[{"tags": ["haskell", "singleton-type"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1515101705, "post_id": 48086359, "comment_id": 83183344, "body": "Next time you&#39;re using Template Haskell that expands into code that needs other extensions, it would be helpful if you&#39;d list those at the top. Otherwise people answering your question will have to work out which extensions they need first."}, {"owner": {"reputation": 14787, "user_id": 139766, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6352d881fa53799e7452d6edb2d1df89?s=128&d=identicon&r=PG", "display_name": "Callum Rogers", "link": "https://stackoverflow.com/users/139766/callum-rogers"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1515115672, "post_id": 48086359, "comment_id": 83187686, "body": "dfeuer: Understood, but I did also post a github repo with all the code ready to go."}], "answers": [{"comments": [{"owner": {"reputation": 14787, "user_id": 139766, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6352d881fa53799e7452d6edb2d1df89?s=128&d=identicon&r=PG", "display_name": "Callum Rogers", "link": "https://stackoverflow.com/users/139766/callum-rogers"}, "edited": false, "score": 0, "creation_date": 1515062473, "post_id": 48088452, "comment_id": 83161427, "body": "Thanks! Wondered why I didn&#39;t see this in the <a href=\"https://hackage.haskell.org/package/singletons-2.3.1/docs/Data-Singletons-Prelude-List.html\" rel=\"nofollow noreferrer\">docs</a>, looks like I was looking at the <a href=\"https://hackage.haskell.org/package/singletons-2.3.1/docs/Data-Promotion-Prelude-List.html\" rel=\"nofollow noreferrer\">promotion docs</a> for list instead!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1515038200, "creation_date": 1515038200, "answer_id": 48088452, "question_id": 48086359, "link": "https://stackoverflow.com/questions/48086359/how-to-use-lists-with-the-haskell-singletons-library/48088452#48088452", "title": "How to use lists with the Haskell singletons library?", "body": "<p>You're very close, but you need to use list <em>singletons</em>.</p>\n\n<pre><code>{-# language TemplateHaskell, DataKinds, GADTs, TypeFamilies #-}\nmodule SingList where\n\nimport Data.Singletons.TH (singletons)\nimport Data.Singletons.Prelude.List (Sing (SNil, SCons))\n\n$(singletons [d|\n\n    data LLVMType\n        = IntegerType\n        | FloatType\n        | FunctionType { argumentTypes :: [LLVMType] }\n\n    |])\n\nfoo :: SLLVMType ('FunctionType '[ 'IntegerType ])\nfoo = SFunctionType (SCons SIntegerType SNil)\n</code></pre>\n"}], "owner": {"reputation": 14787, "user_id": 139766, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6352d881fa53799e7452d6edb2d1df89?s=128&d=identicon&r=PG", "display_name": "Callum Rogers", "link": "https://stackoverflow.com/users/139766/callum-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 48088452, "answer_count": 1, "score": 0, "last_activity_date": 1515038200, "creation_date": 1515020275, "question_id": 48086359, "link": "https://stackoverflow.com/questions/48086359/how-to-use-lists-with-the-haskell-singletons-library", "title": "How to use lists with the Haskell singletons library?", "body": "<p>I'm trying to make a type using the <a href=\"https://github.com/goldfirere/singletons\" rel=\"nofollow noreferrer\"><code>singletons</code></a> library where I use a list:</p>\n\n<pre><code>import Data.Singletons.TH (singletons)\n\n$(singletons [d|\n\n    data LLVMType\n        = IntegerType\n        | FloatType\n        | FunctionType { argumentTypes :: [LLVMType] }\n\n    |])\n\nfoo :: SLLVMType ('FunctionType '[ 'IntegerType ])\nfoo = ???\n</code></pre>\n\n<p>I tried to make <code>foo</code> be: <code>SFunctionType [SIntegerType]</code>, however it results in this error:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Data.Singletons.Sing '['IntegerType]\u2019\n              with actual type \u2018[Data.Singletons.Sing 'IntegerType]\u2019\n\u2022 In the first argument of \u2018SFunctionType\u2019, namely \u2018[SIntegerType]\u2019\n  In the expression: SFunctionType [SIntegerType]\n  In an equation for \u2018foo\u2019: foo = SFunctionType [SIntegerType]\n</code></pre>\n\n<p>How do I make an expression for <code>foo</code> that typechecks? Or how can I achieve this in another way?</p>\n\n<p><a href=\"https://github.com/CRogers/singleton-list-question\" rel=\"nofollow noreferrer\">Github repo with the code</a>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 3, "creation_date": 1515019268, "post_id": 48086038, "comment_id": 83147343, "body": "Instances aren&#39;t somehow &quot;baked&quot; into the values, they get passed as extra parameters to functions. In fact, values themselves don&#39;t carry any runtime type information at all. So if your function doesn&#39;t have a <code>Show</code> constraint (which would make the compiler pass the instance to the function), there is absolutely nowhere to get it from."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1515019478, "post_id": 48086038, "comment_id": 83147410, "body": "This is not really doable. There are half-baked ideas like <a href=\"https://stackoverflow.com/a/35790024/3072788\">stackoverflow.com/a/35790024/3072788</a> that might get you a bit further but honestly, you are better off adding the <code>Show</code> instances everywhere."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1515020227, "post_id": 48086038, "comment_id": 83147640, "body": "@Alec thanks for that link, somehow I missed that question when I was searching. I was really hoping there was some unsafe way to do this for debugging, since I don&#39;t think I actually can add <code>Show</code> everywhere in my case (at least not trivially)."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1515020316, "post_id": 48086038, "comment_id": 83147661, "body": "@FyodorSoikin I understand there&#39;s no run-time information, I was hoping there might be some compile-time hack I could use to do this to force the constraint. Thanks for the input though!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1515021387, "post_id": 48086038, "comment_id": 83147980, "body": "Note that using <code>unsafeCoerce</code> is very dangerous: if used with the wrong type (i.e., if the runtime type is not the target type of the coercion), the behavior of the program becomes completely undefined. The resulting effect is similar to generating a random pointer to memory and then jumping to that address -- anything could happen. In the best scenario, some gibberish is printed and then a segmentation fault happens."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1515033278, "post_id": 48086038, "comment_id": 83150672, "body": "<code>#ifdef DEBUG; type SomeConstraint a = (RealSomeConstraint a, Show a); #else; type SomeConstraint a = RealSomeConstraint #endif</code>"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1515081556, "post_id": 48086038, "comment_id": 83172977, "body": "@chi Definitely important to remember. Like I mentioned before, this is strictly for debugging with known parameters, not used in the more open environment."}], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1515018651, "creation_date": 1515018195, "last_edit_date": 1515018651, "question_id": 48086038, "link": "https://stackoverflow.com/questions/48086038/trace-debugging-a-polymorphic-type-without-a-show-constraint", "title": "Trace debugging a polymorphic type without a Show constraint", "body": "<p>I'm trying to debug a polymorphic function, and would love to be able to print out some intermediate values. <code>Debug.Trace</code> will allow me to print strings to the screen (unsafely) for debugging purposes.</p>\n\n<p>For example</p>\n\n<pre><code>buggyFunction :: (SomeConstraint a, SomeMonadStack m) =&gt; a -&gt; m Int\nbuggyFunction x = do \n   ...\n   trace \"I'm here!\" $ return ()\n   ...\n</code></pre>\n\n<p>If I want to trace an arbitrary value, <code>traceShow</code> works but requires the value you're calling it on to have a <code>Show</code> instance. In my case, I know that my <code>a</code> that is being used to test does have a <code>Show</code> instance I could use, but I can't just add it to my constraints because other functions then wouldn't resolve. </p>\n\n<p>If I just had one type I'm calling it on, I could use <code>unsafeCoerce</code> along with a call to <code>show</code>. For example, let's say <code>buggyFunction</code> works on <code>Int</code> and while testing in GHCi I call it with <code>buggyFunction 5</code>: </p>\n\n<pre><code>buggyFunction :: (SomeConstraint a, SomeMonadStack m) =&gt; a -&gt; m Int\nbuggyFunction x = do \n   ...\n   trace (\"I'm here with value \" ++ show (unsafeCoerce x :: Int)) $ return ()\n   ...\n</code></pre>\n\n<p>Since <code>unsafeCoerce</code> requires a concrete type, I couldn't use it as <code>unsafeCoerce :: a -&gt; (Show b =&gt; b)</code></p>\n\n<p>How could I do this if I don't know the particular type of <code>a</code>, but I do know that it will have an instance for <code>Show</code>? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1515017172, "post_id": 48084706, "comment_id": 83146583, "body": "A note on terminology.  What you have defined is a &quot;type constuctor&quot; (<code>Tree</code>) which can be provided with a type argument to produce a type (ex <code>Tree Int</code>) and a couple &quot;data constructors&quot; (<code>Leaf</code> and <code>Node</code>) which can be provided value argument to produce a value (not an &quot;instance&quot;).  See, for example, <a href=\"https://stackoverflow.com/questions/18204308/haskell-type-vs-data-constructor\">this prior question and answer</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1515021646, "post_id": 48084706, "comment_id": 83148052, "body": "That&#39;s good, since partial functions as <code>head,tail,!!</code> should be avoided as much as possible, using pattern matching instead."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1515022398, "post_id": 48084842, "comment_id": 83148266, "body": "What do you mean, linear access?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1515012189, "creation_date": 1515012189, "answer_id": 48084842, "question_id": 48084706, "link": "https://stackoverflow.com/questions/48084706/accessing-values-in-haskell-custom-data-type/48084842#48084842", "title": "Accessing values in haskell custom data type", "body": "<p>You perform <strong>pattern matching</strong>. For example if you want the first child, you can use:</p>\n\n<pre><code>firstChild :: Tree a -&gt; Maybe (Tree a)\nfirstChild (Node (h:_)) = Just h\nfirstChild _ = Nothing\n</code></pre>\n\n<p>Here we wrap the answer in a <code>Maybe</code> type, since it is possible that we process a <code>Leaf x</code> or a <code>Node []</code>, such that there is no first child.</p>\n\n<p>Or we can for instance obtain the <em>i</em>-th item with:</p>\n\n<pre><code>iThChild :: Int -&gt; Tree a -&gt; Tree a\niThChild i (Node cs) = cs !! i\n</code></pre>\n\n<p>So here we unwrap the <code>Node</code> constructor, obtain the list of children <code>cs</code>, and then perform <code>cs !! i</code> to obtain the <em>i</em>-th child. Note however that <code>(!!) :: [a] -&gt; Int -&gt; a</code> is usually a bit of an anti-pattern: it is unsafe, since we have no guarantees that the list contains enough elements, and using <code>length</code> is an anti-pattern as well, since the list can have infinite length, so we can no do such bound check.</p>\n\n<p>Usually if one writes algorithms in Haskell, one tends to make use of <em>linear</em> access, and write <em>total</em> functions: functions that always return something.</p>\n"}], "owner": {"reputation": 21, "user_id": 6426775, "user_type": "registered", "profile_image": "https://graph.facebook.com/1021391964615109/picture?type=large", "display_name": "Ciar&#225;n Martin", "link": "https://stackoverflow.com/users/6426775/ciar%c3%a1n-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1405, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1515012189, "creation_date": 1515011596, "question_id": 48084706, "link": "https://stackoverflow.com/questions/48084706/accessing-values-in-haskell-custom-data-type", "title": "Accessing values in haskell custom data type", "body": "<p>I'm very new to haskell and need to use a specific data type for a problem I am working on.</p>\n\n<pre><code>data Tree a = Leaf a | Node [Tree a]\nderiving (Show, Eq)\n</code></pre>\n\n<p>So when I make an instance of this e.g Node[Leaf 1, Leaf2, Leaf 3] how do I access these? It won't let me use head or tail or indexing with !! .</p>\n"}, {"tags": ["haskell", "atom-editor", "haskell-stack"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1515005919, "post_id": 48083426, "comment_id": 83141698, "body": "You have to create a cabal file (or yaml file if using hpack) to list down the dependencies. You can quickly get started like this: <a href=\"https://haskell-lang.org/get-started\" rel=\"nofollow noreferrer\">haskell-lang.org/get-started</a>"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1515006355, "post_id": 48083426, "comment_id": 83141895, "body": "@Sibi I&#39;ve routinely been playing with <code>.hs</code> files in Atom for a year or more, and whenever I&#39;ve stuck to &#39;basic&#39; modules, I&#39;ve been doing fine without a <code>.cabal</code> or <code>.yaml</code> file. I know how to create a &#39;proper&#39; Stack project and add dependencies. This question is specifically about ad-hoc, exploratory programming."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1515007060, "post_id": 48083426, "comment_id": 83142220, "body": "Ah, I see. You have them installed as global dependencies. Unfortunately I don&#39;t use atom and can&#39;t be of much help. As a check you can see if <code>stack exec ghc-pkg list</code> has your dependency."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1515007331, "post_id": 48083426, "comment_id": 83142359, "body": "@Sibi Thank you for looking at the question. I understand that you don&#39;t use Atom, so you probably can&#39;t help, but I&#39;ll leave this response for others to see: <code>vector-0.12.0.1</code> is included in the list produced by <code>stack exec ghc-pkg list</code>, which seems to be consistent with the fact that <code>stack ghci</code> can load the module; it&#39;s Atom that can&#39;t find it."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1523145415, "post_id": 48083426, "comment_id": 86439651, "body": "have you found an answer to this problem? I am having this problem even with <code>Data.Vector</code>"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1523173155, "post_id": 48083426, "comment_id": 86444158, "body": "@matthias No, I would happily post an answer to my own question if I managed to get it resolved. I&#39;ve currently abandoned Atom in favour of VS Code for Haskell development, but <a href=\"https://stackoverflow.com/q/48770086/126014\">that comes with its own set of problems</a>."}], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1515005412, "creation_date": 1515005412, "question_id": 48083426, "link": "https://stackoverflow.com/questions/48083426/why-can-i-load-a-module-in-ghci-while-atom-cant-find-it", "title": "Why can I load a module in GHCi, while Atom can&#39;t find it?", "body": "<p>I'm using Haskell with Stack and Atom on Windows 10. Sometimes, I like to just write a stand-alone <code>.hs</code> file to play around with various things. When I do that, I prefer to interact with it using GHCi.</p>\n\n<p>Usually, I start it from Git Bash:</p>\n\n<pre><code>$ stack ghci --color never\n</code></pre>\n\n<p>From here, I can add modules:</p>\n\n<pre><code>Prelude&gt; :m +Data.Vector.Unboxed\nPrelude Data.Vector.Unboxed&gt;\n</code></pre>\n\n<p>In Atom, however, I'm having trouble with that particular package:</p>\n\n<ol>\n<li>Open Atom</li>\n<li>Create a new <code>.hs</code> file</li>\n<li>Add this following content to it and hit <em>Save:</em></li>\n</ol>\n\n<p>File contents:</p>\n\n<pre><code>module Ploeh where\n\nimport qualified Data.Vector.Unboxed as V\n</code></pre>\n\n<p>When I save the file, I get this error message in Atom:</p>\n\n<pre><code>Failed to load interface for `Data.Vector.Unboxed'\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p>If I remove the import of <code>Data.Vector.Unboxed</code>, the error message goes away.</p>\n\n<p>This problem happens specifically with <code>Data.Vector.Unboxed</code>. Other modules are either consistently present in both GHCi and Atom, or consistently missing in both environments, but particularly this module behaves inconsistently.</p>\n\n<p>I suppose Atom uses a different engine than the 'global' configuration used by <code>stack ghci</code>, but if so, where is it, and can I configure/update it? Why the difference?</p>\n\n<hr>\n\n<p>I'm using the following Atom packages:</p>\n\n<ul>\n<li><em>autocomplete-haskell</em> 1.0.1</li>\n<li><em>haskell-ghc-mod</em> 2.2.2</li>\n<li><em>ide-haskell</em> 2.2.2</li>\n<li><em>ide-haskell-cabal</em> 2.1.0</li>\n<li><em>language-haskell</em> 1.17.2</li>\n</ul>\n\n<p>Atom itself is version 1.23.2 x64.</p>\n\n<pre><code>$ stack --version\nVersion 1.6.3, Git revision b27e629b8c4ce369e3b8273f04db193b060000db (5454 commits) x86_64 hpack-0.20.0\n</code></pre>\n\n<p>I believe that everything is up-to-date.</p>\n\n<p>I've read <a href=\"https://atom-haskell.github.io/core-packages/haskell-ghc-mod/#using-with-stack\" rel=\"nofollow noreferrer\">https://atom-haskell.github.io/core-packages/haskell-ghc-mod/#using-with-stack</a> and other parts of the documentation to see if I could find some useful information, but I've failed to find something to enlighten me.</p>\n"}, {"tags": ["xcode", "bash", "haskell", "ghc", "fish"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1515004602, "post_id": 48082595, "comment_id": 83140996, "body": "I would recommend you to get started like this: <a href=\"https://haskell-lang.org/get-started/osx\" rel=\"nofollow noreferrer\">haskell-lang.org/get-started/osx</a>"}, {"owner": {"reputation": 306, "user_id": 7295609, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eafa51697642ed1af7680b797152fe92?s=128&d=identicon&r=PG&f=1", "display_name": "\ud64d\ud55c\uc11d", "link": "https://stackoverflow.com/users/7295609/%ed%99%8d%ed%95%9c%ec%84%9d"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1515050644, "post_id": 48082595, "comment_id": 83155272, "body": "@Sibi Thanks!\ud83d\ude0d"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1515056599, "post_id": 48082595, "comment_id": 83157931, "body": "You can answer the question yourself, if it solved you."}, {"owner": {"reputation": 306, "user_id": 7295609, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eafa51697642ed1af7680b797152fe92?s=128&d=identicon&r=PG&f=1", "display_name": "\ud64d\ud55c\uc11d", "link": "https://stackoverflow.com/users/7295609/%ed%99%8d%ed%95%9c%ec%84%9d"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1515144753, "post_id": 48082595, "comment_id": 83196767, "body": "@Sibi Thanks to notice me, I answered."}], "answers": [{"tags": [], "owner": {"reputation": 306, "user_id": 7295609, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eafa51697642ed1af7680b797152fe92?s=128&d=identicon&r=PG&f=1", "display_name": "\ud64d\ud55c\uc11d", "link": "https://stackoverflow.com/users/7295609/%ed%99%8d%ed%95%9c%ec%84%9d"}, "is_accepted": true, "score": 1, "last_activity_date": 1515144708, "creation_date": 1515144708, "answer_id": 48110719, "question_id": 48082595, "link": "https://stackoverflow.com/questions/48082595/install-haskell-through-ghc-in-fish/48110719#48110719", "title": "install Haskell through GHC in fish", "body": "<p>Solved by other installation ways:</p>\n\n<ol>\n<li>Follow the instructions of:\n<a href=\"https://haskell-lang.org/get-started/osx\" rel=\"nofollow noreferrer\">https://haskell-lang.org/get-started/osx</a></li>\n</ol>\n\n<p>or</p>\n\n<ol start=\"2\">\n<li>Download it(it takes long time..):\n<a href=\"https://www.haskell.org/platform/\" rel=\"nofollow noreferrer\">https://www.haskell.org/platform/</a></li>\n</ol>\n"}], "owner": {"reputation": 306, "user_id": 7295609, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eafa51697642ed1af7680b797152fe92?s=128&d=identicon&r=PG&f=1", "display_name": "\ud64d\ud55c\uc11d", "link": "https://stackoverflow.com/users/7295609/%ed%99%8d%ed%95%9c%ec%84%9d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 48110719, "answer_count": 1, "score": 0, "last_activity_date": 1515144708, "creation_date": 1515001873, "question_id": 48082595, "link": "https://stackoverflow.com/questions/48082595/install-haskell-through-ghc-in-fish", "title": "install Haskell through GHC in fish", "body": "<p>I'd like to install Haskell using <a href=\"https://ghcformacosx.github.io/\" rel=\"nofollow noreferrer\">GHC</a>, recommended.</p>\n\n<p>I did instructions that said but it warns me:\n<a href=\"https://i.stack.imgur.com/NZaH1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NZaH1.png\" alt=\"GHC\"></a></p>\n\n<ol>\n<li>1st warn:\n\n<blockquote>\n  <p>!These instructions were written for users who use bash or zsh, not <code>/usr/local/bin/fish</code>.\n  Hopefully you know what you're doing!</p>\n</blockquote></li>\n</ol>\n\n<p>Using fish, unfortunately, I edit the instructions in fish version:</p>\n\n<pre><code>$ cat ~/.config/fish/config.fish\n...\nset GHC_DOT_APP /Applications/ghc-7.10.3.app\nif test -d $GHC_DOT_APP\n    set PATH $HOME/.local/bin $HOME/.cabal/bin $GHC_DOT_APP/Contents/bin $PATH\nend\n...\n$ echo $PATH\n/Users/hongbook/.local/bin /Users/hongbook/.cabal/bin /Applications/ghc-7.10.3.app/Contents/bin /Users/hongbook/.fzf/bin /Users/hongbook/.rvm/bin /usr/local/bin /usr/bin /bin /usr/sbin /sbin /opt/X11/bin /usr/local/go/bin /Applications/Postgres.app/Contents/Versions/latest/bin /Users/hongbook/.rvm/bin\n</code></pre>\n\n<p>Also, wrote that, above instructions too in <code>~/.profile</code>.</p>\n\n<ol start=\"2\">\n<li>2nd warn:\n\n<blockquote>\n  <p>Xcode is not installed</p>\n</blockquote></li>\n</ol>\n\n<p>But I've already got it.</p>\n\n<pre><code>$ xcode-select --version \nxcode-select version 2349.\n</code></pre>\n\n<p>Refresh checklist doesn't work.</p>\n"}, {"tags": ["performance", "haskell", "graph", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1515031369, "post_id": 48085048, "comment_id": 83150305, "body": "Should probably get a pattern guard and <code>error</code> clause."}], "tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": false, "score": 2, "last_activity_date": 1515013166, "creation_date": 1515013166, "answer_id": 48085048, "question_id": 48081629, "link": "https://stackoverflow.com/questions/48081629/improve-performance-of-finding-graph-diameter-in-haskell/48085048#48085048", "title": "Improve performance of finding graph diameter in Haskell", "body": "<p><code>deq (Queue [] [])</code> causes an infinite loop, I think.</p>\n"}, {"comments": [{"owner": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 0, "creation_date": 1515030916, "post_id": 48086700, "comment_id": 83150199, "body": "Looks reasonable, will try it out tomorrow :)"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 1, "creation_date": 1515031213, "post_id": 48086700, "comment_id": 83150267, "body": "Oh, and the contest judge might also accept <code>{#- OPTIONS_GHC -O3 -fllvm -#}</code> for some more speedup, or it might not. Let me know how much difference that makes."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 0, "creation_date": 1515031464, "post_id": 48086700, "comment_id": 83150323, "body": "The next step would be to make sure you\u2019re using the right algorithm and data structures before micro-optimizing stuff like strictness, eagerness, and eliminating intermediate lists. Haven\u2019t analyzed that in any detail yet."}, {"owner": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 0, "creation_date": 1515060728, "post_id": 48086700, "comment_id": 83160335, "body": "Your changes resulted in a considerable performance boost - I&#39;m still getting time limits, but on fewer tests."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 0, "creation_date": 1515062134, "post_id": 48086700, "comment_id": 83161220, "body": "In my experience, the fist thing you should always do in any programming-contest problem for Haskell is plug in some fast I/O boilerplate. It will make any solution that uses the <code>Prelude</code> run in a fraction of the time. Then look at your algorithm and, in particular, your data structures. You probably want to solve this one yourself, but a look at the problem statement says the graph is actually a <i>tree</i>, which means you can find the root of the tree and the two longest branches in linear time."}, {"owner": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 1, "creation_date": 1515072358, "post_id": 48086700, "comment_id": 83167251, "body": "Well, the problem description states that it&#39;s a tree like structure, but a close look at the provided input actually reveals that a root cannot be determined based on the input. Consider one of the sample tests <code>(3 4) (0 3) (0 2) (1 4)</code>   The structure described by the edges listed above cannot be a rooted tree because if we assume the edges are directed, than either <code>4</code> or <code>0</code> has more than one parent.  Coming to think about it, this might be a directed graph. I&#39;ll try treating the graph as directed and see where this goes :)"}, {"owner": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 0, "creation_date": 1515072691, "post_id": 48086700, "comment_id": 83167466, "body": "<code>{#- OPTIONS_GHC -O3 -fllvm -#}</code> Didn&#39;t help much. The <code>-fllvm</code> flag caused compile error on my machina as well as on the judge system."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "edited": false, "score": 0, "creation_date": 1515074651, "post_id": 48086700, "comment_id": 83168768, "body": "Got to be undirected, or in the second example, the path 0-&gt;10-&gt;5-&gt;1-&gt;7-&gt;2-&gt;8-&gt;6-&gt;4 fails at the 7-&gt;2 step.  But all the examples are connected and acyclic."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 1, "last_activity_date": 1515027255, "last_edit_date": 1515027255, "creation_date": 1515022832, "answer_id": 48086700, "question_id": 48081629, "link": "https://stackoverflow.com/questions/48081629/improve-performance-of-finding-graph-diameter-in-haskell/48086700#48086700", "title": "Improve performance of finding graph diameter in Haskell", "body": "<p>When I\u2019ve solved contest problems in Haskell, typically the biggest performance hog has been the slow I/O library, which operates on lazy linear linked lists of wide characters.  The first thing I always do for a programming contest is replace that with fast I/O,</p>\n\n<p>Here\u2019s a version that makes minimal changes to the program logic and just replaces the I/O with <code>Data.ByteString.Lazy.Char8</code>, implemented with a lazily-evaluated list of strict byte arrays, and <code>Data.ByteString.Builder</code>, which builds a function to fill an output buffer.  It should be useful to calculate the speed-up from fast I/O alone.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-} -- Added\n\nimport Data.ByteString.Builder\n  (Builder, char7, intDec, toLazyByteString) -- Added\nimport qualified Data.ByteString.Lazy.Char8 as B8 -- Added\nimport qualified Data.Map as Map\nimport qualified Data.Set as Set\nimport Data.List (maximumBy)\nimport Data.Maybe (fromJust) -- Added\nimport Data.Monoid ((&lt;&gt;)) -- Added\nimport Data.Ord (comparing)\n\nbuildGraph :: [Int] -&gt; Map.Map Int [(Int, Int)] -&gt; Map.Map Int [(Int, Int)]\nbuildGraph [] acc                  = acc\nbuildGraph (from:to:dist:rest) acc = let withTo = Map.insertWith (++) from [(to, dist)] acc\n                                         withFromTo = Map.insertWith (++) to [(from, dist)] withTo\n                                        in buildGraph rest $ withFromTo\n\ndata Queue a = Queue {\n                ingoing :: [a]\n                , outgoing :: [a]\n            } deriving Show\n\ntoQueue xs = Queue [] xs\nenqMany xs (Queue is os) = (Queue (reverse xs ++ is) os)\ndeq (Queue is []) = deq (Queue [] $ reverse is)\ndeq (Queue is (o:os)) = (o, Queue is os)\n\nextract :: (Ord a) =&gt; a -&gt; Map.Map a [b] -&gt; [b]\nextract k m = case Map.lookup k m of\n                    Just value -&gt; value\n                    Nothing    -&gt; error \"sdfsd\" -- should never happen\n\nbfs node graph = bfs' Set.empty (toQueue [(node, 0)]) []\n    where\n        bfs' :: Set.Set Int -&gt; Queue (Int, Int) -&gt; [(Int, Int)] -&gt; [(Int, Int)]\n        bfs' visited (Queue [] []) acc = acc\n        bfs' visited que acc = let ((n, dist), rest) = deq que\n                                    in if Set.member n visited\n                                            then bfs' visited rest acc\n                                            else let children = map (\\(i, d) -&gt; (i, d + dist)) $ extract n graph\n                                                     newNodes = enqMany children rest\n                                                    in bfs' (Set.insert n visited) newNodes ((n, dist):acc)\n\nfindMostDistant xs = maximumBy (comparing snd) xs\n\nsolve triples = answer -- Changed (by deleting one line)\n    where\n        graph = buildGraph triples Map.empty\n        -- pick arbitary node, find the farther node from it using bfs\n        (mostDistant, _) = findMostDistant $ bfs (head triples) graph\n        -- find the farthest node from the previously farthest node, counting the distance on the way\n        (_, answer) = findMostDistant $ bfs mostDistant graph\n\ntests = [ -- Unchanged, but now interpreted as OverloadedStrings\n            \"11 2 7 2 1 7 6 5 1 8 2 8 6 8 6 9 10 5 5 9 1 9 0 10 15 3 1 21 6 4 3\" -- 54\n            , \"5 3 4 3 0 3 4 0 2 6 1 4 9\" -- 22\n            , \"16 2 3 92 5 2 10 14 3 42 2 4 26 14 12 50 4 6 93 9 6 24 15 14 9 0 2 95 8 0 90 0 13 60 9 10 59 1 0 66 11 12 7 7 10 35\" -- 428\n        ]\n\nrunZeroTests = B8.putStr -- Changed\n  . toLazyByteString\n  . foldMap format\n  . map (solve . parse)\n  $ tests\n\nmain :: IO () -- Changed\nmain = B8.interact ( toLazyByteString . format . solve . parse )\n\nparse :: B8.ByteString -&gt; [Int] -- Added\n-- the first number is the number of edges and is not necessary\nparse = map (fst . fromJust . B8.readInt) . tail . B8.words\n\nformat :: Int -&gt; Builder -- Added\nformat n = intDec n &lt;&gt; eol where\n  eol = char7 '\\n'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1515123967, "post_id": 48104114, "comment_id": 83189436, "body": "As for evaluation order: there\u2019s a formal answer that involves compiling Haskell programs to lambda expressions, but in practice there are only two times I\u2019ve found I cared. One was when I\u2019m relying on lazy evaluation to avoid infinite recursion, so I need to put the expression that might never terminate to the right of the one that will. The other is when I\u2019m optimizing for speed or memory by explicitly forcing strict evaluation, and then I override it anyway."}], "tags": [], "owner": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "is_accepted": true, "score": 1, "last_activity_date": 1515268119, "last_edit_date": 1515268119, "creation_date": 1515102732, "answer_id": 48104114, "question_id": 48081629, "link": "https://stackoverflow.com/questions/48081629/improve-performance-of-finding-graph-diameter-in-haskell/48104114#48104114", "title": "Improve performance of finding graph diameter in Haskell", "body": "<p>With help from @Davislor with doing IO using <code>ByteString</code> and a few other things I managed to get 100 points on the problem. In the end, what I did to optimize it was:</p>\n\n<ol>\n<li>Using <code>ByteString</code> IO as @Davislor suggested</li>\n<li>Since I knew integers in the input were valid, I wrote my own <code>parseInt</code> function that does not perform unnecessary checks.</li>\n<li>Instead of lazy <code>Map</code>, I used <code>Array</code> to create an adjacency list. I do not know what the asymptotic complexity of constructing an <code>Array</code> using <code>accumArray</code> is (I believe it should be <code>O(n)</code>), but lookup in the array should be <code>O(1)</code>, instead of the <code>O(log n)</code> for the <code>Map</code>.</li>\n</ol>\n\n<p>Here is the final solution:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE BangPatterns #-}\n\nimport Data.ByteString.Builder\n(Builder, char7, intDec, toLazyByteString)\nimport qualified Data.ByteString.Lazy.Char8 as B8\nimport qualified Data.Set as Set\nimport Data.Monoid ((&lt;&gt;))\nimport Data.Char (ord)\nimport Data.ByteString (getLine)\nimport Data.Array (Array, array, accumArray, (!), (//))\n\nbuildAdjList :: Int -&gt; [Int] -&gt; Array Int [(Int, Int)]\nbuildAdjList n xs = accumArray (flip (:)) [] (0, n) $ triples xs []\n    where\n        triples [] res = res\n        triples (x:y:dist:rest) res = let edgeXY = (x, (y, dist))\n                                        edgeYX = (y, (x, dist))\n                                        in triples rest (edgeXY:edgeYX:res)\n\ndata Queue a = Queue {\n                ingoing :: [a]\n                , outgoing :: [a]\n            } deriving Show\n\nenqMany xs (Queue is os) = Queue (reverse xs ++ is) os\ndeq (Queue [] []) = error \"gosho\"\ndeq (Queue is []) = deq (Queue [] $ reverse is)\ndeq (Queue is (o:os)) = (o, Queue is os)\n\nbfs !node adjList = let start = (node, 0) in bfs' Set.empty (Queue [] [start]) start\n    where\n        bfs' :: Set.Set Int -&gt; Queue (Int, Int) -&gt; (Int, Int) -&gt; (Int, Int)\n        bfs' visited (Queue [] []) !ans = ans\n        bfs' visited que !ans = let (curr@(n, dist), rest) = deq que\n                                    in if Set.member n visited\n                                            then bfs' visited rest ans\n                                            else let children = map (\\(i, d) -&gt; (i, d + dist)) $ adjList ! n\n                                                    newNodes = enqMany children rest\n                                                    in bfs' (Set.insert n visited) newNodes (longerEdge curr ans)\n\nlongerEdge :: (Int, Int) -&gt; (Int, Int) -&gt; (Int, Int)\nlongerEdge a b = if (snd a) &lt; (snd b) then b else a\n\nparseInt :: B8.ByteString -&gt; Int\nparseInt str = parseInt' str 0 where\n    parseInt' str !acc\n        | B8.null str  = acc\n        | otherwise = parseInt' (B8.tail str) $ ((ord $ B8.head str) - 48 + acc * 10)\n\nparseIntList :: B8.ByteString -&gt; [Int]\nparseIntList = map parseInt . B8.words\n\nsolve :: [Int] -&gt; Int\nsolve (n:triples) = answer\n    where\n        graph = buildAdjList n triples\n        -- pick arbitary node, find the farther node from it using bfs\n        (mostDistant, _) = bfs (head triples) graph\n        -- find the farthest node from the previously farthest node, counting the distance on the way\n        (_, answer) = bfs mostDistant graph\n\nmain :: IO ()\nmain = B8.interact ( toLazyByteString . intDec . solve . parseIntList )\n\n-- debug code below\ntests = [\n            \"11 2 7 2 1 7 6 5 1 8 2 8 6 8 6 9 10 5 5 9 1 9 0 10 15 3 1 21 6 4 3\" -- 54\n            , \"5 3 4 3 0 3 4 0 2 6 1 4 9\" -- 22\n            , \"16 2 3 92 5 2 10 14 3 42 2 4 26 14 12 50 4 6 93 9 6 24 15 14 9 0 2 95 8 0 90 0 13 60 9 10 59 1 0 66 11 12 7 7 10 35\" -- 428\n        ]\n\nrunZeroTests = B8.putStr\n    . toLazyByteString\n    . foldMap format\n    . map (solve . parseIntList)\n    $ tests\n\nformat :: Int -&gt; Builder\nformat n = intDec n &lt;&gt; eol\n    where eol = char7 '\\n'\n</code></pre>\n\n<p>There could still be room for improvement, the <code>Set</code> for visited nodes could be changed to a bit array, <code>Int32</code> can be used instead of <code>Int</code>, <code>BangPatterns</code> could be applied, although I feel like I can't really make sense of the execution order of Haskell programs.</p>\n"}], "owner": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 48104114, "answer_count": 3, "score": 1, "last_activity_date": 1515268119, "creation_date": 1514998001, "question_id": 48081629, "link": "https://stackoverflow.com/questions/48081629/improve-performance-of-finding-graph-diameter-in-haskell", "title": "Improve performance of finding graph diameter in Haskell", "body": "<p>I'm solving the following <a href=\"http://judge.telerikacademy.com/problem/03diameter\" rel=\"nofollow noreferrer\">problem</a>, which in essence is \"find the diameter of a connected undirected weighted graph\", in Haskell. Now, the solution below produces correct answers, but exceeds the time limit on 9/27 of the tests. I'm far from a Haskell prodigy, can you guys give me a clue whether and how I can improve the performance of my solution without using the builtin <code>Data.Graph</code> module? I tried using accumulator parameters, strict pairs and strict evaluation in some places, but either I used them incorrectly or the performance issue is elsewhere. Thanks in advance!</p>\n\n<pre><code>import qualified Data.Map as Map\nimport qualified Data.Set as Set\nimport Data.List (maximumBy)\nimport Data.Ord (comparing)\n\nbuildGraph :: [Int] -&gt; Map.Map Int [(Int, Int)] -&gt; Map.Map Int [(Int, Int)]\nbuildGraph [] acc                  = acc\nbuildGraph (from:to:dist:rest) acc = let withTo = Map.insertWith (++) from [(to, dist)] acc\n                                        withFromTo = Map.insertWith (++) to [(from, dist)] withTo\n                                        in buildGraph rest $ withFromTo\n\ndata Queue a = Queue {\n                ingoing :: [a]\n                , outgoing :: [a]\n            } deriving Show\n\ntoQueue xs = Queue [] xs\nenqMany xs (Queue is os) = (Queue (reverse xs ++ is) os)\ndeq (Queue is []) = deq (Queue [] $ reverse is)\ndeq (Queue is (o:os)) = (o, Queue is os)\n\nextract :: (Ord a) =&gt; a -&gt; Map.Map a [b] -&gt; [b]\nextract k m = case Map.lookup k m of\n                    Just value -&gt; value\n                    Nothing    -&gt; error \"sdfsd\" -- should never happen\n\nbfs node graph = bfs' Set.empty (toQueue [(node, 0)]) []\n    where\n        bfs' :: Set.Set Int -&gt; Queue (Int, Int) -&gt; [(Int, Int)] -&gt; [(Int, Int)]\n        bfs' visited (Queue [] []) acc = acc\n        bfs' visited que acc = let ((n, dist), rest) = deq que\n                                    in if Set.member n visited\n                                            then bfs' visited rest acc\n                                            else let children = map (\\(i, d) -&gt; (i, d + dist)) $ extract n graph\n                                                    newNodes = enqMany children rest\n                                                    in bfs' (Set.insert n visited) newNodes ((n, dist):acc)\n\nfindMostDistant xs = maximumBy (comparing snd) xs\n\nsolve input = answer\n    where\n        -- the first number is the number of edges and is not necessary\n        (_:triples) = map read $ words input\n        graph = buildGraph triples Map.empty\n        -- pick arbitary node, find the farther node from it using bfs\n        (mostDistant, _) = findMostDistant $ bfs (head triples) graph\n        -- find the farthest node from the previously farthest node, counting the distance on the way\n        (_, answer) = findMostDistant $ bfs mostDistant graph\n\ntests = [\n            \"11 2 7 2 1 7 6 5 1 8 2 8 6 8 6 9 10 5 5 9 1 9 0 10 15 3 1 21 6 4 3\" -- 54\n            , \"5 3 4 3 0 3 4 0 2 6 1 4 9\" -- 22\n            , \"16 2 3 92 5 2 10 14 3 42 2 4 26 14 12 50 4 6 93 9 6 24 15 14 9 0 2 95 8 0 90 0 13 60 9 10 59 1 0 66 11 12 7 7 10 35\" -- 428\n        ]\n\nrunZeroTests = mapM_ print $ map solve tests\n\nmain = do\n    answer &lt;- solve &lt;$&gt; getContents\n    print answer\n</code></pre>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514995916, "post_id": 48081039, "comment_id": 83136281, "body": "Any attempt from your side?"}, {"owner": {"reputation": 1342, "user_id": 4934409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd7da6e3fc1ed1e5316b3e8c10c93d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Scriptim", "link": "https://stackoverflow.com/users/4934409/scriptim"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514996005, "post_id": 48081039, "comment_id": 83136344, "body": "@WillemVanOnsem You can see my attempt for constant <code>n</code>s, but I have no idea how to make this generic."}, {"owner": {"reputation": 1342, "user_id": 4934409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd7da6e3fc1ed1e5316b3e8c10c93d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Scriptim", "link": "https://stackoverflow.com/users/4934409/scriptim"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514996051, "post_id": 48081039, "comment_id": 83136367, "body": "I guess it&#39;s a fairly basic question, but I don&#39;t know much about Haskell."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514996062, "post_id": 48081039, "comment_id": 83136376, "body": "Hint: use recursion"}, {"owner": {"reputation": 1342, "user_id": 4934409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd7da6e3fc1ed1e5316b3e8c10c93d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Scriptim", "link": "https://stackoverflow.com/users/4934409/scriptim"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514996115, "post_id": 48081039, "comment_id": 83136411, "body": "@WillemVanOnsem Yeah, I assumed that recursion is needed."}], "answers": [{"comments": [{"owner": {"reputation": 1342, "user_id": 4934409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd7da6e3fc1ed1e5316b3e8c10c93d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Scriptim", "link": "https://stackoverflow.com/users/4934409/scriptim"}, "edited": false, "score": 0, "creation_date": 1514998274, "post_id": 48081662, "comment_id": 83137687, "body": "Oh, I didn&#39;t expect it to be that simple - Thank you!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1514998550, "post_id": 48081662, "comment_id": 83137826, "body": "And you can use <code>enumFromTo</code> to avoid duplicating the reference to <code>n</code>, leading to a point-free version <code>f = sequence . (replicate &lt;*&gt; enumFromTo 1)</code>."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 7, "last_activity_date": 1514998131, "creation_date": 1514998131, "answer_id": 48081662, "question_id": 48081039, "link": "https://stackoverflow.com/questions/48081039/haskell-f-n-that-returns-list-of-lists-of-n-elements-from-1-n/48081662#48081662", "title": "Haskell: f n that returns list of lists of n elements from [1..n]", "body": "<p>one solution can be</p>\n\n<pre><code>f n = sequence . replicate n $ [1..n]\n</code></pre>\n\n<p>Note that <code>f 10</code> will have 10^10 elements</p>\n"}, {"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 2, "creation_date": 1514999919, "post_id": 48082005, "comment_id": 83138556, "body": "from @chepner&#39;s comment, in pointfree from  <code>replicateM &lt;*&gt; (enumFromTo 1)</code>"}], "tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": false, "score": 6, "last_activity_date": 1514999419, "creation_date": 1514999419, "answer_id": 48082005, "question_id": 48081039, "link": "https://stackoverflow.com/questions/48081039/haskell-f-n-that-returns-list-of-lists-of-n-elements-from-1-n/48082005#48082005", "title": "Haskell: f n that returns list of lists of n elements from [1..n]", "body": "<p>Another method could be:</p>\n\n<pre><code>Prelude&gt; import Control.Monad\nPrelude Control.Monad&gt; f n = replicateM n [1..n]\nPrelude Control.Monad&gt; f 2\n[[1,1],[1,2],[2,1],[2,2]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 0, "last_activity_date": 1521056348, "creation_date": 1521056348, "answer_id": 49286399, "question_id": 48081039, "link": "https://stackoverflow.com/questions/48081039/haskell-f-n-that-returns-list-of-lists-of-n-elements-from-1-n/49286399#49286399", "title": "Haskell: f n that returns list of lists of n elements from [1..n]", "body": "<p>A solution with the great <code>combinat</code> library:</p>\n\n<pre><code>Math.Combinat.Sets&gt; combine 3 [1 .. 3]\n[[1,1,1],[1,1,2],[1,1,3],[1,2,2],[1,2,3],[1,3,3],[2,2,2],[2,2,3],[2,3,3],[3,3,3]]\n</code></pre>\n"}], "owner": {"reputation": 1342, "user_id": 4934409, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd7da6e3fc1ed1e5316b3e8c10c93d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Scriptim", "link": "https://stackoverflow.com/users/4934409/scriptim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 48081662, "answer_count": 3, "score": 1, "last_activity_date": 1521056348, "creation_date": 1514995828, "last_edit_date": 1514995954, "question_id": 48081039, "link": "https://stackoverflow.com/questions/48081039/haskell-f-n-that-returns-list-of-lists-of-n-elements-from-1-n", "title": "Haskell: f n that returns list of lists of n elements from [1..n]", "body": "<p>I need a function <code>f :: (Integral n) =&gt; n -&gt; [[n]]</code>.</p>\n\n<p>The returned list should contain all lists of length <code>n</code> where all elements originate from <code>[1..n]</code>.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>f 2 = [[1,1],[1,2],[2,1],[2,2]]\n</code></pre>\n\n<hr>\n\n<p>This is an easy problem for constant <code>n</code>s:</p>\n\n<pre><code>f2 = [[a, b] | a &lt;- [1..2], b &lt;- [1..2]]\nf3 = [[a, b, c] | a &lt;- [1..3], b &lt;- [1..3], c &lt;- [1..3]]\nf4 = [[a, b, c, d] | a &lt;- [1..4], b &lt;- [1..4], c &lt;- [1..4], d &lt;- [1..4]]\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "haskell-stack", "ghcjs", "haskell-miso"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1515004404, "post_id": 48080510, "comment_id": 83140888, "body": "Just a guess: perhaps the <code>stack setup</code> code hasn&#39;t been tested with cabal-install 2.0 yet. You could try putting version 1.24 on your $PATH and see if things work then."}, {"owner": {"reputation": 14006, "user_id": 3798102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002464470905/picture?type=large", "display_name": "pamu", "link": "https://stackoverflow.com/users/3798102/pamu"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515004501, "post_id": 48080510, "comment_id": 83140942, "body": "@MichaelSnoyman Thanks for the advice. you mean stack-1.24 right!"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1515004578, "post_id": 48080510, "comment_id": 83140984, "body": "No, I meant cabal 1.24. I&#39;m not familiar with the GHCJS code path, but it appears to use the <code>cabal</code> executable under the surface to do some of the work, and may be making assumptions about its version. (It&#39;s also very likely that it&#39;s the GHCJS scripts themselves making these assumptions.)"}, {"owner": {"reputation": 14006, "user_id": 3798102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002464470905/picture?type=large", "display_name": "pamu", "link": "https://stackoverflow.com/users/3798102/pamu"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515004843, "post_id": 48080510, "comment_id": 83141124, "body": "@MichaelSnoyman Thanks, I will definitely try. <code>stack setup</code>, <code>stack build</code>, <code>stack clean</code> also fails with same error."}, {"owner": {"reputation": 14006, "user_id": 3798102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002464470905/picture?type=large", "display_name": "pamu", "link": "https://stackoverflow.com/users/3798102/pamu"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1515005942, "post_id": 48080510, "comment_id": 83141715, "body": "@MichaelSnoyman Works after deleting <code>cabal-install</code> and running <code>stack build</code>"}], "answers": [{"tags": [], "owner": {"reputation": 14006, "user_id": 3798102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002464470905/picture?type=large", "display_name": "pamu", "link": "https://stackoverflow.com/users/3798102/pamu"}, "is_accepted": true, "score": 2, "last_activity_date": 1515026467, "creation_date": 1515026467, "answer_id": 48087169, "question_id": 48080510, "link": "https://stackoverflow.com/questions/48080510/stack-setup-error-solver-must-be-one-of-modular/48087169#48087169", "title": "Stack setup error &quot;solver must be one of: modular &quot;", "body": "<p>Works after deleting <code>cabal-install</code> and running <code>stack build</code>. As hinted by @MichaelSnoyman ghcjs might be expecting right cabal version.</p>\n"}], "owner": {"reputation": 14006, "user_id": 3798102, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100002464470905/picture?type=large", "display_name": "pamu", "link": "https://stackoverflow.com/users/3798102/pamu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 1, "accepted_answer_id": 48087169, "answer_count": 1, "score": 2, "last_activity_date": 1515026467, "creation_date": 1514993842, "last_edit_date": 1515000415, "question_id": 48080510, "link": "https://stackoverflow.com/questions/48080510/stack-setup-error-solver-must-be-one-of-modular", "title": "Stack setup error &quot;solver must be one of: modular &quot;", "body": "<p>When running <code>stack setup</code> in Miso sample-app (<a href=\"https://github.com/dmjio/miso/tree/master/sample-app\" rel=\"nofollow noreferrer\">https://github.com/dmjio/miso/tree/master/sample-app</a>) following error occurred.</p>\n\n<p>Shorter version:</p>\n\n<pre><code>exit status: 1                                \nstderr: solver must be one of: modular        \nCallStack (from HasCallStack):                \n  error, called at libraries/Cabal/Cabal/Distribution/ReadE.hs:46:24 in Cabal-2.0.1.0:Distribution.ReadE\n</code></pre>\n\n<p>Verbose:</p>\n\n<pre><code>/Users/username/Documents/projects/hs/miso/sample-app$ [ghcjs-pkg]: /Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs-pkg \"recache\" \"--global\" \"--no-user-package-db\"\ninstalling stage 0\n/Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/ghcjs-boot/boot/ghc-prim$ rm_rf dist\n/Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/ghcjs-boot$ [cabal]: /usr/local/bin/cabal \"--config-file\" \"/Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/cabalBootConfig\" \"--ignore-sandbox\" \"install\" \"./boot/ghc-prim\" \"--solver=topdown\" \"--global\" \"--ghcjs\" \"--one-shot\" \"--avoid-reinstalls\" \"--builddir\" \"dist\" \"--with-compiler\" \"/Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs\" \"--with-hc-pkg\" \"/Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs-pkg\" \"--prefix\" \"/Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs\" \"--enable-documentation\" \"--haddock-html\" \"--haddock-hyperlink-source\" \"--enable-shared\" \"--enable-library-profiling\" \"--root-cmd\" \"/Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/run.sh\" \"-v2\" \"--dry-run\"\n/usr/local/bin/cabal --config-file /Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/cabalBootConfig --ignore-sandbox install ./boot/ghc-prim --solver=topdown --global --ghcjs --one-shot --avoid-reinstalls --builddir dist --with-compiler /Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs --with-hc-pkg /Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs-pkg --prefix /Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs --enable-documentation --haddock-html --haddock-hyperlink-source --enable-shared --enable-library-profiling --root-cmd /Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/run.sh -v2 --dry-run\nsolver must be one of: modular\nCallStack (from HasCallStack):\n  error, called at libraries/Cabal/Cabal/Distribution/ReadE.hs:46:24 in Cabal-2.0.1.0:Distribution.ReadE\nghcjs-boot: error running: /usr/local/bin/cabal --config-file /Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/cabalBootConfig --ignore-sandbox install ./boot/ghc-prim --solver=topdown --global --ghcjs --one-shot --avoid-reinstalls --builddir dist --with-compiler /Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs --with-hc-pkg /Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs-pkg --prefix /Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs --enable-documentation --haddock-html --haddock-hyperlink-source --enable-shared --enable-library-profiling --root-cmd /Users/username/.ghcjs/x86_64-darwin-0.2.0.9006020-7.10.3/ghcjs/run.sh -v2 --dry-run\nexit status: 1\nstderr: solver must be one of: modular\nCallStack (from HasCallStack):                \n  error, called at libraries/Cabal/Cabal/Distribution/ReadE.hs:46:24 in Cabal-2.0.1.0:Distribution.ReadE\n\nBooting GHCJS (this will take a long time) ...Process exited with ExitFailure 1: /Users/username/.stack/programs/x86_64-osx/ghcjs-0.2.0.9006020_ghc-7.10.3/src/.stack-work/install/x86_64-osx/lts-6.20/7.10.3/bin/ghcjs-boot --clean\n</code></pre>\n\n<p>Stack and cabal version:</p>\n\n<pre><code>[sample-app] stack --version                                          master  \u2731\nVersion 1.6.3 x86_64 hpack-0.20.0\n[sample-app] cabal --version                                          master  \u2731\ncabal-install version 2.0.0.1\ncompiled using version 2.0.1.0 of the Cabal library \n</code></pre>\n"}, {"tags": ["haskell", "graphviz", "dot", "threepenny-gui"], "comments": [{"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1515235182, "post_id": 48080131, "comment_id": 83229641, "body": "It appears to me that the error is unrelated to Threepenny. At some point, the function <code>head</code> is applied to an empty list. This function is not used in the Threepenny code (though I did only a cursory check), so it is probably used somewhere in your code or a dependency."}, {"owner": {"reputation": 33, "user_id": 6304311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbdcf06bd6cae6ffb5397a867965964?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Bill", "link": "https://stackoverflow.com/users/6304311/tim-bill"}, "reply_to_user": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1515243037, "post_id": 48080131, "comment_id": 83231615, "body": "Thankyou @HeinrichApfelmus, I was applying &quot;head&quot; to an empty list of graph - unintentionally of course. This solved, thanks :)"}], "owner": {"reputation": 33, "user_id": 6304311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbdcf06bd6cae6ffb5397a867965964?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Bill", "link": "https://stackoverflow.com/users/6304311/tim-bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514992385, "creation_date": 1514992385, "question_id": 48080131, "link": "https://stackoverflow.com/questions/48080131/haskell-cant-generate-and-use-image-file-in-threepenny", "title": "Haskell - can&#39;t generate and use Image file in threepenny", "body": "<p>I will try to be as specific as possible.\nI am trying to make a graph visualization GUI using Haskell, Threepenny and DOT</p>\n\n<p>I have created buttons that modify the graph, and I am trying to save the modified graph in the image and load that image <strong>Every Time the graph is modified</strong></p>\n\n<p>However, I can run the Threepenny gui, but I CANT write the image and update it thrown function. </p>\n\n<p>RunGraphviz Function returns IO () and Threepenny GUI uses UI (). I am trying to use \"liftIO\" but it is generating some error \"Prelude head.empty list\". Here is the snippet</p>\n\n<pre><code>url &lt;- GL.loadFile sl \"graph.png\"\n   img &lt;- GL.img # set GL.src url\n   getBody window #+ [return img] #+ [br]\n\nGL.on GL.click button2 $ \\_ -&gt; do\n   -- number &lt;- get GL.value noOfNodes\n    currentGraph &lt;- GL.get GL.value ini\n    no&lt;- GL.get GL.value noOfNodes\n    let (Just g1) = readMaybe (currentGraph) :: Maybe AdjList\n    let f1 = addnode (read no::Int) g1\n    set GL.value (show f1) (element ini)\n    liftIO (visualize f1)\n    getBody window #+ [GL.string \"New Nodes Added\"] #+ [br]\n\nvisualize g = void $ do \n    runGraphviz (graphToDot myParams (myGraph g)) Png (\"C:/Users/Tabish/Desktop/Barira/graph.png\")\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515004357, "post_id": 48077876, "comment_id": 83140870, "body": "I can&#39;t reproduce this on my system, but it&#39;s possible you have something else going on in your <code>stack.yaml</code> that I can&#39;t see. Is there a specific reason you&#39;re referring to the URL explicitly instead of including <code>extra-deps: [Cardinality-0.2]</code>?"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515006430, "post_id": 48077876, "comment_id": 83141932, "body": "Hello, Michael!! As I understand, Cardinality is missing in Stackage, and I see <a href=\"https://hackage.haskell.org/package/Cardinality-0.2\" rel=\"nofollow noreferrer\">here</a> that it&#39;s available only for NixOS and as tarball. So, I added dependency as &quot;archive&quot; with URL to tarball. I&#39;ll try it again tomorrow and will answer about result"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515006871, "post_id": 48077876, "comment_id": 83142125, "body": "Btw, I tried also &quot;extra-deps&quot; even with &quot;@rev:0&quot;, but with the same error. OpenSuse, stack 1.6.3"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515034873, "post_id": 48077876, "comment_id": 83150975, "body": "Then my best guess is that there&#39;s something else in your <code>stack.yaml</code> file that&#39;s causing the problem, since it&#39;s working for me. Also: <code>extra-deps</code> is designed to work with packages on Hackage but not Stackage... Rereading your question: are you, by any chance, running <code>stack build</code> inside the <code>..&#47;mylib</code> directory, <i>away</i> from your <code>stack.yaml</code> file?"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515054036, "post_id": 48077876, "comment_id": 83156756, "body": "No, I run <code>stack build</code> first: in mylib/ dir where is placed mylib&#39;s stack.yaml. Then I run <code>stack build</code> in dir of the application - where is placed stack.yaml of application. What I see is that stack tracks dependency Cardinality in mylib (!) and says that I need to add it as dependency in app&#39;s stack.yaml"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515054859, "post_id": 48077876, "comment_id": 83157095, "body": "may be the problem is in <code>packages:</code> section of app stack.yaml: how I define dependency <code>app &lt;- mylib</code>? May be such dep. must be defined in other way?"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515055548, "post_id": 48077876, "comment_id": 83157400, "body": "<a href=\"https://github.com/commercialhaskell/stack/issues/3742#issuecomment-355228049\" rel=\"nofollow noreferrer\">stack.yaml files of lib and app</a>"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515063212, "post_id": 48077876, "comment_id": 83161821, "body": "I added <a href=\"https://github.com/commercialhaskell/stack/issues/3742#issuecomment-355252852\" rel=\"nofollow noreferrer\">attachment with 2 dummy projects</a> which shows the problem."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515063331, "post_id": 48077876, "comment_id": 83161881, "body": "Michael Sloan already explained the problem in that issue: if you want to use a different stack.yaml in your app, you&#39;ll need to define the extra-dep in that stack.yaml too."}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515063637, "post_id": 48077876, "comment_id": 83162065, "body": "what does it mean &quot;different stack.yaml&quot;? What I can&#39;t understand is: if my libraries use some dependencies (let&#39;s suppose as &quot;archive&quot; tarballs) then all applications which use thos libraries should repeat &quot;archive&quot; dependencies in their own stack.yaml files? If it&#39;s true, this sounds cool."}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515064706, "post_id": 48077876, "comment_id": 83162657, "body": "Seems that I found solution: dependency between myapp and mylib should be defined as <code>extra-dep:</code> local FS path but not as <code>packages:</code>. So, IMO such problem must be refracted in some FAQ, guide, etc, because my use-case looks very usual"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515066387, "post_id": 48077876, "comment_id": 83163654, "body": "This workaround works for such simple projects, but does not work for complex projects with many &quot;local&quot; libraries. As for me, this is a bug in stack: what is &quot;extra-deps:&quot; in the case?! Dependencies of my dependencies (in extra-deps) must be re-included again?! If &quot;extra-deps&quot; is not real dependencies but some kind of &quot;associated build job&quot; or &quot;include&quot;, so it should be named differently."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1515069530, "post_id": 48077876, "comment_id": 83165612, "body": "I don&#39;t have anything else to add to what I&#39;ve said here and what Michael Sloan has already explained on Github."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1517610383, "post_id": 48077876, "comment_id": 84180721, "body": "@Paul-AG a start to documenting this would be if you posted your solution you found as an answer and accepted it, so people encountering this problem could see how you solved it without reading the comment history..."}], "owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514984206, "creation_date": 1514984206, "question_id": 48077876, "link": "https://stackoverflow.com/questions/48077876/how-to-add-tarball-cardinality-package-to-dependency-with-stack", "title": "How to add tarball (Cardinality package) to dependency with stack?", "body": "<p>I have mylib library package and myapp application. I want to use Cardinality package in mylib which is available only as tarball. So, I added to mylib stack.yaml:</p>\n\n<pre><code>packages:\n  ...\n  - location: https://hackage.haskell.org/package/Cardinality-0.2/Cardinality-0.2.tar.gz\n    extra-dep: true\n</code></pre>\n\n<p>Then I add to mylib's cabal file:</p>\n\n<pre><code>build-depends: ...\n               , Cardinality\n</code></pre>\n\n<p>And it's compilable. Now I'm trying to build myapp tool which depends on mylib:</p>\n\n<pre><code>packages:\n  ...\n  - '../mylib'\n</code></pre>\n\n<p>But I get error:</p>\n\n<pre><code>Error: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for mylib:\n    Cardinality must match -any, but the stack configuration has no specified version (latest matching version is 0.2)\nneeded since mylib is a build target.\n\nSome potential ways to resolve this:\n\n  * Recommended action: try adding the following to your extra-deps in /home/XXXX/prj/myapp/stack.yaml:\n\n- Cardinality-0.2\n\n  * Set 'allow-newer: true' to ignore all version constraints and build anyway.\n\n  * You may also want to try using the 'stack solver' command.\n\nPlan construction failed.\n</code></pre>\n\n<p>So, how to add Cardinality tarball to mylib package in right way?!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1514978003, "post_id": 48076189, "comment_id": 83126054, "body": "A <code>where</code> is bound to a syntactical block: <a href=\"https://wiki.haskell.org/Let_vs._Where\" rel=\"nofollow noreferrer\">wiki.haskell.org/Let_vs._Where</a>. So an entire function clause, whereas <code>let</code> is more locally scoped."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514978182, "post_id": 48076189, "comment_id": 83126149, "body": "@WillemVanOnsem Ohhh, I see - that&#39;s a shame."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514978212, "post_id": 48076189, "comment_id": 83126172, "body": "You might be looking for <i>list comprehensions</i>."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514978595, "post_id": 48076189, "comment_id": 83126394, "body": "@Davislor &#39;fraid not, I&#39;m constructing a list with specific single elements, rather than drawing them from another list."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1514979956, "post_id": 48076189, "comment_id": 83127118, "body": "@hnefatl <code>[1 | 1==2]</code> is a list comprehension too."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514986620, "post_id": 48076189, "comment_id": 83130814, "body": "In that case, <code>let xs = [i] where i = 1</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1515000705, "post_id": 48076189, "comment_id": 83139001, "body": "@Davislor this only works at GHCi prompt."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1515019534, "post_id": 48076189, "comment_id": 83147427, "body": "@WillNess Works fine in the context of <code>main = let xs = [i] where i = 1 in print xs</code>, but if you have <code>main = print xs</code>, you would write <code>xs = [i] where i = 1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1514989999, "post_id": 48076314, "comment_id": 83132683, "body": "<code>foo</code> should only have one argument, <code>exclChars</code>, no? Also, you could replace <code>conversionFails</code> with <code>Data.Maybe.isNothing . toInput</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1514990104, "post_id": 48076314, "comment_id": 83132754, "body": "@chepner: correct. I did not read the semantics of the code in the question. It was more a &quot;syntax&quot; transformation."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1514990301, "last_edit_date": 1514990301, "creation_date": 1514978294, "answer_id": 48076314, "question_id": 48076189, "link": "https://stackoverflow.com/questions/48076189/using-where-in-a-list/48076314#48076314", "title": "Using where in a list", "body": "<p>Like the <a href=\"https://wiki.haskell.org/Let_vs._Where\" rel=\"nofollow noreferrer\">Haskell Wiki article says</a>:</p>\n\n<blockquote>\n  <p>It is important to know that <code>let ... in ...</code> is an expression, that is, it can be written <strong>wherever expressions are allowed</strong>. In contrast, <code>where</code>\n  is bound to a <strong>surrounding syntactic construct</strong>, like the pattern matching line of a function definition.</p>\n</blockquote>\n\n<p>So in short, <code>where</code> is bound to the clause of a function declaration, whereas <code>let</code> is more locally scoped in an expression. If you write <code>where</code>, it is visible for the entire clause, like:</p>\n\n<pre><code>f a | a &gt; 0 = g b b\n    | otherwise = b\n    where b = g a a\n</code></pre>\n\n<p>so here the <code>where</code> is visible for the two guards, a <code>let</code> is more locally scoped. If you write <code>let y = f x in y * y</code>, then that <code>y</code> is only <em>visible</em> in the <code>in ...</code> part. For example we can write:</p>\n\n<pre><code>Prelude&gt; let a = 4 in (let a = 2 in a) + a\n6\n</code></pre>\n\n<p>So here the inner <code>a</code> is <code>2</code> whereas the outer is <code>4</code>. This might end up to be very confusing. If we would define variables with the same name in a <code>where</code> clause, this would result in name conflicts.</p>\n\n<p>In case your code sample is a single function, you can of course move this out of the list definition, like:</p>\n\n<pre><code>foo exclChars = \n  testGroup \"toInput\" [testProperty \"toInput '*'\" (forAll others conversionFails)]\n  where others = arbitrary `suchThat` (`notElem` exclChars)\n        conversionFails = isNothing . toInput\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1514978550, "post_id": 48076328, "comment_id": 83126376, "body": "But this has nothing to do with list comprehension. Here a singleton list is constructed."}, {"owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514978810, "post_id": 48076328, "comment_id": 83126507, "body": "You can create singleton lists using list comprehensions by giving singleton generators and use them as where clauses."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1514979589, "post_id": 48076328, "comment_id": 83126942, "body": "@WillNess: yes, but nowhere in the question is there a condition that decides whether or not to add an element. It simply wrappes a result into a singleton-list. It is  quite strange to use a concept that simply is orthogonal on the task."}], "tags": [], "owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "is_accepted": false, "score": 1, "last_activity_date": 1514979086, "last_edit_date": 1514979086, "creation_date": 1514978349, "answer_id": 48076328, "question_id": 48076189, "link": "https://stackoverflow.com/questions/48076189/using-where-in-a-list/48076328#48076328", "title": "Using where in a list", "body": "<p>You might be looking forward to using list comprehensions. In list comprehensions, you could use <code>|</code> which means <em>such that</em>, and you can say <code>[ i | i &lt;- [1] ]</code>. So, you might use them as follows: <code>[ ... | others &lt;- [suchThat arbitrary (\\c -&gt; notElem c exclChars)]</code> in your example.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1514979597, "last_edit_date": 1514979597, "creation_date": 1514979053, "answer_id": 48076506, "question_id": 48076189, "link": "https://stackoverflow.com/questions/48076189/using-where-in-a-list/48076506#48076506", "title": "Using where in a list", "body": "<p><code>[1 | 1==2]</code> is a list comprehension too. <code>1==2</code> is a Boolean <em>expression</em>.</p>\n\n<p>In your example <code>foo = [let i = 1 in i]</code>, the <code>let i = 1 in i</code> is an expression as well.</p>\n\n<p>Indeed <code>where</code> and <code>let</code> are different. <code>let</code> forms an expression, but <code>where</code> does not - it is a part of a definition (<code>a = b where ...</code>). </p>\n\n<p>Difference is, a variable defined by <code>where</code> can be used in the definition's <em>guards</em>, whereas <code>let</code> goes on the right hand side of the <code>=</code> sign.</p>\n\n<p>To your question, just move <code>]</code> before the <code>where</code>, and it will become part of the definition where it appears. </p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1514994815, "creation_date": 1514994815, "answer_id": 48080762, "question_id": 48076189, "link": "https://stackoverflow.com/questions/48076189/using-where-in-a-list/48080762#48080762", "title": "Using where in a list", "body": "<p>I'm unsure about why do you want this specific list comprehension, but this works, and you can try it in GHCi:</p>\n\n<pre><code>&gt; [ i | let i=1 ]\n[1]\n</code></pre>\n\n<p>You can't instead use <code>where</code> in a list comprehension to this effect.</p>\n"}], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 48076314, "answer_count": 4, "score": 3, "last_activity_date": 1514994815, "creation_date": 1514977853, "last_edit_date": 1514987111, "question_id": 48076189, "link": "https://stackoverflow.com/questions/48076189/using-where-in-a-list", "title": "Using where in a list", "body": "<p>Is there any way to use a <code>where</code> expression inside the list syntax? I imagined something like this would work:</p>\n\n<pre><code>foo = [i where i = 1]\n</code></pre>\n\n<p>But compilation yields:</p>\n\n<blockquote>\n  <p>error: parse error on input \u2018where\u2019</p>\n</blockquote>\n\n<p>It's possible to use <code>let ... in</code> inside a list:</p>\n\n<pre><code>foo = [let i = 1 in i]\n</code></pre>\n\n<p>So I assume that <code>where</code> and <code>let</code> behave as different syntactic constructs?</p>\n\n<p>I'm aware it's possible to do:</p>\n\n<pre><code>foo = [i] where i = 1\n</code></pre>\n\n<p>... but for more complicated lists the distance between the <code>i</code> and the <code>i = 1</code> is too far for it to be clear - see the context section below and imagine many more test cases, and this <code>testGroup</code> itself nested inside a list.</p>\n\n<hr>\n\n<p><strong>Context</strong></p>\n\n<p>I ran across this while trying to write a readable testcase:</p>\n\n<pre><code>testGroup \"toInput\"\n[\n    testProperty \"toInput '*'\" (forAll others conversionFails)\n            where others = arbitrary `suchThat` (\\c -&gt; c `notElem` exclChars)\n                  conversionFails c = toInput c == Nothing\n]\n</code></pre>\n\n<p>The equivalent with <code>let</code> just isn't as satisfying to read imo (and, more concretely, when surrounded by other test cases, the <code>testProperty</code> not being on the same indentation as them makes it harder to follow).</p>\n\n<pre><code>testGroup \"toInput\"\n[\n    let others = arbitrary `suchThat` (\\c -&gt; c `notElem` exclChars)\n        conversionFails c = toInput c == Nothing\n    in\n        testProperty \"toInput '*'\" (forAll others conversionFails)\n]\n</code></pre>\n"}, {"tags": ["sockets", "haskell", "networking"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1514991846, "post_id": 48075900, "comment_id": 83133827, "body": "I guess the maintainer <a href=\"https://github.com/haskell/network\" rel=\"nofollow noreferrer\">github.com/haskell/network</a> could answer the question."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1515022305, "post_id": 48075900, "comment_id": 83148244, "body": "The functionality you are asking for is still buggy since you can race, getting a client closing the connection between checking if it&#39;s closed and the call to close.  I&#39;m surprised this causes an exception in the first place, but why don&#39;t you just catch and ignore the exception?  If the exception is non-unique then file an issue."}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1514976693, "creation_date": 1514976693, "question_id": 48075900, "link": "https://stackoverflow.com/questions/48075900/why-theres-no-isclosed-function-at-network-socket", "title": "Why there&#39;s no isClosed function at Network.Socket", "body": "<p>In the <a href=\"https://hackage.haskell.org/package/network-2.6.3.2/docs/Network-Socket.html\" rel=\"noreferrer\"><code>Network.Socket</code></a> module there are functions like <a href=\"https://hackage.haskell.org/package/network-2.6.3.2/docs/Network-Socket.html#t:SocketStatus\" rel=\"noreferrer\"><code>isConnected</code></a>, <a href=\"https://hackage.haskell.org/package/network-2.6.3.2/docs/Network-Socket.html#t:SocketStatus\" rel=\"noreferrer\"><code>isBound</code></a>, etc. but there is no <code>isClosed</code> function, to check whether a socket is closed.</p>\n\n<p>I'm writing a module that needs to close a socket connection:</p>\n\n<pre><code>import qualified Network.Socket as Socket\n\n-- ...\n\nclose Connection{connSock, serverSock} = do\n    Socket.close connSock\n    Socket.close serverSock\n</code></pre>\n\n<p>The problem is that this if the socket is already closed (for instance on the client side), I'll get the following error:</p>\n\n<pre><code>epollControl: does not exist (No such file or directory)\n</code></pre>\n\n<p>So I now I'm checking that the socket is open before closing it:</p>\n\n<pre><code>  closeIfOpen sock = do\n      let MkSocket _ _ _ _ stMV = sock\n      st &lt;- readMVar stMV\n      case st of\n          Closed -&gt; return ()\n          _ -&gt; Socket.close sock\n</code></pre>\n\n<p>While this works, the lack of an <code>isClosed</code> function makes me wonder whether the code above has some potential problem that I'm not aware of (for instance it has a race condition, but my guess is that <code>isConnected</code> and <code>isBound</code> should have it as well...).</p>\n"}, {"tags": ["haskell", "evaluation"], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 3, "last_activity_date": 1514969590, "creation_date": 1514969590, "answer_id": 48074045, "question_id": 48073840, "link": "https://stackoverflow.com/questions/48073840/evaluation-order-of-a-function-makesum-in-haskell/48074045#48074045", "title": "Evaluation order of a function makeSum in haskell", "body": "<blockquote>\n  <p>How do i evaluate this?</p>\n</blockquote>\n\n<p>So, you just have to expand carefully your code there, given the definitions:</p>\n\n<pre><code>makeSum [3, 2, 7]               --initial definition\nfoldr1 add [3, 2, 7]            --substitute with makeSum xs = foldr1 add xs, being xs = [3,2,7]\nadd 3 (foldr1 add [2, 7])       --foldr1 f (x:xs) = f x (foldr1 f xs) being f = add and xs = [2,3,7]\nadd 3 (add 2 (foldr1 add [7]))  --keep the recursive work\nadd 3 (add 2 (7))\n3 + ((2 + 7)\n3 + 9\n12                              --final result\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 9164468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RqJYd.jpg?s=128&g=1", "display_name": "Stefani Dimitrova", "link": "https://stackoverflow.com/users/9164468/stefani-dimitrova"}, "edited": false, "score": 0, "creation_date": 1514973961, "post_id": 48075087, "comment_id": 83123861, "body": "Right, got it! Thanks a lot, i was struggling to understand why we are able to only use xs."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1514973670, "creation_date": 1514973670, "answer_id": 48075087, "question_id": 48073840, "link": "https://stackoverflow.com/questions/48073840/evaluation-order-of-a-function-makesum-in-haskell/48075087#48075087", "title": "Evaluation order of a function makeSum in haskell", "body": "<pre><code>makeSum [] = 0\nmakeSum xs = foldr1 add xs\n   where\n   add x y = x + y\n</code></pre>\n\n<p>is equivalent to the OP's alternative</p>\n\n<pre><code>makeSum [] = 0\nmakeSum (x:xs) = foldr1 add (x:xs)\n   where\n   add x y = x + y\n</code></pre>\n\n<p>The point is: in the first snippet, the variable <code>xs</code> will be bound the <em>whole</em> list. Also, <code>xs</code> is non empty because the first line handles the <code>[]</code> case.</p>\n\n<p>There is no need to match the other constuctor <code>_:_</code> explicitly, a catch-all pattern as <code>xs</code> does the same job, in this case.</p>\n"}], "owner": {"reputation": 95, "user_id": 9164468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RqJYd.jpg?s=128&g=1", "display_name": "Stefani Dimitrova", "link": "https://stackoverflow.com/users/9164468/stefani-dimitrova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 48075087, "answer_count": 2, "score": 3, "last_activity_date": 1514973670, "creation_date": 1514968746, "question_id": 48073840, "link": "https://stackoverflow.com/questions/48073840/evaluation-order-of-a-function-makesum-in-haskell", "title": "Evaluation order of a function makeSum in haskell", "body": "<p>I am a Haskell newbie and i am looking at evaluation order as part of my lectures of University. I have an example that i can't quite work out.\nI know that Haskell uses lazy evaluation and that it evaluates outermost, leftmost.\nIn this case i think it is the function itself that i don't understand.</p>\n\n<p>c) Show all the steps in the evaluation of makeSum [3, 2, 7], using the following de\ufb01nition of makeSum and foldr1. </p>\n\n<pre><code>makeSum [] = 0\nmakeSum xs = foldr1 add xs\nwhere\nadd x y = x + y\n\nfoldr1 f [x] = x\nfoldr1 f (x:xs) = f x (foldr1 f xs)\n</code></pre>\n\n<p>I get that foldr1 takes a function and a list and if the list contains one element it returns the element and if the list is longer it applies the function to the first and the rest of the elements.</p>\n\n<p>makeSum takes an empty list and returns zero and here is where i get confused. If it has a case where it takes an empty list shouldn't the recursive call look like this:</p>\n\n<pre><code>makeSum (x:xs) = foldr1 add xs\n</code></pre>\n\n<p>rather than this:</p>\n\n<pre><code>makeSum xs = foldr1 add xs\n</code></pre>\n\n<p>From what i am getting makeSum takes a list and adds the elements in it together?</p>\n\n<p>How do i evaluate this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 378, "user_id": 7785984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CgfJB.jpg?s=128&g=1", "display_name": "Arno C", "link": "https://stackoverflow.com/users/7785984/arno-c"}, "edited": false, "score": 1, "creation_date": 1514964101, "post_id": 48072774, "comment_id": 83119338, "body": "Are you sure you are importing correctly / have saved your file before importing? Both functions work fine here. <code>*Main&gt; evenOdd 202</code> gives  <code>1</code> and <code>*Main&gt; fib 21</code> gives  <code>17711</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514964840, "post_id": 48072774, "comment_id": 83119647, "body": "<a href=\"https://ideone.com/mbH1pC\" rel=\"nofollow noreferrer\">Not reproducible</a>, voting to close."}, {"owner": {"reputation": 103, "user_id": 9166915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b81d336175687db9dbd9f28d7e788?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Besson", "link": "https://stackoverflow.com/users/9166915/marc-besson"}, "edited": false, "score": 0, "creation_date": 1514964909, "post_id": 48072774, "comment_id": 83119676, "body": "Unfortunately, I&#39;m still getting the error, when I use :l and the filename (and GHCi says that the file loaded correctly)."}, {"owner": {"reputation": 378, "user_id": 7785984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CgfJB.jpg?s=128&g=1", "display_name": "Arno C", "link": "https://stackoverflow.com/users/7785984/arno-c"}, "edited": false, "score": 0, "creation_date": 1514965197, "post_id": 48072774, "comment_id": 83119778, "body": "You could try and <code>:edit filename.hs</code> to check if you are actually loading the right file. Maybe you are in the wrong directory / loading up an old version / didn&#39;t save properly."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1514970954, "post_id": 48072774, "comment_id": 83122259, "body": "Unrelated, but: <code>evenOdd n = mod n 2</code>, or <code>evenOdd = (`mod` 2)</code> if you&#39;re zealous about point-free. The <code>if</code>/<code>then</code>/<code>else</code> is unneeded extra work. Of course, the wasted/duplicated work in <code>fib</code> and <code>sumFib</code> is going to dwarf that..."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9166915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b81d336175687db9dbd9f28d7e788?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Besson", "link": "https://stackoverflow.com/users/9166915/marc-besson"}, "edited": false, "score": 0, "creation_date": 1514965618, "post_id": 48073019, "comment_id": 83119944, "body": "Thanks! It ended up being a saving problem."}], "tags": [], "owner": {"reputation": 378, "user_id": 7785984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CgfJB.jpg?s=128&g=1", "display_name": "Arno C", "link": "https://stackoverflow.com/users/7785984/arno-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1514965318, "last_edit_date": 1514965318, "creation_date": 1514964701, "answer_id": 48073019, "question_id": 48072774, "link": "https://stackoverflow.com/questions/48072774/difficulty-with-loading-modules-and-haskell-ghci/48073019#48073019", "title": "Difficulty with loading modules and Haskell GHCi", "body": "<p>On my ghci everything seems to work fine. As you can use fib I'm sure you loaded the file correctly but it seems like you didn't save after adding <code>evenOdd</code> to the file before actually loading.</p>\n\n<p>Try:</p>\n\n<ul>\n<li>Save file first</li>\n<li><code>:l filename.hs</code></li>\n<li><code>evenOdd 10</code></li>\n</ul>\n\n<p>This worked on my device. If for some reason this is still not working, you could try and run a <code>:edit filename.hs</code> to see what file you are actually loading in. Maybe this file is a different one / different version than you expected it to be.</p>\n\n<p>My terminal output:</p>\n\n<pre><code>\u279c  Desktop ls\nPO.pptx     untitled.hs\n\u279c  Desktop ghci\nGHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :l untitled.hs\n[1 of 1] Compiling Main             ( untitled.hs, interpreted )\nOk, 1 module loaded.\n*Main&gt; fib 20\n10946\n*Main&gt; evenOdd 2023\n0\n*Main&gt; evenOdd 2\n1\n*Main&gt; \n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 9166915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b81d336175687db9dbd9f28d7e788?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Besson", "link": "https://stackoverflow.com/users/9166915/marc-besson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 48073019, "answer_count": 1, "score": 0, "last_activity_date": 1514965318, "creation_date": 1514963424, "last_edit_date": 1514964029, "question_id": 48072774, "link": "https://stackoverflow.com/questions/48072774/difficulty-with-loading-modules-and-haskell-ghci", "title": "Difficulty with loading modules and Haskell GHCi", "body": "<p>I've got a text file with the following code:</p>\n\n<pre><code>fib 0 = 1\n\nfib 1 = 1 \n\nfib n = fib (n-1) + fib (n-2)\n\nevenOdd n = if (mod n 2) == 0 then 1 else 0\n\nsumFib 0 = 0\n\nsumFib 1 = 0\n\nsumFib n = (evenOdd (fib n))*(fib n) + sumFib (n-1)\n</code></pre>\n\n<p>Basically, I'm trying to define three functions, where the third relies on the first two. However, when I load this in GHCi, while fib works fine, evenOdd gives me the following error:</p>\n\n<blockquote>\n  <p>interactive>:1:1:1 error:  Variable not in scope: evenOdd :: Integer\n  -> t</p>\n</blockquote>\n\n<p>This confuses me, because if I type that exact line of code into *Main>, evenOdd works fine. How can I get this to work?</p>\n"}, {"tags": ["haskell", "typeclass", "existential-type", "constraint-kinds"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1514950370, "post_id": 48070211, "comment_id": 83115246, "body": "How do you expect the compiler to determine what the constraint <code>cxt</code> is from the type <code>result</code>?"}, {"owner": {"reputation": 3766, "user_id": 167485, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/80c33b5a72595157a2a8a217a7af3e38?s=128&d=identicon&r=PG", "display_name": "Rehno Lindeque", "link": "https://stackoverflow.com/users/167485/rehno-lindeque"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1514952383, "post_id": 48070211, "comment_id": 83115649, "body": "Good point, I was trying to infer the constraints from <code>mkResult</code> but of course there&#39;s no way of doing that. Looking at it now I suppose I was attempting to somehow define <code>data Showable (cxt ~ Show) = forall x. cxt x =&gt; Showable x</code> such that <code>f :: (cxt (), cxt (result cxt)) =&gt; (forall x. cxt x =&gt; x -&gt; result cxt) -&gt; result cxt</code> and infer <code>cxt</code> directly from <code>Showable</code>."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1514956760, "post_id": 48070864, "comment_id": 83116754, "body": "Or <code>f :: forall cxt. (cxt (), cxt result) =&gt; (forall x. cxt x =&gt; x -&gt; result) -&gt; result</code> and then <code>f @Show Showable</code> with <code>-XTypeApplications</code>"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 1, "last_activity_date": 1514951021, "creation_date": 1514951021, "answer_id": 48070864, "question_id": 48070211, "link": "https://stackoverflow.com/questions/48070211/how-to-abstract-constraints-in-function-with-rank-2-type/48070864#48070864", "title": "How to abstract constraints in function with Rank-2 type?", "body": "<p>Your failed attempt works if you provide a way to determine <code>cxt</code></p>\n\n<pre><code>import Data.Proxy\n\nf :: (cxt (), cxt result) =&gt; p cxt -&gt; (forall x. cxt x =&gt; x -&gt; result) -&gt; result\nf _ mkResult = mkResult ()\n\nresultStr :: String\nresultStr = show (f (Proxy :: Proxy Show) Showable)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3766, "user_id": 167485, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/80c33b5a72595157a2a8a217a7af3e38?s=128&d=identicon&r=PG", "display_name": "Rehno Lindeque", "link": "https://stackoverflow.com/users/167485/rehno-lindeque"}, "is_accepted": false, "score": 0, "last_activity_date": 1514958158, "creation_date": 1514958158, "answer_id": 48071793, "question_id": 48070211, "link": "https://stackoverflow.com/questions/48070211/how-to-abstract-constraints-in-function-with-rank-2-type/48071793#48071793", "title": "How to abstract constraints in function with Rank-2 type?", "body": "<p>I apologize for posting my own answer, but this is another alternative I ended up finding:</p>\n\n<pre><code>{-# language ExistentialQuantification, RankNTypes, ConstraintKinds, KindSignatures, TypeFamilies, FlexibleInstances #-}\n\nmodule Experiment3 where\n\nimport GHC.Exts\n\ndata Showable (cxt :: * -&gt; Constraint) = forall x. (cxt ~ Show, cxt x) =&gt; Showable x\ninstance Show (Showable Show) where showsPrec p (Showable x) = showsPrec p x\n\nf :: cxt () =&gt; (forall x. cxt x =&gt; x -&gt; result cxt) -&gt; result cxt\nf mkResult = mkResult ()\n\nresultStr :: String\nresultStr = show (f Showable :: Showable Show)\n</code></pre>\n\n<p>Unfortunately it requires an explicit type signature in <code>show (f Showable)</code> while my goal was to get type inference (or rather, some kind of constraint inference) through <code>Showable</code>. So this answer is not a solution as such, but rather another counter example to what I wanted.</p>\n\n<p>I will accept the answer by Cirdec since it guided me to this conclusion.</p>\n"}], "owner": {"reputation": 3766, "user_id": 167485, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/80c33b5a72595157a2a8a217a7af3e38?s=128&d=identicon&r=PG", "display_name": "Rehno Lindeque", "link": "https://stackoverflow.com/users/167485/rehno-lindeque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 48070864, "answer_count": 2, "score": 1, "last_activity_date": 1514958158, "creation_date": 1514944699, "question_id": 48070211, "link": "https://stackoverflow.com/questions/48070211/how-to-abstract-constraints-in-function-with-rank-2-type", "title": "How to abstract constraints in function with Rank-2 type?", "body": "<p>The following snippet of code borrows from <a href=\"https://wiki.haskell.org/Heterogenous_collections#Existential_types\" rel=\"nofollow noreferrer\">the Haskell wiki</a> to carry around a typeclass dictionary along with an existential type:</p>\n\n<pre><code>{-# language ExistentialQuantification #-}\nmodule Experiment1 where\n\ndata Showable = forall x. Show x =&gt; Showable x\ninstance Show Showable where showsPrec p (Showable x) = showsPrec p x\n\nresultStr :: String\nresultStr = show (Showable ()) -- \"()\"\n</code></pre>\n\n<p>Is it possible to write a function <code>f :: (forall x. x -&gt; result) -&gt; result</code> that is able to take the <code>Showable</code> constructor (or any other data constructor to an existential type) as an argument?</p>\n\n<p>One failed attempt at doing this looks like this:</p>\n\n<pre><code>{-# language ExistentialQuantification, RankNTypes, ConstraintKinds #-}\n\nmodule Experiment2 where\n\n-- import Data.Constraint (Dict(..), withDict)\n\ndata Showable = forall x. Show x =&gt; Showable x\ninstance Show Showable where showsPrec p (Showable x) = showsPrec p x\n\nf :: (cxt (), cxt result) =&gt; (forall x. cxt x =&gt; x -&gt; result) -&gt; result\nf mkResult = mkResult ()\n\nresultStr :: String\nresultStr = show (f Showable)\n</code></pre>\n\n<p>As implied by my commented import above, I have the impression that the <a href=\"http://hackage.haskell.org/package/constraints\" rel=\"nofollow noreferrer\">constraints</a> package might allow me to pass around the necessary proofs, but I can't see how that would work?</p>\n"}, {"tags": ["haskell", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514926615, "post_id": 48067697, "comment_id": 83108955, "body": "What parts have you difficulties with?"}, {"owner": {"reputation": 41, "user_id": 7773522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15d0a2851773674f8ba30e9cbe2368b?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/7773522/michi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514926835, "post_id": 48067697, "comment_id": 83109047, "body": "as i  mentioned before with fibu&#39;, the tupels and the second where"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514926985, "post_id": 48067697, "comment_id": 83109098, "body": "isn&#39;t the last <code>fibu&#39;</code> clause <code>fibu&#39; n = (a + l, l)</code> (with <code>+ l</code> instead of <code>+ 1</code>)."}, {"owner": {"reputation": 41, "user_id": 7773522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15d0a2851773674f8ba30e9cbe2368b?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/7773522/michi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514927148, "post_id": 48067697, "comment_id": 83109171, "body": "oh, my mistake. yup, its a &#39;L&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1514927288, "creation_date": 1514927288, "answer_id": 48067865, "question_id": 48067697, "link": "https://stackoverflow.com/questions/48067697/how-does-this-fibonacci-function-work/48067865#48067865", "title": "How does this Fibonacci function work?", "body": "<p>Let us first analyze</p>\n\n<pre><code>fibu' 0 = (0, 0)\nfibu' 1 = (1, 0)\nfibu' n = (a + l, l)\n    where (l, a) = fibu' (n-1)\n</code></pre>\n\n<p>Here we have a function that takes as input a number <em>i</em>, and returns a 2-tuple with two numbers. The two numbers are <em>(F<sub>i</sub>, F<sub>i-1</sub>)</em> with <em>F<sub>i</sub></em> the <em>i</em>-th Fibonacci number.</p>\n\n<p>The first two numbers (for <em>i = 0</em>, and <em>i = 1</em>) are hardcoded (as <code>(0, 0)</code> and <code>(1, 0)</code>). But of course we can not keep hardcoding Fibonacci values. In case <em>i</em> is not <code>0</code> or <code>1</code>, the last line will be fired. This case is implemented to handle the <code>i-1</code> case.</p>\n\n<p>In that case we recursively calculate <code>fibu' (n-1)</code> (so the tuple that contains <em>(F<sub>n-1</sub>, F<sub>n-2</sub>)</em>, we calculate this in the two previous Fibonacci numbers. We then know that (this is the Fibonacci inductive relation <em>F<sub>n</sub> = F<sub>n-1</sub> + F<sub>n-2</sub></em>). So that means that we can return <code>(a+l, l)</code>. So if we call for instance <code>fibu' 5</code>, it will call <code>fibu' 4</code>, <code>fibu' 3</code>, etc. until we reach <code>fibu' 1</code> and then we will each time construct a new tuple that will keep calculating the last two Fibonacci numbers, until we have reached the Fibonacci numbers with index <code>5</code>.</p>\n\n<p>Now the only problem with <code>fibu'</code> is that it returns a 2-tuple, and a user usually wants to get a simple number (the <em>i</em>-th Fibonacci number). So now we define a function:</p>\n\n<pre><code>fibu :: Integer -Integer\nfibu x = fst (fibu' x)\n</code></pre>\n\n<p>This will return the <em>first</em> item of the 2-tuple (which is the <em>i</em>-th Fibonacci number).</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1514927389, "creation_date": 1514927389, "answer_id": 48067879, "question_id": 48067697, "link": "https://stackoverflow.com/questions/48067697/how-does-this-fibonacci-function-work/48067879#48067879", "title": "How does this Fibonacci function work?", "body": "<p>You may have seen the na&iuml;ve implementation of the Fibonacci sequence:</p>\n\n<pre><code>fibo :: Integer -&gt; Integer\nfibo 0 = 0\nfibo 1 = 1\nfibo n = fibo (n-1) + fibo (n-2)\n</code></pre>\n\n<p>Well, the problem with this is that the function calls itself <em>twice</em>, recursively. And each of these calls calls itself twice again... so you end up with exponentially many calls.</p>\n\n<p>What the implementation you're asking about does to solve this problem: it returns not only the <em>n</em>-th Fibonacci number, but both the <em>n</em>-th and <em>n</em>&minus;1-th. Then the <em>n</em>+1-call only needs <em>one</em> extra invocation, not two, because that one invocation gives it all that's needed to calculate the next element of the sequence.</p>\n\n<p>For the final result, you don't want two numbers but only one though, therefore the penultimate value is discarded using <code>fst</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 7773522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15d0a2851773674f8ba30e9cbe2368b?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/7773522/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1514946932, "accepted_answer_id": 48067865, "answer_count": 2, "score": 0, "last_activity_date": 1514930256, "creation_date": 1514926352, "last_edit_date": 1514930256, "question_id": 48067697, "link": "https://stackoverflow.com/questions/48067697/how-does-this-fibonacci-function-work", "closed_reason": "Needs more focus", "title": "How does this Fibonacci function work?", "body": "<p>Can anybody tell me how the following function works?</p>\n\n<p>Especially the <code>fibu'</code>-thing and the tuples? Thanks!</p>\n\n<pre><code>fibu :: Integer -&gt; Integer\nfibu x = fst (fibu' x)\n      where fibu' 0 = (0, 0)\n            fibu' 1 = (1, 0)\n            fibu' n = (a + l, l)\n                      where (l, a) = fibu' (n-1)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "ghc-mod"], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": true, "score": 1, "last_activity_date": 1514921979, "creation_date": 1514921979, "answer_id": 48066834, "question_id": 48066295, "link": "https://stackoverflow.com/questions/48066295/haskell-stack-install-of-ghc-mod-fails-at-old-time-and-clock/48066834#48066834", "title": "Haskell Stack install of ghc-mod fails at old time and clock", "body": "<p>Are you using arch linux?  Here's the new way to fix this: <a href=\"https://github.com/commercialhaskell/stack/blob/2a715639fe20b5dccb84f6a37ed54d650fdcf119/doc/faq.md#i-get-strange-ld-errors-about-recompiling-with--fpic\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/blob/2a715639fe20b5dccb84f6a37ed54d650fdcf119/doc/faq.md#i-get-strange-ld-errors-about-recompiling-with--fpic</a></p>\n\n<p>Old way to fix this is adding <code>ghc-build: tinfo6</code> to your <code>~/.stack/config.yaml</code>, but that requires downloading and installing ghc again.</p>\n"}], "owner": {"reputation": 3, "user_id": 9165015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G9bFX.png?s=128&g=1", "display_name": "iangrant", "link": "https://stackoverflow.com/users/9165015/iangrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 48066834, "answer_count": 1, "score": 0, "last_activity_date": 1514921979, "creation_date": 1514919359, "question_id": 48066295, "link": "https://stackoverflow.com/questions/48066295/haskell-stack-install-of-ghc-mod-fails-at-old-time-and-clock", "title": "Haskell Stack install of ghc-mod fails at old time and clock", "body": "<p>Installing ghc-mod through stack fails. I've tried all the solutions I found googleing to no avail. I've installed happy and alex. All the other solutions I've found are 1-2 years old and relate to upgrading to GHC 8.</p>\n\n<blockquote>\n  <h2>ERROR OUTPUT</h2>\n  \n  <p>stack install ghc-mod </p>\n  \n  <p>clock-0.7.2: configure</p>\n  \n  <p>clock-0.7.2: build</p>\n  \n  <p>old-time-1.1.0.3: configure</p>\n  \n  <h2>OLDTIME LOG</h2>\n\n<pre><code>--  While building custom Setup.hs for package old-time-1.1.0.3 using:   \n\n/tmp/stack23769/old-time-1.1.0.3/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/setup/setup --builddir=.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0 configure --with-ghc=/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/bin/ghc --with-ghc-pkg=/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/bin/ghc-pkg --user --package-db=clear --package-db=global --package-db=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/pkgdb --libdir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/lib --bindir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/bin --datadir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/share --libexecdir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/libexec --sysconfdir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/etc --docdir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/doc/old-time-1.1.0.3 --htmldir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/doc/old-time-1.1.0.3 --haddockdir=/home/ian/.stack/snapshots/x86_64-linux-tinfo6-nopie/lts-9.18/8.0.2/doc/old-time-1.1.0.3 --dependency=base=base-4.9.1.0 --dependency=old-locale=old-locale-1.0.0.7-KGBP1BSKxH5GCm0LnZP04j\nProcess exited with code: ExitFailure 1\nLogs have been written to: /home/ian/.stack/global-project/.stack-work/logs/old-time-1.1.0.3.log\n\n\n[1 of 2] Compiling Main             ( /tmp/stack23769/old-time-1.1.0.3/Setup.hs, /tmp/stack23769/old-time-1.1.0.3/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/setup/Main.o )\n[2 of 2] Compiling StackSetupShim   ( /home/ian/.stack/setup-exe-src/setup-shim-mPHDZzAJ.hs, /tmp/stack23769/old-time-1.1.0.3/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/setup/StackSetupShim.o )\nLinking /tmp/stack23769/old-time-1.1.0.3/.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/setup/setup ...\nConfiguring old-time-1.1.0.3...\nconfigure: WARNING: unrecognized options: --with-compiler     checking for gcc... /usr/bin/gcc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables...\nchecking whether we are cross compiling... configure: error: in `/tmp/stack23769/old-time-1.1.0.3':\nconfigure: error: cannot run C compiled programs.\nIf you meant to cross compile, use `--host'.\nSee `config.log' for more details\n</code></pre>\n  \n  <h2>Clock Log</h2>\n\n<pre><code>--  While building custom Setup.hs for package clock-0.7.2 using:\n  /home/ian/.stack/setup-exe-cache/x86_64-linux-tinfo6-nopie/Cabal-simple_mPHDZzAJ_1.24.2.0_ghc-8.0.2 --builddir=.stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0 build --ghc-options \" -ddump-hi -ddump-to-file\"\n\nProcess exited with code: ExitFailure 1\n\nLogs have been written to: /home/ian/.stack/global-project/.stack-work/logs/clock-0.7.2.log\n\nConfiguring clock-0.7.2...\nBuilding clock-0.7.2...\nPreprocessing library clock-0.7.2...\n/tmp/stack23769/clock-0.7.2/Clock.hsc:44:0: warning: \"hsc_alignment\" redefined\n/tmp/stack23769/clock-0.7.2/In file included from .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/build/System/Clock_hsc_make.c:1:0:\n/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/template-hsc.h:88:0: note: this is the location of the previous definition\n #define hsc_alignment(t...) \\\n\n/usr/bin/ld: .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/build/System/Clock_hsc_make.o: relocation R_X86_64_32 against `.rodata' can not be used when making a shared object; recompile with -fPIC\n/usr/bin/ld: final link failed: Nonrepresentable section on output\ncollect2: error: ld returned 1 exit status\nlinking .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/build/System/Clock_hsc_make.o failed (exit code 1)\ncommand was: /usr/bin/gcc .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/build/System/Clock_hsc_make.o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/build/System/Clock_hsc_utils.o -o .stack-work/dist/x86_64-linux-tinfo6-nopie/Cabal-1.24.2.0/build/System/Clock_hsc_make -fno-PIE -fno-stack-protector -L/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/base-4.9.1.0 -Wl,-R,/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/base-4.9.1.0 -L/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/integer-gmp-1.0.0.1 -Wl,-R,/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/integer-gmp-1.0.0.1 -lgmp -L/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/ghc-prim-0.5.0.0 -Wl,-R,/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/ghc-prim-0.5.0.0 -L/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/rts -Wl,-R,/home/ian/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/lib/ghc-8.0.2/rts -lm -lrt -ldl -lpthread\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1514917643, "post_id": 48065932, "comment_id": 83105099, "body": "BinaryLiterals is not a type but an extension that lets you type in numbers in binary which then are interpreted as any other number (i.e. <code>fromInteger</code>).  If you simply want to parse binary then you could map <code>digitToInt</code> and <code>zipWith (*) powersOfTwo</code>."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 4, "last_activity_date": 1514919655, "last_edit_date": 1514919655, "creation_date": 1514919341, "answer_id": 48066282, "question_id": 48065932, "link": "https://stackoverflow.com/questions/48065932/how-to-convert-string-to-binaryliterals/48066282#48066282", "title": "How to convert String to BinaryLiterals", "body": "<p>Using <code>readBin</code> from <a href=\"https://stackoverflow.com/a/5922212/126014\">https://stackoverflow.com/a/5922212/126014</a>, you can parse a binary string representation of a number into an <code>Maybe Integral</code> of your choice, e.g.:</p>\n\n<pre><code>*Q48065932&gt; readBin \"11001100\"\nJust 204\n</code></pre>\n\n<p><code>11001100</code> is just the binary representation of the (decimal) integer <code>204</code>. Using <code>BinaryLiterals</code>, you can write that number using binary representation:</p>\n\n<pre><code>*Q48065932&gt; :set -XBinaryLiterals\n*Q48065932&gt; Just 0b11001100\nJust 204\n</code></pre>\n\n<p>If you want the integer to be a particular type (say: <code>Word8</code>), you can do that for both expressions:</p>\n\n<pre><code>*Q48065932 Data.Word&gt; readBin \"11001100\" :: Maybe Word8\nJust 204\n*Q48065932 Data.Word&gt; Just 0b11001100 :: Maybe Word8\nJust 204\n</code></pre>\n\n<p>You can convince yourself that these two expressions have the same value by comparing them:</p>\n\n<pre><code>*Q48065932 Data.Word&gt; readBin \"11001100\" == Just 0b11001100\nTrue\n</code></pre>\n\n<p>You can also write the number <code>204</code> using hexadecimal notation, like this:</p>\n\n<pre><code>*Q48065932 Data.Word&gt; Just 0xCC\nJust 204\n</code></pre>\n\n<p>That's still equal to <code>11001100</code>:</p>\n\n<pre><code>*Q48065932 Data.Word&gt; Just 0xCC == readBin \"11001100\"\nTrue\n*Q48065932 Data.Word&gt; Just 0xCC == Just 204\nTrue\n</code></pre>\n\n<p>All of these expressions are equal to each other because they're the same number (<code>204</code>); they're just different ways to write the same number. The data type used to store that number in memory (<code>Int</code>, <code>Word8</code>, etc.) is independent of how you write the literal numbers.</p>\n"}], "owner": {"reputation": 639, "user_id": 5715485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6cb679baae60c79d57ea33ee91424a96?s=128&d=identicon&r=PG&f=1", "display_name": "limitless", "link": "https://stackoverflow.com/users/5715485/limitless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 48066282, "answer_count": 1, "score": 2, "last_activity_date": 1514919707, "creation_date": 1514917473, "last_edit_date": 1514919707, "question_id": 48065932, "link": "https://stackoverflow.com/questions/48065932/how-to-convert-string-to-binaryliterals", "title": "How to convert String to BinaryLiterals", "body": "<p>Is there anyway to convert <code>String</code> to <code>BinaryLiterals</code> type?</p>\n\n<p>For example <code>\"11001100\"</code> to <code>0b11001100</code></p>\n"}, {"tags": ["haskell", "types", "type-theory"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514914503, "post_id": 48065007, "comment_id": 83103896, "body": "What book are you reading?"}, {"owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514914782, "post_id": 48065007, "comment_id": 83104003, "body": "@WillemVanOnsem some notes in Spanish from my college teacher of declarative programming"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1514920362, "post_id": 48065007, "comment_id": 83106300, "body": "I suspect your teacher means <i>monotonicity</i>, which is rather less of an editorialisation than <i>monotony</i> \ud83d\ude09"}, {"owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1514924318, "post_id": 48065007, "comment_id": 83107955, "body": "@BenjaminHodgson ups, now fixed!"}], "answers": [{"comments": [{"owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "edited": false, "score": 0, "creation_date": 1514915405, "post_id": 48065382, "comment_id": 83104241, "body": "This has been useful for me to read, but I want to stress that I am looking for practical examples in day to day programming."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1514930186, "post_id": 48065382, "comment_id": 83110341, "body": "It&#39;s not a technique you actively use; it&#39;s just a concept to help describe the underlying semantics of your code. Practically speaking, you want to avoid <code>undefined</code> as much as possible."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "edited": false, "score": 1, "creation_date": 1514986696, "post_id": 48065382, "comment_id": 83130866, "body": "@Jsevillamol It has not frequent applications. Perhaps a small one is: after you test <code>length [undefined, undefined] == 2</code> there is no need to also test <code>length [1,2] == 2</code> and <code>length [4,-4] == 2</code> etc. since they must be <code>==2</code> by monotonicity. If the first test passes, the other must have the same result. It&#39;s more a technique for <i>reasoning</i> about code (e.g. proving properties on the code) rather than for practical <i>programming</i>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1514914536, "creation_date": 1514914536, "answer_id": 48065382, "question_id": 48065007, "link": "https://stackoverflow.com/questions/48065007/monotonicity-of-evaluation-in-haskell/48065382#48065382", "title": "Monotonicity of evaluation in Haskell", "body": "<p>Since <code>undefined &lt;= 4</code>, by monotonicity we can conclude <code>undefined + 12 &lt;= 4 + 12</code>. Indeed, the former is <code>undefined</code>, while the latter is <code>16</code>. We also have <code>[undefined] &lt;= [4]</code>, or more in general <code>f undefined &lt;= f 4</code>.</p>\n\n<p>The intuition is this: assume <code>f :: Int -&gt; T</code>. When <code>f x</code> is called, either <code>f</code> demands the integer argument <code>x</code> or it does not. If it does, <code>f undefined</code> will be undefined (crash / exception / non termination), so <code>f 4</code> will surely be <code>&gt;=</code> than. If it does not demand <code>x</code>, then <code>f undefined = f 4 = f x</code> for any <code>x</code>, so <code>&lt;=</code> holds again, trivially.</p>\n\n<p>Things become more complex with more complex types. If <code>g :: (Int,Int) -&gt; T</code> we have</p>\n\n<pre><code>g undefined\n&lt;= g (undefined, undefined)\n&lt;= g (undefined, 2)\n&lt;= g (3, 2)\n</code></pre>\n\n<p>The very rough idea behind monotonicity is: if we pass a function a more defined argument, we get a more defined (or equally defined) result. Or more bluntly: less crashing input, less crashing output.</p>\n"}], "owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 48065382, "answer_count": 1, "score": 1, "last_activity_date": 1614024190, "creation_date": 1514912682, "last_edit_date": 1614024190, "question_id": 48065007, "link": "https://stackoverflow.com/questions/48065007/monotonicity-of-evaluation-in-haskell", "title": "Monotonicity of evaluation in Haskell", "body": "<blockquote>\n  <p>Let <code>&lt;</code> denote the semantic approximation order in Haskell.</p>\n  \n  <p>Then the <em>monotonicity of evaluation</em> guarantees that if <code>e1 &lt; e2</code> then\n  <code>[[e1]] &lt; [[e2]]</code>, where <code>e1</code>, <code>e2</code> are expressions and <code>[[e1]]</code>\n  denotes the evaluation of <code>e1</code>.</p>\n</blockquote>\n\n<p>In the notes I am following this is noted as a very useful property to reason about Haskell programs, but there are no examples given.</p>\n\n<p>Can somebody give me one example of such reasoning?</p>\n"}, {"tags": ["haskell", "bitwise-operators"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1514912818, "post_id": 48065001, "comment_id": 83103213, "body": "Binary data? Like a stream of <code>Word8</code>? A <code>ByteString</code>?"}, {"owner": {"reputation": 639, "user_id": 5715485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6cb679baae60c79d57ea33ee91424a96?s=128&d=identicon&r=PG&f=1", "display_name": "limitless", "link": "https://stackoverflow.com/users/5715485/limitless"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1514913306, "post_id": 48065001, "comment_id": 83103405, "body": "Well im not sure. Im tring to implement &quot;sha256&quot; function so Im getting <code>String</code> of text as input and immediately conveting it to the representing binary text. so now it is <code>String</code>."}], "answers": [{"comments": [{"owner": {"reputation": 639, "user_id": 5715485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6cb679baae60c79d57ea33ee91424a96?s=128&d=identicon&r=PG&f=1", "display_name": "limitless", "link": "https://stackoverflow.com/users/5715485/limitless"}, "edited": false, "score": 0, "creation_date": 1514914046, "post_id": 48065159, "comment_id": 83103711, "body": "Thank you. one small thing, giving string <code>&quot;11111111&quot;</code> representation how do you convert to <code>0b11111111</code> <code>BinaryLiterals</code> type?"}, {"owner": {"reputation": 639, "user_id": 5715485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6cb679baae60c79d57ea33ee91424a96?s=128&d=identicon&r=PG&f=1", "display_name": "limitless", "link": "https://stackoverflow.com/users/5715485/limitless"}, "edited": false, "score": 0, "creation_date": 1514916764, "post_id": 48065159, "comment_id": 83104753, "body": "But he is converting to the representing integer. I think I missed how to change it to convert to the <code>0bXXX</code> type we talked about."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 639, "user_id": 5715485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6cb679baae60c79d57ea33ee91424a96?s=128&d=identicon&r=PG&f=1", "display_name": "limitless", "link": "https://stackoverflow.com/users/5715485/limitless"}, "edited": false, "score": 1, "creation_date": 1514918566, "post_id": 48065159, "comment_id": 83105516, "body": "@limitless An expression like <code>0b101010</code> isn&#39;t a data type; it&#39;s a representation. It&#39;s just a way to write the number <code>42</code>. If you go <code>0b101010 :: Int8</code> it&#39;s <code>42</code> as an <code>Int8</code>. If you go <code>0b101010 :: Word64</code>, it&#39;s <code>42</code> as a <code>Word64</code>. You can also represent <code>42</code> a hexadecimal number, like this: <code>0x2a :: Word64</code>. It&#39;s still <code>42</code> as a <code>Word64</code>; it&#39;s just two different ways of writing it."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 4, "last_activity_date": 1514913427, "creation_date": 1514913427, "answer_id": 48065159, "question_id": 48065001, "link": "https://stackoverflow.com/questions/48065001/data-bits-operation-on-binary-represention/48065159#48065159", "title": "Data.Bits operation on binary represention", "body": "<p>As written, <code>ch</code> will only take <code>Int8</code> values, but you can relax the type of the function without changing its implementation:</p>\n\n<pre><code>import Data.Bits\n\nch :: Bits a =&gt; a -&gt; a -&gt; a -&gt; a\nch x y z = (x .&amp;. y) `xor` (complement x .|. z)\n</code></pre>\n\n<p>Binary values are just particular representations of integers, but to make things more readable, you can enable <code>BinaryLiterals</code>, e.g. like this in GHCi:</p>\n\n<pre><code>*Q48065001&gt; :set -XBinaryLiterals\n*Q48065001&gt; ch 0b11111111 0b101110011 0b10110101\n-58\n</code></pre>\n\n<p>In a code file, you can enable that with a language pragma:</p>\n\n<pre><code>{-# LANGUAGE BinaryLiterals #-}\n</code></pre>\n\n<hr>\n\n<p>If you have string representation of binary numbers, you'll first need to parse those. See e.g. <a href=\"https://stackoverflow.com/q/5921573/126014\">Convert a string representing a binary number to a base 10 string haskell</a></p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1514938844, "last_edit_date": 1514938844, "creation_date": 1514935629, "answer_id": 48069237, "question_id": 48065001, "link": "https://stackoverflow.com/questions/48065001/data-bits-operation-on-binary-represention/48069237#48069237", "title": "Data.Bits operation on binary represention", "body": "<p>A good choice for I/O on binary data is <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString-Lazy.html\" rel=\"nofollow noreferrer\"><code>Data.ByteString.Lazy</code></a>, a highly-optimized library for reading <code>Word8</code> values.  It includes analogues for most of the list and I/O functions in the <code>Prelude</code> and in <code>Data.List</code>, and is well-suited for efficient interactive I/O because it reads bytes in and can write them out as a lazily-evaluated list of strict arrays.  It also has efficient functions to convert to and from various encodings.  See also <a href=\"https://wiki.haskell.org/Dealing_with_binary_data\" rel=\"nofollow noreferrer\">this tutorial</a>.</p>\n"}], "owner": {"reputation": 639, "user_id": 5715485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6cb679baae60c79d57ea33ee91424a96?s=128&d=identicon&r=PG&f=1", "display_name": "limitless", "link": "https://stackoverflow.com/users/5715485/limitless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 1, "accepted_answer_id": 48065159, "answer_count": 2, "score": 2, "last_activity_date": 1514938844, "creation_date": 1514912674, "last_edit_date": 1514913486, "question_id": 48065001, "link": "https://stackoverflow.com/questions/48065001/data-bits-operation-on-binary-represention", "title": "Data.Bits operation on binary represention", "body": "<p>I want to use Data.Bits bitwise operators on a binary data.\nWhat data type I need to use? \nI wrote this function for example : </p>\n\n<pre><code>ch :: Int8 -&gt; Int8 -&gt; Int8 -&gt; Int8\nch x y z = (x .&amp;. y) `xor` ((complement x) .|. z)\n</code></pre>\n\n<p>I want to get as input binary type or at least <code>String</code> (not <code>Int</code>) but still use Data.Bits</p>\n\n<p>So what I need to change to use it like this for example? :\n<code>ch 11111111 101110011 10110101</code></p>\n"}, {"tags": ["list", "haskell", "playing-cards"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1514908374, "post_id": 48063879, "comment_id": 83100805, "body": "Shouldn&#39;t this be <code>x &lt;= &#39;9&#39;</code>, instead of <code>x &lt; 9</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1514908696, "creation_date": 1514908696, "answer_id": 48064022, "question_id": 48063879, "link": "https://stackoverflow.com/questions/48063879/haskell-function-with-deck-of-playing-cards-returning-value-of-hand/48064022#48064022", "title": "Haskell function with deck of playing cards (returning value of hand)", "body": "<p>First of all I think you can make the code more elegantly, by introducing a <em>new</em> function:</p>\n\n<pre><code>score :: PlayingCardValue -&gt; Int\nscore '2' = 2\nscore '3' = 3\nscore '4' = 4\nscore '5' = 5\nscore '6' = 6\nscore '7' = 7\nscore '8' = 8\nscore '9' = 9\nscore 'T' = 10\nscore 'J' = 10\nscore 'Q' = 10\nscore 'K' = 10\nscore 'A' = 11\nscore _ = 0\n</code></pre>\n\n<p>So now we can calculate the score of an individual card. We can use the <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Char.html#v:digitToInt\" rel=\"noreferrer\"><strong><code>digitToInt :: Char -&gt; Int</code></strong></a> function if we want. It is also more clean how the score of a single card is calculated.</p>\n\n<p>Next we can use recursion with:</p>\n\n<pre><code>scoreHand :: [PlayingCardValue] -&gt; Int\nscoreHand [] = 0\nscoreHand (x:xs) = score x + scoreHand xs\n</code></pre>\n\n<p>If we want to write a non-recursive one, we can make use of <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:map\" rel=\"noreferrer\"><strong><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code></strong></a>, and <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:sum\" rel=\"noreferrer\"><strong><code>sum :: Num a =&gt; [a] -&gt; a</code></strong></a>:</p>\n\n<pre><code>scoreHand :: [PlayingCardValue] -&gt; Int\nscoreHand xs = sum (map score xs)\n</code></pre>\n\n<p>So by using <code>map score xs</code>, we create a new list, where for each card in the list <code>xs</code>, we have an element that contains the score, and then we <code>sum</code> up these values. We can write it more elegantly, by using function composition:</p>\n\n<pre><code>scoreHand :: [PlayingCardValue] -&gt; Int\nscoreHand = sum . map score\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 9164468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RqJYd.jpg?s=128&g=1", "display_name": "Stefani Dimitrova", "link": "https://stackoverflow.com/users/9164468/stefani-dimitrova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 48064022, "answer_count": 1, "score": 2, "last_activity_date": 1514908752, "creation_date": 1514908156, "last_edit_date": 1514908752, "question_id": 48063879, "link": "https://stackoverflow.com/questions/48063879/haskell-function-with-deck-of-playing-cards-returning-value-of-hand", "title": "Haskell function with deck of playing cards (returning value of hand)", "body": "<p>i am in revision week and i am trying to work on a past paper for Haskell exam. However, this function is something i can't quite cope with.</p>\n\n<p>The values of playing cards are represented like this:\n  \u20192\u2019, \u20193\u2019, \u20194\u2019, \u20195\u2019, \u20196\u2019, \u20197\u2019, \u20198\u2019, \u20199\u2019, \u2019T\u2019, \u2019J\u2019, \u2019Q\u2019, \u2019K\u2019, \u2019A\u2019.\n A hand of cards can be written as a String, for example \u201cA563Q\u201d. </p>\n\n<p>I need to to write a function \nscoreHand :: [PlayingCardValue] -> Int\nthat will return the total value held in a hand of cards. \u2019A\u2019 has a value of 11. \u2019T\u2019, \u2019J\u2019, \u2019Q\u2019 and \u2019K\u2019 each have a value of 10. The other numbers have their face value (\u20192\u2019 has a value of 2, \u20193\u2019 has a value of 3 and so on).</p>\n\n<p>So i am supposed to write two versions of this function. <strong>First one</strong> using recursion and no library functions or list comprehension and <strong>second one</strong> the other way around (a.k.a) using list comprehension, library functions etc.</p>\n\n<p><strong>I wrote the version with recursion, but i am struggling with the other \nversion.</strong></p>\n\n<p>Here is my code with recursion (even though i'm using one library function, but i will figure it out eventually)</p>\n\n<p>*</p>\n\n<pre><code>import Data.Char\ntype PlayingCardValue = Char\nscoreHand :: [PlayingCardValue] -&gt; Int\nscoreHand [] = 0\nscoreHand (x:xs) =\n  if x &gt; '1' &amp;&amp; x &lt; '9'\n    then digitToInt x + scoreHand (xs)\n    else if x == 'T' || x == 'J' || x == 'Q' || x == 'K'\n      then 10 + scoreHand (xs)\n        else if x == 'A'\n          then 11 + scoreHand (xs)\n          else 0 + scoreHand (xs)\n</code></pre>\n\n<p>*\nAny ideas on how to create the same function not using recursion?</p>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 4, "creation_date": 1514883785, "post_id": 48058053, "comment_id": 83088384, "body": "<code>f (g a)</code> is a nested functor. But what you have is two separate, unrelated functors. You&#39;ll have to convert one to the other."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514883950, "post_id": 48058053, "comment_id": 83088450, "body": "It depends on what you want to get. A list of maybes?"}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1514884045, "post_id": 48058053, "comment_id": 83088491, "body": "Or a maybe list, doesn&#39;t really matter, see my edit"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514884520, "post_id": 48058053, "comment_id": 83088715, "body": "If you want to map a list to a list, you can use just its <code>Functor</code> instance, it doesn&#39;t have to be an <code>Applicative</code>. Thus you want a <code>fmap</code> on the list side, not a <code>&lt;*&gt;</code>. You also want to insert <code>pure</code> in there somewhere to get <code>Just Integer</code> from <code>Integer</code>. <code>fmap ((&lt;*&gt;) (Just (+5)) . pure) [1,2,3]</code> does the job."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514884829, "post_id": 48058053, "comment_id": 83088868, "body": "Another option would be to convert a Maybe to a List (this is specific to these types and cannot be generalised to any Applicative): <code>(maybeToList (Just (+ 5))) &lt;*&gt; [1,2,3]</code>."}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1514885046, "post_id": 48058053, "comment_id": 83088979, "body": "While this works, in the end I want it general enough to apply <code>f (g (a -&gt; b)</code> to <code>f (g a)</code>. And I don&#39;t see how I get there from this"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514886314, "post_id": 48058053, "comment_id": 83089541, "body": "If you want to apply <code>f (g (a -&gt; b)</code> to <code>f (g a)</code> you may want to give a better example of it in the question. <code>Just (+5)</code> and <code>[1,2,3]</code> are not of these types."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514888684, "post_id": 48058053, "comment_id": 83090650, "body": "<a href=\"https://ideone.com/o1KI3u\" rel=\"nofollow noreferrer\">ideone.com/o1KI3u</a>"}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514888949, "post_id": 48058053, "comment_id": 83090778, "body": "@n.m. My first edit gives you <code>f (g a)</code> from those. But the function that you provided is just what I looked for."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514889909, "post_id": 48058053, "comment_id": 83091255, "body": "This is basically just <code>(&lt;*&gt;) . fmap (&lt;*&gt;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1514890579, "creation_date": 1514890579, "answer_id": 48059679, "question_id": 48058053, "link": "https://stackoverflow.com/questions/48058053/fmap-fmap-for-applicative/48059679#48059679", "title": "(fmap.fmap) for Applicative", "body": "<p>We have a <code>f (g (a-&gt;b))</code>. To get <code>g a -&gt; g b</code> from <code>g (a-&gt;b)</code> we just need <code>&lt;*&gt;</code>, but <code>g (a-&gt;b)</code> is wrapped in <code>f</code>. Luckily <code>f</code> is a Functor so we can <code>fmap</code> over it.</p>\n\n<pre><code>Prelude&gt; :t fmap (&lt;*&gt;)\nfmap (&lt;*&gt;)\n  :: (Functor f1, Applicative f) =&gt;\n     f1 (f (a -&gt; b)) -&gt; f1 (f a -&gt; f b)\nPrelude&gt;\n</code></pre>\n\n<p>That's better, we have a function wrapped in a Functor now. If this Functor happens to be an Applicative, we can apply <code>&lt;*&gt;</code> through it.</p>\n\n<pre><code>Prelude&gt; :t (&lt;*&gt;) . fmap (&lt;*&gt;)\n(&lt;*&gt;) . fmap (&lt;*&gt;)\n  :: (Applicative f, Applicative f1) =&gt;\n     f1 (f (a -&gt; b)) -&gt; f1 (f a) -&gt; f1 (f b)\nPrelude&gt;\n</code></pre>\n\n<p>Just what the doctor ordered. </p>\n\n<pre><code>Prelude&gt; let (&lt;***&gt;) = (&lt;*&gt;) . fmap (&lt;*&gt;)\nPrelude&gt; [Just (+2), Just (*3), Nothing] &lt;***&gt; [Just 7, Just 42, Nothing]\n[Just 9,Just 44,Nothing,Just 21,Just 126,Nothing,Nothing,Nothing,Nothing]\nPrelude&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 4, "last_activity_date": 1514890774, "creation_date": 1514890774, "answer_id": 48059733, "question_id": 48058053, "link": "https://stackoverflow.com/questions/48058053/fmap-fmap-for-applicative/48059733#48059733", "title": "(fmap.fmap) for Applicative", "body": "<p><code>liftA2</code> has a similar compositional property as <code>fmap</code>.</p>\n\n<pre><code>liftA2 f            ::    f a  -&gt;    f b  -&gt;    f c\n(liftA2 . liftA2) f :: g (f a) -&gt; g (f b) -&gt; g (f c)\n</code></pre>\n\n<p>So you can write</p>\n\n<pre><code>(liftA2 . liftA2) ($) (pure (Just (+5))) (fmap pure [1,2,3]) :: [Maybe Integer]\n</code></pre>\n\n<p>i.e., <code>(&lt;***&gt;) = (liftA2 . liftA2) ($)</code>. (much like <code>(&lt;*&gt;) = liftA2 ($)</code>)</p>\n\n<hr>\n\n<p>Another way to look at it is that the composition of applicative functors is an applicative functors, this is made concrete by <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Functor-Compose.html\" rel=\"nofollow noreferrer\"><code>Data.Functor.Compose</code></a>:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, PartialTypeSignatures #-}\n\nimport Data.Functor.Compose\nimport Data.Coerce\n\n(&lt;***&gt;) :: forall f g a b. (Applicative f, Applicative g)\n        =&gt; f (g (a -&gt; b)) -&gt; f (g a) -&gt; f (g b)\n(&lt;***&gt;) = coerce ((&lt;*&gt;) :: Compose f g (a -&gt; b) -&gt; _)\n</code></pre>\n\n<p>The point with <code>coerce</code> is to show that <code>(&lt;***&gt;)</code> <em>is</em> the applicative <code>(&lt;*&gt;)</code> for the right type; we can also do the unwrapping manually</p>\n\n<pre><code>f &lt;***&gt; x = getCompose $ Compose f &lt;*&gt; Compose x\n</code></pre>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1514890774, "creation_date": 1514883302, "last_edit_date": 1514886482, "question_id": 48058053, "link": "https://stackoverflow.com/questions/48058053/fmap-fmap-for-applicative", "title": "(fmap.fmap) for Applicative", "body": "<p><code>fmap.fmap</code> allows us to go \"two layers deep\" into a functor:</p>\n\n<pre><code>fmap.fmap :: (a -&gt; b) -&gt; f (g a) -&gt; f (g b)\n</code></pre>\n\n<p>Is this also possible for applicative functors? Let's say I wanted to combine <code>Just (+5)</code> and <code>[1,2,3]</code> by using their applicative properties. I can think of an obvious way to do it, but it doesn't seem that trivial to me.</p>\n\n<p><code>(&lt;*&gt;).(&lt;*&gt;)</code> doesn't a have a conclusive type signature:</p>\n\n<pre><code>((&lt;*&gt;).(&lt;*&gt;)) :: (a1 -&gt; a2 -&gt; b) -&gt; ((a1 -&gt; a2) -&gt; a1) -&gt; (a1 -&gt; a2) -&gt; b\n-- where I would expect something like:\n-- ((&lt;*&gt;).(&lt;*&gt;)) :: f (g (a -&gt; b)) -&gt; f (g a) -&gt; f (g b)\n</code></pre>\n\n<p>Is it possible to compose <code>Just (+5)</code> and <code>[1,2,3]</code> in this fashion?</p>\n\n<p>EDIT:</p>\n\n<p>The first step would be to go with either:</p>\n\n<ul>\n<li><code>pure $ Just (+5)</code> and <code>fmap pure [1,2,3]</code>, or</li>\n<li><code>fmap pure (Just (+5)</code> and <code>pure [1,2,3]</code></li>\n</ul>\n\n<p>But I still don't how to compose these...</p>\n\n<p>EDIT:</p>\n\n<p>It would be nice to have a general way to compose a function <code>f (g (a -&gt; b)</code> and <code>f (g a)</code>, I'm not just looking for a solution for the above case, which is just supposed to serve as an example input of such a function. Basically I want a function:</p>\n\n<pre><code>(&lt;***&gt;) :: f (g (a -&gt; b)) -&gt; f (g a) -&gt; f (g b)\n</code></pre>\n"}, {"tags": ["haskell", "types", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1514899831, "post_id": 48056733, "comment_id": 83096286, "body": "Wouldn&#39;t that be an <i>integer</i> literal is translated to <code>fromInteger n</code>? <code>partialSum = sum 2.5</code> would be interpreted slightly differently."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 7, "last_activity_date": 1514876021, "creation_date": 1514876021, "answer_id": 48056733, "question_id": 48056655, "link": "https://stackoverflow.com/questions/48056655/haskell-how-is-num-held/48056733#48056733", "title": "Haskell: How is Num held?", "body": "<p>The answer can be broken down in two components:</p>\n\n<ul>\n<li><p>Typeclass constraints get elaborated as records and they're automatically passed around whenever needed.</p></li>\n<li><p>A numeric literal <code>n</code> is translated to <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:fromInteger\" rel=\"noreferrer\"><code>fromInteger n</code></a></p></li>\n</ul>\n\n<p>So</p>\n\n<pre><code>sum :: Num a =&gt; a -&gt; a -&gt; a\nsum a b = a + b\n</code></pre>\n\n<p>would become:</p>\n\n<pre><code>sum' :: RecordNum a -&gt; a -&gt; a -&gt; a\nsum' dict a b = (plus dict) a b\n</code></pre>\n\n<p>where</p>\n\n<pre><code>data RecordNum a = RecordNum\n    { plus :: a -&gt; a -&gt; a\n    ; mult :: a -&gt; a -&gt; a\n    (...)\n    ; fromInteger :: Integer -&gt; a\n    }\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>partialSum :: Num a =&gt; a -&gt; a\npartialSum = sum 1\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>partialSum' :: RecordNum a -&gt; a -&gt; a\npartialSum' dict = sum' dict (fromInteger dict 1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "edited": false, "score": 0, "creation_date": 1514891337, "post_id": 48056734, "comment_id": 83091993, "body": "I was wondering if fromIntegral is the only way and only hence only Integer can be used in the above manner. So for example this does not work:``` let f = 1::Float let d = 2::Double let sum Num::a=&gt; a-&gt;a-&gt;a; sum a b = a+b let partialSum = sum f partialSum d``` leads to error"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "edited": false, "score": 0, "creation_date": 1514904060, "post_id": 48056734, "comment_id": 83098509, "body": "@Ngm You can naturally ensure the literal be of a certain type by adding a type annotation, although unless you force it to WNHF, you have no guarantees an actual literal of that type will be stored at that point. Also worth noting that unboxed literals like <code>1#</code> and <code>1.0#</code> exist (they map more closely onto value types from other languages, but are used less frequently by Haskell beginners)."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 7, "last_activity_date": 1514876036, "creation_date": 1514876036, "answer_id": 48056734, "question_id": 48056655, "link": "https://stackoverflow.com/questions/48056655/haskell-how-is-num-held/48056734#48056734", "title": "Haskell: How is Num held?", "body": "<blockquote>\n  <p>But at this point <code>let partialSum = sum 1</code> GHCi has to hold 1 in memory</p>\n</blockquote>\n\n<p>Sure, but remember that Haskell number literals are overloaded. In this case, <code>1</code> gets stored as <code>fromInteger (1 :: Integer) :: Num a =&gt; a</code>. <code>partialSum</code> holds onto this until it knows what <code>a</code> should be. GHCi holds onto only <code>1</code> the <code>Integer</code>.</p>\n"}], "owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 48056734, "answer_count": 2, "score": 3, "last_activity_date": 1514876036, "creation_date": 1514875553, "question_id": 48056655, "link": "https://stackoverflow.com/questions/48056655/haskell-how-is-num-held", "title": "Haskell: How is Num held?", "body": "<p>In the following example:</p>\n\n<pre><code>&gt; let sum::Num a=&gt; a-&gt;a-&gt;a; sum a b = a +b\n&gt; let partialSum = sum 1\n&gt; partialSum 2.0\n3.0\n</code></pre>\n\n<p>In step <code>let partialSum = sum 1</code> it would appear that a is interpreted as Integer but I suppose Haskell delays this until it can figure out the type (and consequently which typeclass instance to use) until the whole expression is built.\nWe can interpret this because the ultimate result is Fractional (3.0)</p>\n\n<p>But at this point <code>let partialSum = sum 1</code> GHCI has to hold <code>1</code>  in memory, I was wondering what does it hold it as? </p>\n"}, {"tags": ["haskell", "types", "ghc", "ghci"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1514868876, "post_id": 48055640, "comment_id": 83083695, "body": "LYAH must be pretty outdated - in the couple of years I&#39;ve known/used Haskell, I&#39;ve never even heard of <code>Error</code> having been used in GHCi. Anyone know the history behind this?"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 7, "last_activity_date": 1514868692, "creation_date": 1514868692, "answer_id": 48055729, "question_id": 48055640, "link": "https://stackoverflow.com/questions/48055640/why-doesnt-ghci-provide-the-expected-ambiguous-type-variable-error-in-this-scen/48055729#48055729", "title": "Why doesn&#39;t ghci provide the expected Ambiguous type variable error in this scenario?", "body": "<p>This is due to <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghc-flag--XExtendedDefaultRules\" rel=\"noreferrer\"><code>-XExtendedDefaultRules</code></a> being now enabled by default in GHCi. To turn it off (and get your expected error message):</p>\n\n<pre><code>ghci&gt; :set -XNoExtendedDefaultRules\nghci&gt; Right 3 &gt;&gt;= \\x -&gt; return (x + 100)\n&lt;interactive&gt;:2:1: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018print\u2019\n      prevents the constraint \u2018(Show a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance (Show b, Show a) =&gt; Show (Either a b)\n          -- Defined in \u2018Data.Either\u2019\n        instance Show Ordering -- Defined in \u2018GHC.Show\u2019\n        instance Show Integer -- Defined in \u2018GHC.Show\u2019\n        ...plus 23 others\n        ...plus 11 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>This extension adds a bunch of extra ways to default otherwise ambiguous code. In your case, you have an expression of type <code>Num b =&gt; Either a b</code>. <a href=\"https://www.haskell.org/onlinereport/decls.html#sect4.3.4\" rel=\"noreferrer\">Regular Haskell defaulting rules</a> tell us the <code>b</code> should default to <code>Integer</code>. The extended rules (see the link above) additionally default <code>a</code> to <code>()</code>.</p>\n"}], "owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 48055729, "answer_count": 1, "score": 7, "last_activity_date": 1514904130, "creation_date": 1514867910, "last_edit_date": 1514904130, "question_id": 48055640, "link": "https://stackoverflow.com/questions/48055640/why-doesnt-ghci-provide-the-expected-ambiguous-type-variable-error-in-this-scen", "title": "Why doesn&#39;t ghci provide the expected Ambiguous type variable error in this scenario?", "body": "<p>I'm working through <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">a Haskell book</a>. It has the following example:</p>\n\n<pre><code>ghci&gt; Right 3 &gt;&gt;= \\x -&gt; return (x + 100)  \n</code></pre>\n\n<p>It expects that this blows up with this error:</p>\n\n<pre><code>&lt;interactive&gt;:1:0:  \n    Ambiguous type variable `a' in the constraints:  \n      `Error a' arising from a use of `it' at &lt;interactive&gt;:1:0-33  \n      `Show a' arising from a use of `print' at &lt;interactive&gt;:1:0-33  \n    Probable fix: add a type signature that fixes these type variable(s)  \n</code></pre>\n\n<p>When I run it:</p>\n\n<pre><code>$ ghci\n\nPrelude&gt; Right 3 &gt;&gt;= \\x -&gt; return (x + 100) \n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>Right 103\n</code></pre>\n\n<p>ie I don't get the error expected. </p>\n\n<p>Now maybe the compiler or the library has changed - but I'm not sure how to verify that. </p>\n\n<p>My question is: <strong>Why doesn't ghci provide the expected Ambiguous type variable error in this scenario?</strong></p>\n"}, {"tags": ["haskell", "algebraic-data-types", "galois-field"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1514866676, "post_id": 48055285, "comment_id": 83083326, "body": "Not knowing anything about the domain, it looks like <code>poly</code> is what defines an &quot;element&quot;, while the other three fields of <code>GF</code> characterize the &quot;Galois field&quot; per se, is that right? And so it would be an error if those three fields were not consistent between the two arguments of <code>addGF</code>? If that&#39;s right then the traditional approach would be to e.g. make <code>addGF :: GF -&gt; GF -&gt; Maybe GF</code> and return <code>Nothing</code> if the elements can&#39;t be added. If the parameters of the field are always expected to be known at compile time then you have various better options."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1514866807, "post_id": 48055285, "comment_id": 83083345, "body": "I suspect your question is more or less the same as &quot;what&#39;s a good API for vectors&quot;, which is pretty well-trodden territory."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514869638, "post_id": 48055285, "comment_id": 83083883, "body": "Helper functions for modular arithmetic could come in very handy: for example, if you\u2019re computing a large expression such as a fold, it could defer the expensive <code>mod</code>/<code>rem</code> operation until the end, rather than doing it at every step."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514869777, "post_id": 48055285, "comment_id": 83083918, "body": "You also probably want to be able to write slices, such as <code>GF 7</code>, that you can then use with different characteristic polynomials."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514869946, "post_id": 48055285, "comment_id": 83083948, "body": "Depending on your operations, lists might have decent performance if you always walk them from front to back. Otherwise, you might find it better to store arrays. For some algorithms, it\u2019s an advantage to use nested form for polynomials, but perhaps not this one?"}, {"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514872384, "post_id": 48055285, "comment_id": 83084491, "body": "Thanks everyone.  Yes, jberryman you are correct: the &quot;poly&quot; defines the element.  And I take your point about Maybe, as you can&#39;t add elements from different fields.  However, I was intending to leave that until I&#39;d got the basic system sorted out.  Note that I am very much a Haskell beginner - up to about the level of maps and folds (which I&#39;ve used in other systems), but not Monads.  I will also check out vectors (which maybe I should have done before posting)."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514874246, "post_id": 48055285, "comment_id": 83084992, "body": "That\u2019s not a bad implementation of addition at all. Adding the check for the powers would be a simple matter of a pattern guard at the top of the function."}, {"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514897317, "post_id": 48055285, "comment_id": 83095080, "body": "I&#39;ve tried <code>addGF :: GF -&gt; GF -&gt; Maybe GF</code> to get the error message <code>Couldn&#39;t match expected type \u2018Maybe GF\u2019 with actual type \u2018GF\u2019 </code>.  There&#39;s a subtlety here which has confused me..."}], "answers": [{"comments": [{"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514909153, "post_id": 48063737, "comment_id": 83101233, "body": "Many thanks indeed for your detailed solution and discussion!  I had tried doing something similar; except I had a <code>sameField</code> function which meant I could replace the first guard with <code>sameField x y = GF q n zp p</code>.  I&#39;m still getting my head around <code>Maybe</code>: can I use a <code>Just</code> result as input to another function as though the <code>Just</code> wasn&#39;t there?"}, {"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514910129, "post_id": 48063737, "comment_id": 83101791, "body": "Like <code>addGF x $ addGF y z</code> ?  All field operations need to return results which can be used in other results."}, {"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514912216, "post_id": 48063737, "comment_id": 83102907, "body": "I was just thinking: another approach would be comparable to what is done in <code>zipWith (+) [2,3] [1,2,3]</code>: the larger list is simply truncated to be the size of the smaller list.  Similarly <code>addGF x y</code> could be made total by truncating (or otherwise reducing) an element of a larger field to an element of a smaller field."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514924364, "post_id": 48063737, "comment_id": 83107974, "body": "<code>Maybe</code> is just a normal data type like your <code>GF</code>, only with two data constructors (<code>Just</code> and <code>Nothing</code>). Try opening ghci and typing <code>:info Maybe</code>. If you want to inspect a value of type <code>Maybe GF</code> you will need to pattern-match on it (or use a helper function (which is implemented with pattern-matching) like <code>maybe</code>. In ghci try <code>:t maybe</code>)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514933189, "post_id": 48063737, "comment_id": 83111437, "body": "@Alasdair, we often use the <code>Functor</code>, <code>Applicative</code>, and <code>Monad</code> instances of <code>Maybe</code> (and other types) for plumbing things through. They often help limit the syntactic overhead of dealing with partial functions and such. That said, if combining two things is simply an error and should never be done, there&#39;s not much shame in just throwing an error."}, {"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514939424, "post_id": 48063737, "comment_id": 83113120, "body": "I&#39;m still confused with <code>Maybe</code> and <code>Just</code>, since I&#39;d like <code>addGF</code> to be applicable to elements both of type <code>GF</code> and of type <code>Maybe GF</code>.  What would be handy is a version of <code>Maybe</code> that returns simply <code>a</code> rather than <code>Just a</code>.  Unless this is displaying my monumental ignorance of types..."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514956343, "post_id": 48063737, "comment_id": 83116636, "body": "@Alasdair I think if you&#39;re patient with the first couple chapters of a Haskell book these things will be clear"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 2, "last_activity_date": 1514907634, "creation_date": 1514907634, "answer_id": 48063737, "question_id": 48055285, "link": "https://stackoverflow.com/questions/48055285/data-type-for-finite-fields-in-haskell/48063737#48063737", "title": "Data type for finite fields in Haskell?", "body": "<p>I don't think your <code>GF</code> type is ugly or incorrect. The main issue I see is that <code>addGF</code> does not enforce that the elements can actually be added. Instead you could do:</p>\n\n<pre><code>addGF :: GF -&gt; GF -&gt; Maybe GF\naddGF x y -- the pipes below are called \"guards\", a multi-way `if` syntax\n  | q == characteristic y &amp;&amp; n == power y &amp;&amp; p == irreducible y = Just $ GF q n zp p\n  | otherwise = Nothing\n  where\n    q = characteristic x\n    n = power x\n    zp = zipWith (\\i j -&gt; rem (i+j) q) xp yp\n      where\n        xp = poly x\n        yp = poly y\n    p = irreducible x\n</code></pre>\n\n<p>It might be more ergonomic and useful (but not a fundamentally different solution) to separate the notion of a field from its elements, like this:</p>\n\n<pre><code>-- these names are probably not appropriate\ndata Field  \n  = Field { characteristic::Int\n          , power::Int\n          , irreducible::[Int]\n          } deriving(Eq, Show)\n\n-- formerly `GF`:\ndata FieldElement\n  = FieldElement \n          { field::Field\n          , poly::[Int]\n          } deriving(Eq, Show)\n</code></pre>\n\n<p>Then in the guard above, you'd simply need to do e.g.</p>\n\n<pre><code>...\n| field x == field y = Just $ ...\n</code></pre>\n\n<p><code>RecordWildCards</code> is also a nice extension for removing boilerplate when you wish to work with record names.</p>\n\n<p>If you know that you will be working with particular fields with parameters known at compile-time, then you can allow the type-checker to enforce the invariant in <code>addGF</code> for you. One way would be like this:</p>\n\n<pre><code>-- see `Data.Proxy` for info about this idiom\nclass SomeField f where\n   characteristic :: proxy f -&gt; Int\n   power :: proxy f -&gt; Int\n   irreducible :: proxy f -&gt; [Int]\n\n-- A field element is just the polynomial, tagged with its field using the `f` type parameter\n-- you may want to not expose the internals of `GF` but instead expose a \n-- makeGF function which enforces whatever invariants should hold between the parameters\n-- of a field and the polynomial of its element.\nnewtype GF f = GF { poly :: [Int] }\n\n-- `addGF` is no longer partial; the type system enforces that both arguments are elements of the same field\naddGF :: (SomeField f)=&gt; GF f -&gt; GF f -&gt; GF f\naddGF x@(GF xp) (GF yp) = GF $ zipWith (\\i j -&gt; rem (i+j) q) xp yp\n  where q = characteristic x\n</code></pre>\n\n<p>I mentioned \"vectors\" only be cause the problem and various approaches you have open to you here is the same as the one you have with vector arithmetic, in which e.g. only vectors of the same dimension can be added.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514932784, "post_id": 48065086, "comment_id": 83111286, "body": "<code>reflection</code> is another option for making sure the polynomials match. It&#39;s a bit on the conservative side, but you can work around that with a runtime check if necessary. In particular, you can produce a <code>Coercion</code> between two types when you&#39;ve verified they have equal irreducible polynomials."}, {"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1514939188, "post_id": 48065086, "comment_id": 83113066, "body": "Dear @leftaroundabout, thank you very much! - lots of good advice and great ideas.   As for checking irreducibility, there are several options: (1) no checking; leave it to the user, noting that using a non-irreducible polynomial will lead to errors (such as elements not having inverses), (2) download, or provide online access to, a library of known polynomials - since most finite fields are &quot;small&quot; this may work, with the proviso that polynomials not in this library devolve to option (1), and (3) code up a criterion such as given at <a href=\"https://maths-people.anu.edu.au/~brent/pd/ANZMC08t4.pdf\" rel=\"nofollow noreferrer\">maths-people.anu.edu.au/~brent/pd/ANZMC08t4.pdf</a>"}, {"owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1515034588, "post_id": 48065086, "comment_id": 83150915, "body": "I&#39;ve tried this approach, also with advice from jberryman, to try to define <code>data GF = GF {characteristic::Integer, power::Integer , irreducible::[Mod Integer characteristic]} deriving(Eq, Show)</code> except this causes an error, that <code>characteristic</code> is not in scope.  How can I define a variable to be a list of type <code>Mod Integer p</code> where p is the characteristic of the field?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "edited": false, "score": 0, "creation_date": 1515063512, "post_id": 48065086, "comment_id": 83161998, "body": "@Alasdair you can only do that when <code>characteristic</code> lives in the type level, as it does in my examples. (Haskell strongly separates type- and value-level variables, in particular you can never just use a value to influence what type another value should have. Although, <a href=\"https://hackage.haskell.org/package/reflection-2.1.2/docs/Data-Reflection.html\" rel=\"nofollow noreferrer\"><code>reflection</code></a>, as dfeuer mentions, actually manages to do this, through clever higher-rank polymorphism.)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1514913039, "creation_date": 1514913039, "answer_id": 48065086, "question_id": 48055285, "link": "https://stackoverflow.com/questions/48055285/data-type-for-finite-fields-in-haskell/48065086#48065086", "title": "Data type for finite fields in Haskell?", "body": "<p>It is easy enough to lift <code>characteristic</code> and <code>power</code> into the type system in modern Haskell (GHC>=7.8), that is,</p>\n\n<pre><code>{-# LANGUAGE TypeOperators, DataKinds #-}\n{-# LANGUAGE FlexibleContexts, TypeFamilies, UndecidableInstances #-}\n{-# LANGUAGE StandaloneDeriving #-}\n</code></pre>\n\n<p>and express that the coefficients of the polynomials come from the <a href=\"https://hackage.haskell.org/package/modular-arithmetic-1.2.1.2/docs/Data-Modular.html\" rel=\"nofollow noreferrer\">finite group</a> whose size is the characteristic:</p>\n\n<pre><code>import GHC.TypeLits\nimport Data.Modular\n\ndata GF \u03c7 -- characteristic\n        n -- power\n   = GF { irreducible :: [\u2124/\u03c7]\n        , poly :: [\u2124/\u03c7]\n        }\n</code></pre>\n\n<p>This already gives you for free that any additions on polynomials will be modulo <code>\u03c7</code>.</p>\n\n<p>You could <a href=\"https://hackage.haskell.org/package/fixed-vector-1.0.0.0/docs/Data-Vector-Fixed-Boxed.html\" rel=\"nofollow noreferrer\">furthermore express</a> that there are always <code>n + 1</code> coefficients:</p>\n\n<pre><code>import qualified Data.Vector.Fixed as Fix\nimport qualified Data.Vector.Fixed.Boxed as Fix\n\ndata GF \u03c7 n\n   = GF { irreducible :: Fix.Vec (n+1) (\u2124/\u03c7)\n        , poly :: Fix.Vec (n+1) (\u2124/\u03c7)\n        }\nderiving instance (KnownNat \u03c7, Fix.Arity (n+1)) =&gt; Show (GF \u03c7 n)\n\naddGF :: (KnownNat \u03c7, Fix.Arity (n+1))\n           =&gt; GF \u03c7 n -&gt; GF \u03c7 n -&gt; GF \u03c7 n\naddGF (GF irr xp) (GF irr' yp)\n | irr==irr'  = GF irr $ Fix.zipWith (+) xp yp\n | otherwise  = error \"Cannot add elements of finite fields with different irreducible polynomials!\"\n\nmain = print (GF irr (Fix.fromList [0,0,1]) `addGF` GF irr (Fix.fromList [0,1,1])\n               :: GF 2 2)\n where irr = Fix.fromList [1,1,1]\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>GF {irreducible = fromList [1,1,1], poly = fromList [0,1,0]}\n</code></pre>\n\n<p>It's still ugly that we have to runtime-check the irreducible polynomial. While it would in principle be possible to lift that into the type level as well, I'm not sure if that would really work out very well; we're already pushing against the boundaries here of how well Haskell can be used as a dependently-typed language. Perhaps it would be enough to choose for every characteristic and power only once an irreducible polynomial that would always be used?</p>\n"}], "owner": {"reputation": 1178, "user_id": 1568590, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/b6bb720c28219294cf31d0693ed47388?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1568590/alasdair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1514913039, "creation_date": 1514863824, "question_id": 48055285, "link": "https://stackoverflow.com/questions/48055285/data-type-for-finite-fields-in-haskell", "title": "Data type for finite fields in Haskell?", "body": "<p>I'm trying to learn a  bit of Haskell by writing a small set of functions for computations over finite (Galois) fields.  Years ago I wrote the first version of a similar library for the computer algebra system GNU Maxima (<a href=\"https://sourceforge.net/p/maxima/code/ci/master/tree/share/contrib/gf/gf.mac\" rel=\"nofollow noreferrer\">see here</a>) and I thought I'd try the same thing with Haskell.  </p>\n\n<p>However, I'm getting myself all muddled with data types.  For a finite field, you need a base prime q (the <em>characteristic</em> of the field), and a polynomial p(x) which is irreducible modulo q.  If p(x) has degree n, then the order of the field is q^n and its elements are all polynomials (modulo q) with degree n-1 or less.</p>\n\n<p>We can represent polynomials as lists of their coefficients, so that elements of the field are simply lists (or vectors, if you prefer) of elements of Z_q and of length n.  Addition is done component-wise modulo q, and multiplication is done modulo p(x).</p>\n\n<p>I reckon if I can get the data type and addition sorted out the rest will be straightforward.  My first attempt is this:</p>\n\n<pre><code>import Data.List\n\ndata GF = GF {characteristic::Int\n             ,power::Int\n             ,poly::[Int]\n             ,irreducible::[Int]\n             } deriving(Eq, Show)\n</code></pre>\n\n<p>The power element is unnecessary - it is after all simply one less than the length of the irreducible polynomial - but it's a convenience to have it rather than having to compute it.</p>\n\n<p>Then I had my addition function as:</p>\n\n<pre><code>addGF :: GF -&gt; GF -&gt; GF\naddGF x y = GF q n zp p\n  where\n    q = characteristic x\n    n = power x\n    zp = zipWith (\\i j -&gt; rem (i+j) q) xp yp\n      where\n        xp = poly x\n        yp = poly y\n    p = irreducible x\n</code></pre>\n\n<p>This works, but is inelegant, and I'm sure very \"un-Haskell-ish\".  Part of the problem is that I don't know how to decouple the definition (or type) of a Galois field from its elements.</p>\n\n<p>What I need to do is to provide a general type for a field, and on top of that define elements of it.  There are, after all, things I might want to do with a field which are independent of its elements, such as generate a normal basis, find a primitive element, generate a table of logarithms for a primitive element, generate random elements, etc.</p>\n\n<p>So I guess my question is: how do I define a generic type of a Galois field, in such a way that operations on its elements are as natural as possible?</p>\n\n<p>I have read a number of pages about defining data types, classes, etc, and I've no doubt that one of them contains the solution to my problem.  But the more I read the more confused I become.  All I want is for somebody to point me gently but firmly in the right direction.  Thanks!</p>\n"}, {"tags": ["haskell", "pattern-matching"], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 8, "last_activity_date": 1514854609, "creation_date": 1514854609, "answer_id": 48054471, "question_id": 48054454, "link": "https://stackoverflow.com/questions/48054454/function-from-tuple-haskell/48054471#48054471", "title": "Function from tuple - Haskell", "body": "<pre><code>let a b = (5, 6)\n</code></pre>\n\n<p>You are defining a function called <code>a</code>, which takes one argument, called <code>b</code>. This function ignores its argument and returns <code>(5, 6)</code>. I assume you want <code>a</code> and <code>b</code> to be bound, respectively, to <code>5</code> and <code>6</code>, in which case you want the following syntax.</p>\n\n<pre><code>let (a, b) = (5, 6)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1514857714, "post_id": 48054513, "comment_id": 83081802, "body": "You may want to mention that numeric literals can&#39;t have <i>any</i> type, but that they&#39;re actually <code>forall a. Num a =&gt; a</code>, and maybe explain how <code>fromInteger</code> makes this work."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1514858233, "post_id": 48054513, "comment_id": 83081897, "body": "It\u2019s a topic a Haskell programmer definitely will want to get to, at some point, but maybe a little too far off on a tangent for this question? That\u2019s very true, and why I said \u201cmore than one type,\u201d rather than any type."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1514858806, "post_id": 48054513, "comment_id": 83081987, "body": "I&#39;d say that it&#39;s important to understand how numbers are polymorphic. You&#39;ve explained how the types work out, but you haven&#39;t said what actually happens to the values, and I think it&#39;s within the purview of the question. Up to you."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1514860546, "post_id": 48054513, "comment_id": 83082283, "body": "Okay, I added a discussion at the end, because you requested it. Kind of ambivalent about putting that here, in response to a newbie question about how to write a pair."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 4, "last_activity_date": 1514863648, "last_edit_date": 1592644375, "creation_date": 1514855068, "answer_id": 48054513, "question_id": 48054454, "link": "https://stackoverflow.com/questions/48054454/function-from-tuple-haskell/48054513#48054513", "title": "Function from tuple - Haskell", "body": "<p>An answer that goes into more detail about why Haskell comes up with the specific result it does:</p>\n<p>Okay, let\u2019s break it down. In Haskell, numeric constants can have more than one possible type, so <code>5</code> could be <code>Int</code>, <code>Integer</code>, <code>Word</code>, etc., and <code>(5,6)</code> might have type <code>(Int, Integer)</code>, <code>(Int, Int)</code> or something else.  So GHC arbitrarily denotes its type as <code>(a,b)</code> and will wait and see if you use the result later in a context that will let it deduce the type.  If not, it will default to <code>(Integer, Integer)</code>.</p>\n<p>It so happens that GHC assigned the same lowercase letters for the unknown types that you used as identifiers on the left side of the equals sign, but they\u2019re unrelated uses of the same names.  You can change <code>a b =</code> to <code>f _ = (5,6)</code> if that makes it clearer what Haskell is seeing when it takes you literally.</p>\n<p>Your declaration <code>a b</code> is a function named <code>a</code> with one argument, <code>b</code>.  This parameter is unused, so GHC cannot deduce a type for it unless you call it, and it designates that as <code>p</code>.</p>\n<p>So you declared a function that takes a <code>p</code> and returns a pair of numbers of unknown types <code>a</code> and <code>b</code>: <code>p -&gt; (a,b)</code>.</p>\n<p>As Sivio Mayolo beat me to saying, if you want to bind variables <code>a</code> and <code>b</code>, you can write <code>(a,b) = (5,6)</code>.</p>\n<h3>P.S.:</h3>\n<p>HTNW suggests I talk a little more about what values the types of the numbers can have.  <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1360006.4.1\" rel=\"nofollow noreferrer\"><em>The Haskell 2010 Report</em></a> says, \u201cAn integer literal represents the application of the function <code>fromInteger</code> to the appropriate value of type <code>Integer</code>.\u201d</p>\n<p>So, the constant <code>5</code> is equivalent to <code>(fromInteger (5::Integer))</code>.</p>\n<p>Where\u2019s <code>fromInteger</code> defined?  As part of the typeclass <code>Num</code>.  It has type <code>fromInteger  :: (Num a) =&gt; Integer -&gt; a</code>.  That is, every <code>instance</code> of typeclass <code>Num</code> (including <code>Int</code>, <code>Double</code>, and so on) has its own polymorphic version of <code>fromInteger</code> defined for it that will convert an <code>Integer</code> to that type of value.</p>\n<p>If the compiler can deduce the type of the constant, either because you provided a type annotation or because you use it in an expression that requires a specific type, it will then know which version of <code>fromInteger</code> to call to get a constant of that type.  (In fact, it will surely optimize away the call at compile time and just use the result at runtime.)  If you leave it completely up to the compiler, GHC will pick <code>Integer</code> and give you a warning.</p>\n<p>If you try to bind <code>x = 5</code> and then use <code>x</code> as any kind of <code>Num</code>, it will work\u2014but if you try to use it as two <em>different</em> types, the compiler won\u2019t be able to resolve it.  So, if you need to use <code>x</code> as an <code>Int</code> in one line, and then you want to pass it as a <code>Double</code> later, you\u2019d want to write the conversion to <code>Double</code> as <code>(fromIntegral x)</code>.  That way, <code>x</code> is an <code>Int</code> all the time and everyone\u2019s happy.</p>\n<p>An example of a conversion that\u2019s possible, but not allowed by the type system: Unlike in C, trying to use a numeric literal as a <code>Char</code> will not work, as <code>Char</code> is not an instance of <code>Num</code>.  It is, however, an <code>Enum</code>, so you can use <code>fromEnum</code> and <code>toEnum</code> to convert between <code>Char</code> and <code>Int</code>.</p>\n<p>So, if you try this in GHCI, you get:</p>\n<pre><code>Prelude&gt; 7 :: Char\n\n&lt;interactive&gt;:1:1: error:\n    \u2022 No instance for (Num Char) arising from the literal \u20187\u2019\n    \u2022 In the expression: 7 :: Char\n      In an equation for \u2018it\u2019: it = 7 :: Char\n</code></pre>\n<p><code>Char</code> is not an instance of <code>Num</code>, so there is no version of <code>fromInteger</code> that converts to <code>Char</code>.</p>\n<pre><code>Prelude&gt; toEnum 7 :: Char\n'\\a'\n</code></pre>\n<p>This is effectively <code>toEnum (fromInteger 7) :: Char</code>.  Every <code>Enum</code> has a <code>toEnum</code> function that converts from <code>Int</code> to that type of <code>Enum</code>.  The <code>:: Char</code> at the end tells GHCI that the <code>Enum</code> to convert to is <code>Char</code>, so GHCI can deduce that it should convert 7 from <code>Integer</code> to <code>Int</code> to <code>Char</code>. Haskell borrowed from C the <code>'\\a'</code> escape code for ASCII/Unicode codepoint 7.  (For <em>alert</em>, and if you typed control-G on a terminal, it used to beep at you.  It might still work in your Linux console, or at least make the window flash.)</p>\n"}], "owner": {"reputation": 241, "user_id": 5622934, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3ac80aebf3caef245b0627aaff0a6039?s=128&d=identicon&r=PG&f=1", "display_name": "BigMeister", "link": "https://stackoverflow.com/users/5622934/bigmeister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 48054513, "answer_count": 2, "score": 1, "last_activity_date": 1514863648, "creation_date": 1514854295, "last_edit_date": 1514854625, "question_id": 48054454, "link": "https://stackoverflow.com/questions/48054454/function-from-tuple-haskell", "title": "Function from tuple - Haskell", "body": "<p>a simple problem for ones who are good with Haskell!\nWhy if I write:</p>\n\n<pre><code>let a b = (5,6)\n</code></pre>\n\n<p>I obtain a function:</p>\n\n<pre><code>a :: p -&gt; (a, b)\n</code></pre>\n\n<p>Furthermore, b is not instantiated. I tried to understand it in vain.\nThank you for help!</p>\n"}, {"tags": ["haskell", "monads", "typeclass", "rank-n-types"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1514841503, "post_id": 48053237, "comment_id": 83078848, "body": "Completely orthogonal to the question, but <code>f</code> is more elegantly written <code>f g = liftA2 (,) (g val) (g valM)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 1460350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62326efdfa8241b162bad205e4df501f?s=128&d=identicon&r=PG", "display_name": "johncowie", "link": "https://stackoverflow.com/users/1460350/johncowie"}, "edited": false, "score": 0, "creation_date": 1514841884, "post_id": 48053293, "comment_id": 83078926, "body": "Ah the key thing I was missing was that I didn&#39;t realise you could use the <code>forall</code> syntax on the right hand side of <code>=&gt;</code>.  That&#39;s great, thanks for your help!"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 317, "user_id": 1460350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62326efdfa8241b162bad205e4df501f?s=128&d=identicon&r=PG", "display_name": "johncowie", "link": "https://stackoverflow.com/users/1460350/johncowie"}, "edited": false, "score": 1, "creation_date": 1514841992, "post_id": 48053293, "comment_id": 83078952, "body": "@johncowie That is, in fact, precisely what <code>RankNTypes</code> allows. Consider reading <a href=\"https://downloads.haskell.org/~ghc/8.2.2/docs/html/users_guide/glasgow_exts.html#arbitrary-rank-polymorphism\" rel=\"nofollow noreferrer\">the relevant section of the GHC user\u2019s guide</a>."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 8, "last_activity_date": 1514841370, "creation_date": 1514841370, "answer_id": 48053293, "question_id": 48053237, "link": "https://stackoverflow.com/questions/48053237/how-can-i-pass-a-monadic-function-as-an-argument-with-a-flexible-type-variable/48053293#48053293", "title": "How can I pass a monadic function as an argument with a flexible type variable?", "body": "<p>You\u2019re right that you need <code>RankNTypes</code>, but you\u2019re missing a <code>forall</code>. The correct type for <code>f</code> is:</p>\n\n<pre><code>f :: MyClass m a =&gt; (forall b. m b -&gt; IO b) -&gt; IO (a, Maybe a)\n</code></pre>\n\n<p>\u2026since the function passed to <code>f</code> must work for any result type, and it shouldn\u2019t be related to the <code>a</code> in the result.</p>\n\n<hr>\n\n<p>It\u2019s also potentially worth noting that this sort of function is also known as a <em>natural transformation</em>, and the natural-transformation package provides <a href=\"https://hackage.haskell.org/package/natural-transformation-0.4/docs/Control-Natural.html#t:-126--62-\" rel=\"noreferrer\">a <code>(~&gt;)</code> type alias</a> for such functions:</p>\n\n<pre><code>type (~&gt;) f g = forall a. f a -&gt; g a\n</code></pre>\n\n<p>Therefore, using that type alias, you could also write <code>f</code> like this:</p>\n\n<pre><code>f :: MyClass m a =&gt; (m ~&gt; IO) -&gt; IO (a, Maybe a)\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 1460350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62326efdfa8241b162bad205e4df501f?s=128&d=identicon&r=PG", "display_name": "johncowie", "link": "https://stackoverflow.com/users/1460350/johncowie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 48053293, "answer_count": 1, "score": 2, "last_activity_date": 1514841370, "creation_date": 1514840821, "question_id": 48053237, "link": "https://stackoverflow.com/questions/48053237/how-can-i-pass-a-monadic-function-as-an-argument-with-a-flexible-type-variable", "title": "How can I pass a monadic function as an argument with a flexible type variable?", "body": "<p>Apologies for the potentially vague question title - I'm not sure how to phrase it because I have a pretty poor understanding of what the problem is.  </p>\n\n<p>Basically, how do I make the following compile? :-p</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass (Monad m) =&gt; MyClass m a where\n  valM :: m (Maybe a)\n  val  :: m a\n\nf :: (MyClass m a) =&gt; (m a -&gt; IO a) -&gt; IO (a, Maybe a)\nf g = do\n  x &lt;- g val\n  yM &lt;- g valM\n  return (x, yM)\n</code></pre>\n\n<p>GHC (v8.2.2) complains that <code>a</code> is a rigid type variable and can't seem to cope with the idea that <code>(g val)</code> and <code>(g valM)</code> could produce values of different types.  I've tried using <code>RankNTypes</code> but to no avail.</p>\n\n<p>Is there an extension I can use to help the compiler, or is there something conceptually broken with what I'm trying to do from a type-inference point of view?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514835987, "post_id": 48052583, "comment_id": 83077608, "body": "thanks @4castle. It solves the issue, if instance defination is replaced by <code>instance (IsPerson a) =&gt; IsPerson (EmployeeRecord a) where</code>"}], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 4, "last_activity_date": 1514836322, "last_edit_date": 1514836322, "creation_date": 1514835987, "answer_id": 48052737, "question_id": 48052583, "link": "https://stackoverflow.com/questions/48052583/class-instance-implementation/48052737#48052737", "title": "Class Instance Implementation", "body": "<p>Your <code>EmployeeRecord</code> type is like a \"box\" where the type implementing <code>IsPerson</code> is inside. You need to \"unbox\" the <code>EmployeeRecord</code> in order to access the \"inner\" <code>personName</code>.</p>\n\n<p>You can do this unboxing by either pattern matching or using the <code>employe</code> function.</p>\n\n<pre><code>instance IsPerson (EmployeeRecord a) where\n  personName (EmployeeRecord a _) = personName a\n  personAge (EmployeeRecord a _) = personAge a\n</code></pre>\n\n\n\n<pre><code>instance IsPerson (EmployeeRecord a) where\n  personName = personName . employe\n  personAge = personAge . employe\n</code></pre>\n\n<hr>\n\n<p>By the way, your code makes use of the deprecated <code>DatatypeContexts</code> language extension. Rather than put the constraint on <code>a</code> in the <code>EmployeeRecord</code> type declaration, put the constraint in your <code>instance</code> declaration:</p>\n\n<pre><code>instance IsPerson a =&gt; IsPerson (EmployeeRecord a) where\n</code></pre>\n"}], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 48052737, "answer_count": 1, "score": 0, "last_activity_date": 1514836623, "creation_date": 1514834776, "last_edit_date": 1514836623, "question_id": 48052583, "link": "https://stackoverflow.com/questions/48052583/class-instance-implementation", "title": "Class Instance Implementation", "body": "<p>Apart from <code>instance IsPerson (EmployeeRecord a)</code> the whole code is a part of the post <a href=\"https://mmhaskell.com/blog/2018/1/1/general-functions-with-typeclasses\" rel=\"nofollow noreferrer\">General Functions with Typeclasses</a>.</p>\n\n<p><code>ghci</code> compiles the code, but <code>printPerson</code> doesn't print anything. I guess it calls itself recursively.</p>\n\n<pre><code>Main&gt; :l type-class.hs \n[1 of 1] Compiling Main             ( type-class.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; printPerson $ EmployeeRecord (Student \"me\" 123) 11\n</code></pre>\n\n<p>Removing of <code>instance IsPerson (EmployeeRecord a)</code> leads to the exception</p>\n\n<pre><code>Main&gt; printPerson $ EmployeeRecord (Student \"me\" 123) 11\n\n&lt;interactive&gt;:116:1: error:\n    * No instance for (IsPerson (EmployeeRecord Student))\n        arising from a use of `printPerson'\n    * In the expression:\n        printPerson $ EmployeeRecord (Student \"me\" 123) 11\n      In an equation for `it':\n          it = printPerson $ EmployeeRecord (Student \"me\" 123) 11\n</code></pre>\n\n<p>How should <code>instance IsPerson EmployeeRecord</code> be implemented solve the issue with <code>printPerson</code>?</p>\n\n<pre><code>data Student = Student String Int deriving Show\n\ndata Teacher = Teacher\n  { teacherName:: String\n  , teacherAge:: Int\n  , teacherDepartment :: String\n  , teacherSalary :: Int\n  } deriving Show\n\nclass IsPerson a where\n  personName :: a -&gt; String\n  personAge :: a -&gt; Int\n\ninstance IsPerson Student where\n  personName (Student n _) = n\n  personAge (Student _ a) = a\n\ninstance IsPerson Teacher where\n  personName = teacherName\n  personAge  = teacherAge\n\ndata (IsPerson a) =&gt; EmployeeRecord a = EmployeeRecord\n  {\n      employe :: a\n    , tenure :: Int\n  } deriving (Show)\n\n\ninstance IsPerson (EmployeeRecord a) where\n  personName a = personName a\n  personAge = undefined\n\nprintPerson :: (IsPerson a) =&gt; a -&gt; IO ()\nprintPerson p = putStrLn $ personName p\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1514823090, "post_id": 48051083, "comment_id": 83074113, "body": "Why do you need to abstract over the constructor? How are you going to use the return value of <code>f</code> if you don&#39;t know its type ahead of time?"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1514823647, "post_id": 48051083, "comment_id": 83074276, "body": "I would create a typeclass where <code>User</code> would have a instance relating to this. So <code>save (User &quot;chris&quot; &quot;str&quot;)</code> would work as an example."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1514827295, "post_id": 48051083, "comment_id": 83075240, "body": "This seems like a poor design. Rather than try to create one function which does all of the work, you should create several smaller, simpler functions which each deal with a different entity type."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 4, "last_activity_date": 1514825966, "creation_date": 1514825966, "answer_id": 48051562, "question_id": 48051083, "link": "https://stackoverflow.com/questions/48051083/how-can-i-transform-a-list-of-values-to-a-data-constructors-parameters/48051562#48051562", "title": "How can I transform a list of values to a data constructor&#39;s parameters?", "body": "<p>Let me preface this by saying that you should almost certainly <em>not</em> use this.  </p>\n\n<p>The usual way of doing this sort of thing is to have overlapping multiparameter typeclasses.</p>\n\n<h2>First attempt</h2>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies, FlexibleInstances,\n             UndecidableInstances #-}\n\nclass PackArgs a b | a -&gt; b where\n  packArgs :: [String] -&gt; a -&gt; Maybe b\n\ninstance {-# OVERLAPPING #-} PackArgs y z =&gt; PackArgs (String -&gt; y) z where\n  packArgs [] _ = Nothing\n  packArgs (a:as) f = packArgs as (f a)\n\ninstance {-# OVERLAPPABLE #-} PackArgs z z where\n  packArgs (_:_) _ = Nothing\n  packArgs [] z = Just z\n</code></pre>\n\n<p>And here it is working in action:</p>\n\n<pre><code>ghci&gt; data User = User String String deriving Show\nghci&gt; data Address1 = Address1 String deriving Show\nghci&gt; packArgs [\"chris\",\"str\"] User :: Maybe User\nJust (User \"chris\" \"str\")\nghci&gt; packArgs [\"chris\"] User :: Maybe User\nNothing\nghci&gt; packArgs [] User :: Maybe User\nNothing\nghci&gt; packArgs [\"earth\"] Address1 :: Maybe Address1\nJust (Address1 \"earth\")\n</code></pre>\n\n<p>The problem is that we need the type annotations for this to work. In a nutshell, Haskell needs to know what your expected return type is. We can fix this with some type families.</p>\n\n<h2>Second attempt</h2>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies, FlexibleInstances,\n             UndecidableInstances, TypeFamilies, ScopedTypeVariables #-}\n\nimport Data.Proxy\n\ntype family StringFuncReturn a where\n  StringFuncReturn (String -&gt; b) = StringFuncReturn b\n  StringFuncReturn b = b\n\nclass PackArgs a where\n  packArgs :: [String] -&gt; a -&gt; Maybe (StringFuncReturn a)\n\ninstance (StringFuncReturn a ~ r, PackArgs' a r) =&gt; PackArgs a where\n  packArgs = packArgs' (Proxy :: Proxy r)\n\nclass PackArgs' a b where\n  packArgs' :: Proxy b -&gt; [String] -&gt; a -&gt; Maybe b\n\ninstance {-# OVERLAPPING #-} PackArgs' y z =&gt; PackArgs' (String -&gt; y) z where\n  packArgs' _ [] _ = Nothing\n  packArgs' p (a:as) f = packArgs' p as (f a)\n\ninstance {-# OVERLAPPABLE #-} PackArgs' z z where\n  packArgs' _ (_:_) _ = Nothing\n  packArgs' _ [] z = Just z\n</code></pre>\n\n<p>And here it is working in action:</p>\n\n<pre><code>ghci&gt; data User = User String String deriving Show\nghci&gt; data Address1 = Address1 String deriving Show\nghci&gt; packArgs [\"chris\",\"str\"] User\nJust (User \"chris\" \"str\")\nghci&gt; packArgs [\"chris\"] User\nNothing\nghci&gt; packArgs [] User\nNothing\nghci&gt; packArgs [\"earth\"] Address1\nJust (Address1 \"earth\")\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 48051562, "answer_count": 1, "score": 2, "last_activity_date": 1514825966, "creation_date": 1514822108, "question_id": 48051083, "link": "https://stackoverflow.com/questions/48051083/how-can-i-transform-a-list-of-values-to-a-data-constructors-parameters", "title": "How can I transform a list of values to a data constructor&#39;s parameters?", "body": "<p>I am processing a web request, and trying to save a potential entity (User / Address 1). The main question is, how can I transform a list of Strings to parameters to a function - where the list could be of arbitrary length.</p>\n\n<p>I have looked at <a href=\"https://stackoverflow.com/questions/3775446/passing-list-elements-as-parameters-to-curried-function\">Passing list elements as parameters to curried function</a> but this seems to be a solution only when knowing the amount of parameters in advance.</p>\n\n<hr>\n\n<pre><code>data User = User String String\ndata Address1 = Address1 String\n\nlet ufields = [\"chris\", \"str\"]\nlet afields = [\"earth\"]\n</code></pre>\n\n<p>I'm looking for a function along the lines of:</p>\n\n<pre><code>f :: [String] -&gt; (? -&gt; c) -&gt; Maybe c\nf fields c = undefined\n</code></pre>\n\n<p>So all I would need to pass is the data constructor (User/Address1), and a list of strings.</p>\n\n<p>Examples:</p>\n\n<p><code>f ufields User</code> would return <code>Just ( User \"chris\" \"str\")</code>.</p>\n\n<p><code>f [\"chris\"] User</code> would return <code>Nothing</code>.</p>\n\n<p><code>f [] User</code> would return <code>Nothing</code>.</p>\n\n<p><code>f afields Address1</code> would return <code>Just ( Address1 \"earth\" )</code>.</p>\n\n<p>Is this possible to be done without using TemplateHaskell? I can achieve the above manually, but it involves quite a bit of additional typing: </p>\n\n<pre><code>data User = User String String deriving (Show)\ndata Address1 = Address1 String deriving (Show)\n\ndata EntityType = UserEntity | AddressEntity\ndata EntityContainer = UserContainer User | AddressContainer Address1\n\nf :: EntityType -&gt; [String] -&gt; Maybe EntityContainer\nf UserEntity  (p:p':[]) = Just $ UserContainer $ User p p'\nf AddressEntity  (p:[]) = Just $ AddressContainer $ Address1 p\nf _ _ = Nothing\n\nprintPossibleEntity :: [String] -&gt; EntityType -&gt; IO ()\nprintPossibleEntity fields entityType = \n  case (f entityType fields) of\n    Just (UserContainer u) -&gt; print u\n    Just (AddressContainer a) -&gt; print a\n    Nothing -&gt; print \"No entity matched\"\n\nmain :: IO ()\nmain = do\n  let ufields = [\"chris\", \"str\"]\n  let afields = [\"earth\"]\n  printPossibleEntity ufields UserEntity\n  printPossibleEntity afields AddressEntity\n  printPossibleEntity [] AddressEntity\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>User \"chris\" \"str\"\nAddress1 \"earth\"\n\"No entity matched\"\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "wreq"], "comments": [{"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1514820850, "post_id": 48050742, "comment_id": 83073520, "body": "Which stackage snapshot? Check your <code>stack.yaml</code>."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1514821307, "post_id": 48050742, "comment_id": 83073623, "body": "The default one: resolver: lts-10.2"}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1514849052, "post_id": 48050742, "comment_id": 83080447, "body": "Works on my system... got the log files mentioned?"}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1514851471, "post_id": 48050742, "comment_id": 83080831, "body": "The log only contains no message other than what I posted I force uninstalled the haskell platform. and reinstalled with home-brew, and did stack upgrade, then works.  Thanks for looking into this anyway."}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1514819680, "creation_date": 1514819422, "last_edit_date": 1514819680, "question_id": 48050742, "link": "https://stackoverflow.com/questions/48050742/stack-install-cause-error-cannot-satisfy-package-id", "title": "stack install cause error &quot;cannot satisfy -package-id ...&quot;", "body": "<p>I'm using the latest Haskell Platform 8.2.2 on my MacOS El Captain.</p>\n\n<p>When I create a new project and install <code>wreq</code>, I will get the following error</p>\n\n<pre><code>stack new hello\ncd hello\nstack build // &lt;- this is fine\nstack install wreq // &lt;- this command will cause the following error after a few seconds\n</code></pre>\n\n<hr>\n\n<pre><code>\u25b8 stack install wreq\nasn1-encoding-0.9.5: configure\nasn1-encoding-0.9.5: build\ncryptohash-0.11.9: configure\ncryptohash-0.11.9: build\ndata-default-0.7.1.1: configure\ndata-default-0.7.1.1: build\nblaze-builder-0.4.0.2: configure\ndata-default-0.7.1.1: copy/register\nasn1-encoding-0.9.5: copy/register\nblaze-builder-0.4.0.2: build\nexceptions-0.8.3: configure\nexceptions-0.8.3: build\ncryptohash-0.11.9: copy/register\nProgress: 5/46\n--  While building custom Setup.hs for package exceptions-0.8.3 using:\n      /Users/leo/.stack/setup-exe-cache/x86_64-osx/Cabal-simple_mPHDZzAJ_2.0.1.0_ghc-8.2.2 --builddir=.stack-work/dist/x86_64-osx/Cabal-2.0.1.0 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /Users/leo/zhangchiqing/hello/.stack-work/logs/exceptions-0.8.3.log\n\n    Configuring exceptions-0.8.3...\n    Preprocessing library for exceptions-0.8.3..\n    Building library for exceptions-0.8.3..\n    &lt;command line&gt;: cannot satisfy -package-id stm-2.4.4.1-6AExGOUG8NB2Rzejnay0ww\n        (use -v for more information)\n\n\n--  While building custom Setup.hs for package blaze-builder-0.4.0.2 using:\n      /Users/leo/.stack/setup-exe-cache/x86_64-osx/Cabal-simple_mPHDZzAJ_2.0.1.0_ghc-8.2.2 --builddir=.stack-work/dist/x86_64-osx/Cabal-2.0.1.0 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /Users/leo/zhangchiqing/hello/.stack-work/logs/blaze-builder-0.4.0.2.log\n\n    Configuring blaze-builder-0.4.0.2...\n    Preprocessing library for blaze-builder-0.4.0.2..\n    Building library for blaze-builder-0.4.0.2..\n    &lt;command line&gt;: cannot satisfy -package-id text-1.2.2.2-EakMpasry3jA6OIwSZhq9M\n        (use -v for more information)\n</code></pre>\n\n<p>My environment:</p>\n\n<pre><code>\u25b8 stack --version\nVersion 1.6.1, Git revision f25811329bbc40b0c21053a8160c56f923e1201b (5435 commits) x86_64 hpack-0.20.0\n\n\u25b8 cabal --version\ncabal-install version 2.0.0.1\ncompiled using version 2.0.1.1 of the Cabal library\n\n\u25b8 ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 8.2.2\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514817051, "post_id": 48050404, "comment_id": 83072683, "body": "We usually say that that 5 does not belong to the empty list: returning an error is a bit extreme. You don&#39;t really need the singleton-list case. In the recursive case, you ignore the first element of the list, but that looks wrong."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1514864740, "post_id": 48050404, "comment_id": 83083019, "body": "Unrelated to your question, an easier way of formulating this (while still using explicit recursion) would be <code>lcf (5 : _) = True; lcf (_ : xs) = lcf xs; lcf [] = False</code>. A more idiomatic phrasing would be <code>lcf = any (== 5)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1514817133, "last_edit_date": 1514817133, "creation_date": 1514816758, "answer_id": 48050450, "question_id": 48050404, "link": "https://stackoverflow.com/questions/48050404/haskell-error-no-instance-from-literal/48050450#48050450", "title": "Haskell error no instance from literal", "body": "<p>Your type signature says that the argument is  <code>[Int]</code> (An Int list) but you are comparing it with <code>==</code> to <code>5</code> with is a single <code>Int</code>. You could pattern match for <code>x:[]</code>(or equivalently <code>[x]</code>) and then compare <code>x == 5</code></p>\n"}, {"comments": [{"owner": {"reputation": 326, "user_id": 2877123, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/71e37b1809a4ab999ac1156e571ff1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/2877123/oblivion"}, "edited": false, "score": 0, "creation_date": 1514817418, "post_id": 48050463, "comment_id": 83072772, "body": "Thanks, the [Int] was the code problem but my logic was also way off."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1514816872, "creation_date": 1514816872, "answer_id": 48050463, "question_id": 48050404, "link": "https://stackoverflow.com/questions/48050404/haskell-error-no-instance-from-literal/48050463#48050463", "title": "Haskell error no instance from literal", "body": "<p>The argument of <code>listContainsFive</code> has the type <code>[Int]</code>. So in <code>listContainsFive x = if x == 5 then True else False</code>, <code>x</code> has type <code>[Int]</code>. Since you're comparing <code>x</code> and <code>5</code> and both operands of <code>==</code> must have the same type, <code>5</code> must also have the type <code>[Int]</code>. The error message is GHC's way of telling you that it can't find a way to make <code>5</code> have a list type.</p>\n\n<p>I'm not sure whether your intent was to match a single-element list and let <code>x</code> refer to the element of that list, or whether your intent was to have <code>x</code> refer to the head of any non-empty list. In the former case you should use the pattern <code>[x]</code> instead of <code>x</code>. In the latter case you should use the same pattern as on the following line (<code>(x:xs)</code>) - in fact you should merge those lines as the next pattern would be redundant otherwise.</p>\n\n<p>Note that if your intent was to only match single-element lists with that pattern, your function will only check if 5 is the last element of a list while the name of the function suggests that it checks whether the list contains 5. So either your logic or your name would be wrong in that case.</p>\n"}], "owner": {"reputation": 326, "user_id": 2877123, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/71e37b1809a4ab999ac1156e571ff1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/2877123/oblivion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 48050463, "answer_count": 2, "score": 0, "last_activity_date": 1514817133, "creation_date": 1514816421, "question_id": 48050404, "link": "https://stackoverflow.com/questions/48050404/haskell-error-no-instance-from-literal", "title": "Haskell error no instance from literal", "body": "<p>Getting the following error:</p>\n\n<pre><code>\u2022 No instance for (Num [Int]) arising from the literal \u20185\u2019\n\u2022 In the second argument of \u2018(==)\u2019, namely \u20185\u2019\nIn the expression: x == 5\nIn the expression: if x == 5 then True else False\n</code></pre>\n\n<p>When trying to load a haskell function:</p>\n\n<pre><code>listContainsFive :: [Int] -&gt; Bool\nlistContainsFive [] = error \"empty list\"\nlistContainsFive x = if x == 5 then True else False\nlistContainsFive (x:xs) = listContainsFive xs\n</code></pre>\n\n<p>I'm not sure what the issue is, i'm very new to Haskell.</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 0, "creation_date": 1514803554, "post_id": 48048985, "comment_id": 83069519, "body": "Oh, seems like that&#39;s what&#39;s happening indeed. Now I need to think a bit on how to fix this situation :)"}, {"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 0, "creation_date": 1514803708, "post_id": 48048985, "comment_id": 83069547, "body": "Thanks, will try your suggestion a bit later. I have tried something like <code>(optionMaybe dimensParser) &lt;|&gt; skipMany anyChar</code>, but it led to the same results. I guess that&#39;s because it still consumed comma and fooled sepBy"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 1, "creation_date": 1514803873, "post_id": 48048985, "comment_id": 83069572, "body": "@dimsuz <code>optionMaybe</code> always succeeds, so the <code>skipMany</code> is never used."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1514803783, "last_edit_date": 1514803783, "creation_date": 1514803362, "answer_id": 48048985, "question_id": 48048903, "link": "https://stackoverflow.com/questions/48048903/why-parsecs-sepby-stops-and-does-not-parse-all-elements/48048985#48048985", "title": "Why Parsec&#39;s sepBy stops and does not parse all elements?", "body": "<p>I'd guess that <code>optionMaybe dimensParser</code>, when fed with input <code>\"hello,...\"</code>, tries <code>dimensParser</code>. That fails, so <code>optionMaybe</code> returns success with <code>Nothing</code>, and consumes no portion of the input.</p>\n\n<p>The last part is the crucial one: after <code>Nothing</code> is returned, the input string to be parsed is still <code>\"hello,...\"</code>.</p>\n\n<p>At that point <code>sepBy</code> tries to parse <code>char ','</code>, which fails. So, it deduces that the list is over, and terminates the output list, without consuming any more input.</p>\n\n<p>If you want to skip other entities, you need a \"consuming\" parser that returns <code>Nothing</code> instead of <code>optionMaybe</code>. That parser, however, need to know how much to consume: in your case, until the comma.</p>\n\n<p>Perhaps you need some like (untested)</p>\n\n<pre><code>(   try (Just &lt;$&gt; dimensParser) \n&lt;|&gt; (noneOf \",\" &gt;&gt; return Nothing))\n    `sepBy` char ','\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 0, "creation_date": 1514804080, "post_id": 48049030, "comment_id": 83069613, "body": "Thank you! Another great answer!"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1514803816, "creation_date": 1514803816, "answer_id": 48049030, "question_id": 48048903, "link": "https://stackoverflow.com/questions/48048903/why-parsecs-sepby-stops-and-does-not-parse-all-elements/48049030#48049030", "title": "Why Parsec&#39;s sepBy stops and does not parse all elements?", "body": "<p>In order to answer this question, it's handy to take a piece of paper, write down the input, and act as a dumb parser.</p>\n\n<p>We start with \"300x300,hello,5x5,6x6\", our current parser is <code>optionMaybe ...</code>. Does our <code>dimensParser</code> correctly parse the dimension? Let's check:</p>\n\n<pre><code>  w &lt;- many1 digit   -- yes, \"300\"\n  char 'x'           -- yes, \"x\"\n  h &lt;- many1 digit   -- yes, \"300\"\n  return (read w, read h) -- never fails\n</code></pre>\n\n<p>We've successfully parsed the first dimension. The next token is <code>,</code>, so <code>sepBy</code> successfully parses that as well. Next, we try to parse \"hello\" and fail:</p>\n\n<pre><code> w &lt;- many1 digit -- no. 'h' is not a digit. Stop\n</code></pre>\n\n<p>Next, <code>sepBy</code> tries to parse <code>,</code>, but that's not possible, since the next token is a <code>'h'</code>, not a <code>,</code>. Therefore, <code>sepBy</code> stops.</p>\n\n<p>We haven't parsed <em>all</em> the input, but that's not actually necessary. You would get a proper error message if you've used</p>\n\n<pre><code>parse (dimensStringParser &lt;* eof)\n</code></pre>\n\n<p>Either way, if you want to discard anything in the list that's not a dimension, you can use</p>\n\n<pre><code>dimensStringParser1 :: Parser (Maybe (Int, Int))\ndimensStringParser1 = (Just &lt;$&gt; dimensParser) &lt;|&gt; (skipMany (noneOf \",\") &gt;&gt; Nothing)\n\ndimensStringParser = dimensStringParser1  `sepBy` char ','\n</code></pre>\n"}], "owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 1, "accepted_answer_id": 48048985, "answer_count": 2, "score": 2, "last_activity_date": 1514803816, "creation_date": 1514802640, "question_id": 48048903, "link": "https://stackoverflow.com/questions/48048903/why-parsecs-sepby-stops-and-does-not-parse-all-elements", "title": "Why Parsec&#39;s sepBy stops and does not parse all elements?", "body": "<p>I am trying to parse some comma separated string which may or may not contain a string with image dimensions. For example <code>\"hello world, 300x300, good bye world\"</code>.</p>\n\n<p>I've written the following little program:</p>\n\n<pre><code>import Text.Parsec\nimport qualified Text.Parsec.Text as PS\n\nparseTestString :: Text -&gt; [Maybe (Int, Int)]\nparseTestString s = case parse dimensStringParser \"\" s of\n                      Left _ -&gt; [Nothing]\n                      Right dimens -&gt; dimens\n\ndimensStringParser :: PS.Parser [Maybe (Int, Int)]\ndimensStringParser = (optionMaybe dimensParser) `sepBy` (char ',')\n\ndimensParser :: PS.Parser (Int, Int)\ndimensParser = do\n  w &lt;- many1 digit\n  char 'x'\n  h &lt;- many1 digit\n  return (read w, read h)\n\nmain :: IO ()\nmain = do\n  print $ parseTestString \"300x300,40x40,5x5\"\n  print $ parseTestString \"300x300,hello,5x5,6x6\"\n</code></pre>\n\n<p>According to <code>optionMaybe</code> documentation, it returns <code>Nothing</code> if it can't parse, so I would expect to get this output:</p>\n\n<pre><code>[Just (300,300),Just (40,40),Just (5,5)]\n[Just (300,300),Nothing, Just (5,5), Just (6,6)]\n</code></pre>\n\n<p>but instead I get:</p>\n\n<pre><code>[Just (300,300),Just (40,40),Just (5,5)]\n[Just (300,300),Nothing]\n</code></pre>\n\n<p>I.e. parsing stops after first failure. So I have two questions:</p>\n\n<ol>\n<li>Why does it behave this way?</li>\n<li>How do I write a correct parser for this case?</li>\n</ol>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 27, "last_activity_date": 1514786777, "last_edit_date": 1514786777, "creation_date": 1514785885, "answer_id": 48047431, "question_id": 48047395, "link": "https://stackoverflow.com/questions/48047395/why-is-not-defined-as/48047431#48047431", "title": "Why is (&gt;&gt;) not defined as (*&gt;)?", "body": "<p>According to a comment in the <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/src/GHC.Base.html#%3E%3E\" rel=\"noreferrer\">source code</a>, it's to prevent people from accidentally creating a recursive binding if they override <code>*&gt;</code> as <code>&gt;&gt;</code> in their <code>Applicative</code> instance.</p>\n\n<pre><code>(>>)        :: forall a b. m a -> m b -> m b\nm >> k = m >>= \\_ -> k -- <b>See Note [Recursive bindings for Applicative/Monad]</b>\n</code></pre>\n\n<p>The note says:</p>\n\n<blockquote>\n  <h3>Note: Recursive bindings for Applicative/Monad</h3>\n  \n  <p>The original Applicative/Monad proposal stated that after implementation, the designated implementation of (>>) would become</p>\n\n<pre><code>(&gt;&gt;) :: forall a b. m a -&gt; m b -&gt; m b\n(&gt;&gt;) = (*&gt;)\n</code></pre>\n  \n  <p>by default. You might be inclined to change this to reflect the stated proposal, but you really shouldn't! Why? Because people tend to\n  define such instances the <em>other</em> way around: in particular, it is\n  perfectly legitimate to define an instance of Applicative <code>(*&gt;)</code> in\n  terms of <code>(&gt;&gt;)</code>, which would lead to an infinite loop for the default\n  implementation of Monad! And people do this in the wild.</p>\n  \n  <p>This turned into a nasty bug that was tricky to track down, and rather\n  than eliminate it everywhere upstream, it's easier to just retain the\n  original default.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 9, "last_activity_date": 1514802619, "creation_date": 1514802619, "answer_id": 48048902, "question_id": 48047395, "link": "https://stackoverflow.com/questions/48047395/why-is-not-defined-as/48048902#48048902", "title": "Why is (&gt;&gt;) not defined as (*&gt;)?", "body": "<p>4castle's answer is right, of course, but there's another thing to consider. Not every <code>Monad</code> instance supports an <code>Applicative</code> instance more efficient than <code>liftA2 = liftM2</code>. That is,</p>\n\n<pre><code>liftA2 f xs ys = xs &gt;&gt;= \\x -&gt; ys &gt;&gt;= \\y -&gt; pure (f x y)\n</code></pre>\n\n<p>Using the default <code>(*&gt;) = liftA2 (flip const)</code> gives</p>\n\n<pre><code>xs *&gt; ys = xs &gt;&gt;= \\ _ -&gt; ys &gt;&gt;= \\y -&gt; pure y\n</code></pre>\n\n<p>On the other hand, the default definition of <code>(&gt;&gt;)</code> gives</p>\n\n<pre><code>xs &gt;&gt; ys = xs &gt;&gt;= \\ _ -&gt; ys\n</code></pre>\n\n<p>As you can see, this uses only one bind, where the other uses two. By a monad identity law, they're equivalent, but the compiler doesn't know the monad laws. So the approach you suggest will probably make the optimizer work harder, and may even prevent it from producing the best code in some cases.</p>\n"}], "owner": {"reputation": 484, "user_id": 6421681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gZN1tFHAS_0/AAAAAAAAAAI/AAAAAAAAAGo/c8XZSrjQuEM/photo.jpg?sz=128", "display_name": "Yolo Voe", "link": "https://stackoverflow.com/users/6421681/yolo-voe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 3, "accepted_answer_id": 48047431, "answer_count": 2, "score": 21, "last_activity_date": 1514933350, "creation_date": 1514785158, "last_edit_date": 1514933350, "question_id": 48047395, "link": "https://stackoverflow.com/questions/48047395/why-is-not-defined-as", "title": "Why is (&gt;&gt;) not defined as (*&gt;)?", "body": "<p>GHC currently implements <code>&gt;&gt;</code> as</p>\n\n<pre><code>(&gt;&gt;) :: m a -&gt; m b -&gt; m b\nm &gt;&gt; k = m &gt;&gt;= \\_ -&gt; k\n</code></pre>\n\n<p>Why not do the following instead?</p>\n\n<pre><code>(&gt;&gt;) :: m a -&gt; m b -&gt; m b\nm &gt;&gt; k = m *&gt; k\n</code></pre>\n\n<p>Right now, I am thinking <code>&gt;&gt;=</code> does something <code>*&gt;</code> doesn't.</p>\n\n<p>But everything works out grammatically (as in, type-wise), so it's really hard to reason about why it wouldn't work.\nPerhaps the monad instance does some computation that the applicative instance doesn't, but I think this would break the semantics of the type.</p>\n\n<p><strong>Update</strong> I only get to pick one SO answer as accepted, but the <a href=\"https://stackoverflow.com/a/48048902/6421681\">answer by dfeuer</a> is very insightful (specially, for people who, like me, are relatively inexperienced in Haskell).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1514776575, "post_id": 48046833, "comment_id": 83065406, "body": "Hope this reaches you in time to tell you when\u2019s the new year. Have a happy one!"}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514779687, "post_id": 48046930, "comment_id": 83065710, "body": "You can use <code>deriving (Enum)</code> to avoid writing that boilerplate code. Just subtract one from the result of <code>toWeekDate</code>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514779788, "post_id": 48046930, "comment_id": 83065719, "body": "Unfortunately, no. <code>toWeekDate</code> returns  7, not 0."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514779942, "post_id": 48046930, "comment_id": 83065732, "body": "You can use <code>toEnum (weekDayNumber - 1)</code> to avoid writing that custom <code>Enum</code> instance."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514779943, "post_id": 48046930, "comment_id": 83065733, "body": "Then I couldn\u2019t pass the result to <code>toEnum</code>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514845405, "post_id": 48046930, "comment_id": 83079711, "body": "@4castle On second thought, I added a second example that uses a wrapper instead of boilerplate."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1515242035, "post_id": 48046930, "comment_id": 83231342, "body": "By the way, there\u2019s also the package <code>Data.Dates</code> for this."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 1, "last_activity_date": 1514845589, "last_edit_date": 1514845589, "creation_date": 1514776307, "answer_id": 48046930, "question_id": 48046833, "link": "https://stackoverflow.com/questions/48046833/haskell-how-to-extract-timeofday-and-dayofweek-from-zonedtime/48046930#48046930", "title": "Haskell - How to extract TimeOfDay and DayOfWeek from ZonedTime", "body": "<p>Does this work for you?</p>\n\n<pre><code>import Data.Time.LocalTime\n  (ZonedTime, TimeOfDay, getZonedTime, localDay, localTimeOfDay,\n   zonedTimeToLocalTime)\nimport Data.Time.Calendar.WeekDate (toWeekDate)\n\n-- toWeekDate numbers the days 1 for Monday to 7 for Sunday.\ndata DayOfWeek = Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday\n  deriving (Eq, Read, Show)\n\ninstance Enum DayOfWeek where\n  toEnum 0 = Sunday\n  toEnum 1 = Monday\n  toEnum 2 = Tuesday\n  toEnum 3 = Wednesday\n  toEnum 4 = Thursday\n  toEnum 5 = Friday\n  toEnum 6 = Saturday\n  toEnum 7 = Sunday -- Yes, twice.\n  toEnum n = toEnum (n `mod` 7)\n\n  fromEnum Monday = 1\n  fromEnum Tuesday = 2\n  fromEnum Wednesday = 3\n  fromEnum Thursday = 4\n  fromEnum Friday = 5\n  fromEnum Saturday = 6\n  fromEnum Sunday = 7\n\ntimeOfDayAndDayOfWeek :: ZonedTime -&gt; (TimeOfDay, DayOfWeek)\ntimeOfDayAndDayOfWeek zt = let\n    lt = zonedTimeToLocalTime zt\n    day = localDay lt\n    (_, _, weekDayNumber) = toWeekDate day\n    dow = toEnum weekDayNumber\n    tod = localTimeOfDay lt\n  in\n    (tod, dow)\n\nmain :: IO ()\nmain = do\n  zt &lt;- getZonedTime\n  let (tod, dow) = timeOfDayAndDayOfWeek zt\n  print tod\n  print dow\n</code></pre>\n\n<p>You might prefer this version with a wrapper function instead of boilerplate, suggested by 4castle.  (Especially if you\u2019d have to use more than one mapping from integers to the <code>Enum</code>.)</p>\n\n<pre><code>import Data.Time.LocalTime\n  (ZonedTime, TimeOfDay, getZonedTime, localDay, localTimeOfDay,\n   zonedTimeToLocalTime)\nimport Data.Time.Calendar.WeekDate (toWeekDate)\n\ndata DayOfWeek = Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday\n  deriving (Enum, Eq, Read, Show)\n\n-- toWeekDate numbers the days 1 for Monday to 7 for Sunday.\nweekDateToDayOfWeek :: (Integer, Int, Int) -&gt; DayOfWeek\nweekDateToDayOfWeek (_, _, d) = toEnum (d-1)\n\ntimeOfDayAndDayOfWeek :: ZonedTime -&gt; (TimeOfDay, DayOfWeek)\ntimeOfDayAndDayOfWeek zt = let\n    lt = zonedTimeToLocalTime zt\n    dow = (weekDateToDayOfWeek . toWeekDate . localDay) lt\n    tod = localTimeOfDay lt\n  in\n    (tod, dow)\n\nmain :: IO ()\nmain = do\n  zt &lt;- getZonedTime\n  let (tod, dow) = timeOfDayAndDayOfWeek zt\n  print tod\n  print dow\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 1, "last_activity_date": 1583580839, "creation_date": 1583580839, "answer_id": 60577105, "question_id": 48046833, "link": "https://stackoverflow.com/questions/48046833/haskell-how-to-extract-timeofday-and-dayofweek-from-zonedtime/60577105#60577105", "title": "Haskell - How to extract TimeOfDay and DayOfWeek from ZonedTime", "body": "<p>You can go from <code>ZonedTime</code> to <code>LocalTime</code> to <code>Day</code>.</p>\n\n<p>With <code>Day</code> you can use <a href=\"https://hackage.haskell.org/package/time-1.9.3/docs/Data-Time-Calendar.html#t:DayOfWeek\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/time-1.9.3/docs/Data-Time-Calendar.html#t:DayOfWeek</a> to get a <code>DayOfWeek</code> enum.</p>\n\n<p>And use <code>localTimeOfDay</code> to go from <code>LocalTime</code> to <code>TimeOfDay</code>.</p>\n"}], "owner": {"reputation": 28880, "user_id": 471136, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70505981ff01b23b2d6da7ccb3c67785?s=128&d=identicon&r=PG", "display_name": "pathikrit", "link": "https://stackoverflow.com/users/471136/pathikrit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1583580839, "creation_date": 1514773748, "question_id": 48046833, "link": "https://stackoverflow.com/questions/48046833/haskell-how-to-extract-timeofday-and-dayofweek-from-zonedtime", "title": "Haskell - How to extract TimeOfDay and DayOfWeek from ZonedTime", "body": "<p>I am looking at the <a href=\"https://hackage.haskell.org/package/time-1.8.0.3/docs/Data-Time-LocalTime.html#g:2\" rel=\"nofollow noreferrer\">time</a> module and I want something like this:</p>\n\n<pre><code>import Data.Time.LocalTime\n\ntimeOfDayAndDayOfWeek :: ZonedTime -&gt; (TimeOfDay, DayOfWeek)\n</code></pre>\n\n<p>How do I do that?</p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514752477, "post_id": 48045500, "comment_id": 83062177, "body": "Can you describe in words, why you think the above should work. Why did you wrote something like <code>Any -&gt; Bool</code> for instance?"}, {"owner": {"reputation": 93, "user_id": 6740334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/558ad340a1e7ffa0d1e1b9182f3cb8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Perseus", "link": "https://stackoverflow.com/users/6740334/perseus"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1514753291, "post_id": 48045500, "comment_id": 83062324, "body": "Hey, that was a typo. I have now edited it. The code above checks if the given integer is part of the list but does not necessarily answer the task."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1514753411, "post_id": 48045500, "comment_id": 83062352, "body": "indeed, you more or less created <code>elem</code> (by using <code>elem</code>). Perhaps it is better to first aim to construct the function signature. What would the signature have to look like?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1514758544, "post_id": 48045500, "comment_id": 83063240, "body": "By the way, if you were a little perplexed by the definition of <code>any</code> in the <code>Prelude</code>, the type signature <code>Foldable t =&gt;</code> ... <code>t a</code> basically means, <code>t</code> is a typeclass that holds elements of type <code>a</code> and can be walked like a list. A list is an instance of <code>Foldable</code>, so <code>any</code> works on lists, and on other types that work like lists. That\u2019ll come later in your tutorials, but the <code>Num</code> hierarchy is a good introduction to the concept.  Maybe take a look at the definition of <code>Rational a</code> once you\u2019re familiar with <code>Int</code> and <code>Integer</code>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514769017, "post_id": 48045500, "comment_id": 83064590, "body": "<code>checkMatch f = foldr ((||) . f) False</code>"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 6740334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/558ad340a1e7ffa0d1e1b9182f3cb8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Perseus", "link": "https://stackoverflow.com/users/6740334/perseus"}, "edited": false, "score": 0, "creation_date": 1514756646, "post_id": 48045722, "comment_id": 83062897, "body": "Great explanation, Thanks! Not homework but a series of tasks I am attempting to level up my Haskell and functional programming skills."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 93, "user_id": 6740334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/558ad340a1e7ffa0d1e1b9182f3cb8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Perseus", "link": "https://stackoverflow.com/users/6740334/perseus"}, "edited": false, "score": 0, "creation_date": 1514756866, "post_id": 48045722, "comment_id": 83062930, "body": "Ah, okay!  Great.  In that case, you probably still want to solve it yourself, not for me to give you the answer.  One addendum: I should\u2019ve tested <code>checkMatch even []</code> for complete code coverage!"}, {"owner": {"reputation": 93, "user_id": 6740334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/558ad340a1e7ffa0d1e1b9182f3cb8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Perseus", "link": "https://stackoverflow.com/users/6740334/perseus"}, "edited": false, "score": 0, "creation_date": 1514757381, "post_id": 48045722, "comment_id": 83063038, "body": "Yes, indeed. Really appreciate your help!"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 93, "user_id": 6740334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/558ad340a1e7ffa0d1e1b9182f3cb8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Perseus", "link": "https://stackoverflow.com/users/6740334/perseus"}, "edited": false, "score": 0, "creation_date": 1514757657, "post_id": 48045722, "comment_id": 83063084, "body": "You\u2019re welcome!  You might consider accepting it, then. :)"}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 6, "last_activity_date": 1514759365, "last_edit_date": 1514759365, "creation_date": 1514755141, "answer_id": 48045722, "question_id": 48045500, "link": "https://stackoverflow.com/questions/48045500/function-that-accepts-a-function-and-a-list-and-returns-boolean/48045722#48045722", "title": "function that accepts a function and a list and returns boolean", "body": "<p>Okay.  Not a complete answer, because you want to solve the problem yourself, but some hints.</p>\n\n<p>I\u2019d strongly suggest you start out by writing the type signatures until you get a shell that compiles and handles a few cases, and then filling in the function definitions.  So let\u2019s start with the correct type signature.</p>\n\n<p>In Haskell, if you want a function that takes any types of argument, you name each type with a different lowercase name, typically a letter.  Specific types have uppercase names, generic types lowercase letters.  So a function that takes any type of argument and returns a Bool would have the type signature <code>a -&gt; Bool</code>.  For your second argument, you want to take a list of some arbitrary type of element.  You want to pass its elements to your function, so it has to contain the <em>same</em> type as the domain of the function, which we called <code>a</code>.  (If it could hold anything, we would pick another lowercase name, such as <code>b</code>.)  You write that list type as <code>[a]</code>.  You want to return a <code>Bool</code>. </p>\n\n<p>Therefore, your type signature should be <code>(a -&gt; Bool) -&gt; [a] -&gt; Bool</code>.  Typically when we write a function that operates on lists, a good approach is <em>tail-recursion</em>, where we split the list into its head and tail <code>(x:xs)</code>, do something with <code>x</code>, and then call the function again on <code>xs</code> until you end up with an empty list. You were on the right track with your pattern guards, so you can start with the following skeleton:</p>\n\n<pre><code>checkMatch :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\ncheckMatch _ [] = _\ncheckMatch f (x:xs) | f x       = _\n                    | otherwise = _\n\nmain :: IO()\nmain = do\n  let shouldBeFalse = [1,3,5,7,9] :: [Int]\n  let shouldBeTrue = [1..10] :: [Int]\n\n  print (checkMatch (== \" \") []) -- Does the empty string contain a space?\n  print (checkMatch even shouldBeFalse)\n  print (checkMatch even shouldBeTrue)\n</code></pre>\n\n<p>If you compile this, GHC will tell you that it found three \u201choles\u201d in the program, which are the three <code>_</code> symbols on the right side of the equals sign in lines 2, 3 and 4.  (The <code>_</code> in the pattern to the left of the equals sign means something different: that we don\u2019t care what the function argument is when the list is empty.  Why is that?) It will also tell you that the type it needs to fill each hole is an expression returning <code>Bool</code>.  It will also give you a list of the local functions and variables that have that type.  If you try to partly fill in one of the holes, say with <code>f _</code> or <code>checkMatch _ _</code>, it will tell you what type you need to fill in the new holes you created.</p>\n\n<p>Fill in all the holes with the correct program logic, and your program will work.</p>\n"}, {"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1514757735, "post_id": 48045764, "comment_id": 83063098, "body": "The <code>Prelude</code> also has <code>even</code>."}, {"owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1514757877, "post_id": 48045764, "comment_id": 83063121, "body": "Yep, that was for the sake of showing an example of a predicate."}], "tags": [], "owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "is_accepted": false, "score": 1, "last_activity_date": 1514756184, "last_edit_date": 1514756184, "creation_date": 1514755678, "answer_id": 48045764, "question_id": 48045500, "link": "https://stackoverflow.com/questions/48045500/function-that-accepts-a-function-and-a-list-and-returns-boolean/48045764#48045764", "title": "function that accepts a function and a list and returns boolean", "body": "<p>What you are looking for given your description is a function that takes a predicate (this is, a function that takes one or more arguments and returns a boolean) and a list, and returns true if at least one element of the list satisfies the predicate.</p>\n\n<p>In Haskell, the predicate above is a function of type: <code>a -&gt; Bool</code>. A simple example of this could be:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven x = mod x 2 == 0`\n</code></pre>\n\n<p>which takes an integer number and returns whether or not it's even.</p>\n\n<p>So, our function would be something like this:</p>\n\n<pre><code>isSatisfied :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nisSatisfied p [] = False\nisSatisfied p (x:xs) = if (p x) then True else isSatisfied p xs\n</code></pre>\n\n<p>This defines a function that takes two parameters. The first one, <code>p</code>, is a predicate over the elements of the second argument. It takes an element of type <code>a</code>, and returns true whether or not it satisfies the predicate. For example, <code>isEven</code> will return true if there's some element in the list which is even:</p>\n\n<pre><code>Prelude&gt; isSatisfied isEven [1]\nFalse\n</code></pre>\n\n<p>But, if there's some even in the list:</p>\n\n<pre><code>Prelude&gt; isSatisfied isEven [1,3,5,2,1,2]\nTrue\n</code></pre>\n\n<p>I used pattern matching to define <code>isSatisfied</code>: the first case is the empty list, since the list has no elements there's no element that satisfies the predicate so it should evaluate to <code>False</code>. The non-empty case works in a recursive way as follows: first check the predicate against the head of the list <code>x</code>, leading to two possibilities. If <code>x</code> satisfies the predicate, we found an element and we should return <code>True</code>. Otherwise, we proceed checking on the rest of the list.</p>\n\n<p>Basically, this is the definition of <code>any</code> from the Prelude:</p>\n\n<pre><code>Prelude&gt; any isEven [1,2,3,4,5]\nTrue\nPrelude&gt; any isEven []\nFalse\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6740334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/558ad340a1e7ffa0d1e1b9182f3cb8f3?s=128&d=identicon&r=PG&f=1", "display_name": "Perseus", "link": "https://stackoverflow.com/users/6740334/perseus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2012, "favorite_count": 0, "accepted_answer_id": 48045722, "answer_count": 2, "score": 3, "last_activity_date": 1514763518, "creation_date": 1514752316, "last_edit_date": 1514763518, "question_id": 48045500, "link": "https://stackoverflow.com/questions/48045500/function-that-accepts-a-function-and-a-list-and-returns-boolean", "title": "function that accepts a function and a list and returns boolean", "body": "<p>I am very new to Haskell and functional programming. I am trying to implement the task below: </p>\n\n<p>Create a function that accepts a function and a list and returns true if the function returns true for at least one item in the list, and false otherwise. Should work polymorphically.</p>\n\n<p>I have searched many ways to do it, including Prelude and the <code>any</code> function</p>\n\n<pre><code>any :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>However, I am struggling to implement them. This is what I have:</p>\n\n<pre><code>list = [2,3,45,17,78]\n\ncheckMatch :: Int -&gt; Bool \ncheckMatch x \n    | x `elem` list = True\n    | otherwise = False\n\nmain = do\n    print (checkMatch 45)\n</code></pre>\n\n<p>Any help how to use the Prelude or any function for this task. Don't just provide the answer, please do explain the procedure. Regards.</p>\n"}, {"tags": ["haskell", "gcc", "cabal"], "comments": [{"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1539693074, "post_id": 48045243, "comment_id": 92587113, "body": "This is incredibly frustrating. We had to alter the GHC include files to remove them, because it&#39;s been many months and there&#39;s still no fix to this..."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 2005704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pAFVx.jpg?s=128&g=1", "display_name": "W4t3randWind", "link": "https://stackoverflow.com/users/2005704/w4t3randwind"}, "edited": false, "score": 0, "creation_date": 1514754906, "post_id": 48045439, "comment_id": 83062606, "body": "Since the error has nothing to do with Haskell or the install, I&#39;d argue that the error is quite peripheral to the installed system. GCC 4.2/4.8 are routinely used in enterprise systems and version requirements aren&#39;t mentioned in the Haskell system documentation (rare mentions can be found in the ghci standalone for older versions of GHC, and LLVM in the newer standalones). <code>brew upgrade gcc</code> and aliasing gcc solved the issue. Thank you @chi"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1514758511, "post_id": 48045439, "comment_id": 83063234, "body": "It shouldn&#39;t be necessary to upgrade gcc.  gcc 4.8.0 was released in 2013. It doesn&#39;t support C99 <i>by default</i>. You just need to invoke it with <code>-std=c99</code> (to support C99) or <code>-std=gnu99</code> (to support C99 with GNU extensions). The default language version is <code>-std=gnu89</code>. For more recent releases, the default is <code>-std=gnu11</code>. (But if you&#39;ve upgraded gcc anyway, that should also solve it.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1514765452, "post_id": 48045439, "comment_id": 83064184, "body": "@KeithThompson Ah, right. That&#39;s an excellent advice. I can&#39;t remember how to convince <code>cabal</code> to pass on that flag, but it should be doable."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1514765651, "last_edit_date": 1514765651, "creation_date": 1514751655, "answer_id": 48045439, "question_id": 48045243, "link": "https://stackoverflow.com/questions/48045243/ghc-gcc-compiler-issue-stdc-version-w-c99-from-stg-h-fails-for-every-packa/48045439#48045439", "title": "GHC/GCC compiler issue __STDC_VERSION__ w/ C99 from Stg.h, fails for every package", "body": "<blockquote>\n  <p>the error is incredibly cryptic</p>\n</blockquote>\n\n<p>Actually, it looks pretty clear:</p>\n\n<pre><code>error: #error __STDC_VERSION__ does not advertise C99 or later\n</code></pre>\n\n<p>The C header file <code>Stg.h</code> is checking whether the compiler supports C99 (the 1999 version of the standard ISO C), using the standard macro <code>__STDC_VERSION__</code>. Since that is not set accordingly, the compiler is not C99 compliant, and the C source triggers an error.</p>\n\n<p>Basically, <code>Stg.h</code> refuses to compile with a C compiler which does not even support the 18 years old C standard. Quite reasonable.</p>\n\n<p>GCC 4.8 indeed looks ancient: the latest GCC is 7.1. I'd try to upgrade GCC to a more recent version, if not the latest.</p>\n\n<hr>\n\n<p>Update: as Keith Thompson pointed out below, GCC 4.8, in spite of its age, can support C99 if passed the flag <code>-std=c99</code>. There should be some way to instruct <code>cabal</code> to pass on this flag to <code>gcc</code>, but I can't remember how. There should be some option named something like <code>cflags</code> for this, somehwere.</p>\n"}], "owner": {"reputation": 462, "user_id": 2005704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pAFVx.jpg?s=128&g=1", "display_name": "W4t3randWind", "link": "https://stackoverflow.com/users/2005704/w4t3randwind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 48045439, "answer_count": 1, "score": 1, "last_activity_date": 1514765651, "creation_date": 1514749311, "last_edit_date": 1514758249, "question_id": 48045243, "link": "https://stackoverflow.com/questions/48045243/ghc-gcc-compiler-issue-stdc-version-w-c99-from-stg-h-fails-for-every-packa", "title": "GHC/GCC compiler issue __STDC_VERSION__ w/ C99 from Stg.h, fails for every package", "body": "<p>Whenever I try to install a package with cabal(2.0.0) on OSX 10.12.6 and GCC 4.8.0, I am met with the following error regarding the Stg.h file from GHC 8.2.1, the error is incredibly cryptic. I can't install any package on OSX. </p>\n\n<p>Expected behavior:</p>\n\n<p><code>cabal install $packagename</code> should install <code>$packagename</code> on OSX, since cabal and cabal-install are properly installed. </p>\n\n<p>Observed behavior:</p>\n\n<p><code>cabal install $packagename</code> fails due to a low-level GHC/GCC issue related to a variable called <code>__STDC_VERSION__</code>. I am not a C programmer and I don't expect my proper install of GHC and cabal to fail to install packages. AFAICT this issue is not related to user error.</p>\n\n<pre><code>Matthew@Mattmac git:the_D*+ ~/Projects/kata/euler&gt;cabal update &amp;&amp; cabal \ninstall optparse-applicative\nDownloading the latest package list from hackage.haskell.org\ngcc: warning: couldn\u2019t understand kern.osversion \u201816.7.0\ngcc: warning: couldn\u2019t understand kern.osversion \u201816.7.0\nWarning: --root-cmd is no longer supported, see\nhttps://github.com/haskell/cabal/issues/3353 (if you didn't type --root-cmd,\ncomment out root-cmd in your ~/.cabal/config file)\nResolving dependencies...\nDownloading transformers-compat-0.5.1.4...\nConfiguring colour-2.3.4...\nConfiguring transformers-compat-0.5.1.4...\nBuilding colour-2.3.4...\nBuilding transformers-compat-0.5.1.4...\nFailed to install transformers-compat-0.5.1.4\nBuild log ( /Users/Matthew/.cabal/logs/ghc-8.2.1/transformers-compat-0.5.1.4-HHfl4KyHCH71PMx2CRgdve.log ):\ncabal: Entering directory '/var/folders/qw/k0t4r5fd5_b0phjvwtxx_n700000gq/T/cabal-tmp-91946/transformers-compat-0.5.1.4'\nConfiguring transformers-compat-0.5.1.4...\ngcc: warning: couldn\u2019t understand kern.osversion \u201816.7.0\nPreprocessing library for transformers-compat-0.5.1.4..\nBuilding library for transformers-compat-0.5.1.4..\n[1 of 2] Compiling Control.Monad.Trans.Instances ( src/Control/Monad/Trans/Instances.hs, dist/build/Control/Monad/Trans/Instances.o )\n[2 of 2] Compiling Paths_transformers_compat ( dist/build/autogen/Paths_transformers_compat.hs, dist/build/Paths_transformers_compat.o )\n[1 of 2] Compiling Control.Monad.Trans.Instances ( src/Control/Monad/Trans/Instances.hs, dist/build/Control/Monad/Trans/Instances.p_o )\nIn file included from /Library/Frameworks/GHC.framework/Versions/8.2.1-x86_64/usr/lib/ghc-8.2.1/include/Rts.h:30:0: error:\n    0,\n                     from /var/folders/qw/k0t4r5fd5_b0phjvwtxx_n700000gq/T/ghc92089_0/ghc_7.c:2:\n\n/Library/Frameworks/GHC.framework/Versions/8.2.1-x86_64/usr/lib/ghc-8.2.1/include/Stg.h:30:3: error:\n     error: #error __STDC_VERSION__ does not advertise C99 or later\n     # error __STDC_VERSION__ does not advertise C99 or later\n       ^\n   |\n30 | # error __STDC_VERSION__ does not advertise C99 or later\n   |   ^\n`gcc' failed in phase `C Compiler'. (Exit code: 1)\ncabal: Leaving directory '/var/folders/qw/k0t4r5fd5_b0phjvwtxx_n700000gq/T/cabal-tmp-91946/transformers-compat-0.5.1.4'\nFailed to install colour-2.3.4\nBuild log ( /Users/Matthew/.cabal/logs/ghc-8.2.1/colour-2.3.4-9c0ktEQZfar3Wigr5kT6BU.log ):\ncabal: Entering directory '/var/folders/qw/k0t4r5fd5_b0phjvwtxx_n700000gq/T/cabal-tmp-91945/colour-2.3.4'\nConfiguring colour-2.3.4...\nPreprocessing library for colour-2.3.4..\nBuilding library for colour-2.3.4..\n[ 1 of 14] Compiling Data.Colour.CIE.Chromaticity ( \nData/Colour/CIE/Chromaticity.hs, dist/build/Data/Colour/CIE/Chromaticity.o )\n...\n[ 1 of 14] Compiling Data.Colour.CIE.Chromaticity ( Data/Colour/CIE/Chromaticity.hs, dist/build/Data/Colour/CIE/Chromaticity.p_o )\n\nIn file included from /Library/Frameworks/GHC.framework/Versions/8.2.1-x86_64/usr/lib/ghc-8.2.1/include/Rts.h:30:0: error:\n    0,\n                     from /var/folders/qw/k0t4r5fd5_b0phjvwtxx_n700000gq/T/ghc92201_0/ghc_3.c:2:\n\n/Library/Frameworks/GHC.framework/Versions/8.2.1-x86_64/usr/lib/ghc-8.2.1/include/Stg.h:30:3: error:\n     error: #error __STDC_VERSION__ does not advertise C99 or later\n     # error __STDC_VERSION__ does not advertise C99 or later\n       ^\n   |\n30 | # error __STDC_VERSION__ does not advertise C99 or later\n   |   ^\n`gcc' failed in phase `C Compiler'. (Exit code: 1)\ncabal: Leaving directory '/var/folders/qw/k0t4r5fd5_b0phjvwtxx_n700000gq/T/cabal-tmp-91945/colour-2.3.4'\ncabal: Error: some packages failed to install:\nansi-terminal-0.7.1.1-3eOIKoB8mo97DkHMJ6AgBw depends on ansi-terminal-0.7.1.1\nwhich failed to install.\nansi-wl-pprint-0.6.8.1-Ctcte9oFd5tFGoIV7u576g depends on\nansi-wl-pprint-0.6.8.1 which failed to install.\ncolour-2.3.4-9c0ktEQZfar3Wigr5kT6BU failed during the building phase. The\nexception was:\nExitFailure 1\noptparse-applicative-0.14.0.0-Iaq7kOKFg2Z4XsKvk269H6 depends on\noptparse-applicative-0.14.0.0 which failed to install.\ntransformers-compat-0.5.1.4-HHfl4KyHCH71PMx2CRgdve failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n"}, {"tags": ["haskell", "authentication", "servant"], "comments": [{"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 1, "creation_date": 1514800074, "post_id": 48044187, "comment_id": 83068759, "body": "Hello! I have done authorization a couple of times (and different ways) with servant, you can see a summary <a href=\"https://github.com/haskell-servant/servant-auth/issues/73#issuecomment-349737003\" rel=\"nofollow noreferrer\">here</a> but long story short: I don&#39;t think authorization groups &amp; what not belong to the API type, this is a private piece of information that only the server knows and cares about, and you can achieve what you want with a simple helper function or two. If you really want to explore adding authorization things to the API type, keep us posted, I just haven&#39;t found a nice way to make this work."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1514816881, "post_id": 48044187, "comment_id": 83072649, "body": "maybe this would be applicable here: <a href=\"https://stackoverflow.com/q/35246397\">stackoverflow.com/q/35246397</a>"}], "owner": {"reputation": 4970, "user_id": 1726797, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a76b9e0b9a393201d9897082bf70bf07?s=128&d=identicon&r=PG", "display_name": "nnnmmm", "link": "https://stackoverflow.com/users/1726797/nnnmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1514738414, "creation_date": 1514738414, "question_id": 48044187, "link": "https://stackoverflow.com/questions/48044187/authentication-for-groups-of-users-with-different-permissions-in-servant", "title": "Authentication for groups of users with different permissions in Servant", "body": "<p>I would like to implement a permission system for my API wherein the endpoints available to admins are a superset of those available to superusers, which are a superset of those of regular users. What is an elegant way to do this in Servant?</p>\n\n<p>Should I use several AuthProtect combinators, each of which return a User, but only if the authenticated user's privilege level is high enough? This seems like it would perhaps require writing mostly identical code each time, so maybe it's not ideal, especially if there are many groups. Is there a better way?</p>\n"}, {"tags": ["haskell", "predicate", "boolean-expression", "mod"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1514732147, "post_id": 48043436, "comment_id": 83057727, "body": "Why would it? <code>mod 9 :: Integral a =&gt; a -&gt; a</code>, while <code>0 :: Num a =&gt; a</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1514732282, "post_id": 48043436, "comment_id": 83057763, "body": "You appear to be trying to compose <code>==</code> and <code>mod 9</code>, which would look like <code>((== 0) . (mod 9)) 9</code>."}, {"owner": {"reputation": 101, "user_id": 2863992, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0229dce677f9e17c1c2e0d31c34f22aa?s=128&d=identicon&r=PG&f=1", "display_name": "spideyonthego", "link": "https://stackoverflow.com/users/2863992/spideyonthego"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1514732283, "post_id": 48043436, "comment_id": 83057765, "body": "Got it! I feel stupid now. On the bright side, Haskell&#39;s type system seems so useful in understanding code. Thank you. Should I delete this question?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1514732336, "post_id": 48043436, "comment_id": 83057785, "body": "Mmm, I wouldn&#39;t. I feel like there is a kernel of a good question here; I&#39;m just not sure how it should be worded :)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514735605, "post_id": 48043436, "comment_id": 83058636, "body": "<code>mod 9 == 0</code> means <code>(==) (mod 9) 0</code>, comparing a function (<code>mod 9</code>) and a number (<code>0</code>). Ignoring that issue, we still have that <code>(mod 9 == 0) 9</code> is <code>(==) (mod 9) 0 9</code> passing three arguments to <code>(==)</code>, which only takes two."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1514743963, "post_id": 48043436, "comment_id": 83060533, "body": "Saying e.g. &quot;<code>mod 9 9</code> should return 0&quot; is very common. You can also say &quot;<code>mod 9 9</code> should evaluate to 0&quot; which is better and more common I think, since there&#39;s no implication that <code>mod</code> fires missiles and incidentally &quot;returns&quot; <code>0</code> (where &quot;return&quot; is from the language of mutable registers, stack, pointers, etc). In other contexts you can pronounce <code>=</code> as &quot;is&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1514733406, "creation_date": 1514733406, "answer_id": 48043603, "question_id": 48043436, "link": "https://stackoverflow.com/questions/48043436/couldnt-match-expected-type-integer-t-with-actual-type-bool/48043603#48043603", "title": "Couldn&#39;t match expected type \u2018Integer -&gt; t\u2019 with actual type \u2018Bool\u2019", "body": "<p>As I mentioned in a comment, it appears that you expect <code>mod 9 == 0</code> to be a function that takes an argument, passes it to <code>mod 9</code>, then returns the result of the comparison. You can write such an expression, but it's a little more complicated.</p>\n\n<pre><code>&gt;&gt;&gt; ((== 0) . (mod 9)) 9\nTrue\n</code></pre>\n\n<p>Here, <code>(== 0) . (mod 9)</code> is the composition of two functions, <code>(== 0)</code> and <code>mod 9</code>. The composed function takes its argument, applies <code>mod 9</code> to it, then applies <code>(== 0)</code> to the result. (Where <code>(== 0)</code> is a short form for <code>\\x -&gt; x == 0</code>.)</p>\n"}], "owner": {"reputation": 101, "user_id": 2863992, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0229dce677f9e17c1c2e0d31c34f22aa?s=128&d=identicon&r=PG&f=1", "display_name": "spideyonthego", "link": "https://stackoverflow.com/users/2863992/spideyonthego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 48043603, "answer_count": 1, "score": 2, "last_activity_date": 1514733406, "creation_date": 1514731995, "question_id": 48043436, "link": "https://stackoverflow.com/questions/48043436/couldnt-match-expected-type-integer-t-with-actual-type-bool", "title": "Couldn&#39;t match expected type \u2018Integer -&gt; t\u2019 with actual type \u2018Bool\u2019", "body": "<p>In Haskell,</p>\n\n<p>This works perfectly fine:<code>(mod 9) 7</code>. It gives the expected result: remainder when 9 is divided by 7 (<strong>2</strong>).</p>\n\n<p>Similarly, this works too:<code>(mod 9) 9</code>. It returns <strong>0</strong>.</p>\n\n<p>This led me to think that <code>(mod 9 == 0) 9</code> should return <code>True</code>. However, that hasn't been the case: it threw up an error instead.</p>\n\n<p>THE ERROR:</p>\n\n<pre><code>&lt;interactive&gt;:62:1: error:\n    \u2022 Couldn't match expected type \u2018Integer -&gt; t\u2019\n                  with actual type \u2018Bool\u2019\n    \u2022 The function \u2018mod 9 == 0\u2019 is applied to one argument,\n      but its type \u2018Bool\u2019 has none\n      In the expression: (mod 9 == 0) 9\n      In an equation for \u2018it\u2019: it = (mod 9 == 0) 9\n    \u2022 Relevant bindings include it :: t (bound at &lt;interactive&gt;:62:1)\n</code></pre>\n\n<p>Please help me understand why <code>(mod 9 == 0) 9</code> wouldn't return <code>True</code>.</p>\n\n<p>P.S.: I'm convinced that my usage of \"return\" in Haskell's context is flawed. However, I am just starting out, so please excuse me. (Would be nice if you could correct me if I am, indeed, wrong.)</p>\n"}, {"tags": ["haskell", "apply", "associativity", "design-rationale", "design-choices"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1514731205, "post_id": 48043167, "comment_id": 83057502, "body": "Function application is inherently left-associative; a better question would be why is <code>$</code> right-associative?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1514731905, "post_id": 48043167, "comment_id": 83057674, "body": "Also, <code>fmap</code> is better thought of as function <i>lifting</i> rather than function application. Once <code>fmap</code> returns the lifted function, it is applied the same as any other function; no special application required."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1514733533, "last_edit_date": 1514733533, "creation_date": 1514733207, "answer_id": 48043577, "question_id": 48043167, "link": "https://stackoverflow.com/questions/48043167/why-is-left-associative/48043577#48043577", "title": "Why is &lt;$&gt; left associative?", "body": "<p>Really, the reason is probably just that it allows <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code> to share one precedence level. We definitely want <code>&lt;*&gt;</code> to be left-associative so stuff like</p>\n\n<pre><code>Prelude&gt; foldr &lt;$&gt; [(+),(*)] &lt;*&gt; [0,1] &lt;*&gt; [[1,2,3], [4,5,6]]\n[6,15,7,16,0,0,6,120]\n</code></pre>\n\n<p>works, and this also makes <code>&lt;$&gt;</code> behave the correct way even though it doesn't have higher precedence. Actually chaining multiple <code>&lt;$&gt;</code> operators is indeed not very useful with left-associativity.</p>\n\n<p><em>However, it would also not be very useful with right-associativity</em>. As chepner commented, it's actually a bit funny that <code>$</code> is right-associative. Sure, that allows writing compositions like</p>\n\n<pre><code>Prelude&gt; sum $ map (+3) $ take 19 $ cycle [4..7]\n160\n</code></pre>\n\n<p>but then, this could just as well be written as the arguably more elegant</p>\n\n<pre><code>Prelude&gt; sum . map (+3) . take 19 . cycle $ [4..7]\n160\n</code></pre>\n\n<p>(more elegant I say, because here the computation-chain is parsed as a single functional pipeline, rather than imperative-style &ldquo;do this, then that, then...&rdquo;). Thanks to the functor laws, this can be done just the same way with <code>&lt;$&gt;</code> and <code>.</code> as with <code>$</code> and <code>.</code>.</p>\n\n<p>The only reason why you might prefer the multiple-<code>$</code> style is that it allows infix expressions in the pipeline, perhaps the most common example being lens updates (which are typically written with the flipped <code>&amp;</code>, but the principle is the same):</p>\n\n<pre><code>Prelude Control.Lens&gt; [4..7] &amp; ix 1+~9 &amp; ix 2*~8\n[4,14,48,7]\n</code></pre>\n\n<p>This works because <code>$</code> and <code>&amp;</code> have very low precedence, pretty much lower than any infix operator. That's not the case for <code>&lt;$&gt;</code> so you can't do</p>\n\n<pre><code>Prelude Control.Lens&gt; ix 1+~9 &lt;$&gt; [[4..8], [5..9]]\n\n&lt;interactive&gt;:23:1: error:\n    Precedence parsing error\n        cannot mix \u2018+~\u2019 [infixr 4] and \u2018&lt;$&gt;\u2019 [infixl 4] in the same infix expression\n</code></pre>\n\n<p>In such a case, you <em>need</em> to use some parentheses anyway, and then you might as well do it with the also low-precedence composition operators from <code>Control.Category</code>:</p>\n\n<pre><code>Prelude Control.Lens Control.Category&gt; (ix 1+~9 &gt;&gt;&gt; ix 2*~8) &lt;$&gt; [[4..8], [5..9]]\n[[4,14,48,7,8],[5,15,56,8,9]]\n</code></pre>\n\n<p>or with parens around each updater:</p>\n\n<pre><code>Prelude Control.Lens&gt; (ix 1+~9) . (ix 2*~8) &lt;$&gt; [[4..8], [5..9]]\n[[4,14,48,7,8],[5,15,56,8,9]]\n</code></pre>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 2, "accepted_answer_id": 48043577, "answer_count": 1, "score": 10, "last_activity_date": 1582138527, "creation_date": 1514729619, "last_edit_date": 1582138527, "question_id": 48043167, "link": "https://stackoverflow.com/questions/48043167/why-is-left-associative", "title": "Why is &lt;$&gt; left associative?", "body": "<p><code>fmap</code> is also <code>&lt;$&gt;</code> because it is function application (<code>$</code>) in the functor category.</p>\n\n<pre><code>(+5)  $  (*10)  $  10      -- 105\n(+5) &lt;$&gt; (*10) &lt;$&gt; [1,2,3] -- [15,25,35]\n</code></pre>\n\n<p>Then I thought, well in that case <code>&lt;*&gt;</code> is function application in the applicative functor category, and this should work:</p>\n\n<pre><code>[(+5), (+10)] &lt;*&gt;  [(*10), (*100)] &lt;*&gt; [1,2,3]  -- ERROR\n-- however:\n[(+5), (+10)] &lt;*&gt; ([(*10), (*100)] &lt;*&gt; [1,2,3]) -- [15,25,35,...]\n</code></pre>\n\n<p>So, <code>&lt;$&gt;</code> only works out because <code>fmap</code> for functions happens to be postcomposition, so <code>(+5) &lt;$&gt; (*10)</code> becomes <code>(+5) . (*10)</code> which is then applied to <code>[1,2,3]</code>.</p>\n\n<p>However left associativity for all the application operators (<code>&lt;&lt;=</code> included) seems to me like a poor design choice, especially after they recognized the similarity to <code>$</code> which is already right-associative. Is there another reason for this?</p>\n"}, {"tags": ["haskell", "command-line-arguments", "haskell-cmdargs"], "answers": [{"tags": [], "owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "is_accepted": false, "score": 3, "last_activity_date": 1514725518, "creation_date": 1514725518, "answer_id": 48042712, "question_id": 48041242, "link": "https://stackoverflow.com/questions/48041242/how-to-instruct-cmdargs-to-not-parse-args-beyond-some-point/48042712#48042712", "title": "How to instruct cmdargs to not parse args beyond some point?", "body": "<p>The traditional method is not within the parser but using a <code>--</code> argument, indicating the end of flags:</p>\n\n<pre><code>$ ./args record -- something -l\nRecord {file = Nothing, command = \"something\", commandArgs = [\"-l\"]}\n</code></pre>\n\n<p>Unfortunately I don't know how to tell getArgs to do so at an arbitrary place, but I imagine it would have something to do with modes. </p>\n"}], "owner": {"reputation": 2009, "user_id": 107341, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2263e59b3b4f65895d0d3dd592f00662?s=128&d=identicon&r=PG", "display_name": "oshyshko", "link": "https://stackoverflow.com/users/107341/oshyshko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1514725518, "creation_date": 1514710797, "question_id": 48041242, "link": "https://stackoverflow.com/questions/48041242/how-to-instruct-cmdargs-to-not-parse-args-beyond-some-point", "title": "How to instruct cmdargs to not parse args beyond some point?", "body": "<p>I am working on a program that takes another command with its arguments:</p>\n\n<pre><code>$ myprog record -f 1.txt ls\n$ myprog record -f 1.txt ls -l\n</code></pre>\n\n<p>Something like sudo:</p>\n\n<pre><code>$ sudo ls\n$ sudo ls -l\n</code></pre>\n\n<p>Here is my code that uses cmdargs:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-9.20 script --package cmdargs\n\n{-# LANGUAGE DeriveDataTypeable #-}\n\nmodule Main where\n\nimport           System.Console.CmdArgs as Args\n\ndata Tape = Record  {file :: Maybe String, command :: String, commandArgs :: [String]}\n          | Replay\n            deriving (Data, Typeable, Show, Eq)\nmain :: IO ()\nmain = do\n  m &lt;- cmdArgs $ modes\n         [ Record  { file        = def &amp;= typ \"FILE\"\n                   , command     = def &amp;= typ \"COMMAND\" &amp;= argPos 0\n                   , commandArgs = def &amp;= typ \"ARGS\"    &amp;= args     }\n         , Replay ]\n  print m\n</code></pre>\n\n<p>It works nicely, but only for commands that don't have their own flags:</p>\n\n<pre><code>$ ./cmdargs.hs record -f 1.txt ls\nRecord {file = Just \"1.txt\", command = \"ls\", commandArgs = []}\n\n$ ./cmdargs.hs record -f 1.txt ls 1 2 3\nRecord {file = Just \"1.txt\", command = \"ls\", commandArgs = [\"1\",\"2\",\"3\"]}\n\n$ ./cmdargs.hs record -f 1.txt ls -l\nUnknown flag: -l\n</code></pre>\n\n<p>Q: How to instruct cmdargs to keep \"commandArgs\" as is, without looking for flags in it?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1514690140, "post_id": 48039452, "comment_id": 83049774, "body": "That definition of <code>return</code> doesn&#39;t type-check, does it?"}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1514690678, "post_id": 48039630, "comment_id": 83049856, "body": "This will fix the syntax error, but there will still be type errors for both <code>return</code> and <code>(&gt;&gt;=)</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514740981, "post_id": 48039630, "comment_id": 83059900, "body": "Indeed. I was only answering what was noted in the question, did not bother to look further. I will still leave this answer here for completeness."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1514689434, "creation_date": 1514689434, "answer_id": 48039630, "question_id": 48039452, "link": "https://stackoverflow.com/questions/48039452/how-to-make-newtype-an-instance-of-monad/48039630#48039630", "title": "How to make newtype an instance of monad", "body": "<p>You need to provide the constructor when constructing an instance of <code>Val</code> in the definition of <code>&gt;&gt;=</code>:</p>\n\n<pre><code>(&gt;&gt;=) (Val {getVal = l}) f = Val {getVal = map f l}\n</code></pre>\n\n<p>Haskell does not have \"free\" records, the way, say, PureScript does. In Haskell, <code>{ x = y, v = u }</code> on its own is not a valid syntax for constructing a record. You need to always provide the constructor, e.g. <code>C { x = y, v = u }</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 5, "last_activity_date": 1514703051, "creation_date": 1514703051, "answer_id": 48040596, "question_id": 48039452, "link": "https://stackoverflow.com/questions/48039452/how-to-make-newtype-an-instance-of-monad/48040596#48040596", "title": "How to make newtype an instance of monad", "body": "<p>There are a couple of issues here. First, you have to specify the record name before the braces. So you want</p>\n\n<pre><code>(&gt;&gt;=) (Val {getVal = l}) f = Val {getVal = map f l}\n</code></pre>\n\n<p>Now, neither of your functions is going to typecheck right now. But the fixes aren't too difficult, since you're just delegating to the already-existing list monad instance. Your <code>return</code> is close, but you need to wrap the result in a list.</p>\n\n<pre><code>return x = Val [x]\n</code></pre>\n\n<p>Likewise, you don't want <code>map</code> inside the record. You want the list monad version of <code>(&gt;&gt;=)</code>.</p>\n\n<pre><code>(&gt;&gt;=) (Val {getVal = l}) f = Val {getVal = l &gt;&gt;= f}\n</code></pre>\n\n<p>Unfortunately, this still won't <em>quite</em> typecheck, since <code>f</code> is designed to return <code>Val</code> and not <code>[]</code>. We need to make that correction inside the monad operation.</p>\n\n<pre><code>(&gt;&gt;=) (Val {getVal = l}) f = Val {getVal = l &gt;&gt;= getVal . f}\n</code></pre>\n\n<p>After that, you'll likely get errors about <code>Applicative</code> being a superclass of <code>Monad</code>. That can be solved with a simple application of some helper functions.</p>\n\n<pre><code>import Control.Monad\n\n-- ...\n\ninstance Functor Val where\n    fmap = liftM\n\ninstance Applicative Val where\n    pure = return\n    (&lt;*&gt;) = ap\n</code></pre>\n\n<p>Now everything should compile.</p>\n\n<hr>\n\n<p>As a side note, if you're using GHC, there's a handy feature called <code>GeneralizedNewtypeDeriving</code> that will give you instances for <code>newtype</code> data types automatically. You can use it like so</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nnewtype Val a = Val {getVal :: [a]}\n    deriving (Show, Functor, Applicative, Monad)\n</code></pre>\n\n<p>This only works on <code>newtype</code>, not <code>data</code>, and it only works in GHC, so don't use it if you intend your code to be portable across compilers.</p>\n"}, {"comments": [{"owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "edited": false, "score": 0, "creation_date": 1514761945, "post_id": 48042841, "comment_id": 83063727, "body": "This is advance things than i&#39;m learning but i&#39;m glad i learnt something new , thanks :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1514726728, "creation_date": 1514726728, "answer_id": 48042841, "question_id": 48039452, "link": "https://stackoverflow.com/questions/48039452/how-to-make-newtype-an-instance-of-monad/48042841#48042841", "title": "How to make newtype an instance of monad", "body": "<p><code>GeneralizedNewtypeDeriving</code> is the most convenient option here.</p>\n\n<p>A longer alternative is to use safe coercions so to ask Haskell to perform all the wrapping / unwrapping for us automatically. Unfortunately, this requires some manual type annotations and arguments, since otherwise types are too general for the automagic coercions to work.</p>\n\n<p>Not terribly convenient, but there it is.</p>\n\n<pre><code>{-# LANGUAGE InstanceSigs, ScopedTypeVariables, TypeApplications #-}\n\nimport Data.Coerce\n\nnewtype Val a = Val {getVal :: [a]} deriving (Show)\n\ninstance Functor Val where\n   fmap :: forall a b. (a -&gt; b) -&gt; Val a -&gt; Val b\n   fmap = coerce (fmap @ [] @ a @ b)\n\ninstance Applicative Val where\n   pure :: forall a. a -&gt; Val a\n   pure = coerce (pure @ [] @ a)\n   (&lt;*&gt;) :: forall a b. Val (a -&gt; b) -&gt; Val a -&gt; Val b\n   (&lt;*&gt;) = coerce ((&lt;*&gt;) @ [] @ a @ b)\n\ninstance Monad Val where\n   return :: forall a. a -&gt; Val a\n   return = coerce (return @ [] @ a)\n   (&gt;&gt;=) :: forall a b. Val a -&gt; (a -&gt; Val b) -&gt; Val b\n   (&gt;&gt;=) = coerce ((&gt;&gt;=) @ [] @ a @ b)\n</code></pre>\n\n<p>Another option would be to manually do the wrapping / unwrapping, which <code>coerce</code> automated in the code above. This is quite boring and cumbersome, though. Still, it would require no type annotations or arguments, so at least it would save effort on those.</p>\n"}], "owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 48042841, "answer_count": 3, "score": -1, "last_activity_date": 1514726728, "creation_date": 1514686892, "question_id": 48039452, "link": "https://stackoverflow.com/questions/48039452/how-to-make-newtype-an-instance-of-monad", "title": "How to make newtype an instance of monad", "body": "<p>I am stucked here, I can make <code>data</code> types instances of <code>Monad</code> but i can't figure out how i can do it with <code>newtype</code>.</p>\n\n<pre><code>newtype Val a = Val {getVal :: [a]} deriving (Show)\n\ninstance Monad Val where\n    return = Val\n    (&gt;&gt;=) (Val {getVal = l}) f  = map f l\n</code></pre>\n\n<p>If i write like this :</p>\n\n<pre><code>instance Monad Val where\nreturn = Val\n(&gt;&gt;=) (Val {getVal = l}) f  =  {getVal = map f l}\n</code></pre>\n\n<p>then i get error and it says <code>parse error on input {</code>\n.</p>\n\n<p>How do i make <code>newtype</code> an instance of Monad?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1514680707, "post_id": 48039012, "comment_id": 83048451, "body": "You can use <code>takeWhile</code> to stop processing the list when it no longer satisfies a predicate."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1514680735, "post_id": 48039012, "comment_id": 83048460, "body": "The list is monotonic increasing, but haskell doesn&#39;t know this - so it won&#39;t stop evaluating elements from it just because you go over a threshold that&#39;s tied into a predicate in a list comprehension running over it."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 2005704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pAFVx.jpg?s=128&g=1", "display_name": "W4t3randWind", "link": "https://stackoverflow.com/users/2005704/w4t3randwind"}, "edited": false, "score": 0, "creation_date": 1514687853, "post_id": 48039047, "comment_id": 83049428, "body": "The direct answer is <code>[y | y&lt;- takeWhile (\\x -&gt; x &lt; 4*10^6 + 1) fibs, even y]</code>"}], "tags": [], "owner": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "is_accepted": true, "score": 6, "last_activity_date": 1514680493, "creation_date": 1514680493, "answer_id": 48039047, "question_id": 48039012, "link": "https://stackoverflow.com/questions/48039012/projecteuler-q2-haskell-solution-wont-evaluate/48039047#48039047", "title": "ProjectEuler Q2: Haskell solution won&#39;t evaluate", "body": "<p><code>ghc</code> doesn't know when <code>[x | x&lt;-fibs, even x &amp;&amp; x &lt; (4*10^6 + 1)]</code> should terminate and it will try to exhaust the infinite list <code>fibs</code>. In otherwords, it will try to exhaust an infinte list of fibonacci numbers before termating. You should look into <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-List.html\" rel=\"noreferrer\"><code>takeWhile</code></a>.</p>\n"}], "owner": {"reputation": 462, "user_id": 2005704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pAFVx.jpg?s=128&g=1", "display_name": "W4t3randWind", "link": "https://stackoverflow.com/users/2005704/w4t3randwind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 48039047, "answer_count": 1, "score": 2, "last_activity_date": 1514680493, "creation_date": 1514680028, "question_id": 48039012, "link": "https://stackoverflow.com/questions/48039012/projecteuler-q2-haskell-solution-wont-evaluate", "title": "ProjectEuler Q2: Haskell solution won&#39;t evaluate", "body": "<p>I invite you to check out the following fibonacci related problem from <a href=\"https://projecteuler.net/problem=2\" rel=\"nofollow noreferrer\">project Euler</a>. The question asks the users to first generate a fibonacci sequence or function capable of returning the nth fibonacci number. I used the zipWith solution to generate a lazy/infinite list of fibonacci numbers:</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\n</code></pre>\n\n<p>Next, the question asks to restrict the list to fibonacci numbers/values less than 4e6, and then sum the even numbers. I <em>thought</em> this would be a very simple list comprehension:</p>\n\n<pre><code>sum [x | x&lt;-fibs, even x &amp;&amp; x &lt; (4*10^6 + 1)]\n</code></pre>\n\n<p>This expression will not finish evaluating.... I thought it would proceed until it finds the right-most number (the first fib greater than 4e6, the 34th element in the list <code>fibs!!34</code>) and then terminate the list, summing a small number of integers. What am I doing wrong?</p>\n"}, {"tags": ["haskell", "types", "functional-programming", "type-signature"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 10, "creation_date": 1514666773, "post_id": 48037709, "comment_id": 83045674, "body": "Your example is not equivalent to <code>u f = f . f</code>. In <code>g=(:[]).(:[])</code>, each <code>(:[])</code> has a different type. In <code>u f = f . f</code>, each <code>f</code> must have the same type."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514666854, "post_id": 48037709, "comment_id": 83045698, "body": "@ReinHenrichs Yes that is the problem."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1514666915, "post_id": 48037709, "comment_id": 83045717, "body": "And it is also why the problem has no solution. There is only one <code>f</code> and it may only have one type."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514667569, "post_id": 48037709, "comment_id": 83045869, "body": "@ReinHenrichs So there is simply no way to make a function that allows us to self compose any self-composable function?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1514667648, "post_id": 48037709, "comment_id": 83045884, "body": "No, <code>u</code> us that function. What you are trying to pass to it is not a self-composable function. The only self-composable functions are functions of type <code>a -&gt; a</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514667736, "post_id": 48037709, "comment_id": 83045912, "body": "Look at it another way: <code>u f</code> is the theorem that <code>f</code> is a self-composable function. The fact that <code>u (:[])</code> does not type-check is evidence that <code>(:[])</code> is not a self-composable function."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514667906, "post_id": 48037709, "comment_id": 83045962, "body": "@ReinHenrichs I think we are operating under different definitions of self-composable.  When I say self-composable I mean a function that can be composed with itself. <code>(:[])</code> by that definition is self composable since it can be composed with itself."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1514667971, "post_id": 48037709, "comment_id": 83045990, "body": "The two <code>(:[])</code> in <code>(:[]) . (:[])</code> <i>are not the same function</i>. They inhabid different types."}, {"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514667986, "post_id": 48037709, "comment_id": 83045992, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/162231/discussion-between-epsilon-neighborhood-watch-and-rein-henrichs\">continue this discussion in chat</a>."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 7, "creation_date": 1514668130, "post_id": 48037709, "comment_id": 83046042, "body": "This is an excellent question. Think <code>RankNTypes</code>. When are <i>polymorphic</i> functions composable?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 4, "creation_date": 1514668189, "post_id": 48037709, "comment_id": 83046068, "body": "<code>let u :: (forall a. a -&gt; f a) -&gt; b -&gt; f (f b); u f = f . f</code>"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1514668226, "post_id": 48037709, "comment_id": 83046076, "body": "but now <code>u not</code> doesn&#39;t typecheck"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1514865991, "post_id": 48037709, "comment_id": 83083224, "body": "If you\u2019re curious, a type system feature that would enable this is <i>intersection types</i>, which Haskell doesn\u2019t support. In such a system, <code>u</code> would have the type <code>(a -&gt; b &#47;\\ b -&gt; c) -&gt; a -&gt; c</code>. You can think of an intersection of function types as the type of an overloaded function, or as the least upper bound of the types; in Haskell\u2019s type system, the least upper bound <i>that you can express</i> for <code>a -&gt; b</code> and <code>b -&gt; c</code> is exactly what you got: <code>a -&gt; a</code> (where <code>a ~ b ~ c</code>). This also hints that <code>forall</code> represents an infinite intersection."}], "answers": [{"comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1514668819, "post_id": 48037928, "comment_id": 83046227, "body": "Fans of intersection types (I&#39;m not, but I know a few) might beg to differ."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1514669069, "post_id": 48037928, "comment_id": 83046268, "body": "@pigworker, what might it look like if we had those?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 6, "creation_date": 1514670265, "post_id": 48037928, "comment_id": 83046546, "body": "Writing <code>&amp;</code> for intersection, <code>((a -&gt; b) &amp; (b -&gt; c)) -&gt; (a -&gt; c)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1514670543, "post_id": 48037928, "comment_id": 83046605, "body": "@pigworker, ah, I see. Seems rather unlikely to show up in Haskell."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1514670668, "post_id": 48037928, "comment_id": 83046641, "body": "Ah, but then the explanation would be &quot;Haskell disallows meaningful things&quot;, and a note of contrition would be appropriate."}, {"owner": {"reputation": 13337, "user_id": 441899, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/368fb99f86e2264ceec0539a3746b9d3?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/441899/jules"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1514684318, "post_id": 48037928, "comment_id": 83048962, "body": "@pigworker - <i>all</i> non-trivial consistent type systems disallow meaningful things.   That&#39;s a direct consequence of Godel&#39;s incompleteness theorem."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1514685624, "post_id": 48037928, "comment_id": 83049142, "body": "@pigworker I&#39;ve always found bravado to be the best course for the Haskeller in these and similar situations."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 13337, "user_id": 441899, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/368fb99f86e2264ceec0539a3746b9d3?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/441899/jules"}, "edited": false, "score": 0, "creation_date": 1514717941, "post_id": 48037928, "comment_id": 83054321, "body": "@Jules That just means some contrition is inevitable. &quot;We can&#39;t do everything so we shouldn&#39;t do better.&quot; is the argument you are making. I&#39;d rather think about how to do better."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 17, "last_activity_date": 1514671324, "last_edit_date": 1514671324, "creation_date": 1514668237, "answer_id": 48037928, "question_id": 48037709, "link": "https://stackoverflow.com/questions/48037709/haskells-type-signature-of-u-f-f-f-is-stronger-than-i-would-like/48037928#48037928", "title": "Haskell&#39;s type signature of u f=f.f is stronger than I would like", "body": "<p>There are lots of different functions that can do this for specific cases, but none that work in general.</p>\n\n<pre><code>u1 :: (forall a. a -&gt; f a) -&gt; b -&gt; f (f b)\nu2 :: (forall a. f a -&gt; a) -&gt; f (f b) -&gt; b\n</code></pre>\n\n<p>and infinitely more are possible. But the function</p>\n\n<pre><code>u f x = f (f x)\n</code></pre>\n\n<p>does not <em>have</em> a most general type in Haskell when <code>RankNTypes</code> is in play. As pigworker notes, there are type systems that can give <code>u</code> a principle type of the sort you desire, but they take type system extension in a very different direction from the ones that Haskell designers have focused on.</p>\n"}], "owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 48037928, "answer_count": 1, "score": 17, "last_activity_date": 1522934384, "creation_date": 1514666594, "last_edit_date": 1522934384, "question_id": 48037709, "link": "https://stackoverflow.com/questions/48037709/haskells-type-signature-of-u-f-f-f-is-stronger-than-i-would-like", "title": "Haskell&#39;s type signature of u f=f.f is stronger than I would like", "body": "<p>I wrote the following simple function</p>\n\n<pre><code>u f=f.f\n</code></pre>\n\n<p>According to <code>ghci</code> this has the type signature of</p>\n\n<pre><code>u :: (b -&gt; b) -&gt; b -&gt; b\n</code></pre>\n\n<p>However that type signature is too strict.  Haskell is enforcing that our input be of type <code>(b -&gt; b)</code> when it shouldn't necessarily need to be.  For example the function <code>(:[])</code> has the type signature of </p>\n\n<pre><code>(:[]) :: a -&gt; [a]\n</code></pre>\n\n<p>Which is not of the form <code>(b -&gt; b)</code>, (unless you allow infinite types) and thus can't be passed to <code>u</code>.  However you can compose <code>(:[])</code> with itself.</p>\n\n<pre><code>g=(:[]).(:[])\n</code></pre>\n\n<p>This works and has the type</p>\n\n<pre><code>(:[]).(:[]) :: a -&gt; [[a]]\n</code></pre>\n\n<p>So I should be, in principle, able to pass this to <code>u</code>.</p>\n\n<p>I tried to write a new type signature myself to replace the generated signature but I could not come up with a way to express the requirements of the function.  I always come up with the same type signature that the compiler provides.  Is there a type signature we can give to weaken the <code>u</code> so that functions like <code>(:[])</code> can be passed to it?  </p>\n"}, {"tags": ["haskell", "gadt", "church-encoding"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514657069, "post_id": 48036021, "comment_id": 83043112, "body": "<code>MonoLocalBinds</code> looks quite restrictive in this case, especially because the local binding does not really involve GADTs. I wonder if a more relaxed approach could be used by GHC."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514667329, "post_id": 48036021, "comment_id": 83045810, "body": "@chi, maybe. But it&#39;s important for users to be able to predict when inference will succeed. <code>MonoLocalBinds</code> is already a bit hard to understand (because it tries to allow polymorphism sometimes); getting more clever sounds risky."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1514653140, "creation_date": 1514653140, "answer_id": 48036021, "question_id": 48035554, "link": "https://stackoverflow.com/questions/48035554/church-encoding-conversion-function-fails-to-compile-with-gadts/48036021#48036021", "title": "Church encoding conversion function fails to compile with GADTs", "body": "<p>This really doesn't have anything to do with GADTs, only, the <code>-XGADTs</code> extension also implies <code>-XMonoLocalBinds</code>, and that's the real problem here. What it does is, because the local binding <code>fn</code> has no explicit signature it wants to give it a type that is no more polymorphic than the environment... i.e. in this case <em>not polymorphic at all</em>. But of course, it <em>must</em> be polymorphic so it can actually be used in the <code>Church</code> type, so that's no good.</p>\n\n<p>You can still give an <em>explicit</em> polymorphic signature:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, MonoLocalBinds #-}\nnewtype Church = Church { unC :: forall a. (a -&gt; a) -&gt; a -&gt; a }\nto_c :: Int -&gt; Church\n-- to_c 0 = ...  -- the base case is redundant.\nto_c n =\n    let fn :: (a -&gt; a) -&gt; a -&gt; a\n        fn f c = iterate f c !! n\n    in Church fn\n</code></pre>\n\n<p>but an easier solution is to just don't make any <em>binding</em> at all, then <code>-XMonoLocalBinds</code> doesn't come into play:</p>\n\n<pre><code>to_c :: Int -&gt; Church\nto_c n = Church (\\f c -&gt; iterate f c !! n)\n</code></pre>\n\n<p>...or, if you do make a binding, do it within the <code>Church</code> constructor, because there the environment is already polymorphic:</p>\n\n<pre><code>to_c n = Church (let fn f c = iterate f c !! n in fn)\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6665045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440cdfdd21d225dbc880be6c69545c37?s=128&d=identicon&r=PG&f=1", "display_name": "skilluminati", "link": "https://stackoverflow.com/users/6665045/skilluminati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 48036021, "answer_count": 1, "score": 2, "last_activity_date": 1514653140, "creation_date": 1514649957, "last_edit_date": 1514650751, "question_id": 48035554, "link": "https://stackoverflow.com/questions/48035554/church-encoding-conversion-function-fails-to-compile-with-gadts", "title": "Church encoding conversion function fails to compile with GADTs", "body": "<p>The <code>to_c</code> function below is rejected due to a type error when compiling with the GADTs extension that I want to use for an unrelated code fragment that is not shown here. </p>\n\n<pre><code>newtype Church = Church { unC :: forall a. (a -&gt; a) -&gt; a -&gt; a }\nto_c :: Int -&gt; Church\nto_c 0 = let f0 f c = c in Church f0\nto_c n =\n    let fn f c = iterate f c !! n in Church fn\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>Couldn't match type \u2018a0\u2019 with \u2018a\u2019 because type variable \u2018a\u2019 would escape its scope\n  This (rigid, skolem) type variable is bound by\n    a type expected by the context:\n      (a -&gt; a) -&gt; a -&gt; a\n\n  Expected type: (a -&gt; a) -&gt; a -&gt; a\n    Actual type: (a0 -&gt; a0) -&gt; a0 -&gt; a0\n  In the first argument of \u2018Church\u2019, namely \u2018fn\u2019\n</code></pre>\n\n<p>I can rewrite the function in direct recursive style that will type check and also work; however, I was curious as to why this iterative approach is defective and whether it can be salvaged with some clever type annotations.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 5, "creation_date": 1514645280, "post_id": 48034774, "comment_id": 83039900, "body": "Have you tried compiling a simple application in two different ways and seeing if you get a difference? My suspicion is that you\u2019ll get bigger files if you compile without optimisation and the same size with optimisation. But it may be that you\u2019d need LTO. I don\u2019t think you\u2019ll get a difference importing functions explicitly versus a module at a time"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1514669614, "post_id": 48034774, "comment_id": 83046388, "body": "This is not a characteristic of Haskell code; it&#39;s a characteristic of linking. Firstly, if you link dynamically, none of this will make a difference so I assume you&#39;re talking about static linking. In your first case, it only has an affect if <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html#ghc-flag--split-objs\" rel=\"nofollow noreferrer\"><code>split-objs</code></a> is enabled; otherwise, the entire library is linked. In the second case, it will never make a difference; importing even no names (!) from a module requires linking in the entire module (or the entire package without <code>split-objs</code> enabled)."}, {"owner": {"reputation": 1003, "user_id": 427157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a741079b16fe45e33f518dc4f8611?s=128&d=identicon&r=PG", "display_name": "Damien Flament", "link": "https://stackoverflow.com/users/427157/damien-flament"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514670239, "post_id": 48034774, "comment_id": 83046537, "body": "@user2407038 Thanks for your answer ! Make it a real answer and I will validate it."}, {"owner": {"reputation": 1003, "user_id": 427157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a741079b16fe45e33f518dc4f8611?s=128&d=identicon&r=PG", "display_name": "Damien Flament", "link": "https://stackoverflow.com/users/427157/damien-flament"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514670514, "post_id": 48034774, "comment_id": 83046600, "body": "@user2407038 What about <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html#ghc-flag--split-sections\" rel=\"nofollow noreferrer\">split-sections</a> ? The documentation says it is more efficient than <code>split-objs</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1514750634, "post_id": 48034774, "comment_id": 83061859, "body": "@user2407038, what if no names or class instances are used (in an executable) or re-exported (in a library)? Someone could want to import a module just for type families and types without strict fields."}], "answers": [{"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 1, "last_activity_date": 1514764906, "last_edit_date": 1514764906, "creation_date": 1514761753, "answer_id": 48046202, "question_id": 48034774, "link": "https://stackoverflow.com/questions/48034774/are-explicit-imports-able-to-reduce-compiled-file-size/48046202#48046202", "title": "Are explicit imports able to reduce compiled file size?", "body": "<p>If the modules are compiled as an object file, then no, not even in theory.  Functions that can\u2019t be imported can still be used internally, and you could load the module up in <code>GHCI</code> and test the unexported internal functions.</p>\n\n<p>If you\u2019re linking statically or using specific instances of a generic function, then in theory the compiler should be able to analyze which pieces of the library are unreachable from this specific program, and as a whole-program optimization, pare them out of the executable.  (For example, if the only lists your program uses are lists of <code>Int</code>, maybe the compiler only compiles the partially-specialized <code>[Int]</code> versions of generic functions, and only the ones you use.)  However, it should be able to do the same static analysis as a whole-program optimization no matter how you declare your imports and exports.</p>\n\n<p>When compiling a dynamic library, it could in theory exclude a code path or piece of data that static analysis proves can never be reached, directly or indirectly, by any possible call through the exported interface.  If so, a compiler could use the export list to prove that some identifier in the library is completely useless and leave it out of the compiled library.</p>\n\n<p>If you\u2019re asking what some specific compiler, such as GHC 8, does, I don\u2019t know.  You\u2019d have to test it and see.</p>\n\n<p>The main benefit of specifically listing your exports and imports is that you\u2019ll never run into trouble, years later, when a second module declares an identifier you\u2019re already using.  This has happened to me before, and now I\u2019m a lot more careful.</p>\n"}], "owner": {"reputation": 1003, "user_id": 427157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/691a741079b16fe45e33f518dc4f8611?s=128&d=identicon&r=PG", "display_name": "Damien Flament", "link": "https://stackoverflow.com/users/427157/damien-flament"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 48046202, "answer_count": 1, "score": 4, "last_activity_date": 1514764906, "creation_date": 1514643558, "question_id": 48034774, "link": "https://stackoverflow.com/questions/48034774/are-explicit-imports-able-to-reduce-compiled-file-size", "title": "Are explicit imports able to reduce compiled file size?", "body": "<p>I will ask about <em>usefulness</em>. It's about the impact on the size of the compiled executable/library. Not about code maintainability or readability.</p>\n\n<h1>Importing specific module</h1>\n\n<p>Is it useful to import the only used module from a package instead of importing the main module (which imports itself the submodules).</p>\n\n<p>For example, with the <code>Foreign</code> module (which contains only an import list): </p>\n\n<pre><code>import Foreign.Storable\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>import Foreign\n</code></pre>\n\n<h1>Explicitly importing functions/types</h1>\n\n<p>Is it useful to import just the used function/types instead of importing the whole module ?</p>\n\n<p>For example:</p>\n\n<pre><code>import Foreign.ForeignPtr (ForeignPtr, mallocForeignPtr, withForeignPtr)\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>import Foreign.ForeignPtr\n</code></pre>\n"}, {"tags": ["haskell", "memory-leaks"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1514642226, "post_id": 48034553, "comment_id": 83039094, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 8601, "user_id": 433835, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3e2d4d28e146d5ea68425807f4040c07?s=128&d=identicon&r=PG", "display_name": "Koh&#225;nyi R&#243;bert", "link": "https://stackoverflow.com/users/433835/koh%c3%a1nyi-r%c3%b3bert"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514643016, "post_id": 48034553, "comment_id": 83039287, "body": "Well, I&#39;ve tried clarifying it, hope this enough. It&#39;s not minimal ... yet, but complete and verifiable! I&#39;m not sure how to make it more minimal currently, because I can&#39;t narrow down the problem (mostly because lack of experience with Haskell I think)."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514644176, "post_id": 48034553, "comment_id": 83039627, "body": "It&#39;s not complete. The code you posted here is just fragments of a function. There isn&#39;t even a <code>main</code>."}, {"owner": {"reputation": 8601, "user_id": 433835, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3e2d4d28e146d5ea68425807f4040c07?s=128&d=identicon&r=PG", "display_name": "Koh&#225;nyi R&#243;bert", "link": "https://stackoverflow.com/users/433835/koh%c3%a1nyi-r%c3%b3bert"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514644951, "post_id": 48034553, "comment_id": 83039816, "body": "I don&#39;t have time this year to make it more complete, will do so when I have the time. I could write a <code>main</code> function with minimal code if I knew what, which part exactly, which statements, what syntax, etc. causes the problem, but I don&#39;t. The help section defines a question being &quot;complete&quot; as one that contains <i>all information necessary to reproduce the problem</i>. I think my question does try hard to do so. Will knowing that the <code>Part2.hs</code> source contains the <code>main</code> function help to understand it? I can update the question later."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1514645255, "post_id": 48034553, "comment_id": 83039895, "body": "A complete question contains all the necessary code, not just a bunch of links to other sites. I&#39;m not going to click around in someone&#39;s github account, for example."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514666091, "post_id": 48035071, "comment_id": 83045509, "body": "<code>{-# language STRICT #-}</code> is a very big (and somewhat experimental) hammer. Making the type strict in its fields would definitely be worth considering."}, {"owner": {"reputation": 8601, "user_id": 433835, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3e2d4d28e146d5ea68425807f4040c07?s=128&d=identicon&r=PG", "display_name": "Koh&#225;nyi R&#243;bert", "link": "https://stackoverflow.com/users/433835/koh%c3%a1nyi-r%c3%b3bert"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514667451, "post_id": 48035071, "comment_id": 83045835, "body": "Hmm, thanks, <i>thunk accumulation</i> was the key-phrase for me. Also what @dfeuer mentions seems milder for me, I like that approach better, but thanks for the pointers! Oh, and <code>CircularBuffer</code> is used exclusively in the first part of the solution."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 1, "last_activity_date": 1514645999, "creation_date": 1514645999, "answer_id": 48035071, "question_id": 48034553, "link": "https://stackoverflow.com/questions/48034553/how-to-avoid-haskell-space-leak/48035071#48035071", "title": "How to avoid Haskell space leak?", "body": "<p>The following works:</p>\n\n<pre><code>{-# language BangPatterns #-}\n\n...\n\nstepSpinlock :: Count -&gt; Spinlock -&gt; Spinlock\nstepSpinlock count spinlock@(Spinlock !stepSize !position !value !buffer)\n...\n</code></pre>\n\n<p>On each iteration, you update <code>value</code> and <code>buffer</code> without doing anything with them, hence the thunk accumulation. Alternatively, I recommend just using <code>{-# language Strict #-}</code>. I also note that <code>CircularBuffer</code> is not used at all during the program run with <code>input.txt</code>.</p>\n"}], "owner": {"reputation": 8601, "user_id": 433835, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3e2d4d28e146d5ea68425807f4040c07?s=128&d=identicon&r=PG", "display_name": "Koh&#225;nyi R&#243;bert", "link": "https://stackoverflow.com/users/433835/koh%c3%a1nyi-r%c3%b3bert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "closed_date": 1514666070, "accepted_answer_id": 48035071, "answer_count": 1, "score": 2, "last_activity_date": 1514983005, "creation_date": 1514641860, "last_edit_date": 1592644375, "question_id": 48034553, "link": "https://stackoverflow.com/questions/48034553/how-to-avoid-haskell-space-leak", "closed_reason": "Not suitable for this site", "title": "How to avoid Haskell space leak?", "body": "<h1>Context</h1>\n<p>I've started leaning Haskell not long ago by solving this year's Advent of Code tasks.</p>\n<p>While solving <a href=\"https://adventofcode.com/2017/day/17\" rel=\"nofollow noreferrer\">Part 2 of Day 17</a> I've ran into a nasty memory leak (space leak) -- I think.</p>\n<p><sub>(Here's the full <a href=\"https://github.com/kohanyirobert/advent-of-code-2017/blob/e748d5f46007c85fcf1da6c8d87a743139edb45b/17/README.txt\" rel=\"nofollow noreferrer\">README</a> including Part 2, one can only access it after solving Part 1.)</sub></p>\n<p>My solution works and it runs fine, but only with a dirty little hack, which forces Haskell to evaluate an intermediate computation every now and then.</p>\n<p>I'm using <code>traceShow</code> to print the intermediate state to the console after every 5000 iterations (please see here <a href=\"https://github.com/kohanyirobert/advent-of-code-2017/blob/e748d5f46007c85fcf1da6c8d87a743139edb45b/17/Day17.hs#L46\" rel=\"nofollow noreferrer\">the actual code</a>). This way the program finishes in a reasonable time and doesn't use too much memory.</p>\n<p>The problem: if I remove this (not printing the intermediate state at all, only the last state) the program eats up all available memory. :(</p>\n<p>I've started out with using <code>iterate</code> and then I've read that using that can cause stuff like what I'm noticing. I've replaced it. Nothing. Tried different folds (<code>foldl</code>, <code>foldl'</code>, etc.). Nothing. I'm not sure at this point what can cause this although my guess is that at some point there's some not so evident lazy evaluation going on.</p>\n<p>My question: how can I avoid this? What causes this in my case?</p>\n<p>Thank you for your time and insight. Oh, and I'm pretty sure that there are shorter, sweeter solutions to this problem, but currently I'm only interested in what causes the memory leak in my case.</p>\n<h1>Testing</h1>\n<p>I've isolated the part of the code where I notice this error.</p>\n<pre><code>type Count = Int\ntype StepSize = Int\ntype Value = Int\ntype Position = Int\ntype Size = Int\n\ndata Buffer = Buffer Size Position (Maybe Value)\n  deriving Show\n\ndata Spinlock = Spinlock StepSize !Position !Value Buffer\n  deriving Show\n\nupdateBuffer :: Position -&gt; Value -&gt; Buffer -&gt; Buffer\nupdateBuffer position value (Buffer size trackedPosition trackedValue)\n  | position == trackedPosition = Buffer nextSize trackedPosition (Just value)\n  | otherwise = Buffer nextSize trackedPosition trackedValue\n  where nextSize = size + 1\n\nstepSpinlock :: Count -&gt; Spinlock -&gt; Spinlock\nstepSpinlock count spinlock@(Spinlock stepSize position value buffer)\n  | count == 0 = spinlock\n  | otherwise = stepSpinlock nextCount newSpinlock\n  where (Buffer size _ _) = buffer\n        nextCount = count - 1\n        nextPosition = ((position + stepSize) `mod` size) + 1\n        nextValue = value + 1\n        newBuffer = updateBuffer nextPosition nextValue buffer\n        newSpinlock = Spinlock stepSize nextPosition nextValue newBuffer\n\nmain = do\n  let stepSize = 371\n      buffer = Buffer 1 0 Nothing\n      spinlock = Spinlock stepSize 0 0 buffer\n      (Spinlock _ _ _ (Buffer _ _ (Just value))) = stepSpinlock (50000000 - 1) spinlock\n  print $ value \n</code></pre>\n<p>I'm running this with <code>stack</code> (<code>lts-10.1</code>), GHC 8.2.2.</p>\n<p>Running this eats up all of my memory and fails miserably with a <em>cannot allocate memory</em> error after a little while.</p>\n<p>If I replace this</p>\n<pre><code>  | otherwise = stepSpinlock nextCount newSpinlock\n</code></pre>\n<p>with this</p>\n<pre><code>  | otherwise = stepSpinlock nextCount $ if count `mod` 5000 == 0\n                                         then traceShow newSpinlock newSpinlock\n                                         else newSpinlock \n</code></pre>\n<p>it runs in reasonable time.\nand recompile with <code>stack ghc Part2.hs</code> then run again <code>./Part2 &lt; input.txt</code>.</p>\n"}, {"tags": ["haskell", "types", "polymorphism"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1514631269, "post_id": 48033185, "comment_id": 83036479, "body": "As a hunch, it&#39;s because <code>Foldable</code>s with &quot;length&quot; greater than <code>2^29 - 1</code> are sufficiently rare (and time-consuming to compute) that anyone needing it wouldn&#39;t mind writing a quick <code>length&#39; = foldl&#39; (\\a _ -&gt; a+1) 0</code> instead."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1514631981, "post_id": 48033185, "comment_id": 83036655, "body": "Note that genericLength does exist."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1514632618, "post_id": 48033185, "comment_id": 83036789, "body": "@Alec However it&#39;s only defined for <code>List</code>, rather than all <code>Foldable</code>s (<a href=\"https://www.haskell.org/hoogle/?hoogle=genericLength\" rel=\"nofollow noreferrer\">hoogle</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1514632403, "post_id": 48033359, "comment_id": 83036750, "body": "<code>genericLength</code> is sadly defined only for lists, not for <code>Foldable</code>s (<a href=\"https://www.haskell.org/hoogle/?hoogle=genericLength\" rel=\"nofollow noreferrer\">hoogle</a>)."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1514634407, "post_id": 48033359, "comment_id": 83037216, "body": "@hnefatl If you really want, you can define your own <code>genericLength</code> for <code>Foldable</code>."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1514635160, "post_id": 48033359, "comment_id": 83037391, "body": "@Shersh I&#39;m aware, I&#39;ve already given an implementation in my comment on the OP&#39;s question. My point is that the type of <code>genericLength</code> stated in this answer is not the same as the standard Prelude one which is linked to, which has type <code>Num i =&gt; [a] -&gt; i</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1514647591, "last_edit_date": 1514647591, "creation_date": 1514632300, "answer_id": 48033359, "question_id": 48033185, "link": "https://stackoverflow.com/questions/48033185/why-some-haskell-functions-does-not-abstract-concrete-integral-type/48033359#48033359", "title": "Why some Haskell functions does not abstract concrete integral type?", "body": "<p>Yes, perhaps, however first take note that more polymorphism is not always a good thing. If all functions have highly polymorphic arguments <em>and</em> results, then the compiler has little information to start type inference, so you end up having to type more awkward local signatures.</p>\n\n<p>Now as for <code>length</code>, there is very little reason why it you'd want a result of any other <code>Integral</code> type but <code>Int</code>, at least not on a 64-bit machine:</p>\n\n<ul>\n<li>Smaller types like <code>Word16</code> don't usually give much performance- or memory advantage in Haskell, because there'll be some boxing somwhere, and then you have a 64-bit pointer to only 16 bits of information... bit silly.</li>\n<li>It's basically impossible to have a list (let alone array or map) so large that its length can't be measured with a 63 bit word. Even for a crazy lazy list that never completely exists in memory at any time.<br>Now, strictly speaking, <code>Int</code> only guarantees 29 which can in some extreme cases be exhausted, but practically this is only relevant on 32-bit platforms which are anyways more limited in memory and performance, so you wouldn't want to juggle such huge data.</li>\n<li>For that matter, any application where performance <em>or</em> exhaustion could possibly an issue should probably be optimised to something more efficient than lists or other <code>Foldable</code> (which are always boxed due to parametricity); unboxed vectors or <code>ByteString</code>s perform much better.</li>\n<li>If you need the result to be <code>Integer</code> or something else more expensive, not for length but simply context reasons, it is probably a better idea to just calculate the length in <code>Int</code> and convert once <em>at the end</em>, rather than dragging around a slow addition through the entire list.</li>\n</ul>\n\n<p>That said, I do in fact sometimes wish the signature was in fact that of the <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-List.html#v:genericLength\" rel=\"nofollow noreferrer\">actually existing</a></p>\n\n<pre><code>genericlength :: (Foldable t, Num i) =&gt; t a -&gt; i\n</code></pre>\n\n<p>...note that the function doesn't need to <em>know</em> its result will be integral. And in fact it would often be pretty useful to make the result <em>rational</em>, so we could then just write</p>\n\n<pre><code>average :: Fractional n =&gt; [n] -&gt; n\naverage l = sum l / length l\n</code></pre>\n\n<p>instead of needing an extra <code>fromIntegral</code>.</p>\n\n<p>The reason this isn't the case in <code>Prelude.length</code>? I don't know, seems rather historical. The rationale is probably as I said in the beginning that you don't want <em>too much polymorphism</em>. Then again, IMO it's usually a good idea to make function <em>results</em> as polymorphic as possible, and rather constrain the <em>arguments</em> a bit more tightly, because then the result will always be bound to something that can be used for type inference.</p>\n"}], "owner": {"reputation": 425, "user_id": 521641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35872d2b8915024cad9ab6504bbc63df?s=128&d=identicon&r=PG", "display_name": "Nikolay Artamonov", "link": "https://stackoverflow.com/users/521641/nikolay-artamonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 48033359, "answer_count": 1, "score": 0, "last_activity_date": 1514647591, "creation_date": 1514630818, "question_id": 48033185, "link": "https://stackoverflow.com/questions/48033185/why-some-haskell-functions-does-not-abstract-concrete-integral-type", "title": "Why some Haskell functions does not abstract concrete integral type?", "body": "<p>For example, function <code>length</code> abstracts concrete sequence (<code>Foldable</code>), but do not abstract concrete integral type <code>Int</code>:</p>\n\n<pre><code>length :: Foldable t =&gt; t a -&gt; Int\n</code></pre>\n\n<p>Would it be more useable or more convenient to have following type signature?</p>\n\n<pre><code>length' :: Foldable t, Integral i =&gt; t a -&gt; i\n</code></pre>\n"}, {"tags": ["haskell", "testing", "integration-testing", "yesod", "yesod-test"], "answers": [{"comments": [{"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "edited": false, "score": 0, "creation_date": 1514686304, "post_id": 48031755, "comment_id": 83049228, "body": "This solved half of it, I have almost finished solving the other issue which I will post soon."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 2, "last_activity_date": 1514617184, "creation_date": 1514617184, "answer_id": 48031755, "question_id": 48031134, "link": "https://stackoverflow.com/questions/48031134/run-db-action-in-yesod-test/48031755#48031755", "title": "Run db action in yesod test", "body": "<p>You need to use <code>runDB</code> function. i.e:</p>\n\n<pre><code>runDB $ update 0  [UserAuthorized =. True]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 0, "last_activity_date": 1514797021, "creation_date": 1514797021, "answer_id": 48048359, "question_id": 48031134, "link": "https://stackoverflow.com/questions/48031134/run-db-action-in-yesod-test/48048359#48048359", "title": "Run db action in yesod test", "body": "<p>There were 2 problems in this, the first one as Sibi pointed out is I needed <code>runDB</code> the second one is you can't just look up a record with an integer.</p>\n\n<p>To get this working I used the following code</p>\n\n<pre><code>runDB $ do\n    (first :: Maybe (Entity User)) &lt;- selectFirst [] []\n    case first of\n        Nothing -&gt; pure () -- handle the case when the table is empty\n        Just (Entity k _) -&gt; update k [UserAuthorized =. True]\n</code></pre>\n\n<p>This find's the record in the DB and then updates it. Modify <code>(first :: Maybe (Entity User)) &lt;- selectFirst [] []</code> to select the record you want to update.</p>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 48048359, "answer_count": 2, "score": 0, "last_activity_date": 1514797021, "creation_date": 1514610252, "question_id": 48031134, "link": "https://stackoverflow.com/questions/48031134/run-db-action-in-yesod-test", "title": "Run db action in yesod test", "body": "<p>In my yesod test I want to be able to modify a record in the db in the middle of the test.</p>\n\n<p>Here is the code I came up with</p>\n\n<pre><code>        yit \"post is created by authorized user\" $ do\n            request $ do\n                addPostParam \"ident\" \"dummy\"\n                setMethod \"POST\"\n                setUrl (\"http://localhost:3000/auth/page/dummy\" :: Text)\n            update 0 [UserAuthorized =. True]\n            postBody PostR (encode $ object [\n                \"body\" .= (\"test post\" :: Text),\n                \"title\" .= (\"test post\" :: Text),\n                \"coverImage\" .= (\"test post\" :: Text),\n                \"author\" .= (0 :: Int)\n                ])\n            statusIs 200\n</code></pre>\n\n<p>This fails with the error </p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018IO a0\u2019\n              with actual type \u2018ReaderT backend0 m0 ()\u2019\n\u2022 In the second argument of \u2018($)\u2019, namely\n    \u2018update 0 [UserAuthorized =. True]\u2019\n\n  In a stmt of a 'do' block:\n    runIO $ update 0 [UserAuthorized =. True]\n  In the expression:\n    do { settings &lt;- runIO\n                     $ loadYamlSettings\n                         [\"config/test-settings.yml\", \"config/settings.yml\"] [] useEnv;\n         foundation &lt;- runIO $ makeFoundation settings;\n         yesodSpec foundation $ do { ydescribe \"Auth\" $ do { ... } };\n         runIO $ update 0 [UserAuthorized =. True];\n         .... }\n</code></pre>\n\n<p>I can tell this is because <code>update</code> returns <code>m ()</code> instead of <code>YesodExample site ()</code> like <code>request</code>, <code>postBody</code> and <code>statusIs</code> do.</p>\n\n<p>How would I be able to do a db update inside of this test?</p>\n"}, {"tags": ["haskell", "emacs", "haskell-stack", "intero"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1514624944, "post_id": 48029802, "comment_id": 83035162, "body": "Try again with  intero-0.1.24 which appears to be compatible with ghc-8.2.2."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1514690049, "post_id": 48029802, "comment_id": 83049752, "body": "How do I go about doing this? As far as I can see emacs doesn&#39;t give me any option to specify the intero version."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1514731533, "post_id": 48029802, "comment_id": 83057588, "body": "I&#39;m not quite sure actually. Simply running <code>stack install intero-0.1.24</code> might work. Or add <code>intero-0.1.24</code> to the <code>extra-deps</code> section in your <code>stack.yaml</code>."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1514792440, "post_id": 48029802, "comment_id": 83067401, "body": "<code>stack build intero-0.1.24</code> (which seems to be the proper way to do it, as intero isn&#39;t supposed to be installed globally) results in an error <code>The wrong version of Intero is installed for this Emacs package.</code>, followed by another attempted installation of <code>intero-0.1.23</code>. Adding it to <code>extra-deps</code> doesn&#39;t do anything. I also noticed that <code>intero-0.1.24</code> doesn&#39;t seem to be <a href=\"https://github.com/commercialhaskell/intero/releases\" rel=\"nofollow noreferrer\">released</a> yet..."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1514830749, "post_id": 48029802, "comment_id": 83076168, "body": "The release is listed on <a href=\"https://hackage.haskell.org/package/intero-0.1.24\" rel=\"nofollow noreferrer\">Hackage</a>. Try opening a GitHub issue to get more competent help. Also use the <code>haskell</code> tag next time for more visibility."}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1514867155, "creation_date": 1514867155, "answer_id": 48055566, "question_id": 48029802, "link": "https://stackoverflow.com/questions/48029802/intero-ghc-from-stack-configuration-does-not-match/48055566#48055566", "title": "Intero: ghc from stack configuration does not match", "body": "<p>I'm not at all an emacs expert, but I do know that the intero-mode elisp files specify an exact version of the intero Haskell package. You'll need to update to the newer emacs package. I don't know how you installed intero-mode in the first place, but I'm going to guess that (like me) you got it off MELPA. Ultimately I moved over to installing via Git so I could more easily upgrade and test features that hadn't been released on MELPA yet. You can do this by:</p>\n\n<ol>\n<li>Cloning <a href=\"https://github.com/commercialhaskell/intero\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/intero</a> somewhere on your filesystem, e.g. <code>~/.emacs.d/vendor/intero</code></li>\n<li>Add a line like this to <code>~/.emacs</code>: <code>(load-file \"~/.emacs.d/vendor/intero/elisp/intero.el\")</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "is_accepted": false, "score": 1, "last_activity_date": 1514906174, "creation_date": 1514906174, "answer_id": 48063407, "question_id": 48029802, "link": "https://stackoverflow.com/questions/48029802/intero-ghc-from-stack-configuration-does-not-match/48063407#48063407", "title": "Intero: ghc from stack configuration does not match", "body": "<p>First <code>stack update</code> and then <code>stack install intero</code> to install latest version of intero.</p>\n"}], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1828, "favorite_count": 0, "accepted_answer_id": 48055566, "answer_count": 2, "score": 5, "last_activity_date": 1514906174, "creation_date": 1514593413, "last_edit_date": 1514853801, "question_id": 48029802, "link": "https://stackoverflow.com/questions/48029802/intero-ghc-from-stack-configuration-does-not-match", "title": "Intero: ghc from stack configuration does not match", "body": "<p>When <code>intero-mode</code> tries automatically installing Intero, it produces the following error:</p>\n\n<pre><code>Intero is not installed in the Stack environment.\n\nInstalling intero-0.1.23 automatically ...\n\n\nError: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for intero-0.1.23:\n    ghc-8.2.2 from stack configuration does not match &gt;=7.8 &amp;&amp; &lt;8.2.2 (latest matching version\n              is 8.2.1)\nneeded since intero is a build target.\n\nSome potential ways to resolve this:\n\n  * Recommended action: try adding the following to your extra-deps\n    in &lt;project directory&gt;\\stack.yaml:\n\n- ghc-8.2.1\n\n  * Set 'allow-newer: true' to ignore all version constraints and build anyway.\n\n  * You may also want to try using the 'stack solver' command.\n\nPlan construction failed.\nCould not install Intero!\n\nWe don't know why it failed. Please read the above output and try\ninstalling manually. If that doesn't work, report this as a\nproblem.\n\nWHAT TO DO NEXT\n\nIf you don't want to Intero to try installing itself again for\nthis project, just keep this buffer around in your Emacs.\n\nIf you'd like to try again next time you try use an Intero\nfeature, kill this buffer.\n</code></pre>\n\n<p>This started happening after I upgraded to <code>lts-10.0</code>, but even before that I was having problems with Intero (I reported it at <a href=\"https://github.com/commercialhaskell/intero/issues/499\" rel=\"noreferrer\">https://github.com/commercialhaskell/intero/issues/499</a>). What is happening here and how can I fix it? I'm using emacs and spacemacs on Windows 10.</p>\n"}, {"tags": ["haskell", "type-inference", "gadt", "type-families"], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 4, "creation_date": 1514600382, "post_id": 48029630, "comment_id": 83030863, "body": "Do you mean turn <code>-XMonoLocalBinds</code> <i>off</i>, with <code>-XNoMonoLocalBinds</code>?"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 11, "last_activity_date": 1514605140, "last_edit_date": 1514605140, "creation_date": 1514591288, "answer_id": 48029630, "question_id": 48029598, "link": "https://stackoverflow.com/questions/48029598/typefamilies-or-gadts-suddenly-breaks-the-valid-code/48029630#48029630", "title": "TypeFamilies or GADTs suddenly breaks the valid code", "body": "<p>This is due to <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#ghc-flag--XMonoLocalBinds\" rel=\"noreferrer\"><code>-XMonoLocalBinds</code></a> which <code>-XGADTs</code> and <code>-XTypeFamilies</code> imply. You can get your code to compile again by adding a type signature to <code>andCombiner</code> (or by turning on <code>-XNoMonoLocalBinds</code>, although I do <em>not</em> recommend that):</p>\n\n<pre><code>instance Semigroup Config where\n    c1 &lt;&gt; c2 = Config\n        { cInts    = andCombiner cInts\n        , cStrings = andCombiner cStrings }\n      where\n        andCombiner :: Semigroup a =&gt; (Config -&gt; a) -&gt; a\n        andCombiner field = field c1 &lt;&gt; field c2\n</code></pre>\n\n<p>Using the terminology from the GHC docs I've linked, <code>andCombiner</code> is not fully generalized because it mentions <code>c1</code> and <code>c2</code> which are not closed or imported.</p>\n"}], "owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 48029630, "answer_count": 1, "score": 8, "last_activity_date": 1514605140, "creation_date": 1514590896, "question_id": 48029598, "link": "https://stackoverflow.com/questions/48029598/typefamilies-or-gadts-suddenly-breaks-the-valid-code", "title": "TypeFamilies or GADTs suddenly breaks the valid code", "body": "<p>I have very innocent-looking code</p>\n\n<pre><code>data Config = Config\n    { cInts    :: [Int]\n    , cStrings :: [String] }\n\ninstance Semigroup Config where\n    c1 &lt;&gt; c2 = Config\n        { cInts    = andCombiner cInts\n        , cStrings = andCombiner cStrings }\n      where\n        andCombiner field = field c1 &lt;&gt; field c2\n</code></pre>\n\n<p>It compiles and works fine. However if I add <code>TypeFamilies</code> or <code>GADTs</code> extension I see very strange error:</p>\n\n<pre><code>.../Main.hs:19:22: error:\n    \u2022 Couldn't match type \u2018Int\u2019 with \u2018[Char]\u2019\n      Expected type: [String]\n        Actual type: [Int]\n    \u2022 In the \u2018cStrings\u2019 field of a record\n      In the expression:\n        Config {cInts = andCombiner cInts, cStrings = andCombiner cStrings}\n      In an equation for \u2018&lt;&gt;\u2019:\n          c1 &lt;&gt; c2\n            = Config\n                {cInts = andCombiner cInts, cStrings = andCombiner cStrings}\n            where\n                andCombiner field = field c1 &lt;&gt; field c2\n   |\n19 |         , cStrings = andCombiner cStrings }\n   |                      ^^^^^^^^^^^^^^^^^^^^\n\n.../Main.hs:19:34: error:\n    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Int\u2019\n      Expected type: Config -&gt; [Int]\n        Actual type: Config -&gt; [String]\n    \u2022 In the first argument of \u2018andCombiner\u2019, namely \u2018cStrings\u2019\n      In the \u2018cStrings\u2019 field of a record\n      In the expression:\n        Config {cInts = andCombiner cInts, cStrings = andCombiner cStrings}\n   |\n19 |         , cStrings = andCombiner cStrings }\n   |                                  ^^^^^^^^\n</code></pre>\n\n<p>What can be the reason for this compiler error?</p>\n"}, {"tags": ["haskell", "exception", "error-handling", "either"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514587042, "post_id": 48029125, "comment_id": 83028421, "body": "Except doesn&#39;t &quot;throw it&#39;s error into the underlying monad&quot;, that&#39;s just what the MonadThrow instances is doing (N.B. <code>instance MonadThrow m =&gt; MonadThrow (ExceptT e m)</code>).  If you want to throw an exception in the Except monad then you don&#39;t need <code>Control.Exception.Safe</code> at all, just use the functions in <code>Control.Monad.Except</code>."}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1514587813, "post_id": 48029125, "comment_id": 83028609, "body": "Well I thought of <code>MonadThrow</code> (and the other typeclasses in Control.Exception.Safe) as generalizing <code>MonadError</code>, but that doesn&#39;t seem to be the case"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514613397, "post_id": 48029125, "comment_id": 83032973, "body": "<code>MonadError</code> and the design goals of <code>MonadThrow</code> didn&#39;t appear in the question. Would you care to edit?"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1514617185, "post_id": 48031497, "comment_id": 83033614, "body": "I don&#39;t see a question in your second edit and have no idea what you might be looking for in a response."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1514617521, "post_id": 48031497, "comment_id": 83033658, "body": "Oh, you want <code>MonadThrow m =&gt; m a</code> for a <code>m ~ ExceptT m2</code> with different semantics?  Well the semantics you don&#39;t like are already given for <code>ExceptT</code>. You can make a newtype such as <code>ExceptTWithString</code> and give a <code>MonadThrow</code> instance you like.  Aren&#39;t we just spinning around the same point that you don&#39;t like the existing <code>MonadThrow</code> instance?"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1514614110, "creation_date": 1514614110, "answer_id": 48031497, "question_id": 48029125, "link": "https://stackoverflow.com/questions/48029125/control-exception-safe-why-do-exceptt-and-either-behave-so-differently/48031497#48031497", "title": "Control.Exception.Safe, why do ExceptT and Either behave so differently?", "body": "<blockquote>\n  <p>Ok, so apparently Except throws its error into its underlying monad in the transformer stack? </p>\n</blockquote>\n\n<p>As I said in the comment: Except doesn't \"throw it's error into the underlying monad\", that's just what the MonadThrow instances is doing.</p>\n\n<blockquote>\n  <p>But why is that?</p>\n</blockquote>\n\n<p>The instance of MonadThrow can not throw a String exception into <code>ExceptT e</code> for all types <code>e</code> and rather than have an instance just for <code>ExceptT String</code> it appears the author lifted to throw an exception on the next higher monad.</p>\n\n<blockquote>\n  <p>Isn't Except basically designed to handle exceptions?</p>\n</blockquote>\n\n<p>Indeed <code>Except</code> is designed to allow for failure in exceptional cases.</p>\n\n<p>Being pedantic, I'd call it an alternative to exceptions.  A monad plumbing an alternative notion of return (an error case) and calling itself \"Except\" doesn't actually mean any of the typical exception options, such as a low level stack unwinding, is in use.</p>\n\n<blockquote>\n  <p>Why this weird behavior? </p>\n</blockquote>\n\n<p>Because of the MonadThrow instance, which is re-exported from <code>Control.Monad.Throw</code>:</p>\n\n<pre><code>-- | Throws exceptions into the base monad.\ninstance MonadThrow m =&gt; MonadThrow (ExceptT e m) where\n  throwM = lift . throwM\n</code></pre>\n\n<blockquote>\n  <p>Why not the equivalent of Left \"Foo\"</p>\n</blockquote>\n\n<p>Because then the instance would have to be for <code>ExceptT String</code> instead of <code>ExceptT e</code>.  Or, that is why I think the author of <code>exceptions</code> (Edward Kmett) decided on this design.</p>\n\n<p>Instead, consider using <code>Control.Monad.Except.throwError</code> which does what it sounds like you want.</p>\n\n<blockquote>\n  <p>What do I do, when I want to use the behaviour of <code>Either e a</code> that is supplied by Control.Exception.Safe but in the context of monad transformers?</p>\n</blockquote>\n\n<p>What \"behavior of <code>Either e a</code> are you talking about?  How is what you are looking for different from <code>throwError</code>?  As far as I can tell, you are looking for an unnecessary extra layer of abstraction.</p>\n"}, {"tags": [], "owner": {"reputation": 224, "user_id": 10668680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c4996037684a7b9e963c7c3d19c260?s=128&d=identicon&r=PG&f=1", "display_name": "Erick Gonzalez", "link": "https://stackoverflow.com/users/10668680/erick-gonzalez"}, "is_accepted": false, "score": 2, "last_activity_date": 1547410698, "creation_date": 1547410698, "answer_id": 54172821, "question_id": 48029125, "link": "https://stackoverflow.com/questions/48029125/control-exception-safe-why-do-exceptt-and-either-behave-so-differently/54172821#54172821", "title": "Control.Exception.Safe, why do ExceptT and Either behave so differently?", "body": "<p>This is a bit of an old question but I think there is room to improve on this answer as I recently ran into this topic at work. Let's see, I believe that your expectation of having <code>ExceptT</code> behave similar to <code>Either</code> makes sense, but unfortunately the author of <code>MonadThrow</code> chose a different stance and decided that \"passing\" the decision on how to \"throw\" a failure to the underlying monad (or transformer) was the right way to go. Without attempting to speculate why decision was made, I agree that this behavior defeats the purpose of using a \"failable\" transformer such as 'MaybeT' or 'ExceptT' as an instance of an error class like <code>MonadThrow</code>, which is to give \"Maybe\" or \"Either\" like semantics to a different monad.</p>\n\n<p>For this reason I have donned my flame vest and took a stab at <code>Control.Monad.Failable</code> , which would do exactly what you (and I) would expect, which is to return something like <code>Left e</code> where e is an instance of <code>Exception</code>.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/failable-0.1.0.3\" rel=\"nofollow noreferrer\">Control.Monad.Failable</a></p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1547410698, "creation_date": 1514586674, "last_edit_date": 1514616862, "question_id": 48029125, "link": "https://stackoverflow.com/questions/48029125/control-exception-safe-why-do-exceptt-and-either-behave-so-differently", "title": "Control.Exception.Safe, why do ExceptT and Either behave so differently?", "body": "<p>I'm trying to use <code>Control.Exception.Safe</code> with <code>Control.Monad.Except</code>.</p>\n\n<pre><code>throwString \"Foo\" :: Except String a\n-- error, no instance for `MonadTrow Identity`\n</code></pre>\n\n<p>Ok, so apparently <code>Except</code> throws its error into its underlying monad in the transformer stack?\nBut why is that? Isn't <code>Except</code> basically designed to handle exceptions? Why this weird behavior? Why not the equivalent of <code>Left \"Foo\"</code></p>\n\n<p>EDIT:</p>\n\n<p>Okay to further illustrate my problem:</p>\n\n<p>I thought <code>ExceptT e m a</code> was to <code>Either e a</code> what <code>ReaderT a m b</code> is to <code>a -&gt; b</code>. <code>Control.Monad.Except.throwError</code>, and <code>catchError</code> work exactly like <code>Control.Exception.Safe.throw</code>, and <code>catch</code> do with <code>Either e a</code>.\nHowever they suddenly work different when applied to <code>Except e a</code>. </p>\n\n<p>What do I do, when I want to use the behaviour of <code>Either e a</code> that is supplied by <code>Control.Exception.Safe</code> but in the context of monad transformers?</p>\n\n<p>My context is that I do \"Write yourself a Scheme in 48 hours\" and wanted to generalize errors (with <code>MonadThrow</code>), so that I can do some IO stuff with it.</p>\n\n<p>EDIT2:</p>\n\n<p>Example:</p>\n\n<pre><code>data CountError = CountError deriving (Show, Except)\n\nx :: String -&gt; ExceptT CountError (Writer [String]) Int\nx str = do { lift $ writer (length \"str\", return str); }\n</code></pre>\n\n<p>Now this count characters and collects the strings in the writer. This could be extended however much you want. The error could signal \"wrong character in string\", or \"too many characters\", or whatever.</p>\n\n<pre><code>y :: MonadThrow m =&gt; m a\ny = throw CountError\n</code></pre>\n\n<p>This is a very general exception, which I could use for composition with any other kind of exception, except for <code>ExceptT</code>:</p>\n\n<pre><code>y &gt;&gt; x\n-- No instance for MonadThrow Identity\n-- But what I want is (Left CountError, [])\n</code></pre>\n"}, {"tags": ["haskell", "garbage-collection", "ffi"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1514591890, "post_id": 48028503, "comment_id": 83029467, "body": "<a href=\"http://www.tweag.io/posts/2017-11-29-linear-jvm.html\" rel=\"nofollow noreferrer\">This blog post</a> talks about this problem. It is a good summary of the current state of the art for this sort of thing."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1514583001, "creation_date": 1514583001, "answer_id": 48028656, "question_id": 48028503, "link": "https://stackoverflow.com/questions/48028503/foreign-data-and-garbage-collection/48028656#48028656", "title": "Foreign data and garbage collection", "body": "<p>Understanding when a pointer becomes unreferenced is not trivial. \nAs far as I know, there is no way to perform what you request, namely inform the GC that a pointer is now no longer reachable. At best, one can trigger a GC cycle, but there are no hard guarantees.</p>\n\n<p>From your description, you probably would prefer a reference-counting mechanism instead of garbage collection. However, especially in complex pure code, it is hard to identify the points where the counter should be incremented or decremented: it would be easier in a state or IO-based monad where such side effects are properly sequenced w.r.t. the rest of the computation.</p>\n\n<p>If you don't really need reference counting beyond \"one\", a somehow common idiom is using a <code>with</code>-style function for handling the allocation and deallocation. \nThis can get a bit tricky to handle correctly.</p>\n\n<p>For instance, a trivial implementation could be</p>\n\n<pre><code>-- very simplified code\nwithMyResource :: (ResourcePtr -&gt; IO r) -&gt; IO r\nwithMyResource action = do\n   p &lt;- allocResourcePtr\n   result &lt;- action p\n   deallocResourcePtr p\n   return result\n</code></pre>\n\n<p>This can then be used as</p>\n\n<pre><code>withResource $ \\ptr -&gt; do\n   use ptr\n</code></pre>\n\n<p>Note that this is not completely safe, since one might return the pointer, making it live after its deallocation</p>\n\n<pre><code>ptr &lt;- withResource return\nuse ptr -- dangerous!\n</code></pre>\n\n<p>A properly pointer-handling routine should work like the <code>ST</code> monad and its tagged <code>STRef</code>s, which are designed so to prevent pointers to escape their intended scope (as done above). This exploits rank-2 types, but is effective.</p>\n\n<p>Still, one can live with the naive <code>with</code> routine, and just be careful to not let pointers escape.</p>\n\n<p>Another unsafety issue is caused by <code>action</code> being able to throw exceptions. (This can be handled using <code>bracket</code>-like routines from the library).</p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 3, "last_activity_date": 1514585159, "last_edit_date": 1514585159, "creation_date": 1514583455, "answer_id": 48028714, "question_id": 48028503, "link": "https://stackoverflow.com/questions/48028503/foreign-data-and-garbage-collection/48028714#48028714", "title": "Foreign data and garbage collection", "body": "<p>The RTS has no idea whether any piece of data is unreferenced until GC is run. GHC does not have reference counting GC, which would allow immediate action on garbage. You could try to implement reference counting yourself, or use manual GC from <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/System-Mem.html\" rel=\"nofollow noreferrer\"><code>System.Mem</code></a>.</p>\n\n<p>Foreign allocation isn't tracked in Haskell-land. If you want more control, but no custom GC or reference counting, you can use e. g. <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Foreign-Marshal-Array.html\" rel=\"nofollow noreferrer\"><code>Foreign.Marhsal.Array</code></a> for manual/scoped allocation and deallocation.</p>\n\n<p>Another option is to use pinned allocation in GHC RTS. This gives you memory which is not moved by GC. References to pinned data can be passed to foreign code without overhead, but pinned data is tracked, can be GC-d, and triggers GC the same way as usual heap data does. <a href=\"https://hackage.haskell.org/package/primitive-0.6/candidate/docs/Data-Primitive-ByteArray.html\" rel=\"nofollow noreferrer\">Here's</a> one API for pinned data. Another choice is simply <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString.html\" rel=\"nofollow noreferrer\"><code>ByteString</code></a>. The possible drawback of pinned data is memory fragmentation and slower allocation, but that also holds for (any) foreign allocation which returns stable pointers.</p>\n"}], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 48028714, "answer_count": 2, "score": 1, "last_activity_date": 1514585159, "creation_date": 1514581896, "question_id": 48028503, "link": "https://stackoverflow.com/questions/48028503/foreign-data-and-garbage-collection", "title": "Foreign data and garbage collection", "body": "<p>When I allocate some data via FFI and associate a finalizer with it, I get a <code>ForeignPtr</code> in Haskell. When this pointer becomes unreferenced, GC collects the pointer, which causes finalizer to run. But the collecting only happens when GC has run and \"unreferencing\" doesn't force GC to run. I.e. there can be many pointers lying around, but since pointers themselves do not occupy much memory, RTS simply doesn't see a reason to start GC, because the size of foreign data is not tracked by the RTS, according to my <a href=\"https://github.com/effectfully/haskell-ffi-example/blob/f7837c4304442a3b595caf0533dae1d47a78ab66/src/Main.hs#L28\" rel=\"nofollow noreferrer\">investigations</a>. Is this correct?</p>\n\n<p>How do I communicate \"when this pointer becomes unreferenced, collect it immediately\" to the RTS? Are there any flags that allow to control when to start GC? Is this a problem for a real program (as any real program always has enough explicit garbage to stimulate GC)?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "edited": false, "score": 6, "creation_date": 1514565575, "post_id": 48025222, "comment_id": 83020729, "body": "This isn\u2019t directly related to your question, but I\u2019d strongly advise you not to use floating-point values to represent money. If you use integers instead\u2014an integer number of cents, for example, if you\u2019re dealing with U.S. currency\u2014then you will no longer have to worry about things like the epsilon in your example: you can add, subtract, and multiply currency values without needing to worry about rounding or things like that."}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1514571319, "post_id": 48025549, "comment_id": 83023060, "body": "Using record syntax would also create the <code>extractExpense</code> function for you."}], "tags": [], "owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "is_accepted": true, "score": 2, "last_activity_date": 1514565138, "creation_date": 1514565138, "answer_id": 48025549, "question_id": 48025222, "link": "https://stackoverflow.com/questions/48025222/haskell-make-a-list-of-the-variables-of-a-list/48025549#48025549", "title": "Haskell make a list of the variables of a list", "body": "<p>You can proceed as follows:</p>\n\n<pre><code>balanced :: [Expense] -&gt; Double -&gt; Bool\nbalanced expenses epsilon =\n  let amounts = map extractExpense expenses\n  in maximum amounts - minimum amounts &lt; epsilon\n</code></pre>\n\n<p>And <code>extractExpense</code> would be the unwrapper of the <code>Double</code> value of your data:</p>\n\n<pre><code>extractExpense :: Expense -&gt; Double\nextractExpense (MkExpense expense _) = expense\n</code></pre>\n\n<p>Or more concise:</p>\n\n<pre><code>balanced :: [Expense] -&gt; Double -&gt; Bool\nbalanced expenses epsilon =\n  let amounts = map extractExpense expenses\n  in maximum amounts - minimum amounts &lt; epsilon\n    where extractExpense (MkExpense e _) = e\n</code></pre>\n"}], "owner": {"reputation": 1375, "user_id": 1881719, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f9d319fb5c2669d9bab860c9b2227505?s=128&d=identicon&r=PG", "display_name": "Wouter Vandenputte", "link": "https://stackoverflow.com/users/1881719/wouter-vandenputte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 48025549, "answer_count": 1, "score": 0, "last_activity_date": 1514565138, "creation_date": 1514563578, "question_id": 48025222, "link": "https://stackoverflow.com/questions/48025222/haskell-make-a-list-of-the-variables-of-a-list", "title": "Haskell make a list of the variables of a list", "body": "<p>Suppose I have the data</p>\n\n<pre><code>data Expense = MkExpense Double String deriving (Eq,Ord)\n</code></pre>\n\n<p>and a function </p>\n\n<pre><code>balanced :: [Expense] -&gt; Double -&gt; Bool\nbalanced expenses epsilon =\n  let amounts = ...\n  in maximum amounts - minimum amounts &lt; epsilon;\n</code></pre>\n\n<p>which computes wether the list of expenses is balances (i.e. everyone paid the same with a maximum difference of epsilon due to floating point errors), the epsilon has a value of 0.01.</p>\n\n<p>The alogrithm is correct, but where the three dots are, I want to extract a list of doubles; i.e. the doubles of all the expenses in my parameter. How can I do that without changing the datatype?</p>\n"}, {"tags": ["haskell", "haskell-stack", "test-suite"], "answers": [{"tags": [], "owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "is_accepted": true, "score": 3, "last_activity_date": 1514624757, "creation_date": 1514624757, "answer_id": 48032473, "question_id": 48025206, "link": "https://stackoverflow.com/questions/48025206/tests-output-in-multi-package-project-is-not-shown-with-stack-test/48032473#48032473", "title": "Tests output in multi-package project is not shown with `stack test`", "body": "<p>You can use the <code>--dump-logs</code> flag or use <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#dump-logs\" rel=\"nofollow noreferrer\">the corresponding option</a> by adding the follow line to your <code>stack.yaml</code>:</p>\n\n<pre><code>dump-logs: all\n</code></pre>\n"}], "owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 48032473, "answer_count": 1, "score": 3, "last_activity_date": 1514624757, "creation_date": 1514563519, "question_id": 48025206, "link": "https://stackoverflow.com/questions/48025206/tests-output-in-multi-package-project-is-not-shown-with-stack-test", "title": "Tests output in multi-package project is not shown with `stack test`", "body": "<p>I have a multi-package project with test suits in every package. When I run <code>stack test</code> command I expect output of every package's tests to be shown, but it's not. Here is what I've got:</p>\n\n<pre><code>package1-0.1.0.0: test (suite: package1-test)\npackage2-0.1.0.0: test (suite: package2-test)\npackage3-0.1.0.0: build (test)\npackage1-0.1.0.0: Test suite package1-test passed\npackage3-0.1.0.0: test (suite: package3-test)\npackage3-0.1.0.0: Test suite package3-test passed\n...\n</code></pre>\n\n<p>What I would like to see is something like this:</p>\n\n<pre><code>   test/Test.hs\n      Test.Pack1\n        Ggurda\n          skovoroda:  OK (0.41s)\n            OK\n          patak: OK (7.59s)\n            OK\n</code></pre>\n\n<p>I'm able too see detailed test output if I specify package explicitly (<code>stack test package1:test:package1-test</code>), but I don't want to do it by hands for all packages I have.</p>\n\n<p>Is there a command that would help to show detailed output of each test results of every package?</p>\n"}, {"tags": ["haskell", "functor", "recursive-datastructures"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1514555039, "post_id": 48023348, "comment_id": 83016153, "body": "You can&#39;t use <code>deriving (Functor)</code> in vanilla Haskell. You need the pragma <code>{-# LANGUAGE DeriveFunctor #-}</code> at the top of your file. More info <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/DeriveFunctor\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1514557340, "post_id": 48023602, "comment_id": 83017117, "body": "Rather, the compiler <i>can</i> derive a <code>Functor</code> instance (it&#39;s fairly trivial to do so), it just isn&#39;t <i>required</i> to do so in Haskell 2010."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 2, "last_activity_date": 1514555298, "creation_date": 1514555298, "answer_id": 48023602, "question_id": 48023348, "link": "https://stackoverflow.com/questions/48023348/deriving-a-functor-for-an-infinite-stream/48023602#48023602", "title": "deriving a Functor for an infinite Stream", "body": "<p><code>deriving</code> is very limited in Haskell without using language extensions. Since the compiler can't always work out what a <code>Functor</code> instance should be, <code>deriving Functor</code> is not standard Haskell.</p>\n\n<p>However, there is a language extension that allows this, namely <code>-XDeriveFunctor</code>. To enable this extension do one of:</p>\n\n<ul>\n<li><p>Compile with the flag <code>-XDeriveFunctor</code>. (Eg: run <code>ghc -XDeriveFunctor Main.hs</code> when compiling)</p></li>\n<li><p>Write the pragma <code>{-# LANGUAGE DeriveFunctor #-}</code> at the top of your file.</p></li>\n</ul>\n\n<p>Here's how your file would look with this pragma added:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nnewtype Fix f = Fix (f (Fix f))\nunFix :: Fix f -&gt; f (Fix f)\nunFix (Fix x) = x\n\ncata :: Functor f =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a\ncata alg = alg . fmap (cata alg) . unFix\n\nana :: Functor f =&gt; (a -&gt; f a) -&gt; a -&gt; Fix f\nana coalg = Fix . fmap (ana coalg) . coalg\n\ndata StreamF e a = StreamF e a\n    deriving Functor\ndata Stream e = Stream e (Stream e)\n\nera :: [Int] -&gt; StreamF Int [Int]\nera (p : ns) = StreamF p (filter (notdiv p) ns)\n    where notdiv p n = n `mod` p /= 0\n\nprimes = ana era [2..]\n</code></pre>\n\n<p>If you plan on using GHCi, use <code>:set -XDeriveFunctor</code> before loading the file.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6996876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 48023602, "answer_count": 1, "score": 2, "last_activity_date": 1563169614, "creation_date": 1514554082, "last_edit_date": 1563169614, "question_id": 48023348, "link": "https://stackoverflow.com/questions/48023348/deriving-a-functor-for-an-infinite-stream", "title": "deriving a Functor for an infinite Stream", "body": "<p>I'm following this <a href=\"https://bartoszmilewski.com/2017/02/28/f-algebras/\" rel=\"nofollow noreferrer\">blog</a> about F-algebras\nIt explains that</p>\n\n<blockquote>\n  <p>A terminal coalgebra is usually interpreted in programming as a recipe\n  for generating (possibly infinite) data structures or transition\n  systems.</p>\n</blockquote>\n\n<p>and says  that</p>\n\n<blockquote>\n  <p>A canonical example of a coalgebra is based on a functor whose fixed\n  point is an infinite stream of elements of type e. This is the\n  functor:</p>\n</blockquote>\n\n<pre><code>data StreamF e a = StreamF e a\n  deriving Functor\n</code></pre>\n\n<p>and this is its fixed point:</p>\n\n<pre><code>data Stream e = Stream e (Stream e)\n</code></pre>\n\n<p>I\u2019ve tried the code <a href=\"https://repl.it/repls/FeistyActualBrownbutterfly\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>the relevant part being</p>\n\n<pre><code>newtype Fix f = Fix (f (Fix f))\nunFix :: Fix f -&gt; f (Fix f)\nunFix (Fix x) = x\n\ncata :: Functor f =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a\ncata alg = alg . fmap (cata alg) . unFix\n\nana :: Functor f =&gt; (a -&gt; f a) -&gt; a -&gt; Fix f\nana coalg = Fix . fmap (ana coalg) . coalg\n\ndata StreamF e a = StreamF e a\n    deriving Functor\ndata Stream e = Stream e (Stream e)\n\nera :: [Int] -&gt; StreamF Int [Int]\nera (p : ns) = StreamF p (filter (notdiv p) ns)\n    where notdiv p n = n `mod` p /= 0\n\nprimes = ana era [2..]\n</code></pre>\n\n<p>I\u2019m getting this error</p>\n\n<pre><code>main.hs:42:14: error:\n\u2022 Can\u2019t make a derived instance of \u2018Functor (StreamF e)\u2019:\nYou need DeriveFunctor to derive an instance for this class\n\u2022 In the data declaration for \u2018StreamF\u2019\n</code></pre>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["haskell", "newtype"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1514526156, "post_id": 48017808, "comment_id": 83004901, "body": "Functions such as <code>run*</code>, <code>eval*</code>, and <code>exec*</code> have to do with particular monads (Reader, and State in this case).  How deep an answer regarding Monads would you like?"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514526498, "post_id": 48017808, "comment_id": 83004979, "body": "As general as possible. I would like to understand the tutorials that seem to asume that I understand this convention."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1514526653, "post_id": 48017808, "comment_id": 83005023, "body": "Perhaps you should read the wikibook <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads/State\" rel=\"nofollow noreferrer\">chapter on the State monad</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1514549220, "post_id": 48017808, "comment_id": 83013808, "body": "These often just remove a <code>newtype</code> wrapper, exposing the underlying type. Sometimes we also find <code>unSomething, getSomething, appSomething</code> for a similar unwrapping. E.g. <code>appEndo, getDual</code>. I wish the convention were more uniform."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 10, "creation_date": 1514526935, "post_id": 48018042, "comment_id": 83005086, "body": "And for completeness: <code>evalSomething</code> is for when you don&#39;t care about the effects and want the lightest-weight possible way to get the value it computes, while <code>execSomething</code> is for when you only care about the effects and the value it computes at the end is irrelevant."}], "tags": [], "owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "is_accepted": true, "score": 10, "last_activity_date": 1514526666, "creation_date": 1514526666, "answer_id": 48018042, "question_id": 48017808, "link": "https://stackoverflow.com/questions/48017808/what-is-the-meaning-for-the-convention-runsomething-in-the-haskell-community/48018042#48018042", "title": "What is the meaning for the convention &quot;runSomething&quot; in the Haskell community?", "body": "<p>In Haskell, the convention <code>runSomething</code> means 'execute the effects described inside the given argument, and return the resulting value'.</p>\n\n<p>I purposely said 'effects' because I was being fuzzy; in Haskell you use the type system to describe different effects that might happen, like doing I/O, or modifying state, etc. So depending on the exact type, different effects might be run before the final value is returned.</p>\n"}], "owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 1, "accepted_answer_id": 48018042, "answer_count": 1, "score": 6, "last_activity_date": 1514526666, "creation_date": 1514525267, "last_edit_date": 1514525674, "question_id": 48017808, "link": "https://stackoverflow.com/questions/48017808/what-is-the-meaning-for-the-convention-runsomething-in-the-haskell-community", "title": "What is the meaning for the convention &quot;runSomething&quot; in the Haskell community?", "body": "<p>I've seen in some docs and tutorials:</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html\" rel=\"noreferrer\">runReader</a></li>\n<li><a href=\"https://wiki.haskell.org/State_Monad#Primitives\" rel=\"noreferrer\">runState</a></li>\n<li><a href=\"http://www.learnyouahaskell.com/for-a-few-monads-more\" rel=\"noreferrer\">runState</a></li>\n</ul>\n\n<p>What is the abstract concept that this pattern covers? What does running something mean in Haskell?</p>\n\n<p>Side question, is there a tag for things you always wanted to know but were too afraid to ask?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 5, "creation_date": 1514519373, "post_id": 48017130, "comment_id": 83003437, "body": "<code>unsafePerformIO</code> is almost certainly the wrong answer. What solution did you attempt that gave you an <code>IO</code> where you weren&#39;t expecting it?"}, {"owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1514519464, "post_id": 48017130, "comment_id": 83003451, "body": "It&#39;s called &quot;Array of N elements&quot;, Link: <a href=\"https://www.hackerrank.com/challenges/fp-array-of-n-elements/problem\" rel=\"nofollow noreferrer\">hackerrank.com/challenges/fp-array-of-n-elements/problem</a>  the haskell version atleast."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1514519555, "post_id": 48017130, "comment_id": 83003467, "body": "Yes, I understand that. It&#39;s a programming challenge, which means you have to have attempted it with some code. What code did you use? Simply running the challenge with a blank function is not going to accomplish anything."}, {"owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1514519752, "post_id": 48017130, "comment_id": 83003506, "body": "fn n = [1..(unsafePerformIO n)]"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1514519753, "post_id": 48017130, "comment_id": 83003507, "body": "Okay, I think I understand your confusion now. Does my answer help?"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1514520115, "post_id": 48017130, "comment_id": 83003578, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9932913/bindings-in-do-notation\">&quot;&lt;-&quot; bindings in do notation</a>"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "edited": false, "score": 0, "creation_date": 1514520082, "post_id": 48017199, "comment_id": 83003568, "body": "Oh I understand now. So the code would be same if it was just <code>n &lt;- readLn</code> instead of <code>n&lt;-readLn : IO Int</code>? Also I think I&#39;ll have to write <code>fn :: Int-&gt;[Int]</code>"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "edited": false, "score": 0, "creation_date": 1514520146, "post_id": 48017199, "comment_id": 83003589, "body": "Yes. The type signature is only there to remind you, the coder, what type you need to input. And you&#39;re correct about the output type; that was an oversight on my part."}, {"owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "edited": false, "score": 0, "creation_date": 1514520267, "post_id": 48017199, "comment_id": 83003617, "body": "I tried this: <code>fn :: Int -&gt; [Int]   fn n = [1..n]</code> but it threw <code>Couldn&#39;t match expected type \u2018t0 -&gt; [Int]\u2019                   with actual type \u2018[Int]\u2019</code> What does the type t0 mean? Any ambigous type?"}, {"owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "edited": false, "score": 0, "creation_date": 1514520412, "post_id": 48017199, "comment_id": 83003659, "body": "Hey. I just figured it out. Apparently I had to remove the underlines before submitting. :)"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "edited": false, "score": 0, "creation_date": 1514520427, "post_id": 48017199, "comment_id": 83003663, "body": "Ah okay. Glad you figured it out!"}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 4, "last_activity_date": 1514520108, "last_edit_date": 1514520108, "creation_date": 1514519734, "answer_id": 48017199, "question_id": 48017130, "link": "https://stackoverflow.com/questions/48017130/haskell-couldnt-match-t0-t-with-actual-type-integer/48017199#48017199", "title": "Haskell couldn&#39;t match &#39;t0 -&gt;t&#39; with actual type &#39;[Integer]&#39;", "body": "<p>The input to <code>fn</code> on that website <em>is</em> an <code>Int</code>. You're fundamentally misunderstanding the do-notation used here.</p>\n\n<pre><code>main = do\n n &lt;- readLn :: IO Int\n print (fn(n))\n</code></pre>\n\n<p>The second line does not say <code>n</code> has type <code>IO Int</code>. It says <code>readLn</code> has type <code>IO Int</code>, which is then bound <em>inside</em> the <code>IO</code> monad to <code>n</code>. So <code>n</code> has type <code>Int</code>. Write your function as <code>fn :: Int -&gt; [Int]</code> and you'll be just fine. No need to worry about <code>IO</code> in this challenge.</p>\n\n<p>You can read more about do-notation <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\">here</a>, but it probably won't make too much sense unless you've been through a Haskell tutorial that covers monads.</p>\n"}], "owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "closed_date": 1514581575, "accepted_answer_id": 48017199, "answer_count": 1, "score": -3, "last_activity_date": 1514520108, "creation_date": 1514519050, "question_id": 48017130, "link": "https://stackoverflow.com/questions/48017130/haskell-couldnt-match-t0-t-with-actual-type-integer", "closed_reason": "Not suitable for this site", "title": "Haskell couldn&#39;t match &#39;t0 -&gt;t&#39; with actual type &#39;[Integer]&#39;", "body": "<p>I am learning Haskell and after grasping some of the basics I decided to solve some easy problems in HackerRank. But I soon found myself stuck.</p>\n\n<p>Problem 7 in Functional Problems is called \"Array of N elements\"</p>\n\n<p>We are supposed to return any array of n elements for a given n. This would have fairly simple if n was an Int but it's read as <code>IO Int</code>. And I haven't really grasped the concept of monads. I hoogled for functions with type signature <code>IO Int -&gt; Int</code> and found unsafePerform IO but it threw this:</p>\n\n<pre><code>Couldn't match expected type \u2018t0 -&gt; t\u2019\n              with actual type \u2018[Integer]\u2019\n</code></pre>\n\n<p>I dont't quite understand what types t0 and t are.</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Link: <a href=\"https://www.hackerrank.com/challenges/fp-array-of-n-elements/problem\" rel=\"nofollow noreferrer\">https://www.hackerrank.com/challenges/fp-array-of-n-elements/problem</a></p>\n"}, {"tags": ["haskell", "types", "constructor", "functional-programming", "pattern-matching"], "comments": [{"owner": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "edited": false, "score": 2, "creation_date": 1514514022, "post_id": 48016547, "comment_id": 83002539, "body": "<code>Node (Node z)</code> is evaluated first, because it is function application, but it can&#39;t evaluate, because the first <code>Node</code> is expecting a <code>[Tree]</code> but receiving what appears to be a <code>Tree</code>. Try <code>Node (Node z:y:xs)</code>. (Similarly parenthesize <code>_:_:_</code>s in the sequel)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514549854, "post_id": 48016547, "comment_id": 83014076, "body": "I can spot several code smells above, beyond the wrong parentheses. The list <code>(Leaf z):y:xs</code> surely has length &gt;=2, so testing for that looks wrong. The test <code>Leaf n == Leaf z</code> is weird, why not <code>n == z</code>? More in general, using <code>length</code> is often the wrong way: pattern matching already gives us information about the list length."}], "answers": [{"tags": [], "owner": {"reputation": 781, "user_id": 5057805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9USavIbjP-M/AAAAAAAAAAI/AAAAAAAAADk/5fj7tZo247s/photo.jpg?sz=128", "display_name": "Paul Parker", "link": "https://stackoverflow.com/users/5057805/paul-parker"}, "is_accepted": true, "score": 1, "last_activity_date": 1514526085, "last_edit_date": 1514526085, "creation_date": 1514516907, "answer_id": 48016943, "question_id": 48016547, "link": "https://stackoverflow.com/questions/48016547/pattern-matching-on-custom-constructors-haskell/48016943#48016943", "title": "Pattern matching on custom constructors Haskell", "body": "<p>I set up an example on <a href=\"https://repl.it/@sunwukong/ParchedRudeMajungatholus\" rel=\"nofollow noreferrer\">repl.it</a>, but the code is below.</p>\n\n<p>The first thing I did was add a more concrete signature to the function so that it was easier to reason about. Feel free to change it back to your origin signature once you've worked through everything. It's easier to move from the concrete to the abstract, than the other way around.</p>\n\n<ul>\n<li>The first problem was a lack of brackets in the pattern (this meant that instead of <code>Tree a</code>, you were trying to match against <code>[Tree a]</code>. The original <code>(Node (Node z):y:xs)</code> evaluated like this: <code>((Node (Node z)):y:xs)</code>. I added the <code>all@</code> <em>at</em> pattern below for my own convenience, but you can replace that, it is not essential. </li>\n<li>The second problem was that you really were trying to jam a <code>[Tree a]</code> into a <code>Tree a</code>, because that's what <code>y:xs</code> means in <code>foo n y:xs</code>, so I replaced it with <code>Node (y:xs)</code> which is a <code>Tree a</code>. </li>\n<li>Third problem was that the pattern matching for <code>foo</code> was non-exhaustive, added a catch-all at the end, you'll want to consider your intended behaviour and clean that up.</li>\n</ul>\n\n<p>The code follows:</p>\n\n<pre><code>module Main where\n\ndata Tree a = Leaf a | Node [Tree a] deriving (Show, Eq)\n\nfoo :: Int -&gt; Tree Int -&gt; [Tree Int]\nfoo n (Leaf _) = []\n\nfoo n (Node all@((Node z):xs)) = if length all &lt; 2 then [] \n            else (foo n (Node z)) ++ (foo n (Node xs) )\n\nfoo n (Node all@((Leaf z):y:xs)) = if length all &lt; 2 then [] \n            else if Leaf n == Leaf z then [y] ++ (foo n (Node (y:xs)))\n            else (foo n (Node (y:xs)))\nfoo _ _ = []\n\nmyTree :: Tree Int\nmyTree = Node [Leaf 1, Leaf 3, Node [Leaf 5, Leaf 3, Leaf 6], Leaf 4, Leaf 3, Leaf 44, Leaf 3]\n\n\nmain :: IO ()\nmain = do\n  print (foo 3 myTree)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[Node [Leaf 5,Leaf 3,Leaf 6],Leaf 6,Leaf 44]\n</code></pre>\n"}], "owner": {"reputation": 6610, "user_id": 1449637, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/71baba15969012d4c07b755fb0441016?s=128&d=identicon&r=PG", "display_name": "Greg Peckory", "link": "https://stackoverflow.com/users/1449637/greg-peckory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 1, "accepted_answer_id": 48016943, "answer_count": 1, "score": 2, "last_activity_date": 1514526085, "creation_date": 1514513039, "question_id": 48016547, "link": "https://stackoverflow.com/questions/48016547/pattern-matching-on-custom-constructors-haskell", "title": "Pattern matching on custom constructors Haskell", "body": "<p>My Custom type is:</p>\n\n<pre><code>data Tree a = Leaf a | Node [Tree a] deriving (Show, Eq)\n</code></pre>\n\n<p>I need to write a function</p>\n\n<pre><code>foo :: Eq a =&gt; a -&gt; Tree a -&gt; [Tree a]\n</code></pre>\n\n<p>Example</p>\n\n<pre><code>foo 3 (Node [Leaf 1, Leaf 3, Node [Leaf 5, Leaf 3, Leaf 6], Leaf 4, Leaf 3, Leaf 44, Leaf 3])\n\n-- this should print [Node [leaf 5, leaf 3, leaf 6], leaf 6, leaf 44] i.e - all elements that follow a \"Leaf 3\" in the Tree\n</code></pre>\n\n<p>My code is as follows (using pattern matching)</p>\n\n<pre><code>foo n (Leaf _) = []\n\nfoo n (Node (Node z):y:xs) = if length (Node z):y:xs &lt; 2 then [] \n                else (foo n (Node z)):(foo n y:xs)\n\nfoo n (Node (Leaf z):y:xs) = if length (Leaf z):y:xs &lt; 2 then [] \n                else if Leaf n == Leaf z then [y]:(foo n y:xs)\n                else (foo n y:xs)\n</code></pre>\n\n<p>However I get an error:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Tree a\u2019 with actual type \u2018[Tree a]\u2019\n\n\u2022 In the pattern: Node (Node z) : y : xs\n</code></pre>\n\n<p>But the pattern <code>Node (Node z) : y : xs</code> could represent the input </p>\n\n<pre><code>Node [Node [Leaf 4, Leaf 2], Leaf 6, Leaf 9, Leaf 1]\n</code></pre>\n\n<p>Am I wrong in saying that? It seems perfect to me.</p>\n\n<p>Why then, is the pattern matching failing?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1514504100, "post_id": 48015209, "comment_id": 83000630, "body": "Is there a reason you&#39;re using <code>data Graph a = Graph [a]</code> rather than <code>newtype Graph a = Graph [a]</code>? The usual default for single-constructor, single-field types is <code>newtype</code>; we use <code>data</code> for those only when we need an extra bit of laziness for a special purpose."}, {"owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514513336, "post_id": 48015209, "comment_id": 83002433, "body": "@dfeuer It is the next section, i have not read that section."}], "answers": [{"comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1514500699, "post_id": 48015233, "comment_id": 82999617, "body": "It&#39;s worth noting that although this <i>looks</i> like a recursive function, it is not. The <code>show</code> you call is totally different than the <code>show</code> you declare."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1514507459, "post_id": 48015233, "comment_id": 83001322, "body": "(But you should implement <code>showsPrec</code> instead of <code>show</code>.)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1514500512, "creation_date": 1514500512, "answer_id": 48015233, "question_id": 48015209, "link": "https://stackoverflow.com/questions/48015209/list-as-instance-of-show/48015233#48015233", "title": "List as Instance of show", "body": "<pre><code>instance Show a =&gt; Show (Graph a) where\n    show (Graph x) = show x\n</code></pre>\n\n<p>We have to show the contained list, so we can't return <code>x</code>, but we must return <code>show x</code>. This, in turn, requires that the list <code>x</code> of type <code>[a]</code> is showable, so we need to require that using the <code>Show a =&gt; ...</code> context.</p>\n"}, {"tags": [], "owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "is_accepted": false, "score": 3, "last_activity_date": 1514500602, "creation_date": 1514500602, "answer_id": 48015243, "question_id": 48015209, "link": "https://stackoverflow.com/questions/48015209/list-as-instance-of-show/48015243#48015243", "title": "List as Instance of show", "body": "<p>Simply show the list:</p>\n\n<pre><code>show (Graph x) = show x\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 6932854, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/1666674616977204/picture?type=large", "display_name": "Khan Saab", "link": "https://stackoverflow.com/users/6932854/khan-saab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 48015233, "answer_count": 2, "score": 1, "last_activity_date": 1514500683, "creation_date": 1514500378, "last_edit_date": 1514500683, "question_id": 48015209, "link": "https://stackoverflow.com/questions/48015209/list-as-instance-of-show", "title": "List as Instance of show", "body": "<p>Is there anyway to check how lists are instances of <code>Show</code>class. I have a datatype like this:</p>\n\n<p><code>data Graph a = Graph [a]</code> and i want to make it an instance of <code>Show</code> so that \nwhen i can call <code>show</code> function , i get only list and not the word Graph with it.</p>\n\n<p>I tried this but i know this would not work because <code>show</code> returns a string and <code>x</code> is a list. I'm learning from <em>Learn you haskell for a great good</em>. There is no example, nor can I find any on internet. </p>\n\n<pre><code>instance Show (Graph a) where\n    show (Graph x) = x\n</code></pre>\n\n<p>How can I get this result? </p>\n"}, {"tags": ["python", "haskell", "nlp", "spacy"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1514498137, "post_id": 48014298, "comment_id": 82998685, "body": "I think this question is a bit too broad. SpaCy seems to be a quite high level library, thus wrapping its features with the FFI will be a tedious task if possible at all - in addition you try to marry a dynamicly typed language with a strong &amp; static one which is already a task to do."}, {"owner": {"reputation": 93705, "user_id": 610569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0e9087f2672b0e4f28d91266acf9ce57?s=128&d=identicon&r=PG", "display_name": "alvas", "link": "https://stackoverflow.com/users/610569/alvas"}, "edited": false, "score": 0, "creation_date": 1514508064, "post_id": 48014298, "comment_id": 83001404, "body": "That&#39;ll be interesting to see Haskell with SpaCy =)"}, {"owner": {"reputation": 93705, "user_id": 610569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0e9087f2672b0e4f28d91266acf9ce57?s=128&d=identicon&r=PG", "display_name": "alvas", "link": "https://stackoverflow.com/users/610569/alvas"}, "edited": false, "score": 0, "creation_date": 1514508151, "post_id": 48014298, "comment_id": 83001424, "body": "I do believe that it&#39;s possible to wrap SpaCy into some sort of API request that it&#39;s curl-able but that&#39;ll take a significant work to make sure that all functionalities are API accessible."}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514494641, "creation_date": 1514494641, "question_id": 48014298, "link": "https://stackoverflow.com/questions/48014298/is-there-a-way-to-interface-with-pythons-spacy-using-haskell", "title": "Is there a way to interface with Python&#39;s SpaCy using Haskell?", "body": "<p>I've read a little about Haskell's foreign function interface, FFI, and it seems like it can call Python functions, but can it do something complicated, like parse a document using SpaCy, and then access all that document's properties in Haskell? If so, what would that look like?</p>\n"}, {"tags": ["bash", "haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "edited": false, "score": 0, "creation_date": 1514493594, "post_id": 48013693, "comment_id": 82997024, "body": "Remove the line <code>-- stack exec bash</code> or fix it to be a valid command."}, {"owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "reply_to_user": {"reputation": 26589, "user_id": 1032785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/30816b3d787c2bd9d6f036318304f225?s=128&d=identicon&r=PG", "display_name": "jordanm", "link": "https://stackoverflow.com/users/1032785/jordanm"}, "edited": false, "score": 2, "creation_date": 1514493910, "post_id": 48013693, "comment_id": 82997154, "body": "@jordanm, it is not working without this line. And my question is exactly about how to fix it."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514506712, "post_id": 48013693, "comment_id": 83001181, "body": "Well, it isn&#39;t working <i>with</i> the line either."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1514544461, "post_id": 48013693, "comment_id": 83011715, "body": "@ReinHenrichs it works <i>with</i> the line. It just prints error. Just some garbage output. But overall it works and the desired behavior is almost achieved."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514501722, "post_id": 48014385, "comment_id": 82999938, "body": "&quot;Wow.&quot; -- indeed! This was quite a rabbit chase down the hole."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1514507696, "post_id": 48014385, "comment_id": 83001350, "body": "Could we just <code>#!&#47;usr&#47;bin&#47;env stack exec bash</code>? edit: Seems not. Everything after the command name in a <code>#!</code> line is given as a single first argument. Bummer."}, {"owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "edited": false, "score": 0, "creation_date": 1514545470, "post_id": 48014385, "comment_id": 83012195, "body": "Thanks! This is really detailed explanation! Unfortunately, for my complicated real case that doesn&#39;t work, as I have <code>stack exec</code> calls inside <code>$(...)</code>. So I just made <code>bin&#47;setup.sh</code> shebang <code>#!&#47;usr&#47;bin&#47;env bash</code> and call the script with <code>stack exec .&#47;bin&#47;setup.sh</code>."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 6, "last_activity_date": 1514495142, "creation_date": 1514495142, "answer_id": 48014385, "question_id": 48013693, "link": "https://stackoverflow.com/questions/48013693/strange-stack-bash-error-command-not-found/48014385#48014385", "title": "Strange stack bash error: --: command not found", "body": "<p>Here's the problem.  The first line:</p>\n\n<pre><code>#!/usr/bin/env stack\n</code></pre>\n\n<p>is interpreted by your operating system (e.g., the Linux kernel) as indicating that the script should be invoked using the equivalent of the shell command:</p>\n\n<pre><code>$ /usr/bin/env stack setup.sh\n</code></pre>\n\n<p>or, since <code>env</code> is just there to search the path for <code>stack</code>, the equivalent of:</p>\n\n<pre><code>$ stack setup.sh\n</code></pre>\n\n<p>If you run this manually, you'll get the same error.  That's because, when <code>stack</code> is invoked this way, it reads the indicated file, searching for a line of the form:</p>\n\n<pre><code>-- stack blah blah whatever blah blah\n</code></pre>\n\n<p>after the first <code>#!</code> line.  Normally, this line looks something like:</p>\n\n<pre><code>-- stack --resolver lts-10.0 script\n</code></pre>\n\n<p>which tells stack to run the script as if you had run the shell command:</p>\n\n<pre><code>$ stack --resolver lts-10.0 script hello.sh\n</code></pre>\n\n<p>which interprets <code>hello.sh</code> as a Haskell program, instead of a shell script, but runs it using the lts-10.0 resolver, and all is well.</p>\n\n<p>However, you've told <code>stack</code> to use the command <code>stack exec bash</code>, so <code>stack</code> invokes your script with the equivalent of:</p>\n\n<pre><code>$ stack exec bash hello.sh\n</code></pre>\n\n<p>which is basically the same as running:</p>\n\n<pre><code>$ bash hello.sh\n</code></pre>\n\n<p>after setting up the <code>stack</code> paths and so on.</p>\n\n<p><strong>FINALLY</strong>, then, the shell <code>bash</code> is running your script.  Bash ignores the first line, because it starts with <code>#</code> character that indicates a shell comment.  But when Bash tries to interpret the second line, it's as if you entered the following command at the shell prompt:</p>\n\n<pre><code>$ -- stack exec bash\n</code></pre>\n\n<p>Bash looks for a program named <code>--</code> to run with arguments <code>stack exec bash</code>, and you get an error message.  The script keeps running, though, so the <code>echo</code> and <code>my-exec</code> lines get run as expected.</p>\n\n<p>Wow.</p>\n\n<p>Here's one way that may work for you.  You can use:</p>\n\n<pre><code>#!/bin/bash\nexec stack exec bash &lt;&lt;EOF\n\necho Echo printing\n./hello\n\nEOF\n</code></pre>\n\n<p>This shell script will invoke <code>stack exec bash</code> using a so-called \"here doc\", basically passing everything up to the <code>EOF</code> as a script file for <code>stack exec bash</code> to run.</p>\n"}], "owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "accepted_answer_id": 48014385, "answer_count": 1, "score": 1, "last_activity_date": 1514495142, "creation_date": 1514491430, "question_id": 48013693, "link": "https://stackoverflow.com/questions/48013693/strange-stack-bash-error-command-not-found", "title": "Strange stack bash error: --: command not found", "body": "<p>I have very simple haskell project with only executable <code>my-exec</code>. All it does is printing \"Hello, world!\" to console.</p>\n\n<p>I want to create the script file <code>bin/setup.sh</code> which will run my executable and also do some <code>echo</code></p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack exec bash\n\necho Echo printing\nmy-exec\n</code></pre>\n\n<p>When I run it I get</p>\n\n<pre><code>$ ./bin/setup.sh\n./bin/setup.sh: line 2: --: command not found\nEcho printing\nHello, world!\n</code></pre>\n\n<p>And I don't understand what is the issue with this file and why it says <code>--: command not found</code> but still working as expected.</p>\n\n<p>I understand that in this simple example I could write it in much easier form, but in my real situation I have to make like 10 of non trivial exec calls and don't want to duplicate <code>stack exec</code> multiple times.</p>\n\n<p>So what can I do to get rid of this error?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49388, "user_id": 6779307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7O3q.jpg?s=128&g=1", "display_name": "Patrick Haugh", "link": "https://stackoverflow.com/users/6779307/patrick-haugh"}, "edited": false, "score": 2, "creation_date": 1514484398, "post_id": 48012154, "comment_id": 82993082, "body": "The term you&#39;re looking for is <a href=\"https://stackoverflow.com/questions/28431125/mutual-recursion-in-odd-even-functions-in-haskell\">mutual recursion</a> which is possible in <a href=\"https://stackoverflow.com/questions/tagged/haskell\">haskell</a>.  If you&#39;re using GHCi, it might help for you to turn on the multiline mode with <code>:set +m</code> and define both at the same time using <code>let</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1514485601, "post_id": 48012154, "comment_id": 82993596, "body": "Also note that such definitions will lead to an exponential-complexity algorithm. Don&#39;t expect it to reasonably work for large input values."}, {"owner": {"reputation": 121, "user_id": 8178029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4f8246a1970468c61891554064bc5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Temple", "link": "https://stackoverflow.com/users/8178029/christian-temple"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514505858, "post_id": 48012154, "comment_id": 83001006, "body": "@chi but doesn&#39;t the compiler handle that for us automatically?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514542813, "post_id": 48012154, "comment_id": 83010985, "body": "The compiler will not turn an inefficient algorithm into an efficient one. If you need an efficient algorithm, you need to provide it to the compiler."}, {"owner": {"reputation": 121, "user_id": 8178029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4f8246a1970468c61891554064bc5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Temple", "link": "https://stackoverflow.com/users/8178029/christian-temple"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514578869, "post_id": 48012154, "comment_id": 83025913, "body": "@chi I don&#39;t know if you are expert on Haskell. But Haskell is a purely functional language, meaning that in Haskell you have to define functions recursively, there are no for loops. However, I heard that haskell compiler is intelligent and will determine how to compile efficiently and functions don&#39;t call each other in the order you thought."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514581663, "post_id": 48012154, "comment_id": 83026869, "body": "The compiler is not that magic. Anyway, I&#39;m not saying you should trust me -- write your program using that direct recursive approach and observe the time. GHC implements recursion efficiently, but an exponential-time algorithm will still be exponential, only with a lower constant factor. (And I&#39;m not suggesting to avoid recursion completely, which is both impossible and pointless in Haskell, but to research for new equivalent algorithms, if possible, or trying to use, say, memoization or some other technique to improve the complexity.)"}, {"owner": {"reputation": 121, "user_id": 8178029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4f8246a1970468c61891554064bc5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Temple", "link": "https://stackoverflow.com/users/8178029/christian-temple"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514586527, "post_id": 48012154, "comment_id": 83028293, "body": "@chi I mean the compiler should find the optimum machine codes by turning recursion into for loops, in other words, converting an exponential time algorithm into polynomial time algorithms. If the compiler is not that magic then someone will try to fix in the future. Artificial intelligence may be applied here to make the compiler more intelligent."}, {"owner": {"reputation": 121, "user_id": 8178029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4f8246a1970468c61891554064bc5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Temple", "link": "https://stackoverflow.com/users/8178029/christian-temple"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514588754, "post_id": 48012154, "comment_id": 83028805, "body": "@chi The compiler is already magic if you didn&#39;t know. In Haskell, the source code written for humans to read is exponential, but the executable machine code is polynomial. The compiler handles all that performance optimization for you. The reason for the preference to recursion is that it improves readability by making the code neater and more concise. For performance issues, we still have to use for loops when it compiles to machine codes, (readability is not a concern here since machine codes aren&#39;t meant to be read by humans), so the machine codes are polynomial, not exponential."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514592218, "post_id": 48012154, "comment_id": 83029530, "body": "I wish I had a compiler so smart to turn any EXPTIME algorithm into a PTIME algorithm when possible. With that, we could solve the P vs NP problem by just compiling an EXPTIME SAT solver! Truth is, there no such a compiler available. GHC is very nice, and includes many optimizations, but it is not magic. I strongly recommend you try computing the 1000000th Fibonacci number using the inefficient recursive algorithm and the manually memoized one. GHC won&#39;t turn the first in the second one."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514592407, "post_id": 48012154, "comment_id": 83029565, "body": "Further, finding the &quot;optimum machine codes&quot; would violate well-known Computability results -- with that we could solve many problems which we know to be unsolvable algorithmically. This is an immediate consequence of Rice&#39;s theorem."}, {"owner": {"reputation": 121, "user_id": 8178029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4f8246a1970468c61891554064bc5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Temple", "link": "https://stackoverflow.com/users/8178029/christian-temple"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514600540, "post_id": 48012154, "comment_id": 83030882, "body": "@chi of course it will never turn every exp algorithm into a ptime algorithm, only in limited cases. Maybe in the future some strong AI will be able to memoize on its own."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 7, "last_activity_date": 1514484615, "last_edit_date": 1514484615, "creation_date": 1514484297, "answer_id": 48012241, "question_id": 48012154, "link": "https://stackoverflow.com/questions/48012154/simultaneous-recurrence-relations-in-haskell/48012241#48012241", "title": "simultaneous recurrence relations in haskell", "body": "<p>In Haskell the order of definitions doesn't matter. You can define <code>a</code> before <code>b</code> or <code>b</code> before <code>a</code>, and in both cases they can reference each other just fine:</p>\n\n<pre><code>a n = 3 * a (n-1) + 2 * b (n-1)\nb n = a (n-1) + 2 * b (n-1)\n</code></pre>\n\n<p>If you're working in GHCi (please clarify that), then yes, it won't accept a definition of <code>a</code> alone, because it doesn't know what <code>b</code> is. You can, however, give GHCi both definitions together, by enclosing them in <code>:{ ... :}</code>, like so:</p>\n\n<pre><code>*Prelude&gt; :{                             \n*Prelude| a n = 3 * a (n-1) + 2 * b (n-1)\n*Prelude| b n = a (n-1) + 2 * b (n-1)    \n*Prelude| :}\n</code></pre>\n\n<p>Finally, I have to note that these definitions, as written, will produce an infinite loop: there are no cases (i.e. no inputs) for which <code>a</code> and <code>b</code> don't call themselves recursively. This means that, once you call any of them, they will just keep calling each other forever.</p>\n\n<p>To fix that, you need to provide a base case - an input, or a set of inputs, where the functions don't call themselves, for example:</p>\n\n<pre><code>a 0 = 1\na n = 3 * a (n-1) + 2 * b (n-1)\n\nb 0 = 1\nb n = a (n-1) + 2 * b (n-1)\n</code></pre>\n\n<p>(I can't tell whether I provided the correct base cases, because I don't know what your original problem is, and so can't say what is \"correct\" in your context; the base cases I provided are just examples to illustrate how it might be done)</p>\n"}], "owner": {"reputation": 121, "user_id": 8178029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4f8246a1970468c61891554064bc5cb?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Temple", "link": "https://stackoverflow.com/users/8178029/christian-temple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 48012241, "answer_count": 1, "score": 3, "last_activity_date": 1514484778, "creation_date": 1514483840, "last_edit_date": 1514484778, "question_id": 48012154, "link": "https://stackoverflow.com/questions/48012154/simultaneous-recurrence-relations-in-haskell", "title": "simultaneous recurrence relations in haskell", "body": "<p>Is it possible to set up a system of simultaneous recurrence relations in haskell? I'm trying to implement </p>\n\n<pre><code>a(n)=3a(n-1)+2b(n-1)\n\nb(n) = a(n-1) + 2b(n-1)\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code> a n = 3 * a (n-1) + 2 * b (n-1)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;interactive&gt;:103:25: error: Variable not in scope: b :: t -&gt; a\n</code></pre>\n\n<p>So, neither can I define a without defining b first, but nor can I define b without defining a first. I'm not sure if doing so is possible? </p>\n\n<p>PS: I'm working in gchi</p>\n"}, {"tags": ["haskell", "binding", "pattern-matching"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1514477311, "post_id": 48010100, "comment_id": 82989805, "body": "Please highlight the differences if you re-ask a question that has previously been closed as a duplicate."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 1, "creation_date": 1514479165, "post_id": 48010100, "comment_id": 82990631, "body": "What exactly is the question"}, {"owner": {"reputation": 2090, "user_id": 6214495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/30oWo.png?s=128&g=1", "display_name": "nicodp", "link": "https://stackoverflow.com/users/6214495/nicodp"}, "edited": false, "score": 1, "creation_date": 1514479964, "post_id": 48010100, "comment_id": 82991036, "body": "In our case, <code>True = False</code> is an irrefutable pattern, and since there are no variables bounded by it nothing forces the match between the <code>True</code> pattern and the value <code>False</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1563327719, "post_id": 48010100, "comment_id": 100659450, "body": "@DamianLattenero I&#39;ll reply to your Meta question here, in order to evade the Meta effect. I think that question of yours has value as a duplicate, and shouldn&#39;t be deleted. I guess the reopen vote has attracted extra attention to it, leading to the delete votes. As luck would have it, there is an easy way out in this case: abandon that other question in favour of this one -- it is essentially identical, was closed against the same target, and even has helpful supplementary answers. As a bonus, this question <i>can&#39;t</i> be deleted by normal means, because I used it as a duplicate target elsewhere."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1563329437, "post_id": 48010100, "comment_id": 100659737, "body": "@duplode I have a better idea, why don&#39;t I change the other question putting there the link to this question? and you mark this question that question as duplicate of this one? can you do that?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1563330001, "post_id": 48010100, "comment_id": 100659824, "body": "@duplode I&#39;m curius now, what&#39;s the &quot;meta effect?&quot;"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1563330056, "post_id": 48010100, "comment_id": 100659838, "body": "@DamianLattenero [1/2] If I were to do that, there would be no need for you to edit a link into it. However, it would be quite odd to change duplicate targets to make a question point at an identical question which is also a duplicate. (Strictly speaking, I don&#39;t think there is an acute need to do anything. I&#39;m only suggesting that because of your concern about the delete votes, and because the questions are identical, so in principle we only need one of them to exist.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1563330506, "post_id": 48010100, "comment_id": 100659908, "body": "@DamianLattenero [2/2] The Meta effect is when a post gets lots of extra votes because it is being discussed in a Meta question. I suspect the Meta crowd would find the existence of this second question problematic, potentially leading to downvotes and/or a derailed discussion."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1563330663, "post_id": 48010100, "comment_id": 100659932, "body": "@duplode ok... it is sad... and I will sacrifice rep, but it&#39;s ok, the better for the site is to close the other question. thanks for your time"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1563330951, "post_id": 48010100, "comment_id": 100659974, "body": "@DamianLattenero If nothing else, this resolution should, quite appropriately, earn you the Disciplined badge."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1563390020, "post_id": 48010100, "comment_id": 100688040, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/196591/discussion-between-damian-lattenero-and-duplode\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1563363330, "post_id": 48011129, "comment_id": 100673100, "body": "<code>let 5 = 10</code> and <code>let True = False</code> are pretty useless, but someone could actually want to write, say, <code>let Just _ = x</code>, though <code>PartialTypeSignatures</code> and <code>TypeApplications</code> are better for that these days."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1514479261, "creation_date": 1514479261, "answer_id": 48011129, "question_id": 48010100, "link": "https://stackoverflow.com/questions/48010100/is-true-false-understanding-binding-and-pattern-matching/48011129#48011129", "title": "Is True = False? Understanding binding and pattern matching", "body": "<p>Both <code>where</code> and <code>let</code> introduce defining equations using <em>lazy</em> patterns.</p>\n\n<p>In any module, all the top-level definitions are under a <code>where</code>.</p>\n\n<pre><code>module Main where\n         -- ^^^^^\n\nx, y :: Int\n(x, y) = undefined\n\nmain :: IO ()\nmain = putStrLn \"hello!\"\n</code></pre>\n\n<p>The above program will print \"hello\", as intended. The pattern matching against <code>(x, y)</code> would diverge if it were strict, but since it is lazy it does not -- the <code>undefined</code> expression never gets evaluated.</p>\n\n<p>Definitions typed in GHCi are also under an implicit <code>let</code>.</p>\n\n<p>After knowing this, the issue mentioned in the question is exactly the one in the <a href=\"https://stackoverflow.com/questions/33006500/about-let-5-10\"><code>let 5 = 10</code></a> question.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 1, "last_activity_date": 1514480037, "creation_date": 1514480037, "answer_id": 48011313, "question_id": 48010100, "link": "https://stackoverflow.com/questions/48010100/is-true-false-understanding-binding-and-pattern-matching/48011313#48011313", "title": "Is True = False? Understanding binding and pattern matching", "body": "<p>In Haskell a let \u201cbinding\u201d is doing pattern matching. There are precisely two types of pattern-matching-binding in Haskell: You can either write <code>P = x</code> where <code>P</code> is a pattern or you may write <code>v1 p1 p2 ... pn = x</code> where each <code>pi</code> is a pattern. This defines (part of) a function <code>v1</code>. What is a pattern?\nA pattern is either a variable <code>v</code> which causes <code>v</code> to be bound to whatever is being matched when the match is successful. Or a pattern may be a constant like 7 where when the matching is done it succeeds only if the thing being matched is equal to the constant. Or a pattern may be a variant of a data type:  If <code>Foo</code> is a variant (constructor) for the type <code>Bar</code> taking n parameters then <code>Foo p1 p2 ... pn</code>, where the <code>pi</code> are patterns, is a pattern which looks at an object of type <code>Bar</code> and successfully matches if it is of the <code>Foo</code> variant and each of the <code>pi</code> successfully match.</p>\n\n<p>Because Haskell is lazy, the only way to force the pattern matching to happen is to use a variable which was bound by pattern matching. So one may force the binding of <code>x</code> in <code>let (x,5)=(6,6)</code> by using <code>x</code> and this cause a matching failure. If a variant has no parameters there is no way for the matching to be forced so there is no way for the match to fail. Thus <code>let True = False</code> would fail if you ever got the match to happen but because there is no way to get the match to happen, there is no error. Note that you are not rebinding <code>True</code> but using it as a pattern with no arguments.</p>\n"}], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 1, "closed_date": 1525018883, "accepted_answer_id": 48011129, "answer_count": 2, "score": 1, "last_activity_date": 1563333868, "creation_date": 1514475017, "last_edit_date": 1563333868, "question_id": 48010100, "link": "https://stackoverflow.com/questions/48010100/is-true-false-understanding-binding-and-pattern-matching", "closed_reason": "Duplicate", "title": "Is True = False? Understanding binding and pattern matching", "body": "<p>A friend of us is teaching to us the basics of functional programming in Haskell, and he started to write the rarest thing I ever saw:</p>\n\n<p>He started with something not so amazing, but pretty cool:</p>\n\n<pre><code>(x,y) = (10,20)\n(z:zs) = 0 : [1..]\n</code></pre>\n\n<p>and shows in the prelude:</p>\n\n<pre><code>prelude&gt; x\n10\nprelude&gt; z\n0\nprelude&gt; takeN 3 zs\n[1,2,3]\n</code></pre>\n\n<p>so far, so good... I didn't know you could bind the values like that</p>\n\n<pre><code>(x,y) = (10,20)\n(z:zs) = 0 : [1..]\nTrue = False -- HERE\n</code></pre>\n\n<p>What!? Everyone in the class thought, ok, something will go wrong, but not even <strong>the code compiled</strong>, then it runs:</p>\n\n<pre><code>prelude&gt; x\n10\nprelude&gt; 4\n4\nprelude&gt; True\nTrue\n</code></pre>\n\n<p>(I read the question <a href=\"https://stackoverflow.com/questions/33006500/about-let-5-10\">What does `let 5 = 10` do? Is it not an assignment operation?</a> and I'm not using any let here, in my example I write the code in a file and the execute it, so my question is not answered yet, none of that answers are useful for me.)</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "ghcjs"], "comments": [{"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 1, "creation_date": 1514475730, "post_id": 48008085, "comment_id": 82988926, "body": "Building GHCJS yourself is not a nice task. Even if you succeed today, you have  no guarantee that you can rebuild it tomorrow, You may have new issues with the next GHC version. Therfore the <a href=\"https://www.reddit.com/r/haskell/comments/7mm3i8/what_is_the_best_way_to_setup_a_ghcghcjs_full/\" rel=\"nofollow noreferrer\">common opinion</a> is to use the <a href=\"https://github.com/reflex-frp/reflex-platform\" rel=\"nofollow noreferrer\">reflex-platform</a> even if you don&#39;t use reflex!"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1514499700, "post_id": 48008085, "comment_id": 82999253, "body": "@Jogger Thanks! I find it quite funny that when I open up the stackoverflow question I asked, I get a link back to the reddit post that I made."}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514467541, "creation_date": 1514466461, "last_edit_date": 1514467541, "question_id": 48008085, "link": "https://stackoverflow.com/questions/48008085/createtree-already-exists-file-exists-error-when-running-ghcjs-boot", "title": "`createTree: already exists (File exists)` error when running `ghcjs-boot`", "body": "<p>When running <code>ghcjs-boot</code> I get a whole bunch of:</p>\n\n<pre><code>ignoring unexpected entry type in tar. only normal files and directories (no links) are supported:\nghcjs-boot/./@LongLink\n</code></pre>\n\n<p>Before finally:</p>\n\n<pre><code>ghcjs-boot: /Users/&lt;user&gt;/.ghcjs/x86_64-darwin-0.2.1-8.0.2/ghcjs/ghcjs-boot/boot/aeson/tests/JSONTestSuite/parsers/test_JSONKit/test-JSONKit.xcodeproj/xcuserdata/nst: createTree: already exists (File exists)\n</code></pre>\n\n<p>And then failure.</p>\n\n<p>For more information my globally installed <code>ghc</code> is 8.2. Since that doesn't work for <code>ghcjs</code>, I installed <code>ghc-8.0</code> via brew and modified my <code>PATH</code> before running the command so that it pointed to <code>ghc-8.0</code>. I also am using <code>cabal-2.0.0.1</code> and am on <code>OS X Yosemite 10.10.5</code>.</p>\n\n<p>Any idea what the issue is / how I can fix.</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1514461626, "post_id": 48006676, "comment_id": 82981973, "body": "<code>:set -XMonomorphismRestriction</code> makes this work in GHCi as well. GHCi disables the MR, unlike GHC (the compiler), but in this case it is beneficial, so you can turn it back on. Essentially, <code>newGen</code> is given a too general type, which causes the ambiguity later on."}, {"owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514464345, "post_id": 48006676, "comment_id": 82983340, "body": "Cool - why does ghci disable the monomorphism restriction ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1514464412, "post_id": 48006676, "comment_id": 82983364, "body": "Because especially on the REPL, the defaulting to a specific type is more often a pain than a benefit."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514465582, "post_id": 48006676, "comment_id": 82983923, "body": "In most cases, the MR makes the code less likely to type-check, assigning monomorphic types when they could be generalized to polymorphic ones. The MR was introduced to improve performance in some cases, where computation could be duplicated as in <code>let x = 10*10 in x+x</code> which causes <code>10*10</code> to be computed twice without the MR (or an explicit annotation). This comes at the cost of typeability. Some argue that MR should be disabled in Haskell by default, but this breaks retro-compatibility, so for now GHC keeps it on. GHCi, instead, turns it off to improve convenience."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514465670, "post_id": 48006676, "comment_id": 82983968, "body": "Anyway, the MR is a relatively complex thing, with subtle consequences. It is described in some detail at <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\" title=\"what is the monomorphism restriction\">stackoverflow.com/questions/32496864/&hellip;</a>"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1514465691, "post_id": 48006676, "comment_id": 82983974, "body": "@chi you should probably put this in an answer."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1514491583, "post_id": 48008127, "comment_id": 82996187, "body": "Those polymorphic signatures have no hope of working. The pattern bindings lead to trouble because you can&#39;t simply extract a <code>forall r. r</code> from a <code>forall r. (r,a)</code>. Furthermore, there&#39;s syntactically just one <code>r</code>, but that expands to three unrelated type variables. Question: do you need the full MR, or will <code>MonoLocalBinds</code> do the trick?"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1514466653, "creation_date": 1514466653, "answer_id": 48008127, "question_id": 48006676, "link": "https://stackoverflow.com/questions/48006676/why-can-the-haskell-compiler-infer-this-type-but-ghci-cannot/48008127#48008127", "title": "Why can the haskell compiler infer this type but ghci cannot?", "body": "<p>As chi already commented, this code only works when the <a href=\"https://wiki.haskell.org/MonomorphismRestriction\" rel=\"nofollow noreferrer\">monomorphism restriction</a> is enabled. That restriction makes the compiler choose <em>one specific type</em> for any non-function definition, i.e. a signature with no type variables in it like the <code>a</code> in <code>length :: [a] -&gt; Int</code>. So (unless you've manually specified a local signature) the compiler looks around everywhere for a hint what this type could be, before it chooses. In your example, it sees that <code>firstCoin</code> <code>secondCoin</code> <code>thirdCoin</code> are used in the final result which at the top-level signature is declared <code>(Bool, Bool, Bool)</code>, so it infers that all the coins must have type <code>Bool</code>. </p>\n\n<p>That's nice and fine in such a simple example, but in modern Haskell, you very often need values to be more general, so you can use them in multiple different-typed contexts or as arguments for Rank-2 function. You can always achieve this by giving explicit signatures, but especially in GHCi that's awkward (it's regularly called &ldquo;the <em>Dreaded</em> Monomorphism Restriction&rdquo;), therefore it was decided a couple of versions ago to disable it by default in GHCi.</p>\n\n<p><em>Conceptually</em>, <code>firstCoin</code> <code>secondCoin</code> <code>thirdCoin</code> etc. could also be more general than <code>Bool</code>: <code>random</code> is after all able to yield random values of <em>any</em> suitable type (i.e. any type that has a <a href=\"http://hackage.haskell.org/package/random-1.1/docs/System-Random.html#t:Random\" rel=\"nofollow noreferrer\"><code>Random</code></a> instance). So in principle, the local definitions could have a polymorphic type, like this:</p>\n\n<pre><code>threeCoins :: StdGen -&gt; (Bool, Bool, Bool)  \nthreeCoins gen =   \n    let firstCoin, secondCoin, thirdCoin :: Random r =&gt; r\n        (firstCoin, newGen) = random gen\n        (secondCoin, newGen') = random newGen\n        (thirdCoin, newGen'') = random newGen'\n    in  (firstCoin, secondCoin, thirdCoin)\n</code></pre>\n\n<p>which is basically what happens when the monomorphism restriction is turned off, as you can see by compiling your original example with the line</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n</code></pre>\n\n<p>on top.</p>\n\n<p>Trouble is, your code doesn't actually work with those general local signatures. The reason is a bit involved, it's basically that the type information of the <code>r</code> variable has to be propagated back into a tuple before it can be used in the <code>random</code> generator, and for reasons that I right now don't understand either, the Hindley-Milner type system can't do that.</p>\n\n<p>The best solution is to <em>not</em> do this manual tuple unwrapping, which is anyways awkward, but instead use a <a href=\"http://hackage.haskell.org/package/random-fu-0.2.7.0/docs/Data-Random.html\" rel=\"nofollow noreferrer\">random monad</a>, like this:</p>\n\n<pre><code>import System.Random \nimport Data.Random \n\nthreeCoins :: RVar (Bool, Bool, Bool)  \nthreeCoins = do   \n    firstCoin &lt;- uniform False True\n    secondCoin &lt;- uniform False True\n    thirdCoin &lt;- uniform False True\n    return (firstCoin, secondCoin, thirdCoin)\n\nmain = print . sampleState threeCoins $ mkStdGen 21\n</code></pre>\n\n<p>which works with or without momomorphism restriction, because <code>firstCoin</code> <code>secondCoin</code> <code>thirdCoin</code> now come from a monadic bind, <a href=\"https://en.wikipedia.org/wiki/Parametric_polymorphism#Predicativity_and_impredicativity\" rel=\"nofollow noreferrer\">which is <em>always</em> monomorphic</a>.</p>\n\n<p>Incidentally, because you're in a monad then you can use standard combinators and thus easily shorten it to</p>\n\n<pre><code>import Control.Monad (replicateM)\n\nthreeCoins :: RVar (Bool, Bool, Bool)  \nthreeCoins = do   \n    [firstCoin,secondCoin,thirdCoin] &lt;- replicateM 3 $ uniform False True\n    return (firstCoin, secondCoin, thirdCoin)\n</code></pre>\n"}], "owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "accepted_answer_id": 48008127, "answer_count": 1, "score": 7, "last_activity_date": 1514466653, "creation_date": 1514460648, "question_id": 48006676, "link": "https://stackoverflow.com/questions/48006676/why-can-the-haskell-compiler-infer-this-type-but-ghci-cannot", "title": "Why can the haskell compiler infer this type but ghci cannot?", "body": "<p>I'm working through the <a href=\"http://learnyouahaskell.com/chapters\" rel=\"noreferrer\">following book</a> to learn Haskell - looking in particular at the chapter on <a href=\"http://learnyouahaskell.com/input-and-output#randomness\" rel=\"noreferrer\">randomness</a>:</p>\n\n<p>I'm running the following as the file <code>three-coins.hs</code>:</p>\n\n<pre><code>import System.Random \n\nthreeCoins :: StdGen -&gt; (Bool, Bool, Bool)  \nthreeCoins gen =   \n    let (firstCoin, newGen) = random gen\n        (secondCoin, newGen') = random newGen\n        (thirdCoin, newGen'') = random newGen'\n    in  (firstCoin, secondCoin, thirdCoin)\n\nmain = print ( threeCoins (mkStdGen 21) )\n</code></pre>\n\n<p>Which I then execute with <code>runhaskell three-coins.hs</code> and get output similar to:</p>\n\n<pre><code>(True,True,True)\n</code></pre>\n\n<p>Now they make the point in the notes:</p>\n\n<blockquote>\n  <p>Notice that we didn't have to do <code>random gen :: (Bool, StdGen)</code>. That's because we already specified that we want booleans in the type declaration of the function. That's why Haskell can infer that we want a boolean value in this case.</p>\n</blockquote>\n\n<p>That is cool. </p>\n\n<p>Now when I run this in <code>ghci</code> with the following code:</p>\n\n<pre><code>import System.Random \n\n:{\nthreeCoins :: StdGen -&gt; (Bool, Bool, Bool)\nthreeCoins gen =\n    let (firstCoin, newGen) = random gen\n        (secondCoin, newGen') = random newGen\n        (thirdCoin, newGen'') = random newGen'\n    in  (firstCoin, secondCoin, thirdCoin)\n:}\n</code></pre>\n\n<p>I get the following response:</p>\n\n<pre><code>&lt;interactive&gt;:6:9: error:\n    \u2022 Ambiguous type variable \u2018t0\u2019\n      prevents the constraint \u2018(Random t0)\u2019 from being solved.\n    \u2022 When checking that the inferred type\n        newGen :: forall t. Random t =&gt; StdGen\n      is as general as its inferred signature\n        newGen :: StdGen\n      In the expression:\n        let\n          (firstCoin, newGen) = random gen\n          (secondCoin, newGen') = random newGen\n          (thirdCoin, newGen'') = random newGen'\n        in (firstCoin, secondCoin, thirdCoin)\n      In an equation for \u2018threeCoins\u2019:\n          threeCoins gen\n            = let\n                (firstCoin, newGen) = random gen\n                (secondCoin, newGen') = random newGen\n                ....\n              in (firstCoin, secondCoin, thirdCoin)\n</code></pre>\n\n<p>Which is interesting. Somewhat like the error they were warning us about in the book. </p>\n\n<p>So if we modify the code to put the type hints in:</p>\n\n<pre><code>import System.Random \n\n:{\nthreeCoins :: StdGen -&gt; (Bool, Bool, Bool)\nthreeCoins gen =\n    let (firstCoin, newGen) = random gen :: (Bool, StdGen)\n        (secondCoin, newGen') = random newGen :: (Bool, StdGen)\n        (thirdCoin, newGen'') = random newGen' :: (Bool, StdGen)\n    in  (firstCoin, secondCoin, thirdCoin)\n:}\n</code></pre>\n\n<p>That works fine - and we can test it with the following:</p>\n\n<pre><code>threeCoins (mkStdGen 21) \n</code></pre>\n\n<p>and get this result</p>\n\n<pre><code>(True,True,True)\n</code></pre>\n\n<p>Huh - that worked. So the Haskell compiler can infer from the type that we provided that we want a boolean, but ghci can't. </p>\n\n<p>My question is: <strong>Why can the haskell compiler infer this type but ghci cannot?</strong></p>\n"}, {"tags": ["haskell", "xmonad"], "answers": [{"comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 2, "creation_date": 1514661343, "post_id": 48026263, "comment_id": 83044235, "body": "It should be the &#39;second&#39; value determined by the following: <code>xprop | grep WM_CLASS</code>"}], "tags": [], "owner": {"reputation": 785, "user_id": 5478942, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-E0u3n2mQxTk/AAAAAAAAAAI/AAAAAAAABUI/1PPJs1QQ7BU/photo.jpg?sz=128", "display_name": "Solomon Bothwell", "link": "https://stackoverflow.com/users/5478942/solomon-bothwell"}, "is_accepted": true, "score": 0, "last_activity_date": 1514568866, "creation_date": 1514568866, "answer_id": 48026263, "question_id": 48002667, "link": "https://stackoverflow.com/questions/48002667/xmonad-how-to-use-managehook/48026263#48026263", "title": "XMonad: How to use manageHook?", "body": "<p>If anyone else was stuck on this, it turns out manageHooks takes the xprop classname not the program name. You can read all about it here: <a href=\"https://wiki.haskell.org/Xmonad/Frequently_asked_questions#I_need_to_find_the_class_title_or_some_other_X_property_of_my_program\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Xmonad/Frequently_asked_questions#I_need_to_find_the_class_title_or_some_other_X_property_of_my_program</a></p>\n"}], "owner": {"reputation": 785, "user_id": 5478942, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-E0u3n2mQxTk/AAAAAAAAAAI/AAAAAAAABUI/1PPJs1QQ7BU/photo.jpg?sz=128", "display_name": "Solomon Bothwell", "link": "https://stackoverflow.com/users/5478942/solomon-bothwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 48026263, "answer_count": 1, "score": 0, "last_activity_date": 1514568866, "creation_date": 1514442505, "question_id": 48002667, "link": "https://stackoverflow.com/questions/48002667/xmonad-how-to-use-managehook", "title": "XMonad: How to use manageHook?", "body": "<p>I'm following the instructions <a href=\"https://wiki.haskell.org/Xmonad/General_xmonad.hs_config_tips#Making_window_float_by_default.2C_or_send_it_to_specific_workspace\" rel=\"nofollow noreferrer\">Here</a> to make a program (wicd-gtk) always run in a floating window.</p>\n\n<p>Here are the relevant sections from my xmonad.hs:</p>\n\n<pre><code>myManageHook = composeAll\n    [ className =? \"wicd-gtk\"       --&gt; doFloat\n    , className =? \"stalonetray\"    --&gt; doIgnore\n    , manageDocks  \n    ]\n\nmain = do\n    xmproc &lt;- spawnPipe \"~/.local/bin/xmobar ~/.xmobarrc\"\n    xmonad $ dynamicProjects projects $ docks def\n        { layoutHook            = avoidStruts $ myLayoutHook\n        , manageHook            = myManageHook &lt;+&gt; manageHook def\n        , logHook               = dynamicLogWithPP xmobarPP\n            { ppOutput  = hPutStrLn xmproc\n            , ppLayout  = (\\x -&gt; drop 10 x)\n            , ppTitle   = xmobarColor \"green\" \"\" . shorten 150\n            }\n        , modMask               = mod4Mask\n        , keys                  = myKeys\n        , workspaces            = myWorkspaces\n        , normalBorderColor     = myNormalBorderColor\n        , focusedBorderColor    = myFocusedBorderColor\n        }\n</code></pre>\n\n<p>I don't get any errors when I recompile but wicd-gtk does not load as a floating window. I also previously tried using <code>doShift</code> to force firefox into a specific window but that did not work as well.</p>\n\n<p>Any ideas what I am doing wrong?</p>\n"}, {"tags": ["haskell", "applicative", "traversable"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1514430887, "post_id": 48000812, "comment_id": 82970807, "body": "Another thing to note in the <code>Data.Traversable</code> documentation is that &quot;The naturality law is implied by parametricity.&quot; This basically means that any definition of <code>traverse</code> that passes the type checker will obey the naturality law; you don&#39;t have to worry about it."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1514429988, "post_id": 48000912, "comment_id": 82970658, "body": "The <code>&lt;*&gt;</code> law is more difficult to show formally, but if you express it in terms of <code>concat</code> and <code>map</code>, I think it will become at least intuitively clear. The basic principle is that <code>concat (reverse (map reverse xss)) = reverse (concat xss)</code>. Looking at a few small examples should convince anyone that this is true. <code>reverse (concat [[1,2], [3,4,5]]) = [5,4,3,2,1] = concat [[5,4,3], [2,1]] = concat (reverse (map reverse [[1,2], [3,4,5]]))</code>, for instance."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 5, "last_activity_date": 1514428014, "creation_date": 1514428014, "answer_id": 48000912, "question_id": 48000812, "link": "https://stackoverflow.com/questions/48000812/what-is-a-applicative-transformation-in-naturality-of-traversability/48000912#48000912", "title": "What is a &quot;applicative transformation&quot; in naturality of traversability?", "body": "<p>The Hackage page for Data.Traversable defines an applicative transformation as follows.</p>\n\n<blockquote>\n  <p>[A]n applicative transformation is a function</p>\n\n<pre><code>t :: (Applicative f, Applicative g) =&gt; f a -&gt; g a\n</code></pre>\n  \n  <p>preserving the Applicative operations, i.e.</p>\n\n<pre><code>t (pure x) = pure x\n\nt (x &lt;*&gt; y) = t x &lt;*&gt; t y\n</code></pre>\n</blockquote>\n\n<p>The simplest example of this would be the identity function. <code>id</code> is an applicative transformation. A more specific example for lists would be <code>reverse</code>.</p>\n\n<pre><code>reverse (pure x) = reverse [x] = [x] = pure x\n-- (the (&lt;*&gt;) law is more difficult to show)\n</code></pre>\n\n<p>And you can verify in GHCi that the laws you reference do hold for <code>reverse</code>.</p>\n\n<pre><code>Prelude&gt; reverse . sequenceA $ [[1], [2,3]]\n[[1,3],[1,2]]\nPrelude&gt; sequenceA . fmap reverse $ [[1], [2,3]]\n[[1,3],[1,2]]\n</code></pre>\n\n<hr>\n\n<p>Source: <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Traversable.html\" rel=\"noreferrer\">Data.Traversable</a></p>\n"}], "owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 48000912, "answer_count": 1, "score": 0, "last_activity_date": 1514428014, "creation_date": 1514426957, "question_id": 48000812, "link": "https://stackoverflow.com/questions/48000812/what-is-a-applicative-transformation-in-naturality-of-traversability", "title": "What is a &quot;applicative transformation&quot; in naturality of traversability?", "body": "<p>The <code>traverse</code> and <code>sequenceA</code> function in <code>Traversable</code> class must satisfy the following 'naturality' laws:</p>\n\n<pre><code>t . traverse f == traverse (t . f)\nt . sequenceA == sequenceA . fmap t\n</code></pre>\n\n<p>for every 'applicative transformation' <code>t</code>. But what is it?</p>\n\n<p>It doesn't seem to work for <code>instance Traversable []</code> for <code>t = tail</code>:</p>\n\n<pre><code>Prelude&gt; tail . sequenceA $ [[1],[2,3]]\n[[1,3]]\nPrelude&gt; sequenceA . fmap tail $ [[1],[2,3]]\n[]\n</code></pre>\n\n<p>Nor for <code>t = join (++)</code> (repeat the list twice):</p>\n\n<pre><code>Prelude Control.Monad&gt; join (++) . sequenceA $ [[1],[2,3]]\n[[1,2],[1,3],[1,2],[1,3]]\nPrelude Control.Monad&gt; sequenceA . fmap (join (++)) $ [[1],[2,3]]\n[[1,2],[1,3],[1,2],[1,3],[1,2],[1,3],[1,2],[1,3]]\n</code></pre>\n\n<p>So for what <code>t</code> they are satisfied?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 6, "creation_date": 1514421313, "post_id": 48000209, "comment_id": 82969013, "body": "Are you asking why the line after <code>($) :: ...</code> is written <code>f $ x = ...</code> rather than <code>($) f x = ...</code>?"}, {"owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "reply_to_user": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 1, "creation_date": 1514421509, "post_id": 48000209, "comment_id": 82969047, "body": "Yes exactly that"}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 5, "creation_date": 1514421880, "post_id": 48000209, "comment_id": 82969121, "body": "@w1220 both are valid haskell syntax. One is hte prefix notation, one the infix notation. They&#39;re interchangable."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 0, "creation_date": 1514423157, "post_id": 48000316, "comment_id": 82969354, "body": "So I understand the infix and prefix notation and I&#39;ve written the functions with those three functions and I can test them in ghci to output what I expect with   f 2 and apply (\\x -&gt; x+1) 5  But how do I test the ($) function to see how it works?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 0, "creation_date": 1514423244, "post_id": 48000316, "comment_id": 82969365, "body": "Like <code>(\\x -&gt; x + 1) $ 5</code> or <code>log $ exp 37</code>. The <code>$</code> doesn&#39;t really do much at all, it&#39;s main purpose is to group expressions: because it&#39;s an infix with very low fixity, it acts usually as if both sides were in parentheses, even if they aren&#39;t."}, {"owner": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "reply_to_user": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 0, "creation_date": 1514424502, "post_id": 48000316, "comment_id": 82969623, "body": "@w1220 one way to use <code>($)</code> to do a little more than nothing is to pass it around partially applied. For instance if <code>evaluateAt1 = ($ 1)</code>, then <code>evaluateAt1 succ</code> gives <code>2</code>, or <code>map ($ x) [f, g, h]</code> gives <code>[f x, g x, h x]</code>."}, {"owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 0, "creation_date": 1514424557, "post_id": 48000316, "comment_id": 82969640, "body": "@leftaroundabout Using those examples without adding the ($) function in my code I can understand the purpose of       $  but I when I add the ($) function in your answer into my code I run into problems. Why do people write      ($) :: ...     f $ x ...  as the function definition doesn&#39;t match the second line?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "edited": false, "score": 0, "creation_date": 1514425091, "post_id": 48000316, "comment_id": 82969748, "body": "@w1220 it does match the second line, albeit only after desugaring."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1514422466, "last_edit_date": 1514422466, "creation_date": 1514422137, "answer_id": 48000316, "question_id": 48000209, "link": "https://stackoverflow.com/questions/48000209/naming-functions-or/48000316#48000316", "title": "Naming functions ($) or (&gt;&gt;=)", "body": "<p>Infix applications like <code>1 + 2</code> or <code>f $ x</code> are just syntactic sugar for <code>(+) 1 2</code> and <code>($) f x</code>, respectively. This is regardless of whether they appear in a pattern match (left side of <code>=</code>) or in an expression. So, your snippets desugar to</p>\n\n<pre><code>f :: Int -&gt; Int\nf x = (+) x 2\n\n($) :: (a -&gt; b) -&gt; (a -&gt; b)\n($) f x = f x\n</code></pre>\n\n<p>The latter could also be written</p>\n\n<pre><code>apply :: (a -&gt; b) -&gt; a -&gt; b\napply f x = f x\n</code></pre>\n\n<p>The syntax rule is: if an identifier consists of letters (and possibly numbers, in non-leading position) it's parsed as a function with all arguments on the right, or simply as a constant value if there are no arguments. If it consists of any other symbols and is not surrounded by parentheses, it's parsed as an infix, i.e. desugared so whatever stands on the left is used as the first argument and whatever stands on the right the second argument.</p>\n"}], "owner": {"reputation": 347, "user_id": 8941497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73ef14622ee81e7247a804e94da912e0?s=128&d=identicon&r=PG&f=1", "display_name": "f23aaz", "link": "https://stackoverflow.com/users/8941497/f23aaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 48000316, "answer_count": 1, "score": 0, "last_activity_date": 1514423747, "creation_date": 1514421112, "last_edit_date": 1514423747, "question_id": 48000209, "link": "https://stackoverflow.com/questions/48000209/naming-functions-or", "title": "Naming functions ($) or (&gt;&gt;=)", "body": "<p>What are the functions that begin with <code>($)</code> or <code>(&gt;&gt;=)</code> supposed to do. I'm not asking exactly what <code>$</code> or <code>&gt;&gt;=</code> mean but I understand that</p>\n\n<pre><code>f :: Int -&gt; Int\nf x = x+2\n</code></pre>\n\n<p>is a function that takes an integer and adds two, but whilst learning Haskell I've ran into problems where the solution has been something like the following:</p>\n\n<pre><code>($) :: (a -&gt; b) -&gt; (a -&gt; b)\nf $ x = f x\n</code></pre>\n\n<p>from <a href=\"https://stackoverflow.com/questions/19521246/what-does-mean-do-in-haskell\">What does $ mean/do in Haskell?</a></p>\n\n<p>I assume this means the function ($) takes a lambda (a -> b) and outputs a lambda (a -> b), and then the next line I'm unsure.</p>\n\n<p>but I always assumed the function definition </p>\n\n<pre><code>f :: Int -&gt; Int\n</code></pre>\n\n<p>had to be followed by a function with arguments starting with f like my first code example.</p>\n\n<p>Thanks</p>\n"}]