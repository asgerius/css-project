[{"tags": ["haskell", "type-inference"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 7, "creation_date": 1444255820, "post_id": 33003175, "comment_id": 53831479, "body": "The <code>a</code> in your class has no relation to the <code>a</code> in your instance, so you need to give <code>next</code> a value of the type <code>State [a] b</code>, or more likely fix your class declaration somehow."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1444256285, "post_id": 33003175, "comment_id": 53831677, "body": "It looks like you&#39;re trying to recreate <a href=\"https://hackage.haskell.org/package/monad-supply/docs/Control-Monad-Supply.html\" rel=\"nofollow noreferrer\"><code>MonadSupply</code> and <code>Supply</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1576306615, "post_id": 33003702, "comment_id": 104864542, "body": "Should that perhaps be <code>Generator NonEmpty</code>?"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 15, "last_activity_date": 1444302457, "last_edit_date": 1444302457, "creation_date": 1444258100, "answer_id": 33003702, "question_id": 33003175, "link": "https://stackoverflow.com/questions/33003175/haskell-type-resolution-in-type-classes/33003702#33003702", "title": "Haskell type resolution in Type Classes", "body": "<p>Reid's right in his comment. When you write</p>\n\n<pre><code>class Generator g where\n  next :: State g a\n</code></pre>\n\n<p>you're really saying</p>\n\n<pre><code>class Generator g where\n  next :: forall a. State g a\n</code></pre>\n\n<p>so that from a given state in <code>g</code>, your clients can generate an element of whatever type <code>a</code> they wish for, rather than whatever type is being supplied by the state in <code>g</code>.</p>\n\n<p>There are three sensible ways to fix this problem. I'll sketch them in the order I'd prefer them.</p>\n\n<p>Plan A is to recognize that any generator of things is in some sense a container of them, so presentable as a type constructor rather than a type. It should certainly be a <code>Functor</code> and with high probability a <code>Comonad</code>. So</p>\n\n<pre><code>class Comonad f =&gt; Generator f where\n  move :: forall x. f x -&gt; f x\n  next :: forall x. State (f x) x\n  next = state $ \\ g -&gt; (extract g, move g)\n  -- laws\n  -- move . duplicate = duplicate . move\n\ninstance Generator [] where\n  move = tail\n</code></pre>\n\n<p>If that's all Greek to you, maybe now is your opportunity to learn some new structure on a need-to-know basis!</p>\n\n<p>Plan B is to ignore the comonadic structure and add an <em>associated type</em>.</p>\n\n<pre><code>class Generator g where\n  type From g\n  next :: State g (From g)\n\ninstance Generator [a] where\n  type From [a] = a\n  next = state $ \\ (a : as) -&gt; (a, as)\n</code></pre>\n\n<p>Plan C is the \"functional dependencies\" version, which is rather like MonadSupply, as suggested by Cirdec.</p>\n\n<pre><code>class Generator g a | g -&gt; a where\n  next :: State g a\n\ninstance Generator [a] a where\n  next = state $ \\ (a : as) -&gt; (a, as)\n</code></pre>\n\n<p>What all of these plans have in common is that the functional relationship between <code>g</code> and <code>a</code> is somehow acknowledged. Without that, there's nothing doing.</p>\n"}], "owner": {"reputation": 1308, "user_id": 340597, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/6efb7f7a58f040077885d1fcae624151?s=128&d=identicon&r=PG", "display_name": "Keynan", "link": "https://stackoverflow.com/users/340597/keynan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 2, "accepted_answer_id": 33003702, "answer_count": 1, "score": 9, "last_activity_date": 1444302457, "creation_date": 1444255385, "question_id": 33003175, "link": "https://stackoverflow.com/questions/33003175/haskell-type-resolution-in-type-classes", "title": "Haskell type resolution in Type Classes", "body": "<p>Haskell seems to be having trouble resolving 'g == [a]' when performing type inference. Any ideas how to make this work?</p>\n\n<p>Thx</p>\n\n<pre><code>module X where\n\nimport Control.Monad.State.Lazy\n\nclass Generator g where\n  next :: State g a\n\ninstance Generator ([] a) where\n  next = nextL\n\nnextL :: State [a] a\nnextL = state $ split\n\nsplit :: [a] -&gt; (a, [a])\nsplit l = (head l, tail l)\n</code></pre>\n"}, {"tags": ["haskell", "instance", "ghc"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1444252526, "post_id": 33002330, "comment_id": 53829977, "body": "Why not just use <code>deriving (Read, Show)</code>?  That way you don&#39;t have to write any of those instances"}, {"owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1444253914, "post_id": 33002330, "comment_id": 53830634, "body": "Because deriving <code>Combin</code> cause the output string of <code>Combin PrefA ValC</code> to be &quot;Combin a mp&quot;. And it&#39;s not what I want. I want &quot;amp&quot; concatened together. Same thing for read."}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 2, "last_activity_date": 1445220942, "creation_date": 1445220942, "answer_id": 33205617, "question_id": 33002330, "link": "https://stackoverflow.com/questions/33002330/read-instance-of-a-combined-datatype-with-haskell/33205617#33205617", "title": "Read instance of a combined datatype with Haskell", "body": "<p>Your <code>readsPrec</code> implementations are wrong, since they are supposed to accept valid prefixes of the input, not necessarily consume the whole input. Your <code>readsPrec</code> functions are not composable.</p>\n\n<p>The key to the solution is to rewrite them so that they check if their input matches any of the names:</p>\n\n<pre><code>import Data.List (stripPrefix)\n\ninstance Read Type where\n    readsPrec _ s | Just s' &lt;- stripPrefix \"typeA\" s = [(ValA, s')]\n                  | Just s' &lt;- stripPrefix \"O\" s     = [(Valb, s')]\n                  | Just s' &lt;- stripPrefix \"mp\" s    = [(ValC, s')]\n                  | otherwise = []\n</code></pre>\n\n<p>and similarly for <code>Prefix</code>:</p>\n\n<pre><code>instance Read Prefix where\n    readsPrec _ s | Just s' &lt;- stripPrefix \"a\" s  = [(PrefA, s')]\n                  | Just s' &lt;- stripPrefix \"bm\" s = [(PrefB, s')]\n                  | Just s' &lt;- stripPrefix \"c\" s  = [(PrefC, s')]\n                  | otherwise = [(NoPref, s)]\n</code></pre>\n\n<p>Note the last branch of <code>readsPrec</code> for <code>Prefix</code>, which says that every string that doesn't begin with <code>\"a\"</code>, <code>\"bm\"</code> or <code>\"c\"</code> is to be parsed as <code>NoPref</code>. This only works for <code>Combin</code> because there's no <code>Type</code> which starts with any of the <code>Prefix</code> bits; otherwise, the parser for <code>Prefix</code> would need to be nondeterminstic, since a string like <code>\"aXY\"</code> could either correspond to a <code>Prefix</code> of <code>\"a\"</code> and a <code>Type</code> of <code>\"XY\"</code>, or a <code>Prefix</code> of <code>NoPref</code> and a <code>Type</code> of <code>\"aXY\"</code>. I went with the deterministically eager version here because I think it's going to be easier for you to understand how it works.</p>\n\n<p>Once we have these two <code>Read</code> instances, writin ghte one for <code>Combin</code> is a straightforward matter of trying to read the whole string with <code>reads</code> for <code>Prefix</code>, and then trying to read each remainder as a <code>Type</code>:</p>\n\n<pre><code>instance Read Combin where\n    readsPrec _ s = [(Combin pre typ, s'') | (pre, s') &lt;- reads s, (typ, s'') &lt;- reads s']\n</code></pre>\n\n<p>If you are familiar with <code>do</code> notation and the <code>[]</code> monad, you can rewrite this as</p>\n\n<pre><code>instance Read Combin where\n    readsPrec _ s = do\n        (pre, s) &lt;- reads s\n        (typ, s) &lt;- reads s\n        return (Combin pre typ, s)\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 33205617, "answer_count": 1, "score": 0, "last_activity_date": 1445220942, "creation_date": 1444251635, "last_edit_date": 1444337357, "question_id": 33002330, "link": "https://stackoverflow.com/questions/33002330/read-instance-of-a-combined-datatype-with-haskell", "title": "Read instance of a combined datatype with Haskell", "body": "<p>I implemented these (simplified) datatypes in a Haskell program : </p>\n\n<pre><code>data Type  = ValA\n           | Valb\n           | ValC\n\ndata Prefix = PrefA\n            | PrefB\n            | PrefC\n            | NoPref\n\ndata Combin = Combin Prefix Type\n\ninstance Show Type where\n  show ValA = \"typeA\"\n  show Valb = \"O\"\n  show ValC = \"mp\"\n\ninstance Read Type where\n  readsPrec  _ \"typeA\" = [(ValA,\"\")]\n  readsPrec  _ \"O\"     = [(Valb,\"\")]\n  readsPrec  _ \"mp\"    = [(ValC,\"\")]\n\ninstance Show Prefix where\n  show PrefA = \"a\"\n  show PrefB = \"bm\"\n  show PrefC = \"c\"\n  show NoPref = \"\"\n\ninstance Read Prefix where\n  readsPrec  _ \"a\"  = [(PrefA,\"\")]\n  readsPrec  _ \"bm\" = [(PrefB,\"\")]\n  readsPrec  _ \"c\"  = [(PrefC,\"\")]\n  readsPrec  _ \"\"   = [(NoPref,\"\")]\n\ninstance Show Combin where\n  show (Combin pre typ) = show pre++show typ\n</code></pre>\n\n<p>With the instances, I'm able to <code>show</code> and <code>read</code> the types <code>Prefix</code> and <code>Type</code>. The <code>Combin</code> datatype is a concatenation of a <code>Prefix</code> and a <code>Type</code>.\nNow, I would like to implement the read instance for the <code>Combin</code> datatype and I have no idea on how to do it. </p>\n\n<p>I thought about deriving the Combin type, but it cause the output string of Combin PrefA ValC to be \"Combin a mp\". And it's not what I want. I want \"amp\" concatened together. Same thing for read</p>\n\n<p>I thought about making pattern matching with the input string but the <code>Prefix</code> strings have differents length and may be void (<code>NoPref</code>).</p>\n\n<p><strong>Have you ever implemented a such functionnality with read ? Do you know how to do it ?</strong></p>\n"}, {"tags": ["haskell", "reactive-banana"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444249550, "post_id": 33001718, "comment_id": 53828473, "body": "so you did end up giving 1.0 a try?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1444249824, "post_id": 33001718, "comment_id": 53828615, "body": "&quot;<code>Moment</code> has no <code>MonadFix</code> instance&quot; -- In the current <i>master</i> <a href=\"https://github.com/HeinrichApfelmus/reactive-banana/blob/3ac2dfc54e09ee9ce72d241fb434af10c7477d1b/reactive-banana/src/Reactive/Banana/Types.hs#L102\" rel=\"nofollow noreferrer\">it does</a>."}, {"owner": {"reputation": 1256, "user_id": 432908, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/097eae56da66c90c498796daf225ccc4?s=128&d=identicon&r=PG", "display_name": "apirogov", "link": "https://stackoverflow.com/users/432908/apirogov"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444252042, "post_id": 33001718, "comment_id": 53829745, "body": "@ErikAllik Yes, I decided to get the newest version from github instead of wasting time with the old API :)"}, {"owner": {"reputation": 1256, "user_id": 432908, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/097eae56da66c90c498796daf225ccc4?s=128&d=identicon&r=PG", "display_name": "apirogov", "link": "https://stackoverflow.com/users/432908/apirogov"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1444252054, "post_id": 33001718, "comment_id": 53829748, "body": "@duplode oh, I see, I did a stupid mistake... problem solved!"}], "answers": [{"tags": [], "owner": {"reputation": 1256, "user_id": 432908, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/097eae56da66c90c498796daf225ccc4?s=128&d=identicon&r=PG", "display_name": "apirogov", "link": "https://stackoverflow.com/users/432908/apirogov"}, "is_accepted": false, "score": 5, "last_activity_date": 1444252201, "creation_date": 1444252201, "answer_id": 33002470, "question_id": 33001718, "link": "https://stackoverflow.com/questions/33001718/reactive-banana-1-0-monadic-api-how-to-define-recursive-behaviors-now/33002470#33002470", "title": "reactive-banana 1.0 monadic API: How to define recursive behaviors now?", "body": "<p>Ok, this was a stupid mistake. I just needed to add <code>MonadFix m</code> as a constraint, as I am not working with the <code>Moment</code> Monad directly:</p>\n\n<pre><code>mkCounter :: (MonadFix m,MonadMoment m,Enum a,Ord a) =&gt; a -&gt; Maybe a -&gt; Maybe a -&gt; Bool\n          -&gt; Event b -&gt; Event c -&gt; m (Behavior a)\n</code></pre>\n\n<p>Then it works as expected with <code>mdo</code>.</p>\n"}], "owner": {"reputation": 1256, "user_id": 432908, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/097eae56da66c90c498796daf225ccc4?s=128&d=identicon&r=PG", "display_name": "apirogov", "link": "https://stackoverflow.com/users/432908/apirogov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1444252201, "creation_date": 1444249140, "question_id": 33001718, "link": "https://stackoverflow.com/questions/33001718/reactive-banana-1-0-monadic-api-how-to-define-recursive-behaviors-now", "title": "reactive-banana 1.0 monadic API: How to define recursive behaviors now?", "body": "<p>In reactive-banana &lt;1.0.0, this worked:</p>\n\n<pre><code>-- takes a start value, minimum and maximum value, flag whether counter is\n-- cyclic, an increment and decrement event stream and returns a behavior\nmkCounter :: (Enum a,Ord a) =&gt; a -&gt; Maybe a -&gt; Maybe a -&gt; Bool\n          -&gt; Event t b -&gt; Event t c -&gt; Behavior t a\nmkCounter start minVal maxVal cyclic incE decE = counter\n  let incF curr | isNothing maxVal = succ\n                | Just maxv &lt;- maxVal, curr&lt;maxv = succ\n                | Just maxv &lt;- maxVal, Just minv &lt;- minVal, cyclic = const minv\n                | otherwise = id\n      decF curr | isNothing minVal = pred\n                | Just minv &lt;- minVal, curr&gt;minv = pred\n                | Just minv &lt;- minVal, Just maxv &lt;- maxVal, cyclic = const maxv\n                | otherwise = id\n  counter = accumB start $ ((incF &lt;$&gt; counter) &lt;@ incE) `union`((decF &lt;$&gt; counter) &lt;@ decE)\n</code></pre>\n\n<p>Now, <code>counter</code> is defined in terms of itself. But in the new monadic API, <code>accumB</code> is a monadic function, and this is where I don't see how to proceed - <code>Moment</code> has no <code>MonadFix</code> instance, so how does it work now?</p>\n\n<p>For obvious reasons this does NOT work ('Not in scope: counter')</p>\n\n<pre><code>mkCounter :: (MonadMoment m,Enum a,Ord a) =&gt; a -&gt; Maybe a -&gt; Maybe a -&gt; Bool\n          -&gt; Event b -&gt; Event c -&gt; m (Behavior a)\nmkCounter start minVal maxVal cyclic incE decE = do\n  -- .. same as above ..\n  counter &lt;- accumB start $ unions [((incF &lt;$&gt; counter) &lt;@ incE)\n                                   ,((decF &lt;$&gt; counter) &lt;@ decE)]\n  return counter\n</code></pre>\n\n<p>What is the correct way to do it now? Thanks in advance!</p>\n"}, {"tags": ["haskell", "enums"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1444249323, "post_id": 33001638, "comment_id": 53828363, "body": "<code>succ</code> is given by some implementation that can determine whether it\u2019s valid or not."}], "answers": [{"comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1444249941, "post_id": 33001786, "comment_id": 53828681, "body": "And how can <code>succ</code> do this without <code>(Bounded a, Eq a) =&gt; a</code>? Is it a &quot;primitives can break rules&quot; case?"}, {"owner": {"reputation": 8276, "user_id": 327038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e17117063f64ef47f36ab4ee45bf3d4b?s=128&d=identicon&r=PG", "display_name": "asthasr", "link": "https://stackoverflow.com/users/327038/asthasr"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1444250540, "post_id": 33001786, "comment_id": 53828995, "body": "I think it&#39;s simply that <code>succ</code> does not require any bounds or equality testing; it requires only that there be a function <code>a -&gt; a</code>. Quite literally, it could (uselessly) be the same thing as the <code>id</code> function."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 3, "creation_date": 1444251269, "post_id": 33001786, "comment_id": 53829369, "body": "@Mephy: In the <code>Enum</code> instance for a given type, <code>succ</code> is defined specifically for <i>that one type</i>, not generally, and can exploit <i>anything</i> about that one type.  For example, here <code>succ</code> is being defined for <code>Ordering</code>.  Any function on <code>Ordering</code> is fair game.  <code>succ</code> can be <i>used</i> generally, but it&#39;s <i>implemented</i> once per type."}, {"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1444253040, "post_id": 33001786, "comment_id": 53830241, "body": "@LouisWasserman an oversight on my part, thanks for your explanation."}], "tags": [], "owner": {"reputation": 8276, "user_id": 327038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e17117063f64ef47f36ab4ee45bf3d4b?s=128&d=identicon&r=PG", "display_name": "asthasr", "link": "https://stackoverflow.com/users/327038/asthasr"}, "is_accepted": false, "score": 2, "last_activity_date": 1444249404, "creation_date": 1444249404, "answer_id": 33001786, "question_id": 33001638, "link": "https://stackoverflow.com/questions/33001638/cycling-a-value-enum-a-bounded-a-a/33001786#33001786", "title": "Cycling a value (Enum a, Bounded a) =&gt; a", "body": "<p>It looks like, for some of the typeclass instances, it simply defines the functions as you have done with your example:</p>\n\n<pre><code>instance Enum Ordering where\n  succ LT = EQ\n  succ EQ = GT\n  succ GT = error \"Prelude.Enum.Ordering.succ: bad argument\"\n\n  pred GT = EQ\n  pred EQ = LT\n  pred LT = error \"Prelude.Enum.Ordering.pred: bad argument\"\n</code></pre>\n\n<p>Otherwise, as you say, it seems most likely that you're going to need to allow for <code>Eq</code>, because fundamentally there must be some concept of comparison (in order to compare the bounds against the current value), if the full space of the type can't be easily enumerated.</p>\n"}, {"comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1444250429, "post_id": 33001954, "comment_id": 53828939, "body": "This looks great! Are these limitations always caught by the type system? Trying it out on GHCi, <code>previous 10</code> gives a compilation-time error while <code>previous (10 :: Int)</code> works fine."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1444251882, "post_id": 33001954, "comment_id": 53829680, "body": "No they are not. If an instance of <code>Enum</code> has more elements than the size of <code>Int</code>, then <code>from&#47;toEnum</code> simply break. <code>succ</code> and <code>pred</code> may still work."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1444252034, "post_id": 33001954, "comment_id": 53829740, "body": "<code>previous 10</code> is a valid expression whose type would be <code>Num a, Enum a, Bounded a =&gt; a</code>, however, GHCI can&#39;t print it because it doesn&#39;t know which type to pick for <code>a</code>. Usually it picks <code>Integer</code> but that isn&#39;t <code>Bounded</code>. If you type <code>default (Int)</code> into your GHCI session, then it will try defaulting to <code>Int</code> instead - so <code>previous 10</code> will be defaulted to <code>Int</code>, and will work without a type signature."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 6, "last_activity_date": 1444249996, "creation_date": 1444249996, "answer_id": 33001954, "question_id": 33001638, "link": "https://stackoverflow.com/questions/33001638/cycling-a-value-enum-a-bounded-a-a/33001954#33001954", "title": "Cycling a value (Enum a, Bounded a) =&gt; a", "body": "<p>The <code>Enum</code> class defines two functions</p>\n\n<pre><code>  toEnum :: Enum a =&gt; Int -&gt; a\n  fromEnum :: Enum a =&gt; a -&gt; Int\n</code></pre>\n\n<p>These functions can be used to compare an <code>Enum</code> to another, if the range of that <code>Enum</code> fits into the size of <code>Int</code>. If you are willing to accept this slight limitation, you can write your functions as follows.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nprevious :: forall a . (Enum a, Bounded a) =&gt; a -&gt; a\nprevious x | from x &gt; from minBound = pred x \n           | otherwise              = maxBound where from :: a -&gt; Int; from = fromEnum \n\nnext :: forall a . (Enum a, Bounded a) =&gt; a -&gt; a\nnext x | from x &lt; from maxBound = succ x \n       | otherwise              = minBound where from :: a -&gt; Int; from = fromEnum  \n</code></pre>\n\n<p>These functions make several assumptions; that given <code>(Enum a, Bounded a)</code>, every value of <code>a</code> will be between the <code>minBound</code> and <code>maxBound</code>, inclusive, and that <code>{to/from}Enum</code> preserve this ordering, with respect to the ordering on integers. This is true for simple enumerations:</p>\n\n<pre><code>&gt;import Control.Arrow\n&gt;map (next &amp;&amp;&amp; previous) [A,B,C]\n[(B,C),(C,A),(A,B)]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1444251098, "post_id": 33002082, "comment_id": 53829287, "body": "This solution has apparently the same limitations as user2407038&#39;s answer (<code>cycleNext 10</code> gives compilation-time error, <code>cyclenext (10 :: Int)</code> works fine), but does not require <code>-XScopedTypeVariables</code>. Thanks for the contribution."}], "tags": [], "owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "is_accepted": false, "score": 5, "last_activity_date": 1444250604, "creation_date": 1444250604, "answer_id": 33002082, "question_id": 33001638, "link": "https://stackoverflow.com/questions/33001638/cycling-a-value-enum-a-bounded-a-a/33002082#33002082", "title": "Cycling a value (Enum a, Bounded a) =&gt; a", "body": "<p>What's the problem? If you can add the <code>Eq</code> class too, it's easy:</p>\n\n<pre><code>module CycleEnum where\n\ndata XEnum = A1 | A2 | A3 deriving (Bounded, Enum, Eq, Show)\n\ncyclePrev :: (Eq a, Enum a, Bounded a) =&gt; a -&gt; a\ncyclePrev x = if x == minBound then maxBound else pred x\n\ncycleNext :: (Eq a, Enum a, Bounded a) =&gt; a -&gt; a\ncycleNext x = if x == maxBound then minBound else succ x\n</code></pre>\n\n<p>Without <code>Eq</code>, it's slightly more complicated...</p>\n\n<pre><code>module CycleEnum where\n\ndata XEnum = A1 | A2 | A3 deriving (Bounded, Enum, Show)\n\nisSingle :: [a] -&gt; Bool\nisSingle [x] = True\nisSingle _ = False\n\nisLastElement :: Enum a =&gt; a -&gt; Bool\nisLastElement x = isSingle $ enumFrom x\n\nisFirstElement :: (Enum a, Bounded a) =&gt; a -&gt; Bool\nisFirstElement x = isSingle $ enumFromTo minBound x\n\ncyclePrev :: (Enum a, Bounded a) =&gt; a -&gt; a\ncyclePrev x = if isFirstElement x then maxBound else pred x\n\ncycleNext :: (Enum a, Bounded a) =&gt; a -&gt; a\ncycleNext x = if isLastElement x then minBound else succ x\n</code></pre>\n\n<p>Note that I wrote <code>isSingle</code> with pattern matching, and not by calling <code>length</code>; because calculating the length of a list can be very inefficient if you just want to know if the list contains exactly one element.</p>\n"}], "owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 33001954, "answer_count": 3, "score": 7, "last_activity_date": 1444250604, "creation_date": 1444248864, "last_edit_date": 1495541837, "question_id": 33001638, "link": "https://stackoverflow.com/questions/33001638/cycling-a-value-enum-a-bounded-a-a", "title": "Cycling a value (Enum a, Bounded a) =&gt; a", "body": "<p>I'm looking for the pair of functions</p>\n\n<pre><code>previous :: (Enum a, Bounded a) =&gt; a -&gt; a\nnext     :: (Enum a, Bounded a) =&gt; a -&gt; a\n</code></pre>\n\n<p>Such that <code>previous</code> is <code>pred :: Enum a =&gt; a -&gt; a</code> if the resulting value will be constrained by the bounds, and cycle it to the other side otherwise (symmetrical for <code>next</code> and <code>succ</code>).</p>\n\n<p>Example</p>\n\n<pre><code>data X = A | B | C deriving (Bounded, Enum)\nnext A = B\nnext B = C\nnext C = A\n</code></pre>\n\n<p>This would be easy if I were to add the <code>Eq a =&gt; a</code> constraint, as discussed in these <a href=\"https://stackoverflow.com/questions/25788202/is-there-a-way-to-plus-one-to-an-enum-bounded-ord-type-in-a-list-in-haskell\">similar</a> <a href=\"https://stackoverflow.com/questions/13387881/haskell-bound-values-in-generic-functions\">questions</a>.\nBut this constraint seems unnecessary, as a <code>Bounded a =&gt; a</code> type to me sounds like it should be able to tell if its within bound or not. The <code>succ</code> and <code>pred</code> functions themselves have some kind of control over this, but I would rather not use Exceptions in my otherwise pure code:</p>\n\n<pre><code>Prelude&gt; succ (maxBound :: Int)\n*** Exception: Prelude.Enum.succ{Int}: tried to take `succ' of maxBound\n</code></pre>\n\n<p>How does <code>succ</code>/<code>pred</code> test against the bounds without requiring <code>Eq a =&gt; a</code> (or even <code>Bounded a =&gt; a</code>)? Can I replicate this behavior in my own function? Or is there another way to write a function with this behavior and not requiring the <code>Eq</code> constraint?</p>\n"}, {"tags": ["haskell", "records"], "comments": [{"owner": {"reputation": 14562, "user_id": 71116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e3643cd0195fab5a3bfa310b5ea27e7?s=128&d=identicon&r=PG", "display_name": "Michael Steele", "link": "https://stackoverflow.com/users/71116/michael-steele"}, "edited": false, "score": 2, "creation_date": 1444241269, "post_id": 32999028, "comment_id": 53823462, "body": "The <code>head</code> function returns a <code>Char</code>. Am I correct to understand that you want the type of your fields to change depending on what the supplied function returns?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1444241798, "post_id": 32999028, "comment_id": 53823761, "body": "uniplate is a lightweight generics library that can probably do that easily."}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 14562, "user_id": 71116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e3643cd0195fab5a3bfa310b5ea27e7?s=128&d=identicon&r=PG", "display_name": "Michael Steele", "link": "https://stackoverflow.com/users/71116/michael-steele"}, "edited": false, "score": 0, "creation_date": 1444246200, "post_id": 32999028, "comment_id": 53826481, "body": "@MichaelSteele my fault, something like <code>tail</code> which will return same type <code>String</code>. I&#39;ve updated questions"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444248343, "post_id": 32999028, "comment_id": 53827829, "body": "In the case of <code>tail</code>, @leftroundabout&#39;s answer is the one to use. Note that even though you are looking for a function Config -&gt; Config, you&#39;ll want to add a type variable to the definition of Config (as in @leftroundabout&#39;s answer) so that <code>fmap</code> can do the work for you."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1444248510, "post_id": 32999028, "comment_id": 53827930, "body": "Are you sure you aren&#39;t thinking by analogy with a dynamically typed language where this would be a natural thing to do. In Haskell its not impossible, but in general each field of a data structure would represent a different type of thing, and hence be processed with a different function. The look of your structure seems to suggest a dictionary or array, in which case Data.Map or Array might be more suitable."}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1444256096, "post_id": 32999028, "comment_id": 53831601, "body": "@PaulJohnson Yes. I&#39;m sure. My config fields have 3 different kind of data inside <code>yaml</code> field - &quot;data&quot;, &quot;data:data&quot; and &quot;data:data:data&quot;. Since, I don&#39;t want to write parser, I&#39;m using <code>decodeFile</code> one-liner. It&#39;s easier for me to read through config to datatype and then provide case logic for fields afterwards"}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444246343, "post_id": 32999537, "comment_id": 53826548, "body": "monotraversable would be an alternative."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1445444096, "post_id": 32999537, "comment_id": 54329730, "body": "For strings, this seems like the obvious way to go. It&#39;s unfortunate that this approach prevents nice optimizations in some other situations."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 16, "last_activity_date": 1444241979, "last_edit_date": 1444241979, "creation_date": 1444241648, "answer_id": 32999537, "question_id": 32999028, "link": "https://stackoverflow.com/questions/32999028/how-to-iterate-over-record-fields/32999537#32999537", "title": "How to iterate over record fields?", "body": "<p>Well, the best way to do it would probably be</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\ntype Config = Config' String\ndata Config' a = Config\n  { field1 :: a\n  , field2 :: a\n  , field3 :: a\n  } deriving (Functor)\n\nconfigHeads :: Config -&gt; Config' Char\nconfigHeads = fmap head\n</code></pre>\n\n\n"}], "owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 4, "answer_count": 1, "score": 8, "last_activity_date": 1445417906, "creation_date": 1444239881, "last_edit_date": 1445417906, "question_id": 32999028, "link": "https://stackoverflow.com/questions/32999028/how-to-iterate-over-record-fields", "title": "How to iterate over record fields?", "body": "<p>I have following datatype defined as record</p>\n\n<pre><code>data Config = Config\n  { field1 :: String\n  , field2 :: String\n  , field3 :: String\n  }\n</code></pre>\n\n<p>I want to iterate over each field of <code>Config</code>, apply some function <code>String -&gt; String</code>, for example <code>tail</code> and get in return new <code>Config</code>. </p>\n\n<p>What is idiomatic way to do this? Preferably, without heavy 3rd party libraries. </p>\n"}, {"tags": ["function", "haskell", "functional-programming", "currying"], "comments": [{"owner": {"reputation": 17837, "user_id": 1923190, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/D0JyZ.jpg?s=128&g=1", "display_name": "Simon H", "link": "https://stackoverflow.com/users/1923190/simon-h"}, "edited": false, "score": 0, "creation_date": 1444236647, "post_id": 32997948, "comment_id": 53820773, "body": "Currying - <a href=\"http://learnyouahaskell.com/higher-order-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/higher-order-functions</a>"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444236692, "post_id": 32997948, "comment_id": 53820799, "body": "I&#39;m not sure what specifically you are confused sbout. Which <code>x</code> where?"}, {"owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 0, "creation_date": 1444237067, "post_id": 32997948, "comment_id": 53821033, "body": "hold on ill edit the question"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1444239813, "post_id": 32997948, "comment_id": 53822655, "body": "I would recommend rephrasing the question so that it is clearer what you expect the code to do. Also I suggest you add type signatures. They might point out weird things like <code>cube</code> being of type <code>[(a,b,c)]</code> while <code>cubes</code> is also <code>[(a,b,c)]</code>. While this might be intended, I fail to find any intuition behind the piece of code (I do not say that means anything)."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 4, "last_activity_date": 1444237645, "last_edit_date": 1444237645, "creation_date": 1444237341, "answer_id": 32998263, "question_id": 32997948, "link": "https://stackoverflow.com/questions/32997948/difficult-to-understand-function-definition/32998263#32998263", "title": "difficult to understand function definition", "body": "<p>In Haskell, we don't usually use tuples (ie: <code>(a,b,c)</code>) to pass arguments to functions. We use <em>currying</em>.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>add a b = a + b\n</code></pre>\n\n<p>Here <code>add</code> is a function that takes a number, the <em>returns another function</em> that takes a number, then returns a number. We represent it's type as so:</p>\n\n<pre><code>add :: Int -&gt; (Int -&gt; Int)\n</code></pre>\n\n<p>Because of the way <code>-&gt;</code> behaves, we can remove the parentheses in this case:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\n</code></pre>\n\n<p>It is called like this:</p>\n\n<pre><code>(add 1) 2\n</code></pre>\n\n<p>but because of the way application works, we can just write:</p>\n\n<pre><code>add 1 2\n</code></pre>\n\n<p>Doesn't that look like our definition above, of the form <code>add a b</code>...?</p>\n\n<hr>\n\n<p>Your function <code>pcubes</code> is similar. Here's how I'd write it:</p>\n\n<pre><code>pcubes x (b,n,m) = floor (sqrt (b*n)) == x\n</code></pre>\n\n<p>And as someone else said, it's type could be represented as:</p>\n\n<pre><code>pcubes :: Float -&gt; (Float, Float, Float) -&gt; Bool \n</code></pre>\n\n<hr>\n\n<p>When we write <code>pcubes 1</code> the type becomes:</p>\n\n<pre><code>pcubes 1 :: (Float, Float, Float) -&gt; Bool\n</code></pre>\n\n<p>Which, through currying, is legal, and can quite happily be used elsewhere.</p>\n\n<p>I know, this is crazy black functional magic, as it was for me, but before long I guarantee you'll never want to go back: curried functions are useful.</p>\n\n<hr>\n\n<p><em>A note on tuples: Expressions like <code>(a,b,c)</code> are</em> data <i>. They are not purely function-argument expressions. The fact that we can pull it into a function is called </i> pattern matching, <i>though it's not my turn to go into that.</i></p>\n"}], "owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444237645, "creation_date": 1444236301, "last_edit_date": 1444237422, "question_id": 32997948, "link": "https://stackoverflow.com/questions/32997948/difficult-to-understand-function-definition", "title": "difficult to understand function definition", "body": "<pre><code>cube (x,y,z) =\n  filter (pcubes x) cubes\n\n\ncubes = [(a,b,c) | a &lt;- [1..30],b &lt;- [1..30],c &lt;- [1..30]]\n\n\npcubes x (b,n,m) = (floor(sqrt(b*n)) == x)\n</code></pre>\n\n<p>so this code works, <code>cubes</code> makes a list of tuples,pcubes is used with filter to filter all the cubes in which <code>floor(sqrt(b*n)) == x</code> is satisfied,but the person who has modified my code wrote     <code>pcubes x</code> in <code>filter (pcubes x) cubes</code>,how does this work.<code>pcubes x</code> makes a function that will initial the <code>cubes x (b,n,m)</code> that will take in a tuple and output a bool.the bool will be used in the filter function. How does this sort of manipulation happen? how does <code>pcubes x</code> access the <code>(b,n,m)</code> part of the function?</p>\n"}, {"tags": ["performance", "function", "haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1444235075, "post_id": 32997325, "comment_id": 53819809, "body": "I guess YMMV on whether this is a useful use of GADTs. Still, pattern matching is the fastest thing there is: everything else depends on it (with the exception of things like floating point math). As far as &quot;data lookup&quot; (field accessors), you might look at core to see what they are actually doing."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 4, "creation_date": 1444235754, "post_id": 32997325, "comment_id": 53820232, "body": "Try it and see! But I would predict about an order of magnitude slowdown compared to using data. But that is more due to the overhead of calling an unknown function than due to pattern matching. The function version is also not quite the same because if the fields are more complicated expressions than just <code>32</code>, they will be re-evaluated each time. (Or you or the compiler floats it out of the function into a closure, and then you just reinvented storing data as data, with extra overhead to access it.)"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 6, "creation_date": 1444235996, "post_id": 32997325, "comment_id": 53820366, "body": "An issue with  the <code>(-&gt;)</code> representation is that updating fields leaks space and lookup gets slower after each update."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 3, "last_activity_date": 1444253808, "creation_date": 1444253808, "answer_id": 33002821, "question_id": 32997325, "link": "https://stackoverflow.com/questions/32997325/how-fast-is-haskell-pattern-matching/33002821#33002821", "title": "How fast is Haskell pattern matching?", "body": "<p>If you compile your code with <code>-ddump-asm</code> you can see the pattern match is a series of comparisons and jumps with the data embedded in the instructions (load an address for the string, load a constant for the number 32, etc).</p>\n\n<p>A container, such as a Map or HashMap, will be slower due to the indirection but hopefully it is obvious that a statically named variable is faster than traversing a (potentially dynamic) tree structure.</p>\n"}], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 1, "accepted_answer_id": 33002821, "answer_count": 1, "score": 3, "last_activity_date": 1444253808, "creation_date": 1444234303, "question_id": 32997325, "link": "https://stackoverflow.com/questions/32997325/how-fast-is-haskell-pattern-matching", "title": "How fast is Haskell pattern matching?", "body": "<p>We mostly use data to store values, like this:</p>\n\n<pre><code>data Sex = Male | Female\ndata Person = Person {name :: String, age :: Int, sex :: Sex}\n\ncharlie :: Person\ncharlie = Person \"Charlie\" 32 Male\n</code></pre>\n\n<p>And now we have nice functions <code>name</code> <code>age</code> and <code>sex</code> to get data values with.</p>\n\n<p>But, with GADTs and Rank2, we can do something cooler:</p>\n\n<pre><code>{-# LANGUAGE GADTs      #-}\n{-# LANGUAGE Rank2Types #-}\n\ndata Sex = Male | Female\n\ndata Data a where\n    Name :: Data String\n    Age  :: Data Int\n    Sex  :: Data Sex\n\ntype Person = forall a. Data a -&gt; a\n\ncharlie :: Person\ncharlie Name = \"Charlie\"\ncharlie Age  = 32\ncharlie Sex  = Male\n</code></pre>\n\n<p>So, this is pretty darned awesome. It provides us with a gloriously beautiful syntax for defining people, and makes slick use of GADTs.</p>\n\n<p>But is this really any better? How is this represented at runtime? Is pattern-matching actually slower and/or bigger in representation than the data?</p>\n\n<p><strong>lt;dr</strong>: How fast is pattern matching compared to data lookup?</p>\n"}, {"tags": ["haskell", "filter", "predicate", "prefix", "infix-notation"], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 1, "creation_date": 1444227739, "post_id": 32994397, "comment_id": 53814266, "body": "Worth mentioning: the result is the same for all: <code>(`elem` v)</code>, <code>(\\a -&gt; elem a v)</code>, and <code>(flip elem v)</code>. Also, if I am not mistaken, you don&#39;t need the dollar sign."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1444227820, "post_id": 32994397, "comment_id": 53814329, "body": "@jd823592 I thought a point of it was to provide an equivalent solution, and so I didn&#39;t think that mentioning it was important. As for the dollar, I typically leave it for consistency and easier &quot;function&quot; and &quot;data&quot; separation, though I do realize it&#39;s very subjective."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 1, "creation_date": 1444228382, "post_id": 32994397, "comment_id": 53814762, "body": "I did not mean to suggest I disapproved. I totally agree with your answer, I just thought it might not be obvious and additional info may improve understanding of the matter."}, {"owner": {"reputation": 157, "user_id": 3771392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bcc632a7a944f2fce2b9064894aa96?s=128&d=identicon&r=PG&f=1", "display_name": "Ghost Bunnies", "link": "https://stackoverflow.com/users/3771392/ghost-bunnies"}, "edited": false, "score": 0, "creation_date": 1444228420, "post_id": 32994397, "comment_id": 53814779, "body": "@bartek-banachewicz, this is what I was looking for, thanks a lot for your help!"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 5, "last_activity_date": 1444233708, "last_edit_date": 1444233708, "creation_date": 1444226663, "answer_id": 32994397, "question_id": 32994285, "link": "https://stackoverflow.com/questions/32994285/prefix-function-as-a-predicate-for-filter-function/32994397#32994397", "title": "Prefix function as a predicate for filter function", "body": "<p>Either by creating a lambda (which will work for functions taking more than 2 parameters):</p>\n\n<pre><code>filter' (\\a -&gt; elem a ['a'..'z']) \"Hell0!\"\n</code></pre>\n\n<p>Or by using <code>flip</code>:</p>\n\n<pre><code>filter' (flip elem ['a'..'z']) \"Hell0!\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 3771392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bcc632a7a944f2fce2b9064894aa96?s=128&d=identicon&r=PG&f=1", "display_name": "Ghost Bunnies", "link": "https://stackoverflow.com/users/3771392/ghost-bunnies"}, "edited": false, "score": 0, "creation_date": 1444228324, "post_id": 32994403, "comment_id": 53814707, "body": "@c-quilley, thanks a lot for your answer, even though I&#39;ve chosen @bartek-banachewicz&#39;s proposition as the best solution, because it suggests two different paths, <code>flip</code> is indeed what I was looking for!"}], "tags": [], "owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "is_accepted": false, "score": 1, "last_activity_date": 1444237641, "last_edit_date": 1444237641, "creation_date": 1444226673, "answer_id": 32994403, "question_id": 32994285, "link": "https://stackoverflow.com/questions/32994285/prefix-function-as-a-predicate-for-filter-function/32994403#32994403", "title": "Prefix function as a predicate for filter function", "body": "<p>Sounds like you're after <code>flip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c</code>, which is in the prelude.</p>\n\n<p>It can be implemented as <code>flip f = \\b a -&gt; f a b</code>.</p>\n"}], "owner": {"reputation": 157, "user_id": 3771392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bcc632a7a944f2fce2b9064894aa96?s=128&d=identicon&r=PG&f=1", "display_name": "Ghost Bunnies", "link": "https://stackoverflow.com/users/3771392/ghost-bunnies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 32994397, "answer_count": 2, "score": 3, "last_activity_date": 1444237641, "creation_date": 1444226432, "question_id": 32994285, "link": "https://stackoverflow.com/questions/32994285/prefix-function-as-a-predicate-for-filter-function", "title": "Prefix function as a predicate for filter function", "body": "<p>Here is the type signature and the definition of the <code>filter</code> function from <em>Learn You a Haskell for Great Good!</em>:</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' _ [] = []\nfilter' p (x:xs)\n    | p x = x : filter' p xs\n    | otherwise = filter' p xs\n</code></pre>\n\n<p>An usage example in the book is with <code>elem</code> is as follows:</p>\n\n<pre><code>filter' (`elem` ['a'..'z']) \"Hell0!\"\n</code></pre>\n\n<p>Which returns:</p>\n\n<pre><code>\"ell\"\n</code></pre>\n\n<p>In this particular example, is there a possible way of using <code>elem</code> as a prefix function instead of an infix function as a predicate?</p>\n\n<p>In a more general sense, is there a way to supply only the second parameter in order to partially apply a prefix function?</p>\n\n<p>Thanks in advance for your help!</p>\n"}, {"tags": ["haskell", "reactive-banana"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444230337, "post_id": 32994152, "comment_id": 53816307, "body": "I&#39;ve been told reactive-banana 1.0 (current <code>master</code>) will simplify the types in non-trivial and substantial ways, such as not requiring <code>RankNTypes</code> (in some scenarios?), so you might give it a try."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444292292, "post_id": 32994152, "comment_id": 53844316, "body": "@ErikAllik The API changes for reactive-banana 1.0 mainly concern the type parameter <code>t</code>. The question at hand is unrelated to this."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1444228531, "post_id": 32994944, "comment_id": 53814867, "body": "Alas, I can confirm that <code>ImpredicativeTypes</code> is very brittle \u2013 but can you say <i>why</i> it&#39;s so little-maintained? I feel it should be a rather natural extension to <code>RankN</code>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1444229899, "post_id": 32994944, "comment_id": 53815950, "body": "@leftaroundabout <a href=\"https://mail.haskell.org/pipermail/glasgow-haskell-users/2014-February/024684.html\" rel=\"nofollow noreferrer\">Explanation by Simon PJ</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1444229903, "post_id": 32994944, "comment_id": 53815951, "body": "@leftaroundabout, I personally cannot, but my impression is that it&#39;s a &quot;deep&quot; problem. GHC&#39;s type checker is apparently fundamentally incapable of doing it right, and no one knows how to write a type checker that does it right, offers all the other pretty things, and gives vaguely human-readable error messages."}, {"owner": {"reputation": 1256, "user_id": 432908, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/097eae56da66c90c498796daf225ccc4?s=128&d=identicon&r=PG", "display_name": "apirogov", "link": "https://stackoverflow.com/users/432908/apirogov"}, "edited": false, "score": 0, "creation_date": 1444231196, "post_id": 32994944, "comment_id": 53816969, "body": "Thanks! The necessary unwrapping is a bit unsatisfactory, but it works!"}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 7, "last_activity_date": 1444232435, "last_edit_date": 1444232435, "creation_date": 1444228072, "answer_id": 32994944, "question_id": 32994152, "link": "https://stackoverflow.com/questions/32994152/create-an-event-stream-of-polymorphic-functions-possible-if-yes-how/32994944#32994944", "title": "Create an event stream of polymorphic functions - possible? If yes, how?", "body": "<p><code>ImpredicativeTypes</code> is an incredibly brittle extension that is not really supported or maintained and so keeps breaking further in new GHC versions.</p>\n\n<p>A much better working option is to use <code>RankNTypes</code> together with a <code>newtype</code> wrapper:</p>\n\n<pre><code>newtype PolyRandFun = PR { getPR :: forall a. Random a =&gt; (a,a) -&gt; a) }\n</code></pre>\n\n<p>This requires you to explicitly wrap and unwrap the newtype constructor, but otherwise works fine for passing around polymorphic functions like this.</p>\n\n<p>Unfortunately I foresee another problem in this case. Different <code>Random a</code> instances use their random generator a <em>different</em> amount, and in the case of e.g. <code>Integer</code> the amount of primitive random numbers generated to build the <code>Integer</code> result will even depend on the size of the range. So you cannot get the next <code>g</code> without knowing the type and range used when actually calling your functions.</p>\n\n<p>Fortunately there's a function in the <code>System.Random</code> API that can get around this: <code>split</code> gives you a new random generator that can be passed into subcalculations when you really need to generate several random values entirely independently.</p>\n"}], "owner": {"reputation": 1256, "user_id": 432908, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/097eae56da66c90c498796daf225ccc4?s=128&d=identicon&r=PG", "display_name": "apirogov", "link": "https://stackoverflow.com/users/432908/apirogov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 32994944, "answer_count": 1, "score": 6, "last_activity_date": 1444232792, "creation_date": 1444226119, "last_edit_date": 1444232792, "question_id": 32994152, "link": "https://stackoverflow.com/questions/32994152/create-an-event-stream-of-polymorphic-functions-possible-if-yes-how", "title": "Create an event stream of polymorphic functions - possible? If yes, how?", "body": "<p>I am currently learning FRP with reactive-banana and wanted to create a stream of random functions. I've come up with this:</p>\n\n<pre><code>-- | take number generator, and some pulse event stream, generate random function stream\nmkRandom :: (Random a,RandomGen g) =&gt; g -&gt; Event t b -&gt; Event t ((a,a) -&gt; a)\nmkRandom rng es = (\\f -&gt; \\r -&gt; fst $ f r) &lt;$&gt; (accumE first $ next &lt;$&gt; es)\n  where first = flip randomR rng\n        next _ prev range = randomR range g\n          where (a,g) = prev range\n</code></pre>\n\n<p>It seems to work, I can use it like this:</p>\n\n<pre><code>randFuncs = mkRandom rnd (pulse 1000 time)\nsome = ($ (0,10::Int)) &lt;$&gt; randFuncs\n</code></pre>\n\n<p>But, of course, when I try to share that stream to generate numbers of a different type:</p>\n\n<pre><code>some2 = ($ (0,10::Double)) &lt;$&gt; randFuncs\n</code></pre>\n\n<p>The type checker complains, which I understand. Then I tried to generalize the function to the following:</p>\n\n<pre><code>mkRandom :: (RandomGen g) =&gt; g -&gt; Event t b -&gt; Event t (forall a. Random a =&gt; (a,a) -&gt; a)\n</code></pre>\n\n<p>Then GHC complained about illegal polymorphic signature and whether I'd like to enable ImpredicativeTypes. I did it and for quite a while tried to annotate everything to make it work, but GHC always complained that it could not match the types.</p>\n\n<p>My question is - is it possible to do what I want? Do I really need ImpredicativeTypes for that or am I just doing it wrong?</p>\n\n<p>I thought RankNTypes should be enough for it, but I have no experience with such extensions yet.</p>\n\n<p>Thanks in advance!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>For the record, now my solution based on the helpful response is:</p>\n\n<pre><code>newtype RandomSource = Rand { getRand :: forall a. (Random a) =&gt; (a,a) -&gt; [a] }\n\n-- | take number generator and some pulse event stream, generate randomness stream\nmkRandom :: RandomGen g =&gt; g -&gt; Event t a -&gt; Behavior t RandomSource\nmkRandom rng es = fst &lt;$&gt; (accumB (next id (id,rng)) $ next &lt;$&gt; es)\n  where next _ (_,rng) = (Rand $ flip randomRs g1, g2)\n          where (g1,g2) = split rng\n\n-- | take a rand. source, a range and a pulse, return stream of infinite lists of random numbers\nrandStream :: Random a =&gt; Behavior t RandomSource -&gt; (a,a) -&gt; Event t b -&gt; Event t [a]\nrandStream funcs range pulse = ($ range) . getRand &lt;$&gt; funcs &lt;@ pulse\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1444228277, "post_id": 32993988, "comment_id": 53814673, "body": "Even if functions had an <code>Eq</code> instance it would be a useless instance. Function equality is undecidable and so it would return wrong results, no matter how it is implemented."}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1444228659, "post_id": 32993988, "comment_id": 53814974, "body": "Not necessarily. Equality could be checked for the trivial case, which would be useful in my specific case: <code>fn == fn</code>, or less trivially: <code>let fn&#39; = fn in fn == fn&#39;</code>. So in these cases, the pointers to these functions are identical, AFAIU, and those can be compared. For example functions can be compared like this in JavaScript; if it returns true, you can be sure they are the same. If it returns false, they may still behave identically, but we at least know that their pointers point to different memory addresses."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1444229810, "post_id": 32993988, "comment_id": 53815888, "body": "You invoke \u201cJavaScript does it\u201d as a reason that something should be possible in Haskell \u2013 <a href=\"https://www.destroyallsoftware.com/talks/wat\" rel=\"nofollow noreferrer\">seriously</a>? No, really, apart from totally not being in the spirit of Haskell, to replace equality with pointer equality would also not be very useful: because values are so often re-wrapped, re-arranged, identity-composed etc.. All of that will break pointer equality though it&#39;s structure-preserving. \u2014 To check whether different modules export the same stuff, surely the correct solution would operate on the syntax/module level, not on the value level?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1444234187, "post_id": 32993988, "comment_id": 53819247, "body": "Besides, pointer equality would break referential transparency, making it both useless and illegal."}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444235015, "post_id": 32993988, "comment_id": 53819770, "body": "That&#39;s an interesting point @ReinHenrichs, could you give an example on how it would break referential transparency?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1444235279, "post_id": 32993988, "comment_id": 53819936, "body": "It does so literally, by making the reference no longer transparent. It means I can&#39;t replace <code>id foo</code> with <code>foo</code> and yield an equivalent program."}], "answers": [{"comments": [{"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457239489, "post_id": 32999645, "comment_id": 59313604, "body": "For a certain definition of &quot;beautiful&quot; that&#39;s beautiful!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1444241976, "creation_date": 1444241976, "answer_id": 32999645, "question_id": 32993988, "link": "https://stackoverflow.com/questions/32993988/is-there-a-way-in-haskell-to-check-whether-a-module-exports-the-same-functions-a/32999645#32999645", "title": "Is there a way in Haskell to check whether a module exports the same functions as an other one?", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/System-Mem-StableName.html\" rel=\"nofollow\"><code>StableName</code></a>s in IO:</p>\n\n<pre><code>Prelude Data.List System.Mem.StableName&gt; v  &lt;- makeStableName   Prelude.takeWhile\nPrelude Data.List System.Mem.StableName&gt; v' &lt;- makeStableName Data.List.takeWhile\nPrelude Data.List System.Mem.StableName&gt; v == v'\nTrue\n</code></pre>\n"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1444241976, "creation_date": 1444225722, "last_edit_date": 1444226206, "question_id": 32993988, "link": "https://stackoverflow.com/questions/32993988/is-there-a-way-in-haskell-to-check-whether-a-module-exports-the-same-functions-a", "title": "Is there a way in Haskell to check whether a module exports the same functions as an other one?", "body": "<p>I have some specs (written with HSpec) and would like to have a test that checks whether the re-exporting of some functions takes place as intended.</p>\n\n<p>Code:</p>\n\n<p><a href=\"https://github.com/Wizek/compose-ltr/blob/ab954f00beb56c6c1a595261381d40e7e824e3bc/spec/Spec.hs#L4\" rel=\"nofollow\">https://github.com/Wizek/compose-ltr/blob/ab954f00beb56c6c1a595261381d40e7e824e3bc/spec/Spec.hs#L4</a></p>\n\n<p>If I go into this file, I can run all tests with either import if I manually switch whether line 4 or 5 is commented out. Is there a simple way to have an automated specification that ensures that both modules export the same functions?</p>\n\n<p>The first thing I thought of is to import one of the modules qualified, and check for equality:</p>\n\n<pre><code>(($&gt;) == (ComposeLTR.$&gt;)) `shouldBe` True\n-- Or more succintly\n($&gt;) `shouldBe` (ComposeLTR.$&gt;)\n</code></pre>\n\n<p>But that won't work since functions are not directly comparable, they are not part of the <code>Eq</code> type class.</p>\n\n<p>The only thing I can think of that would work automatically is to import qualified and to define QuickCheck properties for all 4 functions like so:</p>\n\n<pre><code>import qualified ComposeLTR\n\nit \"should re-export the same function\" $ do\n  let\n    prop :: (Fun Int Int) -&gt; Int -&gt; Bool\n    prop (Fun _ f) g = (g $&gt; f) == (g ComposeLTR.$&gt; f)\n  property prop\n\n-- ... Essentially repeated 3 more times\n</code></pre>\n\n<p>But that seems awfully long-handed and redundant. Is there an elegant way to check this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444226107, "post_id": 32993902, "comment_id": 53812967, "body": "What if one or both of the lists are too short? How do you want to handle the fact that <code>Int</code> is bounded while <code>Integer</code> is conceptually unbounded?"}, {"owner": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444226407, "post_id": 32993902, "comment_id": 53813189, "body": "For this i&#39;m assuming that the numbers entered will be &#39;830314&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444227818, "post_id": 32994377, "comment_id": 53814328, "body": "Tried this, &#39;not in scope&#39;  listCheck :: [Int] -&gt; [Int] -&gt; Int -&gt; Bool  listCheck (x:xs) (y:ys) n = listCheck xs ys (n - 1)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444229120, "post_id": 32994377, "comment_id": 53815349, "body": "@sam <i>What</i> is not in scope? (The code in the answer has been tested in ghci.)"}, {"owner": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444229268, "post_id": 32994377, "comment_id": 53815468, "body": "Im getting &#39;compareLists not in scope&#39;   Here is my full code;  compareLists :: Int -&gt; [Int] -&gt; [Int] -&gt; Bool compareLists (x:xs) (y:ys) n = compareLists xs ys (n - 1)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444229527, "post_id": 32994377, "comment_id": 53815667, "body": "@sam The type is <code>[Int] -&gt; [Int] -&gt; Int -&gt; Bool</code>."}, {"owner": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444229664, "post_id": 32994377, "comment_id": 53815773, "body": "Ok i&#39;ve changed that and still getting scope error. It prints:            Not in scope: \u2018compareLists\u2019           Perhaps you meant \u2018compareList\u2019 (line 2)  Thanks for assisting me."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444230076, "post_id": 32994377, "comment_id": 53816105, "body": "@sam You defined &#39;compareList&#39;, but you&#39;re using &#39;compareList<b>s</b>&#39;. I get that error if I misspell the function when I apply it."}, {"owner": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444230306, "post_id": 32994377, "comment_id": 53816282, "body": "where have I defined the function as &#39;compareList&#39; I&#39;m checking my code and everything seems to be spelt compareLists even when i call the function in the ghci"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "edited": false, "score": 0, "creation_date": 1444234440, "post_id": 32994377, "comment_id": 53819401, "body": "@sam We can&#39;t see your code so you&#39;ll just have to take the compiler&#39;s word for it."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 1, "last_activity_date": 1444226623, "creation_date": 1444226623, "answer_id": 32994377, "question_id": 32993902, "link": "https://stackoverflow.com/questions/32993902/checking-if-two-lists-are-equal-at-nth-position/32994377#32994377", "title": "Checking if two lists are equal at Nth position", "body": "<p>(Assuming that element indexing starts at 0.)</p>\n\n<p>The n:th element of a list is the same as the (n-1):th element of its tail, so we can use recursion over the lists.</p>\n\n<p>It's easy to compare the first (0:th) position of two non-empty lists:</p>\n\n<pre><code>compareLists (x:xs) (y:ys) 0 = x == y\n</code></pre>\n\n<p>It's also easy if one or both of the lists is empty, if we adopt the convention that the n:th elements are unequal if they don't exist:</p>\n\n<pre><code>compareLists [] [] n = False\ncompareLists [] (y:ys) n = False\ncompareLists (x:xs) [] n = False\n</code></pre>\n\n<p>(These cases can be combined somewhat, but I'm spelling them out in the hope that it's clearer.)</p>\n\n<p>And for the general case, take the tails of the two lists and compare their (n-1):th elements:</p>\n\n<pre><code>compareLists (x:xs) (y:ys) n = compareLists xs ys (n - 1)\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5397172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c9bd7f764955d79f67ae0d7e11a4205?s=128&d=identicon&r=PG&f=1", "display_name": "methhead", "link": "https://stackoverflow.com/users/5397172/methhead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 32994377, "answer_count": 1, "score": -1, "last_activity_date": 1444226623, "creation_date": 1444225500, "question_id": 32993902, "link": "https://stackoverflow.com/questions/32993902/checking-if-two-lists-are-equal-at-nth-position", "title": "Checking if two lists are equal at Nth position", "body": "<p>I've just started learning Haskell as a module in my CS degree. </p>\n\n<p>Currently trying to create a function which takes a list <code>[Int]</code> and a list <code>[Integer]</code>. </p>\n\n<p>My goal is to check if the two lists are equal at the n-th position.</p>\n\n<p>So far, i've been able to compare two [Int] lists to see if they're equal. </p>\n\n<pre><code>compareList :: [Int] -&gt; [Int] -&gt; Bool \ncompareList x y = x == y \n</code></pre>\n\n<p>But i am unsure how to compare at the n-th position. If someone could help me that would be great. </p>\n\n<p>Thanks in advance, \nsam </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1444241833, "post_id": 32993625, "comment_id": 53823786, "body": "Ok, I didn&#39;t tested but replace m-1 by m should work. Thanks"}], "tags": [], "owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "is_accepted": true, "score": 6, "last_activity_date": 1444224823, "creation_date": 1444224823, "answer_id": 32993625, "question_id": 32993551, "link": "https://stackoverflow.com/questions/32993551/an-haskell-exp-function-returns-a-wrong-result/32993625#32993625", "title": "An haskell &quot;exp&quot; function returns a wrong result", "body": "<p>The odd case is wrong. You end up evaluating <code>exp1 4 3</code> to be <code>4 * (exp1 16 0)</code>.</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 32993625, "answer_count": 1, "score": -1, "last_activity_date": 1444224935, "creation_date": 1444224610, "last_edit_date": 1444224935, "question_id": 32993551, "link": "https://stackoverflow.com/questions/32993551/an-haskell-exp-function-returns-a-wrong-result", "title": "An haskell &quot;exp&quot; function returns a wrong result", "body": "<p>the following code:</p>\n\n<pre><code>Module Main where\n\nmain :: IO ()\nmain = do putStrLn \"hello\"\n          putStrLn $ \"2 exp 6 = \" ++ show (2 `exp1` 6)\n\nexp1 :: Integer -&gt; Integer -&gt; Integer\nexp1 x n | n == 0 = 1\n         | n == 1 = x\n         | even n =     exp1 (x*x) m\n         | odd  n = x * exp1 (x*x) (m-1)\n         where m = n `div` 2\n</code></pre>\n\n<p>produces the output <code>4</code> for <code>2 `exp1` 6</code>, which is obviously wrong.</p>\n\n<p>thanks</p>\n"}, {"tags": ["haskell", "types", "calculus"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444225112, "post_id": 32993547, "comment_id": 53812161, "body": "are you sure this is a SO question and not <a href=\"http://cstheory.stackexchange.com\">CSTheory</a> or similar?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1444225260, "post_id": 32993547, "comment_id": 53812304, "body": "@ErikAllik, CSTheory seems to be exclusively for grad students and researchers. CS seems barely populated. Such questions often get answers from the Haskell crowd here."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 8, "creation_date": 1444225809, "post_id": 32993547, "comment_id": 53812748, "body": "luckily it&#39;s one of those things non-haskellers won&#39;t understand and thus won&#39;t close, and haskellers just won&#39;t close anyway."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444261393, "post_id": 33001450, "comment_id": 53833263, "body": "So if you close off the universe to admit only the possible forms of holomorphic functions, you get infinite differentiability &quot;for free&quot;?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444264549, "post_id": 33001450, "comment_id": 53834120, "body": "@dfeuer I don&#39;t quite understand what you mean by that. I added another way to look at it in the answer."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1444264524, "last_edit_date": 1495541671, "creation_date": 1444248216, "answer_id": 33001450, "question_id": 32993547, "link": "https://stackoverflow.com/questions/32993547/is-complex-differentiation-of-datatypes-sensible/33001450#33001450", "title": "Is complex differentiation of datatypes sensible?", "body": "<p><em>Not really an answer... but this rant is way too long for a comment</em>.</p>\n\n<p>I find it a bit misleading to think complex differentiability just implies infinite differentiability. It's in fact much stronger than that: if a function is complex differentiable, then its derivatives at any point <a href=\"https://en.wikipedia.org/wiki/Identity_theorem\" rel=\"nofollow noreferrer\">determine the entire function</a>. And because infinite differentiability gives you a full Taylor series, you have an analytic function which is equal to your function, i.e. is your function itself. So, in a sense complex differentiable functions are analytic... because they are.\n<br>\n<sub>From a (standard) calculus perspective, the key contrast between real diff'ability and complex diff'ability is that in the reals, there is only one direction in which you can take the limit of difference-quotients (<em>f</em>(<em>x</em>+<em>&delta;</em>) - <em>f x</em>)/<em>&delta;</em>. You merely require that the left limit equals the right limit. But because that's an equality <em>after</em> the limit, this has only an effect locally. (Topologically speaking, the constraint just compares two discrete values, so it doesn't really deal with continuity properties at all.)</sub><br>\n<sub>OTOH, for complex differentiability we require that the limit of the difference quotient is the same if we approach <em>x</em> from any direction in the entire complex plane. That's an entire continuous degree of freedom constrained. You can then go on to perform topological tricks (Cauchy integrals are essentially that) to &ldquo;spread&rdquo; the constraint through the entire domain. \n</sub></p>\n\n<p>I consider this a bit problematic philosophically. <strong>Holomorphic functions aren't really functions at all</strong>, as in: they're not so much defined by the entirety of their result values across the domain, as by some way to write them with analytic formulas (i.e. possibly-infinite algebraic expressions / polynomials).\n<br>\n<sub>Most mathematicians and physicists apparently like this a lot &ndash; such expressions are just the way in which they generally write functions.\n<br>I don't, really, like it at all: to me, a function should be a function, something defined by individual values, like field strengths you can measure in space or results you can define in Haskell.\n<br>Anyway, I digress...</sub></p>\n\n<p>If we translate this issue from functions on numbers to functors on Haskell types, I suppose the upshot is that complex diff'ability means nothing else but: a type <em>can be written as a (possibly infinite?) ADT polynomial</em>. And how to get infinite differentiability for such ADTs was shown in <a href=\"https://stackoverflow.com/q/14133121\">the post you linked to</a>.</p>\n\n<hr>\n\n<h2>Another spin... perhaps closer to an answer.</h2>\n\n<p>These &ldquo;derivatives&rdquo; of Haskell types aren't really derivatives in the calculus sense. As in, they aren't motivated by a concept of small-pertubation response analysis<sup>&dagger;</sup>. It so happens that you can mathematically proove, for a very specific class of functions &ndash; those defined by an algebraic expression &ndash; that the calculus-derivative can again be written in a simple algebraic way (given by the well-known differentiation rules). That means trivially that you can differentiate infinitely often.</p>\n\n<p>The usefulness of this symbolic differentiation also motivates to think about it as a more abstract operation. And when you're differentiating Haskell types, it is mainly just this algebraic definition you're going after, not the original calculus one.</p>\n\n<p>Which is fine... but once you're doing algebra rather than calculus, it's not very meaningful to distinguish &ldquo;real&rdquo; from &ldquo;complex&rdquo; &ndash; it's actually neither, because you're <em>not</em> handling values but symbolic representations of values. An untyped language, if you will (and indeed, Haskell's type language is still untyped, with everything having kind <code>*</code>).</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Be it with traditional convergent limits or <a href=\"https://en.wikipedia.org/wiki/Non-standard_analysis\" rel=\"nofollow noreferrer\">NSA</a>-infinitesimals.</sub></p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 33001450, "answer_count": 1, "score": 7, "last_activity_date": 1444264524, "creation_date": 1444224601, "last_edit_date": 1495542575, "question_id": 32993547, "link": "https://stackoverflow.com/questions/32993547/is-complex-differentiation-of-datatypes-sensible", "title": "Is complex differentiation of datatypes sensible?", "body": "<p>pigworker once asked <a href=\"https://stackoverflow.com/q/14133121\">how to express that a type is infinitely differentiable</a>. This question brought to mind the fact that in complex analysis, a function that is differentiable (on an open set) must be infinitely differentiable (on that set). Is there a way to talk about complex differentiation of datatypes? If so, does a similar theorem hold?</p>\n"}, {"tags": ["haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1444220471, "post_id": 32991379, "comment_id": 53808586, "body": "Does this question solve your doubt: <a href=\"https://stackoverflow.com/questions/32974091/what-does-mean-in-a-type-signature/32980202#32980202\" title=\"what does mean in a type signature\">stackoverflow.com/questions/32974091/&hellip;</a>"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444222867, "post_id": 32991379, "comment_id": 53810447, "body": "The best professor a programmer can have is the programmer himself: <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">learnyouahaskell.com</a>, <a href=\"http://book.realworldhaskell.org/read/\" rel=\"nofollow noreferrer\">book.realworldhaskell.org/read</a> to name a few resources for becoming self-taught and to stop relying on professors."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444223696, "post_id": 32991379, "comment_id": 53811088, "body": "@ErikAllik, what? I think the professor was justified in making this simplification. They didn&#39;t want to get into type classes yet, and it&#39;s impossible to do much with numbers in Haskell without using functions that happen to be class-polymorphic."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444224784, "post_id": 32991379, "comment_id": 53811907, "body": "@dfeuer: well, I wasn&#39;t questioning the professor \u2014 just offering some alternatives to the uni."}], "answers": [{"comments": [{"owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 0, "creation_date": 1444221165, "post_id": 32992006, "comment_id": 53809121, "body": "thanks. so since we do not specify what we are going to send in as input we say <code>a -&gt; a</code> to simplify it ,since there are several types of floating point numbers (Double,Float)"}, {"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "reply_to_user": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 0, "creation_date": 1444221256, "post_id": 32992006, "comment_id": 53809185, "body": "@Charana true, but not enough: we don&#39;t allow <i>any</i> <code>a</code>. We only allow <code>a</code> such that <code>Floating a</code> is true, or in other words, only <code>a</code>&#39;s that are instances of <code>Floating</code>."}], "tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": false, "score": 2, "last_activity_date": 1444221282, "last_edit_date": 1444221282, "creation_date": 1444220330, "answer_id": 32992006, "question_id": 32991379, "link": "https://stackoverflow.com/questions/32991379/how-is-the-floating-typeclass-different-from-double/32992006#32992006", "title": "How is the Floating typeclass different from Double?", "body": "<p>You can think of the part to the left of <code>=&gt;</code> as a set of constraints.</p>\n\n<p><code>Floating a</code> means: the type <code>a</code> must be an instance of the <code>Floating</code> type class. I assume you know what type classes are. If not, see <a href=\"https://www.haskell.org/tutorial/classes.html\" rel=\"nofollow\">this</a> or search for \"haskell type classes\"</p>\n\n<p>So: <code>Floating a =&gt; a -&gt; a</code> means: given any type <code>a</code> that is an instance of the <code>Floating</code> type class, this function has type <code>a -&gt; a</code>. Because Haskell has more than one type of floating point numbers, this \"more generic\" type is used. One instance of <code>Floating</code> is indeed, <code>Double</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1444220886, "creation_date": 1444220886, "answer_id": 32992214, "question_id": 32991379, "link": "https://stackoverflow.com/questions/32991379/how-is-the-floating-typeclass-different-from-double/32992214#32992214", "title": "How is the Floating typeclass different from Double?", "body": "<p><code>Floating</code> is a type class. You can think of it as a collection of numeric types which support the following operations:</p>\n\n<pre><code>sqrt, exp, log, (**) \ntrig functions:  sin, cos, tan, asin, acos, atan, pi\nhyperboolic trig functions: sinh, cosh, tanh, asinh, acosh, atanh\n</code></pre>\n\n<p>If you know Java, then you can think of a typeclass like Floating as Java interface.</p>\n\n<p>Examples of types which are in the <code>Floating</code> class:</p>\n\n<ul>\n<li>Float  (single precision floating point)</li>\n<li>Double</li>\n<li>Complex Double</li>\n</ul>\n\n<p><code>Complex Double</code> are complex numbers where the real and imaginary parts are represented with <code>Double</code> values.</p>\n\n<p>Examples of types which are not in the <code>Floating</code> class:</p>\n\n<ul>\n<li>Int</li>\n<li>Char</li>\n<li>String</li>\n</ul>\n\n<p>The signature <code>sqrt :: Floating a =&gt; a -&gt; a</code> translates roughly as:</p>\n\n<blockquote>\n  <p>For any type <strong>a</strong>, if <strong>a</strong> is in the <strong>Floating</strong> class, then <strong>sqrt</strong> is a function taking an <strong>a</strong> and returning an <strong>a</strong></p>\n</blockquote>\n\n<p>This means that you can write code like this:</p>\n\n<pre><code>root a b c = (-b + sqrt (b*b - 4*a*c)) / (2*a)\n</code></pre>\n\n<p>and you can call <code>root</code> with either <code>Double</code>, <code>Float</code> or <code>Complex Double</code> arguments (provided they are all of the same type). For example:</p>\n\n<pre><code>import Data.Complex\n\nghci&gt; let root a b c = (-b + sqrt (b*b - 4*a*c)) / (2*a)\n\nghci&gt; root 1 0 1 :: Double\nNaN           -- can't represent sqrt -1 as a Double\n\nghci&gt; root 1 0 1 :: Complex Double\n0.0 :+ 1.0    -- sqrt -1 as a Complex number = i\n</code></pre>\n\n<p>Note how the same expression <code>root 1 0 1</code> gave different results based on what we forced the return type to be.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1444221003, "creation_date": 1444221003, "answer_id": 32992264, "question_id": 32991379, "link": "https://stackoverflow.com/questions/32991379/how-is-the-floating-typeclass-different-from-double/32992264#32992264", "title": "How is the Floating typeclass different from Double?", "body": "<p>Consider this problem instead:</p>\n\n<pre><code>axe :: Log -&gt; (Log, Log)\n</code></pre>\n\n<p>A function that splits wooden logs in two. Can we generalise this? Turns out we can:</p>\n\n<pre><code>class Splittable l where\n  axe :: l -&gt; (l,l)\n</code></pre>\n\n<p>Now axe is not specific to <code>Log</code>s, but can split anything that's soft enough.</p>\n\n<pre><code>instance Splittable Log where\n  axe = ... -- previous definition, for logs\n\ninstance Splittable Neck where\n  axe = ... -- executable version\n</code></pre>\n\n<p>For <code>sqrt</code> it's similar: this function sure makes sense for (positive) <code>Double</code>s, but it can also operate on more general types of numbers. For instance,</p>\n\n<pre><code>&gt; sqrt (-1) :: Double \n    NaN    -- urgh... negative numbers don't have real roots!\n&gt; :m +Data.Complex\n&gt; sqrt (-1) :: Complex Double \n    (- 0.0) :+ 1.0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444223828, "post_id": 32992388, "comment_id": 53811180, "body": "The fact that these functions and constants are in a class called <code>Floating</code> is rather sad, especially when square roots ate really very much simpler than, say, general exponentiation."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 5, "last_activity_date": 1444221322, "creation_date": 1444221322, "answer_id": 32992388, "question_id": 32991379, "link": "https://stackoverflow.com/questions/32991379/how-is-the-floating-typeclass-different-from-double/32992388#32992388", "title": "How is the Floating typeclass different from Double?", "body": "<p>A useful thing to try interactively in <code>ghci</code> is the <code>:info &lt;something&gt;</code> command, which can sometimes tell you helpful things.</p>\n\n<pre><code>&gt; :info Floating\nclass Fractional a =&gt; Floating a where\n  pi :: a\n  exp :: a -&gt; a\n  log :: a -&gt; a\n  sqrt :: a -&gt; a\n  (**) :: a -&gt; a -&gt; a\n  ---------------------------------------- loads more stuff\n         -- Defined in \u2018GHC.Float\u2019\ninstance Floating Float -- Defined in \u2018GHC.Float\u2019\ninstance Floating Double -- Defined in \u2018GHC.Float\u2019\n</code></pre>\n\n<p>What does this mean? <code>Floating</code> is a <em>type class</em>. There is more than one type of floating point numbers. Indeed, two come as standard: <code>Float</code> and <code>Double</code>, where <code>Double</code> gives you twice the precision of <code>Float</code>. The <code>a</code> in <code>Floating a</code> stands for any type, and the big list of operations (including <code>sqrt</code>) is an interface which any instance of the class must implement. The fact that <code>sqrt</code> is in the interface for <code>Floating</code> means that it can always and only be used for instances of <code>Floating</code>. That is, to you its type is given as you say</p>\n\n<pre><code>sqrt :: Floating a =&gt; a -&gt; a\n</code></pre>\n\n<p>The <code>=&gt;</code> syntax signals a <em>constraint</em>, here <code>Floating a</code> to its left. The type says</p>\n\n<blockquote>\n  <p>for any type <code>a</code> which is an instance of <code>Floating</code>, given an input of type <code>a</code>, the output will have type <code>a</code></p>\n</blockquote>\n\n<p>You can specialize this type by filling in <code>a</code> with any type for which the constraint <code>Floating a</code> can be satisfied, so the following are both true</p>\n\n<pre><code>sqrt :: Float -&gt; Float\nsqrt :: Double -&gt; Double\n</code></pre>\n\n<p>Now, <code>Float</code> and <code>Double</code> are represented by different bit-patterns, so the computational mechanisms for taking square roots is different in each case. It's handy not to have to remember different names for the different versions used for different types. The \"constraint\" <code>Floating a</code> really stands for the record (or <em>dictionary</em>) of the implementations for type <code>a</code> of all the operations in the interface. What the type of <code>sqrt</code> is really saying is</p>\n\n<blockquote>\n  <p>given a type <code>a</code> and a dictionary of implementations for all the <code>Floating</code> operations, I'll take an <code>a</code> and give you an <code>a</code></p>\n</blockquote>\n\n<p>and it works by extracting the relevant <code>sqrt</code> implementation from the dictionary and using it on the given input.</p>\n\n<p>So the <code>=&gt;</code> signals a function type with an invisible dictionary input just as <code>-&gt;</code> signals a function type with a visible value input. You don't (indeed, you can't) write the dictionary when you use the function: the compiler figures it out from the type. When we write</p>\n\n<pre><code>sqrt :: Double -&gt; Double\n</code></pre>\n\n<p>we mean the general <code>sqrt</code> function invisibly applied to the <code>Floating Double</code> dictionary.</p>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444224624, "last_edit_date": 1444224624, "creation_date": 1444223138, "answer_id": 32993023, "question_id": 32991379, "link": "https://stackoverflow.com/questions/32991379/how-is-the-floating-typeclass-different-from-double/32993023#32993023", "title": "How is the Floating typeclass different from Double?", "body": "<p>The <code>Floating a</code> bit is a constraint requiring the type <code>a</code> to belong to the class of types that represent, or are viewable as, floating point numbers, that is, <code>a</code> belongs to the <code>Floating</code> class, or, <code>a</code> is an instance of <code>Floating</code>.</p>\n\n<p>You can, sort of, think of type classes like interfaces \u2014 a type <code>a</code> either implements that \"interface\" or it doesn't; now <code>sqrt</code> simply works on any type <code>a</code> that implements <code>Floating</code>.</p>\n\n<p>But don't get too carried away with this analogy \u2014 it ends almost as quickly as it begins: there are more differences between, say Java, interfaces and Haskell type classes than there are similarities, but the analogy is useful for \"getting on board\".</p>\n\n<hr>\n\n<p>To sum up, <code>Floating a =&gt; a -&gt; a</code> means: a function from values of <em>any</em> type <code>a</code> to values of that same type <code>a</code> (i.e. <code>a -&gt; a</code>), for as long as the type <code>a</code> resembles a floating point.</p>\n\n<p>Doing <code>:i Floating</code> in a GHCi REPL will, in addition to the structure of the <code>Floating</code> type class, show you a list of the types that implement it:</p>\n\n<pre><code>Prelude&gt; :i Floating\nclass Fractional a =&gt; Floating a where\n    ... LOTS OF FUNCTION DECLARATIONS ...\n    -- Defined in \u2018GHC.Float\u2019\ninstance Floating Float -- Defined in \u2018GHC.Float\u2019\ninstance Floating Double -- Defined in \u2018GHC.Float\u2019\n</code></pre>\n\n<p>Constraints have a language of their own in Haskell and can be composed, so you can have <code>(Floating a, Floating c, Foo a, Bar [b], Baz c) =&gt; a -&gt; [b] -&gt; (a, c)</code> or some other crazy imaginary type signature.</p>\n"}], "owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1867, "favorite_count": 0, "accepted_answer_id": 32992388, "answer_count": 5, "score": 0, "last_activity_date": 1550358466, "creation_date": 1444218406, "last_edit_date": 1550358466, "question_id": 32991379, "link": "https://stackoverflow.com/questions/32991379/how-is-the-floating-typeclass-different-from-double", "title": "How is the Floating typeclass different from Double?", "body": "<pre><code>*User&gt; :t sqrt\nsqrt :: Floating a =&gt; a -&gt; a\n</code></pre>\n\n<p>I don't understand what <code>Floating a =&gt; a -&gt; a</code> is trying to tell me.\nMy professor told me <code>sqrt</code> can be thought of like <code>sqrt :: Double -&gt; Double</code>.\nAnd it does act like that but what does <code>Floating a =&gt; a -&gt; a</code> mean?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 4, "creation_date": 1444210691, "post_id": 32988409, "comment_id": 53802249, "body": "Remark: regardless of the convention you use, if you want to be consistent, <code>Empty</code> and <code>Node _ Empty Empty</code> should not have the same height."}, {"owner": {"reputation": 617, "user_id": 5110174, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh4.googleusercontent.com/-btpSKjv4Tc4/AAAAAAAAAAI/AAAAAAAAHKY/CaLgOlnjUwg/photo.jpg?sz=128", "display_name": "\u041b\u0438\u043b\u0438\u044f \u0421\u0430\u043f\u0443\u0440\u0438\u043d\u0430", "link": "https://stackoverflow.com/users/5110174/%d0%9b%d0%b8%d0%bb%d0%b8%d1%8f-%d0%a1%d0%b0%d0%bf%d1%83%d1%80%d0%b8%d0%bd%d0%b0"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1444210874, "post_id": 32988409, "comment_id": 53802388, "body": "@Jubobs yes, edited!"}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 2, "creation_date": 1444211297, "post_id": 32988409, "comment_id": 53802678, "body": "Can you please edit into the question what you mean by <i>length</i>, and <i>current</i> length?"}], "answers": [{"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 2, "last_activity_date": 1444217382, "last_edit_date": 1444217382, "creation_date": 1444211558, "answer_id": 32989143, "question_id": 32988409, "link": "https://stackoverflow.com/questions/32988409/minimum-height-in-tree/32989143#32989143", "title": "minimum height in tree", "body": "<p>You want to count depth from top and use returned values of minHeight to bound the other calls.</p>\n\n<pre><code>minHeight :: Integer -&gt; (Maybe Integer) -&gt; Tree -&gt; Integer\nminHeight depth bound tree = ...\n</code></pre>\n\n<p>Initially pass in 0 as depth and<code>Nothing</code> as bound (aka <code>Infinity</code>), at leaves return the smaller of <code>depth</code> and <code>bound</code>, otherwise see if you have a finite bound (<code>Just b</code>) and compare it to current <code>depth</code>.</p>\n\n<pre><code>case b of\n    Just min -&gt; if min &lt;= depth then return min else RECURSION\n    otherwise -&gt; RECURSION\n</code></pre>\n\n<p>Whenever you compute some <code>minHeight</code> in recursion, combine its result with the current <code>bound</code>.</p>\n\n<pre><code>minHeight d min (Node _ t1 t2) =\n    let min1 = Just (minHeight (d + 1) min t1) in\n        (minHeight (d + 1) min1 t2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 2, "last_activity_date": 1444212029, "creation_date": 1444212029, "answer_id": 32989329, "question_id": 32988409, "link": "https://stackoverflow.com/questions/32988409/minimum-height-in-tree/32989329#32989329", "title": "minimum height in tree", "body": "<p>Here's a solution, which doesn't calculate the branches, whose depth will be higher then the already known one:</p>\n\n<pre><code>data Tree = Empty | Node Integer Tree Tree\n\nminHeight :: Tree -&gt; Int\nminHeight =\n  loop Nothing 0\n  where\n    loop defaultDepth depth tree =\n      case defaultDepth of\n        Just x | x &lt;= depth -&gt;\n          x\n        _ -&gt;\n          case tree of\n            Empty -&gt; depth\n            Node _ left right -&gt;\n              loop (Just (loop defaultDepth (succ depth) left)) (succ depth) right\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1444225659, "post_id": 32990438, "comment_id": 53812624, "body": "Very nice. Note that calculating <code>min</code> directly takes even less code than comparison: <code>minNat (S m) (S n) = S (minNat m n); minNat _ _ = Z</code>."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444226128, "post_id": 32990438, "comment_id": 53812987, "body": "so basically this solution relies the fact that e.g. <code>1 &lt;= 1 + abs someComputation</code> should be able to be evaluated to <code>True</code> without evaluating <code>someComputation</code>, but that it&#39;s only possible if instead of the <code>1</code> and <code>3</code>, a better representation of naturals were used than <code>Int</code>/<code>Integer</code> \u2014 very nice!"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1444227157, "post_id": 32990438, "comment_id": 53813799, "body": "@dfeuer, moreover <code>minNat n Z</code> is <code>Z</code>, while <code>min n Z</code> (where <code>min</code> is defined via <code>(&lt;=)</code>) doesn&#39;t compute. So my version doesn&#39;t work for <code>tree = Node 0 tree (Node 1 tree Empty)</code>, while your works. Thanks for the suggestion."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444227393, "post_id": 32990438, "comment_id": 53813977, "body": "I don&#39;t see why your definition would fail there, actually."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444227965, "post_id": 32990438, "comment_id": 53814439, "body": "@dfeuer, it <a href=\"http://ideone.com/0xFaoS\" rel=\"nofollow noreferrer\">fails</a>. I thought a bit more, and I don&#39;t know why it fails."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444228278, "post_id": 32990438, "comment_id": 53814674, "body": "If <code>n</code> is bottom/stuck, then <code>minNat n Z</code> will be too because pattern matching works from left to right."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444228305, "post_id": 32990438, "comment_id": 53814697, "body": "@dfeuer, yes, I always forget that."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444229382, "post_id": 32990438, "comment_id": 53815568, "body": "@dfeuer, OK, I see, why your definition works, while my doesn&#39;t. It&#39;s because yours is productive: <code>min (S n) (S m)</code> immediately reduces to <code>S ...</code>, while with <code>(&lt;=)</code> you have an infinite chain like this: <code>if (if (if ... &lt;= Z then ... else Z) &lt;= Z then ... else Z) &lt;= Z then ... else Z)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444229626, "post_id": 32990438, "comment_id": 53815740, "body": "Yes, mine can deal with trees with infinite minimum depth, making use of the fact that <code>Nat</code> is actually more like the one-point compactification of the naturals than like the naturals proper."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 14, "last_activity_date": 1444227186, "last_edit_date": 1444227186, "creation_date": 1444215473, "answer_id": 32990438, "question_id": 32988409, "link": "https://stackoverflow.com/questions/32988409/minimum-height-in-tree/32990438#32990438", "title": "minimum height in tree", "body": "<p>You can use Peano <code>Nat</code>s instead of <code>Integer</code>s and let laziness do the job:</p>\n\n<pre><code>data Nat = S Nat | Z deriving (Eq)\n\ninstance Ord Nat where\n    min (S n) (S m) = S (min n m)\n    min  _     _    = Z\n\ninstance Enum Nat where\n    fromEnum  Z    = 0\n    fromEnum (S n) = fromEnum n + 1\n\ndata Tree = Empty | Node Integer Tree Tree\n\nminHeight  Empty        = Z\nminHeight (Node _  l r) = S (min (minHeight l) (minHeight r))\n\ntree = Node 0 (Node 1 tree Empty) tree\n\nmain = print $ fromEnum $ minHeight tree -- 2\n</code></pre>\n"}], "owner": {"reputation": 617, "user_id": 5110174, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh4.googleusercontent.com/-btpSKjv4Tc4/AAAAAAAAAAI/AAAAAAAAHKY/CaLgOlnjUwg/photo.jpg?sz=128", "display_name": "\u041b\u0438\u043b\u0438\u044f \u0421\u0430\u043f\u0443\u0440\u0438\u043d\u0430", "link": "https://stackoverflow.com/users/5110174/%d0%9b%d0%b8%d0%bb%d0%b8%d1%8f-%d0%a1%d0%b0%d0%bf%d1%83%d1%80%d0%b8%d0%bd%d0%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 5, "accepted_answer_id": 32990438, "answer_count": 3, "score": 9, "last_activity_date": 1444227186, "creation_date": 1444209489, "last_edit_date": 1444225195, "question_id": 32988409, "link": "https://stackoverflow.com/questions/32988409/minimum-height-in-tree", "title": "minimum height in tree", "body": "<p>I'm trying to optimize the code:</p>\n\n<pre><code>data Tree = Empty | Node Integer Tree Tree\nminHeight Empty = -1\nminHeight (Node _ Empty Empty) = 0\nminHeight (Node _ l     r    ) = (min (minHeight l) (minHeight r)) + 1\n</code></pre>\n\n<p>My goal is to not calculate the branches whose depth will be higher than the already known one.</p>\n"}, {"tags": ["haskell", "typeclass", "type-constraints", "type-families", "type-level-computation"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444223572, "post_id": 32983019, "comment_id": 53810984, "body": "btw, didn&#39;t GHC ever recommend a language extension, such as e.g. <code>FlexibleContexts</code> or something else, during your trial and error process? because I&#39;m quite sure it did \u2014 just a side-note on the <i>&quot;is this even possible with Haskell&quot;</i> bit."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "edited": false, "score": 0, "creation_date": 1444187910, "post_id": 32983078, "comment_id": 53791606, "body": "Right, I should have explained that I have already looked into this, but the FlexibleContexts and UndecidableInstances extensions make me nervous. I feel like they could come back to bite me in the end when adding more instances, unless I&#39;m mistaken."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "edited": false, "score": 4, "creation_date": 1444188486, "post_id": 32983078, "comment_id": 53791732, "body": "As far as I&#39;m aware, <code>FlexibleContexts</code> is completely safe, and simply allows non-type variables as type parameters. <code>UndecidableInstances</code> can cause non-termination during compilation if your instances form a loop (as the compiler cannot check this). For more info, see <a href=\"http://stackoverflow.com/a/5017549/925978\">this answer</a>."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "edited": false, "score": 7, "creation_date": 1444193937, "post_id": 32983078, "comment_id": 53793305, "body": "@user3773003: I want to say something stronger than Eric: I don&#39;t think it&#39;s reasonable to use <code>TypeFamilies</code> without <code>FlexibleContexts</code>, and probably not without <code>UndecidableInstances</code>! The non-flexible context rules were designed for a language without type families; it&#39;s no surprise they need extension. And since type families are type-level functions, it&#39;s no surprise that the (type-level) termination checker can get in the way, especially since it&#39;s not very smart; we don&#39;t have a termination checker at the value level, so <code>UndecidableInstances</code> gets us a similarly-expressive type level."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "edited": false, "score": 2, "creation_date": 1444223766, "post_id": 32983078, "comment_id": 53811143, "body": "@user3773003 I consider <code>FlaxibleContexts</code> completely harmless, and I hope it will be included in the next Haskell standard. <code>UndecidableInstances</code> is also fine, albeit I can see some value in having to turn it on explcitly. OTOH, <code>Incoherent-</code> and <code>Overlapping-</code> instances are evil, and should be avoided as much as possible."}], "tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": false, "score": 6, "last_activity_date": 1444186776, "creation_date": 1444186776, "answer_id": 32983078, "question_id": 32983019, "link": "https://stackoverflow.com/questions/32983019/haskell-type-family-instance-with-type-constraints/32983078#32983078", "title": "Haskell type family instance with type constraints", "body": "<p>Actually, you can do exactly what you mentioned:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, FlexibleContexts, UndecidableInstances #-}\n\nclass Evaluable c where\n    type Return c :: *\n    evaluate :: c -&gt; Return c\n\ndata Negate n = Negate n\n\ninstance (Evaluable n, Num (Return n)) =&gt; Evaluable (Negate n) where\n    type Return (Negate n) = Return n\n    evaluate (Negate n) = negate (evaluate n)\n</code></pre>\n\n<p><code>Return n</code> certainly is a type, which can be an instance of a class just like <code>Int</code> can. Your confusion might be about what can be the argument of a constraint. The answer is \"anything with the correct kind\". The kind of <code>Int</code> is <code>*</code>, as is the kind of <code>Return n</code>. <code>Num</code> has kind <code>* -&gt; Constraint</code>, so <em>anything</em> of kind <code>*</code> can be its argument. It perfectly legal (though vacuous) to write <code>Num Int</code> as a constraint, in the same way that <code>Num (a :: *)</code> is legal.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "edited": false, "score": 0, "creation_date": 1444190136, "post_id": 32983470, "comment_id": 53792143, "body": "Yes, again something I should have mentioned that I tried in the original question.  This one too needs UndecidableInstances and also FlexibleInstances which I would like to avoid."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "edited": false, "score": 0, "creation_date": 1444191549, "post_id": 32983470, "comment_id": 53792555, "body": "@user3773003, I&#39;m not too optimistic that you can get what you want without these extensions. I could be missing something, of course."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "edited": false, "score": 0, "creation_date": 1444209617, "post_id": 32983470, "comment_id": 53801521, "body": "@user3773003 There is literally no downside to <code>FlexibleInstances</code> and <code>UndecidableInstances</code> is also effectively harmless."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1444219354, "post_id": 32983470, "comment_id": 53807785, "body": "@Andr&#225;sKov&#225;cs, Ekmett prefers to avoid flexible instances when possible (I think to improve instance resolution), but only when possible."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1444224270, "last_edit_date": 1444224270, "creation_date": 1444189593, "answer_id": 32983470, "question_id": 32983019, "link": "https://stackoverflow.com/questions/32983019/haskell-type-family-instance-with-type-constraints/32983470#32983470", "title": "Haskell type family instance with type constraints", "body": "<p>To complement Eric's answer, let me suggest one possible alternative: using a functional dependency instead of a type family:</p>\n\n<pre><code>class EvaluableFD r c | c -&gt; r where\n  evaluate :: c -&gt; r\n\ndata Negate n = Negate n\n\ninstance (EvaluableFD r n, Num r) =&gt; EvaluableFD r (Negate n) where\n  evaluate (Negate n) = negate (evaluate n)\n</code></pre>\n\n<p>This makes it a bit easier to talk about the result type, I think. For instance, you can write</p>\n\n<pre><code>foo :: EvaluableFD Int a =&gt; Negate a -&gt; Int\nfoo x = evaluate x + 12\n</code></pre>\n\n<p>You can also use <code>ConstraintKinds</code> to apply this partially (which is why I put the arguments in that funny-looking order):</p>\n\n<pre><code>type GivesInt = EvaluableFD Int\n</code></pre>\n\n<p>You could do this with your class as well, but it would be more annoying:</p>\n\n<pre><code>type GivesInt x = (Evaluable x, Result x ~ Int)\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 3773003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b0e7df7b94bd733b8114c561123c95?s=128&d=identicon&r=PG&f=1", "display_name": "user3773003", "link": "https://stackoverflow.com/users/3773003/user3773003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 1, "answer_count": 2, "score": 8, "last_activity_date": 1444237280, "creation_date": 1444186310, "last_edit_date": 1444237280, "question_id": 32983019, "link": "https://stackoverflow.com/questions/32983019/haskell-type-family-instance-with-type-constraints", "title": "Haskell type family instance with type constraints", "body": "<p>I am trying to represent expressions with type families, but I cannot seem to figure out how to write the constraints that I want, and I'm starting to feel like it's just not possible.  Here is my code:</p>\n\n<pre><code>class Evaluable c where\n    type Return c :: *\n    evaluate :: c -&gt; Return c\n\ndata Negate n = Negate n\n\ninstance (Evaluable n, Return n ~ Int) =&gt; Evaluable (Negate n) where\n    type Return (Negate n) = Return n\n    evaluate (Negate n) = negate (evaluate n)\n</code></pre>\n\n<p>This all compiles fine, but it doesn't express exactly what I want. In the constraints of the <code>Negate</code> instance of <code>Evaluable</code>, I say that the return type of the expression inside <code>Negate</code> must be an <code>Int</code> (with <code>Return n ~ Int</code>) so that I can call negate on it, but that is too restrictive. The return type actually only needs to be an instance of the <code>Num</code> type class which has the <code>negate</code> function. That way <code>Double</code>s, <code>Integer</code>s, or any other instance of <code>Num</code> could also be negated and not just <code>Int</code>s. But I can't just write</p>\n\n<pre><code>Return n ~ Num\n</code></pre>\n\n<p>instead because <code>Num</code> is a type class and <code>Return n</code> is a type.  I also cannot put</p>\n\n<pre><code>Num (Return n)\n</code></pre>\n\n<p>instead because <code>Return n</code> is a type not a type variable.</p>\n\n<p>Is what I'm trying to do even possible with Haskell? If not, should it be, or am I misunderstanding some theory behind it? I feel like Java could add a constraint like this. Let me know if this question could be clearer.</p>\n\n<p>Edit: Thanks guys, the responses are helping and are getting at what I suspected. It appears that the type checker isn't able to handle what I'd like to do without UndecidableInstances, so my question is, is what I'd like to express really undecidable? It is to the Haskell compiler, but is it in general? i.e. could a constraint even exist that means \"check that Return n is an instance of Num\" which is decidable to a more advanced type checker?</p>\n"}, {"tags": ["function", "haskell", "types", "signature"], "comments": [{"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 0, "creation_date": 1444184803, "post_id": 32982759, "comment_id": 53790816, "body": "What is it that your function is meant to do? g ab = repeat (b,a) has the required type and returns in an infinite list of a tuple consisting of the second parameter followed by the first parameter."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 0, "creation_date": 1444185130, "post_id": 32982759, "comment_id": 53790912, "body": "Pretty much can do whatever we want, the only catch that has to have the exact signature. The thing that I don&#39;t understand is how repeat goes from a -&gt; b -&gt; [(b,a)]. Thanks very much for your comment."}, {"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 0, "creation_date": 1444185322, "post_id": 32982759, "comment_id": 53790959, "body": "in ghci, type <code>:t repeat</code> and it tells you the type (a -&gt; [a]) ... so it takes a type and returns a list of that type .... so we need the input to repeat to be type (b,a) and it will return a type of [(b,a)]"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444185327, "post_id": 32982759, "comment_id": 53790961, "body": "Well, the definition <code>g a b = []</code> satisfies the type signature. Does this help? Note - it may not satisfy the conditions of the assignment, but the type checker won&#39;t complain if you declare <code>g :: a -&gt; b -&gt; [(b,a)]</code>."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1444185525, "post_id": 32982759, "comment_id": 53791028, "body": "I probably took the signature to literal thinking that the function would needed three steps, I kind of understand now, but still a little bit confused. Thanks for both of you. So how could I satisfy the entire signature?"}, {"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 0, "creation_date": 1444185773, "post_id": 32982759, "comment_id": 53791093, "body": "No the type signature is for allowing partially applied functions.  so you can for instance <code>f = g 1</code> which will have type <code>f :: b -&gt; [(b,a)]</code> and then you can call <code>f &quot;a&quot;</code> and <code>f &quot;b&quot;</code>.  Search for currying for more information."}, {"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 2, "creation_date": 1444185822, "post_id": 32982759, "comment_id": 53791105, "body": "Also, this question isn&#39;t really very good ... if you don&#39;t understand type signatures then ask a specific question about what you don&#39;t understand about type signatures .... this will never be useful to anyone else."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1444185899, "post_id": 32982759, "comment_id": 53791119, "body": "I know it&#39;s too specific but but after 6 hours feeling a little bit frustrated..."}], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1444186444, "post_id": 32982992, "comment_id": 53791244, "body": "Thanks @karakfa. by the way what is the difference between <code>=&gt;</code> and <code>-&gt;</code>, like in <code>g :: Ord a =&gt; [a] -&gt; a -&gt; bool</code>?"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 2, "creation_date": 1444186657, "post_id": 32982992, "comment_id": 53791294, "body": "funny you ask, answered the same question today, here <a href=\"http://stackoverflow.com/a/32974148/1435869\">stackoverflow.com/a/32974148/1435869</a>"}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1444186861, "post_id": 32982992, "comment_id": 53791348, "body": "Great, got it! Thanks."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 2, "last_activity_date": 1444186089, "creation_date": 1444186089, "answer_id": 32982992, "question_id": 32982759, "link": "https://stackoverflow.com/questions/32982759/using-haskell-signature-to-create-function-through-different-types/32982992#32982992", "title": "Using Haskell signature to create function through different types", "body": "<p>Perhaps you can start with a simpler type</p>\n\n<pre><code>g' :: a -&gt; b -&gt; (b,a)\n</code></pre>\n\n<p>can be read as g' takes two arguments and returns a tuple of them in reverse order.</p>\n\n<p>Now, extend it to a list of tuples</p>\n\n<pre><code>g :: a -&gt; b -&gt; [(b,a)]\n</code></pre>\n\n<p>there is the trivial case <code>[]</code>, singleton case <code>[(b,a)]</code> with a single element, infinite case, or any other arbitrary number of elements in the list.  For example,</p>\n\n<pre><code>doublePair :: Int -&gt; Int -&gt; [(Int,Int)]\ndoublePair x y = [(y,x),(y,x)]\n</code></pre>\n"}], "owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 32982992, "answer_count": 1, "score": -3, "last_activity_date": 1444186089, "creation_date": 1444184418, "question_id": 32982759, "link": "https://stackoverflow.com/questions/32982759/using-haskell-signature-to-create-function-through-different-types", "title": "Using Haskell signature to create function through different types", "body": "<p>I'm new to Haskell and I been trying to make this function <code>g :: a -&gt; b -&gt; [(b,a)]</code>.</p>\n\n<p>I kind of got to the type result <code>[(b,a)]</code> (not entirely) through this:\n<code>[(length a , a)]</code>.</p>\n\n<p>Never got to make the signature correctly especially passing from type <code>a</code> to <code>b</code>.</p>\n\n<p>Almost 6 hours on this particular function unable to figure it out. Can someone help me?\nNote that I'm a truly beginner so if it's possible and not asking to much please stick to the basics.\nMany thanks in advance.  </p>\n"}, {"tags": ["haskell", "repa"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1466068226, "post_id": 32981990, "comment_id": 63167706, "body": "Could this be related to <a href=\"http://stackoverflow.com/q/32981990/1333025\">What&#39;s wrong with using Identity monad with mmultP when using repa?</a>"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1466079506, "post_id": 32981990, "comment_id": 63175200, "body": "@PetrPudl&#225;k I think the issue in this case is that <code>test-framework</code> is multi--threaded. This definitely leads to nested parallelism. Thanks for reminding me about this question!"}], "answers": [{"comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1466100808, "post_id": 37858964, "comment_id": 63190049, "body": "Does this mean that Repa can&#39;t be called from parallel threads? That seems to me strange, perhaps there is another way."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1466107572, "post_id": 37858964, "comment_id": 63193687, "body": "@PetrPudl&#225;k I asked Ben Lippmeier, &quot;Is coarse-grained parallelism possible when using repa?&quot; His response in a private communication: &quot;The data parallel model assumes a single thread of control. It also assumes that there is enough work available to make use of all processors. Running two repa computations at once won\u2019t make anything faster, and isn\u2019t supported by the library. At best you\u2019ll just suffer more scheduling overhead, which is why I added the warning [about nested parallelism].&quot;"}], "tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 1, "last_activity_date": 1466079410, "creation_date": 1466079410, "answer_id": 37858964, "question_id": 32981990, "link": "https://stackoverflow.com/questions/32981990/nested-parallelism-in-repa/37858964#37858964", "title": "Nested Parallelism in Repa", "body": "<p>The problem is that <code>test-framework</code> is implicitly multi-threaded (see <a href=\"https://hackage.haskell.org/package/test-framework-0.8.1.1/src/Test/Framework/Runners/ThreadPool.hs\" rel=\"nofollow\">this</a> for example.)</p>\n\n<p>The solution that works for me is to run <code>defaultMainWithArgs</code> with the option <code>--threads=1</code>.</p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 37858964, "answer_count": 1, "score": 3, "last_activity_date": 1466079410, "creation_date": 1444178674, "last_edit_date": 1495542252, "question_id": 32981990, "link": "https://stackoverflow.com/questions/32981990/nested-parallelism-in-repa", "title": "Nested Parallelism in Repa", "body": "<p>The following code produces the (dreaded) \"nested parallelism\" error with <a href=\"https://hackage.haskell.org/package/repa-3.4.0.1\" rel=\"nofollow noreferrer\">repa-3.4.0.1</a>:</p>\n\n<pre><code>import Control.Monad.Identity (runIdentity, liftM)\nimport Data.Array.Repa              as R\nimport Data.Array.Repa.Repr.Unboxed\nimport Data.Vector.Unboxed\nimport Test.Framework\nimport Test.Framework.Providers.QuickCheck2\nimport Test.QuickCheck hiding (generate,output)\n\nmain :: IO ()\nmain = defaultMainWithArgs [prop,prop] [\"--maximum-generated-tests=1\"]\n\nprop = testProperty \"Test\" $ property prop_fmap\n\nprop_fmap :: Arr Int -&gt; Bool\nprop_fmap x = fmapT id x == x\n\n\n\n\nnewtype Arr r = Arr (Array U DIM1 r) deriving (Eq, Show)\n\ninstance (Arbitrary r, Unbox r) =&gt; Arbitrary (Arr r) where\n    arbitrary = replM arbitrary\n    shrink = shrinkNothing\n\nreplM :: (Unbox r, Monad mon) =&gt; mon r -&gt; mon (Arr r)\nreplM = let n = 6\n        in liftM (Arr . fromUnboxed (Z:.n)) . replicateM n\n\nfmapT :: (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Arr a -&gt; Arr b\nfmapT f (Arr v) = Arr $ force' $ R.map f $ v\n\nforce' :: (Shape sh, Unbox r) =&gt; Array D sh r -&gt; Array U sh r\nforce' = runIdentity . computeP\n</code></pre>\n\n<p>The exact error is:</p>\n\n<pre><code>Performing nested parallel computation sequentially.   You've probably\ncalled the 'compute' or 'copy' function while another   instance was\nalready running. This can happen if the second version   was suspended\ndue to lazy evaluation. Use 'deepSeqArray' to ensure   that each array\nis fully evaluated before you 'compute' the next one. \n</code></pre>\n\n<p>I'm compiling with <code>ghc Main -threaded</code> and running with <code>Main +RTS -N2</code>. I've tried using <code>deepSeqArray</code> in the definition of <code>fmapT</code>, but it doesn't help. Since the tests are independent (aside from sequencing the randomness), it's not clear how nested parallelism is even possible in this example. </p>\n\n<p>Interestingly, if I change <code>main</code> to just <code>quickCheck prop_fmap</code>, it successfully completes 100 tests. So it seems there's something going on with  test-framework (probably a more general problem with monad sequencing) that is different from <code>QuickCheck</code>.</p>\n\n<p>Any ideas on why I'm getting this error and how I can avoid it while still doing a parallel computation?</p>\n\n<p>Note: using the <code>Identity</code> monad: <a href=\"https://stackoverflow.com/a/10773593/925978\">ref1</a>, <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch05.html\" rel=\"nofollow noreferrer\">ref2</a></p>\n"}, {"tags": ["haskell", "types", "instance", "deriving"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444172419, "post_id": 32980745, "comment_id": 53787775, "body": "I&#39;m confused. Are you using <code>DataKinds</code> and promoting those constructors or something?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444223396, "post_id": 32980745, "comment_id": 53810832, "body": "I can&#39;t understand this question. You want to give them different names to avoid name clashes, yet you want to access them with the old names. This looks contradictory to me. How do you expect this will work, exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 6, "last_activity_date": 1444171768, "last_edit_date": 1444171768, "creation_date": 1444171261, "answer_id": 32980973, "question_id": 32980745, "link": "https://stackoverflow.com/questions/32980745/haskell-typeable-instance/32980973#32980973", "title": "Haskell Typeable instance", "body": "<p>In recent versions of GHC, <code>Typeable</code> simply cannot be user-defined. Its casting operations are supposed to be guaranteed safe, and for that only automatically derived instances are allowed.</p>\n\n<p>Since GHC 7.10, it's changed further: <code>Typeable</code> is now automatically derived for <em>all</em> types, so <code>deriving Typeable</code> is actually redundant (but may be included for backwards compatibility.)</p>\n\n<p><code>Data</code> <em>can</em> still be user-defined, but I'm not sure it's a good idea. In fact for your use case I'm suspecting it would be better to use the much simpler <code>Read</code> class instead.</p>\n\n<p>You can also avoid renaming your constructors by splitting them off into a different module, and importing that qualified:</p>\n\n<pre><code>module Types.Fun where\ndata Function = Max\n              | Min\n              | Moy\n              | Med\n              deriving (Eq,Data,Typeable)\n\n...\n\nmodule Main where\nimport qualified Types.Fun as Fun\n\n... case ... of Fun.Max -&gt; ...\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 32980973, "answer_count": 1, "score": 3, "last_activity_date": 1444171768, "creation_date": 1444169885, "question_id": 32980745, "link": "https://stackoverflow.com/questions/32980745/haskell-typeable-instance", "title": "Haskell Typeable instance", "body": "<p>I'm using <code>cmdargs</code> to get some arguments from a command line program. I'm using some special type in my program </p>\n\n<pre><code>data Function = Max\n              | Min\n              | Moy\n              | Med\n              deriving (Eq,Data,Typeable)\n</code></pre>\n\n<p>I can pass these types directly in arguments with <code>\"Max\" \"Min\" \"Moy\" \"Med\"</code> by deriving the <code>Function</code> datatype in the classes <code>Data</code> and <code>Typeable</code>. My problem is my program is becoming more complex and I need to rename my constructor to avoid name collisions.</p>\n\n<pre><code>data Function = funMax\n              | funMin\n              | funMoy\n              | funMed\n              deriving (Eq,Data,Typeable)\n</code></pre>\n\n<p>However, I would like to keep accessing these constructor with <code>\"Max\" \"Min\" \"Moy\" \"Med\"</code>. To do that, I suppose I need to create my own <code>Data</code> and <code>Typeable</code> Instances of <code>Function</code>, is that right ?</p>\n\n<p>My problem is I didn't manage to create these instance even after reading the Hackage documentation.</p>\n\n<p><strong>Have you ever succesfully created <code>Data</code> and <code>Typeable</code> instances of your own data type?</strong></p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": false, "score": 2, "last_activity_date": 1444168026, "creation_date": 1444168026, "answer_id": 32980331, "question_id": 32980278, "link": "https://stackoverflow.com/questions/32980278/confuse-about-flip-function/32980331#32980331", "title": "Confuse about flip function", "body": "<p><code>flip charIn \"abcdefghijklmnopqrstuvwxyz\"</code> is the same as the lambda <code>\\c -&gt; charIn c \"abcdefghijklmnopqrstuvwxyz\"</code>.</p>\n\n<p><code>flip charIn</code> is partially applied to the string; what remains is a function expecting one argument.</p>\n"}, {"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1444169262, "last_edit_date": 1444169262, "creation_date": 1444168894, "answer_id": 32980537, "question_id": 32980278, "link": "https://stackoverflow.com/questions/32980278/confuse-about-flip-function/32980537#32980537", "title": "Confuse about flip function", "body": "<p><code>flip</code> takes the function you pass as an argument and <em>gives you back</em> a function that takes parameters in reversed order, what might be confusing you is the pointfree definition of <code>isWord</code> and that you partially apply the flipped function to one of its arguments.</p>\n\n<p>You start with <code>charIn</code> and flip its arguments so now it is <code>String -&gt; Char -&gt; Bool</code>, then you apply it to <code>String</code> argument <code>\"abc...\"</code> and get back <code>Char -&gt; Bool</code>. Then you do one more partial application: <code>all</code> takes a function from elements to <code>Bool</code> and a list of elements, which <code>Char -&gt; Bool</code> and <code>String</code> aka <code>[Char]</code> are. So from <code>(Char -&gt; Bool) -&gt; String -&gt; Bool</code>, which is the type of <code>all</code> in this context, you get the result <code>String -&gt; Bool</code> by passing in the first of the arguments.</p>\n\n<p>Also you may want to consider <code>['a'..'z']</code> instead of the <code>\"abc...z\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1444169051, "creation_date": 1444169051, "answer_id": 32980574, "question_id": 32980278, "link": "https://stackoverflow.com/questions/32980278/confuse-about-flip-function/32980574#32980574", "title": "Confuse about flip function", "body": "<p>If you have a function f with two arguments x and y in that order, i.e. <code>f x y</code>.  If you need to fix y and make x as a free variable you can use flip to write it as <code>flip f y x</code> and convert to partially applied form by dropping x <code>flip f y</code>.  When applied to x, <code>f x y</code> will be evaluated.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5414435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a233e05fd1489358e277f8b2e16941?s=128&d=identicon&r=PG&f=1", "display_name": "user124659", "link": "https://stackoverflow.com/users/5414435/user124659"}, "edited": false, "score": 0, "creation_date": 1444176336, "post_id": 32980701, "comment_id": 53788862, "body": "It&#39;s much clearer now. But I do have a question. I put your evaluation of flip in the statement but doesnt work though - all $ charIn x [&#39;a&#39;..&#39;z&#39;]. It only work when I change it to - all (charIn x) &quot;abcdefghijklmnopqrstuvwxyz&quot;"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 15, "user_id": 5414435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a233e05fd1489358e277f8b2e16941?s=128&d=identicon&r=PG&f=1", "display_name": "user124659", "link": "https://stackoverflow.com/users/5414435/user124659"}, "edited": false, "score": 0, "creation_date": 1444177171, "post_id": 32980701, "comment_id": 53789066, "body": "@user124659, you seem to have missed the <code>\\x -&gt;</code> right before <code>charIn x [&#39;a&#39; .. &#39;z&#39;]</code>."}, {"owner": {"reputation": 15, "user_id": 5414435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a233e05fd1489358e277f8b2e16941?s=128&d=identicon&r=PG&f=1", "display_name": "user124659", "link": "https://stackoverflow.com/users/5414435/user124659"}, "edited": false, "score": 0, "creation_date": 1444178920, "post_id": 32980701, "comment_id": 53789457, "body": "Oops I missed that part but still isWord1 x = all $ \\x -&gt; charIn x [&#39;a&#39; .. &#39;z&#39;] gives me &quot;No instance for (Show (t10 Char -&gt; Bool))&quot; error."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 15, "user_id": 5414435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a233e05fd1489358e277f8b2e16941?s=128&d=identicon&r=PG&f=1", "display_name": "user124659", "link": "https://stackoverflow.com/users/5414435/user124659"}, "edited": false, "score": 1, "creation_date": 1444179806, "post_id": 32980701, "comment_id": 53789647, "body": "@user124659, you don&#39;t need that <code>x</code> on the left-hand side. If you need more real-time help, you should check out the #haskell channel on FreeNode."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1444169643, "creation_date": 1444169643, "answer_id": 32980701, "question_id": 32980278, "link": "https://stackoverflow.com/questions/32980278/confuse-about-flip-function/32980701#32980701", "title": "Confuse about flip function", "body": "<p>Whenever you see a partial application, you can use <em>eta (&eta;) expansion</em> to make things more explicit. The eta rule says that if <code>f</code> is any function,</p>\n\n<pre><code>f = \\x -&gt; f x\n</code></pre>\n\n<p>If you type</p>\n\n<pre><code>:t flip charIn \"abcdefghijklmnopqrstuvwxyz\"\n</code></pre>\n\n<p>at the GHCi prompt, you'll get a result that has an arrow (<code>-&gt;</code>) in it, meaning it's a function. So</p>\n\n<pre><code>flip charIn ['a' .. 'z']\n=\n\\x -&gt; flip charIn ['a' .. 'z'] x\n</code></pre>\n\n<p>Now you can apply <code>flip</code> to get</p>\n\n<pre><code>=\n\\x -&gt; charIn x ['a' .. 'z']\n</code></pre>\n\n<p>Which is perhaps more clearly written</p>\n\n<pre><code>\\x -&gt; x `charIn` ['a' .. 'z']\n</code></pre>\n\n<p>or even, using operator section notation,</p>\n\n<pre><code>(`charIn` ['a' .. 'z'])\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5414435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a233e05fd1489358e277f8b2e16941?s=128&d=identicon&r=PG&f=1", "display_name": "user124659", "link": "https://stackoverflow.com/users/5414435/user124659"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 32980701, "answer_count": 4, "score": 0, "last_activity_date": 1444169643, "creation_date": 1444167819, "question_id": 32980278, "link": "https://stackoverflow.com/questions/32980278/confuse-about-flip-function", "title": "Confuse about flip function", "body": "<pre><code>charIn ::  Char -&gt; String -&gt; Bool\ncharIn _ []       = False\ncharIn x (y:ys)   = x==y || charIn x ys\n\nisWord :: String -&gt; Bool\nisWord = all $ flip charIn \"abcdefghijklmnopqrstuvwxyz\"\n\n-- isword \"abc\" (Result True)\n-- isWord \"ab1\" (Result False)\n</code></pre>\n\n<p>I'm confuse about the way flip function works. I know it flips first two arguments but how does it work in the above code? Does it just flip the string argument and <em>charIn \"abcdefghijklmnopqrstuvwxyz\"</em> so that it looks like - all $  charIn \"abcdefghijklmnopqrstuvwxyz\"?</p>\n"}, {"tags": ["mongodb", "haskell", "yesod"], "comments": [{"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1525973812, "post_id": 32978797, "comment_id": 87573614, "body": "You could also try <code>res &lt;-  runDB $ selectList ([] :: [Filter Survey]) []</code>. What does your <code>instance YesodPersist</code> look like?"}], "owner": {"reputation": 2306, "user_id": 318976, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/125d810d710271326abfa1a2e3d640e3?s=128&d=identicon&r=PG", "display_name": "stevejb", "link": "https://stackoverflow.com/users/318976/stevejb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1444162208, "creation_date": 1444162208, "question_id": 32978797, "link": "https://stackoverflow.com/questions/32978797/using-selectlist-in-persistent-haskell-mongodb-to-return-json-list", "title": "Using selectList in Persistent Haskell MongoDB to return json list", "body": "<p>I am working on a yesod app. I am trying to write a handler which simply queries a collection and returns all of the results. </p>\n\n<p>In my config/models file the relevant entry is</p>\n\n<pre><code>Survey json\n    name              String\n    questions         [QuestionId]\n    deriving (Show)\n</code></pre>\n\n<p>I am working on the following handler:</p>\n\n<pre><code>module Handler.ListSurveys where\nimport Import\n\ngetListSurveysR :: Handler Value\ngetListSurveysR = do\n    res :: [Entity Survey]  &lt;-  runDB $ selectList [] [] \n    return   $ object [\"surveys\" .= res]\n</code></pre>\n\n<p>This is leading to the following error:</p>\n\n<pre><code>Handler/ListSurveys.hs:6:41:\n    Couldn't match type \u2018YesodPersistBackend App\u2019\n                   with \u2018mongoDB-2.0.7:Database.MongoDB.Query.MongoContext\u2019\n    Expected type: YesodDB App [Entity Survey]\n      Actual type: ReaderT\n                     mongoDB-2.0.7:Database.MongoDB.Query.MongoContext\n                     (HandlerT App IO)\n                     [Entity Survey]\n    In the second argument of \u2018($)\u2019, namely \u2018selectList [] []\u2019\n    In a stmt of a 'do' block:\n      res :: [Entity Survey] &lt;- runDB $ selectList [] []\n</code></pre>\n\n<p>I could really use some help as to understand what is going on with the types here (relatively inexperienced with Haskell) and how to fix this.</p>\n"}, {"tags": ["haskell", "numerical-methods"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1444160627, "post_id": 32978290, "comment_id": 53781975, "body": "Clearing up the coding style problems will make it easier to see what&#39;s going on and to test pieces in isolation."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444160776, "post_id": 32978290, "comment_id": 53782062, "body": "True. I should learn to write good code and test it. But that&#39;d probably come later."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1444161074, "post_id": 32978290, "comment_id": 53782243, "body": "Why do you put <code>x1*x2</code> in the <code>points</code> list? That doesn&#39;t make sense to me. You could just use a range comprehension there, though float ranges are a bit... weird. See <a href=\"http://stackoverflow.com/questions/7290438/haskell-ranges-and-floats/7296160#7296160\">this post of mine</a> (I used the very example of trapezoidal integration there, to demonstrate why the strange behaviour of floats makes some sense)."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1444161215, "post_id": 32978290, "comment_id": 53782322, "body": "Hint: missing a factor of 2.  Let there be 3 points.  You should  have `(b-a)/4*(f_1+2f_2+f_3).  Compare with your solution."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1444161484, "post_id": 32978290, "comment_id": 53782459, "body": "@karakfa, that&#39;s true, but not really my fault: I used a Wikipedia article in another language, which gives a different formula. Also, I doubt that&#39;s what affects the signs."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1444161871, "post_id": 32978290, "comment_id": 53782701, "body": "@leftaroundabout: I&#39;m just trying to make a list of points that a function&#39;ll later work with."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444162108, "post_id": 32978290, "comment_id": 53782840, "body": "Actually, the formula I&#39;m using gives results that are closer to actual values than the one from the english article."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1444162289, "post_id": 32978290, "comment_id": 53782963, "body": "you points seems off  - for example the first point will be <code>999 * (b-a) &#47; 1000</code> which is about <code>(b-a)</code> and the last point will be just <code>0</code> but shouln&#39;t those be from <code>a</code> to <code>b</code>? (aka: you missed a <code>+ a</code> there) - assuming the rest is ok then you will integrate from <code>0</code> to <code>b-a</code> instead of from <code>a</code> to <code>b</code>this way!"}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444163913, "post_id": 32978290, "comment_id": 53783973, "body": "The order of points doesn&#39;t affect anything, if I understand the whole process right; it&#39;s the sum of their values that matters, and it doesn&#39;t depend on the order of points."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444164017, "post_id": 32978290, "comment_id": 53784031, "body": "I am not talking about the order - see my answer (which produces reasonable results for basic functions - so chances are good it&#39;s not totally wrong ;) )"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444164034, "post_id": 32979259, "comment_id": 53784046, "body": "Your <code>points</code> looks the same. I think both are shady because they count with <code>Double</code>, but I don&#39;t think the order of the point list matters for this algorithm."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444164057, "post_id": 32979259, "comment_id": 53784061, "body": "@dfeuer: He moved <code>(+a)</code> into <code>integration</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444164100, "post_id": 32979259, "comment_id": 53784090, "body": "yes ... it was easier (aka I was to lazy to add another argument to points)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444164212, "post_id": 32979259, "comment_id": 53784147, "body": "it&#39;s really not about any order - the only thing I might have f***ed up is that maybe I choose the wrong end of the intervals here - I&#39;m really sleepy and I would not do it this way (points) but this really should be close to the wiki article (it&#39;s not that difficult)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 1, "creation_date": 1444165418, "post_id": 32979259, "comment_id": 53784827, "body": "@Chiffa: Well, this is an overkill, but you could create random polynomials, integrate them, and check whether your <code>integration</code> differs too much from the correct result."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444166165, "post_id": 32979259, "comment_id": 53785250, "body": "The major aim for me is to learn to write code that would create such polynomials for me and then test other code with it. But thanks for the idea."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1444163755, "creation_date": 1444163755, "answer_id": 32979259, "question_id": 32978290, "link": "https://stackoverflow.com/questions/32978290/haskell-numerical-integration-via-trapezoidal-rule-results-in-wrong-sign/32979259#32979259", "title": "Haskell numerical integration via Trapezoidal rule results in wrong sign", "body": "<p>Yes it indeed was the points plus you had some factors wrong (the <em>inner</em> points are multiplied by 2) - this is the fixed version of your code:</p>\n\n<pre><code>integration :: (Double -&gt; Double) -&gt; Double -&gt; Double -&gt; Double\nintegration f a b = h * (f a + f b + innerSum) / 2\n    where \n        h = (b - a) / 1000 \n        innerPts  = map ((2*) . f . (a+)) (points (1000-1) h) \n        innerSum = sum innerPts\n\npoints  :: Double -&gt; Double -&gt; [Double]\npoints i x \n    | i &lt;= 0 = []\n    | otherwise = (i*x) : points (i-1) x\n</code></pre>\n\n<p>which gives sensible approximations (to 1000 points):</p>\n\n<pre><code>\u03bb&gt; integration (const 2) 1 2\n2.0\n\u03bb&gt; integration id 1 2\n1.5\n\n\u03bb&gt; integration (\\x -&gt; x*x) 1 2\n2.3333334999999975\n\n\u03bb&gt; 7/3\n2.3333333333333335\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444166186, "post_id": 32979584, "comment_id": 53785266, "body": "A good technique for avoiding weird fence-post issues when counting in floating point is <code>map (arbitraryTransformation . fromIntegral)</code>. Of course, this all changes if you use variable-width intervals."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444166250, "post_id": 32979584, "comment_id": 53785304, "body": "That is a great answer. I regret being able to give it only 1 point. Also, should I look into literal Haskell. As a student, I  don&#39;t yet know what that is."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444166477, "post_id": 32979584, "comment_id": 53785421, "body": "@Chiffa: You know how you usually use <code>--</code> or <code>{- ... -}</code> for comments? <i>Literate</i> programming basically flips everything around. Everything is interpreted as a comment, unless you use special syntax (in this case <code>&gt; ...</code>, which is also called Bird style)."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444166497, "post_id": 32979584, "comment_id": 53785433, "body": "My function is a result of an exercise. Surely a real-life, well-designed function should have an argument for the number of points. As for <code>iterate</code>, I&#39;m yet to learn about it."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444166663, "post_id": 32979584, "comment_id": 53785507, "body": "@Chiffa: Remark: I use literate Haskell only on StackOverflow, so that one can copy and paste the whole answer into an editor/file. I usually don&#39;t use it for my own projects."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 5, "last_activity_date": 1444164961, "creation_date": 1444164961, "answer_id": 32979584, "question_id": 32978290, "link": "https://stackoverflow.com/questions/32978290/haskell-numerical-integration-via-trapezoidal-rule-results-in-wrong-sign/32979584#32979584", "title": "Haskell numerical integration via Trapezoidal rule results in wrong sign", "body": "<p><sub>Note: This answer is written in literate Haskell. Save it with <code>.lhs</code> as extension and load it in GHCi to test the solution.</sub></p>\n\n<h1>Finding the culprit</h1>\n\n<p>First of all, let's take a look at <code>integration</code>. In its current form, it contains only summation of function values <code>f x</code>. Even though the factors aren't correct at the moment, the overall approach is fine: you evaluate <code>f</code> at the grid points. However, we can use the following function to verify that there's something wrong:</p>\n\n<pre><code>ghci&gt; integration (\\x -&gt; if x &gt;= 10 then 1 else (-1)) 10 15\n-4.985\n</code></pre>\n\n<p>Wait a second. <code>x</code> isn't even negative in [10,15]. This suggests that you use the wrong grid points.</p>\n\n<h1>Grid points revisited</h1>\n\n<p>Even though you've linked the article, let's have a look at an exemplary use of the trapezoidal rule (<a href=\"https://commons.wikimedia.org/wiki/File:Composite_trapezoidal_rule_illustration.svg\" rel=\"noreferrer\">public domain, original file by Oleg Alexandrov</a>):</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZpjlZ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ZpjlZ.png\" alt=\"trapezoidal rule\"></a></p>\n\n<p>Although this doesn't use a uniform grid, let's suppose that the 6 grid points are equidistant with grid distance <code>h = (b - a) / 5</code>. What are the <code>x</code> coordinates of those points?</p>\n\n<pre><code>x_0 = a + 0 * h (== a)\nx_1 = a + 1 * h\nx_2 = a + 2 * h\nx_3 = a + 3 * h\nx_4 = a + 4 * h\nx_5 = a + 5 * h (== b)\n</code></pre>\n\n<p>If we use set <code>a = 10</code> and <code>b = 15</code> (and therefore <code>h = 1</code>), we should end up with <code>[10, 11, 12, 13, 14, 15]</code>. Let's check your <code>points</code>. In this case, you would use <code>points 5 1</code> and end up with <code>[5,4,3,2,1]</code>. </p>\n\n<p>And there's the error. <code>points</code> doesn't respect the boundary. We can easily fix this by using <code>pointsWithOffset</code>:</p>\n\n<pre><code>&gt; points  :: Double -&gt; Double -&gt; [Double]\n&gt; points x1 x2 \n&gt;     | x1 &lt;= 0 = []\n&gt;     | otherwise = (x1*x2) : points (x1-1) x2\n&gt;\n&gt; pointsWithOffset :: Double -&gt; Double -&gt; Double -&gt; [Double]\n&gt; pointsWithOffset x1 x2 offset = map (+offset) (points x1 x2)\n</code></pre>\n\n<p>That way, we can still use your current <code>points</code> definition to generate grid points from <code>x1</code> to <code>0</code> (almost). If we use <code>integration</code> with <code>pointsWithOffset</code>, we end up with</p>\n\n<pre><code>integration :: (Double -&gt; Double) -&gt; Double -&gt; Double -&gt; Double\nintegration f a b = h * (f a + f b + partial_sum)\n    where \n        h = (b - a) / 1000 \n        most_parts  = map f (pointsWithOffset (1000-1) h a)  \n        partial_sum = sum most_parts\n</code></pre>\n\n<h1>Tying up loose ends</h1>\n\n<p>However, this doesn't take into account that you use all inner points twice in the trapezoid rule. If we add the factors, we end up with</p>\n\n<pre><code>&gt; integration :: (Double -&gt; Double) -&gt; Double -&gt; Double -&gt; Double\n&gt; integration f a b = \n&gt;      h / 2 * (f a + f b + 2 * partial_sum)\n&gt;    --    ^^^              ^^^\n&gt;    where \n&gt;        h = (b - a) / 1000 \n&gt;        most_parts  = map f (pointsWithOffset (1000-1) h a)  \n&gt;        partial_sum = sum most_parts\n</code></pre>\n\n<p>Which yields the correct value for our test function above.</p>\n\n<h1>Exercise</h1>\n\n<p>Your current version only supports <code>1000</code> grid points. Add an <code>Int</code> argument so that one can change the number of grid points:</p>\n\n<pre><code>integration :: Int -&gt; (Double -&gt; Double) -&gt; Double -&gt; Double -&gt; Double\nintegration n f a b = -- ...\n</code></pre>\n\n<p>Furthermore, try to write <code>points</code> in different ways, for example go from <code>a</code> to <code>b</code>, use <code>takeWhile</code> and <code>iterate</code>, or even a list comprehension.</p>\n"}], "owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "accepted_answer_id": 32979259, "answer_count": 2, "score": 2, "last_activity_date": 1546173693, "creation_date": 1444160366, "last_edit_date": 1546173693, "question_id": 32978290, "link": "https://stackoverflow.com/questions/32978290/haskell-numerical-integration-via-trapezoidal-rule-results-in-wrong-sign", "title": "Haskell numerical integration via Trapezoidal rule results in wrong sign", "body": "<p>I've written some code that's meant to integrate a function numerically using the trapezoidal rule. It works, but the answer it produces has a wrong sign. Why might that be?</p>\n\n<p>The code is:</p>\n\n<pre><code>integration :: (Double -&gt; Double) -&gt; Double -&gt; Double -&gt; Double\nintegration f a b = h * (f a + f b + partial_sum)\n    where \n        h = (b - a) / 1000 \n        most_parts  = map f (points (1000-1) h) \n        partial_sum = sum most_parts\n\npoints  :: Double -&gt; Double -&gt; [Double]\npoints x1 x2 \n    | x1 &lt;= 0 = []\n    | otherwise = (x1*x2) : points (x1-1) x2\n</code></pre>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Trapezoidal_rule\" rel=\"nofollow\">Trapezoidal rule</a> </p>\n\n<p>The code is probably inelegant, but I'm only a student of Haskell and would like to deal with the current problem first and coding style matters after that.</p>\n"}, {"tags": ["haskell", "pandoc", "hakyll"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1444164011, "post_id": 32977025, "comment_id": 53784027, "body": "Whoever voted to close as &quot;about general computing hardware and software&quot; doesn&#39;t know what Hakyll is and didn&#39;t bother to check."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444172839, "post_id": 32977025, "comment_id": 53787912, "body": "Possible alternative: instead of translating <code># Heading 1</code> to <code>&lt;h3&gt;</code>, you might consider changing your CSS to make <code>h1</code>&#39;s less pronounced. (Though I recognize there can also be legitimate reasons to avoid <code>h1</code> entirely.)"}, {"owner": {"reputation": 1381, "user_id": 1936416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7314f391870688f6808f07e859927ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1936416/ben"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1444172913, "post_id": 32977025, "comment_id": 53787934, "body": "@DanielWagner I use h1 in the templates as a more general header title, and then want my markdown to generate the body. In other words, I do need the h1 too."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1444156613, "creation_date": 1444156613, "answer_id": 32977206, "question_id": 32977025, "link": "https://stackoverflow.com/questions/32977025/start-from-different-html-heading-in-hakyll/32977206#32977206", "title": "Start from different html heading in Hakyll", "body": "<p>The <a href=\"https://hackage.haskell.org/package/hakyll-4.7.3.0/docs/Hakyll-Web-Html.html\" rel=\"nofollow\"><code>Hakyll.Web.Html</code> module</a> includes some useful functions for HTML manipulation, including a <code>demoteHeaders</code> which should be enough for your needs. It is also worth noting that the <code>withTags</code> function there allows convenient usage of <a href=\"https://hackage.haskell.org/package/tagsoup-0.13.3/\" rel=\"nofollow\"><em>tagsoup</em></a> for arbitrary manipulation of HTML tags.</p>\n"}], "owner": {"reputation": 1381, "user_id": 1936416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7314f391870688f6808f07e859927ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1936416/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 32977206, "answer_count": 1, "score": 1, "last_activity_date": 1444156613, "creation_date": 1444155971, "question_id": 32977025, "link": "https://stackoverflow.com/questions/32977025/start-from-different-html-heading-in-hakyll", "title": "Start from different html heading in Hakyll", "body": "<p>I'm building a static website with Hakyll and I'm using the PandocCompiler to compile markdown to html. This works perfectly, but the compiler takes this:</p>\n\n<pre><code># Heading 1\n</code></pre>\n\n<p>and compiles it to</p>\n\n<pre><code>&lt;h1&gt;Heading 1&lt;/h1&gt;\n</code></pre>\n\n<p>This is the expected result. However, I'd like to start at a lower heading, say, <code>&lt;h3&gt;</code>, so that:</p>\n\n<pre><code># Heading 1\n</code></pre>\n\n<p>compiles to</p>\n\n<pre><code>&lt;h3&gt;Heading 1&lt;/h3&gt;\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>## Heading 2\n</code></pre>\n\n<p>compiles to</p>\n\n<pre><code>&lt;h4&gt;Heading 2&lt;/h4&gt;\n</code></pre>\n\n<p>and so on.</p>\n\n<p>I could of course change the markdown itself, but I have many files and it would be a lot of work, and it would make the markdown a bit uglier. </p>\n\n<p>Any ideas on how to do this? </p>\n"}, {"tags": ["haskell", "dictionary"], "comments": [{"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 3, "creation_date": 1444154187, "post_id": 32976308, "comment_id": 53778079, "body": "Looks like you need <code>unionWith</code> from <code>Data.Map</code>: <code>unionWith (+) map1 map2</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444162831, "post_id": 32976308, "comment_id": 53783307, "body": "If you are implementing a bag, consider just using the <a href=\"http://hackage.haskell.org/package/multiset\" rel=\"nofollow noreferrer\">multiset</a> package."}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "edited": false, "score": 0, "creation_date": 1606254280, "post_id": 32976308, "comment_id": 114907739, "body": "For those looking for how to combine maps of different value-types, the functions in <a href=\"https://hackage.haskell.org/package/containers-0.6.4.1/docs/Data-Map-Merge-Strict.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/containers-0.6.4.1/docs/&hellip;</a> let you e.g. zip values of matching keys with <code>ziptersect = merge dropMissing dropMissing (zipWithMatched (\\_key x y -&gt; (x, y)))</code> (or change <code>dropMissing</code> to some other <code>WhenMissing</code> tactic if you want something other than intersecting zips)"}], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444155119, "post_id": 32976461, "comment_id": 53778590, "body": "Thanks very much. And should the function looks something like this:              bagSum :: M.Map String Int -&gt; M.Map String Int -&gt; M.Map String Int bagSum b1 b2 = M.unionWith (+) b1 b2"}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444156473, "post_id": 32976461, "comment_id": 53779462, "body": "And should the call be mergeMap [(&quot;a&quot;,1),(&quot;b&quot;,2)] [(&quot;a&quot;,1),(&quot;b&quot;,2)] ??? It says that it couldn&#39;t bind the variables"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444156569, "post_id": 32976461, "comment_id": 53779521, "body": "You&#39;re calling it with lists not maps; if you wrap your list literals with <code>Map.fromList</code>, it&#39;ll work just fine. Like this: <code>mergeMap (Map.fromList [(&quot;a&quot;,1),(&quot;b&quot;,2)]) (Map.fromList [(&quot;a&quot;,1),(&quot;b&quot;,2)])</code> or <code>Map.fromList [(&quot;a&quot;,1),(&quot;b&quot;,2)] `mergeMap` Map.fromList [(&quot;a&quot;,1),(&quot;b&quot;,2)]</code>."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 16, "last_activity_date": 1577099478, "last_edit_date": 1577099478, "creation_date": 1444154152, "answer_id": 32976461, "question_id": 32976308, "link": "https://stackoverflow.com/questions/32976308/how-can-i-merge-2-maps-in-haskell/32976461#32976461", "title": "How can I merge 2 maps in Haskell", "body": "\n\n<p>How about <code>unionWith</code> from <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Map.html\" rel=\"nofollow noreferrer\"><code>Data.Map</code></a>? </p>\n\n<p>Here's a sample GHCi session using it on two maps <code>m1</code> and <code>m2</code> both containing the key 'a':</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; import qualified Data.Map as Map\nPrelude Data.Map&gt; let m1 = Map.fromList [('a', 1)]\nPrelude Data.Map&gt; let m2 = Map.fromList [('a', 2), ('b', 10)]\nPrelude Data.Map&gt; Map.unionWith (+) m1 m2\nfromList [('a',3),('b',10)]\n</code></pre>\n\n<hr>\n\n<p>If you want to define your own function to wrap all that up:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mergeMap :: (Ord k, Num a) =&gt; Map.Map k a -&gt; Map.Map k a -&gt; Map.Map k a\nmergeMap = Map.unionWith (+)\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mergeMap a b = Map.unionWith (+) a b\n</code></pre>\n\n<p>or even</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>a `mergeMap` b = Map.unionWith (+) a b\n</code></pre>\n\n<hr>\n\n<p><strong>Note:</strong> in real life, make sure to make the right choice between lazy and strict maps, and hence between <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Map-Strict.html#g:9\" rel=\"nofollow noreferrer\"><code>Data.Map.Strict.unionWith</code></a> and <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Map-Lazy.html#g:9\" rel=\"nofollow noreferrer\"><code>Data.Map.Lazy.unionWith</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444161624, "post_id": 32977927, "comment_id": 53782545, "body": "@ErikAllik, it&#39;s admittedly a bit hard to say for sure--we are reasoning from a single example. I imagined the lists were intended to represent maps already, and that they needed only be merged. It&#39;s possible they&#39;re even supposed to be sorted already."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1444159064, "creation_date": 1444159064, "answer_id": 32977927, "question_id": 32976308, "link": "https://stackoverflow.com/questions/32976308/how-can-i-merge-2-maps-in-haskell/32977927#32977927", "title": "How can I merge 2 maps in Haskell", "body": "<p>An alternative to <code>Map</code> is <code>sort</code>. This version assumes each key occurs only once in each list. If that's not the case, you could fix it up, but the <code>Map</code> approach would start looking a lot more attractive.</p>\n\n<pre><code>combine op xs ys = cs op (s xs) (s ys)\n  where\n    s = sortBy (compare `on` fst)\n\n    cs _ [] qs = qs\n    cs _ ps [] = ps\n    cs op pss@(p@(pk,pv):ps) qss@(q@(qk,qv):qs) =\n      case compare pk qk of\n        LT -&gt; p : cs op ps qss\n        GT -&gt; q : cs op pss qs\n        EQ -&gt; (pk, pv `op` qv) : cs op ps qs\n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3638, "favorite_count": 3, "accepted_answer_id": 32976461, "answer_count": 2, "score": 5, "last_activity_date": 1577099478, "creation_date": 1444153601, "last_edit_date": 1444155008, "question_id": 32976308, "link": "https://stackoverflow.com/questions/32976308/how-can-i-merge-2-maps-in-haskell", "title": "How can I merge 2 maps in Haskell", "body": "<p>If I have 2 Haskell Maps, for example:</p>\n\n<pre><code>[(\"a\",1),\n (\"b\",2),\n (\"c\",1)]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[(\"a\",1)]\n</code></pre>\n\n<p>How can I write a function in such a way that it would give something like:</p>\n\n<pre><code>[(\"a\",2),(\"b\",2),(\"c\",1)]\n</code></pre>\n\n<p>Until now I could only write the base cases but that was all.</p>\n"}, {"tags": ["haskell", "hoogle", "stackage"], "comments": [{"owner": {"reputation": 13201, "user_id": 1098230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c8776a6aefb37bf25d866707973593e?s=128&d=identicon&r=PG", "display_name": "Kolmar", "link": "https://stackoverflow.com/users/1098230/kolmar"}, "edited": false, "score": 2, "creation_date": 1444151230, "post_id": 32975116, "comment_id": 53776407, "body": "By the way, this package is the first result in Google for <code>text lift package site: hackage.haskell.org</code>"}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 13201, "user_id": 1098230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c8776a6aefb37bf25d866707973593e?s=128&d=identicon&r=PG", "display_name": "Kolmar", "link": "https://stackoverflow.com/users/1098230/kolmar"}, "edited": false, "score": 0, "creation_date": 1444152492, "post_id": 32975116, "comment_id": 53777129, "body": "Thanks @Kolmar!  Searching google using <code>site:hackage.haskell.org</code> seems like a good way to find things!"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444156411, "post_id": 32975116, "comment_id": 53779414, "body": "...or <a href=\"http://hayoo.fh-wedel.de\" rel=\"nofollow noreferrer\">Hayoo</a>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1444152114, "post_id": 32975529, "comment_id": 53776895, "body": "I believe this can only work if the package can see the source. If it&#39;s an orphan, all bets are off. I see the orphan instance problem as Haskell&#39;s biggest scaling problem."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444156746, "post_id": 32975529, "comment_id": 53779623, "body": "@dfeuer The haddocks already include the <code>Text</code> instance in the list of instances for <code>Lift</code>; isn&#39;t that good evidence that they can see the source?"}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 0, "creation_date": 1444174754, "post_id": 32975529, "comment_id": 53788413, "body": "@DanielWagner, I don&#39;t think my original question was specific enough.  There are two packages, <code>th-lift</code> and <code>th-lift-instances</code>.  <code>th-lift</code> defines the <code>Lift</code> type class.  <code>th-lift-instances</code> defines the <code>Lift Text</code> instance.   If you want an instance of <code>Lift</code> for <code>Text</code> and all you know about is the <code>Lift</code> typeclass (in the <code>th-lift</code> package), then there is no good way to find out about the <code>th-lift-instances</code> package, save from googling for it like @Kolmar suggests."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1444150729, "creation_date": 1444150729, "answer_id": 32975529, "question_id": 32975116, "link": "https://stackoverflow.com/questions/32975116/how-to-search-for-typeclass-instances-on-hoogle/32975529#32975529", "title": "How to search for typeclass instances on Hoogle?", "body": "<p>For now, no. However, a feature was recently added to haddock to allow instances to link to their source, and all new documentation built on Hackage has that turned on. So in the next release of the <code>th-lift</code> package, you should see a \"Source\" link next to the <code>Lift Text</code> instance that will tell you what you need to know.</p>\n"}, {"tags": [], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "is_accepted": false, "score": 1, "last_activity_date": 1487854080, "last_edit_date": 1495542308, "creation_date": 1487854080, "answer_id": 42416202, "question_id": 32975116, "link": "https://stackoverflow.com/questions/32975116/how-to-search-for-typeclass-instances-on-hoogle/42416202#42416202", "title": "How to search for typeclass instances on Hoogle?", "body": "<p>Expanding on <a href=\"https://stackoverflow.com/questions/32975116/how-to-search-for-typeclass-instances-on-hoogle#comment53776407_32975116\">Kolmar's comment</a>, some Google techniques do go a long way towards finding instances.</p>\n\n<p>Examples:</p>\n\n<ul>\n<li><a href=\"https://www.google.com/search?q=site:hackage.haskell.org%20%22instance%20Lift%20Text%22\" rel=\"nofollow noreferrer\">site:hackage.haskell.org \"instance Lift Text\"</a></li>\n<li><a href=\"https://www.google.com/search?q=site%3Ahackage.haskell.org%20%22instance%20Default%22%20-inurl%3ADefault%20%28*Opts%20OR%20*Options%20OR%20*Config%29\" rel=\"nofollow noreferrer\">site:hackage.haskell.org \"instance Default\" -inurl:Default (*Opts OR *Options OR *Config)</a></li>\n<li><a href=\"https://www.google.com/search?q=site:hackage.haskell.org%20%22instance%20Num%22\" rel=\"nofollow noreferrer\">site:hackage.haskell.org \"instance Num\"</a></li>\n<li><a href=\"https://www.google.com/search?q=site:hackage.haskell.org+%22instance+Monoid%22+-inurl:monoid\" rel=\"nofollow noreferrer\">site:hackage.haskell.org \"instance Monoid\" -inurl:monoid</a></li>\n</ul>\n\n<p><code>-inurl:</code> is used to clean up superfluous results from where the typeclass was defined.</p>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 1, "accepted_answer_id": 32975529, "answer_count": 2, "score": 8, "last_activity_date": 1487854080, "creation_date": 1444149233, "last_edit_date": 1444156454, "question_id": 32975116, "link": "https://stackoverflow.com/questions/32975116/how-to-search-for-typeclass-instances-on-hoogle", "title": "How to search for typeclass instances on Hoogle?", "body": "<p>Is there a way to search for instances of a typeclass on Hoogle (or Stackage)?</p>\n\n<p>For instance, I want to know which package defines an instance of <a href=\"http://haddock.stackage.org/lts-3.8/th-lift-0.7.2/Language-Haskell-TH-Lift.html#t:Lift\" rel=\"nofollow\"><code>Lift</code></a> for <code>Text</code>.</p>\n\n<p>I was able to find it in the package <a href=\"https://hackage.haskell.org/package/th-lift-instances-0.1.6/docs/Instances-TH-Lift.html\" rel=\"nofollow\"><code>th-lift-instances</code></a>, but it took about 10 minutes of manual searching. It seems like there should be some functionality of Hoogle that allows searching for instances.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1444150028, "post_id": 32974509, "comment_id": 53775689, "body": "I would prefer <code>map (\\(x:xs) -&gt; toUpper x : xs)</code> for the map function. Generally speaking, there&#39;s no reason to prefer <code>[x] ++ xs</code> over <code>x : xs</code>, and pattern matching should almost always be preferred over head and tail."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444151296, "post_id": 32974509, "comment_id": 53776454, "body": "@ReinHenrichs, indeed, and it&#39;s unfortunate that <code>words</code> returns a list of lists instead of a list of <code>NonEmpty</code>s."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444163480, "post_id": 32974509, "comment_id": 53783696, "body": "Quick note for posterity: I closed this as a duplicate of question X, which is a duplicate of Y. However, I think there are some slight details different between X and Y that makes this question not a duplicate of Y; but the answers at X do indeed address the confusion arising in this question. (Probably X should not be a duplicate of Y in the first place, though I can see why it was closed that way.)"}], "answers": [{"tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": false, "score": 4, "last_activity_date": 1444149200, "last_edit_date": 1444149200, "creation_date": 1444148029, "answer_id": 32974740, "question_id": 32974509, "link": "https://stackoverflow.com/questions/32974509/haskell-good-usage-of-map-number-of-arguments/32974740#32974740", "title": "haskell : good usage of map, number of arguments", "body": "<p>You want the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:-36-\" rel=\"nofollow\">application operator</a> <code>($) :: (a -&gt; b) -&gt; a -&gt; b</code> instead of the dot which is function composition <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code>.</p>\n\n<pre><code>modernise s = unwords $ map (\\m -&gt; [toUpper (head m)]  ++ tail m) (words s)\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>modernise s = unwords ( map (\\m -&gt; [toUpper (head m)]  ++ tail m) (words s) )\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444148958, "post_id": 32974780, "comment_id": 53775051, "body": "this is such an often made mistake that I wonder why GHC doesn&#39;t detect the intent behind it for new users and report an easier to understand error message."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1444151769, "post_id": 32974780, "comment_id": 53776709, "body": "@ErikAllik, getting the type checker to give usable error messages is hard enough without trying to bake in knowledge of commonly confused functions. Furthermore, the type checker does not backtrack, and for the sake of speed is implemented using techniques that do not support backtracking. So it doesn&#39;t really have the ability to try using an alternative function hypothetically; as soon as it sees the <code>.</code> it commits to it."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 4, "last_activity_date": 1444148143, "creation_date": 1444148143, "answer_id": 32974780, "question_id": 32974509, "link": "https://stackoverflow.com/questions/32974509/haskell-good-usage-of-map-number-of-arguments/32974780#32974780", "title": "haskell : good usage of map, number of arguments", "body": "<p>In the first version, you wrote</p>\n\n<pre><code>modernise s = unwords . map whatever (words s)\n</code></pre>\n\n<p>By the definition of <code>.</code>, this means</p>\n\n<pre><code>modernise s = \\x -&gt; unwords (map whatever (words s) x)\n</code></pre>\n\n<p>You could instead have used the <code>$</code> operator:</p>\n\n<pre><code>modernise s = unwords $ map whatever (words s)\n</code></pre>\n\n<p>But the version you got to work is perfectly idiomatic and clear, so there's no need to change that aspect of its structure.</p>\n"}, {"tags": [], "owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "is_accepted": false, "score": 2, "last_activity_date": 1444148467, "creation_date": 1444148467, "answer_id": 32974871, "question_id": 32974509, "link": "https://stackoverflow.com/questions/32974509/haskell-good-usage-of-map-number-of-arguments/32974871#32974871", "title": "haskell : good usage of map, number of arguments", "body": "<blockquote>\n  <p>\"too many arguments for the map function\"; but I gave 2 arrguments (the lambda function and the result of \"words\") which is the good number of arguments.</p>\n</blockquote>\n\n<p>Exactly. In the subexpression <code>map (\\m -&gt; [toUpper (head m)]  ++ tail m) (words s)</code> you gave <code>map</code> two arguments and arrived at a value of type <code>[String]</code> which is a non-function type. However you treat the result as a function, because the second argument to <code>(.)</code> must be of function type.</p>\n\n<p>Whenever you try to supply a non-function value where a function is expected, the compiler provides diagnostic. The subexpression in question is a multiple application of function <code>map</code>, that's why the compiler makes a suggestion that you might have tried to feed it with too many arguments.</p>\n\n<p>As others have already said, you need the <code>($)</code> function.</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "closed_date": 1444163418, "accepted_answer_id": 32974780, "answer_count": 3, "score": 0, "last_activity_date": 1444149200, "creation_date": 1444147304, "last_edit_date": 1444148878, "question_id": 32974509, "link": "https://stackoverflow.com/questions/32974509/haskell-good-usage-of-map-number-of-arguments", "closed_reason": "Duplicate", "title": "haskell : good usage of map, number of arguments", "body": "<p>the signature of <code>map</code> is <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>, which means that it takes 2 arguments and returns a list.\nYet the following function, which transforms a string into a first letter capitalised clone is wrong:</p>\n\n<pre><code>modernise :: String -&gt; String\nmodernise s = unwords . map (\\m -&gt; [toUpper (head m)] ++ tail m) (words s)\n</code></pre>\n\n<p>the good version is:</p>\n\n<pre><code>modernise :: String -&gt; String\nmodernise = unwords . map (\\m -&gt; [toUpper (head m)] ++ tail m) . words\n</code></pre>\n\n<p>the first version is rejected with an error saying: <em><code>\"too many arguments for the map function\"</code></em>; but I gave 2 arguments (the lambda function and the result of <code>words</code>) which is the good number of arguments.</p>\n\n<p>can you help me?</p>\n"}, {"tags": ["haskell", "symbols"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1444584745, "post_id": 32974091, "comment_id": 53954275, "body": "Great question (as evidenced by the quality of the answer), but do persist with the book - all will soon be clear."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 6, "last_activity_date": 1444146181, "creation_date": 1444146181, "answer_id": 32974148, "question_id": 32974091, "link": "https://stackoverflow.com/questions/32974091/what-does-mean-in-a-type-signature/32974148#32974148", "title": "What does =&gt; mean in a type signature?", "body": "<p>It's a constraint on the type, means <code>a</code> should be an instance of class <code>Show</code>.</p>\n\n<p>see for example <a href=\"https://en.wikibooks.org/wiki/Haskell/Classes_and_types\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 7, "last_activity_date": 1444147478, "creation_date": 1444147478, "answer_id": 32974558, "question_id": 32974091, "link": "https://stackoverflow.com/questions/32974091/what-does-mean-in-a-type-signature/32974558#32974558", "title": "What does =&gt; mean in a type signature?", "body": "<p>The <code>=&gt;</code> is first introduced and explained in <a href=\"http://learnyouahaskell.com/types-and-typeclasses#typeclasses-101\" rel=\"noreferrer\">Chapter 3 - Types and Typeclasses</a>:</p>\n\n<blockquote>\n  <p>What's the type signature of the == function?</p>\n\n<pre><code>ghci&gt; :t (==)  \n(==) :: (Eq a) =&gt; a -&gt; a -&gt; Bool  \n</code></pre>\n  \n  <p>Note: the equality operator, == is a function. So are +, *, -, / and\n  pretty much all operators. If a function is comprised only of special\n  characters, it's considered an infix function by default. If we want\n  to examine its type, pass it to another function or call it as a\n  prefix function, we have to surround it in parentheses.</p>\n  \n  <p>Interesting. We see a new thing here, the => symbol. Everything before\n  the => symbol is called a class constraint. We can read the previous\n  type declaration like this: the equality function takes any two values\n  that are of the same type and returns a Bool. The type of those two\n  values must be a member of the Eq class (this was the class\n  constraint).</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444169012, "post_id": 32980202, "comment_id": 53786569, "body": "Have you figured out The Right Way to do erasure yet?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444169201, "post_id": 32980202, "comment_id": 53786629, "body": "I&#39;m not into absolutes, but I have a few new clues."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 22, "last_activity_date": 1444167468, "creation_date": 1444167468, "answer_id": 32980202, "question_id": 32974091, "link": "https://stackoverflow.com/questions/32974091/what-does-mean-in-a-type-signature/32980202#32980202", "title": "What does =&gt; mean in a type signature?", "body": "<p>Here's another way of looking at it. Some of a function's arguments are invisible, others are visible. A type <code>input -&gt; output</code> tells us that a visible <code>input</code> is expected as an argument. A type <code>(Constraint) =&gt; output</code> tells us that some invisible information is expected. They're not interchangeable, because the visible arguments must be written, and the invisible arguments must not be written. The invisible arguments are for the compiler to figure out for himself (well, he sounds like a himself to me), and he insists on puzzling them out: he refuses just to be told what they are!</p>\n\n<p>Secretly, the full type of this <code>tell</code> example is</p>\n\n<pre><code>tell :: forall (a :: *). (Show a) =&gt; [a] -&gt; String\n</code></pre>\n\n<p>What I've done is to make clear where this <code>a</code> variable comes in and what kind of a thing it is. You can also read this as a \"deal\": <code>tell</code> offers to work for all types <code>a</code> which satisfy the demand <code>(Show a)</code>.</p>\n\n<p>In order for a usage of <code>tell</code> to make sense, it needs three things. Two of them are invisible and one is visible. That is, when you use <code>tell</code>, you make the visibile argument explicit, and the compiler tries to fill in the invisible parts. Let's work through that type more slowly.</p>\n\n<pre><code>tell :: forall (a :: *).   -- the type of elements to tell          (invisible)\n        (Show a) =&gt;        -- how to make a String from one element (invisible)\n        [a] -&gt;             -- the list of elements to be told       (visible)\n        String             -- the String made by showing all the elements\n</code></pre>\n\n<p>So, when you use <code>tell</code>, e.g.,</p>\n\n<pre><code>tell [True, False]\n</code></pre>\n\n<p>you give only the visible argument: the list <code>[True, False]</code> of things to tell, and the compiler figures out the invisible arguments. He knows that <code>True</code> and <code>False</code> are both values of type <code>Bool</code>, so that means</p>\n\n<pre><code>[True, False] :: [Bool]\n</code></pre>\n\n<p>which is how the compiler figures out that the <code>a</code> in the type of <code>tell</code> must be <code>Bool</code>, making <code>[a] = [Bool]</code></p>\n\n<p>(By the way, about <code>[True, False] :: [Bool]</code>. Left of ::, the square brackets, [..], make list values. Right of ::, the square brackets, [..], make a type of lists. They may just look black on a grey background to you, but my brain colours the value-making brackets red and the type-making brackets blue. They are entirely different. I wish I could colour code on this site. I digress.)</p>\n\n<p>So, now, the other invisible argument must satisfy this <code>(Show a)</code> thing, which we now know is specifically <code>(Show Bool)</code> because we figured out that <code>a</code> is <code>Bool</code>. We call this part of the type a \"constraint\", but really it's a demand not just that a fact is true, but that some useful stuff exists. The stuff that is being demanded here is that there is a function</p>\n\n<pre><code>show :: Bool -&gt; String\n</code></pre>\n\n<p>That's the function used to turn the individual elements <code>True</code> and <code>False</code> into <code>String</code>s in the process of evaluating <code>tell [True, False]</code>.</p>\n\n<p>The identifier <code>Show</code> is the name of a <em>type class</em> and <em>show</em> is the method of that type class. A type <code>class</code> specifies an interface of operations which must be implemented for each <code>instance</code>. The invisible argument to the function is a record (or \"dictionary\") packaging the implementations of those operations for the type in question (here, the implementation of <code>show</code>). Without that information, the compiled code would have no way to do its job, but we don't have to write that information, because the compiler can (at least in this case) search through the instances it knows about and fill in the right one for the job.</p>\n\n<p>So, we don't just have invisible type arguments (which are inferred at compile time, then erased before run time), signalled by lowercase type variables, or more explicitly by <code>forall</code> <em>blah</em> <code>.</code>. We also have invisible implementations of type class operations (which are looked up at compile time, to provide vital run time information). So, something very important happens <em>between inferring and erasing types</em>: while the compiler still knows the types, it uses them to figure out which invisible implementations will be needed at run time, so that we can get away with not writing them ourselves.</p>\n\n<p>Zooming out, <code>=&gt;</code> in a type documents our expectation that the compiler will make use of type information to guide the generation of run time code that we don't have to bother writing. That's a nice little bit of win, right there.</p>\n\n<p><strong>Ulterior motive for type system hackers.</strong> The message that the invisible-visible distinction is in a different place from the erasable-useful distinction is one that some people have not yet received. That is the classic Hindley-Milner position, but the fact is that these distinctions are orthogonal, and the sooner people learn to enjoy that, the better.</p>\n"}], "owner": {"reputation": 3575, "user_id": 4678042, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R0bWq.jpg?s=128&g=1", "display_name": "sunny", "link": "https://stackoverflow.com/users/4678042/sunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "accepted_answer_id": 32974148, "answer_count": 3, "score": 5, "last_activity_date": 1444167468, "creation_date": 1444145983, "last_edit_date": 1444146531, "question_id": 32974091, "link": "https://stackoverflow.com/questions/32974091/what-does-mean-in-a-type-signature", "title": "What does =&gt; mean in a type signature?", "body": "<p>I just starting <em>Learn you a Haskell</em>, and I saw this used in an example without explanation:</p>\n\n<pre><code>tell :: (Show a) =&gt; [a] -&gt; String\n</code></pre>\n\n<p>What does this mean, in particular the <code>=&gt;</code>? I know it won't work if I substitute <code>-&gt;</code> or delete it, but I don't really understand why.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "edited": false, "score": 1, "creation_date": 1444145533, "post_id": 32973776, "comment_id": 53772905, "body": "The line that decides if the string is full of colours (<code>string == []) = if ...</code> reads (in English) &quot;return True if there are not the same number of red and yellow balls, or there are not the same number of green and blue balls&quot;. This isn&#39;t the same as the spec."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1444145536, "post_id": 32973776, "comment_id": 53772906, "body": "divide your solution in it&#39;s parts (make predicates for each of the points above) and check the input against each ;)"}, {"owner": {"reputation": 3185, "user_id": 241899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/56dfa400a964081e78a0be24978e7cdf?s=128&d=identicon&r=PG", "display_name": "Vitaly Olegovitch", "link": "https://stackoverflow.com/users/241899/vitaly-olegovitch"}, "reply_to_user": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "edited": false, "score": 0, "creation_date": 1444145976, "post_id": 32973776, "comment_id": 53773183, "body": "@C.Quilley I didn&#39;t see that. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 3, "last_activity_date": 1444594391, "last_edit_date": 1495539889, "creation_date": 1444147235, "answer_id": 32974487, "question_id": 32973776, "link": "https://stackoverflow.com/questions/32973776/wrong-output-of-simple-haskell-exercise-solution/32974487#32974487", "title": "Wrong output of simple Haskell exercise solution", "body": "<p>Besides <a href=\"https://stackoverflow.com/users/3842022/c-quilley\">C. Quilley</a>'s comments, here is some general advice and a suggestion for structuring your function differently. The guard <code>string == []</code> is better written as <code>null string</code>, since the built-in function <code>null</code> will make this decision with a single pattern match, rather than having to rely on the list of elements being comparable (which it only is when the elements of the list themselves are comparable). The pattern <code>if ... then True else False</code> can be shortened to <code>...</code>, since this is already a boolean with the same value. <em>Generally, try and use pattern matching!</em></p>\n\n<p>I cannot see where you derive <code>(red /= yellow) || (green /= blue)</code> from. When does the number of red balls and yellow balls have constraints in common?</p>\n\n<p>Instead of a String, you may want to create a data type that reflects balls:</p>\n\n<pre><code>data Ball = Red | Green | Yellow | Blue\n          deriving Eq\n</code></pre>\n\n<p>You may want them to be displayed just the same as before:</p>\n\n<pre><code>instance Show Ball where\n    show Red = \"R\"\n    show Green = \"G\"\n    show Yellow = \"Y\"\n    show Blue = \"B\"\n</code></pre>\n\n<p>And you may want to embed the helper function inside the main function:</p>\n\n<pre><code>isFullOfColors :: [Ball] -&gt; Bool\nisFullOfColors = go (0, 0, 0, 0)\n  where\n    go :: (Int, Int, Int, Int) -&gt; [Ball] -&gt; Bool\n    go (r,g,y,b) (Red:balls) = ...\n    go (r,g,y,b) (Green:balls) = ...\n    go (r,g,y,b) (Yellow:balls) = ...\n    go (r,g,y,b) (Blue:balls) = ...\n    go (r,g,y,b) [] = ...\n</code></pre>\n\n<p>As for hints on the logical part: These can be expressed as comparisons between r, g, y and b in combination with recursive calls to <code>balls</code>.</p>\n"}], "owner": {"reputation": 3185, "user_id": 241899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/56dfa400a964081e78a0be24978e7cdf?s=128&d=identicon&r=PG", "display_name": "Vitaly Olegovitch", "link": "https://stackoverflow.com/users/241899/vitaly-olegovitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 32974487, "answer_count": 1, "score": 0, "last_activity_date": 1444594391, "creation_date": 1444145106, "last_edit_date": 1592644375, "question_id": 32973776, "link": "https://stackoverflow.com/questions/32973776/wrong-output-of-simple-haskell-exercise-solution", "title": "Wrong output of simple Haskell exercise solution", "body": "<p>I am trying to solve this exercise:</p>\n<blockquote>\n<p>You are given a sequence of N balls in 4 colors: red, green, yellow\nand blue. The sequence is full of colors if and only if all of the\nfollowing conditions are true:</p>\n<ul>\n<li>There are as many red balls as green balls.</li>\n<li>There are as many yellow balls as blue balls.</li>\n<li>Difference between the number of red balls and green balls in every prefix of the sequence is at most 1.</li>\n<li>Difference between the number of yellow balls and blue balls in every prefix of the sequence is at most 1.</li>\n</ul>\n<p>Your task is to write a program, which for a given sequence prints <code>True</code> if it is full of colors, otherwise it prints <code>False</code>.</p>\n</blockquote>\n<p>My solution so far is:</p>\n<pre><code>module Main where\n\nimport Control.Monad\n\nmain = do\n  s &lt;- readLn :: IO Int\n  elements &lt;- replicateM s getLine\n  let result = map checkColours elements\n  mapM (putStrLn . show) result\n\ncheckColours :: String -&gt; Bool\ncheckColours string = isFullOfColors 0 0 0 0 string\n\nisFullOfColors :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; String -&gt; Bool\nisFullOfColors red green yellow blue string\n  | (abs (red - green)) &gt; 1 = False\n  | (abs (yellow - blue)) &gt; 1 = False\n  | (string == []) = if (red /= yellow) || (green /= blue) then True else False\n  | (head string == 'R' ) = isFullOfColors (red + 1) green yellow blue (tail string)\n  | (head string == 'G' ) = isFullOfColors red  (green + 1) yellow blue (tail string)\n  | (head string == 'Y' ) = isFullOfColors red green (yellow + 1) blue (tail string)\n  | (head string == 'B' ) = isFullOfColors red green yellow  (blue + 1) (tail string)\n</code></pre>\n<p>But it fails on the input <code>&quot;RYBG&quot;</code>, returning <code>False</code> instead of <code>True</code>.</p>\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell", "lambda", "scope", "anonymous-function"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1444149218, "post_id": 32972877, "comment_id": 53775200, "body": "just curious: are you trying to understand someone&#39;s homework?"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "edited": false, "score": 1, "creation_date": 1444190125, "post_id": 32973267, "comment_id": 53792137, "body": "This is great.  The explanation of q was particularly helpful. Thank you!"}], "tags": [], "owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "is_accepted": false, "score": 0, "last_activity_date": 1444143651, "creation_date": 1444143651, "answer_id": 32973267, "question_id": 32972877, "link": "https://stackoverflow.com/questions/32972877/variable-scope-in-a-higher-order-lambda-function/32973267#32973267", "title": "Variable scope in a higher-order lambda function", "body": "<p><code>zip :: [a] -&gt; [b] -&gt; [(a,b)]</code> takes two lists and joins them into pairs, dropping any remaining at the end. </p>\n\n<p><code>any :: (a -&gt; Bool) -&gt; [a] -&gt; Bool</code> takes a function and a list of <code>a</code>s and then returns <code>True</code> if any of the values returned true or not. </p>\n\n<p>So <code>colDist</code> and <code>q</code> are the first and second elements of the pairs in the list made by <code>zip [1..] qs</code>, and they are bound when they are applied to the pair by <code>any</code>.</p>\n\n<p><code>q</code> is only bound within the body of the lambda function - this is the same as with lambda calculus. Since <code>try</code> was bound before in the function definition, it is still available in this inner scope. If you think of lambda calculus, the term <code>\\x.\\y.x+y</code> makes sense, despite the <code>x</code> and the <code>y</code> being bound at different times.</p>\n\n<p>As for the design approach, this approach is much cleaner than trying to iterate or recurse through the list manually. It seems quite clear in its intentions to me (with respect to the larger codebase it comes from).</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "edited": false, "score": 0, "creation_date": 1444184917, "post_id": 32975198, "comment_id": 53790859, "body": "Nice, clear explanation. By the time i read &quot;well, simple&quot;, I would agree because of how you laid out the logic.  Thank you."}, {"owner": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "edited": false, "score": 0, "creation_date": 1444189921, "post_id": 32975198, "comment_id": 53792086, "body": "Is this a fair synthesis? This approach to designing a higher-order function allows the invoking code to change how f behaves AND invoke the higher-order function with a list that requires additional processing prior to being used to invoke f for every element in the list.    Encapsulating the list processing (in this case with zip) seems the right thing to do, but is the intent of this additional processing really clear in the original one-liner above?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "edited": false, "score": 0, "creation_date": 1444209343, "post_id": 32975198, "comment_id": 53801305, "body": "What additional processing? <code>zip</code> does its processing as always, the result of which is passed to <code>any</code>. And <code>any</code> doesn&#39;t do any additional processing \u2014 it just does very simple bookkeeping: the first time <code>f</code> returns <code>True</code>, it also returns <code>True</code> and stops analysing the rest of the list. I will edit the answer and explain the mechanism of <code>any</code> in a bit more detail for you."}, {"owner": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "edited": false, "score": 0, "creation_date": 1444591476, "post_id": 32975198, "comment_id": 53956479, "body": "Thank you Erik.  You have clarified my misunderstanding.  I realize part of what threw me off the intent of the code was the use of brackets to define the anonymous function (and the first argument to any), with the use of $ for the second argument for any.  sameDiag try qs = any $ &#40;colDist,q) -&gt; abs (try - q) == colDist  (zip [1..] qs) works, as does sameDiag try qs = any (\\&#40;colDist,q) -&gt; abs (try - q) == colDist)  (zip [1..] qs).  This last version would have been my preferred somehow."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "edited": false, "score": 0, "creation_date": 1444596120, "post_id": 32975198, "comment_id": 53957950, "body": "I&#39;m glad I was of use! If an answer solved your issue or answered your question, you ought to accept it! As to the rest of the comment, I find it very hard to parse text with non-monospaced, or at least quoted code snippets sprinkled in."}, {"owner": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "edited": false, "score": 0, "creation_date": 1444615319, "post_id": 32975198, "comment_id": 53962338, "body": "I know what you mean and figured out how to do in the comment.  Here is the code:  <code>sameDiag try qs = any $ (colDist,q) -&gt; abs (try - q) == colDist (zip [1..] qs) </code> works, as does <code>sameDiag try qs = any (\\(colDist,q) -&gt; abs (try - q) == colDist) (zip [1..] qs)</code>    This last version would have been my preferred to better highlight the two arguments for <code>any</code>.  It may be too much hand-holding, but given the flexibility in Haskell, I was caught looking for more in the code than what was there."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 0, "last_activity_date": 1444210541, "last_edit_date": 1444210541, "creation_date": 1444149548, "answer_id": 32975198, "question_id": 32972877, "link": "https://stackoverflow.com/questions/32972877/variable-scope-in-a-higher-order-lambda-function/32975198#32975198", "title": "Variable scope in a higher-order lambda function", "body": "\n\n<p>The function <strong><code>any</code></strong> is a <a href=\"https://en.wikipedia.org/wiki/Higher-order_function\" rel=\"nofollow\">higher-order function</a> that takes 2 arguments:</p>\n\n<ul>\n<li>the <strong>1st argument</strong> is of type <code>a -&gt; Bool</code>, i.e. a function from <code>a</code> to <code>Bool</code></li>\n<li>the <strong>2nd argument</strong> is of type <code>[a]</code>, i.e. a list of items of type <code>a</code>;</li>\n</ul>\n\n<p>i.e. the <strong>1st argument</strong> is a function that takes any element from the list passed as the <strong>2nd argument</strong>, and returns a <code>Bool</code> based on that element. (well it can take any values of type <code>a</code>, not just the ones in that list, but it's quite obviously certain that <code>any</code> won't be invoking it with some arbitrary values of <code>a</code> but the ones from the list.)</p>\n\n<hr>\n\n<p>You can then simplify thinking about the original snippet by doing a slight refactoring:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sameDiag :: Int -&gt; [Int] -&gt; Bool\nsameDiag try qs = any f xs\n  where\n    xs = zip [1..] qs\n    f = (\\(colDist, q) -&gt; abs (try - q) == colDist)\n</code></pre>\n\n<p>which can be transformed into</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sameDiag :: Int -&gt; [Int] -&gt; Bool\nsameDiag try qs = any f xs\n  where\n    xs = zip [1..] qs\n    f (colDist, q) = abs (try - q) == colDist)\n</code></pre>\n\n<p>which in turn can be transformed into</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sameDiag :: Int -&gt; [Int] -&gt; Bool\nsameDiag try qs = any f xs\n  where\n    xs = zip [1..] qs\n    f pair = abs (try - q) == colDist) where (colDist, q) = pair\n</code></pre>\n\n<p><em>(Note that <code>sameDiag</code> could also have a more general type <code>Integral a =&gt; a -&gt; [a] -&gt; Bool</code> rather than the current monomorphic one)</em></p>\n\n<p>\u2014 so how does the <code>pair</code> in <code>f pair = ...</code> get bound to a value? well, simple: it's just a function; whoever calls it must pass along a value for the <code>pair</code> argument. \u2014 when calling <code>any</code> with the first argument set to <code>f</code>, it's the invocation of the function <code>any</code> who's doing the calling of <code>f</code>, with individual elements of the list <code>xs</code> passed in as values of the argument <code>pair</code>.</p>\n\n<p>and, since the contents of <code>xs</code> is a list of pairs, it's OK to pass an individual pair from this list to <code>f</code> as <code>f</code> expects it to be just that.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> a further explanation of <code>any</code> to address the asker's comment:</p>\n\n<blockquote>\n  <p>Is this a fair synthesis? This approach to designing a higher-order function allows the invoking code to change how f behaves AND invoke the higher-order function with a list that requires additional processing prior to being used to invoke f for every element in the list. Encapsulating the list processing (in this case with zip) seems the right thing to do, but is the intent of this additional processing really clear in the original one-liner above?</p>\n</blockquote>\n\n<p>There's really no additional <em>processing</em> done by <code>any</code> prior to invoking <code>f</code>. There is just very minimalistic bookkeeping in addition to simply iterating through the passed in list <code>xs</code>: invoking <code>f</code> on the elements during the iteration, and immediately breaking the iteration and returning <code>True</code> the first time <code>f</code> returns <code>True</code> for any list element.</p>\n\n<p>Most of the behavior of <code>any</code> is \"implicit\" though in that it's taken care of by Haskell's lazy evaluation, basic language semantics as well as existing functions, which <code>any</code> is composed of (well at least my version of it below, <code>any'</code> \u2014 I haven't taken a look at the built-in <code>Prelude</code> version of <code>any</code> yet but I'm sure it's not much different; just probably more heavily optimised).</p>\n\n<p>In fact, <code>any</code> is simple it's almost trivial to re-implement it with a one liner on a GHCi prompt:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; let any' f xs = or (map f xs)\n</code></pre>\n\n<p>let's see now what GHC computes as its type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; :t any'\nany' :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>\u2014 same as the built-in <code>any</code>. So let's give it some trial runs:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; any' odd [1, 2, 3]  -- any odd values in the list?\nTrue\nPrelude&gt; any' even [1, 3]    -- any even ones?\nFalse\nPrelude&gt; let adult = (&gt;=18)\nPrelude&gt; any' adult [17, 17, 16, 15, 17, 18]\n</code></pre>\n\n<p>\u2014 see how you can sometimes write code that almost looks like English with higher-order functions?</p>\n"}], "owner": {"reputation": 355, "user_id": 5405669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZH6x.jpg?s=128&g=1", "display_name": "Edmund&#39;s Echo", "link": "https://stackoverflow.com/users/5405669/edmunds-echo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "accepted_answer_id": 32975198, "answer_count": 2, "score": 0, "last_activity_date": 1444211538, "creation_date": 1444142608, "last_edit_date": 1444211538, "question_id": 32972877, "link": "https://stackoverflow.com/questions/32972877/variable-scope-in-a-higher-order-lambda-function", "title": "Variable scope in a higher-order lambda function", "body": "<p>In working through a solution to the 8 Queens problem, a person used the following line of code:</p>\n\n<pre><code>sameDiag try qs = any (\\(colDist,q) -&gt; abs (try - q) == colDist) $ zip [1..] qs\n</code></pre>\n\n<p><code>try</code> is an an item; <code>qs</code> is a list of the same items.</p>\n\n<ol>\n<li><p>Can someone explain how <code>colDist</code> and <code>q</code> in the lambda function get bound to anything?</p></li>\n<li><p>How did <code>try</code> and <code>q</code> used in the body of lambda function find their way into the same scope?</p></li>\n<li><p>To the degree this is a Haskell idiom, what problem does this design approach help solve?</p></li>\n</ol>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1444141479, "post_id": 32972414, "comment_id": 53769888, "body": "Instead of asking what the last line matches, <i>very carefully</i> say what the first two lines match. Reveal itself, the answer will."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444146938, "post_id": 32972414, "comment_id": 53773781, "body": "For the sake of clarity, it really should be written <code>listSet1 [] _ _ = []</code>. There are very good reasons to avoid &quot;catch-all&quot; patterns in most cases--they tend to make code harder to understand and can lead to silent breakage when type definitions change. They make sense when one or two constructors need to change and multiple others pass through."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5414435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a233e05fd1489358e277f8b2e16941?s=128&d=identicon&r=PG&f=1", "display_name": "user124659", "link": "https://stackoverflow.com/users/5414435/user124659"}, "edited": false, "score": 0, "creation_date": 1444142122, "post_id": 32972482, "comment_id": 53770347, "body": "Thanks! After commenting that line out, I see it&#39;s catch all statement."}], "tags": [], "owner": {"reputation": 34465, "user_id": 12274, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/98e72a0366a5d8e0a4a5df9ecd1933db?s=128&d=identicon&r=PG&f=1", "display_name": "JB.", "link": "https://stackoverflow.com/users/12274/jb"}, "is_accepted": true, "score": 2, "last_activity_date": 1444141515, "creation_date": 1444141515, "answer_id": 32972482, "question_id": 32972414, "link": "https://stackoverflow.com/questions/32972414/replacing-a-list-element-by-pattern-matching/32972482#32972482", "title": "Replacing a list element by pattern matching", "body": "<p>The last pattern handles the end of the list. You won't notice it unless you try and replace an index not present in the list (try it!)</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1444147674, "creation_date": 1444147674, "answer_id": 32974624, "question_id": 32972414, "link": "https://stackoverflow.com/questions/32972414/replacing-a-list-element-by-pattern-matching/32974624#32974624", "title": "Replacing a list element by pattern matching", "body": "<p>You can and should add one of the following lines to the top of every Haskell file: <code>{-# OPTIONS_GHC -Wall #-}</code> or <code>{-# OPTIONS_GHC -fwarn-incomplete-patterns #-}</code>. These go above the <code>module Foo where</code> line if you have one of those. With one of these in place, commenting out that last pattern will give you a warning saying exactly what is not matched.</p>\n"}], "owner": {"reputation": 15, "user_id": 5414435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a233e05fd1489358e277f8b2e16941?s=128&d=identicon&r=PG&f=1", "display_name": "user124659", "link": "https://stackoverflow.com/users/5414435/user124659"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 1, "accepted_answer_id": 32972482, "answer_count": 2, "score": 0, "last_activity_date": 1444147674, "creation_date": 1444141301, "last_edit_date": 1444147329, "question_id": 32972414, "link": "https://stackoverflow.com/questions/32972414/replacing-a-list-element-by-pattern-matching", "title": "Replacing a list element by pattern matching", "body": "<p>This function takes list, index number, and a replacement string. It goes through the list and replaces the element at the given index with the replacement string. What I'm not sure of is what case the pattern in the last line is trying to catch.</p>\n\n<pre><code>-- e.g., listSet1 [\"a\",\"x\",\"k\"] 2 \"d\" = [\"a\", \"d\",\"k\"]\nlistSet1 (x:xs) 1 y = y:xs\nlistSet1 (x:xs) n y = x : listSet1 xs (n-1) y\nlistSet1 xs _ _ = xs\n</code></pre>\n"}, {"tags": ["list", "haskell", "return", "perfect-numbers"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1444138469, "post_id": 32971332, "comment_id": 53767563, "body": "Try to give your function a type. If you don&#39;t know Haskell types (yet), what would be the type of the Java function? <code>static int[] listX(int)</code>? Also, try to figure out what <code>listX</code> should return. What should <code>listX</code> return on <code>1</code>? What should <code>listX</code> return on <code>2</code>? This can already give you some grasps how to implement <code>listX</code> later."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1444141623, "last_edit_date": 1444141623, "creation_date": 1444140072, "answer_id": 32971978, "question_id": 32971332, "link": "https://stackoverflow.com/questions/32971332/haskell-defining-result-as-a-list-and-returning-null/32971978#32971978", "title": "Haskell - Defining result as a list and returning null", "body": "<p>Your main problem seems to be that you still think imperative (with the <code>insert</code>) - also <code>()</code> is the value <em>unit</em> - you probably wanted to write <code>[]</code> (the empty list) instead - but still the <code>xs</code> here is totally undefined so you would have to fix this too (and I don't see how to be honest).</p>\n\n<h2>perfect numbers</h2>\n\n<p>I think I can see a basic idea in there, and I think the best way to fix this is to go full list-comprehension (as you seem to understand them quite well) - here is a version that should work:</p>\n\n<pre><code>listX n = [ x | x &lt;- [1..n], sum [ y | y &lt;- [1..x-1], x `mod` y == 0] == x]\n</code></pre>\n\n<p>As you can see I changed this a bit - first I check all <code>x</code> from <code>1</code> to <code>n</code> if they could be perfect - and I do this by checking by summing up all proper divisors and checking if the sum is equal to <code>x</code> (that's the job of the <code>sum [...] == x</code> part) - in case you don't know this works because you can add guards to list comprehensions (the <code>sum [..] == x</code> filters out all values of <code>x</code> where this is true).</p>\n\n<h3>a nicer version</h3>\n\n<p>to make this a bit more readable (and separate the concerns) I would suggest writing it that way:</p>\n\n<pre><code>properDivisors :: Integer -&gt; [Integer]\nproperDivisors n = [ d | d &lt;- [1..n-1], n `mod` d == 0]\n\nisPerfect :: Integer -&gt; Bool\nisPerfect n = sum (properDivisors n) == n\n\nperfectNumbers :: [Integer]\nperfectNumbers = filter isPerfect [1..]\n\nperfectNumbersUpTo :: Integer -&gt; [Integer]\nperfectNumbersUpTo n = takeWhile (&lt;= n) perfectNumbers\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4125609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/283fcdedc20df2dfb9dcd27e47fe1a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Medeiros", "link": "https://stackoverflow.com/users/4125609/rodrigo-medeiros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444141623, "creation_date": 1444138300, "question_id": 32971332, "link": "https://stackoverflow.com/questions/32971332/haskell-defining-result-as-a-list-and-returning-null", "title": "Haskell - Defining result as a list and returning null", "body": "<pre><code>listX n = xs\nif sum[x | x &lt;- [2, 4..n-1], y &lt;- [1..n-1], y `rem` x == 0] == y\n    then insert y xs\n    else return ()\n</code></pre>\n\n<p>Alright, first time trying to work with Haskell, and only having novice Java knowledge has led to some problems. \nWhat I was trying to do, was to define the result of the function listX n as a list called xs.\nMy idea was that the program would grab every number of from 1 to n, and check if it was equal to the sum of its positive divisors.\nClearly, I have failed horribly and need help, pointers to concepts I haven't understood is extremely appreciated.</p>\n"}, {"tags": ["haskell", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 84157, "user_id": 238978, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a633afaf19e6d4bb53ee50b62e3b5397?s=128&d=identicon&r=PG", "display_name": "Emil Vikstr&#246;m", "link": "https://stackoverflow.com/users/238978/emil-vikstr%c3%b6m"}, "is_accepted": false, "score": 3, "last_activity_date": 1444124161, "creation_date": 1444124161, "answer_id": 32966554, "question_id": 32966391, "link": "https://stackoverflow.com/questions/32966391/use-list-comprehension-to-return-number-of-integers-which-contain-a-digit/32966554#32966554", "title": "Use list comprehension to return number of integers which contain a digit", "body": "<p>Use <code>checkDigits</code> and <code>split</code> in <code>countD</code>. This is how you count the number of integers that contains the digit (two, in your example):</p>\n\n<pre><code>countD intL a = length [y | y &lt;- intL, (checkDigits (split y) a) &gt; 0]\n</code></pre>\n\n<p>And here is how you count the total times the digit appears (three in your example):</p>\n\n<pre><code>countD intL a = sum [checkDigits (split y) a | y &lt;- intL]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5187407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IYk-mgFHjzM/AAAAAAAAAAI/AAAAAAAAAGk/pO1hdqFW9ME/photo.jpg?sz=128", "display_name": "Creevey", "link": "https://stackoverflow.com/users/5187407/creevey"}, "edited": false, "score": 0, "creation_date": 1444175747, "post_id": 32968442, "comment_id": 53788697, "body": "Apologies I tried my best to explain it. The correct way was that it should count how many time the actual digit appears in the list.  e.g. count [102,45,256,24] 2 would return 3. This is because the digit &#39;2&#39; appeared three times in the list."}, {"owner": {"reputation": 43, "user_id": 5187407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IYk-mgFHjzM/AAAAAAAAAAI/AAAAAAAAAGk/pO1hdqFW9ME/photo.jpg?sz=128", "display_name": "Creevey", "link": "https://stackoverflow.com/users/5187407/creevey"}, "edited": false, "score": 0, "creation_date": 1444176567, "post_id": 32968442, "comment_id": 53788922, "body": "[Update] I actually re-read over the brief and realised that I had misread what it said and your first point was actually correct. Apologies about that. Also could you explain the benefit of defining number, digit and count as type Int? could you not just use count:: [Int] -&gt; Int -&gt; Int?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 43, "user_id": 5187407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IYk-mgFHjzM/AAAAAAAAAAI/AAAAAAAAAGk/pO1hdqFW9ME/photo.jpg?sz=128", "display_name": "Creevey", "link": "https://stackoverflow.com/users/5187407/creevey"}, "edited": false, "score": 1, "creation_date": 1444208606, "post_id": 32968442, "comment_id": 53800809, "body": "Yes, you&#39;re right: you could use <code>[Int] -&gt; Int -&gt; Int</code> which is also why I added the comment <code>-- these are optional</code> above the aliases :) They&#39;re just for readability because <code>Int</code> is not very descriptive. In a language such as Agda or Idris, you would use much more constrained (and thus descriptive) data types and not just type aliases: the return type would be <code>Nat</code>, and <code>Digit</code> would be <code>Fin 10</code> (which is a <code>Nat</code> with an upper bound of <code>10</code>); it could even return a proof that the return value is <code>&lt;= length xs</code> etc :)"}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 3, "last_activity_date": 1444131504, "last_edit_date": 1444131504, "creation_date": 1444129748, "answer_id": 32968442, "question_id": 32966391, "link": "https://stackoverflow.com/questions/32966391/use-list-comprehension-to-return-number-of-integers-which-contain-a-digit/32968442#32968442", "title": "Use list comprehension to return number of integers which contain a digit", "body": "<p>Your question is ambiguous about what the <code>count</code> function should do precisely. At the beginning you say</p>\n\n<blockquote>\n  <p>the number of integers in the list which contain the digit </p>\n</blockquote>\n\n<p>whereas later on you say</p>\n\n<blockquote>\n  <p><code>count [22] 2</code> /.../ should return 2</p>\n</blockquote>\n\n<p>which is <em>not</em> the number of integers that contain the digit <code>2</code> in <code>[22]</code> \u2014 there is only one integer in that list, so you should return 1, regardless of the fact that this integer contains the digit <code>2</code> twice.</p>\n\n<p>Therefore, I've provided solutions to both possibilities below.</p>\n\n<hr>\n\n<p>For the first possibility, this solution is the shortest I could come up with:</p>\n\n<pre><code>-- these are optional\ntype Digit  = Int\ntype Number = Int\ntype Count  = Int\n\ncount :: [Number] -&gt; Digit -&gt; Count\ncount xs d = sum [count' x | x &lt;- xs]  -- same as `sum $ map count' xs`\n  where count' x = if d' `elem` show x then 1 else 0\n        d':[] = show d\n</code></pre>\n\n<p>If, however, the 2nd possibility is indeed correct and <code>count [22] 2</code> should return <code>2</code>, then change the <code>count'</code> helper function accordingly:</p>\n\n<pre><code>count :: [Number] -&gt; Digit -&gt; Count\ncount xs d = sum [count' x | x &lt;- xs]\n  where count' i = length $ filter (== d') (show i)\n        d':[] = show d\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 3, "creation_date": 1444130942, "post_id": 32968676, "comment_id": 53762179, "body": "How about <code>countDigits xs d = sum [1 | n &lt;- concat $ map show xs, n == d&#39;] where d&#39;:[] = show d</code> if you want to pass in the digit and convert it from <code>Int</code> to <code>Char</code> as in my solution."}, {"owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444131387, "post_id": 32968676, "comment_id": 53762464, "body": "Thanks Allik, that took me a minute to understand though."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444131566, "post_id": 32968676, "comment_id": 53762583, "body": "Well and it has the advantage of requiring <code>d</code> to be a single-digit integer because otherwise <code>d&#39;:[]</code> will fail to match the result. Ideally though, instead of using <code>Int</code> to specify a <code>Digit</code>, there&#39;d be a separate <code>Digit</code> type (not an alias) whose constructors are the digits 0 to 9, but in a non-dependently-typed language this won&#39;t look ideal."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 4, "creation_date": 1444133659, "post_id": 32968676, "comment_id": 53764034, "body": "You can also use the fact that the List monad uses <code>concatMap</code> as <code>&gt;&gt;=</code> to write the even less comprehensible <code>sum [1 | n &lt;- show =&lt;&lt; xs, n == d]</code>."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1444133692, "post_id": 32968676, "comment_id": 53764058, "body": "I&#39;d suggest adding a type signature, as your solution (correctly) has a slightly different type than the examples in the question."}, {"owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1444134933, "post_id": 32968676, "comment_id": 53764952, "body": "How&#39;s it slightly different? <code>[Int] -&gt; Int -&gt; Int</code> is what I got. @rampion."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1444179312, "post_id": 32968676, "comment_id": 53789553, "body": "Ori: <code>n == d</code> constrains <code>n</code> and <code>d</code> to be of the same type. Since <code>n</code> is a <code>Char</code>, so must <code>d</code> be.   I suspect you meant to do <code>n == d&#39;</code> to get <code>[Int] -&gt; Int -&gt; Int</code>."}, {"owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "edited": false, "score": 0, "creation_date": 1444197200, "post_id": 32968676, "comment_id": 53794443, "body": "Thanks for the catch.  Updated"}], "tags": [], "owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "is_accepted": true, "score": 5, "last_activity_date": 1444197076, "last_edit_date": 1444197076, "creation_date": 1444130568, "answer_id": 32968676, "question_id": 32966391, "link": "https://stackoverflow.com/questions/32966391/use-list-comprehension-to-return-number-of-integers-which-contain-a-digit/32968676#32968676", "title": "Use list comprehension to return number of integers which contain a digit", "body": "<p>Best I could do. <strike>I'd appreciate if someone showed me how to pass the integer <code>2</code> digit as an argument rather than it hard coded</strike>.</p>\n\n<p>Thanks Erik for your answer.</p>\n\n<pre><code>countDigits :: [Int] -&gt; Int -&gt; Int\ncountDigits xs d = sum [1 | n &lt;- (concat . map show) xs, n == d']\n    where d':[] = show d\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5187407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IYk-mgFHjzM/AAAAAAAAAAI/AAAAAAAAAGk/pO1hdqFW9ME/photo.jpg?sz=128", "display_name": "Creevey", "link": "https://stackoverflow.com/users/5187407/creevey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1538, "favorite_count": 0, "accepted_answer_id": 32968676, "answer_count": 3, "score": 1, "last_activity_date": 1569483648, "creation_date": 1444123721, "last_edit_date": 1569483648, "question_id": 32966391, "link": "https://stackoverflow.com/questions/32966391/use-list-comprehension-to-return-number-of-integers-which-contain-a-digit", "title": "Use list comprehension to return number of integers which contain a digit", "body": "<p>For an assignment I have been asked to re-write the following function using list comprehension. This function takes in a list of integers and an integer digit <code>a</code> and returns the number of integers in the list which contain the digit <code>a</code>.</p>\n\n<p>e.g.</p>\n\n<pre><code>count [102,41,256] 2 \n</code></pre>\n\n<p>Should return <code>2</code></p>\n\n<pre><code>count [98,4,376] 2\n</code></pre>\n\n<p>Should return <code>0</code></p>\n\n<p>This is what I have for the non-list comprehension function:</p>\n\n<pre><code>split :: Int -&gt; [Int]\nsplit 0 = []\nsplit x = split (div x 10) ++ [rem x 10]\n\ncheckDigits :: [Int] -&gt; Int -&gt; Int\ncheckDigits [] y = 0\ncheckDigits (x:xs) y\n    | x == y = 1 + (checkDigits xs y)\n    | otherwise = checkDigits xs y\n\ncount :: [Int] -&gt; Int -&gt; Int\ncount [] a = 0\ncount (x:xs) a \n    | (checkDigits (split x) a) &gt; 0 = (checkDigits (split x) a) + (count xs a) \n    | otherwise = count xs a\n</code></pre>\n\n<p>Split will take in an integer and return the integer in a list</p>\n\n<pre><code>split 321    will return:    [3,2,1]\n</code></pre>\n\n<p><code>checkDigits</code> counts the number of times that a digit appears in an integer (this was to solve an error where <code>count [22] 2</code> would return as <code>0</code> when it should return <code>2</code>)</p>\n\n<pre><code>e.g. the digit '2' appears 4 times in the list [2,65,42,22]\n</code></pre>\n\n<p>Finally in count we use <code>checkDigits</code> to check if any of the digits in <code>x</code> are equal to <code>a</code>, if this number is greater than 0 (1 or more are equal to a) then add the number of digits found and call again.</p>\n\n<p>I am new to list comprehensions and have only managed to get it to work if the number in the list is equal to <code>a</code>:</p>\n\n<pre><code>countD :: [Int] -&gt; Int -&gt; Int\ncountD intL a = length [y | y &lt;- intL, y == a]\n</code></pre>\n\n<p>Here <code>countD [2,3,4,22] 2</code> returns <code>1</code>l how do I change what I have so that it will return <code>3</code> (as there are 3 <code>2</code>'s in the list).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 1, "creation_date": 1529542557, "post_id": 32961985, "comment_id": 88915095, "body": "Despite being a simple typographical error this error message doesn&#39;t point to it.  This question should stay as that error message is searchable and is useful to others."}], "answers": [{"tags": [], "owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "is_accepted": true, "score": 12, "last_activity_date": 1444107500, "creation_date": 1444107500, "answer_id": 32962029, "question_id": 32961985, "link": "https://stackoverflow.com/questions/32961985/error-message-perhaps-you-intended-to-use-templatehaskell/32962029#32962029", "title": "Error Message &quot;Perhaps you intended to use TemplateHaskell &quot;", "body": "<p>Those look like quotes (') and not back ticks (`) to me, which is why the compiler is confused.  The infix expression uses the back ticks (left of 1 on most keyboards).</p>\n"}], "owner": {"reputation": 1105, "user_id": 4402169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PSVFa.jpg?s=128&g=1", "display_name": "Gautam", "link": "https://stackoverflow.com/users/4402169/gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4625, "favorite_count": 0, "closed_date": 1444119672, "accepted_answer_id": 32962029, "answer_count": 1, "score": 1, "last_activity_date": 1444107500, "creation_date": 1444107180, "question_id": 32961985, "link": "https://stackoverflow.com/questions/32961985/error-message-perhaps-you-intended-to-use-templatehaskell", "closed_reason": "Not suitable for this site", "title": "Error Message &quot;Perhaps you intended to use TemplateHaskell &quot;", "body": "<p>I tried to use to infix expression for div function as follows:</p>\n\n<pre><code>92 'div' 10\n</code></pre>\n\n<hr>\n\n<p>The following error message popped out:\nSyntax error on 'div'\nPerhaps you intended to use TemplateHaskell\nIn the Template Haskell Quotation 'div'</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1444114359, "post_id": 32960539, "comment_id": 53751753, "body": "You appear to have added another question to this question. Please remove it from here and make another question with it in."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1444117304, "post_id": 32960539, "comment_id": 53753356, "body": "Two hints. You currently use tail recursion and an accumulator which you grow on the right: it would be cleaner to grow directly on the left of the result of a (non-tail-) recursive call. You currently use <code>map head</code> and <code>map tail</code> to take whole lists of things apart: it might be better to use <code>zipWith (:)</code> to put whole lists of things together."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1444132726, "post_id": 32960539, "comment_id": 53763386, "body": "@pigworker ... like this one: <a href=\"https://stackoverflow.com/questions/32944035/exception-prelude-head-empty-list-what-is-the-base-case/32944488#32944488\" title=\"exception prelude head empty list what is the base case\">stackoverflow.com/questions/32944035/&hellip;</a> ? ^^"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1444139920, "post_id": 32960539, "comment_id": 53768676, "body": "@Carsten Aye. (Using the ZipList applicative structure) By the power of Control.Newtype, there&#39;s a three word solution..."}, {"owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444260185, "post_id": 32960539, "comment_id": 53832949, "body": "@Carsten That is also my question but since I want it tail recursion so I open another question here."}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1488876261, "post_id": 32960539, "comment_id": 72414469, "body": "thanks for the answer, it helped me!"}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 0, "creation_date": 1444098122, "post_id": 32960617, "comment_id": 53746469, "body": "Thanks for answering. I have my solution now but it is not elegant could you show me your way to do it?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 2, "creation_date": 1444098691, "post_id": 32960617, "comment_id": 53746621, "body": "@katharineKim That sounds like a great follow-up question! Feel free to ask, along with relevant details, e.g. the inelegant code and what you dislike about it, in a freshly opened question. I would suggest the code review stack exchange, except that it doesn&#39;t seem to be very well populated; perhaps asking here at StackOverflow would not be <i>too</i> off-topic, if you give a clear description of what you want to fix about your code."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1444132686, "post_id": 32960617, "comment_id": 53763348, "body": "that would be the 3rd question (I know of) about the same function ;)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1444097241, "creation_date": 1444097241, "answer_id": 32960617, "question_id": 32960539, "link": "https://stackoverflow.com/questions/32960539/matrix-transpose-with-tail-recursion-runs-forever/32960617#32960617", "title": "Matrix Transpose with Tail Recursion Runs Forever", "body": "<p>In this clause:</p>\n\n<pre><code>transpose'' m acc = transpose'' (map tail m) (acc ++ [map head m])\n</code></pre>\n\n<p>We know if we reach this clause, then <code>m /= []</code>. Observe that <code>map tail m</code> has the same length as <code>m</code>, hence in particular <em>cannot</em> be <code>[]</code>, no matter what <code>m</code> is. Therefore the recursion cannot terminate.</p>\n\n<p>To deal with this, you have a couple of options; one is to prune away empty sublists, and another is to use the first clause to check that all sublists are empty instead of checking that the list itself is empty. In either case, you will likely need to be more graceful about accepting lists with empty sublists; <code>tail</code> and <code>head</code> are bad functions to call on empty lists.</p>\n"}], "owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 32960617, "answer_count": 1, "score": 3, "last_activity_date": 1444131286, "creation_date": 1444096666, "last_edit_date": 1444131286, "question_id": 32960539, "link": "https://stackoverflow.com/questions/32960539/matrix-transpose-with-tail-recursion-runs-forever", "title": "Matrix Transpose with Tail Recursion Runs Forever", "body": "<p>I am working on the transpose with matrix transpose but this wants to run forever.  What am I doing wrong here?</p>\n\n<pre><code>transpose'' :: [[Int]] -&gt; [[Int]] -&gt; [[Int]]\ntranspose'' [] acc = acc\ntranspose'' m acc = transpose'' (map tail m) (acc ++ [map head m])\n\ntranspose' m = transpose'' m []\n</code></pre>\n\n<hr>\n\n<p>Now I have a check for empty sublist, but is there a more elegant way to do it?</p>\n\n<pre><code>transpose' :: [[Int]] -&gt; [[Int]]\ncheck m\n    |head m == [] = []\n    |otherwise    = m\ntranspose'' [] acc = acc\ntranspose'' m acc = transpose'' (check (map tail m)) (acc ++ [map head m])\ntranspose' m = transpose'' m []\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 5298455, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zEzWj_qaO7I/AAAAAAAAAAI/AAAAAAAAACw/A7lGVwEZUYs/photo.jpg?sz=128", "display_name": "Emanuel Borsboom", "link": "https://stackoverflow.com/users/5298455/emanuel-borsboom"}, "edited": false, "score": 1, "creation_date": 1444144033, "post_id": 32960404, "comment_id": 53771751, "body": "Related: there was just a discussion in the Stack issue tracker about caching extra-deps: <a href=\"https://github.com/commercialhaskell/stack/issues/1029\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/1029</a>.  Using a <a href=\"https://github.com/commercialhaskell/stack/wiki/Custom-Snapshot\" rel=\"nofollow noreferrer\">custom snapshot</a> may help."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1444095641, "creation_date": 1444095641, "answer_id": 32960404, "question_id": 32959661, "link": "https://stackoverflow.com/questions/32959661/how-to-avoid-needless-rebuilds-with-stack/32960404#32960404", "title": "How to avoid needless rebuilds with stack?", "body": "<p>My understanding is that once you have selected a resolver, stack will \"cache\" a package if:</p>\n\n<ol>\n<li>The package is in Stackage for the resolver, and</li>\n<li>The package is built with exactly the same set of dependency-versions specified by the resolver.</li>\n</ol>\n\n<p>The package-versions selected by the resolver LTS-2.15 may be found on this page:</p>\n\n<p><a href=\"https://www.stackage.org/lts-2.15\" rel=\"nofollow\">https://www.stackage.org/lts-2.15</a></p>\n\n<p>The \"cache\" on your machine for the resolver LTS-2.15 is located in a directory like:</p>\n\n<pre><code>~/.stack/snapshots/x86_64-osx/lts-2.15/7.8.4/pkgdb\n</code></pre>\n\n<p>For instance, your project uses <code>blaze-builder-0.4.0.1</code> which is in Stackage LTS-2.15. However, <code>blaze-builder</code> depends on <code>text</code>, and if you were using the version of <code>text</code> in LTS-2.15 (namely <code>text-1.2.0.6</code>) then stack would cache <code>blaze-builder-0.4.0.1</code> in the LTS-2.15 snapshot directory (assuming all of the other dependencies for <code>blaze-builder</code> matched the versions in LTS-2.15.) However, since you have specified version 1.1.1.4 for <code>text</code>, stack will not save the resulting <code>blaze-builder</code> in the LTS-2.15 snapshot directory. It will be saved in the <code>.stack-work</code> directory for the project.</p>\n\n<p>Since so many packages depend on <code>text</code>, my recommendation would be to use a version of <code>text</code> which is listed in a Stackage resolver.</p>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444095641, "creation_date": 1444089142, "last_edit_date": 1444092690, "question_id": 32959661, "link": "https://stackoverflow.com/questions/32959661/how-to-avoid-needless-rebuilds-with-stack", "title": "How to avoid needless rebuilds with stack?", "body": "<p>Stack usually caches package dependency builds to save time in future builds, but I've noticed many cases in practice where this doesn't happen.  When it works, it can be a huge time-saver, as building dependencies can often take like half an hour or more.</p>\n\n<p>After some work I've been able to isolate a simple example which illustrates this problem, and was wondering if someone could help me fix it.  Note, this problem only refers to new builds, like after a clone....  The second build of the same clone does in fact go quickly.</p>\n\n<hr>\n\n<p>If I compile this very simple Main.hs</p>\n\n<pre><code>import Network.Haskoin.Internals\n\nmain = undefined\n</code></pre>\n\n<p>using this stack.yaml</p>\n\n<pre><code>resolver: lts-2.15\npackages:\n- '.'\nextra-deps: \n- haskoin-0.1.0.2\n- json-rpc-0.2.1.6\n- pbkdf-1.1.1.1\n- text-1.1.1.4\n\nflags: {}\n</code></pre>\n\n<p>and this .cabal file</p>\n\n<pre><code>name:                simple\nversion:             0.1.0.0\ncabal-version:       &gt;=1.10\n\nexecutable simple-exe\n  hs-source-dirs:      src\n  main-is:             Main.hs\n  build-depends:       base\n                     , haskoin\n  default-language:    Haskell2010\n</code></pre>\n\n<p>stack will rebuild every dependency every time I re-clone the source code.</p>\n\n<p>I am guessing that it might have something to do with the <code>extra-deps</code>, in particular <code>text-1.1.1.4</code>, but don't know for sure.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444089056, "post_id": 32959589, "comment_id": 53744232, "body": "Do you expect there to be a lot of matches? One easy way would be to use <code>breakOn</code>, then throw away one character from the second part of the result and repeat."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444089456, "post_id": 32959589, "comment_id": 53744318, "body": "@ReidBarton: That&#39;s an idea. I&#39;m a bit worried that the document says &quot;If you need to break a string by a substring repeatedly (e.g. you want to break on every instance of a substring), use breakOnAll instead, as it has lower startup overhead.&quot; Does that means it&#39;s not advisable to use this function repeatedly?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444090051, "post_id": 32959589, "comment_id": 53744491, "body": "Well yes I assume there is some extra startup overhead per search. That&#39;s why I asked whether you expect to find lots of matches, or just a few, in which case the extra overhead is unlikely to matter. Anyways there may be some better solutions in third-party packages."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444090194, "post_id": 32959589, "comment_id": 53744525, "body": "@ReidBarton: Unfortunately I expect <i>a lot</i> of matches. As you could imagine, 6-letters in a 3-billion-letter string could be more than abundant."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1444100415, "post_id": 32959589, "comment_id": 53747021, "body": "Are you performing more than one search? It seems to me like you should use a specialized data structure for this."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1444100493, "post_id": 32959589, "comment_id": 53747043, "body": "@Cubic: I will perform about 50 searches, each using a different 6-letter word, but same 3-billion string."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1444101877, "post_id": 32959589, "comment_id": 53747373, "body": "@trVoldemort Do you know anything at all about the text? For example, is your 6 letter string always surrounded by separators, such as spaces? Then you could just build and index and search using that. Text search is a well understood problem, and it seems wrong to me to roll your own for an example where performance clearly matters."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444102584, "post_id": 32959589, "comment_id": 53747523, "body": "KMP or similar without unpacking seems sensible, I think..."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1444102922, "post_id": 32959589, "comment_id": 53747592, "body": "@Cubic: Unfortunately the long string is a continuous DNA sequence, so there&#39;s no actual separable &quot;words&quot;."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 8, "creation_date": 1444107973, "post_id": 32959589, "comment_id": 53749091, "body": "@LouisWasserman, I bet some good algorithms have already been implemented for <code>ByteString</code>. trVoldemort, why would you use <code>Text</code> to represent DNA?"}], "answers": [{"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444169309, "post_id": 32978256, "comment_id": 53786683, "body": "Thanks. I guess one of the reasons I chose <code>Text</code> is because it has this convenient function <code>toUpper</code> which is needed to apply on the input sequence, and I didn&#39;t find an equivalent in <code>ByteString</code>. Is there any simple way I can do the same thing in <code>ByteString</code>?"}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444170307, "post_id": 32978256, "comment_id": 53787043, "body": "Uhm ... I could possibly use <code>Data.ByteString.Lazy.Char8</code> -&gt; <code>map Char.toUpper</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444172206, "post_id": 32978256, "comment_id": 53787698, "body": "@trVoldemort, you could, but you might be better off doing case conversion by pattern matching by hand. You only need to convert, what, four letters? Five if you want the same function to support RNA? Full Unicode case conversion seems like overkill, but you might find it&#39;s fast enough."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1444160251, "creation_date": 1444160251, "answer_id": 32978256, "question_id": 32959589, "link": "https://stackoverflow.com/questions/32959589/how-do-i-search-substrings-in-text-very-fast/32978256#32978256", "title": "How do I search substrings in `Text` very fast?", "body": "<p>The introductory text to <a href=\"https://hackage.haskell.org/package/stringsearch/docs/Data-ByteString-Search.html\" rel=\"nofollow\"><code>Data.ByteString.Search</code></a> indicates that Boyer-Moore is usually fastest, links to a DFA-based algorithm that is better in some special cases, and gives approximate performance ratios. You should not be using <code>Text</code> to represent DNA sequences. <code>Text</code> is intended for natural-language, possibly multilingual texts. DNA sequences look completely different.</p>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1444160251, "creation_date": 1444088652, "last_edit_date": 1444100661, "question_id": 32959589, "link": "https://stackoverflow.com/questions/32959589/how-do-i-search-substrings-in-text-very-fast", "title": "How do I search substrings in `Text` very fast?", "body": "<p>I'm trying to find the fastest way possible to search for substrings in a <code>Text</code> String. Here are the desired output:</p>\n\n<pre><code>findSubstringIndices :: Text -&gt; Text -&gt; [Int]\nfindSubstringIndices \"asdfasdf\" \"as\" == [0, 4]  -- 0-indexed\nfindSubstringIndices \"asdasdasdasd\" \"asdasd\" == [0, 3, 6]  -- matches can overlap\n</code></pre>\n\n<p>In my application, the substring is a fixed 6 letter word, but the string to be searched is very long (let's say over 3 billion letters). My current approach is using the <code>KMP</code> package:</p>\n\n<pre><code>import Data.Text.Lazy as T\nimport Data.Algorithms.KMP as KMP\nfindSubstringIndices a b = KMP.match (KMP.build $ T.unpack b) $ T.unpack a\n</code></pre>\n\n<p>But it seems to be a huge waste of the compactness from <code>Text</code>. Is there any (preferably concise) way to do it without <code>unpack</code>ing?</p>\n\n<p>I know there's a function called <code>breakOnAll</code> in <code>Text</code>, however it doesn't fit my requirement of allowing overlapping matches.</p>\n\n<hr>\n\n<p>Edit: Per @ReidBarton 's suggestion, I implemented a version that does not need <code>unpack</code>, which is indeed faster. However I'm not sure this is the fastest possible.</p>\n\n<pre><code>findSubstringIndicesC t a b = let (l, r) = T.breakOn b a in case r of\n    \"\" -&gt; []\n    _  -&gt; T.length l : findSubstringIndicesC (t + T.length l + 1) (T.tail r) b\n\nfindSubstringIndices = findSubstringIndicesC 0\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 391, "user_id": 5298455, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zEzWj_qaO7I/AAAAAAAAAAI/AAAAAAAAACw/A7lGVwEZUYs/photo.jpg?sz=128", "display_name": "Emanuel Borsboom", "link": "https://stackoverflow.com/users/5298455/emanuel-borsboom"}, "is_accepted": true, "score": 11, "last_activity_date": 1444089428, "creation_date": 1444089428, "answer_id": 32959693, "question_id": 32959393, "link": "https://stackoverflow.com/questions/32959393/how-to-use-ddump-minimal-imports-with-stack/32959693#32959693", "title": "How to use &quot;-ddump-minimal-imports&quot; with stack", "body": "<p>I just tried this, using <code>stack build --ghc-options=-ddump-minimal-imports</code>, and it produced output files in <code>./.stack-work/dist/x86_64-osx/Cabal-1.22.4.0/build/</code>, e.g.:</p>\n\n<pre><code>$ stack clean\n\n$ stack build --ghc-options=-ddump-minimal-imports\nstack-0.1.5.0: configure\nConfiguring stack-0.1.5.0...\nstack-0.1.5.0: build\nPreprocessing library stack-0.1.5.0...\n[ 1 of 69] Compiling Data.Set.Monad   ( src/Data/Set/Monad.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.4.0/build/Data/Set/Monad.o )\n[ 2 of 69] Compiling Data.Attoparsec.Combinators ( src/Data/Attoparsec/Combinators.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.4.0/build/Data/Attoparsec/Combinators.o )\n[ 3 of 69] Compiling Network.HTTP.Download.Verified ( src/Network/HTTP/Download/Verified.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.4.0/build/Network/HTTP/Download/Verified.o )\n^Cuser interrupt\n\n$ find . -name '*imports*'\n./.stack-work/dist/x86_64-osx/Cabal-1.22.4.0/build/Data.Attoparsec.Combinators.imports\n./.stack-work/dist/x86_64-osx/Cabal-1.22.4.0/build/Data.Set.Monad.imports\n./.stack-work/dist/x86_64-osx/Cabal-1.22.4.0/build/Network.HTTP.Download.Verified.imports\n</code></pre>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 3, "accepted_answer_id": 32959693, "answer_count": 1, "score": 6, "last_activity_date": 1444089428, "creation_date": 1444087287, "last_edit_date": 1444087598, "question_id": 32959393, "link": "https://stackoverflow.com/questions/32959393/how-to-use-ddump-minimal-imports-with-stack", "title": "How to use &quot;-ddump-minimal-imports&quot; with stack", "body": "<p>I am such a big fan of stack, that I've removed any independent cabal and ghc executables completely from my machine (letting stack install whatever it needs in its own mysterious ~/.stack/ directory)....</p>\n\n<p>However, it looks like some flags aren't working properly under stack.  For instance, I want to use <code>-ddump-minimal-imports</code>.  In cabal this would be</p>\n\n<pre><code>cabal build --ghc-option=-ddump-minimal-imports\n</code></pre>\n\n<p>The obvious translation would be</p>\n\n<pre><code>stack build --ghc-options -ddump-minimal-imports\n</code></pre>\n\n<p>This runs, but produces nothing but the executable (as far as I can tell, at least....  Perhaps the output is somewhere in the mysterious ~/.stack dir).</p>\n\n<p>Is there a way to do this?</p>\n"}, {"tags": ["haskell", "functional-programming", "sdl", "monads", "purely-functional"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1444084853, "post_id": 32959019, "comment_id": 53743029, "body": "Strictly speaking, those are not &#39;functions&#39;."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1444085149, "post_id": 32959019, "comment_id": 53743114, "body": "OK, &#39;functions&#39; in imperative sense."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1444085151, "post_id": 32959019, "comment_id": 53743116, "body": "As long as all foreign functions return <code>IO SomeType</code> no fundamental property should be broken. Is your case much different than calling e.g. <code>writeIORef</code> to update a mutable variable? The latter is &quot;safe&quot;, even if it can be abused to write unidiomatic code."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1444085242, "post_id": 32959019, "comment_id": 53743144, "body": "The thing is, the foreign function is like <code>f (type* src, type* dest)</code>, and content of <code>dest</code> is obviously changed. So if I call <code>f a</code>, it returns nothing but <code>a</code> is modified"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1444088645, "post_id": 32959019, "comment_id": 53744131, "body": "All values in Haskell are immutable, so no function modifies its input. However some values are (or contain) references to cells whose contents may be changed. But changing the contents of those cells doesn&#39;t modify the reference any more than changing the contents of a file modifies its filename. So there is no problem from a language point of view. Of course it can sometimes be more difficult to reason about a system that involves mutable state."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444090859, "post_id": 32959019, "comment_id": 53744696, "body": "You ask, &quot;Does it break composition?&quot; and &quot;Are there any unexpected semantics?&quot;. I ask, &quot;What do you mean by composition?&quot; and &quot;What are the expected semantics?&quot;."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1444091139, "post_id": 32959019, "comment_id": 53744777, "body": "Like will it make code too &quot;impure&quot; for reasoning"}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444091232, "post_id": 32959019, "comment_id": 53744810, "body": "@ReidBarton I know all values in <i>Haskell</i> are immutable, but <code>blitSurface</code> is in C, a foreign function. So after <code>blitSurface</code>, the <code>w</code> is no longer the same <code>w</code> as before. <code>IORef</code> doesn&#39;t have this problem"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444093685, "post_id": 32959019, "comment_id": 53745418, "body": "No, exactly the same is true here. <code>w</code> is a value in a Haskell program, so it is a Haskell value. Concretely <code>w</code> stores some kind of pointer. The value of the pointer never changes; what changes is the data pointed to by the pointer. Same as <code>IORef</code>."}, {"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444095197, "post_id": 32959019, "comment_id": 53745755, "body": "@ReidBarton I see what you mean. I&#39;ve never used IORef before so I don&#39;t know that it is expected"}], "answers": [{"comments": [{"owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "edited": false, "score": 0, "creation_date": 1444102940, "post_id": 32960538, "comment_id": 53747600, "body": "So now I am merely keeping one extremely thin layer of <code>IO</code> for easy manual management."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444105412, "post_id": 32960538, "comment_id": 53748305, "body": "Some mention of indexed monads and effect systems might be appropriate."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1444096666, "creation_date": 1444096666, "answer_id": 32960538, "question_id": 32959019, "link": "https://stackoverflow.com/questions/32959019/does-it-break-composition-to-modify-input-in-haskell/32960538#32960538", "title": "Does it break composition to modify input in Haskell?", "body": "<p>I observe that <code>f a b</code> and <code>flip f b a</code> are beta-equivalent terms. On the other hand, the straightforward <code>IO</code> version of these, namely, <code>f &lt;$&gt; a &lt;*&gt; b</code> and <code>flip f &lt;$&gt; b &lt;*&gt; a</code>, are certainly not beta-equivalent; and even using the equivalence from <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/Papers/marktoberdorf/mark.pdf.gz\">\"Tackling the Awkward Squad\"</a>, which makes many more <code>IO</code> actions equivalent, these two terms are not equivalent.</p>\n\n<p>At a high level, what this means is that if you prove something about the behavior of pure terms, then you can re-use that proof even when the pure computation is used as part of a larger program. On the other hand, there is not a corresponding way to uniformly lift a local proof about an <code>IO</code> term into a proof about a larger <code>IO</code>-based program; if you wish to do so, you must invoke some <em>global</em> properties about the particular <code>IO</code> actions you plan to use together.</p>\n\n<p>This is the impetus behind the common advice to lift as much of your computation as possible out of <code>IO</code> and into the pure world -- indeed, it is one of the primary motivations for doing pure functional programming in the first place, namely, that imperative programs do not compose well.</p>\n\n<p>However, none of this discussion is specific to the FFI or to functions whose <code>IO</code> actions update the values referenced by one of their inputs. <code>blitSurface</code> is no worse or better in this regard than basically any of the \"sin bin\" we toss into <code>IO</code>. Imperative programs simply aren't compositional in the same sense that pure ones are.</p>\n"}], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444096666, "creation_date": 1444084757, "question_id": 32959019, "link": "https://stackoverflow.com/questions/32959019/does-it-break-composition-to-modify-input-in-haskell", "title": "Does it break composition to modify input in Haskell?", "body": "<p>When I was reading the documentations of <code>SDL</code> in haskell, I found that some functions inevitably modifies its input. For example, <code>blitSurface</code> has destination surface as input, but it is updated within the function. Now, generalizing the problem, if I have a function <code>f :: a -&gt; IO a</code>, does it break composition if I modify <code>a</code> inside the function? What about <code>f :: IO a -&gt; IO a</code>? What about <code>a -&gt; IO ()</code>? And what about <code>IO a -&gt; IO ()</code>?</p>\n\n<p>Considering the case that <code>blitSurface</code> is actually a foreign function, and making a new surface every frame doesn't sound very efficient, these functions are hard to avoid. Will such functions cause problems in a larger scale? For example, using <code>fModifySurface :: Surface -&gt; IO ()</code> which does destructive update as an example:</p>\n\n<pre><code>main = do\n    w &lt;- ... -- The window surface\n    -- Do something here\n    s &lt;- someFuncGetSurface -- We get a surface here\n    fModifySurface s -- Destructively update s\n    blitSurface ...... -- Ignore the actual API, but destructively updates w\n</code></pre>\n\n<p>Are there any unexpected semantics in the code above? If so, what is the best way to make use of foreign functions that changes the input?</p>\n"}, {"tags": ["haskell", "dependencies", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1444086275, "post_id": 32958973, "comment_id": 53743470, "body": "The first thing to check would be whether you have added <i>hspec</i> to the cabal file."}, {"owner": {"reputation": 915, "user_id": 4883095, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/186dca84cf6c850ddeedf8318061e58d?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Monta&#241;o", "link": "https://stackoverflow.com/users/4883095/nicholas-monta%c3%b1o"}, "edited": false, "score": 3, "creation_date": 1444117847, "post_id": 32958973, "comment_id": 53753697, "body": "Specifically, look for the line <code>build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5</code>, add a comma, and write <code>hspec</code> there. Then try <code>stack build</code> again."}, {"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1444142590, "post_id": 32958973, "comment_id": 53770705, "body": "@duplode this means that stack does not replace using cabal directly for managing dependencies ? I thought so, that it was managing cabal for me."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1444148751, "post_id": 32958973, "comment_id": 53774930, "body": "@StephaneRolland The confusion is due to &quot;cabal&quot; having multiple meanings. stack replaces cabal-install, the tool which install and manages dependencies. However, it does not replace Cabal, the packaging system. The projects you configure with stack are still Cabal-compatible packages, and stack uses the information in the .cabal files. For instance, if you remove <i>hspec</i> from the extra-deps, add it to the .cabal file build-depends and run <code>stack solver --modify-stack-yaml</code>, stack will happily add it back."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1444498612, "post_id": 32958973, "comment_id": 53933895, "body": "I thought there would be a duplicate, but none of the existing questions under [haskell-stack] fits exactly. That being so, I converted my comment into an answer."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1444498540, "creation_date": 1444498540, "answer_id": 33056972, "question_id": 32958973, "link": "https://stackoverflow.com/questions/32958973/despite-stack-solver-could-not-find-module-test-hspec/33056972#33056972", "title": "Despite stack solver, Could not find module `Test.Hspec&#39;", "body": "<p>While stack replaces cabal-install, the command line tool for building and installing packages, it still uses the Cabal packaging infrastructure. In particular, that means projects built with stack are still Cabal-compatible packages with .cabal files, and all of their dependencies should be listed in the <code>build-depends</code> section of the .cabal file with appropriate version ranges. That holds even if the dependency is also specified in the <code>stack.yaml</code> file <code>extra-deps</code> field, as that field serves a different purpose (namely, giving stack an exact version to use when building the package).</p>\n"}], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1676, "favorite_count": 0, "accepted_answer_id": 33056972, "answer_count": 1, "score": 3, "last_activity_date": 1444498540, "creation_date": 1444084481, "last_edit_date": 1444086147, "question_id": 32958973, "link": "https://stackoverflow.com/questions/32958973/despite-stack-solver-could-not-find-module-test-hspec", "title": "Despite stack solver, Could not find module `Test.Hspec&#39;", "body": "<p>This is my <code>stack.yaml</code> file declaring <code>hspec</code> as a extra dependency:</p>\n\n<pre><code># Specifies the GHC version and set of packages available (e.g., lts-3.5, nightly-2015-09-21, ghc-7.10.2)\nresolver: lts-3.8  \n\n# Local packages, usually specified by relative directory name\npackages:\n- '.'\n\n# Packages to be pulled from upstream that are not in the resolver (e.g., acme-missiles-0.3)\nextra-deps:\n- hspec-2.2.0\n</code></pre>\n\n<p>when I run <code>stack solver</code> it says there is no change to be done:</p>\n\n<pre><code>root@5d7daa2aec0a:/src/test_stack/a-test/src# stack solver\nThis command is not guaranteed to give you a perfect build plan\nIt's possible that even with the changes generated below, you will still need to do some manual tweaking\nAsking cabal to calculate a build plan, please wait\nNo needed changes found\n\nTo automatically modify your stack.yaml file, rerun with '--modify-stack-yaml'\n</code></pre>\n\n<p>this is my source file (only to check that I could use Hspec with stack):</p>\n\n<pre><code>module Main where\n\nimport Test.Hspec\n\n\nmain :: IO ()\nmain = do\n  putStrLn \"hello world\"\n</code></pre>\n\n<p>and when I run <code>stack build</code> I get:</p>\n\n<p>2015-10-05 22:24:08.450413: [warn]     Could not find module `Test.Hspec' @(stack_Bp003b8iWaELtdr693pSPs:Stack.Build.Execute src/Stack/Build/Execute.hs:1241:35)</p>\n\n<p>I thought <code>stack solver</code> was ensuring that extra dependencies are ok.</p>\n\n<p>What I am doing wrong ? \nIt's the first time I use stack.</p>\n"}, {"tags": ["haskell", "traversal", "fold"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1444084824, "post_id": 32958811, "comment_id": 53743019, "body": "For the above <code>Foo</code> I think it&#39;s impossible to craft a law-abiding functor instance. I wonder which kinds of GADTs allow one to do so. It looks as if having a constructor <code>K :: ... -&gt; Foo T</code> prevents any functor instance unless <code>T</code> is a type variable. (Maybe I am overlooking something, though...)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444101645, "post_id": 32960180, "comment_id": 53747320, "body": "It&#39;s possible to construct functors that cheat, for instance by having an <code>Fmap</code> constructor to fuse <code>fmap</code> applications, while hiding that at the module boundary. I&#39;m mostly concerned about whether any such shenanigans could be mixed with a GADT in some subtly dangerous way."}, {"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444133022, "post_id": 32960180, "comment_id": 53763590, "body": "Something like <code>data Fmap f a where Fmap :: (x -&gt; a) -&gt; f x -&gt; Fmap f a</code>? That wouldn&#39;t cause any problems. It&#39;s only a problem when you specifically treat <code>Void</code> differently (like in my example). I don&#39;t expect someone could do it by mistake. As long as everything satisfies the functor laws it should be fine."}], "tags": [], "owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "is_accepted": true, "score": 4, "last_activity_date": 1444093646, "creation_date": 1444093646, "answer_id": 32960180, "question_id": 32958811, "link": "https://stackoverflow.com/questions/32958811/just-when-are-unsafevacuous-and-unsafe/32960180#32960180", "title": "Just when are unsafeVacuous, #., and .# unsafe?", "body": "<p>I don't believe there's any true functor where <code>unsafeVacuous</code> would cause a problem. But if you write a bad <code>Functor</code> you can make your own <code>unsafeCoerce</code>, which means it should to labeled with <code>{-# LANGUAGE Unsafe #-}</code>. There was <a href=\"https://github.com/ekmett/void/issues/4\" rel=\"nofollow\">an issue about it in void</a>.</p>\n\n<p>Here's an <code>unsafeCoerce</code> I came up with</p>\n\n<pre><code>{-# LANGUAGE GADTs               #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeFamilies        #-}\nimport Data.Void\nimport Data.Void.Unsafe\n\ntype family F a b where\n  F a Void = a\n  F a b    = b\n\ndata Foo a b where\n  Foo :: F a b -&gt; Foo a b\n\ninstance Functor (Foo a) where\n  fmap = undefined\n\nunsafeCoerce :: forall a b. (F a b ~ b) =&gt; a -&gt; b\nunsafeCoerce a = (\\(Foo b) -&gt; b) $ (unsafeVacuous (Foo a :: Foo a Void) :: Foo a b)\n\nmain :: IO ()\nmain = print $ (unsafeCoerce 'a' :: Int)\n</code></pre>\n\n<p>which prints <code>97</code>. </p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 3, "accepted_answer_id": 32960180, "answer_count": 1, "score": 6, "last_activity_date": 1444093646, "creation_date": 1444083442, "question_id": 32958811, "link": "https://stackoverflow.com/questions/32958811/just-when-are-unsafevacuous-and-unsafe", "title": "Just when are unsafeVacuous, #., and .# unsafe?", "body": "<p><code>unsafeVacuous</code> in <code>Data.Void.Unsafe</code> and <code>.#</code> and <code>#.</code> in <code>Data.Profunctor.Unsafe</code> both warn about the dangers of using those functions with functors/profunctors that are GADTs. Some dangerous examples are obvious:</p>\n\n<pre><code>data Foo a where\n  P :: a -&gt; Foo a\n  Q :: Foo Void\n\ninstance Functor Foo where\n  fmap f (P x) = P (f x)\n  fmap f Q = P (f undefined)\n</code></pre>\n\n<p>Here, <code>unsafeVacuous Q</code> will produce a <code>Q</code> constructor with a bogus type.</p>\n\n<p>This example isn't very troubling because it doesn't look even remotely like a sensible <code>Functor</code> instance. Are there examples that do? In particular, would it be possible to construct useful ones that obey the functor/profunctor laws when manipulated only using their public API, but break horribly in the face of these unsafe functions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444105539, "post_id": 32958512, "comment_id": 53748343, "body": "Your GHCi session all ended up on one line, making it quite hard to read. Could you fix that please?"}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 1, "last_activity_date": 1444092728, "creation_date": 1444092728, "answer_id": 32960081, "question_id": 32958512, "link": "https://stackoverflow.com/questions/32958512/compdata-relationship-between-and-subsume/32960081#32960081", "title": "compdata: relationship between :+: and Subsume", "body": "<p>You've misunderstood, <code>X Int</code> contains no values of type <code>Int</code>. The type alias <code>X'</code> does not use <code>a</code> in the right hand side; therefore, it must be a phantom type. The type <code>X a</code>, for any <code>a</code>, contains trees with either <em>zero or more nodes</em> (due to <code>[]</code>) or <em>zero or one</em> node (due to <code>Maybe</code>). Note, that neither has data at the nodes, or leaves. If you want this tree structure, with data at each 'branch', you must add a constant at each branch: </p>\n\n<pre><code>type X' a = K a :*: ([] :+: Maybe)\n</code></pre>\n\n<p>Where <code>newtype K a x = K a</code>. In fact, this concept of adding a 'constant annotation' to a signature is so common that compdata has a special construct for it, <code>f :&amp;: e</code>, which is isomorphic to <code>f :*: K e</code>. Then construct it like so:</p>\n\n<pre><code>import Data.Comp\nimport Data.Comp.Ops\nimport Data.Comp.Show\nimport Data.Comp.Sum\n\ntype X' a = ([] :+: Maybe) :&amp;: a\ntype X a = Term (X' a)\n\nlistNode :: a -&gt; [X a] -&gt; X a \nlistNode x xs = Term $ Inl xs :&amp;: x  \n\nmayNode :: a -&gt; Maybe (X a) -&gt; X a \nmayNode x mx = Term $ Inr mx :&amp;: x \n\ntest = listNode 1 \n         [ mayNode 2 Nothing\n         , mayNode 3 $ Just $ \n           mayNode 10 $ Just $ \n             listNode 4 \n               [ listNode 10 [] \n               , mayNode 1 Nothing \n               ]\n          ]\n</code></pre>\n"}], "owner": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 32960081, "answer_count": 1, "score": 0, "last_activity_date": 1444092728, "creation_date": 1444081912, "question_id": 32958512, "link": "https://stackoverflow.com/questions/32958512/compdata-relationship-between-and-subsume", "title": "compdata: relationship between :+: and Subsume", "body": "<p>I've been reading \"Data Types a la Carte\" and trying to follow along with </p>\n\n<p><code>\n:set -XTypeOperators\n:m Data.Comp.Ops\n:m Data.Comp\ntype X' a = [] :+: Maybe\ntype X a = Term (X' a)\n</code></p>\n\n<p>So, X Int should be a list or a maybe of Int. But nothing that I've tried has resulted in me being able to create a value of type X Int. I've also tried the smart constructors and they've complained that there's no Subsume relationship available. Looking at hackage, there doesn't appear to be one. Could someone explain how I can square this circle?</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1444087368, "post_id": 32959113, "comment_id": 53743762, "body": "Looks promising, but I am struggling to get <code>-ddump-minimal-imports</code> working with stack....  I just put up another stackoverflow question to sort this out....  Will get back to this question when that is done."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1444093354, "post_id": 32959113, "comment_id": 53745337, "body": "To get it working with stack, I used <code>stack build --ghc-options -ddump-minimal-imports</code>, then copied all the <code>*.imports</code> files to the cabal root, also a file called <code>setup-config</code> needed to be copied to <code>dist&#47;</code>.  All of these files were somewhere in <code>.stack-work&#47;</code> (<code>find</code> can be used to get the exact location)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 1, "creation_date": 1444099297, "post_id": 32959113, "comment_id": 53746756, "body": "@jamshidh Wow, that seems annoying. I&#39;ve opened a feature request to work with stack <a href=\"https://github.com/hvr/packunused/issues/18\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "is_accepted": true, "score": 6, "last_activity_date": 1444085330, "creation_date": 1444085330, "answer_id": 32959113, "question_id": 32958093, "link": "https://stackoverflow.com/questions/32958093/which-cabal-packages-arent-being-used/32959113#32959113", "title": "Which cabal packages aren&#39;t being used", "body": "<p><a href=\"https://hackage.haskell.org/package/packunused\"><code>packunused</code></a> is a <em>simple CLI tool allows to find out which of the packages listed as build-depends in a Cabal package description file are redundant</em>.</p>\n\n<p>You have to build your project with <code>-ddump-minimal-imports</code> then run <code>packunused</code>:</p>\n\n<pre><code>cabal build --ghc-option=-ddump-minimal-imports\npackunused\n</code></pre>\n\n<p>It will print a list of package dependencies that seem to be unused.</p>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 32959113, "answer_count": 1, "score": 8, "last_activity_date": 1444087698, "creation_date": 1444080042, "last_edit_date": 1444087698, "question_id": 32958093, "link": "https://stackoverflow.com/questions/32958093/which-cabal-packages-arent-being-used", "title": "Which cabal packages aren&#39;t being used", "body": "<p>If I crank up the warnings with GHC, it will warn me which imports aren't being used....</p>\n\n<p>Is there a similar command to tell me which <code>build-depends</code> aren't being used in my <code>&lt;project&gt;.cabal</code> file?</p>\n"}, {"tags": ["haskell", "conduit"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1444077650, "post_id": 32957258, "comment_id": 53739959, "body": "The <a href=\"http://hackage.haskell.org/package/pipes-group\" rel=\"nofollow noreferrer\"><code>pipes-group</code></a> and <a href=\"http://hackage.haskell.org/package/streaming-0.1.1.0/docs/Streaming.html#v:chunksOf\" rel=\"nofollow noreferrer\"><code>streaming</code></a> libraries allow this, not sure how to do it with conduit though."}, {"owner": {"reputation": 620, "user_id": 2584221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d093dc953c307e20883be41dd6faa702?s=128&d=identicon&r=PG", "display_name": "dsemi", "link": "https://stackoverflow.com/users/2584221/dsemi"}, "edited": false, "score": 0, "creation_date": 1444101454, "post_id": 32957258, "comment_id": 53747265, "body": "Is the goal to use nested conduits to make this paralellizable? Because you should be able to use one conduit to split on double newline and then sum the groups."}], "answers": [{"comments": [{"owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "edited": false, "score": 0, "creation_date": 1444122432, "post_id": 32961296, "comment_id": 53756538, "body": "Thanks. This is close to what I had in mind, except 1) I would expect more direct support from the library for this, and 2) this looks like unnecessary CPS; shouldn&#39;t <code>Sink a m () -&gt; Sink (Maybe a) m ()</code> be called <code>Conduit (Maybe a) m a</code>?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "edited": false, "score": 0, "creation_date": 1444136179, "post_id": 32961296, "comment_id": 53765903, "body": "I&#39;m not sure what that exact type signature would mean or how such a function would behave. But one of the motivating factors for this design is so that the combinator (<code>folded</code>) has the ability to force flushing of the rest of the substream for cases where the provided function (<code>perGroup</code>) doesn&#39;t fully consume its input."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 3, "last_activity_date": 1444102608, "creation_date": 1444102608, "answer_id": 32961296, "question_id": 32957258, "link": "https://stackoverflow.com/questions/32957258/how-to-model-nested-streams-with-conduits/32961296#32961296", "title": "How to model nested streams with conduits?", "body": "<p>There are two basic approaches I'd recommend for this. The simple one is to just yield a stream of sum types indicating \"another value\" vs \"newline.\" The other approach is to use a combinator approach like <a href=\"http://haddock.stackage.org/nightly-2015-10-05/conduit-extra-1.1.9.1/Data-Conduit-Text.html#v:withLine\" rel=\"nofollow\">withLine</a> or <a href=\"http://haddock.stackage.org/nightly-2015-10-05/conduit-extra-1.1.9.1/Data-Conduit-Text.html#v:foldLines\" rel=\"nofollow\">foldLines</a>. The latter can be built on top of the former. This approach was originally discussed <a href=\"http://www.yesodweb.com/blog/2013/09/folding-lines-conduit\" rel=\"nofollow\">in a blog post on foldLines</a>.</p>\n\n<p>Below is a complete code snippet showing the sum type and combinator approach. Note that folded (probably a bad name for this) is a general purpose function for transforming into a \"nested stream\" from a sum type. The approach taken by pipes (based on FreeT IIRC) can likely be used by conduit as well, but as I mention in the blog post, I think it's a more complicated solution than is needed.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE NoImplicitPrelude #-}\nimport ClassyPrelude.Conduit\nimport Data.Text.Read (decimal, signed)\n\nsumType :: Monad m =&gt; Conduit Text m (Maybe Int)\nsumType =\n    linesUnboundedC =$= mapMC toMaybeInt\n  where\n    toMaybeInt \"\" = return Nothing\n    toMaybeInt t =\n        case signed decimal t of\n            Right (i, \"\") -&gt; return $ Just i\n            _ -&gt; fail $ \"Invalid int: \" ++ show t\n\nfolded :: Monad m =&gt; Sink a m () -&gt; Sink (Maybe a) m ()\nfolded perGroup =\n    startGroup\n  where\n    startGroup = peekC &gt;&gt;= maybe (return ()) (const go)\n\n    go = takeMaybes =$ (perGroup &gt;&gt; sinkNull) &gt;&gt; startGroup\n\n    takeMaybes = await &gt;&gt;= maybe (return ()) (\\x -&gt;\n        case x of\n            Nothing -&gt; return ()\n            Just y -&gt; yield y &gt;&gt; takeMaybes)\n\nmain :: IO ()\nmain = do\n    let src = yield \"1\\n2\\n3\\n\\n5\\n6\\n\\n\\n7\"\n    src $$ sumType =$ (sinkList &gt;&gt;= print)\n    src $$ sumType =$ folded (sinkList &gt;&gt;= print)\n</code></pre>\n"}], "owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1444307729, "creation_date": 1444076553, "question_id": 32957258, "link": "https://stackoverflow.com/questions/32957258/how-to-model-nested-streams-with-conduits", "title": "How to model nested streams with conduits?", "body": "<p>Let's say we need to sum up groups of numbers stored in a file, where groups are delimited by an empty line. So</p>\n\n<pre><code>1\n2\n3\n\n4\n5\n</code></pre>\n\n<p>shoud result in <code>6 9</code>.</p>\n\n<p>It seems natural to model this with nested conduits: the outer conduit would split lines into groups of lines, where each group would itself be a source.</p>\n\n<p>However, I don't see this style supported directly in conduit. What is the most idiomatic way to do this with conduits?</p>\n"}, {"tags": ["parsing", "haskell", "abstract-syntax-tree", "template-haskell"], "answers": [{"tags": [], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "is_accepted": true, "score": 1, "last_activity_date": 1444149278, "last_edit_date": 1495541703, "creation_date": 1444149278, "answer_id": 32975123, "question_id": 32955109, "link": "https://stackoverflow.com/questions/32955109/haskell-src-exts-throws-templatehaskell-error/32975123#32975123", "title": "Haskell-src-exts throws TemplateHaskell error", "body": "<p>This is a duplicate question of <a href=\"https://stackoverflow.com/questions/15784076/parsing-unicodesyntax-with-haskell-src-exts\">this answer</a> - using the <code>parseFile</code> function fixed the issue. However, the reader should note that <code>haskell-src-exts</code> uses different parsing than GHC - I ran into another similar issue right after this, because <a href=\"https://github.com/haskell-suite/haskell-src-exts/issues/29\" rel=\"nofollow noreferrer\">haskell-src-exts can't handle multi-param contexts without -XMultiParamTypeClasses, yet GHC can</a>, borking the parser if you're scraping Hackage. <a href=\"https://hackage.haskell.org/package/hint\" rel=\"nofollow noreferrer\">Hint</a> may be a better option, can't say for sure though.</p>\n"}], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 32975123, "answer_count": 1, "score": 2, "last_activity_date": 1444149278, "creation_date": 1444068679, "question_id": 32955109, "link": "https://stackoverflow.com/questions/32955109/haskell-src-exts-throws-templatehaskell-error", "title": "Haskell-src-exts throws TemplateHaskell error", "body": "<p>I'm trying to use the <a href=\"https://hackage.haskell.org/package/haskell-src-exts\" rel=\"nofollow\">haskell-src-exts</a> package to parse Haskell modules. Currently, I'm trying to parse the <a href=\"https://hackage.haskell.org/package/acme-io\" rel=\"nofollow\">acme-io</a> package's module, but I keep getting this error no matter what parse mode I try:</p>\n\n<pre><code>*** Exception: fromParseResult: Parse failed at [System/IO/Unsafe/Really/IMeanIt] (1:57): TemplateHaskell is not enabled\n</code></pre>\n\n<p>The module mentioned makes no references to TemplateHaskell, not in it's <code>LANGUAGE</code> pragma, nor is there a <code>$</code> anywhere in the source file.</p>\n\n<p>I'm wondering if my parse mode has something to do with it - here it is:</p>\n\n<pre><code>defaultParseMode { parseFilename = toFilePath m\n                 , baseLanguage = Haskell2010\n                 , extensions = []\n                 , ignoreLanguagePragmas = True\n                 , ignoreLinePragmas = True\n                 , fixities = Nothing\n                 }\n</code></pre>\n\n<p>I've also tried to replace the <code>extensions</code> field with <code>knownExtensions</code> from <a href=\"http://hackage.haskell.org/package/haskell-src-exts-1.16.0.1/docs/Language-Haskell-Exts-Extension.html#v:knownExtensions\" rel=\"nofollow\">the parsing suite</a>, without any luck.</p>\n"}, {"tags": ["haskell", "haskell-turtle"], "answers": [{"tags": [], "owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "is_accepted": false, "score": 3, "last_activity_date": 1444069342, "creation_date": 1444069342, "answer_id": 32955297, "question_id": 32953604, "link": "https://stackoverflow.com/questions/32953604/binary-redirection-in-turtle/32955297#32955297", "title": "Binary redirection in Turtle", "body": "<p>The answer is, not yet, but there is an issue open for this here:</p>\n\n<p><a href=\"https://github.com/Gabriel439/Haskell-Turtle-Library/issues/68\" rel=\"nofollow\">https://github.com/Gabriel439/Haskell-Turtle-Library/issues/68</a></p>\n\n<p>I proposed an example API for this in that issue and you might want to chime in on that issue to see if that API would be okay for your use case.</p>\n"}, {"tags": [], "owner": {"reputation": 2393, "user_id": 10486, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa8d1aa7a81deba551fe80024ef74528?s=128&d=identicon&r=PG", "display_name": "William Casarin", "link": "https://stackoverflow.com/users/10486/william-casarin"}, "is_accepted": true, "score": 2, "last_activity_date": 1480702514, "creation_date": 1480702514, "answer_id": 40938577, "question_id": 32953604, "link": "https://stackoverflow.com/questions/32953604/binary-redirection-in-turtle/40938577#40938577", "title": "Binary redirection in Turtle", "body": "<p>As of version 1.3.0, Turtle now has a Turtle.Bytes module just for this:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/turtle/docs/Turtle-Bytes.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/turtle/docs/Turtle-Bytes.html</a></p>\n"}], "owner": {"reputation": 1688, "user_id": 3227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f9115ad9def173d11a02f34d551516?s=128&d=identicon&r=PG", "display_name": "drewr", "link": "https://stackoverflow.com/users/3227/drewr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 40938577, "answer_count": 2, "score": 3, "last_activity_date": 1480702514, "creation_date": 1444063242, "last_edit_date": 1444078381, "question_id": 32953604, "link": "https://stackoverflow.com/questions/32953604/binary-redirection-in-turtle", "title": "Binary redirection in Turtle", "body": "<p>I would like to do something similar to:</p>\n\n<p><code>curl -s http://example.com/some/file.bin &gt;/usr/local/bin/foo\n</code></p>\n\n<p>Since <code>Shell</code> is polymorphic, I can probably do this with Turtle as-is, but all the examples operate on lines of <code>Shell Text</code> and I haven't internalized enough Haskell to navigate it. Is there an idiomatic way to get <code>Shell Bytestring</code> or another solution?</p>\n"}, {"tags": ["algorithm", "haskell", "data-structures", "time-complexity"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1444050821, "post_id": 32949135, "comment_id": 53723751, "body": "How about <code>Array</code> or <code>UArray</code>?"}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "edited": false, "score": 0, "creation_date": 1444051221, "post_id": 32949135, "comment_id": 53724048, "body": "This doesn&#39;t really answer your question, but I&#39;d like to ask anyway. In your first approach, Sprite is equivalent to a list of calls to <code>Position -&gt; Pixel -&gt; ST s ()</code>. Couldn&#39;t it be changed to <code>[(Position, Pixel)]</code> to make it nicer while keeping the same performance?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1444051452, "post_id": 32949135, "comment_id": 53724207, "body": "As far as my skills go, no. The issue is that <code>Position -&gt; Pixel -&gt; ST ()</code> always use constant space. For that to work with lists, you have to always count every list will be fused and compiled to a constant space loop. Maybe it was just me, but I couldn&#39;t get it to perform the same even with simple rendering patterns..."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444052651, "post_id": 32949135, "comment_id": 53724996, "body": "Can you give a complete example of how you want to use your Sprites? Usually when I think of sprites I think of images which are smaller than the image they are rendered onto and they are also repositionable. But I can&#39;t see how you would do that with your ST version."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1444052857, "post_id": 32949135, "comment_id": 53725141, "body": "How not? For example, this <code>Sprite</code> renders just 2 pixels at positions <code>6</code>, <code>7</code>: <code>twoPixels :: Sprite; twoPixels set = set 6 black &gt;&gt; set 7 red</code>. The pure version would be <code>twoPixels = [(6, black), (7, red)]</code>."}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "reply_to_user": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "edited": false, "score": 0, "creation_date": 1444052932, "post_id": 32949135, "comment_id": 53725198, "body": "I think with your current definition of <code>Sprite</code>, you can&#39;t really optimize in the way that you need due to the fact that <code>render</code> has no knowledge about what pixels <code>Sprite</code> is going to touch. Maybe you could change <code>Sprite</code> to also include a list of pixel ranges that it will touch? That might be a shorter list than the one suggested by @madjar in a lot of cases. Using this information, you could maybe come up with an algorithm similar to linear merging to process the union of the sprite ranges, and then &quot;insert&quot; those into your image using an O(P + min{log n, w}) process"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1444053065, "post_id": 32949135, "comment_id": 53725295, "body": "Those on the OP are just examples, though. I&#39;m looking for any datatype/function that implements fast rendering of many sprites, it doesn&#39;t have to use my definition of <code>Sprite</code> at all."}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1444053602, "post_id": 32949135, "comment_id": 53725660, "body": "Probably something like vty <a href=\"http://hackage.haskell.org/package/vty-5.4.0/docs/src/Graphics-Vty-Image-Internal.html#Image\" rel=\"nofollow noreferrer\">Image</a>? It uses chars instead of pixels, but the idea is similar.  <a href=\"http://hackage.haskell.org/package/vty-5.4.0/docs/src/Graphics-Vty-PictureToSpans.html#displayOpsForImage\" rel=\"nofollow noreferrer\">Here</a> is how it is rendered."}, {"owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 0, "creation_date": 1444056777, "post_id": 32949135, "comment_id": 53727963, "body": "<code>HashMap</code> from <code>unordered-containers</code> or <code>Vector</code> from <code>persistent-vector</code> practically reduces the <code>log N</code> factor to constant. But it&#39;s still more costly than mutable vectors."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1444056828, "post_id": 32949135, "comment_id": 53727994, "body": "But it depends on the primitive <code>Array</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444070216, "post_id": 32949135, "comment_id": 53735915, "body": "<code>Map</code> is typically very slow. What happens if you swap in <code>IntMap</code>? It won&#39;t be nearly as fast as unboxed vectors, but it&#39;s certainly a better purely functional baseline."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444072523, "post_id": 32949135, "comment_id": 53737195, "body": "@Viclib I think the question is a bit incomplete unless you talk about what reads you want to do from an <code>Image</code> (at the moment it is write-only)."}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 6, "last_activity_date": 1444060720, "creation_date": 1444060720, "answer_id": 32952832, "question_id": 32949135, "link": "https://stackoverflow.com/questions/32949135/what-is-a-purely-functional-data-structure-that-efficiently-implements-rendering/32952832#32952832", "title": "What is a purely functional data structure that efficiently implements rendering to an image?", "body": "<p>If the positions in a sprite can be arbitrary (e.g. <code>[(0,x),(7,y),(5000,z)]</code>) it seems pretty clear that you can't hope to do better than O(P log N) if you are only allowed to use data structures of bounded branching factor.</p>\n\n<p>If the positions in a sprite are contiguous then you could use a <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html\"><code>Seq</code></a> (fingertree) which supports logarithmic slicing and concatenation to implement <code>render</code> in O(log N) time. If your sprite consists of k disjoint contiguous sequences then you can repeat this k times for O(k log N) <code>render</code>.</p>\n\n<p>However, I don't think the extension to two dimensions is as easy as you make it sound unless you are willing to give up an extra factor of O(side length of sprite in one dimension). Perhaps there is some kind of finger-k-d tree that avoids this extra factor.</p>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444082198, "post_id": 32955357, "comment_id": 53742011, "body": "I think this is using Array or similar behind the scenes."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444083885, "post_id": 32955357, "comment_id": 53742705, "body": "@ReidBarton Indeed, and it can be done with <code>Array</code> &quot;in front of the scenes&quot;, too, if preferred, with the same asymptotics: just use <code>(&#47;&#47;)</code> instead of <code>union</code> and <code>toMapWith</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1444069570, "creation_date": 1444069570, "answer_id": 32955357, "question_id": 32949135, "link": "https://stackoverflow.com/questions/32949135/what-is-a-purely-functional-data-structure-that-efficiently-implements-rendering/32955357#32955357", "title": "What is a purely functional data structure that efficiently implements rendering to an image?", "body": "<p>You can use the <a href=\"http://hackage.haskell.org/package/discrimination\" rel=\"nofollow\">discrimination</a> package to build your <code>Map</code> in O(n+p) time:</p>\n\n<pre><code>render sprites image\n    = flip union image\n    . toMapWith (\\new old -&gt; new)\n    . concat\n    $ sprites\n</code></pre>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 4, "accepted_answer_id": 32952832, "answer_count": 2, "score": 11, "last_activity_date": 1444069570, "creation_date": 1444049527, "last_edit_date": 1444050976, "question_id": 32949135, "link": "https://stackoverflow.com/questions/32949135/what-is-a-purely-functional-data-structure-that-efficiently-implements-rendering", "title": "What is a purely functional data structure that efficiently implements rendering to an image?", "body": "<p>Images and pixel-rendering are one of the last things in Haskell I couldn't pick an efficient enough purely functional data structure for. For simplicity, lets talk about <code>1D</code> images, since those can easily extended to n-d images. I'm using unboxed vectors as the representation and their mutable view for rendering:</p>\n\n<pre><code>-- An 1D image is an unboxed vector of Pixels\ntype Position = Int\ndata Image    = Image { size :: Position, buffer :: UV.Vector Pixel }\n\n-- A sprite is a recipe to draw something to an Image\nnewtype Sprite = Sprite (forall s .\n    -&gt; (Position -&gt; Pixel -&gt; ST s ()) -- setPixel\n    -&gt; ST s ())                       -- ST action that renders to Image\n\n-- Things that can be rendered to screen provide a sprite\nclass Renderable a where\n    getSprite a :: a -&gt; Sprite\n\n-- `render` applies all sprites, mutably, in sequence. `O(P)` (where P = pixels to draw)\nrender :: [Sprite] -&gt; Image -&gt; Image\nrender draws (Image size buffer) = Image size $ runST $ do ...\n</code></pre>\n\n<p>This is the most performant design for CPU-rendering I found, yet it is rather ugly. For a purely functional structure that implements <code>render</code>, the obvious answer would be to use a map to represent the Image and a list of <code>(Position, Pixel)</code> pairs to represent the sprite. Something like:</p>\n\n<pre><code>-- 1D for simplicity\ntype Position = Int\n\n-- An image is a map from positions to colors\ntype Image    = Map Position Pixel\n\n-- A sprite is, too, a map from positions to colors\ntype Sprite   = [(Position, Pixel)]\n\n-- Rendering is just inserting each pixel in sequence\n-- (Not tested.)\nrender :: [Sprite] -&gt; Image -&gt; Image\nrender sprites image = foldr renderSprite image sprites\n    where renderSprite sprite image = foldr (uncurry insert) image sprites\n</code></pre>\n\n<p>Which is <code>O(P * log(N))</code> (P = pixels to render, N = size of the image). It might look that the <code>log(N)</code> is unescapable, but if you see it carefully, <code>render</code> is traveling the same paths through <code>Image</code> several times (i.e., if you insert at position 0, then at position 1, you are running all way down to a leaf, then all way up, then all way down to the neighbor leaf...). That looks like the exact same pattern for which <code>zippers</code>, for instance, can improve the asymptotics, which leads me to suspect <code>render</code> can be improved. <strong>Is there any purely functional data structure that allows implementing <code>render</code> better than <code>O(P*log N)</code>?</strong></p>\n\n<p>Note: by \"purely functional\", I specifically mean a structure that uses nothing but Haskell's algebraic datatypes alone, i.e., without native primitives such as <code>Int</code> and <code>Array</code> (even though those are technically served as pure data structures nether less).</p>\n"}, {"tags": ["haskell", "types", "io", "typeerror"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 0, "creation_date": 1444047527, "post_id": 32948330, "comment_id": 53721498, "body": "The result of minmax when call, so akin to type of minmax, i&#39;ve tried casting it, but it always throws me an error that it &quot;expects a contraint but IO [Int] has kind &#39;*&#39; &quot;"}], "tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": false, "score": 2, "last_activity_date": 1444047115, "creation_date": 1444047115, "answer_id": 32948330, "question_id": 32948201, "link": "https://stackoverflow.com/questions/32948201/type-error-in-a-min-and-max-function/32948330#32948330", "title": "Type error in a min-and-max function", "body": "<p><code>minmaxlist :: IO [Int]</code> states that <code>minmaxlist</code> is an <code>IO</code> action that returns a list of <code>Int</code>. However, it tries to return the result of <code>minmax</code> (in <code>return (minmax (number:int_list)))</code>), which is of type <code>(Int, Int)</code>.</p>\n\n<p>So, what do you want <code>minmaxlist</code> to return?</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 0, "creation_date": 1444048406, "post_id": 32948343, "comment_id": 53722006, "body": "I have to declare it of [Int] because that&#39;s the only way my list will accumulate, so i&#39;m approaching this wrong then?"}, {"owner": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 0, "creation_date": 1444049720, "post_id": 32948343, "comment_id": 53722929, "body": "Having the same issue with the type [Int] trying to be the return but asking for ([Int], [Int])"}], "tags": [], "owner": {"reputation": 17837, "user_id": 1923190, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/D0JyZ.jpg?s=128&g=1", "display_name": "Simon H", "link": "https://stackoverflow.com/users/1923190/simon-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1444051219, "last_edit_date": 1444051219, "creation_date": 1444047167, "answer_id": 32948343, "question_id": 32948201, "link": "https://stackoverflow.com/questions/32948201/type-error-in-a-min-and-max-function/32948343#32948343", "title": "Type error in a min-and-max function", "body": "<p>You were very close - don't use a tuple, but return a list instead</p>\n\n<pre><code>minmax :: (Ord a) =&gt; [a] -&gt; [a]\nminmax [] = error \"Null\"\nminmax xs = [minimum xs, maximum xs]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 0, "creation_date": 1444050732, "post_id": 32949237, "comment_id": 53723674, "body": "So in this instance you&#39;re casting the returned list of type IO [Int] into a list? Could you go into more detail on what you did casting wise for minmaxIO?"}, {"owner": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 0, "creation_date": 1444050968, "post_id": 32949237, "comment_id": 53723860, "body": "Specifically is the list you set of type IO Int? or is it Int?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 1, "creation_date": 1444051166, "post_id": 32949237, "comment_id": 53723994, "body": "there is no actual casting - your function <code>convertIO</code> is of type <code>IO Int</code>, so <code>number &lt;- convertIO</code> pulls out an <code>Int</code> - that fixes all the types here (of course <code>Int</code> is an instance of <code>Ord</code>) - the value <code>list</code> I pull out with <code>list &lt;- ioInts</code> will have type <code>[Int]</code> (if you do <code>x &lt;- y</code> and <code>y :: IO a</code> then <code>y</code> must be <code>x :: a</code>)"}, {"owner": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 0, "creation_date": 1444055692, "post_id": 32949237, "comment_id": 53727177, "body": "So the way I understand, what I was trying to is impossible because everytime the function ioInts gets called and set int_list it would need to be getting it from a list of Int, and not of (Int, Int) which is what it was returning."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "edited": false, "score": 1, "creation_date": 1444055857, "post_id": 32949237, "comment_id": 53727284, "body": "yes exactly - the types on the both branches of your <code>if</code> would not have matched either - you could use the *hack*/trick @SimonH proposed but IMO it&#39;s much clearer this way"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1444049792, "creation_date": 1444049792, "answer_id": 32949237, "question_id": 32948201, "link": "https://stackoverflow.com/questions/32948201/type-error-in-a-min-and-max-function/32949237#32949237", "title": "Type error in a min-and-max function", "body": "<p>Your idea is a good one - both <code>minmax</code> and the way you are producing your <code>IO [Int]</code> seems resonable - I just would push the application of <code>minmax</code> out of the list-generation all togehter:</p>\n\n<pre><code>module Main where\n\nminmax :: (Ord a) =&gt; [a] -&gt; (a,a)\nminmax [] = error \"Null\"\nminmax (x:xs) = (minimum (x:xs), maximum (x:xs))\n\nconvertIO :: IO Int\nconvertIO = do\n    line &lt;- getLine\n    return (read line :: Int)\n\nioInts :: IO [Int]\nioInts = do\n    number &lt;-convertIO\n    if number /= 0\n      then do \n        int_list &lt;- ioInts\n        return (number:int_list)\n      else return []\n\nminmaxIO :: IO (Int,Int)\nminmaxIO = do\n  list &lt;- ioInts\n  return $ minmax list\n\nmain :: IO ()\nmain = do\n  val &lt;- minmaxIO\n  print val\n</code></pre>\n\n<p>you can make this all a bit shorter with operators like <code>(&lt;$&gt;)</code> but I think you are more comfortable with the <code>do</code> notation</p>\n\n<p>As you can see I just added another <code>IO</code> computation <code>minmaxIO</code> that applies <code>minmax</code> to the list produced by <code>ioInts</code> (which I renamed from your <code>minmaxlist</code>) - the other stuff if basically still yours</p>\n"}], "owner": {"reputation": 35, "user_id": 5408268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c77562b012371e559e751ee18938e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "S. Shaw", "link": "https://stackoverflow.com/users/5408268/s-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "accepted_answer_id": 32949237, "answer_count": 3, "score": 2, "last_activity_date": 1444077245, "creation_date": 1444046681, "last_edit_date": 1444077245, "question_id": 32948201, "link": "https://stackoverflow.com/questions/32948201/type-error-in-a-min-and-max-function", "title": "Type error in a min-and-max function", "body": "<p>I am working on a haskell project and have a minmax function that gets the minimum and maximum of a list and returns them in a tuple pair like so:</p>\n\n<pre><code>\u03bb&gt; minmax [1,2,3]\n(1,3)\n\u03bb&gt; minmax [4,2,5,9]\n(2,9)\n</code></pre>\n\n<p>Now I am implementing a user input list that recursively loops until a cancel input is put in then the list completes which then needs to utilize my minmax function, the problem i'm having is that it's not obviously the same type as a simple list when done because it's throwing me type errors. </p>\n\n<pre><code>minmax :: (Ord a) =&gt; [a] -&gt; (a,a)\nminmax [] = error \"Null\"\nminmax (x:xs) = (minimum (x:xs), maximum (x:xs))\n\nconvertIO :: IO Int\nconvertIO = do\n    line &lt;- getLine\n    return (read line :: Int)\n\nminmaxlist :: IO [Int]\nminmaxlist = do\n    number &lt;- convertIO\n    if(number /= 0)\n        then (do \n            int_list &lt;- minmaxlist\n            return (minmax (number:int_list)))\n    else return []\n</code></pre>\n\n<p>Is throwing me this specific error: </p>\n\n<pre><code>Couldn't match expected type `[Int]' with actual type `(Int, Int)'\n</code></pre>\n\n<p>Though a list of integers is exactly what i'm passing through via (number:int_list) and if I do pass it a list of integers it returns the tuple fine. Why is it throwing me errors here? Does it have to do with it being from type IO?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444034746, "post_id": 32944035, "comment_id": 53713980, "body": "@Carsten Thanks for your suggestion. I actually tried quite a few of the base case for example <code>matrixProduct [] [] = []</code> <code>matrixProduct [] _ = []</code> and it still has the the exception."}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1488876279, "post_id": 32944035, "comment_id": 72414481, "body": "thanks for the answer, it helped me!"}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 0, "creation_date": 1444035174, "post_id": 32944488, "comment_id": 53714204, "body": "Thanks!  I actually have never see these expresion."}, {"owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 0, "creation_date": 1444035324, "post_id": 32944488, "comment_id": 53714270, "body": "The <code>$</code> and <code>&lt;-</code> in the code, I didn&#39;t even know these syntax exist."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 1, "creation_date": 1444035411, "post_id": 32944488, "comment_id": 53714336, "body": "oh sorry - the <code>$</code> is just there to save some characters (it<code>s the same as </code>sum (zipWith (*) xs ys)` - you see: one <code>)</code> saved) - the other one are list comprehensions which are quite usefull - but can be expressed with the <code>do</code> notation - or in this case with a pair of <code>map</code>s - as well"}, {"owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 0, "creation_date": 1444036528, "post_id": 32944488, "comment_id": 53715011, "body": "So the exception I got is caused by both transpose&#39; and matrixProduct since they does not check for empty list?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 0, "creation_date": 1444036662, "post_id": 32944488, "comment_id": 53715092, "body": "yes - I would suggest you play with the different versions and try it for yourself"}, {"owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "edited": false, "score": 0, "creation_date": 1444037142, "post_id": 32944488, "comment_id": 53715372, "body": "Just realized tail recursion is required for transpose.  I am trying to figure it out"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1444035811, "last_edit_date": 1444035811, "creation_date": 1444034866, "answer_id": 32944488, "question_id": 32944035, "link": "https://stackoverflow.com/questions/32944035/exception-prelude-head-empty-list-what-is-the-base-case/32944488#32944488", "title": "***Exception: Prelude.head empty List. What is the base case?", "body": "<p>I fixed the issues I found in your solution and this is what I would get:</p>\n\n<pre><code>transpose :: [[a]] -&gt; [[a]]\ntranspose [] = repeat []\ntranspose (m:ms) = zipWith (:) m (transpose ms)\n\ndotProduct :: [Int] -&gt; [Int] -&gt; Int\ndotProduct xs ys = sum $ zipWith (*) xs ys\n\nmatrixProduct :: [[Int]] -&gt; [[Int]] -&gt; [[Int]]\nmatrixProduct xs ys = [ [dotProduct x y | y &lt;- transpose ys ] | x &lt;- xs ]\n</code></pre>\n\n<p>as you can see this should be really close to the <code>row * col</code> definition of matrix-multiplication (the rows of a matrix in your representation are just the elements of the outer-list and the columns are the elements of the transposed matrix outer-list)</p>\n\n<p>Aside from this I simplified your <code>dotProduct</code> a bit (but yours was fine) and \nfixed your <code>transpose'</code> - which by the way was the source of your error!</p>\n\n<p>I think the basic idea was right but you got into trouble with the base case (which is <code>[]</code> not <code>[[]]</code>) and the way you should map the first row to the transposed rest - also note that you can use <code>repeat []</code> which will give you an infinite list of <code>[]</code> as <code>zipWith</code> will deal with it just fine - if you use <code>[]</code> instead your recursive case will break at <code>zipWith (:) m [] == []</code> and bubble up to just <code>[]</code></p>\n\n<hr>\n\n<p>my <code>transpose</code> is a bit different to yours and maybe to complicated - the problem with yours is that one or more list inside <code>m</code> could be empty which will cause <code>head</code> and <code>tail</code> to fail - so you have to guard this case:</p>\n\n<pre><code>transpose' :: [[a]] -&gt; [[a]]\ntranspose' m\n  | and (map (not . null) m) = (map head m) : transpose' (map tail m)\n  | otherwise = []\n</code></pre>\n\n<ul>\n<li><code>map (not . null) m</code> will check each row if it is non-empty (<code>result: [bool]</code>)</li>\n<li><code>and (map (not . null) m)</code> asserts that all rows are non-empty</li>\n</ul>\n"}], "owner": {"reputation": 174, "user_id": 1829376, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/57a99b4d09f0204222e3cb8f0f00457b?s=128&d=identicon&r=PG", "display_name": "Katharine Kim", "link": "https://stackoverflow.com/users/1829376/katharine-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 32944488, "answer_count": 1, "score": 2, "last_activity_date": 1444035811, "creation_date": 1444033087, "last_edit_date": 1444035072, "question_id": 32944035, "link": "https://stackoverflow.com/questions/32944035/exception-prelude-head-empty-list-what-is-the-base-case", "title": "***Exception: Prelude.head empty List. What is the base case?", "body": "<p>I am writing a function of getting the product of 2 matrix.</p>\n\n<pre><code>transpose' :: [[a]] -&gt; [[a]]\ntranspose' [[]] = []\ntranspose' m = (map head m) : transpose' (map tail m)\n\ndotProduct :: [Int] -&gt; [Int] -&gt; Int\ndotProduct [] [] = 0\ndotProduct (x:xs) (y:ys) = (x*y) + dotProduct xs ys\n\nmatrixProduct :: [[Int]] -&gt; [[Int]] -&gt; [[Int]]\nmatrixProduct [] _ = []\nmatrixProduct (x:xs) y = (map (dotProduct x) (transpose' y)):matrixProduct xs y\n</code></pre>\n\n<p>I always get something like <code>[[2,2, ***Exception: Prelude.head empty List</code></p>\n\n<p>Is it because I have wrong base case for the function?</p>\n\n<p>I am not sure what that should be.</p>\n"}, {"tags": ["haskell", "poker"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1444026057, "post_id": 32942315, "comment_id": 53709801, "body": "We don&#39;t have variables in Haskell! Use <a href=\"http://learnyouahaskell.com/recursion\" rel=\"nofollow noreferrer\">recursion</a>."}, {"owner": {"reputation": 339, "user_id": 2754673, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ff88419b678cac73b5f7766a3af42e9c?s=128&d=identicon&r=PG&f=1", "display_name": "user2754673", "link": "https://stackoverflow.com/users/2754673/user2754673"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1444026212, "post_id": 32942315, "comment_id": 53709872, "body": "At least that i know. But how you going to remember ? about the last hand  or the card other player took from the table? thanks"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1444026243, "post_id": 32942315, "comment_id": 53709886, "body": "Additional arguments to your function."}, {"owner": {"reputation": 339, "user_id": 2754673, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ff88419b678cac73b5f7766a3af42e9c?s=128&d=identicon&r=PG&f=1", "display_name": "user2754673", "link": "https://stackoverflow.com/users/2754673/user2754673"}, "edited": false, "score": 0, "creation_date": 1444026422, "post_id": 32942315, "comment_id": 53709972, "body": "Can you explain that a little. coz in lets say 5th run of the poker. I have to update the variable that was used to remember the thing. and i need all the preserved information of all the rounds happened before.And as much  as i can understand, if you are not storing it in a variable, u&#39;ll need some notion of variable to do that. coz u are remembering."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1444026753, "post_id": 32942315, "comment_id": 53710129, "body": "Think in terms of game positions. A position conpletely determines the state of the game. You pass data that represents a position. A move transforms a position into another position. Start with defining a data type that is able to represent a position."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1444027877, "post_id": 32942315, "comment_id": 53710629, "body": "Yes, put up your code."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1444028031, "post_id": 32942315, "comment_id": 53710692, "body": "@AJFarmar, what do you mean we don&#39;t have variables?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444028180, "post_id": 32942315, "comment_id": 53710771, "body": "@dfeuer As in mutable variables. Speaking for a newbie here."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444029014, "post_id": 32942315, "comment_id": 53711151, "body": "it would be much easier to discuss and answer if you would give us a bit code to work with - for example the way you represent the cards, hands, table, ..."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 0, "creation_date": 1444058868, "post_id": 32942315, "comment_id": 53729343, "body": "I&#39;m trying to answer your question but I&#39;m not sure what you&#39;re asking exactly. The title suggests you just want to know how to deal with mutable state. The code suggests you already know how to use the <code>State</code> monad. I&#39;m not sure if you&#39;re asking about the reasoning behind the understanding (the player AI aspect), or what kind of data structure to use for the players&#39; knowledge, or how to update the understanding data structure. Or do you need suggestions on how to update the game state and deal with players&#39; moves?"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444027799, "post_id": 32942555, "comment_id": 53710579, "body": "What does <code>Reader</code> have to do with it?"}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444028324, "post_id": 32942555, "comment_id": 53710837, "body": "Passes the state of the game. The same recursion, but the data are passed implicitly via monad environment."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444028331, "post_id": 32942555, "comment_id": 53710841, "body": "the edit is better (but you mention the reader-monad while you describe the state-monad) - but still it&#39;s really hard to see how this apply to the question"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1444028625, "post_id": 32942555, "comment_id": 53710980, "body": "I think FRP is quite thoroughly overkill for a poker game."}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1444028669, "post_id": 32942555, "comment_id": 53711000, "body": "I don&#39;t see what is wrong in my answer. For example, citing the mtl library: The Reader monad (also called the Environment monad). Represents a computation, which can read values from a shared environment, pass values from function to function, and execute sub-computations in a modified environment. Using Reader monad for such computations is often clearer and easier than using the State monad. <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/mtl-2.2.1/docs/&hellip;</a>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1444028792, "post_id": 32942555, "comment_id": 53711045, "body": "no it&#39;s harder and it&#39;s useless in this case as you want the <i>state</i>  to stay (not only be modified locally) - what you describe is useful for interpreters or app-configuration - but the <i>state-monad</i> is named that for a reason"}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1444028836, "post_id": 32942555, "comment_id": 53711065, "body": "Yes, I admit that FRP is overkill here, so I added simpler explanation. But I keep it for completeness. It is better to make people aware of what tools are available than always give."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1444028921, "post_id": 32942555, "comment_id": 53711106, "body": "FRP here would be an implementation detail for the interaction - the question is far more basic: it&#39;s how to handle state in a pure setting"}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1444033337, "post_id": 32942555, "comment_id": 53713270, "body": "Ok, I wouldn&#39;t argue with that. Significantly updated the answer -- since I started it, I want finish it properly."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444033903, "post_id": 32942555, "comment_id": 53713534, "body": "now your gamestate is hidden in the main loop - how would the application be able to get a representation of the updated state?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444034002, "post_id": 32942555, "comment_id": 53713583, "body": "also: if you want to go this way (having the events in some kind of handler-loop than you should use something like <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Concurrent-Chan.html#t:Chan\" rel=\"nofollow noreferrer\"><code>Control.Concurrent.Chan</code></a> instead (IMO)"}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 2, "creation_date": 1444034017, "post_id": 32942555, "comment_id": 53713593, "body": "Well the question is a bit vague so you&#39;re not really to blame that it&#39;s hard to formulate a strong answer. But I think you&#39;re drifting off a bit also taking IO into the answer (the question seems to be about the logic inside the game, not so much about user interaction). Since the main question seems to be how to update variables in Haskell, I think the asker would benefit most from an explanation of how to use the <code>State</code>  monad (since this is the go-to solution for this kind of problem). You clearly put quite some effort in the answer but it would benefit from being more to-the-point."}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 0, "creation_date": 1444034041, "post_id": 32942555, "comment_id": 53713607, "body": "Main loop is IO action, right? So one can easily add output action inside it"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444034116, "post_id": 32942555, "comment_id": 53713634, "body": "well yes you could but then the abstraction is useless (I guess you would get the input right there too)"}, {"owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "edited": false, "score": 1, "creation_date": 1444034600, "post_id": 32942555, "comment_id": 53713884, "body": "Ok, the better answer would be to explain State monad, I agree. But since it was not in my original answer, let others give it. I leave the answer as is now, because the office hours started already :)"}, {"owner": {"reputation": 339, "user_id": 2754673, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ff88419b678cac73b5f7766a3af42e9c?s=128&d=identicon&r=PG&f=1", "display_name": "user2754673", "link": "https://stackoverflow.com/users/2754673/user2754673"}, "edited": false, "score": 0, "creation_date": 1444035038, "post_id": 32942555, "comment_id": 53714137, "body": "I thought that might be trivial, but looks lot of not. Thanks for helping me with code."}], "tags": [], "owner": {"reputation": 362, "user_id": 2890057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce508983a0e0cff147c3c2c06f756f?s=128&d=identicon&r=PG", "display_name": "artem", "link": "https://stackoverflow.com/users/2890057/artem"}, "is_accepted": false, "score": 1, "last_activity_date": 1444033781, "last_edit_date": 1444033781, "creation_date": 1444026929, "answer_id": 32942555, "question_id": 32942315, "link": "https://stackoverflow.com/questions/32942315/haskell-variable-updation/32942555#32942555", "title": "Haskell Variable Updation", "body": "<p>If you want to keep it simple and are not ready for advanced Haskell things, you can use recursive transforms, as it was suggested in comments to you question.</p>\n\n<p>The main idea is that you create a data type <code>data Game</code> that fully describes the state of the game; and then you write a function \"player A makes action 1\" that <em>transforms the game</em> (e.g. <code>act:: Player -&gt; Action -&gt; Game -&gt; Game</code>).\nSuch function transforms the full game state:\nit preserves the state from input to the output, but changes some parts of it, related to the player and the action (e.g. adding a card to hand).\nThe last step is to bind the function to the <code>IO</code> actions: in the simplest setting you create a main cycle in which the <code>Game</code> changes, waiting for <code>IO</code> input on each iteration (e.g. just like OpenGL main cycle). Or you can use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Concurrent-MVar.html\" rel=\"nofollow\">Control.Concurrent.MVar</a> to pass <code>IO</code> actions asynchronously.</p>\n\n<p>So, in short code:</p>\n\n<pre><code>-- | State of the AI\ndata Mind = Mind\n    { overallLogic :: ???\n    , perPlayerLogic :: [(PlayerID, Understanding)]\n    }\n\n-- | Undersanding of one player by another player\ndata Understanding = ???\n\nnewtype PlayerID = PlayerID Int\n\n-- | Full state of the player\ndata Player = Player\n    { id :: PlayerID\n    , hand :: [Card]\n    , mind :: Mind\n    , ...\n    }\n\n-- | indication of the game state\ndata Status = PlayersTurn PlayerID | PlayerWon PlayerID\n\n-- | Full state of the game\ndata Game = Game\n    { status :: Status\n    , players :: [Player] -- or consider (Int)Map of player-id\n    , ...\n    }\n\n-- | Events in game are passed from IO: they indicate players' actions\ndata Event = PlayersTurn PlayerID Action ...\n           | WhateverElseEvent\n\n-- | the function to transform Game's state\nreact :: Event -&gt; Game -&gt; Game\nreact ev game = game'\n    where game' = ... -- here is game logic \n</code></pre>\n\n<p>And somewhere you put the main cycle in a separate thread:</p>\n\n<pre><code>mainLoop :: MVar Event -&gt; Game -&gt; IO ()\nmainLoop mevent game = do\n    event &lt;- takeMVar mevent\n    let game' = react event game\n    if checkIfFinished game'\n        then return ()\n        else mainLoop mevent game'\n</code></pre>\n\n<p>Note the tail recursive call - the cycle goes until <code>checkIfFinished</code> returns <code>True</code>. <code>checkIfFinished</code> is your logic to decide whether to finish game or not, based on the <code>Game</code> state.\n<code>takeMVar</code> waits for another thread to put something.\nIn other threads you add IO actions that get user input, make out of them the <code>Event</code> data, and put it using <code>putMVar</code>.</p>\n\n<p><strong>Update:</strong> thanks to comments, I put a bit off-topic part of the answer to the bottom as a \"further reading\".</p>\n\n<p>If you want to remember states <em>globally</em>, GHC offers two types for you:\n<a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-STRef.html\" rel=\"nofollow\">Data.STRef</a> and <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Concurrent-MVar.html\" rel=\"nofollow\">Control.Concurrent.MVar</a>.\nHowever, this is not \"purely functional\" approach.\nYou could read about statefull computations and the reader monad here <a href=\"http://learnyouahaskell.com/for-a-few-monads-more\" rel=\"nofollow\">http://learnyouahaskell.com/</a>. Commentators suggest that the state monad is better than the reader monad for current purposes - thanks, I admit this. Anyway, learnyouahaskell is a great source for these kinds of information :) .</p>\n\n<p>The most purely functional and useful in applications approach would be to use <a href=\"https://wiki.haskell.org/Functional_Reactive_Programming\" rel=\"nofollow\">Functional Reactive Programming</a>.\nThere is a notion of <em>behavior</em> to represent a time-varying value.\nSome people would say FRP is an overkill here, and, probably, they would be right.\nBut when you decide to add a GUI and other IO, using nice interfaces provided by e.g. <a href=\"https://wiki.haskell.org/Reactive-banana\" rel=\"nofollow\">reactive-banana</a> will simplify your life significantly.</p>\n"}], "owner": {"reputation": 339, "user_id": 2754673, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ff88419b678cac73b5f7766a3af42e9c?s=128&d=identicon&r=PG&f=1", "display_name": "user2754673", "link": "https://stackoverflow.com/users/2754673/user2754673"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444037868, "creation_date": 1444025787, "last_edit_date": 1592644375, "question_id": 32942315, "link": "https://stackoverflow.com/questions/32942315/haskell-variable-updation", "title": "Haskell Variable Updation", "body": "<ul>\n<li>I'm building a game (kind of poker) in haskell but i'm new to haskell and generally get stuck when try to think how to implement a thing in purely functional language.*</li>\n</ul>\n<blockquote>\n<p>Game is of 3 players(Just to make it easy to explain). Two players will play                                            from the table cards and one will play from the stack. Both kinds of players will take one card and use it if useful(replace one of your card in hand) or just dump it(if not). <strong>Winning is just full-house or a straight</strong>.</p>\n<p>The Two of them have some <strong><code>understanding</code></strong>, something they agree before to help each other. Like if i took K (lets say) from table and next hand i took a 4 from the table means i'm going for a full house and hence you should help if you can in any possible way. Each of these player should help each other so that one of them should win before the player playing with the stack but not at the cost of oneself.</p>\n<p>Table has total 5 cards and so does each player</p>\n</blockquote>\n<p>Implement Understanding between two players :</p>\n<p>I'm stuck how to track what other player have took from the table.  I'm trying to do that by adding the cards to my hand itself (Virtually remembering the thing) and while dong calculations of my hand (real) i'm going to take only first five of cards and while doing calculation for helping him i'm going to drop five cards and then do calculations with that.\nIs there any better strategy to do the same?? It might be trivial but i'm amateur in world of haskell. If you want code I can just put it up.</p>\n<p>basic set up of my Game :</p>\n<pre><code>data Card = Card {\n    c :: (Int, Char) \n   } deriving (Eq, Ord, Show)\n\ndata Deck = Deck {\n   d :: [Card]\n} deriving (Show, Eq, Ord)  \n\ndata Game = Game {\n  bact1Hand :: [Card],\n  bact2Hand :: [Card],\n  orgHand  :: [Card],\n  tableCards :: [Card],\n  deck :: Deck\n} deriving (Show, Eq, Ord)  \n\ntype GameState a = State Game a`\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7579, "user_id": 453261, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PfNvQ.jpg?s=128&g=1", "display_name": "The Internet", "link": "https://stackoverflow.com/users/453261/the-internet"}, "edited": false, "score": 6, "creation_date": 1444012920, "post_id": 32940455, "comment_id": 53706413, "body": "<a href=\"http://stackoverflow.com/questions/6724434/how-to-debug-haskell-code\" title=\"how to debug haskell code\">stackoverflow.com/questions/6724434/how-to-debug-haskell-cod&zwnj;&#8203;e</a>"}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 2, "last_activity_date": 1444045885, "last_edit_date": 1495541725, "creation_date": 1444045476, "answer_id": 32947825, "question_id": 32940455, "link": "https://stackoverflow.com/questions/32940455/debugging-loop-in-haskell/32947825#32947825", "title": "Debugging loop in haskell", "body": "<p>I looked at <a href=\"https://stackoverflow.com/questions/6724434/how-to-debug-haskell-code\">the question</a> @TheInternet linked, and the first answer's advice to use <s><code>-fbreak-on-exception</code></s><code>-fbreak-on-error</code> and <code>:trace</code> is pretty good. However I thought I'd mention two small snags I hit that are specific to this question:</p>\n\n<ol>\n<li>GHCi does <em>not</em> make <code>&lt;&lt;loop&gt;&gt;</code> exceptions, only native compiled GHC does that, and the GHCi debugger cannot trace native compiled code.</li>\n</ol>\n\n<p>Fortunately, this can be solved by pressing <code>^C</code> to interrupt manually.</p>\n\n<ol start=\"2\">\n<li>Trying to <code>:trace</code> and then <code>^C</code> manually instead does give a debugger session, but GHCi hasn't inserted any breakpoints and so there's no context to debug!</li>\n</ol>\n\n<p>This was also easy to fix: I just changed the first equation to <code>x = id y</code>. This is enough to get GHCi to insert breakpoints. I suspect that this problem was due to the OP's code cycle containing only trivial variable equations (to quote <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci-debugger.html#setting-breakpoints\" rel=\"nofollow noreferrer\">the GHC User's Guide</a>: \"<em>Single variables are typically not considered to be breakpoint locations (unless the variable is the right-hand-side of a function definition, lambda, or case alternative)</em>\"), and that it will not usually happen in \"real\" code.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 32947825, "answer_count": 1, "score": 3, "last_activity_date": 1444045885, "creation_date": 1444011979, "last_edit_date": 1444013266, "question_id": 32940455, "link": "https://stackoverflow.com/questions/32940455/debugging-loop-in-haskell", "title": "Debugging loop in haskell", "body": "<p>Say I had the following code in Haskell:</p>\n\n<pre><code>x :: Int\ny :: Int\nz :: Int\nx=y\ny=z\nz=x\n</code></pre>\n\n<p>Naturally, referring to any of these variables causes execution to bomb with <code>&lt;&lt;loop&gt;&gt;</code> if using ghc or spin infinitely if using ghci. I'm working on some code that has high potential for circularity if miscoded - is there any way to debug <code>&lt;&lt;loop&gt;&gt;</code> - can I examine the stack when it bombs to see the circularity?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 8, "last_activity_date": 1444019039, "last_edit_date": 1444019039, "creation_date": 1443994418, "answer_id": 32938651, "question_id": 32938441, "link": "https://stackoverflow.com/questions/32938441/implementing-alpha-equivalence-haskell/32938651#32938651", "title": "Implementing alpha equivalence - Haskell", "body": "<p>Yes, using a <code>Map</code> a correct idea (though think on what the key and value types should be; with <code>Map Name Int</code> you need two extra arguments instead of one). You need to add it as the argument of a helper function, I won't give the full implementation since you asked for a clue only:</p>\n\n<pre><code>alpha_eq e1 e2 = alpha_eq' e1 e2 env0 where\n  env0 = ???\n  alpha_eq' (Var x) (Var y) env = ???\n  alpha_eq' (Lambda x e1) (Lambda y e2) env = ???\n  alpha_eq' (App e1 e2) (App e3 e4) env = ???\n  -- you don't want to throw an error in all other cases\n  alpha_eq' _ _ env = ???\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1286, "user_id": 675799, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/87c5d0a7b707c5bfc04b415e96edef11?s=128&d=identicon&r=PG", "display_name": "krokodil", "link": "https://stackoverflow.com/users/675799/krokodil"}, "edited": false, "score": 0, "creation_date": 1529853438, "post_id": 32943074, "comment_id": 89015126, "body": "The substitution approach will fail on: <code>Lam &quot;x&quot; (Var &quot;x&quot;)</code> and <code>Lam &quot;y&quot; (Var &quot;x&quot;)</code>. It will report that these 2 are equivalent, while they are not"}, {"owner": {"reputation": 607, "user_id": 2436412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07531356cc096dc9551e1ac5983f651d?s=128&d=identicon&r=PG", "display_name": "Heimdell", "link": "https://stackoverflow.com/users/2436412/heimdell"}, "reply_to_user": {"reputation": 1286, "user_id": 675799, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/87c5d0a7b707c5bfc04b415e96edef11?s=128&d=identicon&r=PG", "display_name": "krokodil", "link": "https://stackoverflow.com/users/675799/krokodil"}, "edited": false, "score": 0, "creation_date": 1530103827, "post_id": 32943074, "comment_id": 89116292, "body": "So, to fix this we can replace each name with unique one."}, {"owner": {"reputation": 1286, "user_id": 675799, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/87c5d0a7b707c5bfc04b415e96edef11?s=128&d=identicon&r=PG", "display_name": "krokodil", "link": "https://stackoverflow.com/users/675799/krokodil"}, "edited": false, "score": 0, "creation_date": 1530140864, "post_id": 32943074, "comment_id": 89134818, "body": "All I am saying that it leads us to the concept of &quot;capture-avoiding substitution&quot; which is well described in the literature and worth looking at in the context of this question."}], "tags": [], "owner": {"reputation": 607, "user_id": 2436412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07531356cc096dc9551e1ac5983f651d?s=128&d=identicon&r=PG", "display_name": "Heimdell", "link": "https://stackoverflow.com/users/2436412/heimdell"}, "is_accepted": false, "score": 4, "last_activity_date": 1444029178, "creation_date": 1444029178, "answer_id": 32943074, "question_id": 32938441, "link": "https://stackoverflow.com/questions/32938441/implementing-alpha-equivalence-haskell/32943074#32943074", "title": "Implementing alpha equivalence - Haskell", "body": "<p>You could also make separate function <code>subst :: Name -&gt; Exp -&gt; Exp -&gt; Exp</code>. Then, <code>alpha_eq</code> Lam-case becomes</p>\n\n<pre><code>alpha_eq :: Exp -&gt; Exp -&gt; Bool\n...\nalpha_eq (Lam x xb) (Lam y yb) = xb `alpha_eq` subst y (Var x) yb\n...\n</code></pre>\n\n<p>Excersise: figure out other <code>alpha_eq</code> cases and implementation of <code>subst</code>.</p>\n"}], "owner": {"reputation": 9123, "user_id": 1040718, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u0SVy.jpg?s=128&g=1", "display_name": "cybertextron", "link": "https://stackoverflow.com/users/1040718/cybertextron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 2, "accepted_answer_id": 32938651, "answer_count": 2, "score": 1, "last_activity_date": 1444029178, "creation_date": 1443992995, "last_edit_date": 1444027853, "question_id": 32938441, "link": "https://stackoverflow.com/questions/32938441/implementing-alpha-equivalence-haskell", "title": "Implementing alpha equivalence - Haskell", "body": "<p>So let me define a few things:</p>\n\n<pre><code>type Name = String\n\ndata Exp = Var Name \n         | App Exp Exp\n         | Lam Name Exp\n  deriving (Eq,Show,Read)\n</code></pre>\n\n<p>I want to define <code>alpha-equivalence</code>, which is </p>\n\n<pre><code>alpha_eq :: Exp -&gt; Exp -&gt; Bool\n-- The terms x and y are not alpha-equivalent, because they are not bound in a lambda abstraction \nalpha_eq (Var x) (Var y) = False\nalpha_eq (Lam x e1) (Lam y e2) = False\nalpha_eq (App e1 e2) (App e3 e4) = False\n</code></pre>\n\n<p>For example <code>Lam \"x\" (Var \"x\")</code> and <code>Lam \"y\" (Var \"y\")</code> are both equivalent. However I'm both new and horrible at <code>Haskell</code>. Could someone give a clue of how to implement <code>alpha_eq</code>? One thing I thought about was to use <code>Map Name Int</code> so in this case I would have:</p>\n\n<pre><code>['x' -&gt; 0] ['y' -&gt; 0]\n</code></pre>\n\n<p>so in this case <code>Map['x'] == Map['y']</code>. But again I'm horrible at Haskell. Could you someone give me a clue how to implement it? </p>\n"}, {"tags": ["haskell", "glib", "cabal-install", "ihaskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1443990219, "post_id": 32937659, "comment_id": 53701327, "body": "<i>gilb</i>  and <i>cairo</i> are part of the GTK+ toolkit; as that is a non-Haskell dependency you need to install it in your system separately (I don&#39;t know what is the most convenient way of doing that in OSX)."}, {"owner": {"reputation": 128340, "user_id": 41116, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VWGUO.jpg?s=128&g=1", "display_name": "Abizern", "link": "https://stackoverflow.com/users/41116/abizern"}, "edited": false, "score": 0, "creation_date": 1443995503, "post_id": 32937659, "comment_id": 53703034, "body": "On OS X you can install it using homebrew"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 3, "creation_date": 1443999629, "post_id": 32937659, "comment_id": 53703914, "body": "I don&#39;t understand why this question got downvoted."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1444032435, "post_id": 32937659, "comment_id": 53712821, "body": "Because the author obviously didn&#39;t even attempt to do any research on their own.  A simple Google search for &quot;glib&quot; would have told them what it is, and &quot;glib osx&quot; would have told them how to install it on OS X (the second result for me is a SO post which suggests <code>brew install glib</code>)."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1444045829, "post_id": 32937659, "comment_id": 53720506, "body": "@nemequ: My bad. The searches I did (obviously not?) do \u2014 &quot;haskell glib&quot;, &quot;cabal glib&quot;, etc. \u2014 yielded no useful (and sometimes confusing) results."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444091165, "post_id": 32937659, "comment_id": 53744787, "body": "There are <a href=\"https://wiki.haskell.org/Gtk2Hs/Installation\" rel=\"nofollow noreferrer\">detailed instructions for installing Gtk2Hs</a>, including a page <a href=\"https://wiki.haskell.org/Gtk2Hs/Mac\" rel=\"nofollow noreferrer\">specifically devoted to OSX</a>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444675306, "post_id": 32937659, "comment_id": 53992335, "body": "@DanielWagner: That would make an accepted answer if elaborated a bit."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444675711, "post_id": 32937659, "comment_id": 53992517, "body": "@raxacoricofallapatorius I won&#39;t do that, because I don&#39;t have a Mac and I can&#39;t verify what&#39;s actually worked for me. But it&#39;s perfectly good etiquette to answer your own question once you&#39;ve discovered something that works -- so I say write up the answer you&#39;d accept, and accept it!"}], "answers": [{"tags": [], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "is_accepted": true, "score": 1, "last_activity_date": 1444743171, "creation_date": 1444743171, "answer_id": 33104068, "question_id": 32937659, "link": "https://stackoverflow.com/questions/32937659/cant-install-ihaskell-diagrams-using-cabal/33104068#33104068", "title": "Can&#39;t install &#39;ihaskell-diagrams&#39; using Cabal", "body": "<p>The confusion here results from the perhaps unclear error message: the missing components are <em>not</em> Cabal packages, but libraries that need to be separately installed. </p>\n\n<p>Some of these libraries have their own dependencies, or installing them may reveal additional missing packages, so that the specific requirements on your system my be different; but in general, when you get an error that a \"pig-config package\" is missing, you will need to install it with your package manager (not Cabal).</p>\n\n<p>For example, </p>\n\n<pre><code>brew install glib\nbrew install cairo\nbrew install pango\n</code></pre>\n\n<p>work for me and allow me to </p>\n\n<pre><code>cabal install ihaskell-diagrams\n</code></pre>\n\n<p>without further errors.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 33104068, "answer_count": 1, "score": 0, "last_activity_date": 1444743171, "creation_date": 1443987906, "question_id": 32937659, "link": "https://stackoverflow.com/questions/32937659/cant-install-ihaskell-diagrams-using-cabal", "title": "Can&#39;t install &#39;ihaskell-diagrams&#39; using Cabal", "body": "<p>When I try to </p>\n\n<pre><code>cabal install ihaskell-diagrams\n</code></pre>\n\n<p>I get the error</p>\n\n<blockquote>\n  <p>The pkg-config package 'glib-2.0' is required but it could not be\n  found.</p>\n</blockquote>\n\n<p>What is <code>glib</code> and how do I install it so that it is available for Cabal?</p>\n\n<hr>\n\n<pre><code>Resolving dependencies...\nConfiguring cairo-0.13.1.0...\nConfiguring glib-0.13.2.1...\nFailed to install cairo-0.13.1.0\nBuild log ( /Users/Rax/.cabal/logs/cairo-0.13.1.0.log ):\n[1 of 2] Compiling SetupWrapper     ( /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57646/cairo-0.13.1.0/SetupWrapper.hs, /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57646/cairo-0.13.1.0/dist/setup/SetupWrapper.o )\n[2 of 2] Compiling Main             ( /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57646/cairo-0.13.1.0/dist/setup/setup.hs, /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57646/cairo-0.13.1.0/dist/setup/Main.o )\nLinking /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57646/cairo-0.13.1.0/dist/setup/setup ...\n[1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist/setup-wrapper/Gtk2HsSetup.o )\n[2 of 2] Compiling Main             ( SetupMain.hs, dist/setup-wrapper/Main.o )\nLinking dist/setup-wrapper/setup ...\nConfiguring cairo-0.13.1.0...\nsetup: The pkg-config package 'cairo' version &gt;=1.2.0 is required but it could\nnot be found.\nFailed to install glib-0.13.2.1\nBuild log ( /Users/Rax/.cabal/logs/glib-0.13.2.1.log ):\n[1 of 2] Compiling SetupWrapper     ( /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57647/glib-0.13.2.1/SetupWrapper.hs, /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57647/glib-0.13.2.1/dist/setup/SetupWrapper.o )\n[2 of 2] Compiling Main             ( /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57647/glib-0.13.2.1/dist/setup/setup.hs, /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57647/glib-0.13.2.1/dist/setup/Main.o )\n\nLinking /var/folders/b6/3rk65h797p7407x7d36sqn9c0000gn/T/cabal-tmp-57647/glib-0.13.2.1/dist/setup/setup ...\n[1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist/setup-wrapper/Gtk2HsSetup.o )\n[2 of 2] Compiling Main             ( SetupMain.hs, dist/setup-wrapper/Main.o )\nLinking dist/setup-wrapper/setup ...\nConfiguring glib-0.13.2.1...\nsetup: The pkg-config package 'glib-2.0' is required but it could not be\nfound.\ncabal: Error: some packages failed to install:\ncairo-0.13.1.0 failed during the configure step. The exception was:\nExitFailure 1\ndiagrams-cairo-1.3.0.5 depends on glib-0.13.2.1 which failed to install.\nglib-0.13.2.1 failed during the configure step. The exception was:\nExitFailure 1\nihaskell-diagrams-0.3.1.0 depends on glib-0.13.2.1 which failed to install.\npango-0.13.1.0 depends on glib-0.13.2.1 which failed to install.\n</code></pre>\n"}, {"tags": ["haskell", "stream", "lazy-evaluation", "fibonacci", "lazy-sequences"], "comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 1, "creation_date": 1443988403, "post_id": 32937621, "comment_id": 53700762, "body": "Why was this downvoted?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443989243, "post_id": 32937621, "comment_id": 53701003, "body": "Where did you get <code>0 : 1 : [1] : [1,2] : [1,2,3]</code> from?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443989257, "post_id": 32937621, "comment_id": 53701009, "body": "Because <code>0 : 1 : zipWith (+) [0,1] [1]</code> yields <code>[1]</code> and <code>zipWith (+) [0,1,1] [1,1]</code> yields <code>[1,2]</code> etc."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443989387, "post_id": 32937621, "comment_id": 53701045, "body": "It&#39;s not zipping <code>[0,1,1,...]</code> with <code>[1,1,...]</code>. And it&#39;s not making a list of intermediate lists either."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443989405, "post_id": 32937621, "comment_id": 53701049, "body": "What is it doing then"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443989511, "post_id": 32937878, "comment_id": 53701084, "body": "You&#39;re really quick on the draw today."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1443989629, "post_id": 32937878, "comment_id": 53701123, "body": "I&#39;m displacing massively from things I must do but don&#39;t want to."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443989983, "post_id": 32937878, "comment_id": 53701240, "body": "The complaint expressed in the digression is rather annoying WRT the implementation of <code>zipWith</code> in <code>Data.Sequence</code> and also anything done with <code>Traversable</code> that relies on two traversals of the same structure hitting the same number of elements both times."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 11, "last_activity_date": 1443989463, "creation_date": 1443989463, "answer_id": 32937878, "question_id": 32937621, "link": "https://stackoverflow.com/questions/32937621/can-someone-explain-this-lazy-fibonacci-solution/32937878#32937878", "title": "Can someone explain this lazy Fibonacci solution?", "body": "<p>Your \"Because\" is not telling the whole story. You're truncating the lists at \"the story so far\" and evaluating eagerly, then wondering where the rest comes from. That's not quite to grasp what's really going on, so good question.</p>\n\n<p>What gets computed when you make the definition</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (drop 1 fibs)\n</code></pre>\n\n<p>? Very little. Computation starts once you begin to <em>use</em> the list. Lazy computation happens only on demand.</p>\n\n<p>What's a demand? You get to ask \"are you <code>[]</code> or <code>x : xs</code>?\" and if it's the latter, you get a handle on the pieces.</p>\n\n<p>When we ask that question of <code>fibs</code>, we get that</p>\n\n<pre><code>fibs = x0 : xs0\nx0  = 0\nxs0 = 1 : zipWith (+) fibs (drop 1 fibs)\n</code></pre>\n\n<p>but that means (substituting for <code>fibs</code> and then <code>x0</code>)</p>\n\n<pre><code>xs0 = 1 : zipWith (+) (0 : xs0) (drop 1 (0 : xs0))\n</code></pre>\n\n<p>and when we ask again, we get that</p>\n\n<pre><code>xs0 = x1 : xs1\nx1  = 1\nxs1 = zipWith (+) (0 : xs0) (drop 1 (0 : xs0))\n</code></pre>\n\n<p>so</p>\n\n<pre><code>xs1 = zipWith (+) (0 : 1 : xs1) (drop 1 (0 : 1 : xs1))\n</code></pre>\n\n<p>but now it gets interesting, because we have to do some work. Just enough work to answer the question, mind? When we look at <code>xs1</code>, we force <code>zipWith</code> which forces <code>drop</code>.</p>\n\n<pre><code>xs1 = zipWith (+) (0 : 1 : xs1) (drop 1 (0 : 1 : xs1))\n    = zipWith (+) (0 : 1 : xs1) (1 : xs1)\n    = (0 + 1) : zipWith (+) (1 : xs1) xs1\n</code></pre>\n\n<p>so</p>\n\n<pre><code>xs1 = x2 : xs2\nx2  = 0 + 1 = 1\nxs2 = zipWith (+) (1 : xs1) xs1\n    = zipWith (+) (1 : 1 : xs2) (1 : xs2)\n</code></pre>\n\n<p>See? We've maintained that we still know the first two elements of one zipped list, and the first element of the other. That means we'll be able to deliver the next output <em>and</em> refresh our \"buffer\". When we look at <code>xs2</code>, we get</p>\n\n<pre><code>xs2 = zipWith (+) (1 : 1 : xs2) (1 : xs2)\n    = (1 + 1) : zipWith (1 : xs2) xs2\nxs2 = x3 : xs3\nx3  = 1 + 1 = 2\nxs3 = zipWith (1 : xs2) xs2\n    = zipWith (1 : 2 : xs3) (2 : xs3)\n</code></pre>\n\n<p>and we're good to go again!</p>\n\n<p>Each time we demand the next element, we also move one step further away from <code>zipWith</code> running out of elements, which is just as well, just in the nick of time.</p>\n\n<p>None of the discipline that makes values show up in the nick of time is expressed in the types. At the moment, it's for programmers to make sure that well typed programs don't go wrong by running out of data when a demand is made. (I have plans to do something about that, but I'll try not to digress here.)</p>\n\n<p>The key is that lazy, \"on demand\" computation means that we <em>don't</em> have to truncate lists to just the elements we can see when the process starts. We just need to know that we can always take the next step.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 3, "accepted_answer_id": 32937878, "answer_count": 1, "score": 4, "last_activity_date": 1445759811, "creation_date": 1443987690, "last_edit_date": 1445759811, "question_id": 32937621, "link": "https://stackoverflow.com/questions/32937621/can-someone-explain-this-lazy-fibonacci-solution", "title": "Can someone explain this lazy Fibonacci solution?", "body": "<p>This is the code:  </p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (drop 1 fibs)\n</code></pre>\n\n<p>When evaluated, <code>fibs</code> is an infinite list of Fibonacci numbers. What I don't understand is how the list is concatenated. </p>\n\n<p><code>zipWith</code> returns a list, so zipping <code>fibs</code> would yield this:</p>\n\n<pre><code>0 : 1 : [1] : [1,2] : [1,2,3]\n</code></pre>\n\n<p>Because <code>0 : 1 : zipWith (+) [0,1] [1]</code> yields <code>[1]</code> and <code>zipWith (+) [0,1,1] [1,1]</code> yields <code>[1,2]</code> etc).</p>\n\n<p>However, when I run the code, I get the correct result.</p>\n\n<p>What am I not understanding here?</p>\n"}, {"tags": ["haskell", "binary-tree"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1443982511, "post_id": 32936657, "comment_id": 53698738, "body": "To get your hands on <code>&lt;|&gt;</code> you may need to add <code>import Control.Applicative</code> to the preamble of your file, just after the <code>module</code> line."}, {"owner": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1443982769, "post_id": 32936657, "comment_id": 53698826, "body": "Can you explain me the third line in the code please"}, {"owner": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1443983041, "post_id": 32936657, "comment_id": 53698925, "body": "What is L: and R: in the above code ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443983240, "post_id": 32936657, "comment_id": 53699001, "body": "It appears that this code is probably not at the right &quot;level&quot; for you just yet. You should probably work your way through some more introductory material before you get to this. We <i>could</i> explain it directly (none of the concepts are particularly complicated; there are just a number of different ones stacked up on top of each other), but you&#39;d likely end up just overwhelmed."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1443983254, "post_id": 32936657, "comment_id": 53699008, "body": "Big picture: we&#39;re trying to find the path inside a tree to the leftmost-outermost copy of <code>x</code>. So, we need to find a <code>Node y l r</code> where <code>x == y</code> is <code>True</code>. We&#39;re using <code>Maybe</code> to model the possibility of failure (as <code>x</code> may be nowhere), and we&#39;re trying to compute a list of directions that take us from the root to the <code>Node</code> with the copy of <code>x</code>. The <code>L</code> and <code>R</code> are directions &quot;left&quot; and &quot;right&quot; and the <code>:</code> is the &quot;cons&quot; function which extends a list by one element at the front. The detail of the code isn&#39;t quite right."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443983550, "post_id": 32936657, "comment_id": 53699099, "body": "@dfeuer I suspect you&#39;re right. @Newbie, the <code>fmap</code> and <code>&lt;|&gt;</code> are doing some neat but advanced management of the search logic. It takes a while to learn that method, but you can get the same results with simpler tools. Have you seen the <code>case</code> construct yet?"}, {"owner": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "edited": false, "score": 0, "creation_date": 1443983745, "post_id": 32936657, "comment_id": 53699182, "body": "How to implement the same 3rd line using <code>case</code> ?"}, {"owner": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "edited": false, "score": 0, "creation_date": 1443984265, "post_id": 32936657, "comment_id": 53699368, "body": "I have tried this -<code>inTree:: Eq a =&gt; a -&gt; Tree a -&gt; Maybe [Direction] inTree x End = Nothing inTree x (Node y l r ) | x == y = Just [] | l\\=Empty = L:(inTree x l)</code> . But I get this error <code>Couldn&#39;t match expected type \u2018Maybe Direction\u2019                 with actual type \u2018[Maybe Direction] -&gt; [Maybe Direction]</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1443984269, "post_id": 32936657, "comment_id": 53699371, "body": "@Newbie, you should read about <code>case</code> in a tutorial like &quot;Learn You a Haskell&quot;. Once you&#39;ve done that, you should be able to implement this without using any functions aside from <code>==</code>."}], "owner": {"reputation": 2394, "user_id": 2559838, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/68b75dc3b6cd88e1ffb66708587c144c?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/2559838/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 599, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443985454, "creation_date": 1443982013, "last_edit_date": 1495542147, "question_id": 32936657, "link": "https://stackoverflow.com/questions/32936657/trace-path-of-a-node-binary-tree-in-haskell", "title": "Trace path of a node Binary Tree in Haskell", "body": "<p>I am new to Haskell and I am trying to trace the path of a node in binary tree from the root . \nI followed this link in SO :- <a href=\"https://stackoverflow.com/questions/21770559/trying-to-implement-path-record-for-haskell-binary-tree-search\">Trying to implement path record for Haskell binary tree search</a></p>\n\n<p>I modified the code for better understanding </p>\n\n<pre><code>inTree:: Eq a =&gt; a -&gt; Tree a -&gt; Maybe [Direction]\ninTree x End = Nothing\ninTree x (Node y l r ) = if (x == y) then  Just [] else (fmap (L:) (inTree x (Node _ l _ )) &lt;|&gt; (fmap (R:) (inTree x (Node _ _ r))))\n</code></pre>\n\n<p>But I got the following error when I tried to compile it :-</p>\n\n<pre><code> Not in scope: \u2018&lt;|&gt;\u2019\n    Perhaps you meant one of these:\n      \u2018&lt;$&gt;\u2019 (imported from Prelude), \u2018&lt;*&gt;\u2019 (imported from Prelude)\n</code></pre>\n\n<p>Can anyone please help me fix this </p>\n\n<p>Also , can anyone please explain the <code>3rd line</code> in the code above .\nWhat is <code>L:</code> and what is <code>R:</code> ?</p>\n\n<p>Edit -- </p>\n\n<p>After reading the comments , I have tried this using <code>case construct</code> but I have ran into the following error :-</p>\n\n<pre><code>inTree:: Eq a =&gt; a -&gt; Tree a -&gt; Maybe [Direction] \ninTree x End = Nothing\ninTree x (Node y l r ) | x == y = Just [] | l\\=Empty = L:(inTree x l)\n</code></pre>\n\n<p>error <code>Couldn't match expected type \u2018Maybe Direction\u2019 with actual type \u2018[Maybe Direction] -&gt; [Maybe Direction]</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443982765, "post_id": 32936592, "comment_id": 53698824, "body": "Haskell&#39;s numeric classes are pretty shady. They make some rather peculiar assumptions about how numbers work. The first shady assumption in play here is that if something is a numeric type (<code>Num</code>) then there must be a way to build values from integers: <code>fromInteger :: Num a =&gt; Integer -&gt; a</code> is a method of the <code>Num</code> class. The next shady notion is that there&#39;s a sensible concept of a numeric type being &quot;integral&quot; (<code>Integral</code>), which among other things gives the odd method <code>toInteger :: Integral a =&gt; a -&gt; Integer</code>. (cont)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443982866, "post_id": 32936592, "comment_id": 53698853, "body": "Smashing these strange ideas together gives <code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b; fromIntegral x = fromInteger (toInteger x)</code>. As you probably can see quite easily, this bizarre hack would lead to horribly inefficient coercions, which is why the standard library is full of compiler rewrite rules to patch them up to sanity."}, {"owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443983298, "post_id": 32936592, "comment_id": 53699024, "body": "Wow, I see. That&#39;s pretty bad, and it explains how you can convert 50000 to 80 implicitly by accident, as the <code>fromInteger</code> method for <code>Word8</code> can basically do whatever it wants even though it&#39;s called implicitly."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443984004, "post_id": 32936592, "comment_id": 53699275, "body": "The only time it&#39;s called implicitly is when reading numeric literals. The rest of the time, you just have to know how it behaves. In some ways, it&#39;s nice that it just chops high bits off as needed. Going from a larger type to a smaller one (but not the other way around), <code>fromIntegral x + fromIntegral y = fromIntegral (x + y)</code> and <code>fromIntegral x * fromIntegral y = fromIntegral (x * y)</code>."}, {"owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443984162, "post_id": 32936592, "comment_id": 53699327, "body": "I don&#39;t understand why it calls it when reading numeric literals. In this case, <code>n</code> is a <code>Num b =&gt; b</code> that can be used as a <code>Word8</code> without explicit cast. Is <code>fromIntegral</code> not called when that happens? If not, what is called implicitly? I imagine it&#39;s whatever function that converts <code>Num b =&gt; b</code> to <code>Word8</code> that chops off the bits."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443984578, "post_id": 32936592, "comment_id": 53699493, "body": "I&#39;m not sure what you&#39;re saying there. A numeric literal that looks like an integer is interpreted as meaning, say, <code>fromInteger 5</code> (where that&#39;s a special <code>Integer</code>-only <code>5</code>) and given type <code>Num a =&gt; a</code>. A numeric literal that does not look like an integer is interpreted as meaning, say, <code>fromRational 4.79</code> and given type <code>Fractional a =&gt; a</code>. Thus <code>5</code> can be used for <i>any</i> <code>Num</code>, but <code>4.79</code> can only be used for <code>Fractional</code> things."}, {"owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443984752, "post_id": 32936592, "comment_id": 53699557, "body": "If I have a Num 5 (which for the sake of argument I get from saying <code>fromIntegral 5</code>, it calls <code>fromInteger . toInteger</code> (which is how <code>fromIntegral is implemented</code>, but we lose no data. In other words, if I call <code>toInteger $ fromIntegral 50000</code>, I get 50000 back. However, if I call <code>toInteger (fromIntegral 50000 :: Word8)</code>, I get 80. If I define a <code>Word8 -&gt; Int</code> called <code>integrateWord x</code> as <code>toInteger x</code>, and then I call it with <code>integrateWord $ fromIntegral 50000</code>, it returns 80. Some conversion from Int to Word8 is happening implicitly. Where is that?"}, {"owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443985434, "post_id": 32936592, "comment_id": 53699771, "body": "That comment got mangled, unfortunately. I&#39;m not sure how. If I have a <code>Word8 -&gt; Int</code> which is implemented as <code>toInteger x</code> and I pass it the literal <code>50000</code>, I get back 80. Where does the conversion from <code>50000 :: (Num a) =&gt; a</code> to <code>80 :: Word8</code> happen? Some function must be called implicitly."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443985711, "post_id": 32936592, "comment_id": 53699883, "body": "The <code>fromInteger</code> function is implicitly called for every literal that looks like an integer. When you see <code>50000</code> in the source, you need to read it as <code>fromInteger #50000</code>, where <code>#50000</code> is a made-up name for the version that is always <code>Integer</code>. So <code>toInteger 50000</code> is read as <code>toInteger (fromInteger #50000)</code>."}, {"owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443985776, "post_id": 32936592, "comment_id": 53699903, "body": "I understand, but that returns  a <code>Num</code>, not a <code>Word8</code>. My question is now how <code>Num</code> gets converted to <code>Word8</code> (the conversion from literal/<code>Integer</code> to <code>Num</code> obviously does not chop off all but one byte)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "edited": false, "score": 0, "creation_date": 1443985840, "post_id": 32936592, "comment_id": 53699919, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/91317/discussion-between-dfeuer-and-river-tam\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "edited": false, "score": 0, "creation_date": 1443983130, "post_id": 32936736, "comment_id": 53698954, "body": "I think I understand, for the most part. I guess it&#39;s fascinating and a bit hard to reason about how in Haskell you can actually have a &quot;generic type&quot; object. I think in the future I&#39;ll basically always try to do explicit casts. I&#39;m a bit surprised requiring explicit casts isn&#39;t required in the language, as I imply in the question."}, {"owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "edited": false, "score": 0, "creation_date": 1443983602, "post_id": 32936736, "comment_id": 53699122, "body": "Just to clarify, and please correct me if I&#39;m wrong, but essentially the <code>dictFromInteger</code> function is defined somewhere (probably by another name) by the library that defines <code>Word8</code>, and this is the function that is free to give up data (e.g. 50000 -&gt; 80)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "edited": false, "score": 0, "creation_date": 1443984044, "post_id": 32936736, "comment_id": 53699287, "body": "@RiverTam Yes, it is indeed defined alongside the definition of <code>Word8</code>. Note that in Haskell we do not call <code>someExpression :: SomeType</code> a &quot;cast&quot;, since this does not always lead to data conversion -- we prefer to call that a &quot;type annotation&quot;. E.g. in <code>[] :: [Char]</code> the type is used only to instantiate the polymorphic type of the empty list; in <code>id :: Int -&gt; Int</code> we similarly instantiate the polymorphic function into a monomoprhic one. No conversion is ever performed here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "edited": false, "score": 0, "creation_date": 1443984192, "post_id": 32936736, "comment_id": 53699348, "body": "@RiverTam It is also used to pick a specific instance of a type class: if I write <code>(+) :: Int-&gt;Int-&gt;Int</code> I make the compiler search for <code>instance Num Int</code> in the imported modules, and find the actual implementation of <code>(+)</code>. This also happens, implicitly (!), if I write <code>(2::Int) + 4</code> since the compiler can deduce the exact type of <code>(+)</code>. Similarly for <code>f :: Int-&gt;Int ; f x = x+1</code>. Type information is propagated outwards and inwards during type inference."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1443982853, "last_edit_date": 1443982853, "creation_date": 1443982524, "answer_id": 32936736, "question_id": 32936592, "link": "https://stackoverflow.com/questions/32936592/how-can-an-arbitrary-num-contain-any-other-numeric-type/32936736#32936736", "title": "How can an arbitrary Num contain any other numeric type?", "body": "<p>A common implementation of type classes such as <code>Num</code> is dictionary-passing. Roughly, when the compiler sees something like</p>\n\n<pre><code>f :: Num a =&gt; a -&gt; a\nf x = x + 2\n</code></pre>\n\n<p>it transforms it into something like</p>\n\n<pre><code>f :: (Integer -&gt; a, a -&gt; a -&gt; a) -&gt; a -&gt; a\n  -- ^-- the \"dictionary\"\nf (dictFromInteger, dictPlus) x = dictPlus x (dictFromInteger 2)\n</code></pre>\n\n<p>The latter basically says: \"pass me an implementation for these methods of class <code>Num</code> for your type <code>a</code>, and I will use them to produce a function <code>a -&gt; a</code> for you\".</p>\n\n<p>Values such as your <code>n :: Num b =&gt; b</code> are no different. They are compiled into things such as</p>\n\n<pre><code>n :: (Integer -&gt; b) -&gt; b\nn dictFromInteger = dictFromInteger 5   -- roughly\n</code></pre>\n\n<p>As you can see, this turns innocent-looking integer literals into functions, which can (and does) impact performance. However, in many circumstances the compiler can realize that the full polymorphic version is not actually needed, and remove all the dictionaries. </p>\n\n<p>For instance, if you write <code>f 3</code> but <code>f</code> expects <code>Int</code>, the \"polymorphic\" <code>3</code> can be converted at compile time. So type inference can aid the optimization phase (and user-written type annotation can greatly help here). Further, some other optimizations can be triggered manually, e.g. using the GHC <code>SPECIALIZE</code> pragma. Finally, the dreaded monomorphism restriction tries hard to force non-functions to remain non-functions after translation, at the cost of some loss of polymorphism. However, the MR is now being regarded as harmful, since it can cause puzzling type errors in some contexts.</p>\n"}], "owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 32936736, "answer_count": 1, "score": 2, "last_activity_date": 1443982853, "creation_date": 1443981640, "question_id": 32936592, "link": "https://stackoverflow.com/questions/32936592/how-can-an-arbitrary-num-contain-any-other-numeric-type", "title": "How can an arbitrary Num contain any other numeric type?", "body": "<p>I'm just starting with Haskell, and I thought I'd start by making a random image generator. I looked around a bit and found JuicyPixels, which offers a neat function called <code>generateImage</code>. The example that they give doesn't seem to work out of the box.</p>\n\n<p>Their example:</p>\n\n<pre><code>imageCreator :: String -&gt; IO ()\nimageCreator path = writePng path $ generateImage pixelRenderer 250 300\n   where pixelRenderer x y = PixelRGB8 x y 128\n</code></pre>\n\n<p>when I try this, I get that <code>generateImage</code> expects an <code>Int -&gt; Int -&gt; PixelRGB8</code> whereas <code>pixelRenderer</code> is of type <code>Pixel8 -&gt; Pixel8 -&gt; PixelRGB8</code>. <code>PixelRGB8</code> is of type <code>Pixel8 -&gt; Pixel8 -&gt; Pixel8 -&gt; PixelRGB8</code>, so it makes sense that <code>pixelRenderer</code> is doing some type inference to determine that <code>x</code> and <code>y</code> are of type <code>Pixel8</code>. If I define a type signature that asserts that they are of type <code>Int</code> (so the function gets accepted by <code>generateImage</code>, <code>PixelRGB8</code> complains that it needs <code>Pixel8</code>s, not <code>Ints</code>.</p>\n\n<p><code>Pixel8</code> is just a type alias for <code>Word8</code>. After some hair pulling, I discovered that the way to convert an <code>Int</code> to a <code>Word8</code> is by using <code>fromIntegral</code>.</p>\n\n<p>The type signature for <code>fromIntegral</code> is <code>(Integral a, Num b) =&gt; a -&gt; b</code>. It seems to me that the function doesn't actually know what you want to convert it to, so it converts to the very generic <code>Num</code> class. So theoretically, the output of this is a variable of <em>any</em> type that fits the type class <code>Num</code> (correct me if I'm mistaken here--as I understand it, classes are kind of like \"interfaces\" where types are more like classes/primitives in OOP). If I assign a variable</p>\n\n<pre><code>let n = fromIntegral 5\n:t n -- n :: Num b =&gt; b\n</code></pre>\n\n<p>So I'm wondering... what is 'b'? I can use this variable as anything, and it will implicitly cast to any numeric type, as it seems. Not only will it implicitly cast to a <code>Word8</code>, it will implicitly cast to a <code>Pixel8</code>, meaning <code>fromPixel</code> effectively gets turned from (as I understood it) <code>(Integral a, Num b) =&gt; a -&gt; b</code> to <code>(Integral a) =&gt; a -&gt; Pixel8</code> depending on context.</p>\n\n<p>Can someone please clarify exactly what's happening here? Why can I use a generic <code>Num</code> as any type that fits <code>Num</code>, both mechanically and \"ethically\"? I don't understand how the implicit conversion is implemented (if I were to create my own class, I feel like I would need to add explicit conversion functions). I also don't really know why this works; here I can use a pretty unsafe type and convert it implicitly to anything else. (for example, <code>fromIntegral 50000</code> gets translated to <code>80</code> if I implicitly convert it to a <code>Word8</code>)</p>\n"}, {"tags": ["haskell", "memoization"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1443980704, "post_id": 32936362, "comment_id": 53698168, "body": "The first definition is more like <code>fibonacci = let k = map fib [0 ..] in \\x -&gt; k !! x</code>. It probably shares the list of results instead of recomputing it each time."}, {"owner": {"reputation": 657, "user_id": 1440894, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5cd84e40bb321eb1d75a9b7aa94fec42?s=128&d=identicon&r=PG", "display_name": "MadMonty", "link": "https://stackoverflow.com/users/1440894/madmonty"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1443981008, "post_id": 32936362, "comment_id": 53698250, "body": "Mm, so I&#39;m content that it&#39;s this &quot;sharing&quot; (memoization) that makes the first one super quick. But why do the same for the second one?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1443981123, "post_id": 32936362, "comment_id": 53698279, "body": "You are running your code in GHCI, without optimizations. Try compiling both functions with <code>-O2</code> and seeing if GHC is smart enough to solve your problem for you."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 8, "creation_date": 1443981725, "post_id": 32936362, "comment_id": 53698459, "body": "Update: compiling with optimizations and looking at the generated core shows it is <i>identical</i>. For future reference, if you are interested in performance, you <i>must</i> compile with optimizations!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443981822, "post_id": 32936362, "comment_id": 53698492, "body": "@user2407038, I think the reason for the difference in the unoptimized code is interesting regardless."}, {"owner": {"reputation": 657, "user_id": 1440894, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5cd84e40bb321eb1d75a9b7aa94fec42?s=128&d=identicon&r=PG", "display_name": "MadMonty", "link": "https://stackoverflow.com/users/1440894/madmonty"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443982846, "post_id": 32936362, "comment_id": 53698848, "body": "Thanks, I should&#39;ve compiled first... But as @dfeuer says, it&#39;d be interesting to know why the unoptimised code acts the way it does."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444058742, "post_id": 32936362, "comment_id": 53729272, "body": "@dfeuer I agree completely, which is why I left a comment instead of making it an answer."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 11, "last_activity_date": 1443983384, "last_edit_date": 1443983384, "creation_date": 1443983071, "answer_id": 32936814, "question_id": 32936362, "link": "https://stackoverflow.com/questions/32936362/non-pointfree-style-is-substantially-slower/32936814#32936814", "title": "Non-pointfree style is substantially slower", "body": "<p>To observe the difference, you should probably look at Core. My guess that this boils down to comparing (roughly)</p>\n\n<pre><code>let f = map fib [0..] in \\x -&gt; f !! x\n</code></pre>\n\n<p>to</p>\n\n<pre><code>\\x -&gt; let f = map fib [0..] in f !! x\n</code></pre>\n\n<p>The latter will recompute <code>f</code> from scratch on every invocation. The former does not, effectively caching the same <code>f</code> for each invocation.</p>\n\n<p>It happens that in this specific case, GHC was able to optimize the second into the first, once optimization is enabled.</p>\n\n<p>Note however that GHC does not always perform this transformation, since this is not always an optimization. The cache used by the first is kept in memory forever. This might lead to a waste of memory, depending on the function at hand.</p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1519160005, "creation_date": 1519160005, "answer_id": 48894028, "question_id": 32936362, "link": "https://stackoverflow.com/questions/32936362/non-pointfree-style-is-substantially-slower/48894028#48894028", "title": "Non-pointfree style is substantially slower", "body": "<p>I tried to find it but struck out. I think I have it on my PC at home.\nWhat I read was that functions using fixed point were inherently faster.\nThere are other reasons for using fixed point. I encountered one in writing this iterative Fibonacci function. I wanted to see how an iterative version would perform then I realized I had no ready way to measure. I am a Haskell neophyte. But here is an iterative version for someone to test.\nI could not get this to define unless I used the dot after the first last function.\nI could not reduce it further. the [0,1] parameter is fixed and not to be supplied as a parameter value.</p>\n\n<pre><code>Prelude&gt; fib = last . flip take (iterate (\\ls -&gt; ls ++ [last ls + last (init ls)]) [0,1])\nPrelude&gt; fib 25\n</code></pre>\n\n<p>[0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765,10946,17711,28657,46368,75025]</p>\n"}], "owner": {"reputation": 657, "user_id": 1440894, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5cd84e40bb321eb1d75a9b7aa94fec42?s=128&d=identicon&r=PG", "display_name": "MadMonty", "link": "https://stackoverflow.com/users/1440894/madmonty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 32936814, "answer_count": 2, "score": 10, "last_activity_date": 1519160005, "creation_date": 1443980323, "last_edit_date": 1443980933, "question_id": 32936362, "link": "https://stackoverflow.com/questions/32936362/non-pointfree-style-is-substantially-slower", "title": "Non-pointfree style is substantially slower", "body": "<p>I have the following, oft-quoted code for calculating the nth Fibonacci number in Haskell: </p>\n\n<pre><code>fibonacci :: Int -&gt; Integer\nfibonacci = (map fib [0..] !!)\n    where fib 0 = 0\n          fib 1 = 1\n          fib n = fibonacci (n-2) + fibonacci (n-1)  \n</code></pre>\n\n<p>Using this, I can do calls such as:</p>\n\n<pre><code>ghci&gt; fibonacci 1000\n</code></pre>\n\n<p>and receive an almost instantaneous answer.</p>\n\n<p>However, if I modify the above code so that it's not in pointfree style, i.e.</p>\n\n<pre><code>fibonacci :: Int -&gt; Integer\nfibonacci x = (map fib [0..] !!) x\n    where fib 0 = 0\n          fib 1 = 1\n          fib n = fibonacci (n-2) + fibonacci (n-1) \n</code></pre>\n\n<p>it is substantially slower. To the extent that a call such as</p>\n\n<pre><code>ghci&gt; fibonacci 1000\n</code></pre>\n\n<p>hangs.</p>\n\n<p>My understanding was that the above two pieces of code were equivalent, but GHCi begs to differ. Does anyone have an explanation for this behaviour?</p>\n"}, {"tags": ["haskell", "monads", "monoids", "kleisli"], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443980327, "post_id": 32936292, "comment_id": 53698062, "body": "You have &quot;the structure of the f is often considered more significant than that of the f.&quot; Is that a mistake?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443980619, "post_id": 32936292, "comment_id": 53698146, "body": "I&#39;m also a bit confused by your paragraph about <code>Maybe</code>. I thought the bugbear of the Maybe monoid was that it <i>doesn&#39;t</i> have a <code>Semigroup a =&gt; Monoid (Maybe a)</code> constraint, but rather a <code>Monoid a =&gt; Monoid (Maybe a)</code> constraint, which <i>ignores</i> the property that adjoining an element to a semigroup gives a monoid."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443981917, "post_id": 32936292, "comment_id": 53698527, "body": "Thanks for the typo spotting. And no, that&#39;s not the Maybe bugbear. That&#39;s just the insult that&#39;s added to the injury."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443981995, "post_id": 32936292, "comment_id": 53698555, "body": "Ah, I see. Thanks. And FWIW, it is implemented by <code>Option</code> in the <code>semigroups</code> package, which is a newtype wrapper around <code>Maybe</code>."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443984271, "post_id": 32936292, "comment_id": 53699373, "body": "@ReinHenrichs I just looked. It just gets worse. Concept one: the effect of possible failure and the business of managing it with prioritised choice, which is a notion of computation. Concept two: adjoining a neutral element to a semigroup to get a monoid, which is a notion of value. This repair attempt has not successfully disentagled those concepts."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443986687, "post_id": 32936292, "comment_id": 53700213, "body": "Could you give an example of how the former would be represented differently from the latter, given that they are isomorphic? Option sounds like a direct representation of the latter (modulo newtype wrapping) so I&#39;m not quite seeing it."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1443987528, "post_id": 32936292, "comment_id": 53700455, "body": "@ReinHenrichs You can represent isomorphic types differently by calling them different things (eg, as achieved by newtype). The name is for the idea, for the whole bunch of semantic structures of which the type itself is just the carrier. We get so much effort-saving power by using instance inference to find the right semantic plumbing, keyed to the naming of the concept. It&#39;s a shame to muddle the concepts up. When you wonder &quot;how the former would be represented differently&quot; you miss the wood for the trees."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443989948, "post_id": 32936292, "comment_id": 53701229, "body": "I don&#39;t disagree that naming things is important, or that isomorphic things with different names can have different meanings / represent different ideas. So what then are the &quot;two constructions&quot;? Are they different names with the same implementation? I&#39;d like to understand the distinction you are making a bit more concretely. Can they be written in Haskell?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1443990301, "post_id": 32936292, "comment_id": 53701365, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/91320/discussion-between-pigworker-and-rein-henrichs\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 28, "last_activity_date": 1443981868, "last_edit_date": 1443981868, "creation_date": 1443979867, "answer_id": 32936292, "question_id": 32935812, "link": "https://stackoverflow.com/questions/32935812/why-isnt-kleisli-an-instance-of-monoid/32936292#32936292", "title": "Why isn&#39;t Kleisli an instance of Monoid?", "body": "<p>In the business of library design, we face a choice point here, and we have chosen to be less than entirely consistent in our collective policy (or lack of it).</p>\n\n<p><code>Monoid</code> instances for <code>Monad</code> (or <code>Applicative</code>) type constructors can come about in a variety of ways. Pointwise lifting is always available, but we don't define</p>\n\n<pre><code>instance (Applicative f, Monoid x) =&gt; Monoid (f x) {- not really -} where\n  mempty         = pure mempty\n  mappend fa fb  = mappend &lt;$&gt; fa &lt;*&gt; fb\n</code></pre>\n\n<p>Note that the <code>instance Monoid (a -&gt; b)</code> is just such a pointwise lifting, so the pointwise lifting for <code>(a -&gt; m b)</code> does happen whenever the monoid instance for <code>m b</code> does pointwise lifting for the monoid on <code>b</code>.</p>\n\n<p>We don't do pointwise lifting in general, not only because it would prevent other <code>Monoid</code> instances whose carriers happen to be applied types, but also because the structure of the <code>f</code> is often considered more significant than that of the <code>x</code>. A key case in point is the <em>free</em> monoid, better known as <code>[x]</code>, which is a <code>Monoid</code> by <code>[]</code> and <code>(++)</code>, rather than by pointwise lifting. The monoidal structure comes from the list wrapping, not from the elements wrapped.</p>\n\n<p>My preferred rule of thumb is indeed to prioritise monoidal structure inherent in the type constructor over either pointwise lifting, or monoidal structure of specific instantiations of a type, like the composition monoid for <code>a -&gt; a</code>. These can and do get <code>newtype</code> wrappings.</p>\n\n<p>Arguments break out over whether <code>Monoid (m x)</code> should coincide with <code>MonadPlus m</code> whenever both exist (and similarly with <code>Alternative</code>). My sense is that the only good <code>MonadPlus</code> instance is a copy of a <code>Monoid</code> instance, but others differ. Still, the library is not consistent in this matter, especially not in the matter of (many readers will have seen this old bugbear of mine coming)...</p>\n\n<p>...the monoid instance for <code>Maybe</code>, which ignores the fact that we routinely use <code>Maybe</code> to model possible failure and instead observes that that the same data type idea of chucking in an extra element can be used to give a semigroup a neutral element if it didn't already have one. The two constructions give rise to isomorphic types, but they are not conceptually cognate. (<strong>Edit</strong> To make matters worse, the idea is implemented awkwardly, giving instance a <code>Monoid</code> constraint, when only a <code>Semigroup</code> is needed. I'd like to see the <code>Semigroup</code>-extends-to-<code>Monoid</code> idea implemented, but <em>not</em> for <code>Maybe</code>.)</p>\n\n<p>Getting back to <code>Kleisli</code> in particular, we have three obvious candidate instances:</p>\n\n<ol>\n<li><code>Monoid (Kleisli m a a)</code> with <code>return</code> and Kleisli composition</li>\n<li><code>MonadPlus m =&gt; Monoid (Kleisli m a b)</code> lifting <code>mzero</code> and <code>mplus</code> pointwise over <code>-&gt;</code></li>\n<li><code>Monoid b =&gt; Monoid (Kleisli m a b)</code> lifting the monoid structure of <code>b</code> over <code>m</code> then <code>-&gt;</code></li>\n</ol>\n\n<p>I expect no choice has been made, just because it's not clear which choice to make. I hesitate to say so, but my vote would be for 2, prioritising the structure coming from <code>Kleisli m a</code> over the structure coming from <code>b</code>.</p>\n"}], "owner": {"reputation": 455, "user_id": 3094101, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/944937c3ec4c2870650aa1d4fb229f17?s=128&d=identicon&r=PG&f=1", "display_name": "leo", "link": "https://stackoverflow.com/users/3094101/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 8, "accepted_answer_id": 32936292, "answer_count": 1, "score": 21, "last_activity_date": 1443982398, "creation_date": 1443976796, "last_edit_date": 1592644375, "question_id": 32935812, "link": "https://stackoverflow.com/questions/32935812/why-isnt-kleisli-an-instance-of-monoid", "title": "Why isn&#39;t Kleisli an instance of Monoid?", "body": "<p>If you wish to append two functions of type (a -&gt; m b) so you get only one function of the same type appending both results, you could use Kleisli to do so:</p>\n<pre><code>instance (Monad m, Monoid b) =&gt; Monoid (Kleisli m a b) where\n    mempty = Kleisli (\\_ -&gt; return mempty)\n    mappend k1 k2 =\n        Kleisli g\n            where\n                g x = do\n                    r1 &lt;- runKleisli k1 x\n                    r2 &lt;- runKleisli k2 x\n                    return (r1 &lt;&gt; r2)\n</code></pre>\n<p>However, currently there is no such instance defined in <code>Control.Arrow</code>.\nAs often, in Haskell, I suspect there is a good reason, but cannot find which one.</p>\n<h3>Note</h3>\n<p>This question is rather similar to <a href=\"https://stackoverflow.com/questions/18925045/why-there-isnt-a-functor-instance-for-kleisli-in-control-arrow\">this one</a>. However, with Monoid I don't see a way to define an instance such as:</p>\n<pre><code>instance (Monad m, Monoid b) =&gt; Monoid (a -&gt; m b) where\n    [...]\n</code></pre>\n<p>since there is already an instance:</p>\n<pre><code>instance Monoid b =&gt; Monoid (a -&gt; b) where\n    [...]\n</code></pre>\n"}, {"tags": ["haskell", "gadt"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 1214036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b44c47230e3f69296931078db73dd4a4?s=128&d=identicon&r=PG", "display_name": "TheMADMAN", "link": "https://stackoverflow.com/users/1214036/themadman"}, "edited": false, "score": 0, "creation_date": 1443979849, "post_id": 32935594, "comment_id": 53697909, "body": "Okay, I can understand this. But what if I want to not only return a <code>[Result]</code> but maybe also a pair of results like <code>([Result],[Result])</code>. Basically I want to be able to return a set of types with my <code>integrate</code> function. This is what I thought would have been possible by just saying <code>MkNumeric ::  NumericType -&gt; IntegrationType Numeric b</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 319, "user_id": 1214036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b44c47230e3f69296931078db73dd4a4?s=128&d=identicon&r=PG", "display_name": "TheMADMAN", "link": "https://stackoverflow.com/users/1214036/themadman"}, "edited": false, "score": 0, "creation_date": 1443981018, "post_id": 32935594, "comment_id": 53698252, "body": "@TheMADMAN, the big question is what you can do with the results once you have them. In a fully dependently typed language, you can make the result type depend in arbitrary ways on the input values, but using the result requires proving that it has the type you need (this mechanism seems to be useful mostly for things in the nature of metaprogramming). In Haskell, we can&#39;t do this; the result type can&#39;t depend on the input value."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1443977847, "last_edit_date": 1443977847, "creation_date": 1443975344, "answer_id": 32935594, "question_id": 32934623, "link": "https://stackoverflow.com/questions/32934623/gadt-in-polymorphic-function/32935594#32935594", "title": "GADT in polymorphic function", "body": "<p>The type</p>\n\n<pre><code>integrate :: IntegrationType a b -&gt; b\n</code></pre>\n\n<p>says that, for <em>any</em> <code>a</code> and <code>b</code> of my choice, if I call <code>integrate</code> with a value of type <code>IntegrationType a b</code>, I will get back a value of type <code>b</code>. When you define</p>\n\n<pre><code>MkNumeric ::  NumericType -&gt; IntegrationType Numeric b\n</code></pre>\n\n<p>you let whoever applies the constructor decide what <code>b</code> is. So I could use <code>MkNumeric</code> to manufacture a value of, say, type <code>IntegrationType Numeric Int</code>. But your <code>integrate</code> knows how to produce <code>[Result]</code>, not <code>Int</code>.</p>\n\n<p>In the <em>working</em> code, as soon as <code>integrate</code> \"opens up the evidence box\" by matching <code>MkNumeric</code>, it learns that <code>b ~ [Result]</code> and therefore it can return something of that type.</p>\n"}], "owner": {"reputation": 319, "user_id": 1214036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b44c47230e3f69296931078db73dd4a4?s=128&d=identicon&r=PG", "display_name": "TheMADMAN", "link": "https://stackoverflow.com/users/1214036/themadman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 32935594, "answer_count": 1, "score": 1, "last_activity_date": 1443977847, "creation_date": 1443969379, "question_id": 32934623, "link": "https://stackoverflow.com/questions/32934623/gadt-in-polymorphic-function", "title": "GADT in polymorphic function", "body": "<p>I have a problem with a function which I want to make very polymorphic.\nI would like to integrate functions, either analytically or numerically. When integrating analytically I provide the result.\nIn the numeric case I would like to use various methods, for now, the tanhsinh routine from <a href=\"https://hackage.haskell.org/package/integration-0.2.1/docs/Numeric-Integration-TanhSinh.html\" rel=\"nofollow\">tanhsinh</a>.\nI also want to learn more about gadts, so I tried to find a solution using them.</p>\n\n<p>So far I have the following:</p>\n\n<pre><code>import qualified Data.VectorSpace as DV\nimport Numeric.Integration.TanhSinh\n\ndata IntegrationType a b  where\n      MkAnalytic :: (DV.AdditiveGroup b) =&gt;  (c -&gt; b) -&gt; c -&gt; c -&gt; IntegrationType Analytic b\n      MkNumeric ::  NumericType  -&gt; IntegrationType  Numeric [Result]\n\ndata Analytic = Analytic\ndata Numeric = Numeric\ndata Method = Trapez | Simpson\ndata IntBounds = Closed | NegInfPosInf | ZeroInf\n\ndata NumericType = MkSingleCoreTanhSinh  IntBounds Method  (Double -&gt; Double)  Double Double\n              | MkParallelTanhSinhExplicit IntBounds (Strategy [Double])  Method  (Double -&gt; Double)  Double  Double\n              | MkParallelTanhSinh IntBounds  Method  (Double -&gt; Double)  Double  Double \n\nintegrate :: IntegrationType a b -&gt; b\nintegrate (MkAnalytic f l h) = f h DV.^-^ f l\nintegrate (MkNumeric (MkSingleCoreTanhSinh Closed Trapez f l h )) =  trap f l h\nintegrate (MkNumeric (MkSingleCoreTanhSinh Closed Simpson f l h )) =  simpson f l h\n</code></pre>\n\n<p>This code compiles , because I expicitly state in the constructor MkNumeric that the type variable b is</p>\n\n<pre><code>[Result]\n</code></pre>\n\n<p>Why do I have to do this? Can I not leave the type variable b as in</p>\n\n<pre><code>data IntegrationType a b  where\n     MkNumeric ::  NumericType  -&gt; IntegrationType  Numeric b\n</code></pre>\n\n<p>When I do this I get an error:</p>\n\n<blockquote>\n<pre><code>Could not deduce (b ~ [Result])\nfrom the context (a ~ Numeric)\n  bound by a pattern with constructor\n             MkNumeric :: forall b. NumericType -&gt; IntegrationType Numeric b,\n           in an equation for `integrate'\n  at test-classes-new-programm.hs:139:12-64\n  `b' is a rigid type variable bound by\n      the type signature for integrate :: IntegrationType a b -&gt; b\n      at test-classes-new-programm.hs:137:14\nRelevant bindings include\n  integrate :: IntegrationType a b -&gt; b\n    (bound at test-classes-new-programm.hs:138:1)\nIn the expression: trap f l h\nIn an equation for `integrate':\n    integrate (MkNumeric (MkSingleCoreTanhSinh Closed Trapez f l h))\n      = trap f l h\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell", "cabal-install"], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443969667, "post_id": 32934663, "comment_id": 53694726, "body": "That seems to be how it behaves."}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1443969732, "post_id": 32934663, "comment_id": 53694745, "body": "Great name, by the way."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443988346, "post_id": 32934663, "comment_id": 53700743, "body": "It also apparently shows <i>failed</i> install attempts, which is odd."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1443988410, "post_id": 32934663, "comment_id": 53700766, "body": "If <code>ghc-pkg</code> is deregistering &quot;behind cabal&#39;s back&quot;, is there a way to do it in sight of Cabal?"}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443989833, "post_id": 32934663, "comment_id": 53701190, "body": "Indeed - anything you requested, rather than anything you installed. I&#39;ve updated to make it clearer."}, {"owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443989992, "post_id": 32934663, "comment_id": 53701244, "body": "I know of no way to tell cabal install you don&#39;t want something any more.  It&#39;s a dependency resolver and package installer, rather than a package manager as such."}], "tags": [], "owner": {"reputation": 31301, "user_id": 1598537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c214754fba6f3a238a93af85a0ab4f58?s=128&d=identicon&r=PG", "display_name": "AndrewC", "link": "https://stackoverflow.com/users/1598537/andrewc"}, "is_accepted": true, "score": 8, "last_activity_date": 1443989770, "last_edit_date": 1443989770, "creation_date": 1443969594, "answer_id": 32934663, "question_id": 32934281, "link": "https://stackoverflow.com/questions/32934281/what-is-a-cabal-world-file-for/32934663#32934663", "title": "What is a Cabal &#39;world&#39; file for?", "body": "<p>As far as I'm aware, it's automatically populated with any package you ever explicitly requested (thus including failed installs). This means that if you copy it to another machine, you can do </p>\n\n<pre><code>cabal install world \n</code></pre>\n\n<p>to aim at replicating your current setup.</p>\n\n<p>Of course, you can deregister a package behind cabal's back, and it won't know to delete it from your <code>world</code> file. </p>\n\n<p>(Dependencies will be installed too, but I should emphasise that hackage will have moved on in the meanwhile, and that if you want reproducible installation, it's probably easier to use the stack tool, which has that as one of its principal design goals.) </p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 1, "accepted_answer_id": 32934663, "answer_count": 1, "score": 8, "last_activity_date": 1444342740, "creation_date": 1443967281, "last_edit_date": 1444342740, "question_id": 32934281, "link": "https://stackoverflow.com/questions/32934281/what-is-a-cabal-world-file-for", "title": "What is a Cabal &#39;world&#39; file for?", "body": "<p>What is the role of the <code>~/.cabal/world</code> file, and what do its contents mean? I can't find any documentation and am confused by what I see there.</p>\n\n<p>For example, it corresponds to nether the packages in my user database nor my global packages database, and while it seems to list only (a few of) the packages in my user database, it lists some that I've \"removed\" with <code>ghc-pkg unregister</code>.</p>\n"}, {"tags": ["haskell", "types", "functional-programming", "integer"], "comments": [{"owner": {"reputation": 411, "user_id": 1601251, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bba04f5370f3e5419cf65464fc66870?s=128&d=identicon&r=PG", "display_name": "Asker", "link": "https://stackoverflow.com/users/1601251/asker"}, "reply_to_user": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "edited": false, "score": 0, "creation_date": 1443964082, "post_id": 32933776, "comment_id": 53693086, "body": "@soon thanks for the edit, it is more readable this way"}, {"owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "edited": false, "score": 0, "creation_date": 1443964525, "post_id": 32933776, "comment_id": 53693206, "body": "You are always welcome!"}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 1601251, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bba04f5370f3e5419cf65464fc66870?s=128&d=identicon&r=PG", "display_name": "Asker", "link": "https://stackoverflow.com/users/1601251/asker"}, "edited": false, "score": 0, "creation_date": 1443965369, "post_id": 32933889, "comment_id": 53693474, "body": "ok thank you, so in (f h) haskell calls f with the parameter h and then it adds the result to the result of <code>code</code>( (func t f) )? Is that correct?"}], "tags": [], "owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "is_accepted": false, "score": 6, "last_activity_date": 1443964507, "creation_date": 1443964507, "answer_id": 32933889, "question_id": 32933776, "link": "https://stackoverflow.com/questions/32933776/haskell-types-and-signatures/32933889#32933889", "title": "Haskell types and signatures", "body": "<pre><code>func [] f = 16\n</code></pre>\n\n<p>This line defines a function <code>func</code>, accepting a list and <code>f</code>, and  returning <code>16</code>. The type could be written as <code>Num a =&gt; [b] -&gt; c -&gt; a</code>.</p>\n\n<pre><code>func (h : t) f = (f h) + (func t f)\n</code></pre>\n\n<p>This line restricts <code>f</code> type to <code>Num a =&gt; b -&gt; a</code>, because:</p>\n\n<ol>\n<li><code>f</code> should accept an element from the list</li>\n<li><code>f ...</code> should return a value, which could be added to result of <code>func ...</code></li>\n</ol>\n\n<p>So, the type of <code>func</code> is:</p>\n\n<pre><code>Num a =&gt; [b] -&gt; (b -&gt; a) -&gt; a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 411, "user_id": 1601251, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bba04f5370f3e5419cf65464fc66870?s=128&d=identicon&r=PG", "display_name": "Asker", "link": "https://stackoverflow.com/users/1601251/asker"}, "edited": false, "score": 0, "creation_date": 1443966939, "post_id": 32934082, "comment_id": 53693924, "body": "ok may I do it for another function, <code>func2 1 (h : t) = h ; func2 n (h : t ) = func2 (n-1) t</code> . <code>func2 :: Num a =&gt; a -&gt;[b] -&gt; b</code> for the first line because 1 is a numerical type,(h : t) is a list and h is the first element of the list. The second line is <code>func2:: Num a=&gt; a -&gt; [b] -&gt; ?</code> Maybe the result of the first line which is b? So the complete thing would be <code>func2::Num a =&gt; a -&gt;[b] -&gt; b</code>. Is that correct?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 411, "user_id": 1601251, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bba04f5370f3e5419cf65464fc66870?s=128&d=identicon&r=PG", "display_name": "Asker", "link": "https://stackoverflow.com/users/1601251/asker"}, "edited": false, "score": 1, "creation_date": 1443967427, "post_id": 32934082, "comment_id": 53694074, "body": "Seems to be quite correct, except the base case &#39;1&#39; implies an instance of <code>(Eq a)</code> it seems, I think that&#39;s because you could translate this expression in an <code>if (n == 1) \u2026then\u2026else</code> expression"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 411, "user_id": 1601251, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bba04f5370f3e5419cf65464fc66870?s=128&d=identicon&r=PG", "display_name": "Asker", "link": "https://stackoverflow.com/users/1601251/asker"}, "edited": false, "score": 0, "creation_date": 1443967521, "post_id": 32934082, "comment_id": 53694102, "body": "btw - you can type the <code>func2</code> definition in a file - load it into ghci with ghci myfile.hs and then <code>:t func2</code> in order to see wether your reasoning is correct"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1443965852, "creation_date": 1443965852, "answer_id": 32934082, "question_id": 32933776, "link": "https://stackoverflow.com/questions/32933776/haskell-types-and-signatures/32934082#32934082", "title": "Haskell types and signatures", "body": "<p>One (easy) way to find out about such problems is to write it in a file and load it into <code>ghci</code> and issue the command <code>:t func</code>, which is nice while preparing for an exam but not applicable during it - so I will walk you through the hints that can be found.</p>\n\n<p>As @soon gave a perfectly valid answer - I will only add a few hints you might use in the future:</p>\n\n<p>determine the number of arguments (this might be a bit difficult if the function is written in pointfree style, i.e. <code>func x = const x</code> could be written as <code>func = const</code>.</p>\n\n<p>so in this case we get two arguments and one result so we can write the signature as</p>\n\n<pre><code>func :: ? -&gt; ? -&gt; ?\n</code></pre>\n\n<ol>\n<li><p>Look for results (in this case <code>16</code>) and determine its type\nyou already noticed that <code>16</code> is something numerical - thus</p>\n\n<pre><code>func :: Num a =&gt; ? -&gt; ? -&gt; a\n</code></pre>\n\n<p>looks as a good starting point.</p></li>\n<li><p>Look for type constructors that help you identify ADTs or <code>type</code>/<code>newtype</code>s in your function.</p>\n\n<p>Now in the first and second case we have two hints that the first argument is of type list (<code>[]</code> and the constructor <code>(:)</code>) gives us this info. As we have no information about the contents of the list we have to assign a different type variable for them - <code>b</code>.</p>\n\n<pre><code>func :: Num a =&gt; [b] -&gt; ? -&gt; a\n</code></pre></li>\n<li><p>identify functions used to determine the rest or get more specialized types for the stuff you already found out</p>\n\n<p>here we have 2 informations one is the <code>(+)</code> operator, and <code>(f h)</code> - as the whitespace character in haskell means function applicaton we get <code>h</code>'s type has to be the domain of the function <code>f</code> and as the result of <code>f h</code> is used with <code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code> (Note that both arguments must have the same type, as well as the result) and the result of <code>func t f</code> (which is <code>a</code>) we get  the target type of <code>f</code> and therefore <code>f :: b -&gt; a</code></p></li>\n</ol>\n\n<p>composing this we get </p>\n\n<pre><code>func :: Num a =&gt; [b] -&gt; (type-of-f) -&gt; a\nfunc :: Num a =&gt; [b] -&gt; (b -&gt; a) -&gt; a\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 1601251, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bba04f5370f3e5419cf65464fc66870?s=128&d=identicon&r=PG", "display_name": "Asker", "link": "https://stackoverflow.com/users/1601251/asker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 32934082, "answer_count": 2, "score": 2, "last_activity_date": 1443965852, "creation_date": 1443963712, "last_edit_date": 1443963893, "question_id": 32933776, "link": "https://stackoverflow.com/questions/32933776/haskell-types-and-signatures", "title": "Haskell types and signatures", "body": "<p>I'm studying for an exam about Haskell. I don't understand how I determine the type of a function. The function is:</p>\n\n<pre><code>func [] f = 16\nfunc (h : t) f = (f h) + (func t f)\n</code></pre>\n\n<p>My guess is that the first line has this types: <code>empty list -&gt; a -&gt; a</code> where <code>a</code> has to be a numeric type. In Haskell notation <code>Num a =&gt; [] -&gt; a -&gt; a</code> and the second line has this types: <code>[a]-&gt; a -&gt; ?</code> What does it return? Maybe <code>(a, a)</code> because  <code>(f h)</code> is a tuple. What about <code>(func t f)</code>, is <code>a</code> or? And how do I mix both lines together?</p>\n"}, {"tags": ["haskell", "homebrew", "cabal-install", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 391, "user_id": 5298455, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zEzWj_qaO7I/AAAAAAAAAAI/AAAAAAAAACw/A7lGVwEZUYs/photo.jpg?sz=128", "display_name": "Emanuel Borsboom", "link": "https://stackoverflow.com/users/5298455/emanuel-borsboom"}, "is_accepted": true, "score": 4, "last_activity_date": 1443985193, "creation_date": 1443985193, "answer_id": 32937193, "question_id": 32933659, "link": "https://stackoverflow.com/questions/32933659/how-do-i-ensure-that-my-haskell-packages-match-lts-haskell/32937193#32937193", "title": "How do I ensure that my Haskell packages match LTS Haskell?", "body": "<p>If you're using cabal-install, your best bet is to append the contents of <a href=\"https://www.stackage.org/lts-3.8/cabal.config?global=true\" rel=\"nofollow\">https://www.stackage.org/lts-3.8/cabal.config?global=true</a> (adjust the LTS snapshot slug to your preference) to your <code>~/.cabal/config</code>.  I'd caution against doing this, though, since you may well want to use different snapshots for different projects.  Use of sandboxes with cabal-install is highly recommended (in fact, I set <code>require-sandbox: true</code> in my cabal config to make sure I don't forget).</p>\n\n<p>For Stack, the LTS snapshot is always project-specific; there is no global setting.  But setting the <code>resolver:</code> value in <code>~/.stack/global/stack.yaml</code> sets it for when you run <code>stack</code> outside of a specific project, and also influences the choice of resolver for new projects (when you use <code>stack init</code> or <code>stack new</code>).</p>\n\n<p>BTW, it looks like the Homebrew <code>haskell-stack</code> formula is just an alternate way to install Stack, so if you already have Stack there's no need to use it.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 2, "accepted_answer_id": 32937193, "answer_count": 1, "score": 2, "last_activity_date": 1443985193, "creation_date": 1443962994, "question_id": 32933659, "link": "https://stackoverflow.com/questions/32933659/how-do-i-ensure-that-my-haskell-packages-match-lts-haskell", "title": "How do I ensure that my Haskell packages match LTS Haskell?", "body": "<p>I'd like to have a simple way of ensuring that the packages in my system, whether they are in the global or the user package database, correspond to the versions in the current LTS Haskell.</p>\n\n<p>I gather that there are <a href=\"https://www.stackage.org\" rel=\"nofollow\">fairly simple ways</a> to do something like this for a specific project. But it's not clear to me how to achieve this for my Haskell system as a whole. I have Stack installed already (using Cabal), and use Homebrew where I can (e.g., for Haskell, just for <code>cabal-install</code>). I'm tempted by <a href=\"http://brewformulas.org/HaskellStack\" rel=\"nofollow\"><code>haskell-stack</code></a>, but it's unclear what exactly that does.</p>\n\n<p>Is there a simple way to ensure that my system's Haskell packages (wherever they reside) match LTS Haskell?</p>\n\n<hr>\n"}, {"tags": ["haskell", "typeerror"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 4, "creation_date": 1443962330, "post_id": 32933488, "comment_id": 53692587, "body": "You&#39;re only doing filtering, but <code>l</code> is still a <code>Char</code> when you cons it to <code>numbers ls</code>. You&#39;ll need to convert <code>l</code> to an <code>Int</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1443963504, "post_id": 32933488, "comment_id": 53692917, "body": "You can compare <code>Char</code>s directly, e.g. <code>l &gt;= &#39;0&#39; &amp;&amp; l &lt;= &#39;9&#39;</code>, there is no need to convert them to <code>Int</code> there. You instead have to convert them before you build your list of <code>Int</code>s. Also, your code will produce a list of one-digit numbers, only. E.g. it will never include 123, only 1,2,3. Is that intended?"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1443964196, "post_id": 32933488, "comment_id": 53693118, "body": "Might be you want to break the string into <code>words</code> and convert those to numbers (<code>map</code>) by some implementation of <code>read</code>?"}, {"owner": {"reputation": 188, "user_id": 5406663, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d2fc65d332ca7ec74016b7003e564aa?s=128&d=identicon&r=PG&f=1", "display_name": "C. Rib", "link": "https://stackoverflow.com/users/5406663/c-rib"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443964708, "post_id": 32933488, "comment_id": 53693254, "body": "@chi that&#39;s exactly what I&#39;m trying to do, maybe &quot;numbers&quot; wasn&#39;t the best name here, but yeah I need to extract the algarisms from a String."}, {"owner": {"reputation": 188, "user_id": 5406663, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d2fc65d332ca7ec74016b7003e564aa?s=128&d=identicon&r=PG&f=1", "display_name": "C. Rib", "link": "https://stackoverflow.com/users/5406663/c-rib"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1443964925, "post_id": 32933488, "comment_id": 53693329, "body": "@MarkSeemann I understand. How would you suggest I do that? I thought of doing then chr (ord  l) : (numbers ls) but wouldn&#39;t that be considered a character too? Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1342, "user_id": 4780877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lg9ru.jpg?s=128&g=1", "display_name": "Emacs User", "link": "https://stackoverflow.com/users/4780877/emacs-user"}, "reply_to_user": {"reputation": 188, "user_id": 5406663, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d2fc65d332ca7ec74016b7003e564aa?s=128&d=identicon&r=PG&f=1", "display_name": "C. Rib", "link": "https://stackoverflow.com/users/5406663/c-rib"}, "edited": false, "score": 0, "creation_date": 1443966934, "post_id": 32933893, "comment_id": 53693923, "body": "@C.Rib, your solution is incomplete or your question is misleading. Fix one or the other."}], "tags": [], "owner": {"reputation": 1342, "user_id": 4780877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lg9ru.jpg?s=128&g=1", "display_name": "Emacs User", "link": "https://stackoverflow.com/users/4780877/emacs-user"}, "is_accepted": false, "score": 2, "last_activity_date": 1443964521, "creation_date": 1443964521, "answer_id": 32933893, "question_id": 32933488, "link": "https://stackoverflow.com/questions/32933488/take-all-numbers-from-a-string-and-present-them-in-a-list/32933893#32933893", "title": "Take all numbers from a string and present them in a list", "body": "<p>Since this is a class problem, here are some hints. Use the function <code>words</code> to first break the string into individual elements, drop all non-numeric characters, then <code>read \"elem\":Int</code> for each element of your string and filter out those that return false. What's left will be <code>[Int]</code>. </p>\n\n<p>The magic as is obvious is in the <code>read</code> function that takes a char representation of numbers and converts them to Int. If you have very large numbers, consider using <code>read \"elem\":Integer</code> variation.  </p>\n"}, {"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1443966824, "post_id": 32934072, "comment_id": 53693895, "body": "This is not an adequate answer. I realise this is your question, but firstly, remove &quot;thank you!&quot; messages, and secondly, explain why and how this fixes the problem you had. Please edit it."}, {"owner": {"reputation": 188, "user_id": 5406663, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d2fc65d332ca7ec74016b7003e564aa?s=128&d=identicon&r=PG&f=1", "display_name": "C. Rib", "link": "https://stackoverflow.com/users/5406663/c-rib"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1443983644, "post_id": 32934072, "comment_id": 53699141, "body": "@AJFarmar \t First I&#39;m sorry. Second I understand that I am speaking with people way more knowledgeable than me and that they probably know thousands of ways around solving this problem. I am saying this because I do not know another answer for my problem with my 4 hours total of classes and I really want to describe it more and make it &quot;not misleading&quot; but the best I can do is to translate the question. I did not understand Emacs User&#39;s answer, as much as I wanted to."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1443989818, "post_id": 32934072, "comment_id": 53701185, "body": "This is not an excuse for writing and posting an answer that goes against the answering guidelines. You have improved your answer, so I&#39;ve now up-voted it, but keep in mind that I was not insulting you. I know full well you are inexperienced, but answers here must be written to a certain standard. Refer to <a href=\"http://stackoverflow.com/help/how-to-answer\">this page</a>."}], "tags": [], "owner": {"reputation": 188, "user_id": 5406663, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d2fc65d332ca7ec74016b7003e564aa?s=128&d=identicon&r=PG&f=1", "display_name": "C. Rib", "link": "https://stackoverflow.com/users/5406663/c-rib"}, "is_accepted": true, "score": 1, "last_activity_date": 1444126364, "last_edit_date": 1444126364, "creation_date": 1443965788, "answer_id": 32934072, "question_id": 32933488, "link": "https://stackoverflow.com/questions/32933488/take-all-numbers-from-a-string-and-present-them-in-a-list/32934072#32934072", "title": "Take all numbers from a string and present them in a list", "body": "<p>Ok,</p>\n\n<p>The solution is:</p>\n\n<pre><code>numbers :: String -&gt; [Int]\nnumbers [] = []\nnumbers (l:ls) = if ord l &gt;= 48 &amp;&amp; ord l &lt;= 57\n    then (ord l - 48): (numbers ls)\n    else (numbers ls)\n</code></pre>\n\n<p>This solves my problem, which is (and now I'll try to explain it better):</p>\n\n<blockquote>\n  <p>Using functions from the Data.Char module, define recursively the\n  following functions:</p>\n  \n  <p>(c) nums :: String -> [Int] which receives a string and outputs a list\n  with the algarisms that occur on that string, by the same order.</p>\n</blockquote>\n\n<p><em>Please keep in mind that this was made for students that had less than 8 hours of contact with the haskell language and 0 with any other language.</em></p>\n\n<p>If this is incorrect, I would appreciate any answer. I want to learn.</p>\n\n<p>Note: this solution doesn't seem to be the most complete. Alas, it is made for students that just started learning Haskell and don't know how to use the words and map functions.</p>\n"}], "owner": {"reputation": 188, "user_id": 5406663, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d2fc65d332ca7ec74016b7003e564aa?s=128&d=identicon&r=PG&f=1", "display_name": "C. Rib", "link": "https://stackoverflow.com/users/5406663/c-rib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2168, "favorite_count": 0, "accepted_answer_id": 32934072, "answer_count": 2, "score": 0, "last_activity_date": 1444126364, "creation_date": 1443961843, "last_edit_date": 1443983914, "question_id": 32933488, "link": "https://stackoverflow.com/questions/32933488/take-all-numbers-from-a-string-and-present-them-in-a-list", "title": "Take all numbers from a string and present them in a list", "body": "<p>I was doing some Haskell exercises but can't solve the last one.</p>\n\n<p>I need to <strong>recursively</strong> define functions that are already defined in the Data.Char module.</p>\n\n<p>The last function I need to define is of this type:</p>\n\n<pre><code>nums :: String -&gt; [Int]\n</code></pre>\n\n<p>Here is the (translated) question:</p>\n\n<blockquote>\n  <p>Using functions from the Data.Char module, define recursively the following functions:</p>\n  \n  <p>(c) nums :: String -> [Int] which receives a string and outputs a list\n  with the algarisms that occur on that string, by the same order.</p>\n</blockquote>\n\n<pre><code>--This is my code\n\nnumbers :: String -&gt; [Int]\nnumbers [] = []\nnumbers (l:ls) = if ord l &gt;= 48 &amp;&amp; ord l &lt;= 57\n                 then l : (numbers ls)\n                 else (numbers ls)\n</code></pre>\n\n<p>I've been getting this error on the interpreter:</p>\n\n<pre><code>pratica3.hs:137:14:\n    Couldn't match expected type `Int' with actual type `Char'\n    In the first argument of `(:)', namely `l'\n    In the expression: l : (numbers ls)\n    In the expression:\n      if ord l &gt;= 48 &amp;&amp; ord l &lt;= 57 then\n          l : (numbers ls)\n      else\n          (numbers ls)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "monads", "parse-error"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443963018, "post_id": 32933365, "comment_id": 53692784, "body": "I have a hunch that the definition of <code>item</code> is wrong (it shouldn&#39;t be just a function, that makes it be in the entirely wrong monad for a parser), and that if it compiles like this, then the definition of <code>Parser</code> is wrong too (perhaps it&#39;s defined with <code>type</code>? You cannot define own monads for things defined with <code>type</code>.)"}, {"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443963430, "post_id": 32933365, "comment_id": 53692897, "body": "I&#39;ll post how I wrote the parser."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443964366, "post_id": 32933365, "comment_id": 53693168, "body": "Right, that&#39;s about what I figured. You won&#39;t be able to get do notation to work correctly for the parser with that type definition."}, {"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443965569, "post_id": 32933365, "comment_id": 53693528, "body": "In that case, my book has the wrong definition. Can you post the real definition?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1443966320, "post_id": 32933365, "comment_id": 53693727, "body": "@mcNogard It&#39;s the instance that&#39;s the problem. Make it a Monad."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1443975145, "post_id": 32933365, "comment_id": 53696422, "body": "@mcNogard You can do <code>import Control.Monad.State; type Parser a = StateT String [] a</code> and then you will have an instance that works. But you may need to do other adjustments, like adding <code>StateT $</code> after <code>item =</code>."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "edited": false, "score": 0, "creation_date": 1443962424, "post_id": 32933419, "comment_id": 53692611, "body": "The p is compiling now, but it still gives me the wrong result. p &quot;abcd&quot; gives the result ([(&#39;a&#39;,&quot;bcd&quot;)],[(&#39;a&#39;,&quot;bcd&quot;)],[(&#39;a&#39;,&quot;bcd&quot;)]). I want to get the result [(&#39;a&#39;, &#39;c&#39;), &quot;d&quot;], which is the result in my book."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "edited": false, "score": 0, "creation_date": 1443966066, "post_id": 32933419, "comment_id": 53693669, "body": "@mcNogard You may have written the in-line <code>item</code> accidentally. Ie, it should just be <code>do {x &lt;- item; y &lt;- item; return (x,y)}</code> or just <code>(,) &lt;$&gt; item &lt;*&gt; item</code> in Applicative style. That&#39;s probably what you&#39;re looking for. But that&#39;s another question."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "edited": false, "score": 0, "creation_date": 1443966250, "post_id": 32933419, "comment_id": 53693716, "body": "Ah, but wait: You&#39;re working in the function monad, not the Parser monad! You need to define <code>Parser</code> as another type and make a monad instance. Of course it won&#39;t work if you&#39;re not using the right monad!"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1443961427, "creation_date": 1443961427, "answer_id": 32933419, "question_id": 32933365, "link": "https://stackoverflow.com/questions/32933365/parse-error-in-a-do-block-on-input/32933419#32933419", "title": "Parse error in a `do` block on input `&lt;-`", "body": "<p>It's just a formatting thing. Start a newline:</p>\n\n<pre><code>p = do\n    x &lt;- item\n    item\n    y &lt;- item\n    return (x,y)\n</code></pre>\n\n<p>As for <code>q</code>, remember that <code>do {x &lt;- item; f x}</code> is equivalent to <code>item &gt;&gt;= \\x -&gt; f x</code>, and the second one is redundant, so:</p>\n\n<pre><code>q = do\n    x1 &lt;- item \n    item\n    x3 &lt;- item\n    return (x1, x3)\n</code></pre>\n\n<p>...which is equivalent to <code>p</code>.</p>\n"}], "owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4049, "favorite_count": 0, "accepted_answer_id": 32933419, "answer_count": 1, "score": 2, "last_activity_date": 1443966295, "creation_date": 1443961101, "last_edit_date": 1443966295, "question_id": 32933365, "link": "https://stackoverflow.com/questions/32933365/parse-error-in-a-do-block-on-input", "title": "Parse error in a `do` block on input `&lt;-`", "body": "<p>In my textbook, there is an example of how to take out the first and third character from a string using parsers. I have tried to write it down as it stands in the book. </p>\n\n<pre><code>type Parser a = String -&gt; [(a,String)]\n\nitem = \\inp -&gt; case inp of\n    []-&gt; []\n    (x:xs) -&gt; [(x,xs)]\n\np = do \n    x &lt;- item\n    item \n    y &lt;- item\n    return (x,y)\n</code></pre>\n\n<p>However I get the message: </p>\n\n<pre><code>dataTest.hs:47:11:\nparse error on input \u2018&lt;-\u2019\nPerhaps this statement should be within a 'do' block?\n</code></pre>\n\n<p>As I was not able to figure out what went wrong, I wrote down this for a less abstract version of the code: </p>\n\n<pre><code>q = item &gt;&gt;= \\x1 -&gt; \n    item &gt;&gt;= \\x2 -&gt;\n    item &gt;&gt;= \\x3 -&gt; \n    return (x1, x3)\n</code></pre>\n\n<p>But as shown below:</p>\n\n<pre><code>*Main&gt; q \"abc\"\n([('a',\"bc\")],[('a',\"bc\")],[('a',\"bc\")])\n</code></pre>\n\n<p>I get the wrong output. </p>\n\n<p>So I have two questions:</p>\n\n<ol>\n<li>How should I write p?</li>\n<li>How should I write q? </li>\n</ol>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1443964445, "post_id": 32932943, "comment_id": 53693189, "body": "Do you want <code>ssum xs = execState (traverse (modify . (+)) xs) 0</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443975751, "post_id": 32932943, "comment_id": 53696607, "body": "Unfortunately, whenever anyone talks about <code>ListT</code>, you really have to ask &quot;which one?&quot; because there are several very different versions that behave very differently."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1443958836, "creation_date": 1443958836, "answer_id": 32933044, "question_id": 32932943, "link": "https://stackoverflow.com/questions/32932943/how-to-combine-list-and-state-monad-in-haskell/32933044#32933044", "title": "How to combine List and State Monad in Haskell", "body": "<pre><code>    x &lt;- ListT $ return [1,2,3]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    x &lt;- msum $ return &lt;$&gt; [1,2,3]\n</code></pre>\n\n<p>will do the trick.</p>\n\n<ul>\n<li><p><code>ListT . return</code> just injects a list structure-awarely into a list-transformed monad stack.</p></li>\n<li><p><code>msum</code> uses the fact that <code>ListT</code> is the transformer mapping a monad to the free <code>MonadPlus</code> monoid over it.</p></li>\n</ul>\n"}], "owner": {"reputation": 2548, "user_id": 493886, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/609445395685769579dc8fb2dbb83f49?s=128&d=identicon&r=PG", "display_name": "rausch", "link": "https://stackoverflow.com/users/493886/rausch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 32933044, "answer_count": 1, "score": 3, "last_activity_date": 1443959816, "creation_date": 1443958056, "question_id": 32932943, "link": "https://stackoverflow.com/questions/32932943/how-to-combine-list-and-state-monad-in-haskell", "title": "How to combine List and State Monad in Haskell", "body": "<p>I want to basically map over a list and at the same time carry along some state. I figured combining the list and state monads might get me there. I tried a few things and figured out that I likely need to use <code>ListT</code> for that. As a simplified version of my actual problem, imagine that I want to implement the <code>sum</code> function, while also returning a modified version of the original list. This or similar is what I imagined it would have to look like:</p>\n\n<pre><code>sum' :: ListT (State Int) Int\nsum' = do\n    lift $ put 0\n    x &lt;- [1,2,3]\n    lift $ modify (+x)\n    return $ x + 1\n</code></pre>\n\n<p>What I don't get yet is how the syntax of the regular list monad translates to the ListT monad. I cannot simply do <code>x &lt;- [1,2,3]</code>, since on the right side of the arrow, type <code>ListT (State Int) t0</code> is expected. <code>x &lt;- return [1,2,3]</code> compiles (as in keeps the compiler from complaining about this line) but gets me the whole list put into x, instead of each element.</p>\n\n<p>How do I get this working?</p>\n"}, {"tags": ["list", "haskell", "monoids"], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444029231, "post_id": 32934309, "comment_id": 53711263, "body": "Got It. Thanks so much for your detailed explanation up there. So basically, if I want to create a data structure to store the items in a bag, and their number, can I create something like:                                                            bag :: Eq a =&gt; [a]-&gt;[a]-&gt;[a]"}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444029625, "post_id": 32934309, "comment_id": 53711447, "body": "bag :: Eq a =&gt; [a]-&gt;[a]-[a]                                                                                      bag items nr = if null items || null nr                                                                then append bagItems []                                                                               else append bagItems items                                                                               append bagItemsNr nr ?                                                                      Can I do something like that for storing the elemesnt and numbers of items in each bg"}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444031155, "post_id": 32934309, "comment_id": 53712180, "body": "@user9515: This is starting to sound like a separate question. I would probably not store the number of items in each set separately because you run the risk of the numbers somehow running out of sync with the item sets. After all, it is also very easy to retrieve the number of items in each sublist: <code>map length bag</code>. If you really do want to store the number with each set of items, I would probably choose a <code>bag :: [(Int, [a])]</code> where the lists of items are stored together with their length in the bag. You would then add items as such: <code>bagItems bag items = (length items, items) : bag</code>."}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444036077, "post_id": 32934309, "comment_id": 53714760, "body": "Yeah, but what if I have for example: [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;c&quot;,&quot;c&quot;] -&gt; I want to store this list for example. Should I use something like:                                                    bag:: [(Int,[a])] and then call                                                                                  bagItems bag items = (length items, items) : bag                                           I mean I have different items in each bag? How can I store them in the most quickest way possible? Really new to this kind of programming, and it&#39;s just for curiosity. Thanks!"}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444036298, "post_id": 32934309, "comment_id": 53714881, "body": "Until now I was thinking like                                                                                                 bag :: Eq a =&gt; [a] -&gt; [a]                                                                                         bagItems :: bag -&gt; [] -&gt; [[String]]                                                                                              bagItems bag items = ([ items length ]) ...."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444036660, "post_id": 32934309, "comment_id": 53715090, "body": "@user9515: I&#39;m not sure I understand what you want. If <code>itemz</code> is a list of strings, <code>bag</code> will technically be a list of lists of lists (because strings are lists as well). So I&#39;m not sure if your example is an item in the bag or the bag itself. I also don&#39;t know what you mean with your type statement <code>bag :: Eq a =&gt; [Int] -&gt; [a]</code> - think about it: you can&#39;t just create a list of any (Eq) type from only a list of integers as input."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444036882, "post_id": 32934309, "comment_id": 53715210, "body": "@user9515: You seem to be misunderstanding some quite fundamental principles behind the Haskell type system. Maybe you should spend some more time with (for example) <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">Learn You A Haskell</a>."}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444037209, "post_id": 32934309, "comment_id": 53715402, "body": "So my question is, how can I store a list of items, for example [&quot;a&quot;,&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;c&quot;] in a haskell programme efficiently, so for example, storing a list of items, say [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;] then a list of the numbers of those items [2,1,2]. Can I use bags to help me solve this question? Can u put a piece of code here, regarding storing this numbers? I would appreciate it!"}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444039655, "post_id": 32934309, "comment_id": 53716945, "body": "@user9515: Ok I think I understand what you were looking for now, although it was not so clear from the question. See my updated answer. Documentation for Data.Map is <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Map.html\" rel=\"nofollow noreferrer\">here</a> and usage is also explained in Real World Haskell and I think Learn You A Haskell as well."}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444042603, "post_id": 32934309, "comment_id": 53718654, "body": "Got it now. And if I want to save more than one bag? For example, each bag has certain items, so, I don&#39;t basically add to.each bag, but I want to.save each bag to an array of bags or something like that"}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444043037, "post_id": 32934309, "comment_id": 53718894, "body": "As with any type you can make a list of <code>Map</code>s. If you have a <code>[[String]]</code> you can use <code>map (addToBag bag) itemlists</code> to make a <code>[Map String Int]</code>. If you want you can even use another layer of <code>Map</code>s, i.e. <code>Map String (Map String Int)</code>."}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444051293, "post_id": 32934309, "comment_id": 53724100, "body": "bagsList :: [[M.Map String Int]] bagsList = [[]]                                                                                                        addToBag :: M.Map String Int -&gt; [String] -&gt; M.Map String Int addToBag = foldl&#39; go   where go m i = M.insertWith (+) i 1 m         bagsList.append (go) Should this be the one? Not quite sure how to append it to a list of lists, and which is the parameter. Is it go, after that where?"}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1444052892, "post_id": 32934309, "comment_id": 53725172, "body": "@user9515: I can&#39;t make sense of this amount of code in comments. If you understand the solutions I&#39;ve presented (i.e. how they work) I think you have all the information you need to accomplish what you want. If you don&#39;t understand the code, take your introductory Haskell guide of choice (real world haskell or learn you a haskell) and look up the necessary concepts, I think you&#39;ll be able to figure it out. If you run into problems with your code ask a different question, this discussion is going too far off-topic from your original question."}], "tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": true, "score": 2, "last_activity_date": 1444039622, "last_edit_date": 1444039622, "creation_date": 1443967518, "answer_id": 32934309, "question_id": 32932618, "link": "https://stackoverflow.com/questions/32932618/add-a-list-to-a-list-of-lists-in-haskell/32934309#32934309", "title": "Add a list to a list of lists in Haskell", "body": "<p>You might want to consider adding it at the front, this is faster:</p>\n\n<pre><code>bagItem bag item = item : bag\n</code></pre>\n\n<p>Also it looks like you're coming from an imperative mindset, the way you use <code>bagList</code> before and after the <code>=</code> is not quite right: the expressions before and after the <code>=</code> do not really represent the same construction. Before the <code>=</code> <code>bagItem</code> is used as a function, after the <code>=</code> it's used as some <code>Monoid</code> (which if <code>itemz</code> is a list would also need to be a list).</p>\n\n<p>If you really do want to append the item (this will be slower, because the operation will require going all the way through the list to add the new item at the end, and the whole list will need to be reconstructed) you can do what Christoph suggests or you can go for a recursive formulation something like this:</p>\n\n<pre><code>appendItem :: a -&gt; [a] -&gt; [a]\nappendItem i (x:xs) = x : appendItem i xs\nappendItem i [] = i : []\n</code></pre>\n\n<p>If you both want to append and are also worried about performance, you should have a look at difference lists, for example look for the section on difference lists in <a href=\"http://learnyouahaskell.com/for-a-few-monads-more\" rel=\"nofollow\">this chapter in Learn You a Haskell</a>.</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>From the comments it seems what you are actually looking for is <code>Map</code>s. We can make a <code>Map</code> with each item as a key, and the number of occurrences as the value. In your case it seems this will be a <code>Map String Int</code>.</p>\n\n<pre><code>import Data.List (foldl')\nimport qualified Data.Map as M\n\nbag :: M.Map String Int\nbag = M.empty\n\naddToBag :: M.Map String Int -&gt; [String] -&gt; M.Map String Int\naddToBag = foldl' go\n  where go m i = M.insertWith (+) i 1 m\n\nmain = print $ addToBag bag [\"a\",\"b\",\"c\",\"a\"]\n-- fromList [(\"a\",2), (\"b\", 1), (\"c\", 1)]\n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "accepted_answer_id": 32934309, "answer_count": 1, "score": 0, "last_activity_date": 1444039622, "creation_date": 1443955543, "last_edit_date": 1443956248, "question_id": 32932618, "link": "https://stackoverflow.com/questions/32932618/add-a-list-to-a-list-of-lists-in-haskell", "title": "Add a list to a list of lists in Haskell", "body": "<p>How can I add a list to a list of lists? Say I want to add <code>itemz</code> to <code>bagList</code>, which is a list of lists. How can I do that?</p>\n\n<pre><code>bagList itemz = mappend bagList itemz               \n</code></pre>\n"}, {"tags": ["haskell", "monads", "functor", "applicative", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1443956299, "post_id": 32932140, "comment_id": 53690992, "body": "An example of one-<code>Functor</code>-two-<code>Applicative</code>s is the list monad: it can be a <code>ZipList</code> or a regular one, but I&#39;m unsure about there being any one-<code>Applicative</code>-many-<code>Monad</code>s."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444105723, "post_id": 32932140, "comment_id": 53748393, "body": "Darn. I already voted this up, so I can&#39;t vote it up again to reflect your edit."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1444436852, "post_id": 32932140, "comment_id": 53918726, "body": "Nice example of two Monads with the same Applicative. To make it clear that your second structure really is a monad (it&#39;s associative), consider the alg. theory of semigroups with an absorbing element (0 s.t. 0x = 0 = x0 for all x). The elements of the free such structure on a set are nonempty sequences of elements of the set, plus 0. So they are in one-to-one correspondence with lists (sending a nonempty sequence to a nonempty list, and 0 to the empty list). The monad for this structure, after being transported to lists in this way, is your new Monad [] instance."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1444437070, "post_id": 32932140, "comment_id": 53918775, "body": "@ReidBarton Another way to see it, which may be equivalent to what you say: I concluded my monad is isomorphic to <code>NonEmptyT Maybe</code> (where <code>NonEmptyT</code> isn&#39;t defined in any library I found but you can fake it with <code>ListT</code> and just not using empty lists.)"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444440089, "post_id": 32932140, "comment_id": 53919368, "body": "Yes, they seem related at least. Both correspond somehow to the idea of having an associative nondeterministic &quot;fork&quot; operation plus a &quot;global&quot; failure operation (as contrasted with the regular Monad []&#39;s &quot;local&quot; failure operation)."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 27, "last_activity_date": 1444125692, "last_edit_date": 1444125692, "creation_date": 1443952133, "answer_id": 32932140, "question_id": 32931549, "link": "https://stackoverflow.com/questions/32931549/to-what-extent-are-applicative-monad-instances-uniquely-determined/32932140#32932140", "title": "To what extent are Applicative/Monad instances uniquely determined?", "body": "<p>First, since <code>Monoid</code>s are not unique, neither are <code>Writer</code> <code>Monad</code>s or <code>Applicative</code>s. Consider</p>\n\n<pre><code>data M a = M Int a\n</code></pre>\n\n<p>then you can give it <code>Applicative</code> and <code>Monad</code> instances isomorphic to either of:</p>\n\n<pre><code>Writer (Sum Int)\nWriter (Product Int)\n</code></pre>\n\n<p>Given a <code>Monoid</code> instance for a type <code>s</code>, another isomorphic pair with different <code>Applicative</code>/<code>Monad</code> instances is:</p>\n\n<pre><code>ReaderT s (Writer s)\nState s\n</code></pre>\n\n<p>As for having one <code>Applicative</code> instance extend to two different <code>Monad</code>s, I cannot remember any example. However, back when I tried to convince myself completely about whether <code>ZipList</code> really cannot be made a <code>Monad</code>, I found the following pretty strong restriction that holds for any <code>Monad</code>:</p>\n\n<pre><code>join (fmap (\\x -&gt; fmap (\\y -&gt; f x y) ys) xs) = f &lt;$&gt; xs &lt;*&gt; ys\n</code></pre>\n\n<p>That doesn't give <code>join</code> for <em>all</em> values though: in the case of lists the restricted values are the ones where all elements have the same length, i.e. lists of lists with \"rectangular\" shape.</p>\n\n<p>(For <code>Reader</code> monads, where the \"shape\" of monadic values doesn't vary, these are in fact all the <code>m (m x)</code> values, so those do have unique extension. EDIT: Come to think of it, <code>Either</code>, <code>Maybe</code> and <code>Writer</code> also have only \"rectangular\" <code>m (m x)</code> values, so their extension from <code>Applicative</code> to <code>Monad</code> is also unique.)</p>\n\n<p>I wouldn't be surprised if an <code>Applicative</code> with two <code>Monad</code>s exists, though.</p>\n\n<p>For <code>Alternative</code>/<code>MonadPlus</code>, <s>I cannot recall any law</s> for instances using the Left Distribution law instead of Left Catch, I see nothing preventing you from just swapping <code>(&lt;|&gt;)</code> with <code>flip (&lt;|&gt;)</code>. I don't know if there's a less trivial variation.</p>\n\n<p>ADDENDUM: I suddenly remembered I <em>had</em> found an example of an <code>Applicative</code> with two <code>Monad</code>s. Namely, finite lists. There's the usual <code>Monad []</code> instance, but you can then replace its <code>join</code> by the following function (essentially making empty lists \"infectious\"):</p>\n\n<pre><code>ljoin xs\n  | any null xs = []\n  | otherwise   = concat xs\n</code></pre>\n\n<p>(Alas, the lists need to be finite because otherwise the <code>null</code> check will never finish, and that would ruin the <code>join . fmap return == id</code> monad law.)</p>\n\n<p>This has the same value as <code>join</code>/<code>concat</code> on rectangular lists of lists, so will give the same <code>Applicative</code>. As I recall, it turns out that the first two monad laws are automatic from that, and you just need to check <code>ljoin . ljoin == ljoin . fmap ljoin</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 8957, "user_id": 1073868, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/397bb6e2c9cc191a20143ca8566385c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1073868/dan"}, "edited": false, "score": 2, "creation_date": 1443975901, "post_id": 32933842, "comment_id": 53696657, "body": "As a non-Haskeller: I understand some of these words, just not in the order that you put them."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1443976131, "post_id": 32933842, "comment_id": 53696723, "body": "As the author of the other answer: ARGH my head!"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1443980047, "post_id": 32933842, "comment_id": 53697975, "body": "I&#39;m not sure being a Haskeller helps all that much. Dependently typed insights into the structure of data that aren&#39;t directly modellable in Haskell (the insights, I mean, but sometimes the data as well) will inevitably be a struggle to get your head around. Perhaps it may eventually become worth it."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 8957, "user_id": 1073868, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/397bb6e2c9cc191a20143ca8566385c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1073868/dan"}, "edited": false, "score": 2, "creation_date": 1443981753, "post_id": 32933842, "comment_id": 53698467, "body": "@ARedHerring As a Haskeller, I&#39;m pretty much the same. But I&#39;m <i>fascinated</i>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1444082625, "post_id": 32933842, "comment_id": 53742196, "body": "Thinking about your edit, I note that the <code>join (fmap ...) = f &lt;$&gt; xs &lt;*&gt; ys</code> equation fixes all values of <code>join</code> (essentially all values are what I call &quot;rectangular&quot;) unless you have more than one shape, and at least one shape has two or more positions. This finally made me remember my actual counterexample!"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 22, "last_activity_date": 1444159150, "last_edit_date": 1495542716, "creation_date": 1443964142, "answer_id": 32933842, "question_id": 32931549, "link": "https://stackoverflow.com/questions/32931549/to-what-extent-are-applicative-monad-instances-uniquely-determined/32933842#32933842", "title": "To what extent are Applicative/Monad instances uniquely determined?", "body": "<p>Given that every <code>Applicative</code> has a <code>Backwards</code> counterpart,</p>\n\n<pre><code>newtype Backwards f x = Backwards {backwards :: f x}\ninstance Applicative f =&gt; Applicative (Backwards f) where\n  pure x = Backwards (pure x)\n  Backwards ff &lt;*&gt; Backwards fs = Backwards (flip ($) &lt;$&gt; fs &lt;*&gt; ff)\n</code></pre>\n\n<p>it's <em>unusual</em> for <code>Applicative</code> to be uniquely determined, just as (and this is very far from unrelated) many sets extend to monoids in multiple ways.</p>\n\n<p>In <a href=\"https://stackoverflow.com/a/32825891/828361\">this answer</a>, I set the exercise of finding at least four distinct valid <code>Applicative</code> instances for nonempty lists: I won't spoil it here, but I will give a big hint on how to hunt.</p>\n\n<p>Meanwhile, in some wonderful recent work (which I saw at a summer school a few months ago), Tarmo Uustalu showed a rather neat way to get a handle on this problem, at least when the underlying functor is a <em>container</em>, in the sense of Abbott, Altenkirch and Ghani.</p>\n\n<p><strong>Warning: Dependent types ahead!</strong></p>\n\n<p><strong>What is a container?</strong> If you have dependent types to hand, you can present container-like functors F uniformly, as being determined by two components</p>\n\n<ol>\n<li>a set of shapes, S : Set</li>\n<li>an S-indexed set of positions, P : S -> Set</li>\n</ol>\n\n<p>Up to isomorphism, container data structures in F X are given by the dependent pair of some shape s : S, and some function e : P s -> X, which tells you the element located at each position. That is, we define the extension of a container</p>\n\n<pre><code>(S &lt;| P) X = (s : S) * (P s -&gt; X)\n</code></pre>\n\n<p>(which, by the way, looks a lot like a generalized power series if you read <code>-&gt;</code> as reversed exponentiation). The triangle is supposed to remind you of a tree node sideways, with an element s : S labelling the apex, and the baseline representing the position set P s. We say that some functor is a container if it is isomorphic to some <code>S &lt;| P</code>.</p>\n\n<p>In Haskell, you can easily take <code>S = F ()</code>, but constructing <code>P</code> can take quite a bit of type-hackery. But that <em>is</em> something you can try at home. You'll find that containers are closed under all the usual polynomial type-forming operations, as well as identity,</p>\n\n<pre><code>Id ~= () &lt;| \\ _ -&gt; ()\n</code></pre>\n\n<p>composition, where a whole shape is made from just one outer shape and an inner shape for each outer position,</p>\n\n<pre><code>(S0 &lt;| P0) . (S1 &lt;| P1)  ~=  ((S0 &lt;| P0) S1) &lt;| \\ (s0, e0) -&gt; (p0 : P0, P1 (e0 p0))\n</code></pre>\n\n<p>and some other things, notably the <em>tensor</em>, where there is one outer and one inner shape (so \"outer\" and \"inner\" are interchangeable)</p>\n\n<pre><code>(S0 &lt;| P0) (X) (S1 &lt;| P1)   =   ((S0, S1) &lt;| \\ (s0, s1) -&gt; (P0 s0, P1 s1))\n</code></pre>\n\n<p>so that <code>F (X) G</code> means \"<code>F</code>-structures of <code>G</code>-structures-all-the-same-shape\", e.g., <code>[] (X) []</code> means <em>rectangular</em> lists-of-lists. But I digress</p>\n\n<p><strong>Polymorphic functions between containers</strong> Every polymorphic function</p>\n\n<pre><code>m : forall X. (S0 &lt;| P0) X -&gt; (S1 &lt;| P1) X\n</code></pre>\n\n<p>can be implemented by a <em>container morphism</em>, constructed from two components in a very particular way.</p>\n\n<ol>\n<li>a function <code>f : S0 -&gt; S1</code> mapping input shapes to output shapes;</li>\n<li>a function <code>g : (s0 : S0) -&gt; P1 (f s0) -&gt; P0 s0</code> mapping output positions to input positions.</li>\n</ol>\n\n<p>Our polymorphic function is then</p>\n\n<pre><code>\\ (s0, e0) -&gt; (f s0, e0 . g s0)\n</code></pre>\n\n<p>where the output shape is computed from the input shape, then the output positions are filled up by picking elements from input positions.</p>\n\n<p>(If you're Peter Hancock, you have a whole other metaphor for what's going on. Shapes are Commands; Positions are Responses; a container morphism is a <em>device driver</em>, translating commands one way, then responses the other.)</p>\n\n<p>Every container morphism gives you a polymorphic function, but the reverse is also true. Given such an m, we may take</p>\n\n<pre><code>(f s, g s) = m (s, id)\n</code></pre>\n\n<p>That is, we have a <em>representation theorem</em>, saying that every polymorphic function between two containers is given by such an <code>f</code>, <code>g</code>-pair.</p>\n\n<p><strong>What about <code>Applicative</code>?</strong> We kind of got a bit lost along the way, building all this machinery. But it <em>has</em> been worth it. When the underlying functors for monads and applicatives are containers, the polymorphic functions <code>pure</code> and <code>&lt;*&gt;</code>, <code>return</code> and <code>join</code> must be representable by the relevant notion of container morphism.</p>\n\n<p>Let's take applicatives first, using their monoidal presentation. We need</p>\n\n<pre><code>unit : () -&gt; (S &lt;| P) ()\nmult : forall X, Y. ((S &lt;| P) X, (S &lt;| P) Y) -&gt; (S &lt;| P) (X, Y)\n</code></pre>\n\n<p>The left-to-right maps for shapes require us to deliver</p>\n\n<pre><code>unitS : () -&gt; S\nmultS : (S, S) -&gt; S\n</code></pre>\n\n<p>so it looks like we might need a monoid. And when you check that the applicative laws, you find we need <em>exactly</em> a monoid. Equipping a container with applicative structure is <em>exactly</em> refining the monoid structures on its shapes with suitable position-respecting operations. There's nothing to do for <code>unit</code> (because there is no chocie of source position), but for <code>mult</code>, we need that whenenver</p>\n\n<pre><code>multS (s0, s1) = s\n</code></pre>\n\n<p>we have</p>\n\n<pre><code>multP (s0, s1) : P s -&gt; (P s0, P s1)\n</code></pre>\n\n<p>satisfying appropriate identity and associativity conditions. If we switch to Hancock's interpretation, we're defining a monoid (skip, semicolon) for commands, where there is no way to look at the response to the first command before choosing the second, like commands are a deck of punch cards. We have to be able to chop up responses to combined commands into the individual responses to the individual commands.</p>\n\n<p>So, every monoid on the shapes gives us a potential applicative structure. For lists, shapes are numbers (lengths), and there are a great many monoids from which to choose. Even if shapes live in <code>Bool</code>, we have quite a bit of choice.</p>\n\n<p><strong>What about <code>Monad</code>?</strong> Meanwhile, for monads <code>M</code> with <code>M ~= S &lt;| P</code>. We need </p>\n\n<pre><code>return : Id -&gt; M\njoin   : M . M -&gt; M\n</code></pre>\n\n<p>Looking at shapes first, that means we need a sort-of lopsided monoid.</p>\n\n<pre><code>return_f : () -&gt; S\njoin_f   : (S &lt;| P) S -&gt; S  --  (s : S, P s -&gt; S) -&gt; S\n</code></pre>\n\n<p>It's lopsided because we get a bunch of shapes on the right, not just one. If we switch to Hancock's interpretation, we're defining a kind of sequential composition for commands, where we do let the second command be chosen on the basis of the first response, like we're interacting at a teletype. More geometrically, we're explaining how to glom two layers of a tree into one. It would be very surprising if such compositions were unique.</p>\n\n<p>Again, for the positions, we have to map single output positions to pairs in a coherent way. This is trickier for monads: we first choose an outer position (response), then we have to choose an inner position(response) appropriate to the shape (command) found at the first position (chosen after the first response).</p>\n\n<p>I'd love to link to Tarmo's work for the details, but it doesn't seem to have hit the streets yet. He has actually used this analysis to enumerate all possible monad structures for several choices of underlying container. I'm looking forward to the paper!</p>\n\n<p><strong>Edit.</strong> By way of doing honour to the other answer, I should observe that when everywhere <code>P s = ()</code>, then <code>(S &lt;| P) X ~= (S, X)</code> and the monad/applicative structures coincide exactly with each other and with the monoid structures on <code>S</code>. That is, for writer monads, we need only choose the shape-level operations, because there is exactly one position for a value in every case.</p>\n"}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 12, "accepted_answer_id": 32932140, "answer_count": 2, "score": 29, "last_activity_date": 1444159150, "creation_date": 1443947474, "last_edit_date": 1495539973, "question_id": 32931549, "link": "https://stackoverflow.com/questions/32931549/to-what-extent-are-applicative-monad-instances-uniquely-determined", "title": "To what extent are Applicative/Monad instances uniquely determined?", "body": "<p>As described <a href=\"https://stackoverflow.com/q/19774904/1333025\">this question/answers</a>, <code>Functor</code> instances are uniquely determined, if they exists.</p>\n\n<p>For lists, there are two well know Applicative instances: <code>[]</code> and <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Applicative.html#v:ZipList\" rel=\"noreferrer\"><code>ZipList</code></a>. So <strong>Applicative isn't unique</strong> (see also <a href=\"https://stackoverflow.com/q/32929252/1333025\">Can GHC derive Functor and Applicative instances for a monad transformer?</a> and <a href=\"https://stackoverflow.com/q/18861231/1333025\">Why is there no <code>-XDeriveApplicative</code> extension?</a>). However, <code>ZipList</code> needs infinite lists, as its <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Applicative.html#v:pure\" rel=\"noreferrer\"><code>pure</code></a> repeats a given element indefinitely.</p>\n\n<ul>\n<li>Are there other, perhaps better examples of data structures that have at least two <code>Applicative</code> instances?</li>\n<li>Are there any such examples that only involve finite data structures? That is, like if hypothetically Haskell's type system distinguished inductive and <a href=\"https://en.wikipedia.org/wiki/Coinduction\" rel=\"noreferrer\">coinductive</a> data types, would it be possible to uniquely determine Applicative?</li>\n</ul>\n\n<p>Going further, if we could extend both <code>[]</code> and <code>ZipList</code> to a Monad, we'd have an example where a monad isn't uniquely determined by the data type and its Functor. Alas, <code>ZipList</code> has a Monad instance <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2009-April/059087.html\" rel=\"noreferrer\">only if we restrict ourselves to infinite lists</a> (<a href=\"https://hackage.haskell.org/package/Stream-0.4.7.2/docs/Data-Stream.html\" rel=\"noreferrer\">streams</a>).\nAnd <code>return</code> for <code>[]</code> creates a single-element list, so it requires finite lists. Therefore:</p>\n\n<ul>\n<li>Are Monad instances uniquely determined by the data type? Or is there an example of a data type that can have two distinct Monad instances?</li>\n</ul>\n\n<p>In the case there is an example with two or more distinct instances, an obvious question arises, if they must/can have the same Applicative instance:</p>\n\n<ul>\n<li>Are Monad instances uniquely determined by the Applicative instance, or is there an example of an Applicative that can have two distinct Monad instances?</li>\n<li>Is there an example of a data type with two distinct Monad instances, each having a different Applicative super-instance?</li>\n</ul>\n\n<p>And finally we can ask the same question for Alternative/MonadPlus. This is complicated by the fact that there are two distinct set of <a href=\"https://wiki.haskell.org/MonadPlus\" rel=\"noreferrer\">MonadPlus laws</a>. Assuming we accept one of the set of laws (and for Applicative we accept <a href=\"https://stackoverflow.com/a/28714160/1333025\">right/left distributivity/absorption</a>, see also <a href=\"https://stackoverflow.com/q/13080606/1333025\">this question</a>),</p>\n\n<ul>\n<li>is Alternative uniquely determined by Applicative, and MonadPlus by Monad, or are there any counter-examples?</li>\n</ul>\n\n<p>If any of the above are unique, I'd be interested in knowing why, to have a hint of a proof. If not, an counter-example.</p>\n"}, {"tags": ["haskell", "data-structures"], "comments": [{"owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "edited": false, "score": 0, "creation_date": 1443938625, "post_id": 32930394, "comment_id": 53686973, "body": "[a] is a linked list which is quite efficient at element manipulation. If your problem is efficient indexing then the solution will depend on the actual use case. Perhaps <a href=\"https://wiki.haskell.org/Zipper\" rel=\"nofollow noreferrer\">zippers</a> will help?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1443938895, "post_id": 32930394, "comment_id": 53687015, "body": "Are you asking about <a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Mutable.html\" rel=\"nofollow noreferrer\"><code>Data.Vector.Mutable</code></a>?"}, {"owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "edited": false, "score": 0, "creation_date": 1443938901, "post_id": 32930394, "comment_id": 53687016, "body": "Also look at <a href=\"https://en.wikipedia.org/wiki/Rope_%28data_structure%29\" rel=\"nofollow noreferrer\">Ropes</a>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443943954, "post_id": 32930394, "comment_id": 53687981, "body": "This could definitely be a job for a mutable array, which will do this in constant time and space. But using a mutable data structure may not fit your use case - what exactly are you trying to do?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1443969529, "post_id": 32930394, "comment_id": 53694679, "body": "It sounds like an <code>STArray</code> is what you are looking for."}], "answers": [{"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1443938587, "creation_date": 1443938587, "answer_id": 32930525, "question_id": 32930394, "link": "https://stackoverflow.com/questions/32930394/haskell-data-structure-that-is-efficient-for-swapping-elements/32930525#32930525", "title": "Haskell data structure that is efficient for swapping elements?", "body": "<p>Haskell is a (nearly) pure functional language, so any data structure you update will need to make a new copy of the structure, and re-using the data elements is close to the best you can do.  Also, the new list would be lazily evaluated and typically only the spine would need to be created until you need the data.  If the number of updates is small compared to the number of elements, you could make a difference list that checks a sparse set of updates first, and only then looks in the original vector.</p>\n"}, {"tags": [], "owner": {"reputation": 707, "user_id": 646408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e62561db40e46118628b31cba87840d6?s=128&d=identicon&r=PG", "display_name": "lpsmith", "link": "https://stackoverflow.com/users/646408/lpsmith"}, "is_accepted": false, "score": 5, "last_activity_date": 1443941804, "creation_date": 1443941804, "answer_id": 32930864, "question_id": 32930394, "link": "https://stackoverflow.com/questions/32930394/haskell-data-structure-that-is-efficient-for-swapping-elements/32930864#32930864", "title": "Haskell data structure that is efficient for swapping elements?", "body": "<p><code>Data.Sequence</code> from the <a href=\"https://hackage.haskell.org/package/containers\" rel=\"noreferrer\"><code>containers</code></a> package would likely be a not-terrible data structure to start with for this use case.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443945911, "post_id": 32931311, "comment_id": 53688409, "body": "I was surprised to read that updates cost only O(1), even with the proviso on the tree height. That&#39;s pretty good. You may wish to mention some complexity bounds in your answer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443976078, "post_id": 32931311, "comment_id": 53696709, "body": "Edward Kmett&#39;s been working on some similar structures. I&#39;m not sure how close he is to a release."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 14, "last_activity_date": 1443948531, "last_edit_date": 1443948531, "creation_date": 1443945601, "answer_id": 32931311, "question_id": 32930394, "link": "https://stackoverflow.com/questions/32930394/haskell-data-structure-that-is-efficient-for-swapping-elements/32931311#32931311", "title": "Haskell data structure that is efficient for swapping elements?", "body": "<p>The most efficient implementations of persistent data structures, which exhibit <em>O(1)</em> updates (as well as appending, prepending, counting and slicing), are based on the Array Mapped Trie algorithm. The Vector data-structures of Clojure and Scala are based on it, for instance. The only Haskell implementation of that data-structure that I know of is presented by <a href=\"http://hackage.haskell.org/package/persistent-vector\">the \"persistent-vector\" package</a>.</p>\n\n<p>This algorithm is very young, it was only first presented in the year 2000, which might be the reason why not so many people have ever heard about it. But the thing turned out to be such a universal solution that it got adapted for Hash-tables soon after. The adapted version of this algorithm is called Hash Array Mapped Trie. It is as well used in Clojure and Scala to implement the Set and Map data-structures. It is also more ubiquitous in Haskell with packages like <a href=\"https://hackage.haskell.org/package/unordered-containers\">\"unordered-containers\"</a> and <a href=\"https://hackage.haskell.org/package/stm-containers\">\"stm-containers\"</a> revolving around it.</p>\n\n<p>To learn more about the algorithm I recommend the following links:</p>\n\n<ul>\n<li><a href=\"http://blog.higher-order.net/2009/02/01/understanding-clojures-persistentvector-implementation.html\">http://blog.higher-order.net/2009/02/01/understanding-clojures-persistentvector-implementation.html</a></li>\n<li><a href=\"http://lampwww.epfl.ch/papers/idealhashtrees.pdf\">http://lampwww.epfl.ch/papers/idealhashtrees.pdf</a></li>\n</ul>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 5, "answer_count": 3, "score": 10, "last_activity_date": 1443948531, "creation_date": 1443936984, "question_id": 32930394, "link": "https://stackoverflow.com/questions/32930394/haskell-data-structure-that-is-efficient-for-swapping-elements", "title": "Haskell data structure that is efficient for swapping elements?", "body": "<p>I am looking for a Haskell data structure that stores an ordered list of elements and that is time-efficient at swapping pairs of elements at arbitrary locations within the list. It's not <code>[a]</code>, obviously. It's not <code>Vector</code> because swapping creates new vectors. Which data structure is efficient at this?</p>\n"}, {"tags": ["haskell", "monads", "ghc", "monad-transformers"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443924979, "post_id": 32929252, "comment_id": 53684856, "body": "Related: <a href=\"http://stackoverflow.com/questions/18861231/why-is-there-no-xderiveapplicative-extension\" title=\"why is there no xderiveapplicative extension\">stackoverflow.com/questions/18861231/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1443924868, "creation_date": 1443924868, "answer_id": 32929378, "question_id": 32929252, "link": "https://stackoverflow.com/questions/32929252/can-ghc-derive-functor-and-applicative-instances-for-a-monad-transformer/32929378#32929378", "title": "Can GHC derive Functor and Applicative instances for a monad transformer?", "body": "<p>GHC may well be able to derive the <code>Functor</code> instance, since it's fairly good at those. But the only way it knows to derive an <code>Applicative</code> instance is with generalized newtype deriving, which does not apply here.</p>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1443953939, "post_id": 32931466, "comment_id": 53690422, "body": "Right now, there&#39;s a <code>return = pure</code> default the other way, so you can leave out that. There are also plans to maybe make <code>return</code> just a synonym of <code>pure</code> in the future."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1443946863, "creation_date": 1443946863, "answer_id": 32931466, "question_id": 32929252, "link": "https://stackoverflow.com/questions/32929252/can-ghc-derive-functor-and-applicative-instances-for-a-monad-transformer/32931466#32931466", "title": "Can GHC derive Functor and Applicative instances for a monad transformer?", "body": "<p>No, GHC can not currently do that. Maybe in the future it will.</p>\n\n<p>The need to add applicative instances is a fairly new one, introduced with GHC 7.10 and the \"burn all bridges\" proposal. This fixed some warts of the previous class hierarchy, by finally requiring that monads are subclasses of applicatives which are subclasses of functors. Unfortunately, this breaks backward compatibility, and causes some inconveniences since there's no automatic way to infer the applicative instances.</p>\n\n<p>Perhaps in the future GHC will allow something like</p>\n\n<pre><code>class Applicative m =&gt; Monad m where\n   return :: a -&gt; m a\n   (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n   default pure = return\n   default (&lt;*&gt;) = ap\n</code></pre>\n\n<p>so that one does not need to be explicit about the superclass instances. Or even something based on Template Haskell, so that a library writer can explain to GHC how to automatically derive instances (which, to some extent, is feasible right now). We shall see what comes from the GHC developers.</p>\n"}], "owner": {"reputation": 579, "user_id": 1352338, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/968511f63aa70aa429618df3fd70e4e4?s=128&d=identicon&r=PG", "display_name": "hamsterdam", "link": "https://stackoverflow.com/users/1352338/hamsterdam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1945, "favorite_count": 1, "accepted_answer_id": 32931466, "answer_count": 2, "score": 8, "last_activity_date": 1443946863, "creation_date": 1443923370, "question_id": 32929252, "link": "https://stackoverflow.com/questions/32929252/can-ghc-derive-functor-and-applicative-instances-for-a-monad-transformer", "title": "Can GHC derive Functor and Applicative instances for a monad transformer?", "body": "<p>I'm trying to implement <code>MaybeT</code> in the spirit of the <code>mtl</code> library. With this non-compiling solution: </p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, UndecidableInstances #-}\n\nimport Control.Monad\nimport Control.Monad.Trans\nimport Control.Monad.State\n\nnewtype MaybeT m a = MaybeT { runMaybeT :: m (Maybe a) }\n\ninstance (Monad m) =&gt; Monad (MaybeT m) where\n    x &gt;&gt;= f = MaybeT $ runMaybeT x &gt;&gt;= maybe (return Nothing) (runMaybeT . f)\n    return a = MaybeT $ return (Just a)\n    fail _ = MaybeT $ return Nothing\n\ninstance MonadTrans MaybeT where\n     lift m = MaybeT (liftM Just m)\n\ninstance (MonadIO m) =&gt; MonadIO (MaybeT m) where\n    liftIO m = lift (liftIO m)\n\ninstance (MonadState s m) =&gt; MonadState s (MaybeT m) where\n    get = lift get\n    put = lift . put\n\n...\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>Could not deduce (Applicative (MaybeT m)) arising from the\n  superclasses of an instance declaration from the context (Monad m)</p>\n</blockquote>\n\n<p>If I implement the following, it compiles:</p>\n\n<pre><code>instance (Monad m) =&gt; Applicative (MaybeT m) where\n    pure = return\n    (&lt;*&gt;) = ap \n\ninstance (Monad m) =&gt; Functor (MaybeT m) where\n    fmap = liftM\n</code></pre>\n\n<p>Can GHC do this for me?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4933255"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1443918903, "post_id": 32928819, "comment_id": 53683867, "body": "The infinite list is in fact a bit more complicated than [1..]. This is merely an example. :)"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1443918928, "post_id": 32928819, "comment_id": 53683873, "body": "Edit your question and add the real example."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4933255"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1443919013, "post_id": 32928819, "comment_id": 53683891, "body": "Sure. I think this is much clearer and I already got the answer I needed, but alright."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1443919022, "post_id": 32928819, "comment_id": 53683897, "body": "@DanMaheshwari Can you please rephrase your question? It lacks the clarification that you want to do this while <i>building</i> the list - I thought you were just talking about <code>take</code> for a while here."}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1443944511, "post_id": 32928853, "comment_id": 53688113, "body": "This recomputes the length for every single intermediate list. If performance is an issue, you can do something like <code>takeWhile ((&lt; Sum n) . fst) . scanl1 (&lt;&gt;) . map (Sum . length &amp;&amp;&amp; id)</code>."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 5, "last_activity_date": 1443918479, "creation_date": 1443918479, "answer_id": 32928853, "question_id": 32928819, "link": "https://stackoverflow.com/questions/32928819/haskell-takewhile-but-for-list-not-its-elements/32928853#32928853", "title": "Haskell takeWhile but for list, not its elements", "body": "<p>Use <code>scanl</code> instead of <code>foldl</code> to get a list of all the intermediate results, and take the last one you're happy with:</p>\n\n<pre><code>last . takeWhile ((&lt; 10) . length) . scanl1 (++) $ map show [1..]\n\"123456789\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1444036951, "post_id": 32942872, "comment_id": 53715262, "body": "This is just another way of writing <code>take 9 . concatMap show</code>. Counting each element of <code>inits</code> is not interesting, because you know it increases in size by 1 each iteration. The problem in this question is how to entirely &quot;discard&quot; the last element that would cause the result to be too large. ie, if the list has &quot;room&quot; for one more character and the next number is 10, no more characters should be added, because 10 needs two characters."}], "tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": false, "score": 0, "last_activity_date": 1444028257, "creation_date": 1444028257, "answer_id": 32942872, "question_id": 32928819, "link": "https://stackoverflow.com/questions/32928819/haskell-takewhile-but-for-list-not-its-elements/32942872#32942872", "title": "Haskell takeWhile but for list, not its elements", "body": "<p>Use <code>inits</code> to generate substrings from the beginning of the list, drop them while the criteria is not conveyed,</p>\n\n<pre><code>import Data.List\nhead . dropWhile ((&lt;10-1) . length ) $ inits $ concatMap show [1..]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>last . takeWhile ((&lt;10) . length ) $ inits $ concatMap show [1..]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4933255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1441, "favorite_count": 0, "accepted_answer_id": 32928853, "answer_count": 2, "score": 2, "last_activity_date": 1444028257, "creation_date": 1443918144, "last_edit_date": 1443919043, "question_id": 32928819, "link": "https://stackoverflow.com/questions/32928819/haskell-takewhile-but-for-list-not-its-elements", "title": "Haskell takeWhile but for list, not its elements", "body": "<p>I have an infinite list which I'm concatenating to a string.</p>\n\n<pre><code>foldl1 (++) $ map show [1..]\n</code></pre>\n\n<p>What I'd like is to cut this string off when it has reached a length of ten characters or more.</p>\n\n<p>However, takeWhile operates on individual elements of the list. Is there a function I can use to cut the list off when it's greater than ten characters?</p>\n\n<p>In this case, I'd want the function to output \"123456789\", ignoring the 10, because going over would result in too big a length.</p>\n\n<p>Edit: Here is my actual code. This does what I was describing.</p>\n\n<pre><code>succProd x = last. takeWhile ((&lt;10).length) . scanl1 (++) $ map (show.(x*)) [1..]\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 8, "last_activity_date": 1443904782, "last_edit_date": 1592644375, "creation_date": 1443904115, "answer_id": 32927165, "question_id": 32927048, "link": "https://stackoverflow.com/questions/32927048/switch-order-of-arguments-for-instance-declaration-in-haskell/32927165#32927165", "title": "Switch order of arguments for instance declaration in Haskell", "body": "<blockquote>\n<p>Now I could wrap PSQ with a newtype:</p>\n<pre><code>newtype PSQ'' a b = PSQ'' (Q.PSQ b a)\n</code></pre>\n<p>However this seems clunky to me because I have to constantly wrap/unwrap it. Is there an easier way?</p>\n</blockquote>\n<p>Nope, not really. You could, of course, write your <code>Poppable</code> class to make it match <code>PSQ</code>. And if you like, you can generalize your newtype to</p>\n<pre><code>newtype Flip f a b = Flip (f b a)\n</code></pre>\n<p>at which point you could write</p>\n<pre><code>instance Poppable (Flip Q.PSQ a)\n</code></pre>\n<p>but none of this will get rid of the underlying annoyance factor. There are reasons Haskell doesn't support this (apparently, it makes inference much harder, sometimes impossible, etc.), so you'll just have to deal with it.</p>\n<p>P.S., that type synonym may be more useful poly-kinded, with <code>{-# LANGUAGE PolyKinds #-}</code>, where it ends up meaning</p>\n<pre><code>newtype Flip (f :: k1 -&gt; k2 -&gt; *) (a :: k2) (b :: k1) = Flip (f b a)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 2, "last_activity_date": 1443944947, "creation_date": 1443944947, "answer_id": 32931229, "question_id": 32927048, "link": "https://stackoverflow.com/questions/32927048/switch-order-of-arguments-for-instance-declaration-in-haskell/32931229#32931229", "title": "Switch order of arguments for instance declaration in Haskell", "body": "<p>You could simply abandon parametricity and use a type family to project whichever argument correspond to the 'element type': </p>\n\n<pre><code>class Poppable q where\n  type Elem q \n  tryPop :: q -&gt; Maybe (Elem q, q)\n\ndata PSQ a p = ... \n\ninstance Ord p =&gt; Poppable (PSQ a p) where \n  type Elem (PSQ a p) = a \n  tryPop = ...\n</code></pre>\n\n<p>Note this is a more general formulation, but it may be harder to work with.</p>\n"}], "owner": {"reputation": 950, "user_id": 2430739, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd47a57b46a46d55f7a8dde166ea3742?s=128&d=identicon&r=PG", "display_name": "holdenlee", "link": "https://stackoverflow.com/users/2430739/holdenlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1443944947, "creation_date": 1443903369, "last_edit_date": 1443903933, "question_id": 32927048, "link": "https://stackoverflow.com/questions/32927048/switch-order-of-arguments-for-instance-declaration-in-haskell", "title": "Switch order of arguments for instance declaration in Haskell", "body": "<p>I want to make an instance declaration, but the free type variable is not the last variable. For example, I have a class declaration</p>\n\n<pre><code>class Poppable m where\n  tryPop :: m a -&gt; Maybe (a, m a)\n</code></pre>\n\n<p>Now I want to make Q.PSQ (priority queue) an instance of Poppable. Specifically I want something like this:</p>\n\n<pre><code>instance (Ord p) =&gt; Poppable (\\a -&gt; Q.PSQ a p) where\n  tryPop = fmap (first Q.key) . Q.minView\n</code></pre>\n\n<p>However, this is not legal Haskell code. If the order of arguments to PSQ were switched, then I would have no problem:</p>\n\n<pre><code>instance (Ord p) =&gt; Poppable (Q.PSQ p) where\n  tryPop = fmap (first Q.key) . Q.minView\n</code></pre>\n\n<p>How do I switch the order of arguments for the instance declaration?</p>\n\n<p>Now I could wrap PSQ with a newtype:</p>\n\n<pre><code>newtype PSQ'' a b = PSQ'' (Q.PSQ b a)\n</code></pre>\n\n<p>However this seems clunky to me because I have to constantly wrap/unwrap it. Is there an easier way?</p>\n\n<p>*</p>\n\n<p>I tried using data/type families, but both give errors.</p>\n\n<p>(1) Using a data family declaration:</p>\n\n<pre><code>data family PSQ' a b\ndata instance PSQ' a b = PSQ b a\ninstance (Ord p) =&gt; Poppable (PSQ' p) where\n  tryPop = fmap (first Q.key) . Q.minView\n</code></pre>\n\n<p>However this gives the error</p>\n\n<pre><code>Couldn't match type `Q.PSQ a p0' with `PSQ' p a'\n</code></pre>\n\n<p>even though they can match by setting p=p0.</p>\n\n<p>(2) Type families won't work either.</p>\n\n<pre><code>type family PSQ' a b where\n  PSQ' b a = Q.PSQ a b\n</code></pre>\n\n<p>gives </p>\n\n<pre><code>Illegal type synonym family application in instance: PSQ' p\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1443907783, "post_id": 32926805, "comment_id": 53681454, "body": "Are code changes acceptable? You could wrap the IO value that you have with another one that first executes the value and then prints something that you like."}, {"owner": {"reputation": 628, "user_id": 1620753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88fcbc16af97a555e56078a2c6358963?s=128&d=identicon&r=PG", "display_name": "Vladimir Still", "link": "https://stackoverflow.com/users/1620753/vladimir-still"}, "reply_to_user": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1443946616, "post_id": 32926805, "comment_id": 53688569, "body": "usr: Not of the expression to-be-evaluated, see my edits of the question."}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1446813115, "creation_date": 1446813115, "answer_id": 33566868, "question_id": 32926805, "link": "https://stackoverflow.com/questions/32926805/disable-printing-of-io-results-in-ghci/33566868#33566868", "title": "Disable printing of IO results in GHCi?", "body": "<p>This is an interesting question. The only thing I can come up with is writing some kind of custom prelude module that exports a type called <code>IO</code>, but which isn't \"the\" I/O type that GHCi is special-casing.</p>\n\n<p>Of course, this is no help at all unless the student remembers to import this rather than the real prelude. I suppose you could write that into the GHCi config file, but... well, it's certainly not perfect.</p>\n\n<p>The only other way I can think of is to use the GHC-API to basically reimplement GHCi yourself. But that sounds like <em>waaaay</em> too much work...</p>\n"}], "owner": {"reputation": 628, "user_id": 1620753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88fcbc16af97a555e56078a2c6358963?s=128&d=identicon&r=PG", "display_name": "Vladimir Still", "link": "https://stackoverflow.com/users/1620753/vladimir-still"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 1, "answer_count": 1, "score": 17, "last_activity_date": 1446813115, "creation_date": 1443901747, "last_edit_date": 1443946561, "question_id": 32926805, "link": "https://stackoverflow.com/questions/32926805/disable-printing-of-io-results-in-ghci", "title": "Disable printing of IO results in GHCi?", "body": "<p>When running <code>IO</code> actions in GHCi prompt it automatically runs the action and shows result, this is nice, but not for students trying to understand difference between <code>IO</code> and non-<code>IO</code>. Is there a way to change configuration of GHCi so that it runs the action, but shows something like <code>&lt;&lt;IO Int action&gt;&gt;</code> instead? Something more like result for ST actions (but action should be performed):</p>\n\n<p>now it does:</p>\n\n<pre><code>&gt; return 1 :: IO Int\n1\n&gt; return 1 :: ST s Int\n&lt;&lt;ST action&gt;&gt;\n</code></pre>\n\n<p>i would like:</p>\n\n<pre><code>&gt; return 1 :: IO Int\n&lt;&lt;IO Int action&gt;&gt;\n&gt; putStrLn \"bla\"\nbla\n&lt;&lt;IO () action&gt;&gt;\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<ol>\n<li>I just found that <code>IO</code> is probably the only thing handled specially by GHCi, <code>ST</code> actually has instance for <code>Show (ST s a)</code> which returns <code>\"&lt;&lt;ST action&gt;&gt;\"</code>. So maybe if I could disable this special treatment of <code>IO</code> it would be sufficient.</li>\n<li>As for allowed code changes: manually changing evaluated expression is not an option. Change in libraries might be, but I would prefer not to do that (I considered creating wrapped <code>IO</code> type, but then interpreter will not run the action). If GHCi could automatically wrap <code>IO</code> actions somehow, that would be an option.</li>\n</ol>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 3, "creation_date": 1443891699, "post_id": 32925106, "comment_id": 53676785, "body": "It&#39;s because of the defaulting rules. See <a href=\"http://stackoverflow.com/questions/32549948/haskell-rules-for-selecting-between-type-instances-for-int-double-and-integer/32550216#32550216\">this question</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1443894327, "post_id": 32925106, "comment_id": 53677622, "body": "In general, the type is inferred from the <i>context</i> in which the result is used. Add it to the result of <code>length []</code> to see it magically change.  The defaulting rules kick in only when the context does not give enough information."}, {"owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "reply_to_user": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 0, "creation_date": 1443894347, "post_id": 32925106, "comment_id": 53677629, "body": "@SamvanHerwaarden Yes, of course you are right, it\u2019s just defaulting. What probably confused me is that GHCi keeps showing the polymorphic type."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1443939355, "post_id": 32925106, "comment_id": 53687081, "body": "That&#39;s explained easily: the command <code>:t some-expr</code> is treated differently than just <code>some-expr</code>.   In the first case no defaulting is performed, in the latter defaulting <b>must</b> be performed, because GHCi has to actually produce a value in order to print it and values must have a monomorphic type. To see the type that is actually used use <code>:set -XMonomorphismRestriction</code> and <code>:set +t</code>.  Then when evaluating <code>succ 5</code> it will also display <code>it :: Integer</code>.  Note however that you probably don&#39;t want to keep the monomorphism restriction enabled in GHCi."}], "owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "closed_date": 1459360229, "answer_count": 0, "score": 1, "last_activity_date": 1443894056, "creation_date": 1443891429, "last_edit_date": 1443894056, "question_id": 32925106, "link": "https://stackoverflow.com/questions/32925106/how-does-succ-with-a-numeric-literal-work", "closed_reason": "Duplicate", "title": "How does `succ` with a numeric literal work?", "body": "<pre><code>\u03bb&gt; succ 5\n6\n\u03bb&gt; :t succ 5\nsucc 5 :: (Enum a, Num a) =&gt; a\n</code></pre>\n\n<p>How does this work? Since the literal is polymorphic, what is the instance that is being picked? I suspect it\u2019s <code>Integer</code> but why exactly?</p>\n\n<p>My first theory was that the default implementation of <code>succ</code> might come into play (I have no idea <em>why</em> this would happen though), but, no, it\u2019s not the case as it would not be working correctly:</p>\n\n<pre><code>\u03bb&gt; :t succ (10^20)\nsucc (10^20) :: (Enum a, Num a) =&gt; a\n\u03bb&gt; succ (10^20)\n100000000000000000001\n\u03bb&gt; \n\u03bb&gt; let test = toEnum . (+1) . fromEnum :: Enum a =&gt; a -&gt; a\n\u03bb&gt; :t test (10^20)\ntest (10^20) :: (Enum a, Num a) =&gt; a\n\u03bb&gt; test (10^20)\n7766279631452241921\n</code></pre>\n\n<p>So, again, I\u2019m pretty sure it\u2019s the instance for <code>Integer</code>. But why?</p>\n"}, {"tags": ["performance", "haskell", "constructor"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 10, "creation_date": 1443876079, "post_id": 32922629, "comment_id": 53672042, "body": "Good question. My immediate reaction is &quot;what does the Core say?&quot;"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 6, "creation_date": 1443876882, "post_id": 32922629, "comment_id": 53672286, "body": "Just a nit, for better performance I&#39;d pattern match on <code>compare x a</code>  to prevent the comparison/equality being called twice (or even three times)."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1443876967, "post_id": 32922629, "comment_id": 53672315, "body": "@MathematicalOrchid, Thank you for your quick reply. Do you have any link where I could find more information when you mentioned the Core?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1443877208, "post_id": 32922629, "comment_id": 53672386, "body": "@FtheBuilder Basically, save just this one function as a module, compile with <code>-dump-simpl</code>, and then wade through the gigantic output this produces. In seriousness though: somebody more skilled at this will probably need to interpret the meaning of the results."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1443879228, "post_id": 32922629, "comment_id": 53673008, "body": "Considering that <code>left</code> and <code>right</code> are shared anyway, in the case <code>x == a</code>, I guess there is no noticeable difference, just a negligible constant factor for the one additional <code>Node</code> constructor per the whole operation. The situation would have been different if the whole sub-tree below that node were recomputed."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1443880624, "post_id": 32922629, "comment_id": 53673403, "body": "What if <code>x == a</code> does <b>not</b> imply that <code>f x == f a</code> for all functions <code>f</code>? Then you do not have the option to make that optimization."}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 7, "creation_date": 1443881222, "post_id": 32922629, "comment_id": 53673584, "body": "@behzad.nouri - well, &quot;==&quot; should mean exactly that. if <code>x == a</code> does not imply <code>f x == f a</code> then either the author of that particular &quot;==&quot; instance did make a mistake, or someone is using unsafe functions. I think it&#39;s safe to assume that the implication holds."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "edited": false, "score": 2, "creation_date": 1443881269, "post_id": 32922629, "comment_id": 53673595, "body": "@Michael not necessarily"}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 3, "creation_date": 1443881375, "post_id": 32922629, "comment_id": 53673619, "body": "@behzad.nouri - oh yes, defining broken <code>Eq</code> instances is just bad programming style, and nothing more. it&#39;s the same as defining a Monad that doesn&#39;t follow the monad laws."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "edited": false, "score": 2, "creation_date": 1443881563, "post_id": 32922629, "comment_id": 53673669, "body": "@Michael what are the laws for <code>Eq</code> type class?"}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 5, "creation_date": 1443882262, "post_id": 32922629, "comment_id": 53673864, "body": "@behzad.nouri The law is that it should define &quot;equality&quot;. And equality is defined in mathematics. (x == y) if and only if for every predicate P: ( P(x) = P(y) ). From that, it follows that (f x == f y) if you define Z = f x and P(a) := (a == Z). Or more simply, and less mathematically: <code>Eq</code> must be an equivalence relation, and if (x == y) then for all f it must be true that (f x == f y)"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1443887249, "post_id": 32922629, "comment_id": 53675304, "body": "@behzad.nouri The defining property of equality is that two things which are equal may be substituted for each other in <i>all</i> circumstances (barring name capture). I think I&#39;ve sometimes heard this called the &quot;indistinguishability of identicals&quot; law. What it means for two things to be equal is something that has been studied in detail for a very long time. <a href=\"https://en.wikipedia.org/wiki/Homotopy_type_theory\" rel=\"nofollow noreferrer\">Homotopy type theory</a> has some of the latest research in that general area (as well as some other concepts)."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1443895945, "post_id": 32922629, "comment_id": 53678133, "body": "I remember reading something about <code>containers</code> or something making use of unsafe pointer equality as an optimization when doing this kind of thing. Anyone know what I&#39;m thinking of?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1443900097, "post_id": 32922629, "comment_id": 53679372, "body": "@DavidYoung, Michael, it&#39;s generally expected to be something like &quot;externally observable equality&quot;. Most interesting data structures define <code>==</code> as an equivalence relation other than &quot;true equality&quot; but ensure that users of the public API cannot distinguish <code>==</code> values without unsafe tricks or functions explicitly documented as unsafe. For a priority queue, say, equality modulo tree balance (and <code>==</code> of the underlying elements) is the distinguished equivalence relation that in a HoTT setting would be defined to be equality more formally."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443904610, "post_id": 32922629, "comment_id": 53680629, "body": "@dfeuer That is true, but if the internal structure isn&#39;t observable (like if it is hidden by the module) and the data structure is kept abstract, then <code>x = y</code> implies <code>f x = f y</code> for any <code>f</code> outside the module, since <code>f</code> wouldn&#39;t be able to see the any difference between the two values."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1443948529, "post_id": 32922629, "comment_id": 53689060, "body": "wouldn&#39;t something like &quot;Should I avoid constructing ...&quot; make a more appropriate title for this question? &quot;instantiating&quot; resonates with <code>instance Foo Bar where ...</code>."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1455573773, "post_id": 32922629, "comment_id": 58540416, "body": "@ErikAllik good point, I&#39;ve changed..."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1443880456, "post_id": 32923187, "comment_id": 53673352, "body": "\u201cSo, I&#39;m pretty sure that under <code>-O2</code>, version B and version C are the same\u201d \u2013 I can&#39;t confirm that. Both A and C perform an extra check not needed in B (in GHC-7.8.2 or GHC-7.10.1)."}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1443880564, "post_id": 32923187, "comment_id": 53673387, "body": "oh, the compiler is not as smart as I thought it was"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1443881370, "post_id": 32923187, "comment_id": 53673617, "body": "Wait a moment, I think the difference has nothing to do with the reconstructed node at all... it&#39;s just that the <code>otherwise</code> guard is faster than the <code>x &gt; a</code>."}], "tags": [], "owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "is_accepted": false, "score": 2, "last_activity_date": 1443880664, "last_edit_date": 1443880664, "creation_date": 1443879160, "answer_id": 32923187, "question_id": 32922629, "link": "https://stackoverflow.com/questions/32922629/should-i-avoid-constructing-in-haskell/32923187#32923187", "title": "Should I avoid constructing in Haskell?", "body": "<p>answer seems to be wrong. I just leave it here, for reference...</p>\n\n<hr>\n\n<p>With your second function you avoid creating a new node, because the compiler cannot really understand equality (<code>==</code> is just some function.) If you change the first version to</p>\n\n<pre><code>-- version C\ntreeInsert :: (Ord a) =&gt; a -&gt; Tree a -&gt; Tree a  \ntreeInsert x EmptyTree = singleton x  \ntreeInsert x (Node a left right)   \n  | x == a = Node a left right  -- Difference here! Changed x to a.\n  | x &lt; a  = Node a (treeInsert x left) right  \n  | x &gt; a  = Node a left (treeInsert x right)\n</code></pre>\n\n<p>the compiler will probably be able to do common subexpression elimination, because the optimizer will be able to see that <code>Node a left right</code> is the same as <code>Node a left right</code>.</p>\n\n<p>On the other hand, I doubt that the compiler can deduce from <code>a == x</code> that <code>Node a left right</code> is the same as <code>Node x left right</code>.</p>\n\n<p>So, I'm pretty sure that under <code>-O2</code>, version B and version C are the same, but version A is probably slower because it does an extra instantiation in the <code>a == x</code> case.</p>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1443881091, "post_id": 32923324, "comment_id": 53673544, "body": "This is because of <code>| otherwise</code> in the second version as opposed to <code>| x &gt; a</code> in the first, which I think was not really what the question was intended to be about."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1443884093, "post_id": 32923324, "comment_id": 53674389, "body": "I also don&#39;t find your new bolded assertion to be the case. The core I see with no optimizations is exactly what one would expect in all cases: GHC reuses the original node in the as-pattern, and uses <code>x</code> or <code>a</code> according to whether you wrote <code>x</code> or <code>a</code> in the non-as-pattern versions. GHC certainly will not assume that <code>x == a</code> implies that <code>x</code> and <code>a</code> are interchangeable when <code>x</code> and <code>a</code> are of an arbitrary type."}, {"owner": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1443889664, "post_id": 32923324, "comment_id": 53676060, "body": "@ReidBarton do the axioms for <code>Eq</code> require that <code>x</code> and <code>a</code> be interchangeable when <code>x == a</code>? I vaguely remember that some of the <code>Prelude</code>d functions assume that."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1443910448, "post_id": 32923324, "comment_id": 53682210, "body": "<code>-dsuppress-all -dno-suppress-type-signatures</code> makes the core a whole lot more readable."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 0, "creation_date": 1444175191, "post_id": 32923324, "comment_id": 53788521, "body": "Do you have any tips for me to learn to interpret the core? It seems quite strange and difficult to figure out at first glance... (maybe a manual or something similar)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "edited": false, "score": 1, "creation_date": 1444176483, "post_id": 32923324, "comment_id": 53788904, "body": "@FtheBuilder: well, I&#39;m sure there&#39;s some literature (probably not a lot), but I&#39;ve not read any. You can actually get quite a good feel for the core by toying around a bit with simple Haskell programs and their generated core."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1443884913, "last_edit_date": 1443884913, "creation_date": 1443880030, "answer_id": 32923324, "question_id": 32922629, "link": "https://stackoverflow.com/questions/32922629/should-i-avoid-constructing-in-haskell/32923324#32923324", "title": "Should I avoid constructing in Haskell?", "body": "<p>Let's look at the core! (Without optimisations here)</p>\n\n<blockquote>\n  <p>$ ghc-7.8.2 -ddump-simpl wtmpf-file13495.hs</p>\n</blockquote>\n\n<p>The relevant difference is that the first version (without <code>all@(...)</code>) has</p>\n\n<pre><code>                case GHC.Classes.&gt; @ a_aUH $dOrd_aUV eta_B2 a1_aBQ\n                of _ [Occ=Dead] {\n                  GHC.Types.False -&gt;\n                    Control.Exception.Base.patError\n                      @ (TreeInsert.Tree a_aUH)\n                      \"wtmpf-file13495.hs:(9,1)-(13,45)|function treeInsert\"#;\n                  GHC.Types.True -&gt;\n                    TreeInsert.Node\n                      @ a_aUH\n                      a1_aBQ\n                      left_aBR\n                      (TreeInsert.treeInsert @ a_aUH $dOrd_aUV eta_B2 right_aBS)\n</code></pre>\n\n<p>where reusing the node with that as-pattern does just</p>\n\n<pre><code>                TreeInsert.Node\n                  @ a_aUI\n                  a1_aBR\n                  left_aBS\n                  (TreeInsert.treeInsert @ a_aUI $dOrd_aUW eta_B2 right_aBT);\n</code></pre>\n\n<p>This is an avoided check that may well make a significant performance difference.</p>\n\n<p><strong>However</strong>, this difference has actually nothing to do with the as-pattern. It's just because your first snippet uses a <code>x &gt; a</code> guard, which is not trivial. The second uses <code>otherwise</code>, which is optimised away.</p>\n\n<p>If you change the first snippet to</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>treeInsert :: (Ord a) =&gt; a -&gt; Tree a -&gt; Tree a  \ntreeInsert x EmptyTree = singleton x  \ntreeInsert x (Node a left right)   \n  | x == a     = Node x left right  \n  | x &lt; a      = Node a (treeInsert x left) right  \n  | otherwise  = Node a left (treeInsert x right)\n</code></pre>\n\n<p>then the difference boils down to</p>\n\n<pre><code>      GHC.Types.True -&gt; TreeInsert.Node @ a_aUH a1_aBQ left_aBR right_aBS\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>      GHC.Types.True -&gt; wild_Xa\n</code></pre>\n\n<p>Which is indeed just the difference of <code>Node x left right</code> vs <code>all</code>.</p>\n\n<p>...without optimisations, that is. <a href=\"https://gist.github.com/leftaroundabout/e3cfd8fe97a82ded0db0/revisions?diff=split\" rel=\"noreferrer\">The versions diverge further when I turn on <code>-O2</code></a>. But I can't really make out how the performance would differ, there.</p>\n"}, {"comments": [{"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "edited": false, "score": 8, "creation_date": 1443881299, "post_id": 32923487, "comment_id": 53673603, "body": "in real life coding, you should never define an Eq instance that does not define equality in the mathematical sense."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1443882037, "post_id": 32923487, "comment_id": 53673801, "body": "Regardless of whether this is something you should ever do (I rather agree with Michael that you shouldn&#39;t), it&#39;s not actually so relevant to the question, because GHC seems to newly construct a <code>Node a left right</code> in either case. What&#39;s more relevant is that <code>not (a==b) &amp;&amp; not (a&gt;b)</code> doesn&#39;t imply <code>a&lt;b</code>, so guards with these three cases are technically incomplete."}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1443882561, "post_id": 32923487, "comment_id": 53673928, "body": "@leftaroundabout - I agree that it is better to use <code>otherwise</code>, because then you just see on first sight that the pattern is complete. However, for a valid <code>Ord</code> instance, the implication <code>not (a==b) &amp;&amp; not (a&gt;b)</code> implies <code>a&lt;b</code> must hold, otherwise it is just a broken <code>Ord</code> instance. IMHO, the signature <code>(Ord a) =&gt; a -&gt; Tree a -&gt; Tree a</code> says, &quot;if you give me an a that is a proper Ord instance, I&#39;ll insert it into a Tree a. If you give me garbage, you may get garbage back. garbage in, garbage out ;)&quot;"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "edited": false, "score": 1, "creation_date": 1443883440, "post_id": 32923487, "comment_id": 53674203, "body": "@Michael: I agree on that too, but <a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">try <code>let n = log(-1) in n==n || n&lt;n || n&gt;n</code></a>. (Arguably, it&#39;s the IEEE754 specification that&#39;s broken here, but GHC can&#39;t really just ignore this fact.)"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1443885384, "post_id": 32923487, "comment_id": 53674756, "body": "even though it is more tedious to write, matching <code>compare a b</code> against <code>LT</code>, <code>EQ</code> and <code>GT</code> could be more efficient that testing <code>a &lt; b</code> and <code>a == b</code>, especially if <code>a</code> and <code>b</code> are complex data structures."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1443886883, "post_id": 32923487, "comment_id": 53675196, "body": "I don&#39;t think the video you&#39;ve linked has anything to do with whether <code>a==b</code> \u27f9\u0338 <code>f a==f b</code> is sensible. What Phil Wadler is talking about there is <i>free theorems for polymorphic functions</i>. The point is, for instance, that <code>a-&gt;a-&gt;Bool</code> is inhabited only by <code>\\_ _ -&gt; False</code> and <code>\\_ _ -&gt; True</code>, whereas <code>Eq a =&gt; a-&gt;a-&gt;Bool</code> also has <code>(==)</code> and <code>(&#47;=)</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1443888184, "post_id": 32923487, "comment_id": 53675584, "body": "&quot;The point is Eq type-class only says that you may compare values for equality.&quot; What you describe after this part <a href=\"https://en.wikipedia.org/wiki/Equality_(mathematics)#Some_basic_logical_properties_of_equality\" rel=\"nofollow noreferrer\">is not equality</a>. It would be an equivalence relation but not equality. We would get <i>very</i> few guarantees about what <code>(==)</code> means if we only required that it is an equivalence relation. It would then be completely valid to define <code>(==)</code> on <code>Int</code>s, for example, as congruence modulo 5."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1443901202, "post_id": 32923487, "comment_id": 53679717, "body": "@leftaroundabout, floating point representations have no business being in <code>Num</code>, <code>Enum</code>, <code>Eq</code>, or <code>Ord</code>. They belong in a tiny <code>FromRational</code> class along with proper rational numbers, but they are not numbers and they do not admit a notion of equality that is both useful and well-behaved."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443914015, "post_id": 32923487, "comment_id": 53682965, "body": "@dfeuer: with this I don&#39;t quite agree. For <code>Enum</code> you&#39;re right <a href=\"http://stackoverflow.com/questions/7290438/haskell-ranges-and-floats\">definitely</a>, and for <code>Eq</code> there&#39;s also <a href=\"http://www.paultaylor.eu/ASD/\" rel=\"nofollow noreferrer\">a big point against</a> (apart from the one discussed here). However, losing <code>Num</code> would be way too inconvenient, and there&#39;s IMO almost nothing wrong with that instance. Also not with <code>Fractional</code> and <code>Floating</code>, and <code>&gt;</code>  <code>&lt;</code> are pretty much ok too (except in that <code>Eq</code> is a superclass of <code>Ord</code>)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1443916630, "post_id": 32923487, "comment_id": 53683428, "body": "@leftaroundabout, I expect numbers to obey the (semi)ring axioms. I expect fractions to obey the field axioms. Floating point representations don&#39;t even form semigroups."}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1443939690, "post_id": 32923487, "comment_id": 53687139, "body": "@leftaroundabout : the <code>log(-1)</code> thing is really a bug imho. consider that <code>let n = log(-1) in compare n n</code> results in <code>GT</code>."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 4, "last_activity_date": 1443899498, "last_edit_date": 1443899498, "creation_date": 1443881233, "answer_id": 32923487, "question_id": 32922629, "link": "https://stackoverflow.com/questions/32922629/should-i-avoid-constructing-in-haskell/32923487#32923487", "title": "Should I avoid constructing in Haskell?", "body": "<blockquote>\n  <p>In real life coding, what should I do? Are there any drawbacks when returning the same thing?</p>\n</blockquote>\n\n<p><code>a == b</code> does <em>not</em> guarantee that <code>f a == f b</code> for all functions <code>f</code>. So, you <em>may</em> have to return new object even if they compare equal.</p>\n\n<p>In other words, it may <em>not</em> be feasible to change <code>Node x left right</code> to <code>Node a left right</code> or <code>all</code> when <code>a == x</code> regardless of performance gains.</p>\n\n<p>For example you may have types which carry meta data. When you compare them for equality, you may only care about the values and ignore the meta data. But if you replace them just because they compare equal then you will loose the meta data.</p>\n\n<pre><code>newtype ValMeta a b = ValMeta (a, b)  -- value, along with meta data\n    deriving (Show)\n\ninstance Eq a =&gt; Eq (ValMeta a b) where\n    -- equality only compares values, ignores meta data\n    ValMeta (a, b) == ValMeta (a', b') = a == a'\n</code></pre>\n\n<p>The point is <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Eq.html\" rel=\"nofollow\"><code>Eq</code> type-class</a> <em>only</em> says that you may compare values for equality. <em>It does not guarantee anything beyond that.</em></p>\n\n<p>A real-world example where <code>a == b</code> does not guarantee that <code>f a == f b</code> is when you maintain a <code>Set</code> of unique values within a self-balancing tree. A self-balancing tree (such as Red-Black tree) has some guarantees about the structure of tree but the actual depth and structure depends on the order that the data were added to or removed from the set. </p>\n\n<p>Now when you compare 2 sets for equality, you want to compare that values within the set are equal, not that the underlying trees have the same exact structure. But if you have a function such as <code>depth</code> which exposes the depth of underlying tree maintaining the set then you cannot guarantee that the depths are equal even if the sets compare equal.</p>\n\n<p><a href=\"https://youtu.be/NZeDRs6snm0?t=42m5s\" rel=\"nofollow\">Here is a video of great Philip Wadler realizing live and on-stage that <em>many useful relations do not preserve equality</em></a> (starting at 42min).</p>\n\n<p>Edit: Example from ghc where <code>a == b</code> does not imply <code>f a == f b</code>:</p>\n\n<pre><code>\\&gt; import Data.Set\n\\&gt; let a = fromList [1, 2, 3, 4, 5, 10, 9, 8, 7, 6]\n\\&gt; let b = fromList [1..10]\n\\&gt; let f = showTree\n\\&gt; a == b\nTrue\n\\&gt; f a == f b\nFalse\n</code></pre>\n\n<p>Another real-world example is hash-table. Two hash-tables are equal if and only if their key-value pairs tie out. However, the <em>capacity</em> of a hash-table, i.e. the number of keys you may add before having to re-allocate and rehash, depends on the order of inserts/deletes. </p>\n\n<p>So if you have a function which returns the capacity of hash table, it may return different values for hash-tables <code>a</code> and <code>b</code> even though <code>a == b</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "edited": false, "score": 3, "creation_date": 1443889976, "post_id": 32924229, "comment_id": 53676163, "body": "Shouldn&#39;t this be a comment under the question rather than posted as an answer?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 24791, "user_id": 499214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PObJM.png?s=128&g=1", "display_name": "John Dvorak", "link": "https://stackoverflow.com/users/499214/john-dvorak"}, "edited": false, "score": 2, "creation_date": 1443890753, "post_id": 32924229, "comment_id": 53676451, "body": "I felt I needed more space than the comment area provides. Moreover the comment section under the original question was already very cluttered with another thread. Feel free to down vote (or non-vote) as you like. I contributed it because I considered it relevant to the question."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1443945692, "post_id": 32924229, "comment_id": 53688369, "body": "Since the question is about &#39;real life coding&#39; and about squeezing a tiny drop of performance out of your code, I&#39;d say this answer is extremely relevant (this may increase performance two to three fold, depending on how expensive <code>==</code>, <code>&lt;</code> and <code>&gt;</code> are)."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1443909077, "last_edit_date": 1443909077, "creation_date": 1443885925, "answer_id": 32924229, "question_id": 32922629, "link": "https://stackoverflow.com/questions/32922629/should-i-avoid-constructing-in-haskell/32924229#32924229", "title": "Should I avoid constructing in Haskell?", "body": "<p>My two cents... perhaps not even about the original question:</p>\n\n<p>Instead of writing guards with <code>x &lt; a</code> and <code>x == a</code>, I would match <code>compare a b</code> against <code>LT</code>, <code>EQ</code> and <code>GT</code>, e.g.:</p>\n\n<pre><code>treeInsert x all@(Node a left right) =\n  case compare x a of\n    EQ -&gt; ...\n    LT -&gt; ...\n    GT -&gt; ...\n</code></pre>\n\n<p>I would do this especially if <code>x</code> and <code>a</code> can be complex data structures, since a test like <code>x &lt; a</code> could be expensive.</p>\n"}, {"tags": [], "owner": {"reputation": 707, "user_id": 646408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e62561db40e46118628b31cba87840d6?s=128&d=identicon&r=PG", "display_name": "lpsmith", "link": "https://stackoverflow.com/users/646408/lpsmith"}, "is_accepted": false, "score": 2, "last_activity_date": 1443950471, "last_edit_date": 1443950471, "creation_date": 1443946252, "answer_id": 32931384, "question_id": 32922629, "link": "https://stackoverflow.com/questions/32922629/should-i-avoid-constructing-in-haskell/32931384#32931384", "title": "Should I avoid constructing in Haskell?", "body": "<p>Well, if the first case had used <code>a</code> instead of <code>x</code> as follows,  then there's at least the chance that GHC would eliminate the allocation of a new node through common subexpression elimination.   </p>\n\n<pre><code>treeInsert x (Node a left right)   \n  | x == a = Node a left right\n</code></pre>\n\n<p>However,  this is all but irrelevant in any non-trivial use case,  because the path down the tree to the node is going to be duplicated even when the element already exists.   And this path is going to be significantly longer than a single node unless your use case is trivial.</p>\n\n<p>In the world of ML,  the fairly idiomatic way to avoid this is to throw a <code>KeyAlreadyExists</code> exception,  and then catch that exception at the top-level insertion function and return the original tree.  This would cause the stack to be unwound instead of allocating any of the <code>Node</code>s on the heap.</p>\n\n<p>A direct implementation of the ML idiom is basically a no-no in Haskell,  for good reasons.  If avoiding this duplication matters, the simplest and possibly best thing to do is to check if the tree contains the key before you insert it.</p>\n\n<p>The downside of this approach,  compared to a direct Haskell insert or the ML idiom,  is that it involves two traversals of the path instead of one.   Now, here is a non-duplicating,  single-pass insert you can implement in Haskell:</p>\n\n<pre><code>treeInsert :: Ord a =&gt; a -&gt; Tree a -&gt; Tree a\ntreeInsert x original_tree = result_tree\n  where\n    (result_tree, new_tree) = loop x original_tree\n\n    loop x EmptyTree = (new_tree, singleton x)\n    loop x (Node a left right) =\n       case compare x a of\n         LT -&gt; let (res, new_left) = loop x left\n                in (res, Node a new_left right)\n         EQ -&gt; (original_tree, error \"unreachable\")\n         GT -&gt; let (res, new_right) = loop x right\n                in (res, Node a left new_right)\n</code></pre>\n\n<p>However,  older versions of GHC (roughly 7-10 years ago) don't handle this sort of recursion through lazy pairs of results very efficiently,  and in my experience check-before-insert is likely to perform better.  I'd be slightly surprised if this observation has really changed in the context of more recent GHC versions.</p>\n\n<p>One can certainly imagine a function that directly constructs (but does not return) a new path for the tree,  and decides to return the new path or the original path once it's known whether the element exists already.   (The new path would immediately become garbage if it is not returned.) This conforms to the basic principles of the GHC runtime,  but isn't really expressible in the source language.</p>\n\n<p>Of course,  any completely non-duplicating insertion function on a lazy data structure is going to have different strictness properties than a simple, duplicating insert.  So no matter the implementation technique,  they are different functions if laziness matters.</p>\n\n<p>But of course,  whether or not the path is duplicated may not matter that much.  The cases where it would matter the most would be when you are using the tree persistently,  because in linear use cases the old path would become garbage immediately after each insertion.   And of course, this only matters when you are inserting a significant number of duplicates.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 5, "accepted_answer_id": 32923324, "answer_count": 5, "score": 22, "last_activity_date": 1455573721, "creation_date": 1443875722, "last_edit_date": 1455573721, "question_id": 32922629, "link": "https://stackoverflow.com/questions/32922629/should-i-avoid-constructing-in-haskell", "title": "Should I avoid constructing in Haskell?", "body": "<p>While reading a snipped from <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#recursive-data-structures\">Haskell for Great Good</a> I found the following situation:</p>\n\n<pre><code>treeInsert :: (Ord a) =&gt; a -&gt; Tree a -&gt; Tree a  \ntreeInsert x EmptyTree = singleton x  \ntreeInsert x (Node a left right)   \n  | x == a = Node x left right  \n  | x &lt; a  = Node a (treeInsert x left) right  \n  | x &gt; a  = Node a left (treeInsert x right)\n</code></pre>\n\n<p>Wouldn't it be better for performance if we just reused the given Tree when <code>x == a</code>?</p>\n\n<pre><code>treeInsert :: (Ord a) =&gt; a -&gt; Tree a -&gt; Tree a  \ntreeInsert x EmptyTree = singleton x  \ntreeInsert x all@(Node a left right)   \n  | x == a = all  \n  | x &lt; a  = Node a (treeInsert x left) right  \n  | otherwise  = Node a left (treeInsert x right)\n</code></pre>\n\n<p>In real life coding, what should I do? Are there any drawbacks when returning the same thing?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 10, "last_activity_date": 1443874028, "creation_date": 1443874028, "answer_id": 32922361, "question_id": 32922016, "link": "https://stackoverflow.com/questions/32922016/why-does-the-reader-monad-store-a-function/32922361#32922361", "title": "Why does the Reader monad store a function?", "body": "<p>The point of the reader monad is to model a value which <em>depends</em> on some environment. Or, if you prefer, a computation with an \"implicit\" input. This is different from a value which is stored along its environment.</p>\n\n<p>Consider this:</p>\n\n<pre><code>newtype Reader s a = Reader (s -&gt; a)\n\nask :: Reader a a\nask = Reader (\\s -&gt; s)\n</code></pre>\n\n<p>here the value and the environment are the same. The above simply \"gets\" the value from the environment and returns it.</p>\n\n<p>By contrast,</p>\n\n<pre><code>newtype Reader s a = Reader (s, a)\n\nask :: Reader a a\nask = Reader (s, s)\n   where s = ???\n</code></pre>\n\n<p>here we need to produce both the environment and the value. But we have no actual way to do that! The environment moved from being an input, in the first example, to being an output -- and this makes realizing <code>ask</code> impossible.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1443888784, "last_edit_date": 1443888784, "creation_date": 1443888481, "answer_id": 32924643, "question_id": 32922016, "link": "https://stackoverflow.com/questions/32922016/why-does-the-reader-monad-store-a-function/32924643#32924643", "title": "Why does the Reader monad store a function?", "body": "<p>A somewhat more mathematical argument:</p>\n\n<p>Consider what happens when you <em>modify</em> the environment. For instance, say you have an environment with an <code>Int</code> in in, but your <code>Reader</code> requires an <code>Integer</code>. I.e., you have</p>\n\n<pre><code>yourReader :: Reader Integer A\n</code></pre>\n\n<p>Well, clearly you can convert the <code>Int</code> in the environment, just use </p>\n\n<pre><code>fromIntegral :: Int -&gt; Integer\n</code></pre>\n\n<p>But what this means for your reader monad is that you <em><a href=\"http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Monad-Trans-Reader.html#v:withReader\" rel=\"nofollow\">convert</a> to <code>Reader Int A</code></em>, because only that type works in your original environment.</p>\n\n<pre><code>yourReader' :: Reader Int A\nyourReader' = withReader fromIntegral yourReader\n</code></pre>\n\n<p>Mathematicians describe this by saying <code>Reader</code> is <a href=\"https://en.wikipedia.org/wiki/Functor#Covariance_and_contravariance\" rel=\"nofollow\"><b>contra</b>variant</a> in its first argument. But if it consisted of just a variable for the value and one for the environment, then it would be <b>co</b>variant in both arguments (i.e. <code>Int -&gt; Integer</code> would transform <code>Reader Int A</code> to <code>Reader Integer A</code>, not the other way around). Whereas a function type is contravariant in its left side.</p>\n"}], "owner": {"reputation": 19024, "user_id": 286335, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6882f075e155c96b4ff0fe3bcab951f3?s=128&d=identicon&r=PG&f=1", "display_name": "cibercitizen1", "link": "https://stackoverflow.com/users/286335/cibercitizen1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 32922361, "answer_count": 2, "score": 3, "last_activity_date": 1443888784, "creation_date": 1443871731, "question_id": 32922016, "link": "https://stackoverflow.com/questions/32922016/why-does-the-reader-monad-store-a-function", "title": "Why does the Reader monad store a function?", "body": "<p>According to\n<a href=\"https://wiki.haskell.org/All_About_Monads#The_Reader_monad\" rel=\"nofollow\">All about monads</a></p>\n\n<blockquote>\n  <p>Monad values (of the Reader monad) are functions from the environment to a value. The bound\n  function is applied to the bound value, and both have access to the\n  shared environment.</p>\n</blockquote>\n\n<p>But, why is it necessary to use a function (and not, for instance, two variables, one for the environment and one for the value) in this monad?</p>\n"}, {"tags": ["api", "haskell", "ghci"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1443869030, "post_id": 32921132, "comment_id": 53670139, "body": "You might be interested in <a href=\"https://hackage.haskell.org/package/hint\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hint</a>"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1443869199, "post_id": 32921132, "comment_id": 53670181, "body": "Thank you, that indeed seems very interesting! :)"}], "answers": [{"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1444922073, "creation_date": 1444922073, "answer_id": 33152259, "question_id": 32921132, "link": "https://stackoverflow.com/questions/32921132/using-ghc-as-library/33152259#33152259", "title": "Using GHC as library", "body": "<p>So my problem was solved when I added this initialization at the beginning of the <code>GHC</code> expression that I run with <code>runGhc (Just libdir)</code>:</p>\n\n<pre><code>df &lt;- getSessionDynFlags\nsetSessionDynFlags $ df { hscTarget = HscInterpreted\n                        , ghcLink   = LinkInMemory\n                        }\nsetContext $ map (IIDecl . simpleImportDecl . mkModuleName) [ \"Prelude\" ]\n</code></pre>\n"}], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 2, "accepted_answer_id": 33152259, "answer_count": 1, "score": 7, "last_activity_date": 1444922073, "creation_date": 1443865498, "question_id": 32921132, "link": "https://stackoverflow.com/questions/32921132/using-ghc-as-library", "title": "Using GHC as library", "body": "<p>What would be the simplest example of sending an expression to ghci via its api for evaluation and printing the result? I am not able to find a complete example that would work. Yes, I have tried <a href=\"https://wiki.haskell.org/GHC/As_a_library\">https://wiki.haskell.org/GHC/As_a_library</a> but I keep getting errors that do not tell me much: <code>no package state yet: call GHC.setSessionDynFlags</code>. Wherever I try <code>setSessionDynFlags</code> with whatever arguments, or <code>setContext</code>, I always end up with an error. I currently have (no <code>setXYZ</code>):</p>\n\n<pre><code>import GHC\nimport GHC.Paths ( libdir )\nimport GhcMonad\nimport Debugger\nimport DynFlags\nimport Outputable\nimport Language.Haskell.HsColour\nimport Language.Haskell.HsColour.Colourise\n\ncolour :: String -&gt; String\ncolour = hscolour TTY defaultColourPrefs True True \"\" False\n\nghci :: IO ()\nghci = runGhc (Just libdir) $ do\n    r &lt;- runStmt \"[1, 2, 3]\" RunToCompletion\n    case r of\n        RunOk ns -&gt; do\n            mapM_ ( \\n -&gt; do\n                  mty &lt;- lookupName n\n                  case mty of\n                      Just (AnId id) -&gt; do\n                          t  &lt;- obtainTermFromId maxBound True id\n                          fl &lt;- getSessionDynFlags\n                          liftIO $ putStrLn $ colour $ show $ withPprStyleDoc fl defaultUserStyle $ ppr t\n                          return ()\n                      otherwise -&gt; return ()\n                  ) ns\n        otherwise -&gt; return ()\n\nmain :: IO ()\nmain = ghci\n</code></pre>\n"}, {"tags": ["macos", "haskell"], "comments": [{"owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "reply_to_user": {"reputation": 8444, "user_id": 1837203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4db7eb958bf0c84072c8e9658700167?s=128&d=identicon&r=PG", "display_name": "jaket", "link": "https://stackoverflow.com/users/1837203/jaket"}, "edited": false, "score": 0, "creation_date": 1443861064, "post_id": 32920452, "comment_id": 53668146, "body": "@jaket I typed <code>.&#47;ghci</code> and got the same result <code>-bash: .&#47;ghci: No such file or directory</code>"}, {"owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "reply_to_user": {"reputation": 8444, "user_id": 1837203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4db7eb958bf0c84072c8e9658700167?s=128&d=identicon&r=PG", "display_name": "jaket", "link": "https://stackoverflow.com/users/1837203/jaket"}, "edited": false, "score": 0, "creation_date": 1443861521, "post_id": 32920452, "comment_id": 53668251, "body": "@zenith I downloaded a package from <a href=\"https://www.haskell.org\" rel=\"nofollow noreferrer\">haskell.org</a> on August, installing it and then it is fine."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443861888, "post_id": 32920452, "comment_id": 53668346, "body": "I am having a similar issue. It looks like the symlinks are not created in /usr/bin but you can find the binary only in /Library/Frameworks/GHC.framework/Versions/7.10.2-x86_64/usr&zwnj;&#8203;/bin/"}, {"owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "edited": false, "score": 0, "creation_date": 1443862075, "post_id": 32920452, "comment_id": 53668386, "body": "I remembered I also installed some <code>Command line tools (OSX 10.10) for Xcode</code> from app store in order to run."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "edited": false, "score": 0, "creation_date": 1443862541, "post_id": 32920645, "comment_id": 53668503, "body": "I coped and pasted <code>curl -fsSL ... | sh</code> in the terminal, but it says  <code>You must be root to activate a particular Haskell Platform. Please rerun this command sudo:     sudo sh  </code>"}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "reply_to_user": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "edited": false, "score": 2, "creation_date": 1443862633, "post_id": 32920645, "comment_id": 53668527, "body": "Replace <code>sh</code> with <code>sudo sh</code>."}, {"owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "edited": false, "score": 0, "creation_date": 1443862844, "post_id": 32920645, "comment_id": 53668586, "body": "It says <code>WARNING: Improper use of the sudo command could lead to data loss or the deletion of important system files. Please double-check your typing when using sudo. Type &quot;man sudo&quot; for more information.  To proceed, enter your password, or type Ctrl-C to abort.</code> Is this OK? I am a little bit afraid since I have no idea what am I doing."}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "reply_to_user": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "edited": false, "score": 3, "creation_date": 1443863027, "post_id": 32920645, "comment_id": 53668624, "body": "Yes that warning is correct, you shouldn&#39;t use <code>sudo</code> when you don&#39;t know what you&#39;re doing. If possible, just reinstall the whole Haskell platform from scratch to avoid <code>sudo</code>."}, {"owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "edited": false, "score": 0, "creation_date": 1443863352, "post_id": 32920645, "comment_id": 53668698, "body": "I will try reinstalling it. But since the previous version still exists, will this make my Haskell-related file bigger and bigger with most of it being redundancy?"}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "reply_to_user": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "edited": false, "score": 0, "creation_date": 1443867788, "post_id": 32920645, "comment_id": 53669828, "body": "@CYC: well, just download the script, and execute it as root!"}, {"owner": {"reputation": 11126, "user_id": 12559, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bb381744942a5606750381a65f6c1c8c?s=128&d=identicon&r=PG", "display_name": "Richard Turner", "link": "https://stackoverflow.com/users/12559/richard-turner"}, "edited": false, "score": 2, "creation_date": 1443869771, "post_id": 32920645, "comment_id": 53670341, "body": "I just tried piping the curl command to <code>sudo sh</code> and it tried to add all the symlinks to <code>&#47;usr&#47;bin&#47;</code>, so that&#39;s not a complete solution. Looking in that script it doesn&#39;t seem like it can easily be modified to use <code>&#47;usr&#47;local</code> instead of <code>&#47;usr</code> either."}], "tags": [], "owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "is_accepted": true, "score": 10, "last_activity_date": 1443869093, "last_edit_date": 1443869093, "creation_date": 1443862132, "answer_id": 32920645, "question_id": 32920452, "link": "https://stackoverflow.com/questions/32920452/how-to-run-haskell-on-osx-el-capitan/32920645#32920645", "title": "How to run Haskell on OSX El Capitan", "body": "<p>Haskell used to install itself to <code>/usr/bin</code>, which is incompatible with the new security features in El Capitan. Thus the El Capitan installer simply removed everything in <code>/usr/bin</code> that doesn't belong there.</p>\n\n<p>The new Haskell installer in <a href=\"https://www.reddit.com/r/haskell/comments/3n2dmj/candidate_haskell_platform_7102a_for_use_with_os/\">your link</a> provides an alternative that correctly installs to the normal <code>/usr/local/bin</code> path. You can use it. Here are the instructions:</p>\n\n<ol>\n<li>Download <a href=\"http://downloads.haskell.org/%7Eplatform/7.10.2/Haskell%20Platform%207.10.2-a1%2064bit-unsigned.pkg\">the installer</a>.</li>\n<li>Right-click and select \"Open\".</li>\n<li>Select \"Open\" again in the dialog box.</li>\n</ol>\n\n<p>If you don't want to reinstall the whole Haskell platform, you can simply run <a href=\"https://raw.githubusercontent.com/mzero/haskell-platform/master/hptool/os-extras/osx/bin/activate-hs\">the script</a> from the same post, e.g. with the following command:</p>\n\n<pre><code>curl -fsSL https://raw.githubusercontent.com/mzero/haskell-platform/master/hptool/os-extras/osx/bin/activate-hs | sh\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5405923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e93d070d1bfeb0edb599da3a74eaec1a?s=128&d=identicon&r=PG", "display_name": "Tatsuya Hagino", "link": "https://stackoverflow.com/users/5405923/tatsuya-hagino"}, "is_accepted": false, "score": 0, "last_activity_date": 1443933793, "creation_date": 1443933793, "answer_id": 32930124, "question_id": 32920452, "link": "https://stackoverflow.com/questions/32920452/how-to-run-haskell-on-osx-el-capitan/32930124#32930124", "title": "How to run Haskell on OSX El Capitan", "body": "<p>I needed to create /usr/local/bin and /usr/local/share before installing it.</p>\n"}, {"tags": [], "owner": {"reputation": 3352, "user_id": 98600, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5738c02070833b70609a7fe8f0b75eef?s=128&d=identicon&r=PG", "display_name": "John J. Camilleri", "link": "https://stackoverflow.com/users/98600/john-j-camilleri"}, "is_accepted": false, "score": 2, "last_activity_date": 1447175875, "creation_date": 1447175875, "answer_id": 33635806, "question_id": 32920452, "link": "https://stackoverflow.com/questions/32920452/how-to-run-haskell-on-osx-el-capitan/33635806#33635806", "title": "How to run Haskell on OSX El Capitan", "body": "<p>If you had Haskell installed before the upgrade, you don't need to reinstall it.</p>\n\n<p>For some reason the <code>activate-hs</code> script mentioned in the other solutions tries to create the symlinks in <code>/usr/bin</code> and <code>/usr/share</code>, which will fail because of SIP (I can't understand why the script does this).</p>\n\n<p>However this script can easily be amended to create the symlinks in <code>/usr/local/</code> instead. I have put an edited version of the script <a href=\"https://gist.github.com/johnjcamilleri/1ed5db5eb4bd26a97afb#file-activate-hs-L283-L289\" rel=\"nofollow\">here</a> (see lines 283 to 289).</p>\n\n<p>If you are lazy and blindly trust me, you can just run the following:</p>\n\n<pre><code>curl -fsSL https://gist.githubusercontent.com/johnjcamilleri/1ed5db5eb4bd26a97afb/raw/654eda72af4cdb6f47f4fad3c7d7823449716007/activate-hs | sudo sh\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3150, "user_id": 3443275, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Q4viU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3443275/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1466585746, "creation_date": 1466585746, "answer_id": 37963128, "question_id": 32920452, "link": "https://stackoverflow.com/questions/32920452/how-to-run-haskell-on-osx-el-capitan/37963128#37963128", "title": "How to run Haskell on OSX El Capitan", "body": "<p>I really like Haskell for Mac. <a href=\"http://haskellformac.com/\" rel=\"nofollow\">http://haskellformac.com/</a> </p>\n\n<p>A nice Haskell IDE for Mac. No configuration, package management, etc. required.</p>\n"}], "owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10075, "favorite_count": 1, "accepted_answer_id": 32920645, "answer_count": 4, "score": 13, "last_activity_date": 1466585746, "creation_date": 1443860726, "question_id": 32920452, "link": "https://stackoverflow.com/questions/32920452/how-to-run-haskell-on-osx-el-capitan", "title": "How to run Haskell on OSX El Capitan", "body": "<p>I just upgraded to Mac OSX El Capitan yesterday, finding that the method I used to run Haskell on terminal do not work anymore.</p>\n\n<p>I used to run Haskell on terminal by typing<code>cd (the path where my .hs file is in)</code>, then type <code>ghci</code>, and finally type <code>:l (.hs file name)</code></p>\n\n<p>But it told me that <code>-bash: ghci: command not found</code> when typing <code>ghci</code>.</p>\n\n<p>So how could I run Haskell on El Capitan? I am not familiar with computer and am just learning some algorithms occasionally for fun, so please avoid technical terms and give me some clear steps to follow.</p>\n\n<p>(I don't know wether it helps or not, I found this <a href=\"https://www.reddit.com/r/haskell/comments/3n2dmj/candidate_haskell_platform_7102a_for_use_with_os/\">links</a>, it suggests there is no need to reinstall the whole platform, but I don't know how to download and run the executable file it attached from github.)</p>\n"}, {"tags": ["haskell", "wxhaskell"], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 5573696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AoIOc.png?s=128&g=1", "display_name": "HJvT", "link": "https://stackoverflow.com/users/5573696/hjvt"}, "is_accepted": true, "score": 1, "last_activity_date": 1447790421, "creation_date": 1447790421, "answer_id": 33765911, "question_id": 32920151, "link": "https://stackoverflow.com/questions/32920151/wxwebview-in-wxhaskell/33765911#33765911", "title": "wxWebView in wxHaskell", "body": "<p>wxWebView is not implemented in wxHaskell (yet); feel free to create a pull request to expand wxHaskell.</p>\n\n<p>B.t.w. if you ask questions at the <a href=\"https://lists.sourceforge.net/lists/listinfo/wxhaskell-users\" rel=\"nofollow\" title=\"wxhaskell-users mailing list\">wxhaskell-users mailing list</a>, you probably get an answer sooner.</p>\n"}], "owner": {"reputation": 631, "user_id": 2435054, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4391746fc426b77353167c1c11366953?s=128&d=identicon&r=PG", "display_name": "Slabko", "link": "https://stackoverflow.com/users/2435054/slabko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 33765911, "answer_count": 1, "score": 0, "last_activity_date": 1447790421, "creation_date": 1443857955, "last_edit_date": 1444287191, "question_id": 32920151, "link": "https://stackoverflow.com/questions/32920151/wxwebview-in-wxhaskell", "title": "wxWebView in wxHaskell", "body": "<p>I'm trying to show a web page inside my wxHaskell based application for Mac. I tried to use <code>HtmlWindow</code>, which is very limited. According to the wxWidgets' documentation, I have to use wxWebView, which is capable to process CSS and JS.</p>\n\n<p>From <a href=\"http://docs.wxwidgets.org/trunk/classwx_html_window.html\" rel=\"nofollow\">http://docs.wxwidgets.org/trunk/classwx_html_window.html</a></p>\n\n<blockquote>\n  <p>If you want complete HTML/CSS support as well as a Javascript engine, see instead wxWebView.</p>\n</blockquote>\n\n<p>Exactly what I need! Hoverer I didn't find any mentions of wxWebView in wxHaskell. And, also, which is miracle, Google is pretty silent about it. That makes me think, that I do something wrong. Is there any way to display reach (having HTML/CSS/JS) pages using wxHaskell? How do people do that?</p>\n\n<p>I've got wxWidgets 3.0.2 installed from brew:</p>\n\n<pre><code>brew install wxwidgets\n</code></pre>\n\n<p>and wxHaskell 0.92 from cabal</p>\n\n<pre><code>cabal install wx\ncabal install wxcore\n</code></pre>\n"}, {"tags": ["loops", "haskell", "break"], "answers": [{"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443843781, "post_id": 32918591, "comment_id": 53664731, "body": "Thanks for the answer. But the loop you provided is stopped using a constant. What if the stop condition is dynamically detected like the example I provided?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443844026, "post_id": 32918591, "comment_id": 53664777, "body": "Just replace the condition in the if statement with whatever boolean expression you want."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443844383, "post_id": 32918591, "comment_id": 53664833, "body": "Thanks. But what if that <code>if</code> condition itself is an <code>IO</code> monad, as it is in my example? I can&#39;t just say <code>if isNothing get&#39; then ...</code>."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443844552, "post_id": 32918591, "comment_id": 53664865, "body": "I just added another example with a monadic condition."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443844629, "post_id": 32918591, "comment_id": 53664880, "body": "Ahhh ... now I get it. Thanks."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1443844503, "last_edit_date": 1443844503, "creation_date": 1443842773, "answer_id": 32918591, "question_id": 32918416, "link": "https://stackoverflow.com/questions/32918416/how-do-i-use-break-in-the-package-loops/32918591#32918591", "title": "How do I use `break_` in the package &quot;loops&quot;?", "body": "<p><code>LoopT</code> is a monad transfomer, so you will need to <code>liftIO</code> your <code>print x</code> statement.</p>\n\n<p>Here are some usage examples:</p>\n\n<pre><code>import Control.Monad \nimport Control.Monad.Trans (liftIO)\nimport Control.Monad.Loop as ML\n\n-- infinite printing loop\nfoo :: LoopT IO ()\nfoo = do\n  x &lt;- ML.iterate 0 (+1) \n  liftIO $ print x\n\nrun_foo = ML.exec_ foo\n\n-- prints 1, 3, 5, 7, 9\nbar :: IO () \nbar = ML.exec_ $ do\n  x &lt;- ML.iterate 1 (+2)\n  if x &lt; 10\n    then liftIO $ print x\n    else break_\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>If you want to execute a infinite loop in another monad, I would just use <code>forever</code> from <code>Control.Monad</code> --</p>\n\n<pre><code>import Control.Monad\nimport Control.Monad.State\n\nmyloop = forever $ do\n  x &lt;- get\n  liftIO $ print x\n  put (x+1)\n\nmain = runStateT myloop 10 -- start loop at 10\n</code></pre>\n\n<p><strong>Update 2</strong></p>\n\n<p>Another example using a monadic condition:</p>\n\n<pre><code>findFavoriteNumber = ML.exec_ $ do\n  x &lt;- ML.iterate 1 (+1)\n  yn &lt;- liftIO $ do putStr $ \"is \" ++ show x ++ \" your favorite number? \"\n                    getLine\n  if yn == \"yes\"\n    then break_\n    else return ()\n</code></pre>\n\n<p>Of course, this loop doesn't return the favorite number - it just keeps asking until the user responds with \"yes\".</p>\n"}, {"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443849065, "post_id": 32919007, "comment_id": 53665566, "body": "Thank you for going extra miles. Previously I didn&#39;t realize that I was supposed to put my iteration content in the same <code>do</code>-statement as the iterators (as oppose to putting them in the last <code>return</code>)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1443852014, "post_id": 32919007, "comment_id": 53666127, "body": "@trVoldemort, it&#39;s admittedly a somewhat peculiar interface."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1443847593, "creation_date": 1443847593, "answer_id": 32919007, "question_id": 32918416, "link": "https://stackoverflow.com/questions/32918416/how-do-i-use-break-in-the-package-loops/32919007#32919007", "title": "How do I use `break_` in the package &quot;loops&quot;?", "body": "<p>Here's a direct translation of your loop to <code>loops</code> style:</p>\n\n<pre><code>module Main where\nimport Control.Monad.Loop as ML\nimport Text.Read (readMaybe)\nimport Control.Exception\nimport System.IO.Error\nimport Control.Applicative\nimport Control.Monad.IO.Class\n\nget' :: IO (Maybe Int)\nget' = do\n  catchJust (\\e -&gt; if isEOFError e then Just () else Nothing)\n            (return . readMaybe =&lt;&lt; getLine)\n            (const $ return Nothing)\n\nmain :: IO ()\nmain = exec_ $\n  ML.forever &gt;&gt; do\n    mx &lt;- liftIO get'\n    case mx of\n      Nothing -&gt; break_\n      Just x -&gt; liftIO (print x)\n</code></pre>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 32918591, "answer_count": 2, "score": 1, "last_activity_date": 1443859289, "creation_date": 1443840595, "last_edit_date": 1443859289, "question_id": 32918416, "link": "https://stackoverflow.com/questions/32918416/how-do-i-use-break-in-the-package-loops", "title": "How do I use `break_` in the package &quot;loops&quot;?", "body": "<p>Looking into the package <a href=\"https://hackage.haskell.org/package/loops-0.2.0.2\" rel=\"nofollow\"><code>loops</code></a>, I found it very interesting and could be useful. However, there's one part about the package that I don't understand: how am I supposed to use <a href=\"https://hackage.haskell.org/package/loops-0.2.0.2/docs/Control-Monad-Loop.html#v:break_\" rel=\"nofollow\"><code>break_</code></a>?</p>\n\n<p>Let's say I have a function <code>get' :: IO (Maybe Int)</code>, with which each call will return a number read from a file, and returns <code>Nothing</code> if the EOF is reached. I'm trying to construct a simple loop where I print each number and break upon EOF.</p>\n\n<p>Now, I know to loop indefinitely I can use <code>forever</code>:</p>\n\n<pre><code>import Control.Monad.Loop as ML\nimport Control.Monad as M\n\nmain = do\n    M.sequence . loop $ do\n        ML.forever\n        return $ do\n            mx &lt;- get'\n            case mx of\n                Nothing -&gt; ???\n                Just x  -&gt; print x\n</code></pre>\n\n<p>But where do I put my <code>break_</code>? It is a <code>LoopT IO Int</code>, so I can only put it in <code>LoopT</code> monad, but isn't it supposed to be called mid interation, instead of when defining loops? This really confuses me.</p>\n"}, {"tags": ["haskell", "recursion", "tail"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1443838183, "post_id": 32917745, "comment_id": 53663936, "body": "Try putting the two lines defining <code>mPH</code> adjacent to each other in the code."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1443838224, "post_id": 32917745, "comment_id": 53663944, "body": "Use irc if you want timely advice.  Get countHelp below mPH, don&#39;t split up your mPH definition."}, {"owner": {"reputation": 3, "user_id": 5403272, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MB_VE7awQTk/AAAAAAAAAAI/AAAAAAAAAEY/WGjVPQnHTmY/photo.jpg?sz=128", "display_name": "Jervis Chen", "link": "https://stackoverflow.com/users/5403272/jervis-chen"}, "edited": false, "score": 0, "creation_date": 1443840731, "post_id": 32917745, "comment_id": 53664277, "body": "@Dubuisson what do you mean irc?"}, {"owner": {"reputation": 3, "user_id": 5403272, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MB_VE7awQTk/AAAAAAAAAAI/AAAAAAAAAEY/WGjVPQnHTmY/photo.jpg?sz=128", "display_name": "Jervis Chen", "link": "https://stackoverflow.com/users/5403272/jervis-chen"}, "edited": false, "score": 0, "creation_date": 1443841131, "post_id": 32917745, "comment_id": 53664330, "body": "Ty you guys so much when i put the mPH definition together it work!!!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1443859512, "post_id": 32917745, "comment_id": 53667753, "body": "By <a href=\"https://www.haskell.org/irc\" rel=\"nofollow noreferrer\">IRC</a> he means the good old chat. Anyway, unless it&#39;s a very small thing and you can wait StackOverflow allows one to write more detailed answers."}, {"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1444725892, "post_id": 32917745, "comment_id": 54011414, "body": "@bheklilr, this is actually an answer rather than a comment."}], "owner": {"reputation": 3, "user_id": 5403272, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MB_VE7awQTk/AAAAAAAAAAI/AAAAAAAAAEY/WGjVPQnHTmY/photo.jpg?sz=128", "display_name": "Jervis Chen", "link": "https://stackoverflow.com/users/5403272/jervis-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443833984, "creation_date": 1443832901, "last_edit_date": 1443833984, "question_id": 32917745, "link": "https://stackoverflow.com/questions/32917745/haskell-non-exhaustive-patterns-in-function-for-recursion", "title": "Haskell non exhaustive patterns in function for recursion", "body": "<p>It gives  multiple declaration of <strong>\"mPH\"</strong> </p>\n\n<p>here is the code </p>\n\n<pre><code>dotProduct x y = sum(zipWith (*) x y)\n\nmatrixProduct x y = mPH [] x y\n\nmPH acc [] b = acc\n\ncountHelp countacc c [] = countacc\n\ncountHelp countacc c (d:ds) = countHelp ((dotProduct c d) : countacc) c ds\n\nmPH acc (a:as) b = mPH ((countHelp [] a b) : acc) as b\n</code></pre>\n\n<p>can anyone explain a little bit for me? \nSuppose my input will be </p>\n\n<pre><code>x = [[1,2,3],[4,5,6]]\ny = [[7,9,11],[8,10,12]]\nmatrixProduct x y\n</code></pre>\n\n<p>It should give back \nmartix [[64,58],[154,139]]</p>\n\n<p>what I think is each time I taking out first list of the first matrix when the the matrix become a empty list the recursion will stop.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1443831789, "creation_date": 1443831789, "answer_id": 32917633, "question_id": 32917570, "link": "https://stackoverflow.com/questions/32917570/what-is-the-best-way-to-do-c-struct-in-haskell/32917633#32917633", "title": "What is the best way to do C-struct in haskell?", "body": "<p>You <em>can</em> use the <code>-XDisambiguateRecordFields</code> extension. It allows exactly this: using the same name of record label in multiple data declaration.</p>\n\n<p>However, you should think about whether this is really needed. If two data types contain the same conceptual thing, would it perhaps be better to remove that field from both types and use it in a common wrapper instead?</p>\n\n<pre><code>data Person' = Person { address :: Text }\ndata Dog' = Dog { breed :: Text }\n\ndata Named b = Named { name :: Text, being :: b }\n\ntype Person = Named Person'\ntype Dog = Named Dog'\n</code></pre>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "closed_date": 1443831865, "answer_count": 1, "score": 0, "last_activity_date": 1443831789, "creation_date": 1443831152, "question_id": 32917570, "link": "https://stackoverflow.com/questions/32917570/what-is-the-best-way-to-do-c-struct-in-haskell", "closed_reason": "Duplicate", "title": "What is the best way to do C-struct in haskell?", "body": "<p>Currently I use data <code>fields</code> to mimic a C-struct. But I found that unlike the domain-driven way of programming like <code>object.property</code>, in haskell the property names are all dumped into the module namespace. This creates some problems when I have more than one such struct. For example, what if I have two data types:</p>\n\n<pre><code>data Person = Person { name :: Text, address :: Text }\ndata Dog = Dog { name :: Text, breed :: Text }\n</code></pre>\n\n<p>then GHC will complain: <code>Multiple declarations of \u2018name\u2019</code>. Thus I have to name the \"properties\" with prefixes:</p>\n\n<pre><code>data Person = Person { getPersonName :: Text, getPersonAddress :: Text }\ndata Dog = Dog { getDogName :: Text, getDogBreed :: Text }\n</code></pre>\n\n<p>is this necessary? Or am I using the wrong way to define a struct?</p>\n"}, {"tags": ["haskell", "vector"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1443830122, "post_id": 32917369, "comment_id": 53662604, "body": "are you asking about length checking or initialization?"}, {"owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1443838915, "post_id": 32917369, "comment_id": 53664067, "body": "@jberryman I am asking whether &quot;unsafeNew&quot; means &quot;this function does not check bounds&quot; or &quot;this function does not zero memory&quot;"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1443872434, "post_id": 32917369, "comment_id": 53671022, "body": "Note that the behaviors of <code>new</code> and <code>unsafeNew</code> changed in vector 0.11. Looks like the documentation wasn&#39;t updated to match."}], "answers": [{"comments": [{"owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "edited": false, "score": 0, "creation_date": 1444174592, "post_id": 32917453, "comment_id": 53788375, "body": "i&#39;m trying to figure out the difference between <code>UNSAFE_CHECK(checkLength) </code> and <code>BOUNDS_CHECK(checkLength)</code>."}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 3, "last_activity_date": 1443830070, "creation_date": 1443830070, "answer_id": 32917453, "question_id": 32917369, "link": "https://stackoverflow.com/questions/32917369/does-haskells-data-vector-mutable-unsafenew-zero-the-memory/32917453#32917453", "title": "Does Haskell&#39;s `Data.Vector.Mutable.unsafeNew` zero the memory?", "body": "<p>No, not in general. If you click through the source this is pretty clear:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/docs/src/Data-Vector-Generic-Mutable.html#new\" rel=\"nofollow\">https://hackage.haskell.org/package/vector-0.11.0.0/docs/src/Data-Vector-Generic-Mutable.html#new</a></p>\n\n<p><code>new</code> is <code>unsafeNew</code> with the addition of <code>basicInitialize</code>.</p>\n"}], "owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 32917453, "answer_count": 1, "score": 4, "last_activity_date": 1443830070, "creation_date": 1443829386, "question_id": 32917369, "link": "https://stackoverflow.com/questions/32917369/does-haskells-data-vector-mutable-unsafenew-zero-the-memory", "title": "Does Haskell&#39;s `Data.Vector.Mutable.unsafeNew` zero the memory?", "body": "<p>The <a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Generic-Mutable.html\" rel=\"nofollow\">docs</a> says that <code>new</code> \"creates a mutable vector of the given length\" and <code>unsafeNew</code> \"creates a mutable vector of the given length. The length is not checked.\" </p>\n\n<p>However <a href=\"https://github.com/haskell/vector/issues/30\" rel=\"nofollow\">this resolved github issue</a> indicates that <code>unsafeNew</code> does not zero the memory while <code>new</code> does.</p>\n\n<p>Which one is it?</p>\n"}, {"tags": ["haskell", "dynamic", "types", "casting"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443826514, "post_id": 32916757, "comment_id": 53661802, "body": "You need a language with dependent types (literally &quot;types that can depend on values&quot;) for that. Three popular dependently typed languages are Idris, Agda, and Coq (in order of &quot;most focused on programming&quot; to &quot;most focused on theorem proving&quot;); though I don&#39;t know to what extent those languages have analogs of <code>Typeable</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1443826706, "post_id": 32916757, "comment_id": 53661851, "body": "If you are asking for this as a stepping-stone to some other goal, you should talk about that other goal; it may be possible to achieve without dependent types (e.g. maybe <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Dynamic.html#v:fromDyn\" rel=\"nofollow noreferrer\"><code>fromDyn</code></a> is enough for you)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1443830416, "post_id": 32916757, "comment_id": 53662665, "body": "I suppose you mean something like, <i>how do I use <code>maybeIntType</code> to create a <code>(mempty :: Maybe Int)</code></i>?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1443862939, "post_id": 32916757, "comment_id": 53668608, "body": "As of GHC 7.10.2, the safe API of <code>Data.Typeable</code> makes <code>TypeRep</code>s almost useless except for printing, because all the cast operations require <code>Typeable</code> constraints, not just <code>TypeRep</code>s, and there&#39;s no safe way to get the former by passing in the latter. There are <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Typeable\" rel=\"nofollow noreferrer\">plans</a> to improve this."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1443863555, "post_id": 32916757, "comment_id": 53668747, "body": "Notice that <code>Nothing :: Maybe x</code> already, so the <code>Nothing</code> value is <i>already</i> compatible with the type <code>Maybe Int</code>. This may or may not help you, depending on what you&#39;re after..."}], "owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1443824870, "creation_date": 1443824870, "question_id": 32916757, "link": "https://stackoverflow.com/questions/32916757/how-can-i-create-a-value-with-a-specific-typerep", "title": "How can I create a value with a specific TypeRep", "body": "<p>Using <code>Data.Typeable</code>, I can reify the type of a value -</p>\n\n<pre><code>typeOf :: Typeable a =&gt; a -&gt; TypeRep\n</code></pre>\n\n<p>However, given a <code>TypeRep</code>, there seems to be no way to \"set\" a value to that type.</p>\n\n<p>For example -</p>\n\n<pre><code>maybeIntType :: TypeRep\nmaybeIntType = typeOf (Just 100 :: Maybe Int)\n</code></pre>\n\n<p>But how do I use <code>maybeIntType</code> to create a <code>(Nothing :: Maybe Int)</code>?</p>\n"}, {"tags": ["haskell", "reactive-programming", "frp", "reactive-banana"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1443857524, "post_id": 32916738, "comment_id": 53667267, "body": "just for the record: <i>&quot;it doesn&#39;t work&quot;</i> is not an error message \u2014 you&#39;re not even indicating if it&#39;s a compilation or runtime error, or if there&#39;s in fact even an error or whether you&#39;re just not seeing the wanted behavior."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443861982, "post_id": 32916738, "comment_id": 53668367, "body": "You are right sorry. As partial excuse I am having this issue with Haskell Platform and new &#39;El Capitan&#39; MacOsX that&#39;s why I cannot reproduce errors :( : <a href=\"http://stackoverflow.com/questions/32920452/how-to-run-haskell-on-osx-el-capitan\" title=\"how to run haskell on osx el capitan\">stackoverflow.com/questions/32920452/&hellip;</a>"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443862443, "post_id": 32916738, "comment_id": 53668484, "body": "what&#39;s wrong with <code>brew install ghc</code> or smth? do you have Homebrew? if not, consider giving it a try. you won&#39;t get far if you don&#39;t have Haskell installed... Also, I recommend using Stackage/<code>stack</code> on top of raw Hackage/<code>cabal</code>, and therefore Haskell Platform isn&#39;t recommended because Stackage/<code>stack</code> doesn&#39;t recommend it. Just go with Homebrew GHC, or let Stack install it&#39;s own local version(s) of GHC, or both."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443864545, "post_id": 32916738, "comment_id": 53669012, "body": "yes tried with brew but now cabal doesn&#39;t work (some new permissions errors like for /usr/bin/ar, no found versions of cabal self, etc). Quite a mess at the moment"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444036951, "post_id": 32916738, "comment_id": 53715261, "body": "it would make sense to type annotate <code>mapIO</code> with a generic type, i.e. <code>mapIO :: (a -&gt; IO b) -&gt; Event t a -&gt; Moment t (Event t b)</code>, as in Heinrich&#39;s original example, which is better than your current, monomorphic signature. (also, I&#39;ve fixed an error in your code where you&#39;re calling <code>mapIO</code> \u2014 it seems you still haven&#39;t sorted the Haskell+El Capitan issue :)"}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444039338, "post_id": 32916738, "comment_id": 53716734, "body": "LOL yes Haskell+El Capitan is still a work in progress. I used brew to install cabal/stack (and other tools from cabal) + GHC and I have tried to compile reactive-banana-wx with the new GHC-7.10.2. The problem is that cabal-macosx has a &#39;fgl&#39; version not updated (&lt;5.0) in its cabal file and rbwx uses 0.1.0 that doesn&#39;t compile cos of a <code>catch</code> error. If you update stack.yaml of rbwx to use version 0.2.3 of cabal-macosx the error is gone, but you have to change c-macosx&#39;s cabal file first, to use the right fgl. But it looks like the project cabal-macosx is dead so need local compile of it first"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444305188, "post_id": 32916738, "comment_id": 53852964, "body": "what&#39;s this project anyway? learning? school? hobby? I see you&#39;ve left in all of the dummy code and <code>putStrLn</code>s."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444555847, "post_id": 32916738, "comment_id": 53945936, "body": "it&#39;s a learning/hobby project. Anyway I am just re-adapting the code to something else."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444556479, "post_id": 32916738, "comment_id": 53946081, "body": "have a public repo of it?"}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444642066, "post_id": 32916738, "comment_id": 53972090, "body": "Yes there is a public repo with two branches: master with the current old centralized global state and the &quot;temp_backup&quot; branch that is using reactive-banana. Anyway this temp_backup is still a work in progress so it might be no clear at all :). BTW at the moment looks reactive-banana-wx doesn&#39;t work with Tool Menu Icons. <a href=\"https://github.com/danfran/hxkcd\" rel=\"nofollow noreferrer\">github.com/danfran/hxkcd</a>"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444648905, "post_id": 32916738, "comment_id": 53976147, "body": "Have you also evaluated Sodium, Reflex, Netwrie or Yampa?"}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444652357, "post_id": 32916738, "comment_id": 53978340, "body": "Reactive-Banana is my first FRP with Haskell, but I have started to consider Sodium too (although it looks discontinued for Haskell) and Yampa. I didn&#39;t check the other two yet."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444659296, "post_id": 32916738, "comment_id": 53983030, "body": "@ErikAllik can Sodium be considered the &quot;standard de facto&quot; for FRP in Haskell?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444663284, "post_id": 32916738, "comment_id": 53985716, "body": "I don&#39;t know; I was just curious because there doesn&#39;t seem to be too much comparative information."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444666270, "post_id": 32916738, "comment_id": 53987596, "body": "first chapter here (free to download) <a href=\"https://www.manning.com/books/functional-reactive-programming\" rel=\"nofollow noreferrer\">manning.com/books/functional-reactive-programming</a> it gives you some info about reactive-banana and sodium and frp in general."}], "answers": [{"comments": [{"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443865104, "post_id": 32920479, "comment_id": 53669158, "body": "At the moment I cannot compile anything so I am trying to explain what I was trying to do: Once the button is pressed you have the &quot;coreOfTheApp&quot; behaviour that in the first output just show you the current count. In the second output you pipe that behaviour content to another IO remote function in a form of parameter to get another output to display"}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443866510, "post_id": 32920479, "comment_id": 53669503, "body": "mapIO/Handler should be what I need for: <a href=\"http://hackage.haskell.org/package/reactive-banana-0.9.0.0/docs/Control-Event-Handler.html#t:AddHandler\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/reactive-banana-0.9.0.0/docs/&hellip;</a>. Streaming the event in the IO function (instead of the Behavior)."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443866999, "post_id": 32920479, "comment_id": 53669625, "body": "OK, thanks for the explanation \u2014 so, effectively, the same button should trigger both API calls; it&#39;s just that the new one (obviously) needs to happen  the original one because the original one updates the state and the new one relies on the state when doing the API call. I&#39;ll also take a look at <code>mapIO</code>/<code>Handler</code>."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443869234, "post_id": 32920479, "comment_id": 53670194, "body": "To be honest, I cannot seem to figure out how to achieve <code>(Behavior t a, a -&gt; IO b) -&gt; Behavior t b</code> or <code>(Event t a, a -&gt; IO b) -&gt; Event t b</code> or equivalent... at least not with Reactive Banana \u2014 Sodium and Reflex seem to have more useful functions to get something like that but not Reactive Banana."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443869459, "post_id": 32920479, "comment_id": 53670264, "body": "In other words, Sodium has <code>executeAsyncIO :: Event r (IO a) -&gt; Event r a</code> (and a sync version thereof) but Reactive Banana seems to have nothing similar. I&#39;m trying to figure out if I can achieve the same using a combination of <code>changes</code> and <code>reactimate</code>, or similar."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 1, "last_activity_date": 1443876810, "last_edit_date": 1443876810, "creation_date": 1443860930, "answer_id": 32920479, "question_id": 32916738, "link": "https://stackoverflow.com/questions/32916738/reactive-banana-consume-parametrized-call-to-an-external-api/32920479#32920479", "title": "Reactive Banana: consume parametrized call to an external API", "body": "<p><strong>TL;DR:</strong> scroll down to the <strong>ANSWER:</strong> section for a solution along with an explanation.</p>\n\n<hr>\n\n<p>First of all</p>\n\n<pre><code>getAnotherRemoteApiValue state = (`mod` 10) &lt;$&gt; randomIO + count state\n</code></pre>\n\n<p>is invalid (i.e. does not typecheck) for reasons completely unrelated to FRP or reactive-banana: you cannot add an <code>Int</code> to an <code>IO Int</code> \u2014 just as you can't apply <code>mod 10</code> to an <code>IO Int</code> directly, which is exactly why, in the answer to your original question, I used <code>&lt;$&gt;</code> (which is another name for <code>fmap</code> from <code>Functor</code>). </p>\n\n<p>I strongly recommend you look up and understand the purpose/meaning of <code>&lt;$&gt;</code>, along with <code>&lt;*&gt;</code> and some other <code>Functor</code> and <code>Applicative</code> type class methods \u2014 FRP (at least the way it is designed in reactive-banana) builds heavily upon Functors and Applicatives (and sometimes Monads, Arrows and possibly some other more novel foundation), hence if you don't completely understand those, you won't ever become proficient with FRP.</p>\n\n<p><strong>Secondly</strong>, I'm not sure why you're using <code>coreOfTheApp</code> for <code>sink output2 ...</code> \u2014 the <code>coreOfTheApp</code> value is related to the other API value.</p>\n\n<p><strong>Thirdly</strong>, how should the other API value be displayed? Or, more specifically, when should it be displayed? Your first API value is displayed when the button is clicked but there's no button for the second one\u00a0\u2014 do you want the same button to trigger the API call and display update? Do you want another button? Or do you want it to be polled every <code>n</code> unit of time and simply auto-updated in the UI?</p>\n\n<p><strong>Lastly</strong>, <code>reactimate</code> is meant for converting a <code>Behavior</code> into an <code>IO</code> action, which is not what you want, because you already have the <code>show</code> helper and don't need to <code>setText</code> or smth on the static label. In other words, what you need for the second API value is the same as before, except you need to pass something from the app state along with the request to the external API, but aside from that difference, you can still just keep showing the (other) API value using <code>show</code> as normal.</p>\n\n<hr>\n\n<p><strong>ANSWER:</strong></p>\n\n<p>As to how to convert <code>getAnotherRemoteApiValue :: AppState -&gt; IO RemoteValue</code> into an <code>Event t Int</code> similar to the original <code>remoteValueE</code>:</p>\n\n<p>I first tried to go via <code>IORef</code>s and using <code>changes</code>+<code>reactimate'</code>, but that quickly turned out to a dead end (besides being ugly and overly complicated): <code>output2</code> was always updated one FRP \"cycle\" too late, so it was always one \"version\" behind in the UI.</p>\n\n<p>I then, with the help of Oliver Charles (ocharles) on #haskell-game on FreeNode, turned to <code>execute</code>:</p>\n\n<pre><code>execute :: Event t (FrameworksMoment a) -&gt; Moment t (Event t a)\n</code></pre>\n\n<p>which I still don't fully grasp yet, but it works:</p>\n\n<pre><code>let x = fmap (\\s -&gt; FrameworksMoment $ liftIO $ getAnotherRemoteApiValue s)\n             (appStateB &lt;@ ebt)\nremoteValue2E &lt;- execute x\n</code></pre>\n\n<p>so the same button would trigger both actions. But the problem with that quickly turned out to be the same as with the <code>IORef</code> based solution \u2014 since the same button would trigger a pair of events, and one event inside that pair depended on the other, the contents of <code>output2</code> was still one version behind.</p>\n\n<p>I then realised the events relatede to <code>output2</code> need to be triggered <em>after</em> any events related to <code>output1</code>. However, it's impossible to go from <code>Behavior t a -&gt; Event t a</code>; in other words, once you have a behavior, you can't (easily?) obtain an event from that (except with <code>changes</code>, but <code>changes</code> is tied to <code>reactimate</code>/<code>reactimate'</code>, which is not useful here).</p>\n\n<p>I finally noticed that I was essentially \"throwing away\" an intermediate <code>Event</code> at this line:</p>\n\n<pre><code>appStateB = accumB initialState $ transformState &lt;$&gt; remoteValue1E\n</code></pre>\n\n<p>by replacing it with</p>\n\n<pre><code>appStateE = accumE initialState $ transformState &lt;$&gt; remoteValue1E\nappStateB = stepper initialState -- there seems to be no way to eliminate the initialState duplication but that's fine\n</code></pre>\n\n<p>so I still had the exact same <code>appStateB</code>, which is used as previously, but I could then also rely on <code>appStateE</code> to reliably trigger further events that rely on the <code>AppState</code>:</p>\n\n<pre><code>let x = fmap (\\s -&gt; FrameworksMoment $ liftIO $ getAnotherRemoteApiValue s)\n             appStateE\nremoteValue2E &lt;- execute x\n</code></pre>\n\n<hr>\n\n<p>The final <code>sink output2</code> line looks like:</p>\n\n<pre><code>sink output2 [text :== show &lt;$&gt; remoteValue2B] \n</code></pre>\n\n<p>All of the code can be seen at <a href=\"http://lpaste.net/142202\" rel=\"nofollow\">http://lpaste.net/142202</a>, with debug output still enabled.</p>\n\n<p><em>Note that the <code>(\\s -&gt; FrameworkMoment $ liftIO $ getAnotherRemoteApiValue s)</code> lambda cannot be converted to point-free style for reasons related to RankN types. I was told this problem will go away in reactive-banana 1.0 because there will be no <code>FrameworkMoment</code> helper type.</em></p>\n"}, {"comments": [{"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443908306, "post_id": 32926296, "comment_id": 53681629, "body": "When you say &quot;if the computation is more involved&quot; about the <code>reactimate</code> usage, are you referring to &quot;time duration&quot;? As it is involved a remote API the response time can be variable (milli seconds, seconds, never). If this is what you meant, the only solution is just using mapIO/reactimate."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 1, "creation_date": 1443944543, "post_id": 32926296, "comment_id": 53688123, "body": "Well, it always depends on what you want to do. Time duration is one criterion: It should be much shorter than the typical time frame in which an external Event occurs. If your computation connects to the internet and waits for results, then this is most likely unsuitable for use with <code>execute</code>, because there will be other events coming in in the meantime that the network needs to handle, but can&#39;t, because it is stuck in the IO action."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443947965, "post_id": 32926296, "comment_id": 53688908, "body": "@HeinrichApfelmus: so based on your explanation, I take it it&#39;s not a good idea to use <code>execute</code> for possibly expensive calls, so my answer&#39;s not really valid in the context of this particular question?"}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443968893, "post_id": 32926296, "comment_id": 53694515, "body": "@ErikAllik Yup. To be fair, the question did not specify this. Your explanation of getting a Behavior from the Event is still useful, though."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1443986975, "post_id": 32926296, "comment_id": 53700298, "body": "@HeinrichApfelmus: I am using at the moment the version 0.9 of RR, please look again at my question as I have updated it for readability reason."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1444031718, "post_id": 32926296, "comment_id": 53712453, "body": "@Randomize I have added the type signature for 0.9"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444036476, "post_id": 32926296, "comment_id": 53714980, "body": "@HeinrichApfelmus: wouldn&#39;t it make sense to include <code>mapIO</code> in <code>reactive-banana</code>? IO seems like a big deal, and the more of the boilerplate for it that has been taken care of by <code>reactive-banana</code>, and that is otherwise hard to get right and easy to get wrong, given the tricky relationship between FRP and IO, the easier it is to build real life apps with the library. For example, it&#39;s likely I&#39;d have found about everything you said in a trial and error manner, after my FRP app started misbehaving because I was using <code>execute</code> with slow IO."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1444037233, "post_id": 32926296, "comment_id": 53715411, "body": "@HeinrichApfelmus: ok, I think there is a misunderstanding. You are talking about <code>mapIO</code> right? So this signature <code>Control.Event.Handler.mapIO :: (a -&gt; IO b) -&gt; AddHandler a -&gt; AddHandler b</code>. I was talking about <code>reactimate</code> (so I rewrote in the code <code>mapIO</code> that should be unnecessary at this point)."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444119925, "post_id": 32926296, "comment_id": 53754878, "body": "@ErikAllik Can you make an issue on the issue tracker?"}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1444120099, "post_id": 32926296, "comment_id": 53754965, "body": "@Randomize Ah, sorry, my code contained a mistake, I forgot to call the <code>handler</code> function. I have fixed it in the answer. Also, this is a different <code>mapIO</code> function than then one in <code>Control.Event.Handler</code>, although they serve such a similar purpose that I have given them the same name. I&#39;ll add a tick at the end."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1444121039, "post_id": 32926296, "comment_id": 53755597, "body": "@HeinrichApfelmus thank you. I didn&#39;t tried your code yet but that makes sense. The value from the &quot;remote api&quot; is carried from a new event binding an &quot;IO-handler&quot;. Anyway my <code>MapIO</code> signature is slightly different than yours. I assume you are keep on referring to the new API 1.0 version."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444127642, "post_id": 32926296, "comment_id": 53760034, "body": "@HeinrichApfelmus: conceptually, what separates <code>(a -&gt; IO b) -&gt; Event a -&gt; Event b</code> from <code>(a -&gt; IO b) -&gt; Event a -&gt; MomentIO (Event b)</code> in that latter can exist and the former not? It must be something obvious but your wording of it will probably help."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1444291944, "post_id": 32926296, "comment_id": 53844085, "body": "@Randomize You didn&#39;t need to add the <code>Frameworks t</code> constraint, because the type variable <code>t</code> was already in scope with this constraint. If you make <code>mapIO&#39;</code> a top-level definition , then the constraint would have to be added."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444292100, "post_id": 32926296, "comment_id": 53844197, "body": "@ErikAllik Yes. Note that in the latter, the input <code>Event a</code> and the output <code>Event b</code> will not be simultaneous. Essentially, this is the underlying reason why the former cannot exist."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444304544, "post_id": 32926296, "comment_id": 53852462, "body": "So the <code>MomentIO</code> wrapping is what&#39;s making <code>Event b</code> non-simultaneous with <code>Event a</code>? Or I guess I should read the source or smth..."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444378998, "post_id": 32926296, "comment_id": 53888289, "body": "@ErikAllik Not necessarily. The <code>MomentIO</code> type is just an indication that something with IO happens, which means that in order to understand what a program does, order of execution has to be taken into account. In this case, the result is a lack of simultaneity."}], "tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 3, "last_activity_date": 1444120000, "last_edit_date": 1444120000, "creation_date": 1443898645, "answer_id": 32926296, "question_id": 32916738, "link": "https://stackoverflow.com/questions/32916738/reactive-banana-consume-parametrized-call-to-an-external-api/32926296#32926296", "title": "Reactive Banana: consume parametrized call to an external API", "body": "<p>The fundamental problem is a conceptual one: FRP Events and Behaviors can only be combined in a pure way. In principle, it is not possible to have a function of type, say</p>\n\n<pre><code>mapIO' :: (a -&gt; IO b) -&gt; Event a -&gt; Event b\n</code></pre>\n\n<p>because the order in which the corresponding IO actions are to be executed is <em>undefined</em>.</p>\n\n<hr>\n\n<p>In practice, it may sometimes be useful to perform IO while combining Events and Behaviors. The <code>execute</code> combinator can do this, as @ErikAllik indicates. Depending on the nature of <code>getAnotherRemoteApiValue</code>, this may be the right thing to do, in particular if this is function is idempotent, or does a quick lookup from location in RAM.</p>\n\n<p>However, if the computation is more involved, then it is probably better to use <code>reactimate</code> to perform the IO computation. Using <code>newEvent</code> to create an <code>AddHandler</code>, we can give an implementation of the <code>mapIO'</code> function:</p>\n\n<pre><code>mapIO' :: (a -&gt; IO b) -&gt; Event a -&gt; MomentIO (Event b)\nmapIO' f e1 = do\n    (e2, handler) &lt;- newEvent\n    reactimate $ (\\a -&gt; f a &gt;&gt;= handler) &lt;$&gt; e1\n    return e2\n</code></pre>\n\n<p>The key difference to the pure combinator</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; Event a -&gt; Event b\n</code></pre>\n\n<p>is that the latter guarantees that the input and result events occur simultaneously, while the former gives absolutely no guarantee about when the result event occurs in relation to other events in the network.</p>\n\n<p>Note that <code>execute</code> also guarantees that input and result are have simultaneous occurrences, but places informal restrictions on the IO allowed.</p>\n\n<hr>\n\n<p>With this trick of combining <code>reactimate</code> with <code>newEvent</code> a similar combinator can be written for Behaviors in a similar fashion. Keep in mind that the toolbox from <code>Reactive.Banana.Frameworks</code> is only appropriate if you are dealing with IO actions whose precise order will necessarily be undefined.</p>\n\n<hr>\n\n<p>(To keep this answer current, I have used the type signatures from the upcoming reactive-banana 1.0. In version 0.9, the type signature for <code>mapIO'</code> is</p>\n\n<pre><code>mapIO' :: Frameworks t =&gt; (a -&gt; IO b) -&gt; Event t a -&gt; Moment t (Event t b)\n</code></pre>\n\n<p>)</p>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 1, "accepted_answer_id": 32926296, "answer_count": 2, "score": 6, "last_activity_date": 1444168811, "creation_date": 1443824761, "last_edit_date": 1495541030, "question_id": 32916738, "link": "https://stackoverflow.com/questions/32916738/reactive-banana-consume-parametrized-call-to-an-external-api", "title": "Reactive Banana: consume parametrized call to an external API", "body": "<p>Starting from a previous question here:\n<a href=\"https://stackoverflow.com/questions/32806125/reactive-banana-how-to-use-values-from-a-remote-api-and-merge-them-in-the-event\">Reactive Banana: how to use values from a remote API and merge them in the event stream</a></p>\n\n<p>I have a bit different problem now: How can I use the <code>Behaviour</code> output as input for an IO operation and finally display the IO operation's result?</p>\n\n<p>Below is the code from the previous answer changed with a second output:</p>\n\n<pre><code>import System.Random\n\ntype RemoteValue = Int\n\n-- generate a random value within [0, 10)\ngetRemoteApiValue :: IO RemoteValue\ngetRemoteApiValue = (`mod` 10) &lt;$&gt; randomIO\n\ngetAnotherRemoteApiValue :: AppState -&gt; IO RemoteValue\ngetAnotherRemoteApiValue state = (`mod` 10) &lt;$&gt; randomIO + count state\n\ndata AppState = AppState { count :: Int } deriving Show\n\ntransformState :: RemoteValue -&gt; AppState -&gt; AppState\ntransformState v (AppState x) = AppState $ x + v\n\nmain :: IO ()\nmain = start $ do\n    f        &lt;- frame [text := \"AppState\"]\n    myButton &lt;- button f [text := \"Go\"]\n    output   &lt;- staticText f []\n    output2  &lt;- staticText f []\n\n    set f [layout := minsize (sz 300 200)\n                   $ margin 10\n                   $ column 5 [widget myButton, widget output, widget output2]]\n\n    let networkDescription :: forall t. Frameworks t =&gt; Moment t ()\n        networkDescription = do    \n          ebt &lt;- event0 myButton command\n\n          remoteValueB &lt;- fromPoll getRemoteApiValue\n          myRemoteValue &lt;- changes remoteValueB\n\n          let\n            events = transformState &lt;$&gt; remoteValueB &lt;@ ebt\n\n            coreOfTheApp :: Behavior t AppState\n            coreOfTheApp = accumB (AppState 0) events\n\n          sink output [text :== show &lt;$&gt; coreOfTheApp] \n\n          sink output2 [text :== show &lt;$&gt; reactimate ( getAnotherRemoteApiValue &lt;@&gt; coreOfTheApp)] \n\n    network &lt;- compile networkDescription    \n    actuate network\n</code></pre>\n\n<p>As you can see what I am trying to do it is using the new state of the application -> <code>getAnotherRemoteApiValue</code> -> show. But it doesn't work.</p>\n\n<p>Is actually possible doing that?</p>\n\n<p><strong>UPDATE</strong>\nBased on the Erik Allik and Heinrich Apfelmus below answers I have the current code situation - that works :) :</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule Main where\n\nimport System.Random\nimport Graphics.UI.WX hiding (Event, newEvent)\nimport Reactive.Banana\nimport Reactive.Banana.WX\n\n\ndata AppState = AppState { count :: Int } deriving Show\n\ninitialState :: AppState\ninitialState = AppState 0\n\ntransformState :: RemoteValue -&gt; AppState -&gt; AppState\ntransformState v (AppState x) = AppState $ x + v\n\ntype RemoteValue = Int\n\nmain :: IO ()\nmain = start $ do\n    f        &lt;- frame [text := \"AppState\"]\n    myButton &lt;- button f [text := \"Go\"]\n    output1  &lt;- staticText f []\n    output2  &lt;- staticText f []\n\n    set f [layout := minsize (sz 300 200)\n                   $ margin 10\n                   $ column 5 [widget myButton, widget output1, widget output2]]\n\n    let networkDescription :: forall t. Frameworks t =&gt; Moment t ()\n        networkDescription = do    \n          ebt &lt;- event0 myButton command\n\n          remoteValue1B &lt;- fromPoll getRemoteApiValue\n\n          let remoteValue1E = remoteValue1B &lt;@ ebt\n\n              appStateE = accumE initialState $ transformState &lt;$&gt; remoteValue1E\n              appStateB = stepper initialState appStateE\n\n              mapIO' :: (a -&gt; IO b) -&gt; Event t a -&gt; Moment t (Event t b)\n              mapIO' ioFunc e1 = do\n                  (e2, handler) &lt;- newEvent\n                  reactimate $ (\\a -&gt; ioFunc a &gt;&gt;= handler) &lt;$&gt; e1\n                  return e2\n\n          remoteValue2E &lt;- mapIO' getAnotherRemoteApiValue appStateE\n\n          let remoteValue2B = stepper Nothing $ Just &lt;$&gt; remoteValue2E\n\n          sink output1 [text :== show &lt;$&gt; appStateB] \n          sink output2 [text :== show &lt;$&gt; remoteValue2B] \n\n    network &lt;- compile networkDescription    \n    actuate network\n\ngetRemoteApiValue :: IO RemoteValue\ngetRemoteApiValue = do\n  putStrLn \"getRemoteApiValue\"\n  (`mod` 10) &lt;$&gt; randomIO\n\ngetAnotherRemoteApiValue :: AppState -&gt; IO RemoteValue\ngetAnotherRemoteApiValue state = do\n  putStrLn $ \"getAnotherRemoteApiValue: state = \" ++ show state\n  return $ count state\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1443812857, "post_id": 32914116, "comment_id": 53656190, "body": "Indent your code properly! <code>valueAt</code> as it is, continues the previous line <code>... 8))</code>!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1443813278, "post_id": 32914116, "comment_id": 53656385, "body": "Do not use <code>==</code> here. It has its uses, but it does not belong in this code at all. Use pattern matching here instead of guards."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1443815950, "last_edit_date": 1443815950, "creation_date": 1443812951, "answer_id": 32914208, "question_id": 32914116, "link": "https://stackoverflow.com/questions/32914116/haskell-binary-tree-recursion/32914208#32914208", "title": "Haskell Binary Tree Recursion", "body": "<p>You did not handle the case <code>valueAt [] someTree</code>. The line <code>valueAt (p:ps) ...</code> only matches a <em>non empty</em> list starting with <code>p</code> and continuing with <code>ps</code>. <code>ps</code> might be empty, but <code>p:ps</code> never is.</p>\n\n<p>If you compile with the flag <code>-Wall</code>, GHC should warn about this at compile time. I would strongly recommend this.</p>\n\n<p>As a style suggestion, avoid guards such as <code>p == ...</code> since they do not perform any pattern match. Try instead something like</p>\n\n<pre><code>valueAt :: Path -&gt; Tree a -&gt; Maybe a\nvalueAt []     (Node a _ _) = Just a    -- note the \"a\" !\nvalueAt (L:ps) (Node _ l _) = valueAt ps l\nvalueAt (R:ps) (Node _ _ r) = valueAt ps r\nvalueAt _      End          = Nothing   -- in all the other cases\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5402553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54b738b7d0c2054d15177354ab2fbb4a?s=128&d=identicon&r=PG&f=1", "display_name": "Prathveer Rai", "link": "https://stackoverflow.com/users/5402553/prathveer-rai"}, "edited": false, "score": 0, "creation_date": 1444164482, "post_id": 32916258, "comment_id": 53784299, "body": "Hey thanks a lot , this has helped a lot , yea the guards kinda make it look more complicated. thank you for spending your time on this."}], "tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": false, "score": 0, "last_activity_date": 1443822046, "creation_date": 1443822046, "answer_id": 32916258, "question_id": 32914116, "link": "https://stackoverflow.com/questions/32914116/haskell-binary-tree-recursion/32916258#32916258", "title": "Haskell Binary Tree Recursion", "body": "<p>Your pattern match for <code>valueAt</code> does not cover <code>[]</code>, because <code>(p:ps)</code> will fail on an empty list. However, it is not necessary that it do so. Guards are evaluated in the order they are written, which means that your <code>p == L</code> and <code>p == R</code> guards are evaluated <em>before</em> your <code>ps == []</code> case. In other words, you have put your edge case after your recursion cases, resulting in an invalid pattern match. This code should fix that.</p>\n\n<pre><code>valueAt (p:ps) (Node a l r)  \n                           | ps == [] = Just    \n                           | p == L = valueAt ps l \n                           | p == R = valueAt ps r       \n                           | otherwise = Nothing\n</code></pre>\n\n<p>However, your code has another problem. The function has the type description <code>valueAt :: Path -&gt; Tree a -&gt; Maybe a</code>, but in your edge case (<code>ps == []</code>), <code>Just</code> has type <code>a -&gt; Maybe a</code>; <code>Just</code> is applied to <em>too few arguments</em>. Try this instead.</p>\n\n<pre><code>                           | ps == [] = Just a\n</code></pre>\n\n<p>Now that your errors are fixed, I would also suggest moving from guards and <code>==</code> to pattern matches. It will be simpler, faster, and less error prone.</p>\n\n<pre><code>valueAt :: Path -&gt; Tree a -&gt; Maybe a\nvalueAt []     (Node a _ _) = Just a\nvalueAt (L:ps) (Node _ l _) = valueAt ps l\nvalueAt (R:ps) (Node _ _ r) = valueAt ps r\nvalueAt _      _            = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5402553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54b738b7d0c2054d15177354ab2fbb4a?s=128&d=identicon&r=PG&f=1", "display_name": "Prathveer Rai", "link": "https://stackoverflow.com/users/5402553/prathveer-rai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1076, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1443822046, "creation_date": 1443812570, "question_id": 32914116, "link": "https://stackoverflow.com/questions/32914116/haskell-binary-tree-recursion", "title": "Haskell Binary Tree Recursion", "body": "<p>I am a beginner in haskell and I need to display the value in a tree based on directions specified in a List (Path). I have liste below the Data structures , I want to understand why my recursive feature that i have implemented is wrong</p>\n\n<pre><code>import Data.List\n\n data Step = L | R\n deriving(Eq,Show)\n\ntype Path = [Step]  \n\n data Tree a = Node a (Tree a) (Tree a)\n             | End\n        deriving (Eq,Show)\n\n      leaf :: a -&gt; Tree a\n      leaf x = Node x End End\n\n     ex :: Tree Int\n\n\n     ex = Node 4 (Node 3 (leaf 2) End)\n               (Node 7 (Node 5 End (leaf 6))\n                     (leaf 8))\n\n\n\n        valueAt :: Path -&gt; Tree a -&gt; Maybe a\n        valueAt (p:ps) (Node a l r)  \n                               | p == L = valueAt ps l \n                               | p == R = valueAt ps r\n                               | ps == [] = Just           \n                               | otherwise = Nothing\n</code></pre>\n\n<p>// When i execute this it says non exhaustive function at valueAt. So im guessing my recursive idea was implemented wrong. Can anyone explain why .</p>\n"}, {"tags": ["unit-testing", "haskell", "hunit"], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443813471, "post_id": 32914098, "comment_id": 53656481, "body": "I had looked into <code>detailed-0.9</code>, but <a href=\"http://stackoverflow.com/a/18686329/656912\">got the vibe</a> that it was less stable and hard to use."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1443813534, "post_id": 32914098, "comment_id": 53656508, "body": "@raxacoricofallapatorius, could be. I&#39;ve never messed with either; I&#39;ve only done a bit of expansion of existing test suites in existing projects."}, {"owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "edited": false, "score": 0, "creation_date": 1503085414, "post_id": 32914098, "comment_id": 78486228, "body": "@dfeuer: I used your approach with <code>ExitSuccess</code> and <code>ExitFailure</code>, but it does not work for some reason if I run <code>cabal test --show-details=&#39;always&#39;</code> - build says test suite : PASS even though there is one failure. Could you please recommend a workaround?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "edited": false, "score": 0, "creation_date": 1503116083, "post_id": 32914098, "comment_id": 78493580, "body": "@altern, I suggest you ask a separate question with a full reproduction and link to this question. It&#39;s too hard to go into detail with comments, and it&#39;s impossible to diagnose the problem without code."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1578345052, "last_edit_date": 1578345052, "creation_date": 1443812511, "answer_id": 32914098, "question_id": 32913552, "link": "https://stackoverflow.com/questions/32913552/why-does-my-hunit-test-suite-fail-but-pass-successfully-in-cabal/32914098#32914098", "title": "Why does my HUnit test suite fail but pass successfully in Cabal?", "body": "<p>According to the <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#test-suites\" rel=\"nofollow noreferrer\">Cabal users' guide</a>,</p>\n\n<blockquote>\n  <p>Test suites using the <code>exitcode-stdio-1.0</code> interface are executables that indicate test failure with a non-zero exit code when run; they may provide human-readable log information through the standard output and error channels.</p>\n</blockquote>\n\n<p>You've defined</p>\n\n<pre><code>main :: IO Counts\nmain = runTestTT $ TestList [test1, test2, test1]\n</code></pre>\n\n<p>This runs tests, prints out test information, and then always exits successfully. If you want Cabal to know the test has failed, you need to capture the <code>Counts</code>, check for <code>errors</code> and <code>failures</code>, and exit with a non-zero status if you find such.</p>\n\n<pre><code>import System.Exit\n\nmain :: IO ()\nmain = do\n  results &lt;- runTestTT $ TestList [test1, test2, test1]\n  if (errors results + failures results == 0)\n    then\n      exitWith ExitSuccess\n    else\n      exitWith (ExitFailure 1)\n</code></pre>\n\n<p>The <code>test-framework</code> package provides convenient <code>defaultMain</code> functions that do this sort of thing; you may want to consider that approach.</p>\n\n<p>You should note that the <code>exitcode-stdio-1.0</code> interface is considered semi-deprecated; the Cabal maintainers recommend switching to their rather more Haskellian <code>detailed-0.9</code> interface.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 1, "accepted_answer_id": 32914098, "answer_count": 1, "score": 11, "last_activity_date": 1578345052, "creation_date": 1443810532, "last_edit_date": 1578344970, "question_id": 32913552, "link": "https://stackoverflow.com/questions/32913552/why-does-my-hunit-test-suite-fail-but-pass-successfully-in-cabal", "title": "Why does my HUnit test suite fail but pass successfully in Cabal?", "body": "<p>If I have <code>test/Test.hs</code> with</p>\n\n<pre><code>module Main where\n\nimport Test.HUnit\n\ntest1 :: Test\ntest1 = TestCase $ assertEqual \"Should be one\" 1 5\n\ntest2 :: Test\ntest2 = TestCase $ assertEqual \"Shold both be zero\" 0 0\n\nmain :: IO Counts\nmain = runTestTT $ TestList [test1, test2, test1]\n</code></pre>\n\n<p>and a <code>.cabal</code> with</p>\n\n<pre><code>test-suite my-test\n    type:               exitcode-stdio-1.0\n    hs-source-dirs:     test\n    main-is:            Test.hs\n    build-depends:      base &gt;= 4.8.1.0 &amp;&amp; &lt;4.9,\n                        HUnit &gt;= 1.3\n    default-language:   Haskell2010\n</code></pre>\n\n<p>and I run <code>cabal test --show-details='always'</code> then I get</p>\n\n<pre><code>Test suite my-test: RUNNING...\n### Failure in: 0\ntest/Test.hs:6\nShould be one\nexpected: 1\n but got: 5\n### Failure in: 2\ntest/Test.hs:6\nShould be one\nexpected: 1\n but got: 5\nCases: 3  Tried: 3  Errors: 0  Failures: 2\nTest suite my-test: PASS\n</code></pre>\n\n<p>Why does my test suite pass when I've had failures? Likewise, if I <code>cabal sdist</code> I get no warning that my tests have failed.</p>\n"}, {"tags": ["function", "haskell", "recursion", "list-comprehension", "quickcheck"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1443810821, "post_id": 32913548, "comment_id": 53655103, "body": "Try both on an empty list."}, {"owner": {"reputation": 31, "user_id": 5402470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb3ea424b13e04eaa612233ac02d3dd?s=128&d=identicon&r=PG&f=1", "display_name": "JP7", "link": "https://stackoverflow.com/users/5402470/jp7"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1443811161, "post_id": 32913548, "comment_id": 53655268, "body": "Ok, that seems to have fixed it, thanks. I just added a line prior to capitalise xs saying: &quot;capitalise [] = []&quot;"}], "owner": {"reputation": 31, "user_id": 5402470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb3ea424b13e04eaa612233ac02d3dd?s=128&d=identicon&r=PG&f=1", "display_name": "JP7", "link": "https://stackoverflow.com/users/5402470/jp7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1443810513, "creation_date": 1443810513, "question_id": 32913548, "link": "https://stackoverflow.com/questions/32913548/haskell-functions-not-equivalent-but-they-are", "title": "Haskell functions not equivalent (but they are?)", "body": "<p>I have a piece of Haskell code which capitalises words appropriately. For example, it will take \"rObOT\" and change it to \"Robot\". One function is list comprehension, the other is recursive. Both seem to work exactly the same (according to all values I have passed through them) but despite this quickCheck claims that they are not equivalent and that they are falsifiable after 1 test.</p>\n\n<pre><code>-- List-comprehension version\ncapitalise :: String -&gt; String\ncapitalise xs = toUpper (head xs): [toLower x | x &lt;- tail xs]\n\n-- Recursive version\ncapitalFuncRec :: String -&gt; String\ncapitalFuncRec [] = []\ncapitalFuncRec (x:xs) = toLower(x) : capitalFuncRec xs\n\ncapitaliseRec :: String -&gt; String\ncapitaliseRec [] = []\ncapitaliseRec (x:xs) = (toUpper x) : capitalFuncRec xs\n\n-- Mutual test ---\nprop_capitalise :: String -&gt; Bool\nprop_capitalise xs = capitaliseRec xs == capitalise xs\n</code></pre>\n"}, {"tags": ["json", "haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1443809942, "post_id": 32912240, "comment_id": 53654657, "body": "One option is to use a custom <code>parseJSON</code> so the string interpretation is integrated. The aeson parser type is <i>monadic</i>, so there&#39;s no difficulty producing a parse error from a higher stratum. Instead of thinking about <code>.</code>, consider <code>=&lt;&lt;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1443809468, "post_id": 32913167, "comment_id": 53654440, "body": "close, but not quite. I would like it to be parameterized over <code>Text</code> and <code>a</code> (not <code>Maybe a</code>), so <code>Getter</code> doesn&#39;t seem to work. To be specific, if I used your <code>_Read</code> function as <code>mystery</code>, then the type of <code>v ^? key &quot;timespent&quot; . _String . mystery</code> (from my post) would be <code>Maybe (Maybe Double)</code>, but I would like it to be <code>Maybe Double</code>."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1443809553, "post_id": 32913167, "comment_id": 53654472, "body": "what about <code>_Read . traverse</code>?"}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1443809835, "post_id": 32913167, "comment_id": 53654614, "body": "I think that will work. What would the type of that be? Is it <code>Fold Text a</code>?"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1443810504, "post_id": 32913167, "comment_id": 53654933, "body": "according to GHCi it&#39;s a <code>Read a =&gt; Fold Text a</code>."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 2, "last_activity_date": 1443810414, "last_edit_date": 1443810414, "creation_date": 1443808988, "answer_id": 32913167, "question_id": 32912240, "link": "https://stackoverflow.com/questions/32912240/prism-traversal-or-fold-from-readmaybe/32913167#32913167", "title": "Prism, Traversal, or Fold from readMaybe", "body": "<p>I think what you want is a <a href=\"http://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Type.html#t:Getter\" rel=\"nofollow\">Getter</a>:</p>\n\n<pre><code>_Read :: Read a =&gt; Getter Text (Maybe a)\n_Read f = contramap g . f . g where g = readMaybe . unpack\n</code></pre>\n\n<p>In general, if you have <code>x :: a -&gt; b</code> then <code>\\f -&gt; contramap x . f . x</code> is a <code>Getter a b</code>.</p>\n\n<p>Then to get the <code>a</code> value out of the <code>Maybe a</code>, use <code>traverse</code>, so combined you have <code>_Read . traverse</code> which is a <code>Read a =&gt; Fold Text a</code>.</p>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 32913167, "answer_count": 1, "score": 3, "last_activity_date": 1443810824, "creation_date": 1443805347, "last_edit_date": 1443810824, "question_id": 32912240, "link": "https://stackoverflow.com/questions/32912240/prism-traversal-or-fold-from-readmaybe", "title": "Prism, Traversal, or Fold from readMaybe", "body": "<p>In working with lenses, I occasionally have the need for some basic text parsing in the chain of optics. In one API I'm dealing with, there is a JSON field like this:</p>\n\n<pre><code>\"timespent\": \"0.25\",\n</code></pre>\n\n<p>Since it is incorrectly encoded as a string instead of a number, I can't just do the typical <code>lens-aeson</code> solution:</p>\n\n<pre><code>v ^? key \"timespent\" . _Double -- this doesn't work\n</code></pre>\n\n<p>So, I need this instead:</p>\n\n<pre><code>v ^? key \"timespent\" . _String . mystery\n</code></pre>\n\n<p>where the <code>mystery</code> optic needs to turn <code>Text</code> into a <code>Double</code>. I know that <code>mystery</code> could be typed as follows:</p>\n\n<pre><code>mystery :: Prism' Text Double\n</code></pre>\n\n<p>And I could built this as follows:</p>\n\n<pre><code>mystery = prism' (pack . show) (readMaybe . unpack)\n</code></pre>\n\n<p>And technically, this function could have an even more general type signature with <code>Read</code> and <code>Show</code> constraints, but that's not really what my question is about. What I don't like is the <code>Prism</code> is really too strong for what I'm doing. Most of the time, I'm interested in parsing but not is rendering it back to a string. So, I need either a <code>Traversal</code> or a <code>Fold</code> but I'm not sure which one, and I'm not sure how to build them. When I look at the type signature of <code>^?</code> to find the minimum optic required, I see:</p>\n\n<pre><code>(^?) :: s -&gt; Getting (First a) s a -&gt; Maybe a\n</code></pre>\n\n<p>I can sort of understand what this means but not very well. So, to make my question clear, it is:</p>\n\n<p>If I have a function <code>f :: Text -&gt; Maybe a</code>, how can I turn this into a <code>Traversal</code> or a <code>Fold</code>? Thanks, and let me know if there is anything I can clarify.</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1444245671, "post_id": 32911567, "comment_id": 53826158, "body": "<i>[...] I want to get <code>&quot;abc&quot;</code> from <code>&quot;aabbccabc&quot;</code> [...]</i> What do you mean, exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "edited": false, "score": 0, "creation_date": 1443839162, "post_id": 32912678, "comment_id": 53664096, "body": "that works,but uses try ,which utilize backtracking. With large file will this be inefficent?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "edited": false, "score": 2, "creation_date": 1443841905, "post_id": 32912678, "comment_id": 53664446, "body": "I think you should explain why you want to use parsec to search for a string in a large file. Why parsec? Why not just <code>breakOn</code> from <code>Data.Text</code>?"}, {"owner": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "edited": false, "score": 0, "creation_date": 1443850762, "post_id": 32912678, "comment_id": 53665868, "body": "Because i may extend the parsing work to more complicated one,breakOn is a good suggestion"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1443807008, "creation_date": 1443807008, "answer_id": 32912678, "question_id": 32911567, "link": "https://stackoverflow.com/questions/32911567/find-substring-in-a-string-with-parsec/32912678#32912678", "title": "Find substring in a string with parsec", "body": "<p>You can do something like this:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n\nimport Text.Parsec\nimport Text.Parsec.Char\n\nfindSubString str = try (string str) &lt;|&gt; (anyChar *&gt; findSubString str)\n\nfoo = do\n  findSubString \"abc\"\n  findSubString \"def\"\n\ntest1 = parseTest foo \"this is abc\"         -- fails: expecting def\n\ntest2 = parseTest foo \"this is abc and de\"  -- fails: expecting def\n\ntest3 = parseTest foo \"this is abc and def\" -- succeeds\n</code></pre>\n"}], "owner": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 32912678, "answer_count": 1, "score": 2, "last_activity_date": 1444068444, "creation_date": 1443802825, "last_edit_date": 1444068444, "question_id": 32911567, "link": "https://stackoverflow.com/questions/32911567/find-substring-in-a-string-with-parsec", "title": "Find substring in a string with parsec", "body": "<p>For example, I want to get <code>\"abc\"</code> from <code>\"aabbccabc\"</code>, which should be easy with regex. But i want to use parsec. It seems that <code>try</code> can do that, but that must be quite inefficient...</p>\n\n<p>I tried:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Text.ParserCombinators.Parsec\nps pser txt = case (parse pser  \"\" txt ) of\n  Left e  -&gt; show e\n  Right v -&gt; v\n</code></pre>\n\n<p>and got the following result:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; ps (string \"asf\") \"  dsfdsasf\"\n\"(line 1, column 1):\\nunexpected \\\" \\\"\\nexpecting \\\"asf\\\"\"\n</code></pre>\n"}, {"tags": ["haskell", "asynchronous"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1443803555, "post_id": 32909794, "comment_id": 53651414, "body": "I think that they are semantically identical, but only because an <code>Async</code> moves monotonically from empty to full (or empty to <code>cancel</code>-ed) and the API enforces this. If you were dealing with <code>TVar</code>s they would be different because the former is in a single transaction, while the latter is two separate transactions."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1443804357, "post_id": 32909794, "comment_id": 53651822, "body": "(by &quot;the former/latter&quot; I mean your two implementations above)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1443835954, "post_id": 32909794, "comment_id": 53663560, "body": "For those who are wondering about the difference between <code>waitSTM left</code> and <code>waitSTM left `orElse` (waitSTM right &gt;&gt; retry)</code>: after staring at this for a while, I believe the difference is related to exceptions. If <code>left</code> retries, the former will <code>retry</code> whereas the latter will give <code>right</code> a chance to throw an exception before retrying."}], "owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1443797056, "creation_date": 1443797056, "question_id": 32909794, "link": "https://stackoverflow.com/questions/32909794/implementing-waitboth-function-in-the-async-library", "title": "Implementing `waitBoth` function in the `async` library", "body": "<p>I am currently going through the implementation of the <a href=\"https://hackage.haskell.org/package/async-2.0.2/docs/src/Control-Concurrent-Async.html\" rel=\"nofollow\">async</a> library (for self-studying purpose) and have a question regarding the <code>waitBoth</code> function.</p>\n\n<p>The library implements the function as follows:</p>\n\n<pre><code>waitBoth :: Async a -&gt; Async b -&gt; IO (a,b)\nwaitBoth left right =\n  atomically $ do\n    a &lt;- waitSTM left\n           `orElse`\n         (waitSTM right &gt;&gt; retry)\n    b &lt;- waitSTM right\n    return (a,b)\n</code></pre>\n\n<p>And I was wondering if I could implement the function in terms of the <code>waitEither</code> and <code>wait</code> functions:</p>\n\n<pre><code>{-# LANGUAGE LambdaCase        #-}\n{-# LANGUAGE TupleSections     #-}\n\nwaitBoth :: Async a -&gt; Async b -&gt; IO (a,b)\nwaitBoth a b =\n  waitEither a b &gt;&gt;= \\case\n    Left res  -&gt; (res,) &lt;$&gt; wait b\n    Right res -&gt; (,res) &lt;$&gt; wait a\n</code></pre>\n\n<p>Are these two versions exactly the same or is there any subtle semantical or performance differences?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1443797917, "post_id": 32909721, "comment_id": 53648153, "body": "I not sure the output is quite the same as the original. I think perhaps the <code>concat</code> would need to be <code>map (map concat)</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1443798209, "post_id": 32909721, "comment_id": 53648357, "body": "@ryachza: I don&#39;t know which function \u201cthe original\u201d is supposed to be. <code>all3x3blocks</code> certainly has another result \u2013 the 3&#215;3-blocks are represented as flat lists of length 9. I daresay it&#39;s trivial to get there from my solution."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1443798501, "post_id": 32909721, "comment_id": 53648565, "body": "Yes, I was referring to the <code>all3x3blocks</code> and the &quot;desired outcome&quot; section. I agree it is trivial for some (as my comment shows - a very minor change), but not necessarily for all, so I figured I would mention it in case a more direct comparison was preferred."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1443798717, "post_id": 32909721, "comment_id": 53648706, "body": "Actually, in fact I messed it up myself. It would actually need to be <code>concat . map (map concat)</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1443798824, "post_id": 32909721, "comment_id": 53648774, "body": "@ryachza or <code>map concat . concat</code>."}, {"owner": {"reputation": 155, "user_id": 1689857, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9de209bcd1983be3a19074516e1e171?s=128&d=identicon&r=PG", "display_name": "Pro9", "link": "https://stackoverflow.com/users/1689857/pro9"}, "edited": false, "score": 0, "creation_date": 1443799520, "post_id": 32909721, "comment_id": 53649191, "body": "Interesting solutions, I will try to integrate them, and I should really try to make my functions more general"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1443807349, "post_id": 32909721, "comment_id": 53653326, "body": "fyi - <code>splitsEach</code> is also known as <a href=\"https://hackage.haskell.org/package/split-0.2.2/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\"><b><code>chunksOf</code></b></a> in the <code>Data.List.Split</code> library"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1443798457, "last_edit_date": 1443798457, "creation_date": 1443796882, "answer_id": 32909721, "question_id": 32908793, "link": "https://stackoverflow.com/questions/32908793/transform-a-9x9-list-so-that-each-row-contains-the-3x3-block/32909721#32909721", "title": "Transform a 9x9 list so that each row contains the 3x3 block", "body": "<p>Essentially the same as you did, but I would write it as a pipeline:</p>\n\n<pre><code>sudokuClusters :: [[c]] -&gt; [ [[c]] ]   -- note this is polymorphic: no reason\nsudokuClusters =                       -- it should only work with `Maybe Int`!\n      concat              -- gather 3\u00d73-blocks from each triplet of rows\n    . map transpose       -- combine cell-triplets that were vertical neighbours\n    . splitsEach 3        -- partition rows\n    . map (splitsEach 3)  -- partition each row\n\nsplitsEach :: Int -&gt; [a] -&gt; [[a]]\nsplitsEach _ [] = []\nsplitsEach n l = firstSplit : splitsEach n rest\n where (firstSplit, rest) = splitAt n l\n</code></pre>\n\n<p>An interesting, more general solution would be:</p>\n\n<pre><code>recluster :: (\u2200 x . [x] -&gt; [[x]]) -&gt; [[c]] -&gt; [ [[c]] ]\nrecluster f = concatMap transpose . f . map f\n\nsudokuClusters = recluster (splitsEach 3)\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 1689857, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9de209bcd1983be3a19074516e1e171?s=128&d=identicon&r=PG", "display_name": "Pro9", "link": "https://stackoverflow.com/users/1689857/pro9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 32909721, "answer_count": 1, "score": 1, "last_activity_date": 1443798457, "creation_date": 1443794073, "question_id": 32908793, "link": "https://stackoverflow.com/questions/32908793/transform-a-9x9-list-so-that-each-row-contains-the-3x3-block", "title": "Transform a 9x9 list so that each row contains the 3x3 block", "body": "<p>This is my solution which works, but there probably is a better way to write this.</p>\n\n<p>Basically I have a list with 9 rows each containing 9 elements, representing a 9x9 sudoku as seen in the example. I want to tranform that list so that each row corresponds to the 3x3 blocks in a sudoku</p>\n\n<p>How can I improve this?</p>\n\n<pre><code>-- returns 9 rows that corresponds to the 3x3 blocks in a sudoku\n-- splits the list, transposes, concats, and then combines into 9 rows\nall3x3blocks :: [Block] -&gt; [Block] \nall3x3blocks b = combineList (concat (transpose (splitList b)))\n\n-- splits up each of the 9 rows into 3 parts with 3 elements in each\nsplitList :: [Block] -&gt; [[Block]]\nsplitList b = [mySplit 3 x | x &lt;- b ]\n\n-- splits a list into n sized lists\nmySplit :: Int -&gt; Block -&gt; [Block]\nmySplit _ [] = []\nmySplit n list = firstSplit : (mySplit n rest)\n  where\n    (firstSplit,rest) = splitAt n list\n\n-- combines a split row, by combining 3 parts into 1 row with 9 elements\ncombineList :: [Block] -&gt; [Block]\ncombineList [] = []\ncombineList list = concat(split) : combineList rest\n    where (split, rest) = splitAt 3 list\n\ntype Block = [Maybe Int]\n\nexample :: [Block]\nexample =\n    [ [Just 3, Just 6, Nothing,Nothing,Just 7, Just 1, Just 2, Nothing,Nothing]\n    , [Nothing,Just 5, Nothing,Nothing,Nothing,Nothing,Just 1, Just 8, Nothing]\n    , [Nothing,Nothing,Just 9, Just 2, Nothing,Just 4, Just 7, Nothing,Nothing]\n    , [Nothing,Nothing,Nothing,Nothing,Just 1, Just 3, Nothing,Just 2, Just 8]\n    , [Just 4, Nothing,Nothing,Just 5, Nothing,Just 2, Nothing,Nothing,Just 9]\n    , [Just 2, Just 7, Nothing,Just 4, Just 6, Nothing,Nothing,Nothing,Nothing]\n    , [Nothing,Nothing,Just 5, Just 3, Nothing,Just 8, Just 9, Nothing,Nothing]\n    , [Nothing,Just 8, Just 3, Nothing,Nothing,Nothing,Nothing,Just 6, Nothing]\n    , [Nothing,Nothing,Just 7, Just 6, Just 9, Nothing,Nothing,Just 4, Just 3]\n    ]\n\n-- Desired outcome after transformation\n[[Just 3,Just 6,Nothing,Nothing,Just 5,Nothing,Nothing,Nothing,Just 9]\n,[Nothing,Nothing,Nothing,Just 4,Nothing,Nothing,Just 2,Just 7,Nothing]\n,[Nothing,Nothing,Just 5,Nothing,Just 8,Just 3,Nothing,Nothing,Just 7]\n,[Nothing,Just 7,Just 1,Nothing,Nothing,Nothing,Just 2,Nothing,Just 4]\n,[Nothing,Just 1,Just 3,Just 5,Nothing,Just 2,Just 4,Just 6,Nothing]\n,[Just 3,Nothing,Just 8,Nothing,Nothing,Nothing,Just 6,Just 9,Nothing]\n,[Just 2,Nothing,Nothing,Just 1,Just 8,Nothing,Just 7,Nothing,Nothing]\n,[Nothing,Just 2,Just 8,Nothing,Nothing,Just 9,Nothing,Nothing,Nothing]\n,[Just 9,Nothing,Nothing,Nothing,Just 6,Nothing,Nothing,Just 4,Just 3]]\n</code></pre>\n"}, {"tags": ["haskell", "state-monad"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443814510, "post_id": 32909155, "comment_id": 53656991, "body": "<code>sequence . map f</code> is the same as <code>traverse f</code>, but the later has a more general type."}], "tags": [], "owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "is_accepted": false, "score": 5, "last_activity_date": 1443795195, "creation_date": 1443795195, "answer_id": 32909155, "question_id": 32908792, "link": "https://stackoverflow.com/questions/32908792/how-to-apply-stateful-computation-to-a-list/32909155#32909155", "title": "How to apply stateful computation to a list?", "body": "<p>The function you are looking for is <code>sequence</code>, which has the signature <code>sequence :: Monad m =&gt; [m a] -&gt; m [a]</code>, and is a very common pattern when dealing with monads like <code>State</code>.</p>\n\n<p>For your code, you would expect the evaluator to look like this:</p>\n\n<pre><code>evalBF :: String -&gt; State Int String\nevalBF = sequence . map eval\n</code></pre>\n\n<p>Which you would then fully evaluate with something like:</p>\n\n<pre><code>main :: IO ()\nmain = do\n       src &lt;- getLine\n       print $ runState (evalBF src) 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 346, "user_id": 630998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/959ac9c13950188523b5c51e1ed6ff43?s=128&d=identicon&r=PG", "display_name": "Rapha&#235;l Mor", "link": "https://stackoverflow.com/users/630998/rapha%c3%abl-mor"}, "edited": false, "score": 0, "creation_date": 1444390688, "post_id": 32909166, "comment_id": 53895403, "body": "works fine ! thanks ! Still have to get my head around many of the concepts."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 7, "last_activity_date": 1443795230, "creation_date": 1443795230, "answer_id": 32909166, "question_id": 32908792, "link": "https://stackoverflow.com/questions/32908792/how-to-apply-stateful-computation-to-a-list/32909166#32909166", "title": "How to apply stateful computation to a list?", "body": "<p>You can use <code>traverse_</code> from <code>Data.Foldable</code>:</p>\n\n<pre><code>import Data.Foldable (traverse_)\nexecState (traverse_ eval \"++++--\") 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1443798742, "creation_date": 1443798742, "answer_id": 32910365, "question_id": 32908792, "link": "https://stackoverflow.com/questions/32908792/how-to-apply-stateful-computation-to-a-list/32910365#32910365", "title": "How to apply stateful computation to a list?", "body": "<p>An ugly solution but using the fold that you correctly suspected was applicable.</p>\n\n<pre><code>import Control.Monad.Trans.State\n\nprogram = \"++++--\"\n\neval :: Char -&gt; State Int Char\neval '+' = do\n    x &lt;- get\n    put (x + 1)\n    return 'I'\neval '-' = do\n    x &lt;- get\n    put (x - 1)\n    return 'D'\n\nevalList :: [Char] -&gt; State Int Char\nevalList = foldl (\\s c -&gt; (s &gt;&gt; eval c)) (return ' ')\n\nmain = putStrLn $ show $ runState (evalList program) 0\n</code></pre>\n"}], "owner": {"reputation": 346, "user_id": 630998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/959ac9c13950188523b5c51e1ed6ff43?s=128&d=identicon&r=PG", "display_name": "Rapha&#235;l Mor", "link": "https://stackoverflow.com/users/630998/rapha%c3%abl-mor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 32909166, "answer_count": 3, "score": 1, "last_activity_date": 1443798742, "creation_date": 1443794073, "last_edit_date": 1443795680, "question_id": 32908792, "link": "https://stackoverflow.com/questions/32908792/how-to-apply-stateful-computation-to-a-list", "title": "How to apply stateful computation to a list?", "body": "<p>Let's imagine a dummy subset of Brainf*ck: </p>\n\n<p><code>+</code> increments the counter</p>\n\n<p><code>-</code> decrements the counter</p>\n\n<p>A simple program:</p>\n\n<p><code>program = \"++++--\" -- should evaluate to 2</code></p>\n\n<p>And a stateful evaluation function:</p>\n\n<pre><code>eval :: Char -&gt; State Int Char\neval '+' = do x &lt;- get\n              put (x + 1)\n              return 'I'\neval '-' = do x &lt;- get\n              put (x - 1)\n              return 'D'\n</code></pre>\n\n<p>How would you evaluate the program?\n(Looks like a <code>fold</code> to me but can't get my head around it, and it doesn't feel like it's the way to do it properly...)</p>\n"}, {"tags": ["haskell", "module", "cabal", "stackage"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1443793291, "post_id": 32908437, "comment_id": 53644850, "body": "I&#39;ve read the whole documentation for Stack and some Cabal tutorials. Now I know about many features, but I still don&#39;t know how the directory trees are supposed to be organized. Do I need one directory for stack and multiple subdirectories for projects, each one with a <code>.cabal</code> file? Or what instead? How I can link import local projects from eachother? A hope solid example can clarify those and other questions."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443793739, "post_id": 32908437, "comment_id": 53645162, "body": "Stack/Stackage is nice. has commercial backing and everything."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1443796034, "post_id": 32908437, "comment_id": 53646827, "body": "On my mobile without much time, but you&#39;ve got the right idea. One subdirectory per library, each with a cabal file, and reference each dir from the stack.yaml file. The wai repo provides a solid example of this"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1443796653, "post_id": 32908437, "comment_id": 53647271, "body": "Ah, that helps a lot. The only confusion left is the definition of &quot;project&quot;, since wai is a single thing. Specifically, mind those two designs: 1. A single <code>.yaml</code> for all my personal packages. Example: <code>Viclib&#47;viclib.yaml</code>, <code>Viclib&#47;grid&#47;grid.cabal</code>, <code>Viclib&#47;bsp&#47;bsp.cabal</code>. 2. One <code>.yaml</code> for each package, even if single file. Example: <code>Viclib&#47;grid&#47;grid.yaml</code>, <code>Viclib&#47;grid&#47;grid&#47;grid.cabal</code>, <code>Viclib&#47;bsp&#47;bsp.yaml</code>, <code>Viclib&#47;bsp&#47;bsp&#47;bsp.cabal</code>. What is the correct way? Looks like the second, but then how do I import <code>grid</code> from <code>bsp</code>, for example?"}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1443805426, "post_id": 32910861, "comment_id": 53652414, "body": "Woops. I should&#39;ve compiled the program before posting the question. Sorry about that. This looks reasonable to me, I&#39;ll wait more upvotes as a sign of consensus. Thank you."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443838511, "post_id": 32910861, "comment_id": 53663993, "body": "Personally, I would recommend having <code>lib</code> and <code>bin</code> directories (or similar) under <code>hypotenuse</code>. This way you can use <code>hs-source-dirs</code> to make sure that the <code>Hypotenuse</code> module you import in the executable comes from the <code>hypotenuse</code> package rather than from the local <code>Hypotenuse.hs</code>, which cuts down on compile time."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1443853251, "post_id": 32910861, "comment_id": 53666366, "body": "@DanielWagner: I&#39;m not sure I understand. I normally have my code in a <code>src&#47;</code> dir just for the organization. If you import <code>Hypotenuse</code> from <code>Hypotenuse.hs</code> it is only compiled if you change it, right? And the same holds if you import it from a package in stack? What is the conceptual difference between importing from <code>hypotenuse</code> or <code>Hypotenuse.hs</code>?"}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 0, "creation_date": 1443853339, "post_id": 32910861, "comment_id": 53666386, "body": "By the way I&#39;m still hoping someone will post a more complete answer (including the Hackage/Stackage part). Of course that should become the accepted answer then."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1443853767, "post_id": 32910861, "comment_id": 53666480, "body": "@SamvanHerwaarden If you have all the files in the same directory, and change <code>Hypotenuse.hs</code>, it will be rebuilt twice: once for the library, and once for the executable. If you put the library in its own directory that is invisible to the executable, it will be rebuilt only once while rebuilding the library, then the library will be used in the executable."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1445535323, "post_id": 32910861, "comment_id": 54374329, "body": "@DanielWagner do you mean a &quot;bin&quot; dir with <code>.hs</code> files?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1445538442, "post_id": 32910861, "comment_id": 54376134, "body": "@Viclib One standard layout is to have a <code>bin</code> directory for executables and a <code>lib</code> directory for libraries, yes. The important core thing is that the library&#39;s files be in a directory that is listed in <code>hs-source-dirs</code> for the library section but not the executable section(s)."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1445705805, "post_id": 32910861, "comment_id": 54439458, "body": "Thanks - is there anything wrong in having a top level directory with a <code>stack.yaml</code> file, and many directories inside it including <code>.cabal</code> files?"}], "tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": true, "score": 4, "last_activity_date": 1443800403, "creation_date": 1443800403, "answer_id": 32910861, "question_id": 32908437, "link": "https://stackoverflow.com/questions/32908437/what-is-the-up-to-date-standard-workflow-for-building-haskell-projects/32910861#32910861", "title": "What is the up-to-date standard workflow for building Haskell projects?", "body": "<p>This is not a complete answer, it does not start with your <code>OrganizeMe</code> directories (there are some errors in your code) and it does not include publishing to Hackage/Stackage. I start with a directory <code>stackenv</code> to contain both packages but you could do this quite differently of course.</p>\n\n<pre><code>mkdir stackenv &amp;&amp; cd stackenv/\nmkdir square &amp;&amp; cd square\nvim Square.hs # The file you describe without the x in the type of square\ncabal init # Go through the questions and choose \"library\"\nstack init\ncd ../ &amp;&amp; mkdir hypotenuse &amp;&amp; cd hypotenuse/\nvim Hypotenuse.hs # The file you describe\nvim Main.hs # The file you describe but importing Hypotenuse\ncabal init # Go through the questions... \"executable\" this time\nstack init\nvim hypotenuse.cabal # add \"square\" or chosen package name to build-depends\nvim stack.yaml # add \"- '../square/'\" below packages\nstack install\nhypotenuse 3 4 # works because ~/.local/bin is in my PATH\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 4, "accepted_answer_id": 32910861, "answer_count": 1, "score": 10, "last_activity_date": 1443805479, "creation_date": 1443793055, "last_edit_date": 1443805479, "question_id": 32908437, "link": "https://stackoverflow.com/questions/32908437/what-is-the-up-to-date-standard-workflow-for-building-haskell-projects", "title": "What is the up-to-date standard workflow for building Haskell projects?", "body": "<p>Since things change so fast, I've posted this question so hopefully the community-agreed way to start a Haskell project can be clarified. Imagine I have two separate projects:</p>\n\n<ul>\n<li><p><strong>Project #1</strong>: Square, the library that squares numbers. No deps.</p>\n\n<pre><code>-- Square.hs\n\nmodule Square where\n\nsquare :: Num a =&gt; a -&gt; a\nsquare x = x * x\n</code></pre></li>\n<li><p><strong>Project #2</strong>: Hypotenuse, the library and executable that finds the longest side of a right-angled triangle. Depends on #1:</p>\n\n<pre><code>-- Hypotenuse.hs\n\nmodule Hypotenuse where\n\nimport Square\n\nhypotenuse :: Floating a =&gt; a -&gt; a -&gt; a\nhypotenuse x y = sqrt $ square x + square y\n</code></pre>\n\n<p>,</p>\n\n<pre><code>-- Main.hs\n\nimport System.Environment\nimport Hypotenuse\n\nmain = do\n    [x,y] &lt;- fmap (map read) getArgs\n    print $ hypotenuse x y\n</code></pre></li>\n</ul>\n\n<p>Starting with a computer with GHC 7.10.2, Stack and Cabal installed, and a single directory, <code>~/OrganizeMe</code>, containing <code>~/OrganizeMe/Square.hs</code>, <code>~/OrganizeMe/Hypotenuse.hs</code> and <code>~/OrganizeMe/Main.hs</code>, as presented above - <strong>what is a complete set of unix commands an experienced Haskeller would use to architect those projects?</strong> That includes:</p>\n\n<ol>\n<li><p>Organizing the directory tree of those projects;</p></li>\n<li><p>configuring <code>Stack</code>/<code>Cabal</code>/<code>etc</code> (and <code>git</code>, optionally);</p></li>\n<li><p>building/installing them locally;</p></li>\n<li><p>publishing to <code>Hackage</code>/<code>Stackage</code>.</p></li>\n</ol>\n"}, {"tags": ["performance", "haskell", "recursion", "random"], "answers": [{"tags": [], "owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "is_accepted": true, "score": 4, "last_activity_date": 1443795249, "creation_date": 1443795249, "answer_id": 32909173, "question_id": 32907961, "link": "https://stackoverflow.com/questions/32907961/haskell-how-to-improve-performance-of-deep-recursion-and-random-number-generati/32909173#32909173", "title": "Haskell: How to improve performance of deep recursion and random number generation", "body": "<p>Yes, the <a href=\"http://hackage.haskell.org/package/random\" rel=\"nofollow\"><code>random</code></a> library is very slow. <code>randomRIO</code> isn't ideal in this situation but using other functions <code>random</code> won't help much with the speed. There are several alternatives, Bryan O'Sullivan <a href=\"http://hackage.haskell.org/package/mwc-random\" rel=\"nofollow\"><code>mwc-random</code></a> is the most popular but there's also Don Stewart's <a href=\"https://hackage.haskell.org/package/mersenne-random\" rel=\"nofollow\"><code>mersenne-random</code></a> and my own <a href=\"http://hackage.haskell.org/package/pcg-random\" rel=\"nofollow\"><code>pcg-random</code></a>. Also note that C's <code>rand</code> isn't a particularly good random number generator.</p>\n\n<p>Here's a similar <code>mwc-random</code> version of your code that runs in 2.3s on my machine (ghc-7.10.2, with <code>-O2 -fllvm</code>)</p>\n\n<pre><code>import Control.Monad.ST\nimport qualified System.Random.MWC as MWC\nimport Data.Int\n\ns :: Int32 -&gt; Int32 -&gt; Int32\ns n s = runST $ do\n  g &lt;- MWC.create\n\n  let go 0  !a = pure a\n      go !i !a = do\n        w &lt;- MWC.uniformR (0, maxBound::Int32) g\n        go (i-1) (a + w)\n\n  go n s\n\nmain :: IO ()\nmain = print $ s' 100000000 0\n</code></pre>\n\n<p>The equivalent code using <code>System.Random.PCG</code> runs in 1s for me. And on the experimental fast pure pcg code it can run in 0.28s:</p>\n\n<pre><code>import System.Random.PCG.Fast.Pure\n\ns :: Int32\ns = go (100000000::Word64) 0xcafef00dd15ea5e5 0\n  where\n  go 0   _ a = a\n  go !i !s a = go (i-1) s' (a + fromIntegral r)\n    where P s' r = bounded 2147483647 s\n\nmain = print s\n</code></pre>\n\n<p>So Haskell's certainly capable of fast random number generation.</p>\n"}], "owner": {"reputation": 15, "user_id": 5401191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98aea1f5780967edad3a8d06ef62f76?s=128&d=identicon&r=PG&f=1", "display_name": "Joule", "link": "https://stackoverflow.com/users/5401191/joule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 32909173, "answer_count": 1, "score": 0, "last_activity_date": 1443795249, "creation_date": 1443791493, "question_id": 32907961, "link": "https://stackoverflow.com/questions/32907961/haskell-how-to-improve-performance-of-deep-recursion-and-random-number-generati", "title": "Haskell: How to improve performance of deep recursion and random number generation", "body": "<p>The problem of interest is to enhance the following Haskell program with a recursion depth of 100,000,000 by making it faster:</p>\n\n<pre><code>s :: Int32 -&gt; Int32 -&gt; IO Int32\ns 0 acc = return $! acc\ns n acc = do r &lt;- randomRIO (0, maxBound :: Int32)\n             s (n-1) $! (acc + r)\n\nmain = do z &lt;- s 100000000 0\n          putStrLn $ show z\n</code></pre>\n\n<p>This program takes about 70 seconds on my machine.\nHowever, a corresponding C program takes only one second:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;    \n\nint main(){\n    double startTime;\n    double timeEllapsed;\n    unsigned int sum;\n    long long i;    \n\n    startTime = clock();\n    srand(time(NULL));    \n\n    sum = 0;\n    i = 0;\n    for(i=0; i&lt;100000000;i++){\n      sum += rand();\n    }    \n\n    timeEllapsed = (clock() - startTime) / (CLOCKS_PER_SEC);    \n\n    printf(\"sum = %u, time ellapsed = %lfs\\n\", sum, timeEllapsed);    \n\n    return EXIT_SUCCESS;    \n}\n</code></pre>\n\n<p>Where does this difference come from? Is the implementation of random numbers in the Haskell standard library slower? Or should you use a function different from randomRIO? Or has it to do with lazy evaluation?\nCan you optimize anything on the Haskell program and make it faster?</p>\n\n<p>It's clear that there might be performance differences between a very high level language like Haskell and C, but I did not expect it to be in the order of ~70 times slower, so I wonder about the causes.</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443794187, "post_id": 32907671, "comment_id": 53645502, "body": "seems like overengineering to use <code>Data.Monoid</code> for such a trivial, isolated, concrete task... especially if all it&#39;s about is the extraneous <code>deriving</code> clause."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443805225, "post_id": 32907671, "comment_id": 53652325, "body": "in this case I have to disagree - well not entirely if you can derive the <code>Ord</code> instance without problems, it is the easiest method - but the question was - for a more complicated data-structure, thus I gave advice on creating an <code>Ord</code> instance on your own. One use-case where I ran into problems when I had an infinite list in my data-structure, which lead to an infinite calculation when the data structures were the same, thus I had to craft the <code>Eq</code> and <code>Ord</code> instance by hand. And I have to admit that I simply overlooked the deriving clause, as no error message was provided."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1443791538, "last_edit_date": 1443791538, "creation_date": 1443790557, "answer_id": 32907671, "question_id": 32907458, "link": "https://stackoverflow.com/questions/32907458/defining-a-special-ord-for-a-data-type-in-haskell/32907671#32907671", "title": "Defining a special Ord for a data type in haskell", "body": "<p>One helpful thing for <code>Ord</code> is its instance of <code>Monoid</code> so you can combine your case like this</p>\n\n<pre><code>instance Ord Coordinate where\n    compare (Coord x1 x2) (Coord y1 y2) = (compare x1 y1) &lt;&gt; (compare x2 y2)\n</code></pre>\n\n<p>you might need to <code>import Data.Monoid</code> in order to have <code>(&lt;&gt;)</code> at your hands.\nThis \"trick\" enables you to abstract the traversing/if-then-elsing/recursing over your data structure from the actual operation of comparing the sub results.</p>\n\n<p>If you tell me what your datatype is - I could (maybe) give you more concrete hints how to do this.</p>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p>A bit more explanation on the <code>Monoid</code> thing:</p>\n\n<p>A Monoid is a datastructure that has an (<a href=\"https://en.wikipedia.org/wiki/Associative_property\" rel=\"nofollow\">associative</a>) operation <code>&lt;&gt;</code> that allows you to combine  two datastructures and a neutral element <code>mempty</code> that has the following property:</p>\n\n<pre><code> x &lt;&gt; mempty = x\n mempty &lt;&gt; x = x\n</code></pre>\n\n<p>the easiest example you can think of is your data structure being the good old list <code>[a]</code> then where the combination operator is just concatenation of lists <code>(&lt;&gt;) = (++)</code> and the neutral element is the empty list <code>mempty = []</code>.</p>\n\n<p>For the <code>Ord</code> the combination is slightly more complicated - <code>compare</code> yields something of type <code>Ordering</code> which is just one of <code>EQ|LT|GT</code> so we have to define two things for it to be a <code>Monoid</code></p>\n\n<pre><code> mempty = EQ\n LT &lt;&gt; _ = LT\n GT &lt;&gt; _ = GT\n EQ &lt;&gt; x = x\n</code></pre>\n\n<p><code>Monoid</code>s are a quite convenient way of abstracting things so they are a neat trick to have up your sleeve.</p>\n"}, {"tags": [], "owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "is_accepted": false, "score": 0, "last_activity_date": 1443790628, "creation_date": 1443790628, "answer_id": 32907693, "question_id": 32907458, "link": "https://stackoverflow.com/questions/32907458/defining-a-special-ord-for-a-data-type-in-haskell/32907693#32907693", "title": "Defining a special Ord for a data type in haskell", "body": "<p>You can define an instance of a typeclass with any functions you like (that have the correct signature).</p>\n\n<p>As an example:</p>\n\n<pre><code>newtype LexInt = LexInt [Int] -- ints in reverse digit order\ninstance Eq LexInt where\n    (==) (LexInt (l:ls)) (LexInt (r:rs)) = (l == r) &amp;&amp; ((LexInt ls) == (LexInt rs))\n    (==) (LexInt []) (LexInt []) = True\n    (==) _ _ = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8276, "user_id": 327038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e17117063f64ef47f36ab4ee45bf3d4b?s=128&d=identicon&r=PG", "display_name": "asthasr", "link": "https://stackoverflow.com/users/327038/asthasr"}, "is_accepted": false, "score": 3, "last_activity_date": 1443791186, "last_edit_date": 1443791186, "creation_date": 1443790752, "answer_id": 32907720, "question_id": 32907458, "link": "https://stackoverflow.com/questions/32907458/defining-a-special-ord-for-a-data-type-in-haskell/32907720#32907720", "title": "Defining a special Ord for a data type in haskell", "body": "<p>I think your real issue is that you've used <code>deriving (Eq, Ord)</code>, which implies that you already have a derived typeclass instance for <code>Ord</code>.  If you remove that and use your comparison, it seems fine:</p>\n\n<pre><code>data Cord = Cord { x :: Int, y :: Int }\n  deriving (Eq, Show)\n\ninstance Ord Cord where\n  compare (Cord a b) (Cord c d) = if a == c then compare b d else compare a c   \n</code></pre>\n\n<p>In GHCI:</p>\n\n<pre><code>*Main&gt; compare (Cord 4 2) (Cord 9 6)\nLT\n*Main&gt; compare (Cord 3 2) (Cord 3 0)\nGT\n*Main&gt; compare (Cord 2 2) (Cord 2 2)\nEQ\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5401331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b55a28b6e9e9520d3ca4e90d82abf0a2?s=128&d=identicon&r=PG&f=1", "display_name": "Kiss P&#233;ter", "link": "https://stackoverflow.com/users/5401331/kiss-p%c3%a9ter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1443791538, "creation_date": 1443789840, "last_edit_date": 1443790109, "question_id": 32907458, "link": "https://stackoverflow.com/questions/32907458/defining-a-special-ord-for-a-data-type-in-haskell", "title": "Defining a special Ord for a data type in haskell", "body": "<p>I just couldn't find out how can I implement a special ord for my datatypes in haskell. I read on the forum, that it should look somewhat like this:</p>\n\n<pre><code>import Data.Set\n\ndata Cord = Cord { x :: Int\n                 , y :: Int} deriving (Eq,Ord)\n\ninstance Eq Cord where\n    (Cord a b) == (Cord a b) = (a==c and b==d) \n\ninstance Ord Cord where\n    compare (Cord a b) (Cord c d) = if a==c then compare (b d) else compare(a c)\n</code></pre>\n\n<p>I want to create a simple type with 2 integers, and one is larger then the other if his first number is larger then the other ones first number, or the second ones if the firsts are equal. I know that this comparison can be done by creating lists of 2 integers, however i wan't to some lot more complex data types and can't find anywhere a guide how to define an ord with if-s and recursions.</p>\n\n<p>Thank you for your anwser!</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1443795072, "post_id": 32907594, "comment_id": 53646144, "body": "if define custom type, it is not tuple any more. is it possible to count tuple directly? moreover, how to union b1 and b2 in above case? how to use this custom type?"}, {"owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1443795503, "post_id": 32907594, "comment_id": 53646433, "body": "countnest (ConsPair (ConsPair (ConsLeaf 1) (ConsLeaf 2)) (ConsLeaf 3)) i know how to use now"}, {"owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "reply_to_user": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1443795694, "post_id": 32907594, "comment_id": 53646569, "body": "Do you mean &quot;union&quot; is concatenate? ((1,2),3) -&gt; [1,2,3] ?"}, {"owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1443795989, "post_id": 32907594, "comment_id": 53646788, "body": "got some difficulty when change to this data Expr = A | B | C | D | S | M2 | M1 | MM1 deriving (Show) data NestType = ConsLeaf Expr | ConsPair NestType NestType let cartProd xs ys = [(ConsPair (ConsLeaf x),(ConsLeaf y)) | x &lt;- xs, y &lt;- ys] let m2 = (cartProd (cartProd (cartProd [(ConsLeaf A), (ConsLeaf S)] [(ConsLeaf B),(ConsLeaf M2)]) [(ConsLeaf C),(ConsLeaf M1)]) [(ConsLeaf D)])"}, {"owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1443796090, "post_id": 32907594, "comment_id": 53646861, "body": "union is concatenate [((1,2),3)]  [((4,5),6)] to [((1,2),3), ((4,5),6)]"}, {"owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "reply_to_user": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1443796316, "post_id": 32907594, "comment_id": 53647031, "body": "then it is just ConsPair."}, {"owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "reply_to_user": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1443796386, "post_id": 32907594, "comment_id": 53647090, "body": "And if you want tuples exactly, try     data NestType = ConsLeaf Int | ConsPair (NestType, NestType)"}], "tags": [], "owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "is_accepted": true, "score": 0, "last_activity_date": 1443790271, "creation_date": 1443790271, "answer_id": 32907594, "question_id": 32907157, "link": "https://stackoverflow.com/questions/32907157/how-to-count-the-number-of-nested-in-tuples-and-how-to-union-this-list-of-tuples/32907594#32907594", "title": "how to count the number of nested in tuples and how to union this list of tuples", "body": "<pre><code>countnest :: (Int,Int) -&gt; Int\ncountnest ((a1,a2), (b1,b2)) = ...\n</code></pre>\n\n<p>Function definition here is inconsistent with declaration. But it is not just a mistake: the thing you calling \"tuple\" is actually a tree, so you probably need a code like this instead:</p>\n\n<pre><code>data NestType = ConsLeaf Int | ConsPair NestType NestType\n\ncountnest :: NestType -&gt; Int\ncountnest (ConsLeaf _) = 1\ncountnest (ConsPair x y) = max (countnest x) (countnest y) +1\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 32907594, "answer_count": 1, "score": 0, "last_activity_date": 1443790271, "creation_date": 1443788797, "question_id": 32907157, "link": "https://stackoverflow.com/questions/32907157/how-to-count-the-number-of-nested-in-tuples-and-how-to-union-this-list-of-tuples", "title": "how to count the number of nested in tuples and how to union this list of tuples", "body": "<p>1.how to count the number of nested in tuples</p>\n\n<p>2.got error when union, even if number of nested are the same, how to union this list of tuples?</p>\n\n<p>error:</p>\n\n<pre><code>&lt;interactive&gt;:13:1:\n    No instance for (Eq Expr) arising from a use of `union'\n    Possible fix: add an instance declaration for (Eq Expr)\n    In the expression: union b1 b2\n    In an equation for `it': it = union b1 b2\n</code></pre>\n\n<p>haskell code:</p>\n\n<pre><code>countnest :: (Int,Int) -&gt; Int\ncountnest ((a1,a2), (b1,b2)) = max (max ((countnest (fst (a1,a2)))+1) ((countnest (snd (a1,a2)))+1)) (max ((countnest (fst (b1,b2)))+1) ((countnest (snd (b1,b2)))+1))\ncountnest (a1, (b1,b2)) = max 0 (max ((countnest (fst (b1,b2)))+1) ((countnest (snd (b1,b2)))+1))\ncountnest ((a1,a2), b1) = max (max ((countnest (fst (a1,a2)))+1) ((countnest (snd (a1,a2)))+1)) 0\ncountnest (a1, a2) = 1\ncountnest a1 = 1\n\nrotate :: Int -&gt; [a] -&gt; [a]\nrotate _ [] = []\nrotate n xs = zipWith const (drop n (cycle xs)) xs\n\nrev2 :: [a] -&gt; [a]\nrev2 (x:[]) = [x]\nrev2 (x:xs) = rev xs ++ [x]\n\nflatten1 :: [[a]] -&gt; [a]\nflatten1 xss = foldr (++) [] xss\n\ngetUniqueOrder :: (Ord a) =&gt; [[a]] -&gt; [[a]]\ngetUniqueOrder xs = nub ( map sort xs)\n\ngetUnique :: (Ord a) =&gt; [[a]] -&gt; [[a]]\ngetUnique xs = nub (xs)\n\ndata Expr = A | B | C | D | S | M2 | M1 | MM1 deriving (Show)\nlet cartProd xs ys = [(x,y) | x &lt;- xs, y &lt;- ys]\nlet m1 = cartProd [A,S] [B,M2]\nlet m2 = (cartProd (cartProd (cartProd [A,S] [B,M2]) [C,M1]) [D])  \nlet m3 = m2 ++ [(((S,MM1),MM1),MM1)]\n\nlet a1 = m3\nlet b1 = [rotate y a1 | y &lt;- [0..(length a1 -1)]]\nlet a2 = rev a1\nlet b2 = [rotate y a2 | y &lt;- [0..(length a2 -1)]]\nunion b1 b2\n</code></pre>\n\n<p>when compile countnest got error, after tried many times, still can not \nfind where is wrong, already match pattern</p>\n\n<pre><code>*Main&gt; :l oo.hs\n[1 of 1] Compiling Main             ( oo.hs, interpreted )\n\noo.hs:140:12:\n    Couldn't match expected type `Int'\n                with actual type `((Int, Int), (Int, Int))'\n    In the pattern: (a1, a2)\n    In the pattern: ((a1, a2), (b1, b2))\n    In an equation for `countnest':\n        countnest ((a1, a2), (b1, b2))\n          = max\n              (max\n                 ((countnest (fst (a1, a2))) + 1) ((countnest (snd (a1, a2))) + 1))\n              (max\n                 ((countnest (fst (b1, b2))) + 1) ((countnest (snd (b1, b2))) + 1))\n\noo.hs:140:21:\n    Couldn't match expected type `Int'\n                with actual type `((Int, Int), (Int, Int))'\n    In the pattern: (b1, b2)\n    In the pattern: ((a1, a2), (b1, b2))\n    In an equation for `countnest':\n        countnest ((a1, a2), (b1, b2))\n          = max\n              (max\n                 ((countnest (fst (a1, a2))) + 1) ((countnest (snd (a1, a2))) + 1))\n              (max\n                 ((countnest (fst (b1, b2))) + 1) ((countnest (snd (b1, b2))) + 1))\n</code></pre>\n"}, {"tags": ["haskell", "gtk2hs"], "comments": [{"owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "edited": false, "score": 0, "creation_date": 1444550921, "post_id": 32907101, "comment_id": 53944832, "body": "i return false solved this"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444554702, "post_id": 32907101, "comment_id": 53945674, "body": "then please close this or add your solution as an answer"}, {"owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444671305, "post_id": 32907101, "comment_id": 53990336, "body": "i change to another useful question instead of easy question"}], "owner": {"reputation": 380, "user_id": 961473, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62defec67888f9d19543c77e25d38b30?s=128&d=identicon&r=PG", "display_name": "M-Askman", "link": "https://stackoverflow.com/users/961473/m-askman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444671279, "creation_date": 1443788595, "last_edit_date": 1495541197, "question_id": 32907101, "link": "https://stackoverflow.com/questions/32907101/how-to-dynamic-to-add-widget-to-window-such-as-increase-number-of-vbox-in-gtk2hs", "title": "how to dynamic to add widget to window such as increase number of vbox in gtk2hs and how to add opengl as a widget in gtk2hs window", "body": "<ol>\n<li>i search Data.Dynamic</li>\n</ol>\n\n<p>how to make use of it to dynamic add widget to increase  </p>\n\n<pre><code>bgBac1 &lt;- imageNewFromFile \"example1_big.png\"\nrow0  &lt;- hBoxNew False 2\nboxPackStart row0 bgBac1 PackNatural 0\n</code></pre>\n\n<ol start=\"2\">\n<li>how to add opengl as a widget in gtk2hs window ?\nafter search it need GtkGLext, but i have installation problem,\ni search this method, however the createwindow is not a widget can not be added to vbox\n<a href=\"https://stackoverflow.com/questions/9548816/programming-in-haskell-via-opengl-and-glut\">Programming in Haskell via Opengl and GLUT</a></li>\n</ol>\n"}, {"tags": ["haskell", "cabal", "ihaskell"], "answers": [{"tags": [], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "is_accepted": true, "score": 1, "last_activity_date": 1444669290, "creation_date": 1444669290, "answer_id": 33086508, "question_id": 32907067, "link": "https://stackoverflow.com/questions/32907067/unable-to-import-haskell-packages-in-the-user-package-database/33086508#33086508", "title": "Unable to import Haskell packages in the &quot;user&quot; package database", "body": "<p>This is <a href=\"https://github.com/gibiansky/IHaskell/issues/581#issuecomment-145932645\" rel=\"nofollow\">an error specific to IHaskell</a>, which will be addressed in a future release.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 33086508, "answer_count": 1, "score": 1, "last_activity_date": 1444669305, "creation_date": 1443788491, "last_edit_date": 1444669305, "question_id": 32907067, "link": "https://stackoverflow.com/questions/32907067/unable-to-import-haskell-packages-in-the-user-package-database", "title": "Unable to import Haskell packages in the &quot;user&quot; package database", "body": "<p>Is there something I need to do to enable import of Haskell packages from the <code>user</code> package database?</p>\n\n<p>While most apps and tools on my system (GHC, GHCi, Cabal, Stack, my IDE, etc.) seem to be aware of both the <code>global</code> and <code>user</code> package databases by default. Ask least some \u2014 <a href=\"https://github.com/gibiansky/IHaskell/issues/581\" rel=\"nofollow\">e.g., IHaskell</a> \u2014 is unable to import any packages in my <code>user</code> package database.</p>\n\n<p>Is there something I can do globally to my Haskell/GHC installation so that my <code>user</code> packages are visible to all Haskell tools and applications I install?</p>\n\n<hr>\n\n<p>I'm using Homebrew Haskell on OS X 10.11, and have the package databases in the standard locations:</p>\n\n<pre><code>/usr/local/Cellar/ghc/7.10.2/lib/ghc-7.10.2/package.conf.d\n</code></pre>\n\n<p>and</p>\n\n<pre><code>/Users/Rax/.ghc/x86_64-darwin-7.10.2/package.conf.d\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1443785883, "post_id": 32906139, "comment_id": 53640565, "body": "What are you looking for? May be <a href=\"https://hackage.haskell.org/package/aws-lambda\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/aws-lambda</a>"}, {"owner": {"reputation": 3278, "user_id": 1054808, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/efba8ca1758acda2032c79b9ff4cd60b?s=128&d=identicon&r=PG", "display_name": "J Fritsch", "link": "https://stackoverflow.com/users/1054808/j-fritsch"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1443786497, "post_id": 32906139, "comment_id": 53640883, "body": "I look for some guidance how to put the execution of arbitrary functions in Haskell without a main function in practice. The Haskell aws-lambda package is a wrapper for the AWS API so that you can execute / trigger lambda functions within your haskell function."}, {"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1443787079, "post_id": 32906139, "comment_id": 53641190, "body": "I think you must to clarify what you want to do (write some AWS Lambda function using Haskell language is not possible) and, strictly, any program need the <code>main</code> function to work (although that function run into some service server). Do you want write AWS Lambda functions using Haskell? Then take a look to Amazon Linux..."}, {"owner": {"reputation": 3278, "user_id": 1054808, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/efba8ca1758acda2032c79b9ff4cd60b?s=128&d=identicon&r=PG", "display_name": "J Fritsch", "link": "https://stackoverflow.com/users/1054808/j-fritsch"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1443787396, "post_id": 32906139, "comment_id": 53641357, "body": "Added a clarification. Hope this helps. I think if you have worked w AWS lambda it gets clear what look &amp; feel I want to reproduce."}], "answers": [{"tags": [], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "is_accepted": false, "score": 1, "last_activity_date": 1443790097, "last_edit_date": 1495540503, "creation_date": 1443790097, "answer_id": 32907547, "question_id": 32906139, "link": "https://stackoverflow.com/questions/32906139/aws-lambda-like-execution-of-haskell-functions/32907547#32907547", "title": "AWS lambda like execution of Haskell functions", "body": "<p>If you want reproduce the same functionality (functions as services) exists a lot of technologies you can use (soap, rpc, rest, ...). If you unknown it I suggest to you read about.</p>\n\n<p>My ever favorite is SOAP but is so unpopular and Haskell support is limited <a href=\"https://hackage.haskell.org/package/soap\" rel=\"nofollow noreferrer\">soap</a> (see <a href=\"https://stackoverflow.com/questions/9931410/haskell-which-soap-client-lib-to-use\">related question</a>). SOAP (as others) provide exactly you want.</p>\n\n<p>But you must to concrete your real problem to select the best technology.</p>\n\n<p>If you are looking for distribute your own Haskell code <a href=\"http://haskell-distributed.github.io/\" rel=\"nofollow noreferrer\">Cloud Haskell</a> may be a good starting point.</p>\n\n<p>If you need more like \"web server\" then take a look to <a href=\"https://github.com/SodiumFRP/sodium\" rel=\"nofollow noreferrer\">sodium</a>, <a href=\"http://elm-lang.org/\" rel=\"nofollow noreferrer\">elm</a>, ... in a Javascript style or <a href=\"https://haskell-servant.github.io/\" rel=\"nofollow noreferrer\">servant</a> (generate client code to some languages).</p>\n\n<p>Anyway, even AWS Lambda require support for each language and you should not expect to find one ubiquitous technology (like HTTP) for RPC.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2536670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D5Uk4.jpg?s=128&g=1", "display_name": "ababkin", "link": "https://stackoverflow.com/users/2536670/ababkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1482210795, "creation_date": 1482210795, "answer_id": 41235319, "question_id": 32906139, "link": "https://stackoverflow.com/questions/32906139/aws-lambda-like-execution-of-haskell-functions/41235319#41235319", "title": "AWS lambda like execution of Haskell functions", "body": "<p>You may want to check out the \"serverless for haskell\" framework: <a href=\"http://qmu.li\" rel=\"nofollow noreferrer\">http://qmu.li</a></p>\n\n<p>Not only you can run individual haskell functions as Lambda functions with it but you can also describe your whole AWS infrastructure in haskell. (vs. doing it in CloudFormation json/yaml template), build it all locally and easily deploy to AWS.</p>\n"}], "owner": {"reputation": 3278, "user_id": 1054808, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/efba8ca1758acda2032c79b9ff4cd60b?s=128&d=identicon&r=PG", "display_name": "J Fritsch", "link": "https://stackoverflow.com/users/1054808/j-fritsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1482210795, "creation_date": 1443785097, "last_edit_date": 1443787337, "question_id": 32906139, "link": "https://stackoverflow.com/questions/32906139/aws-lambda-like-execution-of-haskell-functions", "title": "AWS lambda like execution of Haskell functions", "body": "<p>In AWS Lambda people can create a node.js function and trigger it through events, for example a message, etc..</p>\n\n<p>I wonder how this can work 'under the hood' and how to put something like this together in Haskell. The uploaded functions are basically single function libraries without any <code>main</code> function.</p>\n\n<p>Means on the CLI or via an API you can call any of your functions by name (and with the required input) and you get the output defined by the function signature--or, alternatively an error of course.</p>\n\n<p>Would it be possible to do this in Haskell? </p>\n\n<p>To clarify: what I want to do is for example loading a number of different single function Haskell libraries on a Haskell platform or any other execution context that is in my data center and execute / call them by name via the CLI or an API just in the same way AWS Lambda works with node.js functions.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443784507, "post_id": 32904842, "comment_id": 53639906, "body": "is there no Haskell equivalent of Scala&#39;s <code>3 match { case `four` =&gt; ... }</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1443790133, "post_id": 32904842, "comment_id": 53642821, "body": "@ErikAllik AFAIK, no, you need to use the guarded pattern <code>v | v == four -&gt; ...</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1443790070, "last_edit_date": 1443790070, "creation_date": 1443780033, "answer_id": 32904842, "question_id": 32904429, "link": "https://stackoverflow.com/questions/32904429/matching-against-already-assigned-variable-in-case-of-expression/32904842#32904842", "title": "matching against already assigned variable in case of expression", "body": "<p>This comes from the general static scoping rules, and renaming of variables (alpha-conversion). E.g. we know that</p>\n\n<pre><code>(\\x -&gt; x + 1)\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>(\\y -&gt; y + 1)\n</code></pre>\n\n<p>in any context. This works in the same way for other binders:</p>\n\n<pre><code>let x = 1 in f x  -- is the same as\nlet y = 1 in f y\n</code></pre>\n\n<p>Also</p>\n\n<pre><code>case e of x -&gt; f x -- is the same as\ncase e of y -&gt; f y\n</code></pre>\n\n<p>Some languages, such as Erlang, decided to break this general renaming rule, special-casing pattern matching against a variable defined in an outer scope.\nI'd say most functional languages decided instead to follow it.</p>\n\n<p>In Haskell you can achieve the same using</p>\n\n<pre><code>case e of v | v == previousVariable -&gt; ...\n</code></pre>\n\n<p>Note that this requires <code>(==)</code>, so an <code>Eq</code> instance must be available. That is, it works for <code>Int</code>s, but not for functions (or other types lacking a comparator).</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1443780131, "creation_date": 1443780131, "answer_id": 32904864, "question_id": 32904429, "link": "https://stackoverflow.com/questions/32904429/matching-against-already-assigned-variable-in-case-of-expression/32904864#32904864", "title": "matching against already assigned variable in case of expression", "body": "<p>In this case Haskell does not compare the value of <code>four = 4</code> to <code>3</code> it uses <code>four</code> as a <strong>pattern</strong> (which in this case will catch everything) so to the right of <code>-&gt;</code> <code>four</code> will now be <code>four == 3</code> (it shadows the binding above)</p>\n\n<p>you probably want</p>\n\n<pre><code>let four = 4\ncase 3 of\n    x | four == x -&gt; putStrLn \"3 == 4\"\n      | otherwise -&gt; putStrLn \"3 /= 4\"\n</code></pre>\n\n<p>inestead</p>\n"}], "owner": {"reputation": 71, "user_id": 3516751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6aef22038fc2a3592420c6c565d02e4?s=128&d=identicon&r=PG&f=1", "display_name": "user3516751", "link": "https://stackoverflow.com/users/3516751/user3516751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 32904842, "answer_count": 2, "score": 2, "last_activity_date": 1443790070, "creation_date": 1443778616, "question_id": 32904429, "link": "https://stackoverflow.com/questions/32904429/matching-against-already-assigned-variable-in-case-of-expression", "title": "matching against already assigned variable in case of expression", "body": "<p>The following code in Erlang catches the value of 3 if its equivalent to the value that Four is assigned to:</p>\n\n<pre><code>run() -&gt;\n    Four = 4,\n    case 3 of\n        Four -&gt; io:format(\"3 == 4~n\", []);\n        _ -&gt; io:format(\"3 /= 4~n\", [])\n    end.\n</code></pre>\n\n<p>When executed it prints out \"3 /= 4\". Similar code in Haskell:</p>\n\n<pre><code>main = do\n    let four = 4\n    case 3 of\n        four -&gt; putStrLn \"3 == 4\"\n        _ -&gt; putStrLn \"3 /= 4\"\n</code></pre>\n\n<p>prints \"3 == 4\" which is a statement I'm not (at this point in my life) ready to accept as truth.</p>\n\n<p>Why does Haskell not let me match against previously bound variables? Is it per design or just a result of how do-notation (and case .. of expressions by the way, I tested binding a name to a value in one case .. of and then matching against it in another case .. of inside and it didn't work) are implemented?\nIs there some way to get it to work and be as cool and simple as the Erlang one or do I have to manually compare them?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1443777978, "post_id": 32904183, "comment_id": 53636770, "body": "<code>putStrLn</code> returns <code>IO ()</code>. I don&#39;t know why you&#39;d expect it to work. If you expect a possibility of failure return <code>IO (Maybe Handle)</code> - add <code>Just</code> to the main path and <code>return Nothing</code> to your handler"}, {"owner": {"reputation": 531, "user_id": 2026722, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/67b13fd6c59bbcdf99f8d6cbb221ef09?s=128&d=identicon&r=PG", "display_name": "te7", "link": "https://stackoverflow.com/users/2026722/te7"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1443778400, "post_id": 32904183, "comment_id": 53636987, "body": "Thanks. I knew it was IO but I didn&#39;t know how to adress it. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 2026722, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/67b13fd6c59bbcdf99f8d6cbb221ef09?s=128&d=identicon&r=PG", "display_name": "te7", "link": "https://stackoverflow.com/users/2026722/te7"}, "edited": false, "score": 0, "creation_date": 1443790717, "post_id": 32904608, "comment_id": 53643197, "body": "I used the first example you gave and it worked. Thanks. But then the function convertFIle didn&#39;t recognize the variables fromHandle and toHandle. I changed the function declaration to &quot;convertFile :: (Either IOError Handle) -&gt; (Either IOError Handle) -&gt; IO ()&quot; and the variables are recognized, but now hGetLine fails with the new variable type (different from the expected type Handle). Any ideas?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 531, "user_id": 2026722, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/67b13fd6c59bbcdf99f8d6cbb221ef09?s=128&d=identicon&r=PG", "display_name": "te7", "link": "https://stackoverflow.com/users/2026722/te7"}, "edited": false, "score": 0, "creation_date": 1443794527, "post_id": 32904608, "comment_id": 53645755, "body": "If the result is a <code>Left  ioError</code>, you should stop what you are doing and handle it. It makes little sense to call <code>convertFile</code> unless you have two actual <code>Handles</code>. The point is -- the code above just shift exceptions into the <code>Either</code> type. You can forward that, thus postponing the error handling, as much as you want. But there will be some point in your program where you will want to check what&#39;s inside these <code>Either</code>s: if it&#39;s a <code>Left</code>, stop, if it&#39;s a <code>Right</code>, take the handle and continue."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1443779691, "last_edit_date": 1443779691, "creation_date": 1443779224, "answer_id": 32904608, "question_id": 32904183, "link": "https://stackoverflow.com/questions/32904183/how-to-use-catch-with-io-handle/32904608#32904608", "title": "How to use catch with IO Handle", "body": "<p>A signature such as</p>\n\n<pre><code>openGivenFile :: String -&gt; IOMode -&gt; IO Handle\n</code></pre>\n\n<p>states that <code>openGivenFile</code> returns an <code>Handle</code>, unless it throws an exception.</p>\n\n<p>If you decide to catch <code>IOError</code>s inside that, that's fine by itself, but you need some way to come up with an <code>Handle</code> in every case -- which is impossible.</p>\n\n<p>So, either you need to let the exception flow out if it, or you need to change the signature so that you no longer promise an <code>Handle</code> but something weaker. E.g.</p>\n\n<pre><code>openGivenFile :: String -&gt; IOMode -&gt; IO (Either IOError Handle)\nopenGivenFile name mode\n  =  catch (do handle &lt;- openFile name mode\n               return (Right handle)) \n            handler\n            where\n              handler :: IOError -&gt; IO (Either IOError Handle)\n              handler ex = do\n                 -- since we are returning the error,\n                 -- printing it may be a bad design now\n                 putStrLn $ \"Caught exception: \" ++ show ex\n                 return (Left ex)\n</code></pre>\n\n<p>After some cleanup:</p>\n\n<pre><code>openGivenFile :: String -&gt; IOMode -&gt; IO (Either IOError Handle)\nopenGivenFile name mode = (Right &lt;$&gt; openFile name mode) `catch` handler\n   where handler :: IOError -&gt; IO (Either IOError Handle)\n         handler = return . Left\n</code></pre>\n\n<p>Even this would work:</p>\n\n<pre><code>openGivenFile :: String -&gt; IOMode -&gt; IO (Either IOError Handle)\nopenGivenFile name mode =\n   (Right &lt;$&gt; openFile name mode) `catch` (return . Left)\n</code></pre>\n\n<p>but the exception being catched is a now a bit hidden inside the type signature of the whole function. Since this is an one-liner, it should be clear enough, but I'd prefer the previous alternative in general since it document the intent of catching <code>IOError</code> better.</p>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 2026722, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/67b13fd6c59bbcdf99f8d6cbb221ef09?s=128&d=identicon&r=PG", "display_name": "te7", "link": "https://stackoverflow.com/users/2026722/te7"}, "is_accepted": false, "score": 0, "last_activity_date": 1444972346, "last_edit_date": 1444972346, "creation_date": 1443885484, "answer_id": 32924158, "question_id": 32904183, "link": "https://stackoverflow.com/questions/32904183/how-to-use-catch-with-io-handle/32924158#32924158", "title": "How to use catch with IO Handle", "body": "<p>I got the program to work. Thanks Chi. I marked your answer as the answer. Here is the final code:</p>\n\n<p>Edit: ammended code for End-of-File check so as not to get exception in normal run.</p>\n\n<pre><code>-- Converts .lhs (literary Haskell files) to .hs (plain Haskell files)\n-- Keeps only the statements which are normally compiled, plus blank lines.\n\n-- To use:\n--    ghc --make lhs2hs.hs\n-- to get an executable file lhs2hs.\n-- Then\n--    lhs2hs filename\n-- will open filename.lhs and save the converted file in filename.hs\n\n-- by Scot Drysdale on 7/28/07, based on SOE program on p. 241\n\nmodule Main where\nimport System.IO\nimport System.IO.Error\nimport Control.Exception (catch)\nimport System.Environment   -- to allow getArgs\n\n-- Opens a file, given name and mode\nopenGivenFile :: String -&gt; IOMode -&gt; IO (Either IOError Handle)\nopenGivenFile name mode\n  = catch (do handle &lt;- openFile name mode\n              return (Right handle))\n           handler\n           where\n             handler :: IOError -&gt; IO (Either IOError Handle)\n             handler ex = do\n                 -- since we are returning the error,\n                 -- printing it may be a bad design now\n                putStrLn $ \"Caught exception: \" ++ show ex\n                return (Left ex)\n\nmain = do args &lt;- getArgs\n          (Right fromHandle) &lt;- openGivenFile (args !! 0 ++ \".lhs\") ReadMode\n          (Right toHandle) &lt;- openGivenFile (args !! 0 ++ \".hs\") WriteMode\n        --  (Right fromHandle) &lt;- openGivenFile (head args) ReadMode\n        --  (Right toHandle) &lt;- openGivenFile (head args) WriteMode\n          convertFile fromHandle toHandle\n          hClose fromHandle\n          hClose toHandle\n\n-- Converts all the lines in a file\nconvertFile :: Handle -&gt; Handle -&gt; IO ()\nconvertFile fromHandle toHandle\n  = catch ( do ineof &lt;- hIsEOF fromHandle\n               if ineof\n                  then return ()\n                  else do line &lt;- hGetLine fromHandle\n                          case line of\n                            ('&gt;' : ' ' : rest) -&gt; hPutStrLn toHandle rest\n                            ('&gt;' : rest)       -&gt; hPutStrLn toHandle rest\n                            ('\\n' : rest)      -&gt; hPutStrLn toHandle line\n                            ('\\r' : rest)      -&gt; hPutStrLn toHandle line\n                            _                  -&gt; return ()\n                          convertFile fromHandle toHandle)\n           handler\n           where\n             handler :: IOError -&gt; IO ()\n             handler ex = putStrLn $ \"Caught exception: \" ++ show ex\n</code></pre>\n"}], "owner": {"reputation": 531, "user_id": 2026722, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/67b13fd6c59bbcdf99f8d6cbb221ef09?s=128&d=identicon&r=PG", "display_name": "te7", "link": "https://stackoverflow.com/users/2026722/te7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 1, "accepted_answer_id": 32904608, "answer_count": 2, "score": 3, "last_activity_date": 1444972346, "creation_date": 1443777797, "question_id": 32904183, "link": "https://stackoverflow.com/questions/32904183/how-to-use-catch-with-io-handle", "title": "How to use catch with IO Handle", "body": "<p>I'm trying to build a little program in Haskell in Leksah that will convert an .lhs file to an .hs file. But I can't get it to build without errors. Any help would be appreciated. I'm new to Haskell so forgive me if the answer is obvious, though I can't see it. Here is the code and error:</p>\n\n<pre><code>-- Converts .lhs (literary Haskell files) to .hs (plain Haskell files)\n-- Keeps only the statements which are normally compiled, plus blank lines.\n\n-- To use:\n--    ghc --make lhs2hs.hs\n-- to get an executable file lhs2hs.\n-- Then\n--    lhs2hs filename\n-- will open filename.lhs and save the converted file in filename.hs\n\n-- by Scot Drysdale on 7/28/07, based on SOE program on p. 241\n\nmodule Main where\nimport System.IO\n-- import System.IO.Error (catchIOError)\nimport Control.Exception (catch)\nimport System.Environment   -- to allow getArgs\n\n-- Opens a file, given name and mode\nopenGivenFile :: String -&gt; IOMode -&gt; IO Handle\nopenGivenFile name mode\n  =  catch (do handle &lt;- openFile name mode\n               return handle) \n            handler\n            where\n              handler :: IOError -&gt; IO Handle \n              -- Next line does not match IO Handle\n              handler ex = putStrLn $ \"Caught exception: \" ++ show ex\n                                --   (\\e -&gt; error (\"Cannot open \" ++ name))\n\nmain = do args &lt;- getArgs\n          fromHandle &lt;- openGivenFile (args !! 0 ++ \".lhs\") ReadMode\n          toHandle &lt;- openGivenFile (args !! 0 ++ \".hs\") WriteMode\n          convertFile fromHandle toHandle\n          hClose fromHandle\n          hClose toHandle\n\n-- Converts all the lines in a file\nconvertFile :: Handle -&gt; Handle -&gt; IO ()\nconvertFile fromHandle toHandle\n  = catch (do line &lt;- hGetLine fromHandle\n              case line of\n                          ('&gt;' : ' ' : rest) -&gt; hPutStrLn toHandle rest\n                          ('&gt;' : rest)       -&gt; hPutStrLn toHandle rest\n                          ('\\n' : rest)      -&gt; hPutStrLn toHandle line\n                          ('\\r' : rest)      -&gt; hPutStrLn toHandle line \n                          _                  -&gt; return ()\n              convertFile fromHandle toHandle)\n              handler\n              where\n               handler :: IOError -&gt; IO ()\n               handler ex = putStrLn $ \"Caught exception: \" ++ show ex\n</code></pre>\n\n<p>Error is :</p>\n\n<pre><code> src\\Main.hs:27:28-69:\n    Couldn't match type `()' with `Handle'\n    Expected type: IO Handle\n      Actual type: IO ()\n    In the expression: putStrLn $ \"Caught exception: \" ++ show ex\n    In an equation for `handler':\n        handler ex = putStrLn $ \"Caught exception: \" ++ show ex\n    In an equation for `openGivenFile':\n        openGivenFile name mode\n          = catch\n              (do { handle &lt;- openFile name mode;\n                    return handle })\n              handler\n          where\n              handler :: IOError -&gt; IO Handle\n              handler ex = putStrLn $ \"Caught exception: \" ++ show ex\n</code></pre>\n"}]