[{"tags": ["haskell", "lazy-evaluation"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1463044004, "last_edit_date": 1463044004, "creation_date": 1463036806, "answer_id": 37179658, "question_id": 37174707, "link": "https://stackoverflow.com/questions/37174707/haskell-cis194-spring-13-homework-6-exercise-5/37179658#37179658", "title": "Haskell CIS194 Spring 13 Homework 6 Exercise 5", "body": "<p>first congrats - you solved the <em>hard</em> part ;)</p>\n\n<p>To your question: if you use the <code>interleaveStreams</code> than it will pattern match on the second <code>Cons</code> too - but if you look at your code you see that the second part is generated by:</p>\n\n<pre><code>let s n = interleaveStreams ... (s (n+1)) \n</code></pre>\n\n<p>so if <code>interleaveStreams</code> now asks it to <em>produce</em> a <code>Cons</code> for this part too you end up in an infinite loop</p>\n\n<p>The other function solves this issue by <em>only</em> forcing the first constructor, which you get at once from<code>streamRepeat</code></p>\n\n<h3>interleaveStreams:</h3>\n\n<pre><code>s 0\n= interleaveStreams (streamRepeat 0) (s 1))\n{ need both cons }\n= interleaveStreams (Cons 0 (streamRepeat 0)) (s 1)\n= interleaveStreams (Cons ...) (interleaveStreams (streamRepeat 1) (s 2))\n{ the inner interleaveStream needs both Cons again for it's pattern }\n= ...\n</code></pre>\n\n<p>you'll never get to a <code>Cons</code> and <code>streamToList</code> will never be able to produce a list-cons and then you have your problem</p>\n\n<h3>interleaveStreams':</h3>\n\n<pre><code>s 0\n= interleaveStreams' (streamRepeat 0) (s 1))\n{ need only first Cons for the pattern-match }\n= interleaveStreams' (Cons 0 (streamRepeat 0)) (s 1)\n= Cons 0 $ interleaveStreams' (s 1) (streamRepeat 0)\n= ...\n</code></pre>\n\n<p>as you can see you get the <code>Cons</code> which is the happy path for laziness in <code>show</code>/<code>streamToList</code></p>\n\n<hr>\n\n<h3>a bit shorter</h3>\n\n<p>by the way: you can write this without the <code>s</code> inner-function by using <code>streamMap</code>:</p>\n\n<pre><code>ruler :: Stream Integer\nruler = interleaveStreams (streamRepeat 0) (streamMap (+1) ruler)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6322729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f95393293687c2fdf11f534e6ed942e?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/6322729/user9123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 37179658, "answer_count": 1, "score": 1, "last_activity_date": 1463044004, "creation_date": 1463008065, "question_id": 37174707, "link": "https://stackoverflow.com/questions/37174707/haskell-cis194-spring-13-homework-6-exercise-5", "title": "Haskell CIS194 Spring 13 Homework 6 Exercise 5", "body": "<p><a href=\"http://www.seas.upenn.edu/~cis194/spring13/hw/06-laziness.pdf\" rel=\"nofollow\">http://www.seas.upenn.edu/~cis194/spring13/hw/06-laziness.pdf</a></p>\n\n<p>The question is about representing the ruler function</p>\n\n<blockquote>\n  <p>0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 4, . . .\n  where the nth element in the stream (assuming the first element\n  corresponds to n = 1) is the largest power of 2 which evenly divides n</p>\n</blockquote>\n\n<p>I have working solution using show to display the first 20 elements with interleaveStreams' function:</p>\n\n<pre><code>data Stream a = Cons a (Stream a)\n\nstreamToList :: Stream a -&gt; [a]\nstreamToList (Cons a b) = a : streamToList b \n\ninstance Show a =&gt; Show (Stream a) where\n  show = show . take 20 . streamToList\n\nstreamRepeat :: a -&gt; Stream a\nstreamRepeat a = Cons a (streamRepeat a)\n\nruler :: Stream Integer\nruler = \n  let s n = interleaveStreams' (streamRepeat n) (s (n+1)) \n  in s 0\n\ninterleaveStreams :: Stream a -&gt; Stream a -&gt; Stream a\ninterleaveStreams (Cons x xs) (Cons y ys) = Cons x (Cons y (interleaveStreams xs ys))\n\ninterleaveStreams' :: Stream a -&gt; Stream a -&gt; Stream a\ninterleaveStreams' (Cons x xs) y = Cons x $ interleaveStreams' y xs\n</code></pre>\n\n<p>However I don't understand why ruler using the interleave function instead does not terminate with Show. </p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1463017691, "creation_date": 1463017691, "answer_id": 37175937, "question_id": 37174457, "link": "https://stackoverflow.com/questions/37174457/what-does-the-operators-like-i-and-mean-in-ghc-num-module/37175937#37175937", "title": "What does the operators like I# and +# mean in GHC.Num module?", "body": "<p>They are <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/PrimOps\" rel=\"nofollow\">GHC primops</a>, i.e. primitive operations that are not implemented in Haskell, but provided by the runtime. </p>\n\n<p>These particular ones are <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html\" rel=\"nofollow\">declared in <code>GHC.Prim</code></a> and implement <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html#g:3\" rel=\"nofollow\">unboxed <code>Int</code>s</a>: <code>Int#</code> is the type of unboxed <code>Int</code>s, <code>I#</code> is the constructor of <code>Int</code> (i.e. <code>data Int = I# Int#</code>), and <code>+#</code> is <code>Int#</code> addition.</p>\n"}], "owner": {"reputation": 35, "user_id": 5056221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bb6f045ed4078d1979638049e19e25?s=128&d=identicon&r=PG&f=1", "display_name": "ghjang", "link": "https://stackoverflow.com/users/5056221/ghjang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 37175937, "answer_count": 1, "score": 0, "last_activity_date": 1463037172, "creation_date": 1463006453, "last_edit_date": 1463037172, "question_id": 37174457, "link": "https://stackoverflow.com/questions/37174457/what-does-the-operators-like-i-and-mean-in-ghc-num-module", "title": "What does the operators like I# and +# mean in GHC.Num module?", "body": "<p>I opened up <code>GHC/Num.lhs</code> file and could find some codes like following:</p>\n\n<pre><code>instance  Num Int  where\n    I# x + I# y = I# (x +# y)\n    I# x - I# y = I# (x -# y)\n    negate (I# x) = I# (negateInt# x)\n    I# x * I# y = I# (x *# y)\n    abs n  = if n `geInt` 0 then n else negate n\n\n    signum n | n `ltInt` 0 = negate 1\n             | n `eqInt` 0 = 0\n             | otherwise   = 1\n\n    {-# INLINE fromInteger #-}   -- Just to be sure!\n    fromInteger i = I# (integerToInt i)\n</code></pre>\n\n<p>Are they some kind of intrinsic operators for GHC implementation?</p>\n"}, {"tags": ["haskell", "xmonad"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 150989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182ffb5e5361957bc16597f980b27c7?s=128&d=identicon&r=PG", "display_name": "HokieGeek", "link": "https://stackoverflow.com/users/150989/hokiegeek"}, "edited": false, "score": 0, "creation_date": 1463009194, "post_id": 37174437, "comment_id": 61884336, "body": "No difference, unfortunately."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 11, "user_id": 150989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182ffb5e5361957bc16597f980b27c7?s=128&d=identicon&r=PG", "display_name": "HokieGeek", "link": "https://stackoverflow.com/users/150989/hokiegeek"}, "edited": false, "score": 0, "creation_date": 1463019489, "post_id": 37174437, "comment_id": 61886880, "body": "Added some new ideas to try out."}, {"owner": {"reputation": 11, "user_id": 150989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182ffb5e5361957bc16597f980b27c7?s=128&d=identicon&r=PG", "display_name": "HokieGeek", "link": "https://stackoverflow.com/users/150989/hokiegeek"}, "edited": false, "score": 0, "creation_date": 1463019868, "post_id": 37174437, "comment_id": 61886981, "body": "I edited my question, but with the current example, the echo with the -n does not seem to be returning a newline at least when I try it on a standalone program. Going to try the other suggestions."}, {"owner": {"reputation": 11, "user_id": 150989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182ffb5e5361957bc16597f980b27c7?s=128&d=identicon&r=PG", "display_name": "HokieGeek", "link": "https://stackoverflow.com/users/150989/hokiegeek"}, "edited": false, "score": 0, "creation_date": 1463020150, "post_id": 37174437, "comment_id": 61887050, "body": "No joy :-/ The first one did indeed succeed but the second one resulted in no response to my binding."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 11, "user_id": 150989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182ffb5e5361957bc16597f980b27c7?s=128&d=identicon&r=PG", "display_name": "HokieGeek", "link": "https://stackoverflow.com/users/150989/hokiegeek"}, "edited": false, "score": 0, "creation_date": 1463021346, "post_id": 37174437, "comment_id": 61887342, "body": "Added some more things to try."}, {"owner": {"reputation": 11, "user_id": 150989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182ffb5e5361957bc16597f980b27c7?s=128&d=identicon&r=PG", "display_name": "HokieGeek", "link": "https://stackoverflow.com/users/150989/hokiegeek"}, "edited": false, "score": 0, "creation_date": 1463061606, "post_id": 37174437, "comment_id": 61910982, "body": "Apparently, the issue was with how xmonad treats its children. The solution is to replace readProcess with runProcessWithInput"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1464028562, "last_edit_date": 1464028562, "creation_date": 1463006348, "answer_id": 37174437, "question_id": 37174160, "link": "https://stackoverflow.com/questions/37174160/how-do-i-use-the-output-of-readprocess-in-an-xmonad-keybinding/37174437#37174437", "title": "How do I use the output of readProcess in an xmonad keybinding?", "body": "<p><strong>Update</strong></p>\n\n<p>Apparently the solution (see the comments below) is to use <code>readProcessWithInput</code></p>\n\n<p><strong>Original Answer</strong></p>\n\n<p>You said that:</p>\n\n<pre><code>liftIO test &gt;&gt;= spawn\n</code></pre>\n\n<p>didn't work, but how about:</p>\n\n<pre><code>liftIO test &gt;&gt;= (\\m -&gt; spawn (\"xmessage \" ++ m))\n</code></pre>\n\n<p>Also note that the string returned by <code>readProcess</code> likely will have a newline at the end, and that may be affecting things.</p>\n\n<p>Some more things to try in this vein:</p>\n\n<pre><code>return \"gvim\" &gt;&gt;= (\\m -&gt; spawn (\"xmessage \" ++ m))\n\n\nimport Data.Char\n\ndo { m &lt;- liftIO test;  spawn (\"xmessage \" ++ (filter isAlpha m)) }\n</code></pre>\n\n<p>The first one should succeed since it is equivalent to <code>spawn \"xmessage grim\"</code>. The second one will strip any newlines (indeed, any non-letters) from the output of <code>test</code>.</p>\n\n<p>Some further things which might shed light on what is going on:</p>\n\n<ol>\n<li><p>Create a script called <code>/tmp/report</code> with these contents:</p>\n\n<pre><code>#!/bin/sh\n( date; echo \"/tmp/report was called with args\" \"$@\") &gt;&gt; /tmp/output\n</code></pre></li>\n<li><p>Make <code>/tmp/report</code> executable.</p></li>\n<li>Run <code>/tmp/report</code> and verify that two lines was appended to <code>/tmp/output</code></li>\n<li>In your monad config, make the action <code>spawn \"/tmp/report A\"</code>. Test the action by seeing if the expected line is appended to <code>/tmp/output</code>.</li>\n<li><p>Try making the monad action this:</p>\n\n<pre><code>liftIO (readProcess \"/tmp/report\" [\"B\"] \"\") &gt;&gt; spawn \"/tmp/report A\"\n</code></pre>\n\n<p>(Note we are using <code>&gt;&gt;</code> here, not <code>&gt;&gt;=</code>.) When you trigger the action you should see a report line for the <code>B</code> call and also one for the <code>A</code> call.</p></li>\n</ol>\n\n<p>Based on what you see in the file <code>/tmp/output</code> you should be able to determine whether the <code>readProcess</code> command is even being executed as well as the <code>spawn</code> command is triggering.</p>\n"}], "owner": {"reputation": 11, "user_id": 150989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182ffb5e5361957bc16597f980b27c7?s=128&d=identicon&r=PG", "display_name": "HokieGeek", "link": "https://stackoverflow.com/users/150989/hokiegeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464028562, "creation_date": 1463004801, "last_edit_date": 1495542240, "question_id": 37174160, "link": "https://stackoverflow.com/questions/37174160/how-do-i-use-the-output-of-readprocess-in-an-xmonad-keybinding", "title": "How do I use the output of readProcess in an xmonad keybinding?", "body": "<p>Ok, so some time ago I was thinking of basing the effect of a keybinding in my xmonad based on the output of a script on my box. I eventually decided not to do that for unrelated reasons but I did recently try to do something similar just as an exercise in learning Haskell.</p>\n\n<p>So, given the function:</p>\n\n<pre><code>test = readProcess \"echo\" [\"-n\", \"gvim\"] []\n</code></pre>\n\n<p>This throws up because test returns IO String and spawn expects a String.</p>\n\n<pre><code>((modm, xK_y), spawn (\"xmessage \" ++ test))\n</code></pre>\n\n<p>Ok. That's cool. I get it that IO operations are unpredictable and so they should be kept separate. Fine. So I did some poking around online and got to this (dropped the xmessage and just want to pass the output of test by itself):</p>\n\n<pre><code>((modm, xK_y), liftIO test &gt;&gt;= spawn)\n</code></pre>\n\n<p>This is worse. It annoyingly compiles but nothing happens when I try out the binding. (I also replaced it with just spawn \"xmessage test\" and that worked)</p>\n\n<p>So, then I thought \"Maybe there's something wrong with my function\" so I repl it but from GCHi I get \"gvim\" which is correct. So then I write it to a haskell file:</p>\n\n<pre><code>main = test &gt;&gt;= putStrLn\ntest = readProcess \"echo\" [\"-n\", \"gvim\"] []\n</code></pre>\n\n<p>Also works correctly.</p>\n\n<p>So, where did I go wrong?</p>\n\n<p>EDIT: Solution was to use <code>runProcessWithInput</code> instead of <code>readProcess</code>. \nRelated link: <a href=\"https://ghc.haskell.org/trac/ghc/ticket/5212\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/5212</a> <a href=\"https://stackoverflow.com/questions/26562522/xmonad-io-binding-not-working\">xmonad io binding not working</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1463000823, "post_id": 37173181, "comment_id": 61881169, "body": "It appears that <code>EmptyStatement</code> is like a list of <code>Stmt</code>, not a single <code>Stmt</code>, so why is it valid as a return value from <code>nextStatement</code>? I think the same problem you are having with defining <code>nextStatement</code> is the same as trying to define <code>head :: [a] -&gt; a</code> on the empty list. You can&#39;t, and that&#39;s why <code>head []</code> throws an error."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1463002012, "post_id": 37173181, "comment_id": 61881783, "body": "It is polite to include enough code that we can at least reproduce your problem. That means imports and all the type definitions needed -- e.g. what are <code>VarName</code>, <code>Type</code>, <code>LitVal</code>, <code>Stmt</code>? We can stub this stuff out, but in the future please include a minimal working example."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1463002713, "post_id": 37173181, "comment_id": 61882088, "body": "@DanielWagner I wanted to avoid putting too much code. I can attach now."}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1463001768, "post_id": 37173499, "comment_id": 61881674, "body": "no,  note that <code>Stmts</code> is field of <code>InterpreterMT</code> monad while you get it as argument in function"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1463001951, "post_id": 37173499, "comment_id": 61881757, "body": "@Gilgamesz Ugh, why is your <code>InterpreterMT</code> transformer set up in such a roundabout way? Anyway, give me a moment and I will show how to deal with the ugliness."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1463004528, "post_id": 37173499, "comment_id": 61882845, "body": "&quot;You should probably also implement the usual interfaces for InterpreterMT, giving an instance of MonadTrans (InterpreterMT stmts) and probably a few of MonadError e m =&gt; MonadError e (InterpreterMT stmts m) + the other mtl classes. Then you will be able to write&quot; I don&#39;t understand what do you mean."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1463002611, "last_edit_date": 1463002611, "creation_date": 1463001703, "answer_id": 37173499, "question_id": 37173181, "link": "https://stackoverflow.com/questions/37173181/field-in-monad-haskell/37173499#37173499", "title": "Field in monad. Haskell", "body": "<p>I guess you probably want something like this:</p>\n\n<pre><code>nextStatement :: MonadError String m =&gt; Stmts -&gt; m Stmt\nnextStatement (Statements s _) = return s\nnextStatement EmptyStmts = throwError \"nextStatement EmptyStmts\"\n</code></pre>\n\n<p>In particular <code>Interpreter</code> is an instance of <code>MonadError String</code> and so this can also be given the type <code>Stmts -&gt; Interpreter Stmt</code>. You can retrieve the <code>Stmts</code> from the <code>InterpreterMT</code> transformer in the usual <code>State</code>-like way, annotated with either <code>ExeInterpreter</code> or <code>PropInterpreter</code> as appropriate (I don't know which is appropriate so I just picked one):</p>\n\n<pre><code>getStmts :: Monad m =&gt; InterpreterMT stmts m stmts\ngetStmts = InterpreterMT (\\stmts -&gt; return (ExeInterpreter stmts stmts))\n</code></pre>\n\n<p>You should probably also implement the usual interfaces for <code>InterpreterMT</code>, giving an instance of <code>MonadTrans (InterpreterMT stmts)</code> and probably a few of <code>MonadError e m =&gt; MonadError e (InterpreterMT stmts m)</code> + the other <code>mtl</code> classes. Then you will be able to write</p>\n\n<pre><code>getStmts &gt;&gt;= nextStatement :: MonadError String m =&gt; InterpreterMT Stmts m Stmt\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 37173499, "answer_count": 1, "score": 0, "last_activity_date": 1463002611, "creation_date": 1463000339, "question_id": 37173181, "link": "https://stackoverflow.com/questions/37173181/field-in-monad-haskell", "title": "Field in monad. Haskell", "body": "<pre><code>type Context = Map.Map VarName (Type, Integer)\ntype Memory = Map.Map Integer LitVal\ntype Functions = Map.Map VarName (Stmt, Context)\n\ndata InterpreterM stmts a = ExeInterpreter stmts a | PropInterpreter stmts a\n\nnewtype InterpreterMT stmts m a = InterpreterMT { runInterpreterMT :: stmts -&gt; m (InterpreterM stmts a) }\n\ntype Interpreter = InterpreterMT Stmts (StateT (Memory, Functions) (ReaderT (Context, Context) (ErrorT String IO)))\n\n\n\ninstance (Monad m) =&gt; Monad (InterpreterMT s m) where\n    return x = InterpreterMT $ \\stmts -&gt; return (ExeInterpreter stmts x)\n    x &gt;&gt;= f = InterpreterMT $ \\stmts -&gt; do\n        m &lt;- runInterpreterMT x stmts \n        case m of\n            (ExeInterpreter ss a) -&gt; (runInterpreterMT (f a) ss)\n\ndata Stmts =  Statements Stmt Stmts | EmptyStmts\n\n    nextStatement :: &lt;HERE&gt;\n</code></pre>\n\n<p>Hi,\nAs you can see <code>Stmts</code> has recursive definition. Now, I would like to implement <code>nextStatement</code> function but I cannot imagine how to do it in monad. \nBeyond monad it is simple but then, statements must be provided,  I mean:</p>\n\n<pre><code>nextStatement :: Stmts  -&gt; Stmt\nnextStatement (Statements s ss) =  s\nnextStatement EmptyStatement = EmptyStatement\n</code></pre>\n"}, {"tags": ["haskell", "lambda", "type-inference"], "comments": [{"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 0, "creation_date": 1462987997, "post_id": 37169464, "comment_id": 61874072, "body": "<code>g&#39; = map (\\(x,y) -&gt; x == y)</code>  also gives an error message. The presence of the list in the definition probably plays an important role."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1462988259, "post_id": 37169464, "comment_id": 61874220, "body": "What error are you guys getting?  The first example works for me even without the type declaration."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 3, "creation_date": 1462988338, "post_id": 37169464, "comment_id": 61874275, "body": "This is due to the monomorphism restriction."}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1462988883, "post_id": 37169464, "comment_id": 61874626, "body": "@jamshidh <code>No instance for (Eq a0) arising from a use of &#39;==&#39; The type variable &#39;a0&#39; is ambiguous (...)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 1, "creation_date": 1462988613, "post_id": 37169791, "comment_id": 61874451, "body": "I&#39;d like to see this answer expanded with a short explanation of the monomorphism restriction. I think OP wants to understand why it happens."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1462989134, "post_id": 37169791, "comment_id": 61874812, "body": "see <a href=\"http://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\" title=\"what is the monomorphism restriction\">stackoverflow.com/questions/32496864/&hellip;</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1462991483, "last_edit_date": 1462991483, "creation_date": 1462988445, "answer_id": 37169791, "question_id": 37169464, "link": "https://stackoverflow.com/questions/37169464/haskell-type-inference-for-lambda-functions-in-map/37169791#37169791", "title": "Haskell type inference for lambda functions (in map)", "body": "<p>If you use:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nf = \\(x,y) -&gt; x==y\n</code></pre>\n\n<p>you won't get the error.</p>\n\n<p><strong>Update</strong></p>\n\n<p>The Haskell Wiki page on Monomorphism Restriction <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow\">(link)</a> offers some details on why these definitions are treated differently:</p>\n\n<pre><code>f1 x = show x\n\nf2 = \\x -&gt; show x\n</code></pre>\n\n<blockquote>\n  <p>The difference between the first and second version is that the first version binds x via a \"function binding\" (see section 4.4.3 of the Haskell 2010 Report), and is therefore unrestricted, but the second version does not. The reason why one is allowed and the other is not is that it's considered clear that sharing f1 will not share any computation, and less clear that sharing f2 will have the same effect. If this seems arbitrary, that's because it is. It is difficult to design an objective rule which disallows subjective unexpected behaviour. Some people are going to fall foul of the rule even though they're doing quite reasonable things.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462990025, "post_id": 37170164, "comment_id": 61875339, "body": "The thing is that if you write <code>f (x,y) = x == y</code> the monomorphism restriction doesn&#39;t get in the way, and I&#39;m trying to figure out why."}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462990811, "post_id": 37170164, "comment_id": 61875805, "body": "The Haskell Wikia on the subject starts with an similar example. It looks as if the monomorphism restriction comes into play when there are lambda expressions that aren&#39;t bound to other items. Now studying the spec."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462991372, "post_id": 37170164, "comment_id": 61876065, "body": "@ErikR That&#39;s a design choice. The goal of the MR is to avoid turning non-functions into functions. E.g. <code>let x = product [1..500] in ...</code> without the MR defines a runtime function taking a hidden <code>Num a</code> argument. This implies that each use of <code>x</code> triggers 500 multiplications, with surprising performance penalties. This repeated evaluation could turn a linear recursive algorithm into an exponential one, IIRC. So, the MR &quot;forces&quot; non-function bindings <code>let x = e</code> to resolve all constraints at once, limiting polymorphism."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462991501, "post_id": 37170164, "comment_id": 61876130, "body": "@ErikR The weird thing is that only the binding type is inspected by the MR. If we write <code>let x = e</code>, then <code>x</code> is monomorphic even if <code>e</code> has a function type and adding a hidden dictionary argument would not have been so bad. The designers of Haskell apparently chose against the special case, making <code>let f y = ...</code> different from <code>let f = \\y -&gt; e</code> at type-check time. Later, they discovered that in practice this problem almost never happens (running a Hackage statistic), so there&#39;s hope that the MR will be turned off sometime in the future."}], "tags": [], "owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "is_accepted": false, "score": 2, "last_activity_date": 1462989697, "last_edit_date": 1495542236, "creation_date": 1462989697, "answer_id": 37170164, "question_id": 37169464, "link": "https://stackoverflow.com/questions/37169464/haskell-type-inference-for-lambda-functions-in-map/37170164#37170164", "title": "Haskell type inference for lambda functions (in map)", "body": "<p>As @ErikR notes in the comments, this is due to the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">Monomorphism restriction</a>. We also see this in the error message:</p>\n\n<blockquote>\n  <p>No instance for (Eq a0) arising from a use of '=='<br>\n    The type variable 'a0' is ambiguous<br>\n    Possible cause: the monomorphism restriction applied to the following:<br>\n      f :: (a0, a0) -> Bool<br>\n        (bound at ...<br>\n    Note: there are several potential instances:<br>\n      instance Eq a => Eq (GHC.Real.Ratio a) -- Defined in 'GHC.Real'<br>\n      instance Eq () -- Defined in 'GHC.Classes'<br>\n      instane (Eq a, Eq b) => Eq (a,b) -- Defined in 'GHC.Classes'<br>\n      ..plus 22 others</p>\n</blockquote>\n\n<p>The monomorphism restriction implies that the compiler tries to instantiate an ambiguous type into a non-ambiguous type. (Source: <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">What is the monomorphism restriction?</a>).  </p>\n\n<p>So, Haskell wants to put a single instance, but it can't - it finds several, and doesn't know which to choose.</p>\n\n<p>This explains why adding the type solves the problem: now the compiler knows what to choose.</p>\n\n<blockquote>\n  <p>The \"monomorphism restriction\" is a counter-intuitive rule in Haskell type inference. If you forget to provide a type signature, sometimes this rule will fill the free type variables with specific types using \"type defaulting\" rules. </p>\n</blockquote>\n"}], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "closed_date": 1462994868, "answer_count": 2, "score": 1, "last_activity_date": 1462991483, "creation_date": 1462987532, "last_edit_date": 1462987851, "question_id": 37169464, "link": "https://stackoverflow.com/questions/37169464/haskell-type-inference-for-lambda-functions-in-map", "closed_reason": "Duplicate", "title": "Haskell type inference for lambda functions (in map)", "body": "<h3>Example 1</h3>\n\n<p>Following definition without the type declaration will throw an error:</p>\n\n<pre><code>f :: Eq t =&gt; (t,t) -&gt; Bool  -- omiting this line will result in an error\nf = \\(x,y) -&gt; x==y\n</code></pre>\n\n<p>(I know this function can be written shorter, but this is not the point here.)</p>\n\n<h3>Example 2</h3>\n\n<p>On the other hand using the <em>same</em> lambda function in a function using <code>map</code> does work without producing an error:</p>\n\n<pre><code> g l = map (\\(x,y) -&gt; x==y) l\n</code></pre>\n\n<p>(Just as an illustration: <code>g [(3,4),(5,5),(7,6)]</code> will produce <code>[False,True,False]</code></p>\n\n<h3>Example 3</h3>\n\n<p>Also following code is perfectly fine and it seems to do exactly the same as the original <code>f</code> from above. Here the type inference seems to work.</p>\n\n<pre><code> f' (x,y) = x==y\n</code></pre>\n\n<h3>Question</h3>\n\n<p>So my question is: Why do we need a type declaration in the first case, but not in the second and in the third?</p>\n"}, {"tags": ["haskell", "websocket", "haskell-snap-framework"], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 2, "last_activity_date": 1462986712, "creation_date": 1462986712, "answer_id": 37169213, "question_id": 37168386, "link": "https://stackoverflow.com/questions/37168386/getting-client-ip-address-in-websocket-library/37169213#37169213", "title": "Getting client IP address in websocket library", "body": "<p><code>runWebSocketsSnap</code> is just a regular <code>Snap</code> application, so you can use <a href=\"https://hackage.haskell.org/package/snap-core-0.9.7.0/docs/Snap-Core.html#v:rqRemoteAddr\" rel=\"nofollow\"><code>rqRemoteAddr</code></a> to get remote IP address:</p>\n\n<pre><code>do\n  addr &lt;- getsRequest rqRemoteAddr\n  runWebSocketsSnap $ \\pending -&gt; ...\n</code></pre>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 37169213, "answer_count": 1, "score": 1, "last_activity_date": 1462986712, "creation_date": 1462984045, "question_id": 37168386, "link": "https://stackoverflow.com/questions/37168386/getting-client-ip-address-in-websocket-library", "title": "Getting client IP address in websocket library", "body": "<p>I am using <code>Network.WebSocket</code> library. I tried <code>WS.requestHeaders . WS.pendingRequest</code> on <code>PendingConnection</code> to get the connection request information. However, it seems it doesn't have client IP information, only the server IP information in <code>Host</code> key. An example output below:</p>\n\n<pre><code>[(\"Upgrade\",\"websocket\"),(\"Sec-WebSocket-Extensions\",\"permessage-deflate; \nclient_max_window_bits\"),(\"Sec-WebSocket-Key\",\"&lt;taken out for SO post&gt;\"),\n(\"Connection\",\"Upgrade\"),(\"Sec-WebSocket-Version\",\"13\"),(\"Host\",\"localhost:8080\")]\n</code></pre>\n\n<p>What will be a good way to get the \"Client IP\" information when running <code>Network.Websocket</code> (I am running it within <code>Snap</code> monad using <code>runWebSocketsSnap</code>). I will like to log it in case of error.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 2, "creation_date": 1462977397, "post_id": 37165461, "comment_id": 61867074, "body": "I say to have a look at <code>&lt;*&gt;</code> in <code>Control.Applicative</code>."}, {"owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "edited": false, "score": 1, "creation_date": 1462977444, "post_id": 37165461, "comment_id": 61867122, "body": "How do you want to determine the order of the composition? You give an example for lists of length 2, but what should it be for 3, 4...?"}], "answers": [{"comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1462978204, "post_id": 37166144, "comment_id": 61867699, "body": "The wrong order is fixed by using <code>&lt;**&gt;</code> which is basically <code>&lt;*&gt;</code> with its arguments reversed."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1462979034, "post_id": 37166144, "comment_id": 61868281, "body": "Also, <code>composeAll</code> is the same as <code>foldr (flip (.)) id</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1462979169, "post_id": 37166144, "comment_id": 61868367, "body": "Thanks; I&#39;ve going to leave my answer as-is, as a &quot;dumbed-down&quot; complement to your standard-functions-only answer."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1462980810, "last_edit_date": 1495540840, "creation_date": 1462978051, "answer_id": 37166144, "question_id": 37165461, "link": "https://stackoverflow.com/questions/37165461/outer-product-partially-applied-functions-composition/37166144#37166144", "title": "outer product -&gt; partially applied functions -&gt; composition", "body": "<p>See <a href=\"https://stackoverflow.com/a/37166187/1126841\">ThreeFx's answer</a> for a solution using only standard functions.</p>\n\n<hr>\n\n<p>You also need to fold the list of partially applied functions itself with <code>(.)</code>.</p>\n\n<p>First, get your list of partially applied functions:</p>\n\n<pre><code>-- If f :: a -&gt; b -&gt; a, then (`f` b) :: a -&gt; a\n[ (`f` b) | b &lt;- [b0, b1], f &lt;- [f0, f1] ]\n-- Result: [(`f0` b0), (`f1` b0), (`f0` b1), (`f1` b1)]\n</code></pre>\n\n<p>(It would be nice to use <code>fs &lt;*&gt; bs</code> but you need to partially apply <code>f</code> to its <em>second</em> argument, not first, and the resulting list would have the wrong order for the composition step.)</p>\n\n<p>Next, fold that list with <code>(.)</code>. I can never quite remember which fold to use (or how to use it to ensure the correct ordering you need), so here is a custom recursive function that I know does the right thing:</p>\n\n<pre><code>composeAll :: [(a -&gt; a)]\ncomposeAll [] = id\ncomposeAll (f:fs) = composeAll fs . f\n</code></pre>\n\n<p>Putting it all together:</p>\n\n<pre><code>fs = [f0, f1, f2]\nbs = [b0, b1, b2]\nf = composeAll [(`f` b) | b &lt;- bs, f &lt;- fs]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462978322, "post_id": 37166187, "comment_id": 61867772, "body": "Nice; I wasn&#39;t aware of <code>&lt;**&gt;</code>."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1462979856, "post_id": 37166187, "comment_id": 61868918, "body": "I find <code>zipWith flip fs bs</code> much more readable then <code>bs &lt;**&gt; (map flip fs)</code>."}], "tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": false, "score": 3, "last_activity_date": 1462978423, "last_edit_date": 1462978423, "creation_date": 1462978143, "answer_id": 37166187, "question_id": 37165461, "link": "https://stackoverflow.com/questions/37165461/outer-product-partially-applied-functions-composition/37166187#37166187", "title": "outer product -&gt; partially applied functions -&gt; composition", "body": "<p>You can use <code>&lt;**&gt;</code> (which is located in <code>Control.Applicative</code>) and <code>fold</code> the result:</p>\n\n<pre><code>combine :: [(a -&gt; b -&gt; a)] -&gt; [b] -&gt; (a -&gt; a)\ncombine fs bs = foldr (flip (.)) id $ bs &lt;**&gt; (map flip fs)\n</code></pre>\n\n<p>Let's have a look at the components:</p>\n\n<pre><code>map flip fs\n</code></pre>\n\n<p>This just flips the functions from <code>a -&gt; b -&gt; a</code> to <code>b -&gt; a -&gt; a</code> so we can <code>ap</code> them later on.</p>\n\n<pre><code>bs &lt;**&gt; (map flip fs)\n-- ex: [b0, b1] &lt;**&gt; [f0, f1] == [f0 b0, f1 b0, f0 b1, f1 b1]\n</code></pre>\n\n<p>This function partially applys all the <code>bs</code> to the <code>fs</code> and puts them in a list. All we have to do now is to <code>fold</code> the result using the composition operator (<code>(.)</code>). Note that using <code>flip (.)</code> we reverse order of composition since the list generated by <code>&lt;**&gt;</code> is the reverse of what we want:</p>\n\n<pre><code>foldr (flip (.)) id $ it -- alternatively foldr1\n-- ex: foldr (flip (.)) id [f0 b0, f1 b0, f0 b1, f1 b1] ==\n--     (f1 b1) . (f0 b1) . (f1 b0) . (f0 b0)\n</code></pre>\n"}], "owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 37166144, "answer_count": 2, "score": 3, "last_activity_date": 1462980810, "creation_date": 1462976400, "question_id": 37165461, "link": "https://stackoverflow.com/questions/37165461/outer-product-partially-applied-functions-composition", "title": "outer product -&gt; partially applied functions -&gt; composition", "body": "<p>I have a list of binary functions such that <code>(a -&gt; b -&gt; a)</code> and a list of items <code>[b]</code>.  I need to produce a transformation <code>(a -&gt; a)</code> as follows.  For each of the bs I need to partially apply the functions and produce their composition, which gives me a list of unary functions the same length as the bs.  Call each of these compositions a processor;  I next need to compose the processors. So for example, if I have functions <code>[f0,f1]</code> and items <code>[b0,b1]</code>, I need the function <code>(f1 b1) . (f0 b1) . (f1 b0) . (f0 b0)</code>.  I can see that I'm folding across the bs, but this also looks like a composition of an outer product.  So, does Haskell offer a clever way to produce this with some kind of outer product? (Order matters, of course.) If so, please explain in terms understandable to a complete novice.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1462974752, "post_id": 37164604, "comment_id": 61864941, "body": "to make your errors clearer start by adding explicit type signatures - what input are your functions expecting - what output are you expecting. note haskell has no automatic type conversion - you need to explicitly call <code>fromIntegral</code> if you want to have an <code>Int</code> used as a <code>Double</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1462974843, "post_id": 37164604, "comment_id": 61865037, "body": "also note there are functions <code>odd</code> and <code>even</code>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1462974928, "post_id": 37164604, "comment_id": 61865122, "body": "We really need MathJax support. The formula is barely readable."}, {"owner": {"reputation": 886, "user_id": 2398479, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/dd43348c16d5bfdb295185cc08025d34?s=128&d=identicon&r=PG", "display_name": "Emre Alparslan", "link": "https://stackoverflow.com/users/2398479/emre-alparslan"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462975997, "post_id": 37164604, "comment_id": 61866026, "body": "@epsilonhalbe thank you for your answers. I tried chi&#39;s answer which is the same logic with yours."}], "answers": [{"comments": [{"owner": {"reputation": 886, "user_id": 2398479, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/dd43348c16d5bfdb295185cc08025d34?s=128&d=identicon&r=PG", "display_name": "Emre Alparslan", "link": "https://stackoverflow.com/users/2398479/emre-alparslan"}, "edited": false, "score": 0, "creation_date": 1462975923, "post_id": 37164795, "comment_id": 61865964, "body": "Thank you for your answer. It works like a charm! I&#39;m trying to understand the logic of Haskell. It helped so much!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1462974827, "creation_date": 1462974827, "answer_id": 37164795, "question_id": 37164604, "link": "https://stackoverflow.com/questions/37164604/haskell-the-type-variable-a0-is-ambiguous-error/37164795#37164795", "title": "Haskell &quot;The type variable `a0&#39; is ambiguous&quot; Error", "body": "<p>Always add signatures, for better errors.</p>\n\n<pre><code>fact :: Int -&gt; Int\nfact x = product [1..x]\n\ncosSeries :: Double -&gt; Int -&gt; Double\ncosSeries x l = sum[(helperOfCos x i pointer)\n        |i&lt;-[0..l], i `mod` 2 == 0, pointer&lt;-[0..l]]\n\n\nhelperOfCos :: Double -&gt; Int -&gt; Int -&gt; Double\nhelperOfCos x i p = if p `mod` 2 == 0\n        then x^i / fromIntegral (fact i)\n        else -(x^i) / fromIntegral (fact i)\n</code></pre>\n\n<p>Here the problem was the lack of the last two <code>fromIntegral</code>. Indeed, <code>fact i</code> returned an integral type (since <code>mod</code> above forces <code>i</code> to be integral), but <code>/</code> requires a floating type.</p>\n\n<p>Without the conversion, we would get a type with an unsatisfiable constraint:</p>\n\n<pre><code>&gt; :t cosSeries \ncosSeries :: (Fractional a, Integral a) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Also note that <code>fact</code> will quickly generate very large numbers and cause overflows. You can prevent that using <code>Integer</code> instead of <code>Int</code>, or reworking your code so to avoid computing the factorial at each step.</p>\n"}], "owner": {"reputation": 886, "user_id": 2398479, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/dd43348c16d5bfdb295185cc08025d34?s=128&d=identicon&r=PG", "display_name": "Emre Alparslan", "link": "https://stackoverflow.com/users/2398479/emre-alparslan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 37164795, "answer_count": 1, "score": 0, "last_activity_date": 1462974918, "creation_date": 1462974375, "last_edit_date": 1462974918, "question_id": 37164604, "link": "https://stackoverflow.com/questions/37164604/haskell-the-type-variable-a0-is-ambiguous-error", "title": "Haskell &quot;The type variable `a0&#39; is ambiguous&quot; Error", "body": "<p>I'm trying to write a function for this series.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MnMlU.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MnMlU.gif\" alt=\"Cos Series\"></a></p>\n\n<p>Code is here:</p>\n\n<pre><code>fact x = product [1..x]\n\ncosSeries x l = sum[(helperOfCos x i pointer)\n        |i&lt;-[0..l], i `mod` 2 == 0, pointer&lt;-[0..l]]\n\n\nhelperOfCos x i p = if p `mod` 2 == 0\n        then x**i/(fact i)\n        else -(x**i)/(fact i)\n</code></pre>\n\n<p>And I'm getting this error:</p>\n\n<pre><code>*Main&gt; cosSeries 2 2\n\n&lt;interactive&gt;:2:1:\nNo instance for (Integral a0) arising from a use of `cosSeries'\nThe type variable `a0' is ambiguous\nPossible fix: add a type signature that fixes these type variable(s)\nNote: there are several potential instances:\n  instance Integral Int -- Defined in `GHC.Real'\n  instance Integral Integer -- Defined in `GHC.Real'\n  instance Integral GHC.Types.Word -- Defined in `GHC.Real'\nIn the expression: cosSeries 2 2\nIn an equation for `it': it = cosSeries 2 2\n\n&lt;interactive&gt;:2:11:\nNo instance for (Num a0) arising from the literal `2'\nThe type variable `a0' is ambiguous\nPossible fix: add a type signature that fixes these type variable(s)\nNote: there are several potential instances:\n  instance Num Double -- Defined in `GHC.Float'\n  instance Num Float -- Defined in `GHC.Float'\n  instance Integral a =&gt; Num (GHC.Real.Ratio a)\n    -- Defined in `GHC.Real'\n  ...plus three others\nIn the first argument of `cosSeries', namely `2'\nIn the expression: cosSeries 2 2\nIn an equation for `it': it = cosSeries 2 2\n</code></pre>\n\n<p>I couldn't understand solution of similar questions in stackoverflow.</p>\n\n<p>Can you help me about that error?</p>\n\n<p>Thanks..</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "is_accepted": false, "score": 4, "last_activity_date": 1462970909, "last_edit_date": 1462970909, "creation_date": 1462970527, "answer_id": 37163055, "question_id": 37163000, "link": "https://stackoverflow.com/questions/37163000/own-monad-transformer-and-lifting/37163055#37163055", "title": "Own Monad Transformer and lifting", "body": "<p>You dont seem to have any instance of MonadTrans in context so <code>lift</code> does not exist.</p>\n\n<p>But more importantly, look at the type of the functions.\n<code>x</code> is a value of type <code>a</code>  and <code>return x</code> needs to give an element of type <code>(InterpreterMT m) a</code>.</p>\n\n<p>For this you need to use the data constructor <code>InterpreterMT</code> and give it a  <code>m (InterpreterM a)</code></p>\n\n<p>which means the body of return should be like </p>\n\n<pre><code>return . PropInterpreter $ x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1463071902, "post_id": 37166458, "comment_id": 61918569, "body": "I think this entails that <code>InterpreterMT (return (PropInterpreter a)) &gt;&gt;= return</code> = <code>InterpreterMT (return (ExeInterpreter a))</code> which violates <code>x &gt;&gt;= return = x</code>"}, {"owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1463077414, "post_id": 37166458, "comment_id": 61921835, "body": "You are totally right. This is a simplified EitherT definition, but the important difference is that we have only one type parameter and not two like Either. One should change the case expression to <code>(PropInterpreter a) -&gt; return (PropInterpreter a)</code>, but the typechecker throws an error because it can&#39;t match the expeced <code>InterpreterMT m b</code> with the <code>InterpreterMT m a</code>. Unfortunately I don&#39;t know a solution to this."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1463080756, "post_id": 37166458, "comment_id": 61923761, "body": "Right, I <i>think</i>  both cases should apply <code>f</code> to <code>a</code> and then go in and match again, assembling the result. In this answer to <a href=\"http://stackoverflow.com/questions/37187933/lift-monad-reader-local/37190716#37190716\">his other question</a> I just reduce InterpreterMT to (a certain) Monoid + WriterT which has the advantage of being clear, but the answer is too complicated to be practical. I think the correct monad instance will effectively inline a monoid m + the monad instance for (m,)/WriterT m"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1463092433, "post_id": 37166458, "comment_id": 61929474, "body": "<code>(return . ExeInterpreter) =&lt;&lt; ma</code> can be shortened to <code>fmap ExeInterpreter ma</code>."}], "tags": [], "owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "is_accepted": true, "score": 5, "last_activity_date": 1462978780, "creation_date": 1462978780, "answer_id": 37166458, "question_id": 37163000, "link": "https://stackoverflow.com/questions/37163000/own-monad-transformer-and-lifting/37166458#37166458", "title": "Own Monad Transformer and lifting", "body": "<p>What nicolas said. I didn't use the point-free style, so it might be a little bit easier to understand the types. You can look into example implementations to get a better feeling for transformers - <a href=\"http://hackage.haskell.org/package/transformers-0.4.2.0/docs/Control-Monad-Trans-Class.html#t:MonadTrans\">Control.Monad.Trans.Class</a></p>\n\n<pre><code>data InterpreterM a = ExeInterpreter a\n                    | PropInterpreter a\n\nnewtype InterpreterMT m a = InterpreterMT { runInterpreterMT :: m (InterpreterM a) }\n\ninstance (Monad m) =&gt; Monad (InterpreterMT m) where\n\n--  return :: Monad m =&gt; a -&gt; InterpreterMT m a\n    return x = InterpreterMT $ (return . ExeInterpreter) x\n\n-- or after you defined MonadTrans below\n--  return x = lift . return $ x\n\n--  (&gt;&gt;=) :: Monad m =&gt; InterpreterMT m a -&gt; (a -&gt; InterpreterMT m b) -&gt; InterpreterMT m b\n    (&gt;&gt;=) ima f = InterpreterMT $ do\n        ia &lt;- runInterpreterMT ima\n        case ia of\n            (ExeInterpreter  a) -&gt; runInterpreterMT $ f a\n            (PropInterpreter a) -&gt; runInterpreterMT $ f a\n\ninstance MonadTrans InterpreterMT where\n\n--  lift :: Monad m =&gt; m a -&gt; InterpreterMT m a\n    lift ma = InterpreterMT $ (return . ExeInterpreter) =&lt;&lt; ma\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 37166458, "answer_count": 2, "score": 1, "last_activity_date": 1462978780, "creation_date": 1462970372, "question_id": 37163000, "link": "https://stackoverflow.com/questions/37163000/own-monad-transformer-and-lifting", "title": "Own Monad Transformer and lifting", "body": "<pre><code>data InterpreterM a = ExeInterpreter a | PropInterpreter a\n\nnewtype InterpreterMT m a = InterpreterMT { runInterpreterMT :: m (InterpreterM a) }\n\ninstance (Monad m) =&gt; Monad (InterpreterMT m) where\n    return x = lift . return\n    x &gt;&gt;= f = InterpreterMT $ do\n        m &lt;- runInterpreterMT x\n        case m of\n            (ExeInterpreter a) -&gt; runInterpreterMT (f a) \n\ninstance MonadTrans InterpreterMT where\n    lift m = lift .  (ExeInterpreter m)\n</code></pre>\n\n<p>I've got error, and I don't know why:</p>\n\n<pre><code>Interpreter.hs:25:20:\n    Couldn't match expected type `InterpreterMT m a'\n                with actual type `a2 -&gt; t1 m1 a2'\n    In the expression: lift . return\n    In an equation for `return': return x = lift . return\n    In the instance declaration for `Monad (InterpreterMT m)'\n\nInterpreter.hs:32:18:\n    Couldn't match expected type `InterpreterMT m a'\n                with actual type `a0 -&gt; t0 m0 a1'\n    In the expression: lift . (ExeInterpreter m)\n    In an equation for `lift': lift m = lift . (ExeInterpreter m)\n    In the instance declaration for `MonadTrans InterpreterMT'\n\nInterpreter.hs:32:27:\n    Couldn't match expected type `a0 -&gt; m0 a1'\n                with actual type `InterpreterM (m a)'\n    In the return type of a call of `ExeInterpreter'\n    Probable cause: `ExeInterpreter' is applied to too many arguments\n    In the second argument of `(.)', namely `(ExeInterpreter m)'\n    In the expression: lift . (ExeInterpreter m)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "answers": [{"tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": false, "score": 4, "last_activity_date": 1462982472, "creation_date": 1462982472, "answer_id": 37167828, "question_id": 37162831, "link": "https://stackoverflow.com/questions/37162831/configuring-snap-for-performance/37167828#37167828", "title": "Configuring Snap for performance", "body": "<p>I'm by no means an expert on the subject so I can only really answer your first question, and yes you are comparing apples and oranges (and also bananas without realizing it). </p>\n\n<p>First off, it looks like you are attempting to benchmark <em>different</em> things, so naturally, your results will be inconsistent. One of these is the sample Snap application and the other is just \"a Grails application\". What exactly are each of these things doing? Are you serving pages? Handling requests? The difference in applications will explain the differences in performance. </p>\n\n<p>Secondly, the difference in RAM usage also shows the difference in what these applications are doing. Haskell web frameworks are very good at handling large instances without much RAM where other frameworks, like Tomcat as you saw, will be limited in their performance with limited RAM. Try limiting both applications to 100mb and see what happens to your performance difference. </p>\n\n<p>If you want to compare the different frameworks, you really need to run a standard application to do that. Snap did this with a Pong benchmark. The results of an old test (from 2011 and Snap 0.3) can be seen <a href=\"http://snapframework.com/blog/2010/11/17/snap-0.3-benchmarks\" rel=\"nofollow\">here</a>. This paragraph is extremely relevant to your situation: </p>\n\n<blockquote>\n  <p>If you\u2019re comparing this with our previous results you will notice that we left out Grails. We discovered that our previous results for Grails may have been too low because the JVM had not been given time to warm up. The problem is that after the JVM warms up for some reason httperf isn\u2019t able to get any samples from which to generate a replies/sec measurement, so it outputs 0.0 replies/sec. There are also 1000 connreset errors, so we decided the Grails numbers were not reliable enough to use.</p>\n</blockquote>\n\n<p>As a comparison, the Yesod blog has a Pong benchmark from around the same time that shows similar results. You can find that <a href=\"http://www.yesodweb.com/blog/2011/03/preliminary-warp-cross-language-benchmarks\" rel=\"nofollow\">here</a>. They also link to their benchmark code if you would like to try to run a more similar benchmark, it is <a href=\"https://github.com/yesodweb/benchmarks\" rel=\"nofollow\">available on Github</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "is_accepted": true, "score": 2, "last_activity_date": 1463500031, "last_edit_date": 1463500031, "creation_date": 1463079138, "answer_id": 37195233, "question_id": 37162831, "link": "https://stackoverflow.com/questions/37162831/configuring-snap-for-performance/37195233#37195233", "title": "Configuring Snap for performance", "body": "<p>The answer by jkeuhlen makes good observations relevant to your first question.  As to your second question, there are definitely things you can play with to tune performance.  If you look at Snap's <a href=\"https://github.com/snapframework/snap-benchmarks/blob/master/results.txt#L182\" rel=\"nofollow\">old raw result data</a>, you can see that we were running the application with <code>+RTS -A4M -N4</code>.  The <code>-N4</code> option tells the GHC runtime to use 4 threads.  (Note that you have to build the application with <code>-threaded</code> to do this.)  The <code>-A4M</code> option sets the size of the garbage collector's allocation area.  Our experiments showed that these two seemed to have the biggest impact on performance.  But that was done a long time ago and GHC has changed a lot since then, so you probably want to play around with them and find what works best for you.  <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime-control.html\" rel=\"nofollow\">This page</a> has in-depth information about other command line options available to control GHC's runtime if you wish to do more experimentation.</p>\n\n<p>A little work was done last year on updating the benchmarks.  If you're interested in that, look around the different branches in the <a href=\"https://github.com/snapframework/snap-benchmarks\" rel=\"nofollow\">snap-benchmarks repository</a>.  It would be great to get more help on a new set of benchmarks.</p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 2, "accepted_answer_id": 37195233, "answer_count": 2, "score": 4, "last_activity_date": 1463500031, "creation_date": 1462969958, "last_edit_date": 1495541293, "question_id": 37162831, "link": "https://stackoverflow.com/questions/37162831/configuring-snap-for-performance", "title": "Configuring Snap for performance", "body": "<p>I'm just playing with the Snap framework and wanted to see how it performs against other frameworks (under completely artificial circumstances).</p>\n\n<p>What I have found is that my Snap application tops out at about 1500 requests/second (the app is simply <code>snap init; snap build; ./dist/app/app</code>, ie. no code changes to the default app created by snap):</p>\n\n<pre><code>$ ab -n 20000 -c 500 http://127.0.0.1:8000/                                        \nThis is ApacheBench, Version 2.3 &lt;$Revision: 1706008 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking 127.0.0.1 (be patient)\nCompleted 2000 requests\nCompleted 4000 requests\nCompleted 6000 requests\nCompleted 8000 requests\nCompleted 10000 requests\nCompleted 12000 requests\nCompleted 14000 requests\nCompleted 16000 requests\nCompleted 18000 requests\nCompleted 20000 requests\nFinished 20000 requests\n\n\nServer Software:        Snap/0.9.5.1\nServer Hostname:        127.0.0.1\nServer Port:            8000\n\nDocument Path:          /\nDocument Length:        721 bytes\n\nConcurrency Level:      500\nTime taken for tests:   12.845 seconds\nComplete requests:      20000\nFailed requests:        0\nTotal transferred:      17140000 bytes\nHTML transferred:       14420000 bytes\nRequests per second:    1557.00 [#/sec] (mean)\nTime per request:       321.131 [ms] (mean)\nTime per request:       0.642 [ms] (mean, across all concurrent requests)\nTransfer rate:          1303.07 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0   44 287.6      0    3010\nProcessing:     6  274 153.6    317    1802\nWaiting:        5  274 153.6    317    1802\nTotal:         20  318 346.2    317    3511\n\nPercentage of the requests served within a certain time (ms)\n  50%    317\n  66%    325\n  75%    334\n  80%    341\n  90%    352\n  95%    372\n  98%   1252\n  99%   2770\n 100%   3511 (longest request)\n</code></pre>\n\n<p>I then fired up a Grails application, and it seems like Tomcat (once the JVM warms up) can take a bit more load:</p>\n\n<pre><code>$ ab -n 20000 -c 500 http://127.0.0.1:8080/test-0.1/book                                                                                                                                                                                                     \nThis is ApacheBench, Version 2.3 &lt;$Revision: 1706008 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking 127.0.0.1 (be patient)\nCompleted 2000 requests\nCompleted 4000 requests\nCompleted 6000 requests\nCompleted 8000 requests\nCompleted 10000 requests\nCompleted 12000 requests\nCompleted 14000 requests\nCompleted 16000 requests\nCompleted 18000 requests\nCompleted 20000 requests\nFinished 20000 requests\n\n\nServer Software:        Apache-Coyote/1.1\nServer Hostname:        127.0.0.1\nServer Port:            8080\n\nDocument Path:          /test-0.1/book\nDocument Length:        722 bytes\n\nConcurrency Level:      500\nTime taken for tests:   4.366 seconds\nComplete requests:      20000\nFailed requests:        0\nTotal transferred:      18700000 bytes\nHTML transferred:       14440000 bytes\nRequests per second:    4581.15 [#/sec] (mean)\nTime per request:       109.143 [ms] (mean)\nTime per request:       0.218 [ms] (mean, across all concurrent requests)\nTransfer rate:          4182.99 [Kbytes/sec] received\n\nConnection Times (ms)\n              min  mean[+/-sd] median   max\nConnect:        0   67 347.4      0    3010\nProcessing:     1   30  31.4     21     374\nWaiting:        0   26  24.4     20     346\nTotal:          1   97 352.5     21    3325\n\nPercentage of the requests served within a certain time (ms)\n  50%     21\n  66%     28\n  75%     35\n  80%     42\n  90%     84\n  95%    230\n  98%   1043\n  99%   1258\n 100%   3325 (longest request)\n</code></pre>\n\n<p>I'm guessing that a part of this could be the fact that Tomcat seems to reserve a lot of RAM and can keep/cache some methods. During this experiment Tomcat was using in excess of 700mb or RAM while Snap barely approached 70mb.</p>\n\n<p>Questions I have:</p>\n\n<ul>\n<li>Am I comparing apples and oranges here?</li>\n<li>What steps would one take to optimise Snap for throughput/speed?</li>\n</ul>\n\n<hr>\n\n<p>Further experiments:</p>\n\n<p>Then, as suggested by <a href=\"https://stackoverflow.com/users/527460/mightybyte\">mightybyte</a>, I started experimenting with <code>+RTS -A4M -N4</code> options. The app was able to serve just over 2000 requests per second (about 25% increase).</p>\n\n<p>I also removed the nested templating and served a document (same size as before) from the top level <code>tpl</code> file. This increased the performance to just over 7000 requests a second. The memory usage went up to about 700MB.</p>\n"}, {"tags": ["haskell", "events", "concurrency", "stm"], "answers": [{"comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1462970133, "post_id": 37162520, "comment_id": 61860979, "body": "I am performing STM in my server, and I&#39;d like to display to the user some text (post a message to his UI) as to why the transaction has failed, so that he fixes the form submission and writes to the TVar again."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 5, "creation_date": 1462971331, "post_id": 37162520, "comment_id": 61862021, "body": "@nicolas Use <a href=\"https://hackage.haskell.org/package/stm-2.4.4.1/docs/Control-Monad-STM.html#v:orElse\" rel=\"nofollow noreferrer\"><code>orElse</code></a> and return a success/failure code. <code>atomically $ (myPossiblyFailingSTMAction &gt;&gt; return True) `orElse` (return False)</code>. If you get <code>False</code> you know <code>myPossiblyFailingSTMAction</code> failed. Much cleaner than <code>unsafeIOToSTM</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 1, "creation_date": 1462974370, "post_id": 37162520, "comment_id": 61864588, "body": "@nicolas In this case, one should make the transaction succeed but return a &quot;failure&quot; result, as Benjamin Hodgson suggests."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1462977886, "post_id": 37162520, "comment_id": 61867470, "body": "@BenjaminHodgson indeed, but that&#39;s control flow which is orthogonal to delivering a STM value. what would be cleaner IMO would be to have a notion of directionality somewhere, where sending out information to a region of IO which is independant of my IO region is allowed"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1462978566, "post_id": 37162520, "comment_id": 61867949, "body": "@nicolas I don&#39;t understand your comment. If you need to return a value from your <code>STM</code> block then it&#39;s pretty easy to modify my suggestion: <code>atomically $ (fmap Just myAction) `orElse` (return Nothing)</code> (aka <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Applicative.html#v:optional\" rel=\"nofollow noreferrer\"><code>optional</code></a>)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1462979491, "post_id": 37162520, "comment_id": 61868612, "body": "@nicolas I see. That would make <code>atomically</code> not completely atomic, but that could be useful in some scenarios. I think that is currently unfeasible without <code>unsafe</code> primitives. It could be worth to wrap up the <code>unsafe</code>, directional approach in a library, maybe using a custom <code>STM&#39;</code> variant which allows <code>retry value</code> making the value visible somehow. I am not sure about what a sensible design here could be (nor if there is one, actually)."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1462979528, "post_id": 37162520, "comment_id": 61868645, "body": "@BenjaminHodgson I mean the final value. whatever correction steps my user has to do to the input TVar is between him and the STM monad. I could indeed mix this control flow with my applicative logic. That&#39;s the point of retry, you leave it to the STM and .. itself (like the giveItem example from RWH <a href=\"http://book.realworldhaskell.org/read/software-transactional-memory.html\" rel=\"nofollow noreferrer\">book.realworldhaskell.org/read/&hellip;</a> ). but you could open that loop and leave it to the STM and the client where they are contrained in the data flow."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1462979822, "post_id": 37162520, "comment_id": 61868883, "body": "@nicolas I just remembered that STM reads may refer to an <i>inconsistent</i> state (since no locks are used), and that might cause a retry for a spurious reason (which should not be reported to the user). In such cases, <code>atomically</code> observes the retry, notices that some previously read <code>TVar</code> was changed, and re-attempts the transaction. To exclude these cases you would need - it seems - more information than what the STM library currently exposes."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1462980041, "post_id": 37162520, "comment_id": 61869070, "body": "@nicolas I still don&#39;t really understand you. Are you suggesting continually retrying the transaction and asking the user to modify the <code>TVar</code> on another thread in the meantime? That seems like a strange thing to do. Why not just abort the transaction, ask the user to take corrective action, and retry when they&#39;ve done so?"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1462980189, "post_id": 37162520, "comment_id": 61869162, "body": "@BenjaminHodgson for the same reason as those exposed in the RWH in their &quot;Retrying a transaction&quot; section : &quot;Not only do we have to check whether the item was given, we have to propagate an indication of success back to our caller. The complexity thus cascades outwards &quot; it&#39;s mixing control flow for getting a value with control flow for the application... STM can take care of it by itself when not touching IO with retry, and you could imagine it taking care of it when talking directionally with another system. But I dont think it can as pointed out by chi"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1462980481, "post_id": 37162520, "comment_id": 61869365, "body": "@BenjaminHodgson My understanding is that to &quot;ask the user to take corrective action&quot; we need to report the problem to the user. The problem is known at the <code>retry</code> point, but that information can not (easily) escape the STM monad. The non-compositional option is to <code>return (Left &quot;reason&quot;)</code> instead of retrying, which requires to use a different <code>orElse</code> which is aware of this convention. Worse, when returning the error we probably do <i>not</i> want the previous writes to take effect. It&#39;s quite tricky, and I am not yet sure that the approach can actually work sensibly."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 3, "creation_date": 1462980822, "post_id": 37162520, "comment_id": 61869597, "body": "@nicolas I think I see what you mean now - you want the automatic wait/retry functionality of STM but you also want to report the occurrence and circumstances of a retry to the user. I&#39;m afraid your idea is not (safely) compatible with the semantics of STM. It&#39;s a <i>transaction</i> - either the whole transaction successfully took place or none of it did. Putting IO inside a transaction breaks the &quot;or none of it did&quot; part. The RWH chapter on STM has some guidance on when <code>unsafeIOToSTM</code> is appropriate"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1462989651, "post_id": 37162520, "comment_id": 61875094, "body": "@BenjaminHodgson you got the idea. ultimately that&#39;s a transaction. but retry is about the way to the commit, abstracting it away. I wanted to have the same abstraction, taking into account the fact that I have a user in front who would benefit of a clue to help the transaction to happen. and he is on a independant system than mine, so it is safe to send him a message as to why if my applicative logic has decided to not proceed with the transaction. I think you are right STM semantic is not good for that.. although I wish there was a way.."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1463219087, "post_id": 37162520, "comment_id": 61980289, "body": "Thank you for the discussion, it helped me clarify a bit. I am wondering if it would may be possible with a refinement of IO. A clearer analogy is memoization. From outside I am pure. Now inside I might need IO but it&#39;s not the business of my users. In the normal course of operation it should be hidden. Maybe adding some typelevel quantification could allow me to hide that IO externally, and give structure to distinguish IO from here from IO from there"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1462969198, "creation_date": 1462969198, "answer_id": 37162520, "question_id": 37162112, "link": "https://stackoverflow.com/questions/37162112/stm-and-outgoing-io/37162520#37162520", "title": "STM and outgoing IO", "body": "<p>If you are sure that the performed IO does not affect the invariants of STM, you can use\n<a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/GHC-Conc-Sync.html#v:unsafeIOToSTM\" rel=\"nofollow\"><code>unsafeIOToSTM</code></a>. Use it with great care, as all the <code>unsafe</code> stuff.</p>\n\n<p>I do, however, wonder if you really need that. It's impossible to tell from the question. If you can, you should avoid it.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 1, "accepted_answer_id": 37162520, "answer_count": 1, "score": 4, "last_activity_date": 1462969198, "creation_date": 1462968216, "question_id": 37162112, "link": "https://stackoverflow.com/questions/37162112/stm-and-outgoing-io", "title": "STM and outgoing IO", "body": "<p>If I am inside a STM whose transaction fail, and I retry as part of the normal control flow (no STM collision etc..), I might want to indicate to someone outside a way to take corrective action.</p>\n\n<p>If it's purely 'outgoing', then my STM can still be replayed purely.</p>\n\n<p>How might I perform <strong><em>outgoing</em></strong> IO from a STM retry ?</p>\n\n<p>Has anyone encountered this ? How evil is this ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1462963456, "post_id": 37159634, "comment_id": 61856057, "body": "<a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Word.html#t:Word8\" rel=\"nofollow noreferrer\"><code>Data.Word</code></a>?"}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1462963720, "post_id": 37159634, "comment_id": 61856228, "body": "Yep, this is perfect. Thank you !"}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1462963950, "post_id": 37159634, "comment_id": 61856408, "body": "Good to hear; I&#39;m still learning my way around Haskell myself, but I found it via Hoogle."}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1462963993, "post_id": 37159634, "comment_id": 61856437, "body": "Added link to my favorites, thank you."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462968746, "post_id": 37159634, "comment_id": 61859908, "body": "off topic - you are using a really old version of GHC (8.0.1 is soon to be released) <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow noreferrer\">here</a> is a ppa"}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462970921, "post_id": 37159634, "comment_id": 61861637, "body": "@epsilonhalbe Thank you. As an aside question, I only joined the world of Linux a year ago, and while I have gained some practice at installing software from source (configure, make, make install), I am still reluctant to do this for packages which may conflict with those of my &#39;official&#39; Debian repository for fear that this may corrupt my system. Am I being overly cautious, or am I right in thinking I should abstain from this sort of upgrade until I know precisely what I am doing?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462973014, "post_id": 37159634, "comment_id": 61863470, "body": "am using &quot;configure, make, sudo checkinstall&quot; - and i am rarely using software that is not in a repo, or I only install it for my user - in &quot;~/bin/&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "is_accepted": true, "score": 6, "last_activity_date": 1462963900, "creation_date": 1462963900, "answer_id": 37160451, "question_id": 37159634, "link": "https://stackoverflow.com/questions/37159634/what-import-is-required-for-symbol-word8-to-be-in-scope/37160451#37160451", "title": "What `import` is required for symbol `Word8` to be in scope", "body": "<p>The definition can be found in <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Word.html#t:Word8\" rel=\"noreferrer\"><code>Data.Word</code></a>.</p>\n\n<p>For future reference, <a href=\"https://www.haskell.org/hoogle/\" rel=\"noreferrer\">Hoogle</a> is really nice to look up where symbols come from.</p>\n"}], "owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 37160451, "answer_count": 1, "score": 1, "last_activity_date": 1462963900, "creation_date": 1462961851, "question_id": 37159634, "link": "https://stackoverflow.com/questions/37159634/what-import-is-required-for-symbol-word8-to-be-in-scope", "title": "What `import` is required for symbol `Word8` to be in scope", "body": "<p>This feels like a trivial question, but it has been nagging me for a while now: in the course of following 'Real World Haskell', I have been trying out sample code with the <code>Word8</code> data type, using the <code>Data.ByteString.Lazy.Char8</code> module. Most of it works fine, but I had to remove type declaration involving the symbol <code>Word8</code> as ghci would not recognize it. When using the :type ghci on some function involving this type, it is referred to as <code>GHC.Word.Word8</code>, yet replacing <code>Word8</code> by <code>GHC.Word.Word8</code> in the code doesn't improve things, and any <code>import</code> statement I have guessed around <code>GHC.Word.Word8</code> has failed. I have looked online on the hackage site which suggest <code>Data.Word8</code> but this failed to. Searching for earlier posts on this forum did not give me an answer. I am using:<code>GHCi, version 7.6.3: http://www.haskell.org/ghc/</code> on Debian 8. </p>\n"}, {"tags": ["haskell", "yesod", "persistent"], "comments": [{"owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "edited": false, "score": 1, "creation_date": 1462969176, "post_id": 37159124, "comment_id": 61860245, "body": "Reproduced with persistent-2.2.2.1. Looks like the it happens <a href=\"http://haddock.stackage.org/lts-5.16/persistent-template-2.1.8/src/Database-Persist-TH.html#mkEntity\" rel=\"nofollow noreferrer\">haddock.stackage.org/lts-5.16/persistent-template-2.1.8/src/&zwnj;&#8203;&hellip;</a> in <code>addSyn</code>. If mpsGeneric is False this will be <code>id</code> and it works as expected. I think the bad deriving of Eq happens here <a href=\"http://haddock.stackage.org/lts-5.16/persistent-2.2.4.1/src/Database-Persist-Class-PersistEntity.html#Key\" rel=\"nofollow noreferrer\">haddock.stackage.org/lts-5.16/persistent-2.2.4.1/src/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2878, "user_id": 655862, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bad65d3d7319025d73e065d7a29ee22a?s=128&d=identicon&r=PG", "display_name": "Greg Weber", "link": "https://stackoverflow.com/users/655862/greg-weber"}, "is_accepted": true, "score": 1, "last_activity_date": 1463198358, "creation_date": 1463198358, "answer_id": 37222359, "question_id": 37159124, "link": "https://stackoverflow.com/questions/37159124/the-eq-instance-of-a-key-with-mpsgeneric-enabled-seems-strange/37222359#37222359", "title": "The Eq instance of a Key with mpsGeneric enabled seems strange", "body": "<p>This is a bug. It is reported on github now: <a href=\"https://github.com/yesodweb/persistent/issues/560\" rel=\"nofollow\">https://github.com/yesodweb/persistent/issues/560</a></p>\n"}], "owner": {"reputation": 113, "user_id": 5532935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f9f7776476d9787e71931078a981718?s=128&d=identicon&r=PG&f=1", "display_name": "uuhan", "link": "https://stackoverflow.com/users/5532935/uuhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 37222359, "answer_count": 1, "score": 0, "last_activity_date": 1463198358, "creation_date": 1462960698, "last_edit_date": 1462961658, "question_id": 37159124, "link": "https://stackoverflow.com/questions/37159124/the-eq-instance-of-a-key-with-mpsgeneric-enabled-seems-strange", "title": "The Eq instance of a Key with mpsGeneric enabled seems strange", "body": "<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE QuasiQuotes #-}\nmodule Main\n  where\n\nimport           Database.Persist.Sql\nimport           Database.Persist.TH\n\nshare\n    [mkPersist\n        sqlSettings\n            { mpsGeneric = True\n            , mpsPrefixFields = False\n            , mpsEntityJSON = Just EntityJSON\n                                { entityToJSON = 'keyValueEntityToJSON\n                                , entityFromJSON = 'keyValueEntityFromJSON\n                                }\n            , mpsGenerateLenses = False\n            }\n    , mkMigrate \"abc\"]\n    [persistLowerCase|\nTest\n    a String\n|]\n\nmain :: IO ()\nmain = do\n    print $ (toSqlKey 1 :: TestId) /= (toSqlKey 1 :: TestId)\n    print $ (toSqlKey 1 :: TestId) == (toSqlKey 1 :: TestId)\n\n    print $ (toSqlKey 1 :: TestId) /= (toSqlKey 2 :: TestId)\n    print $ (toSqlKey 1 :: TestId) == (toSqlKey 2 :: TestId)\n</code></pre>\n\n<p>In this haskell program, I enable the mpsGeneric switch, and the result of this program is:</p>\n\n<pre><code>True\nTrue\nFalse\nFalse\n</code></pre>\n\n<p>If disable mpsGeneric, the result is:</p>\n\n<pre><code>True\nFalse\nFalse\nTrue\n</code></pre>\n\n<p>It seems that, the Eq instance the above one is broken.\nI test the program with </p>\n\n<pre><code>persistent of version 2.2.4.1\npersistent-template of version 2.1.6\n</code></pre>\n\n<p><strong>This \"feature\" kills me a whole afternoon</strong>, when I run the follow code:</p>\n\n<pre><code>filter (/= someKey) [key1, key2, key3]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462961055, "post_id": 37159093, "comment_id": 61854392, "body": "What is your actual question?"}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1462962390, "creation_date": 1462962390, "answer_id": 37159863, "question_id": 37159093, "link": "https://stackoverflow.com/questions/37159093/errort-binding-function/37159863#37159863", "title": "ErrorT binding function", "body": "<p>I think you are confused by the <code>newtype</code> wrapper. The newtype definition of <code>ErrorT</code> results in two functions being defined:</p>\n\n<pre><code>ErrorT :: m (Either e a) -&gt; ErrorT e m a\nrunErrorT :: ErrorT e m a -&gt; m (Either e a)\n</code></pre>\n\n<p>so in the definition of <code>(&gt;&gt;=)</code>, <code>ErrorT $ do ...</code> refers to the constructor for the <code>ErrorT</code> newtype while</p>\n\n<pre><code>a &lt;- runErrorT m\nrunErrorT (k r)\n</code></pre>\n\n<p>refer to the 'unwrapping' function to extract the underlying <code>m (Either e a)</code>.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 37159863, "answer_count": 1, "score": -3, "last_activity_date": 1462962390, "creation_date": 1462960623, "question_id": 37159093, "link": "https://stackoverflow.com/questions/37159093/errort-binding-function", "title": "ErrorT binding function", "body": "<pre><code>newtype ErrorT e m a = ErrorT { runErrorT :: m (Either e a) }\n\ninstance (Monad m, Error e) =&gt; Monad (ErrorT e m) where\nm &gt;&gt;= k = ErrorT $ do\n    a &lt;- runErrorT m\n    case a of\n        Left l -&gt; return (Left l)\n        Right r -&gt; runErrorT (k r)\n</code></pre>\n\n<p><code>ErrorT</code> is just a value constructor ( type constructor as well) and to get instance of that type ( to get <code>ErrorT</code> value ) we have to call constructor with one parameter- a function ( destructor) which gets <code>ErrorT</code> and returns inner monad, in our case it is any <code>m</code> (Either e a). So,  in bind function it is defined: <code>m &gt;&gt;= k = ErrorT $ ...</code>. But, in its definion it calls <code>runErrorT</code> which is just definied. So something like recursive call. But, I suppose that there is no recursion here. That means that I misunderstand something with monad/ monad transformers. Please help :)</p>\n"}, {"tags": ["haskell", "symlink"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1462944041, "post_id": 37153638, "comment_id": 61844349, "body": "<a href=\"https://hackage.haskell.org/package/unix-2.7.2.0/docs/System-Posix-Files.html#g:9\" rel=\"nofollow noreferrer\">System.Posix.Files.createSymbolicLink</a>"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462944227, "post_id": 37153638, "comment_id": 61844433, "body": "@n.m. Feel free to post as an answer, unless a duplicate question already exists."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462945053, "post_id": 37153638, "comment_id": 61844705, "body": "Apparently there&#39;s a (near) duplicate <a href=\"http://stackoverflow.com/questions/35369470/what-is-the-command-to-create-a-soft-link-with-haskell-turtle\">here</a>."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1462945429, "post_id": 37153638, "comment_id": 61844881, "body": "@n.m. I think this question will be easier to find via search engines, I think we should keep this one."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462950155, "post_id": 37153638, "comment_id": 61847255, "body": "@Mark: Closing as a duplicate won&#39;t delete this question. Instead, it will still come up in search engines. (By the way, I knew I answered this question already somewhere :D)"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 10, "last_activity_date": 1462969213, "last_edit_date": 1462969213, "creation_date": 1462951052, "answer_id": 37155633, "question_id": 37153638, "link": "https://stackoverflow.com/questions/37153638/how-to-create-symlink-with-haskell/37155633#37155633", "title": "How to create symlink with Haskell?", "body": "<p>Creating a symbolic link is non-portable. For example, the creation symbolic links on Windows <a href=\"https://en.wikipedia.org/wiki/NTFS_symbolic_link#Restrictions\">is re&shy;strict&shy;ed</a><sup>1</sup>. Therefore it does not fit into <code>directory</code> providing <a href=\"https://hackage.haskell.org/package/directory\">\"a basic set of operations for ma&shy;nip&shy;u&shy;lat&shy;ing files and directories in a <strong>portable way</strong>\"</a> (emphasis mine). This affects all platform independent packages.</p>\n\n<p>The platform specific package <a href=\"https://hackage.haskell.org/package/unix\"><code>unix</code></a> provides that functionality in <a href=\"https://hackage.haskell.org/package/unix-2.7.1.0/docs/System-Posix-Files.html#g:9\"><code>System.Posix.Files</code> with <code>createSymbolicLink</code></a> though:</p>\n\n<pre><code>import System.Posix.Files (createSymbolicLink)\n\nmain :: IO ()\nmain = createSymbolicLink \"/opt/ghc/7.10.3\" \"/opt/ghc/active\"\n</code></pre>\n\n<p><sub>1: That's also a reason why <code>unix-compat</code> does not implement <a href=\"https://github.com/jystic/unix-compat/blob/master/src/System/PosixCompat/Files.hsc#L371-L378\"><code>createSymbolicLink</code></a></sub></p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 0, "last_activity_date": 1508759744, "creation_date": 1508759744, "answer_id": 46888755, "question_id": 37153638, "link": "https://stackoverflow.com/questions/37153638/how-to-create-symlink-with-haskell/46888755#46888755", "title": "How to create symlink with Haskell?", "body": "<p><a href=\"http://hackage.haskell.org/package/directory-1.3.1.5/docs/System-Directory.html#v:createFileLink\" rel=\"nofollow noreferrer\">directory-1.3.1 has</a></p>\n\n<pre><code>createFileLink :: FilePath -&gt; FilePath -&gt; IO ()\n</code></pre>\n\n<p>This is supposed to work even on Windows \u2013 only on a suitable file system, of course.</p>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "accepted_answer_id": 37155633, "answer_count": 2, "score": 5, "last_activity_date": 1508759744, "creation_date": 1462943855, "question_id": 37153638, "link": "https://stackoverflow.com/questions/37153638/how-to-create-symlink-with-haskell", "title": "How to create symlink with Haskell?", "body": "<p>How to create a symlink with Haskell? The <code>directory</code> package to my knowledge does not provide a way to do it.</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "edited": false, "score": 1, "creation_date": 1462939736, "post_id": 37152528, "comment_id": 61843082, "body": "Well first I think you want to use <code>length s - 1</code> in your values function."}], "answers": [{"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1462940067, "post_id": 37152990, "comment_id": 61843164, "body": "Ah foldl1 -&gt; foldl was so simple."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1462940239, "last_edit_date": 1462940239, "creation_date": 1462939918, "answer_id": 37152990, "question_id": 37152528, "link": "https://stackoverflow.com/questions/37152528/cant-match-tuple-inside-of-foldl/37152990#37152990", "title": "Can&#39;t match tuple inside of foldl", "body": "<p>to get it compiling you actually just have to switch <code>foldl1'</code> to <code>foldl'</code> and add the <em>starting</em> accumulator:</p>\n\n<pre><code>import Data.Char (ord)\nimport Data.List (foldl')\n\ncolumnToNumber :: String -&gt; Int\ncolumnToNumber s = foldl' (\\acc (i, v) -&gt; acc + 26 ^ i * v) 0 (values s)\n  where values s = zip (reverse [0..(length s)]) ((\\c -&gt; ord c - 64) &lt;$&gt; s)\n</code></pre>\n\n<p>if you add the suggestion <code>Free_D</code> made (start at <code>length s - 1</code>):</p>\n\n<pre><code>columnToNumber :: String -&gt; Int\ncolumnToNumber s = foldl' (\\acc (i, v) -&gt; acc + 26 ^ i * v) 0 (values s)\n  where values s = zip (reverse [0..(length s -1)]) ((\\c -&gt; ord c - 64) &lt;$&gt; s)\n</code></pre>\n\n<p>you get the desired results:</p>\n\n<pre><code>\u03bb&gt; columnToNumber \"AA\"\n27\n\u03bb&gt; columnToNumber \"AB\"\n28\n</code></pre>\n\n<hr>\n\n<p>I don't know if you actually gonna need this but hey why not:</p>\n\n<p>what you probably don't like is that <code>columnToNumber \"A1\"</code> is <code>11</code> - to fix this you need to tread digits differently from letters:</p>\n\n<pre><code>columnToNumber :: String -&gt; Int\ncolumnToNumber s = foldl' (\\acc (i, v) -&gt; acc + 26 ^ i * v) 0 (values s)\n  where values s = zip (reverse [0..(length s -1)]) (parse &lt;$&gt; s)\n        parse c\n          | c &gt;= '0' &amp;&amp; c &lt;= '9' = ord c - ord '0'\n          | otherwise = ord c - 64\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1462940486, "post_id": 37153007, "comment_id": 61843267, "body": "<code>[l - 1, l - 2 ..0]</code> had no idea you could do this!"}], "tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": false, "score": 2, "last_activity_date": 1462940060, "creation_date": 1462940060, "answer_id": 37153007, "question_id": 37152528, "link": "https://stackoverflow.com/questions/37152528/cant-match-tuple-inside-of-foldl/37153007#37153007", "title": "Can&#39;t match tuple inside of foldl", "body": "<p>Looking at the definition of <code>foldl1'</code>, it has to take two things that are of the same type and produce something similar</p>\n\n<pre><code>*Main Data.List&gt; :t foldl1'\nfoldl1' :: (a -&gt; a -&gt; a) -&gt; [a] -&gt; a\n</code></pre>\n\n<p>But <code>foldl</code> is what you want:</p>\n\n<pre><code>*Main Data.List&gt; :t foldl\nfoldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<p>So essentially this:</p>\n\n<pre><code>import Data.Char (ord, toUpper)\n\ncolumnToNumber :: String -&gt; Int\ncolumnToNumber s = foldl (\\acc (i, v) -&gt; acc + 26 ^ i * v) 0 $ values s where \n    values s = zip [l - 1, l - 2 ..0] ((\\c -&gt; (ord.toUpper) c - 64) &lt;$&gt; s) where\n        l = length s\n</code></pre>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 37152990, "answer_count": 2, "score": 1, "last_activity_date": 1462940239, "creation_date": 1462936638, "question_id": 37152528, "link": "https://stackoverflow.com/questions/37152528/cant-match-tuple-inside-of-foldl", "title": "Can&#39;t match tuple inside of foldl", "body": "<p>I have the following code, which should\u2122 convert an excel column type its corresponding number. For example AA into 27 and AB into 28:</p>\n\n<pre><code>import Data.Char (ord)\nimport Data.List (foldl1')\n\ncolumnToNumber :: String -&gt; Int\ncolumnToNumber s = foldl1' (\\acc (i, v) -&gt; acc + 26 ^ i * v) (values s)\n  where values s = zip (reverse [0..(length s)]) ((\\c -&gt; ord c - 64) &lt;$&gt; s)\n</code></pre>\n\n<p>The idea is to take the string \"AA\" convert it to the corresponding numbers</p>\n\n<pre><code>[\"A\", \"A\"] -&gt; [1, 1]\n</code></pre>\n\n<p>and zip it with the base so from right to left 26^0, 26^1, 26^2, and so on.</p>\n\n<pre><code>zip [1, 0] [1, 1] -&gt; [(1, 1), (0, 1)]\n</code></pre>\n\n<p>That way the result of the fold would be </p>\n\n<pre><code>26^1 * 1 + 26^0 * 1 = 27\n</code></pre>\n\n<p>Unfortunately, I'm getting the following errors and I'm not sure why:</p>\n\n<pre><code>ExcelSheetColumn.hs:7:34:\n    Couldn't match expected type \u2018Int\u2019\n                with actual type \u2018(Integer, Int)\u2019\n    In the pattern: (i, v)\n    In the first argument of \u2018foldl1'\u2019, namely\n      \u2018(\\ acc (i, v) -&gt; acc + 26 ^ i * v)\u2019\n    In the expression:\n      foldl1' (\\ acc (i, v) -&gt; acc + 26 ^ i * v) (values s)\n\nExcelSheetColumn.hs:7:63:\n    Couldn't match type \u2018(Int, Int)\u2019 with \u2018Int\u2019\n    Expected type: [Int]\n      Actual type: [(Int, Int)]\n    In the second argument of \u2018foldl1'\u2019, namely \u2018(values s)\u2019\n    In the expression:\n      foldl1' (\\ acc (i, v) -&gt; acc + 26 ^ i * v) (values s)\n</code></pre>\n\n<p>Could someone help me out?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 2, "last_activity_date": 1462932175, "creation_date": 1462932175, "answer_id": 37151887, "question_id": 37151626, "link": "https://stackoverflow.com/questions/37151626/binary-instance-with-sum-type/37151887#37151887", "title": "Binary instance with sum type", "body": "<p>If you know that you only have <code>ProtoA</code> or <code>ProtoB</code> messages, use <code>get :: Get ProtoA</code> or <code>get :: Get ProtoB</code> to read them. There's no reason to try to read a <code>P</code> if you know that it's a <code>ProtoA</code>. If you want a <code>P</code> holding a <code>ProtoA</code> you can use <code>(PA &lt;$&gt; get) :: Get P</code>.</p>\n\n<p>You won't read a <code>P</code> unless you don't know whether it's a <code>PA</code> or a <code>PB</code>, so your <code>Binary P</code> instance <em>should</em> write a tag that you can use to differentiate between <code>PA</code>s and <code>PB</code>s.</p>\n\n<pre><code>instance Binary P where\n    put (PA a) = do put (0 :: Word8)\n                    put a\n    put (PB b) = do put (1 :: Word8)\n                    put b\n    get = do t &lt;- get :: Get Word8\n             case t of\n                  0 -&gt; PA &lt;$&gt; get\n                  1 -&gt; PB &lt;$&gt; get\n</code></pre>\n\n<p>If you are going to write <code>P</code>s to somewhere that should only be <code>ProtoA</code>s or <code>ProtoB</code>s it's your job to check and make sure that that is true. Then use <code>put :: ProtoA -&gt; Put</code> or <code>put :: ProtoB -&gt; Put</code>.</p>\n"}], "owner": {"reputation": 211, "user_id": 4589460, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-vDj0ltaGLZU/AAAAAAAAAAI/AAAAAAAAEeU/zGlq69ZIPyI/photo.jpg?sz=128", "display_name": "Mark Fine", "link": "https://stackoverflow.com/users/4589460/mark-fine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462933244, "creation_date": 1462930278, "last_edit_date": 1462933244, "question_id": 37151626, "link": "https://stackoverflow.com/questions/37151626/binary-instance-with-sum-type", "title": "Binary instance with sum type", "body": "<p>I am processing a couple of different protocols and storing their messages in a channel. To do this I am using a sum type capturing both types of messages. Now I am having trouble writing a decoding instance for <code>Binary</code> - I know which protocol I want to decode, but I don't know how to force it without using ugly newtype wrappers. Code is:</p>\n\n<pre><code>    -- Supported protocols\n    data ProtoA = ProtoA\n    data ProtoB = ProtoB\n\n    -- Protocol sum type for storing messages in a channel.\n    data P = PA ProtoA | PB ProtoB\n\n    -- messages stored in a channel that can support either message.\n    type PChan = TChan P\n\n    instance Binary ProtoA where\n      put ProtoA = return ()\n      get = return ProtoA\n\n    instance Binary ProtoB where\n      put ProtoB = return ()\n      get = return ProtoB\n\n    instance Binary P where\n      -- on put, have the constructor available to drive behavior\n      put (PA ProtoA) = return ()\n      put (PB ProtoB) = return ()\n      -- on get, nothing to differentiate behavior\n      -- don't want alternation\n      get = undefined\n\n    -- Yuck, wrapped newtypes instances...\n    newtype PA' = PA' P\n    newtype PB' = PB' P\n\n    instance Binary PA' where\n      put (PA' (PA ProtoA)) = return ()\n      put (PA' (PB ProtoB)) = fail \"shouldn't happen\"\n      get = return (PA' (PA ProtoA))\n\n    instance Binary PB' where\n      put (PB' (PA ProtoA)) = fail \"shouldn't happen\"\n      put (PB' (PB ProtoB)) = return ()\n      get = return (PB' (PB ProtoB))\n</code></pre>\n\n<p>Is there a better way to handle this? Maybe with phantom types? At the time of decoding, I know which protocol I am dealing with - but not sure how to force it. Advice and/or suggestions very much welcome! Thanks!</p>\n"}, {"tags": ["arrays", "haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1462924114, "post_id": 37150564, "comment_id": 61839381, "body": "For a non-optimized approach, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:splitAt\" rel=\"nofollow noreferrer\">splitAt</a> is a good start."}], "answers": [{"comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1463068195, "post_id": 37150919, "comment_id": 61916164, "body": "This solution looks quadratic, but the question asks for O(n).  You could refactor using <code>map product . inits = scanl (*) 1</code> and <code>map product . tails = scanr (*) 1</code>"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 1, "last_activity_date": 1462949218, "last_edit_date": 1462949218, "creation_date": 1462925148, "answer_id": 37150919, "question_id": 37150564, "link": "https://stackoverflow.com/questions/37150564/mapping-a-list-to-the-product-of-the-elements-excluding-the-current-index-withou/37150919#37150919", "title": "Mapping a list to the product of the elements excluding the current index without using division", "body": "<p>You can do this using the <code>tails</code> and <code>inits</code> functions, which return all the elements after and before the Nth.</p>\n\n<pre><code>&gt; tails [1,2,3,4]\n[[1,2,3,4], [2,3,4], [3,4], [4]]\n</code></pre>\n\n<p>Note that if you remove the first value, this is exactly the values that you will have to multiply after the missing element.</p>\n\n<pre><code>&gt; tail $ tails [1,2,3,4]\n[[2,3,4], [3,4], [4]]\n</code></pre>\n\n<p><code>inits</code> will return the values before the missing number</p>\n\n<pre><code>&gt; heads [1,2,3,4]\n[[], [1], [1,2], [1,2,3], [1,2,3,4]]\n</code></pre>\n\n<p>Finally, use the product function and a zipwith to do the final multiplication.</p>\n\n<pre><code>zipWith (*) (map product $ inits [1,2,3,4]) (map product $ tail $ tails [1,2,3,4])\n</code></pre>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 37150919, "answer_count": 1, "score": 0, "last_activity_date": 1462949218, "creation_date": 1462922981, "last_edit_date": 1592644375, "question_id": 37150564, "link": "https://stackoverflow.com/questions/37150564/mapping-a-list-to-the-product-of-the-elements-excluding-the-current-index-withou", "title": "Mapping a list to the product of the elements excluding the current index without using division", "body": "<p>I'm doing some exercies in Haskell, and this is the current one I'm working on <a href=\"https://leetcode.com/problems/product-of-array-except-self/\" rel=\"nofollow noreferrer\">https://leetcode.com/problems/product-of-array-except-self/</a>.</p>\n<blockquote>\n<p>Given an array of n integers where n &gt; 1, nums, return an array output such that output[i] is equal to the product of all the elements of nums except nums[i].</p>\n<p>Solve it without division and in O(n).</p>\n<p>For example, given [1,2,3,4], return [24,12,8,6].</p>\n</blockquote>\n<p>I was able to do it pretty easily with division:</p>\n<pre><code>import Data.List (foldl1')\n\nproductOfArray :: [Int] -&gt; [Int]\nproductOfArray xs = f &lt;$&gt; xs\n  where p = foldl1' (*)\n        f = div (p xs)\n</code></pre>\n<p>But I'm not quite sure how to approach it without doing division. The imperative approach is map to the product of all the numbers to the left of the current index times all the numbers to the right of the current index, but in Haskell I'm not quite sure how to conceptualize that.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1462972807, "post_id": 37150212, "comment_id": 61863293, "body": "I think this may be a duplicate of <a href=\"http://stackoverflow.com/questions/35084867/haskell-generating-all-combinations-of-n-numbers\">this question</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1462921226, "creation_date": 1462921226, "answer_id": 37150296, "question_id": 37150212, "link": "https://stackoverflow.com/questions/37150212/list-to-list-of-list-with-all-possible-combination/37150296#37150296", "title": "List to List of List with all possible combination", "body": "<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :m +Control.Monad\nPrelude Control.Monad&gt; replicateM 3 [0,1,2]\n[[0,0,0],[0,0,1],[0,0,2],[0,1,0],[0,1,1],[0,1,2],[0,2,0],[0,2,1],[0,2,2],[1,0,0],[1,0,1],[1,0,2],[1,1,0],[1,1,1],[1,1,2],[1,2,0],[1,2,1],[1,2,2],[2,0,0],[2,0,1],[2,0,2],[2,1,0],[2,1,1],[2,1,2],[2,2,0],[2,2,1],[2,2,2]]\n</code></pre>\n\n<p>Note that basically, the length of the list of permitted values needs in no way be connected to the length of each list of choices.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1462928029, "creation_date": 1462928029, "answer_id": 37151316, "question_id": 37150212, "link": "https://stackoverflow.com/questions/37150212/list-to-list-of-list-with-all-possible-combination/37151316#37151316", "title": "List to List of List with all possible combination", "body": "<p>with list comprehension</p>\n\n<pre><code>x = [0,1,2]\n[[a,b,c] | a&lt;-x, b&lt;-x, c&lt;-x]                           \n\n[[0,0,0],[0,0,1],[0,0,2],[0,1,0],[0,1,1],[0,1,2],[0,2,0],[0,2,1],[0,2,2],\n [1,0,0],[1,0,1],[1,0,2],[1,1,0],[1,1,1],[1,1,2],[1,2,0],[1,2,1],[1,2,2],\n [2,0,0],[2,0,1],[2,0,2],[2,1,0],[2,1,1],[2,1,2],[2,2,0],[2,2,1],[2,2,2]]\n</code></pre>\n"}], "owner": {"reputation": 6176, "user_id": 398909, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7341b4c982d87acd9bc260a5a970782f?s=128&d=identicon&r=PG", "display_name": "william", "link": "https://stackoverflow.com/users/398909/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 37150296, "answer_count": 2, "score": 1, "last_activity_date": 1462931713, "creation_date": 1462920681, "last_edit_date": 1462931713, "question_id": 37150212, "link": "https://stackoverflow.com/questions/37150212/list-to-list-of-list-with-all-possible-combination", "title": "List to List of List with all possible combination", "body": "<p>First of all, I cannot remember the name of this repetition of list.</p>\n\n<p>I have a list:</p>\n\n<pre><code>myList = [0, 1, 2]\n</code></pre>\n\n<p>I want to repeat list of list:</p>\n\n<pre><code>[[0,1,2],[1,2,0],...]\n</code></pre>\n\n<p>I know that I can do <code>permutations myList</code>\nBut it won't cover the repeated parts such as <code>[[0,0,0],[1,1,1],[1,1,0],...]</code></p>\n\n<p>So, my questions are what is the name given for such kind of list.\nIt is not <code>permutations</code> and it definitely is not <code>combinations</code></p>\n\n<p>In logic, we call it <code>truth table</code>, I believe.</p>\n\n<p>And is there a builtin function for that in haskell? </p>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1462915239, "post_id": 37149144, "comment_id": 61836347, "body": "I&#39;m not sure how those leading spaces got up there, but they aren&#39;t present in my system (I&#39;m adjusting the post now). Nevertheless, are you able to <code>cabal install --enable-tests</code> without error?"}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1462915262, "post_id": 37149144, "comment_id": 61836364, "body": "When I run <code>cabal build</code>, I still get the original error as well."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1462915323, "post_id": 37149144, "comment_id": 61836400, "body": "Also: my project builds fine with <code>cabal install</code>. It is only when I try to run the tests that I get this error."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1462916243, "post_id": 37149144, "comment_id": 61836808, "body": "I don&#39;t think <code>cabal install</code> builds or runs any tests."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1462915877, "last_edit_date": 1462915877, "creation_date": 1462915081, "answer_id": 37149144, "question_id": 37149042, "link": "https://stackoverflow.com/questions/37149042/cabal-error-when-building-a-simple-tutorial-project/37149144#37149144", "title": "cabal error when building a simple tutorial project", "body": "<p>Update:</p>\n\n<p>You get the error when you run <code>cabal test</code>.</p>\n\n<p>The problem is that your test suite depends on the library <code>haq</code>, but the cabal file does not declare a library component. It only declares an executable.</p>\n\n<p>To fix:</p>\n\n<ol>\n<li>Rename the existing file <code>Haq.hs</code> to <code>App.hs</code>. Update the cabal file appropriately.</li>\n<li><p>Create a new file 'Haq.hs` with this contents:</p>\n\n<pre><code>module Haq (haqify) where\n\nhaqify :: String -&gt; String\nhaqify s = \"Haqify! \" ++ s\n</code></pre></li>\n<li><p>Add this stanza to the cabal file:</p>\n\n<pre><code>library\n  build-depends: base &gt;= 4.8 &amp;&amp; &lt; 4.9\n  exposed-modules: Haq\n</code></pre></li>\n<li><p>Run <code>cabal build</code> or <code>cabal test</code></p></li>\n</ol>\n\n<p><em>Original Answer</em></p>\n\n<p>I was able to <code>cabal build</code> your project once I fixed the indentation problems in <code>Haq.hs</code>:</p>\n\n<ul>\n<li>removed the leading space on the lines for <code>main</code></li>\n<li>removed the leading space in front of <code>haqify</code></li>\n</ul>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462915877, "creation_date": 1462914594, "last_edit_date": 1462915292, "question_id": 37149042, "link": "https://stackoverflow.com/questions/37149042/cabal-error-when-building-a-simple-tutorial-project", "title": "cabal error when building a simple tutorial project", "body": "<h2>1 The Problem</h2>\n\n<p>I am following the tutorial <a href=\"https://wiki.haskell.org/How_to_write_a_Haskell_program\" rel=\"nofollow\">How to Write a Haskell Program</a>, in which you build the project <code>haq</code>.</p>\n\n<p>Whenever I try to run <code>cabal test</code>, I get the following error snippet:</p>\n\n<pre><code>&lt;command line&gt;: cannot satisfy -package-id haq-0.1.0.0-inplace\n    (use -v for more information)\n    cabal: Error: some packages failed to install:\n    haq-0.1.0.0 failed during the building phase. The exception was:\n    ExitFailure 1\n</code></pre>\n\n<p>Notice that the package it cannot build is itself (at least I think that's what this error means).</p>\n\n<h2>2 The Details</h2>\n\n<h3>2.1 The Full Error</h3>\n\n<pre><code>$ cabal install --enable-tests\nResolving dependencies...\nConfiguring haq-0.1.0.0...\nBuilding haq-0.1.0.0...\nFailed to install haq-0.1.0.0\nBuild log ( /home/user/.cabal/logs/haq-0.1.0.0.log ):\nConfiguring haq-0.1.0.0...\nWarning: The 'license-file' field refers to the file 'LICENSE' which does not\nexist.\nBuilding haq-0.1.0.0...\nPreprocessing executable 'haq' for haq-0.1.0.0...\n[1 of 1] Compiling Main             ( Haq.hs, dist/build/haq/haq-tmp/Main.o )\nLinking dist/build/haq/haq ...\nPreprocessing test suite 'tests' for haq-0.1.0.0...\n&lt;command line&gt;: cannot satisfy -package-id haq-0.1.0.0-inplace\n    (use -v for more information)\n    cabal: Error: some packages failed to install:\n    haq-0.1.0.0 failed during the building phase. The exception was:\n    ExitFailure 1\n</code></pre>\n\n<h3>2.2 Project File Structure</h3>\n\n<pre><code>.\n\u251c\u2500\u2500 .cabal-sandbox\n\u251c\u2500\u2500 cabal.sandbox.config\n\u251c\u2500\u2500 dist\n\u251c\u2500\u2500 haq.cabal\n\u251c\u2500\u2500 Haq.hs\n\u251c\u2500\u2500 HSpecTests.hs\n\u2514\u2500\u2500 Setup.hs\n</code></pre>\n\n<h3>2.3 Haq.hs</h3>\n\n<pre><code>    --\n    -- Copyright (c) 2006 Don Stewart - http://www.cse.unsw.edu.au/~dons/\n    -- GPL version 2 or later (see http://www.gnu.org/copyleft/gpl.html)\n    --\n    import System.Environment\n\n    -- | 'main' runs the main program\n    main :: IO ()\n    main = getArgs &gt;&gt;= print . haqify . head\n\n    haqify s = \"Haq! \" ++ s\n</code></pre>\n\n<h3>2.4 haq.cabal</h3>\n\n<pre><code>    -- Initial haq.cabal generated by cabal init.  For further documentation, \n    -- see http://haskell.org/cabal/users-guide/\n\n    name:                haq\n    version:             0.1.0.0\n    -- synopsis:            \n    -- description:         \n    -- license:             \n    license-file:        LICENSE\n    author:              First Last\n    maintainer:          first.last@gmail.com\n    -- copyright:           \n    -- category:            \n    build-type:          Simple\n    -- extra-source-files:  \n    cabal-version:       &gt;=1.10\n\n    executable haq\n        main-is:             Haq.hs\n        -- other-modules:       \n        -- other-extensions:    \n        build-depends:       base &gt;=4.8 &amp;&amp; &lt;4.9\n        -- hs-source-dirs:      \n        default-language:    Haskell2010\n\n    test-suite tests\n        ghc-options: -Wall\n        default-extensions:  OverloadedStrings\n        type: exitcode-stdio-1.0\n        main-is: HSpecTests.hs\n        build-depends:       base,\n                                                 haq,\n                                                 hspec                &gt;= 1.8\n        default-language:    Haskell2010\n</code></pre>\n\n<h3>2.5 HSpecTests.hs</h3>\n\n<pre><code>    module Main where\n\n    import Haq\n    import Test.Hspec\n\n    main :: IO ()\n    main = hspec $ do\n\n        describe \"Validate haqify function\" $ do\n            it \"haqify is supposed to prefix Haq! to things\" $ do\n                haqify \"me\" `shouldBe` \"Haq! me\"\n</code></pre>\n"}, {"tags": ["haskell", "refactoring", "automated-refactoring", "hlint"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462958919, "post_id": 37148753, "comment_id": 61852875, "body": "maybe the <a href=\"https://github.com/RefactoringTools/HaRe\" rel=\"nofollow noreferrer\">HaRe project</a> and <a href=\"https://github.com/mpickering/apply-refact\" rel=\"nofollow noreferrer\">this repo</a> are of interest to you"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 5426, "user_id": 4887423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yW2L2.jpg?s=128&g=1", "display_name": "Willie Cheng", "link": "https://stackoverflow.com/users/4887423/willie-cheng"}, "edited": false, "score": 0, "creation_date": 1462970164, "post_id": 37148753, "comment_id": 61861006, "body": "@willie: Why would code be necessary for this question? It&#39;s just about the usage of a programming related tool."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1462970118, "last_edit_date": 1462970118, "creation_date": 1462915296, "answer_id": 37149190, "question_id": 37148753, "link": "https://stackoverflow.com/questions/37148753/can-hlint-automatically-do-suggested-edits/37149190#37149190", "title": "Can HLint automatically do suggested edits?", "body": "<p>You have to use <code>--refactor</code> and have the <code>refactor</code> executable in your <code>$PATH</code>. See <a href=\"https://github.com/ndmitchell/hlint#readme\" rel=\"nofollow\">hlint's README</a> for more information:</p>\n\n<blockquote>\n  <h3>Automatically Applying Hints</h3>\n  \n  <p>By supplying the <code>--refactor</code> flag hlint can automatically apply most\n  suggestions. Instead of a list of hints, hlint will instead output the\n  refactored file on stdout. In order to do this, it is necessary to\n  have the <code>refactor</code> executable on you path. <code>refactor</code> is provided by\n  the <a href=\"https://github.com/mpickering/apply-refact\" rel=\"nofollow\"><code>apply-refact</code></a>\n  package, it uses the GHC API in order to transform source files given\n  a list of refactorings to apply. Hlint directly calls the executable\n  to apply the suggestions.</p>\n</blockquote>\n\n<p>Note that hlint doesn't apply transformations recursively, so additional <code>--refactor</code> could be nec&shy;es&shy;sary. That being said, make sure to commit/save before you apply <code>hlint --refactor</code> and test your code afterwards, since the changes might break your code, especially if you use Rank2Types or <code>seq</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "is_accepted": false, "score": 0, "last_activity_date": 1518516941, "creation_date": 1518516941, "answer_id": 48764272, "question_id": 37148753, "link": "https://stackoverflow.com/questions/37148753/can-hlint-automatically-do-suggested-edits/48764272#48764272", "title": "Can HLint automatically do suggested edits?", "body": "<p>To complement Zeta's answer, I use some additional flags to perform the refactoring in place:</p>\n\n<pre><code>hlint  --refactor --refactor-options=\"--inplace\" path/to/your/File.hs\n</code></pre>\n\n<p>Sometimes you only want to apply a certain kind of hint, which can be done by passing the <code>-o</code> flag, e.g.:</p>\n\n<pre><code>hlint  -o=\"Use fewer imports\" --refactor --refactor-options=\"--inplace\" \n</code></pre>\n\n<p>As far as I know, the suggested refactorings need to be done in a per-file basis.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 37149190, "answer_count": 2, "score": 3, "last_activity_date": 1518516941, "creation_date": 1462913505, "last_edit_date": 1462970348, "question_id": 37148753, "link": "https://stackoverflow.com/questions/37148753/can-hlint-automatically-do-suggested-edits", "title": "Can HLint automatically do suggested edits?", "body": "<p><a href=\"https://hackage.haskell.org/package/hlint\" rel=\"nofollow\">HLint</a> gives suggestion how one can improve source code. However, given the nature of the suggestions, I wonder whether it's possible to automatically apply those suggestions.</p>\n\n<p>Is it possible to automatically apply suggestions proposed by <code>hlint</code>?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 2, "creation_date": 1462915968, "post_id": 37149161, "comment_id": 61836695, "body": "That panic has nothing to do with (the correct behavior of) <code>UndecidableInstances</code> \u2013 the worst <code>UndecidableInstances</code> can do (or at least, should be able to do!) is make the type checker loop.  I&#39;d say to report that as a bug, but you&#39;re apparently on a pretty old GHC version.  If you edit this to include the code that panics, I can test it on a more recent GHC."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1462984390, "post_id": 37149161, "comment_id": 61871955, "body": "OK, thanks.  Good news: I couldn&#39;t reproduce a panic with your code under GHC 7.10.2 on Mac OS X 10.10.5."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1462998761, "post_id": 37149161, "comment_id": 61880123, "body": "Change <code>fold show</code> to <code>fold (\\ x -&gt; &quot;Foo (&quot; ++ show x ++ &quot;)&quot;)</code>. It panics 7.4.2. I tried it with 7.6.x and it didn&#39;t panic, so I&#39;m pretty sure whatever this bug is, it&#39;s long since been fixed."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1462998847, "post_id": 37149161, "comment_id": 61880169, "body": "That&#39;s truly bizarre o_O.  But at least it&#39;s fixed!  (Confirmed on 7.10.2.)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1462955685, "last_edit_date": 1462955685, "creation_date": 1462915178, "answer_id": 37149161, "question_id": 37148710, "link": "https://stackoverflow.com/questions/37148710/cant-write-a-show-instance-for-this-type/37149161#37149161", "title": "Can&#39;t write a Show instance for this type", "body": "<p>OK, so while playing with the code, I found <strong>a</strong> way of doing it:</p>\n\n<pre><code>instance (Functor f, Show (f String)) =&gt; Show (Foobar f) where\n  show = fold show\n\nfold :: Functor f =&gt; (f x -&gt; x) -&gt; Foobar f -&gt; x\nfold f (Foo x) = f (fmap (fold f) x)\n</code></pre>\n\n<p>There's a couple of problems though.</p>\n\n<ul>\n<li>It doesn't produce exactly the right output. (The <code>Foo</code> constructor is missing, and subexpressions get quoted.)</li>\n<li>It apparently requires <code>UndecidableInstances</code> to work. (!)</li>\n<li>I tried to change <code>show</code> to include the <code>Foo</code> constructor, but then GHC panicked (!!!)</li>\n</ul>\n\n<p>I didn't know you could actually <em>crash GHC</em> just by writing user code... apparently you can do that.</p>\n\n<pre><code>ghc: panic! (the 'impossible' happened)\n  (GHC version 7.4.2 for i386-unknown-mingw32):\n    kindFunResult ghc-prim:GHC.Prim.*{(w) tc 34d}\n\nPlease report this as a GHC bug:  http://www.haskell.org/ghc/reportabug\n</code></pre>\n\n<p>I guess it's called \"undecidable\" for a reason! o_O</p>\n"}, {"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1462932628, "post_id": 37149293, "comment_id": 61841475, "body": "That&#39;s <a href=\"https://hackage.haskell.org/package/recursion-schemes-4.1.2/docs/src/Data-Functor-Foldable.html#Fix\" rel=\"nofollow noreferrer\">how <code>Show</code> is defined for <code>Fix</code></a> in recursion-schemes."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1462932721, "post_id": 37149293, "comment_id": 61841495, "body": "Ah yes, that makes sense \u2013 because this <i>is</i> <code>Fix</code>, up to renaming!  I should have noticed that immediately :-)"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1462955036, "post_id": 37149293, "comment_id": 61850274, "body": "I was sure this type was already in the libraries somewhere, but I couldn&#39;t see it for some reason..."}], "tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 6, "last_activity_date": 1462915788, "creation_date": 1462915788, "answer_id": 37149293, "question_id": 37148710, "link": "https://stackoverflow.com/questions/37148710/cant-write-a-show-instance-for-this-type/37149293#37149293", "title": "Can&#39;t write a Show instance for this type", "body": "<p>If you just specify the obvious constraint \u2013 and add some necessary language pragmas \u2013 everything works just fine.  For <code>Foobar</code> to be showable, the field of <code>Foo</code> must be showable, so we require a <code>Show (x (Foobar x))</code> constraint.  And if we ask for that, everything just works out:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts, UndecidableInstances, StandaloneDeriving #-}\n\ndata Foobar x = Foo (x (Foobar x))\nderiving instance Show (x (Foobar x)) =&gt; Show (Foobar x)\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>\u03bb&gt; print $ Foo [Foo [], Foo [Foo []]]\nFoo [Foo [],Foo [Foo []]]\n\u03bb&gt; data SL a = S String | L [a] deriving Show\n\u03bb&gt; print $ Foo (L [Foo (S \"a\"), Foo (L [Foo (S \"b\"), Foo (L []), Foo (S \"c\")])])\nFoo (L [Foo (S \"a\"),Foo (L [Foo (S \"b\"),Foo (L []),Foo (S \"c\")])])\n</code></pre>\n\n<p>I'm a little bit surprised this works, but not overly so :-)</p>\n\n<hr>\n\n<p>Incidentally, this is exactly what GHC asks of you if you try to derive <code>Show</code> for <code>Foobar</code>:</p>\n\n<pre><code>\u03bb&gt; data Foobar x = Foo (x (Foobar x)) deriving Show\n\n&lt;interactive&gt;:2:45:\n    No instance for (Show (x (Foobar x)))\n      arising from the first field of \u2018Foo\u2019 (type \u2018x (Foobar x)\u2019)\n    Possible fix:\n      use a standalone 'deriving instance' declaration,\n        so you can specify the instance context yourself\n    When deriving the instance for (Show (Foobar x))\n</code></pre>\n\n<p>All we had to do was use <code>StandaloneDeriving</code> and specify exactly that constraint!</p>\n\n<hr>\n\n<p>Also, to be clear, the <code>StandaloneDeriving</code> part is optional \u2013 it's not doing any magic, and the instance isn't too hard to write by hand:</p>\n\n<pre><code>instance Show (x (Foobar x)) =&gt; Show (Foobar x) where\n  showsPrec p (Foo x) = showParen (p &gt; app_prec) $\n                          showString \"Foo \" . showsPrec (app_prec + 1) x\n    where app_prec = 10 :: Int\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1462921780, "creation_date": 1462921780, "answer_id": 37150374, "question_id": 37148710, "link": "https://stackoverflow.com/questions/37148710/cant-write-a-show-instance-for-this-type/37150374#37150374", "title": "Can&#39;t write a Show instance for this type", "body": "<p>Here is how to do it with no extensions:</p>\n\n<pre><code>data Foobar x = Foo (x (Foobar x))\n\nclass Show1 f where\n    showsPrec1 :: Show a =&gt; Int -&gt; f a -&gt; ShowS\n\ninstance Show1 f =&gt; Show (Foobar f) where\n    showsPrec n (Foo v) = (\"Foo \" ++) . showsPrec1 n v -- doesn't handle n correctly because that's not the point of the question and would only distract from the actual important idea\n</code></pre>\n\n<p>The <code>Show1</code> class (and some instances for standard types) is also available <a href=\"https://hackage.haskell.org/package/prelude-extras-0.4.0.3/docs/Prelude-Extras.html#t:Show1\" rel=\"noreferrer\">on Hackage</a>. The module that defines it uses a few extensions -- but only to reduce boilerplate, and not to enable anything that boring old Haskell2010 can't do.</p>\n"}], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 37149293, "answer_count": 3, "score": 3, "last_activity_date": 1545158968, "creation_date": 1462913382, "last_edit_date": 1545158968, "question_id": 37148710, "link": "https://stackoverflow.com/questions/37148710/cant-write-a-show-instance-for-this-type", "title": "Can&#39;t write a Show instance for this type", "body": "<p>Consider the following type declaration:</p>\n\n<pre><code>data Foobar x = Foo (x (Foobar x))\n</code></pre>\n\n<p>Now write a <code>Show</code> instance for that. I dare you!</p>\n\n<p>I casually wrote <code>deriving Show</code>, expecting GHC to do it's thing. But it complained that it couldn't do it. \"Poor simpleton\", I thought, and proceeded to define it myself. But... um... oh, actually that's quite interesting... Clearly <code>Foobar x</code> is only showable when <code>x y</code> is showable for showable <code>y</code>... or... something like that... aaargh!</p>\n\n<p>Now I'm sure I cannot possibly be the first person to define a type such as this. And I can't be the first person to want a <code>Show</code> instance for it. So somebody must have figured out how to do this.</p>\n"}, {"tags": ["haskell", "haddock"], "answers": [{"comments": [{"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1462934231, "post_id": 37149175, "comment_id": 61841867, "body": "I had considered this, and in the long run it may be the route I choose to take with the library. However, I am still interested, largely out of curiosity, if what I asked about is possible. If you include an answer to that question in your answer, I will accept it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1463519634, "post_id": 37149175, "comment_id": 62097648, "body": "@Kwarrtz, I&#39;ve added information on how to detect a documentation build."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1463519601, "last_edit_date": 1463519601, "creation_date": 1462915237, "answer_id": 37149175, "question_id": 37148333, "link": "https://stackoverflow.com/questions/37148333/hiding-declaration-of-type-synonym-in-haddock/37149175#37149175", "title": "Hiding declaration of type synonym in Haddock", "body": "<p>If your users really don't need to know what's under the hood, you should use a <code>newtype</code> and not export the constructor. <code>GeneralizedNewtypeDeriving</code> can help ease the pain of this approach. If some of your users may want to peek behind the curtain, you can expose the <code>newtype</code> constructor from a base module but hide it from the main module. Type synonyms are a very weak tool for abstraction in general. The <code>lens</code> library uses them to good effect, to allow packages to define lenses without depending on <code>lens</code>, but that's a bit of an oddball.</p>\n\n<p>I don't think there's any way to tell Haddock to hide what a type synonym means. That doesn't, however, mean you can't do what you want.</p>\n\n<p>Cabal defines the <code>__HADDOCK_VERSION__</code> CPP macro when documentation is being built. If you're so inclined, you can detect this and replace the type synonym with a <code>newtype</code>. This wouldn't compile, of course, but I don't think it should cause Haddock any trouble. I don't think this is at all wise, though.</p>\n"}], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 37149175, "answer_count": 1, "score": 1, "last_activity_date": 1463519601, "creation_date": 1462912077, "question_id": 37148333, "link": "https://stackoverflow.com/questions/37148333/hiding-declaration-of-type-synonym-in-haddock", "title": "Hiding declaration of type synonym in Haddock", "body": "<p>I'm writing a library, and in it I have defined and exported some (very convoluted) type synonym <code>T</code>.</p>\n\n<pre><code>-- | A type\ntype T a b i o = ReaderT (WriterT i a X) (WriterT i b o)\n</code></pre>\n\n<p>Internal to the library, the type makes sense. To a user, however, it is unecessary and confusing. For that reason, I would prefer to hide the actual declaration of the type in the Haddock page.</p>\n\n<p>I.E., I would prefer the Haddock page look like this...</p>\n\n<pre><code>type T a b i o\n    A type\n</code></pre>\n\n<p>... rather than this.</p>\n\n<pre><code>type T a b i o = ReaderT (WriterT i a X) (WriterT i b o)\n    A type\n</code></pre>\n\n<p>Is this possible? If so, how?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1462915568, "post_id": 37148264, "comment_id": 61836516, "body": "If you replaced both of the <code>a</code>s with <code>y</code>, it would work. But by calling one <code>a</code> and the other <code>y</code>, you&#39;re saying that they can be different. But then the definition of the function treats them as the same, so you get the error."}], "answers": [{"comments": [{"owner": {"reputation": 499, "user_id": 3023426, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/H7JSx.jpg?s=128&g=1", "display_name": "ohmygoddess", "link": "https://stackoverflow.com/users/3023426/ohmygoddess"}, "edited": false, "score": 0, "creation_date": 1462916263, "post_id": 37148351, "comment_id": 61836818, "body": "Thank you! It makes sense to me now. I just tested it using an example."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 3, "last_activity_date": 1462912119, "creation_date": 1462912119, "answer_id": 37148351, "question_id": 37148264, "link": "https://stackoverflow.com/questions/37148264/declare-function-type-in-function-definition-in-haskell/37148351#37148351", "title": "declare function type in function definition in haskell", "body": "<p>The specific names of your type variables do not matter, that is the types <code>a -&gt; b -&gt; c</code>, <code>x -&gt; y -&gt; z</code> and <code>foo -&gt; bar -&gt; baz</code> are all completely equivalent.</p>\n\n<p>What does matter is whether you use the same type variable multiple times or you use different ones. That is <code>a -&gt; b</code> is a different type than <code>a -&gt; a</code>. Specifically <code>a -&gt; b</code> is more general because out of the concrete types <code>Int -&gt; Int</code>, <code>String -&gt; String</code>, <code>Int -&gt; String</code> and <code>String -&gt; Int</code>, <code>a -&gt; a</code> would only match the first two (with <code>a = Int</code> and <code>a = String</code> respectively) whereas <code>a -&gt; b</code> would match all four.</p>\n"}], "owner": {"reputation": 499, "user_id": 3023426, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/H7JSx.jpg?s=128&g=1", "display_name": "ohmygoddess", "link": "https://stackoverflow.com/users/3023426/ohmygoddess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "accepted_answer_id": 37148351, "answer_count": 1, "score": 2, "last_activity_date": 1462916446, "creation_date": 1462911801, "last_edit_date": 1462916446, "question_id": 37148264, "link": "https://stackoverflow.com/questions/37148264/declare-function-type-in-function-definition-in-haskell", "title": "declare function type in function definition in haskell", "body": "<p>I just began to learn haskell recently. I have some confusion of declare function type in the function definition. For example if we want to define a foldr function:</p>\n\n<pre><code>foldr :: (a-&gt;b-&gt;b)-&gt;b-&gt;[a]-&gt;b\nfoldr f v [] = v\nfoldr f v (x:xs) = f x (foldr f v xs)\n</code></pre>\n\n<p>Thus,  foldr (+) 0 [1,2,3,4] = sum [1,2,3,4] = 10.</p>\n\n<p>My question is: can I just change it to something like :</p>\n\n<pre><code>foldr :: (a-&gt;a-&gt;a)-&gt;a-&gt;[a]-&gt;a\n OR:\nfoldr :: (a-&gt;b-&gt;c)-&gt;x-&gt;[y]-&gt;z\n</code></pre>\n\n<p>I didn't find a place to explain the choice/requirements of letters in the definition. Thanks!</p>\n\n<hr>\n\n<p>Update:\nI tested it with:</p>\n\n<pre><code> foldr :: (a-&gt;b-&gt;c)-&gt;x-&gt;[y]-&gt;z\n</code></pre>\n\n<p>Got the following err:</p>\n\n<pre><code>   Couldn't match type `y' with `a'\n  `y' is a rigid type variable bound by\n      the type signature for folderr :: (a -&gt; b -&gt; c) -&gt; x -&gt; [y] -&gt; z\n      at test.hs:3:1\n  `a' is a rigid type variable bound by\n      the type signature for folderr :: (a -&gt; b -&gt; c) -&gt; x -&gt; [y] -&gt; z\n      at test.hs:3:1\n</code></pre>\n\n<p>If changed everything to a, it works. I must have missing some points here.</p>\n\n<hr>\n\n<p>As explained in @sepp2k's comments. I tested using the following simple example:</p>\n\n<pre><code>     folderr :: (a-&gt;b-&gt;b)-&gt;b-&gt;[a]-&gt;b\n     folderr f v [] = v\n     folderr f v (x:xs) = f x (folderr f v xs)\n\n\n     myop :: Int -&gt; Bool -&gt; Bool\n     myop x y | x &gt; 0 = True &amp;&amp; y\n              | otherwise = False &amp;&amp; y\n</code></pre>\n\n<p>folderr (myop) True [3,3,222]   -> True\nfolderr (myop) True [3,2,-1] -> False</p>\n\n<p>So a,b just means the types are different or not.</p>\n"}, {"tags": ["string", "parsing", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 0, "creation_date": 1462910215, "post_id": 37147659, "comment_id": 61833567, "body": "I have a question regarding <code>read</code>. How do I use the parsing value? <code>read</code> is called like this <code>read str :: Type</code>, but your function <code>getFirstInteger</code> gives me a parse error since it doesn&#39;t have the type mentioned. If I write in Prelude <code>(read . head . word) &quot;a12&quot; :: Int</code>, it also gives me an error."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "edited": false, "score": 0, "creation_date": 1462911767, "post_id": 37147659, "comment_id": 61834395, "body": "@RazvanMeriniuc: your example says that <code>&quot;12kids&quot;</code> isn&#39;t a valid string, so an error is expected in <code>&quot;a12&quot;</code>. Note that the type you expect from <code>read</code> is non-ambiguous due to <code>getFirstInteger</code>&#39;s type signature."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 4, "last_activity_date": 1462910091, "last_edit_date": 1462910091, "creation_date": 1462909692, "answer_id": 37147659, "question_id": 37147458, "link": "https://stackoverflow.com/questions/37147458/haskell-elegant-solution-for-integer-parsing/37147659#37147659", "title": "Haskell: Elegant solution for integer parsing", "body": "<pre><code>getFirstInteger :: String -&gt; Int\ngetFirstInteger = read . head . words\n</code></pre>\n\n<p><code>words</code> will split the <code>String</code> into a list of <code>Strings</code>, which were originally separated by whitespace. <code>head</code> will take the first (or <code>error</code> if the original string was empty), and <code>read</code> will parse the string as usual (and <code>error</code> if the first word wasn't a valid <code>Int</code>).</p>\n\n<p>However, I prefer a variant that doesn't use <code>error</code> on empty <code>String</code>s or unparseable ones, e.g.</p>\n\n<pre><code>import Text.Read (readMaybe)\n\ngetFirstInteger :: String -&gt; Maybe Int\ngetFirstInteger [] = Nothing\ngetFirstInteger xs = readMaybe . head . words $ xs\n</code></pre>\n\n<p>One could write this completely point-free with <code>listToMaybe</code> from <code>Data.Maybe</code>, but that's probably an overkill:</p>\n\n<pre><code>import Data.Maybe (listToMaybe)\nimport Text.Read (readMaybe)\nimport Control.Monad ((&gt;=&gt;))\n\ngetFirstInteger :: String -&gt; Maybe Int\ngetFirstInteger = listToMaybe . words &gt;=&gt; readMaybe\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1462910361, "creation_date": 1462910361, "answer_id": 37147857, "question_id": 37147458, "link": "https://stackoverflow.com/questions/37147458/haskell-elegant-solution-for-integer-parsing/37147857#37147857", "title": "Haskell: Elegant solution for integer parsing", "body": "<p>If you want to parse strings without using parser combinator libraries or any of the machinery in Text.Read, have a look at the functions <code>break</code> and <code>span</code>:</p>\n\n<pre><code>span :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\nbreak :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n\n<p>The nice thing is that both of these functions not only return what they match but also the remainder of the string allowing you to continue your parsing.</p>\n\n<p>To solve your problem:</p>\n\n<pre><code>import Data.Char\n\ngetFirstInteger :: String -&gt; Maybe Int\ngetFirstInteger str\n   let (digs, rest1) = span isDigit str\n       endsok = case rest1 of\n                  [] -&gt; True\n                  (c:_) -&gt; c == ' '\n   in\n   if not (null digs) &amp;&amp; endsok\n     then Just (read digs)\n     else Nothing          -- either no digits or doesn't end properly\n</code></pre>\n\n<p>This version does not allow a leading minus sign. This next version allows an optional leading minus sign for the integer:</p>\n\n<pre><code>getFirstInteger' str =\n  let (minus,rest1) = span (=='-') str\n      (digs, rest2) = span  isDigit rest1\n      endsok = case rest2 of\n                 [] -&gt; True\n                 (c:_) -&gt; c == ' '\n  in\n  if length minus &lt;= 1 &amp;&amp; not (null digs) &amp;&amp; endsok\n    then Just (read (minus ++ digs))\n    else Nothing\n</code></pre>\n\n<p>Yes - this does not terminate as early as possible on bad input. I provide it mainly as an example of how to chain together calls to <code>span</code> and <code>break</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462969501, "post_id": 37148256, "comment_id": 61860481, "body": "Given the arbitrary amount of whitespace after <code>12</code>, you might want to use <code>lex</code> instead. Also, I think your patterns should be <code>[(n, ...)]</code>, unless you <i>really</i> want to accept ambiguous parsings."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462988813, "post_id": 37148256, "comment_id": 61874582, "body": "@Zeta The OP says nothing about arbitrary amounts of whitespace, so I did not assume he wanted to consume arbitrary amounts of whitespace. The standard <code>Read</code> instances do not produce ambiguous parses. I considered both of these subtleties while writing this answer. I also considered some you didn&#39;t mention; for example, the standard <code>Read</code> instance for <code>Int</code> will accept some things outside the OP&#39;s specification like extra whitespace <i>before</i> the number and numbers in parentheses; I judged these to be an acceptable tradeoff for the low code required to implement this solution."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462995787, "post_id": 37148256, "comment_id": 61878487, "body": "You already got my upvote before I commented, :D. I was more or less thinking from a teaching perspective. I&#39;m aware of those (let&#39;s call them) &quot;quirks&quot;, but OP might not. And yes, the tradeoff is perfectly acceptable."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1463000736, "post_id": 37148256, "comment_id": 61881130, "body": "@Zeta Yes, good point. I&#39;ll add some text to the answer calling out some of these considerations."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1463001165, "last_edit_date": 1463001165, "creation_date": 1462911777, "answer_id": 37148256, "question_id": 37147458, "link": "https://stackoverflow.com/questions/37147458/haskell-elegant-solution-for-integer-parsing/37148256#37148256", "title": "Haskell: Elegant solution for integer parsing", "body": "<p>Use <code>reads</code>. For example:</p>\n\n<pre><code>type Unit = String\n\nreadUnit :: String -&gt; Maybe (Int, Maybe Unit)\nreadUnit s = case reads s of               -- the integer is at the beginning of the string and...\n    (n, ' ':unit):_ -&gt; Just (n, Just unit) -- is followed by space...\n    (n, \"\"      ):_ -&gt; Just (n, Nothing)   -- or nothing.\n    _ -&gt; Nothing\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; readUnit \"12\"\nJust (12,Nothing)\n&gt; readUnit \"12 kids\"\nJust (12,Just \"kids\")\n&gt; readUnit \"12kids\"\nNothing\n&gt; readUnit \"a12\"\nNothing\n</code></pre>\n\n<p>However, there are a few minor considerations to keep in mind. It's possible that <code>read</code> does not restrict the syntax as much as you might want; for example, the following answer may surprise you:</p>\n\n<pre><code>&gt; readUnit \"  ((-0x5)) kids\"\nJust (-5,Just \"kids\")\n</code></pre>\n\n<p>You may also want to drop extraneous spaces in the unit; for example, you could change the first clause above to</p>\n\n<pre><code>(n, ' ':unit):_ -&gt; Just (n, Just (dropWhile isSpace unit))\n</code></pre>\n\n<p>or similar. And as a final variation on this theme, note that while the standard instances of <code>Read</code> never return lists with more than one element from <code>reads</code>, it is technically possible that some user-supplied type may do so. So if you were ever to use <code>reads</code> to parse types other than <code>Int</code>, you may want to either demand an unambiguous parse or consider all the parses before deciding what to do; the above code bakes in the assumption that the first parse is as good as any.</p>\n"}], "owner": {"reputation": 172, "user_id": 4932965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30dd676072dec501db6881c9dd4ac970?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Meriniuc", "link": "https://stackoverflow.com/users/4932965/razvan-meriniuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1245, "favorite_count": 0, "accepted_answer_id": 37147857, "answer_count": 3, "score": 2, "last_activity_date": 1463001165, "creation_date": 1462908969, "question_id": 37147458, "link": "https://stackoverflow.com/questions/37147458/haskell-elegant-solution-for-integer-parsing", "title": "Haskell: Elegant solution for integer parsing", "body": "<p>I want to write a function that gets the first integer in a string, if the integer is at the beginning of the string and is followed by space or nothing.</p>\n\n<p>For example, \"12\" and \"12 kids\" would be valid strings, but \"12kids\", \"a12\" are invalid.</p>\n\n<p>This is my function:</p>\n\n<pre><code>getFirstInteger :: String -&gt; Int\ngetFirstInteger []                                      = error \"No integer\"\ngetFirstInteger str\n  | dropWhile (Char.isNumber) str == []                 = read str :: Int\n  | Char.isSpace $ head $ dropWhile (Char.isNumber) str = read (takeWhile (Char.isNumber) str) :: Int\n  | otherwise                                           = error \"No integer found\" \n</code></pre>\n\n<p>The problem is that if the string is actually an integer, <code>head</code> will raise an exception, so that is why the first condition exists. Is there any elegant solution to this problem?</p>\n"}, {"tags": ["windows", "haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462907884, "post_id": 37147084, "comment_id": 61832300, "body": "no there is no easy way using cabal - basically you do what you are told and get a Msys2 ... or you grab <code>stack</code> (which will get it for you)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462907976, "post_id": 37147084, "comment_id": 61832344, "body": "I think they&#39;re only untared temporarily. You can use <code>cabal unpack</code> to get a local unpacked copy in your current directory. Note that updating the global Cabal package database is usually a bad idea."}, {"owner": {"reputation": 157, "user_id": 5696999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2JksN.png?s=128&g=1", "display_name": "ENPM", "link": "https://stackoverflow.com/users/5696999/enpm"}, "edited": false, "score": 0, "creation_date": 1462909431, "post_id": 37147084, "comment_id": 61833122, "body": "So to put it more generally: what is the <i>recommended</i> way of updating a given package?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462910454, "post_id": 37147084, "comment_id": 61833703, "body": "@ENPM don&#39;t - use sandboxes or better stack to handle this for you (it will not update the package as in removing the old one) - but on windows the <i>sane</i> option right now is really stack - if you don&#39;t run into stupid restrictions with the length of paths it can handle almost anything you throw at it"}, {"owner": {"reputation": 157, "user_id": 5696999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2JksN.png?s=128&g=1", "display_name": "ENPM", "link": "https://stackoverflow.com/users/5696999/enpm"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462910714, "post_id": 37147084, "comment_id": 61833818, "body": "@Carsten Alright so. Installing stack now. Thanks for the help."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1517906789, "creation_date": 1517906789, "answer_id": 48638782, "question_id": 37147084, "link": "https://stackoverflow.com/questions/37147084/update-haskell-package-on-windows/48638782#48638782", "title": "Update Haskell Package on Windows", "body": "<p>Current versions of ghc and the haskell platform ship with an msys distro. Adding a few lines (in the instructions) to the cabal config file allows <code>cabal</code> to take advantage of this, in after which you can build packages with custom configure scrips (such as <code>network</code> or <code>old-time</code>) just fine.</p>\n"}], "owner": {"reputation": 157, "user_id": 5696999, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2JksN.png?s=128&g=1", "display_name": "ENPM", "link": "https://stackoverflow.com/users/5696999/enpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517906803, "creation_date": 1462907660, "last_edit_date": 1517906803, "question_id": 37147084, "link": "https://stackoverflow.com/questions/37147084/update-haskell-package-on-windows", "title": "Update Haskell Package on Windows", "body": "<p>How do you update a pre-installed Haskell package (for example, the System.Directory package) on Windows? I've tried simply telling cabal to install it but it encountered an error while doing so.</p>\n\n<pre><code>The package has a '.configure' script. This requires a Unix compatibility toolchain such \nas MinGW+MSYS or Cygwin.\ncabal: Error: some packages failed to install:\ndirectory-1.2.6.3 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>I presume there is an easy way of doing this within cabal. Failing this, where do the various files in the .tar.gz available off Hackage for a pre-installed package go? Thanks in advance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462904952, "post_id": 37146065, "comment_id": 61830605, "body": "<code>read</code>? ... I have some trouble understanding your question - can you add some examples or try to rework it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462969790, "post_id": 37146065, "comment_id": 61860689, "body": "In my mind, this question is asking for a universal <code>readDyn :: String -&gt; Maybe Dynamic</code> which is able to read &quot;anything&quot;, and let the user test whether the <code>Dynamic</code> is of this or that type."}], "answers": [{"tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 0, "last_activity_date": 1462905655, "creation_date": 1462905655, "answer_id": 37146491, "question_id": 37146065, "link": "https://stackoverflow.com/questions/37146065/fromstring-in-haskell-with-checking-returned-type/37146491#37146491", "title": "fromString in haskell - with checking returned type", "body": "<p>Use <code>read</code>:</p>\n\n<pre><code>\u03bb&gt; :t read\nread :: Read a =&gt; String -&gt; a\n\u03bb&gt; read \"42\" :: Int\n42\n\u03bb&gt; read \"True\" :: Bool\nTrue\n\u03bb&gt; read \"\\\"a string\\\"\" :: String\n\"a string\"\n\u03bb&gt; read \"[1,2,3]\" :: [Int]\n[1,2,3]\n</code></pre>\n\n<p>However, I don't recommend <code>read</code> unless you can check that your input is valid because <code>read</code> returns an error if the given string could not be parsed, instead of <code>Nothing</code>. Try implementing your own function instead (using monads like <code>Maybe</code> or <code>Either</code> preferably).</p>\n"}, {"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 4, "creation_date": 1462906009, "post_id": 37146505, "comment_id": 61831173, "body": "I would recommend using <code>Text.Read.readMaybe</code> instead of re-implementing a parser for every specific type needed."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1462908498, "post_id": 37146505, "comment_id": 61832626, "body": "For a good example of why you shouldn&#39;t reimplement things all the time: your <code>readInt</code> parser doesn&#39;t accept negative numbers, let alone octal, hex, etc."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1462905712, "creation_date": 1462905712, "answer_id": 37146505, "question_id": 37146065, "link": "https://stackoverflow.com/questions/37146065/fromstring-in-haskell-with-checking-returned-type/37146505#37146505", "title": "fromString in haskell - with checking returned type", "body": "<p><code>fromString</code> already exists as a function in the typeclass <code>IsString</code>. It's main use is to (with the <code>-XOverloadedStrings</code> compile option) allow you to use string literals for all of the different string implementations that Haskell has, e.g. strict/lazy ByteString and strict/lazy Text, but there are other instances, e.g. for urls, file paths, and others.</p>\n\n<p>You mention both <em>convert</em> and <em>check</em> operations. For conversion I would suggest using <code>read</code>. Here is a simple program which converts a string to a Bool:</p>\n\n<pre><code>main = do putStr \"Enter a boolean:\"\n          inp &lt;- getLine\n          let b = read inp\n          if b then putStrLn \"You entered True\"\n               else putStrLn \"You entered False\"\n</code></pre>\n\n<p>However, if the user does not enter either <code>True</code> or <code>False</code>, <code>read</code> will throw an error. So only use <code>read</code> if you know you have valid input or if it is ok to die if the input is invalid.</p>\n\n<p>If you need to check for invalid input, I think the simplest approach is to simply write your own functions - at least for simple types like <code>Bool</code> and <code>Int</code>:</p>\n\n<pre><code>readBool :: String -&gt; Maybe Bool\nreadBool str | str == \"True\"  = Just True\n             | str == \"true\"  = Just True\n             | str == \"False\" = Just False\n             | str == \"false\" = Just False\n             | otherwise      = Nothing\n\nimport Data.Char\n\nreadInt :: String -&gt; Maybe Int\nreadInt str | all isDigit str = Just (read str)\n            | otherwise       = Nothing\n</code></pre>\n\n<p>Note that the call to <code>read</code> in <code>readInt</code> should never fail since we've already verified that the input is valid.</p>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1462909084, "last_edit_date": 1462909084, "creation_date": 1462907648, "answer_id": 37147078, "question_id": 37146065, "link": "https://stackoverflow.com/questions/37146065/fromstring-in-haskell-with-checking-returned-type/37147078#37147078", "title": "fromString in haskell - with checking returned type", "body": "<p>Use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow\"><code>readMaybe</code></a> from <code>Text.Read</code>. It returns <code>Nothing</code> if the value couldn't get parsed (aka if <code>read</code> would throw an error):</p>\n\n<pre><code>import Text.Read (readMaybe)\n\nisInteger :: String -&gt; Bool\nisInteger xs = (readMaybe xs :: Maybe Integer) /= Nothing\n\nisBool    :: String -&gt; Bool\nisBool    xs = (readMaybe xs :: Maybe Bool)    /= Nothing\n</code></pre>\n\n<p>Of course, if you actually want to <em>use</em> the <code>Integer</code> or <code>Bool</code>, you use <code>readMaybe</code>'s result:</p>\n\n<pre><code>isPositive :: String -&gt; Either String Bool\nisPositive xs = case readMaybe xs :: Maybe Integer of\n                  Just n  -&gt; Right (n &gt; 0)\n                  Nothing -&gt; Left \"Not an Integer\"\n</code></pre>\n\n<p>Note that <code>readMaybe</code> uses <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:reads\" rel=\"nofollow\"><code>reads</code></a>, which is available in the Prelude. I suggest you to re-implement <code>readMaybe</code> with <code>reads</code> if you want to know how <code>read</code> and the <code>Read</code> instances work.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 37146505, "answer_count": 3, "score": 1, "last_activity_date": 1462909084, "creation_date": 1462904158, "question_id": 37146065, "link": "https://stackoverflow.com/questions/37146065/fromstring-in-haskell-with-checking-returned-type", "title": "fromString in haskell - with checking returned type", "body": "<p>Is there exists function <code>fromString</code> in haskell ?  I am expectning that beside convert from String to <code>a</code>, I would be able to check if <code>a</code> is Integer or <code>Boolean</code>.   Could you  help me ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1462898085, "post_id": 37144229, "comment_id": 61826665, "body": "Not too far into this tutorial they read in a character: <a href=\"https://www.haskell.org/tutorial/io.html\" rel=\"nofollow noreferrer\">haskell.org/tutorial/io.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 2, "last_activity_date": 1462898102, "creation_date": 1462898102, "answer_id": 37144275, "question_id": 37144229, "link": "https://stackoverflow.com/questions/37144229/how-can-i-use-getline-or-getchar-in-haskell/37144275#37144275", "title": "How can I use getLine or getChar in haskell?", "body": "<p>Here is a sample</p>\n\n<pre><code>main = do\n    x &lt;- getLine\n    putStrLn $ \"Here is the string you typed in: \" ++ x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "is_accepted": true, "score": 1, "last_activity_date": 1462903720, "last_edit_date": 1462903720, "creation_date": 1462898108, "answer_id": 37144277, "question_id": 37144229, "link": "https://stackoverflow.com/questions/37144229/how-can-i-use-getline-or-getchar-in-haskell/37144277#37144277", "title": "How can I use getLine or getChar in haskell?", "body": "<p>Reading from console, maybe is not very useful. However you should use <code>&lt;-</code> construct.</p>\n\n<p>For example (without <code>\"</code> is good too) :</p>\n\n<pre><code>&gt;myString &lt;- getLine\n&gt;\"Hello world\" \n</code></pre>\n\n<p>or</p>\n\n<pre><code>&gt;myChar &lt;- getChar\n&gt;c\n</code></pre>\n\n<p>For more I suggest to read <a href=\"http://learnyouahaskell.com/input-and-output\" rel=\"nofollow\">here</a> </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4929787"}, "edited": false, "score": 0, "creation_date": 1462904021, "post_id": 37145214, "comment_id": 61830053, "body": "Thanks for your answer it&#39;s very accurate, however I asked for use it directly from the console."}, {"owner": {"reputation": 1821, "user_id": 2391244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyC7o.jpg?s=128&g=1", "display_name": "BalinKingOfMoria Reinstate CMs", "link": "https://stackoverflow.com/users/2391244/balinkingofmoria-reinstate-cms"}, "edited": false, "score": 0, "creation_date": 1477453227, "post_id": 37145214, "comment_id": 67768711, "body": "@user4929787 (I think you&#39;re referring to using it from inside <code>ghci</code>... if I assumed incorrectly, please let me know!) Try <code>ch &lt;- getChar</code> rather than <code>let ch = getChar</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1462901312, "creation_date": 1462901312, "answer_id": 37145214, "question_id": 37144229, "link": "https://stackoverflow.com/questions/37144229/how-can-i-use-getline-or-getchar-in-haskell/37145214#37145214", "title": "How can I use getLine or getChar in haskell?", "body": "<p>The type of <code>getChar</code> is <code>IO Char</code>. It is not a function that returns a <code>Char</code>; it is an IO action that, when executed, returns a <code>Char</code>. (While subtle, this distinction is crucial to understanding how Haskell performs IO with pure functions.)</p>\n\n<p>The line</p>\n\n<pre><code>let x = getChar\n</code></pre>\n\n<p>just binds the name <code>x</code> to the same IO action (which you can see by subsequently typing <code>:t x</code> in GHCi). Typing <code>x</code> then executes that action; GHCI waits for you to type a character, then it immediately returns that character.</p>\n\n<p>To use <code>getChar</code> in a program, you need to use it within an IO monad, with something like</p>\n\n<pre><code>main = do ch &lt;- getChar\n          print ch\n</code></pre>\n\n<p>or</p>\n\n<pre><code>main = getChar &gt;&gt;= print\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 785337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f998d9676f41047e30f37c44f5a1b?s=128&d=identicon&r=PG", "display_name": "Rafa Moyano", "link": "https://stackoverflow.com/users/785337/rafa-moyano"}, "is_accepted": false, "score": 0, "last_activity_date": 1556596561, "last_edit_date": 1556596561, "creation_date": 1556595449, "answer_id": 55913633, "question_id": 37144229, "link": "https://stackoverflow.com/questions/37144229/how-can-i-use-getline-or-getchar-in-haskell/55913633#55913633", "title": "How can I use getLine or getChar in haskell?", "body": "<p>You need to bind it to a variable using <strong>&lt;-</strong>, the result of an action is being bound:</p>\n\n<pre><code>*Main&gt; variable &lt;- getLine \n hello      \n*Main&gt; putStrLn variable \n hello\n*Main&gt; anotherChar &lt;- getChar\na*Main&gt; \n*Main&gt; putChar anotherChar \na*Main&gt; \n</code></pre>\n\n<p>Function <strong>getLine</strong> has type IO String and <strong>getChar</strong> has type IO Char.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4929787"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4483, "favorite_count": 0, "accepted_answer_id": 37144277, "answer_count": 4, "score": 2, "last_activity_date": 1556596561, "creation_date": 1462897944, "question_id": 37144229, "link": "https://stackoverflow.com/questions/37144229/how-can-i-use-getline-or-getchar-in-haskell", "title": "How can I use getLine or getChar in haskell?", "body": "<p>I'm trying to get from my console a <code>string</code> or just a <code>char</code> and store into a variable.</p>\n\n<p>I tried to use:</p>\n\n<pre><code>&gt; let x = getChar\n&gt; x\n&gt; c -- for getting a char.\n</code></pre>\n\n<p>But nothing is stored (same for getLine) how can I do?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6316336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ad20bb24bd1bdcd7f28d06ed75b66b?s=128&d=identicon&r=PG&f=1", "display_name": "Kabal", "link": "https://stackoverflow.com/users/6316336/kabal"}, "edited": false, "score": 0, "creation_date": 1462905804, "post_id": 37144328, "comment_id": 61831066, "body": "Hi, thanks for your answer, but what if I actually want the return type from part1 to be a fractional? I tried with &quot;part1 :: Integer -&gt; Integer -&gt; Integer -&gt; Float&quot; but taht did not work"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1462898304, "creation_date": 1462898304, "answer_id": 37144328, "question_id": 37144190, "link": "https://stackoverflow.com/questions/37144190/haskell-no-instance-for-fractional-a0-arising/37144328#37144328", "title": "Haskell No instance for (Fractional a0) arising", "body": "<p>Your problem here is a very common one - it roots into you mixing <code>(/)</code> with <code>Integral</code> operations like <code>mod</code> - this leads to two constraints: one for <code>Integral</code> and one for <code>Fractional</code> (the <code>(/)</code>) - but there is no basic number type which is an instance of both of them - so you end up with <em>unsolvable</em> constraints and GHC(i) will not find a matching instance and complain.</p>\n\n<p>Most of this becomes obvious if you signatures - yes you don't have to but as you can see here it's valuable to do so anyway.</p>\n\n<p>Assuming you want to work over <code>Integer</code> you get this:</p>\n\n<pre><code>part1 :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\npart1 j n 0 = 0\npart1 j n k = (part1 j n (k-1)) + (powmod 16 (n-k) r) `div` r\n   where\n     r = 8*k+j\n</code></pre>\n\n<p>note that I replaced <code>(/)</code> with <code>div</code>? Haskell points you to this as soon as you include expected types.</p>\n\n<p><em>also</em> note that of course</p>\n\n<pre><code>part1 :: Integral a =&gt; a -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>will work as well</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 6316336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ad20bb24bd1bdcd7f28d06ed75b66b?s=128&d=identicon&r=PG&f=1", "display_name": "Kabal", "link": "https://stackoverflow.com/users/6316336/kabal"}, "is_accepted": false, "score": 0, "last_activity_date": 1462906804, "creation_date": 1462906804, "answer_id": 37146832, "question_id": 37144190, "link": "https://stackoverflow.com/questions/37144190/haskell-no-instance-for-fractional-a0-arising/37146832#37146832", "title": "Haskell No instance for (Fractional a0) arising", "body": "<p>I solved it. I needed some fromIntegral conversions. Final code:</p>\n\n<pre><code>part1 :: Integer -&gt; Integer -&gt; Integer -&gt; Double\npart1 j n 0 = 0\npart1 j n k =  (part1 j n (k-1)) + (fromIntegral (powmod 16 (n-k) r)) / fromIntegral r\n where\n   r = 8*k+j\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6316336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ad20bb24bd1bdcd7f28d06ed75b66b?s=128&d=identicon&r=PG&f=1", "display_name": "Kabal", "link": "https://stackoverflow.com/users/6316336/kabal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462906804, "creation_date": 1462897834, "last_edit_date": 1462905646, "question_id": 37144190, "link": "https://stackoverflow.com/questions/37144190/haskell-no-instance-for-fractional-a0-arising", "title": "Haskell No instance for (Fractional a0) arising", "body": "<p>I have the following code in Haskell:</p>\n\n<pre><code>powmod base 1 m = mod base m\npowmod base exp m | even exp  = mod (pow2 * pow2) m\n                  | otherwise = mod (base * powmod base (exp - 1) m) m\n     where\n        pow2 = powmod base (div exp 2) m\n\npart1 j n 0 = 0\npart1 j n k = (part1 j n (k-1)) + (powmod 16 (n-k) r)/r\n   where\n     r = 8*k+j\n</code></pre>\n\n<p>The code is loaded without any problem on ghci. The problem comes when I try to call the function part1 as:</p>\n\n<pre><code>part1 4 10 4\n</code></pre>\n\n<p>I get:</p>\n\n<blockquote>\n  <p>No instance for (Fractional a0) arising from a use of <code>it' The type\n  variable</code>a0' is ambiguous Note: there are several potential\n  instances:   instance Integral a => Fractional (GHC.Real.Ratio a)\n      -- Defined in <code>GHC.Real'   instance Fractional Double -- Defined in</code>GHC.Float'   instance Fractional Float -- Defined in <code>GHC.Float'\n  In the first argument of</code>print', namely `it' In a stmt of an\n  interactive GHCi command: print it</p>\n</blockquote>\n\n<p>I don't understand this problem. Any help would be great. Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1462900594, "post_id": 37143832, "comment_id": 61828074, "body": "When you say you want it to handle many lines, do you mean the lines will have separate expressions, which are separately handled, perhaps with interleaving some interaction with the program, or do you just mean you want to be able to handle a text which may have many newlines? If the latter, you just use <code>fmap lines getContents</code>, which will accept material from stdin up til EOF and deliver a list of separate lines. (It is probably better to use <code>Data.Text.IO.getContents</code> for this, by the way.)"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1462900721, "post_id": 37143832, "comment_id": 61828147, "body": "Sorry, I got rid of the first version since it was ungrammatical, but then reverted it... But, to return, is the idea that each lambda entered will immediately be followed by a response, until EOF?"}, {"owner": {"reputation": 593, "user_id": 1764929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/533cc4c907b7d2b6b38d4b33b96edd1e?s=128&d=identicon&r=PG", "display_name": "G&#225;bor Birk&#225;s", "link": "https://stackoverflow.com/users/1764929/g%c3%a1bor-birk%c3%a1s"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1462900948, "post_id": 37143832, "comment_id": 61828266, "body": "@Michael So, if there are say 5 lambda expressions, one in each line, then I would see 5 response lines after the input lines. Enter 1 line &gt; print 1 line. Enter 5 lines &gt; print 5 lines."}, {"owner": {"reputation": 593, "user_id": 1764929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/533cc4c907b7d2b6b38d4b33b96edd1e?s=128&d=identicon&r=PG", "display_name": "G&#225;bor Birk&#225;s", "link": "https://stackoverflow.com/users/1764929/g%c3%a1bor-birk%c3%a1s"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1462901013, "post_id": 37143832, "comment_id": 61828301, "body": "@Michael And since we&#39;re talking functional languages here, I think all the input will be read into a string and then split somehow. And then I would have to process the lines one by one."}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 1764929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/533cc4c907b7d2b6b38d4b33b96edd1e?s=128&d=identicon&r=PG", "display_name": "G&#225;bor Birk&#225;s", "link": "https://stackoverflow.com/users/1764929/g%c3%a1bor-birk%c3%a1s"}, "edited": false, "score": 0, "creation_date": 1462902509, "post_id": 37145257, "comment_id": 61829108, "body": "Excellent answer and explanation! Very educational. Exactly what I was looking for. Many thanks!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1462901976, "last_edit_date": 1462901976, "creation_date": 1462901436, "answer_id": 37145257, "question_id": 37143832, "link": "https://stackoverflow.com/questions/37143832/read-in-multiple-lines-from-standard-input-with-arguments-in-haskell/37145257#37145257", "title": "Read in multiple lines from standard input with arguments in Haskell", "body": "<p>It appears you want to:</p>\n\n<ol>\n<li>Parse a command line option which may or may not exist.</li>\n<li>For each line of input process it with some function.</li>\n</ol>\n\n<p>Here is an approach using lazy IO:</p>\n\n<pre><code>import System.Environment\nimport Control.Monad\n\nmain = do args &lt;- getArgs\n          let option = case args of\n                         []    -&gt; ... the default value...\n                         (a:_) -&gt; read a\n\n          contents &lt;- getContents\n          forM_ (lines contents) $ \\aline -&gt; do\n            process option aline\n</code></pre>\n\n<p>I am assuming your processing function has type <code>process :: Int -&gt; String -&gt; IO ()</code>. For instance, it could look like:</p>\n\n<pre><code>process :: Int -&gt; String -&gt; IO ()\nprocess option str = do\n  if length str &lt; option\n    then putStrLn $ \"OK: \" ++ str\n    else putStrLn $ \"NOT OK: line too long\"\n</code></pre>\n\n<p>Here's how it works:</p>\n\n<ol>\n<li><code>contents &lt;- getContents</code> reads all of standard input into the variable <code>contents</code></li>\n<li><code>lines contents</code> breaks up the input into lines</li>\n<li><code>forM_ ...</code> iterates over each line, passing the line to the <code>process</code> function</li>\n</ol>\n\n<p>The trick is that <code>getContents</code> reads standard input lazily so that you'll get some output after each line is read.</p>\n\n<p>You should be aware that there are issues with lazy IO which you may run into when your program becomes more complex. However, for this simple use case lazy IO is perfectly fine and works well.</p>\n"}], "owner": {"reputation": 593, "user_id": 1764929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/533cc4c907b7d2b6b38d4b33b96edd1e?s=128&d=identicon&r=PG", "display_name": "G&#225;bor Birk&#225;s", "link": "https://stackoverflow.com/users/1764929/g%c3%a1bor-birk%c3%a1s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2026, "favorite_count": 0, "accepted_answer_id": 37145257, "answer_count": 1, "score": 2, "last_activity_date": 1462902877, "creation_date": 1462896628, "last_edit_date": 1462898584, "question_id": 37143832, "link": "https://stackoverflow.com/questions/37143832/read-in-multiple-lines-from-standard-input-with-arguments-in-haskell", "title": "Read in multiple lines from standard input with arguments in Haskell", "body": "<p>I'm trying to read in multiple lines from standard input in Haskell, plus one argument, then do something with the current line and write something to the standard output.</p>\n\n<p>In my case I am trying to normalize lambda expressions. The program may receive 1 or more lambda expressions to normalize and then it has to write the result (normalized form or error) to the standard output. And the program may receive an argument (the max number of reductions). Here is the main function:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  params &lt;- getArgs\n  fullLambda &lt;- getLine\n  let lambda = convertInput fullLambda\n  let redNum | (length params) == 1 = read (head params)\n             | otherwise = 100\n  case (parsing lambda) of\n    Left  errorExp -&gt; putStrLn (\"ERROR: \" ++ lambda)\n    Right lambdaExp -&gt; do\n      let normalizedLambdaExp = reduction lambdaExp redNum\n      if (isNormalForm normalizedLambdaExp) &amp;&amp; (isClosed lambdaExp)\n        then putStrLn (\"OK: \" ++ show normalizedLambdaExp)\n        else putStrLn (\"ERROR: \" ++ lambda)\n  where\n    convertInput :: String -&gt; String\n    convertInput ('\\\"':xs) = take ((length xs) - 2) xs\n    convertInput input = input\n</code></pre>\n\n<p>So this code handles one line and completes the reductions and then writes something to the standard output. How can I change this to handle multiple lines? I've read about <em>replicateM</em> but I can't seem to grasp it. My mind is very OO so I was thinking maybe some looping somehow, but that is surely not the preferred way.</p>\n\n<p>Also, this program has to be able to run like this:</p>\n\n<pre><code>echo \"(\\x.x) (\\x.x)\" | Main 25\n</code></pre>\n\n<p>And will produce:</p>\n\n<pre><code>OK: (\\x.x)\n</code></pre>\n\n<p>And if there are multiple lines, it has to produce the same kind of output for each line, in new lines.</p>\n\n<p>But also has to work without the argument, and has to handle multiple lines. I spent time on google and here, but I'm not sure how the argument reading will happen. I need to read in the argument once and the line(s) once or many times. Does someone know a not too lengthy solution to this problem? </p>\n\n<p>I've tried it like this, too (imperatively):</p>\n\n<pre><code>main :: IO ()\nmain = do\n  params &lt;- getArgs\n  mainHelper params\n  main\n\nmainHelper :: [String] -&gt; IO ()\nmainHelper params = do\n  fullLambda &lt;- getLine\n</code></pre>\n\n<p>And so on, but then it puts this to the standard output as well:</p>\n\n<pre><code>Main: &lt;stdin&gt;: hGetLine: end of file\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["sockets", "haskell", "io"], "comments": [{"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 2, "creation_date": 1462897960, "post_id": 37143458, "comment_id": 61826601, "body": "I&#39;m almost sure you have a mess with newline characters. When you press <code>CR</code> in telnet prompt, it sends something like <code>\\r\\n</code>, but <code>hGetLine</code> expects only <code>\\n</code>. So &#39;\\r&#39; becomes part of the username, so &quot;!&quot; is printed on the beginning of the line."}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 3, "creation_date": 1462898015, "post_id": 37143458, "comment_id": 61826633, "body": "see <a href=\"http://stackoverflow.com/questions/25219130/tcp-server-haskell-string-comparison/25219265#25219265\" title=\"tcp server haskell string comparison\">stackoverflow.com/questions/25219130/&hellip;</a>"}, {"owner": {"reputation": 961, "user_id": 2353196, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65de4e83806a99f3948073a0711c7a9c?s=128&d=identicon&r=PG", "display_name": "wickstopher", "link": "https://stackoverflow.com/users/2353196/wickstopher"}, "reply_to_user": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1462898908, "post_id": 37143458, "comment_id": 61827126, "body": "Thanks, that was the right approach. Sanitizing the input by stripping &#39;\\r&#39; characters out does the trick."}, {"owner": {"reputation": 961, "user_id": 2353196, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65de4e83806a99f3948073a0711c7a9c?s=128&d=identicon&r=PG", "display_name": "wickstopher", "link": "https://stackoverflow.com/users/2353196/wickstopher"}, "reply_to_user": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1462898996, "post_id": 37143458, "comment_id": 61827180, "body": "Now, the meta question is: should I mark this as a dup? Would it be useful to post my solution as an answer to my own question? Or @Yuras, would you like to answer?"}], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462903265, "post_id": 37144917, "comment_id": 61829574, "body": "fyi - Data.List defines <code>notElem</code>"}], "tags": [], "owner": {"reputation": 961, "user_id": 2353196, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65de4e83806a99f3948073a0711c7a9c?s=128&d=identicon&r=PG", "display_name": "wickstopher", "link": "https://stackoverflow.com/users/2353196/wickstopher"}, "is_accepted": false, "score": 0, "last_activity_date": 1462900363, "creation_date": 1462900363, "answer_id": 37144917, "question_id": 37143458, "link": "https://stackoverflow.com/questions/37143458/socket-programming-in-haskell-putstrln-hputstrln-not-behaving-as-expected/37144917#37144917", "title": "Socket Programming in Haskell: putStrLn / hPutStrLn not behaving as expected", "body": "<p>I am marking the question as a duplicate, but I wanted to post my solution that came out of that question, in the event that it may prove useful, as the original question doesn't contain an explicit solution.</p>\n\n<p>I wrapped calls to <code>hGetLine handle</code> as follows:</p>\n\n<pre><code>sanitizeInput :: Handle -&gt; IO String\nsanitizeInput handle = do\n    input &lt;- hGetLine handle\n    return (sanitize input)\n\nbadChars :: [Char]\nbadChars = ['\\r']\n\nsanitize :: String -&gt; String\nsanitize = filter (\\x -&gt; not (elem x badChars))\n</code></pre>\n"}], "owner": {"reputation": 961, "user_id": 2353196, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65de4e83806a99f3948073a0711c7a9c?s=128&d=identicon&r=PG", "display_name": "wickstopher", "link": "https://stackoverflow.com/users/2353196/wickstopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "closed_date": 1462900375, "answer_count": 1, "score": 2, "last_activity_date": 1462900363, "creation_date": 1462895610, "last_edit_date": 1462896162, "question_id": 37143458, "link": "https://stackoverflow.com/questions/37143458/socket-programming-in-haskell-putstrln-hputstrln-not-behaving-as-expected", "closed_reason": "Duplicate", "title": "Socket Programming in Haskell: putStrLn / hPutStrLn not behaving as expected", "body": "<p>I am currently attempting to write a toy server in Haskell, with the example at <a href=\"https://wiki.haskell.org/Implement_a_chat_server\" rel=\"nofollow\">https://wiki.haskell.org/Implement_a_chat_server</a> as a baseline for socket programming.</p>\n\n<p>I'm running into an issue in which <code>putStrLn</code> and <code>hPutStrLn</code> are not behaving as I would have expected. The code at the bottom of this post is a complete example demonstrating my problem, and compiles and runs without issue as follows:</p>\n\n<p><code>$ ghc -main-is TestServer.main TestServer.hs</code></p>\n\n<p><code>$ ./TestServer</code></p>\n\n<p>The server accepts telnet connections on port 4242 as follows:</p>\n\n<p><code>$ telnet localhost 4242</code></p>\n\n<p>It then prompts the user for their name. When entered, the user should receive the message:</p>\n\n<p><b>Welcome, [username]!</b></p>\n\n<p>But instead receives the message</p>\n\n<p><b>!elcome, [username]</b></p>\n\n<p>Note that the exclamation point seems to be moved from the end of the string and replaces the 'W'. It doesn't make a difference how long the username is, the result is the same.</p>\n\n<p>Additionally, the terminal on which the server is running should then display the name of the the user as follows:</p>\n\n<p><b>[username] has joined the server.</b></p>\n\n<p>But instead displays:</p>\n\n<p><b> has joined the server.</b></p>\n\n<p>The username appears to be the empty string. However, if we simply substitute the line </p>\n\n<p><code>putStrLn (userName newUser)</code> </p>\n\n<p>for the line </p>\n\n<p><code>putStrLn ((userName newUser) ++ \" has joined the server.\")</code></p>\n\n<p>the user's name is displayed correctly. I'm at a bit of a loss as to why I'm having these issues (the example linked to above compiles fine, and there are no such problems with putStrLn/hPutStrLn. I'm convinced it's something painfully subtle.</p>\n\n<p>Here's the aforementioned code:</p>\n\n<pre><code>-- TestServer.hs\nmodule TestServer where\n\nimport Control.Concurrent\nimport Network.Socket\nimport System.IO\n\ntype User = (Handle, String)\n\nuserName :: User -&gt; String\nuserName (_, name) = name\n\nmain :: IO ()\nmain = do\n    sock &lt;- socket AF_INET Stream 0\n    setSocketOption sock ReuseAddr 1\n    bind sock (SockAddrInet 4242 iNADDR_ANY)\n    listen sock 2\n    socketLoop sock []\n\nsocketLoop sock users = do\n    (uSock, _)      &lt;- accept sock\n    uHandle         &lt;- socketToHandle uSock ReadWriteMode\n    hSetBuffering uHandle NoBuffering\n    newUser         &lt;- initUser uHandle\n\n    putStrLn ((userName newUser) ++ \" has joined the server.\")\n\n    socketLoop sock (newUser:users)\n\ninitUser :: Handle -&gt; IO User\ninitUser handle = do\n    hPutStr handle \"Please enter your name: \"\n    name &lt;- hGetLine handle\n    let user = (handle, name) in do\n        hPutStrLn handle (\"Welcome, \" ++ name ++ \"!\")\n        return user\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1462903220, "post_id": 37143398, "comment_id": 61829538, "body": "Use <code>Control.Monad.Trans.Except</code>. :)"}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 4, "last_activity_date": 1462896416, "creation_date": 1462896416, "answer_id": 37143745, "question_id": 37143398, "link": "https://stackoverflow.com/questions/37143398/use-control-monad-trans-except-instead-how-to-turn-off-this-warning-in-ghc/37143745#37143745", "title": "Use Control.Monad.Trans.Except instead - how to turn off this warning in ghc?", "body": "<p>You can do with </p>\n\n<pre><code>{-# OPTIONS_GHC -fno-warn-warnings-deprecations -#}\n{-# OPTIONS_GHC -fno-warn-deprecated-flags -#}\n</code></pre>\n\n<p>But I would <strong>not</strong> recommend that - better change your import to importing the mentioned package.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 37143745, "answer_count": 1, "score": 1, "last_activity_date": 1462896416, "creation_date": 1462895416, "question_id": 37143398, "link": "https://stackoverflow.com/questions/37143398/use-control-monad-trans-except-instead-how-to-turn-off-this-warning-in-ghc", "title": "Use Control.Monad.Trans.Except instead - how to turn off this warning in ghc?", "body": "<p>Is it possible to turn off warning in ghc compiler ?</p>\n\n<pre><code>Deprecated: \"Use Control.Monad.Trans.Except instead\"\n</code></pre>\n"}, {"tags": ["function", "haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462895160, "post_id": 37143072, "comment_id": 61824857, "body": "have a look at <code>maximumBy</code> using <code>compare `on` something</code> (where <code>on</code> is from <code>Data.Function</code>)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462895210, "post_id": 37143072, "comment_id": 61824897, "body": "you probably want to combine this with a getter like <code>size (Hill _ sz _ _) = sz</code> - if you convert this into record syntax you&#39;ll get those for free"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462903248, "post_id": 37144252, "comment_id": 61829557, "body": "This solution is very nice! I do understand your code(thanks for the explanation!), but i dont understand this <code>&lt;$&gt;</code> operation."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "reply_to_user": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 1, "creation_date": 1462903741, "post_id": 37144252, "comment_id": 61829866, "body": "<code>&lt;$&gt;</code> is syntactic sugar - basically a shorthand infix version of <code>map</code>, which, unsurprisingly, maps a function to the items to a list."}, {"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "edited": false, "score": 0, "creation_date": 1462904462, "post_id": 37144252, "comment_id": 61830318, "body": "Thats suprised me alot! Thanks for the new notation :)"}], "tags": [], "owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "is_accepted": true, "score": 1, "last_activity_date": 1462904096, "last_edit_date": 1462904096, "creation_date": 1462898028, "answer_id": 37144252, "question_id": 37143072, "link": "https://stackoverflow.com/questions/37143072/haskell-data-type-function-and-how-to-extract-information/37144252#37144252", "title": "Haskell, data type function and how to extract information?", "body": "<p>You can implement <code>mSize</code> easily using pattern matching and a helper function:</p>\n\n<pre><code>maxSize' :: Hill -&gt; (Size, Name)\nmaxSize' (Hill n s _ _) = (s, n)\n\nmaxSize :: MountainChain -&gt; Size\nmaxSize (MountainChain _ mc) = fst $ maximum $ maxSize' &lt;$&gt; mc\n\nmajorHill :: MountainChain -&gt; Name\nmajorHill (MountainChain _ mc) = snd $ maximum $ maxSize' &lt;$&gt; mc\n</code></pre>\n\n<p>What's happening here is that <code>maxSize</code> does a pattern match against the <code>Hill</code> type and extracts the name and size. It then takes the value of a tuple with the size as its first element (there's a reason for that, and I'll get to it in a bit).</p>\n\n<p><code>maxSize</code> just maps <code>maxSize'</code> over a <code>MountainChain</code>, which (thanks to pattern matching) is treated just like a list of <code>Hill</code>s. We then apply <code>maximum</code> over the returned list of <code>[(Float, String)]</code>. <code>maximum</code> is fortunately smart enough that it'll perform a stable sort on a list of tuples using the first element in each tuple. Finally, we extract the first element from the single tuple returned by <code>maximum</code> using <code>fst</code>.</p>\n\n<p><code>majorHill</code> once again makes use of this mechanic, but extracts the name (using <code>snd</code>) instead of the height.</p>\n"}], "owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 37144252, "answer_count": 1, "score": 0, "last_activity_date": 1462904096, "creation_date": 1462894491, "question_id": 37143072, "link": "https://stackoverflow.com/questions/37143072/haskell-data-type-function-and-how-to-extract-information", "title": "Haskell, data type function and how to extract information?", "body": "<p>i created two data types which let me create a \"Hill\" and a \"MountainChain\":</p>\n\n<pre><code>data Hill = Hill Name Size Isolation Prominence\n  deriving(Eq,Show)\ntype Name      = String\ntype Size     = Float\ntype Isolation  = Float\ntype Prominence = Float\n\ndata MountainChain = MountainChain Name [Hill]\n  deriving(Eq,Show)\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>fstHill = Hill \"fstHill\" 45.0 18.0 4.0\n\nscdHill = Hill \"scdHill\" 222.0 60.0 15.0\n\noutput: \n\n*Main&gt; fstHill\nHill \"fstHill\" 45.0 18.0 4.0\n*Main&gt; scdHill\nHill \"scdHill\" 222.0 60.0 15.0\n</code></pre>\n\n<p>My question now is how to write a function that will return the <code>maxSize</code> of an <code>Hill</code> within the <code>MountainChain</code> and a function that returns the <code>name</code> of the highest <code>Hill</code> (within the MC) with the following types:</p>\n\n<pre><code>mSize :: MountainChain -&gt; Size\nmajorHill :: MountainChain -&gt; Name\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "edited": false, "score": 1, "creation_date": 1462893814, "post_id": 37136485, "comment_id": 61823911, "body": "The doubt comes from &quot;then&quot; I was thinking it was an implication or something similar. Thank&#39;s for your answer."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "edited": false, "score": 1, "creation_date": 1462898152, "post_id": 37136485, "comment_id": 61826708, "body": "@granmirupa The &quot;then&quot; is meant in the sense of &quot;do x, then do y&quot;."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 16, "last_activity_date": 1540752248, "last_edit_date": 1540752248, "creation_date": 1462877757, "answer_id": 37136485, "question_id": 37136294, "link": "https://stackoverflow.com/questions/37136294/what-operator-does/37136485#37136485", "title": "What &gt;&gt; operator does?", "body": "<p><code>&gt;&gt;</code> is a shortcut for when you don't care about the value. That is, <code>a &gt;&gt; b</code> is equivalent to <code>a &gt;&gt;= \\_ -&gt; b</code> (assuming a sane (or default) definition of <code>&gt;&gt;</code> in the given monad).</p>\n\n<p>So when you're, say, in the IO monad and want to execute some <code>print</code>s, you can use <code>&gt;&gt;</code> because there's no reason to do anything with the <code>()</code> that <code>print</code> produces: <code>print a &gt;&gt; print b</code>.</p>\n\n<p>In terms of do-notation <code>exp &gt;&gt;= \\var -&gt; rest</code> corresponds to</p>\n\n<pre><code>do\n  var &lt;- exp\n  rest\n</code></pre>\n\n<p>and <code>exp &gt;&gt; rest</code> corresponds to just</p>\n\n<pre><code>do\n  exp\n  rest\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 6, "last_activity_date": 1462878016, "creation_date": 1462878016, "answer_id": 37136588, "question_id": 37136294, "link": "https://stackoverflow.com/questions/37136294/what-operator-does/37136588#37136588", "title": "What &gt;&gt; operator does?", "body": "<p><code>&gt;&gt;</code> performs the monadic action on the left hand side but discards its result and then performs the right hand side.</p>\n\n<p>when you are using do - notation this is what happens when you write something like</p>\n\n<pre><code>... = do _ &lt;- action1\n         action2\n</code></pre>\n\n<p>or shorter (but the compiler will issue a warning of unbound <code>action1</code>)</p>\n\n<pre><code>... = do action1\n         action2\n</code></pre>\n\n<p>now where is that useful - consider the situation of a monadic parser where you</p>\n\n<pre><code>... = do string \"IP:\"\n         d1 &lt;- decimal\n         char '.'\n         d2 &lt;- decimal\n         char '.'\n         d3 &lt;- decimal\n         char '.'\n         d4 &lt;- decimal\n         char '.'\n         return $ IP d1 d2 d3 d4\n</code></pre>\n\n<p>here you are interested in the actual numbers but not in the dots in between or the string \"IP:\" at the beginning.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 6388268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa440320f370f0a624ffa3c4f2f5f44?s=128&d=identicon&r=PG&f=1", "display_name": "f.saint", "link": "https://stackoverflow.com/users/6388268/f-saint"}, "is_accepted": false, "score": 1, "last_activity_date": 1493046193, "last_edit_date": 1493046193, "creation_date": 1493045799, "answer_id": 43591458, "question_id": 37136294, "link": "https://stackoverflow.com/questions/37136294/what-operator-does/43591458#43591458", "title": "What &gt;&gt; operator does?", "body": "<p>The <code>&gt;&gt;</code> operator works as the <code>&gt;&gt;=</code> operator and is used when the function does not need the value produced by the first monadic operator.</p>\n\n<p>To better understand it a comparation with <code>do</code> notation is useful:</p>\n\n<blockquote>\n  <p>The (>>) (then) operator works almost identically in do notation and\n  in unsugared code. \n  <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\"> [here]</a></p>\n</blockquote>\n\n<p>You can look better at this example:</p>\n\n<pre><code>putStr \"Hello\" &gt;&gt; \nputStr \" \" &gt;&gt; \nputStr \"world!\" &gt;&gt; \nputStr \"\\n\"\n</code></pre>\n\n<p>that is equivalent to:</p>\n\n<pre><code>do putStr \"Hello\"\n   putStr \" \"\n   putStr \"world!\"\n   putStr \"\\n\"\n</code></pre>\n"}], "owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 2, "accepted_answer_id": 37136485, "answer_count": 3, "score": 3, "last_activity_date": 1540752248, "creation_date": 1462877278, "last_edit_date": 1495535480, "question_id": 37136294, "link": "https://stackoverflow.com/questions/37136294/what-operator-does", "title": "What &gt;&gt; operator does?", "body": "<p>I'm learning about monad in Haskell.</p>\n\n<p>I read <a href=\"https://stackoverflow.com/questions/44965/what-is-a-monad\">here</a> an excelent explaination about Monads, and I think to have understand (not all, but ehy I just started) about <code>&gt;&gt;=</code> bind operator and Monad.</p>\n\n<p>On my teacher's slides I found this:</p>\n\n<pre><code>class  Monad m  where\n    (&gt;&gt;=)            :: m a -&gt; (a -&gt; m b) -&gt; m b   -- \"bind\"\n    (&gt;&gt;)             :: m a -&gt; m b -&gt; m b          -- \"then\"\n    return           :: a -&gt; m a  \n</code></pre>\n\n<p>What is <code>&gt;&gt;</code> and in what it differs from <code>&gt;&gt;=</code>?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 6, "creation_date": 1462875668, "post_id": 37135435, "comment_id": 61810174, "body": "it would be best to switch to using <a href=\"http://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\"><code>stack</code></a> or <a href=\"http://coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html\" rel=\"nofollow noreferrer\"><code>cabal sandboxes</code></a> - maybe you need to delete the current .cabal folder"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1462891370, "post_id": 37135435, "comment_id": 61822076, "body": "<code>scalpel</code> is on stackage <a href=\"https://www.stackage.org/nightly-2016-05-08/package/scalpel-0.3.0.1\" rel=\"nofollow noreferrer\">stackage.org/nightly-2016-05-08/package/scalpel-0.3.0.1</a> ; if you learn how to install with <code>stack</code> you won&#39;t have to deal with this sort of problem."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1463204572, "post_id": 37135435, "comment_id": 61976283, "body": "It looks like you&#39;re using a haskell platform from 2013? That ships with ghc 7.6.2 -- lots of packages consider that at the tail end of their support window. It would be much better to use a more up to date ghc regardless. Having done so, if you stick with cabal, you may want to consider using sandboxes to prevent issues like this in the future..."}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 2596349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f216090d551a7da10d849915bc3f6b2?s=128&d=identicon&r=PG", "display_name": "ForestPhoenix", "link": "https://stackoverflow.com/users/2596349/forestphoenix"}, "is_accepted": false, "score": 1, "last_activity_date": 1462893292, "creation_date": 1462893292, "answer_id": 37142555, "question_id": 37135435, "link": "https://stackoverflow.com/questions/37135435/i-have-trouble-installing-a-library-with-cabal/37142555#37142555", "title": "I have trouble installing a library with cabal", "body": "<p>Cabal can become <em>very</em> <a href=\"https://wiki.haskell.org/Cabal/Survival\" rel=\"nofollow\">problematic</a> with dependencies blocking each other.</p>\n\n<p>If you can, use <a href=\"http://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow\"><code>stack</code></a> or <a href=\"http://coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html\" rel=\"nofollow\"><code>cabal sandbox</code></a>.\nThis isolates creates isolated environments that can prevent the 'dependency hell'.</p>\n\n<p><code>stack</code> automaticall creates a new sandbox for each project, while <code>cabal sandbox</code> has to be triggered manually.</p>\n\n<p>You can try to delete <code>.cabal</code> and maybe <code>.ghc</code> from your home directory to fix the current situation, but that fix will be temporary if you do not use sandboxing (which is exactly what <code>stack</code> or <code>cabal sandbox</code> do)</p>\n"}], "owner": {"reputation": 320, "user_id": 1168820, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fe9159acc0883bc7a80d30806f8268f1?s=128&d=identicon&r=PG", "display_name": "Vlad K.", "link": "https://stackoverflow.com/users/1168820/vlad-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462893292, "creation_date": 1462875049, "question_id": 37135435, "link": "https://stackoverflow.com/questions/37135435/i-have-trouble-installing-a-library-with-cabal", "title": "I have trouble installing a library with cabal", "body": "<p>What I want to install is <a href=\"https://hackage.haskell.org/package/scalpel\" rel=\"nofollow\"><code>scalpel</code></a> library.  </p>\n\n<p>When I try:</p>\n\n<pre><code>cabal install -p scalpel\n</code></pre>\n\n<p>I have following output:</p>\n\n<pre><code>Microsoft Windows [Version 6.3.9600]\n(c) 2013 Microsoft Corporation. All rights reserved.\n\nC:\\Users\\maion_000&gt;cabal install -p scalpel\nResolving dependencies...\nIn order, the following would be installed:\ncurl-1.3.8 +new-base (new package)\nregex-base-0.93.2 (reinstall) changes: bytestring-0.10.0.2 -&gt; 0.10.6.0,\nmtl-2.1.2 -&gt; 2.2.1\nregex-tdfa-1.2.2 (new package)\ntagsoup-0.13.10 (new package)\nscalpel-0.3.0.1 (new package)\ncabal: The following packages are likely to be broken by the reinstalls:\nregex-posix-0.95.2\nregex-compat-0.95.1\nhaskell-platform-2013.2.0.0\nUse --force-reinstalls if you want to install anyway.\n</code></pre>\n\n<p>What should I do? I tried --force-reinstalls and it gives more errors.</p>\n"}, {"tags": ["haskell", "yesod", "cloud9-ide", "haskell-stack"], "comments": [{"owner": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "edited": false, "score": 0, "creation_date": 1463044809, "post_id": 37133463, "comment_id": 61898264, "body": "A script for setting up a database - <a href=\"https://github.com/yesodweb/yesod-scaffold/blob/master/setup.sh\" rel=\"nofollow noreferrer\">github.com/yesodweb/yesod-scaffold/blob/master/setup.sh</a>"}], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 4969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd866c0a1345507dc8227b3f3d1d0d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Khaezzar", "link": "https://stackoverflow.com/users/4969544/khaezzar"}, "edited": false, "score": 2, "creation_date": 1463061754, "post_id": 37134674, "comment_id": 61911105, "body": "If I don&#39;t make mistake, you don&#39;t have to install haskell-platform as stack take care of that."}, {"owner": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "edited": false, "score": 0, "creation_date": 1463170910, "post_id": 37134674, "comment_id": 61968475, "body": "To clarify, <code>sudo apt-get update &amp;&amp; sudo apt-get install stack -y</code> would install haskell? So someone could skip directly to <i>Installing Stack</i>?"}, {"owner": {"reputation": 36, "user_id": 4969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd866c0a1345507dc8227b3f3d1d0d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Khaezzar", "link": "https://stackoverflow.com/users/4969544/khaezzar"}, "reply_to_user": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "edited": false, "score": 1, "creation_date": 1463225746, "post_id": 37134674, "comment_id": 61982224, "body": "yes, you can read about it at <a href=\"http://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">stack</a> page."}, {"owner": {"reputation": 36, "user_id": 4969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd866c0a1345507dc8227b3f3d1d0d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Khaezzar", "link": "https://stackoverflow.com/users/4969544/khaezzar"}, "reply_to_user": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "edited": false, "score": 1, "creation_date": 1463584110, "post_id": 37134674, "comment_id": 62128983, "body": "In fact &quot;stack&quot; is a binary that will install haskell."}], "tags": [], "owner": {"reputation": 36, "user_id": 4969544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd866c0a1345507dc8227b3f3d1d0d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Khaezzar", "link": "https://stackoverflow.com/users/4969544/khaezzar"}, "is_accepted": true, "score": 2, "last_activity_date": 1462912136, "last_edit_date": 1462912136, "creation_date": 1462873215, "answer_id": 37134674, "question_id": 37133463, "link": "https://stackoverflow.com/questions/37133463/running-yesod-in-cloud9/37134674#37134674", "title": "Running Yesod in Cloud9", "body": "<p>Did you configure Postgres to accept TCP connections as indicated by the error message? Your installation of Yesod seems ok, but Yesod reads the DB to make a migration at start time so it needs a connection to your DB.</p>\n"}], "owner": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 2, "accepted_answer_id": 37134674, "answer_count": 1, "score": 2, "last_activity_date": 1478643077, "creation_date": 1462870103, "last_edit_date": 1478643077, "question_id": 37133463, "link": "https://stackoverflow.com/questions/37133463/running-yesod-in-cloud9", "title": "Running Yesod in Cloud9", "body": "<p>These are the steps I used to run a Yesod scaffold in Cloud9. The whole process took a few hours and I had to upgrade memory and disk (do this before proceeding):</p>\n\n<h2>Installing Stack</h2>\n\n<ol>\n<li><code>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 575159689BEFB442</code></li>\n<li>(Ubuntu 14.04 (amd64)):<br>\n<code>echo 'deb http://download.fpcomplete.com/ubuntu trusty main'|sudo tee /etc/apt/sources.list.d/fpco.list</code></li>\n<li><code>sudo apt-get update &amp;&amp; sudo apt-get install stack -y</code></li>\n</ol>\n\n<p><em>Status: running <code>$ stack</code> from the command line works as expected</em></p>\n\n<h2>Yesod Template Quickstart</h2>\n\n<ol>\n<li>Create a new scaffolded site: \n<code>stack new yesodOnC9 yesod-postgres &amp;&amp; cd yesodOnC9</code></li>\n<li>Install the yesod command line tool: \n<code>stack build yesod-bin cabal-install --install-ghc</code></li>\n<li>Build libraries:\n<code>stack build</code></li>\n</ol>\n\n<h2>Create PostgreSQL Database in C9</h2>\n\n<ol>\n<li>Start the PostgreSQL service\n <code>$ sudo service postgresql start</code></li>\n<li>Connect to the service\n <code>$ sudo sudo -u postgres psql</code></li>\n<li>Create a PostgreSQL database (from inside psql, at last step)\n <code>postgres=# CREATE DATABASE \"yesodDB\";</code></li>\n<li>Create a test PostgreSQL database\n <code>postgres=# CREATE DATABASE \"yesodDB_test\"</code></li>\n<li>Set Password for Postgres User\n <code>postgres-# \\password postgres</code>\n <code>Enter new password: MYPASSWORD</code></li>\n</ol>\n\n<p><em>Result:</em><br/>\n  <em>user: postgres</em><br/>\n  <em>password: MYPASSWORD</em></p>\n\n<h2>Configure Yesod to Database</h2>\n\n<ol>\n<li>Open config/settings.yml</li>\n<li>Change database user to:\n  <code>user:     \"_env:PGUSER:postgres\"</code></li>\n<li>Change database password to:\n  <code>password: \"_env:PGPASS:MYPASSWORD\"</code></li>\n<li>Change database database to:\n  <code>database: \"_env:PGDATABASE:yesodDB\"</code></li>\n<li>Close settings.yml and open test-settings.yml</li>\n<li>Change database database to:\n <code>database: yesodDB_test</code></li>\n</ol>\n\n<h2>Launch devel server:</h2>\n\n<ol>\n<li><code>stack exec -- yesod devel -b $IP -p $PORT</code></li>\n</ol>\n\n<p><em>Result: Successful, Running Scaffold</em></p>\n\n<blockquote>\n  <p>If you leave your workspace, you will have to restart the PostgreSQL service with: <code>$ sudo service postgresql start</code> when you return.</p>\n</blockquote>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1462869869, "post_id": 37133345, "comment_id": 61806113, "body": "what have you already tried? and what is with the list <code>[(1,2),(2,1)]</code>?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462869981, "post_id": 37133345, "comment_id": 61806193, "body": "by the way haskell is usually using camelCase, therefore the naming <code>is_in_order</code> is usually <code>isInOrder</code>, I recommend using HLint to check for common stuff like that - it helped me improve my haskell skills a lot!"}, {"owner": {"reputation": 5, "user_id": 6031932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1296861183674396/picture?type=large", "display_name": "Bremer Sharp", "link": "https://stackoverflow.com/users/6031932/bremer-sharp"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462870467, "post_id": 37133345, "comment_id": 61806497, "body": "Thanks @epsilonhalbe I&#39;ll fix that to <code>isInOrder</code>. So I&#39;ve just tried  <code>isInOrder :: (Ord a) =&gt; [a] -&gt; Bool  isInOrder [] = True  isInOrder [x] = True  isInOrder (x:y:xs) = x &lt;= y &amp;&amp; isInOrder (y:xs)</code> And that just puts a list into order. I can&#39;t seem to get it to work with tuples and I need it in a case format"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1462880172, "post_id": 37133345, "comment_id": 61813399, "body": "<code>unzip [(1,2), (1,3)] == ([1,1], [2,3])</code> might help."}, {"owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "edited": false, "score": 0, "creation_date": 1462884797, "post_id": 37133345, "comment_id": 61817009, "body": "Are you only checking the <code>y</code> values of these tuples? Or does the <code>x</code> play some role as well?"}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1462876397, "creation_date": 1462876397, "answer_id": 37135961, "question_id": 37133345, "link": "https://stackoverflow.com/questions/37133345/check-if-tuple-list-is-in-increasing-consecutive-order-in-haskell/37135961#37135961", "title": "Check if tuple list is in increasing consecutive order in Haskell", "body": "<p>As this seems to be an exercise example I will only provide some hints and not a full solution:</p>\n\n<p>for just checking if all second tuples are consecutive a simple</p>\n\n<pre><code>checkConsecutive :: Num a =&gt; [a] -&gt; Bool\ncheckConsecutive x = and $ zipWith (\\x y -&gt; y - x == 1) x (drop 1 x)\n</code></pre>\n\n<p>but I guess the case at hand should be more general - your <code>inOrder</code> function already provides a good base line</p>\n\n<pre><code>isConsecutive :: Num a =&gt; [a] -&gt; Bool\nisConsecutive [] = True\nisConsecutive [x] = True\nisConsecutive (x:y:xs) = consecutive x y &amp;&amp; isConsecutive (y:xs)\n  where consecutive :: (Num a, Num b) =&gt; (a,b) -&gt; (a,b) -&gt; Bool\n        consecutive (x1,y1) (x2,y2) = ..\n</code></pre>\n\n<p>You write that you need <code>case</code> in order to do that, you can use a case expression in consecutive, but I don't think it would make the function clearer.</p>\n\n<p><strong>Note:</strong> you can simplify the function above to</p>\n\n<pre><code>isConsecutive (x:y:xs) = consecutive x y &amp;&amp; isConsecutive (y:xs)\n  where consecutive :: (Num a, Num b) =&gt; (a,b) -&gt; (a,b) -&gt; Bool\n        consecutive (x1,y1) (x2,y2) = ..\nisConsecutive _ = True\n</code></pre>\n\n<p>the <code>_</code> indicates a \"catchall\" pattern - i.e. it matches anything that is not matching the above patterns.</p>\n\n<p>So the remaining task is to declare what it means for two tuples to be <code>consecutive</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8419, "user_id": 2702781, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e6776aa6608f9af0115c241d84a05a6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nyavro", "link": "https://stackoverflow.com/users/2702781/nyavro"}, "is_accepted": false, "score": 0, "last_activity_date": 1462876611, "creation_date": 1462876611, "answer_id": 37136033, "question_id": 37133345, "link": "https://stackoverflow.com/questions/37133345/check-if-tuple-list-is-in-increasing-consecutive-order-in-haskell/37136033#37136033", "title": "Check if tuple list is in increasing consecutive order in Haskell", "body": "<p>You can implement isInOrder this way:</p>\n\n<pre><code>isInOrder xs = all check $ zip xs $ tail xs where\n    check ((x1,y1),(x2,y2)) = x1&lt;=x2 &amp;&amp; y2-y1==1  \n</code></pre>\n\n<p>You can modify check function the way you mean 'increasing consecutive order'</p>\n"}], "owner": {"reputation": 5, "user_id": 6031932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1296861183674396/picture?type=large", "display_name": "Bremer Sharp", "link": "https://stackoverflow.com/users/6031932/bremer-sharp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 37135961, "answer_count": 2, "score": -5, "last_activity_date": 1462876611, "creation_date": 1462869766, "last_edit_date": 1462870428, "question_id": 37133345, "link": "https://stackoverflow.com/questions/37133345/check-if-tuple-list-is-in-increasing-consecutive-order-in-haskell", "title": "Check if tuple list is in increasing consecutive order in Haskell", "body": "<p>So I have a problem where I need to see if a list of positions which are in the form of (x,y) are in increasing consecutive order. </p>\n\n<p>Just a for an example of whats meant to happen </p>\n\n<pre><code>[(1,2), (1,3), (1,4), (1,5), (1,6)] it would return True, but\n[(1,2), (1,3), (1,5), (1,6), (1,7)] will return False\n</code></pre>\n\n<p>For example starting off like this.</p>\n\n<pre><code>is_in_order :: [Position] -&gt; Bool\n</code></pre>\n\n<p>Thanks for the help. </p>\n"}, {"tags": ["mongodb", "haskell", "persistent", "servant"], "comments": [{"owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "edited": false, "score": 0, "creation_date": 1462882585, "post_id": 37132615, "comment_id": 61815225, "body": "I released function convertDocToUser :: Document -&gt; User convertDocToUser doc =     User { userFam   = typed . valueAt &quot;userFam&quot;   $ doc          , userIm    = typed . valueAt &quot;userIm&quot;    $ doc           , userOt    = typed . valueAt &quot;userOt&quot;    $ doc          , userEmail = typed . valueAt &quot;userEmail&quot; $ doc          , userLogin = typed . valueAt &quot;userLogin&quot; $ doc          , userPswd  = typed . valueAt &quot;userPswd&quot;  $ doc          }"}, {"owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "edited": false, "score": 0, "creation_date": 1462882670, "post_id": 37132615, "comment_id": 61815294, "body": "resultDB &lt;- runDb $ do rest =&lt;&lt; find (select [] &quot;user&quot;) users &lt;- do return $ map convertDocToUser resultDB return users"}, {"owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "edited": false, "score": 0, "creation_date": 1462882711, "post_id": 37132615, "comment_id": 61815334, "body": "But maybe there is a more correct way?"}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1463636507, "post_id": 37132615, "comment_id": 62149737, "body": "I think it might be difficult to answer this question without knowing the types or code for <code>rest</code> and <code>find</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7751, "user_id": 83938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/81b900db36308bed1289e374c32cb4a2?s=128&d=identicon&r=PG&f=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/83938/nik"}, "is_accepted": false, "score": 0, "last_activity_date": 1585749925, "creation_date": 1585749925, "answer_id": 60972746, "question_id": 37132615, "link": "https://stackoverflow.com/questions/37132615/peristent-with-mongodb-in-servant/60972746#60972746", "title": "Peristent with MongoDB in Servant", "body": "<p>Use <code>bson-generic</code> package to generate <code>fromBSON</code> and <code>toBSON</code> functions\nThen map documents you get from the database to <code>[User]</code></p>\n\n<p><a href=\"http://hackage.haskell.org/package/bson-generic-0.0.8.1/docs/Data-Bson-Generic.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/bson-generic-0.0.8.1/docs/Data-Bson-Generic.html</a></p>\n"}], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1585749925, "creation_date": 1462867530, "last_edit_date": 1462872365, "question_id": 37132615, "link": "https://stackoverflow.com/questions/37132615/peristent-with-mongodb-in-servant", "title": "Peristent with MongoDB in Servant", "body": "<p>I try to use <code>persistent</code> with MongoDB in Servant webservices APIs.\nBelow is my model code (<code>Model.hs</code>)</p>\n\n<pre><code>let mongoSettings = (mkPersistSettings (ConT ''MongoContext))\n    in share [mkPersist mongoSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nUser\n    fam   String\n    im    String \n    ot    String \n    email String \n    login String\n    pswd  String\n    deriving Show\n|]\n\n$(deriveJSON defaultOptions ''User)\n</code></pre>\n\n<p>And the code to access the database:</p>\n\n<pre><code>usersGet :: AppM [User]\nusersGet = do \n    resultDB &lt;- runDb $ do rest =&lt;&lt; find (select [] \"user\")\n    return resultDB\n</code></pre>\n\n<p>Which gives me an error:</p>\n\n<pre><code>Error: Expected type: [User] Actual type: [Document].\n</code></pre>\n\n<p>I understand the error, but I thought that the library should automatically generate the necessary functions for the conversion from <code>Document -&gt; User</code>.</p>\n\n<p>What is function that generates for that?</p>\n"}, {"tags": ["arrays", "string", "haskell"], "comments": [{"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 2, "creation_date": 1462866386, "post_id": 37132152, "comment_id": 61803926, "body": "A string in Haskell is a list of characters (sounds familiar?) Consider <code>Data.Char.isDigit</code>. And perhaps a <code>filter</code>."}, {"owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "edited": false, "score": 1, "creation_date": 1462867102, "post_id": 37132152, "comment_id": 61804378, "body": "Hint: all values in Haskell are immutable, so you won&#39;t be able to actually change the string. You&#39;ll have to construct a new one."}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 2, "creation_date": 1462867193, "post_id": 37132152, "comment_id": 61804441, "body": "This question is too broad however. Pick up a Haskell book. <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">Learn You a Haskell for Great Good</a> is popular, and can be read online for free. After the first few chapters you should be able to answer this for yourself."}, {"owner": {"reputation": 320, "user_id": 1168820, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fe9159acc0883bc7a80d30806f8268f1?s=128&d=identicon&r=PG", "display_name": "Vlad K.", "link": "https://stackoverflow.com/users/1168820/vlad-k"}, "reply_to_user": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 0, "creation_date": 1462867343, "post_id": 37132152, "comment_id": 61804556, "body": "@S.L.Barth I&#39;m currently reading first chapters of this book. :)"}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1462870383, "creation_date": 1462870383, "answer_id": 37133555, "question_id": 37132152, "link": "https://stackoverflow.com/questions/37132152/string-manipulation-in-haskell/37133555#37133555", "title": "String manipulation in haskell", "body": "<p>If you already know the exact position of the number in the <code>String</code> I would recommend using a function</p>\n\n<pre><code>stoverString :: Int -&gt; String\nstoverSTring n = \"http://stackoverflow.com/users?page=\"++ show n\n               ++\"&amp;tab=reputation&amp;filter=all\"\n</code></pre>\n\n<p>and then use <code>map</code> in combination with [Int] to create all the <code>String</code>s you desire.</p>\n\n<p>Assuming you want to do some downloading - the next function you should look into is <code>mapM</code> a relative of the simple <code>map</code> function that does IO-actions with your list, instead of simple function application for each element of the list.</p>\n"}], "owner": {"reputation": 320, "user_id": 1168820, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fe9159acc0883bc7a80d30806f8268f1?s=128&d=identicon&r=PG", "display_name": "Vlad K.", "link": "https://stackoverflow.com/users/1168820/vlad-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 37133555, "answer_count": 1, "score": 0, "last_activity_date": 1462870383, "creation_date": 1462866035, "last_edit_date": 1495540792, "question_id": 37132152, "link": "https://stackoverflow.com/questions/37132152/string-manipulation-in-haskell", "title": "String manipulation in haskell", "body": "<p>I've been coding in Java and Python last 3,4 years. Now I decided I want to learn Haskell.</p>\n\n<p>I have a string in the form:</p>\n\n<blockquote>\n  <p>\"<a href=\"https://stackoverflow.com/users?page=1&amp;tab=reputation&amp;filter=all\">https://stackoverflow.com/users?page=1&amp;tab=reputation&amp;filter=all</a>\"</p>\n</blockquote>\n\n<p>I need a function that would increment page number:</p>\n\n<blockquote>\n  <p>\"<a href=\"https://stackoverflow.com/users?page=2&amp;tab=reputation&amp;filter=all\">https://stackoverflow.com/users?page=2&amp;tab=reputation&amp;filter=all</a>\"</p>\n</blockquote>\n\n<p>and this string to:</p>\n\n<blockquote>\n  <p>\"<a href=\"https://stackoverflow.com/users?page=3&amp;tab=reputation&amp;filter=all\">https://stackoverflow.com/users?page=3&amp;tab=reputation&amp;filter=all</a>\"</p>\n</blockquote>\n\n<p>and so on...</p>\n\n<p>I'm very new to Haskell and don't know how to manipulate strings. How to write such a function?</p>\n"}, {"tags": ["haskell", "web", "utf-8"], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1462859739, "post_id": 37130049, "comment_id": 61800451, "body": "Thanks. I forgot <code>hSetEncoding</code>, this was the important thing."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1462858669, "last_edit_date": 1495535288, "creation_date": 1462858669, "answer_id": 37130049, "question_id": 37129768, "link": "https://stackoverflow.com/questions/37129768/haskell-and-the-web-utf-8/37130049#37130049", "title": "Haskell and the web (UTF-8)", "body": "<p>Some questions:</p>\n\n<ol>\n<li><p>What <code>Content-type</code> header is your CGI script sending?</p></li>\n<li><p>Are you setting the encoding on the <code>stdout</code> handle?</p></li>\n</ol>\n\n<p>You should always send a <code>Content-type</code> header, and in that header you can stipulate the character encoding. See <a href=\"http://www.w3.org/International/articles/http-charset/index\" rel=\"nofollow noreferrer\">this page</a> for more details.</p>\n\n<p>Also, the encoding for Haskell file handles is determined by your OS's current default. It might be UTF-8, but it also might be something else. See <a href=\"https://stackoverflow.com/a/5288816/866915\">this SO answer</a> for more info.</p>\n\n<p>So to make sure that the characters you send appear correctly on a web page, I would:</p>\n\n<ol>\n<li>Send a <code>Content-type</code> header with charset=utf8</li>\n<li><p>Make sure the encoding for <code>stdout</code> is also set to <code>utf8</code>:</p>\n\n<pre><code>import System.IO\n...\nhSetEncoding stdout utf8\n</code></pre></li>\n</ol>\n\n<p>If the Content-type header and your output encoding agree, things should work out.</p>\n"}, {"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1462859426, "post_id": 37130107, "comment_id": 61800344, "body": "I have already <code>&lt;meta charset=&quot;UTF-8&quot;&gt;</code> in my <code>index.html</code>, what do you mean with &#228;dd this inside the tag&quot;?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1462859981, "post_id": 37130107, "comment_id": 61800552, "body": "Sorry, was supposed to be the <code>&lt;head&gt;</code> tag, but the output cut that.  I&#39;ve fixed the response.  What was the result of viewing the xxd output?"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1462859915, "last_edit_date": 1462859915, "creation_date": 1462858963, "answer_id": 37130107, "question_id": 37129768, "link": "https://stackoverflow.com/questions/37129768/haskell-and-the-web-utf-8/37130107#37130107", "title": "Haskell and the web (UTF-8)", "body": "<p>Assuming that the Haskell program is properly outputting utf-8, you will still need to let the browser know what encoding you are using.  In HTML 4, you can do this as follows</p>\n\n<pre><code>&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/&gt;\n</code></pre>\n\n<p>(add this inside the &lt;head&gt; tag).</p>\n\n<p>In HTML 5 you can use</p>\n\n<pre><code>&lt;meta charset=\"UTF-8\"&gt;\n</code></pre>\n\n<hr>\n\n<p>You can verify that the Haskell program is outputting the correct format using xxd on the command line</p>\n\n<pre><code>./myProgram | xxd\n</code></pre>\n\n<p>This will show you the actual output in bytes, so that you can verify on a character by character basis.</p>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 37130049, "answer_count": 2, "score": 1, "last_activity_date": 1462859915, "creation_date": 1462857233, "question_id": 37129768, "link": "https://stackoverflow.com/questions/37129768/haskell-and-the-web-utf-8", "title": "Haskell and the web (UTF-8)", "body": "<p>I have a Haskell-Script what <code>putStr</code> some stuff ... and this output I want to display on a webpage. I compiled the Haskellscript and let it be executed like a CGI Script, works well.</p>\n\n<p>But when I have special characters in the <code>putStr</code>, it will fail:</p>\n\n<p>Terminal-Output:</p>\n\n<pre><code>&lt;p class=\"text\"&gt;what happrns at \u00e4 ?&lt;/p&gt;\n</code></pre>\n\n<p>Web output:</p>\n\n<pre><code>what happrns at \n</code></pre>\n\n<p>And nothing behind it is displayed ... wha happened?</p>\n"}, {"tags": ["string", "haskell", "bytestring"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1462832970, "post_id": 37126404, "comment_id": 61793605, "body": "Don&#39;t use the lazy variant of <code>ByteString</code> for <code>urlDecode</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1462832980, "post_id": 37126404, "comment_id": 61793611, "body": "What is <code>urlDecode</code> (type!)?"}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1462833840, "post_id": 37126404, "comment_id": 61793856, "body": "where are you getting <code>urlDecode</code> from?"}], "answers": [{"tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": true, "score": 2, "last_activity_date": 1462833804, "creation_date": 1462833804, "answer_id": 37126597, "question_id": 37126404, "link": "https://stackoverflow.com/questions/37126404/bytestrings-and-strings/37126597#37126597", "title": "ByteStrings and Strings", "body": "<p>I wasn't able to find a <code>urlDecode</code> in Hackage which fits your usage so I can't be sure., but it probably expects a strict <code>ByteString</code> rather than a lazy one, in which case the following should work.</p>\n\n<pre><code>import Data.ByteString as BS  (readFile, ByteString, unpack)\nimport Data.ByteString.Char8 as C8 (pack)\nimport Data.ByteString.UTF8        (toString)\nimport Data.Char                   (chr)\n\nrecode :: String -&gt; String\nrecode str = toString $ urlDecode True (C8.pack str)\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 37126597, "answer_count": 1, "score": -1, "last_activity_date": 1462833804, "creation_date": 1462832673, "question_id": 37126404, "link": "https://stackoverflow.com/questions/37126404/bytestrings-and-strings", "title": "ByteStrings and Strings", "body": "<p>How to solve following problem:</p>\n\n<pre><code>import Data.ByteString.Lazy as BS  (readFile, ByteString, unpack, fromStrict)\nimport Data.ByteString.Char8 as C8 (pack)\nimport Data.ByteString.UTF8        (toString)\nimport Data.Char                   (chr)\n\nstringToBS :: String -&gt; BS.ByteString\nstringToBS str = BS.fromStrict $ C8.pack str\n\nrecode :: String -&gt; String\nrecode str = toString $ urlDecode True (stringToBS str)\n</code></pre>\n\n<p><strong>NOTE</strong> I need to have them the types I set already.</p>\n\n<p>Error at compiling:</p>\n\n<pre><code>Couldn't match expected type \u2018Data.ByteString.Internal.ByteString\u2019\n            with actual type \u2018ByteString\u2019\nNB: \u2018Data.ByteString.Internal.ByteString\u2019\n      is defined in \u2018Data.ByteString.Internal\u2019\n    \u2018ByteString\u2019 is defined in \u2018Data.ByteString.Lazy.Internal\u2019\nIn the second argument of \u2018urlDecode\u2019, namely \u2018(stringToBS str)\u2019\nIn the second argument of \u2018($)\u2019, namely\n  \u2018urlDecode True (stringToBS str)\u2019\n</code></pre>\n\n<p>How can I solve this mistake?</p>\n"}, {"tags": ["haskell", "recursion", "tree", "fold", "postfix-notation"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1462828154, "post_id": 37125331, "comment_id": 61791840, "body": "Replace <code>x * y</code> with <code>Node x &quot;*&quot; y</code>, etc. Simpler yet, write <code>foldingFunction (x:y:ys) o | isOp o = Node x o y:ys</code> where <code>isOp</code> determines if the string is one of your operators."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1462828352, "creation_date": 1462828352, "answer_id": 37125551, "question_id": 37125331, "link": "https://stackoverflow.com/questions/37125331/haskell-create-artihmetic-tree-from-prefix-expression/37125551#37125551", "title": "Haskell - create artihmetic tree from prefix expression", "body": "<p>Here's a hint -- in your <code>foldingFunction</code> approach, the first argument is a list of numbers. Use the same approach, but this time the first argument will be a list of <code>Tree</code> values.</p>\n\n<p>When the folding function comes across a number, e.g. \"3\", you'll want to push <code>Leaf 3</code> onto the stack.</p>\n\n<p>When it comes across an operator like <code>*</code>, you'll want to push <code>Node x \"*\" y</code> where <code>x</code> and <code>y</code> are the <code>Tree</code> values of the top two values on the stack.</p>\n"}], "owner": {"reputation": 43, "user_id": 6067680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c6b8c5a7289045a36edb05eb013c608?s=128&d=identicon&r=PG&f=1", "display_name": "Rupert Ehringer", "link": "https://stackoverflow.com/users/6067680/rupert-ehringer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "accepted_answer_id": 37125551, "answer_count": 1, "score": 3, "last_activity_date": 1462828352, "creation_date": 1462827446, "question_id": 37125331, "link": "https://stackoverflow.com/questions/37125331/haskell-create-artihmetic-tree-from-prefix-expression", "title": "Haskell - create artihmetic tree from prefix expression", "body": "<p>I want to create arithmetic binary tree from <strong>prefix notation</strong>.</p>\n\n<p>My tree is defined as:</p>\n\n<pre><code>data Tree a = Leaf Int | Node Tree String Tree deriving (Show)\n</code></pre>\n\n<p>I want to convert it to arithmetic binary tree, like this:\n<a href=\"http://i.stack.imgur.com/XJmPm.gif\" rel=\"nofollow\">arithmetic tree</a></p>\n\n<p>To evaluate prefix expression from string, I wrote this function:</p>\n\n<pre><code>evaluatePrefix:: String -&gt; Int\nevaluatePrefix expression = head (foldl foldingFunction [] (reverse (words  ( expression))) )\nwhere   foldingFunction (x:y:ys) \"*\" = (x * y):ys  \n        foldingFunction (x:y:ys) \"+\" = (x + y):ys  \n        foldingFunction (x:y:ys) \"-\" = (x - y):ys  \n        foldingFunction (x:y:ys) \"/\" = ( x `div` y):ys  \n        foldingFunction xs numberString = read numberString:xs \n</code></pre>\n\n<p>Which is basically an algorithm from <a href=\"https://en.wikipedia.org/wiki/Polish_notation\" rel=\"nofollow\">wikipedia</a></p>\n\n<pre><code>Scan the given prefix expression from right to left\nfor each symbol\n {\n  if operand then\n    push onto stack\n  if operator then\n   {\n    operand1=pop stack\n    operand2=pop stack\n    compute operand1 operator operand2\n    push result onto stack\n   }\n }\nreturn top of stack as result\n</code></pre>\n\n<p>Now I want to convert prefix expression <strong>into the arithmetic tree</strong>, so I can walk the tree and evaluate it that way, or convert it to postfix or infix.</p>\n\n<p><strong>How could I do that?</strong></p>\n\n<p>I thought of not evaluatig stack when folding, but instead creating nodes, but I don't know how to express it in Haskell.</p>\n\n<p><strong>Can anybody give me a hint?</strong></p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 7, "creation_date": 1462824665, "post_id": 37124471, "comment_id": 61790051, "body": "They are not enforced by the language or compiler. The programmer is responsible for making sure the laws hold."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462826859, "post_id": 37124471, "comment_id": 61791119, "body": "Since Haskell is a <i>Turing complete</i> language, you cannot enforce any laws on its functions."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 9, "creation_date": 1462827567, "post_id": 37124471, "comment_id": 61791528, "body": "@WillemVanOnsem That&#39;s really misleading.  A turning complete language can still have a proof system and provide guarantees about operations.  For example, many extensions (often SMT based) on top of Haskell can prove the monad laws - do these new extended language suddenly become non-Turing-complete?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1462843625, "post_id": 37124471, "comment_id": 61796161, "body": "@ThomasM.DuBuisson I guess it is impossible <i>in general</i> to automatically  determine if the monad laws are satisfied in a Turing Complete Language: <a href=\"https://en.wikipedia.org/wiki/Rice%27s_theorem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Rice%27s_theorem</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1462998620, "post_id": 37124471, "comment_id": 61880040, "body": "@ThomasM.DuBuisson: Rices theorem says that every non-trivial language-invariant property of a language <i>L</i> cannot be decided. Now evidently there are prove systems that can prove in <i>some</i> circumstances that an invariant holds. The point is that this cannot be done for a <i>generic</i> instance. Furthermore some extensions can shape the structure in such a way that the sublanguage itself is not Turing complete anymore (for instance a regular language) in which case many properties can be proven."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462998842, "post_id": 37124471, "comment_id": 61880165, "body": "@WillemVanOnsem But that is not the case here, the language remains turing complete in the cases I&#39;ve seen.   Moreover, we are not interested in proving a property in general, we are interested in proving the monad laws hold over a few concrete instances which are usually quite simple.  The theoretical issue of full generality has no hold on the practicality of proving properties in the cases of interest."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1462999044, "post_id": 37124471, "comment_id": 61880263, "body": "@ThomasM.DuBuisson: I would compare it with the <i>halting problem</i> which is well studied. There exists a lot of heuristics that can prove, for most programs whether they will halt for a given input. But you cannot construct a prover that will prove it for any instance. The same holds for monads: you cannot construct a prover that can prove whether monadic laws will hold. But you can get lucky that for a given defintion a heuristic can prove it. That&#39;s the consequence of Rice&#39;s theorem I think."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1462999214, "post_id": 37124471, "comment_id": 61880362, "body": "@WillemVanOnsem Yes, we are both saying much the same thing. Rather verbosely too!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1462999934, "post_id": 37124471, "comment_id": 61880722, "body": "@ThomasM.DuBuisson: But then I don&#39;t see what&#39;s misleading about the comment. If you implement a simple state monad, it is very likely the prove system will prove the laws hold. If you however implement a weird wacko monad, things are less likely to be proven. So in general - which is as far as I know the question - it cannot be proven."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1463004404, "post_id": 37124471, "comment_id": 61882792, "body": "@WillemVanOnsem It is misleading because &quot;Since Haskell is a Turing complete language, you cannot enforce any laws on its functions&quot; suggests to the reader that properties can not be proven about Haskell functions.  Just because a there exist terms and properties you can not prove does not mean all terms are not provable.  In practice it is even more stark, there might exist unverifiable laws but rare is the day you&#39;ll run into one in practice.  Just look at many of the liquid Haskell applications - plenty of things are proven about Haskell code.  Same is true for much of Adam Gundry&#39;s work."}], "answers": [{"tags": [], "owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "is_accepted": false, "score": 12, "last_activity_date": 1462824906, "creation_date": 1462824906, "answer_id": 37124674, "question_id": 37124471, "link": "https://stackoverflow.com/questions/37124471/are-monad-laws-enforced-in-haskell/37124674#37124674", "title": "Are monad laws enforced in Haskell?", "body": "<p>No, the monad laws are not enforced by the language.  But if you don't adhere to them, your code may not necessarily behave as you'd expect in some situations.  And it would certainly be confusing to users of your code.</p>\n"}, {"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 22, "last_activity_date": 1462825225, "last_edit_date": 1462825225, "creation_date": 1462824914, "answer_id": 37124677, "question_id": 37124471, "link": "https://stackoverflow.com/questions/37124471/are-monad-laws-enforced-in-haskell/37124677#37124677", "title": "Are monad laws enforced in Haskell?", "body": "<p><strong>You</strong> are responsible for enforcing that a <code>Monad</code> instance obeys the monad laws. Here's a simple example that <strong>doesn't</strong>.</p>\n\n<p>Even though its type is compatible with the <code>Monad</code> methods, counting the number of times the bind operator has been used isn't a Monad because it violates the law <code>m &gt;&gt;= return = m</code></p>\n\n<pre><code>{-# Language DeriveFunctor #-}\n\nimport Control.Monad\n\ndata Count a = Count Int a\n    deriving (Functor, Show)\n\ninstance Applicative Count where\n    pure = return\n    (&lt;*&gt;) = ap\n\ninstance Monad Count where\n    return = Count 0\n    (Count c0 a) &gt;&gt;= k = \n        case k a of\n            Count c1 b -&gt; Count (c0 + c1 + 1) b\n</code></pre>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1408, "favorite_count": 2, "accepted_answer_id": 37124677, "answer_count": 2, "score": 20, "last_activity_date": 1462825360, "creation_date": 1462824108, "last_edit_date": 1462825360, "question_id": 37124471, "link": "https://stackoverflow.com/questions/37124471/are-monad-laws-enforced-in-haskell", "title": "Are monad laws enforced in Haskell?", "body": "<p>From the Haskell wiki:</p>\n\n<blockquote>\n  <p>Monads can be viewed as a standard programming interface to various\n  data or control structures, which is captured by the Monad class. All\n  common monads are members of it:</p>\n\n<pre><code>class Monad m where\n  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n  (&gt;&gt;) :: m a -&gt; m b -&gt; m b\n  return :: a -&gt; m a\n  fail :: String -&gt; m a\n</code></pre>\n  \n  <p>In addition to implementing the class functions, all instances of\n  Monad should obey the following equations, or Monad Laws:</p>\n\n<pre><code>return a &gt;&gt;= k  =  k a\nm &gt;&gt;= return  =  m\nm &gt;&gt;= (\\x -&gt; k x &gt;&gt;= h)  =  (m &gt;&gt;= k) &gt;&gt;= h\n</code></pre>\n</blockquote>\n\n<p><strong>Question:</strong> Are the three monad laws at the bottom actually enforced in any way by the language? Or are they extra axioms that <strong>you</strong> must enforce in order for your language construct of a \"Monad\" to match the mathematical concept of a \"Monad\"?</p>\n"}, {"tags": ["list", "haskell", "set", "list-comprehension"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1462821907, "post_id": 37123671, "comment_id": 61788500, "body": "your two inputs don&#39;t have the same types.  Perhaps you meant <code>[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;]</code>"}, {"owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1462823340, "post_id": 37123671, "comment_id": 61789326, "body": "You are right, i will change it!"}], "answers": [{"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 2, "creation_date": 1462822943, "post_id": 37124044, "comment_id": 61789107, "body": "you actually just need the length, can be simplified? to <code>f5 xs = [take i xs | i &lt;- [1..(length xs)]]</code>"}, {"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1462823051, "post_id": 37124044, "comment_id": 61789179, "body": "@karakfa Thanks. How do you guys come up with such good answers all the time? ;-)"}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": true, "score": 2, "last_activity_date": 1462822550, "creation_date": 1462822550, "answer_id": 37124044, "question_id": 37123671, "link": "https://stackoverflow.com/questions/37123671/haskell-list-of-lists-with-a-specific-form-list-comprehension/37124044#37124044", "title": "haskell, list of lists with a specific form (list comprehension)", "body": "<p>You can do it like this:</p>\n\n<pre><code>f5 xs = [take index xs | (x, index) &lt;- zip xs [1..]]\n</code></pre>\n\n<p>For each element in the list a tuple is created containing that element and it's index, starting at 1. Then, by using <code>take</code>, for each element in the zipped list an appropriate number of elements from the original list is taken. The number of elements to take is specified in the index.</p>\n\n<p>Actually, we don't even need the <code>x</code> element from the tuple, so this could be rewritten as</p>\n\n<pre><code>f5 xs = [take index xs | (_ ,index) &lt;- zip xs [1..]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1462823049, "creation_date": 1462823049, "answer_id": 37124178, "question_id": 37123671, "link": "https://stackoverflow.com/questions/37123671/haskell-list-of-lists-with-a-specific-form-list-comprehension/37124178#37124178", "title": "haskell, list of lists with a specific form (list comprehension)", "body": "<p>This also works</p>\n\n<pre><code>foldr (\\x rest -&gt; [x]:(map (x:) rest)) [] [1,2,3,4]\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 5539565, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e3caea1216cdc02bbed42516c88cde26?s=128&d=identicon&r=PG&f=1", "display_name": "FastBatteryCharger", "link": "https://stackoverflow.com/users/5539565/fastbatterycharger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 37124044, "answer_count": 2, "score": 1, "last_activity_date": 1462823353, "creation_date": 1462821228, "last_edit_date": 1462823353, "question_id": 37123671, "link": "https://stackoverflow.com/questions/37123671/haskell-list-of-lists-with-a-specific-form-list-comprehension", "title": "haskell, list of lists with a specific form (list comprehension)", "body": "<p>i want to create a functions that takes a list and creates a list of list with list comprehension with the form <code>[[e1],[e1,e2],[e1,e2,e3]...]</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>f5 ['a','b','c'] = [\"a\",\"ab\",\"abc\"]\nf5 [1,2,3] = [[1],[1,2],[1,2,3]]\n</code></pre>\n\n<p>My Code:</p>\n\n<pre><code>f5 xs = [a | a &lt;- xs]\n\n-- tests:\n*Main&gt; f5 [\"a\",\"b\",\"c\"]\n[\"a\",\"b\",\"c\"]\n*Main&gt; f5 [1,2,3]\n[1,2,3]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462821511, "post_id": 37123526, "comment_id": 61788279, "body": "Can you give some examples of what <code>costpow k</code> is supposed to return for a few sample values of <code>k</code>? (<code>costpow 2</code>, <code>costpow 3</code>, <code>costpow 4</code>, for example.)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5884445, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OjRQqOd1U9A/AAAAAAAAAAI/AAAAAAAAAB8/xeVww3S_6cA/photo.jpg?sz=128", "display_name": "Cyneon Bane", "link": "https://stackoverflow.com/users/5884445/cyneon-bane"}, "edited": false, "score": 0, "creation_date": 1462821093, "post_id": 37123562, "comment_id": 61788051, "body": "Yes but i don&#39;t know how to write it.  If i have a given k then it is also a infinite loop ?"}, {"owner": {"reputation": 6990, "user_id": 329289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1536aecadab8356ff5e2d59da6c591?s=128&d=identicon&r=PG", "display_name": "Owen S.", "link": "https://stackoverflow.com/users/329289/owen-s"}, "edited": false, "score": 0, "creation_date": 1462822011, "post_id": 37123562, "comment_id": 61788571, "body": "The trick to recursion is to build off of a smaller result in your recursive function. I.e. <code>costpow k</code> should generally not depend on <code>costpow k</code>, but on <code>costpow x</code> run on some <code>x &lt; k</code>, for it to terminate. Often we use <code>x = k - 1</code>, but it&#39;s not always that simple, and it&#39;s not in this case. Look at the definition of <code>pow</code> you&#39;ve written \u2013 what definition of <code>x</code> does it pick at each step when calling <code>pow x</code>, and how does it relate to <code>k</code>? Should you use the same choice when calling <code>costpow</code> recursively or not?..."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1462820883, "creation_date": 1462820883, "answer_id": 37123562, "question_id": 37123526, "link": "https://stackoverflow.com/questions/37123526/implementing-a-multiplication-counting-function/37123562#37123562", "title": "Implementing a multiplication-counting function", "body": "<p>This is an infinite loop:</p>\n\n<pre><code>costpow k = ...\n   ... 1 + costpow k\n                   ^^^\n</code></pre>\n\n<p>You probably want something like <code>1 + costpow n</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5884445, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OjRQqOd1U9A/AAAAAAAAAAI/AAAAAAAAAB8/xeVww3S_6cA/photo.jpg?sz=128", "display_name": "Cyneon Bane", "link": "https://stackoverflow.com/users/5884445/cyneon-bane"}, "edited": false, "score": 0, "creation_date": 1462822551, "post_id": 37123778, "comment_id": 61788869, "body": "Thanks for the resolve, but I have to look it up more detailed, because i didn&#39;t understand it really."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1462822608, "last_edit_date": 1462822608, "creation_date": 1462821590, "answer_id": 37123778, "question_id": 37123526, "link": "https://stackoverflow.com/questions/37123526/implementing-a-multiplication-counting-function/37123778#37123778", "title": "Implementing a multiplication-counting function", "body": "<p>Your recursion will never end as stated in the other post.  Perhaps you can simplify a little more</p>\n\n<pre><code>costpow :: Integer -&gt; Integer\ncostpow 1 = 0\ncostpow k = m + 1 + costpow n\n       where (n,m) = k `divMod` 2\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5884445, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OjRQqOd1U9A/AAAAAAAAAAI/AAAAAAAAAB8/xeVww3S_6cA/photo.jpg?sz=128", "display_name": "Cyneon Bane", "link": "https://stackoverflow.com/users/5884445/cyneon-bane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462822608, "creation_date": 1462820709, "last_edit_date": 1462822085, "question_id": 37123526, "link": "https://stackoverflow.com/questions/37123526/implementing-a-multiplication-counting-function", "title": "Implementing a multiplication-counting function", "body": "<p>I have written this:</p>\n\n<pre><code>pow :: Integer -&gt; Integer -&gt; Integer\npow x k = if k == 1\nthen x\nelse if k `mod` 2 == 0\nthen pow (x*x) (k `div` 2)\nelse x * pow (x*x) (k `div` 2)\n</code></pre>\n\n<p>Now I want to write a program which has a given <code>k</code> and decides how many multiplications <code>pow x k</code> is going to execute.</p>\n\n<p>My idea was:</p>\n\n<pre><code>costpow :: Integer -&gt; Integer\ncostpow 1 = 0\ncostpow k = if m == 0 \nthen   1 + costpow k\nelse  2 + costpow k\nwhere ( n , m ) = k `divMod` 2\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30577, "user_id": 476496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197b0087c5bee323d2690c977878f8?s=128&d=identicon&r=PG", "display_name": "Vincent Savard", "link": "https://stackoverflow.com/users/476496/vincent-savard"}, "edited": false, "score": 1, "creation_date": 1462815712, "post_id": 37122093, "comment_id": 61785055, "body": "How do you know there&#39;s an error? Is there an error message? Does it return the wrong value? Try to make it easy to help you."}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 2, "creation_date": 1462816647, "post_id": 37122093, "comment_id": 61785599, "body": "What&#39;s this line doing? <code>_ = main</code>"}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 0, "creation_date": 1462816674, "post_id": 37122093, "comment_id": 61785623, "body": "Also, <code>print = putStrLn . show</code> for future reference."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1462816130, "creation_date": 1462816130, "answer_id": 37122240, "question_id": 37122093, "link": "https://stackoverflow.com/questions/37122093/haskell-multiply-arguments-if-odd/37122240#37122240", "title": "Haskell multiply arguments if odd", "body": "<p>first error that catches the eye</p>\n\n<pre><code>evenify :: [Integer] -&gt; [Integer]\nevenify n = if mod n 2 == 0 then n else n*2\n</code></pre>\n\n<p>signature expects a list but implementation is for scalars.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1462816304, "creation_date": 1462816304, "answer_id": 37122284, "question_id": 37122093, "link": "https://stackoverflow.com/questions/37122093/haskell-multiply-arguments-if-odd/37122284#37122284", "title": "Haskell multiply arguments if odd", "body": "<p>First problem is that <code>evenify</code> has the wrong type signature - as written it has the signature:</p>\n\n<pre><code>evenify :: Integer -&gt; Integer\n</code></pre>\n\n<p>With this change your program works in the sense that it will process one command line argument - the first one only.</p>\n\n<p>To process all of the arguments use <code>map</code>:</p>\n\n<pre><code>main = do args &lt;- getArguments\n          putStrLn $ show $ map evenify (map read args)\n</code></pre>\n\n<p>Explanation:</p>\n\n<pre><code>args                         is the list of command line arguments (Strings)\nmap read args                is a list of Integers\nmap evenify (map read args)  is the list of results\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6311621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36802e09383333fdce581d586a5f15c5?s=128&d=identicon&r=PG&f=1", "display_name": "CodingGuy", "link": "https://stackoverflow.com/users/6311621/codingguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1462816381, "creation_date": 1462815584, "last_edit_date": 1462816381, "question_id": 37122093, "link": "https://stackoverflow.com/questions/37122093/haskell-multiply-arguments-if-odd", "title": "Haskell multiply arguments if odd", "body": "<p>I want my code to read numbers from the console arguments and write the even ones back to the console. The odd ones should be multiplied by 2 to make them even as well. For this I added the method evenify which checks with mod 2 if its odd or even. </p>\n\n<p>I just can't find the error I'm making, most likely it's just a syntax error somewhere. Here is my code as of now:</p>\n\n<pre><code>import System.Environment\n\nevenify :: [Integer] -&gt; [Integer]\nevenify n = if mod n 2 == 0 then n else n*2\nmain :: IO ()\nmain = getArgs &gt;&gt;= putStrLn . show . evenify . read . head\n_ = main\n</code></pre>\n\n<p>What is the error?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1462825643, "post_id": 37121797, "comment_id": 61790484, "body": "The instance <code>Member x (Union x ys)</code> requires that both the <code>x</code>s be the same to begin with to match - the compiler will not deduce this information. You would have to write <code>(x ~ x&#39;) =&gt; Member x (Union x&#39; xs)</code> but this would be overlapping with the other instance - I believe you need a cleverer way of computing membership."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462829766, "post_id": 37121797, "comment_id": 61792529, "body": "Is that really enough extensions? Those two <code>Member</code> instances look awfully suspicious -- like maybe you&#39;ll need <code>OverlappingInstances</code> or perhaps even <code>IncoherentInstances</code> for those to &quot;work&quot;. If you&#39;ve got <code>IncoherentInstances</code> on, well... I think the official party line with that extension is, &quot;Good luck, don&#39;t complain to us.&quot;."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462867777, "post_id": 37121797, "comment_id": 61804826, "body": "@DanielWagner That&#39;s odd... <code>OverlappingInstances</code> is supposed to be in there. I&#39;m not sure how it ended up missing. I must have accidentally dropped it while building my minimal example."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1462906947, "post_id": 37121797, "comment_id": 61831716, "body": "@user2407038 I was surprised to learn that you can actually write <code>x ~ y</code> in a type signature! You learn something new every day..."}], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1462867794, "post_id": 37125847, "comment_id": 61804838, "body": "So where exactly are you suggesting I need a fundep?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1462897792, "post_id": 37125847, "comment_id": 61826494, "body": "@MathematicalOrchid There is no small change to your code that comes to mind that would fix things. Everything I can thing of is more of a sweeping architectural change. Your <code>Member</code> typeclass is &quot;bad&quot; from a type inference point of view: the <code>Member x (Union y ys)</code> instance can <i>always</i> match; and worse matching tells you almost nothing about the types <code>x</code>, <code>y</code>, or <code>ys</code>, because the open world assumption says anybody can come along later and add a <code>Member x ys</code> instance for any stupid pair of types! You could consider splitting it into a <code>ReaderMember</code> class (and similar for other effects)."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1462829607, "creation_date": 1462829607, "answer_id": 37125847, "question_id": 37121797, "link": "https://stackoverflow.com/questions/37121797/type-signature-is-too-general-missing-constraint/37125847#37125847", "title": "Type signature is too general; missing constraint?", "body": "<p>The compiler hasn't figured out that <code>x</code> must be <code>Char</code> because it isn't true. For example, one might write</p>\n\n<pre><code>type ReadsBool req = Union (Reader Bool) req\ntype ReadsCharAndBool req = Union (Reader Char) (ReadsBool req)\n</code></pre>\n\n<p>and then you have:</p>\n\n<pre><code>runReader 'X' (get :: ReadsCharAndBool req) :: ActM (ReadsBool req) Bool\n</code></pre>\n\n<p>So congratulations, now you know why <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader-Class.html#t:MonadReader\" rel=\"nofollow\">mtl's <code>MonadReader</code> class</a> has the fundep it does: for type inference reasons, one often wants the monad to uniquely determine what kind of thing you can <code>get</code> from it.</p>\n"}], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 37125847, "answer_count": 1, "score": 1, "last_activity_date": 1462829607, "creation_date": 1462814529, "last_edit_date": 1495542232, "question_id": 37121797, "link": "https://stackoverflow.com/questions/37121797/type-signature-is-too-general-missing-constraint", "title": "Type signature is too general; missing constraint?", "body": "<p>So I tried to ask a general \"<a href=\"https://stackoverflow.com/questions/37101800/how-to-debug-type-level-programs\">how do you debug type-level programming problems?</a>\" question, and it seems either the question is too general to answer, or maybe it's impossible to debug such things. :-}</p>\n\n<p>On this particular day, the problem that's irking me is a moderately large, complex program. I've managed to boil it down to a reasonably small core that still goes wrong. Here we go:</p>\n\n<pre><code>{-#\n  LANGUAGE\n    GADTs, MultiParamTypeClasses,\n    FlexibleInstances, FlexibleContexts, RankNTypes,\n    KindSignatures\n#-}\n\nmodule Minimal where\n\n-------------------------------------------------------------------------------\n\ndata Union (t :: * -&gt; *) (ts :: * -&gt; *) x\n\nclass Member (x :: * -&gt; *) (ys :: * -&gt; *) where\ninstance Member x (Union x ys) where\ninstance (Member x ys) =&gt; Member x (Union y ys) where\n\n-------------------------------------------------------------------------------\n\ndata ActM (effects :: * -&gt; *) x\ninstance Monad (ActM effects) where\n\n-------------------------------------------------------------------------------\n\ndata Reader i x where\n  Get :: Reader i i\n\nget :: Member (Reader i) req =&gt; ActM req i\nget = undefined\n\nrunReader :: i -&gt; ActM (Union (Reader i) req) x -&gt; ActM req x\nrunReader = undefined\n</code></pre>\n\n<p>(Aside: I look at that list of language extensions and think to myself \"maybe this is just a terrible idea!\")</p>\n\n<p>Anyway, the really interesting part is at the bottom. We see that</p>\n\n<pre><code>runReader :: i -&gt; ActM (Union (Reader i) req) x -&gt; ActM req x\n</code></pre>\n\n<p>In other words, for any <code>i</code>, <code>runReader</code> takes an action in the <code>ActM</code> monad that has <code>Reader i</code> as one of its possible effects, and returns an action in the <code>ActM</code> monad <em>without</em> that possible effect. Simple, right?</p>\n\n<p>Now if I pass (say) a <code>Char</code> as the first argument, then the reader type is fixed to <code>Char</code>:</p>\n\n<pre><code>runReader 'X' :: ActM (Union (Reader Char) req) x -&gt; ActM req x\n</code></pre>\n\n<p>So far, so good. If I just return some data, all is fine:</p>\n\n<pre><code>runReader 'X' (return True) :: ActM req Bool\n</code></pre>\n\n<p>(Reassuringly, I also get the correct <em>value</em> as the result!)</p>\n\n<p>But now, what about the <code>get</code> function?</p>\n\n<pre><code>get :: Member (Reader i) req =&gt; ActM req i\n</code></pre>\n\n<p>So <code>get</code> is an action in the <code>ActM</code> monad for any set of effects that includes <code>Reader i</code>. And that means that if I pass it to <code>runReader</code> then I get...</p>\n\n<pre><code>runReader 'X' get :: Member (Reader x) (Union (Reader Char) req) =&gt; ActM req x\n</code></pre>\n\n<p>...wait, what?!? Why hasn't the compiler figured out that <code>x</code> <em>must</em> be <code>Char</code>?</p>\n\n<p>Indeed, if I add an explicit type signature that says</p>\n\n<pre><code>runReader 'X' get :: ActM req Char\n</code></pre>\n\n<p>then it compiles perfectly (and, incidentally, I get the right value output, which is nice). So where am I missing a constraint?</p>\n"}, {"tags": ["haskell", "bytestring"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462818248, "post_id": 37121340, "comment_id": 61786540, "body": "BTW, I hope you know what you are doing. A <code>ByteString</code> is a sequence of bytes, and not a string: conversion between them fundamentally depends on a given encoding. In particular, <code>Char8</code> assumes that everything is encoded using latin-1, and silently truncates everything else."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1462824551, "post_id": 37121340, "comment_id": 61789991, "body": "Is there a particular reason why you are using <code>String</code> and not <code>Text</code> the conversion with encoding/decoding is a bit more straightforward."}, {"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1462832063, "post_id": 37121340, "comment_id": 61793308, "body": "Because my other functions requires String"}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1462816706, "post_id": 37121616, "comment_id": 61785639, "body": "<code>urlDecode True (stringToBS str)</code> with <code>stringToBS str = BS.fromStrict $ C8.pack str</code> brings me: <code>Couldn&#39;t match expected type \u2018Data.ByteString.Internal.ByteString\u2019                 with actual type \u2018ByteString\u2019</code> how to solve?"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 2, "last_activity_date": 1462813786, "creation_date": 1462813786, "answer_id": 37121616, "question_id": 37121340, "link": "https://stackoverflow.com/questions/37121340/string-bytestring-and-reverse/37121616#37121616", "title": "String -&gt; ByteString and reverse", "body": "<p>You can convert between lazy and non-lazy versions using <code>fromStrict</code>, and <code>toStrict</code> (both functions are in the lazy bytestring module).</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1462813791, "creation_date": 1462813791, "answer_id": 37121619, "question_id": 37121340, "link": "https://stackoverflow.com/questions/37121340/string-bytestring-and-reverse/37121619#37121619", "title": "String -&gt; ByteString and reverse", "body": "<p>You are working with both strict ByteStrings and lazy ByteStrings which are two different types.</p>\n\n<p>This import:</p>\n\n<pre><code>import Data.ByteString.Lazy as BS  (ByteString)\n</code></pre>\n\n<p>makes <code>ByteString</code> refer the lazy ByteStrings, so the type signature of your <code>stringToBS</code> doesn't match it's definition:</p>\n\n<pre><code>stringToBS :: String -&gt; ByteString  -- refers to lazy ByteStrings\nstringToBS str = C8.pack str        -- refers to strict ByteStrings\n</code></pre>\n\n<p>I think it would be a better idea to use <code>import qualified</code> like this:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as LBS\nimport qualified Data.ByteString.Char8 as BS\n</code></pre>\n\n<p>and use <code>BS.ByteString</code> and <code>LBS.ByteString</code> to refer to strict / lazy ByteStrings.</p>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1462813791, "creation_date": 1462812813, "question_id": 37121340, "link": "https://stackoverflow.com/questions/37121340/string-bytestring-and-reverse", "title": "String -&gt; ByteString and reverse", "body": "<p>In my Haskell Program I need to work with Strings and ByteStrings:</p>\n\n<pre><code>import Data.ByteString.Lazy as BS  (ByteString)\nimport Data.ByteString.Char8 as C8 (pack)\nimport Data.Char                   (chr)\n\nstringToBS :: String -&gt; ByteString\nstringToBS str = C8.pack str\n\nbsToString :: BS.ByteString -&gt; String\nbsToString bs = map (chr . fromEnum) . BS.unpack $ bs\n</code></pre>\n\n<p><code>bsToString</code> works fine, but <code>stringToBS</code> results with following error at compiling:</p>\n\n<pre><code>Couldn't match expected type \u2018ByteString\u2019\n                with actual type \u2018Data.ByteString.Internal.ByteString\u2019\n    NB: \u2018ByteString\u2019 is defined in \u2018Data.ByteString.Lazy.Internal\u2019\n        \u2018Data.ByteString.Internal.ByteString\u2019\n          is defined in \u2018Data.ByteString.Internal\u2019\n    In the expression: pack str\n    In an equation for \u2018stringToBS\u2019: stringToBS str = pack str\n</code></pre>\n\n<p>But I need to let it be <code>ByteString</code> from <code>Data.ByteString.Lazy as BS  (ByteString)</code> for further working functions in my code.</p>\n\n<p>Any idea how to solve my problem?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1462811976, "post_id": 37120968, "comment_id": 61783006, "body": "you&#39;re calling <code>l</code> on the tail of the list"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1462812236, "post_id": 37120968, "comment_id": 61783139, "body": "Why are you using <code>[Bool]</code> instead of <code>Bool</code>?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462815023, "post_id": 37120968, "comment_id": 61784686, "body": "Can you give an example of an input to <code>decode</code> which should return <code>Nothing</code>?"}, {"owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1462828986, "post_id": 37120968, "comment_id": 61792233, "body": "@jberryman thx this fixed the second problem. <code>decode xs = Just (l xs)</code>"}, {"owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462829130, "post_id": 37120968, "comment_id": 61792284, "body": "@ErikR [I,O,abc,I] should return Nothing. Anything that is not [I,O...] should return Nothing."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462829857, "post_id": 37120968, "comment_id": 61792563, "body": "@HornsUp - but <code>decode</code> needs a list of Bit values, and <code>abc</code> is (presumably) not a Bit, so you couldn&#39;t even construct that list in the first place. Now if <code>decode</code> operateed on a list of String values, I could see where it could return Nothing."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1462829809, "creation_date": 1462829809, "answer_id": 37125878, "question_id": 37120968, "link": "https://stackoverflow.com/questions/37120968/data-constructor-and-working-with-maybe/37125878#37125878", "title": "Data constructor and working with maybe", "body": "<p>Your definition</p>\n\n<pre><code>data Bit = O | I\n</code></pre>\n\n<p>enforces that <code>[Bit]</code> can only have <code>I/O</code>.  Perhaps you just need to handle empty list case?  Also, the representation of single true/false values as singleton lists is strange.  Why not just use <code>Bool</code>?</p>\n\n<p>I would simplify it as</p>\n\n<pre><code>encodeBit O = False\nencodeBit I = True\n\ndecodeBit False = O\ndecodeBit True = I\n\n&gt; map encodeBit [O,O,I]\n[False,False,True]\n\n&gt; map decodeBit it\n[O,O,I]\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1462829809, "creation_date": 1462811666, "last_edit_date": 1462829163, "question_id": 37120968, "link": "https://stackoverflow.com/questions/37120968/data-constructor-and-working-with-maybe", "title": "Data constructor and working with maybe", "body": "<p>The first function \"encode\" works and takes Lists of Bool statements and makes them into Is and Os. In the function \"decode\" i am supposed to decode the Is and Os again into True and False. In the decode function i am having trouble with checking if there are any elements that are not in data Bit to which the programm is supposed to respond with Nothing.</p>\n\n<p>In the decode otherwise guard Just (l xs) does not give me \"Just [[False],[False],[True]]\" for \"decode [O,O,I]\" It leaves out the first Bit \"Just [False],[True]\" and I do  not know why that is.</p>\n\n<pre><code>module Blueprint where\nimport Prelude\nimport Data.List\nimport Data.Maybe\n\ndata Bit = O | I  deriving (Eq, Show)\n\nencode :: [[Bool]] -&gt; [Bit]\nencode [] = []\nencode (x:xs) |x==[True]  = I : encode xs\n          |otherwise  = O : encode xs\n\nl :: [Bit] -&gt; [[Bool]]\nl [] = []\nl (x:xs) |x==I =[True] : l xs\n         |x==O =[False]: l xs\n\ndecode :: [Bit] -&gt; Maybe [[Bool]]\ndecode xs |{-if anything is in the list that is not in data Bit-} = Nothing\n              |otherwise = Just (l xs)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "edited": false, "score": 0, "creation_date": 1462812921, "post_id": 37120967, "comment_id": 61783530, "body": "Please add the error you are getting to the question"}], "answers": [{"tags": [], "owner": {"reputation": 3137, "user_id": 1862339, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1fdbdf79034c63bd0fb1b51e48695f?s=128&d=identicon&r=PG", "display_name": "stholzm", "link": "https://stackoverflow.com/users/1862339/stholzm"}, "is_accepted": false, "score": 1, "last_activity_date": 1462813277, "creation_date": 1462813277, "answer_id": 37121467, "question_id": 37120967, "link": "https://stackoverflow.com/questions/37120967/specific-information-from-tuple-lists/37121467#37121467", "title": "Specific information from tuple lists", "body": "<p>Well, this fixes your type errors:</p>\n\n<pre><code>getTuple (x:xs) bk\n    | null xs = \"notBook\"\n    | (getBook x) bk == bk = bk\n    | (getBook x) bk /= bk = getTuple xs bk\n</code></pre>\n\n<p>But I'd like to advise you that returning a special value (<code>\"notBook\"</code>) for exceptional cases is not a good style. You can simplify your solution to just return <code>True</code> if you found the book, or try the next one, or finally return <code>False</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1462813328, "creation_date": 1462813328, "answer_id": 37121483, "question_id": 37120967, "link": "https://stackoverflow.com/questions/37120967/specific-information-from-tuple-lists/37121483#37121483", "title": "Specific information from tuple lists", "body": "<p><code>null</code> is a function, not a value.</p>\n\n<p>You can't do this</p>\n\n<pre><code>x == null\n</code></pre>\n\n<p>But you can do this</p>\n\n<pre><code>null x\n</code></pre>\n\n<p><em>Except</em> that <code>x</code> is also not a list!</p>\n\n<p>I think you meant to check if the list is empty, which can be don't using pattern matching</p>\n\n<pre><code>getTuple [] _ = ....\n</code></pre>\n\n<p>This would come before the line you already have.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 2, "last_activity_date": 1462813423, "creation_date": 1462813423, "answer_id": 37121514, "question_id": 37120967, "link": "https://stackoverflow.com/questions/37120967/specific-information-from-tuple-lists/37121514#37121514", "title": "Specific information from tuple lists", "body": "<p>First of all, <code>x == null</code> won't work.</p>\n\n<p>In Haskell, <code>null</code> is a <em>function</em>. It takes a <em>list</em> and tells you if the list is empty or not. So <code>null x</code> might do something. Except <code>x</code> here isn't a list, it's a <em>tuple</em>.</p>\n\n<p>Perhaps you meant something more like</p>\n\n<pre><code>getTuple [] bk = \"notBook\"\ngetTuple (x:xs) bk\n  | (getBook x) == bk = ...\n  | (getBook x) /= bk = ...\n</code></pre>\n\n<p>Not sure why you're testing that condition twice, once with <code>==</code> and once with <code>/=</code>; you could simply replace the second one with <code>otherwise</code>.</p>\n\n<p>For that matter, not sure why you need a separate <code>getBook</code> function; you could simply do</p>\n\n<pre><code>getTuple [] bk = \"notBook\"\ngetTuple ((person, book) : xs) bk = if book == bk ...\n</code></pre>\n\n<p>Then again, I'm not even sure why <code>getTuple</code> returns a <code>Book</code> (or the magic string <code>\"notBook\"</code> if not found), which <code>borrowed</code> then has to compare... when you could just return a <code>True</code> or <code>False</code> right from here.</p>\n\n<pre><code>borrowed [] bk = False\nborrowed ((person, book) : xs) bk = if book == bk then True else borrowed xs bk\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": false, "score": 2, "last_activity_date": 1462813898, "creation_date": 1462813898, "answer_id": 37121647, "question_id": 37120967, "link": "https://stackoverflow.com/questions/37120967/specific-information-from-tuple-lists/37121647#37121647", "title": "Specific information from tuple lists", "body": "<p>This is very close to the solution, but lets address a few problems in your code:</p>\n\n<ol>\n<li>Avoid in-exhaustive pattern matching</li>\n</ol>\n\n<p>In Haskell we tend to avoid inexhaustive pattern matching as much as possible as such code can crash on runtime. For example, your getTuple function will crash given the empty list. The compiler will alert you of such cases when compiling with -Wall</p>\n\n<ol start=\"2\">\n<li>Encode invariance in your types</li>\n</ol>\n\n<p>Haskell offers data types to help you represent invariance. For example, if you want to represent a 0 or 1 value, use Maybe. For example: \"notBook\" is a valid name for a book, so if you didn't find the value you were looking for you can use Nothing, and if you did you can use Just bk.</p>\n\n<ol start=\"3\">\n<li>Pay attention to type mismatches</li>\n</ol>\n\n<p>In your getTuple function you try to compare x with null, null in Haskell is a function that checks if a list is empty,so you have a tyoe mismatch there.</p>\n\n<ol start=\"4\">\n<li>Name things well</li>\n</ol>\n\n<p>getTuple is probably not a great name for your function :) I'm sure you can come up with a more informative name.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 333, "user_id": 6009572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7899bee63fefec4974ebc4e92809e695?s=128&d=identicon&r=PG&f=1", "display_name": "w13rfed", "link": "https://stackoverflow.com/users/6009572/w13rfed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 37121514, "answer_count": 4, "score": 0, "last_activity_date": 1462813898, "creation_date": 1462811663, "question_id": 37120967, "link": "https://stackoverflow.com/questions/37120967/specific-information-from-tuple-lists", "title": "Specific information from tuple lists", "body": "<p>I'm stuck on a exercise from a book where I have to take a database for a library and I have to find out if a book is currently being borrowed by checking a the database which is full of tuples of the form</p>\n\n<pre><code>type Person = String\ntype Book = String\ntype Database = [(Person,Book)]\n</code></pre>\n\n<p>the function I have to use is</p>\n\n<pre><code>borrowed :: Database -&gt; Book -&gt; Bool\n</code></pre>\n\n<p>where the Database is full of all of the books currently being borrowed, the Book is the book i'm searching for and it should return True if the book is being borrowed</p>\n\n<p>Here's what I've got so far, ghci keeps telling me I have problems with matching types in the getTuple function but I can't figure out what's wrong</p>\n\n<pre><code>-- Database I will use for the function\nexampleBase :: Database \nexampleBase =\n    [ (\"Alice\",\"Tintin\") , (\"Anna\",\"Little Woman\") ,\n      (\"Alice\",\"Asterix\") , (\"Rory\",\"Tintin\") ]\n\nborrowed :: Database -&gt; Book -&gt; Bool\nborrowed dBase book\n    | getTuple dBase book == book = True\n    | otherwise = False\n\ngetTuple :: Database -&gt; Book -&gt; Book\ngetTuple (x:xs) bk\n    | x == null = \"notBook\"\n    | (getBook x) == bk = bk\n    | (getBook x) /= bk = getTuple xs bk\n\ngetBook :: (String,String) -&gt; Book -&gt; Book\ngetBook (first,second) bk\n    | second == bk = bk\n    | otherwise = \"notBook\"\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 3, "last_activity_date": 1462810143, "creation_date": 1462810143, "answer_id": 37120515, "question_id": 37120423, "link": "https://stackoverflow.com/questions/37120423/readint-not-working-in-haskell-in-example/37120515#37120515", "title": "read::Int not working in Haskell in example", "body": "<p><code>read</code> is a function (of type <code>Read a =&gt; String -&gt; a</code>), so it can't have type <code>Int</code>. You could do <code>read :: String -&gt; Int</code>, or you could put a type signature on <code>list</code> rather than <code>read</code>, so you get:</p>\n\n<pre><code>let list :: [Int]\n    list = map read (words s)\n</code></pre>\n"}], "owner": {"reputation": 4558, "user_id": 135807, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9a321fcae67e54d6ff1c8971e036ce47?s=128&d=identicon&r=PG", "display_name": "Aftershock", "link": "https://stackoverflow.com/users/135807/aftershock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 37120515, "answer_count": 1, "score": 0, "last_activity_date": 1462869176, "creation_date": 1462809863, "last_edit_date": 1462869176, "question_id": 37120423, "link": "https://stackoverflow.com/questions/37120423/readint-not-working-in-haskell-in-example", "title": "read::Int not working in Haskell in example", "body": "<p>Here is the problem. It looks simple yet</p>\n\n<pre><code>main = do \n   s &lt;- getContents\n   let list = map (read::Int) (words s)\n   print list\n\n    Couldn't match expected type `Int' with actual type `String -&gt; a0'\n    Probable cause: `read' is applied to too few arguments\n    In the first argument of `map', namely `(read :: Int)'\n    In the expression: map (read :: Int) (words s)\n</code></pre>\n\n<p>The problem was that I thought :: is like casting and I have to put the return type. The solution was to add full wanted |function signature instread.</p>\n"}, {"tags": ["haskell", "expression-trees"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462807918, "post_id": 37119541, "comment_id": 61780477, "body": "The fact that <code>fold</code> takes <i>so</i> many arguments without actually using them (other than to pass them on to recursive calls) suggests that <code>fold</code> doesn&#39;t actually need so many arguments."}, {"owner": {"reputation": 6176, "user_id": 398909, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7341b4c982d87acd9bc260a5a970782f?s=128&d=identicon&r=PG", "display_name": "william", "link": "https://stackoverflow.com/users/398909/william"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462808438, "post_id": 37119541, "comment_id": 61780806, "body": "I am wondering the same thing. So for this new function, should I create a new <code>fold</code>? or sth? I couldn&#39;t think a way to start."}], "answers": [{"comments": [{"owner": {"reputation": 6176, "user_id": 398909, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7341b4c982d87acd9bc260a5a970782f?s=128&d=identicon&r=PG", "display_name": "william", "link": "https://stackoverflow.com/users/398909/william"}, "edited": false, "score": 0, "creation_date": 1462813434, "post_id": 37121464, "comment_id": 61783828, "body": "Thanks. I came up with something that is basically what you suggested."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 0, "last_activity_date": 1462813263, "creation_date": 1462813263, "answer_id": 37121464, "question_id": 37119541, "link": "https://stackoverflow.com/questions/37119541/expression-tree-to-list-of-string/37121464#37121464", "title": "Expression Tree to List of String", "body": "<p>The conventional way to write <code>varList</code> is like this:</p>\n\n<pre><code>varList (V x) = [x]\nvarList (L _) = []\nvarList (N e) = varList e  -- same for all unary nodes, e.g. Q, S, K, ...\nvarList (A a b) = varList a ++ varList b\n  -- same for the other binary nodes\n</code></pre>\n\n<p>So compare:</p>\n\n<pre><code>fold (N x) l v n q s k a o e m =  n (fold x l v n q s k a o e m)\nvarList (N x)                  =  varList x\n</code></pre>\n\n<p>Convince yourself that:</p>\n\n<pre><code>varList blah == fold blah l v n ... e m\n</code></pre>\n\n<p>With this identification,</p>\n\n<pre><code>varList x == n (fold x l v n ... e m) == n (varList x)\n</code></pre>\n\n<p>and therefore <code>n</code> must be <code>id</code>, the identity function.</p>\n\n<p>Another example... determining <code>l</code>:</p>\n\n<pre><code>varList (L x) == fold (L x) l ... e m\n              == l (fold x  l ... e m)\n              == l (varList x)\n              == []\n</code></pre>\n\n<p>so <code>l (varList x) == []</code> which means that <code>l</code> must be ...?</p>\n"}, {"tags": [], "owner": {"reputation": 6176, "user_id": 398909, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7341b4c982d87acd9bc260a5a970782f?s=128&d=identicon&r=PG", "display_name": "william", "link": "https://stackoverflow.com/users/398909/william"}, "is_accepted": false, "score": 0, "last_activity_date": 1462813555, "creation_date": 1462813555, "answer_id": 37121557, "question_id": 37119541, "link": "https://stackoverflow.com/questions/37119541/expression-tree-to-list-of-string/37121557#37121557", "title": "Expression Tree to List of String", "body": "<pre><code>fold2 :: LExpTree a -&gt; [String]\nfold2  (L x) = []\nfold2 (V x) = [x]\nfold2 (N x) = fold2 (x)\nfold2 (Q x) = fold2 (x)\nfold2 (S x) = fold2 (x)\nfold2 (K x) = fold2 (x)\nfold2 (A x) = (fold2 (left' x)) ++ (fold2 (right' x))\nfold2 (O x) = (fold2 (left' x)) ++ (fold2 (right' x))\nfold2 (E x) = (fold2 (left' x)) ++ (fold2 (right' x))\nfold2 (M x) = (fold2 (left' x)) ++ (fold2 (right' x))\n\nvarList :: LExpTree Lukasiewicz -&gt; [String]\nvarList x = [y | y &lt;- fold2 x]\n</code></pre>\n"}], "owner": {"reputation": 6176, "user_id": 398909, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7341b4c982d87acd9bc260a5a970782f?s=128&d=identicon&r=PG", "display_name": "william", "link": "https://stackoverflow.com/users/398909/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 37121464, "answer_count": 2, "score": 0, "last_activity_date": 1462813555, "creation_date": 1462807355, "last_edit_date": 1495541273, "question_id": 37119541, "link": "https://stackoverflow.com/questions/37119541/expression-tree-to-list-of-string", "title": "Expression Tree to List of String", "body": "<p>This is my project, and the continuation of my previous question.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/37100836/haskell-creating-new-data\">Haskell creating new data</a></p>\n\n<p>This is the essential parts of my code. </p>\n\n<pre><code>data Lukasiewicz = C | I | U\n    deriving (Eq,  Show, Ord)\ndata LExpTree a = L a\n                | V [Char]\n                | N (LExpTree a)\n                | Q (LExpTree a)\n                | S (LExpTree a)\n                | K (LExpTree a)\n                | A ((LExpTree a), (LExpTree a))\n                | O ((LExpTree a), (LExpTree a))\n                | E ((LExpTree a), (LExpTree a))\n                | M ((LExpTree a), (LExpTree a))\n                deriving (Show, Eq)\n\ntype Dict = [(String, Lukasiewicz)] \n\ntype Unary a b = a -&gt; b\ntype Unary2 a = a -&gt; a\ntype Binary b = b -&gt; b -&gt; b\n\nfold :: LExpTree a -&gt; Unary a b -&gt; Unary [Char] b -&gt; Unary2 b -&gt; Unary2 b -&gt; Unary2 b -&gt; Unary2 b -&gt; Binary b -&gt; Binary b -&gt; Binary b -&gt; Binary b -&gt; b\nfold (L x) l v n q s k a o e m =  l x\nfold (V x) l v n q s k a o e m =  v x\nfold (N x) l v n q s k a o e m =  n (fold x l v n q s k a o e m)\nfold (Q x) l v n q s k a o e m =  q (fold x l v n q s k a o e m)\nfold (S x) l v n q s k a o e m =  s (fold x l v n q s k a o e m)\nfold (K x) l v n q s k a o e m =  k (fold x l v n q s k a o e m)\nfold (A x) l v n q s k a o e m =  a (fold (left' x) l v n q s k a o e m) (fold (right' x) l v n q s k a o e m)\nfold (O x) l v n q s k a o e m =  o (fold (left' x) l v n q s k a o e m) (fold (right' x) l v n q s k a o e m)\nfold (E x) l v n q s k a o e m =  e (fold (left' x) l v n q s k a o e m) (fold (right' x) l v n q s k a o e m)\nfold (M x) l v n q s k a o e m =  m (fold (left' x) l v n q s k a o e m) (fold (right' x) l v n q s k a o e m)\n\nevalT :: Dict -&gt; LExpTree Lukasiewicz -&gt; Lukasiewicz\nevalT xs x = fold x id (lk xs) negation possible sure unknown (&lt;&amp;&gt;) (&lt;|&gt;) (&lt;-&gt;) (--&gt;)\n</code></pre>\n\n<p>The last function <code>evalT</code> will take a <code>Dict</code> and <code>Expression Tree</code> and will spit out the result of that expression provided that the user will give the value for all variables for <code>V [Char]</code> in the expression tree in <code>Dict</code> list.</p>\n\n<p>Now I need to create a new function which will evaluate the expression tree.\nThis time, the input won't have <code>Dict</code>. So, the output is not the result but the list of all variable names. </p>\n\n<p>My idea is to use the same <code>fold</code> function and to ignore everything except <code>V [Char]</code>. The rest should just call the expression tree, and should not do anything else. </p>\n\n<p>But I have no idea how to start. </p>\n\n<p>The signature of the function should be</p>\n\n<pre><code>varList :: LExpTree Lukasiewicz -&gt; [String]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462807634, "post_id": 37119459, "comment_id": 61780261, "body": "well in the first case <code>GHCi</code> knows to execute the <code>IO</code> action - in the second case it get&#39;s a list of <code>IO</code> actions (which are not an instance of <code>Show</code>) - you can use <code>sequence_ $ tail ls</code> to get something <i>similar</i>"}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 15, "last_activity_date": 1462808836, "last_edit_date": 1462808836, "creation_date": 1462808008, "answer_id": 37119750, "question_id": 37119459, "link": "https://stackoverflow.com/questions/37119459/no-instance-for-show-io-arising-from-a-use-of-print/37119750#37119750", "title": "No instance for (Show (IO ())) arising from a use of \u2018print\u2019", "body": "<p>This behaviour is explained <a href=\"https://downloads.haskell.org/~ghc/7.2.2/docs/html/users_guide/interactive-evaluation.html\" rel=\"noreferrer\">here</a>.</p>\n\n<p><code>head ls</code> has type <code>IO ()</code> so GCHi executes the action and doesn't print the result <code>()</code>.</p>\n\n<p>In contrast, <code>tail ls</code> has type <code>[IO ()]</code>. Since this is not an <code>IO</code> action, GCHi attempts to display it using <code>print</code> which has type:</p>\n\n<pre><code>print :: Show a =&gt; a -&gt; IO ()\n</code></pre>\n\n<p>however since there is no <code>Show</code> instance for <code>[IO ()]</code> you get the error. If you want to evaluate the actions you can use <code>sequence_</code>:</p>\n\n<pre><code>sequence_ (tail ls)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "edited": false, "score": 0, "creation_date": 1462810282, "post_id": 37119787, "comment_id": 61782050, "body": "Thank&#39;s for your explaination. I choose the other just cause was the first."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1462808110, "creation_date": 1462808110, "answer_id": 37119787, "question_id": 37119459, "link": "https://stackoverflow.com/questions/37119459/no-instance-for-show-io-arising-from-a-use-of-print/37119787#37119787", "title": "No instance for (Show (IO ())) arising from a use of \u2018print\u2019", "body": "<p>When you have</p>\n\n<pre><code>&gt; let ls = [putChar 'x', putChar 'y']\n</code></pre>\n\n<p>you aren't executing the actions stored in that list, you're just constructing those actions, if that makes sense.  You could have something like</p>\n\n<pre><code>printHelp :: IO ()\nprintHelp = putStrLn \"You need to pass XYZ options to this program\"\n</code></pre>\n\n<p>defined in a file.  This doesn't immediately print out the message, but instead constructs an action that, once executed, prints that message to the console.  Execution happens in one of two places: in the <code>main</code> function and in GHCi.</p>\n\n<p>It looks like you're using GHCi to execute code, which is awesome for exploring different functions, but is a bit different than executing code in a file.  Whenever you evaluate an <code>IO Something</code> action by itself in GHCi, it runs that IO action.  Whenever you evaluate any other value in GHCi it inserts <code>print</code> in front of that line.  So when you do</p>\n\n<pre><code>&gt; head ls\n</code></pre>\n\n<p>This has type <code>IO ()</code>, and so the action <code>putChar 'x'</code> is executed, resulting in <code>x</code> being printed out to the console.  When you do</p>\n\n<pre><code>&gt; tail ls\n</code></pre>\n\n<p>This has type <code>[IO ()]</code>, so GHCi tries to put a <code>print</code> in front of it, making it equivalent to</p>\n\n<pre><code>&gt; print (tail ls)\n</code></pre>\n\n<p>The <code>print</code> function has type</p>\n\n<pre><code>print :: (Show a) =&gt; a -&gt; IO ()\n</code></pre>\n\n<p>We've passed a list to <code>print</code> here, and there is an instance of <code>Show</code> for lists, but only when the elements of the list have an instance of <code>Show</code>.  So the compiler tries to see if <code>IO ()</code> has an instance for <code>Show</code>.  Unfortunately, it does not, since <code>IO</code> is a pretty complex type that represents that pretty much anything can happen.  So the compiler shows an error that <code>IO ()</code> doesn't have an instance for <code>Show</code>.</p>\n\n<p>If you want to instead run every action in a list in order, there is a function for that: <code>Control.Monad.sequence</code> (or <code>Control.Monad.sequence_</code> if you don't care about the result).  This function actually works on all <code>Monad</code>s, not just <code>IO</code>:</p>\n\n<pre><code>&gt; sequence_ (tail ls)\ny&gt; sequence_ ls\nxy&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1462808566, "last_edit_date": 1462808566, "creation_date": 1462808208, "answer_id": 37119815, "question_id": 37119459, "link": "https://stackoverflow.com/questions/37119459/no-instance-for-show-io-arising-from-a-use-of-print/37119815#37119815", "title": "No instance for (Show (IO ())) arising from a use of \u2018print\u2019", "body": "<blockquote>\n  <p>then if do: <code>head ls</code>\n   the output is obviusly x</p>\n</blockquote>\n\n<p>well, <a href=\"https://www.youtube.com/watch?v=S2OmmcsAZnw\" rel=\"noreferrer\">actually <em>not</em> obviously</a>! In fact, <code>head ls</code> is not something directly related to the character <code>'x'</code>. First of all, it's simply an <code>IO</code> action, and GHCi assumes that this action does something you want to happen: it has a special treatment that for an <code>IO</code> action it tries not to show the action, but <em>executes</em> it. Well, good that you didn't consider instead the list <a href=\"http://hackage.haskell.org/package/acme-missiles-0.3/docs/Acme-Missiles.html#v:launchMissiles\" rel=\"noreferrer\"><code>[launchMissiles, putStrLn \"oops\"]</code></a>...</p>\n\n<p>Now, <em>executing</em> the action does indeed result in the character <code>'x'</code> being printed to the console, which just happens to be also your viewport, so you see it as if it was just the value of <code>putChar 'x'</code>. But it's not!</p>\n\n<p>OTOH, <code>tail ls</code> is from the outside just a list, so ghci doesn't assume you want anything executed. It does try to <em>show</em> the list, but you can't <em>show</em> an IO action or anything with IO actions in it; that's what the error message says.</p>\n"}, {"tags": [], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "is_accepted": false, "score": 0, "last_activity_date": 1462808479, "creation_date": 1462808479, "answer_id": 37119914, "question_id": 37119459, "link": "https://stackoverflow.com/questions/37119459/no-instance-for-show-io-arising-from-a-use-of-print/37119914#37119914", "title": "No instance for (Show (IO ())) arising from a use of \u2018print\u2019", "body": "<p>It's not just <code>tail ls</code>, if you do <code>ls</code> or <code>init ls</code> , you will get the same error.</p>\n\n<p>The type of <code>ls</code> is:</p>\n\n<pre><code>ls :: [IO ()]\n</code></pre>\n\n<p>When you type something in GHCi, it will evaluate the expression and print the result. </p>\n\n<p>In the second case (<code>ls</code>), from the type of <code>ls</code>, the <strong>returned value</strong> is a list of actions and <code>GHC</code> does not know how to show an action of <code>IO ()</code>. </p>\n\n<p>In the first case, GHCi evaluates the <code>IO ()</code>, which prints x. There is <strong>no returned values</strong> for <code>IO ()</code>, so there is nothing to show and no error. </p>\n"}], "owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7086, "favorite_count": 1, "accepted_answer_id": 37119750, "answer_count": 4, "score": 5, "last_activity_date": 1494153010, "creation_date": 1462807112, "last_edit_date": 1494153010, "question_id": 37119459, "link": "https://stackoverflow.com/questions/37119459/no-instance-for-show-io-arising-from-a-use-of-print", "title": "No instance for (Show (IO ())) arising from a use of \u2018print\u2019", "body": "<p>Just for learning I did this on my console WinGHCi:</p>\n\n<pre><code>let ls = [putChar 'x',putChar 'y']\n</code></pre>\n\n<p>then if do:</p>\n\n<pre><code>head ls\n</code></pre>\n\n<p>the output is obviusly  <em>x</em> <em>(obviusly in the sense that I undestand why)</em></p>\n\n<p>else if I do:</p>\n\n<pre><code>tail ls\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>No instance for (Show (IO ())) arising from a use of \u2018print\u2019</p>\n  \n  <p>In a stmt of an interactive GHCi command: print it</p>\n</blockquote>\n\n<p>Why? Shouldn't output <em>y</em> or <code>[putChar 'y']</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462807189, "post_id": 37119229, "comment_id": 61779941, "body": "1: parameters of your <code>g</code> function, 2. <code>const x = \\y -&gt; x</code>"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 1, "creation_date": 1462816759, "post_id": 37119929, "comment_id": 61785659, "body": "But isn&#39;t g&#39;s type only <code>g :: Int -&gt; (Int -&gt; [Int]) -&gt; Int -&gt; [Int]</code> so <code>x :: Int</code> , <code>f :: Int -&gt; [Int]</code> and <code>lst :: Int</code>? Because <code>gcd</code> should take as aruguments two integers in <code>gcd x lst</code>. And I am still wondering how the foldr works with the <code>const[]</code> function. Is it supposed to be some kind of and accumulator?"}, {"owner": {"reputation": 7136, "user_id": 1467115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bee3c36aa1c59317d525baabecec11?s=128&d=identicon&r=PG", "display_name": "Jan Gerlinger", "link": "https://stackoverflow.com/users/1467115/jan-gerlinger"}, "reply_to_user": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1462881619, "post_id": 37119929, "comment_id": 61814542, "body": "Wow, I totally screwed the types up. Thanks for pointing it out! You are accumulating a chain of functions here."}], "tags": [], "owner": {"reputation": 7136, "user_id": 1467115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bee3c36aa1c59317d525baabecec11?s=128&d=identicon&r=PG", "display_name": "Jan Gerlinger", "link": "https://stackoverflow.com/users/1467115/jan-gerlinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1463042346, "last_edit_date": 1463042346, "creation_date": 1462808509, "answer_id": 37119929, "question_id": 37119229, "link": "https://stackoverflow.com/questions/37119229/haskell-foldl-implementation-with-foldr/37119929#37119929", "title": "Haskell foldl implementation with foldr", "body": "<p><code>foldr</code>'s type signature is this</p>\n\n<pre><code>foldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<p>This means your <code>foldr</code> applied to its 3 arguments must return a function that takes the <code>1</code> as an argument.</p>\n\n<p>So you can specialise your <code>foldr</code> to this</p>\n\n<pre><code>foldr :: (Int -&gt; (Int -&gt; [Int]) -&gt; (Int -&gt; [Int])) \n        -&gt; (Int -&gt; [Int]) \n        -&gt; [Int]\n        -&gt; (Int -&gt; [Int])\n</code></pre>\n\n<p>This means your <code>g</code> function must have the following type</p>\n\n<pre><code>g :: Int -&gt; (Int -&gt; [Int]) -&gt; Int -&gt; [Int] \n</code></pre>\n\n<p>So your parameters have the type</p>\n\n<pre><code>x   :: Int\nf    :: Int -&gt; [Int]\nlst :: Int\n</code></pre>\n\n<p>And <code>foldr</code> in its 2nd argument requires a <code>Int -&gt; [Int]</code> instead of just an <code>Int</code>, so you can't pass it the value <code>[]</code>.</p>\n\n<p>Fortunately <code>const</code> returns a function that ignores its argument and just always return a constant expression</p>\n\n<pre><code>const [] :: a -&gt; [b]\n</code></pre>\n\n<p>In your case <code>f</code> is indeed some kind of accumulator. But instead of reducing e.g. a list of values to some number, you are chaining functions here. By passing <code>1</code> to this function chain in the end, it gets evaluated and is then building the actual list you return in <code>fun</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1463690564, "last_edit_date": 1463690564, "creation_date": 1462895234, "answer_id": 37143336, "question_id": 37119229, "link": "https://stackoverflow.com/questions/37119229/haskell-foldl-implementation-with-foldr/37143336#37143336", "title": "Haskell foldl implementation with foldr", "body": "<p><code>foldr</code> is one of those weird tools like bicycles that are really easy to use once you get the hang of them but hard to learn from the start. After several years of experience, I've gotten really good at spotting problems I can solve with <code>foldr</code>, and solving them with it immediately and correctly, but it could easily take me a while to figure out what just what I've done in enough detail to explain!</p>\n\n<p>From a practical standpoint, I usually think of <code>foldr</code> in vaguely continuation-passing language. Ignoring the \"simple\" case where <code>foldr</code> is only applied to three arguments, an application of <code>foldr</code> looks like this:</p>\n\n<pre><code>foldr go finish xs acc1 acc2 ... where\n  finish acc1 acc2 ... = ?\n  go x cont acc1 acc2 ... = ?\n</code></pre>\n\n<p><code>acc1</code>, etc., are accumulators passed \"from left to right\". The result consists, conceptually, of a single value passed \"from right to left\".</p>\n\n<p><code>finish</code> gets the final values of the accumulators and produces something of the result type. It's usually the easiest part to write because</p>\n\n<pre><code>foldr go finish [] acc1 acc2 ...\n=\nfinish acc1 acc2 ...\n</code></pre>\n\n<p>So once you figure out just what you want your fold to produce, writing <code>finish</code> is fairly mechanical.</p>\n\n<p><code>go</code> gets a single container element, a \"continuation\", and the accumulators. It passes modified values if those accumulators \"forward\" to the continuation to get a result, and uses that result to construct its own.</p>\n\n<p><code>foldl</code> is a particularly simple case because its <code>go</code> function just returns the result it gets from folding the rest of the container with a new accumulator argument. I think it's a bit more instructive to look at an example that does a bit more. Here's one that takes a container of numbers and produces a list of pairs representing a running sum and a running product.</p>\n\n<pre><code>sumsProducts :: (Num n, Foldable f) =&gt; f n -&gt; [(n, n)]\nsumsProducts xs = foldr go finish xs 0 1\n  where\n    finish total prod = [(total, prod)]\n    go x cont total prod =\n      (total, prod) : cont (x + total) (x * prod) \n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "accepted_answer_id": 37143336, "answer_count": 2, "score": 2, "last_activity_date": 1463690564, "creation_date": 1462806495, "last_edit_date": 1495539844, "question_id": 37119229, "link": "https://stackoverflow.com/questions/37119229/haskell-foldl-implementation-with-foldr", "title": "Haskell foldl implementation with foldr", "body": "<p>I have troubles understanding the implementation of the <code>foldl</code> function using <code>foldr</code>. I have read this question (<a href=\"https://stackoverflow.com/questions/6172004/writing-foldl-using-foldr\">Writing foldl using foldr</a>) and I still have some things I don't understand in the following example:</p>\n\n<pre><code>fun :: [Int] -&gt; [Int]\nfun l = foldr g (const []) l 1\n    where g x f lst = if gcd x lst == 1 then x : f x else f lst\n</code></pre>\n\n<p>The function takes a list as parameter and return another list where <code>gcd(l[i], l[i + 1] = 1</code>.</p>\n\n<p>My questions are the following:<br>\n1. Who are <code>x</code>, <code>f</code> and <code>lst</code><br>\n2. What is <code>const[]</code> and why I can't use the <code>id</code> function?</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 3065, "user_id": 2080298, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/ETx0q.jpg?s=128&g=1", "display_name": "DonnellyOverflow", "link": "https://stackoverflow.com/users/2080298/donnellyoverflow"}, "edited": false, "score": 0, "creation_date": 1462807577, "post_id": 37119142, "comment_id": 61780213, "body": "OK, so f 3 [1,2] will go to the recursive case and give f 3 [2], which will go to the recursive case which will be f 3 [] which will return an empty set? and the f 3 [1,2,3,4,5] will do the same until it gets to f 3 [3,4,5] which will return [3]? Is that right?"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 3065, "user_id": 2080298, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/ETx0q.jpg?s=128&g=1", "display_name": "DonnellyOverflow", "link": "https://stackoverflow.com/users/2080298/donnellyoverflow"}, "edited": false, "score": 0, "creation_date": 1462807747, "post_id": 37119142, "comment_id": 61780355, "body": "almost but not there yet, you forgot that <code>y :</code> is appending elements to the result."}, {"owner": {"reputation": 3065, "user_id": 2080298, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/ETx0q.jpg?s=128&g=1", "display_name": "DonnellyOverflow", "link": "https://stackoverflow.com/users/2080298/donnellyoverflow"}, "edited": false, "score": 0, "creation_date": 1462808119, "post_id": 37119142, "comment_id": 61780626, "body": "I&#39;m not sure how it would terminate if no elements are removed?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1462808210, "post_id": 37119142, "comment_id": 61780684, "body": "Each recursive case is smaller than the last: <code>ys</code> has strictly fewer elements than <code>(y:ys)</code>."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1462808223, "post_id": 37119142, "comment_id": 61780690, "body": "remember two terminal states.  either nothing left or value matches a list element."}, {"owner": {"reputation": 3065, "user_id": 2080298, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/ETx0q.jpg?s=128&g=1", "display_name": "DonnellyOverflow", "link": "https://stackoverflow.com/users/2080298/donnellyoverflow"}, "edited": false, "score": 0, "creation_date": 1462808512, "post_id": 37119142, "comment_id": 61780863, "body": "So where the the y appended?"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1462809151, "last_edit_date": 1462809151, "creation_date": 1462806248, "answer_id": 37119142, "question_id": 37118832, "link": "https://stackoverflow.com/questions/37118832/understanding-haskell/37119142#37119142", "title": "Understanding Haskell", "body": "<p>Probably better to pay attention to the terminal cases.  Empty list being one and head of list equals to the given element the other.  Otherwise, it's going to recursively operate until one of the two cases happens.</p>\n\n<p>By hand go over what will be the returned list for these two </p>\n\n<pre><code>f 3 [1,2]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>f 3 [1,2,3,4,5]\n</code></pre>\n\n<p>It's better to discover yourself but I guess you're not there yet.</p>\n\n<p>For  </p>\n\n<pre><code>f 3 [1,2] = 1: (f 3 [2]) = 1: 2: (f 3 []) = [1,2]\n</code></pre>\n\n<p>other one similarly</p>\n\n<pre><code>f 3 [1..5] = 1: (f 3 [2..5]) = 1: 2: (f 3 [3,4,5]) = 1: 2: [3] = [1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 3065, "user_id": 2080298, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/ETx0q.jpg?s=128&g=1", "display_name": "DonnellyOverflow", "link": "https://stackoverflow.com/users/2080298/donnellyoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462809151, "creation_date": 1462805382, "question_id": 37118832, "link": "https://stackoverflow.com/questions/37118832/understanding-haskell", "title": "Understanding Haskell", "body": "<p>Can someone help me understand how this function in Haskell works?</p>\n\n<pre><code>f :: Eq t =&gt; t -&gt; [t] -&gt; [t]\nf x [] = []\nf x (y: ys) | (x==y) = [x]\nf x (y: ys) | otherwise = y : f x ys\n</code></pre>\n\n<p>My understanding so far is that the function <code>f</code> tests the equality of variable <code>t</code> and list of type <code>t</code> and returns a list of type <code>t</code>.</p>\n\n<p>If passed <code>x</code> and an empty set <code>f</code> will return an empty set.</p>\n\n<p>If passed <code>x</code> and a list where <code>y</code> heads the list <code>or</code> <code>x</code> is equal to <code>y</code> then it will return a list containing <code>x</code>.</p>\n\n<p>If passed <code>x</code> and a list where <code>y</code> heads the list <code>or</code> anything else then it will return a list headed by <code>y</code> and the contents of the list returned from a recursive call to <code>f</code> using <code>x</code> and list <code>ys</code>?</p>\n\n<p>Is that correct?</p>\n\n<p>Secondly I don't know what the equality being tested is? Is it testing to see if <code>x</code> is contained within a listor checking to see if <code>x</code> is heading the list?</p>\n\n<p>Can someone explain please?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1462797992, "post_id": 37116041, "comment_id": 61773377, "body": "Hint? Fine: if these are <a href=\"http://hackage.haskell.org/package/semigroups-0.18.1/docs/Data-List-NonEmpty.html#t:NonEmpty\" rel=\"nofollow noreferrer\">nonempty lists</a>, then you can just use the <a href=\"http://hackage.haskell.org/package/comonad-5/docs/Control-Comonad.html#v:duplicate\" rel=\"nofollow noreferrer\">duplicate</a> comonad method. (There is no real consistent way to define what the result should be for an empty list!) Seriously though, I doubt that this will help you much now, nor do I think any other answer we could give would help you as much as first reading some tutorials. I always recommend <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1462798076, "post_id": 37116041, "comment_id": 61773434, "body": "Do you know about pattern matching yet?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 6, "creation_date": 1462798641, "post_id": 37116041, "comment_id": 61773826, "body": "A slightly easier hint might be to point you towards <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\"><code>scanl</code></a> ;)"}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 2, "creation_date": 1462799612, "post_id": 37116041, "comment_id": 61774495, "body": "An even easier hint would be to look in <code>Data.List</code> for <code>inits</code> and <code>tail</code>, which is how I would actually do it."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1462799850, "post_id": 37116041, "comment_id": 61774640, "body": "Perhaps this will help: <code>[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;] == &quot;abc&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1462802819, "creation_date": 1462802819, "answer_id": 37117885, "question_id": 37116041, "link": "https://stackoverflow.com/questions/37116041/haskell-summing-up-the-elements-of-a-list/37117885#37117885", "title": "Haskell: summing up the elements of a list", "body": "<p>all those hints are fine but you probably struggle with those too</p>\n\n<p>I would suggest you start from here:</p>\n\n<pre><code>sumList [] = []\nsumList [x] = [[x]]\nsumList (x:xs) = ... : map (...) (sumList xs)\n</code></pre>\n\n<p>and try to figure out what you have to put into both <code>...</code> (<strong>hint</strong> not the same ;))</p>\n\n<p>the first line is only there to give some reasonable result for an empty list as input - you could remove it (recursion should not hit it)</p>\n\n<p>The second one will do <code>[1] -&gt; [[1]]</code></p>\n\n<p>Now you have to figure out what to do with more - here is an additional hint:</p>\n\n<pre><code>sumList [1,2]\n{ 3. line - x = 1, xs = [2] }\n= ... : map (...) (sumList [2])\n{ 2. line }\n= ... : map (...) [[2]]\n</code></pre>\n\n<p>now you <em>want</em></p>\n\n<pre><code>= [[1],[1,2]]\n</code></pre>\n\n<p>so it look like you can do this with</p>\n\n<pre><code>first ... = [1]\nsecond ... = map (prepend 1) to every list in [[2]]\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6307484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5b72ed4f2a61899601cbf5ac63c6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Janet2001", "link": "https://stackoverflow.com/users/6307484/janet2001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 37117885, "answer_count": 1, "score": 1, "last_activity_date": 1462802819, "creation_date": 1462797414, "last_edit_date": 1462797801, "question_id": 37116041, "link": "https://stackoverflow.com/questions/37116041/haskell-summing-up-the-elements-of-a-list", "title": "Haskell: summing up the elements of a list", "body": "<p>I have to sum up the elements of a list like this for example:\nif your input is <code>['a','b','c']</code>, the output should be <code>[\"a\",\"ab\",\"abc\"]</code>.\nBut I have no idea how to code this... could somebody give me a hint?\nI would be very grateful!</p>\n"}, {"tags": ["haskell", "data-structures", "types"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462798917, "post_id": 37115734, "comment_id": 61774025, "body": "In some cases, GADTs can help. Dependent types could do everything, but they are not supported in Haskell (and they require a non trivial effort from the programmer)."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1462806077, "post_id": 37115734, "comment_id": 61779192, "body": "&quot;require non-trivial effort&quot; - the effort required to get a correct program is constant. The choice is where the effort manifests: in the type you declare, in the implementation you write, or just in your head. Of course the last variant is the least re-usable."}], "answers": [{"tags": [], "owner": {"reputation": 2704, "user_id": 4978205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/286541fdef1e5aad84a9bffbe2279dea?s=128&d=identicon&r=PG&f=1", "display_name": "Glubus", "link": "https://stackoverflow.com/users/4978205/glubus"}, "is_accepted": false, "score": 2, "last_activity_date": 1462797069, "creation_date": 1462797069, "answer_id": 37115910, "question_id": 37115734, "link": "https://stackoverflow.com/questions/37115734/defining-data-structures-types-in-haskell/37115910#37115910", "title": "Defining Data Structures/ Types In Haskell", "body": "<p>In the example of a sodoku, create a data type that has multiple constructors, each representing a 'rule' or semantic property.\nI.E.</p>\n\n<pre><code>data SodokuType = NotValidatedRow | InvalidRow | ValidRow\n</code></pre>\n\n<p>Now in some validation function you would return an <code>InvalidRow</code> where you detect a validation of the sodoku rules, and a <code>ValidRow</code> where you detect a successful row (or column or square etc). This allows you to pattern match as well.</p>\n\n<p>The problem you're having is that you're not using types, you're using values. You're defining a list of values, while the list does not say anything about the values it contains. </p>\n\n<p>Note that the example I used is probably not very useful as it does not contain any information about the rows position or anything like that, but you can define it yourself as you'd like.</p>\n"}], "owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462797069, "creation_date": 1462796589, "question_id": 37115734, "link": "https://stackoverflow.com/questions/37115734/defining-data-structures-types-in-haskell", "title": "Defining Data Structures/ Types In Haskell", "body": "<p>How would it possible to define a data structure in Haskell, such that there are certain constraints/rules that apply to the elements of the structure, AND be able to reflect this in the type.</p>\n\n<p>For example, if I have a type made up of a list of another type, say </p>\n\n<p>r = [x | x &lt;- input, rule1, rule2, rule3].</p>\n\n<p>In this case, the type of r is a list of elements of (type of x). But by saying this, we loose the rules. So how would it be possible to retain this extra information in the type definition.</p>\n\n<p>To give more concreteness to my question, take the sudoko case. The grid of sudoko is a list of rows, which in turn is a list of cells. But as we all know, there are constraints on the values, frequency. But when one expresses the types, these constraints don't show up in the definition of the type of the grid and row.</p>\n\n<p>Or is this not possible?</p>\n\n<p>thanks.</p>\n"}, {"tags": ["c#", "haskell", "orm", "ado.net", "dsl"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 1, "creation_date": 1462795753, "post_id": 37115390, "comment_id": 61771887, "body": "Have you tried <a href=\"https://github.com/StackExchange/dapper-dot-net\" rel=\"nofollow noreferrer\">Dapper</a>.  It&#39;s a micro ORM that basically gets rid of a lot of the boiler plate code you end up writing with ADO.Net."}, {"owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "edited": false, "score": 0, "creation_date": 1462797032, "post_id": 37115390, "comment_id": 61772749, "body": "Yep, my vote for Dapper, there where you need a lightweight microORM Dapper is the beast you&#39;re looking for. Else, if you need more complex things then just go for Linq and ADO entities."}], "owner": {"reputation": 125, "user_id": 2596349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f216090d551a7da10d849915bc3f6b2?s=128&d=identicon&r=PG", "display_name": "ForestPhoenix", "link": "https://stackoverflow.com/users/2596349/forestphoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1462795550, "creation_date": 1462795550, "question_id": 37115390, "link": "https://stackoverflow.com/questions/37115390/relational-mapper-for-c-that-keeps-the-relational-model", "title": "Relational Mapper for C# that keeps the relational model", "body": "<p>Currently my Application uses ADO.Net and manual mapping of the results.</p>\n\n<p>The reasons for that are:</p>\n\n<ul>\n<li>many ORMs seem to have rather unpredictable side-effects with lazy loading </li>\n<li>ORMs do not give a developer the power SQL can provide</li>\n<li>I dislike code thats generated in a build-step</li>\n</ul>\n\n<p>The approach to do things by hand has proven rather (too) tedious, but I was not able to find an ORM that solves these problems for C#.</p>\n\n<p>A promising appoach seems to be to map SQL to the programming language used (make an EDSL for database access).</p>\n\n<p>I found several of those projects in haskell:</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/opaleye\" rel=\"nofollow\">opaleye</a></li>\n<li><a href=\"https://hackage.haskell.org/package/haskelldb\" rel=\"nofollow\">haskelldb</a></li>\n<li>esqueleto</li>\n</ul>\n\n<p>Those projects also can add type saftey to id columns, so you cannot make a join on columns that are not actually related.</p>\n\n<p>Are there similar projects for C# that are still developed and allow POCOs (or otherwise unit-testable design)?</p>\n"}, {"tags": ["haskell", "abstract-data-type"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1462801310, "post_id": 37115373, "comment_id": 61775713, "body": "(I just noticed this <code>BinSet</code> type is useless since for strict evaluators it won&#39;t halt, and for lazy evaluators it will build huge thunks and essentially be <code>O(N)</code>. This could be fixed adding a terminal constructor.)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1462802437, "post_id": 37115373, "comment_id": 61776544, "body": "Interesting! I don&#39;t have an answer for you right now, but I&#39;ll point out that <code>NatSet</code> is equivalent to <code>Stream Bool</code> and <code>Nat</code> is the type of positions in a stream. So I think your question really boils down to <i>&quot;<code>Nat</code> is to <code>Stream</code> as <code>Tree</code> is to <code>?</code>&quot;</i> I&#39;ve also been trying to understand this sort of thing recently: see <a href=\"http://stackoverflow.com/questions/36667541/indexing-into-containers-the-mathematical-underpinnings\">my question</a> which didn&#39;t really provoke any definitive answers."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1462802698, "post_id": 37115373, "comment_id": 61776739, "body": "Thinking about it a bit more, I think your <code>Tree</code> type identifies positions in a kinda stream-like-thing where each cell could be labelled one of two ways. For want of a better name, <code>data TreeContainer a = L a (TreeContainer a) | R a (TreeContainer a)</code>, then <code>type TreeSet = TreeContainer Bool</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1462810809, "post_id": 37115373, "comment_id": 61782340, "body": "I sat down and bashed it out: <a href=\"http://pastebin.com/xcd7kbtr\" rel=\"nofollow noreferrer\">pastebin.com/xcd7kbtr</a>. It doesn&#39;t work. You were right to suspect that product types are the problem. You can&#39;t create an empty set of a product type - see line 56 of the paste. (That is, you can&#39;t give an empty <code>TreeSet</code>.) I tried adding a hacky <code>Empty</code> constructor to <code>SetF (f :* g)</code> but that broke <code>insert_</code>."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1462822155, "post_id": 37115373, "comment_id": 61788664, "body": "@BenjaminHodgson that is all so interesting, thank you! So, in short, it is illogical to look for a <code>TreeContainer</code>?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1462886955, "post_id": 37115373, "comment_id": 61818765, "body": "I wrote it up as a full answer"}], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 2, "last_activity_date": 1471353924, "last_edit_date": 1495542784, "creation_date": 1462886929, "answer_id": 37140032, "question_id": 37115373, "link": "https://stackoverflow.com/questions/37115373/is-there-any-type-algebra-function-mapping-an-adt-to-the-set-of-elements-of-that/37140032#37140032", "title": "Is there any type-algebra function mapping an ADT to the set of elements of that ADT?", "body": "<p>Let's take another look at your set type.</p>\n\n<pre><code>data NatSet = Full NatSet | Empty NatSet\n</code></pre>\n\n<p>There's always another <code>NatSet</code> inside this one; the two branches of the sum type indicate whether the current <code>Nat</code> is present in the set.  This is a <em>structural</em> representation of sets. As you observed, the structure of the set depends on the structure of the values.</p>\n\n<p>It's equivalent to a stream of Booleans: we test for membership by indexing into the stream.</p>\n\n<pre><code>data NatSet = NatSet Bool NatSet\n\nempty = NatSet False empty\n\ninsert Z (NatSet _ bs) = NatSet True bs\ninsert (S n) (NatSet b bs) = NatSet b (insert n bs)\n\n(NatSet b _) `contains` Z = b\n(NatSet _ bs) `contains` (S n) = bs `contains` n\n</code></pre>\n\n<p>Based on the insight that set membership is like indexing into a collection of Booleans, let's pursue a generic implementation of <em>sets of values of types formed as the fixed point of a polynomial functor</em> (<a href=\"https://stackoverflow.com/questions/3870088/a-monad-is-just-a-monoid-in-the-category-of-endofunctors-whats-the-issue\">what's the problem?</a>).</p>\n\n<hr>\n\n<p>First things first. As you observed, the set's structure depends on the type of the things inside it. Here's the class of things which can be elements of a set,</p>\n\n<pre><code>class El a where\n    data Set a\n    empty :: Set a\n    full :: Set a\n\n    insert :: a -&gt; Set a -&gt; Set a\n    remove :: a -&gt; Set a -&gt; Set a\n\n    contains :: Set a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>For a first example, I'll modify <code>NatSet</code> from above to suit this format.</p>\n\n<pre><code>instance El Nat where\n    data Set Nat = NatSet Bool (Set Nat)\n\n    empty = NatSet False empty\n    full = NatSet True empty\n\n    insert Z (NatSet _ bs) = NatSet True bs\n    insert (S n) (NatSet b bs) = NatSet b (insert n bs)\n\n    remove Z (NatSet _ bs) = NatSet False bs\n    remove (S n) (NatSet b bs) = NatSet b (remove n bs)\n\n    (NatSet b _) `contains` Z = b\n    (NatSet _ bs) `contains` (S n) = bs `contains` n\n</code></pre>\n\n<p>Another simple <code>El</code> instance which we'll need later is <code>()</code>. A set of <code>()</code>s is either full or empty, with nothing in between.</p>\n\n<pre><code>instance El () where\n    newtype Set () = UnitSet Bool\n    empty = UnitSet False\n    full = UnitSet True\n    insert () _ = UnitSet True\n    remove () _ = UnitSet False\n    (UnitSet b) `contains` () = b\n</code></pre>\n\n<hr>\n\n<p>The fixed point of a functor <code>f</code>,</p>\n\n<pre><code>newtype Fix f = Fix (f (Fix f))\n</code></pre>\n\n<p>in an instance of <code>El</code> whenever <code>f</code> is an instance of the following <code>El1</code> class.</p>\n\n<pre><code>class El1 f where\n    data Set1 f a\n    empty1 :: El a =&gt; Set1 f (Set a)\n    full1 :: El a =&gt; Set1 f (Set a)\n    insert1 :: El a =&gt; f a -&gt; Set1 f (Set a) -&gt; Set1 f (Set a)\n    remove1 :: El a =&gt; f a -&gt; Set1 f (Set a) -&gt; Set1 f (Set a)\n    contains1 :: El a =&gt; Set1 f (Set a) -&gt; f a -&gt; Bool\n\ninstance El1 f =&gt; El (Fix f) where\n    newtype Set (Fix f) = FixSet (Set1 f (Set (Fix f)))\n    empty = FixSet empty1\n    full = FixSet full1\n    insert (Fix x) (FixSet s) = FixSet (insert1 x s)\n    remove (Fix x) (FixSet s) = FixSet (remove1 x s)\n    (FixSet s) `contains` (Fix x) = s `contains1` x\n</code></pre>\n\n<p>As usual we'll be composing bits of functors into bigger functors, before taking the resulting functor's fixed point to produce a concrete type.</p>\n\n<pre><code>newtype I a = I a\nnewtype K c a = K c\ndata (f :* g) a = f a :* g a\ndata (f :+ g) a = L (f a) | R (g a)\ntype N = K ()\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>type Nat = Fix (N :+ N)\ntype Tree = Fix (N :+ (I :* I))\n</code></pre>\n\n<p>Let's make sets of these things.</p>\n\n<p><code>I</code> (for <em>identity</em>) is the location in the polynomial where <code>Fix</code> will plug in the recursive substructure. We can just delegate its implementation of <code>El_</code> to <code>Fix</code>'s.</p>\n\n<pre><code>instance El1 I where\n    newtype Set1 I a = ISet1 a\n    empty1 = ISet1 empty\n    full1 = ISet1 full\n    insert1 (I x) (ISet1 s) = ISet1 (insert x s)\n    remove1 (I x) (ISet1 s) = ISet1 (remove x s)\n    (ISet1 s) `contains1` (I x) = s `contains` x\n</code></pre>\n\n<p>The constant functor <code>K c</code> features no recursive substructure, but it does feature a value of type <code>c</code>. If <code>c</code> can be put in a set, <code>K c</code> can be too.</p>\n\n<pre><code>instance El c =&gt; El1 (K c) where\n    newtype Set1 (K c) a = KSet1 (Set c)\n    empty1 = KSet1 empty\n    full1 = KSet_ full\n    insert1 (K x) (KSet1 s) = KSet1 (insert x s)\n    remove1 (K x) (KSet1 s) = KSet1 (remove x s)\n    (KSet1 s) `contains1` (K x) = s `contains` x\n</code></pre>\n\n<p>Note that this definition makes <code>Set1 N</code> isomorphic to <code>Bool</code>.</p>\n\n<p>For sums, let's use our intuition that testing for membership is like indexing. When you index into a tuple, you choose between the left-hand and right-hand members of the tuple.</p>\n\n<pre><code>instance (El1 f, El1 g) =&gt; El1 (f :+ g) where\n    data Set1 (f :+ g) a = SumSet1 (Set1 f a) (Set1 g a)\n    empty1 = SumSet1 empty1 empty1\n    full1 = SumSet1 full1 full1\n    insert1 (L x) (SumSet1 l r) = SumSet1 (insert1 x l) r\n    insert1 (R y) (SumSet1 l r) = SumSet1 l (insert1 y r)\n    remove1 (L x) (SumSet1 l r) = SumSet1 (remove1 x l) r\n    remove1 (R y) (SumSet1 l r) = SumSet1 l (remove1 y r)\n    (SumSet1 l r) `contains1` (L x) = l `contains1` x\n    (SumSet1 l r) `contains1` (R y) = r `contains1` y\n</code></pre>\n\n<p>This is now enough to do sets of natural numbers. With appropriate instances of <code>Show</code>, you can do this:</p>\n\n<pre><code>ghci&gt; let z = Fix (L (K ()))\nghci&gt; let s n = Fix (R (I n))\nghci&gt; insert (s z) empty `contains` z\nFalse\nghci&gt; insert (s z) empty `contains` (s z)\nTrue\nghci&gt; empty :: Set (Fix (N :+ I))\nFixSet (SumSet1 (KSet1 (UnitSet False)) (ISet1 (FixSet (  -- to infinity and beyond\n</code></pre>\n\n<hr>\n\n<p>I still haven't answered your original question, which was <em>how should this work for product types</em>? I can think of a few strategies, but none of them actually work.</p>\n\n<p>We could make <code>Set1 (f :* g) a</code> a sum type. This has a pleasing symmetry: sets of sums are products, and sets of products are sums. In the context of the indexing idea, this is like saying \"in order to get a <code>Bool</code> out of the set, you have to give an index to handle each of the two possible cases\", rather like <code>Either a b</code>'s elimination rule <code>(a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c</code>. However, you get stuck when you try to come up with meaningful values for <code>empty1</code> and <code>full1</code>:</p>\n\n<pre><code>instance (El1 f, El1 g) =&gt; El1 (f :* g) where\n    data Set1 (f :* g) a = LSet1 (Set1 f a) | RSet1 (Set1 g a)\n    insert1 (l :* r) (LSet1 x) = LSet1 (insert1 l x)\n    insert1 (l :* r) (RSet1 y) = RSet1 (insert1 r y)\n    remove1 (l :* r) (LSet1 x) = LSet1 (remove1 l x)\n    remove1 (l :* r) (RSet1 y) = RSet1 (remove1 r y)\n    (LSet1 x) `contains1` (l :* r) = x `contains1` l\n    (RSet1 y) `contains1` (l :* r) = y `contains1` r\n    empty1 = _\n    full1 = _\n</code></pre>\n\n<p>You could try adding hacky <code>Empty</code> and <code>Full</code> constructors to <code>Set1 (f :* g)</code> but then you'd struggle to implement <code>insert1</code> and <code>remove1</code>.</p>\n\n<p>You could interpret a set of a product type as a pair of the sets of the two halves of the product. An item is in the set if both of its halves are in their respective sets. Like a sort of generalised intersection.</p>\n\n<pre><code>instance (El1 f, El1 g) =&gt; El1 (f :* g) where\n    data Set1 (f :* g) a = ProdSet1 (Set1 f a) (Set1 g a)\n    insert1 (l :* r) (ProdSet1 s t) = ProdSet1 (insert1 l s) (insert1 r t)\n    remove1 (l :* r) (ProdSet1 s t) = ProdSet1 (remove1 l s) (remove1 r t)\n    (ProdSet1 s t) `contains1` (l :* r) = (s `contains1` l) &amp;&amp; (t `contains1` r)\n    empty1 = ProdSet1 empty1 empty1\n    full1 = ProdSet1 full1 full1\n</code></pre>\n\n<p>But this implementation doesn't work correctly. Observe:</p>\n\n<pre><code>ghci&gt; let tip = Fix (L (K ()))\nghci&gt; let fork l r = Fix (R (I l :* I r))\nghci&gt; let s1 = insert (fork tip tip) empty\nghci&gt; let s2 = remove (fork tip (fork tip tip)) s1\nghci&gt; s2 `contains` (fork tip tip)\nFalse\n</code></pre>\n\n<p>Removing <code>fork tip (fork tip tip)</code> also removed <code>fork tip tip</code>. <code>tip</code> got removed from the left-hand half of the set, which meant any tree whose left-hand branch is <code>tip</code> got removed with it. We removed more items than we intended. (However, if you don't need a <code>remove</code> operation on your sets, this implementation works - though that's just another disappointing asymmetry.) You could implement <code>contains</code> with <code>||</code> instead of <code>&amp;&amp;</code> but then you'll end up <em>inserting</em> more items than you intended.</p>\n\n<p>Finally, I also thought about treating a set of products as a set of sets.</p>\n\n<pre><code>data Set1 (f :* g) a = ProdSet1 (Set1 f (Set1 g a))\n</code></pre>\n\n<p>This doesn't work - try implementing any of <code>El1</code>'s methods and you'll get stuck right away.</p>\n\n<p>So at the end of the day your intuition was right. Product types are the problem. There's no meaningful structural representation of sets for product types.</p>\n\n<p>Of course, this is all academic really. Fixed points of polynomial functors have a well-defined notion of equality and ordering, so you can do what everyone else does and use <a href=\"http://downloads.haskell.org/~ghc/7.10.3/docs/html/libraries/containers-0.5.6.2/Data-Set.html\" rel=\"nofollow noreferrer\"><code>Data.Set.Set</code></a> to represent sets, even for product types. It won't have such good asymptotics, though: equality and ordering tests on such values are O(n) (where n is the size of the value), making membership operations on such sets O(n log m) (where m is the size of the set) because the set itself is represented as a balanced tree. Contrast with our generic structural sets, where membership operations are O(n).</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 2, "accepted_answer_id": 37140032, "answer_count": 1, "score": 2, "last_activity_date": 1471353924, "creation_date": 1462795507, "question_id": 37115373, "link": "https://stackoverflow.com/questions/37115373/is-there-any-type-algebra-function-mapping-an-adt-to-the-set-of-elements-of-that", "title": "Is there any type-algebra function mapping an ADT to the set of elements of that ADT?", "body": "<p>For some simple ADTs, we can obtain the ADT of sets of that ADT as <code>data Set = Full Set (*repeated N times) | Empty Set(*repeated N times)</code>, where N is the number of non terminal constructors of that ADT. For a more solid example, take <code>Nat</code>:</p>\n\n<pre><code>data Nat = Succ Nat | Zero\n</code></pre>\n\n<p>We can obtain a type for sets of nats as follows:</p>\n\n<pre><code>data NatSet = Full NatSet | Empty NatSet\n</code></pre>\n\n<p>So, for example,</p>\n\n<pre><code>empty :: NatSet\nempty = Empty empty\n\ninsert :: Nat -&gt; NatSet -&gt; NatSet\ninsert Zero (Empty natverse)       = Full natverse\ninsert Zero (Full natverse)        = Full natverse\ninsert (Succ nat) (Empty natverse) = Empty (insert nat natverse)\ninsert (Succ nat) (Full natverse)  = Full (insert nat natverse)\n\nmember :: Nat -&gt; NatSet -&gt; Bool \nmember Zero (Full natverse)        = True\nmember Zero (Empty natverse)       = False\nmember (Succ nat) (Empty natverse) = member nat natverse\nmember (Succ nat) (Full natverse)  = member nat natverse\n\nmain = do\n    let set = foldr insert empty [Zero, Succ (Succ Zero), Succ (Succ (Succ (Succ (Succ Zero))))]\n    print $ member Zero set\n    print $ member (Succ Zero) set\n    print $ member (Succ (Succ Zero)) set\n    print $ member (Succ (Succ (Succ Zero))) set\n    print $ member (Succ (Succ (Succ (Succ Zero)))) set\n    print $ member (Succ (Succ (Succ (Succ (Succ Zero))))) set\n</code></pre>\n\n<p>For other types, it is equally simple:</p>\n\n<pre><code>data Bin = A Bin | B Bin | C\ndata BinSet = Empty BinSet BinSet | Full BinSet BinSet\n</code></pre>\n\n<p>But what about types that branch? It isn't obvious to me:</p>\n\n<pre><code>data Tree = Branch Tree Tree | Tip\ndata TreeSet = ???\n</code></pre>\n\n<p>Is there any type-algebraic argument that maps ADTs to the ADTs of sets of that type?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462795649, "post_id": 37114588, "comment_id": 61771812, "body": "It is not possible to define types locally, but maybe there&#39;s some alternative. (I don&#39;t have one at the moment)"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462796681, "post_id": 37114588, "comment_id": 61772487, "body": "Sounds like you might be interested in <code>DuplicateRecordFields</code> extension and related ones."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1462800079, "post_id": 37114588, "comment_id": 61774796, "body": "You don&#39;t have to create a new data type to pull values from JSON. See this question and both answers: <a href=\"http://stackoverflow.com/q/35816074/1176156\">stackoverflow.com/q/35816074/1176156</a>"}, {"owner": {"reputation": 113, "user_id": 5532935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f9f7776476d9787e71931078a981718?s=128&d=identicon&r=PG&f=1", "display_name": "uuhan", "link": "https://stackoverflow.com/users/5532935/uuhan"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462835132, "post_id": 37114588, "comment_id": 61794237, "body": "@jd823592 DuplicateRecordFields only avaiable in ghc8 ... Quite close to my need, but the really excited one is just the above &#39;locally defined&#39; one. It is achived in idris [<a href=\"http://docs.idris-lang.org/en/latest/tutorial/typesfuns.html#where-clauses]\" rel=\"nofollow noreferrer\">docs.idris-lang.org/en/latest/tutorial/&hellip;</a> already."}, {"owner": {"reputation": 113, "user_id": 5532935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f9f7776476d9787e71931078a981718?s=128&d=identicon&r=PG&f=1", "display_name": "uuhan", "link": "https://stackoverflow.com/users/5532935/uuhan"}, "reply_to_user": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1462835494, "post_id": 37114588, "comment_id": 61794323, "body": "@MaxGabriel nice thread."}], "owner": {"reputation": 113, "user_id": 5532935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f9f7776476d9787e71931078a981718?s=128&d=identicon&r=PG&f=1", "display_name": "uuhan", "link": "https://stackoverflow.com/users/5532935/uuhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1462793163, "creation_date": 1462793163, "question_id": 37114588, "link": "https://stackoverflow.com/questions/37114588/if-it-is-possible-to-define-locally-data-type-in-haskell", "title": "If it is possible to define locally data type in Haskell?", "body": "<p>Recentlly, I find an interesting question when I'am writing some code in haskell.</p>\n\n<p>For example, in the yesod framework, if i need to write a route to parse json parameters, I need to define a data type like this:</p>\n\n<pre><code>data Args = Args { a :: Int }\ninstance FromJSON Args where\nputSampleR :: Handler ()\nputSampleR = do\n    Args{..} &lt;- requireJsonBody\n    &lt;balabalabala&gt;\n</code></pre>\n\n<p>It works fine. \nBut it becomes pulzzled if I have a lot of these routes which need a parameters to be parsed.</p>\n\n<p>I may have Args1, Args2, Args3 and there field must be different, so \nArgs1{a1}, Args2{a2}, Args3{a3}</p>\n\n<p>It is very annoying to me.</p>\n\n<p>So, if it is possible that I write my code like this way:</p>\n\n<pre><code>putSampleR :: Handler ()\nputSampleR = do\n    Args{..} &lt;- requireJsonBody\n    &lt;balabalabala&gt;\n  where\n    data Args = Args { a :: Int }\n    instance FromJSON Args where\n</code></pre>\n\n<p>To define data variables locally?</p>\n"}, {"tags": ["haskell", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "edited": false, "score": 0, "creation_date": 1462795457, "post_id": 37114647, "comment_id": 61771695, "body": "The first example does not extract the <code>fitness</code> field of the <code>Ind</code> record. Is there any way to do that, with instances? I want to derive an instance for <code>Ord</code> as well."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "edited": false, "score": 0, "creation_date": 1462795599, "post_id": 37114647, "comment_id": 61771783, "body": "@tsorn I don&#39;t understand. If <code>x</code> is a value of type <code>Ind</code>, then <code>fitness x</code> is the value of the field. Why do you need to use classes here?"}, {"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "edited": false, "score": 0, "creation_date": 1462796800, "post_id": 37114647, "comment_id": 61772589, "body": "In the first example, <code>Dominates</code> has no instance for <code>Ind</code> and so <code>Ind</code> can&#39;t derive it. The second example works fine, but I think I need to use instance if I want to derive <code>Ord</code>. I have added another example to the top post."}, {"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "edited": false, "score": 0, "creation_date": 1462802418, "post_id": 37114647, "comment_id": 61776532, "body": "Very good, but the compiler complains that I need to make an instance (Eq Ind). Take a look at the updated post. Do you know why?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1462797742, "last_edit_date": 1462797742, "creation_date": 1462793337, "answer_id": 37114647, "question_id": 37114401, "link": "https://stackoverflow.com/questions/37114401/haskell-pattern-match-on-tuple-length-in-instances/37114647#37114647", "title": "Haskell pattern match on tuple length in instances", "body": "<p>You can provide instances for 2- and 3-tuples.</p>\n\n<pre><code>class Dominates a where\n  dominates :: a -&gt; a -&gt; bool\n\ninstance (Num a, Num b) =&gt; Dominates (a,b) where\n  dominates = dominates2 -- takes two tuples of length 2\n\ninstance (Num a, Num b, Num c) =&gt; Dominates (a,b,c) where\n  dominates = dominates3 -- takes two tuples of length 3\n</code></pre>\n\n<p>I wonder, however, if this is what you actually need. </p>\n\n<p>You could instead need pattern match on all possible cases as follows. No classes are needed here.</p>\n\n<pre><code>dominates :: Ind -&gt; Ind -&gt; Bool\ndominates (Ind{ fitnesses = I2 (a1,a2) })\n          (Ind{ fitnesses = I2 (b1,b2) }) = ...\ndominates (Ind{ fitnesses = F2 (a1,a2) })\n          (Ind{ fitnesses = F2 (b1,b2) }) = ...\ndominates (Ind{ fitnesses = I3 (a1,a2,a3) })\n          (Ind{ fitnesses = I3 (b1,b2,b3) }) = ...\ndominates (Ind{ fitnesses = F3 (a1,a2,a3) })\n          (Ind{ fitnesses = F3 (b1,b2,b3) }) = ...\ndominates _ _ = error \"incompatible Ind values!\"\n</code></pre>\n\n<hr>\n\n<p>Example:</p>\n\n<pre><code>data Ind = Ind { fitnesses :: Fits\n               , otherInfo :: String\n               }  -- no deriving Ord here, we want to define it manually\n\ninstance Ord Ind where\n  (Ind{ fitnesses = I2 x }) `compare` (Ind{ fitnesses = I2 y }) = indCmp2 x y\n  -- other cases here\n</code></pre>\n"}], "owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1462799732, "creation_date": 1462792609, "last_edit_date": 1462799732, "question_id": 37114401, "link": "https://stackoverflow.com/questions/37114401/haskell-pattern-match-on-tuple-length-in-instances", "title": "Haskell pattern match on tuple length in instances", "body": "<p>I want to create a data type which can take a tuple, of either length 2 or 3, and that should contain types deriving Num and Ord. Then, I want to pattern match on the length of this tuple in my type class instances so that I can decide which function to use based on the tuple length. Take a look at the non-compilable, pseudo-code below. There are at least two problems: </p>\n\n<ol>\n<li><blockquote>\n  <p><code>Dominates</code> is not a derivable class</p>\n</blockquote></li>\n<li><p>I don't know how to get the tuple, e.g. to call <code>fitnesses</code>, to get the variable out of the data type when pattern matching in the instance.</p></li>\n</ol>\n\n<p>Code:</p>\n\n<pre><code>data Fits = I2 (Int, Int) | F2 (Float, Float) | I3 (Int, Int, Int) | F3 (Float, Float, Float)\n\ndata Ind = Ind { fitnesses :: Fits\n               , otherInfo :: String\n               } deriving (Dominates)\n\nclass Dominates a where\n  dominates :: a -&gt; a -&gt; bool\n\ninstance Dominates Ind where\n  dominates x@(_,_) y@(_,_) = x `dominates2` y -- takes two tuples of length 2\n  dominates x@(_,_,_) y@(_,_,_) = x `dominates3` y -- takes two tuples of length 3\n</code></pre>\n\n<p>Update:</p>\n\n<pre><code>data Ind = Ind { fitnesses :: Fits\n               , otherInfo :: String\n               }\n\ninstance Eq Ind where\n  (Ind{ fitnesses = I2 x@(a1,a2) }) == (Ind{ fitnesses = I2 y@(b1,b2) }) = indCmp2 x y == EQ\ninstance Ord Ind where\n  (Ind{ fitnesses = I2 x@(a1,a2) }) `compare` (Ind{ fitnesses = I2 y@(b1,b2) }) = indCmp2 x y\n\nindCmp2 :: (Num a, Ord a) =&gt; (a, a) -&gt; (a, a) -&gt; Ordering\nindCmp2 x y\n  | a0 &lt; b0 = LT\n  | a0 &gt; b0 = GT\n  -- Can assume (fst x) == (fst y) beneath\n  | a1 &lt; b1 = LT\n  | a1 &gt; b1 = GT\n  | a1 == b1 = EQ\n  where\n    a0 = fst x\n    a1 = snd x\n    b0 = fst y\n    b1 = snd y\n</code></pre>\n\n<p>This compiles. Why is it necessary to make an instance of <code>Eq</code>, if I only want <code>Ord</code>? Without the Eq-instance the compiler complains \"no instance for (Eq Ind)\". </p>\n"}, {"tags": ["haskell", "types", "casting", "existential-type"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1462790134, "last_edit_date": 1462790134, "creation_date": 1462789878, "answer_id": 37113504, "question_id": 37112927, "link": "https://stackoverflow.com/questions/37112927/existentials-and-reusing-witness/37113504#37113504", "title": "Existentials and reusing witness", "body": "<p>Use singletons</p>\n\n<pre><code>-- singleton for some types we are interested in\ndata S a where\n   Sint  :: S Int\n   Sbool :: S Bool\n\n-- existential type, with a singleton inside\ndata T where\n   T :: S a -&gt; a -&gt; (a -&gt; Int) -&gt; T\n\n-- producer\nt :: T\nt = T Sint 3 succ\n\n-- consumer\nfoo :: T -&gt; Int\nfoo (T Sint  n     f) = f (n + 10)\nfoo (T Sbool True  f) = 23\nfoo (T Sbool False f) = f 3\n</code></pre>\n\n<p>If you need to go full monty, use <code>Typeable</code>.</p>\n\n<pre><code>data T where\n   T :: Typeable a =&gt; a -&gt; (a -&gt; Int) -&gt; T\n\n-- consumer\nfoo :: T -&gt; Int\nfoo (T x f) = case cast x of\n   Just n  -&gt; f ((n :: Int) + 10)\n   Nothing -&gt; 12   -- more casts can be attempted here\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1462790963, "post_id": 37113511, "comment_id": 61768920, "body": "that&#39;s a useful middle ground, but the consumer still has to care for all type instantiation through lexical analysis of every case. how about introducing a constraint into scope directly passing it ?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 1, "creation_date": 1462791165, "post_id": 37113511, "comment_id": 61769046, "body": "I don&#39;t really understand your question, but I will say that it&#39;s possible to make <code>Ty</code> values implicit with a hacky class: <code>class TY a where ty :: Ty a</code> and <code>instance TY Int where ty = IntTy</code>, <code>instance TY Char where ty = CharTy</code>. Then if you like you can pack up the implicit <code>TY</code> dictionary instead of the explicit <code>Ty</code> value: <code>data T where T :: TY a =&gt; { x :: a, f :: a -&gt; Int } -&gt; T</code>."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1462806542, "post_id": 37113511, "comment_id": 61779486, "body": "In my example, I statically know in the second line that <code>v</code> was produced from an <code>Int</code>. I would like to not have to enter some lexical scope by pattern matching to introduce the evidence that X = Int. but that&#39;s imposssible in general I guess as w is a value, the compiler would need to execute code to know where w comes from and introduce the corresponding constraints"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 3, "last_activity_date": 1462790333, "last_edit_date": 1462790333, "creation_date": 1462789890, "answer_id": 37113511, "question_id": 37112927, "link": "https://stackoverflow.com/questions/37112927/existentials-and-reusing-witness/37113511#37113511", "title": "Existentials and reusing witness", "body": "<p>Pack up a GADT which gives you a way to learn by pattern-matching what the existentially quantified type was. This is a way to emulate a <em>dependent pair</em> type.</p>\n\n<pre><code>data Ty a where\n    IntTy :: Ty Int\n    CharTy :: Ty Char\n\ndata T = forall a. T {\n    ty :: Ty a,\n    x :: a,\n    f :: a -&gt; Int\n}\n\nconsumeT :: T -&gt; Int\nconsumeT (T IntTy x _) = {-# GHC knows (x :: Int) in this branch #-} x + 3\nconsumeT (T CharTy x f) = {-# GHC knows (x :: Char) in this branch #-} f x + 3\n</code></pre>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1462790803, "creation_date": 1462788247, "last_edit_date": 1462790803, "question_id": 37112927, "link": "https://stackoverflow.com/questions/37112927/existentials-and-reusing-witness", "title": "Existentials and reusing witness", "body": "<p>Let's imagine I have an existential type T</p>\n\n<pre><code>T = \u2203X { a :: X,  f :: X -&gt; Int} \n</code></pre>\n\n<p>Of which I produce a value</p>\n\n<pre><code>v :: T\nv = pack {Int, { a = 0, f x =  0 } } as T\n</code></pre>\n\n<p>So :</p>\n\n<ul>\n<li><strong><em>users</em></strong> of this value are forbidden to know which type <code>X</code> is actually used in the implementation. In order to consume this value, their code <strong><em>has</em></strong> to be polymorphic in <code>X</code></li>\n<li>the implementor, on the other hand, is in full knowledge that <code>X</code> is actually an <code>Int</code> and can use the capacities of the underlying type as he wishes</li>\n</ul>\n\n<p>I would like to know if there are variant of this mechanism which do not destroy evidence :</p>\n\n<pre><code>w, v = pack {Int, { a = 0, f x =  0 } } as T\ns = unpack w v  -- recovers type information \n</code></pre>\n\n<p>where <code>w</code> would be a value level proof of the type equation tying <code>X</code> to <code>int</code>. the idea would be to selectively reuse the implementation in another part of the code, and have non polymorphic code. to have the usual existential behaviour, we can just ignore the <code>w</code> returned.</p>\n\n<p>I guess one could cast <code>X</code> to <code>Int</code> and abandon type safety, but that's another story: If I know the secret about <code>v</code>, wouldn't it make sense for me to be able to tell the secret to someone else and have the compiler verify that the secret only get used by code it has been given to.</p>\n\n<p>Has it been tried / what's the most wrong part of this?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1462786922, "post_id": 37111731, "comment_id": 61766267, "body": "Do you mean it embeds along with the html code inside <code>&lt;script&gt;</code> tags ? Note that you have the option to embed it as a separate javascript file."}, {"owner": {"reputation": 806, "user_id": 1527537, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5cac7130ae6a4029c6fc00eadc5868e6?s=128&d=identicon&r=PG", "display_name": "Joe Shanahan", "link": "https://stackoverflow.com/users/1527537/joe-shanahan"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1462794361, "post_id": 37111731, "comment_id": 61771024, "body": "Yep <code>&lt;script&gt;</code> tags - they&#39;re snippets included in a widget."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1462797409, "post_id": 37111731, "comment_id": 61773009, "body": "Then why don&#39;t you make Yesod to include your script as a separate javascript file ? Then you can live edit it in Chrome."}], "owner": {"reputation": 806, "user_id": 1527537, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5cac7130ae6a4029c6fc00eadc5868e6?s=128&d=identicon&r=PG", "display_name": "Joe Shanahan", "link": "https://stackoverflow.com/users/1527537/joe-shanahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1462784854, "creation_date": 1462784854, "question_id": 37111731, "link": "https://stackoverflow.com/questions/37111731/live-edit-javascript-in-chrome", "title": "Live edit Javascript in Chrome", "body": "<p>Since Yesod embeds Javascript on to the page, Chrome is unable to edit the Javascript live to diagnose issues that I can't reproduce locally. Is there a way to edit the javascript on a running service in Yesod? </p>\n\n<p>Chrome has the ability to edit live javascript as long as the script is coming from a standalone .js file, however Yesod embeds the js in to the page instead.</p>\n"}, {"tags": ["haskell", "system"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462770096, "post_id": 37107934, "comment_id": 61758034, "body": "use <a href=\"https://hackage.haskell.org/package/process-1.4.2.0/docs/System-Process.html#v:readProcess\" rel=\"nofollow noreferrer\"><code>readProcess</code></a> instead of <code>callCommand</code>"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1462773940, "post_id": 37108680, "comment_id": 61759338, "body": "Remark: don&#39;t use the names <code>stdout</code>, <code>stderr</code> or <code>stdin</code> if you want to use <code>System.IO</code> in the same context, since <code>System.IO</code> exports those names as <code>Handle</code> to the standard streams."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1463087212, "post_id": 37108680, "comment_id": 61927200, "body": "@jamshidh: I made a follow-up question to this answer in another post: <a href=\"http://stackoverflow.com/questions/37197388/binding-the-entire-output-of-an-ongoing-system-process-to-a-variable-in-haskell\" title=\"binding the entire output of an ongoing system process to a variable in haskell\">stackoverflow.com/questions/37197388/&hellip;</a>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1471280052, "post_id": 37108680, "comment_id": 65273148, "body": "@jamshidh Do you know <a href=\"http://stackoverflow.com/questions/38959402/how-to-use-readprocesswithexitcode\">why this command fails?</a>"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 6, "last_activity_date": 1462774037, "last_edit_date": 1462774037, "creation_date": 1462773671, "answer_id": 37108680, "question_id": 37107934, "link": "https://stackoverflow.com/questions/37107934/binding-the-result-of-a-system-command-to-a-variable-in-haskell/37108680#37108680", "title": "Binding the result of a system command to a variable in Haskell", "body": "<p>Here is some working code:</p>\n\n<pre><code>import System.Process\n\nmain :: IO ()\nmain = do\n  let stdin' = \"\"\n  (errCode, stdout', stderr') &lt;- readProcessWithExitCode \"echo\" [\"hi\"] stdin'\n  putStrLn $ \"stdout: \" ++ stdout'\n  putStrLn $ \"stderr: \" ++ stderr'\n  putStrLn $ \"errCode: \" ++ show errCode\n</code></pre>\n\n<p>As Carsten notes, you can use readProcess, but I prefer this version because with any serious usage, you will soon be very confused as to why your command is silently failing (if you run in the command line, both stdout and stderr are, of course, shown).</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1462778673, "last_edit_date": 1462778673, "creation_date": 1462778100, "answer_id": 37109759, "question_id": 37107934, "link": "https://stackoverflow.com/questions/37107934/binding-the-result-of-a-system-command-to-a-variable-in-haskell/37109759#37109759", "title": "Binding the result of a system command to a variable in Haskell", "body": "<p>Expanding on jamshidh's answer, if instead of getting stdout and stderr as <code>String</code> you want to get them as <code>ByteString</code> or <code>Text</code>, you can use the <a href=\"http://hackage.haskell.org/package/process-extras\" rel=\"nofollow\">process-extras</a> package.</p>\n\n<p>You can also use my <a href=\"http://hackage.haskell.org/package/process-streaming\" rel=\"nofollow\">process-streaming</a> package:</p>\n\n<pre><code>$ import System.Process.Streaming\n$ execute (piped (shell \"echo foo\")) (liftA3 (,,) (foldOut intoLazyBytes)    \n                                                  (foldErr intoLazyBytes)\n                                                  exitCode)\n(\"foo\\n\",\"\",ExitSuccess)\n</code></pre>\n\n<p>Also for <code>Text</code>:</p>\n\n<pre><code>$ import System.Process.Streaming.Text\n$ execute (piped (shell \"echo foo\")) (liftA3 (,,) (foldOut (transduce1 utf8x intoLazyText)) \n                                                  (foldErr (transduce1 utf8x intoLazyText)) \n                                                  exitCode)\n(\"foo\\n\",\"\",ExitSuccess)\n</code></pre>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 4, "accepted_answer_id": 37108680, "answer_count": 2, "score": 5, "last_activity_date": 1462778673, "creation_date": 1462769616, "question_id": 37107934, "link": "https://stackoverflow.com/questions/37107934/binding-the-result-of-a-system-command-to-a-variable-in-haskell", "title": "Binding the result of a system command to a variable in Haskell", "body": "<p>How does one run a system command in Haskell <strong>and</strong> bind it's result (i.e., standard output) to a variable? In pseudo-haskell I'm looking for something like the following:</p>\n\n<pre><code>import System.Process\n\nmain = do output &lt;- callCommand \"echo hi\"\n          putStrLn output -- result: \"hi\"\n</code></pre>\n\n<p>This does not work. Is there something similar that does?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "edited": false, "score": 0, "creation_date": 1462739665, "post_id": 37104529, "comment_id": 61751139, "body": "The best SO question doesn&#39;t handle this issue: <a href=\"http://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign\" title=\"haskell difference between dot and dollar sign\">stackoverflow.com/questions/940382/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462740248, "post_id": 37104529, "comment_id": 61751310, "body": "It&#39;s just a low-precedence infix operator. You get an error about this for the same reason <code>3 * 5 + 7</code> means <code>(3*5) + 7</code> rather than <code>3 * (5+7)</code>."}, {"owner": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462740506, "post_id": 37104529, "comment_id": 61751387, "body": "@DanielWagner can you please define an &#39;infix operator&#39; as you understand the term?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1462741380, "post_id": 37104529, "comment_id": 61751651, "body": "<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4\" rel=\"nofollow noreferrer\">The Report</a> is the canonical reference. Any sequence of symbols is an infix operator."}], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "edited": false, "score": 1, "creation_date": 1462741215, "post_id": 37104661, "comment_id": 61751594, "body": "This is a good clarification of Learn You a Haskell&#39;s explanation:  &quot;you can imagine a $ being sort of the equivalent of writing an opening parentheses and then writing a closing one on the far right side of the expression.&quot;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "edited": false, "score": 5, "creation_date": 1462742051, "post_id": 37104661, "comment_id": 61751852, "body": "While we&#39;re quoting LYAH, I should also mention &quot;[functions] are rarely used with the applicative style outside of code golf&quot;. It&#39;s clever, concise, and barely readable :)"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1462757716, "post_id": 37104661, "comment_id": 61755518, "body": "@chepner It&#39;s sort of readable if you think of it as the <code>Reader</code> monad."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1462741789, "last_edit_date": 1462741789, "creation_date": 1462740515, "answer_id": 37104661, "question_id": 37104529, "link": "https://stackoverflow.com/questions/37104529/dollar-sign-not-allowed-in-place-of-parentheses/37104661#37104661", "title": "$ Dollar Sign Not Allowed in Place of Parentheses", "body": "<p><code>$</code> has extremely low precedence, lower than <code>==</code>, lower than <em>everything</em>. Your attempt is parsed as</p>\n\n<pre><code>isInteger x = (x == fromInteger) $ (round x)\n</code></pre>\n\n<p>that is, it attempts to apply a <code>Bool</code> as a function. You could write</p>\n\n<pre><code>isInteger x = x == (fromInteger $ round x)\n</code></pre>\n\n<p>but that doesn't really save any parentheses; it just shifts them.</p>\n\n<hr>\n\n<p>If you <em>really</em> want to get rid of the parentheses (or at least, really move them aside), you can take advantage of the fact that <code>(-&gt; r)</code> is an applicative functor, which in brief means that <code>f &lt;*&gt; g == \\x -&gt; f x (g x)</code>. Replacing <code>f</code> with <code>(==)</code> and <code>g</code> with <code>fromInteger . round</code>, you get</p>\n\n<pre><code>isInteger = (==) &lt;*&gt; fromInteger . round\n</code></pre>\n\n<p>because</p>\n\n<pre><code>x == fromInteger (round x) -&gt; (==) x (fromInteger (round x))\n                           -&gt; (==) x ((fromInteger . round) x)\n                              ----    ---------------------\n                               f   x (          g           x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": false, "score": 1, "last_activity_date": 1462741091, "last_edit_date": 1462741091, "creation_date": 1462740561, "answer_id": 37104665, "question_id": 37104529, "link": "https://stackoverflow.com/questions/37104529/dollar-sign-not-allowed-in-place-of-parentheses/37104665#37104665", "title": "$ Dollar Sign Not Allowed in Place of Parentheses", "body": "<p>This is the beginning of the accepted answer in the question you linked in the comment:</p>\n\n<blockquote>\n  <p>The $ operator is for avoiding parentheses. <strong>Anything appearing after\n  it will take precedence over anything that comes before.</strong></p>\n</blockquote>\n\n<p>Taking this into account, <code>isInteger x = x == fromInteger $ round x</code> becomes <code>isInteger x = (x == fromInteger) (round x)</code>, so you're taking the result of <code>x == fromInteger</code> (which is of type <code>Bool</code>) and applying it to <code>round x</code>. This clearly doesn't make sense.</p>\n"}], "owner": {"reputation": 422, "user_id": 5298869, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153099423030036/picture?type=large", "display_name": "Trajanson", "link": "https://stackoverflow.com/users/5298869/trajanson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 37104661, "answer_count": 2, "score": 0, "last_activity_date": 1462741789, "creation_date": 1462739529, "question_id": 37104529, "link": "https://stackoverflow.com/questions/37104529/dollar-sign-not-allowed-in-place-of-parentheses", "title": "$ Dollar Sign Not Allowed in Place of Parentheses", "body": "<p>Replacing the parentheses in this function:</p>\n\n<pre><code>isInteger x = x == fromInteger (round x)\n</code></pre>\n\n<p>with a dollar sign operator:</p>\n\n<pre><code>isInteger x = x == fromInteger $ round x\n</code></pre>\n\n<p>raises an error.</p>\n\n<p>What are the limitations of using the $ operator?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1462760431, "post_id": 37103951, "comment_id": 61756028, "body": "This is nothing to do with typeclasses, is it? You can make an infinite loop with a &#39;normal&#39; function too. <code>foo x y = foo (x+1) y</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8276, "user_id": 327038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e17117063f64ef47f36ab4ee45bf3d4b?s=128&d=identicon&r=PG", "display_name": "asthasr", "link": "https://stackoverflow.com/users/327038/asthasr"}, "is_accepted": true, "score": 9, "last_activity_date": 1462735861, "creation_date": 1462735861, "answer_id": 37103993, "question_id": 37103951, "link": "https://stackoverflow.com/questions/37103951/what-is-happening-in-the-background-when-an-instance-of-a-typeclass-is-defined-w/37103993#37103993", "title": "What is happening in the background when an instance of a typeclass is defined wrongly?", "body": "<p>It's simply entering an infinite loop. You are defining <code>(==) x y</code> as <code>x == y</code>, which is equivalent to... <code>(==) x y</code>. It's as if you've said <code>f(x) = f(x)</code>.</p>\n"}], "owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 37103993, "answer_count": 1, "score": 4, "last_activity_date": 1462735861, "creation_date": 1462735637, "question_id": 37103951, "link": "https://stackoverflow.com/questions/37103951/what-is-happening-in-the-background-when-an-instance-of-a-typeclass-is-defined-w", "title": "What is happening in the background when an instance of a typeclass is defined wrongly?", "body": "<p>I was busy with an exercise in the \"Typeclasses\" chapter of <a href=\"http://haskellbook.com/\" rel=\"nofollow\">Haskell Book</a>, and I solved it as the following:</p>\n\n<pre><code>data TisAnInteger =\n  TisAn Integer\n\ninstance Eq TisAnInteger where\n  (==) (TisAn x) (TisAn y) = x == y\n</code></pre>\n\n<p>So that I can use it in GHCi REPL like:</p>\n\n<pre><code>\u03bb&gt; TisAn 9 == TisAn 9\nTrue\n\u03bb&gt; TisAn 9 == TisAn 8\nFalse\n</code></pre>\n\n<p>but while playing with it and asking \"what if?\" questions, I've realized that the following compiles, too:</p>\n\n<pre><code>data TisAnInteger =\n  TisAn Integer\n\ninstance Eq TisAnInteger where\n  (==) x y = x == y\n</code></pre>\n\n<p>and when I try to run something similar in GHCi:</p>\n\n<pre><code>\u03bb&gt; TisAn 9 == TisAn 8\nInterrupted.\n\u03bb&gt; TisAn 9 == TisAn 9\nInterrupted.\n</code></pre>\n\n<p>Well <code>Interrupted.</code> because I hit <code>Ctrl+C</code> after a few seconds, GHCi was not printing anything.</p>\n\n<p>I'm trying to understand two things:</p>\n\n<ol>\n<li>Why does it compile without any complaints? </li>\n<li>What's happening in GHCi in the background while nothing is printed at all (at least for many seconds)? Does it enter an infinite loop, etc.? (I can see that the CPU usage of ghc goes to over 90% during that time)</li>\n</ol>\n\n<p>Any hints, pointers to docs, etc. for me so that I can enhance my understanding of the above phenomenon?</p>\n"}, {"tags": ["haskell", "list-comprehension", "primes"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6307484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5b72ed4f2a61899601cbf5ac63c6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Janet2001", "link": "https://stackoverflow.com/users/6307484/janet2001"}, "edited": false, "score": 0, "creation_date": 1462740144, "post_id": 37103843, "comment_id": 61751278, "body": "Thank you I&#39;m very grateful for your help!!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1462734900, "creation_date": 1462734900, "answer_id": 37103843, "question_id": 37103662, "link": "https://stackoverflow.com/questions/37103662/programming-haskell-code-list-of-primes/37103843#37103843", "title": "programming haskell code: List of primes", "body": "<p>Suppose you had a function:</p>\n\n<pre><code>isPrime :: Int -&gt; Bool\n</code></pre>\n\n<p>which returned True for primes and False otherwise. Then you could define:</p>\n\n<pre><code>primes = [ n | n &lt;- [2..], isPrime n ]\n</code></pre>\n\n<p>Using the function <code>all</code>, you could write <code>isPrime</code> like this:</p>\n\n<pre><code>isPrime n = all (\\a -&gt; mod n a /= 0) [2..n-1]\n</code></pre>\n\n<p><code>all f xs</code> returns True if <code>f</code> applied to every member of <code>xs</code> is True. So <code>n</code> is prime if for all elements in [2..n-1], <code>mod n a /= 0</code>, i.e. a does not divide n.</p>\n\n<p>Some more examples of the <code>all</code> function:</p>\n\n<pre><code>all even [2,4,10,12]       -- True\nall (\\x -&gt; x &gt; 0) [4,-5,6] -- False\nall (\\xs -&gt; length xs &gt; 0) [ [3], [4,5], [-4] ] -- True\nall (\\x -&gt; x*x &lt; 0) []     -- True\n</code></pre>\n\n<p>You can come up with the definition of <code>all</code> yourself by using the standard template for recursion on lists:</p>\n\n<pre><code>all f []     =  ...\nall f (x:xs) =  ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1469963556, "last_edit_date": 1469963556, "creation_date": 1462913110, "answer_id": 37148656, "question_id": 37103662, "link": "https://stackoverflow.com/questions/37103662/programming-haskell-code-list-of-primes/37148656#37148656", "title": "programming haskell code: List of primes", "body": "<p>It should be <em>2 &lt;= k <strong>&lt;=</strong> n-2</em>, otherwise 4 would be prime (with the <strong><em>&lt;</em></strong>). </p>\n\n<p>Without functions, it can be written as </p>\n\n<pre><code>[n | n&lt;-[2..], []&lt;-[[i | i&lt;-[2..div n 2], rem n i==0]]]            -- or, even,\n[n | n&lt;-[2..], []&lt;-[[j | i&lt;-[2..n-2], j&lt;-[i*i, i*i+i..n], j==n]]]  -- no `i` dividing `n`\n</code></pre>\n\n<p>The last code snippet is remarkable for being both a trial division and a sieve of Eratosthenes working through addition only (becoming the true sieve when the computational redundancies are discovered and eliminated through rearrangement and sharing of repeated calculations).</p>\n\n<p>To your question specifically, <code>return</code> is out of place there. Test expressions in list comprehensions are simply expressions of type <code>Bool</code>. The <code>False</code> result means rejection of the currently generated value; <code>True</code> means acceptance &mdash; and therefore inclusion in the list of results.</p>\n\n<p>Another thing is, repeated failed testing of repeatedly generated values means <em>infinite  looping</em>, when for all values of <code>k</code> above <code>n-2</code> (generated by <code>k&lt;-[2..]</code> without end) your test <code>(k&gt;=2) &amp;&amp; (k&lt;=(n-2))</code> will <em>always fail</em> (and cause the next <code>k</code> being generated, and the next one, and the next...). </p>\n\n<p>Instead of testing, we stop the generation after <code>n-2</code> altogether, with <code>[2..n-2]</code>, so the test condition always holds <em>by construction</em> &mdash; and were it would fail, those values of <code>k</code> are not generated at all, in the first place.</p>\n"}], "owner": {"reputation": 53, "user_id": 6307484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5b72ed4f2a61899601cbf5ac63c6f1?s=128&d=identicon&r=PG&f=1", "display_name": "Janet2001", "link": "https://stackoverflow.com/users/6307484/janet2001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 37103843, "answer_count": 2, "score": 1, "last_activity_date": 1469963556, "creation_date": 1462733845, "last_edit_date": 1462961392, "question_id": 37103662, "link": "https://stackoverflow.com/questions/37103662/programming-haskell-code-list-of-primes", "title": "programming haskell code: List of primes", "body": "<p>My task is to create a list of primes but only with the following information:</p>\n\n<p>-The list has to be infinite<br>\n-I have to check up primes for <code>n &gt; 1</code><br>\n-If there is a variable <code>2 &lt;= k &lt; n-2</code>, which divides <code>n</code>,then it is no prime, if it does not divide <code>n</code>, it is<br>\n-No function!</p>\n\n<p>So I started writing a code like this:</p>\n\n<pre><code>primes = [n| n&lt;-[2,3..],k&lt;-[2,3..], if (k&gt;=2) &amp;&amp; (k&lt;=(n-2))\n            then if n `mod` k /= 0 then n else return ()\n            else return ()  ]\n</code></pre>\n\n<p>But then appears the following error : \"Couldn't match expected type \u2018Bool\u2019 with actual type\"  </p>\n\n<p>It's because of the <code>return ()</code>, but I don't know how to replace this <code>return</code>.</p>\n\n<p>I hope for help.</p>\n"}, {"tags": ["haskell", "prolog"], "comments": [{"owner": {"reputation": 10335, "user_id": 772868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dt3Kv.jpg?s=128&g=1", "display_name": "false", "link": "https://stackoverflow.com/users/772868/false"}, "edited": false, "score": 2, "creation_date": 1462738245, "post_id": 37103620, "comment_id": 61750693, "body": "Well, what do you expect? Tell which goals you expect to succeed or fail."}, {"owner": {"reputation": 9494, "user_id": 988283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/539251bc88379bc1f60805a7701c1afd?s=128&d=identicon&r=PG", "display_name": "colymore", "link": "https://stackoverflow.com/users/988283/colymore"}, "reply_to_user": {"reputation": 10335, "user_id": 772868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dt3Kv.jpg?s=128&g=1", "display_name": "false", "link": "https://stackoverflow.com/users/772868/false"}, "edited": false, "score": 0, "creation_date": 1462738333, "post_id": 37103620, "comment_id": 61750720, "body": "I writed a example in my question, an input and output. I am expecting that."}, {"owner": {"reputation": 10335, "user_id": 772868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dt3Kv.jpg?s=128&g=1", "display_name": "false", "link": "https://stackoverflow.com/users/772868/false"}, "edited": false, "score": 3, "creation_date": 1462738746, "post_id": 37103620, "comment_id": 61750848, "body": "Put the <b>concrete</b> goals that you tried. Otherwise this is guesswork only"}, {"owner": {"reputation": 9494, "user_id": 988283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/539251bc88379bc1f60805a7701c1afd?s=128&d=identicon&r=PG", "display_name": "colymore", "link": "https://stackoverflow.com/users/988283/colymore"}, "reply_to_user": {"reputation": 10335, "user_id": 772868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dt3Kv.jpg?s=128&g=1", "display_name": "false", "link": "https://stackoverflow.com/users/772868/false"}, "edited": false, "score": 0, "creation_date": 1462739012, "post_id": 37103620, "comment_id": 61750942, "body": "I edit with my input and the result i&#39;m having."}, {"owner": {"reputation": 10335, "user_id": 772868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dt3Kv.jpg?s=128&g=1", "display_name": "false", "link": "https://stackoverflow.com/users/772868/false"}, "edited": false, "score": 3, "creation_date": 1462739078, "post_id": 37103620, "comment_id": 61750963, "body": "The trace is not helpful. But the query <b>is</b> helpful. Now say what you expect and what you get (failure/loop etc)."}, {"owner": {"reputation": 10335, "user_id": 772868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dt3Kv.jpg?s=128&g=1", "display_name": "false", "link": "https://stackoverflow.com/users/772868/false"}, "edited": false, "score": 2, "creation_date": 1462739211, "post_id": 37103620, "comment_id": 61751006, "body": "And: Reduce the size of your example. I am sure you can give a smaller one."}], "answers": [{"comments": [{"owner": {"reputation": 39597, "user_id": 1613573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcY5m.jpg?s=128&g=1", "display_name": "mat", "link": "https://stackoverflow.com/users/1613573/mat"}, "edited": false, "score": 3, "creation_date": 1462745123, "post_id": 37105150, "comment_id": 61752696, "body": "You don&#39;t need <code>append&#47;3</code> here at all. Simply write a goal like <code>Ls = [c(A,B)|Ls0]</code> to state that <code>Ls</code> is a list whose first element is <code>c(A,B)</code> and whose rest is <code>Ls0</code>. More generally, you never need <code>append&#47;3</code> to <i>prepend known elements</i> to a list. Simply write them down like before, using unification directly."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1462743921, "creation_date": 1462743921, "answer_id": 37105150, "question_id": 37103620, "link": "https://stackoverflow.com/questions/37103620/convert-haskell-function-to-prolog-error/37105150#37105150", "title": "Convert haskell function to prolog error", "body": "<p>My Prolog is a bit rusty, but here is what I see:</p>\n\n<pre><code>llenaPares(A,B,[], RES).\n                   ^^^^ shouldn't this be []?\n</code></pre>\n\n<p>In:</p>\n\n<pre><code>llenaPares(A,B,[c(C,D)|YS], RES) :-\n        A &lt; C,\n        append([c(A,B)], RES, SOL),\n        sum(A,1,SIG),\n        llenaPares(SIG,B,[c(C,D)|YS],SOL).\n</code></pre>\n\n<p>shouldn't RES be a larger list than SOL? I think you need to swap them in the <code>append</code> call.</p>\n\n<p>Finally, instead of <code>C &gt;= A</code> (which is almost the same as <code>A &lt; C</code>) I think you want <code>A &gt;= C</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 10335, "user_id": 772868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/dt3Kv.jpg?s=128&g=1", "display_name": "false", "link": "https://stackoverflow.com/users/772868/false"}, "is_accepted": false, "score": 3, "last_activity_date": 1462887267, "last_edit_date": 1462887267, "creation_date": 1462817908, "answer_id": 37122766, "question_id": 37103620, "link": "https://stackoverflow.com/questions/37103620/convert-haskell-function-to-prolog-error/37122766#37122766", "title": "Convert haskell function to prolog error", "body": "<p>To emulate your program as faithfully as possible:</p>\n\n<pre><code>:- use_module(library(clpfd)).\n\nllenaPares(_, [], []).\nllenaPares((A,B), [(C,D)|Ys], [P|Ps]) :-\n        A #&lt; C,  P = (A,B), Ap #= A+1, llenaPares( (Ap,B), [(C,D)|Ys], Ps)\n      ; A #&gt;= C, P = (C,D), Cp #= C+1, llenaPares( (Cp,D), Ys, Ps).\n</code></pre>\n\n<p>This works with SICStus or SWI.  Now we can use the relation to \"compute the inputs\":</p>\n\n<pre><code>?- llenaPares(P, Ys, [(0,0),(1,8),(2,8),(3,8),(4,8),(5,0),(6,4),(7,4),(8,4),(9,4),(10,0),(11,10),(12,0)]).\n   P =  (0,0),\n   Ys = [(1,8),(5,0),(6,4),(10,0),(11,10),(12,0)]\n;  P =  (0,0),\n   Ys = [(1,8),(5,0),(6,4),(9,4),(10,0),(11,10),(12,0)]\n;  P =  (0,0),\n   Ys = [(1,8),(5,0),(6,4),(8,4),(10,0),(11,10),(12,0)]\n;  ...\n</code></pre>\n\n<p>So here the \"result\" is given, and we ask for all \"inputs\" <code>Ys</code> that\nwould lead to that result.</p>\n\n<p>Or we may simply ask what this relation is about:</p>\n\n<pre><code>?- length(Ps, N), llenaPares(P, Ys, Ps).\n   Ps = [],\n   N = 0,\n   Ys = []\n;  Ps = [(_A,_B)],\n   N = 1,\n   P = (_C,_D), Ys = [(_A,_B)],\n   _E#=_A+1, _A#=&lt;_C, _A in inf..sup, _C in inf..sup, _E in inf..sup\n;  Ps = [(_A,_B),(_C,_D)],\n   N = 2,\n   P = (_A,_B),\n   Ys = [(_C,_D)],\n   _E#=_A+1, _F#=_C+1, _C#=&lt;_E, _C#&gt;=_A+1, _C in inf..sup, _A in inf..sup, _E in inf..sup,_F in inf..sup\n;  ...\n</code></pre>\n"}], "owner": {"reputation": 9494, "user_id": 988283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/539251bc88379bc1f60805a7701c1afd?s=128&d=identicon&r=PG", "display_name": "colymore", "link": "https://stackoverflow.com/users/988283/colymore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 37105150, "answer_count": 2, "score": 2, "last_activity_date": 1462887267, "creation_date": 1462733613, "last_edit_date": 1462738881, "question_id": 37103620, "link": "https://stackoverflow.com/questions/37103620/convert-haskell-function-to-prolog-error", "title": "Convert haskell function to prolog error", "body": "<p>i'm trying to convert this haskell function</p>\n\n<pre><code>llenaPares _ [] = []\nllenaPares (a,b) ((c,d):ys)\n      | a &lt; c     = (a,b) : llenaPares (a+1,b) ((c,d):ys)\n      | otherwise = (c,d) : llenaPares (c+1,d) ys\n</code></pre>\n\n<p>Basically this function takes a list of tuples as argument, for example,</p>\n\n<pre><code>[(1, 8), (5, 0), (6, 4), (10, 0), (11, 10), (12, 0)]\n</code></pre>\n\n<p>and return a list from 0 to max(x) of list with each tuple pair if exists or the previous value. For example</p>\n\n<pre><code>[(1,3),(3,5),(7,9),(12,0)] will return [(0,0),(1,3),(2,3),(3,5),(4,5),(5,5),(6x9),(7,9),(8,9),(9,9),(10,9),(11,0)]\n</code></pre>\n\n<p>Im doing this in prolog</p>\n\n<pre><code>llenaPares(A,B,[], RES).\nllenaPares(A,B,[c(C,D)|YS], RES) :-\n        A &lt; C,\n        append([c(A,B)], RES, SOL),\n        sum(A,1,SIG),\n        llenaPares(SIG,B,[c(C,D)|YS],SOL).\nllenaPares(A,B,[c(C,D)|YS], RES) :-\n     C&gt;=A,\n     append([c(C,D)], RES, SOL),\n     sum(C,1,SIG),\n     llenaPares(SIG,D,YS, SOL).\n\nsum(A,B,C):-C is A+B.\n</code></pre>\n\n<p>But doesn't work.\nWhat's wrong?</p>\n\n<pre><code>?-\n|    llenaPares(0,0,[c(1,8),c(5,0),c(6,4),c(10,0),c(11,10),c(12,0)], SAL).\n   Call: (7) llenaPares(0, 0, [c(1, 8), c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], _G4798) ? creep\n   Call: (8) 0&lt;1 ? creep\n   Exit: (8) 0&lt;1 ? creep\n   Call: (8) lists:append([c(0, 0)], _G4798, _G4922) ? creep\n   Exit: (8) lists:append([c(0, 0)], _G4798, [c(0, 0)|_G4798]) ? creep\n   Call: (8) sum(0, 1, _G4925) ? creep\n   Call: (9) _G4926 is 0+1 ? creep\n   Exit: (9) 1 is 0+1 ? creep\n   Exit: (8) sum(0, 1, 1) ? creep\n   Call: (8) llenaPares(1, 0, [c(1, 8), c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(0, 0)|_G4798]) ? creep\n   Call: (9) 1&lt;1 ? creep\n   Fail: (9) 1&lt;1 ? creep\n   Redo: (8) llenaPares(1, 0, [c(1, 8), c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(0, 0)|_G4798]) ? creep\n   Call: (9) 1&gt;=1 ? creep\n   Exit: (9) 1&gt;=1 ? creep\n   Call: (9) lists:append([c(1, 8)], [c(0, 0)|_G4798], _G4940) ? creep\n   Exit: (9) lists:append([c(1, 8)], [c(0, 0)|_G4798], [c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (9) sum(1, 1, _G4943) ? creep\n   Call: (10) _G4944 is 1+1 ? creep\n   Exit: (10) 2 is 1+1 ? creep\n   Exit: (9) sum(1, 1, 2) ? creep\n   Call: (9) llenaPares(2, _G4945, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (10) 2&lt;5 ? creep\n   Exit: (10) 2&lt;5 ? creep\n   Call: (10) lists:append([c(2, _G4941)], [c(1, 8), c(0, 0)|_G4798], _G4952) ? creep\n   Exit: (10) lists:append([c(2, _G4941)], [c(1, 8), c(0, 0)|_G4798], [c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (10) sum(2, 1, _G4955) ? creep\n   Call: (11) _G4956 is 2+1 ? creep\n   Exit: (11) 3 is 2+1 ? creep\n   Exit: (10) sum(2, 1, 3) ? creep\n   Call: (10) llenaPares(3, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (11) 3&lt;5 ? creep\n   Exit: (11) 3&lt;5 ? creep\n   Call: (11) lists:append([c(3, _G4941)], [c(2, _G4941), c(1, 8), c(0, 0)|_G4798], _G4970) ? creep\n   Exit: (11) lists:append([c(3, _G4941)], [c(2, _G4941), c(1, 8), c(0, 0)|_G4798], [c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (11) sum(3, 1, _G4973) ? creep\n   Call: (12) _G4974 is 3+1 ? creep\n   Exit: (12) 4 is 3+1 ? creep\n   Exit: (11) sum(3, 1, 4) ? creep\n   Call: (11) llenaPares(4, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (12) 4&lt;5 ? creep\n   Exit: (12) 4&lt;5 ? creep\n   Call: (12) lists:append([c(4, _G4941)], [c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798], _G4988) ? creep\n   Exit: (12) lists:append([c(4, _G4941)], [c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798], [c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (12) sum(4, 1, _G4991) ? creep\n   Call: (13) _G4992 is 4+1 ? creep\n   Exit: (13) 5 is 4+1 ? creep\n   Exit: (12) sum(4, 1, 5) ? creep\n   Call: (12) llenaPares(5, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (13) 5&lt;5 ? creep\n   Fail: (13) 5&lt;5 ? creep\n   Redo: (12) llenaPares(5, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (13) 5&gt;=5 ? creep\n   Exit: (13) 5&gt;=5 ? creep\n   Call: (13) lists:append([c(5, 0)], [c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798], _G5006) ? creep\n   Exit: (13) lists:append([c(5, 0)], [c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798], [c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (13) sum(5, 1, _G5009) ? creep\n   Call: (14) _G5010 is 5+1 ? creep\n   Exit: (14) 6 is 5+1 ? creep\n   Exit: (13) sum(5, 1, 6) ? creep\n   Call: (13) llenaPares(6, _G5011, [c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (14) 6&lt;6 ? creep\n   Fail: (14) 6&lt;6 ? creep\n   Redo: (13) llenaPares(6, _G5011, [c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (14) 6&gt;=6 ? creep\n   Exit: (14) 6&gt;=6 ? creep\n   Call: (14) lists:append([c(6, 4)], [c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798], _G5018) ? creep\n   Exit: (14) lists:append([c(6, 4)], [c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798], [c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(..., ...)|...]) ? creep\n   Call: (14) sum(6, 1, _G5021) ? creep\n   Call: (15) _G5022 is 6+1 ? creep\n   Exit: (15) 7 is 6+1 ? creep\n   Exit: (14) sum(6, 1, 7) ? creep\n   Call: (14) llenaPares(7, _G5023, [c(10, 0), c(11, 10), c(12, 0)], [c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Call: (15) 7&lt;10 ? creep\n   Exit: (15) 7&lt;10 ? creep\n   Call: (15) lists:append([c(7, _G5019)], [c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(..., ...)|...], _G5030) ? creep\n   Exit: (15) lists:append([c(7, _G5019)], [c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(..., ...)|...], [c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(..., ...)|...]) ? creep\n   Call: (15) sum(7, 1, _G5033) ? creep\n   Call: (16) _G5034 is 7+1 ? creep\n   Exit: (16) 8 is 7+1 ? creep\n   Exit: (15) sum(7, 1, 8) ? creep\n   Call: (15) llenaPares(8, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(..., ...)|...]) ? creep\n   Call: (16) 8&lt;10 ? creep\n   Exit: (16) 8&lt;10 ? creep\n   Call: (16) lists:append([c(8, _G5019)], [c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(..., ...)|...], _G5048) ? creep\n   Exit: (16) lists:append([c(8, _G5019)], [c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(..., ...)|...], [c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(..., ...)|...]) ? creep\n   Call: (16) sum(8, 1, _G5051) ? creep\n   Call: (17) _G5052 is 8+1 ? creep\n   Exit: (17) 9 is 8+1 ? creep\n   Exit: (16) sum(8, 1, 9) ? creep\n   Call: (16) llenaPares(9, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(..., ...)|...]) ? creep\n   Call: (17) 9&lt;10 ? creep\n   Exit: (17) 9&lt;10 ? creep\n   Call: (17) lists:append([c(9, _G5019)], [c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(..., ...)|...], _G5066) ? creep\n   Exit: (17) lists:append([c(9, _G5019)], [c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(..., ...)|...], [c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(..., ...)|...]) ? creep\n   Call: (17) sum(9, 1, _G5069) ? creep\n   Call: (18) _G5070 is 9+1 ? creep\n   Exit: (18) 10 is 9+1 ? creep\n   Exit: (17) sum(9, 1, 10) ? creep\n   Call: (17) llenaPares(10, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(..., ...)|...]) ? creep\n   Call: (18) 10&lt;10 ? creep\n   Fail: (18) 10&lt;10 ? creep\n   Redo: (17) llenaPares(10, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(..., ...)|...]) ? creep\n   Call: (18) 10&gt;=10 ? creep\n   Exit: (18) 10&gt;=10 ? creep\n   Call: (18) lists:append([c(10, 0)], [c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(..., ...)|...], _G5084) ? creep\n   Exit: (18) lists:append([c(10, 0)], [c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(..., ...)|...], [c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(..., ...)|...]) ? creep\n   Call: (18) sum(10, 1, _G5087) ? creep\n   Call: (19) _G5088 is 10+1 ? creep\n   Exit: (19) 11 is 10+1 ? creep\n   Exit: (18) sum(10, 1, 11) ? creep\n   Call: (18) llenaPares(11, _G5089, [c(11, 10), c(12, 0)], [c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(..., ...)|...]) ? creep\n   Call: (19) 11&lt;11 ? creep\n   Fail: (19) 11&lt;11 ? creep\n   Redo: (18) llenaPares(11, _G5089, [c(11, 10), c(12, 0)], [c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(..., ...)|...]) ? creep\n   Call: (19) 11&gt;=11 ? creep\n   Exit: (19) 11&gt;=11 ? creep\n   Call: (19) lists:append([c(11, 10)], [c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(..., ...)|...], _G5096) ? creep\n   Exit: (19) lists:append([c(11, 10)], [c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(..., ...)|...], [c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(..., ...)|...]) ? creep\n   Call: (19) sum(11, 1, _G5099) ? creep\n   Call: (20) _G5100 is 11+1 ? creep\n   Exit: (20) 12 is 11+1 ? creep\n   Exit: (19) sum(11, 1, 12) ? creep\n   Call: (19) llenaPares(12, _G5101, [c(12, 0)], [c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(..., ...)|...]) ? creep\n   Call: (20) 12&lt;12 ? creep\n   Fail: (20) 12&lt;12 ? creep\n   Redo: (19) llenaPares(12, _G5101, [c(12, 0)], [c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(..., ...)|...]) ? creep\n   Call: (20) 12&gt;=12 ? creep\n   Exit: (20) 12&gt;=12 ? creep\n   Call: (20) lists:append([c(12, 0)], [c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(..., ...)|...], _G5108) ? creep\n   Exit: (20) lists:append([c(12, 0)], [c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(..., ...)|...], [c(12, 0), c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(..., ...)|...]) ? creep\n   Call: (20) sum(12, 1, _G5111) ? creep\n   Call: (21) _G5112 is 12+1 ? creep\n   Exit: (21) 13 is 12+1 ? creep\n   Exit: (20) sum(12, 1, 13) ? creep\n   Call: (20) llenaPares(13, _G5113, [], [c(12, 0), c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(..., ...)|...]) ? creep\n   Exit: (20) llenaPares(13, _G5113, [], [c(12, 0), c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(..., ...)|...]) ? creep\n   Exit: (19) llenaPares(12, _G5113, [c(12, 0)], [c(11, 10), c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(..., ...)|...]) ? creep\n   Exit: (18) llenaPares(11, _G5113, [c(11, 10), c(12, 0)], [c(10, 0), c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(..., ...)|...]) ? creep\n   Exit: (17) llenaPares(10, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(9, _G5019), c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(..., ...)|...]) ? creep\n   Exit: (16) llenaPares(9, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(8, _G5019), c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(..., ...)|...]) ? creep\n   Exit: (15) llenaPares(8, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(7, _G5019), c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(..., ...)|...]) ? creep\n   Exit: (14) llenaPares(7, _G5019, [c(10, 0), c(11, 10), c(12, 0)], [c(6, 4), c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Exit: (13) llenaPares(6, _G5113, [c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(5, 0), c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Exit: (12) llenaPares(5, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(4, _G4941), c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Exit: (11) llenaPares(4, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(3, _G4941), c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Exit: (10) llenaPares(3, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(2, _G4941), c(1, 8), c(0, 0)|_G4798]) ? creep\n   Exit: (9) llenaPares(2, _G4941, [c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(1, 8), c(0, 0)|_G4798]) ? creep\n   Exit: (8) llenaPares(1, 0, [c(1, 8), c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], [c(0, 0)|_G4798]) ? creep\n   Exit: (7) llenaPares(0, 0, [c(1, 8), c(5, 0), c(6, 4), c(10, 0), c(11, 10), c(12, 0)], _G4798) ? creep\ntrue .\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching", "parse-error"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1462730710, "post_id": 37102919, "comment_id": 61748195, "body": "it&#39;s probably just <code>encode (x:xs)</code>"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1504684920, "post_id": 37102919, "comment_id": 79100182, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8561762/haskell-parse-error-in-pattern\">Haskell: Parse error in pattern</a>"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 5, "last_activity_date": 1462730735, "creation_date": 1462730735, "answer_id": 37103121, "question_id": 37102919, "link": "https://stackoverflow.com/questions/37102919/error-in-patternmatching-in-haskell/37103121#37103121", "title": "error in patternmatching in Haskell", "body": "<p>Function application has higher precedence than <code>:</code></p>\n\n<p>Thus, Haskell parses</p>\n\n<pre><code>encode x:xs \n</code></pre>\n\n<p>as</p>\n\n<pre><code>(encode x):xs \n</code></pre>\n\n<p>which makes no sense. You need</p>\n\n<pre><code>encode (x:xs) \n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 3726947, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/57129ec6e8cbb9d33c9da31208654b4a?s=128&d=identicon&r=PG&f=1", "display_name": "user3726947", "link": "https://stackoverflow.com/users/3726947/user3726947"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 37103121, "answer_count": 1, "score": 0, "last_activity_date": 1504684900, "creation_date": 1462729531, "last_edit_date": 1504684900, "question_id": 37102919, "link": "https://stackoverflow.com/questions/37102919/error-in-patternmatching-in-haskell", "title": "error in patternmatching in Haskell", "body": "<p>I am writing a function that maps lists of lists of bools invectively into lists of bools. This is my code:</p>\n\n<pre><code>y=[False| y&lt;-[0..]]    \nencode :: [[Bool]] -&gt; [Bool]\nencode x:xs =   (zip1 x y):True:True:(encode xs)\nencode []=[]\n</code></pre>\n\n<p>The zip1 function just takes two lists and writes them alternating into a new list.</p>\n\n<p>I'm getting the error message </p>\n\n<blockquote>\n  <p>Parse error in pattern: encode</p>\n</blockquote>\n\n<p>Why do I get this error message?</p>\n"}, {"tags": ["c++", "haskell", "cabal"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462727568, "post_id": 37101999, "comment_id": 61747210, "body": "Please add the exact error message and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 2, "creation_date": 1462727645, "post_id": 37101999, "comment_id": 61747234, "body": "here is an example for a cabal package that contains C++ sources <a href=\"https://github.com/jbransen/minisat-bundle/blob/master/minisat.cabal\" rel=\"nofollow noreferrer\">github.com/jbransen/minisat-bundle/blob/master/minisat.cabal</a>"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1462730276, "post_id": 37101999, "comment_id": 61748055, "body": "@Zeta This isn&#39;t that type of a question."}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 1, "creation_date": 1462730520, "post_id": 37101999, "comment_id": 61748140, "body": "@d8d0d65b3f7cf42 Yeah, I think the problem I&#39;m having is the missing <code>extra-libraries: stdc++</code>, but when I add it, it still doesn&#39;t work. Saying it can&#39;t find the library. I think this is a GHCi bug on Windows."}], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "is_accepted": false, "score": 2, "last_activity_date": 1462731999, "creation_date": 1462731999, "answer_id": 37103327, "question_id": 37101999, "link": "https://stackoverflow.com/questions/37101999/including-c-sources-in-a-haskell-project/37103327#37103327", "title": "Including C++ sources in a Haskell project", "body": "<p>Ok, I've managed to \"fix\" this for now.</p>\n\n<p>I added a <code>extra-libraries: stdc++-6, gcc_s_seh-1</code> to my cabal file and now it works. No idea if this is platform independant but those libraries do get shipped with GHC when I install it through stack.</p>\n"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1462731999, "creation_date": 1462724095, "last_edit_date": 1462730625, "question_id": 37101999, "link": "https://stackoverflow.com/questions/37101999/including-c-sources-in-a-haskell-project", "title": "Including C++ sources in a Haskell project", "body": "<p>I'm trying to make a data structure that will be exposed in Haskell, but implemented in C++. So far I've implemented it in a <code>.cpp</code> file, declared all the functions I need as <code>extern \"C\"</code> and added the source file to the <code>c-sources</code> field in the <code>.cabal</code> file. When I build the project (in this case with <code>stack build</code>) it seems to build fine.</p>\n\n<p>I know it's doing <em>something</em> to the C++ file because it doesn't compile if there are errors.</p>\n\n<p>I've yet to try running the project because it's a library and so far it doesn't have anything \"runnable\" written, but the repl doesn't seem to work.</p>\n\n<p>When I try running it (<code>stack repl</code> in this case) I get a missing symbol error with some mangled name that may or may not be refer to a name in my file.</p>\n\n<pre><code>unknown symbol `_ZdlPv'\nlinking extra libraries/objects failed\n</code></pre>\n\n<p>How can I fix this issue? I've had a similar problem before that I fixed by manually compiling the source into a dynamic library and then use that library in my project. I don't want to do that since it ties me to a platform and since it makes no sense that a simple C++ couldn't be compiled with the project using the tools that GHC already has. I want to be able to put this on hackage.</p>\n\n<p>Is there something I'm missing? If not, is it a bug and are there plans on fixing it?</p>\n"}, {"tags": ["debugging", "haskell", "types"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 7, "creation_date": 1462723714, "post_id": 37101800, "comment_id": 61745960, "body": "You should post at least some code. As far as I know, type-level programs are best debugged with <code>:kind!</code>, holes and <code>Any</code> as type-level hole."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1462724377, "post_id": 37101800, "comment_id": 61746191, "body": "The code I have is large and complicated, and I doubt anybody will be able to follow it. What I&#39;m asking for is tips on how to hunt down where the problem is, so I know where to start looking."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1462760719, "post_id": 37101800, "comment_id": 61756084, "body": "This comment is just to potentially enable me to say &#39;called it!&#39; later: are you assuming some type family is injective?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 2, "creation_date": 1462782301, "post_id": 37101800, "comment_id": 61763551, "body": "@Cactus LOL! I&#39;ve got GADTs, existential quantification, rank-N types and overlapping instances... but no type families."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1462782352, "post_id": 37101800, "comment_id": 61763577, "body": "Hey, it was worth a shot :)"}, {"owner": {"reputation": 410, "user_id": 2805751, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/22fc46808863bebbaf410616ea630332?s=128&d=identicon&r=PG&f=1", "display_name": "user2805751", "link": "https://stackoverflow.com/users/2805751/user2805751"}, "edited": false, "score": 0, "creation_date": 1522101275, "post_id": 37101800, "comment_id": 86006517, "body": "Did you figure it out?"}, {"owner": {"reputation": 57, "user_id": 4620369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-va5es70rTos/AAAAAAAAAAI/AAAAAAAAACM/0CBuf01LeGc/photo.jpg?sz=128", "display_name": "Abdullah Mansoor", "link": "https://stackoverflow.com/users/4620369/abdullah-mansoor"}, "edited": false, "score": 0, "creation_date": 1525619046, "post_id": 37101800, "comment_id": 87418796, "body": "Answer is here already answered <a href=\"https://stackoverflow.com/a/34754070/4620369\">stackoverflow.com/a/34754070/4620369</a>"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1542955243, "post_id": 37101800, "comment_id": 93756276, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34753708/how-do-you-debug-typelevel-code\">How do you debug typelevel code?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 249, "user_id": 4376453, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-LvhFFca8O_8/AAAAAAAAAAI/AAAAAAAAAFo/11B5JshO4o4/photo.jpg?sz=128", "display_name": "Eliza Brandt", "link": "https://stackoverflow.com/users/4376453/eliza-brandt"}, "is_accepted": false, "score": 1, "last_activity_date": 1527111636, "last_edit_date": 1527111636, "creation_date": 1527110991, "answer_id": 50497760, "question_id": 37101800, "link": "https://stackoverflow.com/questions/37101800/how-to-debug-type-level-programs/50497760#50497760", "title": "How to debug type-level programs", "body": "<p>As has been mentioned in the comments, poking around with :kind and :kind! in GHCi is usually how I go about doing it, but it also surprisingly matters where you place the functions, and what looks like it should be the same, isn't always. </p>\n\n<p>For instance, I was trying to make a dependently typed functor equivalent, for a personal project, which looked like </p>\n\n<pre><code>class IFunctor f where \n  ifmap :: (a -&gt; b) -&gt; f n a -&gt; f n b \n</code></pre>\n\n<p>and I was writing the instance for </p>\n\n<pre><code>data IEither a n b where \n  ILeft :: a -&gt; IEither a Z b \n  IRight :: b -&gt; IEither a (S n) b \n</code></pre>\n\n<p>It should be fairly simple, I thought, just ignore f for the left case, apply it in the right. </p>\n\n<p>I tried </p>\n\n<pre><code>instance IFunctor (IEither a) where\n  ifmap _ l@(ILeft _) = l \n  ifmap f (IRight r) = IRight $ f r\n</code></pre>\n\n<p>but for the specialized version of ifmap in this case being <code>ifmap :: (b -&gt; c) -&gt; IEither a Z b -&gt; IEither a Z c</code>, Haskell inferred the type of l to be <code>IEither a Z b</code> on the LHS, which, makes sense, but then refused to produce <code>b ~ c</code>. </p>\n\n<p>So, I had to unwrap l, get the value of type a, then rewrap it to get the <code>IEither a Z c</code>. </p>\n\n<p>This isn't just the case with dependent types, but also with rank-n types.\nFor instance, I was trying to convert isomorphisms of a proper form into natural transformations, which should be fairly easy, I thought. </p>\n\n<p>Apparently, I had to put the deconstructors in a where clause of the function, because otherwise type inference didn't work properly. </p>\n"}], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 6, "answer_count": 1, "score": 31, "last_activity_date": 1527111636, "creation_date": 1462722894, "question_id": 37101800, "link": "https://stackoverflow.com/questions/37101800/how-to-debug-type-level-programs", "title": "How to debug type-level programs", "body": "<p>I'm trying to do some hoopy type-level programming, and it just doesn't work. I'm tearing my hair out trying to figure out why the heck GHC utterly fails to infer the type signatures I want.</p>\n\n<p>Is there some way to make GHC <em>tell me</em> what it's doing?</p>\n\n<p>I tried <code>-ddump-tc</code>, which just prints out the final type signatures. (Yes, they're wrong. Thanks, I already knew that.)</p>\n\n<p>I also tried <code>-ddump-tc-trace</code>, which dumps out ~70KB of unintelligible gibberish. (In particular, I can't see any user-written identifiers mentioned <em>anywhere</em>.)</p>\n\n<p>My code is <em>so close</em> to working, but somehow an extra type variable keeps appearing. For some reason, GHC can't see that this variable should be completely determined. Indeed, if I <em>manually</em> write the five-mile type signature, GHC happily accepts it. So I'm clearly just missing a constraint somewhere... <em>but where?!?</em> >_&lt;</p>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1462721987, "post_id": 37101611, "comment_id": 61745329, "body": "That simplifies it somewhat but I still have to write n times the <code>&lt;*&gt; num</code> part. Is there a way to automatically repeat that?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 1, "creation_date": 1462723332, "post_id": 37101611, "comment_id": 61745829, "body": "@OneEyeQuestion See if you can use <code>replicateM</code>."}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1462724749, "post_id": 37101611, "comment_id": 61746333, "body": "@MathematicalOrchid How would you use <code>replicateM</code> since it returns a list? Or am I mistaken?"}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 1, "creation_date": 1462725801, "post_id": 37101611, "comment_id": 61746710, "body": "@ErikR You are using <code>try parseActionA &lt;|&gt; try parseActionB</code>, but according to this article (<a href=\"http://blog.ezyang.com/2014/05/parsec-try-a-or-b-considered-harmful/\" rel=\"nofollow noreferrer\">blog.ezyang.com/2014/05/parsec-try-a-or-b-considered-harmfu&zwnj;&#8203;l</a>) we should try to reduce the scope of <code>try</code>. Is this the same case or is it different?"}, {"owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "edited": false, "score": 1, "creation_date": 1462726498, "post_id": 37101611, "comment_id": 61746946, "body": "<code>count :: Stream s m t =&gt; Int -&gt; ParsecT s u m a -&gt; ParsecT s u m [a]</code>  Essentially you can end up with something to the effect of <code>parseActionB = do char &#39;B&#39;; ([a,b,c,d,e]) &lt;- count 5 num; return $ ActionB a b c d e</code>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 1, "creation_date": 1462731857, "post_id": 37101611, "comment_id": 61748579, "body": "@OneEyeQuestion putting <code>try</code> before every parser is safe. When you know more about how Parsec works you can remove the ones you don&#39;t need for better efficiency."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1462722444, "last_edit_date": 1462722444, "creation_date": 1462721818, "answer_id": 37101611, "question_id": 37101410, "link": "https://stackoverflow.com/questions/37101410/how-to-generalize-repetitive-parsing-with-parsec/37101611#37101611", "title": "How to generalize repetitive parsing with Parsec", "body": "<p>Using Applicative combinators you can write:</p>\n\n<pre><code>num = do oneOf \" \"; fmap read (C.many1 digit)\n\nparseActionA = ActionA &lt;$&gt; (char 'A' &gt;&gt; num) &lt;*&gt; num\n\nparseActionB = ActionB &lt;$&gt; (char 'B' &gt;&gt; num) &lt;*&gt; num &lt;*&gt; num &lt;*&gt; num &lt;*&gt; num\n</code></pre>\n\n<p>For your second question, just use <code>&lt;|&gt;</code> with <code>try</code></p>\n\n<pre><code>parseAction = try parseActionA &lt;|&gt; try parseActionB &lt;|&gt; try parseActionC\n</code></pre>\n\n<p>Note - <code>try</code> shouldn't be needed on the last parser, but it doesn't hurt to have it. Also, if you know enough about how your parsers work you may be able to do away with some of the <code>try</code>s.</p>\n"}], "owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 37101611, "answer_count": 1, "score": 1, "last_activity_date": 1462722444, "creation_date": 1462720623, "question_id": 37101410, "link": "https://stackoverflow.com/questions/37101410/how-to-generalize-repetitive-parsing-with-parsec", "title": "How to generalize repetitive parsing with Parsec", "body": "<p>I am learning to use Parsec by parsing lines in a text file. What I have is the following:</p>\n\n<pre><code>import Text.Parsec (ParseError, parse)\nimport Text.Parsec.String (Parser)\nimport Text.Parsec.Char (anyChar, digit, char, oneOf)\nimport Control.Monad (void)\nimport qualified Text.Parsec.Combinator as C\n\ndata Action =\n  ActionA Int Int\n  | ActionB Int Int Int Int Int\n  | ActionC Int Int Int\n  deriving (Show)\n\nparseWithEof :: Parser a -&gt; String -&gt; Either ParseError a\nparseWithEof p = parse (p &lt;* C.eof) \"\"\n\nparseActionA :: Parser Action\nparseActionA = do\n  char 'A'\n  void $ oneOf \" \"\n  a &lt;- C.many1 digit\n  void $ oneOf \" \"\n  b &lt;- C.many1 digit\n  return $ ActionA (read a) (read b)\n\nparseActionB :: Parser Action\nparseActionB = do\n  char 'B'\n  void $ oneOf \" \"\n  a &lt;- C.many1 digit\n  void $ oneOf \" \"\n  b &lt;- C.many1 digit\n  void $ oneOf \" \"\n  c &lt;- C.many1 digit\n  void $ oneOf \" \"\n  d &lt;- C.many1 digit\n  void $ oneOf \" \"\n  e &lt;- C.many1 digit\n  return $ ActionB (read a) (read b) (read c) (read d) (read e)\n\nparseActionC :: Parser Action\nparseActionC = do\n  char 'C'\n  void $ oneOf \" \"\n  a &lt;- C.many1 digit\n  void $ oneOf \" \"\n  b &lt;- C.many1 digit\n  void $ oneOf \" \"\n  c &lt;- C.many1 digit\n  return $ ActionC (read a) (read b) (read c)\n</code></pre>\n\n<p>I would like to be able to generalize these parsing functions since I feel that they are repetitive. I don't know if that is possible, or how it is possible.</p>\n\n<p>I would also like to know if it is possible to have a function like this:</p>\n\n<pre><code>parseAction :: String -&gt; Either ParseError Action\nparseAction input = \n    parseWithEof parseActionA input\n    &lt;some operator|combinator&gt; parseWithEof parseActionB input\n    &lt;some operator|combinator&gt; parseWithEof parseActionC input\n</code></pre>\n\n<p>So when <code>parseAction</code> receives a string as parameter it will try to parse it with the different parsers. I expect it to return (Left ParseError) if no parser could parse the input and (Right Action) if a parser succeeded in parsing the input.</p>\n\n<p>Is it possible?</p>\n"}, {"tags": ["haskell", "functional-programming", "expression-trees"], "answers": [{"comments": [{"owner": {"reputation": 6176, "user_id": 398909, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7341b4c982d87acd9bc260a5a970782f?s=128&d=identicon&r=PG", "display_name": "william", "link": "https://stackoverflow.com/users/398909/william"}, "edited": false, "score": 0, "creation_date": 1462720096, "post_id": 37101191, "comment_id": 61744719, "body": "Thanks for the reply. I declared this type before and forgot to add in the question .  <code>data Lukasiewicz = C | I | U     deriving (Eq,  Show, Ord)</code> And I totally forgot that trick to use GHC to get the type. :) Thanks so much.."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1462719499, "creation_date": 1462719499, "answer_id": 37101191, "question_id": 37100836, "link": "https://stackoverflow.com/questions/37100836/haskell-creating-new-data/37101191#37101191", "title": "Haskell creating new data", "body": "<p>The main problem is that the <code>LExpTree</code> type needs an additional type parameter to become a concrete type. This is, I believe, is a correct version of <code>lukVar</code>:</p>\n\n<pre><code>lukVar :: Parser (LExpTree a)\nlukVar = do i &lt;- ident; return (V i)\n         -- alternatively: V &lt;$&gt; ident\n</code></pre>\n\n<p>Note that this is a parser for <code>LExpTree a</code> for any type <code>a</code>.</p>\n\n<p>Now in <code>lukLit</code> you are trying to return things like <code>L C</code>. I don't see where <code>C</code> is defined, but let's suppose that the type of <code>C</code> is <code>MyLits</code>. Then the signature of <code>lukLit</code> is:</p>\n\n<pre><code>lukLit :: Parser (LExpTree MyLits)\n</code></pre>\n\n<p>Evidently the type parameter <code>a</code> in <code>LExpTree a</code> is the type of the literals you want to use.</p>\n\n<p>Note the difference between <code>lukVar</code> and <code>lukLit</code> - your code for <code>lukVar</code> will work with any literal type hence the variable <code>a</code> in the type signature. The code for <code>lukLit</code> returns literals from <code>MyLits</code> and thus returns a <code>LExpTree MyLits</code>.</p>\n\n<p>Now you should be able to fix up <code>lukExp</code>. My guess is that it will have the signature</p>\n\n<pre><code>lukExp :: Parser (LExpTree a)\n</code></pre>\n\n<p>I bet you can just remove the type signatures and let GHC infer them. In these cases having incorrect type signatures is causing the errors.</p>\n"}], "owner": {"reputation": 6176, "user_id": 398909, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7341b4c982d87acd9bc260a5a970782f?s=128&d=identicon&r=PG", "display_name": "william", "link": "https://stackoverflow.com/users/398909/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 37101191, "answer_count": 1, "score": 1, "last_activity_date": 1462719499, "creation_date": 1462717210, "question_id": 37100836, "link": "https://stackoverflow.com/questions/37100836/haskell-creating-new-data", "title": "Haskell creating new data", "body": "<pre><code>{- P A R T 2 : Implementation of a parser for \u0141ukasiewicz expressions\n--TODO Define the type LExpTree, using the constructors L, V, N, Q, S, K, A, O, E, I\nL for Lukasiewicz literals (i.e. C, I or U)\nV for Variables (string) \nN for a node representing the prefix neg\nQ for a node representing the prefix pos\nS for a node representing the prefix cer\nK for a node representing the prefix unk\nA for a node representing the infix And\nO for a node representing the infix Or\nE for a node representing the infix Equivalence\nM for a node representing the infix Implication\nIt will be convenient to have the new type derive from the classes Show and Eq\n-}\ndata LExpTree a = L a\n                | V [Char]\n                | N (LExpTree a)\n                | Q (LExpTree a)\n                | S (LExpTree a)\n                | K (LExpTree a)\n                | A (LExpTree a) (LExpTree a)\n                | O (LExpTree a) (LExpTree a)\n                | E (LExpTree a) (LExpTree a)\n                | M (LExpTree a) (LExpTree a)\n                deriving (Show, Eq)\n</code></pre>\n\n<p>This is my Haskell Project. \nI have been trying it for 4 days. \nI just wanna verify whether my <code>LExpTree</code> data is correct?</p>\n\n<p>I don't think so though..</p>\n\n<p>After that, I have to create a series of parsers as grammar</p>\n\n<p>This is 3 of them.</p>\n\n<pre><code>{- \nlukExp :: lukOpd ( '&lt;-&gt;' lukExp | '--&gt;' lukExp| e )\nlukVar :: lowercase (Alphanumeric)*\nlukLit :: C | I | U\n-}\nlukExp :: Parser LExpTree\nlukExp = do o &lt;- lukOpd\n            ( do { symbol \"&lt;-&gt;\";\n                   e &lt;- lukExp;\n                   return (E (o &lt;-&gt; e)); }\n             +++ do { symbol \"--&gt;\";\n                      e &lt;- lukExp;\n                      return (E (o --&gt; e)); }\n             +++ return (E o) )\n\nlukVar :: Parser LExpTree \nlukVar = ident\n\nlukLit :: Parser LExpTree\nlukLit = do { symbol \"C\";\n              return (L C); }\n         +++ do { symbol \"I\";\n                  return (L I); }\n         +++ do { symbol \"U\";\n                  return (L U); }\n</code></pre>\n\n<p>And I am getting these errors.</p>\n\n<pre><code>proj.hs:131:18:\n    Expecting one more argument to `LExpTree'\n    The first argument of `Parser' should have kind `*',\n      but `LExpTree' has kind `* -&gt; *'\n    In the type signature for `lukExp': lukExp :: Parser LExpTree\n\nproj.hs:184:18:\n    Expecting one more argument to `LExpTree'\n    The first argument of `Parser' should have kind `*',\n      but `LExpTree' has kind `* -&gt; *'\n    In the type signature for `lukVar': lukVar :: Parser LExpTree\n\nproj.hs:187:18:\n    Expecting one more argument to `LExpTree'\n    The first argument of `Parser' should have kind `*',\n      but `LExpTree' has kind `* -&gt; *'\n    In the type signature for `lukLit': lukLit :: Parser LExpTree\nFailed, modules loaded: Parser.\n</code></pre>\n\n<p>The project is to create \u0141ukasiewicz expressions C for certain, U for uncertain and I for impossible. </p>\n\n<p>And I already have a Parser.hs loaded and it has all the Parser and parse types and its associated functions. </p>\n\n<hr>\n\n<p>I understand this is a school project and supposed to try it my best. I still have 2 more parts and this is supposed to be an easy part. </p>\n\n<p>I would appreciate if someone can help me.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1462713725, "post_id": 37100226, "comment_id": 61742901, "body": "Imagine it as a for-loop which increases its nesting from left to right."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1462713371, "creation_date": 1462713371, "answer_id": 37100258, "question_id": 37100226, "link": "https://stackoverflow.com/questions/37100226/haskell-dot-dot-notation-on-list-unexpected-output/37100258#37100258", "title": "Haskell dot dot notation on list - unexpected output", "body": "<pre><code>[ (x,y,z) | z &lt;- [2..], y &lt;- [2..z-1], x &lt;- [2..y-1] ] =\n[ (x,y,2) | y &lt;- [2..2-1], x &lt;- [2..y-1] ] ++\n[ (x,y,3) | y &lt;- [2..3-1], x &lt;- [2..y-1] ] ++\n[ (x,y,4) | y &lt;- [2..4-1], x &lt;- [2..y-1] ] ++\n... =\n[ (x,y,2) | y &lt;- [2..1], x &lt;- [2..y-1] ] ++\n[ (x,y,3) | y &lt;- [2..2], x &lt;- [2..y-1] ] ++\n[ (x,y,4) | y &lt;- [2..3], x &lt;- [2..y-1] ] ++\n... =\n[ (x,y,2) | y &lt;- [], x &lt;- [2..y-1] ] ++\n[ (x,y,3) | y &lt;- [2], x &lt;- [2..y-1] ] ++\n[ (x,y,4) | y &lt;- [2,3], x &lt;- [2..y-1] ] ++\n...\n</code></pre>\n\n<p>Note the range <code>y &lt;- [2..2-1]</code> i.e. <code>y &lt;- [2..1]</code> i.e. <code>y &lt;- []</code>. Because of this, there are no triples <code>(x,y,2)</code> to generate.</p>\n\n<p>Similarly, when <code>y</code> is <code>2</code>, the range <code>z &lt;- [2..y-1]</code> will generate nothing, and we do not get triples of the form <code>(x,2,3)</code>.</p>\n"}], "owner": {"reputation": 6047, "user_id": 4624156, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/lLHF6.png?s=128&g=1", "display_name": "Josh Laird", "link": "https://stackoverflow.com/users/4624156/josh-laird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 37100258, "answer_count": 1, "score": 1, "last_activity_date": 1462713371, "creation_date": 1462713104, "question_id": 37100226, "link": "https://stackoverflow.com/questions/37100226/haskell-dot-dot-notation-on-list-unexpected-output", "title": "Haskell dot dot notation on list - unexpected output", "body": "<p>One of the questions that came up in one of my lectures was the following:</p>\n\n<pre><code>trips :: [(Int, Int, Int)]\ntrips = [ (x,y,z) | z &lt;- [2..], y &lt;- [2..z-1], x &lt;- [2..y-1] ]\n\nWhat is the first five elements output?\n</code></pre>\n\n<p>Now I thought I was aware how dot dot notation worked, but when I put the above into a compiler the output is:</p>\n\n<p>(2, 3, 4), (2, 3, 5), (2, 4, 5), (3, 4, 5), (2, 3, 6) etc.</p>\n\n<p>How does this happen?</p>\n\n<p>I thought if things begun with [2..] then all the subsequent lists would begin with two? z is defined as [2..] yet it never once displays 2 as the third int. I'm obviously missing something here but I'm not entirely sure what.</p>\n"}, {"tags": ["haskell", "pattern-matching", "algebraic-data-types", "do-notation"], "comments": [{"owner": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1462725129, "post_id": 37099684, "comment_id": 61746466, "body": "@MathematicalOrchid. it didn&#39;t work. I tried. and i also notice it goes to inifnite loop on let ans = op ans n"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1462762802, "post_id": 37099684, "comment_id": 61756476, "body": "@WaqarAhmedm <code>let ans = op ans n</code> -- This <i>recursively</i> defines <code>ans</code> in terms of itself.  You need to use a new name, in this case we often use a prime <code>&#39;</code>: <code>let ans&#39; = op ans n</code>"}, {"owner": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "edited": false, "score": 0, "creation_date": 1462789971, "post_id": 37099684, "comment_id": 61768275, "body": "@luqui..i got it..thanks. one more question, why it is consider good not to return value from simpleCalculator method?"}], "answers": [{"comments": [{"owner": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "edited": false, "score": 0, "creation_date": 1462712050, "post_id": 37099909, "comment_id": 61742478, "body": "i am already doing like this. How to execute multiple statements in switch case?"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "edited": false, "score": 0, "creation_date": 1462712360, "post_id": 37099909, "comment_id": 61742551, "body": "See my code please. In Haskell you don&#39;t execute statements. They are stated, not executed."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 0, "last_activity_date": 1462711033, "creation_date": 1462711033, "answer_id": 37099909, "question_id": 37099684, "link": "https://stackoverflow.com/questions/37099684/comparison-of-custom-data-type-with-parameters/37099909#37099909", "title": "Comparison of custom data type with parameters", "body": "<p>Use <code>case</code>.</p>\n\n<pre><code>simpleCalculator ans op =  do\n    input &lt;- getInput   -- here i got the type as result\n    case input of\n        Exit -&gt; return ()\n        Number x -&gt; print $ans `op` x\n        _ -&gt; simpleCalculator ans op\n</code></pre>\n\n<p>You cannot derive <code>Eq</code> for <code>CalculatorInput</code> because functions are not instances of <code>Eq</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "edited": false, "score": 0, "creation_date": 1462789842, "post_id": 37107160, "comment_id": 61768196, "body": "Hi cactus, i tried this same logic yesterday and it worked. but i am confused, if i use ans = ans op x. it goes to infinite loop. can you please tell me why it is happening."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "edited": false, "score": 0, "creation_date": 1462793196, "post_id": 37107160, "comment_id": 61770297, "body": "That&#39;s because if you do <code>let ans = ans op x</code>, the <code>ans</code> on the right-hand side refers to the same <code>ans</code> being defined."}, {"owner": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "edited": false, "score": 0, "creation_date": 1462804194, "post_id": 37107160, "comment_id": 61777862, "body": "Thank you, i got it...one more question, why it is consider good not to return value from method such as in this case simpleCalculator method?"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1462793384, "last_edit_date": 1462793384, "creation_date": 1462762484, "answer_id": 37107160, "question_id": 37099684, "link": "https://stackoverflow.com/questions/37099684/comparison-of-custom-data-type-with-parameters/37107160#37107160", "title": "Comparison of custom data type with parameters", "body": "<p>You're almost on the right track with your non-working code:</p>\n\n<pre><code>simpleCalculator :: Int -&gt; (Int -&gt; Int -&gt; Int) -&gt; IO ()\nsimpleCalculator ans op =  do\n    input &lt;- getInput   -- here i got the type as result\n    case input of\n      Exit -&gt; return ()\n      Error x -&gt; print x\n      Number n -&gt; ans = ans op x; print ans\n      _ -&gt; simpleCalculator ans op\n</code></pre>\n\n<p>You can nest <code>do</code> notations allowing you to write the following correct program:</p>\n\n<pre><code>simpleCalculator :: Int -&gt; (Int -&gt; Int -&gt; Int) -&gt; IO ()\nsimpleCalculator ans op =  do\n    input &lt;- getInput   -- here i got the type as result\n    case input of\n      Exit -&gt; return ()\n      Error x -&gt; print x\n      Number n -&gt; do\n        let theAns = ans op x\n        print theAns\n      _ -&gt; simpleCalculator ans op\n</code></pre>\n\n<p>As for the <code>Eq</code> instance, you can let the compiler do the work for you by using <a href=\"https://en.wikibooks.org/wiki/Haskell/Classes_and_types#Deriving\" rel=\"nofollow\">derivation</a>, i.e. writing</p>\n\n<pre><code>data CalculatorInput \n    = Exit \n    | Error String \n    | Operator (Int -&gt; Int -&gt; Int)\n    | Number Int\n    deriving Eq\n</code></pre>\n"}], "owner": {"reputation": 4662, "user_id": 3118364, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7db3f31fc4a855a3cf3299932f386f97?s=128&d=identicon&r=PG&f=1", "display_name": "Waqar Ahmed", "link": "https://stackoverflow.com/users/3118364/waqar-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 37107160, "answer_count": 2, "score": 1, "last_activity_date": 1462793384, "creation_date": 1462709438, "last_edit_date": 1462793306, "question_id": 37099684, "link": "https://stackoverflow.com/questions/37099684/comparison-of-custom-data-type-with-parameters", "title": "Comparison of custom data type with parameters", "body": "<p>I am learning Haskell and trying to implement this program. I have a custom data type </p>\n\n<pre><code>data CalculatorInput \n    = Exit \n    | Error String \n    | Operator (Int -&gt; Int -&gt; Int)\n    | Number Int\n</code></pre>\n\n<p>then I have a method <code>getInput</code> which returns a value of this type.</p>\n\n<p>Now i am confused how to dispatch on values of this type. I have a method</p>\n\n<pre><code>simpleCalculator :: Int -&gt; (Int -&gt; Int -&gt; Int) -&gt; IO ()\nsimpleCalculator ans op =  do\n    input &lt;- getInput   -- here i got the type as result\n    if input == Exit then return()\n    else if input == Number x then ans = ans op x; print ans\n    else simpleCalculator ans op\n</code></pre>\n\n<p>I want to know whether the input is a <code>Number x</code> </p>\n\n<p>I tried to use <code>case</code> as well:</p>\n\n<pre><code>simpleCalculator :: Int -&gt; (Int -&gt; Int -&gt; Int) -&gt; IO ()\nsimpleCalculator ans op =  do\n    input &lt;- getInput   -- here i got the type as result\n    --case input of\n    --  Exit -&gt; return ()\n    --  Error x -&gt; print x\n    --  Number n -&gt; ans = ans op x; print ans  -- getting error here, multiple statement not possible\n    --  _ -&gt; simpleCalculator ans op\n</code></pre>\n\n<p>I tried to create instance of <code>Eq</code> as well</p>\n\n<pre><code>instance Eq CalculatorInput where\n    (==) Exit Exit = True\n    (==) (Number x) (Number y) = x == y\n    (==) _ _ = False \n</code></pre>\n\n<p>How can I compare custom data types with parameters or have multiple statements in a <code>case</code> branch?</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1462701442, "post_id": 37098394, "comment_id": 61739798, "body": "if you want to get tricky you can: 1. flip the tuples, 2. use sort, 3. flip again"}], "answers": [{"comments": [{"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 1, "creation_date": 1462701840, "post_id": 37098555, "comment_id": 61739888, "body": "Or: <code>sortT = map swap . sort . map swap</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462703077, "post_id": 37098555, "comment_id": 61740142, "body": "yes: both true ;) - btw: I kindof seen it as a <i>feature</i>  that it will sort the first one if the second turns out to be the same ;)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1462703106, "last_edit_date": 1462703106, "creation_date": 1462701548, "answer_id": 37098555, "question_id": 37098394, "link": "https://stackoverflow.com/questions/37098394/sorting-a-list-of-tuples-by-second-element-without-using-sortby/37098555#37098555", "title": "Sorting a list of tuples by second element without using sortBy", "body": "<p>here is what I meant:</p>\n\n<pre><code>import Data.List (sort)\nimport Data.Tuple (swap)\n\nsortT = map swap . sort . map swap\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1462704220, "last_edit_date": 1462704220, "creation_date": 1462703065, "answer_id": 37098745, "question_id": 37098394, "link": "https://stackoverflow.com/questions/37098394/sorting-a-list-of-tuples-by-second-element-without-using-sortby/37098745#37098745", "title": "Sorting a list of tuples by second element without using sortBy", "body": "<p>As already done by Carsten, you can achieve this by &ldquo;masking&rdquo; the first element and then just using a normal sort. Flipping the elements kind of achieves this, though it's rather a hack (the first element will still get sorted, just with lower priority)... a somewhat better method would be to use a type that really compares <em>only</em> the second element:</p>\n\n<pre><code>data SndOrd a b = SndOrd a b\n\ninstance Eq SndOrd where SndOrd _ x == SndOrd _ y = x==y\ninstance Ord SndOrd where compare (SndOrd _ x) (SndOrd _ y) = compare x y\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>sortT = map (\\(SndOrd a b) -&gt; (a,b)) . sort . map (\\(a,b) -&gt; SndOrd a b)\n</code></pre>\n\n<p>However, I wouldn't recommend this, because it's usually expected that <code>==</code> is a proper equality, but with this approach you have <code>SndOrd 1 2 == SndOrd 3 2</code>.</p>\n\n<p>The right approach, of course, is <em>to use</em> <code>sortBy</code>! Or to implement it yourself. Writing a general sorting algorithm is a topic you can find <em>tons</em> of resources on on the internet, you should check out those first before asking on StackOverflow...</p>\n\n<p>You own attempt is not completely meaningless. First we need to get it to actually cover lists of length other than 0 or 2, by recursion:</p>\n\n<pre><code>sortBySnd' ((_,a):(_,b):l)\n    | a &lt; b  = (_,a) : sortBySnd' ((_,b):l)\n    | a &gt; b  = (_,b) : sortBySnd' ((_,a):l)\n    | a == b = (_,a) : sortBySnd' ((_,b):l)\nsortBySnd' l = l  -- lists with length &lt;2 are already sorted!\n</code></pre>\n\n<p>Note that you can unify the first and third guards:</p>\n\n<pre><code>sortBySnd' ((_,a):(_,b):l)\n    | a &gt; b     = (_,b) : sortBySnd' ((_,a):l)\n    | otherwise = (_,a) : sortBySnd' ((_,b):l)\nsortBySnd' l = l  -- lists with length &lt;2 are already sorted!\n</code></pre>\n\n<p>Now, this doesn't work right yet, since every element can step at most one cell backwards in the list. You can salvage this by iterating the whole process as often as the list has elements:</p>\n\n<pre><code>sortBySnd'' l = iterate sortBySnd' l !! length l\n</code></pre>\n\n<p>This is <a href=\"https://en.wikipedia.org/wiki/Bubble_sort\" rel=\"nofollow\">bubble sort</a>, a very inefficient algorithm but it works.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1462751366, "post_id": 37105338, "comment_id": 61754133, "body": "just as a side note, <code>(uncurry (fmap . flip (,)) &lt;=&lt;)</code> here is the same as  <code>(concatMap (\\(k,as)-&gt; (, k) &lt;$&gt; as) .)</code>. --- Also, if the sort needs to be stable, <code>fromListWith (flip (++))</code> should be used."}], "tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 2, "last_activity_date": 1462745203, "creation_date": 1462745203, "answer_id": 37105338, "question_id": 37098394, "link": "https://stackoverflow.com/questions/37098394/sorting-a-list-of-tuples-by-second-element-without-using-sortby/37105338#37105338", "title": "Sorting a list of tuples by second element without using sortBy", "body": "<p>Just for fun, using <code>Data.Map</code>:</p>\n\n<pre><code>uncurry (fmap.flip(,))  -- distribute the keys over the values\n&lt;=&lt; toList              -- convert back to a list, now sorted\n. fromListWith (++)     -- convert to Map, collect values with same keys\n. fmap (fmap(:[]).swap) -- swap the pairs and promote snd to a list\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 6005857, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/10940e23bda8cf7bbc35957025ef3348?s=128&d=identicon&r=PG&f=1", "display_name": "user6005857", "link": "https://stackoverflow.com/users/6005857/user6005857"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 37098555, "answer_count": 3, "score": 3, "last_activity_date": 1462745203, "creation_date": 1462700469, "question_id": 37098394, "link": "https://stackoverflow.com/questions/37098394/sorting-a-list-of-tuples-by-second-element-without-using-sortby", "title": "Sorting a list of tuples by second element without using sortBy", "body": "<p>Suppose the input to the function is:</p>\n\n<pre><code>[(6,-275),(3,123),(7,1000),(9,-572),(3,333),(1,-23)]\n</code></pre>\n\n<p>The output should be:</p>\n\n<pre><code>[(9,-572),(6,-275),(1,-23),(3,123),(3,333),(7,1000)]\n</code></pre>\n\n<p>Here is the function I want to make:</p>\n\n<pre><code>sortBySnd :: Ord a =&gt; [(a,a)] -&gt; [(a,a)]\nsortBySnd [] = []\nsortBySnd [(_,a),(_,b)]\n    | a &lt; b = [(_,a),(_,b)]\n    | a &gt; b = [(_,b),(_,a)]\n    | a == b = [(_,a),(_,b)]\n</code></pre>\n\n<p>This of course is very wrong but I just wanted to show what I want to achieve.</p>\n\n<p>For a sorting function, can just use mergesort or some builtin sorting function other than sortBy.</p>\n"}, {"tags": ["haskell", "dictionary", "monads", "applicative"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1462693863, "post_id": 37096253, "comment_id": 61737998, "body": "AFAICS, <code>unionWithM</code> is impossible: <code>unionWith</code> can feed the <code>v</code> result of <code>v -&gt; v -&gt; m v</code> to another call of <code>v -&gt; v -&gt; m v</code>. This is close to Kelisli composition, which requires monads."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1462720333, "post_id": 37097590, "comment_id": 61744779, "body": "I see a <code>let</code> with no <code>in</code>."}, {"owner": {"reputation": 763, "user_id": 1213965, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c0cb9460ea9ece255603e2e4326e60bb?s=128&d=identicon&r=PG", "display_name": "Cosmia Luna", "link": "https://stackoverflow.com/users/1213965/cosmia-luna"}, "edited": false, "score": 0, "creation_date": 1462721316, "post_id": 37097590, "comment_id": 61745083, "body": "I have to say that I don&#39;t really like this solution though I upvoted it, well, it works anyway, thanks."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1462722273, "post_id": 37097590, "comment_id": 61745433, "body": "@dfeur indeed. Fixed"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 763, "user_id": 1213965, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c0cb9460ea9ece255603e2e4326e60bb?s=128&d=identicon&r=PG", "display_name": "Cosmia Luna", "link": "https://stackoverflow.com/users/1213965/cosmia-luna"}, "edited": false, "score": 0, "creation_date": 1462722310, "post_id": 37097590, "comment_id": 61745446, "body": "@CosmiaLuna Jus curious. What don&#39;t you like about this solution ?"}, {"owner": {"reputation": 763, "user_id": 1213965, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c0cb9460ea9ece255603e2e4326e60bb?s=128&d=identicon&r=PG", "display_name": "Cosmia Luna", "link": "https://stackoverflow.com/users/1213965/cosmia-luna"}, "edited": false, "score": 0, "creation_date": 1462751847, "post_id": 37097590, "comment_id": 61754241, "body": "@mb14 I do not know, just somewhat..., maybe the intermediate data structure?"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 7, "last_activity_date": 1462761353, "last_edit_date": 1462761353, "creation_date": 1462694589, "answer_id": 37097590, "question_id": 37096253, "link": "https://stackoverflow.com/questions/37096253/can-i-rewrite-this-unionwith-like-function-with-applicative-instead-monad/37097590#37097590", "title": "Can I rewrite this unionWith-like function with Applicative instead Monad?", "body": "<p>Yes you can but you need an intermediate data structure.\nThe problem is you wrap the value of your Map before applying the function, which is why your <code>f'</code> is of type <code>m a -&gt; m a -&gt; m a</code>. To transform <code>f</code> to <code>f'</code> you need <code>join</code>, i.e. a Monad. The trick is to apply the function after the union.\nFor that you could use <code>(Maybe a, Maybe a)</code> which is a bit messy, so instead you can use the <a href=\"https://hackage.haskell.org/package/these-0.6.2.1/docs/Data-These.html\" rel=\"nofollow\">These</a> data type. If we roll it out manually you get</p>\n\n<pre><code>data These a b = That a | This b | These a b\n\nunionWith' f a b = let theses = unionWith These (That &lt;$&gt; a) (This &lt;$&gt; b)\n                   in sequenceA (f' &lt;$&gt; theses)\n    where f' (That a) = pure a\n          f' (This b) = pure b\n          f' (These a b) = f a b\n</code></pre>\n\n<p>If you use the <code>these</code> package you can simplify it to</p>\n\n<pre><code> unionWith'' f a b = sequenceA $ alignWith (these pure pure f)  a b\n</code></pre>\n"}], "owner": {"reputation": 763, "user_id": 1213965, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c0cb9460ea9ece255603e2e4326e60bb?s=128&d=identicon&r=PG", "display_name": "Cosmia Luna", "link": "https://stackoverflow.com/users/1213965/cosmia-luna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1462761353, "creation_date": 1462682254, "question_id": 37096253, "link": "https://stackoverflow.com/questions/37096253/can-i-rewrite-this-unionwith-like-function-with-applicative-instead-monad", "title": "Can I rewrite this unionWith-like function with Applicative instead Monad?", "body": "<p>I tried to write a function similar to <a href=\"http://haddock.stackage.org/lts-5.15/containers-0.5.6.2/Data-Map-Lazy.html#g:9\" rel=\"noreferrer\">Data.Map.unionWith</a>, but may fail. The original one uses Maybe, which indeed is a Monad, so the monadic one just works fine for me. but I wonder if it can be rewritten with Applicative, since I fmapped it with pure just to satisfy the type requirement of unionWith. Or with other function in Data.Map instead of unionWith?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE RankNTypes #-}\nimport Control.Monad\nimport Data.Map\nunionWithM :: (Monad m, Traversable t)\n          =&gt; (forall a. (a -&gt; a -&gt; a)\n              -&gt; t a\n              -&gt; t a\n              -&gt; t a\n             )\n          -&gt; (v -&gt; v -&gt; m v)\n          -&gt; t v\n          -&gt; t v\n          -&gt; m (t v)\nunionWithM u f a b = sequenceA (u f' (pure &lt;$&gt; a) (pure &lt;$&gt; b))\n  where f' x y = join $ f &lt;$&gt; x &lt;*&gt; y\n\nunionWithOriginal :: Ord k =&gt; (a -&gt; a -&gt; Maybe a) -&gt; Map k a -&gt; Map k a -&gt; Maybe (Map k a)\nunionWithOriginal f a b = sequenceA (unionWith f' (Just &lt;$&gt; a) (Just &lt;$&gt; b))\n  where f' x y = join $ f &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1462682663, "post_id": 37096012, "comment_id": 61735903, "body": "On the topic of the DMR, I would suggest that you use a modern version of haskell if you continue exploring haskell.  The behavior you are using only happens in very, very old and outdated versions of ghc, and a lot of questions you might have about it might be pretty outdated, too :)  a lot of work has also been done over the past several years to fix things that might be &quot;mysterious to noob&#39;s eyes&quot;, too."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1462682945, "post_id": 37096012, "comment_id": 61735946, "body": "The other piece in this puzzle is (I think) that your version of <code>ghci</code> implicitly uses <code>:set -XNoMonomorphjsmRestriction</code> (as recent ghci&#39;s do) but that your <code>ghc</code> is using it. This explains the difference between <code>g</code> and <code>h</code> You can investigate the behavior by toggling between <code>{-#LANGUAGE MonomorphismRestriction#-}</code> and <code>{-#LANGUAGE NoMonomorphismRestriction#-}</code> in your file, and <code>:set -XMonomorphismRestriction</code> in ghci"}, {"owner": {"reputation": 31, "user_id": 6305599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a3ac98bb77e25adb742a081842c21b4?s=128&d=identicon&r=PG&f=1", "display_name": "Donghui Kim", "link": "https://stackoverflow.com/users/6305599/donghui-kim"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 1, "creation_date": 1462686196, "post_id": 37096012, "comment_id": 61736487, "body": "@JustinL. But I thought I&#39;m using the latest version.. :) Isn&#39;t this modern enough? <i>The Glorious Glasgow Haskell Compilation System, version 7.10.3</i>   What does DMR stand for, by the way?"}, {"owner": {"reputation": 31, "user_id": 6305599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a3ac98bb77e25adb742a081842c21b4?s=128&d=identicon&r=PG&f=1", "display_name": "Donghui Kim", "link": "https://stackoverflow.com/users/6305599/donghui-kim"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1462687379, "post_id": 37096012, "comment_id": 61736709, "body": "You were right, @Michael. ghci was implicitly setting <i>NoMonomorphismRestriction</i>. Thanks so much!"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1462698921, "post_id": 37096012, "comment_id": 61739179, "body": "@dhK ah, my mistake, i misread your question :)  I thought you were seeing the DMR on for ghci, but it looks like it came from a source file instead.  my apologies!"}], "owner": {"reputation": 31, "user_id": 6305599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a3ac98bb77e25adb742a081842c21b4?s=128&d=identicon&r=PG&f=1", "display_name": "Donghui Kim", "link": "https://stackoverflow.com/users/6305599/donghui-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 2, "closed_date": 1462688285, "answer_count": 0, "score": 3, "last_activity_date": 1462679658, "creation_date": 1462679156, "last_edit_date": 1462679658, "question_id": 37096012, "link": "https://stackoverflow.com/questions/37096012/difference-between-a-nested-lambda-expression-and-a-normally-defined-function-in", "closed_reason": "Duplicate", "title": "Difference between a nested lambda expression and a normally defined function in Haskell", "body": "<p>I was told that every function in Haskell can have only one formal parameter, and defining a function with multiple parameters is just a syntactic sugar. Does that mean a multi-parameter function can be desugared into a nested lambda expression without losing or gaining any property?</p>\n\n<p>I assumed that the answer would be yes. When I actually tried with the two functions below, however, I encountered something that looks mysterious to noob's eyes.</p>\n\n<pre><code>-- aFile.hs\n\nf x y = x + y\n\ng = \\x -&gt; \\y -&gt; x + y\n</code></pre>\n\n<p>I defined <code>f</code> and <code>g</code> in a file both without type annotations, expecting the type of both functions will be <code>Num a =&gt; a -&gt; a -&gt; a</code>. The actual result, however, was puzzling:</p>\n\n<pre><code>Prelude&gt; :load aFile.hs\nOk, modules loaded: Main.\n\n*Main&gt; :type f\nf :: Num a =&gt; a -&gt; a -&gt; a\n\n*Main&gt; :type g\ng :: Integer -&gt; Integer -&gt; Integer\n\n*Main&gt; let h = \\x -&gt; \\y -&gt; x + y\n\n*Main&gt; :type h\nh :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Somehow <code>g</code> is not polymorphic. On what ground <code>Integer</code> is inferred here? Does this result mean that the multi-parameter function definition is not a syntactic sugar?</p>\n\n<p>Even more confusingly, <code>h</code>, which is the same as <code>g</code> but entered directly into the REPL, has the expected polymorphic type. How come <code>g</code> and <code>h</code> are different?</p>\n"}, {"tags": ["java", "haskell", "casting", "floor", "frege"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1462678009, "post_id": 37095330, "comment_id": 61735232, "body": "Your subtraction approach sounds reasonable given the constraints, but I&#39;ve never used Frege."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1462700152, "post_id": 37095330, "comment_id": 61739464, "body": "Judging from <a href=\"http://stackoverflow.com/questions/17960186/is-there-anyway-to-convert-from-double-to-biginteger\" title=\"is there anyway to convert from double to biginteger\">stackoverflow.com/questions/17960186/&hellip;</a> one needs some itermediate representation  to do this."}], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 3, "last_activity_date": 1462700217, "last_edit_date": 1462700217, "creation_date": 1462698904, "answer_id": 37098178, "question_id": 37095330, "link": "https://stackoverflow.com/questions/37095330/frege-double-to-integer/37098178#37098178", "title": "Frege Double to Integer", "body": "<p>This functionality is indeed not available. The reason is that Java apparently doesn't offer methods that support it.</p>\n\n<p>What you can do is to convert the (floored) double to a String and converting that to an Integer.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>frege&gt; import Prelude.Math(floor)\nfrege&gt; integerFromDouble d = String.aton (\"%.0f\".format (floor d))\nfunction integerFromDouble :: Math.Floating a =&gt; a -&gt; Integer\nfrege&gt; integerFromDouble 987654321e20\n98765432100000000000000000000\n</code></pre>\n\n<p>I wonder if there is a more effective method that somehow extracts the mantissa and exponent from a Double and computes the Integer.</p>\n\n<p>Note that above function is unsafe because NaN, +Infinity and -Infinity exist:</p>\n\n<pre><code>frege&gt; integerFromDouble (5/0)\njava.lang.NumberFormatException: For input string: \"Infinity\"\n</code></pre>\n\n<p>You could either check that separately or replace <code>String.aton</code> with <code>String.integer</code> , which returns</p>\n\n<pre><code>Either NumberFormatException Integer\n</code></pre>\n\n<p>If you can make sure your computations don't exceed the <code>Long</code> capacity, what you want can be done with:</p>\n\n<pre><code>round . floor\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1462741375, "post_id": 37102907, "comment_id": 61751649, "body": "Apparently, OP uses numbers so big that not even Long is enough."}], "tags": [], "owner": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "is_accepted": false, "score": 1, "last_activity_date": 1462729480, "creation_date": 1462729480, "answer_id": 37102907, "question_id": 37095330, "link": "https://stackoverflow.com/questions/37095330/frege-double-to-integer/37102907#37102907", "title": "Frege Double to Integer", "body": "<p>You could also just call <code>intValue</code> on the <code>Double</code> result after calling <code>floor</code>.</p>\n\n<p><a href=\"http://docs.oracle.com/javase/6/docs/api/java/lang/Number.html#intValue%28%29\" rel=\"nofollow\">http://docs.oracle.com/javase/6/docs/api/java/lang/Number.html#intValue%28%29</a></p>\n"}], "owner": {"reputation": 1343, "user_id": 4480394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-QwHzVkP4n0Y/AAAAAAAAAAI/AAAAAAAAAGo/xwQ_WdtwEjQ/photo.jpg?sz=128", "display_name": "Mona the Monad", "link": "https://stackoverflow.com/users/4480394/mona-the-monad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 37098178, "answer_count": 2, "score": 2, "last_activity_date": 1462729480, "creation_date": 1462671050, "last_edit_date": 1462698980, "question_id": 37095330, "link": "https://stackoverflow.com/questions/37095330/frege-double-to-integer", "title": "Frege Double to Integer", "body": "<p>I would like to be able to convert a large <code>Double</code> to an <code>Integer</code>, but it seems that the Frege Haskell implementation of <code>floor</code> does not yield an <code>Integral</code> type. Instead, it seems to be implemented to interface with way Java does it, and takes a <code>Floating</code> type to a <code>Double</code>, <code>Floating r =&gt; r -&gt; Double</code>. I could use <code>round</code>, but that rounds rather than truncate (though I might be able to subtract 0.5 and <em>then</em> round). I'd rather work without needing to resort to using <code>Int</code> or <code>Long</code>, which, as wide as the latter is, is still limited in precision.</p>\n\n<p>Any way to go about flooring a floating point type to an arbitrary precision integer type?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1462661885, "post_id": 37094454, "comment_id": 61732767, "body": "Nope. If it makes sense for you, you might want to split the data-type into a CitizenType and Citizen."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1462661954, "creation_date": 1462661954, "answer_id": 37094546, "question_id": 37094454, "link": "https://stackoverflow.com/questions/37094454/construct-a-function-with-my-own-type-signature-avoid-duplication-of-code/37094546#37094546", "title": "construct a function with my own type signature - avoid duplication of code", "body": "<p>For a simple right-hand side like in your example it's not worth it. But if your function was more complex you could do something like:</p>\n\n<pre><code>getName citizen =\n  case citizen of\n    J11 first last -&gt; f first\n    J12 first last -&gt; f first\n  where \n    f = ...complex definition...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 6, "last_activity_date": 1462662453, "creation_date": 1462662453, "answer_id": 37094596, "question_id": 37094454, "link": "https://stackoverflow.com/questions/37094454/construct-a-function-with-my-own-type-signature-avoid-duplication-of-code/37094596#37094596", "title": "construct a function with my own type signature - avoid duplication of code", "body": "<p>Or, you can always go one level higher</p>\n\n<pre><code> data Citizen a = Citizen a String String                                                                     \n firstName :: Citizen a -&gt; String                                                                         \n firstName (Citizen _ f _) = f                                                                            \n\n &gt; let j1 = Citizen J11 \"John\" \"Doe\"                                                                               \n &gt; firstName j1                                        \n\n \"John\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 3, "last_activity_date": 1462680958, "creation_date": 1462680958, "answer_id": 37096153, "question_id": 37094454, "link": "https://stackoverflow.com/questions/37094454/construct-a-function-with-my-own-type-signature-avoid-duplication-of-code/37096153#37096153", "title": "construct a function with my own type signature - avoid duplication of code", "body": "<p>Another option is to use records.</p>\n\n<pre><code>data Citizen =\n  J11\n  { firstName :: String\n  , lastName  :: String\n  } |\n  J12\n  { firstName :: String\n  , lastName  :: String\n  }\n</code></pre>\n\n<p>This defines for you the functions <code>firstName, lastName :: Citizen -&gt; String</code> automatically.</p>\n"}], "owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 37094596, "answer_count": 3, "score": 1, "last_activity_date": 1462680958, "creation_date": 1462661028, "question_id": 37094454, "link": "https://stackoverflow.com/questions/37094454/construct-a-function-with-my-own-type-signature-avoid-duplication-of-code", "title": "construct a function with my own type signature - avoid duplication of code", "body": "<p>I have defined a data type: </p>\n\n<pre><code>data Citizen = J11 String String | J12 String String\n</code></pre>\n\n<p>and I want to write a function:  getName :</p>\n\n<pre><code>getName :: Citizen -&gt; String\ngetName  (J11 firstName lastName  ) =  firstName\ngetName  (J12 firstName lastName  ) =  firstName\n</code></pre>\n\n<p>Is it possible to avoid duplicating the code depending on whether it is J11 or J12?  without changing the type signature? </p>\n\n<pre><code>getName  (XXX firstName lastName  ) =  firstName\n</code></pre>\n\n<p>..something like this...</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1462651538, "creation_date": 1462651538, "answer_id": 37093161, "question_id": 37092872, "link": "https://stackoverflow.com/questions/37092872/idiomatic-use-of-fmap-with-function-composition/37093161#37093161", "title": "Idiomatic use of fmap with function composition", "body": "<p>well I would put this into a do block:</p>\n\n<pre><code>main = do\n    ls &lt;- lines &lt;$&gt; getContents\n    let s = sum $ map getSquareFootage ls\n    print s\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1462652897, "post_id": 37093191, "comment_id": 61730435, "body": "Awesome thanks! I like this one personally:      main = print . sum . map getSquareFootage . lines =&lt;&lt; getContents  My misconception was that <code>print</code> had the type <code>IO a -&gt; IO ()</code> instead of <code>a -&gt; IO ()</code> Cheers!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1462651742, "creation_date": 1462651742, "answer_id": 37093191, "question_id": 37092872, "link": "https://stackoverflow.com/questions/37092872/idiomatic-use-of-fmap-with-function-composition/37093191#37093191", "title": "Idiomatic use of fmap with function composition", "body": "<p>If you're using <code>return</code> at the end of a Kleisli arrow only to feed the result to another one, you could just precompose it as a pure function: <code>return . f &gt;&gt;= q</code> is equivalent to <code>q . f</code> by the monad laws.</p>\n\n<pre><code>main = getContents &gt;&gt;= print . sum . (fmap getSquareFootage) . lines\n</code></pre>\n\n<p>I've used that the fixity of <code>.</code> is higher than <code>infixl 1 &gt;&gt;=</code>. Speaking of fixity: you never need to surround function calls with parens, if they're already surrounded by infixes! And since your specialised to lists, you can use <code>map</code> instead of <code>fmap</code> (though this is a matter of taste).</p>\n\n<pre><code>main = getContents &gt;&gt;= print . sum . map getSquareFootage . lines\n</code></pre>\n\n<p>Not too bad IMO, though it could be argued that the order is confusing. You can make it all right-to-left,</p>\n\n<pre><code>main = print . sum . map getSquareFootage . lines =&lt;&lt; getContents\n</code></pre>\n\n<p>or left-to-right if you prefer</p>\n\n<pre><code>import Control.Arrow\n\nmain = getContents &gt;&gt;= (lines &gt;&gt;&gt; map getSquareFootage &gt;&gt;&gt; sum &gt;&gt;&gt; print)\n</code></pre>\n"}], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 37093191, "answer_count": 2, "score": 0, "last_activity_date": 1462651742, "creation_date": 1462649695, "question_id": 37092872, "link": "https://stackoverflow.com/questions/37092872/idiomatic-use-of-fmap-with-function-composition", "title": "Idiomatic use of fmap with function composition", "body": "<p>I'm pretty new to Haskell, but I'm loving learning about it, it's so different from everything I've used before. I've read a book or two on Monads and how they affect flow, but I'm still having a bit of trouble getting the hang of it. To get better I'm working through the excellent Advent of Code problems, right now I'm on <a href=\"http://adventofcode.com/day/2\" rel=\"nofollow\">problem 2</a>, I've posted my code below and it works properly, but doesn't feel as clean as it could be.</p>\n\n<p>Specifically I'm wondering how I can clean up this:</p>\n\n<p><code>main = getContents &gt;&gt;= (return . sum . (fmap getSquareFootage) . lines) &gt;&gt;= print</code></p>\n\n<p>I don't like mixing function composition AND fmap AND <code>&gt;&gt;=</code> in a line like that, I find it hard to read. Is there a more idiomatic way to achieve the same result? I'm also open to any and all Haskell style advice, I don't really have anyone to talk to about this, Thanks!</p>\n\n<p>TLDR; How can I idiomatically combine fmap, <code>.</code> and <code>&gt;&gt;=</code>?</p>\n\n<pre><code>import Data.List.Split (splitOn)\n\nmain :: IO ()\nmain = getContents &gt;&gt;= (return . sum . (fmap getSquareFootage) . lines) &gt;&gt;= print\n\ngetSquareFootage :: String -&gt; Int\ngetSquareFootage box = area dims + slack dims\n    where dims =  read &lt;$&gt; splitOn \"x\" box\n        slack = minimum . sides\n        sides [l, w, h] = [l*w, w*h, h*l]\n        area [l, w, h] = 2*l*w + 2*w*h + 2*h*l\n</code></pre>\n"}, {"tags": ["haskell", "haskell-wai", "haskell-warp"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1462652127, "creation_date": 1462652127, "answer_id": 37093252, "question_id": 37092810, "link": "https://stackoverflow.com/questions/37092810/stream-stdin-to-a-wai-eventsource/37093252#37093252", "title": "Stream stdin to a Wai.EventSource", "body": "<p><code>L.getContents</code> is a single IO action, so only one event will be created.</p>\n\n<p>Here is an example of eventSourcEventAppIO where multiple events are created:</p>\n\n<pre><code>import Blaze.ByteString.Builder.Char8 (fromString)\n...same imports as above...\n\nnextEvent :: IO ServerEvent\nnextEvent = do\n  s &lt;- getLine\n  let event = if s == \"\"\n                then CloseEvent\n                else ServerEvent\n                     { eventName = Nothing\n                     , eventId = Nothing\n                     , eventData = [ fromString s ]\n                     }\n  case event of\n    CloseEvent -&gt;     putStrLn \"&lt;close event&gt;\"\n    ServerEvent _ _ _ -&gt; putStrLn \"&lt;server event&gt;\"\n  return event\n\nmain :: IO ()\nmain = run 1337 $ eventSourceAppIO nextEvent\n</code></pre>\n\n<p>To test, in one window start up the server and in another run the command <code>curl -v http://localhost:1337</code>. For each line you enter in the server window you will get a data frame from curl. Entering a blank line will close the HTTP connection but the server will remain running allowing you to connect to it again.</p>\n"}], "owner": {"reputation": 4384, "user_id": 1344760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/49aaba480eb0629ee5a6ba72af5e89ff?s=128&d=identicon&r=PG", "display_name": "RichardTowers", "link": "https://stackoverflow.com/users/1344760/richardtowers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 37093252, "answer_count": 1, "score": 0, "last_activity_date": 1462652209, "creation_date": 1462649314, "last_edit_date": 1462652209, "question_id": 37092810, "link": "https://stackoverflow.com/questions/37092810/stream-stdin-to-a-wai-eventsource", "title": "Stream stdin to a Wai.EventSource", "body": "<p>I would like to stream stdin over an HTTP connection using <code>text/event-stream</code>. The <a href=\"http://haddock.stackage.org/lts-5.15/wai-extra-3.0.15.1/Network-Wai-EventSource.html\" rel=\"nofollow\">Network.Wai.EventSource</a> thing looks like a good candidate.</p>\n\n<p>I tried using this code:</p>\n\n<pre><code>import Network.Wai\nimport Network.Wai.EventSource\nimport Network.Wai.Middleware.AddHeaders\nimport Network.Wai.Handler.Warp (run)\nimport qualified Data.ByteString.Lazy as L\nimport qualified Data.ByteString.Lazy.Char8 as C\nimport Blaze.ByteString.Builder.ByteString\n\ntoEvent :: [L.ByteString] -&gt; ServerEvent\ntoEvent s = ServerEvent {\n    eventName = Nothing,\n    eventId = Nothing,\n    eventData = map fromLazyByteString s\n}\n\ncreateWaiApp :: IO L.ByteString -&gt; Application\ncreateWaiApp input = eventSourceAppIO $ fmap (toEvent . C.lines) input\n\nmain :: IO ()\nmain = run 1337 $ createWaiApp L.getContents\n</code></pre>\n\n<p>Which (I think) does:</p>\n\n<ul>\n<li>Reads stdin as a Lazy ByteStream</li>\n<li>Splits the ByteStream into lines</li>\n<li>Produces one ServerEvent for all the lines (this feels wrong - there should presumably be multiple events?)</li>\n<li>Builds a WAI Application from the <code>IO ServerEvent</code></li>\n<li>Binds the Application to port 1337</li>\n</ul>\n\n<p>When I run this (e.g. using <code>ping -c 5 example.com | stack exec test-exe</code>) it doesn't respond until the whole of stdin has been read.</p>\n\n<p>How do I build a Wai application that flushes out the HTTP connection every time it reads a <em>line</em> from stdin?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 2545568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LdpKP.png?s=128&g=1", "display_name": "justinpc", "link": "https://stackoverflow.com/users/2545568/justinpc"}, "edited": false, "score": 0, "creation_date": 1575805756, "post_id": 37093923, "comment_id": 104682085, "body": "the apotrophe in <code>(Bool : xs&#39;)</code> in <code>test1 :: (Eq a, Num a) =&gt; HList &#39;[HList (Bool : xs&#39;) -&gt; a -&gt; Bool]</code> should move before the <code>:</code>, to give <code>HList (Bool &#39;: xs)</code>. I couldn&#39;t apply this change as an edit, as it is too short."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1462656716, "creation_date": 1462656716, "answer_id": 37093923, "question_id": 37092580, "link": "https://stackoverflow.com/questions/37092580/ambiguous-type-variable-in-length-of-heterogeneous-list/37093923#37093923", "title": "Ambiguous type variable in length of heterogeneous list", "body": "<p>The problem isn't with <code>HLength</code>, and it's already as polymorphic as it can be. The issue is with <code>HIndex</code>, which is unnecessarily specific in the <code>xs</code> parameter. </p>\n\n<p>From <code>HIndex xs 'Zero Bool</code> we should be able to infer that <code>xs</code> has <code>Bool ': xs'</code> shape for some <code>xs'</code>. Since the <code>HIndex</code> implementation is driven by the <code>Nat</code> class parameter, we can leave the other parameters unspecified in the instance heads, and instead refine them in the instance constraints, enabling GHC to do the mentioned inference:</p>\n\n<pre><code>class HIndex xs i y | xs i -&gt; y where\n    hIndex :: HList xs -&gt; HNat i -&gt; y\n\ninstance (xs ~ (x ': xs')) =&gt; HIndex xs Zero x where\n    hIndex (x ::: xs) HZero = x\n\ninstance (xs ~ (y ': xs'), HIndex xs' i x) =&gt; HIndex xs (Succ i) x where\n    hIndex (x ::: xs) (HSucc i) = hIndex xs i\n</code></pre>\n\n<p>After this:</p>\n\n<pre><code>test1 :: (Eq a, Num a) =&gt; HList '[HList (Bool : xs') -&gt; a -&gt; Bool] \n</code></pre>\n\n<p>The <code>HIndex</code> constraint disappears, and the remaining constraints are resolved when <code>Num a</code> makes <code>a</code> default to <code>Integer</code>:</p>\n\n<pre><code>&gt; :t hLength test1\nhLength test1 :: HNat ('Succ 'Zero)\n</code></pre>\n\n<p>The general rule when computing with type classes is to move type dependencies into instance constraints, and only do those pattern matches in instance heads which are essential to instance definitions. This turns instance head matching problems (which immediately fail when parameters aren't of the right form) into constraint solving problems (which can be lazily solved based on information from other parts of the program). </p>\n"}, {"tags": [], "owner": {"reputation": 647, "user_id": 2545568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LdpKP.png?s=128&g=1", "display_name": "justinpc", "link": "https://stackoverflow.com/users/2545568/justinpc"}, "is_accepted": false, "score": 0, "last_activity_date": 1575805547, "creation_date": 1575805547, "answer_id": 59235053, "question_id": 37092580, "link": "https://stackoverflow.com/questions/37092580/ambiguous-type-variable-in-length-of-heterogeneous-list/59235053#59235053", "title": "Ambiguous type variable in length of heterogeneous list", "body": "<p>Alternatively, we could explicitly define the type of <code>test1</code> to be <code>test1 :: HList ((HList (Bool ': xs) -&gt; Int -&gt; Bool) ': '[])</code> alone.</p>\n\n<p>This allows us to leave the instance definitions as they were, and do away with the type equality constraints of form <code>xs ~ (x ': xs')</code> which Andr\u00e1s proposes.</p>\n\n<p>The choice is then whether you want to have to explicitly define the type of <code>test1</code>. The type equality constraints make it possible to define <code>test1</code> without also providing a type annotation.</p>\n"}], "owner": {"reputation": 3385, "user_id": 841562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4cbb35380ef84f4f0f68061f578a4e73?s=128&d=identicon&r=PG", "display_name": "Lemming", "link": "https://stackoverflow.com/users/841562/lemming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 37093923, "answer_count": 2, "score": 4, "last_activity_date": 1575805547, "creation_date": 1462647857, "question_id": 37092580, "link": "https://stackoverflow.com/questions/37092580/ambiguous-type-variable-in-length-of-heterogeneous-list", "title": "Ambiguous type variable in length of heterogeneous list", "body": "<p>I have an issue with ambiguous type variables when computing the length of a heterogeneous list. The problem seems to be that the length-function is not polymorphic in the HList's elements.</p>\n\n<h2>My Code</h2>\n\n<p>First, all the language extensions I'm using:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE NoMonomorphismRestriction #-}\n</code></pre>\n\n<p>Natural numbers are defined like so:</p>\n\n<pre><code>data Nat = Zero | Succ Nat\n\ndata HNat n where\n    HZero :: HNat Zero\n    HSucc :: HNat n -&gt; HNat (Succ n)\n</code></pre>\n\n<p>The heterogeneous list is defined as a GADT</p>\n\n<pre><code>data HList (ts :: [*]) where\n    HNil  :: HList '[]\n    (:::) :: t -&gt; HList ts -&gt; HList (t ': ts)\ninfixr 5 :::\n</code></pre>\n\n<p>We can query the length of an HList:</p>\n\n<pre><code>class HLength xs n | xs -&gt; n where\n    hLength :: HList xs -&gt; HNat n\n\ninstance HLength '[] Zero where\n    hLength HNil = HZero\n\ninstance HLength xs n =&gt; HLength (x ': xs) (Succ n) where\n    hLength (_ ::: xs) = HSucc (hLength xs)\n</code></pre>\n\n<p>We can index into an HList and retrieve the <code>i</code>-th element:</p>\n\n<pre><code>class HIndex xs i y | xs i -&gt; y where\n    hIndex :: HList xs -&gt; HNat i -&gt; y\n\ninstance HIndex (x ': xs) Zero x where\n    hIndex (x ::: xs) HZero = x\n\ninstance HIndex xs i y =&gt; HIndex (x ': xs) (Succ i) y where\n    hIndex (x ::: xs) (HSucc i) = hIndex xs i\n</code></pre>\n\n<h2>The Issue</h2>\n\n<p>With that established I'll demonstrate the issue.</p>\n\n<p>Suppose I construct an HList containing a function that itself takes an HList and does something with its first element.</p>\n\n<pre><code>test1 = ((\\l n -&gt; l `hIndex` HZero || n == 0) ::: HNil)\n</code></pre>\n\n<p>In this case the first element has to be a Bool. The derived type-signature confirms that constraint:</p>\n\n<pre><code>:: (Eq a, Num a, HIndex xs 'Zero Bool) =&gt;\n    HList '[HList xs -&gt; a -&gt; Bool]\n</code></pre>\n\n<p>Now I would like to calculate the length of the list <code>test</code>:</p>\n\n<pre><code>test2 = hLength test1\n</code></pre>\n\n<p>Unfortunately, this fails to compile with the following error message:</p>\n\n<pre><code>HListConstraints.hs:55:17:\n    No instance for (HIndex xs0 'Zero Bool)\n      arising from a use of \u2018test1\u2019\n    The type variable \u2018xs0\u2019 is ambiguous\n    Note: there is a potential instance available:\n      instance HIndex (x : xs) 'Zero x\n        -- Defined at HListConstraints.hs:42:10\n    In the first argument of \u2018hLength\u2019, namely \u2018test1\u2019\n    In the expression: hLength test1\n    In an equation for \u2018test2\u2019: test2 = hLength test1\nFailed, modules loaded: none.\n</code></pre>\n\n<p>The constraint on the list elements causes ambiguous type variables.</p>\n\n<p>My understanding is that I need to make <code>hLength</code> polymorphic in the elements of the list that is passed to it. <em>How can I do that?</em></p>\n"}, {"tags": ["windows", "haskell", "zeromq"], "answers": [{"tags": [], "owner": {"reputation": 3864, "user_id": 103054, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85c80d04f1fc401aa57b617340da5a36?s=128&d=identicon&r=PG", "display_name": "csiz", "link": "https://stackoverflow.com/users/103054/csiz"}, "is_accepted": false, "score": 5, "last_activity_date": 1490184524, "last_edit_date": 1490184524, "creation_date": 1462654124, "answer_id": 37093549, "question_id": 37091684, "link": "https://stackoverflow.com/questions/37091684/how-to-install-zeromq4-haskell-on-windows-cant-find-zmq-dependency/37093549#37093549", "title": "How to install zeromq4-haskell on windows? (can&#39;t find zmq dependency )", "body": "<p>It seems like I managed to solve it:</p>\n\n<ol>\n<li>copy <code>&lt;ZMQ&gt;\\lib\\libzmq-v120-mt-4_0_4.lib</code> to <code>&lt;ZMQ&gt;\\lib\\zmq.lib</code></li>\n<li>copy <code>&lt;ZMQ&gt;\\bin\\libzmq-v120-mt-4_0_4.dll</code> to <code>System32\\zmq.dll</code></li>\n<li>run:</li>\n</ol>\n\n<pre class=\"lang-bash prettyprint-override\"><code>cabal install zeromq4-haskell --extra-include-dirs=&lt;ZMQ&gt;\\include --extra-lib-dirs=&lt;ZMQ&gt;\\lib\n</code></pre>\n"}], "owner": {"reputation": 3864, "user_id": 103054, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85c80d04f1fc401aa57b617340da5a36?s=128&d=identicon&r=PG", "display_name": "csiz", "link": "https://stackoverflow.com/users/103054/csiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1490184524, "creation_date": 1462642591, "question_id": 37091684, "link": "https://stackoverflow.com/questions/37091684/how-to-install-zeromq4-haskell-on-windows-cant-find-zmq-dependency", "title": "How to install zeromq4-haskell on windows? (can&#39;t find zmq dependency )", "body": "<p>I installed zmq from the windows binaries <a href=\"http://zeromq.org/distro:microsoft-windows\" rel=\"nofollow\">http://zeromq.org/distro:microsoft-windows</a> then ran:</p>\n\n<pre><code>cabal install zeromq4-haskell --extra-include-dirs=\"F:\\thirdparty\\ZeroMQ4.0.4\\include\\\" --extra-lib-dirs=\"F:\\thirdparty\\ZeroMQ4.0.4\\lib\\\"\n</code></pre>\n\n<p>But I'm still missing the zmq dependency:</p>\n\n<pre><code>Resolving dependencies...\nConfiguring zeromq4-haskell-0.6.4...\nFailed to install zeromq4-haskell-0.6.4\nBuild log ( C:\\Users\\calin\\AppData\\Roaming\\cabal\\logs\\zeromq4-haskell-0.6.4.log ):\nConfiguring zeromq4-haskell-0.6.4...\nsetup-Simple-Cabal-1.22.5.0-x86_64-windows-ghc-7.10.3.exe: Missing dependency\non a foreign library:\n* Missing C library: zmq\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.\ncabal: Error: some packages failed to install:\nzeromq4-haskell-0.6.4 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>I also tried following this page, but I couldn't get anywhere <a href=\"http://gettingsharper.de/2015/06/23/bridging-the-worlds-with-omq/\" rel=\"nofollow\">http://gettingsharper.de/2015/06/23/bridging-the-worlds-with-omq/</a> . I didn't get what he meant by /bin or /lib.</p>\n\n<pre><code>cabal --version\ncabal-install version 1.22.6.0\nusing version 1.22.5.0 of the Cabal library\n\nghci --version\nThe Glorious Glasgow Haskell Compilation System, version 7.10.3\n</code></pre>\n\n<p>I need this to install ihaskell. Help?</p>\n"}, {"tags": ["haskell", "http-conduit", "servant"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1462643929, "post_id": 37091449, "comment_id": 61727466, "body": "Have a look at the <a href=\"http://www.serpentine.com/wreq/\" rel=\"nofollow noreferrer\"><code>wreq</code> package</a>"}], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "edited": false, "score": 0, "creation_date": 1462718871, "post_id": 37092158, "comment_id": 61744382, "body": "I use your code and I get a <code>TlsExceptionHostPort (HandshakeFailed (Error_Protocol (&quot;expecting server hello, got alert : [(AlertLevel_Fatal,HandshakeFailure)]&quot;,True,HandshakeFailure&zwnj;&#8203;))) &quot;thibaud.dauce.fr&quot; 443</code> even if my website as a perfectly valid HTTPS certificate\u2026"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "edited": false, "score": 0, "creation_date": 1462720150, "post_id": 37092158, "comment_id": 61744732, "body": "<code>wreq</code> uses <a href=\"https://github.com/vincenthz/hs-tls\" rel=\"nofollow noreferrer\"><code>hs-tls</code></a> and there have been issues with certain kinds of certificates and ciphers. I would build the latest version from the github repo and run the <code>tis-simpleclient</code> program to get more diagnostic info. And also check the issue tracker - there have been problems with specific ISP providers."}, {"owner": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "edited": false, "score": 0, "creation_date": 1462722359, "post_id": 37092158, "comment_id": 61745468, "body": "Already publish an issue to have more information <a href=\"https://github.com/vincenthz/hs-tls/issues/142\" rel=\"nofollow noreferrer\">github.com/vincenthz/hs-tls/issues/142</a> a few days ago. <code>tls-simpleclient</code> seems to fail too\u2026 Thanks for your help and for your code samples again!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1462645515, "creation_date": 1462645515, "answer_id": 37092158, "question_id": 37091449, "link": "https://stackoverflow.com/questions/37091449/get-the-status-code-of-a-webpage-in-haskell/37092158#37092158", "title": "Get the status code of a webpage in Haskell", "body": "<p>Some examples using <a href=\"http://www.serpentine.com/wreq/tutorial.html\" rel=\"nofollow\"><code>wreq</code></a></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Network.Wreq\nimport Control.Lens\nimport Control.Exception as E\nimport Network.HTTP.Client (HttpException)\n\ntest1 = do\n  r &lt;- get \"https://httpbin.org/get\"\n  print $ r ^. responseStatus . statusCode\n\n-- throws an exception\ntest2 = do\n  r &lt;- get \"https://www.google123123.com\"\n  print $ r ^. responseStatus . statusCode\n\ntestUrl url = do\n  r &lt;- get url\n  return $ r ^. responseStatus . statusCode\n\n-- catching the exception\ntest3 = do\n  st &lt;- testUrl \"https://www.google123123123.com\"  `E.catch` handler\n  print st\n  where\n    handler :: HttpException -&gt; IO Int\n    handler _ = return 999\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 3191372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/jqFzX.jpg?s=128&g=1", "display_name": "Thibaud Dauce", "link": "https://stackoverflow.com/users/3191372/thibaud-dauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462645515, "creation_date": 1462641355, "question_id": 37091449, "link": "https://stackoverflow.com/questions/37091449/get-the-status-code-of-a-webpage-in-haskell", "title": "Get the status code of a webpage in Haskell", "body": "<p>I'm trying to find a way to check if a webpage exists in Haskell. The server is HTTP2 / HTTPS only and I'm trying to check if the page exists in a servant application.</p>\n\n<p>Is there any Haskell packages with good documentation to just check if the status code is 200 or 404? And working with strong HTTPS and HTTP2 servers?</p>\n\n<p>Here what I currently have with http-conduit but I'm receiving weird exceptions (TlsExceptionHostPort (HandshakeFailed (Error_Protocol (\"expecting server hello, got alert : [(AlertLevel_Fatal,HandshakeFailure)]\",True,HandshakeFailure))) \"thibaud.dauce.fr\" 443 and StatusCodeException).</p>\n\n<pre><code>... other imports\nimport qualified Network.HTTP.Conduit as HTTP\n\n... other types\ntype AppM = ReaderT Config (EitherT ServantErr IO)\n\nnewComment :: String -&gt; OneComment -&gt; AppM Int64\nnewComment baseUrl oneComment = do\n    time &lt;- liftIO getCurrentTime\n    response &lt;- HTTP.withManager $ \\manager -&gt; do\n        request &lt;- HTTP.parseUrl $ url oneComment\n        HTTP.httpLbs request manager\n    case (statusIsSuccessful $ HTTP.responseStatus response, startswith baseUrl (url oneComment)) of\n        (_, False) -&gt; return 0\n        (True, True) -&gt; do\n            theNewComment &lt;- runDb $ insert $ Comment (url oneComment) (content oneComment) time\n            return $ fromSqlKey theNewComment\n        _ -&gt; return 0\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 2, "creation_date": 1462639005, "post_id": 37090970, "comment_id": 61725748, "body": "Reverse the encoding. Currently the outermost constructor is the most significant bit, with E meaning &quot;no more bits&quot;. If you make the outermost constructor the least significant bit, the log2 implementation doesn&#39;t change, but the full adder algorithm becomes doable again, because as you step into two numbers, the bits mean the same thing."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1462639227, "post_id": 37090970, "comment_id": 61725835, "body": "@SebastianRedl yes, I just thought about that! Interesting. That might make a full adder feasible indeed. Let me think about it now!"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1462639288, "post_id": 37090970, "comment_id": 61725855, "body": "@JohnColeman it looked obscure, indeed, but with his idea, now it is easy to find the encoded number. Something like that: <code>foldN (\\ n r -&gt; n (r*2)) (\\ n r -&gt; n (r*2+1)) (r -&gt; r) n 1</code>."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1462639365, "post_id": 37090970, "comment_id": 61725881, "body": "Also, before I go: any intuitive reason this encoding seems to exclude 0?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1462639784, "post_id": 37090970, "comment_id": 61726023, "body": "@JohnColeman I&#39;m not sure what you mean. I said that, by counting the number of <code>A</code>s and <code>B</code>s, you get <code>log2(N)</code>. So, for 8, there are 3 <code>A</code>s - i.e., <code>log2(8) == 3</code>."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1462640170, "post_id": 37090970, "comment_id": 61726175, "body": "I see -- I took &quot;log2&quot; as the name of your encoding."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1462646060, "post_id": 37090970, "comment_id": 61728159, "body": "@Viclib On intuition: treat <code>A</code> as 0 and <code>B</code> as 1 in the usual binary representation of numbers. Then in your encoding there is an implicit 1 that you do not include; but since you don&#39;t include it, <i>every</i> number has a 1 in its most significant digit, hence you cannot represent 0."}, {"owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "edited": false, "score": 0, "creation_date": 1463518730, "post_id": 37090970, "comment_id": 62097213, "body": "I think using <code>E</code> as <code>0</code> instead of <code>1</code> is a better solution here, since that will actually make this representation closed w.r.t. <code>log2</code> (i.e. you can represent result of <code>log2</code> as <code>N</code>). Implementation is marginally more complicated (i.e. number of <code>A</code>s and <code>B</code>s minus one), but it boils down to 2 additional pattern matches. Besides, adding <code>0</code> will make your <code>N</code> a commutative semiring under normal addition and multiplication."}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1462643279, "creation_date": 1462638505, "last_edit_date": 1462643279, "question_id": 37090970, "link": "https://stackoverflow.com/questions/37090970/how-to-add-numbers-under-that-encoding", "title": "How to add numbers under that encoding?", "body": "<p>As an fun experiment, I was looking for a binary representation of natural numbers with the simplest implementation of <code>log2</code>. This is the encoding I came up with:</p>\n\n<pre><code>data N = A N | B N | E\n</code></pre>\n\n<p>Where:</p>\n\n<pre><code>1       E\n2       (A E)\n3       (B E)\n4       (A (A E))\n5       (A (B E))\n6       (B (A E))\n7       (B (B E))\n8       (A (A (A E)))\n9       (A (A (B E)))\n10      (A (B (A E)))\n11      (A (B (B E)))\n12      (B (A (A E)))\n13      (B (A (B E)))\n14      (B (B (A E)))\n15      (B (B (B E)))\n16      (A (A (A (A E))))\n</code></pre>\n\n<p>That makes <code>log2</code> as trivial as possible: you just count the number of <code>A</code> and <code>B</code>s! On that encoding, the usual \"full adder\" algorithm doesn't work anymore. Is there any simple algorithm that sums two numbers of N?</p>\n"}, {"tags": ["haskell", "functor", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1462636588, "post_id": 37090473, "comment_id": 61724903, "body": "Thank you! Isn&#39;t <code>pure</code> not somehow misleading? From the name I would somehow expect the complete opposite. e.g. <code>let impure = pure :: a -&gt; IO a</code>. Is there some reason?"}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "reply_to_user": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 2, "creation_date": 1462636855, "post_id": 37090473, "comment_id": 61724988, "body": "@hgiesel it is <a href=\"http://stackoverflow.com/questions/3435308/naming-of-pure-function-in-control-applicative\">just a name</a> and has nothing to do with purity."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 1, "creation_date": 1462651002, "post_id": 37090473, "comment_id": 61729821, "body": "@hgiesel I read <code>pure x</code> as &quot;inject the pure value <code>x</code> in the applicative&quot; (even if this reading would imply that applicative values are somehow impure, which is not the case...)"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 4, "last_activity_date": 1462635788, "creation_date": 1462635788, "answer_id": 37090473, "question_id": 37090393, "link": "https://stackoverflow.com/questions/37090393/without-having-to-wrap-the-second-argument/37090473#37090473", "title": "(&lt;*&gt;) without having to wrap the second argument", "body": "<p>You can use <code>pure</code>:</p>\n\n<pre><code>pure :: Applicative f =&gt; a -&gt; f a\n\nfoo &lt;*&gt; pure i\n</code></pre>\n\n<p>although you could just use <code>fmap</code>:</p>\n\n<pre><code>fmap (\\f -&gt; f i) foo\n</code></pre>\n\n<p>or</p>\n\n<pre><code>fmap ($ i) foo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 3, "last_activity_date": 1462636939, "creation_date": 1462636939, "answer_id": 37090672, "question_id": 37090393, "link": "https://stackoverflow.com/questions/37090393/without-having-to-wrap-the-second-argument/37090672#37090672", "title": "(&lt;*&gt;) without having to wrap the second argument", "body": "<pre><code>(&lt;@&gt;) :: MyConcept m =&gt; m (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>To see if this is like an Applicative try deriving <code>&lt;@&gt;</code> from <code>&lt;*&gt;</code> and <code>pure</code>. You will find that it is impossible.</p>\n\n<p>Where you can find <code>&lt;@&gt;</code> in a more general form is <code>extract :: (Counit w) =&gt; w a -&gt; a</code> for <a href=\"http://hackage.haskell.org/package/definitive-base-2.3/docs/Algebra-Classes.html#t:Comonad\" rel=\"nofollow\">comonads</a>.</p>\n\n<p>Can you implement <code>extract</code> for <code>Maybe</code>? What do you do when the value is <code>Nothing</code>?</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 37090473, "answer_count": 2, "score": 3, "last_activity_date": 1462636939, "creation_date": 1462635327, "question_id": 37090393, "link": "https://stackoverflow.com/questions/37090393/without-having-to-wrap-the-second-argument", "title": "(&lt;*&gt;) without having to wrap the second argument", "body": "<p>Haskell newbie here.\nSo <code>(&lt;$&gt;)</code> is defined as</p>\n\n<pre><code>(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>And <code>(&lt;*&gt;)</code> is defined as</p>\n\n<pre><code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>But I feel like <code>Applicative</code> is two concepts in one:</p>\n\n<ol>\n<li>One would be that of a functor</li>\n<li>And one would be this:</li>\n</ol>\n\n<pre><code>(&lt@&gt) :: MyConcept m => m (a -> b) -> a -> b</code></pre>\n\n<p>So e.g. thinking in terms of <code>Maybe</code>:</p>\n\n<p>I have an <code>let i = 4</code> and I have a <code>let foo = Nothing :: Num a =&gt; Maybe (a -&gt; a)</code>.\nBasically I have a function that may or may not be there, that takes an Int and returns an Int, and an actual Int.</p>\n\n<p>Of course I could just wrap <code>i</code> by saying:</p>\n\n<pre><code>foo &lt;*&gt; Just i\n</code></pre>\n\n<p>But that requires me to know the what Applicative <code>foo</code> is wrapped in.\nIs there something equivalent to what I described here? How would I go about implementing that function <code>&lt;@&gt;</code> myself?</p>\n\n<p>It would be something like this:</p>\n\n<pre><code>let (&lt;@&gt;) func i = func &lt;*&gt; ??? i\n</code></pre>\n"}, {"tags": ["file", "haskell", "io"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6304311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbdcf06bd6cae6ffb5397a867965964?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Bill", "link": "https://stackoverflow.com/users/6304311/tim-bill"}, "edited": false, "score": 0, "creation_date": 1462642273, "post_id": 37090958, "comment_id": 61726913, "body": "This is a nice approach, but the only problem is, I want to add [d6] to the same list after [d1,d2,d5].. because afterwards, i am going to search the term &quot;this&quot; ,that would return the list of all the documents that contain the word &quot;this&quot;."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 33, "user_id": 6304311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbdcf06bd6cae6ffb5397a867965964?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Bill", "link": "https://stackoverflow.com/users/6304311/tim-bill"}, "edited": false, "score": 0, "creation_date": 1462643747, "post_id": 37090958, "comment_id": 61727403, "body": "I am assuming that you are going to load the index into memory before using it. If that&#39;s not the case, just store the data in a sqlite database file - or a dbm / gdbm / BerkeleyDB file. Seeing what your current lookup code is like would help."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1462638447, "creation_date": 1462638447, "answer_id": 37090958, "question_id": 37090362, "link": "https://stackoverflow.com/questions/37090362/how-to-compare-the-already-existing-file-with-new-file-haskell/37090958#37090958", "title": "How to compare the already existing file with new file haskell", "body": "<p>Since your primary use case is adding a document to the index, how about this:</p>\n\n<ol>\n<li>Your index file consists of text lines, one line per key.</li>\n<li>When reading the index you insert the key-value pair to your Map (or whatever you are using as your inverted index) if it the first time you have seen the key. Otherwise, if the key already exists you append/prepend the value to the existing value in the Map.</li>\n<li>To add a new document, simply seek to the end of the file and write out the pairs for just the new document.</li>\n</ol>\n\n<p>For example, suppose your index file contains the lines:</p>\n\n<pre><code>(\"this\",[d1,d2,d5])\n...\n(\"this\", [d6])\n</code></pre>\n\n<p>When you encounter the first \"this\" pair you would create the pair in your Map, and when you encountered the second \"this\" pair you would append/prepend <code>d6</code> to the current list associated with the key.</p>\n"}], "owner": {"reputation": 33, "user_id": 6304311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fbdcf06bd6cae6ffb5397a867965964?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Bill", "link": "https://stackoverflow.com/users/6304311/tim-bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462638447, "creation_date": 1462635179, "question_id": 37090362, "link": "https://stackoverflow.com/questions/37090362/how-to-compare-the-already-existing-file-with-new-file-haskell", "title": "How to compare the already existing file with new file haskell", "body": "<p>I am implementing inverted index in haskell. \nI have already made the case where my code would create the inverted index of every word in the list of documents that i provide. and then write this index to a file called inv.txt which would be something like:</p>\n\n<p>(\"this\",[d1,d2,d5]) </p>\n\n<p>(\"is\",[d3,d4,d16])</p>\n\n<p>(\"hello\",[d1])</p>\n\n<p>However, I want to add an additional case, where if I add a new document to my folder, and call the function, the \"inv.txt\" gets updated according to the newly added document.\nso it now becomes something like</p>\n\n<p>(\"this\",[d1,d2,d5,new Doc]) </p>\n\n<p>(\"is\",[d3,d4,d16])</p>\n\n<p>(\"hello\",[d1])</p>\n\n<p>(\"get\",[new Doc])</p>\n\n<p>but I can not think of an approach to go about it. is this somehow possible in haskell? (without re writing the whole file, like using seekg or peekg functions or something)?</p>\n"}, {"tags": ["haskell", "matrix", "nonlinear-optimization", "automatic-differentiation"], "owner": {"reputation": 669, "user_id": 5025261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/163727f297f2568604d1b626d3631716?s=128&d=identicon&r=PG&f=1", "display_name": "MASL", "link": "https://stackoverflow.com/users/5025261/masl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1462633099, "creation_date": 1462625838, "last_edit_date": 1462633099, "question_id": 37088840, "link": "https://stackoverflow.com/questions/37088840/automatic-differentiation-ad-with-respect-to-list-of-matrices-in-haskell", "title": "Automatic differentiation (AD) with respect to list of matrices in Haskell", "body": "<p>I am trying to understand how can I use <code>Numeric.AD</code> (automatic differentiation) in Haskell.</p>\n\n<p>I defined a simple matrix type and a scalar function taking an array and two matrices as arguments. I want to use AD to get the gradient of the scoring function with respect to both matrices, but I'm running into compilation problems. Here is the code</p>\n\n<pre><code>{-# LANGUAGE DeriveTraversable, DeriveFunctor, DeriveFoldable #-}\nimport Numeric.AD.Mode.Reverse as R\nimport Data.Traversable as T\nimport Data.Foldable as F\n\n--- Non-linear function on \"vectors\"\nlogistic x = 1.0 / (1.0 + exp(-x) )\nphi v = map logistic v\nphi' (x:xs) = x : (phi xs)\n\n--- dot product\ndot u v = foldr (+) 0 $ zipWith (*) u v\n\n--- simple matrix type\ndata Matrix a = M [[a]] deriving (Eq,Show,Functor,F.Foldable,T.Traversable)\n\n--- action of a matrix on a vector\nmv _ [] = []\nmv (M []) _ = []\nmv ( M m ) v = ( dot (head m)  v ) :  (mv (M (tail m)) v )\n\n--- two matrices\nmbW1 = M $ [[1,0,0],[-1,5,1],[1,2,-3]]\nmbW2 = M $ [[0,0,0],[1,3,-1],[-2,4,6]]\n\n--- two different scoring functions\nsc1 v m = foldr (+) 0 $ (phi' . (mv m) )  v  \n\nsc2 :: Floating a =&gt; [a] -&gt; [Matrix a] -&gt; a\nsc2 v [m1, m2] = foldr (+) 0 $ (phi' . (mv m2) . phi' . (mv m1) ) v\n\nstrToInt = read :: String -&gt; Double\nstrLToIntL = map strToInt\n--- testing\nmain = do\n        putStrLn $ \"mbW1:\" ++ (show mbW1)\n        putStrLn $ \"mbW2:\" ++ (show mbW2)\n        rawInput &lt;-  readFile \"/dev/stdin\"\n        let xin= strLToIntL $ lines rawInput\n        putStrLn \"sc xin mbW1\"\n        print $ sc1 xin mbW1  --- ok. = \n        putStrLn \"grad (sc1 xin) mbW1\"\n        print $ grad ( sc1 xin) mbW1   -- yields an error: expects xin [Reverse s Double] instead of [Double]\n        putStrLn \"grad (sc1 [3,5,7]) mbW1\"\n        print $ grad ( sc1 [3,5,7]) mbW1   --- ok. =\n        putStrLn \"sc2 xin [mbW1,mbW2]\"\n        print $ sc2 xin [mbW1, mbW2]\n        putStrLn \"grad (sc2 [3,5,7) [mbW1,mbW2]\"\n        print $ grad ( sc2 [3,5,7]) [mbW1, mbW2]  --- Error: see text\n</code></pre>\n\n<p>The last line (grad on sc2) gives the following error:</p>\n\n<pre><code>Couldn't match type \u2018Reverse s (Matrix Double)\u2019\n               with \u2018Matrix (Reverse s (Matrix Double))\u2019\nExpected type: [Reverse s (Matrix Double)]\n               -&gt; Reverse s (Matrix Double)\n  Actual type: [Matrix (Reverse s (Matrix Double))]\n               -&gt; Reverse s (Matrix Double)\nIn the first argument of \u2018grad\u2019, namely \u2018(sc2 [3, 5, 7])\u2019\nIn the second argument of \u2018($)\u2019, namely\n  \u2018grad (sc2 [3, 5, 7]) [mbW1, mbW2]\u2019\n</code></pre>\n\n<p>I don't understand where the \"Matrix of Matrix\" in the actual type seen comes from. I'm feeding the <code>grad</code> with a curried version of sc2, making it a function on a list of Matrix.</p>\n\n<p>Commenting out the two offending lines runs without problem, i.e., the first gradient works and is correctly calculated (I'm feeding [1,2,3] as input to the program):</p>\n\n<pre><code>mbW1:M [[1.0,0.0,0.0],[-1.0,5.0,1.0],[1.0,2.0,-3.0]]\nmbW2:M [[0.0,0.0,0.0],[1.0,3.0,-1.0],[-2.0,4.0,6.0]]\nsc1 xin mbW1\n1\n2\n3\n2.0179800657874893\ngrad (sc1 [3,5,7]) mbW1\nM [[3.0,5.0,7.0],[7.630996942126885e-13,1.2718328236878141e-12,1.7805659531629398e-12],[1.0057130122694228e-3,1.6761883537823711e-3,2.3466636952953197e-3]]\nsc2 xin [mbW1,mbW2]\n1.8733609463863194\n</code></pre>\n\n<p>Both errors are an issue. I want to take the gradient of any such <code>sc2</code> scoring function, depending on an array of matrices, evaluated at any given \"point\" xin. Clearly, I'm not yet understanding the AD library well enough. Any help would be appreciated. </p>\n"}, {"tags": ["haskell", "vector", "haskell-vector"], "comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462624527, "post_id": 37088222, "comment_id": 61721121, "body": "what&#39;s the goal, why not use simple pairs <code>(,)</code> how should <code>f</code> and <code>g</code> types interact? At one point you say that <code>g</code> is list of <code>f</code>s but then you want <code>f</code> to be fixed sized but <code>g</code> and its sublists to not be fixed."}, {"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462626186, "post_id": 37088222, "comment_id": 61721628, "body": "<code>f</code> can be fixed, but does not have to be. I did not mean that <code>g</code> is a list of <code>f</code>s; rather, it is a list of sub lists with the same elements as <code>f</code> (but likely a in different order). <code>f</code> is passed to a function that returns, for each element, the index of the sub list in <code>g</code> where the element should be put. I guess I can use simple pairs instead of Vector.Fixed. Is the difference between them that pairs are fixed sized linked lists, while V.Fixed is unlinked?"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462626536, "post_id": 37088222, "comment_id": 61721752, "body": "I&#39;d say pair is more like a <code>struct</code>."}, {"owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1462626729, "post_id": 37088222, "comment_id": 61721818, "body": "How are pairs different from V.Fixed? Specifically, the tuples with only contain Ints, will always contain 2 values."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 2, "creation_date": 1462638420, "post_id": 37088222, "comment_id": 61725539, "body": "<code>Data.Vector.Unboxed</code> is from the <code>vector</code> package, which is one of the most important packages in the usual haskell ecosystem (total downloads 199903). vectors in the sense of <code>vector</code> can be any length, so that e.g. ordinary <code>Prelude</code> like functions like <code>take</code> and <code>drop</code> are supported. <code>fixed-vector</code> (total downloads 5281) attempts to use some of the framework from <code>vector</code> to make a general library for vectors of fixed length."}], "owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462626536, "creation_date": 1462622213, "last_edit_date": 1462626536, "question_id": 37088222, "link": "https://stackoverflow.com/questions/37088222/haskell-converting-between-vector-types", "title": "Haskell converting between vector types", "body": "<p>I'm starting to learn Haskell, but I'm finding it hard to figure out the small, little things that the tutorials jumps over. Right now I'm working with tuples in the form of Vector.Fixed:</p>\n\n<pre><code>import qualified Data.Vector.Fixed as VF\nimport qualified Data.Vector.Fixed.Unboxed (Vec 2)\nimport qualified Data.Vector.Unboxed as VU\n\nlet a = VF.mk2 7 7 :: (Int, Int)\nlet b = VF.mk2 7 7 :: (Vec2 Int)\n</code></pre>\n\n<ol>\n<li><p>What's difference between <code>a</code> and <code>b</code>?</p></li>\n<li><p>How can I make a VF vector <code>f</code> equivalent of \n<code>[a, a] = [(7,7), (7,7)]</code>?</p></li>\n<li><p>How can I make a VU vector <code>g</code> equivalent of <code>[[a], [a,a]] = [[(7,7)], [(7,7), (7,7)]]</code>?</p></li>\n</ol>\n\n<p>For question 2 and 3, I can't get past the type errors when trying to use the <code>convert</code> function.</p>\n\n<ol start=\"4\">\n<li><p>I know that my tuples always will be of length 2,  but I need a list\n(or whatever) <code>f</code> of tuples that can be fixed size, and another <code>g</code>\nthat is two-dimensional (e.g. <code>[[(1,2),(3,4)],[(1,2)]]</code> where\nneither the top list nor the sub lists can be of fixed size. Should\nI stick to the same type for <code>f</code> and <code>g</code>?</p></li>\n<li><p>Data.Vector.Fixed and Data.Vector.Unboxed both seem to come from the\nsame package, but they have different maintainers. Are they both\nofficial, so to speak, or do they not share any similarities other\nthan that they both are vector implementations?</p></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462611910, "post_id": 37086579, "comment_id": 61717320, "body": "not by itself (it&#39;ll produce lists) - but you can combine it with other functions after"}, {"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1462612992, "post_id": 37086579, "comment_id": 61717629, "body": "@Carsten, do you have an example?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1462650764, "post_id": 37086766, "comment_id": 61729730, "body": "Nice! We can also use <code>let f x y = do guard (x - y &lt; 0); return (x - y)</code>"}], "tags": [], "owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "is_accepted": false, "score": 6, "last_activity_date": 1462613033, "creation_date": 1462613033, "answer_id": 37086766, "question_id": 37086579, "link": "https://stackoverflow.com/questions/37086579/return-a-nothing-from-while-zipping/37086766#37086766", "title": "Return a Nothing from while zipping", "body": "<p>You can use <code>Control.Monad.zipWithM</code> with a custom function doing the subtraction:</p>\n\n<pre><code>Prelude&gt; let f x y = if x - y &lt; 0 then Nothing else Just (x - y)\nPrelude&gt; import Control.Monad\nPrelude Control.Monad&gt; zipWithM f [5,6,7,8,9] [1,2,3,9,5]\nNothing\nPrelude Control.Monad&gt; zipWithM f [5,6,7,9,9] [1,2,3,9,5]\nJust [4,4,4,0,4]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "is_accepted": false, "score": 2, "last_activity_date": 1462613102, "creation_date": 1462613102, "answer_id": 37086780, "question_id": 37086579, "link": "https://stackoverflow.com/questions/37086579/return-a-nothing-from-while-zipping/37086780#37086780", "title": "Return a Nothing from while zipping", "body": "<p>No need to put everything in zipWith. Haskell is lazy. Processing is done when list is evaluated.</p>\n\n<pre><code>differences = zipWith (-) [5,6,7,8,9] [1,2,3,9,5]\nresult | any (&lt;0) differences = Nothing\n       | otherwise = Just differences\n</code></pre>\n\n<p>Downside is that it is needed to evaluate whole list (untill condition), but that can not be avoided for requirement.</p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1462613135, "creation_date": 1462611700, "last_edit_date": 1462613135, "question_id": 37086579, "link": "https://stackoverflow.com/questions/37086579/return-a-nothing-from-while-zipping", "title": "Return a Nothing from while zipping", "body": "<p>I'm zipping two lists using <code>-</code> as follows:</p>\n\n<pre><code>differences = zipWith (-) [5,6,7,8,9] [1,2,3,9,5]\n</code></pre>\n\n<p>Is it possible for <code>differences</code> to return a <code>Nothing</code> if one of the zipped items is negative? So I'd like the function to stop zipping and return <code>Nothing</code> when it hits the 4th item in the above example.</p>\n\n<p>Edit: or how do I combine it with other functions to get the desired behaviour?</p>\n"}, {"tags": ["parsing", "haskell", "indentation", "parsec", "parser-combinators"], "answers": [{"comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1462621840, "post_id": 37087537, "comment_id": 61720256, "body": "Promising, but... with this approach, if I want to reinstate the <code>caseBlock</code> (which requires using <code>term1</code> unless I misunderstood something), parsing now fails on the <code>o</code> of <code>of</code>, in <code>case X of</code>. I guess because the term <code>X</code> doesn&#39;t consume its trailing space now, and so it is parsed as an application of <code>X</code> to <code>of</code>..."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1462617854, "creation_date": 1462617854, "answer_id": 37087537, "question_id": 37086013, "link": "https://stackoverflow.com/questions/37086013/parsing-juxtaposition-based-indentation-aware-syntax-using-text-parsec-layout/37087537#37087537", "title": "Parsing juxtaposition-based, indentation-aware syntax using Text.Parsec.Layout", "body": "<p>I think the problem has to do with that <code>name</code> already eliminates the following space, so the <code>sepBy1</code> in the definition of <code>term</code> doesn't see it.</p>\n\n<p>Consider these simplified versions of <code>term</code>:</p>\n\n<pre><code>term0 = foldl1 App &lt;$&gt; (Var &lt;$&gt; name) `sepBy1` space\n\nterm1 = foldl1 App &lt;$&gt; (Var &lt;$&gt; name') `sepBy1` space\n\nname' = (:) &lt;$&gt; upper &lt;*&gt; many alphaNum\n\nterm3 = foldl1 App &lt;$&gt; many (Var &lt;$&gt; name)\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>runP term0 \"A B C\"   -- fails\nrunP term1 \"A B C\"   -- succeeds\nrunP term3 \"A B C\"   -- succeeds\n</code></pre>\n\n<p>I think part of the solution is to define</p>\n\n<pre><code>part = [ caseBlock, Var &lt;$&gt; name' ]\n</code></pre>\n\n<p>where <code>name'</code> is as above. However, there are still some issues.</p>\n"}], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462617854, "creation_date": 1462607765, "question_id": 37086013, "link": "https://stackoverflow.com/questions/37086013/parsing-juxtaposition-based-indentation-aware-syntax-using-text-parsec-layout", "title": "Parsing juxtaposition-based, indentation-aware syntax using Text.Parsec.Layout", "body": "<p>I'm trying to parse a small language with Haskell-like syntax, using <a href=\"https://github.com/luqui/parsec-layout\" rel=\"nofollow\"><code>parsec-layout</code></a>. The two key features that don't seem to interact too well with each other are:</p>\n\n<ul>\n<li>Function application syntax is juxtaposition, i.e. if <code>F</code> and <code>E</code> are terms, <code>F E</code> is the syntax for <code>F</code> applied to <code>E</code>.</li>\n<li><p>Indentation can be used to denote nesting, i.e. the following two are equivalent:</p>\n\n<pre><code>X = case Y of\n  A -&gt; V\n  B -&gt; W\n\nX = case Y of A -&gt; V; B -&gt; W\n</code></pre></li>\n</ul>\n\n<p>I haven't managed to figure out a combination of skipping and keeping whitespace that would allow me to parse a list of such definitions. Here's my simplified code:</p>\n\n<pre><code>import Text.Parsec hiding (space, runP)\nimport Text.Parsec.Layout\nimport Control.Monad (void)\n\ntype Parser = Parsec String LayoutEnv\n\ndata Term = Var String\n          | App Term Term\n          | Case Term [(String, Term)]\n          deriving Show\n\nname :: Parser String\nname = spaced $ (:) &lt;$&gt; upper &lt;*&gt; many alphaNum\n\nkw :: String -&gt; Parser ()\nkw = void . spaced . string\n\nreserved :: String -&gt; Parser ()\nreserved s = try $ spaced $ string s &gt;&gt; notFollowedBy alphaNum\n\nterm :: Parser Term\nterm = foldl1 App &lt;$&gt; part `sepBy1` space\n  where\n    part = choice [ caseBlock\n                  , Var &lt;$&gt; name\n                  ]\n\n    caseBlock = Case &lt;$&gt; (reserved \"case\" *&gt; term &lt;* reserved \"of\") &lt;*&gt; laidout alt\n\n    alt = (,) &lt;$&gt; (name &lt;* kw \"-&gt;\") &lt;*&gt; term\n\nbinding :: Parser (String, Term)\nbinding = (,) &lt;$&gt; (name &lt;* kw \"=\") &lt;*&gt; term\n\n-- https://github.com/luqui/parsec-layout/issues/1\ntrim :: String -&gt; String\ntrim = reverse . dropWhile (== '\\n') . reverse\n\nrunP :: Parser a -&gt; String -&gt; Either ParseError a\nrunP p = runParser (p &lt;* eof) defaultLayoutEnv \"\" . trim\n</code></pre>\n\n<p>If I try to run it on input like</p>\n\n<pre><code>s = unlines [ \"A = case B of\"\n            , \" X -&gt; Y Z\"\n            , \"C = D\"\n            ]\n</code></pre>\n\n<p>via <code>runP (laidout binding) s</code>, it fails on the application <code>Y Z</code>:</p>\n\n<pre><code>(line 2, column 10):\nexpecting space or semi-colon\n</code></pre>\n\n<p>However, if I change the definition of <code>term</code> to</p>\n\n<pre><code>term = foldl1 App &lt;$&gt; many1 part\n</code></pre>\n\n<p>then it doesn't stop parsing the term at the start of the (unindented!) third line, leading to</p>\n\n<pre><code>(line 3, column 4):\nexpecting semi-colon\n</code></pre>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1462614507, "post_id": 37084569, "comment_id": 61718100, "body": "You forgot : 6) print... are all at the top level, not in the definition of insert ; 7) insert is only defined for an empty list ; 8) Type names must start with an uppercase letter (linked with the data issue) ; 9) A list can&#39;t contain several different types, that&#39;s for tuples ;"}, {"owner": {"reputation": 23, "user_id": 5901029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d668c8c3edfd45e37f9517e6c6dabc?s=128&d=identicon&r=PG&f=1", "display_name": "Anvika Kumar", "link": "https://stackoverflow.com/users/5901029/anvika-kumar"}, "edited": false, "score": 0, "creation_date": 1462633741, "post_id": 37084569, "comment_id": 61723980, "body": "I have declared the IO monad on the top. Just didn&#39;t include that. I rectified the use of data keyword. Yes I have to use Eq =&gt; a and also main is defined somewhere like in a switch case so control returns to that."}, {"owner": {"reputation": 23, "user_id": 5901029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d668c8c3edfd45e37f9517e6c6dabc?s=128&d=identicon&r=PG&f=1", "display_name": "Anvika Kumar", "link": "https://stackoverflow.com/users/5901029/anvika-kumar"}, "edited": false, "score": 0, "creation_date": 1462633786, "post_id": 37084569, "comment_id": 61723989, "body": "Can you show me or refer a sample code for this. How to do manipulations like these ? Thanks for the answers."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 3, "last_activity_date": 1462596120, "creation_date": 1462596120, "answer_id": 37084569, "question_id": 37084518, "link": "https://stackoverflow.com/questions/37084518/insert-a-list-of-user-inputs-into-a-list-of-lists-in-haskell/37084569#37084569", "title": "Insert a list of user inputs into a list of lists in haskell", "body": "<p>There are many problems with this code</p>\n\n<ol>\n<li><code>print</code>, <code>getLine</code> needs the <code>IO</code> monad.</li>\n<li><code>data</code> is a reserved keyword, you can't use it as a variable name.  You've also defined the value of <code>data</code> 3 times.</li>\n<li><code>insert</code> has a type, but no definition.</li>\n<li>There is no <code>main</code></li>\n<li>I think you meant to use <code>Eq a=&gt;</code>, not (eq a)....  But I am not sure.</li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 5901029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d668c8c3edfd45e37f9517e6c6dabc?s=128&d=identicon&r=PG&f=1", "display_name": "Anvika Kumar", "link": "https://stackoverflow.com/users/5901029/anvika-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462596120, "creation_date": 1462595543, "last_edit_date": 1462595836, "question_id": 37084518, "link": "https://stackoverflow.com/questions/37084518/insert-a-list-of-user-inputs-into-a-list-of-lists-in-haskell", "title": "Insert a list of user inputs into a list of lists in haskell", "body": "<p>I am trying to create  a student record system in haskell wherein I have to take a user input of name, birthday month and birthday date and then perform operations such as searching deleting etc. So i thought of creating lists of lists. each list has a list inside it that contains record of each person. But I am unable to code it. </p>\n\n<p>code is as follows:</p>\n\n<pre><code>type data = [String,Int,Int]\ninsert :: (eq a) -&gt; [a] -&gt; [[a]]\n  print \"Enter the name\"\n  name &lt;- getLine\n  print \"Enter the month\"\n  month &lt;- getLine\n  print \"Enter the date\"\n  date &lt;- getLine\n  insert [] = [data]\n    where \n      data = date:data\n      data = month: data\n      data = name : data\n</code></pre>\n\n<p>I don't know how to proceed after this. Please help me out.</p>\n"}, {"tags": ["haskell", "record"], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 6, "last_activity_date": 1462716346, "last_edit_date": 1462716346, "creation_date": 1462596561, "answer_id": 37084608, "question_id": 37084514, "link": "https://stackoverflow.com/questions/37084514/adding-elements-of-a-record-type/37084608#37084608", "title": "adding elements of a record type", "body": "<p>This will work</p>\n\n<pre><code>maximumBy (compare `on` sum . time1) list_of_boxes\n</code></pre>\n\n<p>You will need to import <code>Data.List</code> and <code>Data.Function</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1463817533, "last_edit_date": 1463817533, "creation_date": 1462649843, "answer_id": 37092897, "question_id": 37084514, "link": "https://stackoverflow.com/questions/37084514/adding-elements-of-a-record-type/37092897#37092897", "title": "adding elements of a record type", "body": "<p>This will sum every list <em>only once</em>:</p>\n\n<pre><code>import Data.List\nimport Data.Ord\nsnd . maximumBy (comparing fst) . map (\\x -&gt; (sum . time1 $ x , x)) $ list_of_boxes\n</code></pre>\n\n<p>The above can be shortened a bit using arrows:</p>\n\n<pre><code>import Control.Arrow\nsnd . maximumBy (comparing fst) . map (sum . time1 &amp;&amp;&amp; id) $ list_of_boxes\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6302839, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aaNh9bqtYP0/AAAAAAAAAAI/AAAAAAAADaI/P3MXY8xBtoA/photo.jpg?sz=128", "display_name": "mikejay", "link": "https://stackoverflow.com/users/6302839/mikejay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 37084608, "answer_count": 2, "score": 1, "last_activity_date": 1463817533, "creation_date": 1462595534, "last_edit_date": 1462722981, "question_id": 37084514, "link": "https://stackoverflow.com/questions/37084514/adding-elements-of-a-record-type", "title": "adding elements of a record type", "body": "<p>So I have a record type:</p>\n\n<pre><code>data Box = Box { edge :: Char\n                   , time1 :: [Int]\n                   , time2 :: Int\n                   }\n             deriving Eq\n</code></pre>\n\n<p>and this list over here:</p>\n\n<pre><code>list_of_boxes :: [Box]\n</code></pre>\n\n<p>How can I sum the values for <code>time1</code> in each box of the list, then find which box gives the highest value for <code>time1</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 6, "creation_date": 1462605912, "post_id": 37084504, "comment_id": 61715835, "body": "I guess it&#39;s because <code>intersections</code> won&#39;t be a total function. Consider <code>union</code> and <code>intersection</code> as monoids on set of sets, identity for <code>union</code> is just <code>empty</code> but identity for <code>intersection</code> is not well defined."}, {"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 1, "creation_date": 1462611073, "post_id": 37084504, "comment_id": 61717082, "body": "To address the totality concerns, I could imagine having an <code>intersectionsMay</code> function that returns <code>Maybe</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 6, "creation_date": 1462615486, "post_id": 37084504, "comment_id": 61718426, "body": "@zakyggaps The unit for <code>intersection</code> is not well-defined <i>for this particular representation of sets</i>. You could instead represent sets intensionally <code>type Set a = a -&gt; Bool</code>, then <code>intersection s t = \\x -&gt; s x &amp;&amp; t x</code> and the unit of intersection is the set containing everything, <code>universe = const True</code>"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1462595427, "creation_date": 1462595427, "question_id": 37084504, "link": "https://stackoverflow.com/questions/37084504/haskell-data-set-has-unions-but-not-intersections-why", "title": "Haskell Data.Set has `unions`, but not `intersections`? Why?", "body": "<p>I need to take the <code>intersection</code> of a list of Sets, and noticed that there is an function </p>\n\n<pre><code>unions :: Ord a =&gt; [Set a] -&gt; Set a Source\n    The union of a list of sets: (unions == foldl union empty).\n</code></pre>\n\n<p>but no corresponding function <code>intersections</code>.  Is there a good reason for this, or is this just an oversight?</p>\n\n<p>Don't get me wrong, it is super easy to define this as</p>\n\n<pre><code>intersections = foldl1 intersection\n</code></pre>\n\n<p>but I just find it curious that one is there, and the other not.</p>\n"}, {"tags": ["haskell", "haskell-vector"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1462583173, "post_id": 37083405, "comment_id": 61711411, "body": "I suspect this is a duplicate of <a href=\"http://stackoverflow.com/questions/12018959/string-is-applied-to-too-many-type-arguments/12018975\">this one</a>, but with <code>Vector a</code> instead of <code>String</code>. Does the solution there work for you as well?"}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 3, "last_activity_date": 1462584348, "creation_date": 1462584348, "answer_id": 37083535, "question_id": 37083405, "link": "https://stackoverflow.com/questions/37083405/haskell-vector-type-declaration/37083535#37083535", "title": "Haskell vector type declaration", "body": "<p><code>Vector</code> is a data type, not a class, so your function type should be</p>\n\n<pre><code>indCmp :: (Ord a, Num a)  =&gt; Vector a -&gt; Vector a -&gt; Ordering\n</code></pre>\n\n<p>When I changed this, it compiled for me.</p>\n"}], "owner": {"reputation": 2185, "user_id": 4129091, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f8076e78a95ed50b9ffbed42849d80e?s=128&d=identicon&r=PG&f=1", "display_name": "tsorn", "link": "https://stackoverflow.com/users/4129091/tsorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 37083535, "answer_count": 1, "score": 1, "last_activity_date": 1462584348, "creation_date": 1462582880, "question_id": 37083405, "link": "https://stackoverflow.com/questions/37083405/haskell-vector-type-declaration", "title": "Haskell vector type declaration", "body": "<p>I'm writing a comparator to pass to <code>sortBy</code> but I can't get the type declaration right. The input is two <code>Data.Vector</code>'s, each containing two numbers.</p>\n\n<pre><code>-- Comparator to sort a list of individuals by increasing order of fit-0 \n--      and for individuals with equal fit-0, with increasing order of fit-1\nindCmp :: (Ord a, Num a, Vector a)  =&gt; a -&gt; a -&gt; Ordering\nindCmp x y\n    | (x ! 0) &lt; (y ! 0) = LT\n    | (x ! 0) &gt; (y ! 0) = GT\n    | (x ! 1) &lt; (y ! 1) = LT -- Can assume (x ! 0) == (y ! 0) here and beneath\n    | (x ! 1) &gt; (y ! 1) = GT\n    | (x ! 1) == (y ! 1) = EQ\n</code></pre>\n\n<p>GHCI complains: </p>\n\n<blockquote>\n  <p>Expected a constraint, but 'Vector a' has kind '*'</p>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1462580109, "post_id": 37083015, "comment_id": 61710839, "body": "note: <code>&gt;&gt;= \\_ -&gt; ..</code> is the same as <code>&gt;&gt;</code>, also it is advisable to stick to a line length of more or less 80 characters to make your code readable."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1462585220, "post_id": 37083015, "comment_id": 61711766, "body": "Also, note that <code>local (\\_ -&gt; ...) ask</code> doesn&#39;t do anything. The environment is modified just for the <code>ask</code> - after it returns the reader environment is &quot;restored&quot; so to speak. See my answer for an example of this."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1462584350, "creation_date": 1462584350, "answer_id": 37083537, "question_id": 37083015, "link": "https://stackoverflow.com/questions/37083015/monad-stack-and-modifying-reader-environment/37083537#37083537", "title": "Monad Stack and modifying reader environment", "body": "<p>You use the <code>local</code> function. Here is a short example:</p>\n\n<pre><code>import Control.Monad.Reader\nimport Control.Monad.State\nimport Control.Monad.Except\n\ntype MyMonad = StateT String (ReaderT Int (ExceptT String IO))\n\nfoo :: Int -&gt; MyMonad ()\nfoo x = do\n  env &lt;- ask\n  liftIO $ putStrLn $ \"x = \" ++ show x ++ \" and env is: \" ++ show env\n\nt1 :: MyMonad ()\nt1 = do\n  foo 1                        -- env = 13\n  local (+20) $ foo 2          -- env = 20+13 = 33\n  local (const 42) $ foo 3     -- env = 42\n  foo 4                        -- env = 13\n\nexample = runExceptT (runReaderT (runStateT t1 \"some state\") 13)\n</code></pre>\n\n<p>Output from running <code>example</code>:</p>\n\n<pre><code>x = 1 and env is: 13\nx = 2 and env is: 33\nx = 3 and env is: 42\nx = 4 and env is: 13\nRight ((),\"some state\")\n</code></pre>\n\n<p>Initially the Reader environment is 13. The <code>local (+20)</code> call executes <code>foo 2</code> with the Reader environment set to 13+20. Then <code>foo 3</code> is executed with the Reader environment set to 42. Finally, <code>foo 4</code> is executed in the original environment.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6262188"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462584350, "creation_date": 1462579122, "question_id": 37083015, "link": "https://stackoverflow.com/questions/37083015/monad-stack-and-modifying-reader-environment", "title": "Monad Stack and modifying reader environment", "body": "<pre><code>type InterpreterMonad = StateT (MEMORY, FUNCTIONS) (ReaderT (NameAddress, NameAddress) (ErrorT String  IO))\ninterpreteStmt :: Stmt -&gt; InterpreterMonad ()\n\n\nhandleFCall :: VarName -&gt; [CallArg] -&gt; InterpreterMonad ()\nhandleFCall (VarName name) argsCall =  do\n    (memory, functions) &lt;- get\n    case (Map.lookup (VarName name) functions) of\n        Nothing -&gt; throwError $ \"error\"\n        (Just ((DefFun  varname argsDef typ begin statements end), env)) -&gt; (checkCoherenceTypesArgs varname argsDef argsCall) &gt;&gt;= \\_ -&gt; argsToContext argsDef argsCall env &gt;&gt;= \\_ -&gt; interpreter statements &gt;&gt;= \\_ -&gt; return ()\n</code></pre>\n\n<p>I don't put whole code to make my problem clearer.\nAnd now, I would like to modify Reader monad ( I mean environment in Reader) in <code>handleFCall</code> Function for <code>interpreter statements</code>. How to do it?</p>\n\n<p>P.S. My attempt: ( It doesn't work, please explain why )</p>\n\n<pre><code>argsToContext :: [DefArg] -&gt; [CallArg] -&gt; NameAddress -&gt; InterpreterMonad ()\nargsToContext xs ys env = do\n    (memory, fs) &lt;- get\n    (mem, args) &lt;- (argsToContext' xs ys memory Map.empty)\n    put ( mem, fs) \n    throwError $ \"Tutej \"  ++ (show args) ++ \" memory \" ++ (show mem)\n    local (\\_ -&gt; (env, args)) ask\n    return ()\n</code></pre>\n"}, {"tags": ["haskell", "mergesort"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 4, "creation_date": 1462579791, "post_id": 37082925, "comment_id": 61710768, "body": "btw - if you are using length this is an O(n) operation - so you are producing unnecessary overhead, in general if you are using length indexing a lot with (single-linked) lists you are probably using the wrong data structure."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1462580387, "post_id": 37083073, "comment_id": 61710904, "body": "that seems to have fixed that error but now when I run the function mergeSort, it says merge not in scope. Does that mean, the code is incomplete and I need to further define what merge actually does?"}, {"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "reply_to_user": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1558207827, "post_id": 37083073, "comment_id": 99027057, "body": "@emuterisa this should be an accepted answer if it solved your problem; even if this is from three years ago..."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 5, "last_activity_date": 1462579617, "creation_date": 1462579617, "answer_id": 37083073, "question_id": 37082925, "link": "https://stackoverflow.com/questions/37082925/haskell-merge-sort/37083073#37083073", "title": "Haskell Merge Sort", "body": "<p>Haskell is an indentation sensitive programming language, you simply need to fix that (btw. if you are using tabs change that to using spaces).</p>\n\n<pre><code>mergeSort :: ([a] -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a]\nmergeSort merge xs\n        | length xs &lt; 2 = xs\n        | otherwise = merge (mergeSort merge first) (mergeSort merge second)\n        where first = take half xs \n              second = drop half xs \n              half = length xs `div` 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "edited": false, "score": 0, "creation_date": 1554194034, "post_id": 42930293, "comment_id": 97651400, "body": "Shouldn&#39;t merge be a tail recursive function for efficiency reasons? I haven&#39;t benchmarked it but when just running it in repl.it with a list of 30000 values, tail recursion is a bit faster: <a href=\"https://repl.it/@faebl/Sorting\" rel=\"nofollow noreferrer\">repl.it/@faebl/Sorting</a>"}, {"owner": {"reputation": 273, "user_id": 4380537, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/823874302/picture?type=large", "display_name": "Cuban coffee", "link": "https://stackoverflow.com/users/4380537/cuban-coffee"}, "edited": false, "score": 1, "creation_date": 1558099265, "post_id": 42930293, "comment_id": 98999637, "body": "the msort is missing the equation &quot;msort [] = []&quot;. Otherwise the thing will never stop if the array to sort is empty."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 273, "user_id": 4380537, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/823874302/picture?type=large", "display_name": "Cuban coffee", "link": "https://stackoverflow.com/users/4380537/cuban-coffee"}, "edited": false, "score": 0, "creation_date": 1558099682, "post_id": 42930293, "comment_id": 98999871, "body": "@Cuban coffee Thanks for the heads up... corrected."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "edited": false, "score": 1, "creation_date": 1558108724, "post_id": 42930293, "comment_id": 99004794, "body": "@FabianSchneider, no, it should not. Haskell lists are lazy in both their elements and (what matters here) their tails. So constructing a Haskell list the way the above code does is efficient: the list constructor is allocated <i>first</i>, and only later is the tail evaluated."}, {"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1558207710, "post_id": 42930293, "comment_id": 99027034, "body": "@dfeuer thanks for the info; I thought about it and read a a bit more about laziness and the list constructor and it makes kind of sense. Also &quot;benchmarking&quot; it on repl.it isn&#39;t really a reliable thing..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1563371730, "post_id": 42930293, "comment_id": 100678356, "body": "It&#39;s likely more efficient to halve a list using a two-pointer algorithm than to take the length and divide by two. And it&#39;s definitely prettier."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1563372602, "post_id": 42930293, "comment_id": 100678936, "body": "Here&#39;s a <a href=\"https://tio.run/##XU1LCsIwEN3nFI/iIgXxAIUsimtPIFKCRjuaJjGJbT19nCpuuhhm3rxfr9PDWFsKDcHHjL13OXq7a0OwdNaZRiNW1ME7fVk/2xj9BHmlmHItRK/taKBw9@Rw8wKYehMNbzCEnJs51ZAdGizzZqDwNS9cjc2imhMTfwuDjjXyeNryzRWDJqcQIrnM8l9h9eSEV1XKBw\" rel=\"nofollow noreferrer\">two-pointer list halver</a>."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1558099652, "last_edit_date": 1558099652, "creation_date": 1490107309, "answer_id": 42930293, "question_id": 37082925, "link": "https://stackoverflow.com/questions/37082925/haskell-merge-sort/42930293#42930293", "title": "Haskell Merge Sort", "body": "<p>Another <code>msort</code> implementation in Haskell;</p>\n\n<pre><code>merge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge [] ys         = ys\nmerge xs []         = xs\nmerge (x:xs) (y:ys) | x &lt; y     = x:merge xs (y:ys)\n                    | otherwise = y:merge (x:xs) ys\n\nhalve :: [a] -&gt; ([a],[a])\nhalve xs = (take lhx xs, drop lhx xs)\n           where lhx = length xs `div` 2\n\nmsort :: Ord a =&gt; [a] -&gt; [a]\nmsort []  = []\nmsort [x] = [x]\nmsort  xs = merge (msort left) (msort right)\n            where (left,right) = halve xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1563371480, "post_id": 52896140, "comment_id": 100678183, "body": "A small but nice optimization: instead of breaking the list up into singletons, break it up into sorted lists of two elements. That saves O(n) allocation without much extra code complexity."}], "tags": [], "owner": {"reputation": 321, "user_id": 5390900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da89cedd78fa0c6eb56ee0e94a1f4c2?s=128&d=identicon&r=PG&f=1", "display_name": "L.-T. Chen", "link": "https://stackoverflow.com/users/5390900/l-t-chen"}, "is_accepted": false, "score": 6, "last_activity_date": 1563368781, "last_edit_date": 1563368781, "creation_date": 1539965164, "answer_id": 52896140, "question_id": 37082925, "link": "https://stackoverflow.com/questions/37082925/haskell-merge-sort/52896140#52896140", "title": "Haskell Merge Sort", "body": "<p>Halving a list is not an O(1) operation but O(n), so the given solutions introduce additional costs compared to the imperative version of merge sort. One way to avoid halving is to simply start merging directly by making singletons and then merging every two consecutive lists:</p>\n\n<pre><code>sort :: (Ord a) =&gt; [a] -&gt; [a]\nsort = mergeAll . map (:[]) \n  where\n    mergeAll [] = []\n    mergeAll [t] = t\n    mergeAll xs  = mergeAll (mergePairs xs)\n\n    mergePairs (x:y:xs) = merge x y:mergePairs xs\n    mergePairs xs = xs\n</code></pre>\n\n<p>where <code>merge</code> is already given by others. </p>\n"}], "owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12879, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1563368781, "creation_date": 1462578376, "question_id": 37082925, "link": "https://stackoverflow.com/questions/37082925/haskell-merge-sort", "title": "Haskell Merge Sort", "body": "<p>This is an implementation of Mergesort using higher order functions,guards,where and recursion.</p>\n\n<p>However getting an error from compiler <code>6:26: parse error on input \u2018=\u2019</code></p>\n\n<pre><code> mergeSort :: ([a] -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a]\n    mergeSort merge xs\n        | length xs &lt; 2 = xs\n        | otherwise = merge (mergeSort merge first) (mergeSort merge second)\n        where first = take half xs \n              second = drop half xs \n               half = (length xs) `div` 2\n</code></pre>\n\n<p>I can't see whats wrong? or rather I don't understand the compiler.</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "is_accepted": false, "score": 1, "last_activity_date": 1462697318, "last_edit_date": 1495542233, "creation_date": 1462574717, "answer_id": 37082467, "question_id": 37082353, "link": "https://stackoverflow.com/questions/37082353/haskell-recursive-types-int2nat/37082467#37082467", "title": "Haskell recursive types int2nat", "body": "<p>You are using a \"n + k patterns\" wich is not supported in Haskell.</p>\n\n<p>You should change your code in this way:</p>\n\n<pre><code>int2nat :: Int -&gt; Nat\nint2nat 0 = Zero\nint2nat n = Succ (int2nat (n-1))\n</code></pre>\n\n<p>How is written in the comments read <a href=\"https://stackoverflow.com/questions/3748592/what-are-nk-patterns-and-why-are-they-banned-from-haskell-2010\">here</a> for more.</p>\n\n<p>Moreover if you insert a negative number it won't terminates.\nTo avoid this problem maybe you can try this:</p>\n\n<pre><code>int2nat :: Int -&gt; Nat\nint2nat 0 = Zero\nint2nat n | n &lt; 0  = Zero\n          | otherwise = Succ (int2nat (n-1))\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6048440, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/43b99784b7b48ffbb5159451ac9c5f78?s=128&d=identicon&r=PG&f=1", "display_name": "mk4280", "link": "https://stackoverflow.com/users/6048440/mk4280"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1462575705, "answer_count": 1, "score": -2, "last_activity_date": 1580025925, "creation_date": 1462573966, "last_edit_date": 1580025925, "question_id": 37082353, "link": "https://stackoverflow.com/questions/37082353/haskell-recursive-types-int2nat", "closed_reason": "Duplicate", "title": "Haskell recursive types int2nat", "body": "<p>I am studying Programming in Haskell by Hutton.</p>\n\n<p>Below is the code on page 102.</p>\n\n<pre><code>int2nat :: Int -&gt; Nat\nint2nat 0 = Zero\nint2nat (n+1) = Succ (int2nat n)\n</code></pre>\n\n<p>I am getting a parse error in pattern: n + 1.\nIt seems like Int does not accept n+1 as integer because of n.\nHow do I fix this issue?</p>\n\n<p>I've also tried changing: </p>\n\n<pre><code>  data Nat = Zero | Succ Nat \n</code></pre>\n\n<p>to <code>data Nat = Zero | Succ Nat deriving Show</code></p>\n"}, {"tags": ["list", "haskell", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 2, "last_activity_date": 1462575561, "last_edit_date": 1462575561, "creation_date": 1462574167, "answer_id": 37082384, "question_id": 37082287, "link": "https://stackoverflow.com/questions/37082287/list-comprehension-guards/37082384#37082384", "title": "List comprehension guards", "body": "<p>with list comprehension </p>\n\n<pre><code>evother xs = [x | (x,i) &lt;- zip xs [1..], even i]\n\n&gt; evother [1..10]\n[2,4,6,8,10]\n</code></pre>\n\n<p>you can skip the list comprehension add the index with zip and filter</p>\n\n<pre><code>evother = map snd . filter (even . fst) . zip [1..]\n\n&gt; evother [1..10]\n[2,4,6,8,10]\n</code></pre>\n\n<p>It's not clear from the description which elements you want to filter, so you can generalize this little bit</p>\n\n<pre><code>evother f = map snd . filter (f . fst) . zip [1..]\n\n&gt; evother even [1..10]\n[2,4,6,8,10]\n\n&gt; evother odd [1..10]\n[1,3,5,7,9]\n</code></pre>\n\n<p>However, a much nicer solution will be using mutual recursion</p>\n\n<pre><code>first, second :: [a] -&gt; [a]\nfirst [] = []\nfirst (x:xs) = x:second xs\nsecond [] = []\nsecond (x:xs) = first xs\n\n&gt; first [1..10]\n[1,3,5,7,9]\n\n&gt; second [1..10]\n[2,4,6,8,10]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "is_accepted": false, "score": 0, "last_activity_date": 1462574906, "creation_date": 1462574906, "answer_id": 37082496, "question_id": 37082287, "link": "https://stackoverflow.com/questions/37082287/list-comprehension-guards/37082496#37082496", "title": "List comprehension guards", "body": "<p>I think @karakfa probably has the right answer but here is one using list comprehensions (note that I flipped the zip).</p>\n\n<pre><code>evother :: [a] -&gt; Int -&gt; [a]\nevother lst q = [ x | (x,y) &lt;- zip lst [q..], even( y ) ]  \n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 6268947, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/b27a22f070dbbc34e426bcd91fe078d2?s=128&d=identicon&r=PG&f=1", "display_name": "J.doe", "link": "https://stackoverflow.com/users/6268947/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1933, "favorite_count": 0, "accepted_answer_id": 37082384, "answer_count": 2, "score": 0, "last_activity_date": 1462575561, "creation_date": 1462573560, "last_edit_date": 1462574204, "question_id": 37082287, "link": "https://stackoverflow.com/questions/37082287/list-comprehension-guards", "title": "List comprehension guards", "body": "<p>I am trying to take out every other element(starting with the first element in the list) using list comprehension , but I have encountered a problem - here is what I am trying to do</p>\n\n<pre><code>evother :: [a]-&gt; Int  -&gt;[a]\nevother lst q  = [x | x &lt;- lst, even( q++ ) ]  \n</code></pre>\n\n<p>What I am trying to do is to increment a variable, q, by 1 every time even is evaluated (this would help me to get the desired list) . Obviously this doesn't work because q++ isn't allowed - what are my alternatives?</p>\n\n<p>eg if I call: evother ['a','b','c'] 1 , then   even (2) is True and the first element (a) gets picked out, the second element 'b' will not get picked out because even (3) is False and finally 'c' will get picked out this gives us the list ['a','b'] </p>\n"}]