[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "edited": false, "score": 0, "creation_date": 1454523294, "post_id": 35184506, "comment_id": 58086239, "body": "Could you also provide output sample for <code>[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]</code> input?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1454523296, "post_id": 35184506, "comment_id": 58086240, "body": "I guess this is homework so what have you tried? - BTW: I think you want the first pair to be 2xFalse instead"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1454525657, "last_edit_date": 1454525657, "creation_date": 1454525342, "answer_id": 35185224, "question_id": 35184506, "link": "https://stackoverflow.com/questions/35184506/haskell-generating-values-for-truth-table/35185224#35185224", "title": "Haskell , generating values for truth table", "body": "<p>one way: </p>\n\n<h2>list comprehensions</h2>\n\n<p>let's give the symbols a name:</p>\n\n<pre><code>symbols :: [String]\nsymbols = [\"A\", \"B\"]\n</code></pre>\n\n<p>start by assigning all combinations of <em>one</em> symbol with the truth-values:</p>\n\n<pre><code>truth :: String -&gt; [(String, Bool)]\ntruth s = [ (s,b) | b &lt;- [True, False] ]\n</code></pre>\n\n<p>then you only have to calculate the cross-product of all those:</p>\n\n<pre><code>truths :: [String] -&gt; [[(String,Bool)]]\ntruths [] = [[]]\ntruths (s:ss) = [ t:ts | t &lt;- truth s, ts &lt;- truths ss ]\n</code></pre>\n\n<p>which yields:</p>\n\n<pre><code>&gt; truths symbols\n\n[ [(\"A\",True),(\"B\",True)]\n, [(\"A\",True),(\"B\",False)]\n, [(\"A\",False),(\"B\",True)]\n,[(\"A\",False),(\"B\",False)] ]\n</code></pre>\n\n<p>which is what you wanted (aside from reorderings ... you should be able to figure those out)</p>\n\n<hr>\n\n<h3>remarks/exercise:</h3>\n\n<ul>\n<li>try to figure out how to get the order you want (aside from the strange flip you did in the very first pairs)</li>\n<li>there are predefined functions for this (cross-product) - try to find it</li>\n<li>you can generalize this quite a bit (no need for <code>String</code> or even <code>Bool</code>) - try to work it out for at least <code>[String] -&gt; [a]</code></li>\n<li>you can do this also with the <code>do</code> notation - try to figure it out</li>\n<li>there is yet another way of doing this with <code>concatMap</code> - try to figure it out!</li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 5877988, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Olv2WoSZ6lc/AAAAAAAAAAI/AAAAAAAAABQ/T4pLLe826vI/photo.jpg?sz=128", "display_name": "CATALINA ROTARU", "link": "https://stackoverflow.com/users/5877988/catalina-rotaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "closed_date": 1454526731, "accepted_answer_id": 35185224, "answer_count": 1, "score": -3, "last_activity_date": 1454525657, "creation_date": 1454523007, "last_edit_date": 1454523153, "question_id": 35184506, "link": "https://stackoverflow.com/questions/35184506/haskell-generating-values-for-truth-table", "closed_reason": "Duplicate", "title": "Haskell , generating values for truth table", "body": "<p>How can you generate the table truth values for an input of symbols?</p>\n\n<pre><code>Input : [\"A\", \"B\"]\n\nOutput: [(\"A\", True), (\"B\", False)], [(\"A\", True), (\"B\", True)],\n        [(\"A\", False), (\"B\", True)], [(\"A\", False), (\"B\", False)]\n</code></pre>\n\n<p>In this exact format. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1454506625, "post_id": 35178388, "comment_id": 58074050, "body": "When working with markdown (e.g. code on StackOverflow), indent all your code lines by four spaces. See also <a href=\"https://stackoverflow.com/editing-help#code\">stackoverflow.com/editing-help#code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1454508292, "creation_date": 1454508292, "answer_id": 35179235, "question_id": 35178388, "link": "https://stackoverflow.com/questions/35178388/haskell-how-to-access-lists-within-lists/35179235#35179235", "title": "Haskell - how to access lists within lists", "body": "<p>Try adapting something like</p>\n\n<pre><code>[ 1000 + x | xs &lt;- [[1,2],[3,4]] , x &lt;- xs ]\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user932887"}, "is_accepted": true, "score": 1, "last_activity_date": 1454510170, "creation_date": 1454510170, "answer_id": 35179899, "question_id": 35178388, "link": "https://stackoverflow.com/questions/35178388/haskell-how-to-access-lists-within-lists/35179899#35179899", "title": "Haskell - how to access lists within lists", "body": "<p>Recursively you can define your concatenation like</p>\n\n<pre><code>conc [] = []\nconc (x:xs) = x ++ (conc xs) -- ++ concatenates two lists\n</code></pre>\n\n<p>Your <code>getSymbols</code> becomes</p>\n\n<pre><code>getSymbols sentence = nub . conc $ sentence\n</code></pre>\n\n<p>About:</p>\n\n<pre><code>getSymbols :: [Sentence] -&gt; [Symbol]\n</code></pre>\n\n<p>Are you sure that you want to take a list of sentences there? It seems that you're trying to work with only one sentence, especially when looking at your example input &amp; output. If you want to work with a list of sentences then you can <code>conc</code> twice to bring all of the symbols to the same level.</p>\n\n<pre><code>getSymbols' :: [Sentence] -&gt; [Symbol]\ngetSymbols' sentences = nub . conc . conc $ sentences\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5877988, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Olv2WoSZ6lc/AAAAAAAAAAI/AAAAAAAAABQ/T4pLLe826vI/photo.jpg?sz=128", "display_name": "CATALINA ROTARU", "link": "https://stackoverflow.com/users/5877988/catalina-rotaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 1, "closed_date": 1454526832, "accepted_answer_id": 35179899, "answer_count": 2, "score": 0, "last_activity_date": 1454510170, "creation_date": 1454506037, "last_edit_date": 1454506536, "question_id": 35178388, "link": "https://stackoverflow.com/questions/35178388/haskell-how-to-access-lists-within-lists", "closed_reason": "Duplicate", "title": "Haskell - how to access lists within lists", "body": "<p>I have this function that I need to build for my assignment. </p>\n\n<p>This function returns a list of all symbols (without duplicates) in all input sentences.  Where Sentence and Symbol are the following types:</p>\n\n<pre><code>-- Symbols are strings (a negative sign as the first character represents a negated symbol)\ntype Symbol = String  \n\n-- Sentence = Statements. This is a list of a list of symbols\ntype Sentence = [[Symbol]] \n</code></pre>\n\n<p>I have tried with list comprehension and recursion, but I don't know how to access list within lists. Also you don't need to have any duplicates , for this I used nub function as:</p>\n\n<pre><code>getSymbols :: [Sentence] -&gt; [Symbol]\ngetSymbols stmts = nub [ x | [x: xs] &lt;- stmts ]\n</code></pre>\n\n\n\n<pre><code>Input:   getSymbols [[\"A\"], [\"B\",\"C\"], [\"C\"]]\nReturn:  [\"A\", \"B\", \"C\"] \n</code></pre>\n\n<p>Really appreciate for some help! </p>\n"}, {"tags": ["haskell", "type-families", "data-kinds"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1454489536, "post_id": 35171719, "comment_id": 58062103, "body": "Where is the type family <code>==</code> defined? Is it lifted from instances automatically by GHC? If so, GHC has to account for the possibility of a weird instance where on some custom type <code>(==) = \\_ _ -&gt; False</code>, I guess."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1454489949, "post_id": 35171719, "comment_id": 58062367, "body": "Can you include a complete working example? When I try your example, I get different errors than the one you showed."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1454491516, "post_id": 35171719, "comment_id": 58063423, "body": "@chi, or not weird: <code>(let x = 0&#47;0 in x == x) ~&gt; False</code>."}], "answers": [{"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1454527465, "post_id": 35178170, "comment_id": 58088734, "body": "@haoformayor When quoting content from outside sources you should use blockquotes, so that it&#39;s clear what was quoted. In this specific case the formatting was terrible and would require some treatment. Also the content you edited in is <i>not</i> essential to answer the question and as such there&#39;s no need to actually copy it. The answer is already complete without it, the &quot;why&quot; no polykinded instance is provided can be answered in an other question or just left as a link for <i>further</i> reading."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1454581436, "post_id": 35178170, "comment_id": 58112939, "body": "What is the utility of your <code>==</code> type family? It&#39;s usually much easier to work with native type equality (<code>~</code>) than it is to build a Boolean equality into the type system. At the end of the day you have to use <code>~</code> to do anything with the result of <code>==</code>, as you did in <code>foo</code>."}, {"owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1454589574, "post_id": 35178170, "comment_id": 58118329, "body": "@BenjaminHodgson: <code>==</code> is not mine. It is from the <code>base</code> package. It is a type family which result has kind <code>Bool</code>. On the other hand, result of <code>~</code> has kind <code>Constraint</code>. So <code>==</code> is usable in boolean type level calculation. You can&#39;t use <code>~</code> instead there."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1454593906, "post_id": 35178170, "comment_id": 58121261, "body": "My question is really <i>why are you using Boolean equality and not <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Type-Equality.html#t::-126-:\" rel=\"nofollow noreferrer\">propositional equality</a></i>?"}, {"owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1454658587, "post_id": 35178170, "comment_id": 58152132, "body": "@BenjaminHodgson <i>propositional equality</i> (<code>:~:</code>) is a data type with kind <code>*</code>. I can&#39;t see how to use it instead of type family <code>==</code> in type calculation. It seems too common question about all these equalities for comments. Probably better to ask it separately?"}], "tags": [], "owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "is_accepted": true, "score": 9, "last_activity_date": 1454527278, "last_edit_date": 1454527278, "creation_date": 1454505467, "answer_id": 35178170, "question_id": 35171719, "link": "https://stackoverflow.com/questions/35171719/why-compiler-couldnt-match-type-a-a-with-true-for-type-family/35178170#35178170", "title": "Why compiler couldn&#39;t match type &#39;a==a&#39; with &#39;`True&#39; for type family?", "body": "<p>Due to a request for a complete working example from Daniel Wagner, I found an answer.</p>\n\n<p>Complete example at first:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE PolyKinds #-}\nmodule Test where\n\nimport Data.Type.Equality(type (==))\nimport Data.Proxy(Proxy(..))\n\ntype family Foo a b :: Bool where\n    Foo a b = a == b\n\nfoo :: Foo a b ~ True =&gt; Proxy a -&gt; Proxy b\nfoo _ = Proxy\n\nbar :: Proxy a -&gt; Proxy a\nbar = foo\n</code></pre>\n\n<p>The problem here is with <code>PolyKinds</code> pragma. Without it it works well.\nI probably need it so that I can write</p>\n\n<pre><code>bar :: Proxy (a :: *) -&gt; Proxy a\n</code></pre>\n\n<p>and all goes well.</p>\n\n<p>The reason is clear now. The type family (<code>==</code>) has no poly-kinded instances (details explaining why such instances aren't provided <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.Type.Equality.html#line-130\" rel=\"nofollow\">here</a>) so we can't reduce all equalities. So we need to specify a kind.</p>\n"}], "owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 35178170, "answer_count": 1, "score": 8, "last_activity_date": 1454527278, "creation_date": 1454487346, "last_edit_date": 1454498344, "question_id": 35171719, "link": "https://stackoverflow.com/questions/35171719/why-compiler-couldnt-match-type-a-a-with-true-for-type-family", "title": "Why compiler couldn&#39;t match type &#39;a==a&#39; with &#39;`True&#39; for type family?", "body": "<p>Is there some reason why this code is not compiled:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type family Foo a b :: Bool where\n    Foo a b = a == b\n\nfoo :: Foo a b ~ True =&gt; Proxy a -&gt; Proxy b\nfoo _ = Proxy\n\nbar :: Proxy a -&gt; Proxy a\nbar = foo\n</code></pre>\n\n<p>with error:</p>\n\n<pre><code>Couldn't match type \u2018a == a\u2019 with \u2018'True\u2019\nExpected type: 'True\n  Actual type: Foo a a\n</code></pre>\n\n<p>but if I change type family definition to</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type family Foo a b :: Bool where\n    Foo a a = True\n    Foo a b = False\n</code></pre>\n\n<p>it is compiled well?</p>\n\n<p>(ghc-7.10.3)</p>\n"}, {"tags": ["list", "haskell", "list-comprehension", "lazy-evaluation"], "answers": [{"comments": [{"owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1454482384, "post_id": 35169371, "comment_id": 58058383, "body": "Thanks, but I don&#39;t quite get what :sprint does, on &quot;lazy evaluation&quot;, because:      Prelude&gt; let a=2     Prelude&gt; :sprint a     a = _  Still seems to print &quot;_&quot;"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1454482469, "post_id": 35169371, "comment_id": 58058421, "body": "<code>:sprint</code> is a <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/ghci-commands.html\" rel=\"nofollow noreferrer\">GHCi Command</a> which &quot;Prints a value without forcing its evaluation. :sprint is similar to :print, with the difference that unevaluated subterms are not bound to new variables, they are simply denoted by \u2018_\u2019.&quot; - so you can check what get&#39;s evaluated/forced and what not"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1454482934, "post_id": 35169371, "comment_id": 58058621, "body": "<a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch02.html#sec_par-eval-whnf\" rel=\"nofollow noreferrer\">Here is a very good introduction</a> on this stuff ^^"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 2, "creation_date": 1454512595, "post_id": 35169371, "comment_id": 58078514, "body": "@viksantata That&#39;s because <code>2</code> isn&#39;t an evaluated value in Haskell.  It&#39;s a polymorphic expression whose evaluation depends on its type.  Try something like <code>2 :: Int</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1454513226, "post_id": 35169371, "comment_id": 58079027, "body": "@Carl right ... I totally misread the comment/question - thanks for pointing this out"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 11, "last_activity_date": 1454478306, "creation_date": 1454478306, "answer_id": 35169371, "question_id": 35169338, "link": "https://stackoverflow.com/questions/35169338/haskell-is-list-comprehension-using-eager-evaluation/35169371#35169371", "title": "Haskell: is &quot;list comprehension&quot; using eager evaluation?", "body": "<p>In Haskell <em>everything</em> (well almost) is lazy and this is no difference</p>\n\n<p>But if you ask GHCi to print it (you did with the input) it will evaluate all of it</p>\n\n<p>To see it use this:</p>\n\n<pre><code>Prelude&gt; let xs = [x*2|x&lt;-[1..10]]\nPrelude&gt; :sprint xs\nxs = _\n</code></pre>\n\n<p>the <code>_</code> indicates a <em>unevaluated</em> thunk here</p>\n\n<hr>\n\n<p>BTW: this is why Haskell has no issue with something like this:</p>\n\n<pre><code>let xs = [x*2|x&lt;-[1..]]\n</code></pre>\n\n<p>which is an infinite list - now if you ask it to print it out it will <em>take some time</em> ;)</p>\n\n<p>The same is true for F#'s <code>seq { ... }</code> but not for F#'s lists!</p>\n"}, {"tags": [], "owner": {"reputation": 2071, "user_id": 2006002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acceacd30b03d868ddc45dc1d7a6bc36?s=128&d=identicon&r=PG", "display_name": "Pseudonym", "link": "https://stackoverflow.com/users/2006002/pseudonym"}, "is_accepted": false, "score": 4, "last_activity_date": 1454478575, "creation_date": 1454478575, "answer_id": 35169437, "question_id": 35169338, "link": "https://stackoverflow.com/questions/35169338/haskell-is-list-comprehension-using-eager-evaluation/35169437#35169437", "title": "Haskell: is &quot;list comprehension&quot; using eager evaluation?", "body": "<p>You can test this yourself by asking for an infinite list:</p>\n\n<pre><code>Prelude&gt; take 10 [ x*2 | x &lt;- [1..], x `mod` 3 == 0 ]\n[6,12,18,24,30,36,42,48,54,60]\n</code></pre>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1454478575, "creation_date": 1454478147, "question_id": 35169338, "link": "https://stackoverflow.com/questions/35169338/haskell-is-list-comprehension-using-eager-evaluation", "title": "Haskell: is &quot;list comprehension&quot; using eager evaluation?", "body": "<p>I just tried this:</p>\n\n<pre><code>Prelude&gt; [x*2|x&lt;-[1..10]]\n[2,4,6,8,10,12,14,16,18,20]\n</code></pre>\n\n<p>Well it seems not like F#'s \"seq\" which is lazy evaluated. Here all the elements inside this set is printed out, so seems \"list comprehension\" is eager evaluation.</p>\n\n<p>What if I wish to build a \"lazy evaluated\" one?\nThanks.</p>\n"}, {"tags": ["haskell", "stack-overflow", "infinite"], "comments": [{"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1454545953, "post_id": 35169048, "comment_id": 58098011, "body": "I&#39;m having a hard time understanding your question, because of the initial example with the &quot;distributive&quot; equation for <code>&gt;*&gt;</code>, whose left hand side involves finite lists of singleton lists\u2014not finite lists of infinite lists or vice-versa."}, {"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1454546363, "post_id": 35169048, "comment_id": 58098125, "body": "Sorry, my bad, should have been more specific... If you do: <code>forever1 [[1]]</code> then it is building a finite list of infinite lists using <code>~&gt;</code>. <code>forever</code> is like repeat, but does it multiplicatively, so it becomes an infinite power.  Anyways, I&#39;m now quite certain that this is not possible under any circumstance, but I haven&#39;t the words to formulate a proper formal answer... Perhaps you do?  <code>forever1 [[1]]</code> will cause stack overflow."}], "owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1454476701, "creation_date": 1454476701, "question_id": 35169048, "link": "https://stackoverflow.com/questions/35169048/haskell-repeat-multiplicative-sequencer-on-finite-list-of-infinite-lists", "title": "haskell: Repeat multiplicative sequencer on finite list of infinite lists", "body": "<p>Given a finite list of infinite lists, or alternatively, an infinite list of finite lists, I'd like to apply a multiplicative operator <code>(~&gt;)</code> or <code>(~~&gt;)</code> or <code>(&gt;*&gt;)</code> if you will that obeys the distributive property:</p>\n\n<pre><code>[[a], [b], [c]] &gt;*&gt; [[d], [e]] == [[a, d], [a, e], [b, d], [b, e], [c, d], [c, e]]\n</code></pre>\n\n<p>This also applies to <code>(~&gt;)</code>, and for <code>(~~&gt;)</code> the transposed representation.</p>\n\n<p>I'd then like to \"repeat\" this multiplicative operator \"forever``</p>\n\n<p>Here are my attempts, all of which due to co-dependency (I think) end up in stack overflow or never terminates.</p>\n\n<p>Example 1:</p>\n\n<pre><code>import Data.Maybe(listToMaybe)\nimport Control.Monad(liftM2)\n\ntype A = [[Int]]\n\na :: A\na = [[1]]\n\n-- Building finite lists of infinite lists:\n(~&gt;) :: A -&gt; A -&gt; A\n(~&gt;) = liftM2 (++)\n\nforever1 :: A -&gt; A\nforever1 p = p ~&gt; forever1 p\n\nforever2 :: A -&gt; A\nforever2 p = forever2 p ~&gt; p\n</code></pre>\n\n<p>Example 2:</p>\n\n<pre><code>-- Building infinite lists of finite lists:\n(~~&gt;) p q = mx q p ++ mx p q\n    where innerLen = maybe 0 length . listToMaybe\n          mx a = map (concatMap $ replicate $ innerLen a)\n\nforever3 :: A -&gt; A\nforever3 p = p ~~&gt; forever3 p\n\nforever4 :: A -&gt; A\nforever4 p = forever4 p ~~&gt; p\n\n{-\nforever1 p = do\n    x &lt;- p\n    y &lt;- do\n        x' &lt;- p\n        y' &lt;- do\n            ...\n    return $ x ++ y\n\nforever1 p =\n    p &gt;&gt;= \\x1 -&gt; p &gt;&gt;= \\x2 -&gt; p &gt;&gt;= ... &gt;&gt;= \\xn -&gt; return concat [x1, x2, ... xn]\n-}\n</code></pre>\n\n<p>Example 3:</p>\n\n<pre><code>u = undefined\n\ntype ActionFn a = a -&gt; (Action a, a)\ndata Action a = None | A { act :: ActionFn a }\nnewtype Program a = P { actions :: [Action a] }\n\n(&gt;&gt;&gt;) :: Action a -&gt; Action a -&gt; Action a\n(&gt;&gt;&gt;) None q = q\n(&gt;&gt;&gt;) (A f) g = A $ \\a -&gt; let (h, b) = f a in (h &gt;&gt;&gt; g, b)\n\n(&gt;*&gt;) :: Program a -&gt; Program a -&gt; Program a\n(&gt;*&gt;) (P ps) (P qs) = P $ zipWith (&gt;&gt;&gt;) (mul qs ps) (mul ps qs)\n    where mul other = concatMap (replicate $ length other)\n\nbasic :: ActionFn a -&gt; Program a\nbasic = P . return . A\n\nidle :: Program a\nidle = basic $ \\a -&gt; (None, a)\n\nforever5 :: Program a -&gt; Program a\nforever5 p = p &gt;*&gt; forever5 p\n\ntestF5 = map (const \"x\") $ actions $ forever5 idle\n</code></pre>\n\n<p>The lists aren't actually made up of <code>Int</code>s but rather functions <code>a -&gt; a</code>.</p>\n\n<p>Is my problem possible to solve in some way? If so - how?\nOr is it not possible?</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1454478924, "post_id": 35169024, "comment_id": 58056867, "body": "You cannot reinstall <code>base</code> with cabal. If you need to update <code>base</code>, you must update your compiler version. In general, if you do <code>ghc-pkg unregister &lt;pkg&gt;</code> it will first tell you what will be broken by this (and hence, the dependencies which you need to unregister to unregister <code>&lt;pkg&gt;</code>) but this doesn&#39;t apply in this case."}, {"owner": {"reputation": 211, "user_id": 1698641, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/55e5b0d7a78344b0c97dbe685af5aad1?s=128&d=identicon&r=PG", "display_name": "user1698641", "link": "https://stackoverflow.com/users/1698641/user1698641"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454525879, "post_id": 35169024, "comment_id": 58087743, "body": "Thanks you @user2407038 you saved my day! I reinstalled ghc and base package is updated!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1454538368, "post_id": 35169024, "comment_id": 58095125, "body": "Also, reverse dependencies don&#39;t prevent you from installing a new version of a package. Multiple installations of the same package (with different version numbers) can happily live alongside each other in GHC&#39;s package database. (Modern GHC&#39;s can even support multiple installations of the same version of the same library with different dependency trees, though cabal has not yet officially grown support for this feature.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454556921, "post_id": 35169024, "comment_id": 58101038, "body": "@DanielWagner, the Haskell world awaits proper support for said feature with bated breath, sitting on the edges of our seats. That will be a great day. Of course, will still have to deal with the lack of first-class, parameterized modules, orphan instances, the evils if overlapping and closed type families, etc."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456433054, "post_id": 35169024, "comment_id": 58957272, "body": "@user2407038 since your comment solved the issue you should submit it as an answer."}, {"owner": {"reputation": 211, "user_id": 1698641, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/55e5b0d7a78344b0c97dbe685af5aad1?s=128&d=identicon&r=PG", "display_name": "user1698641", "link": "https://stackoverflow.com/users/1698641/user1698641"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456533083, "post_id": 35169024, "comment_id": 59008504, "body": "@user2407038 I liked your comment but I can&#39;t submit it as an answer so I just posted answer by myself"}], "answers": [{"tags": [], "owner": {"reputation": 211, "user_id": 1698641, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/55e5b0d7a78344b0c97dbe685af5aad1?s=128&d=identicon&r=PG", "display_name": "user1698641", "link": "https://stackoverflow.com/users/1698641/user1698641"}, "is_accepted": false, "score": 1, "last_activity_date": 1463437255, "last_edit_date": 1463437255, "creation_date": 1456533018, "answer_id": 35664177, "question_id": 35169024, "link": "https://stackoverflow.com/questions/35169024/how-to-find-installed-reverse-dependencies-of-a-package-in-cabal/35664177#35664177", "title": "How to find installed reverse dependencies of a package in cabal", "body": "<p>Updating compiler updated the base package. As explained by user2407038:</p>\n\n<blockquote>\n  <p>You cannot reinstall base with cabal. If you need to update base, you must update your compiler version. In general, if you do ghc-pkg unregister  it will first tell you what will be broken by this (and hence, the dependencies which you need to unregister to unregister ) but this doesn't apply in this case.</p>\n</blockquote>\n"}], "owner": {"reputation": 211, "user_id": 1698641, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/55e5b0d7a78344b0c97dbe685af5aad1?s=128&d=identicon&r=PG", "display_name": "user1698641", "link": "https://stackoverflow.com/users/1698641/user1698641"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463437255, "creation_date": 1454476612, "question_id": 35169024, "link": "https://stackoverflow.com/questions/35169024/how-to-find-installed-reverse-dependencies-of-a-package-in-cabal", "title": "How to find installed reverse dependencies of a package in cabal", "body": "<p>I need to install newest base package but cabal does not let me to do it</p>\n\n<pre><code>cabal install base --reinstall\nResolving dependencies...\ncabal: Could not resolve dependencies:\nnext goal: base (user goal)\nrejecting: base-4.8.2.0, 4.8.1.0, 4.8.0.0, 4.7.0.2, 4.7.0.1, 4.7.0.0, 4.6.0.1,\n4.6.0.0, 4.5.1.0, 4.5.0.0, 4.4.1.0, 4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2,\n4.2.0.1, 4.2.0.0, 4.1.0.0, 4.0.0.0 (only already installed instances can be\nused)\nrejecting: base-3.0.3.2 (conflict: base =&gt; base&gt;=4.0 &amp;&amp; &lt;4.3)\nrejecting: base-3.0.3.1 (conflict: base =&gt; base&gt;=4.0 &amp;&amp; &lt;4.2)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>So I think that when I unregister the dependencies which are holding this package to the old version I can do it</p>\n\n<pre><code>ghc-pkg unregister some_annoying_package\n</code></pre>\n\n<p>But how can I find these packages. I found only </p>\n\n<pre><code>cabal-db revdeps base\n</code></pre>\n\n<p>which gives me all the dependencies form hackage not just the installed one.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 273, "user_id": 3857250, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c603a09e908db2b2ddb53c59343fccc7?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan Scott", "link": "https://stackoverflow.com/users/3857250/johnathan-scott"}, "reply_to_user": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1454473554, "post_id": 35168414, "comment_id": 58055066, "body": "My mistake sorry, myTest is supposed to be <code>after</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": false, "score": 4, "last_activity_date": 1454476557, "creation_date": 1454476557, "answer_id": 35169018, "question_id": 35168414, "link": "https://stackoverflow.com/questions/35168414/recursively-dropping-elements-from-list-in-haskell/35169018#35169018", "title": "Recursively dropping elements from list in Haskell", "body": "<p>Try something like this:</p>\n\n<pre><code>after :: [Int] -&gt; Int -&gt; Int -&gt; Bool\nafter (n:ns) a b | n == a = ns `elem` b\n                 | otherwise = after ns a b\nafter _      _ _ = False\n</code></pre>\n\n<p>Basically, the function steps through the list, element by element. If at any point it encounters <code>a</code> (the first number), then it checks to see if <code>b</code> is in the remainder of the list. If it is, it returns <code>True</code>, otherwise it returns <code>False</code>. Also, if it hits the end of the list without ever seeing <code>a</code>, it returns <code>False</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "is_accepted": false, "score": 3, "last_activity_date": 1454486558, "creation_date": 1454486558, "answer_id": 35171493, "question_id": 35168414, "link": "https://stackoverflow.com/questions/35168414/recursively-dropping-elements-from-list-in-haskell/35171493#35171493", "title": "Recursively dropping elements from list in Haskell", "body": "<pre><code>after :: Eq a =&gt; [a] -&gt; a -&gt; a -&gt; Bool\nafter ns a b =\n  case dropWhile (/= a) ns of\n    [] -&gt; False\n    _:xs -&gt; b `elem` xs\n</code></pre>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.List.html#dropWhile\" rel=\"nofollow\">http://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.List.html#dropWhile</a></p>\n"}, {"comments": [{"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1454553027, "post_id": 35172904, "comment_id": 58100007, "body": "Unless I have misunderstood, the assignment didn&#39;t specify a function which determined if <code>a</code> was IMMEDIATELY after <code>b</code>, just if it was present in the list at some point after it. If so, then this solution answers the wrong problem."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1454554481, "post_id": 35172904, "comment_id": 58100398, "body": "@Kwarrtz, you seem to have confused subsequence with segment."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1454562401, "post_id": 35172904, "comment_id": 58102803, "body": "@dfuer, yes I suppose I have. My apologies."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1454491260, "creation_date": 1454491260, "answer_id": 35172904, "question_id": 35168414, "link": "https://stackoverflow.com/questions/35168414/recursively-dropping-elements-from-list-in-haskell/35172904#35172904", "title": "Recursively dropping elements from list in Haskell", "body": "<pre><code>after xs p1 p2 = [p1, p2] `isSubsequenceOf` xs\n</code></pre>\n\n<p>So how can we define that? Fill in the blanks below!</p>\n\n<pre><code>isSubsequenceOf :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\n\n[] `isSubsequenceOf` _ = ?\n(_ : _) `isSubsequenceOf` [] = ?\nxss@(x : xs) `isSubsequenceOf` (y:ys)\n  | x == y = ?\n  | otherwise = ?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 0, "last_activity_date": 1454590622, "last_edit_date": 1454590622, "creation_date": 1454571228, "answer_id": 35195065, "question_id": 35168414, "link": "https://stackoverflow.com/questions/35168414/recursively-dropping-elements-from-list-in-haskell/35195065#35195065", "title": "Recursively dropping elements from list in Haskell", "body": "<pre><code>   after :: [Int] -&gt; Int -&gt; Int -&gt; Bool\n   Prelude&gt; let after xs a b =  elem b . tail $ dropWhile (/=a) xs\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>  Prelude&gt; after   [1,2,3,4,3] 88  7\n  *** Exception: Prelude.tail: empty list\n</code></pre>\n\n<p>It raises an exception because of tail. It's easy to write tail' such that it won't raise that exception. Otherwise it works pretty well.</p>\n\n<pre><code>  Prelude&gt; after  [1,2,3,4,3] 2  7\n  False\n  Prelude&gt; after   [1,2,3,4,3] 2  4\n  True\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 3857250, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c603a09e908db2b2ddb53c59343fccc7?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan Scott", "link": "https://stackoverflow.com/users/3857250/johnathan-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 2, "answer_count": 4, "score": 0, "last_activity_date": 1454590622, "creation_date": 1454472992, "last_edit_date": 1454473568, "question_id": 35168414, "link": "https://stackoverflow.com/questions/35168414/recursively-dropping-elements-from-list-in-haskell", "title": "Recursively dropping elements from list in Haskell", "body": "<p>Right now I'm working on a problem in Haskell in which I'm trying to check a list for a particular pair of values and return True/False depending on whether they are present in said list. The question goes as follows:</p>\n\n<blockquote>\n  <p>Define a function called <code>after</code> which takes a list of integers and two integers as parameters. <code>after numbers num1 num2</code> should return true if <code>num1</code> occurs in the list and <code>num2</code> occurs after <code>num1</code>. If not it must return false.</p>\n</blockquote>\n\n<p>My plan is to check the head of the list for <code>num1</code> and drop it, then recursively go through until I 'hit' it. Then, I'll take the head of the tail and check that against <code>num2</code> until I hit or reach the end of the list. </p>\n\n<p>I've gotten stuck pretty early, as this is what I have so far:</p>\n\n<pre><code>after :: [Int] -&gt; Int -&gt; Int -&gt; Bool\nafter x y z\n    | y /= head x =  after (drop 1 x) y z\n</code></pre>\n\n<p>However when I try to run something such as <code>after [1,4,2,6,5] 4 5</code> I get a format error. I'm really not sure how to properly word the line such that haskell will understand what I'm telling it to do.</p>\n\n<p>Any help is greatly appreciated! Thanks :)</p>\n\n<p>Edit 1: This is the error in question: </p>\n\n<pre><code>Program error: pattern match failure: after [3,Num_fromInt instNum_v30 4] 3 (Num_fromInt instNum_v30 2)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 12166, "user_id": 202085, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b4c61284eecf2e9e927706a336d704f?s=128&d=identicon&r=PG", "display_name": "Upgradingdave", "link": "https://stackoverflow.com/users/202085/upgradingdave"}, "edited": false, "score": 0, "creation_date": 1454504459, "post_id": 35168255, "comment_id": 58072442, "body": "Thanks for the great answers. They make great sense. Also, I should have read this before I posted! <a href=\"https://www.haskell.org/tutorial/numbers.html\" rel=\"nofollow noreferrer\">haskell.org/tutorial/numbers.html</a>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454478871, "post_id": 35168624, "comment_id": 58056842, "body": "By then, you surely want <code>div</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454479369, "post_id": 35168624, "comment_id": 58057079, "body": "@dfeuer realistically, you probably don&#39;t want this function at all. It computes a base 10 log if I&#39;m not mistaken. There must be a library function for that."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1454478270, "last_edit_date": 1454478270, "creation_date": 1454474300, "answer_id": 35168624, "question_id": 35168255, "link": "https://stackoverflow.com/questions/35168255/what-type-signature-or-annotations-are-needed-for-this-haskell-function/35168624#35168624", "title": "What type signature or annotations are needed for this Haskell function?", "body": "<p>The type of <code>test</code> is <code>(Integral a1, Num a, RealFrac a1) =&gt; a1 -&gt; a</code>. This type is not usable as is because there are no usable types that are both <code>Integral</code> and <code>RealFrac</code>.</p>\n\n<p>Why is that? You are using <code>n / 10</code>, the division requires <code>Fractional</code> arguments, and <code>n</code> is the argument of <code>test</code>, so the argument of <code>test</code> must be a <code>Fractional</code>. It must be even a <code>RealFrac</code> because you then feed the result of the division to <code>floor</code>, and <code>floor</code> accepts a <code>RealFrac</code> argument. OTOH you are using <code>test (floor ...)</code>, and <code>floor</code> returns an <code>Integral</code>, so the argument of <code>test</code> must be an <code>Integral</code> as well!</p>\n\n<p>If you want <code>test</code> to be of type, say, <code>Integral a =&gt; a-&gt;a</code>, you need to convert <code>n</code> from integral so that division and <code>floor</code> can be performed:</p>\n\n<pre><code>test n = test (floor (fromIntegral n / 10))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": false, "score": 6, "last_activity_date": 1454533930, "last_edit_date": 1454533930, "creation_date": 1454484482, "answer_id": 35170916, "question_id": 35168255, "link": "https://stackoverflow.com/questions/35168255/what-type-signature-or-annotations-are-needed-for-this-haskell-function/35170916#35170916", "title": "What type signature or annotations are needed for this Haskell function?", "body": "<p>There are a few basic things you need to understand about Haskell numbers:</p>\n\n<ol>\n<li><p>There are no implicit numeric type conversions in Haskell</p></li>\n<li><p>There is a limited amount of operator overloading, but only for members of a type class</p></li>\n<li><p>There are a lot of numeric type classes, each of which supports a different set of operations</p></li>\n<li><p>Some type classes <em>imply</em> other ones; they all imply <code>Num</code>, for example, so the operators on <code>Num</code> work for all numbers</p></li>\n</ol>\n\n<p>The essence of your problem is that you've got contradictory type constraints, but the compiler doesn't know enough to tell you that the constraint you need is nonsensical rather than just ambiguous or missing.</p>\n\n<p>The contradiction arises because the \"real division\" operator <code>/</code> is in the <code>Fractional</code> type class. But you are also using <code>floor</code>, which has a return type constrained to the <code>Integral</code> class. So for this to make sense, you would need a numeric type that was both <code>Integral</code> and <code>Fractional</code>, which doesn't make sense.</p>\n\n<p>There are a couple of ways to resolve the contradiction:</p>\n\n<ol>\n<li><p>Don't use \"real division\"; use <code>div</code> which is defined in the <code>Integral</code> class</p></li>\n<li><p>Use <code>fromIntegral</code> to convert the <code>Integral</code> argument to <code>/</code> to a suitable member of <code>Fractional</code></p></li>\n</ol>\n\n<hr>\n\n<p>When I'm working with numeric code and trying to figure out the constraints I often take this approach:</p>\n\n<p>I slap some type annotations on the top-level functions with a concrete numeric type of the general sort I want; usually Int or Double depending on what sort of calculations. For your <code>test</code> function, I would write <code>test :: Int -&gt; Int</code>.  At this point, GHC would give me a straightforward error message: </p>\n\n<pre><code>No instance for (RealFrac Int) arising from a use of \u2018floor\u2019\nIn the first argument of \u2018test\u2019, namely \u2018(floor (n / 10))\u2019\nIn the expression: test (floor (n / 10))\nIn an equation for \u2018test\u2019: test n = test (floor (n / 10))\n\nNo instance for (Fractional Int) arising from a use of \u2018/\u2019\nIn the first argument of \u2018floor\u2019, namely \u2018(n / 10)\u2019\nIn the first argument of \u2018test\u2019, namely \u2018(floor (n / 10))\u2019\nIn the expression: test (floor (n / 10))\n</code></pre>\n\n<p>Now I know that <code>/</code> and <code>floor</code> are expecting <code>Fractional</code> types; I either need to use some explicit type conversion to satisfy them, try a different type, or find some other operators! If I try <code>test :: Double -&gt; Double</code> I get a similar error:</p>\n\n<pre><code>No instance for (Integral Double) arising from a use of \u2018floor\u2019\nIn the first argument of \u2018test\u2019, namely \u2018(floor (n / 10))\u2019\nIn the expression: test (floor (n / 10))\nIn an equation for \u2018test\u2019: test n = test (floor (n / 10))\n</code></pre>\n\n<p>At this point, it's clear that a single type isn't going to satisfy these constraints. The algorithm looks like it wants an <code>Integral</code>, so I'll search the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html\" rel=\"nofollow\">Prelude</a> page for \"division\" and see what there is.</p>\n\n<p>Fortunately, <code>Integral</code> provides two different division operations, <code>quot</code> and <code>div</code>. Looking at the descriptions, it looks like <code>div</code> matches up with the semantics of <code>/</code> followed by <code>floor</code>, so that can be used to both eliminate the type errors and simplify the function!</p>\n\n<p>Now I can either leave it as an <code>Int -&gt; Int</code> function, or I can generalize it again to <code>Integral a =&gt; a -&gt; a</code>. Depends on whether I'm going to use it in some other context, or if it's part of something specific where it's clear there's no need for a more general type.</p>\n"}], "owner": {"reputation": 12166, "user_id": 202085, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b4c61284eecf2e9e927706a336d704f?s=128&d=identicon&r=PG", "display_name": "Upgradingdave", "link": "https://stackoverflow.com/users/202085/upgradingdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1454533930, "creation_date": 1454471988, "last_edit_date": 1495535305, "question_id": 35168255, "link": "https://stackoverflow.com/questions/35168255/what-type-signature-or-annotations-are-needed-for-this-haskell-function", "title": "What type signature or annotations are needed for this Haskell function?", "body": "<p>I'm new to Haskell and I'm having trouble understanding exactly which type annotations or which type signature is needed to get this to work. This <code>test</code> function itself is useless, but if I can understand how to get it to work, I think it'd help me to understand haskell types better.</p>\n\n<pre><code>test 0 = -1\ntest n = test (floor (n / 10))\n</code></pre>\n\n<p>This question seems to be related:\n<a href=\"https://stackoverflow.com/questions/19497940/haskell-why-does-realfrac-not-imply-fractional\">Haskell: Why does RealFrac not imply Fractional?</a></p>\n\n<p>But I can't figure out how to get my example to work. Here's the error I see when I run <code>test 0</code>: </p>\n\n<pre><code>&lt;interactive&gt;:470:1:\nCould not deduce (Integral a10) arising from a use of \u2018test\u2019\nfrom the context (Num a)\n  bound by the inferred type of it :: Num a =&gt; a\n  at &lt;interactive&gt;:470:1-6\nThe type variable \u2018a10\u2019 is ambiguous\nNote: there are several potential instances:\n  instance Integral Foreign.C.Types.CChar\n    -- Defined in \u2018Foreign.C.Types\u2019\n  instance Integral Foreign.C.Types.CInt\n    -- Defined in \u2018Foreign.C.Types\u2019\n  instance Integral Foreign.C.Types.CIntMax\n    -- Defined in \u2018Foreign.C.Types\u2019\n  ...plus 28 others\nIn the expression: test 0\nIn an equation for \u2018it\u2019: it = test 0\n\n&lt;interactive&gt;:470:6:\nCould not deduce (Num a10) arising from the literal \u20180\u2019\nfrom the context (Num a)\n  bound by the inferred type of it :: Num a =&gt; a\n  at &lt;interactive&gt;:470:1-6\nThe type variable \u2018a10\u2019 is ambiguous\nNote: there are several potential instances:\n  instance RealFloat a =&gt; Num (Data.Complex.Complex a)\n    -- Defined in \u2018Data.Complex\u2019\n  instance Data.Fixed.HasResolution a =&gt; Num (Data.Fixed.Fixed a)\n    -- Defined in \u2018Data.Fixed\u2019\n  instance forall (k :: BOX) (f :: k -&gt; *) (a :: k).\n           Num (f a) =&gt;\n           Num (Data.Monoid.Alt f a)\n    -- Defined in \u2018Data.Monoid\u2019\n  ...plus 42 others\nIn the first argument of \u2018test\u2019, namely \u20180\u2019\nIn the expression: test 0\nIn an equation for \u2018it\u2019: it = test 0\n</code></pre>\n"}, {"tags": ["haskell", "concurrency", "gtk3", "haskell-pipes"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1454470989, "post_id": 35167939, "comment_id": 58054296, "body": "Can you add a small, stripped-down, self-contained version of your code?"}], "answers": [{"tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": false, "score": 3, "last_activity_date": 1454480758, "creation_date": 1454480758, "answer_id": 35169948, "question_id": 35167939, "link": "https://stackoverflow.com/questions/35167939/pipes-concurrent-sent-signal-is-delivered-one-click-later-than-expected/35169948#35169948", "title": "Pipes.Concurrent: Sent signal is delivered one click later than expected", "body": "<p>Using the <code>latest</code> buffering strategy means there's always a value available to read in the buffer, so <code>await</code> will always return immediately; and <code>send</code> will likewise always succeed, so long as it gets a chance to run. A test program I wrote worked okay in ghci, but when compiled it never let the thread run that was trying to read from the console and <code>send</code>; I just got an endless stream of <code>0</code> until I terminated the program.</p>\n\n<p>Your consumer <code>run</code> doesn't have anything in it that would cause it to pause, so it may similarly be starving the thread that is trying to <code>send</code> to <code>output</code>. If this is the case, a small <code>threadDelay 100</code> or so before each call to <code>run</code> might help.</p>\n\n<p>Another possibility, and a more efficient one, would be to use a buffer that blocks the <code>Consumer</code> until there's a message to act on. To avoid blocking the event callback, you could use the <code>newest 1</code> buffer strategy, which would always succeed with <code>send</code> and overwrite the current value if there was already one there.</p>\n\n<p>If neither of those help, then I suspect that there's something else going on with the way the GUI framework you're using is plumbed, but I am not very familiar with the GTK bindings in Haskell so I can't be of much help with that. </p>\n"}], "owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1454480758, "creation_date": 1454469939, "last_edit_date": 1454470318, "question_id": 35167939, "link": "https://stackoverflow.com/questions/35167939/pipes-concurrent-sent-signal-is-delivered-one-click-later-than-expected", "title": "Pipes.Concurrent: Sent signal is delivered one click later than expected", "body": "<p>I'm using Pipes.Concurrent to write a short GUI program with GTK. It's a minesweeper-esque game, so I'm constructing a grid of buttons.</p>\n\n<p>I construct and connect my buttons with:</p>\n\n<pre><code>b &lt;- buttonNewWithLabel (show $ adjacencies board ! i)\non b buttonActivated \n     $ void . atomically $ send output (ClickSignal i (mines board ! i))\nreturn b\n</code></pre>\n\n<p>And I connect the pipe with:</p>\n\n<pre><code>(output, input)  &lt;- spawn (latest (ClickSignal 0 False))\n\nlet run = do\n        sig &lt;- await\n        case sig of\n            ClickSignal i isMine -&gt;\n                if isMine\n                then do\n                    lift $ labelSetText info (show i ++ \" -- LOSE!\")\n                else do \n                    lift $ labelSetText info (show i ++ \" -- Ok\")\n                    run\n            Empty -&gt; do\n                lift $ labelSetText info \"Empty Case\"\n                run\n\nvoid . forkIO $ do \n    runEffect $ fromInput input &gt;-&gt; run\n    performGC\n</code></pre>\n\n<p>It runs <em>almost</em> as expected. But if I click on button 1, nothing happens. But if I press button 23, it will update the info label to \"1..\". If I click on another button, it will update to \"23..\", and so forth.</p>\n\n<p>I suspect that either I'm failing to understand how concurrent pipes are meant to work on some level or lazy IO is doing something weird.</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 1531, "user_id": 3117915, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/Ml1ru.jpg?s=128&g=1", "display_name": "Yogesh D", "link": "https://stackoverflow.com/users/3117915/yogesh-d"}, "edited": false, "score": 1, "creation_date": 1454480414, "post_id": 35168091, "comment_id": 58057497, "body": "Thank you for your answer. But while reading about Haskell, I came across a statement in the introduction chapter -  <b>&quot;The prompt here is Prelude&gt; but because it can get longer when you load stuff into the session, we&#39;re going to use ghci&gt;&quot;</b>. Does using ghci prompt over prelude have any implications over loading time?"}, {"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 4, "creation_date": 1454487122, "post_id": 35168091, "comment_id": 58060700, "body": "The prompt is only informational / aesthetic; it doesn&#39;t affect loading time, but it can get rather long and take up a large portion of the line if you&#39;re in a narrow window. The only loss when changing to a fixed prompt is that you will have to remember which packages have been imported instead of being able to look at them in the prompt."}, {"owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "edited": false, "score": 1, "creation_date": 1454488268, "post_id": 35168091, "comment_id": 58061327, "body": "If you want to know which things you have imported but also keep the prompt short, you should try importing as. I.e., <code>import Control.Monad as CM</code> will give you a prompt that looks like <code>Prelude CM&gt; </code>. (You don&#39;t have to use <code>CM.function</code> either because you haven&#39;t <code>import qualified</code>.)"}], "tags": [], "owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "is_accepted": true, "score": 19, "last_activity_date": 1454470963, "creation_date": 1454470963, "answer_id": 35168091, "question_id": 35167627, "link": "https://stackoverflow.com/questions/35167627/ghci-vs-prelude-command-prompt-in-haskell/35168091#35168091", "title": "GHCI vs Prelude command prompt in Haskell", "body": "<p>Okay, if I'm understanding this correctly, you're wondering if there's a difference between</p>\n\n<pre><code>Prelude&gt; \n</code></pre>\n\n<p>and</p>\n\n<pre><code>ghci&gt;\n</code></pre>\n\n<p>as prompts after you've invoked GHCi from the command line.</p>\n\n<p>If this is the case, then there is no real difference aside from preference. You can change the prompt to whatever you want to by using the command:</p>\n\n<pre><code>:set prompt \"aglebargle&gt; \"\n</code></pre>\n\n<p>You can replace <code>arglebargle&gt;</code> with whatever you'd like.</p>\n\n<p>The main advantage I see for the <code>Prelude&gt;</code> prompt is that it will update when you import modules. Prelude is the only module you have without any imports, which is why it's the prompt. E.g., if you, say, did <code>import Control.Monad</code>, you'd get <code>Prelude Control.Monad&gt;</code> as a prompt.</p>\n"}], "owner": {"reputation": 1531, "user_id": 3117915, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/Ml1ru.jpg?s=128&g=1", "display_name": "Yogesh D", "link": "https://stackoverflow.com/users/3117915/yogesh-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3086, "favorite_count": 0, "accepted_answer_id": 35168091, "answer_count": 1, "score": 9, "last_activity_date": 1454470963, "creation_date": 1454467754, "question_id": 35167627, "link": "https://stackoverflow.com/questions/35167627/ghci-vs-prelude-command-prompt-in-haskell", "title": "GHCI vs Prelude command prompt in Haskell", "body": "<p>I am trying to learn Haskell from the beginning and was wondering what exactly is the difference between the two prompts (Haskell and Prelude) that are used in it. It may sound a very naive question and not to mention I tried searching for the answer before posting this question but couldn't find one (proper one). Thank you in advance.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1454466253, "post_id": 35167428, "comment_id": 58053056, "body": "Of course, the third problem is that <code>k</code> is probably supposed to be used for something, and the fourth is that it&#39;s impossible to tell from the problem description whether the math is as intended."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1454466139, "creation_date": 1454466139, "answer_id": 35167428, "question_id": 35167377, "link": "https://stackoverflow.com/questions/35167377/how-to-print-a-formula-like-13-2-in-haskell/35167428#35167428", "title": "how to print a formula like &quot;1+(3-2)&quot; in haskell?", "body": "<p>The first level of problems can be solved by adding parentheses to group the argument to <code>print</code> (or by using <code>$</code>):</p>\n\n<pre><code>main = do\n    n &lt;- getLine\n    k &lt;- getLine\n    print (1+(n-1)+(n-1)*(n-2)/n^3)\n    -- OR\n    print $ 1+(n-1)+(n-1)*(n-2)/n^3\n</code></pre>\n\n<p>The next level of problems is that <code>n</code> is a <code>String</code>, but you're hoping for it to be some kind of number. You can fix this by using <code>readLn</code> instead of <code>getLine</code> and specifying what type you want to use; for example:</p>\n\n<pre><code>main = do\n    n &lt;- readLn :: IO Double\n    k &lt;- getLine\n    print $ 1+(n-1)+(n-1)*(n-2)/n^3\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5875648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jrYKi.png?s=128&g=1", "display_name": "Sirotama", "link": "https://stackoverflow.com/users/5875648/sirotama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454466139, "creation_date": 1454465807, "question_id": 35167377, "link": "https://stackoverflow.com/questions/35167377/how-to-print-a-formula-like-13-2-in-haskell", "title": "how to print a formula like &quot;1+(3-2)&quot; in haskell?", "body": "<p>how do i solve this problem in haskell?</p>\n\n<p>\"\nA machine selects an integral number ( more than or equal to one and less than or equal to N)\nwith equal probability at one operation.\nFind the  excepted probability in which the median of three integral number\nselected by three times operation with the machine above is K. (K is also integral number)\n\"</p>\n\n<p>first i tried this and got this error:</p>\n\n<pre><code>main = do\n\n    n &lt;- getLine\n    k &lt;- getLine\n\n    print 1+(n-1)+(n-1)*(n-2)/n^3\n</code></pre>\n\n<p>q4.hs:7:18:\n    Couldn't match type \u2018[Char]\u2019 with \u2018IO ()\u2019\n    Expected type: IO ()\n      Actual type: String\n    In the first argument of \u2018(-)\u2019, namely \u2018n\u2019\n    In the second argument of \u2018(+)\u2019, namely \u2018(n - 1)\u2019</p>\n\n<p>q4.hs:7:24:\n    Couldn't match type \u2018[Char]\u2019 with \u2018IO ()\u2019\n    Expected type: IO ()\n      Actual type: String\n    In the first argument of \u2018(-)\u2019, namely \u2018n\u2019\n    In the first argument of \u2018(*)\u2019, namely \u2018(n - 1)\u2019</p>\n\n<p>q4.hs:7:30:\n    Couldn't match type \u2018[Char]\u2019 with \u2018IO ()\u2019\n    Expected type: IO ()\n      Actual type: String\n    In the first argument of \u2018(-)\u2019, namely \u2018n\u2019\n    In the second argument of \u2018(*)\u2019, namely \u2018(n - 2)\u2019</p>\n\n<p>q4.hs:7:35:\n    Couldn't match type \u2018[Char]\u2019 with \u2018IO ()\u2019\n    Expected type: IO ()\n      Actual type: String\n    In the first argument of \u2018(^)\u2019, namely \u2018n\u2019\n    In the second argument of \u2018(/)\u2019, namely \u2018n ^ 3\u2019</p>\n\n<p>how do i solve this problem?\nsorry i'm very new to haskell(and english too.) \nthank you.</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "comments": [{"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1454443394, "post_id": 35161616, "comment_id": 58043852, "body": "You might want to look at this question as well as the excellent answers: <a href=\"http://stackoverflow.com/questions/14131856/whats-the-absurd-function-in-data-void-useful-for\">&quot;What&#39;s the <code>absurd</code> function in <code>Data.Void</code> useful for?&quot;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1454440842, "post_id": 35162024, "comment_id": 58042312, "body": "<code>Pipes.X</code> is more like the <code>Void</code> of the <code>void</code> package, <code>newtype X = X X</code>, with <code>closed (X x) = closed x</code> for <code>absurd</code>, but the point is basically the same."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1454441121, "post_id": 35162024, "comment_id": 58042463, "body": "@Michael, that&#39;s probably because it&#39;s an evolutionary remnant that might be too hard to get rid of now. The <code>Void</code> package actually only compiles that code for old versions of <code>base</code>--otherwise most of the package is gutted by Cabal in favor of the <code>base</code> versions."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1454444921, "post_id": 35162024, "comment_id": 58044733, "body": "So, it would&#39;ve been just as valid if the library used <code>data X = X</code> and <code>data Y = Y</code> for input and output since X /= Y and it is also not possible to hook them up ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1454445205, "post_id": 35162024, "comment_id": 58044882, "body": "@Ana, I believe all sorts of such things would be valid. Of course, Gonzalez may have some deeper reasoning behind this--he knows a while lot more about category theory and pipes than I do!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1454440681, "creation_date": 1454440681, "answer_id": 35162024, "question_id": 35161616, "link": "https://stackoverflow.com/questions/35161616/why-does-haskell-pipes-use-to-close-unused-inputs-and-x-the-uninhabited-typ/35162024#35162024", "title": "Why does Haskell Pipes &quot;use () to close unused inputs and X (the uninhabited type) to close unused outputs&quot;?", "body": "<p><code>X</code> in pipes is normally spelled <code>Void</code> in the rest of the Haskell ecosystem, so let's pretend <code>X = Void</code>. It's defined like this:</p>\n\n<pre><code>data Void\n</code></pre>\n\n<p>And it has an \"eliminator\"</p>\n\n<pre><code>absurd :: Void -&gt; a\nabsurd x = case x of {}\n</code></pre>\n\n<p>If you have something of type <code>Void</code> (and force it), then <em>something has gone wrong</em>. Your program has produced an error, or it's stuck in an infinite loop.</p>\n\n<p>Making a pipe <em>produce</em> things of type <code>Void</code> bars it from ever producing anything (legitimate). Making it produce things of type <code>()</code> allows it to produce things, but things that carry no information. They're basically clock ticks.</p>\n\n<p>On the input side, a pipe that consumes things of type <code>Void</code> can await input, but as soon as it does so it is stuck--no one will be able to feed it anything. A pipe that consumes things of type <code>()</code> can await, but only gets clock ticks.</p>\n\n<p>All of these options are reasonable. I suspect Gonzalez wanted the type system to prohibit users from accidentally hooking up a pure producer to a pure consumer the wrong way around, and getting an error that could be hard to track down. By making a pure producer consume <code>()</code>, and a pure consumer produce <code>Void</code>, he makes it impossible to hook them up the wrong way.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1454443403, "post_id": 35162455, "comment_id": 58043860, "body": "But pipes aren&#39;t functions. A pipe can consume without producing, produce without consuming, or even sit around effecting without doing either. I don&#39;t think the category of pipes over a non-identity monad is likely to have initial or final objects at all."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454443589, "post_id": 35162455, "comment_id": 58043949, "body": "For any two types <code>a</code> and <code>b</code>, there will be &quot;more&quot; pipes that consume <code>a</code> and produce <code>b</code> than functions <code>a -&gt; b</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1454442177, "creation_date": 1454442177, "answer_id": 35162455, "question_id": 35161616, "link": "https://stackoverflow.com/questions/35161616/why-does-haskell-pipes-use-to-close-unused-inputs-and-x-the-uninhabited-typ/35162455#35162455", "title": "Why does Haskell Pipes &quot;use () to close unused inputs and X (the uninhabited type) to close unused outputs&quot;?", "body": "<p>It's actually a more general thing than just for pipes. <code>()</code> and <code>X</code> are the <a href=\"https://en.wikipedia.org/wiki/Initial_and_terminal_objects\" rel=\"nofollow\">initial and terminal objects</a> of the <strong>Hask</strong> category (and of categories derived from <strong>Hask</strong>), meaning that <em>for all Haskell types <code>a</code></em>,</p>\n\n<ul>\n<li>there exists exactly one morphism <code>a -&gt; ()</code> (namely <code>const ()</code>)</li>\n<li>there exists exactly one morphism <code>X -&gt; a</code> (namely <code>absurd</code>).</li>\n</ul>\n\n<p>As a consequence, any chain of functions <code>a -&gt; ()</code>>>><code>() -&gt; b</code> can't actually depend on the left part (since <code>a -&gt; ()</code> carries no information), and any chain <code>a -&gt; X</code>>>><code>X -&gt; b</code> can't depend on the right part. In that sense, a <code>() -&gt; b</code> input is closed, and so is an <code>a -&gt; X</code> output.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 35162024, "answer_count": 2, "score": 8, "last_activity_date": 1479246463, "creation_date": 1454439340, "last_edit_date": 1479246463, "question_id": 35161616, "link": "https://stackoverflow.com/questions/35161616/why-does-haskell-pipes-use-to-close-unused-inputs-and-x-the-uninhabited-typ", "title": "Why does Haskell Pipes &quot;use () to close unused inputs and X (the uninhabited type) to close unused outputs&quot;?", "body": "<p>In the <a href=\"https://hackage.haskell.org/package/pipes-4.1.8/docs/Pipes-Tutorial.html#g:9\" rel=\"nofollow noreferrer\">Pipes Tutorial</a>, it says that:</p>\n\n<blockquote>\n  <p>The concrete type synonyms use <code>()</code> to close unused inputs and <code>X</code> (the\n  uninhabited type) to close unused outputs:</p>\n</blockquote>\n\n<p>I'd like to understand why <code>()</code> and <code>X</code> are used the way they are. Why not <code>X</code> or <code>()</code> for both inputs and outputs? </p>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 2322, "user_id": 33841, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/5xaqb.jpg?s=128&g=1", "display_name": "kmelvn", "link": "https://stackoverflow.com/users/33841/kmelvn"}, "edited": false, "score": 0, "creation_date": 1454437890, "post_id": 35160613, "comment_id": 58040557, "body": "Can&#39;t believe I missed that, I just copied curl output from the console and worked with that. The API I&#39;m using is broken, it doesn&#39;t wrap strings in quotes..."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 2, "last_activity_date": 1454435978, "creation_date": 1454435978, "answer_id": 35160613, "question_id": 35160600, "link": "https://stackoverflow.com/questions/35160600/parse-top-level-value-with-aeson/35160613#35160613", "title": "Parse top-level value with Aeson", "body": "<p>Try <code>decode \"\\\"JustSomeRandomString\\\"\" :: Maybe Bar</code></p>\n"}], "owner": {"reputation": 2322, "user_id": 33841, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/5xaqb.jpg?s=128&g=1", "display_name": "kmelvn", "link": "https://stackoverflow.com/users/33841/kmelvn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 35160613, "answer_count": 1, "score": 0, "last_activity_date": 1454435978, "creation_date": 1454435912, "question_id": 35160600, "link": "https://stackoverflow.com/questions/35160600/parse-top-level-value-with-aeson", "title": "Parse top-level value with Aeson", "body": "<p>I'm trying to parse JSON values with Aeson and I have no problem (so far) parsing objects or arrays, but I can't get Aeson to parse JSON documents that are just strings.</p>\n\n<p>As I understand, since RFC 7159 values are legal JSON documents, and Aeson supports that since 0.9.0.0 (I'm using 0.9.0.1), so it should work. For example, I'm wrapping an API that returns strings as top-level JSON documents for many of its calls, and would like to newtype those strings for some static typing safety:</p>\n\n<pre><code>newtype Bar = Bar String deriving (Eq, Show)\ninstance FromJSON Bar where\n    parseJSON (String v) = pure (Bar $ T.unpack v)\n    parseJSON _ = mzero\n</code></pre>\n\n<p>If I try to decode something:</p>\n\n<pre><code>decode \"JustSomeRandomString\" :: Maybe Bar\n</code></pre>\n\n<p>all I get is <code>Nothing</code> in return.</p>\n\n<p>Any ideas what I'm doing wrong? Of course, I could handle API calls that return strings as JSON documents without Aeson, but would like to keep things uniform!</p>\n"}, {"tags": ["haskell", "osx-elcapitan", "cabal", "haskell-diagrams"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1454430950, "post_id": 35156425, "comment_id": 58036058, "body": "Your ghc version may be too low so <code>DeriveGeneric</code> language extension was not working properly. Try stack build tool, it will install the correct version of ghc for you."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1454455347, "post_id": 35156425, "comment_id": 58049813, "body": "It looks like <code>Eq1</code> and friends are provided by the <code>transformers</code> (or perhaps <code>transformers-compat</code>) package. What version of <code>transformers</code> and <code>transformers-compat</code> is it selecting?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454462098, "post_id": 35156425, "comment_id": 58051877, "body": "(In particular, if you are using <code>--allow-newer</code>, that is probably causing the problem here.)"}, {"owner": {"reputation": 5116, "user_id": 3023116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce3371c6423c6f4b5fee8777b8c98c6?s=128&d=identicon&r=PG", "display_name": "taras", "link": "https://stackoverflow.com/users/3023116/taras"}, "edited": false, "score": 0, "creation_date": 1455058726, "post_id": 35156425, "comment_id": 58318084, "body": "I have the same issue on debian 8. ghc version 7.6.3"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457039089, "creation_date": 1457039089, "answer_id": 35782996, "question_id": 35156425, "link": "https://stackoverflow.com/questions/35156425/trying-to-install-diagrams-on-os-x/35782996#35782996", "title": "Trying to install diagrams on OS X", "body": "<p>You ran into a bug in that version of linear, relating to certain versions of the <code>transformers</code> library.</p>\n\n<p>See the following ticket:</p>\n\n<p><a href=\"https://github.com/ekmett/linear/issues/97\" rel=\"nofollow\">https://github.com/ekmett/linear/issues/97</a></p>\n\n<p>The comment notes: \"Already fixed in 4a2aab7, not yet on Hackage. In the meantime, use transformers > 0.3 or transformers-compat &lt; 0.5\"</p>\n"}], "owner": {"reputation": 151, "user_id": 5872882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc8fcfe6e5954b67ec74d3408e807c45?s=128&d=identicon&r=PG&f=1", "display_name": "Max K", "link": "https://stackoverflow.com/users/5872882/max-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476901531, "creation_date": 1454424124, "last_edit_date": 1476901531, "question_id": 35156425, "link": "https://stackoverflow.com/questions/35156425/trying-to-install-diagrams-on-os-x", "title": "Trying to install diagrams on OS X", "body": "<p>I'm trying to install diagrams on OS X. While downloading it, I get this kind of error message: </p>\n\n<pre><code>Building linear-1.20.4...\nFailed to install linear-1.20.4\nBuild log ( /Users/Max/.cabal-sandbox/logs/linear-1.20.4.log ):\n</code></pre>\n\n<p>then some time later after some successful linked package:</p>\n\n<pre><code>[ 5 of 22] Compiling Linear.V0        ( src/Linear/V0.hs, dist/dist-sandbox-9f82d52a/build/Linear/V0.o )\n\nsrc/Linear/V0.hs:318:25:\n    \u2018eq1\u2019 is not a (visible) method of class \u2018Eq1\u2019\n\nsrc/Linear/V0.hs:319:25:\n    \u2018compare1\u2019 is not a (visible) method of class \u2018Ord1\u2019\n\nsrc/Linear/V0.hs:320:25:\n    \u2018showsPrec1\u2019 is not a (visible) method of class \u2018Show1\u2019\n\nsrc/Linear/V0.hs:321:25:\n    \u2018readsPrec1\u2019 is not a (visible) method of class \u2018Read1\u2019\n\ncabal: Error: some packages failed to install:\nactive-0.2.0.8 depends on linear-1.20.4 which failed to install.\ndiagrams-1.3 depends on linear-1.20.4 which failed to install.\ndiagrams-contrib-1.3.0.8 depends on linear-1.20.4 which failed to install.\ndiagrams-core-1.3.0.5 depends on linear-1.20.4 which failed to install.\ndiagrams-lib-1.3.0.9 depends on linear-1.20.4 which failed to install.\ndiagrams-svg-1.3.1.10 depends on linear-1.20.4 which failed to install.\nforce-layout-0.4.0.3 depends on linear-1.20.4 which failed to install.\nlinear-1.20.4 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>Does anyone know how to solve it?</p>\n\n<p>My gtk and cabal are all up-to-date. </p>\n\n<p>Thank you :)</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 30577, "user_id": 476496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197b0087c5bee323d2690c977878f8?s=128&d=identicon&r=PG", "display_name": "Vincent Savard", "link": "https://stackoverflow.com/users/476496/vincent-savard"}, "edited": false, "score": 0, "creation_date": 1454423528, "post_id": 35156108, "comment_id": 58030631, "body": "<code>(Bool, t, [Char], t1, [Bool])</code> can&#39;t make sense to you if you do not understand the first part. If it actually makes sense to you, what are <code>t</code> and <code>t2</code>?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1454423828, "post_id": 35156108, "comment_id": 58030844, "body": "Possible duplicate: <a href=\"http://stackoverflow.com/questions/9142731/what-does-the-symbol-mean-in-haskell\" title=\"what does the symbol mean in haskell\">stackoverflow.com/questions/9142731/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 0, "creation_date": 1454426565, "post_id": 35156511, "comment_id": 58032917, "body": "So does that mean that the 5 that I&#39;ve been producing on the last part of my question actually has a different type for the given examples?"}], "tags": [], "owner": {"reputation": 136287, "user_id": 65696, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d8da959b2a586b4a147604e6f534a9fe?s=128&d=identicon&r=PG", "display_name": "SingleNegationElimination", "link": "https://stackoverflow.com/users/65696/singlenegationelimination"}, "is_accepted": false, "score": 0, "last_activity_date": 1454424345, "creation_date": 1454424345, "answer_id": 35156511, "question_id": 35156108, "link": "https://stackoverflow.com/questions/35156108/haskell-types-in-some-examples/35156511#35156511", "title": "Haskell Types in some examples", "body": "<p>Numbers in Haskell are polymorphic, there are separate types for Fixed and arbitrary precision Integers, Rationals, Floating Point numbers, and user defined number types.  All can be instantiated with simple literals, by implementing the <code>fromInteger</code> method on the <code>Num</code> typeclass.  The value you've given, <code>(True, 1, \"hello world\", 3)</code> has two integral literals, and they can be used to create two numbers, of possibly different types.  the bit of type before the fat arrow, <code>(Num t, Num t1)</code>, is saying that in the inferred type, <code>t</code> and <code>t1</code> can be anything, so long as they happen to have the <code>Num</code> typeclass defined on them, ie they can be obtained with a <code>fromInteger</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 0, "creation_date": 1454430572, "post_id": 35158440, "comment_id": 58035751, "body": "I assume that this is because of the static typing, since it wouldn&#39;t be possible to do arithmetics with floats and integers making it a hassle. Can anybody second that or am I imagining things?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 2, "creation_date": 1454432800, "post_id": 35158440, "comment_id": 58037377, "body": "@Nimi Roughly, yes. Numeric <i>literals</i> are polymorphic, so their type adapts to what&#39;s needed in the context. However, once the type is fixed, there are no implicit type conversions, e.g <code>Int</code>s are not promoted to <code>Double</code>s as in some other languages. So, the thumb rule is: no implicit conversions, but literals fit any numeric type."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1454430061, "last_edit_date": 1454430061, "creation_date": 1454429726, "answer_id": 35158440, "question_id": 35156108, "link": "https://stackoverflow.com/questions/35156108/haskell-types-in-some-examples/35158440#35158440", "title": "Haskell Types in some examples", "body": "<p>It appears that GHCi is performing some magic here. It is correctly defaulting the numbers to <code>Integer</code>s so that they can be printed. However it is binding <code>it</code> to the polymorphic type before the defaulting appears.</p>\n\n<p>I guess you want to see the type after the defaulting takes place. For that, I would recommend to use the <code>Data.Typeable</code> library as follows:</p>\n\n<pre><code>&gt; import Data.Typeable\n&gt; let withType x = (x, typeOf x)\n&gt; withType 5\n(5,Integer)\n</code></pre>\n\n<p>Above, GHCi has to default <code>5</code> to <code>Integer</code>, but this causes <code>typeOf x</code> to report the representation of the type after the defaulting happened. Hence we get the wanted type.</p>\n\n<p>The following also works, precisely because <code>typeOf</code> is called after the defaulting happened:</p>\n\n<pre><code>&gt; :type 5\n5 :: Num a =&gt; a\n&gt; typeOf 5\nInteger\n</code></pre>\n\n<p>Keep however in mind that <code>typeOf</code> only works for monomorphic types. In general, the polymorphic result of <code>:type</code> is more useful.</p>\n"}, {"tags": [], "owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "is_accepted": true, "score": 2, "last_activity_date": 1454471224, "last_edit_date": 1454471224, "creation_date": 1454462246, "answer_id": 35166827, "question_id": 35156108, "link": "https://stackoverflow.com/questions/35156108/haskell-types-in-some-examples/35166827#35166827", "title": "Haskell Types in some examples", "body": "<p>There are a number of things going on here.</p>\n\n<ol>\n<li><p>Numeric literals in Haskell are polymorphic; the type of the literal <code>5</code> really is <code>Num a =&gt; a</code>.  It can belong to any type that adheres to the <code>Num</code> type class.</p></li>\n<li><p>Addition is part of the <code>Num</code> type class, so an addition of two numeric literals is still <code>Num a =&gt; a</code>.</p></li>\n<li><p>Interactive evaluation in ghci is very similar to evaluating actions in the IO monad. When you enter a bare expression, ghci acts as if you ran something like the following:</p>\n\n<pre><code>main = do\n  let it = 5 + 5\n  print it\n</code></pre>\n\n<p>It's not <em>exactly</em> like that, though, because in a program like that, inference would work over the entire <code>do</code> expression body to find a specific type. When you enter a single line, it has to infer a type and compile something with only the context available as of the end of the line you entered. So the <code>print</code> doesn't affect the type inferred for the let-binding, as it's not something <em>you</em> entered.</p></li>\n<li><p>There's nothing in that program that would constrain <code>it</code> to a particular instance of <code>Num</code> or <code>Show</code>; this means that <code>it</code> is still a polymorphic value. Specifically, GHC compiles values with type class constraints to functions that accept a type class dictionary that provides the instance implementations required to meet the constraint. So, although <code>it</code> looks like a monomorphic value, it is actually <em>represented</em> by GHC as a function. This was surprising to enough people that the dreaded \"Monomorphism Restriction\" was invented to prevent this kind of surprise. It disallows pattern bindings (such as this one) where an identifier is bound to a polymorphic type.</p>\n\n<p>The Monomorphism Restriction is off by default in GHC now, and it has been off by default in GHCi since version 7.8.</p>\n\n<p>See <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/interactive-evaluation.html#idp46760125930848\" rel=\"nofollow\">the GHC manual</a> for more info.</p></li>\n<li><p>Haskell provides a special bit of magic for polymorphic numbers; each module can make a <em>default declaration</em> that provides type defaulting rules for polymorphic numbers. At your ghci prompt, the defaulting rules made ghci choose 'Int' when it was forced to provide instance dictionaries to <code>show it</code> in order to get to an IO action value.</p>\n\n<p>Here's the relevant section in the <a href=\"https://www.haskell.org/onlinereport/decls.html#sect4.3.4\" rel=\"nofollow\">Haskell 98 Report</a>.</p></li>\n</ol>\n\n<p>To sum it up: <code>it</code> was bound to the expression <code>5 + 5</code>, which has type <code>Num a =&gt; a</code> because that's the more general inferred type based on the polymorphic numeric literals.</p>\n\n<p>Polymorphic values are represented as functions waiting for a typeclass dictionary. So evaluating <code>it</code> at a particular instance doesn't force it to become monomorphic.</p>\n\n<p>However, Haskell's type default rules allow it to pick a particular type when you implicitly <code>print it</code> as part of the ghci interaction. It picks <code>Int</code> and so it chooses the <code>Int</code> type class instance dictionaries for <code>Show</code> and <code>Num</code> when forced to by <code>print it</code>.</p>\n\n<p>I hope that makes it somewhat less confusing!</p>\n\n<p>By the way, here is an example of how you can get the same behavior outside of ghci by explicitly requesting the polymorphic let-binding. Without the type signature in this context, it will infer a monomorphic type for <code>foo</code> and give a type error.</p>\n\n<pre><code>main = do\n  let foo :: Num a =&gt; a\n      foo = 5 + 5\n  let bar = 8 :: Double\n  let baz = 9 :: Int\n\n  print (foo + bar)\n  print (foo + baz)\n</code></pre>\n\n<p>This will compile and run, printing the following:</p>\n\n<pre><code>18.0\n19\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Looking at the Real World Haskell example and the comment thread, some people included different ghci logs along with their ghc versions. Using that information, I looked at ghc release notes and found that starting in version 7.8, the Monomorphism Restriction was disabled in ghci by default.</p>\n\n<p>If you run the following command, you'll re-enable the Monomorphism Restriction and in order to be friendly, ghci will default the binding to Integer rather than giving you either an error or a polymorphic binding:</p>\n\n<pre><code>Prelude&gt; :set -XMonomorphismRestriction\nPrelude&gt; 5 + 5\n10\nPrelude&gt; :t it\nit :: Integer\nPrelude&gt; \n</code></pre>\n"}], "owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 35166827, "answer_count": 3, "score": 1, "last_activity_date": 1454471224, "creation_date": 1454423304, "last_edit_date": 1454428793, "question_id": 35156108, "link": "https://stackoverflow.com/questions/35156108/haskell-types-in-some-examples", "title": "Haskell Types in some examples", "body": "<p>I'm in the process of learning Haskell and I'm a beginner.\nI wish I could search this question on StackOverflow.\nBut honestly I'm not quite sure what to search for.</p>\n\n<p>I already tried to get the answers without much success so\nplease bear with me. It seems this is still really low level\nstuff.</p>\n\n<p>So my ghci interactive session never seems to output\n\"primitive types\" like Int for example. I don't know how\nelse to put it. At the moment I'm trying to follow the\ntutorial on <a href=\"http://book.realworldhaskell.org/read/getting-started.html\" rel=\"nofollow\">http://book.realworldhaskell.org/read/getting-started.html</a>.\nUnfortunately, I can't seem to produce the same results.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; 5\n5\nPrelude&gt; :type it\nit :: Num a =&gt; a\n</code></pre>\n\n<p>I have to specifically say:</p>\n\n<pre><code>Prelude&gt; let e = 5 :: Int\nPrelude&gt; e\n5\nPrelude&gt; :type it\nit :: Int\n</code></pre>\n\n<p>This is all very confusing to me so I hope somebody\ncan clear up this confusion a little bit.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>On <a href=\"http://book.realworldhaskell.org/read/getting-started.html\" rel=\"nofollow\">http://book.realworldhaskell.org/read/getting-started.html</a> it says: \"Haskell has several numeric types. For example, a literal number such as 1 could, depending on the context in which it appears, be an integer or a floating point value. When we force ghci to evaluate the expression 3 + 2, it has to choose a type so that it can print the value, and it defaults to Integer.\" I can't seem to force ghci to evaluate the type.</p>\n\n<p>So for example:</p>\n\n<pre><code>Prelude&gt; 3 + 2\n5\nPrelude&gt; :t it\nit :: Num a =&gt; a\n</code></pre>\n\n<p>Where I expected \"Integer\" to be the correct type.</p>\n"}, {"tags": ["haskell", "monads", "applicative"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1454421611, "post_id": 35155370, "comment_id": 58029195, "body": "right now the <code>...</code> part will be the worst concern - so you should start by trying to figure out the type-signature (IMO this will not primary be a monad or applicative problem - it&#39;s more like a type-function problem right now) - so the first question: is this supposed to work for <code>a -&gt; b</code> and <code>a -&gt; b -&gt; c</code>, ... or for some fixed arity?"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1454426324, "post_id": 35155370, "comment_id": 58032746, "body": "I think it&#39;s worth elaborating on the situation you&#39;re in where you feel like you need this. It reminds me a bit of the <code>Reader</code> monad, but it&#39;s subtly different, I suppose."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1454426456, "post_id": 35155370, "comment_id": 58032845, "body": "Also, it is always easier to write a series of functions <code>wrapC wrapC2 wrapC3</code>... &#224; la <code>liftA</code> and <code>liftM</code>. You can throw yourself into a type-function mess, but consider if it&#39;s really worth it. You probably don&#39;t need to wrap anything bigger than a six-argument function."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 3, "creation_date": 1454426781, "post_id": 35155370, "comment_id": 58033064, "body": "Your <code>wrap</code> currently says &quot;give me a function and n tuples and I&#39;ll apply this function to second projections of these tuples&quot;. It&#39;s simply <code>f &lt;$&gt; t1 &lt;*&gt; t2 &lt;*&gt; t3 &lt;*&gt; ...</code>. Do you actually want the opposite \u2014 &quot;give me a function that receives n tuples and give me n arguments and I&#39;ll attach a context to each argument and apply the function&quot;?"}, {"owner": {"reputation": 125, "user_id": 2421116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f32a1587c6c2ee687f83d6ff29ed370f?s=128&d=identicon&r=PG", "display_name": "Iedu", "link": "https://stackoverflow.com/users/2421116/iedu"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1454442137, "post_id": 35155370, "comment_id": 58043102, "body": "@user3237465: the second situation is exactly what I was expecting. Indeed, I got the idea from studying how applicative functors work and checking the instance implementation for <code>((-&gt;)r)</code>. I imagine an operator that works on every <code>r</code> in a composition <code>r -&gt; r -&gt; ...</code>, similar to how <code>(&lt;*&gt;)</code> behaves."}, {"owner": {"reputation": 125, "user_id": 2421116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f32a1587c6c2ee687f83d6ff29ed370f?s=128&d=identicon&r=PG", "display_name": "Iedu", "link": "https://stackoverflow.com/users/2421116/iedu"}, "reply_to_user": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1454442442, "post_id": 35155370, "comment_id": 58043293, "body": "@Lynn : I will try to elaborate the question then, and will also check how <code>Reader</code> works."}], "owner": {"reputation": 125, "user_id": 2421116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f32a1587c6c2ee687f83d6ff29ed370f?s=128&d=identicon&r=PG", "display_name": "Iedu", "link": "https://stackoverflow.com/users/2421116/iedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454446671, "creation_date": 1454421253, "last_edit_date": 1454446671, "question_id": 35155370, "link": "https://stackoverflow.com/questions/35155370/wrapping-a-functions-arguments", "title": "Wrapping a function&#39;s arguments", "body": "<p>I am trying to figure out the mechanism to transform a generic function with <em>n</em> arguments into a function where each of the <em>n</em> argument is wrapped inside a context.</p>\n\n<p>A simple example in pseudo-Haskell, where the wrapped type is tuple:</p>\n\n<pre><code>wrap :: (a1 -&gt; a2 -&gt; a3 -&gt; ...) -&gt; Context c -&gt; ((c, a1) -&gt; (c, a2) -&gt; (c, a3) -&gt; ...)\n</code></pre>\n\n<p>The container which holds the contexts is suggested by the alias <code>Context c</code>, for which I'm yet to figure out a reasonable form. For example it could be an n-tuple, a list of <code>c</code>s or even a composition of type <code>(c -&gt; c -&gt; c -&gt; ...)</code>.</p>\n\n<p>It would most likely have to do with some ingenious use of applicative functors or monads, but I currently have no idea where to start attacking the problem. Any lead would be deeply appreciated. </p>\n\n<p><strong>Edit. Resolution</strong></p>\n\n<p>As the comments below suggest, the behaviour can be described as \"give me some generic function with <em>n</em> arguments and [some contexts] and attach a context to each argument of the function\". This resulting function will be applied applicative-style to <em>n</em> structures <code>S a</code> using some operators which are implemented to make use of these contexts, something like:</p>\n\n<pre><code>(wrap f contexts) \u00a7&gt; s1 &lt;\u00a7&gt; s2 &lt;\u00a7&gt; s3 &lt;\u00a7&gt; ....\n</code></pre>\n\n<p>As an example, I got something running with <a href=\"https://hackage.haskell.org/package/parameterized-data-0.1.5\" rel=\"nofollow\">fixed-size vectors</a> arguments like <code>FSVec c a</code>. So I was wondering whether there is a method to pass a generic function of type <code>fi :: [a1] -&gt; [a2] -&gt; ...</code> and some lengths and \"zip\" them to get <code>fo :: FSVec c a1 -&gt; FSVec c a2 -&gt; ...</code>. And even more, can it be done in a generic way, i.e. apply any arbitrary constructor, not necessarily one which uses type-level (e.g. a tuple constructor as in the example above)?</p>\n\n<p><strong>Alternate solution</strong></p>\n\n<p>Of course, I can always \"zip\" the contexts on the structures themselves, having to only reimplement <code>(\u00a7&gt;)</code> and <code>(&lt;\u00a7&gt;)</code> to act accordingly and saving me a lot of trouble: </p>\n\n<pre><code>f \u00a7&gt; (c1, s1) &lt;\u00a7&gt; (c2, s2) &lt;\u00a7&gt; (c3, s3) &lt;\u00a7&gt; ...\n</code></pre>\n\n<p>Still, I would like to \"hide\" these contexts as to separate concerns. Apart from just being a matter of style, it is actually a good mental exercise to explore the power of applicative functors and applicative-like functions. </p>\n"}, {"tags": ["haskell", "gtk", "gtk2", "gtk2hs"], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 717881, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aac21dfd75e7d66cc8476bdbca6d2153?s=128&d=identicon&r=PG", "display_name": "ghorn", "link": "https://stackoverflow.com/users/717881/ghorn"}, "edited": false, "score": 0, "creation_date": 1454875652, "post_id": 35170769, "comment_id": 58229286, "body": "I&#39;m not going to accept this answer, even this it works around my problem, because I never really got to the bottom of the issue."}], "tags": [], "owner": {"reputation": 604, "user_id": 717881, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aac21dfd75e7d66cc8476bdbca6d2153?s=128&d=identicon&r=PG", "display_name": "ghorn", "link": "https://stackoverflow.com/users/717881/ghorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1454483961, "creation_date": 1454483961, "answer_id": 35170769, "question_id": 35147473, "link": "https://stackoverflow.com/questions/35147473/cant-get-gtk2-cellrenderercombo-to-display-anything/35170769#35170769", "title": "can&#39;t get gtk2 CellRendererCombo to display anything", "body": "<p>I figured it out for GTK3. (See my edit above for the GTK2 solution.) For GTK3 you have to use the <code>editingStarted</code> signal to edit the combo box's liststore manually. Unfortunately this causes a segfault for GTK2.</p>\n\n<p>Here is the complete working code for GTK3</p>\n\n<pre><code>{-# OPTIONS_GHC -Wall #-}\n{-# LANGUAGE PackageImports #-}\n\nmodule Main ( main ) where\n\nimport qualified Data.Text as T\nimport \"gtk3\" Graphics.UI.Gtk ( AttrOp( (:=) ) )\nimport qualified \"gtk3\" Graphics.UI.Gtk as Gtk\nimport System.Glib.Signals ( on )\n\n-- the element in the list store\ndata ListElement =\n  ListElement\n  { leName :: String\n  , leListStore :: Gtk.ListStore String\n  , leOptions :: [String]\n  }\n\nmakeMyTreeview :: IO Gtk.TreeView\nmakeMyTreeview = do\n  -- the storage for each combo box cell renderer\n  comboListStore0 &lt;- Gtk.listStoreNew []\n  comboListStore1 &lt;- Gtk.listStoreNew []\n  Gtk.treeModelSetColumn comboListStore0 (Gtk.makeColumnIdString 0) id\n  Gtk.treeModelSetColumn comboListStore1 (Gtk.makeColumnIdString 0) id\n  let elements =\n        [ ListElement \"joe\" comboListStore0 [\"hi\", \"there\"]\n        , ListElement \"bob\" comboListStore1 [\"A\", \"B\", \"C\"]\n        ]\n\n  listStore &lt;- Gtk.listStoreNew elements :: IO (Gtk.ListStore ListElement)\n  treeview &lt;- Gtk.treeViewNewWithModel listStore :: IO Gtk.TreeView\n\n  Gtk.treeViewSetHeadersVisible treeview True\n\n  -- add some columns\n  nameCol &lt;- Gtk.treeViewColumnNew\n  comboCol &lt;- Gtk.treeViewColumnNew\n\n  Gtk.treeViewColumnSetTitle nameCol \"name\"\n  Gtk.treeViewColumnSetTitle comboCol \"combo\"\n\n  -- add cell renderers\n  nameRenderer &lt;- Gtk.cellRendererTextNew\n  comboRenderer &lt;- Gtk.cellRendererComboNew\n\n  Gtk.cellLayoutPackStart nameCol nameRenderer True\n  Gtk.cellLayoutPackStart comboCol comboRenderer True\n\n  _ &lt;- Gtk.treeViewAppendColumn treeview nameCol\n  _ &lt;- Gtk.treeViewAppendColumn treeview comboCol\n\n  -- this sets the name column\n  Gtk.cellLayoutSetAttributes nameCol nameRenderer listStore $\n    \\x -&gt; [Gtk.cellText := leName x ++ \"!\"]\n\n  Gtk.cellLayoutSetAttributes comboCol comboRenderer listStore $ \\x -&gt;\n    [ Gtk.cellTextEditable := True\n    , Gtk.cellComboTextModel := (leListStore x, Gtk.makeColumnIdString 0 :: Gtk.ColumnId String String)\n    , Gtk.cellComboHasEntry := False\n    ]\n\n  -- here is where we will set the combo options!!!!\n  _ &lt;- on comboRenderer Gtk.editingStarted $ \\widget treepath -&gt; do\n    case treepath of\n      [k] -&gt; do\n        listElement &lt;- Gtk.listStoreGetValue listStore k\n        comboListStore &lt;- Gtk.comboBoxSetModelText (Gtk.castToComboBox widget)\n        mapM_ (Gtk.listStoreAppend comboListStore . T.pack) (leOptions listElement)\n      ks -&gt; error $ \"bad treepath for liststore: \" ++ show ks\n\n  -- an action when the combo box is edited\n  _ &lt;- on comboRenderer Gtk.edited $ \\_treePath newVal -&gt; do\n    putStrLn $ \"combo box edited, new value: \" ++ newVal\n\n  return treeview\n\n\nmain :: IO ()\nmain = do\n  _ &lt;- Gtk.initGUI\n  win &lt;- Gtk.windowNew\n  _ &lt;- Gtk.set win [ Gtk.containerBorderWidth := 8\n                   , Gtk.windowTitle := \"help\"\n                   ]\n  treeview &lt;- makeMyTreeview\n  _ &lt;- Gtk.set win [ Gtk.containerChild := treeview ]\n  Gtk.widgetShowAll win\n  Gtk.mainGUI\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 717881, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aac21dfd75e7d66cc8476bdbca6d2153?s=128&d=identicon&r=PG", "display_name": "ghorn", "link": "https://stackoverflow.com/users/717881/ghorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1454486344, "creation_date": 1454398203, "last_edit_date": 1454486344, "question_id": 35147473, "link": "https://stackoverflow.com/questions/35147473/cant-get-gtk2-cellrenderercombo-to-display-anything", "title": "can&#39;t get gtk2 CellRendererCombo to display anything", "body": "<p>I am unable to get gtk's cell renderer combo box to display any options. I need to use a different model for each row in my tree, which should be possible with <a href=\"http://hackage.haskell.org/package/gtk-0.14.2/docs/Graphics-UI-Gtk-ModelView-CellRendererCombo.html#v:cellComboTextModel\" rel=\"nofollow\"><code>cellComboTextModel</code></a>. My result is the combo box renderer is completely empty.</p>\n\n<p>Here is a simplified example:</p>\n\n<pre><code>{-# OPTIONS_GHC -Wall #-}\n\nmodule Main ( main ) where\n\nimport Graphics.UI.Gtk ( AttrOp( (:=) ) )\nimport qualified Graphics.UI.Gtk as Gtk\nimport System.Glib.Signals ( on )\n\n-- the element in the list store\ndata ListElement =\n  ListElement\n  { leName :: String\n  , leListStore :: Gtk.ListStore String\n  }\n\nmakeMyTreeview :: IO Gtk.TreeView\nmakeMyTreeview = do\n  -- make a list store with two elements\n\n  -- the storage for each combo box cell renderer\n  comboListStore0 &lt;- Gtk.listStoreNew [\"hi\", \"there\"]\n  comboListStore1 &lt;- Gtk.listStoreNew [\"A\", \"B\", \"C\"]\n  let elements =\n        [ ListElement \"joe\" comboListStore0\n        , ListElement \"bob\" comboListStore1\n        ]\n\n  listStore &lt;- Gtk.listStoreNew elements :: IO (Gtk.ListStore ListElement)\n  treeview &lt;- Gtk.treeViewNewWithModel listStore :: IO Gtk.TreeView\n\n  Gtk.treeViewSetHeadersVisible treeview True\n\n  -- add some columns\n  nameCol &lt;- Gtk.treeViewColumnNew\n  comboCol &lt;- Gtk.treeViewColumnNew\n\n  Gtk.treeViewColumnSetTitle nameCol \"name\"\n  Gtk.treeViewColumnSetTitle comboCol \"combo\"\n\n  -- add cell renderers\n  nameRenderer &lt;- Gtk.cellRendererTextNew\n  comboRenderer &lt;- Gtk.cellRendererComboNew\n\n  Gtk.cellLayoutPackStart nameCol nameRenderer True\n  Gtk.cellLayoutPackStart comboCol comboRenderer True\n\n  _ &lt;- Gtk.treeViewAppendColumn treeview nameCol\n  _ &lt;- Gtk.treeViewAppendColumn treeview comboCol\n\n  -- this sets the name column strings\n  Gtk.cellLayoutSetAttributes nameCol nameRenderer listStore $\n    \\x -&gt; [Gtk.cellText := leName x ++ \"!\"]\n\n  -- combo box\n  Gtk.cellLayoutSetAttributes comboCol comboRenderer listStore $ \\x -&gt;\n    [ Gtk.cellComboTextModel := ( leListStore x, Gtk.makeColumnIdString 0 :: Gtk.ColumnId String String\n                                )\n    , Gtk.cellMode := Gtk.CellRendererModeActivatable\n    , Gtk.cellComboHasEntry := True\n    ]\n\n  -- an action when the combo box is edited\n  _ &lt;- on comboRenderer Gtk.edited $ \\_treePath newVal -&gt; do\n    putStrLn \"combo box is being edited (this never happens)\"\n    putStrLn $ \"new value: \" ++ newVal\n\n  return treeview\n\n\nmain :: IO ()\nmain = do\n  _ &lt;- Gtk.initGUI\n  win &lt;- Gtk.windowNew\n  _ &lt;- Gtk.set win [ Gtk.containerBorderWidth := 8\n                   , Gtk.windowTitle := \"help\"\n                   ]\n  treeview &lt;- makeMyTreeview\n  _ &lt;- Gtk.set win [ Gtk.containerChild := treeview ]\n  Gtk.widgetShowAll win\n  Gtk.mainGUI\n</code></pre>\n\n<p>Any insight would be greatly appreciated.</p>\n\n<p>EDIT:\nI figured out what I was missing:</p>\n\n<pre><code>Gtk.treeModelSetColumn comboListStore0 (Gtk.makeColumnIdString 0) id\nGtk.treeModelSetColumn comboListStore1 (Gtk.makeColumnIdString 0) id\n</code></pre>\n\n<p>This sets the ListStore column ID so that the later line</p>\n\n<pre><code>Gtk.cellComboTextModel := (leListStore x, Gtk.makeColumnIdString 0 :: Gtk.ColumnId String String)\n</code></pre>\n\n<p>is referencing the text correctly. This does not seem to work in GTK3 however</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454391513, "post_id": 35145725, "comment_id": 58011157, "body": "I just checked with your exact setup (well one difference: using it on Windows right now) and it works fine - I would interpret this as having problems with <code>rts&#47;dist&#47;package.conf.install</code> - can you check what&#39;s in there at line 420 and maybe edit your question to include the lines around this too?"}, {"owner": {"reputation": 275, "user_id": 316337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/855357dfc3309c7567d48a540e411a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/316337/alex"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454392848, "post_id": 35145725, "comment_id": 58011642, "body": "Where would I find it? It&#39;s not in <code>~&#47;.stack</code>, nor is it in the project directory."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454393253, "post_id": 35145725, "comment_id": 58011775, "body": "it should be part of your base GHC installation"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454393658, "post_id": 35145725, "comment_id": 58011911, "body": "not 100% sure but you could try to remove the <code>ghc-options</code> from your <code>.cabal</code> (where the <code>-rtsopts</code> etc. are) and retry - maybe it&#39;ll stop trying to parse this file then (just to check)"}, {"owner": {"reputation": 275, "user_id": 316337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/855357dfc3309c7567d48a540e411a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/316337/alex"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454397125, "post_id": 35145725, "comment_id": 58013349, "body": "Gave it a go, but it didn&#39;t help. I can&#39;t find any package.conf.install in my local ghc installation (did find in /usr to be sure). Half the reason I want to use stack is because it&#39;s self-contained anyway. Shouldn&#39;t it not be getting anything from my local machine?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454398850, "post_id": 35145725, "comment_id": 58014197, "body": "well depends - for example it will use an local GHC (in your path) which is a good idea IMO"}, {"owner": {"reputation": 275, "user_id": 316337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/855357dfc3309c7567d48a540e411a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/316337/alex"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454462704, "post_id": 35145725, "comment_id": 58052047, "body": "I&#39;ve removed ghc from the system, reinstalled stack, delete ~/.stack ~/.ghc ~/.cabal and still the same error."}], "answers": [{"tags": [], "owner": {"reputation": 275, "user_id": 316337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/855357dfc3309c7567d48a540e411a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/316337/alex"}, "is_accepted": false, "score": 2, "last_activity_date": 1454469391, "creation_date": 1454469391, "answer_id": 35167876, "question_id": 35145725, "link": "https://stackoverflow.com/questions/35145725/stack-setup-fails-with-package-installation-errors/35167876#35167876", "title": "Stack setup fails with package installation errors", "body": "<p>I figured it out. The GHC build uses <code>grep</code> to make <code>packages.conf.install</code>. I have <code>GREP_OPTIONS=--color=auto -n</code> set in my zsh config. The <code>-n</code> was putting line numbers in front of everything, which was causing the errors.</p>\n\n<p>The reason I couldn't find <code>packages.conf.install</code> anywhere before is because it is made on the fly during GHC <code>make</code>. And stack does that in /tmp.</p>\n"}], "owner": {"reputation": 275, "user_id": 316337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/855357dfc3309c7567d48a540e411a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/316337/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454469391, "creation_date": 1454390923, "question_id": 35145725, "link": "https://stackoverflow.com/questions/35145725/stack-setup-fails-with-package-installation-errors", "title": "Stack setup fails with package installation errors", "body": "<p>I'm trying to get stack running for the first time, but running <code>stack setup</code> in an example project (from <code>stack new helloworld new-template</code>) fails with the following output (I skipped the beginning, which I think was normal):</p>\n\n<pre><code>Installing library in\n/home/ajl/.stack/programs/x86_64-linux/ghc-7.10.2/lib/ghc7.10.2/ghc_JzwEp1oQ8kA7NFNTGk1ho5 \"/home/ajl/.stack/programs/x86_64-linux/ghc-7.10.2/lib/ghc-7.10.2/bin/ghc-pkg\" --force --global-package-db \"/home/ajl/.stack/programs/x86_64-linux/ghc-7.10.2/lib/ghc-7.10.2/package.conf.d\" update rts/dist/package.conf.install\nReading package info from \"rts/dist/package.conf.install\" ... done.\n\n: Warning: Unrecognized field 420 on line 420\n(Skipped unrecognized field for every line 419 down to 1)\n: Warning: Unrecognized field 1 on line 1\n: missing id field\n: invalid package identifier:\n: invalid package key:\nmake[1]: *** [install_packages] Error 1\nmake: *** [install] Error 2\n\nInstalling GHC ...% \n</code></pre>\n\n<p>I'm on Ubuntu 14.04, running stack 1.0.2. Not sure if it's relevant but I have ghc 7.10.1 with Cabal 1.23.0.0 installed on the system already, which work fine.</p>\n\n<p>I have tried changing the resolver to older LTS versions with older ghc versions. I also tried deleting <code>~/.stack</code>. Not sure what else to try given the unhelpfulness of the errors.</p>\n"}, {"tags": ["haskell", "formatting"], "answers": [{"tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 1, "last_activity_date": 1454429124, "last_edit_date": 1454429124, "creation_date": 1454428609, "answer_id": 35158022, "question_id": 35145200, "link": "https://stackoverflow.com/questions/35145200/text-tabular-table-type-errors-what-is-the-type-system-asking-from-me/35158022#35158022", "title": "Text.Tabular.Table type errors - what is the type system asking from me?", "body": "<p>It took me a while to find this one, because there is no problem in the definition of your function: it's the type declaration that is wrong.</p>\n\n<p>Let's take a look at the definition of <code>Table</code>:</p>\n\n<pre><code>data Table rh ch a = Table (Header rh) (Header ch) [[a]]\n</code></pre>\n\n<p>The column header and row header type paramater are already warped in the <code>Header</code> type, so there no need to do it once more.</p>\n\n<p>Instead of defining:</p>\n\n<pre><code>tabulate :: Text -&gt; [[Int]] -&gt; T.Table (T.Header Int) (T.Header Text) Int\n</code></pre>\n\n<p>you can defined:</p>\n\n<pre><code>tabulate :: Text -&gt; [[Int]] -&gt; T.Table Int Text Int\n</code></pre>\n\n<hr>\n\n<p>To debug that kind of things, I usually extract part of the expression to a where clause, along with a type annotation that tells the compiler what each the expression should be. This often gets me better error messages. For example, here, I extracted:</p>\n\n<pre><code>where tagada :: [T.Header Int]\n      tagada = map T.Header leftcoll\n</code></pre>\n\n<p>In the error, I could read:</p>\n\n<pre><code>Expected type: [T.Header (T.Header Int)]\n  Actual type: [T.Header Int]\n</code></pre>\n\n<p>That's when I realized that the <code>Header</code> type was maybe used twice.</p>\n"}], "owner": {"reputation": 2704, "user_id": 2629787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/HApc9.jpg?s=128&g=1", "display_name": "Koz Ross", "link": "https://stackoverflow.com/users/2629787/koz-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 35158022, "answer_count": 1, "score": 0, "last_activity_date": 1454429124, "creation_date": 1454388148, "question_id": 35145200, "link": "https://stackoverflow.com/questions/35145200/text-tabular-table-type-errors-what-is-the-type-system-asking-from-me", "title": "Text.Tabular.Table type errors - what is the type system asking from me?", "body": "<p>I have the following code, using <a href=\"https://hackage.haskell.org/package/tabular\" rel=\"nofollow\">this tabulation library</a>:</p>\n\n<pre><code>{-# LANGUAGE NoImplicitPrelude, OverloadedStrings #-}\n\nimport ClassyPrelude\nimport qualified Text.Tabular as T\n\ndata Category = Age | Gender | Usual | Years\n  deriving (Show, Read, Eq, Enum, Bounded)\n\n tabulate :: Text -&gt; [[Int]] -&gt; T.Table (T.Header Int) (T.Header Text) Int\n tabulate lbl tab = T.Table (T.Group T.NoLine (map T.Header leftcoll)) (T.Group T.DoubleLine [T.Header lbl, T.Header \"All\", T.Header \"Cluster0\", T.Header \"Cluster1\"]) rest\n   where leftcoll = map (`indexEx` 0) tab\n         rest = map (drop 1) tab\n</code></pre>\n\n<p>When I try to compile it, I get the following errors:</p>\n\n<pre><code>Couldn't match type \u2018Int\u2019 with \u2018T.Header Int\u2019\nExpected type: [T.Header Int]\n  Actual type: [Int]\nIn the second argument of \u2018map\u2019, namely \u2018leftcoll\u2019\nIn the second argument of \u2018T.Group\u2019, namely\n  \u2018(map T.Header leftcoll)\u2019\n\n\nCouldn't match expected type \u2018T.Header Text\u2019\n            with actual type \u2018Text\u2019\nIn the first argument of \u2018T.Header\u2019, namely \u2018lbl\u2019\nIn the expression: T.Header lbl\n</code></pre>\n\n<p>I have absolutely no clue why this is the case. From <a href=\"https://hackage.haskell.org/package/tabular-0.2.2.7/docs/Text-Tabular.html#t:Table\" rel=\"nofollow\">the Table type documentation and example</a>, it would appear that I simply have to apply the <code>Header</code> constructor to a list of values and then put them inside the <code>Group</code> constructor to get a whole row (or column) of values, but the errors there seem to suggest that the lists (and data) I'm passing as arguments to the <code>Header</code> constructor already need to be <code>Header</code>s. Thus, I'm confused about what the type system is telling me here, and how to get what I want.</p>\n\n<p>Essentially, the table should look something like this:</p>\n\n<pre><code>Foo All Cluster0 Cluster1\n=========================\n1   10  3        7\n2   11  10       1\n....\n</code></pre>\n"}, {"tags": ["haskell", "pipe"], "answers": [{"tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": true, "score": 1, "last_activity_date": 1454424301, "last_edit_date": 1454424301, "creation_date": 1454383885, "answer_id": 35144551, "question_id": 35144277, "link": "https://stackoverflow.com/questions/35144277/using-a-single-haskell-pipe-to-split-http-content-to-two-consumers/35144551#35144551", "title": "Using a single Haskell pipe to split HTTP content to two consumers", "body": "<p>The expression \"splitting the content between consumers\" might be a little misleading; you want to send all bytes to each of two consumers. But <code>Pipes.Prelude.tee</code> turns any consumer into a Pipe, thus</p>\n\n<pre><code>producer &gt;-&gt; tee consumer1 &gt;-&gt; consumer2\n</code></pre>\n\n<p>feeds the producer to both of the consumers. But the particular case of writing to a file might be simplest with <code>Pipes.Prelude.chain</code>, rather than a consumer. <code>tee</code> and <code>chain</code> allow you to do something with each incoming value, before forwarding it along the pipeline. In this case I just write each successive chunk to a handle, before passing it along:</p>\n\n<pre><code>import Pipes\nimport Pipes.HTTP\nimport qualified Pipes.ByteString as PB \nimport qualified Pipes.Prelude as P\nimport qualified System.IO as IO\nimport qualified Data.ByteString as B\n\nmain = do\n    req &lt;- parseUrl \"https://www.example.com\"\n    m &lt;- newManager tlsManagerSettings \n    withHTTP req m $ \\resp -&gt; \n      IO.withFile \"file.txt\" IO.WriteMode $ \\h -&gt; \n        runEffect $ responseBody resp &gt;-&gt; P.chain (B.hPut h) &gt;-&gt; PB.stdout\n</code></pre>\n\n<p>I ended the pipeline with <code>PB.stdout</code> where you would use <code>pipes-csv</code> materials. Using <code>tee</code>, I could as well have written</p>\n\n<pre><code>runEffect $ responseBody resp &gt;-&gt; P.tee (PB.toHandle h) &gt;-&gt; PB.stdout\n</code></pre>\n\n<p>for the last line. Where the 'consumers' can be viewed as folds, there is the apparatus of <code>Control.Foldl</code> for combining many folds together - and any number of other devices.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 2, "accepted_answer_id": 35144551, "answer_count": 1, "score": 1, "last_activity_date": 1582388202, "creation_date": 1454381943, "last_edit_date": 1582388202, "question_id": 35144277, "link": "https://stackoverflow.com/questions/35144277/using-a-single-haskell-pipe-to-split-http-content-to-two-consumers", "title": "Using a single Haskell pipe to split HTTP content to two consumers", "body": "<p>I can't really figure out whether some of <a href=\"https://stackoverflow.com/questions/16205440/haskell-pipes-and-branching\">these</a> <a href=\"https://stackoverflow.com/questions/29932852/how-to-merge-two-consumer-into-one-in-haskell-pipes\">other</a> <a href=\"https://stackoverflow.com/questions/33464543/forking-the-streaming-flow-in-haskell-pipes\">questions</a> are similar enough to mine but I couldn't extract a solution out of them so I'm posting. Feel free to indicate to me otherwise.</p>\n\n<p>I have a flow where I need to download a large CSV file, and 1) save it to disk, and 2) process it. I'd like to use Haskell pipes, with the <a href=\"https://hackage.haskell.org/package/pipes-http\" rel=\"nofollow noreferrer\">pipes-http</a> and <a href=\"https://hackage.haskell.org/package/pipes-csv\" rel=\"nofollow noreferrer\">pipes-csv</a> packages to do this. </p>\n\n<p>The obvious way is to have two separate pipes: 1) web -> disk, and then 2) disk -> process. Is it possible to do another topology where the output from the web splits into two consumers, one that saves and the other that processes? I feel that this could be more elegant and possibly more efficient. </p>\n\n<p>If so, how is the splitting done? Splitting of pipes is not mentioned anywhere in the documentation.</p>\n"}, {"tags": ["haskell", "accumulator"], "comments": [{"owner": {"reputation": 15219, "user_id": 1272950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1MQy.jpg?s=128&g=1", "display_name": "y\u01dds\u029e\u01ddla", "link": "https://stackoverflow.com/users/1272950/y%c7%9ds%ca%9e%c7%9dla"}, "edited": false, "score": 1, "creation_date": 1454373854, "post_id": 35142843, "comment_id": 58006424, "body": "more generally you could use a sliding window"}], "answers": [{"tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": false, "score": 3, "last_activity_date": 1454373371, "creation_date": 1454373371, "answer_id": 35143071, "question_id": 35142843, "link": "https://stackoverflow.com/questions/35142843/haskell-efficient-accumulator/35143071#35143071", "title": "Haskell: Efficient accumulator", "body": "<p>Seems like a job for <code>fold</code>:</p>\n\n<pre><code>func f l = foldl (\\s (x, y) -&gt; f x y s) \"\" (zip l (tail l))\n\n-- just some placeholder function\nf :: Int -&gt; Int -&gt; String -&gt; String\nf x y s = s ++ \" \" ++ show(x) ++ \" \" ++ show(y)\n\nl = [1,2,3,4]\n\nmain = print $ func f l\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code>\" 1 2 2 3 3 4\"\n</code></pre>\n\n<p>(if you can change the signature of <code>f</code>, you can get rid of the ugly lambda that rearranges arguments)</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454432892, "post_id": 35143074, "comment_id": 58037428, "body": "That&#39;s no reason to be scared of <code>foldl&#39;</code>!"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 4, "last_activity_date": 1454373386, "creation_date": 1454373386, "answer_id": 35143074, "question_id": 35142843, "link": "https://stackoverflow.com/questions/35142843/haskell-efficient-accumulator/35143074#35143074", "title": "Haskell: Efficient accumulator", "body": "<p>This is just a fold left over the pairs in the input list:</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; String -&gt; String\nf = undefined\n\naccum :: [Int] -&gt; String\naccum xs = foldl (flip . uncurry $ f) \"\" $ zip xs (drop 1 xs)\n</code></pre>\n\n<p>You probably want to use <code>Data.List.foldl'</code> instead of <code>foldl</code>, but this is an answer that works with just Prelude.</p>\n"}, {"tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": false, "score": 1, "last_activity_date": 1454394813, "creation_date": 1454394813, "answer_id": 35146610, "question_id": 35142843, "link": "https://stackoverflow.com/questions/35142843/haskell-efficient-accumulator/35146610#35146610", "title": "Haskell: Efficient accumulator", "body": "<p>Of course, rather than zipping, you could pass along the previous element inside the fold's accumulator. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>l = [1,2,3,4]\nf x y = (x,y)\ng b@(accum,prev) a = (accum ++ [f prev a],a)\n\nmain = print (foldl g ([],head l) (tail l))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>([(1,2),(2,3),(3,4)],4)\n</code></pre>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 1, "accepted_answer_id": 35143074, "answer_count": 3, "score": 1, "last_activity_date": 1454394813, "creation_date": 1454371934, "question_id": 35142843, "link": "https://stackoverflow.com/questions/35142843/haskell-efficient-accumulator", "title": "Haskell: Efficient accumulator", "body": "<p>What is the best way to map across a list, using the result of each map as you go along, when your result is of a different type to the list.</p>\n\n<p>for example </p>\n\n<pre><code>f :: Int -&gt; Int -&gt; String -&gt; String\n\nl = [1,2,3,4]\n</code></pre>\n\n<p>I would like to have something that walks along the list l and does:</p>\n\n<p><code>f 1 2 [] = result1 =&gt; f 2 3 result1 = result2 =&gt; f 3 4 result3  ==&gt; return result3.</code></p>\n\n<p>I can sort of get this to work with a an accumulator, but it seems rather cumbersome. Is there a standard way to do this... or is this something for Monads??</p>\n\n<p>Thanks!</p>\n\n<p>NB the function above is just for illustration.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 1, "last_activity_date": 1454415524, "last_edit_date": 1454415524, "creation_date": 1454415024, "answer_id": 35153141, "question_id": 35141939, "link": "https://stackoverflow.com/questions/35141939/how-to-exit-a-conduit-when-using-mergesources/35153141#35153141", "title": "How to exit a conduit when using mergeSources", "body": "<p>the <code>Source</code> created by <code>mergeSources</code> keeps a count of unclosed sources. It's only closed when the count reaches 0 i.e. every upstream source is closed. This mechanism and the underlying TBMChannel is hidden from user code so you have no way to change its behavior.</p>\n\n<p>One possible solution is to create the channel and the source manually with some medium-level functions exported by <a href=\"http://hackage.haskell.org/package/stm-conduit-2.7.0/docs/Data-Conduit-TMChan.html#sinkTBMChan\" rel=\"nofollow\"><code>Data.Conduit.TMChan</code></a>, so you can finalize the source by closing the TBMChannel.  I haven't tested the code below since your program is not runnable on my machine.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport           Control.Concurrent           (threadDelay)\nimport           Control.Monad.IO.Class\nimport           Control.Monad.Trans.Resource\nimport qualified Data.ByteString              as B\nimport           Data.Conduit\nimport           Data.Conduit.Network\nimport           Data.Conduit.TMChan\n\nmain::IO ()\nmain = do\n  runTCPClient (clientSettings 3000 \"127.0.0.1\") $ \\server -&gt; do\n      runResourceT $ do\n        -- create the TBMChannel\n        chan &lt;- liftIO $ newTBMChanIO 2\n        let\n          -- everything piped to the sink will appear at the source\n          chanSink = sinkTBMChan chan True\n          chanSource = sourceTBMChan chan\n        tid1 &lt;- resourceForkIO $ appSource server $$ chanSink\n        tid2 &lt;- resourceForkIO $ infiniteSource $$ chanSink\n\n        chanSource $$ transPipe liftIO (appSink server)\n\n        -- and call 'closeTBMChan chan' when you want to exit.\n        -- 'chanSource' will be closed when the underlying TBMChannel is closed.\n\ninfiniteSource :: MonadIO m =&gt; Source m B.ByteString\ninfiniteSource = do\n  liftIO $ threadDelay 10000000\n  yield \"infinite source\"\n  infiniteSource\n</code></pre>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1454415524, "creation_date": 1454366978, "question_id": 35141939, "link": "https://stackoverflow.com/questions/35141939/how-to-exit-a-conduit-when-using-mergesources", "title": "How to exit a conduit when using mergeSources", "body": "<p>I have a simple forked conduit setup, with two inputs feeding one single output....  </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Concurrent (threadDelay)\nimport Control.Monad.IO.Class\nimport Control.Monad.Trans.Resource\nimport qualified Data.ByteString as B\nimport Data.Conduit\nimport Data.Conduit.TMChan\nimport Data.Conduit.Network\n\nmain::IO ()\nmain = do\n  runTCPClient (clientSettings 3000 \"127.0.0.1\") $ \\server -&gt; do\n      runResourceT $ do\n\n        input &lt;- mergeSources [\n          transPipe liftIO (appSource server),\n          infiniteSource\n          ] 2\n\n        input $$ transPipe liftIO (appSink server)\n\ninfiniteSource::MonadIO m=&gt;Source m B.ByteString\ninfiniteSource = do\n  liftIO $ threadDelay 10000000\n  yield \"infinite source\"\n  infiniteSource\n</code></pre>\n\n<p>(here I connect to a tcp socket, then combine the socket input with a timed infinite source, then respond back to the socket)</p>\n\n<p>This works great, until the connection is dropped....  Because the second input still exists, the conduit keeps running.  (In this case, the program does end when the timed input fires and there is no socket to write to, but this isn't always the case in my real example).</p>\n\n<p>What is the proper way to shut down the full conduit when one of the inputs is closed?</p>\n\n<p>I tried to brute force a crash by adding the following</p>\n\n<pre><code>crashOnEndOfStream::MonadIO m=&gt;Conduit B.ByteString m B.ByteString\ncrashOnEndOfStream = do\nawaitForever $ yield\nerror \"the peer connection has disconnected\" --tried with error\nliftIO $ exitWith ExitSuccess --also tried with exitWith\n</code></pre>\n\n<p>but because the input conduit runs in a thread, the executable was immune to runtime exceptions shutting it down (plus, there is probably a smoother way to shut stuff down than halting the program).</p>\n"}, {"tags": ["haskell", "haddock"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1454367817, "post_id": 35141926, "comment_id": 58004543, "body": "Are you sure you need this? Sounds like <a href=\"http://blog.codinghorror.com/code-tells-you-how-comments-tell-you-why/\" rel=\"nofollow noreferrer\">you&#39;re using comments wrong</a>, after all a Haskell ADT definition <i>is</i> already pretty much a grammar. This reminds me of <a href=\"http://programmers.stackexchange.com/a/3/29181\"><code>i++; &#47;&#47; Increment i by 1</code></a> style coding. \u2014 If you really need BNF, well, provide it as a single plaintext chunk, but not as Haddock inline comments."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454368163, "post_id": 35141926, "comment_id": 58004663, "body": "@leftaroundabout: The BNF <a href=\"https://coq.inria.fr/distrib/current/refman/Reference-Manual003.html\" rel=\"nofollow noreferrer\">already exists</a>, I&#39;m just instantiating it in Haskell. The point of the comments is to line up the constructors, and perhaps more importantly the fields, with the productions/nonterminals in the BNF rules. E.g., in the production <code>Let Ident [Binder] (Maybe Term) Term Term</code>, which <code>Term</code> means what?  It helps to see that this production is <code>let &#47;ident&#47; [&#47;binders&#47;] [: &#47;term&#47;] := &#47;term&#47; in &#47;term&#47;</code>.  So the comments are half &quot;why&quot; and half &quot;what does this mean?&quot;."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454368273, "post_id": 35141926, "comment_id": 58004707, "body": "@leftaroundabout (And even if you aren&#39;t convinced by this use case, the &quot;inline code/code block&quot; ambiguity is something that I&#39;ve encountered with Haddock before.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454368682, "post_id": 35141926, "comment_id": 58004840, "body": "Yeah, me too, Haddock code-snippet syntax is certainly a bit annoying. But IMO it just doesn&#39;t make sense to have \u201cline-spanning inline code\u201d. \u2014 I&#39;m indeed not convinced with this use case: if you want <i>readability</i> then improve your <i>code</i>, not your comments. Type operators / infix constructors / type synonyms can help here."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454369725, "post_id": 35141926, "comment_id": 58005247, "body": "@leftaroundabout I tried that at first \u2013 and I&#39;m certainly not done iterating on the design of this AST \u2013 but with 5-argument type constructors, three of whose arguments are the same type, it gets tricky to do. Type synonyms aren&#39;t necessarily a bad choice (although the number needed becomes a bit of a pain), but I&#39;ve decided that what&#39;s <i>more</i> important is at-a-glance correspondence with the BNF source, as this is part of a verification-related project where it&#39;s important to know that your model is of the right thing. (Although we&#39;re not verifying this code itself, I&#39;m in that mindset.)"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 1, "last_activity_date": 1458286382, "creation_date": 1458286382, "answer_id": 36078610, "question_id": 35141926, "link": "https://stackoverflow.com/questions/35141926/how-to-generate-a-haddock-inline-code-span-that-takes-up-a-whole-line/36078610#36078610", "title": "How to generate a Haddock inline code span that takes up a whole line", "body": "<p>Here is a suggested dirty hack. Your problem is that your lines only have code, and not text, correct? Well, just add, after the code, a bit of meaningless text. You can use the <code>&amp;#xH;</code> format to insert hexcodes of unicode characters, for example zero-width or nonbreaking spaces. I would imagine that this would let you convince haddock that you are in an inline rather than block context.</p>\n"}], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1458286382, "creation_date": 1454366928, "question_id": 35141926, "link": "https://stackoverflow.com/questions/35141926/how-to-generate-a-haddock-inline-code-span-that-takes-up-a-whole-line", "title": "How to generate a Haddock inline code span that takes up a whole line", "body": "<p>In Haddock, the \"inline code\"\u00b9 markup, <code>@...@</code>, is the same as the \"code block\" markup,</p>\n\n<pre><code>@\n...\n@\n</code></pre>\n\n<p>How can I write a single-line Haddock comment that consists only of an <em>inline</em> code span, without it being misinterpreted as a block?  A comment like</p>\n\n<pre><code>-- |@/code/ span@\n</code></pre>\n\n<p>renders as the block</p>\n\n<blockquote>\n<pre><em>code</em> span</pre>\n</blockquote>\n\n<p>instead of the desired inline</p>\n\n<blockquote>\n  <p><code><em>code</em> span</code></p>\n</blockquote>\n\n<p>The context, in case more examples help, is that I'm writing a data type that represents a BNF grammar, and so I have a number of types that look like the following:</p>\n\n<pre><code>-- |@/term/ ::=@\ndata Term = Var Name       -- ^@/name/@\n          | Plus Term Term -- ^@/term/ + /term/@\n          | Print Term     -- ^@print /term/@\n</code></pre>\n\n<p>This example corresponds to the grammar</p>\n\n<pre><em>term</em> ::= <em>name</em>\n      |  <em>term</em> + <em>term</em>\n      |  print <em>term</em>\n</pre>\n\n<p>and so the grammar is embedded in the Haddock comments.  But since Haddock parses those <code>@...@</code> comments as blocks, the output is unnecessarily tall, and is inconsistent when some lines have extra comment text (e.g., <code>-- ^@double /term/@ \u2013 syntax sugar</code>).</p>\n\n<hr>\n\n<p>\u00b9 A.k.a. \"monospaced\" or \"typewriter\".</p>\n"}, {"tags": ["haskell", "pipe"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454358482, "post_id": 35139548, "comment_id": 57999613, "body": "well the <code>sum</code> in pipes takes something that <i>produces</i>  numbers and sums them up in a monadic action ... the idea is quite similar to yours if you think about it - also the package is designed so that you should not care about the details but use <code>fold</code> and the rest of the provided primitives ;)"}], "answers": [{"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1454364376, "post_id": 35140597, "comment_id": 58002966, "body": "&quot;Can&#39;t detect end-of-input&quot; was what I was missing. Thanks very much."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 5, "last_activity_date": 1454365240, "last_edit_date": 1454365240, "creation_date": 1454361823, "answer_id": 35140597, "question_id": 35139548, "link": "https://stackoverflow.com/questions/35139548/how-to-write-a-haskell-pipes-sum-function/35140597#35140597", "title": "How to write a Haskell Pipes &quot;sum&quot; function?", "body": "<p><code>Consumers</code> are actually quite limited in what they can do. They can't detect end-of-input (<a href=\"http://hackage.haskell.org/package/pipes-parse\" rel=\"nofollow\">pipes-parse</a> uses a different technique for that) and when some other part of the pipeline stops (for example the <code>Producer</code> upstream) <em>that</em> part is the one that must provide the result value for the pipeline. So putting the sum in the return value of the <code>Consumer</code> won't work in general.</p>\n\n<p>Some alternatives are:</p>\n\n<ul>\n<li><p>Implement a function that deals directly with <code>Producer</code> internals, or perhaps uses an auxiliary function like <a href=\"http://hackage.haskell.org/package/foldl\" rel=\"nofollow\"><code>next</code></a>. There are adapters of this type that can feed <code>Producer</code> data to \"smarter\" consumers, like <code>Fold</code>s from the <a href=\"http://hackage.haskell.org/package/foldl\" rel=\"nofollow\">foldl</a> package.</p></li>\n<li><p>Keep using a <code>Consumer</code>, but instead of putting the sum in the return value of the <code>Consumer</code>, use a <code>WriterT</code> as the base monad with a <code>Sum Int</code> monoid as accumulator. That way, even if the <code>Producer</code> stop first, you can still run the writer to get to the accumulator This solution is likely to be less efficient, though.</p></li>\n</ul>\n\n<p>Example code for the <code>WriterT</code> approach:</p>\n\n<pre><code>import Data.Monoid\nimport Control.Monad\nimport Control.Monad.Trans.Writer\nimport Pipes\n\nproducer :: Monad m =&gt; Producer Int m ()\nproducer = mapM_ yield [1..10]\n\nsummator :: Monad n =&gt; Consumer Int (WriterT (Sum Int) n) ()\nsummator = forever $ await &gt;&gt;= lift . tell .  Sum\n\nmain :: IO ()\nmain = do\n   Sum r &lt;- execWriterT . runEffect $ producer &gt;-&gt; summator\n   print r\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 3, "accepted_answer_id": 35140597, "answer_count": 1, "score": 8, "last_activity_date": 1454368824, "creation_date": 1454357945, "last_edit_date": 1454368824, "question_id": 35139548, "link": "https://stackoverflow.com/questions/35139548/how-to-write-a-haskell-pipes-sum-function", "title": "How to write a Haskell Pipes &quot;sum&quot; function?", "body": "<p>I'm trying to learn the <code>pipes</code> package by writing my own <code>sum</code> function and I'm getting stumped. I'd like to not use the utility functions from <code>Pipes.Prelude</code> (since it has <code>sum</code> and <code>fold</code> and other functions which make it trivial)  and only use the information as described in <code>Pipes.Tutorial</code>. The tutorial doesn't talk about the constructors of <code>Proxy</code>, but if I look in the source of <code>sum</code> and <code>fold</code> it uses those constructors and I wonder whether it is possible to write my <code>sum</code> function without knowledge of these low level details.</p>\n\n<p>I'm having trouble coming to terms with how this function would be able to continue taking in values as long as there are values available, and then somehow return that sum to the user. I guess the type would be:</p>\n\n<pre><code>sum' :: Monad m =&gt; Consumer Int m Int\n</code></pre>\n\n<p>It appears to me this could work because this function could consume values until there are no more, then return the final sum. I would use it like this:</p>\n\n<pre><code>mysum &lt;- runEffect $ inputs &gt;-&gt; sum'\n</code></pre>\n\n<p>However, the function in <code>Pipes.Prelude</code> has the following signature instead:</p>\n\n<pre><code>sum :: (Monad m, Num a) =&gt; Producer a m () -&gt; m a\n</code></pre>\n\n<p>So I guess this is my first hurdle. Why does the <code>sum</code> function take a <code>Producer</code> as an argument as opposed to using <code>&gt;-&gt;</code> to connect?</p>\n\n<hr>\n\n<p>FYI I ended up with the following after the answer from danidiaz:</p>\n\n<pre><code>sum' = go 0\n  where\n    go n p = next p &gt;&gt;= \\x -&gt; case x of\n      Left _        -&gt; return n\n      Right (_, p') -&gt; go (n + 1) p'\n</code></pre>\n"}, {"tags": ["haskell", "types", "type-inference", "typechecking"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454358518, "post_id": 35139454, "comment_id": 57999630, "body": "It would be nice to have a way to block up the third under certain circumstances, particularly where the ultimate unsatisfiable constraint involves non-exported names. Failures using <code>Data.Constraint.Forall</code> can lead to error messages that involve (necessarily) non-exported skolem families that end users would be better off not seeing. If you write <code>Forall p =&gt;</code> and that doesn&#39;t work out, you&#39;ll hear back that GHC couldn&#39;t satisfy <code>p (Skolem p)</code>, which doesn&#39;t seem quite so lovely."}, {"owner": {"reputation": 10040, "user_id": 298664, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f74250d692283f80eaa0c8053f0b2ccd?s=128&d=identicon&r=PG", "display_name": "Norswap", "link": "https://stackoverflow.com/users/298664/norswap"}, "edited": false, "score": 0, "creation_date": 1454373559, "post_id": 35139454, "comment_id": 58006314, "body": "I don&#39;t think that&#39;s the reason, because the paper does discuss this point abundantly. It in fact suggests to drop this restriction (and as far as I can tell, all the suggestions for improvement made in the conclusion of the paper were adopted in Haskell 98). For instance contexts, it still proposes to keep simple constraints, and the motivation is ... not breaking context reduction. So the causality seems rather in the other direction."}, {"owner": {"reputation": 10040, "user_id": 298664, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f74250d692283f80eaa0c8053f0b2ccd?s=128&d=identicon&r=PG", "display_name": "Norswap", "link": "https://stackoverflow.com/users/298664/norswap"}, "edited": false, "score": 0, "creation_date": 1454373761, "post_id": 35139454, "comment_id": 58006381, "body": "On another note, I agree to your reduction example (point 1), but that does not need reduction via reverse entailment (just the identity and super-class relationships). For the rest, I think reduction is actually confusing, since it does not match to the set of constraints you defined. And changing the way the instances are provided can change the type of your expression!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454374954, "post_id": 35139454, "comment_id": 58006706, "body": "You are incorrect about Haskell &#39;98: the restriction I suggest is correct for both Haskell 98 and Haskell 2010. Only GHC extensions relax this; and indeed from my perusal of the &quot;conclusion&quot; section of the linked paper, basically all of the recommendations became GHC extensions rather than part of the language proper. I&#39;m not sure what part of my answer makes you think that I claim &quot;simple instance contexts&quot; is the cause for context reduction -- I don&#39;t mention instance contexts at all. Type signature contexts are the cause; and making these more complicated should not break context reduction."}, {"owner": {"reputation": 10040, "user_id": 298664, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f74250d692283f80eaa0c8053f0b2ccd?s=128&d=identicon&r=PG", "display_name": "Norswap", "link": "https://stackoverflow.com/users/298664/norswap"}, "edited": false, "score": 0, "creation_date": 1454418817, "post_id": 35139454, "comment_id": 58027213, "body": "You are right about the standard. I did not believe that you meant <i>instance</i> contexts were the rationale for reduction, but re-reading myself I agree my point about them makes little sense. Still, the paper wants to uphold context reduction, despite wanting to relax restrictions on type signatures contexts. So the need for context reduction can hardly be motivated by the need for simple type signature contexts, right?"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 9, "last_activity_date": 1454357531, "creation_date": 1454357531, "answer_id": 35139454, "question_id": 35137690, "link": "https://stackoverflow.com/questions/35137690/why-is-context-reduction-necessary/35139454#35139454", "title": "Why is context reduction necessary?", "body": "<p>I don't know if this is The Reason, necessarily, but it might be considered A Reason: in early Haskell, type signatures were only permitted to have \"simple\" constraints, namely, a type class name applied to a type variable. Thus, for example, all of these were okay:</p>\n\n<pre><code>Ord a =&gt; a -&gt; a -&gt; Bool\nEq a =&gt; a -&gt; a -&gt; Bool\nGraph gr =&gt; gr n e -&gt; [n]\n</code></pre>\n\n<p>But none of these:</p>\n\n<pre><code>Ord (Tree a) =&gt; Tree a -&gt; Tree a -&gt; Bool\nEq (a -&gt; b) =&gt; (a -&gt; b) -&gt; (a -&gt; b) -&gt; Bool\nGraph Gr =&gt; Gr n e -&gt; [n]\n</code></pre>\n\n<p>I think there was a feeling then -- and still today, as well -- that allowing the compiler to infer a type which one couldn't write manually would be a bit unfortunate. Context reduction was a way of turning the above signatures either into ones that could be written by hand as well <em>or</em> an informative error. For example, since one might reasonably have</p>\n\n<pre><code>instance Ord a =&gt; Ord (Tree a)\n</code></pre>\n\n<p>in scope, we could turn the illegal signature <code>Ord (Tree a) =&gt; ...</code> into the legal signature <code>Ord a =&gt; ...</code>. On the other hand, if we don't have any instance of <code>Eq</code> for functions in scope, one would report an error about the type which was inferred to require <code>Eq (a -&gt; b)</code> in its context.</p>\n\n<p>This has a couple of other benefits:</p>\n\n<ol>\n<li>Intuitively pleasing. Many of the context reduction rules do not change whether the type is legal, but do reflect things humans would do when writing the type. I'm thinking here of the de-duplication and subsumption rules that let you turn, e.g. <code>(Eq a, Eq a, Ord a)</code> into just <code>Ord a</code> -- a transformation one definitely would want to do for readability.</li>\n<li>This can frequently catch stupid errors; rather than inferring a type like <code>Eq (Integer -&gt; Integer) =&gt; Bool</code> which can't be satisfied in a law-abiding way, one can report an error like <code>Perhaps you did not apply a function to enough arguments?</code>. Much friendlier!</li>\n<li>It becomes the compiler's job to pinpoint what went wrong. Instead of inferring a complicated context like <code>Eq (Tree (Grizwump a, [Flagle (Gr n e) (Gr n' e') c]))</code> and complaining that the context is not satisfiable, it instead is forced to reduce this to the constituent constraints; it will instead complain that we couldn't determine <code>Eq (Grizwump a)</code> from the existing context -- a much more precise and actionable error.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454358014, "post_id": 35139517, "comment_id": 57999338, "body": "If &quot;an alternative [dictionary-passing] implementation... could work without context reduction&quot;, what motivates the claim that context reduction &quot;is necessary in a dictionary passing implementation&quot;?"}, {"owner": {"reputation": 10040, "user_id": 298664, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f74250d692283f80eaa0c8053f0b2ccd?s=128&d=identicon&r=PG", "display_name": "Norswap", "link": "https://stackoverflow.com/users/298664/norswap"}, "edited": false, "score": 0, "creation_date": 1454374538, "post_id": 35139517, "comment_id": 58006604, "body": "It makes sense, although I&#39;d be disappointed if that turns out to be the answer. Still I&#39;m not convinced, because (1) it&#39;s a bit weird that dictionary-passing is not part of the spec, but context reduction is, (2) the paper does mention this benefit of context reduction (section 4.3 points 2 and 4), but as a trade-off that informs how context reduction should be done, rather than as a reason for introducing context reduction in the first place."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 6, "last_activity_date": 1454358260, "last_edit_date": 1454358260, "creation_date": 1454357793, "answer_id": 35139517, "question_id": 35137690, "link": "https://stackoverflow.com/questions/35137690/why-is-context-reduction-necessary/35139517#35139517", "title": "Why is context reduction necessary?", "body": "<p>I think this is indeed desirable in a dictionary passing implementation. In such an implementation, a \"dictionary\", that is, a tuple or record of functions is passed as implicit argument for every type class constraint in the type of the applied function.</p>\n\n<p>Now, the question is simply when and how those dictionaries are created. Observe that for simple types like <code>Int</code> by necessity all dictionaries for whatever type class <code>Int</code> is an instance of will be a constant. \nNot so in the case of parameterized types like lists, <code>Maybe</code> or tuples. It is clear that to show a tuple, for instance, the <code>Show</code> instances of the actual tuple elements need to be known. Hence such a polymorphic dictionary cannot be a constant. </p>\n\n<p>It appears that the principle guiding the dictionary passing is such that only dictionaries for types that appear as type variables in the type of the applied function are passed. Or, to put it differently: no redundant information is replicated.</p>\n\n<p>Consider this function:</p>\n\n<pre><code> f :: (Show a, Show b) =&gt; (a,b) -&gt; Int\n f ab = length (show ab)\n</code></pre>\n\n<p>The information that a tuple of show-able components is also showable, thus a constraint like <code>Show (a,b)</code> needs not to appear when we already know <code>(Show a, Show b)</code>.</p>\n\n<p>An alternative implementation would be possible, though, where the caller .would be responsible to create and pass dictionaries. This could work without context reduction, such that the type of <code>f</code> would look like:</p>\n\n<pre><code>f :: Show (a,b) =&gt; (a,b) -&gt; Int\n</code></pre>\n\n<p>But this would mean that the code to create the tuple dictionary would have to be repeated on every call site. And it is easy to come up with examples where the number of necessary constraints actually increases, like in:</p>\n\n<pre><code>g :: (Show (a,a), Show(b,b), Show (a,b), Show (b, a)) =&gt; a -&gt; b -&gt; Int\ng a b = maximum (map length [show (a,a), show (a,b), show (b,a), show(b,b)])\n</code></pre>\n\n<p>It is instructive to implement a type class/instance system with actual records that are explicitly passed. For example:</p>\n\n<pre><code>data Show' a = Show' { show' :: a -&gt; String }\nshowInt :: Show' Int\nshowInt = Show' { show' = intshow } where\n      intshow :: Int -&gt; String\n      intshow = show\n</code></pre>\n\n<p>Once you do this you will probably easily recognize the need for \"context reduction\".</p>\n"}], "owner": {"reputation": 10040, "user_id": 298664, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f74250d692283f80eaa0c8053f0b2ccd?s=128&d=identicon&r=PG", "display_name": "Norswap", "link": "https://stackoverflow.com/users/298664/norswap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1454374705, "creation_date": 1454351234, "last_edit_date": 1454374705, "question_id": 35137690, "link": "https://stackoverflow.com/questions/35137690/why-is-context-reduction-necessary", "title": "Why is context reduction necessary?", "body": "<p>I've just read <a href=\"https://courses.cs.washington.edu/courses/cse590p/06sp/multi.pdf\" rel=\"nofollow\">this paper</a> (\"Type classes: an exploration of the design space\" by Peyton Jones &amp; Jones), which explains some challenges with the early typeclass system of Haskell, and how to improve it.</p>\n\n<p>Many of the issues that they raise are related to <em>context reduction</em> which is a way to reduce the set of constraints over instance and function declarations by following the \"reverse entailment\" relationship.</p>\n\n<p>e.g. if you have somewhere <code>instance (Ord a, Ord b) =&gt; Ord (a, b) ...</code> then within contexts, <code>Ord (a, b)</code> gets reduced to <code>{Ord a, Ord b}</code> (reduction does not always shrink the number of constrains).</p>\n\n<p>I did not understand from the paper why this reduction was necessary.</p>\n\n<p>Well, I gathered it was used to perform some form of type checking. When you have your reduced set of constraint, you can check that there exist some instance that can satisfy them, otherwise it's an error. I'm not too sure what the added value of that is, since you would notice the problem at the use site, but okay.</p>\n\n<p>But even if you have to do that check, why use the result of reduction inside inferred types? The paper points out it leads to unintuitive inferred types.</p>\n\n<p>The paper is quite ancient (1997) but as far as I can tell, context reduction is still an ongoing concern. The Haskell 2010 spec does mention the inference behaviour I explain above (<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-910004.5.3\" rel=\"nofollow\">link</a>).</p>\n\n<p>So, why do it this way?</p>\n"}, {"tags": ["scala", "haskell", "enums"], "comments": [{"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 0, "creation_date": 1454345776, "post_id": 35135806, "comment_id": 57991952, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/19081904/scala-difference-between-a-typeclass-and-an-adt\">Scala: difference between a typeclass and an ADT?</a>"}, {"owner": {"reputation": 31264, "user_id": 1632462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/739095ce21a3e8df42d3cdeb20711ea4?s=128&d=identicon&r=PG", "display_name": "R&#233;gis Jean-Gilles", "link": "https://stackoverflow.com/users/1632462/r%c3%a9gis-jean-gilles"}, "reply_to_user": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 1, "creation_date": 1454347589, "post_id": 35135806, "comment_id": 57993180, "body": "@Shoe: I don&#39;t think it can count as duplicate of <a href=\"http://stackoverflow.com/questions/19081904/scala-difference-between-a-typeclass-and-an-adt\" title=\"scala difference between a typeclass and an adt\">stackoverflow.com/questions/19081904/&hellip;</a> when OP&#39;s question is not even remotely about type classes."}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "reply_to_user": {"reputation": 31264, "user_id": 1632462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/739095ce21a3e8df42d3cdeb20711ea4?s=128&d=identicon&r=PG", "display_name": "R&#233;gis Jean-Gilles", "link": "https://stackoverflow.com/users/1632462/r%c3%a9gis-jean-gilles"}, "edited": false, "score": 0, "creation_date": 1454349328, "post_id": 35135806, "comment_id": 57994250, "body": "@R&#233;gisJean-Gilles The answers found in that question represent both ADT and type classes in Haskell and Scala form which is what this question is all about."}, {"owner": {"reputation": 31264, "user_id": 1632462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/739095ce21a3e8df42d3cdeb20711ea4?s=128&d=identicon&r=PG", "display_name": "R&#233;gis Jean-Gilles", "link": "https://stackoverflow.com/users/1632462/r%c3%a9gis-jean-gilles"}, "edited": false, "score": 0, "creation_date": 1454405016, "post_id": 35135806, "comment_id": 58017613, "body": "I guess it&#39;s debatable, but given how broad the other question is, vs how specific this one is, this does not strike me as being a good candidate for a duplicate. No doubt that the other question is related though, and in any case worth a read for SaKou."}], "answers": [{"comments": [{"owner": {"reputation": 5631, "user_id": 540173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15b550e02818cedfc379b85250c98a64?s=128&d=identicon&r=PG", "display_name": "Madoc", "link": "https://stackoverflow.com/users/540173/madoc"}, "edited": false, "score": 0, "creation_date": 1454348574, "post_id": 35135987, "comment_id": 57993776, "body": "Please note that it should be a <code>sealed case class</code> in this case, otherwise this will break open the seal of the <code>Rank</code> trait. (In contrast, <code>object</code>s are sealed by nature.)"}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 5631, "user_id": 540173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15b550e02818cedfc379b85250c98a64?s=128&d=identicon&r=PG", "display_name": "Madoc", "link": "https://stackoverflow.com/users/540173/madoc"}, "edited": false, "score": 0, "creation_date": 1454349325, "post_id": 35135987, "comment_id": 57994248, "body": "@Madoc Thanks, that&#39;s a good note, but it is not needed always - so I won&#39;t fix my answer. Usually <code>sealed</code> for enums is used so compiler could generate <code>match may not be exhaustive</code> check, and it still continues to work for <code>case class</code> even if it is not <code>sealed</code>, because case-to-case inheritance is prohibited in scala, and compiler does not worry about class-to-case inheritance (it does not influence a check). But this note still stands if you have other reasons to seal your type system"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454349410, "post_id": 35135987, "comment_id": 57994302, "body": "FYI, in Haskell, <code>Num Int</code> would not be considered a &quot;data type&quot; but rather a &quot;constraint&quot;. This works out about the same once type checking and &quot;desugaring&quot; have transformed Haskell to GHC Core (a.k.a. System FC), but in Haskell proper they are quite different. The <code>constraints</code> and <code>reflection</code> packages help work with relationships between them."}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 5631, "user_id": 540173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15b550e02818cedfc379b85250c98a64?s=128&d=identicon&r=PG", "display_name": "Madoc", "link": "https://stackoverflow.com/users/540173/madoc"}, "edited": false, "score": 0, "creation_date": 1454349450, "post_id": 35135987, "comment_id": 57994318, "body": "@Madoc Now when I think of it more - only <code>sealed</code> on base trait influence the <code>match may not be exhaustive</code> check. Everything else from the comment still stands"}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454349628, "post_id": 35135987, "comment_id": 57994443, "body": "@dfeuer Thanks, I&#39;m not very good in Haskell terminology. I&#39;ve made a fix, does it look ok?"}, {"owner": {"reputation": 209, "user_id": 3621325, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6852016e1fce8743bacf2ee4852b5471?s=128&d=identicon&r=PG&f=1", "display_name": "SaKou", "link": "https://stackoverflow.com/users/3621325/sakou"}, "edited": false, "score": 0, "creation_date": 1454355625, "post_id": 35135987, "comment_id": 57997883, "body": "@Archeg Thank you,i am a beginner with both scala and haskell can you please explain how to take in consideration the <code>show</code> and <code>Eq</code> instances"}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 209, "user_id": 3621325, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6852016e1fce8743bacf2ee4852b5471?s=128&d=identicon&r=PG&f=1", "display_name": "SaKou", "link": "https://stackoverflow.com/users/3621325/sakou"}, "edited": false, "score": 0, "creation_date": 1454357866, "post_id": 35135987, "comment_id": 57999249, "body": "@SaKou Normally I&#39;d have written that in the answer as well, but in this case you didn&#39;t provide any info on what are you trying to do and what libraries are you using. Scala itself does not provide <code>Show</code> type class and <code>Eq</code> is automatically defined for any <code>case class</code>. I&#39;m not sure whether I can call this mechanics a type class, but it allows you to use <code>==</code> operator. If you want to implement an instance of real type classes, you would want to look at libraries like <code>scalaz</code> or <code>cats</code>, but that&#39;s definitely should be another question as these libraries have it&#39;s own problems with ADT"}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 209, "user_id": 3621325, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6852016e1fce8743bacf2ee4852b5471?s=128&d=identicon&r=PG&f=1", "display_name": "SaKou", "link": "https://stackoverflow.com/users/3621325/sakou"}, "edited": false, "score": 0, "creation_date": 1454357982, "post_id": 35135987, "comment_id": 57999319, "body": "@SaKou And scala provides <code>.toString()</code> for any class, which is not type class I believe but is very close by functionality to <code>Show</code>. So I&#39;d summary that if you need <code>Show</code> and <code>Eq</code> functionality - you have them out of the box. If you want real type classes and be very haskell-like, then you need <code>scalaz</code> or <code>cats</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1454362385, "post_id": 35135987, "comment_id": 58001869, "body": "I would like to point out that the included Haskell code, namely <code>data Rank = ... | Num Int</code> defines a <i>new</i> name <code>Num</code>, not related to the standard <code>Prelude.Num</code>, which is a data constructor and <i>not</i> a type class. So, though I don&#39;t know enough Scala to be able to tell for sure, I suspect that this answer may be predicated on a misunderstanding of the Haskell code and not quite on target."}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1454363046, "post_id": 35135987, "comment_id": 58002275, "body": "@DanielWagner I am aware of that, I also defined <code>Num</code> in scala that is not related to Haskell&#39;s <code>Prelude.Num</code> However my wording or haskell terminology may be wrong as I am mostly scala developer and know only a bit of haskell (and mostly it&#39;s practical side), so please correct me if I&#39;ve said anything wrong."}, {"owner": {"reputation": 31264, "user_id": 1632462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/739095ce21a3e8df42d3cdeb20711ea4?s=128&d=identicon&r=PG", "display_name": "R&#233;gis Jean-Gilles", "link": "https://stackoverflow.com/users/1632462/r%c3%a9gis-jean-gilles"}, "edited": false, "score": 0, "creation_date": 1454405332, "post_id": 35135987, "comment_id": 58017824, "body": "@Archeg: I have a hunch that the confusion comes from the fact that you said &quot;Notice that scala requires you to give it a name, unlike haskell&quot;. In reality the Haskell version <b>does</b> require to come up with a name for it, as just like in scala <code>Num</code> is definitely a new name (that is totally unrelated with <code>Prelude.Num</code>, as pointed by Daniel Wagner). You might want to remove that sentence from your answer."}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 31264, "user_id": 1632462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/739095ce21a3e8df42d3cdeb20711ea4?s=128&d=identicon&r=PG", "display_name": "R&#233;gis Jean-Gilles", "link": "https://stackoverflow.com/users/1632462/r%c3%a9gis-jean-gilles"}, "edited": false, "score": 0, "creation_date": 1454405752, "post_id": 35135987, "comment_id": 58018105, "body": "@R&#233;gisJean-Gilles In that phrase by <code>it</code> I meant the argument of the type.  In haskell you can have <code>Num Int</code>, or you could have a record with <code>Num { value :: Int }</code>. But in scala you only have the latest, so you always have to give <code>Int</code> argument the name"}, {"owner": {"reputation": 5631, "user_id": 540173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15b550e02818cedfc379b85250c98a64?s=128&d=identicon&r=PG", "display_name": "Madoc", "link": "https://stackoverflow.com/users/540173/madoc"}, "edited": false, "score": 0, "creation_date": 1454451860, "post_id": 35135987, "comment_id": 58048376, "body": "@Archeg No, when you extend a <code>sealed</code> type with a non-<code>object</code> type that is not <code>sealed</code>, then it is as if the base type had not been <code>sealed</code> in the first place. Try it out, I had a problem with that once."}, {"owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "reply_to_user": {"reputation": 5631, "user_id": 540173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/15b550e02818cedfc379b85250c98a64?s=128&d=identicon&r=PG", "display_name": "Madoc", "link": "https://stackoverflow.com/users/540173/madoc"}, "edited": false, "score": 0, "creation_date": 1454453048, "post_id": 35135987, "comment_id": 58048922, "body": "@Madoc I&#39;ve tried. I receive a proper may not be exhaustive warning."}], "tags": [], "owner": {"reputation": 7775, "user_id": 423839, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87198e930e8a9974c207222c0e164174?s=128&d=identicon&r=PG", "display_name": "Archeg", "link": "https://stackoverflow.com/users/423839/archeg"}, "is_accepted": true, "score": 5, "last_activity_date": 1454405785, "last_edit_date": 1454405785, "creation_date": 1454345733, "answer_id": 35135987, "question_id": 35135806, "link": "https://stackoverflow.com/questions/35135806/enum-type-using-sealed-case-objects-from-haskell-to-scala/35135987#35135987", "title": "Enum type using sealed case objects (from haskell to scala)", "body": "<p>In Haskell <code>Num</code> is a class that requires a single type argument, such as <code>Int</code>, to produce a constraint such as <code>Num Int</code>. So in scala you should expect something like that:</p>\n\n<pre><code>case class Num(value: Int) extends Rank\n</code></pre>\n\n<p>Notice that scala requires you to give the argument a name, unlike haskell</p>\n\n<p>Also you are missing the instances of <code>Show</code> and <code>Eq</code> defined for <code>Rank</code> in scala code, but that doesn't seem to be a part of the question</p>\n"}], "owner": {"reputation": 209, "user_id": 3621325, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6852016e1fce8743bacf2ee4852b5471?s=128&d=identicon&r=PG&f=1", "display_name": "SaKou", "link": "https://stackoverflow.com/users/3621325/sakou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 35135987, "answer_count": 1, "score": 3, "last_activity_date": 1454405785, "creation_date": 1454345253, "last_edit_date": 1454355387, "question_id": 35135806, "link": "https://stackoverflow.com/questions/35135806/enum-type-using-sealed-case-objects-from-haskell-to-scala", "title": "Enum type using sealed case objects (from haskell to scala)", "body": "<p>I am trying to translate some code from haskell to scala language.\nIn  haskell I implemented an enum type like that :</p>\n\n<pre><code>data Rank = Jack | Queen | King | Ace | Num Int deriving (Show, Eq) \n</code></pre>\n\n<p>I would Like to implement it in scala using selaled case Objects </p>\n\n<pre><code>sealed trait Rank\ncase object Jack extends Rank\ncase object Queen extends Rank\ncase object King extends Rank\ncase object Ace extends Rank\ncase object Num Int extends Rank\n</code></pre>\n\n<p>The problem that for the Num Int type i get an error. I think it should be written as one word ! Any help !</p>\n"}, {"tags": ["haskell", "haskell-lens", "maybe", "lenses"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1454343438, "post_id": 35134772, "comment_id": 57990359, "body": "Not sure what you&#39;re trying to do here - do you want a function <code>(a,b) -&gt; Maybe a -&gt; (a,a)</code> or a function <code>(a,b) -&gt; Maybe a -&gt; Maybe (a,b)</code>?"}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1454343860, "post_id": 35134772, "comment_id": 57990650, "body": "<code>(a,b) -&gt; Maybe a -&gt; (a,a)</code>, but <code>(a,b) -&gt; Maybe a -&gt; Maybe (a,b)</code> also would be interesting"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1454343925, "post_id": 35134772, "comment_id": 57990696, "body": "Did you mean <code>(\\v -&gt; x &amp; _1 .~ v)</code> instead?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1454347777, "post_id": 35134772, "comment_id": 57993294, "body": "could you please make a full example of input &amp; output; also I&#39;d recommend to have a look at prisms <code>Maybe</code> it is just the thing you are looking for."}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "edited": false, "score": 0, "creation_date": 1454348684, "post_id": 35134772, "comment_id": 57993847, "body": "There is already full example. I have a tuple <code>(1,2)</code> and I have an input <code>Maybe Int</code>. What is the right way to update this tuple with this input using <code>lens</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1454351442, "creation_date": 1454351442, "answer_id": 35137742, "question_id": 35134772, "link": "https://stackoverflow.com/questions/35134772/how-to-use-lens-set-function-with-maybe/35137742#35137742", "title": "How to use lens set function with Maybe?", "body": "<p>It appears that you want</p>\n\n<pre><code>maybeSetFst :: (a, b) -&gt; Maybe a -&gt; (a, b)\n</code></pre>\n\n<p>which will update the first field if given an update value and will leave it alone otherwise. I think the first implementation you give is very good, but you can give it a more general type:</p>\n\n<pre><code>maybeSetFst :: Field1 s s a a =&gt; s -&gt; Maybe a -&gt; s\n</code></pre>\n\n<p>If you don't want that generality, you can skip the lenses and write (using <code>TupleSections</code>)</p>\n\n<pre><code>maybeSetFst p@(_,b) = maybe p (,b)\n</code></pre>\n\n<p>Another option is to apply <code>maybe</code> to get the update function:</p>\n\n<pre><code>maybeSetFst p m = maybe id (_1 .~) m p\n</code></pre>\n\n<p>which can be written</p>\n\n<pre><code>maybeSetFst = flip $ maybe id (_1 .~)\n</code></pre>\n\n<p>for point-free silliness.</p>\n"}], "owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 1, "accepted_answer_id": 35137742, "answer_count": 1, "score": 2, "last_activity_date": 1454351442, "creation_date": 1454342137, "last_edit_date": 1454345772, "question_id": 35134772, "link": "https://stackoverflow.com/questions/35134772/how-to-use-lens-set-function-with-maybe", "title": "How to use lens set function with Maybe?", "body": "<p>I have a tuple <code>x</code> and a <code>Maybe</code> value <code>y</code></p>\n\n<pre><code>x = (1,1)\ny = Just 2\n</code></pre>\n\n<p>I can do this</p>\n\n<pre><code>z = maybe x (\\v -&gt; x &amp; _1 .~ v) y\n</code></pre>\n\n<p>Or I can create my own operator</p>\n\n<pre><code>(.~?) x y =  x %~ (\\v -&gt; fromMaybe v y)\n\nz = x &amp; _1 .~? y\n</code></pre>\n\n<p>But if <code>lens</code> doesn't have such operator, maybe I don't need it?</p>\n\n<p>So, how to use <code>lens</code> <code>set</code> function with <code>Maybe</code>?</p>\n"}, {"tags": ["haskell", "composition"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454333736, "post_id": 35131771, "comment_id": 57983373, "body": "you could write your own <i>composition</i> operator - but the <code>do something</code> part smells of sideeffects ..."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1454334495, "post_id": 35131771, "comment_id": 57983901, "body": "Can you be a little more specific in your example?  What are you wanting to use this for?  What problem are you trying to solve that can&#39;t already be solved by simply using something like <code>run before computation after = before &gt;&gt; return computation &gt;&gt;= (\\val -&gt; after &gt;&gt; return val)</code>?  This is a monadic function, though, so it can&#39;t be used in place of <code>computation</code>."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1454337936, "post_id": 35131771, "comment_id": 57986470, "body": "Wait: do you want this: <code>performComposition [] = id; performComposition (f:fs) = f . performComposition fs</code>? But this simply generalizes composition to a list of functions (it&#39;s a <code>fold</code>)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1455720044, "post_id": 35131771, "comment_id": 58615683, "body": "There&#39;s nothing magic in composition. It is simply <code>f . g = \\x -&gt; f(g x)</code>. If you expect to be able to decompose this particular term, why not any other term? How about <code>2 + 2</code>? Given <code>4</code>, would you be able to determine it was <code>2 + 2</code> and not <code>3 + 1</code> originally?"}], "answers": [{"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1454338950, "post_id": 35133671, "comment_id": 57987214, "body": "This looks like a comment. And if you think that the question is a duplicate you should vote/flag for duplication."}], "tags": [], "owner": {"reputation": 1130, "user_id": 2878846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4269b15c82f369605be656a6d9da582?s=128&d=identicon&r=PG&f=1", "display_name": "kodvin", "link": "https://stackoverflow.com/users/2878846/kodvin"}, "is_accepted": false, "score": 0, "last_activity_date": 1454338742, "last_edit_date": 1495542224, "creation_date": 1454338742, "answer_id": 35133671, "question_id": 35131771, "link": "https://stackoverflow.com/questions/35131771/haskell-nested-compostition-functions/35133671#35133671", "title": "Haskell Nested Compostition Functions", "body": "<p>Similar question with several answers can be found <a href=\"https://stackoverflow.com/questions/16825559/does-haskell-keep-track-of-function-composition\">here</a>. As I understand there is no build in mechanism for function composition splitting. You could add some kind of construct (more details in the link), but it would break haskells functional purity, because function decomposition should provide different result with different composition rules <code>a=f.(g.h)</code> and <code>b=(f.g).h</code>. (but its the same function that does identical transformation so it should return the same thing everytime)</p>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 3120835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48c2c7ebc4561f431e104d799f6d4256?s=128&d=identicon&r=PG&f=1", "display_name": "andregps", "link": "https://stackoverflow.com/users/3120835/andregps"}, "is_accepted": false, "score": 1, "last_activity_date": 1455719412, "creation_date": 1455719412, "answer_id": 35459494, "question_id": 35131771, "link": "https://stackoverflow.com/questions/35131771/haskell-nested-compostition-functions/35459494#35459494", "title": "Haskell Nested Compostition Functions", "body": "<p>The solution i have found to my problem was to create something similar to a ternary operator. <a href=\"https://wiki.haskell.org/Ternary_operator\" rel=\"nofollow\">This link</a> was essential.</p>\n\n<p>So, a simple demonstration of the solution to my problem is:</p>\n\n<pre><code>(&gt;=&gt;) :: a -&gt; (a-&gt;b) -&gt; b   -- first operator\nx &gt;=&gt; y = doSomething1  --fake code\n          y x\n\n(\u00a8\u00a8) :: a -&gt; (a-&gt;b) -&gt; b    -- second operator\nx \u00a8\u00a8 y = doSomething2  --fake code\n         y x\n\ninfixl 0 &gt;=&gt; \ninfixl 1 \u00a8\u00a8 \n\ntimes2 :: Int -&gt; Int \ntimes2 x = x*2\n\nplus2 :: Int -&gt; Int\nplus2 x = x+2\n\nplus3 :: Int -&gt; Int\nplus3 x = x+3\n\nmain = putStrLn $ show (3 \u00a8\u00a8 plus2 \u00a8\u00a8 times2 &gt;=&gt; plus3)\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 3120835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48c2c7ebc4561f431e104d799f6d4256?s=128&d=identicon&r=PG&f=1", "display_name": "andregps", "link": "https://stackoverflow.com/users/3120835/andregps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1455719412, "creation_date": 1454333359, "last_edit_date": 1455718863, "question_id": 35131771, "link": "https://stackoverflow.com/questions/35131771/haskell-nested-compostition-functions", "title": "Haskell Nested Compostition Functions", "body": "<p>Is it possible to manipulate nested function compositions in Haskell, in such a way that some processing be executed to each function before the composition?</p>\n\n<p>Suppose a nested composition like <code>(lines . unlines . words) \"Testing Haskell composition\"</code> (it does not make sense; it is just an random example).\nI would like to do something before executing <code>lines</code>,<code>unlines</code> and <code>words</code>. Something like this fake code:</p>\n\n<pre><code>performComposition :: [functions] -&gt; returnValue\nperformComposition [] = ()\nperformComposition (f:fs) = do something\n                            f (performComposition fs )\n</code></pre>\n\n<p>Is it possible, even if it is necessary to create a new operator?</p>\n\n<p>EDIT (February 17th, 2016)</p>\n\n<p>I did not mention that i wanted to do something different on the last function. On the example above, the <code>words</code> function would do something different from the others before executing it.</p>\n\n<p>The solution i have found is detailed below.</p>\n"}, {"tags": ["haskell", "data-structures", "integer", "set", "lookup"], "comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 10, "creation_date": 1454311442, "post_id": 35124851, "comment_id": 57969908, "body": "It&#39;ll be hard to make a good hash function if you don&#39;t even look at the whole integer which will take $O(lg a)$ time."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 3, "creation_date": 1454311881, "post_id": 35124851, "comment_id": 57970117, "body": "You can&#39;t even <i>compare</i> your input integer to a single integer from your set in constant time if you&#39;re actually considering the log(n) factors of unbounded integers."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 6, "creation_date": 1454313674, "post_id": 35124851, "comment_id": 57970992, "body": "The famous O(1) amortized hashing time is achieve quite simply: let&#39;s assume that computing the hash of an element takes O(1) time then... If you drop the O(1) hashing time assumption you no longer have O(1) lookup time."}], "answers": [{"tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": true, "score": 3, "last_activity_date": 1454357506, "last_edit_date": 1454357506, "creation_date": 1454356262, "answer_id": 35139084, "question_id": 35124851, "link": "https://stackoverflow.com/questions/35124851/why-is-intset-lookup-ominn-w-and-not-o1/35139084#35139084", "title": "Why is IntSet lookup O(min(n,W)), and not O(1)?", "body": "<p>As @DerekElkins said in the comments, just reading a single unbounded-size integer takes a minimum of O(log a) time.  As a result, it's not possible in any sense to do better.</p>\n\n<p>If you don't have fixed-size primitives, essentially nothing is O(1).</p>\n"}], "owner": {"reputation": 774, "user_id": 2755648, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/633566630d4365c3c872d00efa730166?s=128&d=identicon&r=PG&f=1", "display_name": "sid-kap", "link": "https://stackoverflow.com/users/2755648/sid-kap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 35139084, "answer_count": 1, "score": 2, "last_activity_date": 1454357506, "creation_date": 1454310866, "last_edit_date": 1454313597, "question_id": 35124851, "link": "https://stackoverflow.com/questions/35124851/why-is-intset-lookup-ominn-w-and-not-o1", "title": "Why is IntSet lookup O(min(n,W)), and not O(1)?", "body": "<p>According to <a href=\"https://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-IntSet.html\" rel=\"nofollow\">https://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-IntSet.html</a>, the <code>member</code> function, which looks up whether an int is in the <code>IntSet</code>, takes O(min(n,W)) time, where <code>n</code> is the number of elements in the <code>IntSet</code>, and W = 32 on a 32-bit machine and 64 on a 64-bit machine.</p>\n\n<p>I imagine that in practice, W is probably less than n, so the function would be O(W) time.</p>\n\n<p>In practice (on a fixed architecture), O(W) is constant, and so this function probably runs very fast (or at least doesn't get slower as a function of n).</p>\n\n<p>However, in theory, this isn't that fast. If we allow integers a\u2081,...,a\u2099 of unbounded size (and let <code>W = log a</code>, where <code>a = max\u209a a\u209a</code>, then this function runs in O(log a). Why can't we use hashing and achieve O(1) amortized cost for this function?</p>\n\n<p>(Context: I'm working on an algorithms homework assignment, and for part of my pseudocode for a problem, I desire a data structure that can check if an integer is a member of my set in constant time, regardless of the number of integers in the set, or the size of the integers in the set. I tried looking up Haskell <code>Set</code>-like data structures for inspiration.)</p>\n"}, {"tags": ["haskell", "applicative", "gadt"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454308055, "post_id": 35123930, "comment_id": 57968612, "body": "I think I&#39;m <i>beginning</i> to understand the backwardsness: my notion of type-aligned sequence starts at the <i>end</i> of the composition chain, and moves towards the <i>beginning</i>. This (I guess?) makes the index applicatives wonky. But it makes other things prettier to look at. Hmmmm."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1454318783, "post_id": 35123930, "comment_id": 57973737, "body": "Why is the second <code>TAL</code> yucky? That&#39;s the definition <a href=\"https://hackage.haskell.org/package/type-aligned-0.9.6/docs/Data-TASequence-ConsList.html\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/agda/agda-stdlib/blob/master/src/Data/Star.agda\" rel=\"nofollow noreferrer\">here</a> too."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1454344462, "post_id": 35123930, "comment_id": 57991083, "body": "@Andr&#225;s Kov&#225;cs, it&#39;s not inherently bad, but it means that folding up the list you have to replace each <code>Cons</code> with <code>&gt;&gt;&gt;</code> rather than <code>.</code>. I&#39;m not actually sure which style ends up more convenient in the long run."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1454313201, "last_edit_date": 1454313201, "creation_date": 1454309058, "answer_id": 35124412, "question_id": 35123930, "link": "https://stackoverflow.com/questions/35123930/how-should-i-traverse-type-aligned-sequences/35124412#35124412", "title": "How should I traverse type-aligned sequences?", "body": "<p>I just figured out one way to do it: swap the type indices in the definition of <code>ttraverse</code>:</p>\n\n<pre><code>class (TAMappable t, TAFoldable t) =&gt; TATraversable t where\n  ttraverse :: IxApplicative m\n            =&gt; (forall x y . c x y -&gt; m y x (d x y))\n            -&gt; t c p q -&gt; m q p (t d p q)\n\nnewtype Consty d y x z = Consty { getConsty :: d x y }\ninstance Category d =&gt; IxApplicative (Consty d) where\n  iap (Consty x) (Consty y) = Consty (x . y)\n</code></pre>\n\n<p>Then things work out the way I was originally hoping. I don't know if this is actually a good idea, though.</p>\n\n<hr>\n\n<p>Fortunately, it seems that either way I do it, I can reverse, with an analogue of <code>Control.Applicative.Backwards.Backwards</code>!</p>\n\n<pre><code>newtype IxBackwards m i j a = IxBackwards {ixForwards :: m j i a}\n\ninstance IxFunctor f =&gt; IxFunctor (IxBackwards f) where\n  imap f (IxBackwards x) = IxBackwards (imap f x)\n\ninstance IxPointed f =&gt; IxPointed (IxBackwards f) where\n  ireturn = IxBackwards . ireturn\n\ninstance IxApplicative f =&gt; IxApplicative (IxBackwards f) where\n  iap (IxBackwards fs) (IxBackwards xs) =\n    IxBackwards $ imap (flip ($)) xs `iap` fs\n</code></pre>\n\n<p>The order of the indices in the type signature of <code>ttraverse</code> seems to determine the traversal order. Traversing <code>IxBackwards</code> will, if I'm not very confused, reverse that order:</p>\n\n<pre><code>traverseOpposite :: (IxApplicative m, TATraversable t) =&gt; (forall x y . c x y -&gt; m x y (d x y)) -&gt; t c p q -&gt; m p q (t d p q)\ntraverseOpposite f  = ixForwards . ttraverse (IxBackwards . f)\n</code></pre>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1454356829, "creation_date": 1454306599, "last_edit_date": 1495535635, "question_id": 35123930, "link": "https://stackoverflow.com/questions/35123930/how-should-i-traverse-type-aligned-sequences", "title": "How should I traverse type-aligned sequences?", "body": "<p>Last summer, I considered the notion of folding a type-aligned sequence, <a href=\"https://stackoverflow.com/questions/30985070/how-can-i-express-foldr-in-terms-of-foldmap-for-type-aligned-sequences\">asking here</a> how one might implement an analogue of <code>foldr</code> in terms of an analogue of <code>foldMap</code>. Joachim Breitner was able to do it with the help of a tricky newtype. Now I decided to think about the notion of <em>traversing</em> a type-aligned sequence. The first thought I had was the simple translation</p>\n\n<pre><code>class TATraversable t where\n  ttraverse :: Applicative f\n            =&gt; (forall x y . c x y -&gt; f (d x y))\n            -&gt; t c p q -&gt; f (t d p q)\n</code></pre>\n\n<p>which turns out to be basically the same as <code>mapMThrist</code> from the <code>thrist</code> package. Unfortunately, this doesn't seem to be strong enough to implement</p>\n\n<pre><code>tfoldMap :: Category d\n         =&gt; (forall x y . c x y -&gt; d x y)\n         -&gt; f c p q -&gt; d p q\n</code></pre>\n\n<p>Since the <code>Monoid</code> of <code>Foldable</code> is replaced by a <code>Category</code> for <code>TAFoldable</code>, the <code>Applicative</code> of <code>Traversable</code> has to be replaced by something stronger. I came up with the following, based on Atkey-style indexed applicative functors, but it feels a tad awkward, especially since the indices seem to like to end up backwards. Basically, I just threw types at the wall until some of them stuck. Is there some more principled/understandable approach?</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, RankNTypes,\n      GADTs, PolyKinds #-}\n\nmodule ITrav where\n\n--Not using this because it's not polykinded\n--import Data.Functor.Indexed\nimport Control.Category\nimport Prelude hiding (id, (.))\n</code></pre>\n\n<p>Polykinded versions of indexed Atkey-style functors. I don't actually need poly-kindedness for any of this code, but I think anyone actually <em>using</em> it will expect it to work with phantoms of all kinds. Besides, this gives me a good excuse to copy the definitions here for reference:</p>\n\n<pre><code>class IxFunctor f where\n  imap :: (a -&gt; b) -&gt; f j k a -&gt; f j k b\n\nclass IxFunctor m =&gt; IxPointed m where\n  ireturn :: a -&gt; m i i a\n\nclass IxPointed m =&gt; IxApplicative m where\n  iap :: m i j (a -&gt; b) -&gt; m j k a -&gt; m i k b\n</code></pre>\n\n<p>A notion of mappability for type-aligned sequences, based on a method in <code>type-aligned</code>:</p>\n\n<pre><code>class TAMappable t where\n  tmap :: (forall x y . c x y -&gt; d x y)\n       -&gt; t c p q -&gt; t d p q\n</code></pre>\n\n<p>My notion of foldability for type-aligned sequences: </p>\n\n<pre><code>class TAFoldable f where\n  tfoldMap :: Category d\n           =&gt; (forall x y . c x y -&gt; d x y)\n           -&gt; f c p q -&gt; d p q\n</code></pre>\n\n<p>My best-so-far notion of traversability for type-aligned sequences:</p>\n\n<pre><code>class (TAMappable t, TAFoldable t) =&gt; TATraversable t where\n  ttraverse :: IxApplicative m\n            =&gt; (forall x y . c x y -&gt; m x y (d x y))\n            -&gt; t c p q -&gt; m p q (t d p q)\n</code></pre>\n\n<p>Machinery to map by traversing:</p>\n\n<pre><code>newtype Identity2 x y z = Identity2 {runIdentity2 :: z}\n\ninstance IxFunctor Identity2 where\n  imap f (Identity2 x) = Identity2 (f x)\n\ninstance IxPointed Identity2 where\n  ireturn = Identity2\n\ninstance IxApplicative Identity2 where\n  iap (Identity2 f) (Identity2 x) = Identity2 (f x)\n\ntmapDefault :: TATraversable t =&gt; (forall x y . c x y -&gt; d x y) -&gt; t c p q -&gt; t d p q\ntmapDefault f = runIdentity2 . ttraverse (Identity2 . f)\n</code></pre>\n\n<p>Machinery to fold by traversing:</p>\n\n<pre><code>newtype Consty d x y z = Consty { getConsty :: d x y }\ninstance IxFunctor (Consty d) where\n  imap _ (Consty x) = Consty x\ninstance Category d =&gt; IxPointed (Consty d) where\n  ireturn _ = Consty id\ninstance Category d =&gt; IxApplicative (Consty d) where\n  iap (Consty x) (Consty y) = Consty (y . x)\n\ntfoldMapDefault :: (Category d, TATraversable t) =&gt; (forall x y . c x y -&gt; d x y) -&gt; t c p q -&gt; d p q\ntfoldMapDefault f = getConsty . ttraverse (Consty . f)\n</code></pre>\n\n<p>Proof that at least the simplest type-aligned sequence admits a (somewhat weird) <code>TATraversable</code> instance.</p>\n\n<pre><code>infixr 5 :::\ndata TAL :: (k -&gt; k -&gt; *) -&gt; k -&gt; k -&gt; * where\n  Nil :: TAL c x x\n  (:::) :: c y z -&gt; TAL c x y -&gt; TAL c x z\n\ninstance TAMappable TAL where\n  tmap = tmapDefault\n\ninstance TAFoldable TAL where\n  tfoldMap = tfoldMapDefault\n\ninstance TATraversable TAL where\n  ttraverse _ Nil = ireturn Nil\n  ttraverse f (x ::: xs) = imap (flip (:::)) (ttraverse f xs) `iap` f x\n</code></pre>\n\n<hr>\n\n<p>I think I've found a hint to the source of backwardsness. My type-aligned list starts with the <em>end</em> of the composition chain, which makes it fight with the <code>IxApplicative</code> index order. One option is to replace the definition of <code>TAL</code> above with</p>\n\n<pre><code>data TAL :: (k -&gt; k -&gt; *) -&gt; k -&gt; k -&gt; * where\n  Nil :: TAL c x x\n  (:::) :: c x y -&gt; TAL c y z -&gt; TAL c x z\n</code></pre>\n\n<p>which makes the obvious instance work:</p>\n\n<pre><code>instance TATraversable TAL where\n  ttraverse _ Nil = ireturn Nil\n  ttraverse f (x ::: xs) = imap (:::) (f x) `iap` ttraverse f xs\n</code></pre>\n\n<p>But this is kind of yucky to look at, to be honest.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1454295442, "creation_date": 1454295442, "answer_id": 35122392, "question_id": 35122275, "link": "https://stackoverflow.com/questions/35122275/way-on-generating-a-truth-table-for-arbitrary-number-of-variables/35122392#35122392", "title": "Way on generating a truth table for arbitrary number of variables", "body": "<p>How do you represent truth tables for variables of type <code>a</code>?</p>\n\n<pre><code>type TruthTable a = [(a, Bool)]\n\ntruthTables :: [a] -&gt; [TruthTable a]\n</code></pre>\n\n<p>What is your truth table for <strong>no</strong> variables? There is only one: the one that contains no variable assignments.</p>\n\n<pre><code>truthTables [] = [[]]\n</code></pre>\n\n<p>How do you construct all possible truth tables for variables <code>v:vs</code>, given the truth tables for <code>vs</code>? You take every possible truth table for <code>vs</code>, and every possible assignment for <code>v</code>, and combine them:</p>\n\n<pre><code>truthTables (v:vs) = [(v, b):others | b &lt;- [True, False], others &lt;- truthTables vs]\n</code></pre>\n\n<p>We could have also written it using the <code>Monad</code> instance of <code>[]</code>:</p>\n\n<pre><code>truthTables [] = return []\ntruthTables (v:vs) = do\n  this &lt;- [True, False]\n  them &lt;- truthTables vs\n  return (this:them)\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5857949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e83895d561b94f0c697aab40e0f9658c?s=128&d=identicon&r=PG&f=1", "display_name": "karambit", "link": "https://stackoverflow.com/users/5857949/karambit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "closed_date": 1454295921, "accepted_answer_id": 35122392, "answer_count": 1, "score": 1, "last_activity_date": 1454295442, "creation_date": 1454294475, "last_edit_date": 1454295113, "question_id": 35122275, "link": "https://stackoverflow.com/questions/35122275/way-on-generating-a-truth-table-for-arbitrary-number-of-variables", "closed_reason": "Duplicate", "title": "Way on generating a truth table for arbitrary number of variables", "body": "<p>How does one generate a truth table of all possible true/false combinations for an input like <code>[\"a\", \"b\", \"c\"]</code>.</p>\n\n<p>I find it really hard to think about it recursively!</p>\n\n<p>For example:\nInput: <code>[\"a\", \"b\"]</code>\nOutput: </p>\n\n<pre><code>        [ [(\"a\",True), (\"b\",True)], \n          [(\"a\",True), (\"b\",False)],\n          [(\"a\",False), (\"b\",True)],\n          [(\"a\",False), (\"b\",False)] ]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 2, "creation_date": 1454290942, "post_id": 35121746, "comment_id": 57964236, "body": "Paste any and all errors you got."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454292698, "post_id": 35121746, "comment_id": 57964635, "body": "It can depend a bit on how you are compiling and running your program, as well; make sure you include a few details on that."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1454299169, "post_id": 35121746, "comment_id": 57966144, "body": "If using the relative path doesn&#39;t work, but the absolute path does... chances are the program is being started in a different directory than you think it is. Note that &quot;/crafting/...&quot; is not a relative directory - the leading forward slash is interpreted as the root directory of unix-like file systems, even on windows."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1454312580, "post_id": 35121746, "comment_id": 57970419, "body": "you are mixing forward and back slashes, plus you can&#39;t tell between relative and asbolute paths. seems to have nothing to do with Haskell."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1454312969, "post_id": 35121746, "comment_id": 57970619, "body": "if in doubt try <code>.&#47;crafting&#47;...</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454314805, "post_id": 35121746, "comment_id": 57971551, "body": "@user2407038, I never heard of the forward slash meaning that on Windows. Is that true in general, or only the GHC libraries?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454317971, "post_id": 35121746, "comment_id": 57973224, "body": "@dfeuer Well I guess what I meant was, it is interpreted as the &quot;analog&quot; of the unix root on windows, which is the root of the current drive. There is no &quot;global&quot; root on Windows as far as I know, not even a very well hidden one as things tend to be on Windows, except perhaps at the kernel level. So if you start this program in any directory on the C: drive then <code>&#47;crafting</code> refers to <code>C:&#47;crafting</code>."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 0, "last_activity_date": 1457062696, "creation_date": 1457062696, "answer_id": 35787520, "question_id": 35121746, "link": "https://stackoverflow.com/questions/35121746/how-to-open-a-subdirectory-with-haskell/35787520#35787520", "title": "How to open a subdirectory with haskell", "body": "<p>Try <code>(\"crafting\\\\\" ++ a ++\".txt\")</code>.</p>\n\n<p>But more generally, you should not be manipulating filepaths with string functions. The <a href=\"https://hackage.haskell.org/package/filepath-1.4.1.0/docs/System-FilePath-Windows.html\" rel=\"nofollow\">FilePath</a> library is a much better approach.</p>\n"}], "owner": {"reputation": 68, "user_id": 5853799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V3Agb.jpg?s=128&g=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5853799/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 35787520, "answer_count": 1, "score": 0, "last_activity_date": 1457062696, "creation_date": 1454290196, "last_edit_date": 1454312486, "question_id": 35121746, "link": "https://stackoverflow.com/questions/35121746/how-to-open-a-subdirectory-with-haskell", "title": "How to open a subdirectory with haskell", "body": "<p>How can I open a file in a subDirectory?\nI'm trying to build a crafting guide to a game, but for that I need to open the file on a sub Directory (In this case \\crafting). I tried doing this, but it doesn't work:</p>\n\n<pre><code>main = do \n  a &lt;- getLine\n  b &lt;- readFile (\"/crafting/\" ++ a ++\".txt\")\n  putStrLn b\n</code></pre>\n\n<p>The error I got is that it doen'st find the file, but it is there.\nWhen I use the full directory it works:</p>\n\n<pre><code>main = do \n a &lt;- getLine\n b &lt;- readFile (\"C:\\\\Users\\\\Utilizador\\\\Desktop\\\\Ash's Games\\\\Haskell\\\\Mega Survival\\\\crafting\\\\\" ++ a ++\".txt\")\n putStrLn b\n</code></pre>\n\n<p>But it works when it is like this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1454285387, "post_id": 35121079, "comment_id": 57962906, "body": "Why do you want to avoid the orphan instance. I don&#39;t think you can avoid it. It is by definition a class instance in a module that does not contain the type it is instanciated with"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1454285667, "post_id": 35121079, "comment_id": 57962962, "body": "You could probably have some cpp flags that activate the instance optionally in package A"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454290518, "post_id": 35121079, "comment_id": 57964127, "body": "The horrifying nature of orphan instances is the primary reason that <code>profunctors</code>, and therefore <code>lens</code> have so many dependencies. There is no way at present for a module or package to specifically bless an instance in another module or package. Edward Kmett has a package notion and I have a module notion for how such blessing could work, but apparently there are complications with such things as the behemoth backpack project, which I don&#39;t understand myself."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454290724, "post_id": 35121079, "comment_id": 57964169, "body": "Orphan instances lead to really <i>nasty</i> problems where incoherence can go undetected, and where small changes can cause code not to compile anymore. I could be wrong, but I believe undetected incoherence can even lead to type safety failures, segmentation faults, and similar fun."}], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 3, "last_activity_date": 1454285762, "creation_date": 1454285762, "answer_id": 35121207, "question_id": 35121079, "link": "https://stackoverflow.com/questions/35121079/writing-an-instance-without-forcing-a-dependency/35121207#35121207", "title": "Writing an instance without forcing a dependency", "body": "<p>Your options are to have one package depend on the other; create a third package with just the types and have both packages depend on that; create a third package that depends on both packages and has orphan instances.</p>\n\n<p>The first and the third option are the only ones available if you don't control both packages (or can't convince the developer of the one you don't control to make the needed changes).</p>\n\n<p>The third option requires orphan instances, but is slightly less bad than normal orphan instances, because it would be the \"authoritative\" choice.  The third option is <a href=\"https://hackage.haskell.org/packages/search?terms=instances\" rel=\"nofollow\">fairly common</a>.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1454285762, "creation_date": 1454284790, "question_id": 35121079, "link": "https://stackoverflow.com/questions/35121079/writing-an-instance-without-forcing-a-dependency", "title": "Writing an instance without forcing a dependency", "body": "<p>Is there a way to write an instance without forcing a dependency. Lets say I'm creating package <code>B</code>, which doesn't depend on package <code>A</code>, nor does package <code>A</code> depend on package <code>B</code>. However, package <code>B</code> contains data type, and package <code>A</code> a class, of which it would be useful to have <code>B</code> as an instance of <code>A</code>.</p>\n\n<p>But other than that type/instance relation, <code>A</code> and <code>B</code> are completely independent, and it's perfectly reasonable to use one without the other.</p>\n\n<p>Is there a way to set up a package and define such an instance without using orphan instances?</p>\n"}, {"tags": ["haskell", "boilerplate", "dependent-type", "idris", "proof-of-correctness"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1454517067, "post_id": 35121047, "comment_id": 58081988, "body": "Many of the old Haskell idioms don&#39;t change in dependently-typed systems. &quot;Make illegal states unrepresentable&quot; holds at the type-level too: I don&#39;t think you should even be able to construct those impossible types. I&#39;d probably structure this example as (something roughly like) a type of fruits that can make wine <code>data WineFruit = Grape | Apple</code> and other fruits <code>data Fruit = WineFruit WineFruit | Banana | Orange | Lemon</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1455569666, "post_id": 35121047, "comment_id": 58538371, "body": "@BenjaminHodgson, that approach starts to fall apart when you want to add <code>PieFruit</code>, <code>SaladFruit</code>, <code>WeaponFruit</code>, etc."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 2, "creation_date": 1458372277, "post_id": 35121047, "comment_id": 59841559, "body": "Given that you&#39;re in idris, why are you defining a datatype for <code>WineStock</code>? Can&#39;t you just define <code>isWineStock</code> as a value level function and use it in proofs where appropriate?"}], "answers": [{"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 4, "last_activity_date": 1498918374, "creation_date": 1498918374, "answer_id": 44861876, "question_id": 35121047, "link": "https://stackoverflow.com/questions/35121047/any-tricks-to-get-rid-of-boilerplate-when-constructing-proofs-of-absurd-predicat/44861876#44861876", "title": "Any tricks to get rid of boilerplate when constructing proofs of absurd predicate on enums?", "body": "<p>@slcv is right: using a function that computes whether a fruit satisfies a property or not rather than building various inductive predicates will allow you to get rid of this overhead.</p>\n\n<p>Here is the minimal setup:</p>\n\n<pre><code>data Is : (p : a -&gt; Bool) -&gt; a -&gt; Type where\n  Indeed : p x = True -&gt; Is p x\n\nisnt : {auto eqF : p a = False} -&gt; Is p a -&gt; b\nisnt {eqF} (Indeed eqT) = case trans (sym eqF) eqT of\n                            Refl impossible\n</code></pre>\n\n<p><code>Is p x</code> ensures that the property <code>p</code> holds of the element <code>x</code> (I used an inductive type rather than a type alias so that Idris doesn't unfold it in the context of a hole; it's easier to read this way).</p>\n\n<p><code>isnt prf</code> dismisses the phoney proof <code>prf</code> whenever the typechecker is able to generate a proof that <code>p a = False</code> automatically (via <code>Refl</code> or an assumption in the context).</p>\n\n<p>Once you have these, you can start defining your properties by only enumerating the positive cases and adding a catchall</p>\n\n<pre><code>wineFruit : Fruit -&gt; Bool\nwineFruit Grape = True\nwineFruit Apple = True\nwineFruit _     = False\n\nweaponFruit : Fruit -&gt; Bool\nweaponFruit Apple  = True\nweaponFruit Orange = True\nweaponFruit Lemon  = True\nweaponFruit _      = False\n</code></pre>\n\n<p>You can define your original predicates as type aliases calling <code>Is</code> with the appropriate decision function:</p>\n\n<pre><code>WineStock : Fruit -&gt; Type\nWineStock = Is wineFruit\n</code></pre>\n\n<p>And, sure enough, <code>isnt</code> allows you to dismiss the impossible cases:</p>\n\n<pre><code>dismiss : WineStock Orange -&gt; Void\ndismiss = isnt\n</code></pre>\n"}], "owner": {"reputation": 12367, "user_id": 531179, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36b013eaaf1270f35e5157a5ea00ac22?s=128&d=identicon&r=PG", "display_name": "ulidtko", "link": "https://stackoverflow.com/users/531179/ulidtko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 2, "accepted_answer_id": 44861876, "answer_count": 1, "score": 11, "last_activity_date": 1499166327, "creation_date": 1454284607, "last_edit_date": 1499166327, "question_id": 35121047, "link": "https://stackoverflow.com/questions/35121047/any-tricks-to-get-rid-of-boilerplate-when-constructing-proofs-of-absurd-predicat", "title": "Any tricks to get rid of boilerplate when constructing proofs of absurd predicate on enums?", "body": "<p>Let's say I have</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Fruit = Apple | Banana | Grape | Orange | Lemon | {- many others -}\n</code></pre>\n\n<p>and a predicate on that type,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data WineStock : Fruit -&gt; Type where\n    CanonicalWine : WineStock Grape\n    CiderIsWineToo : WineStock Apple\n</code></pre>\n\n<p>which doesn't hold for <code>Banana</code>, <code>Orange</code>, <code>Lemon</code> and others.</p>\n\n<p>It <a href=\"http://www.thenewsh.com/~newsham/formal/curryhoward/\" rel=\"nofollow noreferrer\">can be said</a> that this defines <code>WineStock</code> as a predicate on <code>Fruit</code>; <code>WineStock Grape</code> is <em>true</em> (since we can construct a value/proof of that type: <code>CanonicalWine</code>) as well as <code>WineStock Apple</code>, but <code>WineStock Banana</code> is <em>false</em>, since that type is not inhabited by any values/proofs.</p>\n\n<hr>\n\n<p>Then, how can I go about using effectively <code>Not (WineStock Banana)</code>, <code>Not (WineStock Lemon)</code>, etc? It seems that for each <code>Fruit</code> constructor besides <code>Grape</code> and <code>Apple</code>, I can't help but have to code up a case split over <code>WineStock</code>, somewhere, full of <code>impossible</code>s:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Uninhabited (WineStock Banana) where\n    uninhabited CanonicalWine impossible\n    uninhabited CiderIsWineToo impossible\n\ninstance Uninhabited (WineStock Lemon) where\n    uninhabited CanonicalWine impossible\n    uninhabited CiderIsWineToo impossible\n\ninstance Uninhabited (WineStock Orange) where\n    uninhabited CanonicalWine impossible\n    uninhabited CiderIsWineToo impossible\n</code></pre>\n\n<p>Note that:</p>\n\n<ul>\n<li>the code is repetitive,</li>\n<li>LoC will explode when the predicate definition grows, gaining more constructors. Just imagine the <code>Not (Sweet Lemon)</code> proof, assuming there're many sweet alternatives in the <code>Fruit</code> definition.</li>\n</ul>\n\n<p>So, this way doesn't quite seem satisfying, almost <em>impractical</em>.</p>\n\n<p>Are there more elegant approaches?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 0, "creation_date": 1454283292, "post_id": 35120828, "comment_id": 57962379, "body": "&quot;What you need is not a truth table&quot; - why it is not a truth table?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1454283536, "post_id": 35120828, "comment_id": 57962449, "body": "See also: <code>mapM (\\v -&gt; [(v, True), (v, False)]) &quot;xyz&quot;</code>."}, {"owner": {"reputation": 5190, "user_id": 353268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/68f14024956c4a67bd92f44a15505e7c?s=128&d=identicon&r=PG", "display_name": "mariosangiorgio", "link": "https://stackoverflow.com/users/353268/mariosangiorgio"}, "reply_to_user": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 2, "creation_date": 1454283662, "post_id": 35120828, "comment_id": 57962481, "body": "@lisyarus: the OP simply wants to generate all the possible true/false combinations. A truth table has an additional column holding the values of the function it represents corresponding to the input values in that row."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 0, "creation_date": 1454283825, "post_id": 35120828, "comment_id": 57962511, "body": "@mariosangiorgio Totally forgot what a truth table actually is. You convinced me, thanks :)"}], "tags": [], "owner": {"reputation": 5190, "user_id": 353268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/68f14024956c4a67bd92f44a15505e7c?s=128&d=identicon&r=PG", "display_name": "mariosangiorgio", "link": "https://stackoverflow.com/users/353268/mariosangiorgio"}, "is_accepted": false, "score": 4, "last_activity_date": 1454282916, "creation_date": 1454282916, "answer_id": 35120828, "question_id": 35120766, "link": "https://stackoverflow.com/questions/35120766/generating-a-truth-table/35120828#35120828", "title": "Generating a Truth Table", "body": "<p>What you need is not a truth table but rather a cartesian product.\nYou can obtain what you want using list comprehension: <code>[(x,y,z) | x &lt;- [True, False], y &lt;- [True,False], z &lt;- [True,False]]</code></p>\n\n<p>If you want to keep variable names you can use tuples: <code>[(x,y,z) | x &lt;- [(\"X\", True), (\"X\", False)], y &lt;- [(\"Y\", True), (\"Y\", False)], z &lt;- [(\"Z\", True),(\"Z\", False)]]</code></p>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 5857949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e83895d561b94f0c697aab40e0f9658c?s=128&d=identicon&r=PG&f=1", "display_name": "karambit", "link": "https://stackoverflow.com/users/5857949/karambit"}, "edited": false, "score": 0, "creation_date": 1454289519, "post_id": 35120910, "comment_id": 57963895, "body": "could you explain the last line? I am a newbie at Haskell. Also what is the : in ((x,True):) ? I thought that is used to concat results but there is nothing after it? Also what is the map for?"}, {"owner": {"reputation": 11669, "user_id": 76123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c933fbb8685a083234fe385df8e9025f?s=128&d=identicon&r=PG", "display_name": "Daniel Pratt", "link": "https://stackoverflow.com/users/76123/daniel-pratt"}, "reply_to_user": {"reputation": 165, "user_id": 5857949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e83895d561b94f0c697aab40e0f9658c?s=128&d=identicon&r=PG&f=1", "display_name": "karambit", "link": "https://stackoverflow.com/users/5857949/karambit"}, "edited": false, "score": 2, "creation_date": 1454293553, "post_id": 35120910, "comment_id": 57964843, "body": "@karambit You can learn about the syntax in the expression <code>((x, True):)</code> <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">here</a>. Basically, you can omit either the left or right input of an operator and the result is a function of the remaining input. Actually, you can omit both (e.g. <code>(:)</code>), which allows you to use the operator as you would a function."}], "tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 3, "last_activity_date": 1454283571, "creation_date": 1454283571, "answer_id": 35120910, "question_id": 35120766, "link": "https://stackoverflow.com/questions/35120766/generating-a-truth-table/35120910#35120910", "title": "Generating a Truth Table", "body": "<p>Let the recursion be with you. If you have a truth table for <code>n</code> variables, you can obtain one for <code>n+1</code> variables (with added variable <code>X</code>) by appending first <code>(X, True)</code> to the table for <code>n</code> variables, and then appending <code>(X, False)</code>.</p>\n\n<pre><code>truthTable :: [String] -&gt; [[(String, Bool)]]\ntruthTable [] = [[]]\ntruthTable (x:xs) = (map ((x,True):) ts) ++ (map ((x,False):) ts) where ts = truthTable xs\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 5857949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e83895d561b94f0c697aab40e0f9658c?s=128&d=identicon&r=PG&f=1", "display_name": "karambit", "link": "https://stackoverflow.com/users/5857949/karambit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1454292597, "creation_date": 1454282451, "last_edit_date": 1454292597, "question_id": 35120766, "link": "https://stackoverflow.com/questions/35120766/generating-a-truth-table", "title": "Generating a Truth Table", "body": "<p>If I have some values A B C, is is possible to generate a list of all their possible truth values:\nthe input is [\"X\", \"Y\", \"Z\"]\ne.g. the list contains 8 lists (rows of table)</p>\n\n<pre><code>[ [ (\"X\",True), (\"Y\",True), (\"Z\", True) ],\n[ (\"X\",True), (\"Y\",True), (\"Z\", False) ],.... ]\n</code></pre>\n\n<p>Are there any hints on how to do this?</p>\n\n<p>I would like to generate a truth table for an arbitrary number of variables.</p>\n"}, {"tags": ["haskell", "tuples", "intersection"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1454280040, "post_id": 35120348, "comment_id": 57961486, "body": "See <a href=\"https://hackage.haskell.org/package/multiset-0.3.2/docs/Data-MultiSet.html#v:intersection\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/multiset-0.3.2/docs/&hellip;</a>"}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 2, "creation_date": 1454280744, "post_id": 35120348, "comment_id": 57961685, "body": "That <code>Eq a</code> constraints greatly limits your efficient solutions. If you could go with <code>Ord a</code>, then you could consider one of the <a href=\"http://hayoo.fh-wedel.de/?query=intersection\" rel=\"nofollow noreferrer\"><code>intersection</code></a> functions."}], "answers": [{"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 2, "last_activity_date": 1454280144, "creation_date": 1454280144, "answer_id": 35120462, "question_id": 35120348, "link": "https://stackoverflow.com/questions/35120348/best-way-to-intersect-multi-sets-haskell/35120462#35120462", "title": "best way to intersect multi sets haskell", "body": "<p>Look at something like this:</p>\n\n<pre><code>&gt; [(n,min x y)|(n,x) &lt;- [('a',3),('b',5),('c',1)], (m,y) &lt;- [('d',5),('b',2)], n==m]\n[('b',2)]\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3548437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3b40d2e910e9ef796071d4f39ace62?s=128&d=identicon&r=PG&f=1", "display_name": "simon paul", "link": "https://stackoverflow.com/users/3548437/simon-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1454280144, "creation_date": 1454279468, "question_id": 35120348, "link": "https://stackoverflow.com/questions/35120348/best-way-to-intersect-multi-sets-haskell", "title": "best way to intersect multi sets haskell", "body": "<pre><code>type MSet a = [(a , Int)]\n</code></pre>\n\n<p>what is the best way to do the intersection of multi sets in haskell language? ty</p>\n\n<pre><code>intersect :: Eq a =&gt; MSet a -&gt; MSet a -&gt; MSet a\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>[('a',3),('b',5),('c',1)] [('d',5),('b',2)]\n&gt;[('b',2)]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454279029, "post_id": 35119428, "comment_id": 57961135, "body": "haoformayor answers this question perfectly, but I figured I should mention that <code>Enum</code> is, at its heart, a class that tries to do at least three different things, and doesn&#39;t do any of them well. Look not to <code>Enum</code> for good class design!"}], "answers": [{"comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "edited": false, "score": 0, "creation_date": 1454275281, "post_id": 35119484, "comment_id": 57959850, "body": "@haskellHQ oops. fixed."}, {"owner": {"reputation": 549, "user_id": 7826146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a95fdc5b2dadeccfd1047ab1dc58c8b5?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/7826146/vladimir"}, "edited": false, "score": 0, "creation_date": 1548657687, "post_id": 35119484, "comment_id": 95604380, "body": "<b>but</b> <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1310006.3.4\" rel=\"nofollow noreferrer\">Haskell Report (6.3.4 The Enum Class)</a> says: <code>enumFrom</code> and <code>enumFromThen</code> should be defined with an implicit bound, thus...  <i>smth. wrong?</i>"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 8, "last_activity_date": 1454275241, "last_edit_date": 1454275241, "creation_date": 1454274511, "answer_id": 35119484, "question_id": 35119428, "link": "https://stackoverflow.com/questions/35119428/how-can-integer-have-an-instance-of-enum-toenum-and-fromenum-only-use-int-whic/35119484#35119484", "title": "How can Integer have an instance of Enum? toEnum and fromEnum only use Int, which is limited", "body": "<p><code>enumFromTo</code> for <code>Integer</code> is not defined in terms of <code>toEnum</code> and <code>fromEnum</code>, which indeed would cause a loss in representation as you mentioned. You can read the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Enum.html#line-655\">implementation here</a>, which calls <code>enumDeltaToInteger :: Integer -&gt; Integer -&gt; Integer -&gt; [Integer]</code>.</p>\n\n<pre><code>instance  Enum Integer  where\n    succ x               = x + 1\n    pred x               = x - 1\n    toEnum (I# n)        = smallInteger n\n    fromEnum n           = I# (integerToInt n)\n\n    {-# INLINE enumFrom #-}\n    {-# INLINE enumFromThen #-}\n    {-# INLINE enumFromTo #-}\n    {-# INLINE enumFromThenTo #-}\n    enumFrom x             = enumDeltaInteger   x 1\n    enumFromThen x y       = enumDeltaInteger   x (y-x)\n    enumFromTo x lim       = enumDeltaToInteger x 1     lim\n    enumFromThenTo x y lim = enumDeltaToInteger x (y-x) lim\n</code></pre>\n\n\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 0, "accepted_answer_id": 35119484, "answer_count": 1, "score": 5, "last_activity_date": 1454275306, "creation_date": 1454274121, "last_edit_date": 1454274844, "question_id": 35119428, "link": "https://stackoverflow.com/questions/35119428/how-can-integer-have-an-instance-of-enum-toenum-and-fromenum-only-use-int-whic", "title": "How can Integer have an instance of Enum? toEnum and fromEnum only use Int, which is limited", "body": "<p>I don't fully understand why this works just fine:</p>\n\n<pre><code>[9223372036854775809..9223372036854775815] :: [Integer]\n</code></pre>\n\n<p>Those are integers that are larger than <code>maxBound :: Int</code>. Yet these are the type signatures of the two crucial <code>Enum</code> functions:</p>\n\n<pre><code>toEnum :: Int -&gt; a\nfromEnum :: a -&gt; Int\n</code></pre>\n\n<p>As you can see, they have <code>Int</code>, which is bounded.</p>\n\n<p>So why did the above work?</p>\n\n<p><strong>Clarification:</strong></p>\n\n<p>The point of my question is this: Isn't <code>enumFromTo</code> defined in terms of <code>toEnum</code> and <code>fromEnum</code>? And since those two work only on regular <code>Int</code>s, how can <code>enumFromTo</code> (for which <code>..</code> is a syntactic sugar) work for <code>Integer</code>s?</p>\n"}, {"tags": ["haskell", "gtk", "gtk2hs"], "comments": [{"owner": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "edited": false, "score": 0, "creation_date": 1454364767, "post_id": 35119354, "comment_id": 58003167, "body": "Following <a href=\"http://stackoverflow.com/questions/6617816/two-gtk-textview-widgets-with-shared-scrollbar\" title=\"two gtk textview widgets with shared scrollbar\">stackoverflow.com/questions/6617816/&hellip;</a>, I tried synchronizing a hidden scroll window around the text view with an outer scroll window around the hbox (which is a discouraged ugly ugly ugly hack), and it sometimes crashes.  Nevertheless, I fear the resulting UI might be a bit unnatural.  Would you mind sharing a bit more about the UI problem you&#39;re trying to solve?"}, {"owner": {"reputation": 133, "user_id": 3929929, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b9dc71c59f432d1d79d88006c1bf2b40?s=128&d=identicon&r=PG&f=1", "display_name": "jorexe", "link": "https://stackoverflow.com/users/3929929/jorexe"}, "reply_to_user": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "edited": false, "score": 0, "creation_date": 1454370543, "post_id": 35119354, "comment_id": 58005504, "body": "Yes, i have the textView in wich i have code, and a table on the leftside in wich appears buttons to fold the code functions in a single line. I don&#39;t know if there are a better way to do this with gtk. Here is a <a href=\"http://codepad.org/RRUjS0wc\" rel=\"nofollow noreferrer\">link</a> to my code."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1454536294, "post_id": 35119354, "comment_id": 58094064, "body": "I&#39;m confused. Can you mock up some screenshots showing what you want?"}, {"owner": {"reputation": 133, "user_id": 3929929, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b9dc71c59f432d1d79d88006c1bf2b40?s=128&d=identicon&r=PG&f=1", "display_name": "jorexe", "link": "https://stackoverflow.com/users/3929929/jorexe"}, "edited": false, "score": 0, "creation_date": 1454539360, "post_id": 35119354, "comment_id": 58095566, "body": "Yes. <a href=\"http://imgur.com/PC95FiQ\" rel=\"nofollow noreferrer\">Image</a> . I need to scroll those buttons when the textview scrolls. I can&#39;t find any method, i&#39;m trying to use moveCursor with textIterGetLine, but i only get the previous line.. also i can&#39;t know wich lines are visible on screen.."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1455466767, "post_id": 35119354, "comment_id": 58491823, "body": "Oh, you&#39;re trying to do code folding? Look into gtksourceview instead; it was specifically designed for source code editing."}, {"owner": {"reputation": 133, "user_id": 3929929, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b9dc71c59f432d1d79d88006c1bf2b40?s=128&d=identicon&r=PG&f=1", "display_name": "jorexe", "link": "https://stackoverflow.com/users/3929929/jorexe"}, "edited": false, "score": 0, "creation_date": 1455490400, "post_id": 35119354, "comment_id": 58500249, "body": "Thanks you! I will check it"}], "owner": {"reputation": 133, "user_id": 3929929, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b9dc71c59f432d1d79d88006c1bf2b40?s=128&d=identicon&r=PG&f=1", "display_name": "jorexe", "link": "https://stackoverflow.com/users/3929929/jorexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454368796, "creation_date": 1454273724, "last_edit_date": 1454368796, "question_id": 35119354, "link": "https://stackoverflow.com/questions/35119354/scroll-on-textview-and-table-haskell-gtk", "title": "Scroll on TextView and Table - Haskell Gtk", "body": "<p>i'm working on a gtk proyect using haskell. I have a table and a textview in an horizontalBox, and i need to scroll this table at the same time as the textview. I've tried some combinations but i couldn't do it.</p>\n\n<p>This is mi code with the scrollingWindow working only for the textView.</p>\n\n<pre><code>vb &lt;- vBoxNew False 0\ncontainerAdd window vb\n\nboxPackStart vb toolbar PackNatural 2\nhseparator &lt;- hSeparatorNew\nboxPackStart vb hseparator PackNatural 2\n\nhorizontalBox &lt;- hBoxNew False 5\nsw &lt;- scrolledWindowNew Nothing Nothing\ncontainerAdd vb horizontalBox\n\n\ntable&lt;- tableNew totalRows 1 True\ntableGetColSpacing table 0\nwidgetSetSizeRequest table 50 675\ncontainerAdd horizontalBox table\n\ntextview &lt;- textViewNew \ntextViewSetWrapMode textview WrapChar\nwidgetSetSizeRequest textview 700 400\n\ncontainerAdd sw textview\ncontainerAdd horizontalBox sw\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454270611, "post_id": 35118659, "comment_id": 57957919, "body": "Well, what went wrong when you tried adding a parameter to <code>perm</code>?"}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1454270968, "post_id": 35118659, "comment_id": 57958062, "body": "Try writing <code>perm k list</code> by first calling <code>perm (k - 1) list</code>."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "edited": false, "score": 0, "creation_date": 1454273319, "post_id": 35119245, "comment_id": 57959111, "body": "Yes, it definitely helps to achieve this task, however I am learning and would like to know how I can modify the existing code to produce the same result.  Using an already defined function is quite easy, but won&#39;t help me understand the problem more deeply. Anyway, thanks!"}, {"owner": {"reputation": 3430, "user_id": 2538771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ad4af42f7cff8698951a7befb26f0f?s=128&d=identicon&r=PG", "display_name": "Alexey Shmalko", "link": "https://stackoverflow.com/users/2538771/alexey-shmalko"}, "edited": false, "score": 3, "creation_date": 1454279908, "post_id": 35119245, "comment_id": 57961449, "body": "<code>replicateM</code> produces all possible variations, not permutations."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 3430, "user_id": 2538771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ad4af42f7cff8698951a7befb26f0f?s=128&d=identicon&r=PG", "display_name": "Alexey Shmalko", "link": "https://stackoverflow.com/users/2538771/alexey-shmalko"}, "edited": false, "score": 1, "creation_date": 1454307095, "post_id": 35119245, "comment_id": 57968273, "body": "@AlexeyShmalko Terminology aside, doesn&#39;t it fit the requirements described in the OP?"}, {"owner": {"reputation": 3430, "user_id": 2538771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ad4af42f7cff8698951a7befb26f0f?s=128&d=identicon&r=PG", "display_name": "Alexey Shmalko", "link": "https://stackoverflow.com/users/2538771/alexey-shmalko"}, "edited": false, "score": 1, "creation_date": 1454325743, "post_id": 35119245, "comment_id": 57978256, "body": "It doesn&#39;t. It generates different answer."}, {"owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "edited": false, "score": 1, "creation_date": 1454417040, "post_id": 35119245, "comment_id": 58025899, "body": "ReplicateM n produces a &quot;cartesian product&quot; X^n where X is a certain set.  It&#39;s true that it&#39;s not permutation. But the OP is not really clear about that in his question. The output [1,2,3], [9,8,7], [0,6,8] can hardly be considered as a permutation."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1454273097, "creation_date": 1454273097, "answer_id": 35119245, "question_id": 35118659, "link": "https://stackoverflow.com/questions/35118659/haskell-permutations-with-the-length-of-the-output-list/35119245#35119245", "title": "Haskell permutations with the length of the output list", "body": "<p>Will <code>replicateM</code> do what you need?</p>\n\n<pre><code>Prelude Control.Monad&gt; take 10 $ replicateM 3 [0..9]\n[[0,0,0],[0,0,1],[0,0,2],[0,0,3],[0,0,4],[0,0,5],[0,0,6],[0,0,7],[0,0,8],[0,0,9]]\n\nPrelude Control.Monad&gt; take 10 $ replicateM 4 [1,3,3,7]\n[[1,1,1,1],[1,1,1,3],[1,1,1,3],[1,1,1,7],[1,1,3,1],[1,1,3,3],[1,1,3,3],[1,1,3,7],[1,1,3,1],[1,1,3,3]]\n\nPrelude Control.Monad&gt; take 10 $ replicateM 2 [4,2]\n[[4,4],[4,2],[2,4],[2,2]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": true, "score": 4, "last_activity_date": 1594704515, "last_edit_date": 1594704515, "creation_date": 1454396575, "answer_id": 35147055, "question_id": 35118659, "link": "https://stackoverflow.com/questions/35118659/haskell-permutations-with-the-length-of-the-output-list/35147055#35147055", "title": "Haskell permutations with the length of the output list", "body": "<p>Do you mean something like this?</p>\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List (permutations)\n\nchoose n list = concatMap permutations $ choose' list [] where\n  choose' []     r = if length r == n then [r] else []\n  choose' (x:xs) r | length r == n = [r]\n                   | otherwise     = choose' xs (x:r) \n                                  ++ choose' xs r\n</code></pre>\n<p>Output:</p>\n<pre><code>*Main&gt; choose 2 [0..5]\n[[1,0],[0,1],[2,0],[0,2],[3,0],[0,3],[4,0],[0,4],[5,0],[0,5],[2,1]\n,[1,2],[3,1],[1,3],[4,1],[1,4],[5,1],[1,5],[3,2],[2,3],[4,2],[2,4]\n,[5,2],[2,5],[4,3],[3,4],[5,3],[3,5],[5,4],[4,5]]\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "accepted_answer_id": 35147055, "answer_count": 2, "score": 2, "last_activity_date": 1594704515, "creation_date": 1454269999, "last_edit_date": 1495541902, "question_id": 35118659, "link": "https://stackoverflow.com/questions/35118659/haskell-permutations-with-the-length-of-the-output-list", "title": "Haskell permutations with the length of the output list", "body": "<p>I have such code for creating permutations:</p>\n\n<pre><code>--unique permutation\nperm :: [t] -&gt; [[t]]\nperm [] = [[]]\nperm (x:xs) = [(y:zs) | (y,ys) &lt;- views (x:xs), zs &lt;- perm ys]\n\n--create all possible views\nviews :: [t] -&gt; [(t,[t])]\nviews [] = []\nviews (x:xs) = ((x,xs) : [ (y,(x:ys)) | (y,ys) &lt;- views xs ])\n</code></pre>\n\n<p>However I want to limit the output to a certain length. For example, it should take a parameter specifying the number of elements in the ouput of the permutation. I want to create k distinct permutations drawn from a list [0..9].\nSo, for example, if k will be equal to 3, then the output should be something like this:[1,2,3], [9,8,7], [0,6,8] etc.. </p>\n\n<p>Right now if i pass [0..9] to the function it will generate a list with permutations of length 10. I am struggling to come up with a solution.\nIn the end, the function should look like <code>perm k list</code>\nThank you!</p>\n\n<p>It is connected with this question: <a href=\"https://stackoverflow.com/questions/35107662/verbal-arithmetics-in-haskell-send-more-money\">Verbal Arithmetics in Haskell (SEND + MORE = MONEY)</a></p>\n"}, {"tags": ["file", "haskell"], "comments": [{"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1454268475, "post_id": 35118121, "comment_id": 57956994, "body": "I&#39;ve tried to use  contents &lt;- readFile &quot;test.txt&quot; and then assign the first line to nodes so I can use it without passing it to every single function I wanted to do the similar thing with the second line."}, {"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1454268905, "post_id": 35118121, "comment_id": 57957167, "body": "I&#39;ve edited the post"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1454269714, "post_id": 35118121, "comment_id": 57957526, "body": "<i>&quot;it doesn&#39;t work&quot;</i>. What doesn&#39;t work? What are the symptoms?"}, {"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1454269951, "post_id": 35118121, "comment_id": 57957630, "body": "I&#39;m getting different errors recently &#39;Last generator in do {...} must be an expression&#39;"}, {"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1454270269, "post_id": 35118121, "comment_id": 57957768, "body": "sometimes also &#39;Instance of Num [Char] required for definition of main&#39;"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1454271484, "post_id": 35118121, "comment_id": 57958280, "body": "You could start your troubleshooting efforts my considering the type of <code>nodes</code>. Hint: it&#39;s <i>not</i> <code>[Int]</code>..."}, {"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1454271616, "post_id": 35118121, "comment_id": 57958340, "body": "I know it&#39;s not Int, but that&#39;s the problem I wanna read it or somehow convert it to int"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "edited": false, "score": 0, "creation_date": 1454272590, "post_id": 35119002, "comment_id": 57958801, "body": "It works when I put it into another file but if I use it with another code placed after that then I get &quot;Last generator in do {...} must be an expression&quot;"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "edited": false, "score": 0, "creation_date": 1454272801, "post_id": 35119002, "comment_id": 57958908, "body": "@Meii &quot;Last generator in do must be an expression&quot; is about the &quot;do&quot; clause. You can&#39;t have a &quot;let&quot; clause as the last thing in a &quot;do&quot;, because the &quot;do&quot; itself has to have a value. You probably want to &quot;return (nodes, edges)&quot;, or else compute some more things in the &quot;let&quot; and then print the results. BTW, note that &quot;print nodes&quot; returns a &quot;IO ()&quot; value, which is still a return value."}, {"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "edited": false, "score": 0, "creation_date": 1454273429, "post_id": 35119002, "comment_id": 57959155, "body": "It&#39;s not about having let at the end, I add my start function to my post, I don&#39;t have let at the end but I still have that error. It all worked before I add reading graph from file but I have to read it."}, {"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "edited": false, "score": 0, "creation_date": 1454273637, "post_id": 35119002, "comment_id": 57959239, "body": "If I remove some whitespaces I&#39;m getting another error &#39; Type error in application *** Expression     : print hamiltonianCycles nodes *** Term           : print *** Type           : d -&gt; IO () *** Does not match : a -&gt; b -&gt; c;  Can I somehow make edges and nodes global so I dont have to pass it as argument? cause it worked before"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "edited": false, "score": 0, "creation_date": 1454275078, "post_id": 35119002, "comment_id": 57959786, "body": "You probably need to say &quot;print $ hamiltonianCycles nodes&quot;. But it would help if you posted the code you are having difficulty with. Also, note that whitespace is significant in Haskell."}, {"owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "edited": false, "score": 0, "creation_date": 1454276400, "post_id": 35119002, "comment_id": 57960223, "body": "It was probably notepad settings it seems to work now. Thanks a lot!"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "edited": false, "score": 0, "creation_date": 1454453821, "post_id": 35119002, "comment_id": 58049265, "body": "Make sure you turn tabs off. Tabs are legal lexically, but cause no end of confusion in practice."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 4, "last_activity_date": 1454271650, "creation_date": 1454271650, "answer_id": 35119002, "question_id": 35118121, "link": "https://stackoverflow.com/questions/35118121/haskell-reading-from-file-into-specific-array/35119002#35119002", "title": "Haskell - reading from file into specific array", "body": "<p>So the file consists of two lines, each of which needs to be read separately.</p>\n\n<p>First, lets get the first two lines:</p>\n\n<pre><code>firstTwoLines :: [String] -&gt; (String, String)\nfirstTwoLines (x1:x2:_) = (x1,x2)\n</code></pre>\n\n<p>Now you can read the two lines as separate variables</p>\n\n<p>The conversion from String to [Integer] (or to any other type) is done by the \"read\" function. This throws an exception if the string doesn't match the expected format. Each type has its own \"read\" function, so you need to be definite about the type you are expecting.</p>\n\n<p>The type of \"read\" is:</p>\n\n<pre><code>read :: (Read a) =&gt; String -&gt; a\n</code></pre>\n\n<p>In other words the type you are reading has to be an instance of the \"Read\" class. All of the basic types are instances of \"Read\", and tuples and lists of instances are also instances. In other words \"read\" can handle both of your lines.</p>\n\n<p>So you can have</p>\n\n<pre><code>readNodes :: String -&gt; [Int]\nreadNodes = read\n\nreadEdges :: String -&gt; Graph\nreadEdges = read\n</code></pre>\n\n<p>By being specific about the return type we make each of these call the right implementation of \"read\". You can do this implicitly, but if you make a mistake you just get a \"no parse\" exception at run time and no clue as to why.</p>\n\n<p>Now you can write</p>\n\n<pre><code>main = do\n   contents &lt;- readFile \"test.txt\"\n   let (line1, line2) = firstTwoLines $ lines contents\n       nodes = readNodes line1\n       edges = readEdges line2\n   print nodes\n   print edges\n</code></pre>\n\n<p>Obviously you can replace the last two lines by whatever graph processing you want to do, but that will be enough to confirm that you are reading the file properly.</p>\n"}], "owner": {"reputation": 31, "user_id": 4402364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/370798b1d5813117bc35f7692ff95e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Meii", "link": "https://stackoverflow.com/users/4402364/meii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 35119002, "answer_count": 1, "score": -2, "last_activity_date": 1454273285, "creation_date": 1454267363, "last_edit_date": 1454273285, "question_id": 35118121, "link": "https://stackoverflow.com/questions/35118121/haskell-reading-from-file-into-specific-array", "title": "Haskell - reading from file into specific array", "body": "<p>I'm having a Garph defined like this:</p>\n\n<pre><code>type Edge = (Int, Int)\ntype Graph = [Edge]\n</code></pre>\n\n<p>and i also have list with nodes:</p>\n\n<pre><code>nodes :: [Int]\n</code></pre>\n\n<p>where I have all the nodes of my graph.\nAnd I want to read those nodes and graph from file but I can only use Prelude, System.IO and System.Enviorment .\nI've tried something but I haven't been able to work on that lists later.</p>\n\n<p>My file looks like</p>\n\n<pre><code>[1,2,3,4,5,6]\n[(1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 1)]\n</code></pre>\n\n<p>but I can change it if it'll be easier to read them. I would be grateful if someone can help me.</p>\n\n<p>@edit\nreading from file looks like this</p>\n\n<pre><code>getFirstLine input = head (lines input)\n\nstart :: IO()\nstart = do\n    contents &lt;- readFile \"test.txt\"\n    let nodes =  getFirstLine contents\n</code></pre>\n\n<p>but it doesn't work\nI would like to assign those nodes to my </p>\n\n<pre><code>nodes :: [Int]\nnodes = []\n</code></pre>\n\n<p>so I can use functions available for lists</p>\n\n<p>@edit2</p>\n\n<pre><code>start :: IO()\nstart = do\n    contents &lt;- readFile \"test.txt\"\n    let (line1, line2) = firstTwoLines $ lines contents\n        nodes = readNodes line1\n        edges = readEdges line2\n    print nodes\n    print edges\n    print nodes\n    print graph\n    print hamiltonianCycles nodes\n    print eulerianCycles\n</code></pre>\n"}, {"tags": ["haskell", "haskell-prelude", "liquid-haskell"], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 2, "last_activity_date": 1458445193, "creation_date": 1458445193, "answer_id": 36109976, "question_id": 35117590, "link": "https://stackoverflow.com/questions/35117590/is-there-liquid-haskell-enabled-prelude/36109976#36109976", "title": "Is there Liquid Haskell enabled Prelude?", "body": "<p>As discussed in the LH <a href=\"https://github.com/ucsd-progsys/liquidhaskell/README.md\" rel=\"nofollow\">Documentation</a>, you can augment existing files with <code>.spec</code> files that give just specifications of already existing code. LH itself comes with a large prelude (see the <a href=\"https://github.com/ucsd-progsys/liquidhaskell/tree/master/include\" rel=\"nofollow\">include</a> folder) that includes specifications for lots of common stuff, including <code>head</code>, <code>length</code>, functions on <code>Data.Set</code>, etc.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1520340226, "creation_date": 1454264788, "last_edit_date": 1520340226, "question_id": 35117590, "link": "https://stackoverflow.com/questions/35117590/is-there-liquid-haskell-enabled-prelude", "title": "Is there Liquid Haskell enabled Prelude?", "body": "<p>Is there a annotated variant or Haskell Prelude available for easy migration of existing programs that call functions like <code>head</code> or <code>length</code>?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1454264424, "post_id": 35117473, "comment_id": 57955477, "body": "could you specify what your expected result should be?"}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 3, "creation_date": 1454264473, "post_id": 35117473, "comment_id": 57955501, "body": "Standard library solution: <code>nub . concat . concat</code>"}], "answers": [{"tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 8, "last_activity_date": 1454265506, "creation_date": 1454265506, "answer_id": 35117729, "question_id": 35117473, "link": "https://stackoverflow.com/questions/35117473/processing-lists/35117729#35117729", "title": "Processing lists", "body": "<p>The type of that list is <code>(Num a) =&gt; [[[a]]]</code> so you can just use <code>concat</code> to flatten the structure and then <code>nub</code> to remove duplicates:</p>\n\n<pre><code>nub . concat . concat $ [[[4,6,7], [1,2,4,6]], [[10,4,2,4], [1]]]\n-- [4,6,7,1,2,10]\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/366f8fe4a1aa936f\"><kbd>Live demo</kbd></a></p>\n\n<p>Depending on how the data is actually structured and based on statistical considerations it might be more efficient to remove duplicates within internal lists before concatenating.</p>\n"}], "owner": {"reputation": 165, "user_id": 5857949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e83895d561b94f0c697aab40e0f9658c?s=128&d=identicon&r=PG&f=1", "display_name": "karambit", "link": "https://stackoverflow.com/users/5857949/karambit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 35117729, "answer_count": 1, "score": 2, "last_activity_date": 1454265506, "creation_date": 1454264175, "last_edit_date": 1454264889, "question_id": 35117473, "link": "https://stackoverflow.com/questions/35117473/processing-lists", "title": "Processing lists", "body": "<p>I am trying to figure out how to process a list like this:</p>\n\n<pre><code>[ [[4,6,7], [1,2,4,6]] , [[10,4,2,4], [1]] ]\n</code></pre>\n\n<p>This is a list of a list of list of integers</p>\n\n<p>I want my function take take this list as input and return a list of integers that are in the list without duplicates. The result should be [4,6,7,1,2,10]. But I am having trouble in figuring out how to traverse it.</p>\n\n<p>My first idea was to take a process each list of integer lists separately like:\n1st = [ [4,6,7], [1,2,4,6] ]\n2nd = [ [10,4,2,4] , [1] ] \nthe main function will call another function to handle these recursively, but how will the function remember what was in the final list when it comes to handle the 2nd list? I dont think an accumulator will even work.</p>\n"}, {"tags": ["haskell", "ffi"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1454266935, "post_id": 35116169, "comment_id": 57956418, "body": "Recall that in C, an array of ints can decay into a pointer to int, and that an array of arrays of ints can decay into a pointer to array of ints, but <i>not</i> to a pointer to pointer to int. You can&#39;t pass a <code>int a[3][5]</code> where a <code>int **a</code> is expected, but you can where a <code>int (*a)[5]</code> is."}], "answers": [{"comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1454259765, "post_id": 35116520, "comment_id": 57953613, "body": "Unfortunately the point-of-array syntax doesn&#39;t compile for me, but the manual indexing works great."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 4, "last_activity_date": 1454259427, "creation_date": 1454259427, "answer_id": 35116520, "question_id": 35116169, "link": "https://stackoverflow.com/questions/35116169/marshaling-vectors-of-pointers/35116520#35116520", "title": "Marshaling vectors of pointers", "body": "<p>You're not using the same data format on the two sides. Your Haskell code produces a flat array of all the values in all the tuples of the vector, while your C code expects an array of <em>pointers</em>, one for each element of the vector, pointing to the values in that tuple.</p>\n\n<p>If you could declare your C function like this (maybe this is valid C nowadays, I don't know)</p>\n\n<pre><code>void test(int64_t (*y)[tupSize], int32_t vecSize, int16_t tupSize, int64_t *tup)\n</code></pre>\n\n<p>then C would be using the same layout as Haskell. Otherwise, you can index manually with</p>\n\n<pre><code>//  SINGLE pointer |\n//                 v\nvoid test(int64_t *y, int32_t vecSize, int16_t tupSize, int64_t *tup)\n...\n    printf(\"%\" PRId64 \",\", y[i*tupSize+j]);\n</code></pre>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 35116520, "answer_count": 1, "score": 5, "last_activity_date": 1454259427, "creation_date": 1454257594, "last_edit_date": 1454259131, "question_id": 35116169, "link": "https://stackoverflow.com/questions/35116169/marshaling-vectors-of-pointers", "title": "Marshaling vectors of pointers", "body": "<p>I'm trying to represent a Haskell <a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Storable.html\" rel=\"nofollow\">vector</a> of arbitrarily right-nested pairs (i.e. <code>Vector (Int64, (Int64, (...)))</code>) as a 2-d array in C (i.e. <code>int64_t**</code>), indexed first as the vector component, then the tuple component.</p>\n\n<p>Here's my C function:</p>\n\n<pre><code>void test(int64_t** y, int32_t vecSize int16_t tupSize, int64_t* tup)\n{\n    printf(\"Tup vals: \");\n    for(int i = 0; i &lt; tupSize; i++) {\n        printf(\"%\" PRId64 \",\",tup[i]);\n    }\n    printf(\"\\n\");\n\n\n    printf(\"vec\\n\");\n    for(int i = 0; i &lt; vecSize; i++) {\n        printf(\"%d: (\", i);\n        for(int j = 0; j &lt; tupSize; j++) {\n            printf(\"%\" PRId64 \",\", y[i][j]);\n        }\n        printf(\")\\n\");\n    }\n}\n</code></pre>\n\n<p>On the Haskell side I have:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Data.Int\nimport Data.Vector.Storable (Vector, singleton, unsafeWith)\n\nimport Foreign.Marshal.Utils (with)\nimport Foreign.Ptr\nimport Foreign.Storable (Storable (..))\n\nforeign import ccall unsafe \"test\" test :: Ptr (Ptr Int64) -&gt; Int64 -&gt; Int16 -&gt; Ptr Int64 -&gt; IO ()\n\n-- instance assumes right-nested pairs, but not enforced at type level\ninstance (Storable a, Storable b)\n  =&gt; Storable (a,b) where\n  sizeOf _ = (sizeOf (undefined :: a)) + (sizeOf (undefined :: b))\n  alignment _ = max (alignment (undefined :: a)) (alignment (undefined :: b))\n  peek p = do\n    a &lt;- peek (castPtr p :: Ptr a)\n    b &lt;- peek (castPtr (plusPtr p (sizeOf a)) :: Ptr b)\n    return (a,b)\n  poke p (a,b) = do\n    poke (castPtr p :: Ptr a) a\n    poke (castPtr (plusPtr p (sizeOf a)) :: Ptr b) b\n\nmain :: IO ()\nmain = do\n  let tup = (10,11) :: (Int64, Int64)\n      vec = singleton (2,3) :: Vector (Int64, Int64)\n  with tup $ \\tptr -&gt; \n    unsafeWith vec $ \\vptr -&gt;\n      test (castPtr vptr) 1 2 (castPtr tptr)\n</code></pre>\n\n<p>This prints </p>\n\n<pre><code>Moduli: 10,11,\nvec\nSegmentation fault\n</code></pre>\n\n<p>which leads me to think that my <code>Storable (a,b)</code> instance is fine: I'm getting a pointer for <code>(Int64,Int64)</code>, then casting it to <code>Ptr Int64</code>, and reading the data just fine in C. So the question is what is going wrong with the vector? I'm attempting to do the same thing: create a <code>Vector (Int64, Int64)</code>, get a pointer of type <code>Ptr (Int64, Int64)</code> for it, and cast it to a <code>Ptr (Ptr Int64)</code>. Why am I getting a segfault when I try to access the array in C, and what is the proper way to marshal this data?</p>\n"}, {"tags": ["haskell", "functional-programming", "list-comprehension"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1454253506, "post_id": 35115395, "comment_id": 57951369, "body": "so what did you try - &quot;if you want to make your life tougher&quot; try it yourself - i would just write it with <code>deleteBy</code> and <code>find</code> and worry about performance later. And if it was needed I would use a recursive function with an accmulator i guess."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1454253746, "post_id": 35115395, "comment_id": 57951440, "body": "<code>partition (==x)</code> could be useful."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 2, "creation_date": 1454263023, "post_id": 35115395, "comment_id": 57954855, "body": "The second parameter, of type <code>b</code>, doesn&#39;t seem useful. You&#39;re just forwarding it to the predicate. The same can be achieved with passing a closure as the predicate, and this allows you to use one-parameter predicates (e.g. <code>null</code>) directly, without having to invent a parameter."}], "answers": [{"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1454400844, "post_id": 35115877, "comment_id": 58015178, "body": "Is there a more &quot;Monadic&quot; way to write this?"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 2, "last_activity_date": 1454255996, "creation_date": 1454255996, "answer_id": 35115877, "question_id": 35115395, "link": "https://stackoverflow.com/questions/35115395/how-to-delete-from-list-return-the-deleted-element-and-return-the-modified-l/35115877#35115877", "title": "How to delete from list, return the deleted element, and return the &quot;modified&quot; list", "body": "<p>You can implement that function fairly easily with <code>foldr</code>, like this:</p>\n\n<pre><code>deleteFromList :: (b -&gt; a -&gt; Bool) -&gt; b -&gt; [a] -&gt; (Maybe a, [a])\ndeleteFromList p target = foldr folder (Nothing, [])\n  where\n    folder x (Nothing, xs) | p target x = (Just x, xs)\n    folder x (m, xs)                    = (m, x : xs)\n</code></pre>\n\n<p>although I'm sure that experienced Haskellers (which I'm not) will be able to come up with a one-liner...</p>\n\n<p>Examples of usage:</p>\n\n<pre><code>*Q35115395&gt; deleteFromList (\\x y -&gt; x == fst y) 3 [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"), (4, \"Jimmy\")]\n(Just (3,\"Joe\"),[(1,\"Jack\"),(2,\"Jill\"),(4,\"Jimmy\")])\n\n*Q35115395&gt; deleteFromList (\\x y -&gt; x == fst y) 5 [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"), (4, \"Jimmy\")]\n(Nothing,[(1,\"Jack\"),(2,\"Jill\"),(3,\"Joe\"),(4,\"Jimmy\")])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 5715425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80175d4896bc5afa19d54b0a059ed115?s=128&d=identicon&r=PG&f=1", "display_name": "denys.fridman", "link": "https://stackoverflow.com/users/5715425/denys-fridman"}, "is_accepted": false, "score": 1, "last_activity_date": 1454258253, "creation_date": 1454258253, "answer_id": 35116295, "question_id": 35115395, "link": "https://stackoverflow.com/questions/35115395/how-to-delete-from-list-return-the-deleted-element-and-return-the-modified-l/35116295#35116295", "title": "How to delete from list, return the deleted element, and return the &quot;modified&quot; list", "body": "<p>A simple recursive solution:</p>\n\n<pre><code>deleteFromList :: (b -&gt; a -&gt; Bool) -&gt; b -&gt; [a] -&gt; (Maybe a, [a])\ndeleteFromList p b (x: xs) | p b x     = (Just x, xs)\n                           | otherwise = let (y, rest) = deleteFromList p b xs in\n                                           (y, x: rest)\ndeleteFromList _ _ [] = (Nothing, [])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 1, "last_activity_date": 1454266707, "last_edit_date": 1454266707, "creation_date": 1454262677, "answer_id": 35117179, "question_id": 35115395, "link": "https://stackoverflow.com/questions/35115395/how-to-delete-from-list-return-the-deleted-element-and-return-the-modified-l/35117179#35117179", "title": "How to delete from list, return the deleted element, and return the &quot;modified&quot; list", "body": "<p>@Mark Seemann nice job, as Chi has suggested, it's better to improve with partition </p>\n\n<pre><code>  Prelude DL&gt; let myFunction x = partition ((==x).(fst)) \n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>  Prelude DL&gt; myFunction  1 [(1,2),(2,9)]\n  ([(1,2)],[(2,9)])\n  Prelude DL&gt; myFunction  5 [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"),(4, \"Jimmy\")]\n  ([],[(1,\"Jack\"),(2,\"Jill\"),(3,\"Joe\"),(4,\"Jimmy\")])\n  Prelude DL&gt; myFunction  3 [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"),(4, \"Jimmy\")]\n  ([(3,\"Joe\")],[(1,\"Jack\"),(2,\"Jill\"),(4,\"Jimmy\")])\n</code></pre>\n\n<p>This is more general:</p>\n\n<pre><code>  Prelude&gt; let myFunction g  x = partition (g .fst)\n  Prelude&gt; myFunction (==3) 3 [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"),(4, \"Jimmy\")]\n  ([(3,\"Joe\")],[(1,\"Jack\"),(2,\"Jill\"),(4,\"Jimmy\")])\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 35115877, "answer_count": 3, "score": 1, "last_activity_date": 1454266707, "creation_date": 1454253149, "question_id": 35115395, "link": "https://stackoverflow.com/questions/35115395/how-to-delete-from-list-return-the-deleted-element-and-return-the-modified-l", "title": "How to delete from list, return the deleted element, and return the &quot;modified&quot; list", "body": "<p>(Newbie alert)</p>\n\n<p>I'm trying to write a function with the following signature, because I couldn't find something similar in the standard libraries:</p>\n\n<pre><code>deleteFromList :: (b -&gt; a -&gt; Bool) -&gt; b -&gt; [a] -&gt; (Maybe a, [a])\n\n-- Example 1: Item found in the list, and deleted\ndeleteFromList (\\(id1, name1), (id2, name2) -&gt; id1==id2) 3 [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"), (4, \"Jimmy\")]\n-- returns (Just (3, \"Joe\"), [(1, \"Jack\"), (2, \"Jill\"), (4, \"Jimmy\")]\n\n-- Example 2: Item not found in list\ndeleteFromList (\\(id1, name1), (id2, name2) -&gt; id1==id2) 5 [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"), (4, \"Jimmy\")]\n-- returns (Nothing, [(1, \"Jack\"), (2, \"Jill\"), (3, \"Joe\"), (4, \"Jimmy\")]\n</code></pre>\n\n<p>I know this can probably be written by calling <code>Data.List.find</code> and <code>Data.List.deleteBy</code>, but that would result in two traversals of the list. I want to make my life tougher and do this in just a single traversal.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "reply_to_user": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1454621972, "post_id": 35115172, "comment_id": 58139498, "body": "The <code>full-laziness</code> transformantion doesn&#39;t actually have anything to do with evaluation order."}, {"owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "edited": false, "score": 0, "creation_date": 1521465055, "post_id": 35115172, "comment_id": 85727847, "body": "Another possible point against full laziness is from <a href=\"https://mail.haskell.org/pipermail/ghc-devs/2014-August/006195.html\" rel=\"nofollow noreferrer\">this thread</a>."}], "answers": [{"comments": [{"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "edited": false, "score": 0, "creation_date": 1454271871, "post_id": 35115664, "comment_id": 57958455, "body": "Thanks for the example.  The same would apply if <code>f</code> were an <code>Int</code>, especially if calculating it is expensive.  However, I was thinking of a less violent transformation: <code>g = let {f = ...} in \\z -&gt; f (z+1)</code>.  This would still be considered good style I think, even if it doesn&#39;t fit syntactically as nicely with Haskell&#39;s <code>where</code>."}, {"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "edited": false, "score": 0, "creation_date": 1454355800, "post_id": 35115664, "comment_id": 57997997, "body": "Your second example, <code>h</code>, is more convincing because giving a name to <code>(+1)</code> is indeed quite ugly.  I would assess it as being equivalent to SPJ&#39;s example with <code>sqrt 4</code>.  I guess my conclusion is then that <code>full-laziness</code> saves you from death by a thousand cuts.  One could in principle produce optimized versions by hand but it would be inefficient to do so everywhere."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 1, "creation_date": 1531223768, "post_id": 35115664, "comment_id": 89506961, "body": "Note that floating out lambdas should <i>always</i> be beneficial. Floating thunks or partial applications might have the ugly side-effects (retaining huge data structures that are cheap to reconstruct) you want to eliminate. It&#39;s a shame that GHC misses a flag for that."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 11, "last_activity_date": 1454274986, "last_edit_date": 1454274986, "creation_date": 1454254732, "answer_id": 35115664, "question_id": 35115172, "link": "https://stackoverflow.com/questions/35115172/why-is-full-laziness-a-default-optimization/35115664#35115664", "title": "Why is full-laziness a default optimization?", "body": "<p>There's at least one common case where full laziness is \"safe\" and an optimization.</p>\n\n<pre><code>g :: Int -&gt; Int\ng z = f (z+1)\n  where f 0 = 0\n        f y = 1 + f (y-1)\n</code></pre>\n\n<p>This really means <code>g = \\z -&gt; let {f = ...} in f (z+1)</code> and, compiled that way, will allocate a closure for <code>f</code> before calling it. Obviously that's silly, and the compiler should transform the program into</p>\n\n<pre><code>g_f 0 = 0\ng_f y = 1 + g_f (y-1)\ng z = g_f (z+1)\n</code></pre>\n\n<p>where no allocation is needed to call <code>g_f</code>. Happily the full laziness transformation does exactly that.</p>\n\n<p>Obviously programmers could refrain from making these local definitions that do not depend on the arguments of the top-level function, but such definitions are generally considered good style...</p>\n\n<p>Another example:</p>\n\n<pre><code>h :: [Int] -&gt; [Int]\nh xs = map (+1) xs\n</code></pre>\n\n<p>In this case you can just eta reduce, but normally you can't eta reduce. And naming the function <code>(+1)</code> is quite ugly.</p>\n"}], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 3, "answer_count": 1, "score": 12, "last_activity_date": 1454621989, "creation_date": 1454251953, "last_edit_date": 1454621989, "question_id": 35115172, "link": "https://stackoverflow.com/questions/35115172/why-is-full-laziness-a-default-optimization", "title": "Why is full-laziness a default optimization?", "body": "<p>Full laziness has been\n<a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2013-February/106673.html\" rel=\"noreferrer\">repeatedly</a>\n<a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2015-December/122534.html\" rel=\"noreferrer\">demonstrated</a>\nto\n<a href=\"https://github.com/michaelt/streaming/issues/6\" rel=\"noreferrer\">cause</a>\n<a href=\"https://stackoverflow.com/questions/26321784/haskell-compiling-with-o2-drastically-increases-memory-usage/26322330#26322330\">space</a>\n<a href=\"https://stackoverflow.com/questions/32345095/what-is-the-correct-way-to-perform-constant-space-nested-loops-in-haskell/32359655#32359655\">leaks</a>.</p>\n\n<p>Why is full laziness on from <code>-O</code> onwards?  I find myself unconvinced by the reasoning in SPJ's <a href=\"https://www.cse.iitb.ac.in/~as/fpcourse/slpj-book-1987.pdf\" rel=\"noreferrer\">The Implementation of Functional Programming Languages</a>.  The claim is that in</p>\n\n<pre><code>f = \\y -&gt; y + sqrt 4\n</code></pre>\n\n<p><code>sqrt 4</code> is unnecessarily repeated each time <code>f</code> is entered so we should float it outside the lambda.  I agree in the small, but since we've seen what problems this transformation causes in the large I don't believe it is worth it.  It seems to me that the benefits of this transformation are obtainable unilaterally** with only local code changes and programmers who want it should implement it by hand.</p>\n\n<p>Can you convince me otherwise?  Is <code>full-laziness</code> actually really useful?  I will be especially convinced if you can provide examples which to implement by hand require multilateral cooperation or non-local transformations.</p>\n\n<p>** unlike optimizations like inlining and stream fusion which to implement by hand would require multilateral cooperation between modules and non-local code changes</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1312, "user_id": 149988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LX5tz.jpg?s=128&g=1", "display_name": "jarmond", "link": "https://stackoverflow.com/users/149988/jarmond"}, "edited": false, "score": 0, "creation_date": 1454236376, "post_id": 35112638, "comment_id": 57946065, "body": "Is there some canonical place where the controversy regarding records is laid out?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 1312, "user_id": 149988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LX5tz.jpg?s=128&g=1", "display_name": "jarmond", "link": "https://stackoverflow.com/users/149988/jarmond"}, "edited": false, "score": 2, "creation_date": 1454236995, "post_id": 35112638, "comment_id": 57946228, "body": "@jarmond The <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records\" rel=\"nofollow noreferrer\">GHC wiki page on records</a> is pretty comprehensive. In general, the ghc wiki is a great place to find information and discussion about &quot;modern&quot; Haskell."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 4, "last_activity_date": 1454235030, "creation_date": 1454235030, "answer_id": 35112638, "question_id": 35112489, "link": "https://stackoverflow.com/questions/35112489/geometric-point-data-type-tuple-vs-record/35112638#35112638", "title": "Geometric point data type - tuple vs record?", "body": "<p>Records are a controversial subject in Haskell. There is a consensus in the community that the existing implementation is suboptimal due to many reasons and things are being done to fix that.</p>\n\n<p>Now, since the existing records implementation is suboptimal, many Haskellers tend to never use them. I'm one of those.</p>\n\n<p>I would recommend going with the following:</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable, DeriveFunctor, DeriveTraversable #-}\n\ndata Point a =\n  Point !a !a\n  deriving (Functor, Foldable, Traversable)\n</code></pre>\n\n<p>This will give you free instances of some standard classes and strict data-structures are a recommended default.</p>\n"}, {"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1454236300, "post_id": 35112704, "comment_id": 57946043, "body": "you can use <code>first</code> and <code>second</code> from <code>Control.Arrow</code> or  <code>_1</code> and <code>_2</code> from <a href=\"https://hackage.haskell.org/package/Chart-1.1/docs/Control-Lens-Tuple.html\" rel=\"nofollow noreferrer\"><code>Control.Lens.Tuple</code></a> to modify/extract tuple values."}], "tags": [], "owner": {"reputation": 11, "user_id": 5568859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i6cBB.jpg?s=128&g=1", "display_name": "Intrader Amit", "link": "https://stackoverflow.com/users/5568859/intrader-amit"}, "is_accepted": false, "score": -2, "last_activity_date": 1454235510, "creation_date": 1454235510, "answer_id": 35112704, "question_id": 35112489, "link": "https://stackoverflow.com/questions/35112489/geometric-point-data-type-tuple-vs-record/35112704#35112704", "title": "Geometric point data type - tuple vs record?", "body": "<p>According to me,tougher one is tuple,because it is difficult to create any change in the tuples. The best one is last one.</p>\n"}, {"comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 2, "creation_date": 1454237114, "post_id": 35112732, "comment_id": 57946261, "body": "\u201c<code>type Point a = (a,a)</code> which is just an alias or <code>newtype Point a = Point (a,a)</code>\u201d is true only operationally: On the type level, only the latter will let the compiler help you distinguish points from tuples, and allows you do add new instances for <code>Point</code>."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 5, "last_activity_date": 1504398639, "last_edit_date": 1504398639, "creation_date": 1454235700, "answer_id": 35112732, "question_id": 35112489, "link": "https://stackoverflow.com/questions/35112489/geometric-point-data-type-tuple-vs-record/35112732#35112732", "title": "Geometric point data type - tuple vs record?", "body": "<p>I think this depends mostly on your use-case at hand.</p>\n\n<p>Though I'd never use data <code>Point = Point (a, a)</code>, because this introduces one layer of indirection, which bloats the data structure - by two machine words - one for the <code>Point</code> and one for the pointer pointing to the tuple inside it.</p>\n\n<p>Better use <code>type Point a = (a,a)</code> which is just an alias or <code>newtype Point a = Point (a,a)</code> which gets optimized away at compile time, so you have the benefits in this case.</p>\n\n<p>The most flexible (for some definitions of flexible) is the last approach, though I'd call the records <code>pr1</code> and <code>pr2</code> for 'projection to the first/second component'. This approach also lends itself nicely to using lenses.</p>\n\n<p>As @nikitavolkov said - it is a good idea to have strict data fields for performance reasons, but as I like records I'd ultimately go with</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell -#}\n{-# LANGUAGE DeriveFoldable -#}\n{-# LANGUAGE DeriveFunctor -#}\n{-# LANGUAGE DeriveTraversable -#}\n{-# LANGUAGE RecordWildCards #-}\n\nimport Control.Lens\n\ndata Point a = Point { _pr1 :: !a\n                     , _pr2 :: !a\n                     } deriving (..)\n$(makeLenses ''Point)\n</code></pre>\n\n<p>which gets you the benefit of using <code>norm Point{..} = sqrt (_pr1^2 + _pr2^2)</code> with <code>RecordWildCards</code> and all the niceties of lenses.</p>\n\n<h2>Update (2017-09-03):</h2>\n\n<p>Just recently I found the <a href=\"https://hackage.haskell.org/package/strict\" rel=\"nofollow noreferrer\">strict package</a>, which provides strict datatytpes as well as strict IO actions. One thing that stuck out to me was the following from <a href=\"https://hackage.haskell.org/package/strict-0.3.2/docs/Data-Strict-Maybe.html\" rel=\"nofollow noreferrer\">Data.Strict.Maybe</a></p>\n\n<blockquote>\n  <p>Note that strict Maybe is not a monad since <code>return \u22a5 &gt;&gt;= f = \u22a5</code> which is not necessarily the same as <code>f \u22a5</code>.</p>\n</blockquote>\n\n<p>Which I think is applicable to strict pairs as well - so keep that in mind when defining and/or using strict data types.</p>\n"}], "owner": {"reputation": 1312, "user_id": 149988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LX5tz.jpg?s=128&g=1", "display_name": "jarmond", "link": "https://stackoverflow.com/users/149988/jarmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 35112732, "answer_count": 3, "score": 4, "last_activity_date": 1504398639, "creation_date": 1454234053, "last_edit_date": 1454234555, "question_id": 35112489, "link": "https://stackoverflow.com/questions/35112489/geometric-point-data-type-tuple-vs-record", "title": "Geometric point data type - tuple vs record?", "body": "<p>I can think of three ways to define a geometric point as an algebraic data type in Haskell. I want to define it as an algebraic data type for better documentation. </p>\n\n<p>As a tuple type:</p>\n\n<pre><code>data Point a = Point a a\n</code></pre>\n\n<p>As a tuple:</p>\n\n<pre><code>data Point a= Point (a,a)\n</code></pre>\n\n<p>As a record:</p>\n\n<pre><code>data Point a = Point { pointx :: a, pointy :: a}\n</code></pre>\n\n<p>Which is better design/style and why?</p>\n"}, {"tags": ["haskell", "frege"], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 3, "last_activity_date": 1454240313, "last_edit_date": 1454240313, "creation_date": 1454239715, "answer_id": 35113317, "question_id": 35112300, "link": "https://stackoverflow.com/questions/35112300/does-frege-solve-the-issue-of-re-export-qualified-of-haskell/35113317#35113317", "title": "Does Frege solve the issue of &quot;re-export qualified&quot; of Haskell?", "body": "<p>I guess it doesn't. In Frege, a module can re-export items only (i.e. functions, types, type classes), but not modules.</p>\n\n<p>This means that, if you have some <code>foo</code>s down in the module hierarchy you are importing, you still need to hide all but at most one.</p>\n\n<p>What you can do in Frege is:</p>\n\n<pre><code>import mod.A(foo fooA)\nimport mod.B(foo fooB)\n</code></pre>\n\n<p>which effectively renames <code>A.foo</code> to <code>fooA</code> and <code>B.foo</code> to <code>fooB</code> in the importing module. This works also on re-exports. For example, in <code>frege.Prelude</code> we have</p>\n\n<pre><code>import Prelude.PreludeBase public(!= /=)\n</code></pre>\n\n<p>This will cause anyone who imports <code>frege.Prelude</code> to have the operator <code>/=</code> available. But this is only an alias for the <code>!=</code> operator of <code>Ord</code></p>\n\n<p>As one can imagine, we need to have both <code>!=</code> and <code>/=</code> in order to avoid complaints form the Java or Haskell camps, respectively. </p>\n"}], "owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454240313, "creation_date": 1454232765, "question_id": 35112300, "link": "https://stackoverflow.com/questions/35112300/does-frege-solve-the-issue-of-re-export-qualified-of-haskell", "title": "Does Frege solve the issue of &quot;re-export qualified&quot; of Haskell?", "body": "<p>The issue in Haskell: </p>\n\n<blockquote>\n<pre><code>module Foo.A where\n\nfoo = 42\n</code></pre>\n  \n  <p>and</p>\n\n<pre><code>module Foo.B where\n\nfoo = 12\n</code></pre>\n  \n  <p>and you want to write a super module</p>\n\n<pre><code>module Foo (\n      module Foo.A\n    , module Foo.B\n    ) where\n\nimport Foo.A\nimport Foo.B\n</code></pre>\n  \n  <p>which re-exports those modules, you would get a name clash.</p>\n</blockquote>\n\n<p>Note, there can be <strong>plenty of the functions like <code>foo</code></strong> in each module (foo1, foo2, etc) and I want to use them from both modules. There can also be <code>data</code>s with the same member names in each module, after all. So hiding isn't a solution. \nI do <strong>not</strong> consider Lens for resolving it.</p>\n\n<p>Now, does Frege solve the problem of \"re-export qualified\" of Haskell? It seems it does if I remember correctly, but I can't find the evidence now, can anyone elaborate on that?</p>\n"}, {"tags": ["haskell", "pointfree"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1454230077, "post_id": 35111847, "comment_id": 57944533, "body": "try <code>(map id .) . zip</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "edited": false, "score": 0, "creation_date": 1454230530, "post_id": 35111908, "comment_id": 57944626, "body": "I&#39;m confused. Do all functions in Haskell take one argument, don&#39;t they? <code>zip :: [a] -&gt; ([b] -&gt; [(a,b)])</code>"}, {"owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "edited": false, "score": 2, "creation_date": 1454230628, "post_id": 35111908, "comment_id": 57944641, "body": "Aha. I can see. then <code>map</code> rejects function argument."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "edited": false, "score": 0, "creation_date": 1454231955, "post_id": 35111908, "comment_id": 57944932, "body": "yes - the second part for map to work would have to have type signature of the shape <code>[a] -&gt; [b -&gt; (a,b)]</code>"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 5, "last_activity_date": 1454229655, "creation_date": 1454229655, "answer_id": 35111908, "question_id": 35111847, "link": "https://stackoverflow.com/questions/35111847/haskell-point-free-style/35111908#35111908", "title": "Haskell: Point-free style", "body": "<p>If you look at the definition/type signature of <code>(.)</code> you see that its arguments are functions with a single parameter. But <code>zip</code> has two thus you have to supply at least one parameter to make it equivalent </p>\n\n<pre><code>foo a = map id . zip a\n</code></pre>\n"}], "owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 35111908, "answer_count": 1, "score": 0, "last_activity_date": 1454229655, "creation_date": 1454229102, "question_id": 35111847, "link": "https://stackoverflow.com/questions/35111847/haskell-point-free-style", "title": "Haskell: Point-free style", "body": "<p>Why does the first one fails while the latter one succeeds in compilation?</p>\n\n<p>I expect <code>foo</code> and <code>foo'</code> are equivalent, that is, <code>foo'</code> is just a point-free function\nof <code>foo</code>:</p>\n\n<pre><code>foo :: [a] -&gt; [a] -&gt; [(a,a)]\nfoo = map id . zip\n\nfoo' :: [a] -&gt; [a] -&gt; [(a,a)]\nfoo' a b = map id $ zip a b\n</code></pre>\n\n<p>But <code>foo</code> fails with following error:</p>\n\n<pre><code>Couldn't match type \u2018[b0] -&gt; [(a, b0)]\u2019 with \u2018[b]\u2019\nExpected type: [a] -&gt; [b]\n  Actual type: [a] -&gt; [b0] -&gt; [(a, b0)]\nRelevant bindings include\n  foo :: [a] -&gt; [b] (bound at &lt;interactive&gt;:26:5)\nProbable cause: \u2018zip\u2019 is applied to too few arguments\nIn the second argument of \u2018(.)\u2019, namely \u2018zip\u2019\nIn the expression: map id . zip\n</code></pre>\n\n<p>Any comments will be appreciated.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5863326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f727f854b2159dcf0be4f61845434f?s=128&d=identicon&r=PG&f=1", "display_name": "blues5938", "link": "https://stackoverflow.com/users/5863326/blues5938"}, "edited": false, "score": 0, "creation_date": 1454229709, "post_id": 35111843, "comment_id": 57944441, "body": "Thanks for the reply! How does alternateSum&#39; have access to the list passed to alternateSum? Sorry if this is a basic question, still learning."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 3, "user_id": 5863326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f727f854b2159dcf0be4f61845434f?s=128&d=identicon&r=PG&f=1", "display_name": "blues5938", "link": "https://stackoverflow.com/users/5863326/blues5938"}, "edited": false, "score": 0, "creation_date": 1454229759, "post_id": 35111843, "comment_id": 57944454, "body": "<code>alternateSum</code> passes it&#39;s input to <code>alternateSum&#39;</code> - I just eta-reduced the last parameter - sorry will fix this (probably to much for beginners)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1454235982, "last_edit_date": 1454235982, "creation_date": 1454229085, "answer_id": 35111843, "question_id": 35111768, "link": "https://stackoverflow.com/questions/35111768/basic-haskell-recursive-function/35111843#35111843", "title": "Basic Haskell Recursive Function", "body": "<p>ok - you somehow have to carry the <em>sign</em> with you so the obvious solution is to do it with an argument (and then add a version that fixes this argument for the first call):</p>\n\n<pre><code>alternateSum' :: Num a =&gt; a -&gt; [a] -&gt; a\nalternateSum' _ []     = 0\nalternateSum' f (h:tl) = f * h + alternateSum' (-f) tl\n\nalternateSum :: [Integer] -&gt; Integer\nalternateSum ns = alternateSum' 1 ns\n</code></pre>\n\n<p>which will yield what you want:</p>\n\n<pre><code>\u03bb&gt; alternateSum [1,2,3]\n2\n</code></pre>\n\n<hr>\n\n<p>your version has the problem that for the first version (assuming <code>[1,2,3]</code>) <code>ps</code> will have length <code>2</code> which is of course <em>even</em> but for <code>[1,2]</code> it will have length <code>1</code> (<em>odd</em>) and your version would be right ... that's where you are in trouble - your sign depends on the length instead of the position</p>\n\n<hr>\n\n<p>Here is a fun version you can try to figure out:</p>\n\n<pre><code>alternateSum :: [Integer] -&gt; Integer\nalternateSum ns = sum $ zipWith ($) (cycle [id,negate]) ns\n</code></pre>\n\n<p>this one will rewrite the list <code>[1,2,3]</code> first into <code>[1,(-2),3]</code> and then <code>sum</code> the list ;)</p>\n"}, {"tags": [], "owner": {"reputation": 6210, "user_id": 4358829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVIDt.jpg?s=128&g=1", "display_name": "Matteo Piombo", "link": "https://stackoverflow.com/users/4358829/matteo-piombo"}, "is_accepted": false, "score": 1, "last_activity_date": 1454230370, "creation_date": 1454230370, "answer_id": 35111986, "question_id": 35111768, "link": "https://stackoverflow.com/questions/35111768/basic-haskell-recursive-function/35111986#35111986", "title": "Basic Haskell Recursive Function", "body": "<p>Here is a recursive alternative:</p>\n\n<pre><code>alternateSum :: [Integer] -&gt; Integer\nalternateSum xs = go False 0 xs\n--            Odd     Accumul    Tail\n  where go :: Bool -&gt; Integer -&gt; [Integer] -&gt; Integer\n        go _ acc [] = acc\n        go False acc (x:xs) = go True  (acc + x) xs\n        go True  acc (x:xs) = go False (acc - x) xs\n</code></pre>\n\n<p>I'm not a super expert, just trying.</p>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 1, "last_activity_date": 1454235796, "last_edit_date": 1454235796, "creation_date": 1454231654, "answer_id": 35112142, "question_id": 35111768, "link": "https://stackoverflow.com/questions/35111768/basic-haskell-recursive-function/35112142#35112142", "title": "Basic Haskell Recursive Function", "body": "<pre><code>1 - (2 - (3 - (4 - 5))) = 1 - 2 + 3 - 4 + 5\n</code></pre>\n\n<p>So you can write</p>\n\n<pre><code>alternateSum = foldr (-) 0\n</code></pre>\n\n<p>Nice, but inefficient. Dual and more efficient:</p>\n\n<pre><code>import Data.List\n\nalternateSum = foldl' (flip (-)) 0 . reverse\n</code></pre>\n\n<p>But a direct tail recursive solution should be better anyway.</p>\n"}], "owner": {"reputation": 3, "user_id": 5863326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f727f854b2159dcf0be4f61845434f?s=128&d=identicon&r=PG&f=1", "display_name": "blues5938", "link": "https://stackoverflow.com/users/5863326/blues5938"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 35111843, "answer_count": 3, "score": 1, "last_activity_date": 1521542462, "creation_date": 1454228465, "last_edit_date": 1521542462, "question_id": 35111768, "link": "https://stackoverflow.com/questions/35111768/basic-haskell-recursive-function", "title": "Basic Haskell Recursive Function", "body": "<p>I am trying to write a basic recursive function that calculates the alternating sum of a list of numbers (<code>[1, 2, 3] -&gt; 1 - 2 + 3</code>). I am fairly new to Haskell, so I have just been toying around with this problem with little success. Below is my most recent attempt. It works with lists of up to length two.</p>\n\n<pre><code>alternateSum [] = 0\nalternateSum (p:ps) = if odd (length ps) then\n                         p - alternateSum ps\n                      else \n                         p + alternateSum ps         \n</code></pre>\n"}, {"tags": ["haskell", "cookies"], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 1, "last_activity_date": 1454223318, "creation_date": 1454223318, "answer_id": 35111227, "question_id": 35111094, "link": "https://stackoverflow.com/questions/35111094/whats-the-wreqs-way-of-creating-custom-cookies/35111227#35111227", "title": "what&#39;s the wreq&#39;s way of creating custom cookies?", "body": "<p>I'd probably fork the <code>generateCookie</code> implementation, as it looks like the <code>Request</code> argument is used only to validate the fields.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/http-client-0.4.26.2/docs/src/Network-HTTP-Client-Cookies.html#generateCookie\" rel=\"nofollow\">http://hackage.haskell.org/package/http-client-0.4.26.2/docs/src/Network-HTTP-Client-Cookies.html#generateCookie</a>, except for default cookie path, as <code>SetCookie</code> has <code>Maybe</code> path.</p>\n"}], "owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1454223318, "creation_date": 1454221914, "question_id": 35111094, "link": "https://stackoverflow.com/questions/35111094/whats-the-wreqs-way-of-creating-custom-cookies", "title": "what&#39;s the wreq&#39;s way of creating custom cookies?", "body": "<p>I want to make HTTP requests with some known cookie key-value pairs (e.g <code>k1=v1; k2=v2; ...</code>) using <a href=\"https://hackage.haskell.org/package/wreq-0.4.1.0\" rel=\"nofollow\">wreq</a>, but can't find a convenient way of creating them.</p>\n\n<p>Because <a href=\"https://hackage.haskell.org/package/http-client-0.4.27/docs/Network-HTTP-Client.html#t:Cookie\" rel=\"nofollow\">Cookie</a> has many fields, I'd prefer a smart constructor than having to fill all fields on my own.</p>\n\n<p>By browsing documents, I find <a href=\"https://hackage.haskell.org/package/http-client-0.4.27/docs/Network-HTTP-Client.html#v:generateCookie\" rel=\"nofollow\">generateCookie</a> to be the most promosing one (and that's also the only one I've found that returns a <code>Cookie</code>): I can create <code>SetCookie</code> and all I need are just key value pairs. But we don't have a <a href=\"https://hackage.haskell.org/package/http-client-0.4.27/docs/Network-HTTP-Client.html#t:Request\" rel=\"nofollow\">Request</a> to feed it as the second argument. Using http-client alone, one can do <a href=\"https://hackage.haskell.org/package/http-client-0.4.27/docs/Network-HTTP-Client.html#v:parseUrl\" rel=\"nofollow\">parseUrl</a> to create one. But in wreq I feel the author want to hide Request from user and I can't find a function that gives us direct access to it.</p>\n\n<p>So my question is: are there better ways to create cookies in wreq than using <code>Cookie</code> constructor?</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 1, "last_activity_date": 1454221296, "creation_date": 1454221296, "answer_id": 35111015, "question_id": 35110888, "link": "https://stackoverflow.com/questions/35110888/how-write-a-function-that-returns-values-of-different-types/35111015#35111015", "title": "How write a function that returns values of different types?", "body": "<p>There are two cases.  If you know what type you are expecting at any particular use of <code>rpcId2HaskellType</code> you could use a type class that works exactly like the <code>Read</code> type class.  </p>\n\n<p>The other case is if you need to analyze the result to know what type you have and then you do different logic depending on that.  In that case, an algebraic data type is probably the best way of representing that.  </p>\n\n<p>There is another approach for this latter case using existential data types, but it is almost always a bad idea.  The idea behind it isn't too terrible (and is very common in OO programming) which is to have the returned value \"know\" how to do whatever it is you want to do with it itself.  Then your code just becomes asking it to do that thing.  In FP, though, it's usually better to have data be dumb.</p>\n"}, {"tags": [], "owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "is_accepted": false, "score": 3, "last_activity_date": 1454224345, "creation_date": 1454224345, "answer_id": 35111312, "question_id": 35110888, "link": "https://stackoverflow.com/questions/35110888/how-write-a-function-that-returns-values-of-different-types/35111312#35111312", "title": "How write a function that returns values of different types?", "body": "<p>I believe what you're looking for is the <a href=\"https://hackage.haskell.org/package/aeson/docs/Data-Aeson.html#t:FromJSON\" rel=\"nofollow\">FromJSON</a> typeclass in aeson. </p>\n\n<p>So in your case: <code>rpcId2HaskellType :: FromJSON a =&gt; String -&gt; a</code></p>\n\n<p>However I'm willing to bet the <code>rpcId</code> has a consistent type in your protocol, so it should be up to your input functions to do that conversion.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1454233246, "creation_date": 1454233246, "answer_id": 35112366, "question_id": 35110888, "link": "https://stackoverflow.com/questions/35110888/how-write-a-function-that-returns-values-of-different-types/35112366#35112366", "title": "How write a function that returns values of different types?", "body": "<p>I am just guessing as I don't have enough information to proove it,  but I don't think you are asking the right question.</p>\n\n<p>I assume your JSON-RPC looks something like this:</p>\n\n<p><code>request.json</code></p>\n\n<pre><code>{ message-id: \"asec-ureh-asho-fcon-tent\"\n, content: { timestamp: \"2016-01-31T10:23:10.123456\"\n           , command: { name: \"mycommand\"\n                      , parameters: [..]\n                      }\n           }\n}\n</code></pre>\n\n<p><code>response.json</code></p>\n\n<pre><code>{ message-id: \"asec-ureh-asho-fthi-scon-tent\"\n, content: { timestamp: \"2016-01-31T10:26:10.123456\"\n           , result: {..}\n           , original-id: \"asec-ureh-asho-fcon-tent\"\n           }\n}\n</code></pre>\n\n<p>then I don't understand why you need to convert the <code>rpc-id</code> or <code>message-id</code> as this is just the hash of the content, this is most likely to be unique as it includes a (unique) timestamp as long as you leave out hash collisions of your considerations.</p>\n\n<p>For the command I would always use an algebraic data type (ADT) so my server side logic is captured in haskell and I want to restrict the execution of \"all\" commands to the set at hand.</p>\n\n<p>I don't think you want to avoid the writing of ADT's for this, but maybe think it's too much effort - which would lead me to an answer sidestepping your question and advise you to maybe write some template haskell that generates your ADTs for you.</p>\n\n<p>PS.: I am writing this, knowing that you already got two good answers that help you proceeding in the direction you are asking, but wanting to give you a different point of view.</p>\n\n<p>PPS.: <code>aeson</code> has some great capabilities to automatically derive the <code>fromJSON</code> and <code>toJSON</code> instances - see the <a href=\"https://hackage.haskell.org/package/aeson-0.10.0.0/docs/Data-Aeson.html\" rel=\"nofollow\">package description</a> for that. </p>\n"}, {"tags": [], "owner": {"reputation": 2540, "user_id": 1803897, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/921ed2f776bd064b49d8aadb378dd15a?s=128&d=identicon&r=PG", "display_name": "Roland Puntaier", "link": "https://stackoverflow.com/users/1803897/roland-puntaier"}, "is_accepted": false, "score": 0, "last_activity_date": 1593629431, "creation_date": 1593629431, "answer_id": 62683546, "question_id": 35110888, "link": "https://stackoverflow.com/questions/35110888/how-write-a-function-that-returns-values-of-different-types/62683546#62683546", "title": "How write a function that returns values of different types?", "body": "<p>In Haskell it is not possible to write a function that returns values of different types. The reason is that Haskell is statically typed.</p>\n<p>This fails:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>\n  :{\n  g 1 = 2\n  g 2 = &quot;3&quot;\n  :}\n\n</code></pre>\n<p>But you can create your own ADT type.</p>\n<p>This works:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>\n  data IntString = IString String | IntS Int deriving Show\n  :{\n  g :: Int -&gt; IntString\n  g 1 = IntS 2\n  g 2 = IString &quot;3&quot;\n  :}\n\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1593629431, "creation_date": 1454220195, "question_id": 35110888, "link": "https://stackoverflow.com/questions/35110888/how-write-a-function-that-returns-values-of-different-types", "title": "How write a function that returns values of different types?", "body": "<p>The title of the question asks the core question. Here's the context for <em>why</em> I need something like this.</p>\n\n<p>I'm dealing with a JSON-RPC interface over a Websocket. This means that the request-response cycle is completely asynchronous. When I send out a a request, I give it a unique ID, which the async-response includes (to help tie the request-response together).</p>\n\n<p>Now, I need to parse the response JSON to a Haskell object using Aeson. Whichever way I structure it, I will need a function having the following type-signature at some point in my code:</p>\n\n<pre><code>rpcId2HaskellType :: String -&gt; a\n</code></pre>\n\n<p>Where <code>a</code> is not every type under-the-sun, but a set of few known types that I'm expecting in response.</p>\n\n<p>One solution I could think of, was to create an algebraic data type and use that as the return type for <code>rpcId2HaskellType</code></p>\n\n<pre><code>data UnnecessaryAlgebraicDataType = ResponseType1 | ResponseType1 | ResponseType3\nrpcId2HaskellType :: String -&gt; UnnecessaryAlgebraicDataType\n</code></pre>\n\n<p>But, I'm not convinced that this is the best approach. Are there any other ways to do this?</p>\n"}, {"tags": ["haskell", "composition", "higher-order-functions"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1454233760, "post_id": 35109608, "comment_id": 57945357, "body": "modern swedes greet &quot;Hi&quot;!"}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 3, "last_activity_date": 1454231199, "last_edit_date": 1454231199, "creation_date": 1454208554, "answer_id": 35109780, "question_id": 35109608, "link": "https://stackoverflow.com/questions/35109608/how-swedish-is-a-very-very-swedish-greeting/35109780#35109780", "title": "How swedish is a very very swedish greeting?", "body": "<p>Function application is left associative, so</p>\n\n<pre><code>very very swedish greeting\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>((very very) swedish) greeting\n</code></pre>\n\n<hr>\n\n<p><code>very</code> has type <code>(t -&gt; t) -&gt; t -&gt; t</code>. <code>very</code> can be passed as the first argument to <code>very</code></p>\n\n<pre><code>very      :: (t        -&gt; t       ) -&gt; t        -&gt; t\n     very ::  (t -&gt; t) -&gt; (t -&gt; t)\nvery very ::                           (t -&gt; t) -&gt; (t -&gt; t)\n</code></pre>\n\n<p><code>very very</code> is also a function, it has the type <code>(t -&gt; t) -&gt; t -&gt; t</code>. Since <code>swedish</code> has the type <code>String -&gt; String</code> it can be passed to <code>very very</code>. The resulting function has type <code>String -&gt; String</code></p>\n\n<pre><code>((very very) swedish) :: String -&gt; String\n</code></pre>\n\n<p>A function with type <code>String -&gt; String</code> can be applied to <code>greeting :: String</code></p>\n\n<pre><code>(((very very) swedish) greeting) :: String\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7534, "user_id": 1175714, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/91812afdd697c55f3c594208b18a9817?s=128&d=identicon&r=PG", "display_name": "Braden Best", "link": "https://stackoverflow.com/users/1175714/braden-best"}, "edited": false, "score": 0, "creation_date": 1486457945, "post_id": 35109800, "comment_id": 71341451, "body": "Any reason why <code>very very x</code> doesn&#39;t create an infinite loop?"}], "tags": [], "owner": {"reputation": 11669, "user_id": 76123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c933fbb8685a083234fe385df8e9025f?s=128&d=identicon&r=PG", "display_name": "Daniel Pratt", "link": "https://stackoverflow.com/users/76123/daniel-pratt"}, "is_accepted": true, "score": 11, "last_activity_date": 1454208718, "creation_date": 1454208718, "answer_id": 35109800, "question_id": 35109608, "link": "https://stackoverflow.com/questions/35109608/how-swedish-is-a-very-very-swedish-greeting/35109800#35109800", "title": "How swedish is a very very swedish greeting?", "body": "<p>You said:</p>\n\n<blockquote>\n  <p>My (rather incomplete) understanding of Haskell syntax says that a space-separated sequence of expressions is interpreted as a function call, where the first expression is the function and the rest are the arguments.</p>\n</blockquote>\n\n<p>You are correct that this is not a complete understanding of what is actually going on. From your example:</p>\n\n<pre><code>very very swedish greeting\n</code></pre>\n\n<p>This is the same as:</p>\n\n<pre><code>((very very) swedish) greeting\n</code></pre>\n\n<p>This is because function application is left associative. Furthermore, every function in Haskell takes one input and returns one result. What you think of as functions accepting multiple inputs are, in reality, functions that accept a single input and return a function as their result.</p>\n\n<p>This also explains why arrows (->) delimit function inputs <em>and</em> results in function types. Consider the type of <code>++</code>:</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>This is the same as:</p>\n\n<pre><code>(++) :: [a] -&gt; ([a] -&gt; [a])\n</code></pre>\n\n<p>You may think of the <code>++</code> operator as taking two lists and returning a list, but in reality it is a function of one input (a list) that returns a function of one input (another list) that returns a list.</p>\n\n<p>Taken all together, you can hopefully see that <code>very very</code> is a valid expression by itself (and happens to have the same type as <code>very</code>).</p>\n\n<pre><code>very very x\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>very (very (very x))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 613, "user_id": 1212910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9e72454b7676b057e43180c752a92e?s=128&d=identicon&r=PG", "display_name": "matvore", "link": "https://stackoverflow.com/users/1212910/matvore"}, "is_accepted": false, "score": 1, "last_activity_date": 1536602992, "creation_date": 1536602992, "answer_id": 52263293, "question_id": 35109608, "link": "https://stackoverflow.com/questions/35109608/how-swedish-is-a-very-very-swedish-greeting/52263293#52263293", "title": "How swedish is a very very swedish greeting?", "body": "<p>Daniel Pratt's answer explains what is happening on the syntactic level. But  why does <code>(very very)</code> result in <code>swedish</code> being applied 27 times and not some other number? In order to figure this out, let's make a function that is more general than <code>very</code> which applies a function <code>n</code> times:</p>\n\n<pre><code>-- Takes number of times to apply `n` and a function `f`, and returns a\n-- function that applies `f` `n` times.\nappn n f\n  | n == 1    = f\n  | otherwise = f . (appn (n - 1) f)\n\n-- If necessary, you could define very = (appn 3)\nvery = (appn 3)\n</code></pre>\n\n<p>And let's stop using <code>swedish</code> and instead use <code>(+1)</code> so it's easier to count how many times the function is applied:</p>\n\n<pre><code>Vandelay Industries&gt; (appn 3) (appn 3) (+1) 0\n27\nVandelay Industries&gt; (appn 2) (appn 3) (+1) 0\n9\nVandelay Industries&gt; (appn 2) (appn 4) (+1) 0\n16\nVandelay Industries&gt; (appn 4) (appn 10) (+1) 0\n10000\nVandelay Industries&gt; (appn 2) (appn 2) (appn 2) (+1) 0\n16\n</code></pre>\n\n<p>You may see the pattern by now. <code>(appn x) (appn y)</code> generates the equivalent of <code>appn $ y ^ x</code>. But why? Consider <code>(appn 2) (appn 3)</code>. The <code>(appn 3)</code> means <code>f (f (f x))</code> or <code>f . f . f</code>. Put that through <code>(appn 2)</code> and each <code>f</code> is actually applied 3 times: <code>(f . f . f) . (f . f . f) . (f . f . f)</code> or 9 times total.</p>\n"}], "owner": {"reputation": 4104, "user_id": 2447250, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ugE5e.png?s=128&g=1", "display_name": "David Zhang", "link": "https://stackoverflow.com/users/2447250/david-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 1, "accepted_answer_id": 35109800, "answer_count": 3, "score": 7, "last_activity_date": 1536602992, "creation_date": 1454206676, "question_id": 35109608, "link": "https://stackoverflow.com/questions/35109608/how-swedish-is-a-very-very-swedish-greeting", "title": "How swedish is a very very swedish greeting?", "body": "<p>Consider the following Haskell definitions, taken from <a href=\"https://www.youtube.com/watch?v=RqvCNb7fKsg\">this excellent Haskell video on YouTube</a>:</p>\n\n<pre><code>import Data.List\ngreeting = \"Hello\"\nswedish = intersperse 'f'\nvery f x = f (f (f x))\n</code></pre>\n\n<p>If we load them into GHCi, we see the following results:</p>\n\n<pre><code>ghci&gt; swedish greeting\n\"Hfeflflfo\"\nghci&gt; very swedish greeting\n\"Hfffffffeffffffflffffffflfffffffo\"\nghci&gt; very very swedish greeting\n\"Hffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\nffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\nffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\nfffffffffffffffffffffffffffff... (536,870,913 chars total)\n</code></pre>\n\n<p>The first two outputs I understand perfectly. A <code>swedish greeting</code> comes out interspersed with <code>f</code>s, and a <code>very swedish greeting</code> is just a <code>swedish (swedish (swedish greeting))</code>, which comes out triply interspersed.</p>\n\n<p>But what exactly is happening in the third input line? My (rather incomplete) understanding of Haskell syntax says that a space-separated sequence of expressions is interpreted as a function call, where the first expression is the function and the rest are the arguments. In that case, how is the outermost <code>very</code> being called with three arguments (<code>very</code>, <code>swedish</code>, and <code>greeting</code>) when it's only defined to accept two?</p>\n\n<p>If it helps, it appears that a <code>very very swedish greeting</code> is equivalent to a <code>swedish $ swedish $ swedish $ swedish $  ... (27 layers of swedish) ... $ swedish $ swedish greeting</code>.</p>\n"}, {"tags": ["haskell", "tuples", "multiset"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1454205720, "creation_date": 1454205720, "answer_id": 35109517, "question_id": 35109437, "link": "https://stackoverflow.com/questions/35109437/string-to-multi-set-haskell/35109517#35109517", "title": "string to multi set haskell", "body": "<p>You are almost there.</p>\n\n<p>The problem is with your recursive call to the <code>convert</code> function. Since you have already computed the number of characters for a particular character, you don't need to calculate them again. Just use a <code>filter</code> function to remove that character out while calling to <code>convert</code>:</p>\n\n<pre><code>convert :: Eq a =&gt; [a] -&gt; MSet a\nconvert [] = []\nconvert (x:xs) = (x,1+count x xs) : convert (filter (\\y -&gt; y /= x) xs)\n  where count x [] = 0\n        count x (y:ys) = if (x == y) then 1 + count x ys else count x ys\n</code></pre>\n\n<p>Or written more concisely:</p>\n\n<pre><code>convert :: Eq a =&gt; [a] -&gt; MSet a\nconvert [] = []\nconvert (x:xs) = (x,1+count x xs) : convert (filter (/= x) xs)\n  where count x [] = 0\n        count x (y:ys) = if (x == y) then 1 + count x ys else count x ys\n</code></pre>\n\n<p>Demo in ghci:</p>\n\n<pre><code>ghci| &gt; convert \"bacaba\"\n[('b',2),('a',3),('c',1)]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 1, "last_activity_date": 1454208750, "last_edit_date": 1454208750, "creation_date": 1454207085, "answer_id": 35109643, "question_id": 35109437, "link": "https://stackoverflow.com/questions/35109437/string-to-multi-set-haskell/35109643#35109643", "title": "string to multi set haskell", "body": "<blockquote>\n  <p>what is the better way to do it?</p>\n</blockquote>\n\n<p>Your code performs <code>O(n^2)</code>; If the type is an instance of <code>Ord</code> type class (as in your example), using <a href=\"https://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-Map-Strict.html\" rel=\"nofollow\"><code>Data.Map</code></a> you may get an <code>O(n log n)</code> performance:</p>\n\n<pre><code>import Data.Map (toList, fromListWith)\n\nconvert :: (Ord a) =&gt; [a] -&gt; [(a, Int)]\nconvert xs = toList . fromListWith (+) . zip xs $ repeat 1\n</code></pre>\n\n<p>This would result in the right counts but the list would be sorted by the keys:</p>\n\n<pre><code>\\&gt; convert \"bacaba\"\n[('a',3),('b',2),('c',1)]\n</code></pre>\n\n<p>If you need to preserve the order, then </p>\n\n<pre><code>import qualified Data.Map as M\nimport Data.Map (delete, fromListWith)\n\nconvert :: (Ord a) =&gt; [a] -&gt; [(a, Int)]\nconvert xs = foldr go (const []) xs . fromListWith (+) . zip xs $ repeat 1\n    where\n    go x f cnt = case M.lookup x cnt of\n        Just i  -&gt; (x, i): f (x `delete` cnt)\n        Nothing -&gt; f cnt\n</code></pre>\n\n<p>which would output:</p>\n\n<pre><code>\\&gt; convert \"bacaba\"\n[('b',2),('a',3),('c',1)]\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3548437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3b40d2e910e9ef796071d4f39ace62?s=128&d=identicon&r=PG&f=1", "display_name": "simon paul", "link": "https://stackoverflow.com/users/3548437/simon-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 35109643, "answer_count": 2, "score": 1, "last_activity_date": 1454257602, "creation_date": 1454204838, "question_id": 35109437, "link": "https://stackoverflow.com/questions/35109437/string-to-multi-set-haskell", "title": "string to multi set haskell", "body": "<p>Convert string to multi set as the example below:</p>\n\n<p>\"bacaba\" --> [(b,2),(a,3),(c,1)]</p>\n\n<pre><code>type MSet a = [(a,Int)]\n\nconvert :: Eq a =&gt; [a] -&gt; MSet\n</code></pre>\n\n<p>what is wrong with my code and what is the better way to do it? ty</p>\n\n<pre><code>convert :: Eq a =&gt; [a] -&gt; MSet a\nconvert [] = []\nconvert (x:xs) = ((x,1+count x xs) : converte xs) \n  where count x [] = 0\n        count x (y:ys) = if (x == y) then 1 + count x ys else count x ys\n</code></pre>\n"}, {"tags": ["sqlite", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "is_accepted": false, "score": 1, "last_activity_date": 1454199013, "creation_date": 1454199013, "answer_id": 35108790, "question_id": 35108630, "link": "https://stackoverflow.com/questions/35108630/how-to-query-with-sqlite-simple-without-having-to-specify-a-concrete-return-ty/35108790#35108790", "title": "How to query with `sqlite-simple` without having to specify a concrete return type?", "body": "<p>Okay, I've found a crude way, by going one level deeper, using <code>direct-sqlite</code>, the package that <code>sqlite-simple</code> builds on top of.</p>\n\n<pre><code>import           Database.SQLite.Simple\nimport           Database.SQLite3.Direct (exec, execWithCallback)\n\nlet sql = \"SELECT * FROM table LIMIT 3\"\nlet cb count names vals = print vals\nexecWithCallback (connectionHandle conn) sql cb\n</code></pre>\n\n<p>Which in my case prints something like:</p>\n\n<pre><code>[Just \"1\",Just \"2016-01-23 11:25:39.16759\",Just \"val1\"]\n[Just \"2\",Just \"2016-01-23 11:25:40.266674\",Just \"val2\"]\n[Just \"3\",Just \"2016-01-23 11:25:41.396901\",Just \"val3\"]\n</code></pre>\n\n<p>If anyone else knows of a better way, please do share! </p>\n"}, {"tags": [], "owner": {"reputation": 299, "user_id": 45461, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b840aa3cef2f5331e97d8ab353e4f839?s=128&d=identicon&r=PG", "display_name": "Nurpax", "link": "https://stackoverflow.com/users/45461/nurpax"}, "is_accepted": false, "score": 0, "last_activity_date": 1482877872, "creation_date": 1482877872, "answer_id": 41352999, "question_id": 35108630, "link": "https://stackoverflow.com/questions/35108630/how-to-query-with-sqlite-simple-without-having-to-specify-a-concrete-return-ty/41352999#41352999", "title": "How to query with `sqlite-simple` without having to specify a concrete return type?", "body": "<p>Sorry for not scanning for questions related to my library earlier.  </p>\n\n<p>Here is one way to print out the raw SQLite values coming out of a SELECT query.  It's not super clean or obvious.</p>\n\n<p>The idea is to define a debug type <code>DebugShowType</code> and a <code>FromField</code> instance for it that will convert every SQLite row/column into a string.</p>\n\n<pre><code>newtype DebugShowType = DebugShowType String deriving (Eq, Show, Typeable)\n\ninstance FromField DebugShowType where\n  fromField f = cvt f . fieldData $ f where\n    cvt _ v = Ok $ DebugShowType (show v)\n\ntestShowRawValues :: IO ()\ntestShowRawValues = do\n  elems &lt;- query_ conn \"SELECT 13, 'foo'\" :: IO [[DebugShowType]]\n  mapM_ (\\v -&gt; putStrLn (show v ++ \"\\n\"))  elems\n</code></pre>\n\n<p>This should print something like:</p>\n\n<pre><code>[DebugShowType \"SQLInteger 13\",DebugShowType \"SQLText \\\"foo\\\"\"]\n</code></pre>\n\n<p>The <code>Database.SQLite.Simple.setTrace</code> can also be useful for tracing what values get substituted into your SQL queries.</p>\n"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482877872, "creation_date": 1454197699, "question_id": 35108630, "link": "https://stackoverflow.com/questions/35108630/how-to-query-with-sqlite-simple-without-having-to-specify-a-concrete-return-ty", "title": "How to query with `sqlite-simple` without having to specify a concrete return type?", "body": "<p>Anyone knows if <a href=\"http://hackage.haskell.org/package/sqlite-simple-0.4.9.0/docs/Database-SQLite-Simple.html\" rel=\"nofollow\">http://hackage.haskell.org/package/sqlite-simple-0.4.9.0/docs/Database-SQLite-Simple.html</a> can run a <code>query</code> or <code>query_</code> where the rows can be printed without explicitly specifying a return type tuple, for debugging purposes?</p>\n\n<p>Or if not with this package, maybe with another?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1454192255, "post_id": 35107662, "comment_id": 57936691, "body": "<code>perm digits</code> returns only lists of length 10, but <code>list@[s,e,n,d,m,o,r,y] &lt;- perm digits</code> requires that <code>list</code> be of length 8. This causes a pattern match failure. A quick fix could be to use <code>list@[s,e,n,d,m,o,r,y,_,_] &lt;- perm digits</code> instead."}, {"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1454192627, "post_id": 35107662, "comment_id": 57936818, "body": "@rampion Thank you very much!"}, {"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1454193116, "post_id": 35107662, "comment_id": 57936980, "body": "@rampion I can see that output produces some extra numbers, such as 3 and 4, which should not be included in the result, because the solution is: 9567+1085=10652 ([9,5,6,7,1,0,8,2]) Do you have any suggestions how this can be fixed? Thanks!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1454197656, "post_id": 35107662, "comment_id": 57938183, "body": "cf also <a href=\"https://stackoverflow.com/questions/14873315/dynamic-list-comprehension-in-haskell/\" title=\"dynamic list comprehension in haskell\">stackoverflow.com/questions/14873315/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "edited": false, "score": 0, "creation_date": 1454193363, "post_id": 35108042, "comment_id": 57937060, "body": "Thank you very much for a very detailed answer!"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 1, "last_activity_date": 1454193455, "last_edit_date": 1454193455, "creation_date": 1454193264, "answer_id": 35108042, "question_id": 35107662, "link": "https://stackoverflow.com/questions/35107662/verbal-arithmetics-in-haskell-send-more-money/35108042#35108042", "title": "Verbal Arithmetics in Haskell (SEND + MORE = MONEY)", "body": "<p>The main problem is that <code>perm digits</code> returns only lists of length 10, but <code>list@[s,e,n,d,m,o,r,y] &lt;- perm</code> digits requires that list be of length 8. This causes a pattern match failure.</p>\n\n<p>Pattern match failures are silent in list comprehensions - they're useful for filtering input (specifyingy you only care about matches), which can cause issues at times.</p>\n\n<p>A quick fix could be to use <code>[ [s,e,n,d,m,o,r,y] | list@[s,e,n,d,m,o,r,y,_,_] &lt;- perm digits, ... ]</code> instead.</p>\n\n<p>Some other suggestions:</p>\n\n<ul>\n<li>You can replace <code>expand'</code> and <code>expand''</code> by a single <code>expand</code>. It looks like you're using this as a learning expereince, so I'll just give you a hint: <code>expand [s,e,n,d] + expand [m,o,r,e] == expand [m,o,n,e,y]</code></li>\n<li><code>del</code> is somewhat deceptively named. It doesn't delete anything, it just creates all the possible views <code>(x_j, [x_0,...,x_{j-1},x_{j+1},...x_{n-1}])</code> of an <code>n</code>-length list <code>[x_0,...,x_{n-1}]</code></li>\n<li>You <em>could</em> write a version of perm that took another parameter specifying the number of elements in the permutation, so <code>perm k [1..n]</code> returned all the permutations of <code>k</code> distinct elements drawn from <code>[1..n]</code>. If you wanted to generate ALL the solutions, this might be helpful.</li>\n</ul>\n"}], "owner": {"reputation": 113, "user_id": 4793410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I3zVN.jpg?s=128&g=1", "display_name": "Vladyslav Babych", "link": "https://stackoverflow.com/users/4793410/vladyslav-babych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 35108042, "answer_count": 1, "score": 1, "last_activity_date": 1454193455, "creation_date": 1454191188, "question_id": 35107662, "link": "https://stackoverflow.com/questions/35107662/verbal-arithmetics-in-haskell-send-more-money", "title": "Verbal Arithmetics in Haskell (SEND + MORE = MONEY)", "body": "<p>I am trying to implement famous Verbal arithmetics problem (SEND + MORE = MONEY) in Haskell. For those who don't know about verbal arithmetics- <a href=\"https://en.wikipedia.org/wiki/Verbal_arithmetic\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Verbal_arithmetic</a>.</p>\n\n<p>This is my sample program, however for some reason it does not work, it returns an empty list. Could anyone point out the flaw in the code and give some suggestions? I am stuck, thank you! </p>\n\n<pre><code>expand' a b c d e = e + d*10 + c*100 + b*1000 + a*10000\nexpand'' a b c d = d + c*10 + b*100 + a*1000\n\ndigits = [0,1..9]  -- all the digits\n\nanswer = head [ list | list@[s,e,n,d,m,o,r,y] &lt;- perm digits,\n   expand'' s e n d +  expand'' m o r e == expand' m o n e y]\n\n--unique permutation\nperm :: [t] -&gt; [[t]]\nperm [] = [[]]\nperm (x:xs) = [(y:zs) | (y,ys) &lt;- del (x:xs), zs &lt;- perm ys]\n\n--deleting duplicates\ndel :: [t] -&gt; [(t,[t])]\ndel [] = []\ndel (x:xs) = ((x,xs) : [ (y,(x:ys)) | (y,ys) &lt;- del xs ])\n\n\nmain :: IO()\nmain = do\n   print  answer\n</code></pre>\n\n<p>The solution was inspired by: <a href=\"http://www.dcs.gla.ac.uk/mail-www/haskell/msg01929.html\" rel=\"nofollow\">http://www.dcs.gla.ac.uk/mail-www/haskell/msg01929.html</a></p>\n"}, {"tags": ["haskell", "functional-programming", "finite-group-theory"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4638556"}, "edited": false, "score": 0, "creation_date": 1454201778, "post_id": 35107333, "comment_id": 57939097, "body": "I wrote this: <a href=\"http://pastebin.com/hpDi9Ki9\" rel=\"nofollow noreferrer\">pastebin.com/hpDi9Ki9</a> and got it: <a href=\"http://pastebin.com/Ln99DYnQ\" rel=\"nofollow noreferrer\">pastebin.com/Ln99DYnQ</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4638556"}, "edited": false, "score": 0, "creation_date": 1454263647, "post_id": 35107333, "comment_id": 57955136, "body": "Thank you, you helped me a lot! Is there a place where I can read more about similar issues? Can you tell me what means &quot;forall a .&quot; ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1454265668, "post_id": 35107333, "comment_id": 57955948, "body": "Basically, the universla quantifier <code>forall a .  ...</code> states that the caller can choose <code>a</code> to be whatever it wants. Note that, in this particular case, omitting <code>forall a .</code> does not change the type: the caller would be able to choose <code>a</code> anyway. However, GHC handles this redundant quantifier to mean &quot;note the <code>a</code> as chosen by the caller -- if below I use <code>a</code> again, I&#39;m referring to such chosen type` For the gory details you can read <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/other-type-extensions.html#scoped-type-variables\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1454233009, "last_edit_date": 1454233009, "creation_date": 1454189309, "answer_id": 35107333, "question_id": 35107108, "link": "https://stackoverflow.com/questions/35107108/use-the-functions-defined-in-the-class/35107333#35107333", "title": "use the functions defined in the class", "body": "<blockquote>\n  <p>I cant use the identity and set, how to use it?</p>\n</blockquote>\n\n<p>You must use them in a context which defines <code>a</code> unambiguously. E.g. providing an explicit type annotation</p>\n\n<pre><code>set :: [Z2]\nidentity :: Z2\n</code></pre>\n\n<p>Passing them to some function requiring a <code>Z2</code> also works. As long as the compiler can figure out which finite group you are talking about, you will be fine. Otherwise, you'll get an \"ambiguous ...\" error.</p>\n\n<blockquote>\n  <p>How to replace signatures in function and again how to use identity and set in function which I've already defined.</p>\n</blockquote>\n\n<p>Try e.g.</p>\n\n<pre><code>cyclicGenerators :: (Eq a, FiniteGroup a) =&gt; [a]\ncyclicGenerators = filter isGenerator set\n  where isGenerator x = ...  -- a Boolean telling whether it's a generator\n</code></pre>\n\n<p>Above the compiler \"knows\" that <code>set</code> refers to the finite group <code>a</code>, since we must return an <code>[a]</code> and <code>filter</code> doesn't change the type of the input list, hence the <code>set</code> must be of type <code>[a]</code> as well. Here type inference works very well in propagating types so that the correct finite group instance is selected.</p>\n\n<hr>\n\n<p>Edit: the OP proposes the code</p>\n\n<pre><code>cyclicGenerators :: (FiniteGroup a) =&gt; [a]\ncyclicGenerators = filter isGenerator set\n        where isGenerator = (\\x -&gt; groupOrder set == elemOrder x)\n</code></pre>\n\n<p>which triggers an ambiguity error. Indeed, the last <code>set</code> is not forced to belong to the same group -- it would make sense to compare the group order of another group to the order of <code>x</code>. E.g. <code>groupOrder (set :: [Z5]) == elemOrder (identity :: [Z2])</code> would type check, since both are integers.</p>\n\n<p>So we need to state that the type of that <code>set</code> is <code>[a]</code>. The plain Haskell way is</p>\n\n<pre><code> where isGenerator = (\\x -&gt; groupOrder (set `asTypeOf` [x]) == elemOrder x)\n</code></pre>\n\n<p>where <code>asTypeOf</code> is a library function which simply returns its first argument, but requires it shares its type with the second argument. It is defined in the libraries as:</p>\n\n<pre><code>asTypeOf :: t -&gt; t -&gt; t\nasTypeOf x y = x\n</code></pre>\n\n<p>Alternatively, we can exploit a very commonly used extension of GHC Haskell. First, we need to enable it by adding</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n</code></pre>\n\n<p>at the <em>top</em> of the module file. Then, we can simply write</p>\n\n<pre><code>cyclicGenerators :: forall a . (FiniteGroup a) =&gt; [a]\n                 -- ^^^^^^^^^^ added\ncyclicGenerators = filter isGenerator set\n        where isGenerator = (\\x -&gt; groupOrder (set :: [a]) == elemOrder x)\n</code></pre>\n\n<p>where we explicit state that <code>set</code> is of type <code>[a]</code>, so it belongs to the same group.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4638556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 35107333, "answer_count": 1, "score": 1, "last_activity_date": 1454233009, "creation_date": 1454188019, "last_edit_date": 1454193812, "question_id": 35107108, "link": "https://stackoverflow.com/questions/35107108/use-the-functions-defined-in-the-class", "title": "use the functions defined in the class", "body": "<p>I'm writing a program for representation of finite groups and simple operations on their elements. I wrote most of the functionality which I need, for example inverse elements, generators, checking if subset is subgroup etc. </p>\n\n<p>Unfortunately all my functions need identity element, set and operation. I want to define the appropriate instance of the class and use it instead of this trio. And here begins my problem, I don't quite know how to go about it and all I can find on the internet contains only examples of definitions, without usage examples.</p>\n\n<p>Eventually I would like to work with groups <code>Sn</code>, so far I've tested my code on (<code>Zn +</code>).</p>\n\n<p>I wrote this:</p>\n\n<pre><code>data Z2 = Elm Int deriving (Show, Eq)\nz2 :: Int -&gt; Z2\nz2 a = Elm (a `mod` 2)\n\nclass FiniteGroup a where\n    identity :: a\n    op :: a -&gt; a -&gt; a -- operation\n    set :: [a]\n\ninstance FiniteGroup Z2 where\n    identity = (Elm 0)\n    op (Elm x) (Elm y) = z2 (x+y)\n    set = [(Elm 0), (Elm 1)]\n</code></pre>\n\n<p>And it works fine for the function <code>op</code>, for example:</p>\n\n<pre><code>*Main&gt; (Elm 1) `op` (Elm 0)\nElm 1\n</code></pre>\n\n<p>Unfortunately, I cant use <code>identity</code> and <code>set</code>. How do I use it?</p>\n\n<p>I also can't figure out how to refactor an existing function to use my type class.</p>\n\n<p>For example I have this:</p>\n\n<pre><code>cyclicGenerators :: (Eq a) =&gt; a -&gt; [a] -&gt; (a -&gt; a -&gt; a) -&gt; [a]\n</code></pre>\n\n<p>and it works fine, but I want to have something like this:</p>\n\n<pre><code>cyclicGenerators :: (Eq a) =&gt; FiniteGroup a -&gt; [a]\n</code></pre>\n"}, {"tags": ["json", "haskell", "base64", "bytestring"], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 2, "last_activity_date": 1454224314, "creation_date": 1454224314, "answer_id": 35111308, "question_id": 35107076, "link": "https://stackoverflow.com/questions/35107076/is-my-tojson-base64-instance-sane-what-would-fromjson-instance-look-like/35111308#35111308", "title": "Is my ToJSON Base64 instance sane? What would FromJSON instance look like?", "body": "<p>I have done this exercise before: <a href=\"https://github.com/futurice/haskell-base64-bytestring-type/blob/0a1176d16c71c219fe113bc3f130f64d8dda47bc/src/Data/ByteString/Base64/Type.hs#L46-L51\" rel=\"nofollow\">https://github.com/futurice/haskell-base64-bytestring-type/blob/0a1176d16c71c219fe113bc3f130f64d8dda47bc/src/Data/ByteString/Base64/Type.hs#L46-L51</a></p>\n\n<pre><code>-- | Get base64 encoded bytestring\ngetEncodedByteString64 :: ByteString64 -&gt; ByteString\ngetEncodedByteString64 = Base64.encode . getByteString64\n\ninstance ToJSON ByteString64 where\n    toJSON = toJSON . decodeLatin1 . getEncodedByteString64\n\ninstance FromJSON ByteString64 where\n    parseJSON = withText \"ByteString\" $\n        pure . ByteString64 . decodeLenient . encodeUtf8\n</code></pre>\n\n<hr>\n\n<p>After closer look, seems that you encode <code>ByteString</code> (any) as an array of 'Word8', (this what <code>BS.unpack</code> returns) for that you could do, and have an <em>encoded</em> bytestring in <code>Base64</code>:</p>\n\n<pre><code>instance ToJSON Base64 where\n    toJSON = toJSON . B.unpack . B64.decodeLenient . toByteString\n\ninstance FromJSON Base64 where\n    parseJSON = fmap (Base64 . B64.encode . B.pack) . parseJSON\n</code></pre>\n\n<p>This way you don't have to worry how <code>[Word8]</code> is encoded, as far as it's decoded accordinly.</p>\n\n<p>If you like to handle array manually, then it would look like:</p>\n\n<pre><code>instance FromJSON Base64 where\n    parseJSON (Array a) = do\n        a' &lt;- traverse parseJSON a  -- :: Parser (V.Vector Word8)\n        return $ Base64 . B64.encode . B.pack . V.toList $ a'\n    parseJSON _ = fail \"Array expected\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>instance FromJSON Base64 where\n    parseJSON = withArray \"Base64\" $ \\a -&gt; do\n        a' &lt;- traverse parseJSON a  -- :: Parser (V.Vector Word8)\n        return $ Base64 . B64.encode . B.pack . V.toList $ a'\n</code></pre>\n"}], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 35111308, "answer_count": 1, "score": 0, "last_activity_date": 1454224314, "creation_date": 1454187825, "question_id": 35107076, "link": "https://stackoverflow.com/questions/35107076/is-my-tojson-base64-instance-sane-what-would-fromjson-instance-look-like", "title": "Is my ToJSON Base64 instance sane? What would FromJSON instance look like?", "body": "<p>I'm trying to encode a Base64 to JSON. I came across <a href=\"https://github.com/bos/aeson/issues/187\" rel=\"nofollow\">this</a> dialogue. I noticed snoyberg has already included the <code>Base64</code> <code>newtype</code> in the FP Complete codebase, so I thought I would give that a try.</p>\n\n<blockquote>\n  <p>import qualified Data.ByteString        as B</p>\n  \n  <p>import qualified Data.ByteString.Base64 as B64</p>\n  \n  <p>newtype Base64 = Base64 { toByteString :: B.ByteString }<br>\n     deriving ( Eq, Ord, Show,IsString)</p>\n</blockquote>\n\n<p>The <code>ToJSON</code> instance seemed simple enough. I'd appreciate a sanity check.</p>\n\n<blockquote>\n  <p>instance ToJSON Base64 where\n     toJSON (Base64 bs) =<br>\n       toJSON $ B.unpack $ B64.decodeLenient bs</p>\n</blockquote>\n\n<p>The FromJSON instance is where I run into problems.</p>\n\n<p>Studying other examples I surmise I must use <code>withArray</code> which wants a <code>(Array -&gt; Parser a)</code>. This is where I get stuck.</p>\n\n<blockquote>\n  <p>parseBase64 :: Array -> Parser</p>\n  \n  <p>parseBase64 (Array a) = ...</p>\n</blockquote>\n\n<p>I've tried many approaches here, I'm confused as to what needs to happen here or even if I'm on the right track at all. If I could get some feedback as simple as \"you're on the right track keep going\", or being pointed in a different direction, that would be appreciated. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2337, "user_id": 4278243, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IUMpR.jpg?s=128&g=1", "display_name": "Aleksander Monk", "link": "https://stackoverflow.com/users/4278243/aleksander-monk"}, "edited": false, "score": 2, "creation_date": 1454170815, "post_id": 35103820, "comment_id": 57928943, "body": "Thank you for your answer! Now I know what exactly I need, so I can try to understand it and write my own implementation!"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 12, "last_activity_date": 1454171293, "last_edit_date": 1454171293, "creation_date": 1454169532, "answer_id": 35103820, "question_id": 35103739, "link": "https://stackoverflow.com/questions/35103739/haskell-combination-with-repetitions-permutations/35103820#35103820", "title": "Haskell, combination with repetitions + permutations", "body": "<p>That is called <strong>sampling with replacement</strong>. In haskell you may utilize <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:replicateM\"><code>replicateM</code></a> and monadic behaviour of lists (i.e. <em>non-deterministic</em> computations)</p>\n\n<pre><code>\\&gt; import Control.Monad (replicateM)\n\\&gt; length $ replicateM 4 [1..5]   -- should output 5^4\n625\n\\&gt; replicateM 4 [1..5]\n[[1,1,1,1],[1,1,1,2],[1,1,1,3],[1,1,1,4],[1,1,1,5],[1,1,2,1],[1,1,2,2],[1,1,2,3],[1,1,2,4],[1,1,2,5]] ....\n</code></pre>\n\n<p>If you want to have a sample of size 4 from a population of size 5 with replacement, then for each of the 4 items you have 5 choices; so you are <em>replicating</em> each of the <code>[1..5]</code> 4 times, hence <code>replicateM 4</code>.</p>\n\n<p>The <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#t:Monad\"><code>Monad</code> type class</a> (i.e. the <code>M</code> part) says that you should be able to <em>bind</em> these intermediate values together.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.Base.html#line-726\">The list instance of monad type class</a> models <em>non-determinism</em>. i.e it says that each item is non-deterministic but it can be one of <code>[1..5]</code> values, and to <em>bind</em> them together take an <em>outer product</em> of all the non-deterministic values; because if you have 4 items each taking 5 possible values then you have <code>5^4</code> possible final outputs.</p>\n"}], "owner": {"reputation": 2337, "user_id": 4278243, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IUMpR.jpg?s=128&g=1", "display_name": "Aleksander Monk", "link": "https://stackoverflow.com/users/4278243/aleksander-monk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1692, "favorite_count": 1, "accepted_answer_id": 35103820, "answer_count": 1, "score": 6, "last_activity_date": 1454171293, "creation_date": 1454169053, "question_id": 35103739, "link": "https://stackoverflow.com/questions/35103739/haskell-combination-with-repetitions-permutations", "title": "Haskell, combination with repetitions + permutations", "body": "<p>Lets say I have a list with elements, for example <code>[1,2,3,4,5,6,7,8]</code>. \nI want to create all permutations of this elements with length N.</p>\n\n<p>So, for <code>N = 4</code> it will be \n<code>[[1,1,1,1],[1,1,1,2],[1,1,2,1],[1,2,1,1],[2,1,1,1],..]</code> and so on.</p>\n\n<pre><code>comb :: Int -&gt; [a] -&gt; [[a]]\ncomb 0 _ = [[]]\ncomb _ [] = []\ncomb m (x:xs) = map (x:) (comb (m-1) xs) ++ comb m xs\n</code></pre>\n\n<p>Now, to get this lists first I find all combinations with repetitions for my list,\nso <code>[[1,1,1,1],[1,1,1,2],[1,1,1,3],[1,1,1,4],[1,1,1,5],...]</code> and for each list I find all permutations and if permutation is not in the list I add it to the list.</p>\n\n<pre><code>permutations1 :: Eq a =&gt; [a] -&gt; [[a]]\npermutations1 []   = [[]]\npermutations1 list = [(x:xs) | x &lt;- list, xs &lt;- permutations1 $ delete1 x list]\n\ndelete1:: Eq a =&gt; a -&gt; [a] -&gt; [a]\ndelete1 _ [] = [] \ndelete1 a (b:bc) | a == b = bc \n                 | otherwise = b : delete1 a bc\n</code></pre>\n\n<p>And that's how I get wanted answer.</p>\n\n<p>I understand that it is really(really) bad, but I don't understand haskell enough to write function that will combine these functions.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1454174069, "post_id": 35103559, "comment_id": 57930178, "body": "Put them at the top level. Every <code>let</code> and <code>where</code> must be associated with precisely one declaration - there is no way to &quot;share&quot; a <code>let</code> among all the declarations in a class, or among any declarations at all."}], "answers": [{"tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 2, "last_activity_date": 1454183460, "creation_date": 1454183460, "answer_id": 35106335, "question_id": 35103559, "link": "https://stackoverflow.com/questions/35103559/auxiliary-functions-when-defining-instances-in-haskell-how-to-group/35106335#35106335", "title": "Auxiliary functions when defining instances in Haskell, how to group?", "body": "<p>No. <code>let</code> and <code>where</code> can only be used in one expression or declaration by design. If you want to use them as auxiliary functions for more than one declaration simply put them at top level:</p>\n\n<pre><code>zmnoziKoef :: [Rational] -&gt; [Rational] -&gt; [Rational]\nzmnoziKoef _ [] = []\nzmnoziKoef [] _ = []\nzmnoziKoef (x:xs) (y:ys) = (x * y) : pomnoziKoef x ys `sestejKoef` (xs `zmnoziKoef` (y:ys))\n\nsestejKoef :: [Rational] -&gt; [Rational] -&gt; [Rational]\nsestejKoef xs [] = xs\nsestejKoef [] ys = ys\n\nsestejKoef (x:xs) (y:ys) = (x + y):(sestejKoef xs ys)\n\npomnoziKoef :: Rational -&gt; [Rational] -&gt; [Rational]\npomnoziKoef a = map (a *) \n\ninstance Num Polinom where\n    negate (Polinom koef) = Polinom $ pomnoziKoef (-1) koef\n    (Polinom koef1) + (Polinom koef2) = Polinom $ sestejKoef koef1 koef2\n    (Polinom koef1) * (Polinom koef2) = Polinom $ zmnoziKoef koef1 koef2\n    fromInteger x = Polinom $ [fromInteger x]\n</code></pre>\n\n<p>If you want this to be kept private to the module you can simply avoid exporting them by using an export list:</p>\n\n<pre><code>module MyModule(funcA, funcB, funcC) where\n...\n</code></pre>\n\n<p>In the above code only <code>funcA</code>, <code>funcB</code> and <code>funcC</code> will be exported when importing the module (plus all instances).</p>\n"}], "owner": {"reputation": 3, "user_id": 5861374, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193455937348938/picture?type=large", "display_name": "Kevin \u0160tampar", "link": "https://stackoverflow.com/users/5861374/kevin-%c5%a0tampar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 35106335, "answer_count": 1, "score": 0, "last_activity_date": 1454183460, "creation_date": 1454168031, "question_id": 35103559, "link": "https://stackoverflow.com/questions/35103559/auxiliary-functions-when-defining-instances-in-haskell-how-to-group", "title": "Auxiliary functions when defining instances in Haskell, how to group?", "body": "<pre><code>instance Num Polinom where\n    let\n        zmnoziKoef :: [Rational] -&gt; [Rational] -&gt; [Rational]\n        zmnoziKoef _ [] = []\n        zmnoziKoef [] _ = []\n        zmnoziKoef (x:xs) (y:ys) = (x * y) : pomnoziKoef x ys `sestejKoef` (xs `zmnoziKoef` (y:ys))\n        sestejKoef :: [Rational] -&gt; [Rational] -&gt; [Rational]\n        sestejKoef xs [] = xs\n        sestejKoef [] ys = ys\n        sestejKoef (x:xs) (y:ys) = (x + y):(sestejKoef xs ys)\n        pomnoziKoef :: Rational -&gt; [Rational] -&gt; [Rational]\n        pomnoziKoef a = map (a *) \n\n    negate (Polinom koef) = Polinom $ pomnoziKoef (-1) koef\n    (Polinom koef1) + (Polinom koef2) = Polinom $ sestejKoef koef1 koef2\n    (Polinom koef1) * (Polinom koef2) = Polinom $ zmnoziKoef koef1 koef2\n    fromInteger x = Polinom $ [fromInteger x]\n</code></pre>\n\n<p>So this code works, but is there a way to make a group of auxiliary functions, so that I don't have to write them after every definition.</p>\n\n<p>Like this:</p>\n\n<pre><code>instance Num Polinom where\n    negate (Polinom koef) = Polinom $ pomnoziKoef (-1) koef\n    (Polinom koef1) + (Polinom koef2) = Polinom $ sestejKoef koef1 koef2\n    (Polinom koef1) * (Polinom koef2) = Polinom $ zmnoziKoef koef1 koef2\n    fromInteger x = Polinom $ [fromInteger x]\n        where\n            zmnoziKoef :: [Rational] -&gt; [Rational] -&gt; [Rational]\n            zmnoziKoef _ [] = []\n            zmnoziKoef [] _ = []\n            zmnoziKoef (x:xs) (y:ys) = (x * y) : pomnoziKoef x ys `sestejKoef` (xs `zmnoziKoef` (y:ys))\n\n            sestejKoef :: [Rational] -&gt; [Rational] -&gt; [Rational]\n            sestejKoef xs [] = xs\n            sestejKoef [] ys = ys\n\n            sestejKoef (x:xs) (y:ys) = (x + y):(sestejKoef xs ys)\n\n            pomnoziKoef :: Rational -&gt; [Rational] -&gt; [Rational]\n            pomnoziKoef a = map (a *) \n</code></pre>\n"}, {"tags": ["string", "haskell", "parsec"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1454164771, "post_id": 35102864, "comment_id": 57926935, "body": "Please make your code self-contained. In particular, add the required imports."}, {"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1454165319, "post_id": 35102864, "comment_id": 57927166, "body": "oh ok, sorry, will do it"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1454166302, "post_id": 35102864, "comment_id": 57927470, "body": "you can ignore the compiler warning or add a case <code>_ -&gt; undefined</code> to shut up the compiler (it&#39;s fine from a logical standpoint) - aside from this your code works for me just fine <code>parseTest parseString &quot;\\&quot;\\\\\\&quot;hallo\\\\\\&quot;\\&quot;&quot;</code> returns the complete <i>inner</i> string: <code>String &quot;\\&quot;hallo\\&quot;&quot;</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1454166464, "post_id": 35102864, "comment_id": 57927514, "body": "btw: if you write <code>[ &#39;\\\\&#39;, &#39;\\&quot;&#39; ]</code> it&#39;s far more readable (than <code>&quot;\\\\\\&quot;&quot;</code>) IMO (just as you did for <code>oneOf</code>)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1454166567, "post_id": 35102864, "comment_id": 57927541, "body": "also: your example works too but of course you have to input it as <code>&quot;\\&quot;some\\\\\\&quot;someString\\&quot;&quot;</code> into GHCi (yeah you must escape your escapses ;) )"}, {"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "edited": false, "score": 0, "creation_date": 1454166789, "post_id": 35102864, "comment_id": 57927600, "body": "ohhh, I was testing it wrong then, it was &quot;\\&quot;some\\&quot;string\\&quot;&quot;"}, {"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "edited": false, "score": 0, "creation_date": 1454166826, "post_id": 35102864, "comment_id": 57927610, "body": "thanks you :D, is there a better way to test these strings? I think that in the command line I would probably have to do that as well, right?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454166901, "post_id": 35102864, "comment_id": 57927634, "body": "if you get it from stdin? No you would not have to"}, {"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "edited": false, "score": 0, "creation_date": 1454166957, "post_id": 35102864, "comment_id": 57927653, "body": "yes, ah ok, I will try it"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1454179917, "post_id": 35102864, "comment_id": 57932295, "body": "Note that <code>&#39;&quot;&#39;</code> and <code>&#39;\\&quot;&#39;</code> are equivalent. I&#39;m saying this since you use both in your code."}, {"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "edited": false, "score": 0, "creation_date": 1454192339, "post_id": 35102864, "comment_id": 57936722, "body": "oh really?  is that always the same? in the case for &#39;a&#39; &#39;\\a&#39; as well."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1454217745, "post_id": 35102864, "comment_id": 57942180, "body": "@lhahn <code>&#39;\\&quot;</code>&#39; and <code>&#39;&quot;&#39;</code> are equivalent: the double quote needs not be escaped in a character literal, since the delimiter for character literals is a single quote (as opposed to a double quote for strings). However, <code>&#39;\\a&#39;</code> (BELL) and <code>&#39;a&#39;</code> (lowercase letter A) are <i>not</i> equivalent."}], "answers": [{"comments": [{"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "edited": false, "score": 0, "creation_date": 1454240845, "post_id": 35111014, "comment_id": 57947296, "body": "Thanks for the trick with <code>show</code>, that makes it a lot easier to test!"}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 1, "last_activity_date": 1454221296, "creation_date": 1454221296, "answer_id": 35111014, "question_id": 35102864, "link": "https://stackoverflow.com/questions/35102864/haskell-string-parser-not-recognizing-escaped-double-quote/35111014#35111014", "title": "Haskell: String parser not recognizing escaped double-quote", "body": "<p>I don't see any problem in this:</p>\n\n<pre><code>\u03bb *Main &gt; parseTest parseString $ show \"some\\\"string\"\nString \"some\\\"string\"\n\n\u03bb *Main &gt; show \"some\\\"string\"\n\"\\\"some\\\\\\\"string\\\"\"\n\n\u03bb *Main &gt; parseTest parseString \"\\\"some\\\\\\\"string\\\"\"\nString \"some\\\"string\"\n\n-- This happened? Escaping is tricky.\n\u03bb *Main &gt; parseTest parseString \"\\\"some\\\"string\\\"\"\nString \"some\"\n</code></pre>\n"}], "owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1454221332, "creation_date": 1454163589, "last_edit_date": 1454221332, "question_id": 35102864, "link": "https://stackoverflow.com/questions/35102864/haskell-string-parser-not-recognizing-escaped-double-quote", "title": "Haskell: String parser not recognizing escaped double-quote", "body": "<p>I have this Parser (exercise from Write a Lisp in 48 hours):</p>\n\n<pre><code>import Text.ParserCombinators.Parsec\nimport Control.Monad\n\ndata LispVal = String String deriving Show\n\nparseString :: Parser LispVal\nparseString = do char '\"'\n                 x &lt;- many innerChar\n                 char '\"'\n                 return $ String x\n              where innerChar = noneOf ['\\\\','\\\"'] &lt;|&gt; escapeChar\n                    escapeChar = \n                        do char '\\\\'\n                           c &lt;- oneOf ['n', '\"', 'r', 't']\n                           return $ case c of\n                                      '\"' -&gt; '\\\"'\n                                      'n' -&gt; '\\n'\n                                      'r' -&gt; '\\r'\n                                      't' -&gt; '\\t'\n</code></pre>\n\n<p>So, this code seems to work fine for strings with all escaped characters, only when the char is \\\" it seems to end the String.</p>\n\n<ul>\n<li>I receive a warning because the pattern match is not exhaustive, what should the general case be?</li>\n<li>The code seems to fail in cases like \"some\\\"string\", where it succeeds but returns \"some\"</li>\n</ul>\n"}, {"tags": ["haskell", "usb", "sandbox", "cabal"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1454157841, "post_id": 35101844, "comment_id": 57924730, "body": "It sounds very much like you should better see to it that this USB device gets user permission from the OS side. It is generally a bad idea to run anything as superuser, apart from system setup / maintenance operations."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1454173863, "post_id": 35101844, "comment_id": 57930094, "body": "<code>cabal exec &#39;sudo&#39; ghci</code> might work. <code>cabal exec shell-script-which-runs-sudo-ghci</code> will definitely work. <code>sudo cabal repl</code> runs <code>cabal</code> as a super user, I believe, not the process which it starts."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1454182559, "post_id": 35101844, "comment_id": 57933209, "body": "Please give more information on the nature of the failure than &quot;this does not work&quot; and &quot;this does not seem to work either&quot;. What went wrong? Were there error messages?"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1454157223, "creation_date": 1454157223, "question_id": 35101844, "link": "https://stackoverflow.com/questions/35101844/running-cabal-repl-as-a-super-user-on-linux", "title": "Running `cabal repl` as a super-user (on Linux)", "body": "<p>The usb package is not on stackage and I created a cabal sandbox to play with it. Code like the package's <a href=\"https://github.com/basvandijk/usb-example\" rel=\"nofollow\">example.hs</a> is now working using the <code>cabal repl</code> command, but in order to run it fully, one need elevated priviledges (otherwise one gets <code>libusbx couldn't open USB device /dev/bus/usb/001/001: Permission denied</code> sort of error messages) (*). On Linux (Ubuntu Trusty), I tried running <code>sudo cabal repl</code>, but this does not work.</p>\n\n<p>As recommended on the <a href=\"https://wiki.haskell.org/Cabal-Install\" rel=\"nofollow\">Cabal-Install wiki</a> - but maybe that's only for the <code>cabal install</code> command - I added a cabal.config file with a single <code>root-cmd: sudo</code> line, in the directory where cabal.sandbox.config is located. This does not seem to work either, <code>sudo cabal repl</code> still fails.</p>\n\n<p><strong>My question</strong> : what is the proper way to run <code>cabal repl</code> (or <code>cabal run</code>...) with elevated priviledges on linux (Ubuntu)?</p>\n\n<p>(*) One could also change the permissions of the usb devices, and be able to run the program as a normal user, but this is less practical in my situation, and in any case, I'd like to learn how to do it as a super-user rather.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1454140375, "post_id": 35099366, "comment_id": 57919904, "body": "Can you show so example input. I&#39;d also recommended taking a look at parsec or attoparsec it&#39;s a bit of an effort for the first time,  but definitely worth it."}], "answers": [{"comments": [{"owner": {"reputation": 238, "user_id": 4494643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vd83.jpg?s=128&g=1", "display_name": "Yurrili", "link": "https://stackoverflow.com/users/4494643/yurrili"}, "edited": false, "score": 0, "creation_date": 1454143542, "post_id": 35099704, "comment_id": 57920521, "body": "Is a problem with file ReadP, it doesn&#39;t work. I cannot use modules which may have problem with some versions. : /"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454178860, "post_id": 35099704, "comment_id": 57931889, "body": "The type of <code>choose</code> can be generalized to <code>Alternative f =&gt; f a -&gt; f b -&gt; f (Either a b)</code>. This is exactly <code>eitherP</code> from <code>Data.Attoparsec.Combinator</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454179111, "post_id": 35099704, "comment_id": 57931999, "body": "The unsafe version could, I believe, be written safely in a stream framework like &quot;<code>ListT</code> done right&quot;, <code>pipes</code>, <code>conduit</code>, <code>machines</code>, etc."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454209063, "post_id": 35099704, "comment_id": 57940582, "body": "@dfeuer, how would you do that? You need to either lazily produce tuples until an error is encountered or to strictly check the whole input before computing anything. In the first case a lof of unnecessary work can be done (assuming the program should respond &quot;no way&quot; and die on wrong input), so it&#39;s probably best to first check input (<a href=\"http://okmij.org/ftp/Haskell/index.html#memo-off\" rel=\"nofollow noreferrer\">preventing memoization</a> if needed) and then &quot;unsafely&quot; consume it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454254678, "post_id": 35099704, "comment_id": 57951784, "body": "The solution I intended can actually be accomplished lazily as well: <code>data FList e a = Nil | Cons a (FList e a) | Fail e</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454255925, "post_id": 35099704, "comment_id": 57952194, "body": "@dfeuer, yes, but then you also need to consume this <code>FList</code> as soon as values are produced, which means that you need to compute something, which can be expensive, which is inappropriate if you want to throw an error and shutdown on wrong input. Or am I misunderstanding something?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454260347, "post_id": 35099704, "comment_id": 57953819, "body": "Computing things isn&#39;t always as expensive as storing things. Much depends on the error handling requirements..."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 4, "last_activity_date": 1454150991, "last_edit_date": 1454150991, "creation_date": 1454143006, "answer_id": 35099704, "question_id": 35099366, "link": "https://stackoverflow.com/questions/35099366/reading-from-file-list-of-chars-or-list-of-ints/35099704#35099704", "title": "Reading from file list of chars or list of ints", "body": "<p>Just try both and choose the successful:</p>\n\n<pre><code>import Text.Read\nimport Control.Applicative\n\nchoose :: Maybe a -&gt; Maybe b -&gt; Maybe (Either a b)\nchoose x y = fmap Left x &lt;|&gt; fmap Right y\n\nreadListMaybe :: Read a =&gt; [String] -&gt; Maybe [a]\nreadListMaybe = mapM readMaybe\n\ntoTuple :: [String] -&gt; Maybe (Either [(Int, Int)] [(Char, Int)])\ntoTuple ss = readListMaybe ss `choose` readListMaybe ss\n\nmain = do\n    -- Just (Left [(1,2),(1,3),(3,4),(1,4)])\n    print $ toTuple [\"(1,2)\", \"(1,3)\" ,\"(3,4)\" ,\"(1,4)\"]\n    -- Just (Right [('a',2),('b',3),('g',8),('h',2),('r',4)])\n    print $ toTuple [\"('a',2)\", \"('b',3)\", \"('g',8)\", \"('h',2)\", \"('r',4)\"]\n</code></pre>\n\n<hr>\n\n<p>Here is a far more efficient (and unsafe) version:</p>\n\n<pre><code>readListWithMaybe :: Read a =&gt; String -&gt; [String] -&gt; Maybe [a]\nreadListWithMaybe s ss = fmap (: map read ss) (readMaybe s)\n\ntoTuple :: [String] -&gt; Either [(Int, Int)] [(Char, Int)]\ntoTuple  []    = Left []\ntoTuple (s:ss) = fromJust $ readListWithMaybe s ss `choose` readListWithMaybe s ss\n</code></pre>\n\n<p>In the first definition of <code>toTuple</code></p>\n\n<pre><code>toTuple :: [String] -&gt; Maybe (Either [(Int, Int)] [(Char, Int)])\ntoTuple ss = readListMaybe ss `choose` readListMaybe ss\n</code></pre>\n\n<p><code>readListMaybe</code> is too strict:</p>\n\n<pre><code>readListMaybe :: Read a =&gt; [String] -&gt; Maybe [a]\nreadListMaybe = mapM readMaybe\n</code></pre>\n\n<p><code>mapM</code> is defined in terms of <code>sequence</code> which is defined in terms of <code>(&gt;&gt;=)</code> which is strict for the <code>Maybe</code> monad. And also the reference to <code>ss</code> is keeped for too long. The second version doesn't have these problems.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1454185802, "last_edit_date": 1454185802, "creation_date": 1454154412, "answer_id": 35101385, "question_id": 35099366, "link": "https://stackoverflow.com/questions/35099366/reading-from-file-list-of-chars-or-list-of-ints/35101385#35101385", "title": "Reading from file list of chars or list of ints", "body": "<p>As I said it may be a good idea to consider using a parsing library, if the task at hand gets a bit more complicated.</p>\n\n<p>First of all you have the benefit of getting error messages and if you decide to switch to a self declared data Type it is still easily applicable (with slight modifications of course).\nAlso switching from <code>ByteString</code> to <code>Text</code> (which are both preferable to working with <code>String</code> anyways) is just a matter of (un)commenting 4 lines</p>\n\n<p>Here is some example if you have not had the pleasure to work with it.</p>\n\n<p>I'll explain it some time later today - for I have to leave now.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport Data.Attoparsec.ByteString.Char8\nimport Data.ByteString.Char8 as X\n-- import Data.Attoparsec.Text\n-- import Data.Text as X\n\nmain :: IO ()\nmain = do print &lt;$&gt; toTuples $ X.unlines [\"(1,2)\",\"(1,3)\",\"(3,4)\",\"(1,4)\"]\n          print &lt;$&gt; toTuples $ X.unlines [\"('a',2)\",\"('h',2)\",\"('r',4)\"]\n          print &lt;$&gt; toTuples $ X.unlines [\"('a',2)\",\"(1,3)\",\"(1,4)\"] --works\n          print &lt;$&gt; toTuples $ \"('a',2)\"   -- yields Right [Right ('a',2)]!!\n          print &lt;$&gt; toTuples $ \"(\\\"a\\\",2)\" -- yields Right []!!\n\ntoTuples = parseOnly (myparser `sepBy` skipSpace :: Parser [Either (Int,Int) (Char,Int)])\n  where myparser :: Parser (Either (Int,Int) (Char,Int))\n        myparser = eitherP (tupleP decimal decimal)\n                           (tupleP charP decimal)\n        charP = do char '\\''\n                   c &lt;- notChar '\\''\n                   char '\\''\n                   return c\n\ntupleP :: Parser a -&gt; Parser b -&gt; Parser (a, b)\ntupleP a b = do char '('\n                a' &lt;- a\n                skipSpace\n                char ','\n                skipSpace\n                b' &lt;- b\n                char ')'\n                return (a',b')\n</code></pre>\n\n<h2>Edit: Explanation</h2>\n\n<p><code>Parser</code> is a monad, so it comes with <code>do</code>-notation which enables us to write the <code>tupleP</code> function in this very convenient form. Same goes for <code>charP</code> - we describe what to parse in the primitives given by the <code>attoparsec</code> library</p>\n\n<p>and it reads something like</p>\n\n<ul>\n<li>first expect a quote</li>\n<li>then something that is not allowed to be a quote</li>\n<li>and another quote</li>\n<li>return the not quote thingy</li>\n</ul>\n\n<p>if you can write down the parser informally you're most likely halfway through writing the haskell code, the only thing left to do is find the primitives in the library or write some auxilary function like <code>tupleP</code>.</p>\n\n<p>A nice thing is that <code>Parsers</code> (being monads) compose nicely so we get our desired parser <code>eitherP (tupleP ..) (tupleP ..)</code>.</p>\n\n<p>The only magic that happens in the <code>print &lt;$&gt;..</code> lines is that <code>Either</code> is a functor and every function using <code>&lt;$&gt;</code> or <code>fmap</code> uses the <code>Right</code> side of the <code>Either</code>s.</p>\n\n<p>Last thing to note is <code>sepBy</code> returns a list - so in the case where the parsing fails we still get an empty list as a result, if you want to see the failing use <code>sepBy1</code> instead!</p>\n"}], "owner": {"reputation": 238, "user_id": 4494643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vd83.jpg?s=128&g=1", "display_name": "Yurrili", "link": "https://stackoverflow.com/users/4494643/yurrili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 35099704, "answer_count": 2, "score": 1, "last_activity_date": 1454185802, "creation_date": 1454139786, "last_edit_date": 1454185610, "question_id": 35099366, "link": "https://stackoverflow.com/questions/35099366/reading-from-file-list-of-chars-or-list-of-ints", "title": "Reading from file list of chars or list of ints", "body": "<p>I have a question. There is any solution for reading from file list of tuples ? Depends on content ? \nI know that if i need to read integers i do something like that:</p>\n\n<pre><code>toTuple :: [String] -&gt; [(Int,Int)]\ntoTuple = map (\\y -&gt; read y ::(Int,Int))\n</code></pre>\n\n<p>But in file i can have tuples this kind (int,int) or (char, int). Is any way to do this nice ? </p>\n\n<p>I was trying to do this at first in finding sign \" ' \" . If it was, then reading chars, but it doesn't work for some reason.</p>\n\n<p>[Edit]</p>\n\n<p>To function to tuple, i give strings with tuples, before that i splits lines by space sign. </p>\n\n<p>INPUT EXAMPLE:</p>\n\n<pre><code>Case 1 : [\"(1,2)\", \"(1,3)\" ,\"(3,4)\" ,\"(1,4)\"]\nCase 2 : [\"('a',2)\", \"('b',3)\", \"('g',8)\", \"('h',2)\", \"('r',4)\"]\n</code></pre>\n"}, {"tags": ["haskell", "programming-languages", "lazy-evaluation", "multiple-languages"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1454097841, "post_id": 35093050, "comment_id": 57907908, "body": "I&#39;m not aware of Haskell doing this automatically. One question: will <code>B</code> always be evaluated prior to the <code>if</code> while <code>A</code> may or may not be evaluated by this point in execution?"}, {"owner": {"reputation": 13, "user_id": 4218305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4734e745c17c5c69bd00447bfa1ab83c?s=128&d=identicon&r=PG&f=1", "display_name": "random_crane", "link": "https://stackoverflow.com/users/4218305/random-crane"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1454098215, "post_id": 35093050, "comment_id": 57908085, "body": "I am interested in both scenarios. If program flow was determined to evaluate <code>B</code> always prior to <code>A</code>, it could be optimized in compile time. If it was not, some just-in-time checks could be implemented to make use of the already evaluated argument in logical operator evaluation."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1454104500, "post_id": 35093050, "comment_id": 57911310, "body": "With some effort it could be done, but it wouldn&#39;t be that big of an advantage. Besides: in the end what gets executed is machine code. And CPUs already perform branch prediction pretty well, so if a certain condition can be predicted the hardware is likely to already take that into account without having to &quot;swap arguments&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4218305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4734e745c17c5c69bd00447bfa1ab83c?s=128&d=identicon&r=PG&f=1", "display_name": "random_crane", "link": "https://stackoverflow.com/users/4218305/random-crane"}, "edited": false, "score": 0, "creation_date": 1454620035, "post_id": 35093163, "comment_id": 58138417, "body": "It is a very good point, that the AND/OR operators are non commutative in a general case. Probably the feature I requested is not implemented in any language by default."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1454098469, "last_edit_date": 1454098469, "creation_date": 1454098115, "answer_id": 35093163, "question_id": 35093050, "link": "https://stackoverflow.com/questions/35093050/swap-logical-operator-arguments-for-faster-evaluation/35093163#35093163", "title": "Swap logical operator arguments for faster evaluation?", "body": "<p>Under lazy evaluation, AND and OR are not commutative.</p>\n\n<pre><code>foo :: Int -&gt; Bool\nfoo n = False &amp;&amp; foo (n+1)  -- evaluates to False\n\nbar :: Int -&gt; Bool\nbar n = bar (n+1) &amp;&amp; False  -- diverges\n</code></pre>\n\n<p>Under eager evaluation (strict semantics), and absence of side effects, they are commutative. I am not aware of any usual optimization being done by some compiler here, though. (Constants folding aside.)</p>\n\n<p>If side effects are present, AND/OR are not commutative, of course. For instance, an Ocaml compiler can not swap the arguments unless it can prove that at least one of them is side effect-free.</p>\n"}, {"comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1454098587, "post_id": 35093228, "comment_id": 57908288, "body": "In the literature this operation is called <code>por</code> for <code>parallel or</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1454098792, "post_id": 35093228, "comment_id": 57908390, "body": "Besides the literature, this operation is also called <code>por</code> in the <code>unamb</code> package that was linked to. So no need to write it yourself in common usage -- I expect the source here is meant to be pedagogical rather than an example of how you should use the package."}, {"owner": {"reputation": 13, "user_id": 4218305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4734e745c17c5c69bd00447bfa1ab83c?s=128&d=identicon&r=PG&f=1", "display_name": "random_crane", "link": "https://stackoverflow.com/users/4218305/random-crane"}, "edited": false, "score": 0, "creation_date": 1454620885, "post_id": 35093228, "comment_id": 58138894, "body": "I was not aware of existence of <code>unamb</code>, it&#39;s a really interesting find. I think with considerable effort such feature can be implemented in any object-oriented language using <a href=\"https://en.wikipedia.org/wiki/Proxy_pattern\" rel=\"nofollow noreferrer\">Virtual Proxy pattern</a> for the <code>A</code> and <code>B</code>, and proxy-aware <code>AND</code>/<code>OR</code> operator which would check whether the values need to be computed."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1454098389, "creation_date": 1454098389, "answer_id": 35093228, "question_id": 35093050, "link": "https://stackoverflow.com/questions/35093050/swap-logical-operator-arguments-for-faster-evaluation/35093228#35093228", "title": "Swap logical operator arguments for faster evaluation?", "body": "<p>It's not done automatically as part of the language (possibly because it would not be <em>free</em> to perform this reordering check, so you would often end up paying for an optimization that can't be made). However, there are library functions you can use to this end. See, for example, <a href=\"http://conal.net/blog/posts/functional-concurrency-with-unambiguous-choice\" rel=\"nofollow\"><code>unamb</code></a>. With that, you can write</p>\n\n<pre><code>(|||) :: Bool -&gt; Bool -&gt; Bool\na ||| b = (a || b) `unamb` (b || a)\n</code></pre>\n\n<p>And if one operation is cheaper to compute, it can be chosen.</p>\n"}], "owner": {"reputation": 13, "user_id": 4218305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4734e745c17c5c69bd00447bfa1ab83c?s=128&d=identicon&r=PG&f=1", "display_name": "random_crane", "link": "https://stackoverflow.com/users/4218305/random-crane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 35093163, "answer_count": 2, "score": 1, "last_activity_date": 1454098695, "creation_date": 1454097656, "question_id": 35093050, "link": "https://stackoverflow.com/questions/35093050/swap-logical-operator-arguments-for-faster-evaluation", "title": "Swap logical operator arguments for faster evaluation?", "body": "<p>Does any programming language implement swapping of arguments of logical operation (such as AND, OR) for faster evaluation?</p>\n\n<p>Example (I think such method could be implemented in a lazy evaluation language like Haskell)</p>\n\n<ol>\n<li>Lets say we have defined two predicates <code>A</code> and <code>B</code>. </li>\n<li>During program execution, <code>B</code> was evaluated to \"True\" and <code>A</code> was not evaluated</li>\n<li>In the later execution we have condition <code>IF A OR B</code></li>\n<li>Arguments of \"OR\" are swapped, and the condition becomes <code>IF B OR A</code></li>\n<li>Condition is evaluated to \"True\" without evaluating <code>A</code></li>\n</ol>\n"}, {"tags": ["haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "edited": false, "score": 1, "creation_date": 1454092926, "post_id": 35091571, "comment_id": 57905281, "body": "An alternative: <code>readInts :: String -&gt; Maybe [Int]</code>. If you want to eschew all partial functions, you will need something similar with the <code>newtype</code> approach eventually (<code>fromString :: String -&gt; Maybe SpaceSeparatedIntegersString</code>, for example). Which is better? It depends; it depends."}, {"owner": {"reputation": 1821, "user_id": 2391244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyC7o.jpg?s=128&g=1", "display_name": "BalinKingOfMoria Reinstate CMs", "link": "https://stackoverflow.com/users/2391244/balinkingofmoria-reinstate-cms"}, "edited": false, "score": 0, "creation_date": 1454093249, "post_id": 35091571, "comment_id": 57905473, "body": "I&#39;d just accept that functions can fail. In a perfect world, users would do everything right, all inputs would be validated, ..., but stuff happens. There&#39;s going to be a layer between your &quot;perfect&quot; functions and your &quot;imperfect&quot; functions anyway. If you&#39;re asking whether to make that layer as small as possible, then yes, that&#39;s a good idea with anything."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1454183855, "post_id": 35091571, "comment_id": 57933679, "body": "If that&#39;s is what you think is most important you probably want to use Coq instead of Haskell. In Coq all functions are total (and you have to prove it to the compiler). Note however that this requirement makes the language <i>non</i> Turing-complete (though it can still express quite a lot of functions)."}], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 5, "last_activity_date": 1454093028, "creation_date": 1454093028, "answer_id": 35091771, "question_id": 35091571, "link": "https://stackoverflow.com/questions/35091571/haskell-type-representing-a-subset-of-another-type/35091771#35091771", "title": "Haskell type representing a subset of another type", "body": "<p>You probably shouldn't implement <code>SpaceSeparatedIntegerString</code>.  If you did an abstract data type would be the simplest thing to do.  You should not accept that your function should fail, at least not in the \"pattern match failure\" sense.  You should make a function that returns something like <code>Maybe [Int]</code>.</p>\n\n<p>The reason you shouldn't implement <code>SpaceSeparatedIntegerString</code> is that likely just pushes the problem elsewhere.  You probably are getting the <code>String</code>s from some input, so somewhere you need a function <code>String -&gt; SpaceSeparatedIntegerString</code> and that could fail just as well.  At some point you need to go from less structured to more structured data unless your only values are completely statically specified.</p>\n\n<p>The point is going from less structured data to more structured data (or less typed data to more typed data) is virtually always going to be a partial operation.  Indeed, parsing is the process of turning less structured data into more structured data.  What you <em>should</em> do, though, in line with your principle, is as much as practical <em>reify</em> the recovered structure into the type system.  So <code>isValidUri :: String -&gt; Bool</code> is bad, as is <code>makeUri :: String -&gt; Maybe String</code>, but <code>makeUri :: String -&gt; Maybe Uri</code> where <code>Uri</code> is a type that can represent exactly the valid URIs is good.</p>\n"}, {"comments": [{"owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1454093195, "post_id": 35091796, "comment_id": 57905447, "body": "So you suggest writing my function like <code>readInts s | checkIfStringIsWellFormatted s = Nothing; readInts s = Maybe ( map read . words) </code> ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 1, "creation_date": 1454093564, "post_id": 35091796, "comment_id": 57905663, "body": "@Caridorc Roughly, yes. You can exploit <code>reads</code> or <code>readMaybe</code> (to be found in some module) to check whether the conversion suceeded, instead of using guards. (Also, on success it should be <code>Just (...)</code>)."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1454124672, "post_id": 35091796, "comment_id": 57916869, "body": "Unless input strings are known statically, I would make <code>readInts</code> return either a proof that a string is ill-formed or a list of ints. Also, I would probably use a <a href=\"http://lpaste.net/151196\" rel=\"nofollow noreferrer\">view</a> instead of a proof-carrying sigma."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1454144039, "post_id": 35091796, "comment_id": 57920640, "body": "@user3237465 That would be indeed better. I proposed a sigma since the OP asked for a &quot;subset of another type&quot;. By the way, what is <code>T</code> in your Agda snippet?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1454144262, "post_id": 35091796, "comment_id": 57920696, "body": "<code>T</code> makes a proposition from a boolean: <code>T true = \u22a4; T false = \u22a5</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1454093421, "last_edit_date": 1454093421, "creation_date": 1454093095, "answer_id": 35091796, "question_id": 35091571, "link": "https://stackoverflow.com/questions/35091571/haskell-type-representing-a-subset-of-another-type/35091796#35091796", "title": "Haskell type representing a subset of another type", "body": "<p>Your goal is noble, but requires very precise types. Dependent types, such the ones available in Agda, Coq, Idris, and other languages can achieve what you propose. E.g. in Coq,</p>\n\n<pre><code>Definition SpaceSeparatedIntegersString: Type :=\n   { s: string | spaceSeparatedIntegers s } .\nDefinition spaceSeparatedIntegers (s: String): Prop := ...\n</code></pre>\n\n<p>The catch is that, whoever wants to construct a <code>SpaceSeparatedIntegersString</code> value, must provide a formal proof of the relevant property. This is feasible, but requires some care, time and mathematical skills.</p>\n\n<p>In Haskell, it is more common to move the type-guarantee to the output type. Instead of making the input type stronger, we can make the output type weaker:</p>\n\n<pre><code>readInts :: String -&gt; Maybe [Int]\n</code></pre>\n\n<p>This is not as precise, but can be used without having to prove anything.</p>\n\n<p>Alternatively, make <code>SpaceSeparatedIntegersString</code> be an opaque type by declaring it in a module without exporting its value constructors. </p>\n\n<pre><code>module Foo(SpaceSeparatedIntegersString(), ...)\ndata SpaceSeparatedIntegersString = S String        -- S is private\n</code></pre>\n\n<p>In this way, the users of the module will have to manipulate it only through functions exported by the module. With some care, one can craft a bunch of (exported) combinators which guarantee that values of type <code>SpaceSeparatedIntegersString</code> will never contain invalid strings.\nFor instance,</p>\n\n<pre><code>combine :: SpaceSeparatedIntegersString \n        -&gt; SpaceSeparatedIntegersString\n        -&gt; SpaceSeparatedIntegersString \ncombine (S x) (S y) = S (x ++ \" \" ++ y)\n</code></pre>\n\n<p>This is not entirely straightforward -- if you want to allow general string manipulation, you will probably end up in returning <code>Maybe ...</code> in some cases.</p>\n"}, {"comments": [{"owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1454095140, "post_id": 35092332, "comment_id": 57906500, "body": "Do you mean the approach of <code>Maybe</code> or the approach of <code>newtype</code> ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1454095473, "post_id": 35092332, "comment_id": 57906694, "body": "@Caridorc, using <code>Maybe</code>. If you need to deal with <i>streaming</i> input (for responsiveness, throughput, or large input size), you&#39;ll need a more refined sort of error handling, but <code>Maybe</code> will do for many purposes."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1454096687, "last_edit_date": 1495535278, "creation_date": 1454095026, "answer_id": 35092332, "question_id": 35091571, "link": "https://stackoverflow.com/questions/35091571/haskell-type-representing-a-subset-of-another-type/35092332#35092332", "title": "Haskell type representing a subset of another type", "body": "<p>No, this is not a sensible idea in this case. The approach suggested in <a href=\"https://stackoverflow.com/questions/35091571/haskell-type-representing-a-subset-of-another-type#comment57905281_35091571\">Ian Henry's comment</a> using <code>Maybe</code> is one of several reasonable ones. The reason your idea is not sensible in this context is that the entire purpose of a function like <code>readInts</code> is to process input from the user, a file, an HTTP request, etc., which may <em>not</em> be valid. The type system can't help you if you ask the user how many cars they want to buy and they respond with a picture of a kitten. Derek Elkins really explains this better. chi's dependently typed approach is great for some other situations, once the input has been fully validated.</p>\n"}], "owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 35091796, "answer_count": 3, "score": 2, "last_activity_date": 1454096687, "creation_date": 1454092336, "question_id": 35091571, "link": "https://stackoverflow.com/questions/35091571/haskell-type-representing-a-subset-of-another-type", "title": "Haskell type representing a subset of another type", "body": "<p><strong>I think that when given parameter(s) of the specified type, a function should never fail.</strong></p>\n\n<p>But take this seemingly innocuous code:</p>\n\n<pre><code>readInts :: String -&gt; [Int]\nreadInts = map read . words\n</code></pre>\n\n<p>It has a type signature that is too general, in fact, it will fail for any string that is not composed by space separated integers, its type should then be:</p>\n\n<pre><code>readInts :: SpaceSeparatedIntegersString -&gt; [Int]\n</code></pre>\n\n<p>When the program fails when you try to build a <code>SpaceSeparatedIntegersString</code> that does not respect the stated criteria.</p>\n\n<ul>\n<li><p>Is implementing a <code>SpaceSeparatedIntegersString</code> a sensible idea?</p></li>\n<li><p>If it is how can I implement such a type? (I ask just a general idea/tip/nudge in the right direction, not full code) </p></li>\n<li><p>Should I just accept that my function will fail when the <code>String</code> formatting is not correct (that is, my statement at the start of tis question is wrong)?</p></li>\n<li><p>Should I just use a guard clause in the function definition?</p></li>\n</ul>\n"}, {"tags": ["haskell", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "edited": false, "score": 0, "creation_date": 1454095969, "post_id": 35090940, "comment_id": 57906942, "body": "This is definitely an improvement.  I am mostly wondering if there are some flags I can set, or tricks I can use so <code>Nothing</code> is used on unspecified fields.  I am new to Haskell so I don&#39;t know of any.  It&#39;s annoying to build messages that have 10 different fields, only 1 of which is set."}], "tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": false, "score": 2, "last_activity_date": 1454089981, "creation_date": 1454089981, "answer_id": 35090940, "question_id": 35090702, "link": "https://stackoverflow.com/questions/35090702/build-a-protobuf-object-in-haskell-with-optional-fields/35090940#35090940", "title": "Build a protobuf object in haskell with optional fields", "body": "\n\n<p>You can make a record value that has the fields you want already set and then update that record.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>noFailureMsg = ProtoMsg.ReqResponse.ReqResponse {\n            failure_message = Nothing\n        }\n\nlet repMsg = ProtoMsg.WorkerResponse.WorkerResponse {\n    header = noFailureMsg {\n        ProtoMsg.ReqResponse.status = Just ProtoMsg.Status.OK\n    }\n}\n</code></pre>\n\n<p>I'm not completely sure this is what you are looking for.</p>\n"}], "owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1454089981, "creation_date": 1454089206, "question_id": 35090702, "link": "https://stackoverflow.com/questions/35090702/build-a-protobuf-object-in-haskell-with-optional-fields", "title": "Build a protobuf object in haskell with optional fields", "body": "<p>I am building a PB object in Haskell and I do not want to specify optional fields.  Is this possible?</p>\n\n<p>In the very simplest case, I have a header field that has a <code>failure_message</code> that I want empty in most cases.  I have some code where a worker task responds with an OK status:</p>\n\n<pre><code>        let repMsg = ProtoMsg.WorkerResponse.WorkerResponse {\n            header = ProtoMsg.ReqResponse.ReqResponse {\n                ProtoMsg.ReqResponse.status = Just ProtoMsg.Status.OK,\n                failure_message = Nothing\n            }\n        }\n</code></pre>\n\n<p>Is there a way to set all unspecified fields to Nothing some how?  In this case it's not so bad, but when there are more optional fields it gets annoying.</p>\n"}, {"tags": ["performance", "perl", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1454083785, "post_id": 35088733, "comment_id": 57899822, "body": "did you compile the program or invoke it in ghci, did you compile with optimizations; read is known to be slow, as well as using <code>String</code>, try switching to <code>Text</code> !"}, {"owner": {"reputation": 41, "user_id": 5857997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f326d0832fee23401398d13a60f99bc?s=128&d=identicon&r=PG", "display_name": "xzhao", "link": "https://stackoverflow.com/users/5857997/xzhao"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1454083835, "post_id": 35088733, "comment_id": 57899856, "body": "I tried both and both of them are slower than Perl. My ghc version is 7.10.3. I don&#39;t think it is read&#39;s problem because obviously IO is not the bottleneck here."}, {"owner": {"reputation": 3870, "user_id": 2336725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a0b96a26cf233d752469445595f872?s=128&d=identicon&r=PG", "display_name": "Teepeemm", "link": "https://stackoverflow.com/users/2336725/teepeemm"}, "edited": false, "score": 1, "creation_date": 1454084001, "post_id": 35088733, "comment_id": 57899974, "body": "Could you post the problem statement here, so we don&#39;t have to go digging for it?"}, {"owner": {"reputation": 41, "user_id": 5857997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f326d0832fee23401398d13a60f99bc?s=128&d=identicon&r=PG", "display_name": "xzhao", "link": "https://stackoverflow.com/users/5857997/xzhao"}, "edited": false, "score": 0, "creation_date": 1454084123, "post_id": 35088733, "comment_id": 57900048, "body": "Sure I have done that."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454095941, "post_id": 35089600, "comment_id": 57906929, "body": "Arrays are probably fastest, but the O&#39;Neill sieve is arguably the best match to Haskell. The version in the <code>NumberSieves</code> package is much faster than the one in the paper, but it could certainly be improved by using a better priority queue (specializing to <code>Word64</code>, to begin with)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454097316, "post_id": 35089600, "comment_id": 57907654, "body": "&quot;This is a prototypical example of a problem where mutable arrays are helpful&quot; - really? Would it be easier to re-write all the code to work with mutable arrays, or any other mutable data structure, than simply changing the one part of the algorithm that is &quot;bad&quot;. Instead of increment the list directly, store a <code>Map [Int] Int</code> of which factors must increment which digit - the total size of this map is always less than 10 so insert/delete is essentially constant time. There is a version of this <a href=\"https://wiki.haskell.org/Prime_numbers\" rel=\"nofollow noreferrer\">here</a> (3.11)."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 6, "last_activity_date": 1454085573, "creation_date": 1454085573, "answer_id": 35089600, "question_id": 35088733, "link": "https://stackoverflow.com/questions/35088733/haskell-program-low-performance-compared-with-perl/35089600#35089600", "title": "Haskell Program Low Performance Compared with Perl", "body": "<p>Yes, of course. You're effectively using two different algorithms. Your Haskell <code>zipWith ($) (incEvery n) xs</code> has to process <em>every</em> entry of your list, while your Perl <code>for my $j (2 .. ($max / $i)) { $f[$i * $j] ++; }</code> only has to process the entries it actually increments, which is a factor of <code>$i</code> faster. This is a prototypical example of a problem where mutable arrays are helpful: in Haskell you can use <code>STUArray</code>, for example.</p>\n"}, {"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1455647991, "post_id": 35439652, "comment_id": 58578899, "body": "FInally someone who shows the pure solution. I <i>really</i> couldn&#39;t see how vectors would be of any use here! As if the primacity of every number was not fixed from the beginning of time! And it is not subject to change anytime soon :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3970496"}, "is_accepted": false, "score": 8, "last_activity_date": 1455645074, "creation_date": 1455645074, "answer_id": 35439652, "question_id": 35088733, "link": "https://stackoverflow.com/questions/35088733/haskell-program-low-performance-compared-with-perl/35439652#35439652", "title": "Haskell Program Low Performance Compared with Perl", "body": "<p>There is absolutely no reason why you need to resort to imperative programming to gain performance. The unique thing about Haskell is you have to learn to think differently if you want to program in a purely functional manner. Exploit laziness to speed things up a bit:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Control.Applicative ( pure, (&lt;$&gt;) )\nimport Data.List           ( nub )\nimport Data.Monoid         ( (&lt;&gt;) )\n\nisPrime :: (Integral i) =&gt; i -&gt; Bool\nisPrime n = isPrime_ n primes\n  where isPrime_ n (p:ps)\n          | p * p &gt; n      = True\n          | n `mod` p == 0 = False\n          | otherwise      = isPrime_ n ps\n\nprimes :: (Integral i) =&gt; [i]\nprimes = 2 : filter isPrime [3,5..]\n\nprimeFactors :: (Integral i) =&gt; i -&gt; [i]\nprimeFactors n = factors n primes\n  where factors n (x:xs)\n          | x * x &gt; n      = [n]\n          | n `mod` x == 0 = x : factors (n `div` x) (x:xs)\n          | otherwise      = factors n xs\n\nprimacity :: (Integral i) =&gt; i -&gt; Int\nprimacity = length . nub . primeFactors\n\nuser :: IO Int\nuser = do\n  xs &lt;- getLine\n  let a :: Int = read . takeWhile (/=' ') . dropN 0 $ xs\n  let b :: Int = read . takeWhile (/=' ') . dropN 1 $ xs\n  let k :: Int = read . takeWhile (/=' ') . dropN 2 $ xs\n  let n = length . filter (== k) . fmap primacity $ [a..b]\n  pure n\n    where\n      dropN 0 = id\n      dropN n = dropN (pred n) . drop 1 . dropWhile (/= ' ')\n\nprintNTimes :: Int -&gt; Int -&gt; IO ()\nprintNTimes 0 _ = pure ()\nprintNTimes n total = do\n  ans &lt;- user\n  putStr $ \"Case #\" &lt;&gt; show (total - n + 1) &lt;&gt; \": \"\n  putStrLn $ show ans\n  printNTimes (pred n) total\n\nmain :: IO ()\nmain = do\n  n :: Int &lt;- read &lt;$&gt; getLine\n  printNTimes n n\n</code></pre>\n\n<p>This is basically mutual recursion mixed with laziness. Might take a while to understand it, but I can guarantee that it's fast.</p>\n"}], "owner": {"reputation": 41, "user_id": 5857997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f326d0832fee23401398d13a60f99bc?s=128&d=identicon&r=PG", "display_name": "xzhao", "link": "https://stackoverflow.com/users/5857997/xzhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1455645074, "creation_date": 1454083126, "last_edit_date": 1454084111, "question_id": 35088733, "link": "https://stackoverflow.com/questions/35088733/haskell-program-low-performance-compared-with-perl", "title": "Haskell Program Low Performance Compared with Perl", "body": "<p>I am doing a Facebook Hackercup 2015 problem with Haskell and got stuck on <a href=\"http://codeforces.com/gym/100579/attachments\" rel=\"nofollow\">this problem</a>.</p>\n\n<p>Input: Begins with an integer\u00a0T, the number of questions. For each question, there is one line containing 3 space-separated integers:A,\u00a0B, and\u00a0K.</p>\n\n<p>Output: For the\u00a0ith question, print a line containing \"Case #i: \" followed by the number of integers in the inclusive range [A,\u00a0B] with a primacity of\u00a0K.</p>\n\n<p>Primacity of a number X is the number of its prime factors. For example, the primacity of 12 is 2 (as it's divisible by primes 2 and 3), the primacity of 550 is 3 (as it's divisible by primes 2, 5, and 11), and the primacity of 7 is 1 (as the only prime it's divisible by is 7).</p>\n\n<p>1 \u2264\u00a0T\u00a0\u2264 100\u00a0\n2 \u2264\u00a0A\u00a0\u2264\u00a0B\u00a0\u2264 10^7\u00a0\n1 \u2264\u00a0K\u00a0\u2264 10^9\u00a0</p>\n\n<p>Here is my Haskell solution:</p>\n\n<pre><code>import System.IO\nimport Data.List\nimport Control.Monad\n\nincEvery :: Int -&gt; [(Int -&gt; Int)]\nincEvery n = (cycle ((replicate (n-1) id) ++ [(+ 1)]))\n\nprimes2 :: [Int]\nprimes2 = sieve 2 (replicate (10^7) 0)\n  where\n    sieve _ [] = []\n    sieve n (a:xs) = (a + (if a == 0 then 1 else 0))\n      : if a == 0 then\n          sieve (n+1) (zipWith ($) (incEvery n) xs)\n        else\n          sieve (n+1) xs\n\nprocess :: (Int, Int, Int) -&gt; Int\nprocess (lo, hi, k) =\n  length . filter (\\(a, b) -&gt; a &gt;= lo &amp;&amp; a &lt;= hi &amp;&amp; b == k) . zip [2,3..] $ primes2\n\nreadIn :: [String] -&gt; (Int, Int, Int)\nreadIn =\n  (\\[x, y, z] -&gt; (x, y, z)) . fmap (read::String-&gt;Int) . take 3\n\nlib :: String -&gt; String\nlib xs = unlines . fmap (\\(i, x) -&gt; \"Case #\" ++ (show i) ++ \": \" ++ x) . zip [1,2..]\n  . fmap parse . tail . lines $ xs\n  where\n    parse = (show . process . readIn . words)\n\nmain :: IO ()\nmain = interact lib\n</code></pre>\n\n<p>Here is my Perl solution:</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy $max = 10000010;\n\nmy @f = (0) x $max;\n\nfor my $i (2 .. $max) {\n    if($f[$i] == 0) {\n        $f[$i] = 1;\n        # print $i . \"\\n\";\n        for my $j (2 .. ($max / $i)) {\n            $f[$i * $j] ++;\n        }\n    }\n}\n\nmy $k =  &lt;STDIN&gt;;\nfor my $i (1 .. $k) {\n    my $line = &lt;STDIN&gt;;\n    if($line) {\n        chomp $line;\n        my ($a, $b, $t) = split(' ', $line);\n        my $ans = 0;\n        for my $j ($a .. $b) {\n            if($f[$j] == $t) {\n                $ans ++;\n            }\n        }\n        print \"Case #$i: \" . $ans . \"\\n\";\n    }    \n}\n</code></pre>\n\n<p>Though I am using the same sieving algorithm for both languages, the Haskell version is significantly slower than Perl version on 10^7 scale of data.\nBasically the following Haskell function is slower than its Perl counterpart:</p>\n\n<pre><code>incEvery :: Int -&gt; [(Int -&gt; Int)]\nincEvery n = (cycle ((replicate (n-1) id) ++ [(+ 1)]))\n\nprimes2 :: [Int]\nprimes2 = sieve 2 (replicate (10^7) 0)\n  where\n   sieve _ [] = []\n   sieve n (a:xs) = (a + (if a == 0 then 1 else 0))\n   : if a == 0 then\n      sieve (n+1) (zipWith ($) (incEvery n) xs)\n     else\n      sieve (n+1) xs\n</code></pre>\n\n<p>I think both recursion and <code>(zipWith ($) (incEvery n) xs)</code> are causing the problem. Any ideas?</p>\n"}, {"tags": ["haskell", "higher-order-functions"], "comments": [{"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 3, "creation_date": 1454083001, "post_id": 35088503, "comment_id": 57899265, "body": "It sounds like you&#39;ve got the basic gist of it. Do you have a specific question?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1454083087, "post_id": 35088503, "comment_id": 57899343, "body": "<code>(++ &quot; HAHA&quot;)</code> is actually a <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-300003.5\" rel=\"nofollow noreferrer\">section</a> but beyond that your understanding look correct. What do you have a problem with?"}], "answers": [{"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": true, "score": 3, "last_activity_date": 1454085728, "creation_date": 1454085728, "answer_id": 35089661, "question_id": 35088503, "link": "https://stackoverflow.com/questions/35088503/higher-order-functions/35089661#35089661", "title": "Higher Order Functions", "body": "<blockquote>\n  <p>What is the difference between <code>(++ \" HAHA\")</code> and <code>(\"HAHA \" ++)</code>?</p>\n</blockquote>\n\n<p><code>(++ \" HAHA\")</code> gives <code>\" HAHA\"</code> as the second argument to the <code>(++)</code> function.</p>\n\n<p><code>(\"HAHA \" ++)</code> gives <code>\"HAHA \"</code> as the first argument to the <code>(++)</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 5, "last_activity_date": 1454085811, "creation_date": 1454085811, "answer_id": 35089699, "question_id": 35088503, "link": "https://stackoverflow.com/questions/35088503/higher-order-functions/35089699#35089699", "title": "Higher Order Functions", "body": "<p>The difference between <code>(++ \" HAHA\")</code> and <code>(\"HAHA \" ++)</code> has to do with the order in which parameters are passed in. If we explicitly use lambdas, the expressions look like this:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>(++ \" HAHA\") == (\\x -&gt; x ++ \" HAHA\") -- expands to: \"HEY\" ++ \" HAHA\"\n(\"HAHA \" ++) == (\\x -&gt; \"HAHA \" ++ x) -- expands to: \"HAHA \" ++ \"HEY\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 3, "last_activity_date": 1454086142, "creation_date": 1454086142, "answer_id": 35089810, "question_id": 35088503, "link": "https://stackoverflow.com/questions/35088503/higher-order-functions/35089810#35089810", "title": "Higher Order Functions", "body": "<p><code>(++ \"HAHA\")</code> is the same as <code>(\\x -&gt; x ++ \"HAHA\")</code></p>\n\n<p>whereas</p>\n\n<p><code>(\"HAHA\" ++)</code> equals <code>(\\x -&gt; \"HAHA\" ++ x)</code></p>\n\n<p>This is also quite obvious from your tests. This syntax is called <em>section</em> and makes partial application of (non-commutative) binary operators easier and more intuitive.</p>\n"}], "owner": {"reputation": 165, "user_id": 5857949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e83895d561b94f0c697aab40e0f9658c?s=128&d=identicon&r=PG&f=1", "display_name": "karambit", "link": "https://stackoverflow.com/users/5857949/karambit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 35089661, "answer_count": 3, "score": 2, "last_activity_date": 1454086142, "creation_date": 1454082503, "last_edit_date": 1454085484, "question_id": 35088503, "link": "https://stackoverflow.com/questions/35088503/higher-order-functions", "title": "Higher Order Functions", "body": "<p>I am trying to learn about higher order functions from this guide here <a href=\"http://learnyouahaskell.com/higher-order-functions\" rel=\"nofollow\">http://learnyouahaskell.com/higher-order-functions</a>. But I am sort of confused and hoped that someone can clarify some things for me.</p>\n\n<p>So I am looking at this example:</p>\n\n<pre><code>applyTwice :: (a -&gt; a) -&gt; a -&gt; a  \napplyTwice f x = f (f x)  \n</code></pre>\n\n<p>Ok so <code>applyTwice</code> is a function that takes two arguments, a function which takes a type <code>a</code> and return type <code>a</code>, the second argument is a type <code>a</code>. And the function returns a type <code>a</code>.</p>\n\n<p>And in the command line we get this result:</p>\n\n<pre><code>ghci&gt; applyTwice (++ \" HAHA\") \"HEY\"  \n\"HEY HAHA HAHA\" \n</code></pre>\n\n<p>So the function <code>f</code> is <code>(++)</code> and its type is <code>[a] -&gt; [a] -&gt; [a]</code>. <code>(++ \" HAHA\")</code> is a partial application correct? We have only given it one parameter and so it returns <code>[a] -&gt; [a]</code>. \nIn the <code>applyTwice</code> defintion, I want to start with the <code>(f x)</code> part. So f takes \"HEY\" this produces \"HEY HAHA\" which is type <code>a</code>, and then I need to apply <code>f</code> to get \"HEY HAHA HAHA\"</p>\n\n<p>edit:\nWith these two examples: what is the difference between <code>(++ \" HAHA\")</code> and <code>(\"HAHA \" ++)</code></p>\n\n<pre><code>ghci&gt; applyTwice (++ \" HAHA\") \"HEY\"  \n\"HEY HAHA HAHA\"  \n\nghci&gt; applyTwice (\"HAHA \" ++) \"HEY\"  \n\"HAHA HAHA HEY\" \n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "combinations"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1454072095, "post_id": 35084867, "comment_id": 57891678, "body": "Just write a recursive function. Given the combinations for <code>n-1</code> choices, generate those for <code>n</code> choices. You&#39;ll want to output a list, not a fixed-length tuple."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 9, "creation_date": 1454072203, "post_id": 35084867, "comment_id": 57891747, "body": "If after you solve this you want to exploit library functions anyway, know that <code>replicateM n [1..100]</code> does the job. It&#39;s a non-trivial exercise to realize why, though -- so leave that for when you are more familiar with Haskell."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1454081500, "post_id": 35084867, "comment_id": 57898132, "body": "<code>sequence $ replicate 3 [0..9]</code> will generate the cross product as a list, not a tuple but easy to generalize"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 2, "creation_date": 1454087135, "post_id": 35084867, "comment_id": 57902121, "body": "Generate all combinations of numbers... for e.g. 3 digits that&#39;d be <code>000</code>, <code>001</code>, <code>002</code>... <code>009</code>, <code>010</code>, <code>011</code>... <code>999</code>... Am I missing something, or isn&#39;t this the mathematical concept known as <b>counting</b>?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1454100199, "post_id": 35084867, "comment_id": 57909160, "body": "The two code samples you provide seem to do different things, neither of which is what you describe in the first paragraph. Looking at the linked post it makes a bit more sense, but even so its not clear."}, {"owner": {"reputation": 1821, "user_id": 2391244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyC7o.jpg?s=128&g=1", "display_name": "BalinKingOfMoria Reinstate CMs", "link": "https://stackoverflow.com/users/2391244/balinkingofmoria-reinstate-cms"}, "edited": false, "score": 0, "creation_date": 1454169417, "post_id": 35084867, "comment_id": 57928466, "body": "Are tuples required or will a list work?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1454184526, "post_id": 35084867, "comment_id": 57933902, "body": "Define &quot;duplicate&quot;. Do you mean the same n-uple appearing multiple times, or duplicates <i>inside</i> an n-uple? Also does ordering of the elements of a tuple count?"}, {"owner": {"reputation": 596, "user_id": 3144143, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/U5H4X.jpg?s=128&g=1", "display_name": "James Allingham", "link": "https://stackoverflow.com/users/3144143/james-allingham"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1454188281, "post_id": 35084867, "comment_id": 57935284, "body": "@karakfa Thanks, that is simple and works perfectly!"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1577022680, "post_id": 35084867, "comment_id": 105072332, "body": "Why nobody mentioned that this question has absolutely nothing to do with combinations."}], "answers": [{"comments": [{"owner": {"reputation": 596, "user_id": 3144143, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/U5H4X.jpg?s=128&g=1", "display_name": "James Allingham", "link": "https://stackoverflow.com/users/3144143/james-allingham"}, "edited": false, "score": 0, "creation_date": 1454309563, "post_id": 35108514, "comment_id": 57969167, "body": "This was an incredible post! Haskell is continuously blowing my mind! Do you have any tutorials that you would reccomend? As you noted this answer is easier to follow than your second one and while I think I can understand this one, I barely touch the surface of the other one. It is very intimidating! However it was very cool to see how your solution tied so nicely into the Standard Library. If I could accept both asnwers I would!"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 596, "user_id": 3144143, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/U5H4X.jpg?s=128&g=1", "display_name": "James Allingham", "link": "https://stackoverflow.com/users/3144143/james-allingham"}, "edited": false, "score": 0, "creation_date": 1454318627, "post_id": 35108514, "comment_id": 57973630, "body": "Thanks! Happy to help. Tutorial-wise, you may have read it already but <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\"><i>Learn You A Haskell</i></a> remains one of the best programming books I&#39;ve ever read. It&#39;s funny and approachable and it explains the more advanced topics very well. By the way, if there&#39;s anything you don&#39;t understand about the other answer I&#39;ll be happy to elaborate."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1461021646, "last_edit_date": 1495535314, "creation_date": 1454196728, "answer_id": 35108514, "question_id": 35084867, "link": "https://stackoverflow.com/questions/35084867/haskell-generating-all-combinations-of-n-numbers/35108514#35108514", "title": "Haskell generating all combinations of n numbers", "body": "<p>What are all the combinations of three digits? Let's write a few out manually.</p>\n\n<pre><code>000, 001, 002 ... 009, 010, 011 ... 099, 100, 101 ... 998, 999\n</code></pre>\n\n<p>We ended up simply <em>counting</em>! We enumerated all the numbers between 0 and 999. For an arbitrary number of digits this generalises straightforwardly: the upper limit is <code>10^n</code> (exclusive), where <code>n</code> is the number of digits.</p>\n\n<p>Numbers are designed this way on purpose. It would be jolly strange if there was a possible combination of three digits which wasn't a valid number, or if there was a three-digit number which couldn't be expressed by combining three digits!</p>\n\n<p>This suggests a simple plan to me, which just involves arithmetic and doesn't require a deep understanding of Haskell*:</p>\n\n<ol>\n<li>Generate a list of numbers between 0 and <code>10^n</code></li>\n<li>Turn each number into a list of digits.</li>\n</ol>\n\n<p>Step 2 is the fun part. To extract the digits (in base 10) of a three-digit number, <a href=\"https://stackoverflow.com/questions/3963269/split-a-number-into-its-digits-with-haskell\">you do this</a>:</p>\n\n<ol>\n<li>Take the quotient and remainder of your number with respect to 100. The quotient is the first digit of the number.</li>\n<li>Take the remainder from step 1 and take its quotient and remainder with respect to 10. The quotient is the second digit.</li>\n<li>The remainder from step 2 was the third digit. This is the same as taking the quotient with respect to 1.</li>\n</ol>\n\n<p>For an <em>n</em>-digit number, we take the quotient <code>n</code> times, starting with <code>10^(n-1)</code> and ending with <code>1</code>. Each time, we use the remainder from the last step as the input to the next step. This suggests that our function to turn a number into a list of digits should be implemented as a fold: we'll thread the remainder through the operation and build a list as we go. (I'll leave it to you to figure out how this algorithm changes if you're not in base 10!)</p>\n\n<hr>\n\n<p>Now let's implement that idea. We want calculate a specified number of digits, zero-padding when necessary, of a given number. What should the type of <code>digits</code> be?</p>\n\n<pre><code>digits :: Int -&gt; Int -&gt; [Int]\n</code></pre>\n\n<p>Hmm, it takes in a number of digits and an integer, and produces a list of integers representing the digits of the input integer. The list will contain single-digit integers, each one of which will be one digit of the input number.</p>\n\n<pre><code>digits numberOfDigits theNumber = reverse $ fst $ foldr step ([], theNumber) powersOfTen\n    where step exponent (digits, remainder) =\n              let (digit, newRemainder) = remainder `divMod` exponent\n              in (digit : digits, newRemainder)\n          powersOfTen = [10^n | n &lt;- [0..(numberOfDigits-1)]]\n</code></pre>\n\n<p>What's striking to me is that this code looks quite similar to my English description of the arithmetic we wanted to perform. We generate a powers-of-ten table by exponentiating numbers from 0 upwards. Then we fold that table back up; at each step we put the quotient on the list of digits and send the remainder to the next step. We have to <code>reverse</code> the output list at the end because of the right-to-left way it got built.</p>\n\n<p>By the way, the pattern of generating a list, transforming it, and then folding it back up is an idiomatic thing to do in Haskell. It's even got its own high-falutin' mathsy name, <em>hylomorphism</em>. <a href=\"https://downloads.haskell.org/~ghc/7.10.3/docs/html/users_guide/rewrite-rules.html#idp46686526200096\" rel=\"nofollow noreferrer\">GHC knows about this pattern too</a> and can compile it into a tight loop, optimising away the very existence of the list you're working with.</p>\n\n<p>Let's test it!</p>\n\n<pre><code>ghci&gt; digits 3 123\n[1, 2, 3]\nghci&gt; digits 5 10101\n[1, 0, 1, 0, 1]\nghci&gt; digits 6 99\n[0, 0, 0, 0, 9, 9]\n</code></pre>\n\n<p>It works like a charm! (Well, it misbehaves when <code>numberOfDigits</code> is too small for <code>theNumber</code>, but never mind about that.) Now we just have to generate a counting list of numbers on which to use <code>digits</code>.</p>\n\n<pre><code>combinationsOfDigits :: Int -&gt; [[Int]]\ncombinationsOfDigits numberOfDigits = map (digits numberOfDigits) [0..(10^numberOfDigits)-1]\n</code></pre>\n\n<p>... and we've finished!</p>\n\n<pre><code>ghci&gt; combinationsOfDigits 2\n[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,9],[1,0],[1,1] ... [9,7],[9,8],[9,9]]\n</code></pre>\n\n<p><sub>* For a version which <em>does</em> require a deep understanding of Haskell, see <a href=\"https://stackoverflow.com/a/35108876/1523776\">my other answer</a>.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1461069912, "post_id": 35108876, "comment_id": 61022680, "body": "Is this as efficient as the first answer? It looks like it should be, although I&#39;m not particularly well-versed in the optimization power of GHC."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1461072167, "post_id": 35108876, "comment_id": 61024549, "body": "Good question, to which I don&#39;t know the answer. I&#39;ll benchmark it when I have time later today and update the post."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 8, "last_activity_date": 1461081819, "last_edit_date": 1495541760, "creation_date": 1454199717, "answer_id": 35108876, "question_id": 35084867, "link": "https://stackoverflow.com/questions/35084867/haskell-generating-all-combinations-of-n-numbers/35108876#35108876", "title": "Haskell generating all combinations of n numbers", "body": "<p>My <a href=\"https://stackoverflow.com/a/35108514/1523776\">other answer</a> gave an arithmetic algorithm to enumerate all the combinations of digits. Here's an alternative solution which arises by generalising your example. It works for non-numbers, too, because it only uses the structure of lists.</p>\n\n<p>First off, let's remind ourselves of how you might use a list comprehension for three-digit combinations.</p>\n\n<pre><code>threeDigitCombinations = [[x, y, z] | x &lt;- [0..9], y &lt;- [0..9], z &lt;- [0..9]]\n</code></pre>\n\n<p>What's going on here? The list comprehension corresponds to nested loops. <code>z</code> counts from 0 to 9, then <code>y</code> goes up to 1 and <code>z</code> starts counting from 0 again. <code>x</code> ticks the slowest. As you note, the shape of the list comprehension changes (albeit in a uniform way) when you want a different number of digits. We're going to exploit that uniformity.</p>\n\n<pre><code>twoDigitCombinations = [[x, y] | x &lt;- [0..9], y &lt;- [0..9]]\n</code></pre>\n\n<p>We want to abstract over the number of variables in the list comprehension (equivalently, the nested-ness of the loop). Let's start playing around with it. First, I'm going to rewrite these list comprehensions as their equivalent <em>monad comprehensions</em>.</p>\n\n<pre><code>threeDigitCombinations = do\n    x &lt;- [0..9]\n    y &lt;- [0..9]\n    z &lt;- [0..9]\n    return [x, y, z]\ntwoDigitCombinations = do\n    x &lt;- [0..9]\n    y &lt;- [0..9]\n    return [x, y]\n</code></pre>\n\n<p>Interesting. It looks like <code>threeDigitCombinations</code> is roughly the same monadic action as <code>twoDigitCombinations</code>, but with an extra statement. Rewriting again...</p>\n\n<pre><code>zeroDigitCombinations = [[]]  -- equivalently, `return []`\noneDigitCombinations = do\n    z &lt;- [0..9]\n    empty &lt;- zeroDigitCombinations\n    return (z : empty)\ntwoDigitCombinations = do\n    y &lt;- [0..9]\n    z &lt;- oneDigitCombinations\n    return (y : z)\nthreeDigitCombinations = do\n    x &lt;- [0..9]\n    yz &lt;- twoDigitCombinations\n    return (x : yz)\n</code></pre>\n\n<p>It should be clear now what we need to parameterise:</p>\n\n<pre><code>combinationsOfDigits 0 = return []\ncombinationsOfDigits n = do\n    x &lt;- [0..9]\n    xs &lt;- combinationsOfDigits (n - 1)\n    return (x : xs)\n\nghci&gt; combinationsOfDigits' 2\n[[0,0],[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,9],[1,0],[1,1] ... [9,8],[9,9]]\n</code></pre>\n\n<hr>\n\n<p>It works, but we're not done yet. I want to show you that this is an instance of a more general monadic pattern. First I'm going to change the implementation of <code>combinationsOfDigits</code> so that it folds up a list of constants.</p>\n\n<pre><code>combinationsOfDigits n = foldUpList $ replicate n [0..9]\n    where foldUpList [] = return []\n          foldUpList (xs : xss) = do\n              x &lt;- xs\n              ys &lt;- foldUpList xss\n              return (x : ys)\n</code></pre>\n\n<p>Looking at the definiton of <code>foldUpList :: [[a]] -&gt; [[a]]</code>, we can see that it doesn't actually require the use of <em>lists</em> per se: it only uses the monad-y parts of lists. It could work on any monad, and indeed it does! It's in the standard library, and it's called <a href=\"https://hackage.haskell.org/package/base-4.7.0.0/docs/Prelude.html#v:sequence\" rel=\"nofollow noreferrer\"><code>sequence :: Monad m =&gt; [m a] -&gt; m [a]</code></a>. If you're confused by that, replace <code>m</code> with <code>[]</code> and you should see that those types mean the same thing.</p>\n\n<pre><code>combinationsOfDigits n = sequence $ replicate n [0..9]\n</code></pre>\n\n<p>Finally, noting that <code>sequence . replicate n</code> is the definition of <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><code>replicateM</code></a>, we get it down to a very snappy one-liner.</p>\n\n<pre><code>combinationsOfDigits n = replicateM n [0..9]\n</code></pre>\n\n<p>To summarise, <code>replicateM n</code> gives the <em>n</em>-ary combinations of an input list. This works for any list, not just a list of numbers. Indeed, it works for any monad - though the \"combinations\" interpretation only makes sense when your monad represents choice.</p>\n\n<p>This code is very terse indeed! So much so that I think it's not entirely obvious how it works, unlike the arithmetic version I showed you in my other answer. The list monad has always been one of the monads I find less intuitive, at least when you're using higher-order monad combinators and not <code>do</code>-notation.</p>\n\n<p>On the other hand, it runs quite a lot faster than the number-crunching version. On my (high-spec) MacBook Pro, compiled with <code>-O2</code>, this version calculates the 5-digit combinations about 4 times faster than the version which crunches numbers. (If anyone can explain the reason for this I'm listening!)</p>\n\n<p><a href=\"https://i.stack.imgur.com/uPlHG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uPlHG.png\" alt=\"benchmark\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 528, "user_id": 4636182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5403c86cb21ace416b4cb758fabb72b7?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Prokin", "link": "https://stackoverflow.com/users/4636182/ilya-prokin"}, "is_accepted": false, "score": 1, "last_activity_date": 1501340918, "creation_date": 1501340918, "answer_id": 45390775, "question_id": 35084867, "link": "https://stackoverflow.com/questions/35084867/haskell-generating-all-combinations-of-n-numbers/45390775#45390775", "title": "Haskell generating all combinations of n numbers", "body": "<pre><code>combos 1 list = map (\\x -&gt; [x]) list\ncombos n list = foldl (++) [] $ map (\\x -&gt; map (\\y -&gt; x:y) nxt) list\n    where nxt = combos (n-1) list\n</code></pre>\n\n<p>In your case</p>\n\n<pre><code>combos 3 [0..9]\n</code></pre>\n"}], "owner": {"reputation": 596, "user_id": 3144143, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/U5H4X.jpg?s=128&g=1", "display_name": "James Allingham", "link": "https://stackoverflow.com/users/3144143/james-allingham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4068, "favorite_count": 3, "accepted_answer_id": 35108514, "answer_count": 3, "score": 8, "last_activity_date": 1501340918, "creation_date": 1454071404, "last_edit_date": 1495540360, "question_id": 35084867, "link": "https://stackoverflow.com/questions/35084867/haskell-generating-all-combinations-of-n-numbers", "title": "Haskell generating all combinations of n numbers", "body": "<p>I am trying to generate all possible combinations of n numbers. For example if n = 3 I would want the following combinations:</p>\n\n<pre><code>(0,0,0), (0,0,1), (0,0,2)... (0,0,9), (0,1,0)... (9,9,9).\n</code></pre>\n\n<p>This <a href=\"https://stackoverflow.com/questions/27180196/generating-all-possible-combinations-of-numbers-in-a-triplet\">post</a> describes how to do so for n = 3:</p>\n\n<pre><code>[(a,b,c) | m &lt;- [0..9], a &lt;- [0..m], b &lt;- [0..m], c &lt;- [0..m] ]\n</code></pre>\n\n<p>Or to avoid duplicates (i.e. multiple copies of the same n-uple):</p>\n\n<pre><code>let l = 9; in [(a,b,c) | m &lt;- [0..3*l],\n                         a &lt;- [0..l], b &lt;- [0..l], c &lt;- [0..l],\n                         a + b + c == m ]\n</code></pre>\n\n<p>However following the same pattern would become very silly very quickly for <code>n &gt; 3</code>. Say I wanted to find all of the combinations: <code>(a, b, c, d, e, f, g, h, i, j)</code>, etc.</p>\n\n<p>Can anyone point me in the right direction here? Ideally I'd rather not use a built in funtion as I am trying to learn Haskell and I would rather take the time to understand a peice of code than just use a package written by someone else. A tuple is not required, a list would also work.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1454054697, "post_id": 35079176, "comment_id": 57881128, "body": "AFAIK it&#39;s not possible. The best thing is to use <code>:info</code>. It also tells you in which module the instances are defined. you can then search for the module on hoogle or similar and see the source code."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1454055927, "post_id": 35079176, "comment_id": 57881762, "body": "I think you can use lambdabot and call it from inside ghci, but I don&#39;t know how active it&#39;s developed these days. So during installation not everything might be smooth"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1454057701, "post_id": 35079176, "comment_id": 57882807, "body": "No. This may help you: <a href=\"https://stackoverflow.com/questions/18304714/seeing-typeclass-definition-in-ghci-for-a-specific-type\" title=\"seeing typeclass definition in ghci for a specific type\">stackoverflow.com/questions/18304714/&hellip;</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1454058750, "post_id": 35079176, "comment_id": 57883414, "body": "this is the single most important feature that is missing."}], "owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1454057754, "answer_count": 0, "score": 1, "last_activity_date": 1454057673, "creation_date": 1454053135, "question_id": 35079176, "link": "https://stackoverflow.com/questions/35079176/how-to-find-instance-implementation-of-an-operator-in-ghci", "closed_reason": "Duplicate", "title": "How to find instance implementation of an operator in ghci", "body": "<p>I know about :t and :info, but let's say for [] I want to see the definition of instance definition of >>= for type class Monad, whats' the quickest way to do that in ghci? Or is there some standard tool?   </p>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1454097778, "post_id": 35078554, "comment_id": 57907872, "body": "In regards to 3, this is a typical problem with Haskell (GHC) and especially with libraries with provide DSLs - they rely on <i>type inference</i> to work, and type inference only works if you actually use the type of a value somewhere! This is obviously fine in practice but when testing and experimenting you will often run into this situation. Generally speaking an &quot;amiguous type&quot; error corresponds to something like this (unused polymorphic value) - if you see this error look for this sort of thing."}], "tags": [], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "is_accepted": true, "score": 6, "last_activity_date": 1454050451, "creation_date": 1454050451, "answer_id": 35078554, "question_id": 35077554, "link": "https://stackoverflow.com/questions/35077554/how-to-parse-json-with-aeson-without-declaring-individual-types/35078554#35078554", "title": "How to parse JSON with Aeson without declaring individual types", "body": "<p>Thanks to Cale at #haskell here's the working code:</p>\n\n<pre><code>aria2WebsocketReceiver :: WS.Connection -&gt; IO ()\naria2WebsocketReceiver conn = do\n  msg &lt;- WS.receiveData conn\n  let v = do res &lt;- decode msg\n             flip parseMaybe res $ \\o -&gt; do\n                                         r &lt;- o .: \"result\"\n                                         version &lt;- r .: \"version\"\n                                         return $ \"version=\" ++ (version :: String)\n  putStrLn (show v)\n  aria2WebsocketReceiver conn\n</code></pre>\n\n<p>There were three problems in the earlier code:</p>\n\n<ol>\n<li>The type of <code>decode msg</code> is a <code>Maybe</code> which needs to be inside a separate <code>do</code> block.</li>\n<li>Because of <code>{-# LANGUAGE OverloadedStrings #-}</code> the compiler wasn't being able to infer the type for <code>version</code>, hence the <code>(version :: String)</code> hint.</li>\n<li>Similarly, <code>enabledFeatures</code> and <code>id_</code> were being assigned but not being used anywhere, which was causing more problem in type-inference.</li>\n</ol>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 1, "accepted_answer_id": 35078554, "answer_count": 1, "score": 2, "last_activity_date": 1454050451, "creation_date": 1454045487, "question_id": 35077554, "link": "https://stackoverflow.com/questions/35077554/how-to-parse-json-with-aeson-without-declaring-individual-types", "title": "How to parse JSON with Aeson without declaring individual types", "body": "<p>(Haskell newbie alert)</p>\n\n<p>Here's a snippet of the code that I'm struggling with. Basically, I'm taking a JSON coming in from a websocket and I want to parse it using Aeson without defining individual data types for each response.</p>\n\n<pre><code>import Data.Aeson\nimport qualified Network.WebSockets  as WS\n\naria2WebsocketReceiver :: WS.Connection -&gt; IO ()\naria2WebsocketReceiver conn = do\n  msg &lt;- WS.receiveData conn\n  let res = decode msg\n  let v = flip parseMaybe res $ \\o -&gt; do\n                                      r &lt;- o .: \"result\"\n                                      version &lt;- r .: \"version\"\n                                      enabledFeatures &lt;- r .: \"enabledFeatures\"\n                                      id_ &lt;- r .: \"id\"\n                                      return $ \"version=\" ++ version\n  putStrLn (show v)\n  aria2WebsocketReceiver conn\n</code></pre>\n\n<p>Here are the compilation errors that I'm running into:</p>\n\n<pre><code>Nightwatch/Telegram.hs:244:13:\n    No instance for (FromJSON a0) arising from a use of \u2018decode\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Relevant bindings include\n      res :: Maybe a0 (bound at Nightwatch/Telegram.hs:244:7)\n    Note: there are several potential instances:\n      instance FromJSON Chat -- Defined at Nightwatch/Telegram.hs:90:10\n      instance FromJSON Message\n        -- Defined at Nightwatch/Telegram.hs:106:10\n      instance FromJSON TelegramResponse\n        -- Defined at Nightwatch/Telegram.hs:122:10\n      ...plus two others\n    In the expression: decode msg\n    In an equation for \u2018res\u2019: res = decode msg\n    In the expression:\n      do { msg &lt;- WS.receiveData conn;\n           let res = decode msg;\n           let v = flip parseMaybe res $ ...;\n           putStrLn (show v);\n           .... }\n\nNightwatch/Telegram.hs:246:44:\n    Couldn't match type \u2018Maybe a0\u2019\n                   with \u2018unordered-containers-0.2.5.1:Data.HashMap.Base.HashMap\n                           Text Value\u2019\n    Expected type: Object\n      Actual type: Maybe a0\n    Relevant bindings include\n      o :: Maybe a0 (bound at Nightwatch/Telegram.hs:245:34)\n      res :: Maybe a0 (bound at Nightwatch/Telegram.hs:244:7)\n    In the first argument of \u2018(.:)\u2019, namely \u2018o\u2019\n    In a stmt of a 'do' block: r &lt;- o .: \"result\"\n</code></pre>\n\n<p>I'm basically trying to replicate the \"Working with the AST\" example given at <a href=\"https://hackage.haskell.org/package/aeson-0.10.0.0/docs/Data-Aeson.html\" rel=\"nofollow\">https://hackage.haskell.org/package/aeson-0.10.0.0/docs/Data-Aeson.html</a></p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1995, "user_id": 3492631, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/6X56B.jpg?s=128&g=1", "display_name": "Dendi Suhubdy", "link": "https://stackoverflow.com/users/3492631/dendi-suhubdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1454039648, "creation_date": 1454039648, "answer_id": 35076581, "question_id": 35076495, "link": "https://stackoverflow.com/questions/35076495/error-while-compiling-quipper-0-7/35076581#35076581", "title": "Error while compiling Quipper 0.7", "body": "<p>I finally resolved it by</p>\n\n<pre><code>sudo apt-get install cabal-install \ncabal update \n</code></pre>\n\n<p>then I was able to install the random package with </p>\n\n<pre><code>cabal install random\n</code></pre>\n"}], "owner": {"reputation": 1995, "user_id": 3492631, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/6X56B.jpg?s=128&g=1", "display_name": "Dendi Suhubdy", "link": "https://stackoverflow.com/users/3492631/dendi-suhubdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1454039648, "creation_date": 1454038988, "question_id": 35076495, "link": "https://stackoverflow.com/questions/35076495/error-while-compiling-quipper-0-7", "title": "Error while compiling Quipper 0.7", "body": "<p>I have tried to build the Quipper quantum programming language by Dr Selinger but I found this error in Haskell that I don't understand.</p>\n\n<pre><code>/Applications/Xcode.app/Contents/Developer/usr/bin/make SUBDIR_TARGET=all  quipper Libraries QuipperLib Algorithms/BF Algorithms/BWT Algorithms/CL Algorithms/GSE Algorithms/QLS Algorithms/TF Algorithms/USV Programs/QCLParser Programs/Tools tests tests/template\n/Applications/Xcode.app/Contents/Developer/usr/bin/make  -C \"Libraries\" all\ncd /private/var/.home/admin/Documents/code/quipper-0.7; \"/private/var/.home/admin/Documents/code/quipper-0.7/quipper/scripts/quipper\" -O -rtsopts -with-rtsopts=-K50m -i\"/private/var/.home/admin/Documents/code/quipper-0.7/quipper\" -i\"/private/var/.home/admin/Documents/code/quipper-0.7\" -fwarn-incomplete-patterns -Werror Libraries/Auxiliary.hs &amp;&amp; touch -c Libraries/Auxiliary.hi\n[1 of 1] Compiling Libraries.Auxiliary ( Libraries/Auxiliary.hs, Libraries/Auxiliary.o )\ncd /private/var/.home/admin/Documents/code/quipper-0.7; \"/private/var/.home/admin/Documents/code/quipper-0.7/quipper/scripts/quipper\" -O -rtsopts -with-rtsopts=-K50m -i\"/private/var/.home/admin/Documents/code/quipper-0.7/quipper\" -i\"/private/var/.home/admin/Documents/code/quipper-0.7\" -fwarn-incomplete-patterns -Werror Libraries/CommandLine.hs &amp;&amp; touch -c Libraries/CommandLine.hi\n[2 of 2] Compiling Libraries.CommandLine ( Libraries/CommandLine.hs, Libraries/CommandLine.o )\ncd /private/var/.home/admin/Documents/code/quipper-0.7; \"/private/var/.home/admin/Documents/code/quipper-0.7/quipper/scripts/quipper\" -O -rtsopts -with-rtsopts=-K50m -i\"/private/var/.home/admin/Documents/code/quipper-0.7/quipper\" -i\"/private/var/.home/admin/Documents/code/quipper-0.7\" -fwarn-incomplete-patterns -Werror Libraries/PortableSignals.hs &amp;&amp; touch -c Libraries/PortableSignals.hi\n[1 of 1] Compiling Libraries.PortableSignals ( Libraries/PortableSignals.hs, Libraries/PortableSignals.o )\ncd /private/var/.home/admin/Documents/code/quipper-0.7; \"/private/var/.home/admin/Documents/code/quipper-0.7/quipper/scripts/quipper\" -O -rtsopts -with-rtsopts=-K50m -i\"/private/var/.home/admin/Documents/code/quipper-0.7/quipper\" -i\"/private/var/.home/admin/Documents/code/quipper-0.7\" -fwarn-incomplete-patterns -Werror Libraries/RandomSource.hs &amp;&amp; touch -c Libraries/RandomSource.hi\n\nLibraries/RandomSource.hs:17:8:\n    Could not find module \u2018System.Random\u2019\n    Use -v to see a list of the files searched for.\nmake[2]: *** [RandomSource.hi] Error 1\nmake[1]: *** [Libraries] Error 2\nmake: *** [all] Error 2\n</code></pre>\n"}, {"tags": ["haskell", "algebraic-data-types"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1454027811, "post_id": 35074751, "comment_id": 57872617, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2801786/pattern-matching-for-lambda-expressions\">Pattern matching for lambda expressions</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1454028125, "post_id": 35074751, "comment_id": 57872721, "body": "Do you really need seperate <code>Credit</code> and <code>Debit</code> constructors? Why not a single constructor with positive or negative numbers?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1454028642, "post_id": 35074751, "comment_id": 57872869, "body": "The syntax you want is a case statement: <code>\\x -&gt; case x of { Credit c -&gt; ..; Debit c -&gt; ..}</code> - or <code>\\case { ... }</code> with the LamdbaCase extension. Of course you may end up with a lot of duplication this way, but this is related to your encoding. See comment above mine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4709293"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454099926, "post_id": 35074751, "comment_id": 57909020, "body": "@leftaroundabout yes, I do need."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4709293"}, "edited": false, "score": 0, "creation_date": 1454099817, "post_id": 35075038, "comment_id": 57908963, "body": "When compiling : parse error on input `case&#39; Failed, modules loaded: none."}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 0, "creation_date": 1454101898, "post_id": 35075038, "comment_id": 57910095, "body": "You&#39;re getting a compile error even when using the <code>LambdaCase</code> extension? What is your GHC version? It has been available <a href=\"https://ghc.haskell.org/trac/ghc/ticket/4359#comment:87\" rel=\"nofollow noreferrer\">since GHC 7.6.1</a>."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 5, "last_activity_date": 1454028678, "creation_date": 1454028678, "answer_id": 35075038, "question_id": 35074751, "link": "https://stackoverflow.com/questions/35074751/how-to-use-high-order-functions-with-data-types-in-haskell/35075038#35075038", "title": "How to use high order functions with data types in Haskell", "body": "<p>You can use the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html\" rel=\"noreferrer\"><code>LambdaCase</code></a> extension to make the lambda a bit more concise:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>{-# LANGUAGE LambdaCase #-}\n\ndata Movement = Credit Float | Debit Float\n    deriving Show\n\nfoo = map (\\case { Credit f -&gt; f; Debit d -&gt; d}) [Credit 1, Debit 2] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1454032498, "creation_date": 1454032498, "answer_id": 35075581, "question_id": 35074751, "link": "https://stackoverflow.com/questions/35074751/how-to-use-high-order-functions-with-data-types-in-haskell/35075581#35075581", "title": "How to use high order functions with data types in Haskell", "body": "<p>In this specific case, you could use record syntax.</p>\n\n<pre><code>data Movement = Credit { value :: Float } | Debit { value :: Float }\nretrieve l k = filter (\\mvmt -&gt; value mvmt &gt; k) l\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1454065945, "last_edit_date": 1454065945, "creation_date": 1454038059, "answer_id": 35076363, "question_id": 35074751, "link": "https://stackoverflow.com/questions/35074751/how-to-use-high-order-functions-with-data-types-in-haskell/35076363#35076363", "title": "How to use high order functions with data types in Haskell", "body": "<p>you can create a helper called <code>absMovement</code> and then just trivially <code>filter</code> using that:</p>\n\n<pre><code>absMovement :: Movement -&gt; Float\nabsMovement (Credit c) = c\nabsMovement (Debit  d) = d\n\nretrieveBiggerThan k =\n  filter (\\x -&gt; absMovement x &gt; k)\n</code></pre>\n\n<p>(note the curried definition of the function with also its argument order flipped \u2014 this is more idiomatic in Haskell for many practical reasons which are beyond the scope of this post)</p>\n\n<p>you can also go point free(r) if you prefer:</p>\n\n<pre><code>retrieveBiggerThan k =\n  filter $ (k &lt;) . absMovement\n</code></pre>\n\n<p>which reads: <em>\"retrieving bigger than k [of movements] amounts to filtering [of movements] whose absMovement is greater tham k\"</em> \u2014 the bracketed phrases correspond to the arguments that were \"curried away\". </p>\n\n<p>P.S. totally missed that actually using record syntax, you can obtain the <code>absMovement</code> function for free, as Daniel Wagner points out; but then again it's nice to think of this as <code>abs</code>ing, in my opinion. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4709293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1454065945, "creation_date": 1454026897, "question_id": 35074751, "link": "https://stackoverflow.com/questions/35074751/how-to-use-high-order-functions-with-data-types-in-haskell", "title": "How to use high order functions with data types in Haskell", "body": "<p>Consider the following data type.</p>\n\n<pre><code>data Movement = Credit Float | Debit Float\n    deriving Show\n</code></pre>\n\n<p>And now this function.</p>\n\n<pre><code>retrieveBiggerThan :: [Movement] -&gt; Float -&gt; [Movement]\nretrieveBiggerThan l k = (filter (\\(Credit c) -&gt; c&gt;k) l) ++ (filter (\\(Debit c) -&gt; c&gt;k) l)\n</code></pre>\n\n<p>If I test this, I receive as output \"non-exhaustive patterns in lambda\":</p>\n\n<pre><code>retrieveBiggerThan [Credit 5.5, Debit 2.3, Credit 3.3] 2\n\n[Credito 5.5*** Exception: ficha7.hs:116:35-53: Non-exhaustive patterns in lambda\n</code></pre>\n\n<p>I believe this happens because filter is only expecting for one of the constructors defined in <code>data Movement</code>. Is there any chance of doing something like this (a filter able to consider both constructors while checking the list)?</p>\n\n<pre><code>filter (\\((Credit c) || (Debit c)) -&gt; c &gt; k) listofmovements\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1454008002, "post_id": 35069829, "comment_id": 57862841, "body": "What is the exact error message?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1454008011, "post_id": 35069829, "comment_id": 57862847, "body": "When running this through <code>ghci</code>, this works for me..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 13, "creation_date": 1454008481, "post_id": 35069829, "comment_id": 57863117, "body": "This smells like an indentation issue. Are you using tabs? Run GHC with <code>-fwarn-tabs</code> and if it barks at you, replace the tabs with spaces."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 1, "last_activity_date": 1454030552, "last_edit_date": 1454030552, "creation_date": 1454015407, "answer_id": 35072102, "question_id": 35069829, "link": "https://stackoverflow.com/questions/35069829/haskell-let-in-expression/35072102#35072102", "title": "Haskell - Let in expression", "body": "<p>This worked for me:</p>\n\n<pre><code>   Prelude CA&gt; let cylinder r h = \n   Prelude CA|       let sideArea = 2*pi*r*h\n   Prelude CA|           topArea = pi*r^2\n   Prelude CA|       in sideArea + 2*topArea\n   Prelude CA| \n   Prelude CA&gt; cylinder 5 9\n   439.822971502571\n</code></pre>\n\n<p>I guess it's simply an indentation problem</p>\n\n<pre><code>   &lt;interactive&gt;:48:5: parse error (possibly incorrect indentation)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3886346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9de16ac7e9cc2aa21e1218fcb96fe7c5?s=128&d=identicon&r=PG&f=1", "display_name": "user3886346", "link": "https://stackoverflow.com/users/3886346/user3886346"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1454280886, "creation_date": 1454007763, "last_edit_date": 1454280886, "question_id": 35069829, "link": "https://stackoverflow.com/questions/35069829/haskell-let-in-expression", "title": "Haskell - Let in expression", "body": "<p>Im trying to replicate the example of the book \"Learn a Haskell for a Great Good\", with the use of <code>let</code> and <code>in</code>.</p>\n\n<p>The thing is that, although I write the same code in the same way, it doesn't work and shows me a failure with the second \"=\" in the second variable.</p>\n\n<p>Can anyone help me with this issue?</p>\n\n<pre><code>cylinder :: (RealFloat a) =&gt; a -&gt;a -&gt;a\ncylinder r h = \n      let sideArea = 2*pi*r*h\n          topArea = pi*r^2\n      in sideArea + 2*topArea\n</code></pre>\n"}, {"tags": ["list", "haskell", "recursion", "boolean", "pattern-matching"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454015008, "post_id": 35069169, "comment_id": 57866903, "body": "A good way to catch missing patterns is to run GHC with <code>-fwarn-incomplete-patterns</code> or just <code>-Wall</code>. Typically, write <code>{-# OPTIONS_GHC -Wall #-}</code> way up at the top of the file."}], "answers": [{"comments": [{"owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1454006459, "post_id": 35069298, "comment_id": 57861792, "body": "Oh I see, yes that does work and I&#39;ve now found an instance in which mine doesn&#39;t, when I make the first list contain any single integer it will return true. Can you explain the <code>(_:_)</code> part of your solution?"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1454007773, "post_id": 35069298, "comment_id": 57862686, "body": "<code>(_:_) []</code> matches the case when the first list is longer than the second, meaning the first could never be a prefix of the second. (the code could actually be shortened to <code>_ []</code> since we&#39;ve already matched on an empty first list in the first pattern)"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "edited": false, "score": 0, "creation_date": 1454011982, "post_id": 35069298, "comment_id": 57865154, "body": "@GarethAllen-Stringer <code>(x:xs)</code> in that case pattern-matches on the first item of the list (<code>x</code>) and the tail (<code>xs</code>), see <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions</a>"}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 5, "last_activity_date": 1454010600, "last_edit_date": 1454010600, "creation_date": 1454005952, "answer_id": 35069298, "question_id": 35069169, "link": "https://stackoverflow.com/questions/35069169/make-haskell-list-recursion-function-more-efficient/35069298#35069298", "title": "Make Haskell List Recursion function more efficient", "body": "<p>You don't need to use the <code>head</code> function at all. That doubles the number of comparisons. Try this:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>prefix :: [Int] -&gt; [Int] -&gt; Bool\nprefix [] _ = True\nprefix _ [] = False\nprefix (x:xs) (y:ys)\n  | x == y = prefix xs ys\n  | otherwise = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1454012532, "creation_date": 1454012532, "answer_id": 35071275, "question_id": 35069169, "link": "https://stackoverflow.com/questions/35069169/make-haskell-list-recursion-function-more-efficient/35071275#35071275", "title": "Make Haskell List Recursion function more efficient", "body": "<p>Chad Gilbert's solution can be streamlined very slightly:</p>\n\n<pre><code>prefix :: [Int] -&gt; [Int] -&gt; Bool\nprefix [] _ = True\nprefix (x:xs) (y:ys)\n  | x == y = prefix xs ys\nprefix _ _ = False\n</code></pre>\n\n<p>This won't affect the performance, but it demonstrates a language feature: when all the guards on a pattern fail, that match will be abandoned and matching will resume with the next pattern.</p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 5766031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-APTQZlmDZaQ/AAAAAAAAAAI/AAAAAAAAAG4/u-iOSDRTsOo/photo.jpg?sz=128", "display_name": "Zacharie 007", "link": "https://stackoverflow.com/users/5766031/zacharie-007"}, "is_accepted": false, "score": 0, "last_activity_date": 1454014019, "creation_date": 1454014019, "answer_id": 35071705, "question_id": 35069169, "link": "https://stackoverflow.com/questions/35069169/make-haskell-list-recursion-function-more-efficient/35071705#35071705", "title": "Make Haskell List Recursion function more efficient", "body": "<pre><code> Prelude &gt; let prefix [] _ = True\n Prelude |     prefix _ [] = False\n Prelude |     prefix (x:xs) (y:ys) = if ( x==y) then prefix xs ys else False\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>  Prelude&gt; prefix [1,3] []\n  False\n  Prelude&gt; prefix [] [1,2,3]\n  True\n  Prelude&gt; prefix [1,2] [1,2,3]\n  True\n</code></pre>\n"}], "owner": {"reputation": 308, "user_id": 5827612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YiL6R.jpg?s=128&g=1", "display_name": "GarethAS", "link": "https://stackoverflow.com/users/5827612/garethas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 35069298, "answer_count": 3, "score": 0, "last_activity_date": 1454014019, "creation_date": 1454005547, "question_id": 35069169, "link": "https://stackoverflow.com/questions/35069169/make-haskell-list-recursion-function-more-efficient", "title": "Make Haskell List Recursion function more efficient", "body": "<p>I've written a function that will compare two lists and check to see if the first is a prefix of the second and it must be done using recursion.</p>\n\n<p>For example:</p>\n\n<pre><code>prefix [1,2] [1,2,3]\n&gt;True\nprefix [2,1,4] [2,1,13,4]\n&gt;False\n</code></pre>\n\n<p>Now I've done this but I feel it's inefficient:</p>\n\n<pre><code>prefix :: [Int] -&gt; [Int] -&gt; Bool\nprefix (x:xs) (y:ys)\n|   null xs                         =   True\n|   x == y &amp;&amp; head xs == head ys    =   True &amp;&amp; prefix xs ys\n|   head xs /= head ys              =   False\n</code></pre>\n\n<p>I was hoping it could be done more efficiently and with some better pattern matching. Can it be?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1454000578, "post_id": 35067235, "comment_id": 57858278, "body": "what does nvcls mean?  you probably want to write <code>&#39;0&#39; : nvcls xs</code> etc."}, {"owner": {"reputation": 35, "user_id": 5012679, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/886e6a4f008461f4cb4a9aa0f59e6211?s=128&d=identicon&r=PG&f=1", "display_name": "noaH", "link": "https://stackoverflow.com/users/5012679/noah"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1454001558, "post_id": 35067235, "comment_id": 57858832, "body": "i want to convert this: [&quot;rnbkqbnr&quot;,&quot;pppppppp&quot;,&quot;8&quot;,&quot;8&quot;,&quot;8&quot;,&quot;8&quot;,&quot;PPPPPPPP&quot;,&quot;RNBKQBNR&quot;&zwnj;&#8203;] to this: [&quot;rnbkqbnr&quot;,&quot;pppppppp&quot;,&quot;00000000&quot;,&quot;00000000&quot;,&quot;00000000&quot;,&quot;000&zwnj;&#8203;00000&quot;,&quot;PPPPPPPP&quot;,&quot;R&zwnj;&#8203;NBKQBNR&quot;] its a representation of a chessboard"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454001848, "post_id": 35067235, "comment_id": 57859010, "body": "What is a FEN string? What are you trying and what should it do and what errors do you get?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1454001856, "post_id": 35067235, "comment_id": 57859014, "body": "Are you looking for the <code>map</code> function?  e.g. <code>map nvcls [&quot;1&quot;, &quot;2&quot;] == [&quot;0&quot;, &quot;00&quot;]</code>"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1454001900, "post_id": 35067235, "comment_id": 57859038, "body": "so map a function which does the transformation.    <code>f :: String -&gt; String  \\\\  f &quot;8&quot; = &quot;00000000&quot;  \\\\ f x = x</code>"}, {"owner": {"reputation": 35, "user_id": 5012679, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/886e6a4f008461f4cb4a9aa0f59e6211?s=128&d=identicon&r=PG&f=1", "display_name": "noaH", "link": "https://stackoverflow.com/users/5012679/noah"}, "edited": false, "score": 0, "creation_date": 1454002099, "post_id": 35067235, "comment_id": 57859143, "body": "yes im looking for the function, which is spliting the FEN-string and maping  my nvcls function on it afterwards.  in ghci it seems pretty easy: let e = splitFENString startFEN  ...... map nvcls e"}], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 1544008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c56aae0ef5e0981403733f7f248c1f?s=128&d=identicon&r=PG", "display_name": "ArthurVard", "link": "https://stackoverflow.com/users/1544008/arthurvard"}, "reply_to_user": {"reputation": 35, "user_id": 5012679, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/886e6a4f008461f4cb4a9aa0f59e6211?s=128&d=identicon&r=PG&f=1", "display_name": "noaH", "link": "https://stackoverflow.com/users/5012679/noah"}, "edited": false, "score": 2, "creation_date": 1454002606, "post_id": 35068094, "comment_id": 57859465, "body": "maybe if we change function this way make more sense <code>workONstring s = map nvcls (splitFENString s)</code>"}], "tags": [], "owner": {"reputation": 138, "user_id": 1544008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c56aae0ef5e0981403733f7f248c1f?s=128&d=identicon&r=PG", "display_name": "ArthurVard", "link": "https://stackoverflow.com/users/1544008/arthurvard"}, "is_accepted": true, "score": 4, "last_activity_date": 1454002235, "creation_date": 1454002235, "answer_id": 35068094, "question_id": 35067235, "link": "https://stackoverflow.com/questions/35067235/how-to-iterate-through-my-list-of-strings/35068094#35068094", "title": "How to iterate through my List of Strings", "body": "<p>try to change the workONstring function like this</p>\n\n<pre><code>workONstring :: String -&gt; [String]\nworkONstring = map nvcls . splitFENString\n</code></pre>\n\n<p>then you can call for startFEN</p>\n\n<pre><code>workONstring startFEN\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5012679, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/886e6a4f008461f4cb4a9aa0f59e6211?s=128&d=identicon&r=PG&f=1", "display_name": "noaH", "link": "https://stackoverflow.com/users/5012679/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 35068094, "answer_count": 1, "score": 0, "last_activity_date": 1454002235, "creation_date": 1453999681, "question_id": 35067235, "link": "https://stackoverflow.com/questions/35067235/how-to-iterate-through-my-list-of-strings", "title": "How to iterate through my List of Strings", "body": "<p>Ive got some serious problems to finish a project for university and ive got no clue how to work with haskell.</p>\n\n<p>I need to parse a FEN-String to smth i can work with. </p>\n\n<pre><code>import Data.Char\nimport Data.List.Split\n\nstartFEN = \"rnbkqbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBKQBNR\"\n\n\nsplitFENString :: String -&gt; [String]\nsplitFENString = splitOn \"/\" \n\n\nworkONstring :: [String] -&gt; [String]\nworkONstring = let e = splitFENString in\n                map (nvcls) \n\n\nnvcls :: [Char] -&gt; [Char]\nnvcls [] = []\nnvcls ('1':xs) = nvcls ('0':xs)\nnvcls ('2':xs) = nvcls ('0':'0':xs)\nnvcls ('3':xs) = nvcls ('0':'0':'0':xs)\nnvcls ('4':xs) = nvcls ('0':'0':'0':'0':xs)\nnvcls ('5':xs) = nvcls ('0':'0':'0':'0':'0':xs)\nnvcls ('6':xs) = nvcls ('0':'0':'0':'0':'0':'0':xs)\nnvcls ('7':xs) = nvcls ('0':'0':'0':'0':'0':'0':'0':xs)\nnvcls ('8':xs) = nvcls ('0':'0':'0':'0':'0':'0':'0':'0':xs)\nnvcls (x:xs) = x : nvcls xs\n</code></pre>\n\n<p>i want to use <code>nvcls</code> on every string in the list, but i have no clue, how to satisfy the compiler...</p>\n"}, {"tags": ["multithreading", "sockets", "haskell", "server", "udp"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1454000071, "post_id": 35066137, "comment_id": 57857946, "body": "&quot;I&#39;d rather not have a pool of threads each running recvFrom, but I guess I could. I&#39;m not sure how I would write to the socket from multiple threads in a sensible way though.&quot; Why not? That all should be atomic on posix, right? If so you can just <code>replicateM n (forkIO $ forever $ handleConnection socket)</code>. I don&#39;t know if there are performance implications to contention on a UDP socket. If so it might be faster to have one thread reading data and shuttling it into a blocking FIFO queue."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1454036216, "post_id": 35066137, "comment_id": 57874820, "body": "@jberryman Instead of a pool of threads, you could instead dynamically create threads, one for each connection."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1454042913, "post_id": 35066137, "comment_id": 57876517, "body": "This question does not contain enough information for a complete answer. For example, do you want to collect the information provided by all clients somewhere? Do you need to collect them by client? Did you verify that your current approach isn&#39;t fast/&quot;concurrent&quot; enough? Is UDP correct for your use case?"}, {"owner": {"reputation": 53, "user_id": 5851894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445e0929104c9681a163828eb1a838c7?s=128&d=identicon&r=PG&f=1", "display_name": "J.F.", "link": "https://stackoverflow.com/users/5851894/j-f"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1454161861, "post_id": 35066137, "comment_id": 57925969, "body": "@jberryman If that&#39;s atomic on POSIX, that&#39;s great news. I&#39;ll try it out."}, {"owner": {"reputation": 53, "user_id": 5851894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445e0929104c9681a163828eb1a838c7?s=128&d=identicon&r=PG&f=1", "display_name": "J.F.", "link": "https://stackoverflow.com/users/5851894/j-f"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1454162056, "post_id": 35066137, "comment_id": 57926043, "body": "@Zeta I&#39;ve edited the question, I hope it&#39;s clearer now. Yes, I&#39;m collecting things like IP addresses as well as the actual requests. No, I&#39;m not sure if I need to make the server faster than it currently is, but I&#39;m doing this project to learn how to work with Haskell and multithreading, among other things, so I kind of want to try out that approach. UDP is the protocol I need to support."}, {"owner": {"reputation": 53, "user_id": 5851894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445e0929104c9681a163828eb1a838c7?s=128&d=identicon&r=PG&f=1", "display_name": "J.F.", "link": "https://stackoverflow.com/users/5851894/j-f"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1454162398, "post_id": 35066137, "comment_id": 57926170, "body": "@PyRulez how? I guess I could run forkIO AFTER having read data from the socket, but that would mean using a single thread for reading requests."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1454046414, "post_id": 35076181, "comment_id": 57877597, "body": "as you are talking about <code>IO</code> none of the &quot;Haskell is immutable and deadlocks are impossible and much much better&quot; make any sense - you can just <i>f+++</i> up as horrible as in any other language here"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454048258, "post_id": 35076181, "comment_id": 57878308, "body": "@Carsten I said <i>if you don&#39;t use locks</i> then deadlock is impossible. Sure you can go horribly wrong in Haskell, but you only if you use explicit use mutable variables, and even then, you a lot better of, since you can control what is mutable."}, {"owner": {"reputation": 53, "user_id": 5851894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445e0929104c9681a163828eb1a838c7?s=128&d=identicon&r=PG&f=1", "display_name": "J.F.", "link": "https://stackoverflow.com/users/5851894/j-f"}, "edited": false, "score": 0, "creation_date": 1454162153, "post_id": 35076181, "comment_id": 57926091, "body": "Thanks for the links! I&#39;m just unsure about the semantics of simultaneously writing to a socket from multiple threads. Also, the example in the Chapter 12 you linked to uses <i>Network.accept</i>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 53, "user_id": 5851894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445e0929104c9681a163828eb1a838c7?s=128&d=identicon&r=PG&f=1", "display_name": "J.F.", "link": "https://stackoverflow.com/users/5851894/j-f"}, "edited": false, "score": 0, "creation_date": 1454165084, "post_id": 35076181, "comment_id": 57927071, "body": "@J.F. have one thread accepting connections, but then that thread will fork new ones to handle the handles."}, {"owner": {"reputation": 53, "user_id": 5851894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445e0929104c9681a163828eb1a838c7?s=128&d=identicon&r=PG&f=1", "display_name": "J.F.", "link": "https://stackoverflow.com/users/5851894/j-f"}, "edited": false, "score": 0, "creation_date": 1454166058, "post_id": 35076181, "comment_id": 57927394, "body": "@PyRulez Well, the problem is that I can&#39;t use Network.accept since it only works for TCP. UDP is connectionless. But yes, I could probably build something similar by forking after recvFrom."}], "tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 0, "last_activity_date": 1454166726, "last_edit_date": 1454166726, "creation_date": 1454036708, "answer_id": 35076181, "question_id": 35066137, "link": "https://stackoverflow.com/questions/35066137/writing-to-a-socket-from-different-threads-a-concurrent-udp-server-in-haskell/35076181#35076181", "title": "Writing to a socket from different threads (a concurrent UDP server in Haskell)", "body": "<p>You need to learn some concurrency bro!</p>\n\n<p>First thing you need to learn is <a href=\"https://hackage.haskell.org/package/base/docs/Control-Concurrent.html#v:forkIO\" rel=\"nofollow\"><code>forkIO :: IO () -&gt; IO ThreadId</code></a>. This is where all the concurrency starts. You give it an IO action, and it starts a thread to run that IO action, like magic man! Everything, including that <code>accept</code> thing you were talking about, goes back to <code>forkIO</code>! Since Haskell data is immutable, it's perfectly safe to use (if you don't use locks, no problem (and then deadlock is impossible).)</p>\n\n<p>The rest of learning concurrency in Haskell is how to use <code>forkIO</code>, and libraries based on <code>forkIO</code> (and some related primitives.) First, read <a href=\"https://hackage.haskell.org/package/base/docs/Control-Concurrent.html\" rel=\"nofollow\"><code>Control.Concurrent</code></a>. Then read <a href=\"http://chimera.labs.oreilly.com/books/1230000000929\" rel=\"nofollow\">Parallel and Concurrent Haskell</a> (free ebook). To get a feel for how the book helps your situation, go to <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch12.html\" rel=\"nofollow\">Chapter 12</a>.</p>\n\n<p>Haskell is <em>much</em> <strong>much</strong> <strong><em>much</em></strong> better at dealing with concurrency than any imperative and/or impure language, unless specifically built for concurrency (cue downvotes from non-Haskellers). Embrace it.</p>\n\n<hr>\n\n<p>Okay, for this, you would use some sort of channel. <code>MVar</code> would actually be sufficient (as long as you are writing faster than you are producing). See <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch07.html#sec_conc-logger\" rel=\"nofollow\">this</a>. If you produce faster than you write, see <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch07.html#sec_channels\" rel=\"nofollow\">this</a>.</p>\n\n<p>The <code>stm</code> package has similar constructs.</p>\n"}, {"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457064446, "creation_date": 1457064446, "answer_id": 35787817, "question_id": 35066137, "link": "https://stackoverflow.com/questions/35066137/writing-to-a-socket-from-different-threads-a-concurrent-udp-server-in-haskell/35787817#35787817", "title": "Writing to a socket from different threads (a concurrent UDP server in Haskell)", "body": "<p>Personally I'd have a single thread for reads, that just called <code>recv</code> in a loop, and tossing the requests on to a <code>Chan</code> then another for writes, spooling off a <code>Chan</code>. However, I actually do suspect, though can't confirm, that you could have multiple threads doing this directly as in your described architecture. The reason I think this may be ok is that IO gets trafficed through the IO manager, which handles multiplexing. While not containing the latest developments, I think the <a href=\"http://haskell.cs.yale.edu/wp-content/uploads/2013/08/hask035-voellmy.pdf\" rel=\"nofollow\">MIO paper</a> should cover the basics of how things are currently implemented.</p>\n"}], "owner": {"reputation": 53, "user_id": 5851894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445e0929104c9681a163828eb1a838c7?s=128&d=identicon&r=PG&f=1", "display_name": "J.F.", "link": "https://stackoverflow.com/users/5851894/j-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1216, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1457064446, "creation_date": 1453996642, "last_edit_date": 1454168135, "question_id": 35066137, "link": "https://stackoverflow.com/questions/35066137/writing-to-a-socket-from-different-threads-a-concurrent-udp-server-in-haskell", "title": "Writing to a socket from different threads (a concurrent UDP server in Haskell)", "body": "<p><strong>EDIT:</strong></p>\n\n<p>I'm writing an UDP BitTorrent tracker in Haskell. The state is based on STM (two TVar Maps) passed in my datatype ServerState into <em>runUDPServer</em>, <em>acceptConnections</em>, <em>handleConnection</em> and <em>handleRequestData</em>. The clients will either request starting a \"connection\", announce or scrape. Every time someone sends the server a message, they're supposed to get a message back. (The protocol is here: <a href=\"http://www.rasterbar.com/products/libtorrent/udp_tracker_protocol.html\" rel=\"nofollow\">http://www.rasterbar.com/products/libtorrent/udp_tracker_protocol.html</a>).</p>\n\n<p>I will do some binary parsing, some processing in the IO monad (just STM really) and send a message encoded in binary back to the sender. Initially, I was thinking that I could just run every request like this in its own thread, but I guess I could just fork a few threads and let them do the work instead. One problem with that might be that the whole server (all threads) would be blocked by n people sending UDP packages really slowly (but maybe that's not actually possible).</p>\n\n<p>I think I could define my question more clearly thus: <strong>if I just fork n threads that all run handleConnection simultaneously, will that mess with the socket somehow? Also, (how) could I ideally somehow spawn a new thread for each received packet?</strong></p>\n\n<p>I mean, when I fork a few threads and write to stdout, the output will be garbled / a mixture between what was printed from the separate threads. <em>Network.accept</em> actually provides a handle and the individual threads don't really need to know about the socket, but I can't use <em>accept</em>. <strong>I wouldn't just assume that it's safe to write to a socket from multiple threads simultaneously.</strong></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Exception (bracket)\nimport qualified Data.ByteString.Char8 as BS\nimport qualified Network.Socket as S hiding (send, sendTo, recv, recvFrom)\nimport qualified Network.Socket.ByteString as S\n\nrunUDPServer serverState port =\n    S.withSocketsDo $ bracket (createSocket port) S.close (acceptConnections serverState)\n\n    where\n        createSocket port = do\n            serverAddr &lt;- fmap head $ S.getAddrInfo\n                (Just (S.defaultHints {S.addrFlags = [S.AI_PASSIVE]}))\n                Nothing\n                (Just port)\n\n            socket &lt;- S.socket (S.addrFamily serverAddr) S.Datagram S.defaultProtocol\n            S.bind socket $ S.addrAddress serverAddr\n\n            return socket\n\n        acceptConnections serverState socket = do\n            handleConnection serverState socket\n            acceptConnections socket\n\n        handleConnection serverState socket = do\n            (requestData, remoteAddress) &lt;- S.recvFrom socket 2048\n            responseData &lt;- handleRequestData serverState requestData remoteAddress\n            S.sendTo socket responseData remoteAddress\n\n        handleRequestData :: ServerState -&gt; BS.ByteString -&gt; S.SockAddr -&gt; IO BS.ByteString\n        handleRequestData serverState requestData remoteAddress = do\n            putStrLn \"-----\"\n\n            putStrLn $ \"Received UDP message\"\n            putStrLn $ \"Address: \" ++ show remoteAddress\n\n            -- (left out code here)\n            return \"Dummy ByteString\"\n</code></pre>\n\n<p>I would be very grateful for any tips, pointers etc.</p>\n"}, {"tags": ["haskell", "binary-search-tree"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1453988662, "post_id": 35062987, "comment_id": 57848915, "body": "you mix this up to much - see in <code>FamilyTree</code> the subtrees <code>a</code> are constrainted to be <code>Male</code> for left and <code>Female</code> for right - so you cannot insert your general <code>x</code> there anymore!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1453988765, "post_id": 35062987, "comment_id": 57848993, "body": "I think I know what you are trying here but in this case you should do <code>data Person = Male ... | Female ...</code> and then construct your tree of type <code>FamilyTree Person</code> so that the left nodes (the first component of those) are only Male, ... also it&#39;s a bit strange to use the <i>sorted</i>  behavior ... as surely your mother should have a father and mother too ... so it&#39;s gonna be hard to write an <code>Ord</code> instance for said persons"}, {"owner": {"reputation": 311, "user_id": 3296768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f31f7a7524e7628dd45c356a788ac98?s=128&d=identicon&r=PG&f=1", "display_name": "darrrrUC", "link": "https://stackoverflow.com/users/3296768/darrrruc"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1453990248, "post_id": 35062987, "comment_id": 57850156, "body": "Thanks, got alot further no and am on track hopefully. Tanks!"}, {"owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "edited": false, "score": 0, "creation_date": 1454039623, "post_id": 35062987, "comment_id": 57875679, "body": "Not exactly related to your question, but it&#39;s better style to do <code>case compare x a of { LT -&gt; ... ; EQ -&gt; ... ; GT -&gt; ... }</code>, since this only requires performing one comparison, rather than three."}], "answers": [{"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 2, "last_activity_date": 1453995367, "last_edit_date": 1453995367, "creation_date": 1453994909, "answer_id": 35065520, "question_id": 35062987, "link": "https://stackoverflow.com/questions/35062987/recursively-adding-to-binary-tree/35065520#35065520", "title": "Recursively adding to binary tree", "body": "<p>When you write</p>\n\n<pre><code>treeInsert :: Ord a =&gt; a -&gt; FamilyTree a -&gt; FamilyTree a\n</code></pre>\n\n<p>the type system ensures that the type of the first argument equals the index of the second. It means that you can insert a <code>Male</code> only in a tree that starts from a <code>Male</code>. I guess, this is not what you want.</p>\n\n<p>However it's a nice question and I'll answer it. The problem in</p>\n\n<pre><code>treeInsert :: Ord a =&gt; a -&gt; FamilyTree a -&gt; FamilyTree a\n</code></pre>\n\n<p>is that <code>a</code> is far to general. What would</p>\n\n<pre><code>treeInsert :: Int -&gt; FamilyTree Int -&gt; FamilyTree Int\n</code></pre>\n\n<p>mean? You need to restrict <code>a</code> to be either <code>Female</code> or <code>Male</code>. That's a job for <code>GADTs</code>:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata Person a where\n    PFemale :: Female -&gt; Person Female\n    PMale   :: Male   -&gt; Person Male\n</code></pre>\n\n<p><code>Person</code> contains either <code>Female</code> or <code>Male</code> and carries at the type level information about which one. Having this we can define</p>\n\n<pre><code>runPerson :: Person a -&gt; a\nrunPerson (PFemale x) = x\nrunPerson (PMale   x) = x\n\ntreeInsert :: Person a -&gt; FamilyTree a -&gt; FamilyTree a\ntreeInsert p              EmptyTree          = singleton (runPerson p)\ntreeInsert p@(PFemale x) (Node a left right)\n    | x == a    = Node x left right\n    | otherwise = treeInsert p left\ntreeInsert p@(PMale   x) (Node a left right)\n    | x == a    = Node x left right\n    | otherwise = treeInsert p right\n</code></pre>\n\n<p>The trick is that when you pattern match on <code>Person a</code> <code>a</code> gets instantiated either to <code>Female</code> or <code>Male</code> and never to something else. When <code>a</code> is <code>Female</code>, you continue to insert into the \"<code>Female</code>\" subtree, otherwise \u2014 into the \"<code>Male</code>\".</p>\n"}], "owner": {"reputation": 311, "user_id": 3296768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f31f7a7524e7628dd45c356a788ac98?s=128&d=identicon&r=PG&f=1", "display_name": "darrrrUC", "link": "https://stackoverflow.com/users/3296768/darrrruc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 35065520, "answer_count": 1, "score": 3, "last_activity_date": 1454039377, "creation_date": 1453988117, "last_edit_date": 1454039377, "question_id": 35062987, "link": "https://stackoverflow.com/questions/35062987/recursively-adding-to-binary-tree", "title": "Recursively adding to binary tree", "body": "<p>I'm trying to recursively add to a binary tree in Haskell. I'm following <a href=\"http://learnyouahaskell.com\" rel=\"nofollow\"><em>Learn You A Haskell</em></a> on this, only with a few changes, but I'm getting errors, which I do not understand:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Male = Male { maleName :: String\n                 , maleDOB :: Int\n                 } deriving (Show, Read, Eq, Ord)\n\ndata Female = Female { femaleName :: String\n                     , femaleDOB :: Int\n                     } deriving (Show, Read, Eq, Ord)\n\ndata FamilyTree a = EmptyTree \n                  | Node a (FamilyTree Female) (FamilyTree Male)\n                  deriving (Show, Read, Eq, Ord)\n\nsingleton :: a -&gt; FamilyTree a\nsingleton x = Node x EmptyTree EmptyTree\n\ntreeInsert :: (Ord a) =&gt; a -&gt; FamilyTree a -&gt; FamilyTree a\ntreeInsert x EmptyTree = singleton x\ntreeInsert x (Node a left right)\n    | x == a = Node x left right\n    | x &lt; a  = Node a (treeInsert x left) right\n    | x &gt; a  = Node a left (treeInsert x right)\n</code></pre>\n\n<p>Here is the error message I'm getting:</p>\n\n<pre><code>Couldn't match type `Female' with `Male'\nExpected type: Male\n  Actual type: a\nIn the first argument of `treeInsert', namely `x'\nIn the third argument of `Node', namely `(treeInsert x right)'\nIn the expression: Node a left (treeInsert x right)\n</code></pre>\n\n<p>I'm quite new to Haskell and can't wrap my head around what is happening here. Any pointer in the right direction would be welcome!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21, "user_id": 1863063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a886739cf57c23316771d4a8437bdc82?s=128&d=identicon&r=PG", "display_name": "user1863063", "link": "https://stackoverflow.com/users/1863063/user1863063"}, "edited": false, "score": 0, "creation_date": 1453981744, "post_id": 35060673, "comment_id": 57843991, "body": "I forgotten to put the compile error, which is: parse error on input `if&#39;"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1453983221, "post_id": 35060673, "comment_id": 57845022, "body": "The error is right there under you inserted <code>if</code> - it&#39;s a <b>fat</b> ugly tab right there (note: you will see this if you edit your answer here - SO will reformat the markdown and remove the tab in this view)"}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1453982817, "post_id": 35060936, "comment_id": 57844739, "body": "Wouldn&#39;t this be more appropriate as a comment?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1453983229, "post_id": 35060936, "comment_id": 57845025, "body": "@Jubobs kind of, but it&#39;s overwhelmingly likely that tabs are indeed the culprit."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1453983248, "post_id": 35060936, "comment_id": 57845044, "body": "Indeed, there are tabs in the pasted code (we need to press &quot;edit&quot; to see them)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1453983455, "post_id": 35060936, "comment_id": 57845183, "body": "@Carsten Sometimes I wish <code>-Wall</code> were the default. Even the perl man page lists &quot;-w is not the default&quot; in the BUGS section, IIRC ;-)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1453987181, "post_id": 35060936, "comment_id": 57847856, "body": "@Carsten: GHC-7.10 <i>does</i> warn about tabs by default, so we shouldn&#39;t have this problem for too long anymore."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1453987385, "post_id": 35060936, "comment_id": 57848007, "body": "@leftaroundabout really? <b>great</b> - never noticed (well my editor helps me out of that mess) so thank you for letting me know (feeling like an ass now... have to delete some comments)"}, {"owner": {"reputation": 21, "user_id": 1863063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a886739cf57c23316771d4a8437bdc82?s=128&d=identicon&r=PG", "display_name": "user1863063", "link": "https://stackoverflow.com/users/1863063/user1863063"}, "edited": false, "score": 0, "creation_date": 1453991715, "post_id": 35060936, "comment_id": 57851322, "body": "Thank you all for your help.Indeed this was related to tabs (which I thought I double checked - clearly not good enough)"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 21, "user_id": 1863063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a886739cf57c23316771d4a8437bdc82?s=128&d=identicon&r=PG", "display_name": "user1863063", "link": "https://stackoverflow.com/users/1863063/user1863063"}, "edited": false, "score": 0, "creation_date": 1454081928, "post_id": 35060936, "comment_id": 57898455, "body": "@user1863063 If phadej solved your problem, please consider accepting his answer."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 5, "last_activity_date": 1453982475, "creation_date": 1453982475, "answer_id": 35060936, "question_id": 35060673, "link": "https://stackoverflow.com/questions/35060673/parse-error-in-nested-if-do-blocks/35060936#35060936", "title": "parse error in nested if/do blocks", "body": "<p>Your code compiles fine. Are you sure you don't have tabs and spaces interleaved there as an indentation?</p>\n\n<p>Try <code>ghci -fwarn-tabs yourfile.hs</code></p>\n"}], "owner": {"reputation": 21, "user_id": 1863063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a886739cf57c23316771d4a8437bdc82?s=128&d=identicon&r=PG", "display_name": "user1863063", "link": "https://stackoverflow.com/users/1863063/user1863063"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "closed_date": 1455263095, "answer_count": 1, "score": 0, "last_activity_date": 1453983196, "creation_date": 1453981638, "last_edit_date": 1453983196, "question_id": 35060673, "link": "https://stackoverflow.com/questions/35060673/parse-error-in-nested-if-do-blocks", "closed_reason": "Not suitable for this site", "title": "parse error in nested if/do blocks", "body": "<pre><code>defaultFileName :: [Char]\ndefaultFileName = \"Test.log\"\n\ndefaultSearchName :: String\ndefaultSearchName = \"xyz\"\n</code></pre>\n\n<p>This code can be compiled:</p>\n\n<pre><code>a3 :: Int -&gt; [[Char]] -&gt; IO [Char]\na3 index arg = \n  if null arg\n    then do\n      a &lt;- putStrLn \"No parameters have been passed.\"\n      a &lt;- putStrLn $ \"1 Default search string: \" ++ defaultSearchName\n      a &lt;- putStrLn (\"2 Default file name: \" ++ defaultFileName)\n      return defaultFileName\n    else return (arg!!index)\n</code></pre>\n\n<p>once I add an extra IF-THEN-ELSE, I cannot compile it anymore</p>\n\n<pre><code>a3 :: Int -&gt; [[Char]] -&gt; IO [Char]\na3 index arg = \n  if null arg\n    then do\n      a &lt;- putStrLn \"No parameters have been passed.\"\n      a &lt;- putStrLn $ \"1 Default search string: \" ++ defaultSearchName\n      a &lt;- putStrLn (\"2 Default file name: \" ++ defaultFileName)\n      if index == 0\n        then  return defaultSearchName\n        else return defaultFileName\n    else return (arg!!index)\n</code></pre>\n\n<p>why???? It is so frustrating with every single step.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1453991612, "post_id": 35059031, "comment_id": 57851240, "body": "You should be able to call <code>makeSessionBackend</code> on your <code>App</code> value in order to get back a <code>Maybe SessionBackend</code> type, which you can call <code>sbLoadSession</code> on with a <code>Request</code> and a <code>UTCTime</code> to get a dictionary of unencrypted key-value pairs stored in the request. <a href=\"https://hackage.haskell.org/package/yesod-core-1.1.1/docs/Yesod-Core.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/yesod-core-1.1.1/docs/&hellip;</a> (not a Yesod user so this is all conjecture from looking at their source code)"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1453977365, "creation_date": 1453977365, "question_id": 35059031, "link": "https://stackoverflow.com/questions/35059031/how-to-get-set-session-data-in-yesod-handler-tests", "title": "How to get/set session data in Yesod handler tests?", "body": "<p>Is it possible to get session data from within a Yesod Handler test?\nFor example I'd like to get the current userId.</p>\n\n<p>Later on, I'd also like to test two simultaneous browser sessions interacting with the Yesod app in turns.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/yesod-test-1.5.0.1/docs/Yesod-Test.html#v:getRequestCookies\" rel=\"nofollow\"><code>getRequestCookies</code></a> does return the session, but in an encrypted state.</p>\n"}, {"tags": ["class", "haskell", "deriving"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1453974659, "post_id": 35057944, "comment_id": 57839202, "body": "There is no way to &quot;derive&quot; a <code>Num</code> instance. The closest thing you can do is to use Template Haskell. (Or just write a normal Haskell program to auto-generate the code you want.)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1453974734, "post_id": 35057944, "comment_id": 57839260, "body": "<i>counter-productive</i> as in <i>to much work</i> ? ... but no - look there are even other perfectly fine things you could do (handle <code>C _</code> and <code>Placeholder</code> as <code>N 0</code> for example) - so how should the compiler decide for you? - Just define something like a <code>map2</code> to abstract your operations on two numbers to help you out)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1453992368, "post_id": 35057944, "comment_id": 57851907, "body": "Have you considered using a standard applicative functor instead of that custom type?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1454007861, "post_id": 35057944, "comment_id": 57862753, "body": "@leftaroundabout, what are you getting at?"}], "answers": [{"tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": false, "score": 2, "last_activity_date": 1454003560, "creation_date": 1454003560, "answer_id": 35068529, "question_id": 35057944, "link": "https://stackoverflow.com/questions/35057944/is-there-a-way-to-derive-num-class-functions-in-own-data-type-in-haskell/35068529#35068529", "title": "Is there a way to derive Num class functions in own data type in Haskell?", "body": "<p>There is no generic <code>deriving</code> available in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch11.html\" rel=\"nofollow\">standard Haskell</a>:  currently, <code>deriving</code> is only available as defined by the compiler for specific Prelude typeclasses: <code>Read</code>, <code>Show</code>, <code>Eq</code>, <code>Ord</code>, <code>Enum</code>, and <code>Bounded</code>.</p>\n\n<p>The Glasgow Haskell Compiler (GHC) apparently has <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Compiler/GenericDeriving\" rel=\"nofollow\">extensions</a> that support generic <code>deriving</code>.  However, I don't know if it would actually save you any work to try and use them:  how many typeclasses do you need to derive a <code>Num</code> instance from?  And, are you sure that you can define an automatic scheme for deriving <code>Num</code> that will always do what you want?</p>\n\n<p>As noted in the comments, you need to describe what your <code>Num</code> instance will do in any case.  And describing and debugging a general scheme is certain to be more work than describing a particular one.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1454009869, "post_id": 35070253, "comment_id": 57863933, "body": "What I meant with \u201cstandard applicative functor\u201d was something like <code>MaybeT (Either Char) Double</code>. But defining a functor yourself is of course also possible, though... have you checked that this actually fulfills the monad laws?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1454015696, "last_edit_date": 1454015696, "creation_date": 1454009140, "answer_id": 35070253, "question_id": 35057944, "link": "https://stackoverflow.com/questions/35057944/is-there-a-way-to-derive-num-class-functions-in-own-data-type-in-haskell/35070253#35070253", "title": "Is there a way to derive Num class functions in own data type in Haskell?", "body": "<p>No, you can't do this automatically, but I think what leftaroundabout could have been getting at is that you can use <code>Applicative</code> operations to help you.</p>\n\n<pre><code>data MyType n = N n | C Char | Placeholder deriving (Show, Eq, Functor)\n\ninstance Applicative MyType where\n  pure = N\n  (&lt;*&gt;) = ap\n\ninstance Monad MyType where\n  N n &gt;&gt;= f = f n\n  C c &gt;&gt;= _ = C c\n  Placeholder &gt;&gt;= _ = Placeholder\n</code></pre>\n\n<p>Now you can write</p>\n\n<pre><code>instance Num n =&gt; Num (MyType n) where\n  x + y = (+) &lt;$&gt; x &lt;*&gt; y\n  abs = fmap abs\n  ...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4986842, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LHAUFThMvm4/AAAAAAAAAAI/AAAAAAAAADg/HpLKUAxA3as/photo.jpg?sz=128", "display_name": "Cheessie Stew", "link": "https://stackoverflow.com/users/4986842/cheessie-stew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1454015696, "creation_date": 1453974444, "question_id": 35057944, "link": "https://stackoverflow.com/questions/35057944/is-there-a-way-to-derive-num-class-functions-in-own-data-type-in-haskell", "title": "Is there a way to derive Num class functions in own data type in Haskell?", "body": "<p>Let's say I have a type declaration:  </p>\n\n<pre><code> data MyType = N Double | C Char | Placeholder\n</code></pre>\n\n<p>I want to be able to treat MyType as a Double whenever it's possible, with all the Num, Real, Fractional functions resulting in N (normal result) for arguments wrapped in the N constructor, and Placeholder for other arguments</p>\n\n<pre><code>&gt; (N 5.0) + (N 6.0)\nN 11.0\n&gt; (N 5.0) + (C 'a')\nPlaceholder\n</code></pre>\n\n<p>Is there a way to do this other than simply defining this class as an instance of those classes in a manner similar to:  </p>\n\n<pre><code>instance Num MyType where\n  (+) (N d1) (N d2) = N (d1+d2)\n  (+) _ _ = Placeholder\n  ...\n</code></pre>\n\n<p>(which seems counter-productive)?</p>\n"}, {"tags": ["haskell", "pattern-matching", "instance", "typeclass", "type-variables"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1453986093, "last_edit_date": 1453986093, "creation_date": 1453985791, "answer_id": 35062135, "question_id": 35057936, "link": "https://stackoverflow.com/questions/35057936/pattern-matching-in-instances-of-tofu-lyah-example/35062135#35062135", "title": "Pattern matching in instances of Tofu [LYAH example]", "body": "<p>TL;DR: You can not.</p>\n\n<p>Assume <code>t</code> satisfies <code>Tofu t</code>. The function type states</p>\n\n<pre><code>tofu :: j a -&gt; t a j\n</code></pre>\n\n<p>which actually means </p>\n\n<pre><code>tofu :: forall j a. j a -&gt; t a j   -- t is chosen by the class instance\n</code></pre>\n\n<p>So, it's the caller who gets to choose what <code>j</code> and <code>a</code> are. The caller can pass a <code>[Int]</code> or a <code>Maybe Char</code> or a <code>Either String Bool</code> (here <code>j ~ Either String</code> and <code>a ~ Bool</code>). Function <code>tofu</code> can not assume any specific case, and must do its job only using \"general\" operations.</p>\n\n<blockquote>\n  <p>how to work with value of type a in instance declaration of tofu</p>\n</blockquote>\n\n<p>There might be no <code>a</code> value. E.g.</p>\n\n<pre><code>data T a = K Int\n</code></pre>\n\n<p>Since we can instantiate tofu as</p>\n\n<pre><code>tofu :: T a -&gt; t a T\n</code></pre>\n\n<p>we can call that as in <code>tofu (K 6 :: T Bool)</code> even if there's no <code>Bool</code> around.</p>\n\n<p>A similar argument holds for</p>\n\n<pre><code>data U a = U (a -&gt; Int)\n</code></pre>\n\n<p>Here a <code>U Bool</code> contains a function expecting a <code>Bool</code>, instead of providing or \"containing\" it, loosely speaking.</p>\n"}], "owner": {"reputation": 568, "user_id": 265374, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70e5083d48892b749889c4bcbf8a5766?s=128&d=identicon&r=PG", "display_name": "reddot", "link": "https://stackoverflow.com/users/265374/reddot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 35062135, "answer_count": 1, "score": 1, "last_activity_date": 1453986093, "creation_date": 1453974425, "question_id": 35057936, "link": "https://stackoverflow.com/questions/35057936/pattern-matching-in-instances-of-tofu-lyah-example", "title": "Pattern matching in instances of Tofu [LYAH example]", "body": "<p>I'm playing with weird Tofu example from LYAH. I've a little bit simplified it by eliminating record fields from Frank constructor, so here is it:</p>\n\n<pre><code>class Tofu t where\n    tofu :: j a -&gt; t a j\n\ndata Frank a m = Frank (m a) deriving (Show)\n\ninstance Tofu Frank where\n    tofu x = Frank x\n</code></pre>\n\n<p>It's working and rather clear. But now I want to make value of type <code>a</code> to be modified by <code>tofu</code> function. So I've started with expansion of value of <code>x</code> in instance declaration:</p>\n\n<pre><code>instance Tofu Frank where\n    tofu (m y) = Frank (m y)\n</code></pre>\n\n<p>as a result I'm getting:</p>\n\n<pre><code>tofu.hs:13:15: Parse error in pattern: m\n</code></pre>\n\n<p>Ok, next I've tried to do actual pattern matching inside instance declaration:</p>\n\n<pre><code>instance Tofu Frank where\n    tofu (Just y) = Frank (Just y)\n</code></pre>\n\n<p>as a result I'm getting:</p>\n\n<pre><code>tofu.hs:16:15:\n    Couldn't match type `j' with `Maybe'\n      `j' is a rigid type variable bound by\n          the type signature for tofu :: j a -&gt; Frank a j at tofu.hs:16:9\n    Expected type: j a\n      Actual type: Maybe a\n    In the pattern: Just y\n    In an equation for `tofu': tofu (Just y) = Frank (Just y)\n    In the instance declaration for `Tofu Frank'\n</code></pre>\n\n<p>So, question is: how to work with value of type <code>a</code> in instance declaration of tofu? Is it possible to make failed examples working without modification of Tofu class?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 2, "creation_date": 1453949703, "post_id": 35052000, "comment_id": 57828231, "body": "<a href=\"http://stackoverflow.com/questions/3864647/how-does-deriving-work-in-haskell\" title=\"how does deriving work in haskell\">stackoverflow.com/questions/3864647/&hellip;</a>"}, {"owner": {"reputation": 1821, "user_id": 2391244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyC7o.jpg?s=128&g=1", "display_name": "BalinKingOfMoria Reinstate CMs", "link": "https://stackoverflow.com/users/2391244/balinkingofmoria-reinstate-cms"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1454016526, "post_id": 35052000, "comment_id": 57867765, "body": "@Ben That should be an answer."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 1821, "user_id": 2391244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyC7o.jpg?s=128&g=1", "display_name": "BalinKingOfMoria Reinstate CMs", "link": "https://stackoverflow.com/users/2391244/balinkingofmoria-reinstate-cms"}, "edited": false, "score": 0, "creation_date": 1454023965, "post_id": 35052000, "comment_id": 57871358, "body": "@BalinKingOfMoria I&#39;ve promoted it to one"}, {"owner": {"reputation": 1821, "user_id": 2391244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyC7o.jpg?s=128&g=1", "display_name": "BalinKingOfMoria Reinstate CMs", "link": "https://stackoverflow.com/users/2391244/balinkingofmoria-reinstate-cms"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1454024407, "post_id": 35052000, "comment_id": 57871514, "body": "@Ben Perfect. Have an upvote for the great answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1454024209, "post_id": 35073828, "comment_id": 57871438, "body": "There&#39;s one exception: <code>Typeable</code>. Its instances may <i>only</i> be derived."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 6, "last_activity_date": 1454022182, "creation_date": 1454022182, "answer_id": 35073828, "question_id": 35052000, "link": "https://stackoverflow.com/questions/35052000/difference-between-deriving-typeclass-and-creating-an-instance/35073828#35073828", "title": "Difference between deriving typeclass and creating an instance", "body": "<p>You aren't missing anything; <code>deriving</code> is just having the compiler write out the \"obvious\" instance for you. It doesn't do anything you couldn't do if you wrote out the instance yourself.</p>\n\n<p>The benefits are (1) you don't have to write out the instance and (2) it communicates to anyone reading the source that the instance <strong>is</strong> the obvious one (rather than having to read the instance definition to determine whether it's non-standard or not).</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 2, "accepted_answer_id": 35073828, "answer_count": 1, "score": 4, "last_activity_date": 1454022182, "creation_date": 1453949408, "last_edit_date": 1495541321, "question_id": 35052000, "link": "https://stackoverflow.com/questions/35052000/difference-between-deriving-typeclass-and-creating-an-instance", "title": "Difference between deriving typeclass and creating an instance", "body": "<p>Suppose I have this data type:</p>\n\n<pre><code>data TrafficLight = Red | Yellow | Green deriving (Eq)\n</code></pre>\n\n<p>How is it different from creating an instance of <code>Eq</code> like so:</p>\n\n<pre><code>data TrafficLight = Red | Yellow | Green\n\ninstance Eq TrafficLight where\n    Red == Red = True  \n    Green == Green = True  \n    Yellow == Yellow = True  \n    _ == _ = False \n</code></pre>\n\n<p>What am I missing here?</p>\n\n<p><strong>NOTE</strong></p>\n\n<p>This question is different from the <a href=\"https://stackoverflow.com/questions/3864647\">assumed duplicate</a> because I am looking for the contrast between the <code>deriving</code> and <code>instance</code> keyword. The assumed dupe does not mention the <code>instance</code> keyword.</p>\n"}, {"tags": ["haskell", "monads", "control-flow", "either"], "answers": [{"comments": [{"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1453948845, "post_id": 35051685, "comment_id": 57827988, "body": "Good point. Foor <code>Bool</code> something like `unless boolCheck $ Left &quot;check failed&quot; is alrady better."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1453947088, "last_edit_date": 1495540346, "creation_date": 1453947088, "answer_id": 35051685, "question_id": 35050956, "link": "https://stackoverflow.com/questions/35050956/how-to-do-control-flow-in-haskell/35051685#35051685", "title": "How to do control flow in Haskell", "body": "<p>\"Define helper functions\" is exactly how I would handle this. The <a href=\"http://hackage.haskell.org/package/errors-2.1.1/docs/Control-Error-Util.html\" rel=\"nofollow noreferrer\">errors</a> library provides many already, with the possible exception of satisfying <code>Bool</code> functions. For those I would <a href=\"https://stackoverflow.com/a/35026798/791604\">just use <code>when</code>/<code>unless</code></a>.</p>\n\n<p>And of course, to the extent possible, you should promote the actions you're calling to be suitably polymorphic so that no conversion is needed.</p>\n"}, {"comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1453953828, "post_id": 35051736, "comment_id": 57829433, "body": "we did it \ud83d\udd90\ud83c\udffd/ take that, other languages"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 5, "last_activity_date": 1454177343, "last_edit_date": 1454177343, "creation_date": 1453947430, "answer_id": 35051736, "question_id": 35050956, "link": "https://stackoverflow.com/questions/35050956/how-to-do-control-flow-in-haskell/35051736#35051736", "title": "How to do control flow in Haskell", "body": "<p>Use <code>maybe</code>, <code>either</code>, and the <code>mtl</code> package. By the by, <code>eitherCheck :: Show a =&gt; Either a b</code>'s <code>Show a</code> constraint is probably not what you want: it lets callers choose whatever type they want as long as the type implements <code>Show a</code>. You were probably intending having <code>a</code> be a type such that callers would <em>only</em> be able to call <code>show</code> on the value. Probably!</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n\nnewtype Error = Error String\n\ngauntlet :: MonadError Error m =&gt; m ()\ngauntlet = do\n  unless boolCheck (throw \"simple bool check failed\")\n  _ &lt;- maybe (throw \"simple maybe check failed\") pure maybeCheck\n  _ &lt;- either throw pure eitherCheck\n  x &lt;- monadicBoolCheck\n  unless x (throw \"monadic bool check failed\")\n  return ()\n  where\n    throw = throwError . Error\n\nversion2 :: IO ()\nversion2 =\n  putStrLn (case gauntlet of\n              Left (Error e) -&gt;\n                \"Error: \" ++ e\n              Right _ -&gt;\n                \"successfully doing thing\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1454006527, "post_id": 35052120, "comment_id": 57861841, "body": "I like about that, that every check turns into a one-liner and actual control flow is maximum concise. However, when I showed code (that was somewhat like that) to others, I realized that it difficult to explain what it does and those helper functions tend to be very technical and idiosyncratic.  If, again, there was a consensus that those helper functions are the way to go, I would go for it. One might even put them into a type-classs <code>ToEither</code> and define an operator to allow code <code>anyWeirdTypedCheck ||! &quot;This check failed&quot;</code>"}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1454006930, "post_id": 35052120, "comment_id": 57862099, "body": "the different ways <code>Bool</code>, <code>Either</code>, <code>Maybe</code> and combined types like <code>(Bool, a)</code> are turned into Eithers might ruin the idea of having a type-class"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 1, "last_activity_date": 1453950239, "creation_date": 1453950239, "answer_id": 35052120, "question_id": 35050956, "link": "https://stackoverflow.com/questions/35050956/how-to-do-control-flow-in-haskell/35052120#35052120", "title": "How to do control flow in Haskell", "body": "<p>So I'd probably start by reworking your <code>version2</code> into something like</p>\n\n<pre><code>import Control.Monad.Trans\nimport Control.Monad.Trans.Either hiding (left, right)\nimport Control.Monad\nimport Control.Applicative\nimport Control.Arrow\n\nversion3 :: IO ()\nversion3 = eitherT onFailure onSuccess $ do\n    guard boolCheck &lt;|&gt; fail \"simple bool check failed\"\n    v &lt;- hoistEither $ maybe (Left \"simple maybe check failed\") Right maybeCheck\n    w &lt;- hoistEither . left show $ eitherCheck\n    lift (guard =&lt;&lt; monadicBoolCheck v) &lt;|&gt; fail \"monadic boolcheck failed\"\n  where\n    onFailure msg = putStrLn $ \"Error: \"++msg\n    onSuccess _   = print \"successfully doing the thing\"\n</code></pre>\n\n<p>Which I find more readable, but is still a bit awkward, so if I was doing a lot\nof code like this, I'd introduce some helpers:</p>\n\n<pre><code>version4 :: IO ()\nversion4 = eitherT onFailure onSuccess $ do\n    failUnless \"simple bool check failed\" boolCheck\n    v &lt;- hoistMaybe \"simple maybe check failed\" maybeCheck\n    w &lt;- hoistEitherWith show eitherCheck\n    failUnless \"monadic boolcheck failed\" =&lt;&lt; lift (monadicBoolCheck v)\n  where\n    onFailure msg = putStrLn $ \"Error: \"++msg\n    onSuccess _   = print \"successfully doing the thing\"\n\nfailUnless :: Monad m =&gt; String -&gt; Bool -&gt; m ()\nfailUnless _ True = return ()\nfailUnless msg _ = fail msg\n\nhoistMaybe :: Monad m =&gt; e -&gt; Maybe a -&gt; EitherT e m a\nhoistMaybe err = hoistEither . maybe (Left err) Right\n\nhoistEitherWith :: Monad m =&gt; (e -&gt; e') -&gt; Either e a -&gt; EitherT e' m a\nhoistEitherWith f = hoistEither . left f\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "is_accepted": false, "score": 0, "last_activity_date": 1454097362, "creation_date": 1454097362, "answer_id": 35092946, "question_id": 35050956, "link": "https://stackoverflow.com/questions/35050956/how-to-do-control-flow-in-haskell/35092946#35092946", "title": "How to do control flow in Haskell", "body": "<p>In order to have the full range of possible options here, check out this gist:</p>\n\n<p><a href=\"https://gist.github.com/rubenmoor/c390901247e4e7bb97cf\" rel=\"nofollow\">https://gist.github.com/rubenmoor/c390901247e4e7bb97cf</a></p>\n\n<p>It defines several helper functions, basically combining <code>maybe</code>, <code>either</code> and such with <code>throwError</code>. and results in code like this.</p>\n\n<pre><code>gauntlet :: MonadError Error m =&gt; m (a, b, c)\ngauntlet = do\n    assertTrue boolCheck $ Error \"simple bool check failed\"\n    v &lt;- assertJust maybeCheck $ Error \"simple maybe check failed\"\n    assertNothing maybeCheck' $ Error . show\n    w &lt;- assertRight eitherCheck $ Error . show\n    b &lt;- monadicBoolCheck\n    assertTrue b $ Error \"monadic bool check failed\"\n    x &lt;- assertSingletonList list $ Error \"list not singleton\"\n    pure (v, w, x)\n\nversion3 :: IO ()\nversion3 = putStrLn $\n  case gauntlet of\n    Left  (Error e) -&gt; \"Error: \" ++ e\n    Right result    -&gt; \"successfully doing thing with result\"\n</code></pre>\n"}], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 2, "accepted_answer_id": 35051736, "answer_count": 4, "score": 3, "last_activity_date": 1454177343, "creation_date": 1453941863, "last_edit_date": 1453942436, "question_id": 35050956, "link": "https://stackoverflow.com/questions/35050956/how-to-do-control-flow-in-haskell", "title": "How to do control flow in Haskell", "body": "<p>I'll give an example of what I want to do right away.</p>\n\n<pre><code>version1 :: IO ()\nversion1 =\n  if boolCheck\n     then case maybeCheck of\n            Nothing -&gt; putStrLn \"Error: simple maybe failed\"\n            Just v  -&gt; case eitherCheck of\n                         Left  e -&gt; putStrLn $ \"Error: \" ++ show e\n                         Right w -&gt; monadicBoolCheck v &gt;&gt;= \\case\n                                      False -&gt; putStrLn \"Error: monadic bool check failed\"\n                                      True  -&gt; print \"successfully doing the thing\"\n    else putStrLn \"simple bool check failed\"\n</code></pre>\n\n<p>Basically I want to \"do a thing\" under the condition that a number of checks turns out positive.\nWhenever a single check turns out negative, I want to preserve the information about the offending check and abort the mission.\nIn real life those checks have different types, therefore I called them</p>\n\n<pre><code>boolCheck        :: Bool\nmaybeCheck       :: Maybe a\neitherCheck      :: Show a =&gt; Either a b\nmonadicBoolCheck :: Monad m =&gt; m Bool\n</code></pre>\n\n<p>Those are just examples.\nFeel free to also think of monadic Maybe, <code>EitherT</code> or a a singleton list where I extract <code>head</code> and fail when it is not a singleton.</p>\n\n<p>Now I am trying to improve the above implementation and the <code>Either</code> monad came into my mind, because it has the notion of aborting with an error message.</p>\n\n<pre><code>version2 :: IO ()\nversion2 = do\n  result &lt;- runEitherT $ do\n    if boolCheck\n       then pure ()\n       else left \"simple bool check failed\"\n    v &lt;- case maybeCheck of\n           Just x  -&gt; pure x\n           Nothing -&gt; left \"simple maybe check failed\"\n    w &lt;- hoistEither . mapLeft show $ eitherCheck\n    monadicBoolCheck v &gt;&gt;= \\case\n      True  -&gt; pure ()\n      False -&gt; left  \"monadic bool check failed\"\n  case result of\n    Left  msg -&gt; putStrLn $ \"Error: \" ++ msg\n    Right _   -&gt; print \"successfully doing the thing\"\n</code></pre>\n\n<p>While I prefer <code>version2</code>, the improvement in readability is probably marginal.\nVersion2 is superior when it comes to adding further checks.</p>\n\n<p><strong>Is there an ultimately elegant way of doing this?</strong></p>\n\n<p>What I don't like:</p>\n\n<p>1) I am partly abusing the <code>Either</code> monad and what I actually do is more like a <code>Maybe</code> monad with the rolls of <code>Just</code> and <code>Nothing</code> switched in the monadic bind</p>\n\n<p>2) The conversion of the checks to <code>Either</code> requires either rather verbose use of <code>case</code> or a conversion function (like <code>hoistEither</code>).</p>\n\n<p>Ways of improving readability might be:</p>\n\n<p>1) define helper functions to allow code like</p>\n\n<pre><code>v &lt;- myMaybePairToEither \"This check failed\" monadicMaybePairCheck\n\nmonadicMaybePairCheck :: Monad m =&gt; m (Maybe x, y)\n...\nmyMaybePairToEither :: String -&gt; m (Maybe x, y) -&gt; EitherT m e z\nmyMaybePairToEither _   (Just x, y)  = pure $ f x y\nmyMaybePairToEither msg (Nothing, _) = left msg\n</code></pre>\n\n<p>2) consistently use explicit cases, not even use <code>hoistEither</code></p>\n\n<p>3) defining my own monad to stop the <code>Either</code> abuse ... I could provide all the conversion functions along with it (if no-one has already done something like that)</p>\n\n<p>4) use <code>maybe</code> and <code>either</code> where possible</p>\n\n<p>5) ... ?</p>\n"}, {"tags": ["c", "arrays", "haskell", "struct", "ffi"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1453947529, "post_id": 35050825, "comment_id": 57827621, "body": "Err... a value of type <code>Ptr (CFloat, CFloat, CFloat)</code> is by no means guaranteed to point to a memory location that can meaningfully be treated as a C struct with three <code>float</code>s in. I hope you&#39;re not relying on that in your game plan... (AFAIK there is <i>no</i> provision in the FFI spec for dealing with C structs at all.)"}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 5606288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414fa94ff74b0626b93d8ad2515dfd39?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Schatz", "link": "https://stackoverflow.com/users/5606288/charles-schatz"}, "edited": false, "score": 0, "creation_date": 1454018722, "post_id": 35054576, "comment_id": 57869028, "body": "Thanks for the positive advice and code J.J.Hakala. I shall study this with great care to see how to fit this to one of the stated problems. Cheers, Chas."}], "tags": [], "owner": {"reputation": 5662, "user_id": 5781248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712de4f2f811d1a400d3311c9cdd5836?s=128&d=identicon&r=PG&f=1", "display_name": "J.J. Hakala", "link": "https://stackoverflow.com/users/5781248/j-j-hakala"}, "is_accepted": false, "score": 5, "last_activity_date": 1453965620, "last_edit_date": 1453965620, "creation_date": 1453963793, "answer_id": 35054576, "question_id": 35050825, "link": "https://stackoverflow.com/questions/35050825/haskell-ffi-passing-array-of-c-structs-in-and-out/35054576#35054576", "title": "haskell FFI passing array of C structs in and out", "body": "<p><em>Foreign.Marshal.Array</em> seems to provide a way to convert haskell data to C data and other way around. </p>\n\n<p>I tested interfacing C code and haskell using the following files (Haskell + FFI for the first time for me)</p>\n\n<pre><code>hsc2hs rgb_ffi.hsc\nghc main.hs rgb_ffi.hs rgb.c\n</code></pre>\n\n<p><em>rgb.h</em></p>\n\n<pre><code>#ifndef RGB_H\n#define RGB_H\n\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    float r;\n    float g;\n    float b;\n} rgb_t;\n\nvoid rgb_test(rgb_t * rgbs, ssize_t n);\n\n#endif\n</code></pre>\n\n<p><em>rgb.h</em></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include \"rgb.h\"\n\nvoid rgb_test(rgb_t * rgbs, ssize_t n)\n{\n    int i;\n\n    for(i=0; i&lt;n; i++) {\n        printf(\"%.3f %.3f %.3f\\n\", rgbs[i].r, rgbs[i].g, rgbs[i].b);\n        rgbs[i].r *= 2.0;\n        rgbs[i].g *= 2.0;\n        rgbs[i].b *= 2.0;\n    }\n}\n</code></pre>\n\n<p><em>rgb_ffi.hsc</em></p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n{-# LANGUAGE CPP                      #-}\n\nmodule RGB where\n\nimport Foreign\nimport Foreign.C\nimport Control.Monad (ap)\n\n#include \"rgb.h\"\n\ndata RGB = RGB {\n      r :: CFloat, g :: CFloat, b :: CFloat\n} deriving Show\n\ninstance Storable RGB where\n    sizeOf    _ = #{size rgb_t}\n    alignment _ = alignment (undefined :: CInt)\n\n    poke p rgb_t = do\n      #{poke rgb_t, r} p $ r rgb_t\n      #{poke rgb_t, g} p $ g rgb_t\n      #{poke rgb_t, b} p $ b rgb_t\n\n    peek p = return RGB\n             `ap` (#{peek rgb_t, r} p)\n             `ap` (#{peek rgb_t, g} p)\n             `ap` (#{peek rgb_t, b} p)\n\nforeign import ccall \"rgb.h rgb_test\" crgbTest :: Ptr RGB -&gt; CSize -&gt; IO ();\n\nrgbTest :: [RGB] -&gt; IO [RGB]\nrgbTest rgbs = withArray rgbs $ \\ptr -&gt;\n               do\n                 crgbTest ptr (fromIntegral (length rgbs))\n                 peekArray (length rgbs) ptr\n\nrgbAlloc :: [RGB] -&gt; IO (Ptr RGB)\nrgbAlloc rgbs = newArray rgbs\n\nrgbPeek :: Ptr RGB -&gt; Int -&gt; IO [RGB]\nrgbPeek rgbs l = peekArray l rgbs\n\nrgbTest2 :: Ptr RGB -&gt; Int -&gt; IO ()\nrgbTest2 ptr l =\n    do\n      crgbTest ptr (fromIntegral l)\n      return ()\n</code></pre>\n\n<p><em>main.hs</em></p>\n\n<pre><code>module Main (main) where\n\nimport RGB\n\nmain =\n do\n    let a = [RGB {r = 1.0, g = 1.0, b = 1.0},\n             RGB {r = 2.0, g = 2.0, b = 2.0},\n             RGB {r = 3.0, g = 3.0, b = 3.0}]\n    let l = length a\n    print a\n    -- b &lt;- rgbTest a\n    -- print b\n\n    c &lt;- rgbAlloc a\n    rgbTest2 c l\n    rgbTest2 c l\n    d &lt;- rgbPeek c l\n    print d\n    return ()\n</code></pre>\n"}], "owner": {"reputation": 66, "user_id": 5606288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414fa94ff74b0626b93d8ad2515dfd39?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Schatz", "link": "https://stackoverflow.com/users/5606288/charles-schatz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1453965620, "creation_date": 1453940934, "question_id": 35050825, "link": "https://stackoverflow.com/questions/35050825/haskell-ffi-passing-array-of-c-structs-in-and-out", "title": "haskell FFI passing array of C structs in and out", "body": "<p>I am trying to perform a series of transforms on graphical files using Haskell and Repa/DevIL. The starting example used was provided by the Haskell wiki page <a href=\"https://wiki.haskell.org/Numeric_Haskell:_A_Repa_Tutorial\" rel=\"nofollow\">https://wiki.haskell.org/Numeric_Haskell:_A_Repa_Tutorial</a>.  I am an imperative programmer of 30 years experience with some erlang for good measure, trying to learn Haskell outside a classroom environment.</p>\n\n<p>The problem is manipulating the data after the file load was first transformed into a Repa array:</p>\n\n<pre><code>import Data.Array.Repa.IO.DevIL (runIL,readImage,writeImage,Image(RGB),IL)\nimport qualified Data.Array.Repa as R\nimport Data.Vector.Unboxed as DVU\nimport Control.Monad\n\nmain :: IO ()\nmain = do\n  [f] &lt;- getArgs\n  (RGB a) &lt;- runIL $ Data.Array.Repa.IO.DevIL.readImage f\n  let\n    c = (computeP (R.traverse a id rgbTransform)) :: IL (Array U DIM3 Float)\n</code></pre>\n\n<p>which is successfully cast to type \"Array F DIM3 Float\" as output from the rgbTransform. From that point on it has been a nightmare to use the data. Flicking the array storage type between F(oreign) and U(nboxed) changes all following call's usability, plus the Repa-added monad layer IL forces use of liftM for nearly every equation following the 1st transform:</p>\n\n<pre><code>  let -- continued\n     sh = liftM R.extent c -- IL DIM3\n     v = liftM R.toUnboxed c -- IL (Vector Float)\n     lv = liftM DVU.length v -- IL Int\n     f = liftM indexed v -- vector of tuples: (Int,a) where Int is idx\n     k = (Z :. 2) :. 2 :. 0 :: DIM3\n</code></pre>\n\n<p>These are the routines I can call without error. The IO monad's print command produces no output if placed in or after this 'let' list, due to the IL monad layer.</p>\n\n<p>The game plan for the curious:</p>\n\n<ol>\n<li>read the graphic file (done, via Repa)</li>\n<li>resize image (not done, no resize in Repa, must be hand-coded)</li>\n<li>transform and convert image from Word8 to Float (done)</li>\n<li>get a Stablepointer to the transformed Float data (not done)</li>\n<li>transform in-place the Float data as an array of C structs\nof {Float a,b,c;}, by an external C routine via FFI (not completely\ndone). This is done hopefully without marshalling a new graphic\narray by passing a pointer to the data</li>\n<li>perform more passes over the transformed data to extract more info (partly done).</li>\n</ol>\n\n<p><strong>I am looking for help with issues 4 and 5.</strong></p>\n\n<p>4 -> The type system has been difficult to deal with while attempting to get C-usable memory pointers. Going thru the mountains of haskell library calls has not helped.</p>\n\n<p>5 -> The external C routine is of type:</p>\n\n<pre><code>foreign import ccall unsafe \"transform.h xform\"\nc_xform :: Ptr (CFloat,CFloat,CFloat) -&gt;\n           CInt -&gt;\n           IO ()\n</code></pre>\n\n<p>The Ptr is expected to point to an unboxed flat C array of rgb_t structs:</p>\n\n<pre><code>typedef struct\n{\n    float r;\n    float g;\n    float b;\n} rgb_t;\n</code></pre>\n\n<p>Available web-based FFI descriptions of how to deal with array pointers in FFI are non-existent if not downright obscure. The fairly straightforward idea of unfreezing and passing in a C array of floating-point RGB structs, modifying them in-place and then freezing the result is what I had in mind. The external transform is pure in the sense that the same input will produce predictable output, does not use threads, does not use global vars nor depend upon obscure libraries.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1453940517, "post_id": 35050730, "comment_id": 57825694, "body": "First line is a type definition (signature) for the function. It means <code>isPrime</code> is a function from <code>Integer</code> to a <code>Bool</code>. So it accepts a number and returns a boolean whether it&#39;s prime or not. It is optional but it&#39;s a good habit to always put it there."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1453944559, "post_id": 35050730, "comment_id": 57826852, "body": "<a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">Here</a> is a pretty good place to start."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1453949693, "post_id": 35050730, "comment_id": 57828228, "body": "I&#39;m voting to close this question as off-topic because you can&#39;t learn a new programming language by asking generally about arbitrary bits of code."}], "answers": [{"comments": [{"owner": {"reputation": 1094, "user_id": 5476399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0F2n.jpg?s=128&g=1", "display_name": "blkpingu", "link": "https://stackoverflow.com/users/5476399/blkpingu"}, "edited": false, "score": 0, "creation_date": 1453943862, "post_id": 35050818, "comment_id": 57826652, "body": "Okay, great. That was a great explanation @mipadi . Thank you for that. But about that <code>x</code> : How and where does it get initiated? How is it defined? What will be the output of the program? How does it get it&#39;s input? And what does the <code>|</code> resemble? Thank you in advance."}, {"owner": {"reputation": 357162, "user_id": 28804, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/015c999a9db79ffb3030b3cc207d0be8?s=128&d=identicon&r=PG", "display_name": "mipadi", "link": "https://stackoverflow.com/users/28804/mipadi"}, "reply_to_user": {"reputation": 1094, "user_id": 5476399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0F2n.jpg?s=128&g=1", "display_name": "blkpingu", "link": "https://stackoverflow.com/users/5476399/blkpingu"}, "edited": false, "score": 0, "creation_date": 1453947045, "post_id": 35050818, "comment_id": 57827483, "body": "@BlkPengu: That syntax is a &quot;list comprehension&quot;. In general, <code>[x | xs]</code> means &quot;<code>x</code> where <code>x</code> is from the set <code>xs</code>&quot;. The above would be equivalent to the math notation &quot;{ x | x is in the range 2 to n - 1 and n is divisible by x }&quot;. (Indeed, the Haskell syntax is meant to evoke set notation.)"}, {"owner": {"reputation": 1094, "user_id": 5476399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0F2n.jpg?s=128&g=1", "display_name": "blkpingu", "link": "https://stackoverflow.com/users/5476399/blkpingu"}, "edited": false, "score": 0, "creation_date": 1453948936, "post_id": 35050818, "comment_id": 57828015, "body": "thank you for the quick answer @mipadi. can you tell me something about the questions regarding input and output?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1453975197, "post_id": 35050818, "comment_id": 57839538, "body": "@mipadi Don&#39;t you mean <code>[ x | x &lt;- xs ]</code>?"}, {"owner": {"reputation": 357162, "user_id": 28804, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/015c999a9db79ffb3030b3cc207d0be8?s=128&d=identicon&r=PG", "display_name": "mipadi", "link": "https://stackoverflow.com/users/28804/mipadi"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1454003018, "post_id": 35050818, "comment_id": 57859708, "body": "@MathematicalOrchid: I do. :-)"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 1094, "user_id": 5476399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0F2n.jpg?s=128&g=1", "display_name": "blkpingu", "link": "https://stackoverflow.com/users/5476399/blkpingu"}, "edited": false, "score": 0, "creation_date": 1454005190, "post_id": 35050818, "comment_id": 57861007, "body": "@BlkPengu there is no input/otput in this program. It&#39;s just a function definition. No more, no less."}], "tags": [], "owner": {"reputation": 357162, "user_id": 28804, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/015c999a9db79ffb3030b3cc207d0be8?s=128&d=identicon&r=PG", "display_name": "mipadi", "link": "https://stackoverflow.com/users/28804/mipadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1453993517, "last_edit_date": 1453993517, "creation_date": 1453940911, "answer_id": 35050818, "question_id": 35050730, "link": "https://stackoverflow.com/questions/35050730/i-have-problems-understanding-the-syntax-of-this-code-can-someone-explain-it-li/35050818#35050818", "title": "I have problems understanding the syntax of this code. Can someone explain it line by line?", "body": "<pre><code>isPrime :: Integer -&gt; Bool\n</code></pre>\n\n<p>is a type signature. It declares <code>isPrime</code> to be a function that takes an <code>Integer</code> and returns a <code>Bool</code>.</p>\n\n<pre><code>isPrime n = (factors n == [])\n</code></pre>\n\n<p><code>(factors n == [])</code> is the body of <code>isPrime</code>'s definition. <code>isPrime</code> takes one argument, <code>n</code>, and then calls <code>factors n</code> to see if it is equal to an empty list. That is, if <code>n</code> has no factors, then it is prime.</p>\n\n<pre><code>where\n</code></pre>\n\n<p>just sets up the definition of <code>factors</code> so it is scoped to <code>isPrime</code>, basically.</p>\n\n<pre><code>factors n = [ x | x &lt;- [2..n-1], n `mod` x == 0 ]\n</code></pre>\n\n<p>is the real meat-and-bones of this program, so it does the most work. First of all, <code>factors</code> takes a single argument, <code>n</code>. It then builds a list using a list comprehension.</p>\n\n<pre><code>[ x | x &lt;- [2..n-1], n `mod` x == 0 ]\n</code></pre>\n\n<p>can be read as \"make a list of integers <code>x</code> from 2 to n - 1 such that <code>n</code> divided by <code>x</code> yields no remainder\". Which is basically checking to see if <code>n</code> is divisible by <code>x</code>; if it is, <code>x</code> is a <em>factor</em> of <code>n</code>.</p>\n"}], "owner": {"reputation": 1094, "user_id": 5476399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0F2n.jpg?s=128&g=1", "display_name": "blkpingu", "link": "https://stackoverflow.com/users/5476399/blkpingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "closed_date": 1454062139, "accepted_answer_id": 35050818, "answer_count": 1, "score": -2, "last_activity_date": 1453993750, "creation_date": 1453940345, "last_edit_date": 1453993750, "question_id": 35050730, "link": "https://stackoverflow.com/questions/35050730/i-have-problems-understanding-the-syntax-of-this-code-can-someone-explain-it-li", "closed_reason": "Not suitable for this site", "title": "I have problems understanding the syntax of this code. Can someone explain it line by line?", "body": "<p>I am learning about functional programming. I have understood the principle and now I try to learn specifics. This code is supposed to find out if n is a prime or not. I don't understand what the first line is doing. I suggest it wants an integer to be a boolean value in the function(do you call it that?) 'isPrime'.</p>\n\n<p>Line 2 to 4 are some sort of implementation of the equivalent of the determination if the modulo of n/x is zero with x counting up excluding n as a factor.</p>\n\n<p>Please help me with this.\nthank you in advance.</p>\n\n<p>Code in Question:</p>\n\n<pre><code>isPrime :: Integer -&gt; Bool\nisPrime n = (factors n == []) -- (1)\n  where\nfactors n = [ x | x &lt;- [2..n-1], n `mod` x == 0 ] \n</code></pre>\n"}]