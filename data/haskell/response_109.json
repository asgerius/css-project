[{"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1486580270, "post_id": 42121367, "comment_id": 71410904, "body": "You may also consider having a board as a <code>Map (Int, Int) Int</code>; this would allow you to only store non-trivial (&quot;non-empty&quot;, &quot;non-wall&quot;) cells, and the code to update a cell value is already written for you."}, {"owner": {"reputation": 33, "user_id": 7120326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7846310959b60c8a246f6111a52e32b?s=128&d=identicon&r=PG&f=1", "display_name": "DaoDib", "link": "https://stackoverflow.com/users/7120326/daodib"}, "edited": false, "score": 0, "creation_date": 1486580285, "post_id": 42121367, "comment_id": 71410914, "body": "So far I&#39;ve managed to generate a single array with the correct amount of Ints, but drawing a blank about how to generate filled lists inside lists"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1486580339, "post_id": 42121367, "comment_id": 71410946, "body": "@DaoDib: well why don&#39;t you show that attempt for a start?"}, {"owner": {"reputation": 33, "user_id": 7120326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7846310959b60c8a246f6111a52e32b?s=128&d=identicon&r=PG&f=1", "display_name": "DaoDib", "link": "https://stackoverflow.com/users/7120326/daodib"}, "edited": false, "score": 0, "creation_date": 1486580377, "post_id": 42121367, "comment_id": 71410965, "body": "9000, it sounds like a good way to do it, but the tasks requires the specific format [[Int]]"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1486580793, "post_id": 42121367, "comment_id": 71411193, "body": "@DaoDib: take your code that generates a list filled with <code>1</code>s and try to turn it into code that makes a list filled with an arbitrary given value. You&#39;ll be able to reuse that function to both fill a list with ints, and fill a list with other lists."}, {"owner": {"reputation": 33, "user_id": 7120326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7846310959b60c8a246f6111a52e32b?s=128&d=identicon&r=PG&f=1", "display_name": "DaoDib", "link": "https://stackoverflow.com/users/7120326/daodib"}, "edited": false, "score": 0, "creation_date": 1486580893, "post_id": 42121367, "comment_id": 71411259, "body": "Willem, the only thing i got working is using the basics of basics: makeBoard x = take x (repeat 1)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1486603106, "post_id": 42121367, "comment_id": 71421163, "body": "@DaoDib So how about <code>makeBoard x y = take y (repeat (take x (repeat 1)))</code>?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486632718, "post_id": 42121367, "comment_id": 71432447, "body": "Is this homework? If so, it should be tagged as such"}, {"owner": {"reputation": 33, "user_id": 7120326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7846310959b60c8a246f6111a52e32b?s=128&d=identicon&r=PG&f=1", "display_name": "DaoDib", "link": "https://stackoverflow.com/users/7120326/daodib"}, "edited": false, "score": 0, "creation_date": 1486899112, "post_id": 42121367, "comment_id": 71536179, "body": "Alec, it&#39;s neccesary for a school project. I missed that I have to tag it as such. I appologize."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1486580986, "creation_date": 1486580986, "answer_id": 42121636, "question_id": 42121367, "link": "https://stackoverflow.com/questions/42121367/haskell-generate-and-fill-list-of-lists/42121636#42121636", "title": "Haskell: generate and fill list of lists", "body": "<p>You can use nested <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:replicate\" rel=\"nofollow noreferrer\"><code>replicate :: Int -&gt; a -&gt; [a]</code></a>:</p>\n\n<pre><code>makeBoard :: Num a =&gt; Int -&gt; Int -&gt; [[a]]\nmakeBoard h w = replicate h $ replicate w 1\n</code></pre>\n\n<p><code>replicate</code> takes thus an <code>Int</code> and an element <code>a</code> and generates a list <code>[a]</code> that contains <em>n</em> times that element. So the second <code>replicate</code> will return a list of ones, and the first replicate will replicate that list <code>h</code> times.</p>\n\n<p>Note that <code>replicate n x</code> is actually equivalent to:</p>\n\n<pre><code>-- equivalent\nreplicate n x = take n $ repeat x\n</code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>replicate n = take n . repeat\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7120326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7846310959b60c8a246f6111a52e32b?s=128&d=identicon&r=PG&f=1", "display_name": "DaoDib", "link": "https://stackoverflow.com/users/7120326/daodib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2241, "favorite_count": 0, "accepted_answer_id": 42121636, "answer_count": 1, "score": -7, "last_activity_date": 1486580986, "creation_date": 1486580068, "last_edit_date": 1486580350, "question_id": 42121367, "link": "https://stackoverflow.com/questions/42121367/haskell-generate-and-fill-list-of-lists", "title": "Haskell: generate and fill list of lists", "body": "<p>I have to make a game board in Haskell, by taking 2 ints a input, indicating the height and width of the board. The board has to be in the format <code>[[Int]]</code>, and all the spaces have to be filled with the integer <code>1</code>.</p>\n\n<p>For example <code>makeBoard 2 3</code>, should return -> <code>[[1,1,1],[1,1,1]]</code></p>\n"}, {"tags": ["haskell", "casting", "list-comprehension"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1486569683, "post_id": 42117848, "comment_id": 71404167, "body": "Could you add the code that results in an error? Your example should evaluate to a list containing one element. Your example won&#39;t typecheck unless you use <code>minimum</code> and <code>maximum</code> instead of <code>min</code> and <code>max</code>"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1486569748, "post_id": 42117848, "comment_id": 71404208, "body": "If you know the list is always 3 elements long and just want the median, why not use <code>sort list !! 1</code>?"}, {"owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486569828, "post_id": 42117848, "comment_id": 71404251, "body": "I am away from my main computer atm, so I can&#39;t upload the errors."}, {"owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486569892, "post_id": 42117848, "comment_id": 71404303, "body": "Also, I was unaware of the sort function. However, this issue with types seems to be something which will come up again, so I would like to get to the bottom of it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1486569905, "post_id": 42117848, "comment_id": 71404320, "body": "Which <code>min</code> are you using? <code>min :: Ord a =&gt; a -&gt; a -&gt; a</code>, so passing it a list shouldn&#39;t type-check."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486571623, "post_id": 42117848, "comment_id": 71405609, "body": "I postulate your <code>medVal</code> function won&#39;t work well for inputs like <code>[1,1,2]</code> or <code>[3,3,3]</code>, even if they are only three elements."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486570243, "post_id": 42118022, "comment_id": 71404549, "body": "Thanks! I was writing from memory, so not everything carried over. I did use the minimum and maximum functions. I will try this fix when I get back."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486570276, "post_id": 42118022, "comment_id": 71404586, "body": "@MasterArcanist: note that - as is specified in the last paragraph - your function is still not semantically sound."}, {"owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486570905, "post_id": 42118022, "comment_id": 71405083, "body": "I was responding to your post before the edit. I am unfamiliar with the double colon, Ord a, =&gt;, etc. This problem arose when trying to figure out a solution to  a problem concerning right triangles on page 21 of &quot;Learn you a Haskell for great good&quot;, using only what I had learned up to that point."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486570985, "post_id": 42118022, "comment_id": 71405143, "body": "@MasterArcanist: the double colon is to specify a <b>type signature</b>. You do not have to specify it, it is however nice to know what the type is of the function&#39;s operands and the type of the result."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 6, "creation_date": 1486571190, "post_id": 42118022, "comment_id": 71405284, "body": "@MasterArcanist Don&#39;t post from memory; wait until you are at a computer where you can <i>confirm</i> that the posted code actually behaves the way you claim it does."}, {"owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486590139, "post_id": 42118022, "comment_id": 71416407, "body": "@WillemVanOnsem: I&#39;ve fixed the post. It looks like the entire issue is just me getting confused. It is indeed the problem with inputting lists with one or more equivalent values tripping me up, as well as being confused when running the function in ghci and getting what appeared to be only an integer."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1486570339, "last_edit_date": 1486570339, "creation_date": 1486569938, "answer_id": 42118022, "question_id": 42117848, "link": "https://stackoverflow.com/questions/42117848/how-does-a-haskell-list-comprehension-output-a-result-which-is-one-integer/42118022#42118022", "title": "How does a Haskell list comprehension output a result which is one integer?", "body": "<p>First of all, I don't think this will work since in order to calculate the <em>minimum</em> and <em>maximum</em> <strong>of a list</strong>, you need to use <code>minimum</code> and <code>maximum</code> ; not <code>min</code> and <code>max</code>. So a quick fix is:</p>\n\n<pre><code>medVal list = [out | out &lt;- list, out /= <b>minimum</b> list, out /= <b>maximum</b> list]</code></pre>\n\n<blockquote>\n  <p>and when I try to send out the 0th element within the function by adding \"!! 0\" to the end of the function, it tells me that that's an invalid operation for an integer.</p>\n</blockquote>\n\n<p>You can write it as:</p>\n\n<pre><code>medVal :: Ord a => [a] -> a\nmedVal list = [out | out &lt;- list, out /= minimum list, out /= maximum list]<b>!!0</b></code></pre>\n\n<p>or more elegantly (and faster):</p>\n\n<pre><code>medVal :: Ord a => [a] -> a\nmedVal list = <b>head</b> [out | out &lt;- list, out /= minimum list, out /= maximum list]</code></pre>\n\n<p>Nevertheless if you know for sure you will <strong>receive three elements</strong>, I don't know if it is good design to use a list anyway: you could define a function taking three arguments, or a function taking a tuple of elements.</p>\n\n<p>Finally your function <strong>will error if two or more elements are equivalent</strong> (like <code>medVal [0,0,20]</code>) for instance, since it will filter out all elements and thus <code>head</code> will not find a single element.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486574922, "post_id": 42118507, "comment_id": 71407768, "body": "<code>midVal 2 5 4</code> returns <code>2</code> ? Anyway, the logic above is non-trivial -- some explanation would help."}, {"owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486593435, "post_id": 42118507, "comment_id": 71417975, "body": "For some reason this works when interpreted but not when I run it through the compiler. Any idea why? In both cases the text was copy/pasted with only newline/spacing changed."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1486593971, "post_id": 42118507, "comment_id": 71418198, "body": "<code>let</code> is required in the ghci environment, in compiled code you should remove it."}, {"owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "edited": false, "score": 0, "creation_date": 1486605657, "post_id": 42118507, "comment_id": 71421875, "body": "I did remove let."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1486581499, "last_edit_date": 1486581499, "creation_date": 1486571247, "answer_id": 42118507, "question_id": 42117848, "link": "https://stackoverflow.com/questions/42117848/how-does-a-haskell-list-comprehension-output-a-result-which-is-one-integer/42118507#42118507", "title": "How does a Haskell list comprehension output a result which is one integer?", "body": "<p>a more elementary solution</p>\n\n<pre><code>&gt; let midVal x y z | (z&gt;=x)==(x&gt;=y) = x\n                   | (x&gt;=y)==(y&gt;=z) = y\n                   | otherwise      = z\n</code></pre>\n\n<p>Note: typo fixed</p>\n\n<p>It's derived from the truth table, but easy to read the lines, for example if either x is less than z and greater than y or x is greater than z and y is greater than x (so x is in the middle) etc. </p>\n"}], "owner": {"reputation": 103, "user_id": 7535360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFGBS.gif?s=128&g=1", "display_name": "MasterArcanist", "link": "https://stackoverflow.com/users/7535360/masterarcanist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 42118022, "answer_count": 2, "score": -3, "last_activity_date": 1486591818, "creation_date": 1486569506, "last_edit_date": 1486591818, "question_id": 42117848, "link": "https://stackoverflow.com/questions/42117848/how-does-a-haskell-list-comprehension-output-a-result-which-is-one-integer", "title": "How does a Haskell list comprehension output a result which is one integer?", "body": "<p>I am trying to use a list comprehension to find the median of a list which will always contain three integers with the following function:</p>\n\n<pre><code>midNum set = [x | x &lt;- set, x /= maximum set, x /= minimum set]!!0\n</code></pre>\n\n<p>This works well enough on its own, as in the following example:</p>\n\n<pre><code>ghci&gt; midNum [1,2,3]\n2\n</code></pre>\n\n<p>However, it blows up when I try to use it in conjunction with my other functions, resulting in the following error:</p>\n\n<pre><code>*** Exception: Prelude.!!: index too large\n</code></pre>\n\n<p>When I remove the '!!0', the compiler gives me this message:</p>\n\n<pre><code>Triangle.hs:4:79: error:\n* Occurs check: cannot construct the infinite type: t ~ [t]\n* In the second argument of `(+)', namely\n    `squareOf (midNum triangle)'\n  In the second argument of `(==)', namely\n    `squareOf (minimum triangle) + squareOf (midNum triangle)'\n  In the expression:\n    squareOf (maximum triangle)\n    == squareOf (minimum triangle) + squareOf (midNum triangle)\n* Relevant bindings include\n    triangle :: [t] (bound at Triangle.hs:4:9)\n    isRight :: [t] -&gt; Bool (bound at Triangle.hs:4:1)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>So it looks as if the function is giving me an integer, but the compiler is expecting a list. In another language I would typecast to fix this, but I'm not sure what to do in Haskell.</p>\n\n<p>This is also essentially my first dip into Haskell, so forgive me if the answer is blindingly obvious.</p>\n"}, {"tags": ["haskell", "numbers"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 4, "creation_date": 1486562687, "post_id": 42115070, "comment_id": 71399038, "body": "This is not how polymorphism works in Haskell.  Type classes aren&#39;t subtyping. Type variables are chosen by the <i>caller</i> of a function, not the function itself. Is there some question that covers this really well already?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1486562755, "post_id": 42115070, "comment_id": 71399080, "body": "Edit: totally wrong statement preserved for posterity follows - Oh and, for what it&#39;s worth, <code>Int</code> and <code>Word</code> types are not instances of <code>Real</code>."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1486562774, "post_id": 42115070, "comment_id": 71399090, "body": "@Carl Yes they are."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1486562857, "post_id": 42115070, "comment_id": 71399154, "body": "@jpath Well shoot.  I was thinking of the wrong class."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1486562986, "post_id": 42115070, "comment_id": 71399231, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/41508145/unable-to-deduce-two-constrained-types-are-the-same\">Unable to deduce two constrained types are the same</a>"}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1486564384, "post_id": 42115070, "comment_id": 71400260, "body": "@jpath see my edit"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486564727, "post_id": 42115070, "comment_id": 71400525, "body": "Relevant: <a href=\"http://stackoverflow.com/q/40432690/2751851\"><i>How to comfortably deal with the type system on Haskell?</i></a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1486566544, "post_id": 42115070, "comment_id": 71401905, "body": "@Carl I don&#39;t think it&#39;s totally wrong. The point about tyvars chosen by the caller and not by the function/callee is correct, and is the crux of this problem. And I agree that we need a reference question for this -- it&#39;s being asked again and again."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1486617727, "post_id": 42116421, "comment_id": 71424937, "body": "Why insult existential types? They can be quite useful indeed! There&#39;s one at the heart of the <code>foldl</code> package (related closely to the one in <code>Coyoneda</code>), and they&#39;re also important for type-aligned sequences (for &quot;reflection without remorse&quot;), and so on. Of course, they have no place in this particular function, but one could imagine a somewhat similar situation where they would make sense, involving multiple related numbers and functions all wrapped up in an existential."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1486637253, "post_id": 42116421, "comment_id": 71435566, "body": "Did I insult existentials? I just said parametric polymorphism is more useful than they are. Yes, existentials are also useful for <i>some</i> speciality applications."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1486566787, "last_edit_date": 1486566787, "creation_date": 1486565703, "answer_id": 42116421, "question_id": 42115070, "link": "https://stackoverflow.com/questions/42115070/why-doesnt-the-compiler-accept-returning-int8-as-real-c/42116421#42116421", "title": "why doesn&#39;t the compiler accept returning Int8 as &quot;Real c&quot;?", "body": "<p>What you're aiming to express is an <em>existential type</em>:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata SomeReal where\n  SomeReal :: Real c =&gt; c -&gt; SomeReal\n\ngetnumberfromvalue :: JavaValue -&gt; Maybe SomeReal\ngetnumberfromvalue (JavaByte n) = Just $ SomeReal n\ngetnumberfromvalue (JavaShort n) = Just $ SomeReal n\ngetnumberfromvalue (JavaInt n) = Just $ SomeReal n\n...\n</code></pre>\n\n<p>This is then basically equivalent to what an OO language would mean by a signature like <code>Real getNumberFromValue (JavaValue v) {...}</code>: the function returns a number of <em>some type</em>, the caller doesn't know what type it will be (just that it's in the <code>Real</code> class).</p>\n\n<p>But why would you want that? There's not much you can do with a number of unknown type, you can't even add it or compare to other numbers because the types may be different. The only thing you <em>can</em> do, thanks to <code>Real</code> specifically, is <em>convert</em> the number to one with concrete type <code>Rational</code> (which is thought of as a \u201csupertype of all real<sup>\u2020</sup> number types\u201d). Ok, but then you might as well do so right upfront, no need to wrap in in an existential:</p>\n\n<pre><code>getnumberfromvalue :: JavaValue -&gt; Maybe Rational\ngetnumberfromvalue (JavaByte n) = Just $ toRational n\ngetnumberfromvalue (JavaShort n) = Just $ toRational n\ngetnumberfromvalue (JavaInt n) = Just $ toRational n\n...\n</code></pre>\n\n<p>What a standard polymorphic Haskell signature like <code>Real c =&gt; JavaValue -&gt; Maybe c</code> means is quite different and much more useful than existential types: it means the caller gets to choose what number type to use. This can be a fixed type that's shared across many functions, eliminating any need for conversions in between while retaining the flexibility of a dynamic language. It's more similar to C++ templates than to generic covariant OO polymorphism.<br>\nBut of course that means you'll have to settle on a particular type before you start any computations, you can't just pass <em>numbers of unknown type</em> around (that would incur a lot of runtime overhead, which is basically the reason why Ruby and Python are slow and Java has non-object types like <code>int</code>).</p>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>IMO this is silly, since <a href=\"https://en.wikipedia.org/wiki/Real_number\">real numbers</a> are verily in general <em>not</em> rational. The method of <code>Real a</code> should arguably be <code>toCauchySeq :: a -&gt; [(Rational, Rational)]</code> instead. (I reckon you wouldn't prefer that, though...)</sub></p>\n"}, {"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 2, "last_activity_date": 1486567360, "last_edit_date": 1486567360, "creation_date": 1486566270, "answer_id": 42116660, "question_id": 42115070, "link": "https://stackoverflow.com/questions/42115070/why-doesnt-the-compiler-accept-returning-int8-as-real-c/42116660#42116660", "title": "why doesn&#39;t the compiler accept returning Int8 as &quot;Real c&quot;?", "body": "<p>You can do like this:</p>\n\n<pre><code>getnumberfromvalue :: Fractional f =&gt; JavaValue -&gt; Maybe f\ngetnumberfromvalue (JavaByte n) = Just . realToFrac $ n\ngetnumberfromvalue (JavaShort n) = Just . realToFrac $ n\ngetnumberfromvalue (JavaInt n) = Just . realToFrac $ n\ngetnumberfromvalue (JavaLong n) = Just . realToFrac $ n\ngetnumberfromvalue (JavaFloat n) = Just . realToFrac $ n\ngetnumberfromvalue (JavaDouble n) = Just . realToFrac $ n\ngetnumberfromvalue (JavaChar n) = Just . realToFrac . fromEnum $ n\ngetnumberfromvalue _ = Nothing\n</code></pre>\n\n<p>or like this:</p>\n\n<pre><code>getnumberfromvalue :: (Num a, Typeable a) =&gt; JavaValue -&gt; Maybe a\ngetnumberfromvalue (JavaByte n) = Just . fromIntegral $ n\ngetnumberfromvalue (JavaShort n) = Just . fromIntegral $ n\ngetnumberfromvalue (JavaInt n) = Just . fromIntegral $ n\ngetnumberfromvalue (JavaLong n) = Just . fromIntegral $ n\ngetnumberfromvalue (JavaFloat n) = cast n &lt;|&gt; cast (realToFrac n :: Double)\ngetnumberfromvalue (JavaDouble n) = cast n &lt;|&gt; cast (realToFrac n :: Float)\ngetnumberfromvalue (JavaChar n) = Just . fromIntegral . fromEnum $ n\ngetnumberfromvalue _ = Nothing\n</code></pre>\n"}], "owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 42116421, "answer_count": 2, "score": 0, "last_activity_date": 1486567360, "creation_date": 1486562149, "last_edit_date": 1592644375, "question_id": 42115070, "link": "https://stackoverflow.com/questions/42115070/why-doesnt-the-compiler-accept-returning-int8-as-real-c", "title": "why doesn&#39;t the compiler accept returning Int8 as &quot;Real c&quot;?", "body": "<p>I have this example code :</p>\n<pre><code>module Main where\n\nimport Data.Int\nimport Data.Text\n\ndata JavaValue = JavaString Text\n              | JavaByte Int8\n              | JavaShort Int16\n              | JavaInt Int32\n              | JavaLong Int64\n              | JavaFloat Float\n              | JavaDouble Double\n              | JavaChar Char\n              | JavaBool Bool\n              | ArrayValue [JavaValue]\n              | JavaNull deriving (Eq)\n\ngetnumberfromvalue :: Real c =&gt; JavaValue -&gt; Maybe c\ngetnumberfromvalue (JavaByte n) =Just n\ngetnumberfromvalue (JavaShort n) =Just n\ngetnumberfromvalue (JavaInt n) =Just n\ngetnumberfromvalue (JavaLong n) =Just n\ngetnumberfromvalue (JavaFloat n) =Just n\ngetnumberfromvalue (JavaDouble n) =Just n\ngetnumberfromvalue (JavaChar n) =Just $ fromEnum n\ngetnumberfromvalue _ = Nothing\n</code></pre>\n<p>This code doesn't compile with this error :</p>\n<blockquote>\n<p>test.hs:25:34: error:</p>\n<pre><code>\u2022 Couldn't match type \u2018c\u2019 with \u2018Int\u2019\n  \u2018c\u2019 is a rigid type variable bound by\n    the type signature for:\n      getnumberfromvalue :: forall c. Real c =&gt; JavaValue -&gt; Maybe c\n    at test.hs:18:23\n  Expected type: Maybe c\n    Actual type: Maybe Int\n\u2022 In the expression: Just $ fromEnum n\n  In an equation for \u2018getnumberfromvalue\u2019:\n      getnumberfromvalue (JavaChar n) = Just $ fromEnum n\n\u2022 Relevant bindings include\n    getnumberfromvalue :: JavaValue -&gt; Maybe c (bound at test.hs:19:1)\n</code></pre>\n</blockquote>\n<p>I don't understand why, since <code>Int(8,16,32,64)</code>and <code>Float</code> and <code>Double</code> all are <code>Real</code> why does it say it can't match <code>Int</code> with <code>c</code> ?!!</p>\n<p>The above code is just a small part of a java compiler I'm building for university project, <code>getnumberfromvalue</code> is just a utility function, <code>JavaValue</code> is to represent a java literal.</p>\n<p>I know about <code>fromIntegral</code> and <code>realToFrac</code> and I don't think I can use them here.</p>\n<p>I have seen <a href=\"https://stackoverflow.com/questions/41508145/unable-to-deduce-two-constrained-types-are-the-same\">this</a> question but the answer uses GADT and ExistentialQuantification seems to be only for types, I don't think I want to use it for this simple problem, even without GADT isn't there a way that doesn't involve defining a trivial data type ? .</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 430, "user_id": 4347384, "user_type": "registered", "accept_rate": 16, "profile_image": "https://graph.facebook.com/100000178651188/picture?type=large", "display_name": "Micha\u0142 Piotr Stankiewicz", "link": "https://stackoverflow.com/users/4347384/micha%c5%82-piotr-stankiewicz"}, "edited": false, "score": 0, "creation_date": 1486674563, "post_id": 42113823, "comment_id": 71460147, "body": "Only to my consideration, how to replace liftA2, if I want to have like 5 runners?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 430, "user_id": 4347384, "user_type": "registered", "accept_rate": 16, "profile_image": "https://graph.facebook.com/100000178651188/picture?type=large", "display_name": "Micha\u0142 Piotr Stankiewicz", "link": "https://stackoverflow.com/users/4347384/micha%c5%82-piotr-stankiewicz"}, "edited": false, "score": 0, "creation_date": 1486674735, "post_id": 42113823, "comment_id": 71460225, "body": "@Micha\u0142PiotrStankiewicz Either write out the argument (<code>\\p -&gt; do { zoom _1 (tcProgram p) ; zoom _2 (tcProgram p) ; etc }</code>) or stick a <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html\" rel=\"nofollow noreferrer\"><code>ReaderT</code></a> in your monad transformer stack."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1486560784, "last_edit_date": 1486560784, "creation_date": 1486558701, "answer_id": 42113823, "question_id": 42113610, "link": "https://stackoverflow.com/questions/42113610/haskell-statet-and-exceptt-chain/42113823#42113823", "title": "Haskell StateT and ExceptT chain", "body": "<p><code>lens</code> has a <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Zoom.html#v:zoom\" rel=\"nofollow noreferrer\"><code>zoom</code></a> combinator which uses a lens to \"zoom in\" on a part of the state.</p>\n\n<pre><code>zoom :: Lens' s t -&gt; State t a -&gt; State s a\n</code></pre>\n\n<p>(As is usual in <code>lens</code>, the actual type of <code>zoom</code> is more complicated than that, but this is a simple way to think about it.)</p>\n\n<p>So we have</p>\n\n<pre><code>zoom _1 . tcProgram :: Program -&gt; Runner () (TypeCheckState, t)\nzoom _2 . ieProgram :: Program -&gt; Runner () (s, IdentExistenceState)\n</code></pre>\n\n<p>and so</p>\n\n<pre><code>liftA2 (&gt;&gt;) (zoom _1 . tcProgram) (zoom _2 . ieProgram) :: Program -&gt; Runner () (TypeCheckState, IdentExistenceState)\n</code></pre>\n"}], "owner": {"reputation": 430, "user_id": 4347384, "user_type": "registered", "accept_rate": 16, "profile_image": "https://graph.facebook.com/100000178651188/picture?type=large", "display_name": "Micha\u0142 Piotr Stankiewicz", "link": "https://stackoverflow.com/users/4347384/micha%c5%82-piotr-stankiewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 42113823, "answer_count": 1, "score": 1, "last_activity_date": 1486560784, "creation_date": 1486558197, "question_id": 42113610, "link": "https://stackoverflow.com/questions/42113610/haskell-statet-and-exceptt-chain", "title": "Haskell StateT and ExceptT chain", "body": "<p>I am not very good haskell programer. I am tasked to write a compiler at my university and I have choosen haskell, as it is good tool for that purpose. I am using monads StateT and ExcepT, so I have types:</p>\n\n<pre><code>type Runner r s = StateT s (ExceptT LatteError IO) r\ntype RT r s = IO (Either LatteError (r, s))\n</code></pre>\n\n<p>I use it create walk a program tree and produce asm code and it works as I want. As main function for walking over tree I use</p>\n\n<pre><code>rProgram :: Program -&gt; Runner [String] CompileState\n</code></pre>\n\n<p>and to unpack result I use function</p>\n\n<pre><code>runR program = runExceptT (runStateT (rProgram program) initialCompileState)\n</code></pre>\n\n<p>What I want to do not is to have some validators, like type check, ident existance check, and I know to write them. Lets tell I have</p>\n\n<pre><code>tcProgram :: Program -&gt; Runner () TypeCheckState\nieProgram :: Program -&gt; Runner () IdentExistanceState\n</code></pre>\n\n<p>I want to run them both in elegant way, and an failure is indicated by throwError. How to put many functions like them together?</p>\n"}, {"tags": ["haskell", "algebraic-data-types"], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1486557308, "post_id": 42113095, "comment_id": 71395152, "body": "I see, I think <code>Entity</code> would be easier to read due to less constructor noise. But will this one make pattern matching on <code>Entity</code> harder than my old working code? In that case I will use the working one."}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1486557465, "post_id": 42113095, "comment_id": 71395274, "body": "If you move to the separate <code>Entity</code> type, then you will have to pattern match on <code>EPlayer</code> and <code>Player</code> everywhere in order to get the payload."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 2, "last_activity_date": 1486557132, "last_edit_date": 1486557132, "creation_date": 1486556757, "answer_id": 42113095, "question_id": 42113044, "link": "https://stackoverflow.com/questions/42113044/can-i-include-data-declaration-to-another-data/42113095#42113095", "title": "Can I include data declaration to another data?", "body": "<p>You have two constructors in the same module called <code>Player</code>, and the same with <code>Bomb</code>. You could give one of them a prefix like this to disambiguate the constructors:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Entity = EPlayer | EBomb\n  deriving Show\n</code></pre>\n\n<p>However, I don't think your <code>Entity</code> is doing quite what you want it to do. Those two constructors on <code>Entity</code> carry no data and have no relation to the data types <code>Player</code> and <code>Bomb</code>. If you wanted the <code>Entity</code> constructors to carry data, you could define them as such:</p>\n\n<pre><code>data Entity = EPlayer Player | EBomb Bomb\n  deriving Show\n</code></pre>\n\n<p>But by that then, you are kind of in the same position where you started. What exactly are you trying to achieve by this refactoring?</p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 42113095, "answer_count": 1, "score": 0, "last_activity_date": 1486557132, "creation_date": 1486556635, "last_edit_date": 1486556770, "question_id": 42113044, "link": "https://stackoverflow.com/questions/42113044/can-i-include-data-declaration-to-another-data", "title": "Can I include data declaration to another data?", "body": "<p>I am writing CodinGame <a href=\"https://www.codingame.com/ide/puzzle/hypersonic\" rel=\"nofollow noreferrer\">hypersonic</a> bot. </p>\n\n<p>I have a working code for parse input</p>\n\n<pre><code>type Position = (Int,Int)\n\ndata Entity = Player { pId :: Int, pPos :: Position, pBombStock :: Int, pBombRange :: Int } \n            | Bomb { bOwnerId :: Int, bPos :: Position, bTimeLeft :: Int , bBombRange :: Int}\n  deriving Show\n\n-- The entityType will be:\n--   For players: 0.\n--   For bombs: 1.\n-- The owner will be:\n--   For players: id of the player ( 0 or 1).\n--   For bombs: id of the bomb's owner.\n-- The param1 will be:\n--   For players: number of bombs the player can still place.\n--   For bombs: number of rounds left until the bomb explodes.\n-- The param2 is not useful for the current league, and will always be:\n--   For players: explosion range of the player's bombs (= 3).\n--   For bombs: explosion range of the bomb (= 3).\nmkEnt :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Entity\nmkEnt 0 o x y p1 p2 = Player { pId = o, pPos = (x,y), pBombStock = p1, pBombRange = p2}\nmkEnt 1 o x y p1 p2 = Bomb { bOwnerId = o, bPos = (x,y), bTimeLeft = p1, bBombRange = p2}\nmkEnt _ _ _ _ _  _  = error \"invalid entity type\"\n\nmain :: IO ()\nmain = do\n  print $ mkEnt 0 1 0 0 0 3\n  print $ mkEnt 1 1 0 0 0 3\n</code></pre>\n\n<p>But when I try to refactor the <code>Entity</code> </p>\n\n<pre><code>data Entity = Player | Bomb\n  deriving Show\n\ndata Player = Player { pId :: Int, pPos :: Position, pBombStock :: Int, pBombRange :: Int } \n  deriving Show\n\ndata Bomb = Bomb { bOwnerId :: Int, bPos :: Position, bTimeLeft :: Int , bBombRange :: Int}\n  deriving Show\n</code></pre>\n\n<p>the code won't compile with <code>error: Multiple declarations of \u2018Player\u2019</code></p>\n\n<p>Do I need any language extension to make this work, or it can not be done (by designed). </p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486556507, "post_id": 42112941, "comment_id": 71394589, "body": "What do you mean with &quot;declare a tuple type&quot;? Actually it rather weird to state this because a tuple is not really integral: it is hard to convert it to a nice &quot;Integer&quot;..."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486566087, "post_id": 42112941, "comment_id": 71401590, "body": "It&#39;s <a href=\"https://en.wikipedia.org/wiki/Integer#Construction\" rel=\"nofollow noreferrer\">not hard</a>, but not particularly useful here."}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "edited": false, "score": 0, "creation_date": 1486556762, "post_id": 42112999, "comment_id": 71394764, "body": "What if the second element of the tuple is of any type?"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "edited": false, "score": 0, "creation_date": 1486557051, "post_id": 42112999, "comment_id": 71394974, "body": "If you want a parameter to be of any type, use an unconstrained generic parameter. For example, this makes the second argument of the function unconstrained: <code>countRepetitions :: Integral a =&gt; [a] -&gt; b -&gt; (a,a)</code>. However, returning a type of <code>(a,b)</code>, where you are returning something completely unknown as the second parameter, may not be what you&#39;re after."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1486556502, "creation_date": 1486556502, "answer_id": 42112999, "question_id": 42112941, "link": "https://stackoverflow.com/questions/42112941/error-tuple-non-type-variable-argument-in-the-constraint-integral-a-a/42112999#42112999", "title": "Error tuple: Non type-variable argument in the constraint: Integral (a, a)", "body": "<p>You don't need to constraint with <code>Integral (a, a)</code>. The constraint <code>Integral a</code> forces all values for type <code>a</code> to be <code>Integral</code>. Try rewriting it like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>countRepetitions :: Integral a =&gt; [a] -&gt; a -&gt; (a,a)\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 42112999, "answer_count": 1, "score": 0, "last_activity_date": 1486556502, "creation_date": 1486556330, "last_edit_date": 1486556435, "question_id": 42112941, "link": "https://stackoverflow.com/questions/42112941/error-tuple-non-type-variable-argument-in-the-constraint-integral-a-a", "title": "Error tuple: Non type-variable argument in the constraint: Integral (a, a)", "body": "<p>I have seen an example where you define the tuple type in this way:</p>\n\n<pre><code>countRepetitions :: (Integral a, Integral (a,a)) =&gt; [a] -&gt; a -&gt; (a,a)\n</code></pre>\n\n<p>But when I execute the code appears the message:\nNon type-variable argument in the constraint: <code>Integral (a, a)</code>\nHow can I declare a tuple type?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486557944, "post_id": 42112451, "comment_id": 71395619, "body": "You can <i>almost</i> think of <code>(=&gt;)</code> as an operator of kind <code>Constraint -&gt; *</code>, except a constrained type is not a valid expression outside of a type annotation. (Also, <code>=&gt;</code> &quot;takes&quot; either a single <code>Constraint</code> or a &quot;tuple&quot; of <code>Constraint</code>s.)"}], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1486632775, "post_id": 42112610, "comment_id": 71432493, "body": "Here is link to <a href=\"https://www.stackage.org/haddock/lts-7.19/ghc-prim-0.5.0.0/src/GHC-Classes.html#Ord\" rel=\"nofollow noreferrer\">source</a>."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 7, "last_activity_date": 1486555419, "creation_date": 1486555419, "answer_id": 42112610, "question_id": 42112451, "link": "https://stackoverflow.com/questions/42112451/meaning-of-and-ord-a/42112610#42112610", "title": "Meaning of =&gt; and (Ord a)", "body": "<p>The <code>=&gt;</code> symbol is used to build class constraints on a function. In the <code>max</code> example, it means that all parameters of type <code>a</code> need to implement the <code>Ord</code> typeclass.</p>\n\n<p>Consider the implementation of <code>max</code></p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>max :: (Ord a) =&gt; a -&gt; a -&gt; a\nmax x y = if x &lt; y then y else x\n</code></pre>\n\n<p>The only thing we know about <code>x</code> and <code>y</code> is that they have to satisfy the <code>Ord</code> typeclass. That in turn allows us to use the <code>&lt;</code> function for comparison, whose signature is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(&lt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>If you were to omit the <code>Ord a</code> constraint from the definition of <code>max</code>, then it wouldn't compile, because the body of <code>max</code> wouldn't be able to use the comparison function.</p>\n"}, {"tags": [], "owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "is_accepted": false, "score": 3, "last_activity_date": 1486555427, "creation_date": 1486555427, "answer_id": 42112616, "question_id": 42112451, "link": "https://stackoverflow.com/questions/42112451/meaning-of-and-ord-a/42112616#42112616", "title": "Meaning of =&gt; and (Ord a)", "body": "<p>The part <code>(Ord a) =&gt;</code> is a type constraint, indicating a is an ordinal type (it can be ordered).</p>\n\n<p>You can read <code>max :: (Ord a) =&gt; a -&gt; a -&gt; a</code> as:</p>\n\n<p><em>where a is an ordinal type, \"max\" takes 2 arguments of type a and returns type a</em></p>\n"}], "owner": {"reputation": 113, "user_id": 7200922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9yJO.jpg?s=128&g=1", "display_name": "Fireapprentice", "link": "https://stackoverflow.com/users/7200922/fireapprentice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "accepted_answer_id": 42112610, "answer_count": 2, "score": 1, "last_activity_date": 1486563938, "creation_date": 1486554977, "last_edit_date": 1486563938, "question_id": 42112451, "link": "https://stackoverflow.com/questions/42112451/meaning-of-and-ord-a", "title": "Meaning of =&gt; and (Ord a)", "body": "<p>First of all, please be aware that I looked online (in stackoverflow and Hoogle) to see if I could find anything to this topic!</p>\n\n<p>I have been working myself through a \"learn yourself a haskell\" and there are two things I have been stumbling upon quite often which I don't really understand. The use of => and (Ord a) in several important functions. </p>\n\n<p>As an example: </p>\n\n<pre><code>max :: (Ord a) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>and is the use of \"Ordering\" the same as (Ord a), as in:</p>\n\n<pre><code>compareWith :: Int -&gt; Ordering\n</code></pre>\n\n<p>Thank you for taking your time and helping me with this (probably) simpole question!</p>\n"}, {"tags": ["haskell", "haskell-stack", "nix", "ghc-mod"], "comments": [{"owner": {"reputation": 662, "user_id": 668354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yn84u.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/668354/mikkel"}, "edited": false, "score": 0, "creation_date": 1486557119, "post_id": 42110943, "comment_id": 71395029, "body": "You could try <a href=\"https://commercialhaskell.github.io/intero/\" rel=\"nofollow noreferrer\">Intero</a>, which is specifically made to work well with <code>stack</code>. The more difficult way would be to package <code>ghc-mod</code> for Nix."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 662, "user_id": 668354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yn84u.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/668354/mikkel"}, "edited": false, "score": 0, "creation_date": 1486557509, "post_id": 42110943, "comment_id": 71395310, "body": "@Mikkel: thanks, but I&#39;m a vim guy :) there is already a nix package for ghc-mod, I don&#39;t think that&#39;s the problem here, or maybe I&#39;m misunderstanding you."}, {"owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "edited": false, "score": 0, "creation_date": 1530639537, "post_id": 42110943, "comment_id": 89303805, "body": "I think that stack&#39;s nix integration only installs the dependencies in a nix-shell that it uses internally. Is it possible that your ghc-mod is running outside of this shell, and therefore missing some of the <code>LD_LIBRARY_PATH</code> entries it needs?"}], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1486550687, "creation_date": 1486550687, "question_id": 42110943, "link": "https://stackoverflow.com/questions/42110943/using-stack-ghc-mod-and-nixos-all-together", "title": "Using stack, ghc-mod and NixOS all together", "body": "<p>I'm having some trouble getting all these tools to work together, and I would be interested to hear if someone has managed.</p>\n\n<p>My main problem is the following: I have some external dependencies, which in my <code>stack.yaml</code> look like this:</p>\n\n<pre><code>nix:\n  enable: true\n  packages: [curl, postgresql94, zlib]\n</code></pre>\n\n<p>which are clearly provided by the nix system. When I run <code>ghc-mod type Main.hs 39 19</code> on my current <code>Main.hs</code> I get the following:</p>\n\n<pre><code>EXCEPTION: types:\n           &lt;command line&gt;: can't load .so/.DLL for: /home/user/.stack/snapshots/x86_64-linux-nix/lts-7.15/8.0.1/lib/x86_64-linux-ghc-8.0.1/postgresql-libpq-0.9.2.0-IWEdPrPraPeE94ud73Ope3/libHSpostgresql-libpq-0.9.2.0-IWEdPrPraPeE94ud73Ope3-ghc8.0.1.so (libpq.so.5: cannot open shared object file: No such file or directory)\n</code></pre>\n\n<p>so it seems to be having trouble loading these external dependencies.</p>\n\n<p>Any ideas how to proceed?</p>\n"}, {"tags": ["haskell", "function-composition", "writer-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486550964, "post_id": 42110847, "comment_id": 71390812, "body": "well the <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> operator expects two functions each taking one argument and the right one <code>myFunction</code> here has no argument (or at least not the one) that <code>execWriter</code> is expecting."}, {"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 0, "creation_date": 1486554911, "post_id": 42110847, "comment_id": 71393491, "body": "You can also define <code>(.:) = (.) . (.)</code> and then use, <code>execWriter .: myFunction $ 1 2</code>. It is also known as the &quot;owl operator&quot;. (<code>(.:)</code> is already defined in <code>Data.Composition</code> - <a href=\"http://hackage.haskell.org/package/composition-1.0.2.1/docs/Data-Composition.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/composition-1.0.2.1/docs/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 4, "last_activity_date": 1486550967, "creation_date": 1486550967, "answer_id": 42111046, "question_id": 42110847, "link": "https://stackoverflow.com/questions/42110847/function-composition-with-the-writer-monad/42111046#42111046", "title": "Function composition with the Writer monad?", "body": "<p>Function composition with <code>.</code> means that the resulting composition will receive an argument.</p>\n\n<p>This portion:</p>\n\n<pre><code>execWriter . myFunction 1 2\n</code></pre>\n\n<p>Can be written more explicitly like this:</p>\n\n<pre><code>(\\x -&gt; execWriter (myFunction 1 2 x))\n</code></pre>\n\n<p>Since <code>myFunction</code> only takes two arguments, you are getting a compile error. </p>\n\n<p>Had you used <code>$</code> in your code, like this:</p>\n\n<pre><code>execWriter $ myFunction 1 2\n</code></pre>\n\n<p>The resulting code expanded is equivalent to this:</p>\n\n<pre><code>execWriter (myFunction 1 2)\n</code></pre>\n\n<p>Which is valid.</p>\n"}, {"tags": [], "owner": {"reputation": 4667, "user_id": 616456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/646c0755a76e341c3a3a09b5c391ffed?s=128&d=identicon&r=PG", "display_name": "Teo Klestrup R&#246;ijezon", "link": "https://stackoverflow.com/users/616456/teo-klestrup-r%c3%b6ijezon"}, "is_accepted": false, "score": 2, "last_activity_date": 1486551230, "creation_date": 1486551230, "answer_id": 42111148, "question_id": 42110847, "link": "https://stackoverflow.com/questions/42110847/function-composition-with-the-writer-monad/42111148#42111148", "title": "Function composition with the Writer monad?", "body": "<p>In addition to what Chad said, this happens because regular function application (without using <code>$</code>) has a higher priority than all operators (infix functions), including <code>.</code>.</p>\n\n<p>Your example would have worked if you had written it like this:</p>\n\n<pre><code>(execWriter . myFunction 1) 2\n</code></pre>\n\n<p>Which is equivalent to:</p>\n\n<pre><code>(\\x -&gt; execWriter (myFunction 1 x)) 2\n</code></pre>\n\n<p>Which then evaluates to:</p>\n\n<pre><code>execWriter (myFunction 1 2)\n</code></pre>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 42111046, "answer_count": 2, "score": 0, "last_activity_date": 1486551230, "creation_date": 1486550379, "question_id": 42110847, "link": "https://stackoverflow.com/questions/42110847/function-composition-with-the-writer-monad", "title": "Function composition with the Writer monad?", "body": "<p>I'm studying the <code>Writer</code> monad and have the following: </p>\n\n<pre><code>myFunction :: Int -&gt; Int -&gt; Writer String Int\nmyFunction e1 e2 \n   | e1 &gt; e2 = do\n      tell (\"E1 greater\")\n      return (e1)\n   | otherwise = do\n      tell (\"E2 greater\")\n      return (e2)\n\nmain = do\n-- execWriter :: Writer w a -&gt; w \n   print $ execWriter . myFunction 1 2 \n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>\"Couldn't match type \u2018WriterT String Data.Functor.Identity.Identity Int\u2019with \u2018a0 -&gt; Writer c0 a1\u2019\n  Expected type: a0 -&gt; Writer c0 a1\n    Actual type: Writer String Int\"\n</code></pre>\n\n<p>Why does this computation error with <code>.</code> and not <code>$</code>? Perhaps my understanding of function composition is incorrect?</p>\n"}, {"tags": ["haskell", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 3, "last_activity_date": 1486544109, "creation_date": 1486544109, "answer_id": 42108571, "question_id": 42108539, "link": "https://stackoverflow.com/questions/42108539/haskell-parse-error-on-type-declaration/42108571#42108571", "title": "Haskell parse error on Type declaration", "body": "<p>The syntax for defining type synonyms is <code>type</code>, with a lower-case <code>t</code>.</p>\n"}], "owner": {"reputation": 65, "user_id": 7186508, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/efbb0f6aa8d6a557d7d430b01ab4780b?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/7186508/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "closed_date": 1486603241, "answer_count": 1, "score": 0, "last_activity_date": 1486556264, "creation_date": 1486543999, "last_edit_date": 1486556264, "question_id": 42108539, "link": "https://stackoverflow.com/questions/42108539/haskell-parse-error-on-type-declaration", "closed_reason": "Not suitable for this site", "title": "Haskell parse error on Type declaration", "body": "<p>The ghci compiler gives me a parse error on input <code>-&gt;</code> in the following program.</p>\n\n<pre><code>Type Point = (Int,Int)\nType Picture = Point -&gt; Bool\n</code></pre>\n\n<p>Whats wrong with that?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1486521622, "post_id": 42103627, "comment_id": 71377323, "body": "&quot;Not in scope&quot; means you are trying to use a name which is not defined in the place in which you are trying to use it. In this case, it happens because you left out a comma after <code>[1..x]</code>, and so your definition of <code>a</code> within the list comprehension doesn&#39;t work as it should. Change it to <code>[a | a &lt;- [1..x], mod a x == 0]</code>"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1486531415, "post_id": 42103627, "comment_id": 71379992, "body": "It help if you include whole GHCi error message in the question."}], "answers": [{"comments": [{"owner": {"reputation": 495, "user_id": 8707768, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/08ef2730c4493c63a2e802b03570dd32?s=128&d=identicon&r=PG", "display_name": "Malik Kon&#233;", "link": "https://stackoverflow.com/users/8707768/malik-kon%c3%a9"}, "edited": false, "score": 0, "creation_date": 1601796977, "post_id": 42105437, "comment_id": 113512586, "body": "In what case would <code>function3 :: Int -&gt; [Int]</code> not throw an error in ghci ?"}], "tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": true, "score": 31, "last_activity_date": 1486532702, "last_edit_date": 1486532702, "creation_date": 1486531984, "answer_id": 42105437, "question_id": 42103627, "link": "https://stackoverflow.com/questions/42103627/error-haskell-not-in-scope-what-does-that-mean/42105437#42105437", "title": "Error haskell: not in scope. What does that mean?", "body": "<p>Did error happen when you type the function type in GHCi?</p>\n\n<pre><code>$ ghci\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; function3 :: Int -&gt; [Int]\n\n&lt;interactive&gt;:1:1: error:\n    Variable not in scope: function3 :: Int -&gt; [Int]\nPrelude&gt; \n</code></pre>\n\n<p>If it is the case, you have to use multiple line input</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| function3 :: Int -&gt; [Int]\nPrelude| function3 x = [a | a &lt;- [1..x], mod a x == 0]\nPrelude| :}\n</code></pre>\n\n<p>And noted <code>,</code> before <code>mod</code></p>\n\n<p>Alternatively, for better workflow, you can save your code to a file and load in GHCi using <a href=\"https://downloads.haskell.org/~ghc/7.8.2/docs/html/users_guide/loading-source-files.html\" rel=\"noreferrer\">:load</a></p>\n\n<pre><code>$ cat tmp/functions.hs \nfunction3 :: Int -&gt; [Int]\nfunction3 x = [a | a &lt;- [1..x], mod a x == 0]\n\n$ ghci\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :l tmp/functions.hs \n[1 of 1] Compiling Main             ( tmp/functions.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; :t function3 \nfunction3 :: Int -&gt; [Int]\n*Main&gt; \n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40985, "favorite_count": 8, "accepted_answer_id": 42105437, "answer_count": 1, "score": 15, "last_activity_date": 1524943028, "creation_date": 1486520850, "last_edit_date": 1524943028, "question_id": 42103627, "link": "https://stackoverflow.com/questions/42103627/error-haskell-not-in-scope-what-does-that-mean", "title": "Error haskell: not in scope. What does that mean?", "body": "<p>I started with Haskell today and all the functions I perform on ghci display this message. I just want to know why this is happening. \nI know there are a lot of questions about this, but this is a simple case and I need to understand this error in the beginning</p>\n\n<pre><code>function3 :: Int -&gt; [Int]\nfunction3 x = [a | a &lt;- [1..x] mod a x == 0]\n</code></pre>\n"}, {"tags": ["haskell", "dynamic-programming"], "comments": [{"owner": {"reputation": 7292, "user_id": 1276128, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Jat1U.jpg?s=128&g=1", "display_name": "Marko Gresak", "link": "https://stackoverflow.com/users/1276128/marko-gresak"}, "edited": false, "score": 2, "creation_date": 1486520431, "post_id": 42103544, "comment_id": 71377027, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3208258/memoization-in-haskell\">Memoization in Haskell?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 84, "user_id": 6011503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fed13a3f6da431b48ab3c0985e370b?s=128&d=identicon&r=PG&f=1", "display_name": "wei li", "link": "https://stackoverflow.com/users/6011503/wei-li"}, "edited": false, "score": 0, "creation_date": 1486526949, "post_id": 42104387, "comment_id": 71378610, "body": "got it, memoized_fib just like fibs = 1:1: zipWith (+) fibs (tail fibs), final result is a list. i have another problem, i only use fmap and head operation on list, why vector fast than list?"}, {"owner": {"reputation": 662, "user_id": 668354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yn84u.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/668354/mikkel"}, "reply_to_user": {"reputation": 84, "user_id": 6011503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fed13a3f6da431b48ab3c0985e370b?s=128&d=identicon&r=PG&f=1", "display_name": "wei li", "link": "https://stackoverflow.com/users/6011503/wei-li"}, "edited": false, "score": 0, "creation_date": 1486528754, "post_id": 42104387, "comment_id": 71379141, "body": "For <code>head</code> I don&#39;t think it makes a large, if any difference. AFAIK a vector keeps elements next to each other in memory where a linked list has pointers between elements, so any traversal e.g. <code>fmap</code> should be much faster on a <code>vector</code>."}, {"owner": {"reputation": 662, "user_id": 668354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yn84u.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/668354/mikkel"}, "reply_to_user": {"reputation": 84, "user_id": 6011503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fed13a3f6da431b48ab3c0985e370b?s=128&d=identicon&r=PG&f=1", "display_name": "wei li", "link": "https://stackoverflow.com/users/6011503/wei-li"}, "edited": false, "score": 0, "creation_date": 1491894245, "post_id": 42104387, "comment_id": 73740993, "body": "Just came across a good explanation of the difference in efficiency between lists and vectors at <a href=\"https://www.schoolofhaskell.com/user/commercial/content/vector#efficiency\" rel=\"nofollow noreferrer\">School of Haskell</a>"}], "tags": [], "owner": {"reputation": 662, "user_id": 668354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yn84u.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/668354/mikkel"}, "is_accepted": true, "score": 2, "last_activity_date": 1486526536, "last_edit_date": 1486526536, "creation_date": 1486526024, "answer_id": 42104387, "question_id": 42103544, "link": "https://stackoverflow.com/questions/42103544/haskell-how-to-archive-memorize/42104387#42104387", "title": "haskell how to archive memorize", "body": "<p>The <code>memoized_fib</code> works because it initially just creates a <code>thunk</code> out of <code>map fib [0..]</code> (this is laziness, call-by-need). On subsequent calls more and more <code>fib</code> values in the list are calculated and at the same time each call looks up a <code>fib</code> value by indexing into the list (!!).</p>\n\n<p>Without the list each call to <code>fib</code> would have made another two calls to <code>fib</code> which again would make two calls, etc. In algorithmic terms this changes <code>fib</code> from O(n^2) to O(n).</p>\n\n<p>Without having looked at the Project Euler problem I suggest you try with another data structure first. In your case you should probably try with <a href=\"https://hackage.haskell.org/package/vector\" rel=\"nofollow noreferrer\">vector</a> or perhaps <a href=\"https://hackage.haskell.org/package/array\" rel=\"nofollow noreferrer\">array</a>. Those are both much faster than list which you are currently using and which is actually a linked list.</p>\n\n<p>You might also gain a little bit from changing your board representation to <code>board :: [Int]</code>. We intuitively think of a board as having two dimensions, but it's quite easy to implement as a list rather than list of lists. (This I remember from a chapter in <a href=\"http://norvig.com/paip.html\" rel=\"nofollow noreferrer\">PAIP</a>)</p>\n\n<p>For other problems keep <a href=\"https://hackage.haskell.org/package/containers\" rel=\"nofollow noreferrer\">containers</a> and <a href=\"https://hackage.haskell.org/package/unordered-containers\" rel=\"nofollow noreferrer\">unordered-containers</a> in mind.</p>\n"}], "owner": {"reputation": 84, "user_id": 6011503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2fed13a3f6da431b48ab3c0985e370b?s=128&d=identicon&r=PG&f=1", "display_name": "wei li", "link": "https://stackoverflow.com/users/6011503/wei-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 42104387, "answer_count": 1, "score": 3, "last_activity_date": 1486526536, "creation_date": 1486520253, "question_id": 42103544, "link": "https://stackoverflow.com/questions/42103544/haskell-how-to-archive-memorize", "title": "haskell how to archive memorize", "body": "<p>I'm trying to solve #15 from Project Euler, this is my first solution\n    import Data.List</p>\n\n<pre><code>type Location = (Int,Int)\n\nboardX = 20\nboardY = 20\n\nstepBack :: Location -&gt; [Location]\nstepBack (x,y) = [(x-1,y), (x,y-1)]\n\nlegalStep :: Location -&gt; Bool\nlegalStep (x,y) = x &gt;= 0 &amp;&amp; y &gt;= 0\n\niteractStep :: Int -&gt; [[Location]]\niteractStep 0 = [[(boardX, boardY)]]\niteractStep n = [x:y|y &lt;- iteractStep (n-1), x&lt;- stepBack (head y),       legalStep x]\n\nmain :: IO ()\nmain = putStrLn $ show $ length $ iteractStep (boardX + boardY)\n</code></pre>\n\n<p>this is very slow, i find there are so many sub-problem re-computed, i try to memorize sub-problem answer, then i found this example:</p>\n\n<pre><code>  memoized_fib :: Int -&gt; Integer\n  memoized_fib = (map fib [0 ..] !!)\n    where fib 0 = 0\n          fib 1 = 1\n          fib n = memoized_fib (n-2) + memoized_fib (n-1)\n</code></pre>\n\n<p>i try it in ghci, i found it actually memorize sub-problem result, i can't understand how this code can memorize result, it looks like </p>\n\n<pre><code>map fib [0 ..] \n</code></pre>\n\n<p>is global, but i think it is method scope (only exists at every method call), why it can memorize result?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1284, "user_id": 1402585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/455cf7e9fb66b1fc270eba25c32ffd5a?s=128&d=identicon&r=PG", "display_name": "JustGage", "link": "https://stackoverflow.com/users/1402585/justgage"}, "edited": false, "score": 0, "creation_date": 1486512226, "post_id": 42102261, "comment_id": 71374775, "body": "This is a wild guess but laziness might be at work here?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1486515955, "post_id": 42102261, "comment_id": 71375862, "body": "I suggest that you post your edits as an answer."}, {"owner": {"reputation": 1008, "user_id": 2302508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/t3O8C.png?s=128&g=1", "display_name": "BlackCap", "link": "https://stackoverflow.com/users/2302508/blackcap"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486516063, "post_id": 42102261, "comment_id": 71375897, "body": "@duplode I agree, thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1008, "user_id": 2302508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/t3O8C.png?s=128&g=1", "display_name": "BlackCap", "link": "https://stackoverflow.com/users/2302508/blackcap"}, "edited": false, "score": 0, "creation_date": 1486513330, "post_id": 42102326, "comment_id": 71375103, "body": "@BlackCap Wow... I wasn&#39;t expecting that. Interesting."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1486512756, "last_edit_date": 1486512756, "creation_date": 1486512361, "answer_id": 42102326, "question_id": 42102261, "link": "https://stackoverflow.com/questions/42102261/managing-memory-usage-with-infinite-lists/42102326#42102326", "title": "Managing memory usage with infinite lists", "body": "<p>A top level binding like</p>\n\n<pre><code>list = [1..1000000]\n</code></pre>\n\n<p>will lazily produce the list once, and keep it in memory for subsequent use.</p>\n\n<p>A function, instead,</p>\n\n<pre><code>fun x = [1..1000000]\n</code></pre>\n\n<p>will allocate a new list at every call, recomputing it (lazily) from scratch every time. Because it's referred by a top level binding, it will never be garbage collected.</p>\n\n<p>Note that this is not mandated by Haskell -- it's just GHC which works in this way.</p>\n\n<p>For comparison, try this variant:</p>\n\n<pre><code>run x | v &lt;- each $ run x\n      = (x:) . concat $ transpose\n      [ runOmega $ liftM2 (/ ) v v\n      , runOmega $ liftM2 (- ) v v\n      , runOmega $ liftM2 (**) v v\n      ]\nrun15 = run 15\nmain = print . map snd . filter ((==5).fst) $ zip run15 [0..]\n</code></pre>\n\n<p>You should see a lot of memory being consumed, since no garbage collection can happen. Instead,</p>\n\n<pre><code>main = print . map snd . filter ((==5).fst) $ zip run15 [0..]\n   where \n   run15 = run 15\n</code></pre>\n\n<p>should allow for garbage collection and run in a small amount of memory.</p>\n\n<p>(By the way, that use of a pattern binding instead of let/where puzzled me for a while.)</p>\n"}, {"tags": [], "owner": {"reputation": 1008, "user_id": 2302508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/t3O8C.png?s=128&g=1", "display_name": "BlackCap", "link": "https://stackoverflow.com/users/2302508/blackcap"}, "is_accepted": false, "score": 2, "last_activity_date": 1486516030, "creation_date": 1486516030, "answer_id": 42102908, "question_id": 42102261, "link": "https://stackoverflow.com/questions/42102261/managing-memory-usage-with-infinite-lists/42102908#42102908", "title": "Managing memory usage with infinite lists", "body": "<p>@chi is exactly right. A function with no arguments is not really a function, and will be kept in memory, regardless of how recursive it is,  whether it produces an infinite datastructure or not. This will cause you to run out of memory:</p>\n\n<pre><code>run' | v &lt;- each run'\n     = (15:) . concat $ transpose\n     [ runOmega $ liftM2 (/ ) v v\n     , runOmega $ liftM2 (- ) v v\n     , runOmega $ liftM2 (**) v v\n     ]\n\nmain = print $\u00a0run' !! 1000000000\n</code></pre>\n\n<p>while the first <code>run</code> function will not. On the same note- despite looking silly- this will not run out of memory:</p>\n\n<pre><code>exprs' x | v &lt;- each $ exprs' x\n         = (x:) . concat $ transpose\n         [ runOmega $ liftM2 Div v v\n         , runOmega $ liftM2 Sub v v\n         , runOmega $ liftM2 Pow v v\n         ]\n\nmain = print $ exprs' X !! 1000000000\n</code></pre>\n\n<p><br></p>\n\n<h2>PS</h2>\n\n<p>If anyone is curious, the 118588079th element in the list was <code>((((x**x)/x)-(x**(x-(x/x))))-((x-x)-(x/x)))</code></p>\n"}], "owner": {"reputation": 1008, "user_id": 2302508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/t3O8C.png?s=128&g=1", "display_name": "BlackCap", "link": "https://stackoverflow.com/users/2302508/blackcap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 42102326, "answer_count": 2, "score": 2, "last_activity_date": 1486516030, "creation_date": 1486511885, "last_edit_date": 1486516008, "question_id": 42102261, "link": "https://stackoverflow.com/questions/42102261/managing-memory-usage-with-infinite-lists", "title": "Managing memory usage with infinite lists", "body": "<p>So I am trying to find ways to make the number 5 using the number 15</p>\n\n<pre><code>import Data.List\nimport Control.Monad\nimport Control.Monad.Omega\nimport System.IO\n\ndata Expr = X | Sub Expr Expr | Div Expr Expr | Pow Expr Expr\n          deriving Show\n\neval x X = x\neval x (Sub a b) = eval x a -  eval x b\neval x (Div a b) = eval x a /  eval x b\neval x (Pow a b) = eval x a ** eval x b\n\nexprs | v &lt;- each exprs\n      = (X:) . concat $ transpose\n      [ runOmega $ liftM2 Div v v\n      , runOmega $ liftM2 Sub v v\n      , runOmega $ liftM2 Pow v v\n      ]\n\nmain = do\n  hSetBuffering stdout LineBuffering\n  mapM_ print $ filter ((==5).eval 15) exprs\n</code></pre>\n\n<p>However, the first result is the 118588079th element in the list, and Haskell runs out of memory long before getting there. How do I know the first one is 118588079? Because if I just calculate it and ask for the index instead, Haskell uses no memory at all:</p>\n\n<pre><code>run x | v &lt;- each $ run x\n      = (x:) . concat $ transpose\n      [ runOmega $ liftM2 (/ ) v v\n      , runOmega $ liftM2 (- ) v v\n      , runOmega $ liftM2 (**) v v\n      ]\n\nmain = print . map snd . filter ((==5).fst) $ zip (run 15) [0..]\n</code></pre>\n\n<p>Where exactly is my memory going in the first case, and how do I get around it?</p>\n"}, {"tags": ["haskell", "github", "monads", "github-api", "yesod"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1486538049, "post_id": 42100899, "comment_id": 71382781, "body": "Instead of <code>possibleUser &lt;- GitHub.userInfoForR &quot;mike-burns&quot;</code> write <code>let possibleUser = GitHub.userInfoForR &quot;mike-burns&quot;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7531219"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1486561171, "post_id": 42100899, "comment_id": 71397862, "body": "Hi arrowd. That does indeed get rid of errors relating to the &quot;possibleUser&quot; line but then using that variable in the next &quot;result line causes the following error (perhaps I need to structure it with an &#39;in&#39;?):    <code>Handler&#47;Home.hs:49:59:</code>       <code>Couldn&#39;t match expected type \u2018Either a0 GitHub.User\u2019</code>                    <code>with actual type \u2018GitHub.Request k0 GitHub.User\u2019</code>       <code>In the third argument of \u2018either\u2019, namely \u2018possibleUser\u2019</code>       <code>In the expression:</code>         <code>either ((&quot;Error: &quot; &lt;&gt;) . tshow) formatUser possibleUser</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7531219"}, "edited": false, "score": 0, "creation_date": 1486561429, "post_id": 42111737, "comment_id": 71398037, "body": "Thanks for the advice but I&#39;m still not quite there. Although I think I understand the problem a bit more.  I pushed some new code with your suggestions <a href=\"https://github.com/StarStuffSteve/CS7009/blob/master/yesod_simple/project/Handler/Home.hs\" rel=\"nofollow noreferrer\">link</a>.  I am getting the following error <code>Handler&#47;Home.hs:26:18: Parse error in pattern: GitHub.userInfoForR</code>    What are we trying to pattern match here?    Again, my apologie for my general ignorance in this area."}, {"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 0, "creation_date": 1486587706, "post_id": 42111737, "comment_id": 71415130, "body": "What&#39;s on the left of the equal sign is pattern matched. You can&#39;t call a function there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7531219"}, "edited": false, "score": 0, "creation_date": 1486649847, "post_id": 42111737, "comment_id": 71444206, "body": "Is the second executeRequest&#39; type declaration you write meant to be the body of the function or is a body of the function not required?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7531219"}, "edited": false, "score": 0, "creation_date": 1486655202, "post_id": 42111737, "comment_id": 71448228, "body": "Turns out I was trying to use some pretty out of date sample code. The executeRequest approach you mentioned works fine."}], "tags": [], "owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "is_accepted": true, "score": 0, "last_activity_date": 1486552903, "creation_date": 1486552903, "answer_id": 42111737, "question_id": 42100899, "link": "https://stackoverflow.com/questions/42100899/yesod-using-github-api-v3-library-for-haskell/42111737#42111737", "title": "Yesod: Using Github API v3 Library for Haskell", "body": "<p>The GitHub library seems to be about building requests, and running them. The <code>userInfoForR</code> does such a thing :</p>\n\n<pre><code>userInfoForR :: Name User -&gt; Request k User\n</code></pre>\n\n<p>Once you have a request, you can run it with one of the following functions, depending if you need to authenticate or not:</p>\n\n<pre><code>executeRequest :: Auth -&gt; Request k a -&gt; IO (Either Error a)\nexecuteRequest' :: Request RO a -&gt; IO (Either Error a)\n</code></pre>\n\n<p>I don't know about this specific case, but let's say you don't need authentication. So, the following expression would do the trick:</p>\n\n<pre><code>executeRequest' (userInfoForR \"mike-burns\") :: IO (Either Error User)\n</code></pre>\n\n<p>Now, in order to use it in a <code>Handler</code>, you'll need to learn about the fact that <code>Handler</code> is an instance of <code>MonadIO</code>, and you can thus do:</p>\n\n<pre><code>euser &lt;- liftIO (executeRequest' (userInfoForR \"mike-burns\"))\ncase euser of\n    Left rr -&gt; ...\n    Right user -&gt; ...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7531219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 42111737, "answer_count": 1, "score": 0, "last_activity_date": 1486552903, "creation_date": 1486505114, "last_edit_date": 1486505260, "question_id": 42100899, "link": "https://stackoverflow.com/questions/42100899/yesod-using-github-api-v3-library-for-haskell", "title": "Yesod: Using Github API v3 Library for Haskell", "body": "<p>I'm working on a project that builds on the simple yesod template. I am new to functional programming, haskell and Yesod so it's probably something obvious to anyone with Yesod experience. At the moment I am trying to make github API calls using this <a href=\"https://github.com/phadej/github\" rel=\"nofollow noreferrer\">library</a>. I am getting some type issues and I'm not even sure how to start approaching solving them.</p>\n\n<p>You can find my handler <a href=\"https://github.com/StarStuffSteve/CS7009/blob/master/yesod_simple/project/Handler/Home.hs\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<pre><code>   Handler/Home.hs:43:19:\n    Couldn't match expected type \u2018HandlerT\n                                    App IO (Either a0 GitHub.User)\u2019\n                with actual type \u2018GitHub.Request k0 GitHub.User\u2019\n    In a stmt of a 'do' block:\n      possibleUser &lt;- GitHub.userInfoForR \"mike-burns\"\n    In the expression:\n      do { maid &lt;- maybeAuthId;\n           possibleUser &lt;- GitHub.userInfoForR \"mike-burns\";\n           result &lt;- either ((\"Error: \" &lt;&gt;) . tshow) formatUser possibleUser;\n           defaultLayout\n             (do { (asWidgetT GHC.Base.. toWidget)\n                     ((blaze-markup-0.7.1.1:Text.Blaze.Internal.preEscapedText\n                       GHC.Base.. Data.Text.pack)\n                        \"&lt;p&gt;Your current auth ID: \");\n                   (asWidgetT GHC.Base.. toWidget) (toHtml (show maid));\n                   (asWidgetT GHC.Base.. toWidget)\n                     ((blaze-markup-0.7.1.1:Text.Blaze.Internal.preEscapedText\n                       GHC.Base.. Data.Text.pack)\n                        \"&lt;/p&gt;\\n\");\n                   .... }) }\n\n\n   Handler/Home.hs:44:38:\n    Couldn't match type \u2018Text\u2019 with \u2018HandlerT App IO a1\u2019\n    Expected type: a0 -&gt; HandlerT App IO a1\n      Actual type: a0 -&gt; Text\n    In the second argument of \u2018(.)\u2019, namely \u2018tshow\u2019\n    In the first argument of \u2018either\u2019, namely\n      \u2018((\"Error: \" &lt;&gt;) . tshow)\u2019\n\n\n   Handler/Home.hs:44:45:\n    Couldn't match type \u2018Text\u2019 with \u2018HandlerT App IO a1\u2019\n    Expected type: GitHub.User -&gt; HandlerT App IO a1\n      Actual type: GitHub.User -&gt; Text\n    In the second argument of \u2018either\u2019, namely \u2018formatUser\u2019\n    In a stmt of a 'do' block:\n      result &lt;- either ((\"Error: \" &lt;&gt;) . tshow) formatUser possibleUser\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486503512, "post_id": 42100206, "comment_id": 71371145, "body": "The documentation only says that you can <i>use</i> <code>&lt;&gt;</code>; it doesn&#39;t say that you can import it from <code>Options.Applicative</code>."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 7, "last_activity_date": 1486503433, "creation_date": 1486503433, "answer_id": 42100466, "question_id": 42100206, "link": "https://stackoverflow.com/questions/42100206/options-applicative-and-the-monoid-type-class/42100466#42100466", "title": "Options.Applicative, (&lt;&gt;) and the Monoid type class", "body": "<p><code>(&lt;&gt;)</code> is in <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#v:-60--62-\">Data.Monoid</a>, not Options.Applicative. It's an infix synonym for <code>mappend</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 7, "last_activity_date": 1486503602, "creation_date": 1486503602, "answer_id": 42100512, "question_id": 42100206, "link": "https://stackoverflow.com/questions/42100206/options-applicative-and-the-monoid-type-class/42100512#42100512", "title": "Options.Applicative, (&lt;&gt;) and the Monoid type class", "body": "<p>You need to import <code>(&lt;&gt;)</code> from either <code>Data.Monoid</code> or <code>Data.Semigroup</code>, as <a href=\"http://hackage.haskell.org/package/optparse-applicative-0.13.0.0/docs/Options-Applicative.html\"><code>Options.Applicative</code> doesn't actually re-export it</a>. A quick way to verify that is checking <a href=\"http://hackage.haskell.org/package/optparse-applicative-0.13.0.0/docs/doc-index-60.html\">the \"&lt;\" page in the documentation index</a>, which would include <code>(&lt;&gt;)</code> if it was re-exported.</p>\n\n<p>P.S.: While the readme currently on Hackage is slightly misleading indeed, the missing import was already <a href=\"https://github.com/pcapriotti/optparse-applicative/commit/23f15d262fede5a3a0fe9c25808719b811275df0#diff-04c6e90faac2675aa89e2176d2eec7d8\">added upstream at GitHub</a>, and so it will be fixed when the next version of the package is released.</p>\n"}], "owner": {"reputation": 43, "user_id": 3805839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc5870b29d4d4db1220efe702c7b097?s=128&d=identicon&r=PG&f=1", "display_name": "user3805839", "link": "https://stackoverflow.com/users/3805839/user3805839"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 42100512, "answer_count": 2, "score": 4, "last_activity_date": 1486512901, "creation_date": 1486502401, "last_edit_date": 1486512901, "question_id": 42100206, "link": "https://stackoverflow.com/questions/42100206/options-applicative-and-the-monoid-type-class", "title": "Options.Applicative, (&lt;&gt;) and the Monoid type class", "body": "<p>I am learning about Haskell. I am importing the <code>Options.Applicative</code> module, like so:</p>\n\n<pre><code>import Options.Applicative ((&lt;&gt;), Parser)\nimport qualified Options.Applicative as P\n</code></pre>\n\n<p>However, this returns</p>\n\n<pre><code>Module \u2018Options.Applicative\u2019 does not export \u2018(&lt;&gt;)\u2019\n</code></pre>\n\n<p>What is wrong with this? This <a href=\"https://hackage.haskell.org/package/optparse-applicative\" rel=\"nofollow noreferrer\">documentation</a> suggests this should be possible.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1486497449, "post_id": 42098789, "comment_id": 71367926, "body": "Well the error is clear: if you construct a new <code>Phonebook</code> in the shell, <code>ghci</code> wants to <code>print</code> the book, but it does not know how since <code>Name -&gt; Number</code> is a function and it asks you to define an <code>instance Show</code> to print it."}, {"owner": {"reputation": 1030, "user_id": 521806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PaOw7.jpg?s=128&g=1", "display_name": "Juan Pablo Santos", "link": "https://stackoverflow.com/users/521806/juan-pablo-santos"}, "edited": false, "score": 0, "creation_date": 1486497866, "post_id": 42098789, "comment_id": 71368158, "body": "This looks like homework."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486497962, "post_id": 42098789, "comment_id": 71368210, "body": "The <code>print</code> function doesn&#39;t appear in your code."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1486497994, "post_id": 42098789, "comment_id": 71368228, "body": "@chepner: I think he runs it in <code>ghci</code> and <code>ghci</code> aims to print the result of a <code>fillIn</code> call and thus fails to print it."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1486505969, "post_id": 42098789, "comment_id": 71372410, "body": "@DanielWagner There&#39;s actually a few. If you search &quot;Phonebook Haskell&quot; (capital P required), a solid list comes up. I not sure which is the best to close as a dupe as. They&#39;ll all basically the same"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1486506998, "post_id": 42098789, "comment_id": 71372886, "body": "@DanielWagner I should have specified. This homework question has been asked a few times before. It&#39;s not necessarily the same question the OP has though. Sorry, wasn&#39;t paying attention"}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486507661, "post_id": 42098962, "comment_id": 71373168, "body": "Worth noting that <a href=\"https://wiki.haskell.org/Difference_list\" rel=\"nofollow noreferrer\">difference lists</a> use a similar idea, using continuation passing style to build up a function recursively. <code>append item continuation = \\rest -&gt; continuation (item:rest)</code>. In that case you first build up all these append operations into one large function before applying them in one go which lets you append n items in O(n) instead of O(n^2)!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486507900, "post_id": 42098962, "comment_id": 71373293, "body": "@Taren: I don&#39;t really see the relevance of this comment here. We do not append nor apply any functin to a list since this is not a list (but a function). I know what a difference list is: I&#39;ve written <a href=\"http://stackoverflow.com/search?q=user%3A67579+difference+lists\">four answers</a> on them. They are useful for for instance grammar parsing. But in what way are they relevant here?"}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486508858, "post_id": 42098962, "comment_id": 71373691, "body": "Sorry, I wasn&#39;t trying to insinuate that you didn&#39;t know about them. I just figured that the exercise probably was a play on them since it also involves transforming data into a function using cps. I also find them really cool from a conceptual standpoint and thought that some people confused by the fillin function might not have heard about them yet."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486508998, "post_id": 42098962, "comment_id": 71373753, "body": "@Taren: it was not the point that your comment was (it wasn&#39;t) insulting. Indeed difference lists are a cool mechanism in both functional and logic programming. The point is however that one can write a 500-pages textbook on everything you can do with functions and lists, etc :). Although these are cool, they are not really relevant to <i>this</i> question specifically as far as I know :)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1486497928, "creation_date": 1486497928, "answer_id": 42098962, "question_id": 42098789, "link": "https://stackoverflow.com/questions/42098789/telephonebook-in-haskell/42098962#42098962", "title": "Telephonebook in Haskell", "body": "<p>The <code>\\add -&gt; ...</code> is a <strong>lambda expression</strong>. A lambda expression is an anonymous function that here takes one argument <code>add</code> and maps it on <code>...</code> (here <code>if name == add then number else book add</code>). You could have given the poor child a name (for instance <code>newbook</code>) and write it like:</p>\n\n<pre><code>fillIn :: Name -&gt; Number -&gt; Phonebook -&gt; Phonebook\nfillIn name number book = newbook\n    where newbook add = if name == add then number else book add\n</code></pre>\n\n<p>or more elegantly:</p>\n\n<pre><code>fillIn :: Name -&gt; Number -&gt; Phonebook -&gt; Phonebook\nfillIn name number book = newbook\n    where newbook add | name == add = number\n                      | otherwise = book add\n</code></pre>\n\n<p>Now the <code>add</code> is a bit confusing, a better name would be <code>query</code> I guess, since the new phone book <code>newbook</code> takes as input a query and aims to find a phone number.</p>\n\n<p>The function is thus given a new <code>name</code> and <code>number</code> and an old <code>book</code>. It constructs a new phone book <code>newbook</code> that, when queried first checks whether the query corresponds to our newborn <code>name</code> and if that is the case returns his <code>number</code>, and otherwise will pass the query to the <code>book</code> (the old phone book) and lets figure it out by that book.</p>\n\n<p>Your <code>emptyPhonebook</code> of course has no numbers so regardless of what query you give it, it returns <code>\"not found\"</code>.</p>\n\n<p>The reason Haskell cannot <code>print</code> the phonebook, is because it does not know how. In order to print an object, it has to be an instance of <code>Show</code> (and thus implement the <code>show</code> function.</p>\n\n<p>On the other hand I don't know if it is wise to represent a phone book as a function mapping names on numbers, since perhaps you want to find the stalker that once tried to contact you (and thus make a reverse lookup). Perhaps a better way here is to use a list of tuples <code>[(Name,Number)]</code>, or even better use hashtables.</p>\n"}], "owner": {"reputation": 39, "user_id": 7459555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01f706aa3dd7c61ccafb02075137425a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyrill96", "link": "https://stackoverflow.com/users/7459555/kyrill96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1486497963, "creation_date": 1486497273, "last_edit_date": 1486497963, "question_id": 42098789, "link": "https://stackoverflow.com/questions/42098789/telephonebook-in-haskell", "title": "Telephonebook in Haskell", "body": "<p>I have this code here:</p>\n\n<pre><code>type Name = String\ntype Number = String\ntype Phonebook = Name -&gt; Number\n\nemptyPhonebook :: Phonebook \nemptyPhonebook = \\x -&gt; \"not found\"\n\nfillIn :: Name -&gt; Number -&gt; Phonebook -&gt; Phonebook \nfillIn name number book = \\add -&gt; if name == add then number else book add\n</code></pre>\n\n<p>My question is, what exactly is meant with the <code>\\add</code> in the <code>fillIn</code> function and how exactly does the whole line in this function work? </p>\n\n<p>When I'm running the code and try to run one of the functions i get the error: </p>\n\n<pre><code>No instance for (Show Phonebook) arising from a use of `print'\n</code></pre>\n\n<p>How to change that?</p>\n"}, {"tags": ["pointers", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1486495145, "post_id": 42098077, "comment_id": 71366642, "body": "I&#39;m not really sure what you&#39;re asking."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1486495210, "post_id": 42098077, "comment_id": 71366687, "body": "@bheklilr: I think the OP wants to know if some sort of singleton is used to reduce the memory burden. In other words if there are 500 <code>Empty</code> objects, are these are references to the same."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1486495533, "post_id": 42098077, "comment_id": 71366891, "body": "Apparently, but the very notion of distinct equal objects doesn&#39;t really make sense in Haskell. Generally speaking, there is no requirement for <i>any</i> \u201cobjects\u201d to ever occur in the program at all, just the result needs to be equivalent. But the actual result value of a function will often be inlined, there is no actual object on the heap there, and for a information-less constructor like <code>Empty</code> this would be wasteful too. In actual memory, I reckon the result will be just a single int on the stack, representing either a fixed value that means <code>Empty</code> by convention, or a pointer to <code>Full</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1486495608, "post_id": 42098077, "comment_id": 71366937, "body": "@leftaroundabout <code>Empty</code> is not informationless, for the same reason <code>False</code> and <code>True</code> contain information."}, {"owner": {"reputation": 6233, "user_id": 1143013, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/18b2043f1470f68ff6e223e7f48c0cd7?s=128&d=identicon&r=PG", "display_name": "raam86", "link": "https://stackoverflow.com/users/1143013/raam86"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1486497488, "post_id": 42098077, "comment_id": 71367953, "body": "@leftaroundabout thank you, this is the information I was looking for, I hoped this question will have a very different answer than C or Java"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1486495395, "post_id": 42098174, "comment_id": 71366810, "body": "In fact, I <i>think</i> nullary constructors are even shared across types (not just across parameterizations), though I&#39;m not confident enough of that fact to put it in my answer. e.g. I think <code>False</code> and <code>[]</code> and <code>Nothing</code> are all the same."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1486495692, "post_id": 42098174, "comment_id": 71366985, "body": "If that were true, wouldn&#39;t False and True also be the same? That doesn&#39;t seem right; there has to be a tag still to identify <i>which</i> nullary constructor was used. But after the tag, i can imagine that they all point to the same informationless &quot;object&quot; payload."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1486495733, "post_id": 42098174, "comment_id": 71367012, "body": "@amalloy No; but <code>True</code> and <code>&#39;\\1&#39;</code> might be the same."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1486495745, "post_id": 42098174, "comment_id": 71367021, "body": "Apparently you can&#39;t rely on the same nullary constructor being the same pointer: <a href=\"http://stackoverflow.com/a/24602066/1013393\">stackoverflow.com/a/24602066/1013393</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 2, "creation_date": 1486496214, "post_id": 42098174, "comment_id": 71367271, "body": "@sjakobi Fascinating. Answer fixed! I struck out the wrong part of my old answer to emphasize that this part is wrong (I wanted to emphasize it because I suspect I may not be the only person with this wrong belief!)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1486498106, "post_id": 42098174, "comment_id": 71368292, "body": "@DanielWagner You&#39;re not wrong, you&#39;re just missing a nuance. Because of laziness, two suspended computations that yield the same nullary value may be represented by pointers to different thunks. After you force the computations the resulting values will indeed be shared"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1486499510, "post_id": 42098174, "comment_id": 71369025, "body": "What @BenjaminHodgson said. I think that text being crossed out is more misleading than it was originally."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1486502680, "post_id": 42098174, "comment_id": 71370723, "body": "@BenjaminHodgson Now that I think the discussion on the linked answer has concluded, let me summarize: forcing the computation is not enough. It must be forced <i>and</i> a GC must be performed. So there will be times indeed where a program can have many copies of a nullary constructor (presumably with different closure environments but the same code or something like that). I was not missing nuance -- sjakobi was correct to make me change my answer!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1486502738, "post_id": 42098174, "comment_id": 71370750, "body": "@ReidBarton It turns out what BenjaminHodgson said was not correct! See the discussion on the linked answer for more details. The crossed out text will stay crossed out: it is not correct. The fact that it can fool even seasoned Haskellers like you and I is exactly why I left it visible: to bring awareness to the fact that the claim is fragile and not quite right."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1486508427, "post_id": 42098174, "comment_id": 71373511, "body": "It&#39;s still not incorrect. The thunk <code>a</code> isn&#39;t &quot;a copy of a nullary constructor&quot;, it&#39;s an indirection that was left behind by the evaluation of a thunk. GHC won&#39;t ever allocate an <code>Empty</code> constructor; it uses the one that was compiled into the library. Why would it ever do otherwise?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1486514151, "post_id": 42098174, "comment_id": 71375330, "body": "@ReidBarton Perhaps it won&#39;t allocate a new <code>Empty</code> constructor; but it has definitely allocated some space for an object that acts just like the <code>Empty</code> constructor. I think it&#39;s worth bringing attention to that; glossing over it could give the misleading impression that no space is wasted/allocated, which I think is part of the essence of the question being asked."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1486519456, "post_id": 42098174, "comment_id": 71376805, "body": "The space was allocated for the thunk, and then overwritten with an indirection to the static <code>Empty</code> constructor."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1486496194, "last_edit_date": 1486496194, "creation_date": 1486495207, "answer_id": 42098174, "question_id": 42098077, "link": "https://stackoverflow.com/questions/42098077/is-the-same-empty-returned-when-it-matched-in-a-function/42098174#42098174", "title": "Is the same Empty returned when it matched in a function?", "body": "<p>There is nothing in Haskell that lets you observe whether the two <code>Empty</code>s are <em>the same</em> <code>Empty</code> or not, and no guarantees about what an implementation must do with that code in that regard.</p>\n\n<p><s>That said, in GHC, nullary constructors for a given parameterized type are shared across all parameterizations; so there is just one <code>Empty</code> in the whole program, and just one <code>[]</code>, and so forth.</s></p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1486497193, "post_id": 42098648, "comment_id": 71367801, "body": "Well-typed programs can&#39;t go wrong. But that doesn&#39;t mean that ill-typed programs <i>must</i> go wrong. So this claim (not well-typed, therefore the implementation can&#39;t work that way) doesn&#39;t seem quite right to me."}, {"owner": {"reputation": 6233, "user_id": 1143013, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/18b2043f1470f68ff6e223e7f48c0cd7?s=128&d=identicon&r=PG", "display_name": "raam86", "link": "https://stackoverflow.com/users/1143013/raam86"}, "edited": false, "score": 0, "creation_date": 1486497560, "post_id": 42098648, "comment_id": 71367994, "body": "Nice way to illuminate the actual difference between the two values, I was looking for these kind of explanations too"}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "reply_to_user": {"reputation": 6233, "user_id": 1143013, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/18b2043f1470f68ff6e223e7f48c0cd7?s=128&d=identicon&r=PG", "display_name": "raam86", "link": "https://stackoverflow.com/users/1143013/raam86"}, "edited": false, "score": 0, "creation_date": 1486498783, "post_id": 42098648, "comment_id": 71368652, "body": "@raam86. Thanks. Yes, semantically they are not the same thing. However, as Daniel points out, what is actually going on in memory is another matter. I&#39;ll leave the answer as it is, but I think you get the caveat&#39;s that go along with it."}], "tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": false, "score": 2, "last_activity_date": 1486496808, "creation_date": 1486496808, "answer_id": 42098648, "question_id": 42098077, "link": "https://stackoverflow.com/questions/42098077/is-the-same-empty-returned-when-it-matched-in-a-function/42098648#42098648", "title": "Is the same Empty returned when it matched in a function?", "body": "<p>They can't be the same Empty, the argument has the type <code>Optional a</code> and the output has the type <code>Optional b</code>. When I try to force some sort of reuse, I will typically use something of the type </p>\n\n<pre><code>mapOptional _ a@Empty    = a\n</code></pre>\n\n<p>This won't compile, and I don't think that's implementation dependent. </p>\n"}], "owner": {"reputation": 6233, "user_id": 1143013, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/18b2043f1470f68ff6e223e7f48c0cd7?s=128&d=identicon&r=PG", "display_name": "raam86", "link": "https://stackoverflow.com/users/1143013/raam86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1486496808, "creation_date": 1486494848, "question_id": 42098077, "link": "https://stackoverflow.com/questions/42098077/is-the-same-empty-returned-when-it-matched-in-a-function", "title": "Is the same Empty returned when it matched in a function?", "body": "<p>we have mapOptional from the <a href=\"https://github.com/NICTA/course\">NICTA</a> course:</p>\n\n<pre><code>mapOptional :: (a -&gt; b) -&gt; Optional a -&gt; Optional b\nmapOptional _ Empty    = Empty\nmapOptional f (Full a) = Full (f a)\n</code></pre>\n\n<p>When matching <code>f</code> we obviously use <em>that</em> function that was passed, what about the <code>Empty</code>? and what about <code>Full</code>?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486488193, "post_id": 42096008, "comment_id": 71362712, "body": "Just to be sure: is <a href=\"https://hackage.haskell.org/package/tables-0.4.1.1/docs/Data-Table.html\" rel=\"nofollow noreferrer\">this</a> the <code>Table</code> type you are using?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1486493410, "post_id": 42096008, "comment_id": 71365687, "body": "I remember <code>Table</code> from a previous homework problem posted. I think it&#39;s just an association list, maybe a previous homework assignment to implement it."}, {"owner": {"reputation": 33, "user_id": 7530121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deeeb24f64d75924c74fb68ff930d9be?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo DM", "link": "https://stackoverflow.com/users/7530121/ricardo-dm"}, "edited": false, "score": 0, "creation_date": 1486509730, "post_id": 42096008, "comment_id": 71373993, "body": "newtype Table a b = T [(a,b)]"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 7131301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95feecfe61cbcdf86514a34cdc248623?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas By", "link": "https://stackoverflow.com/users/7131301/tomas-by"}, "is_accepted": false, "score": 1, "last_activity_date": 1486489283, "creation_date": 1486489283, "answer_id": 42096444, "question_id": 42096008, "link": "https://stackoverflow.com/questions/42096008/count-the-instances-of-char-in-a-string-in-a-recursive-function/42096444#42096444", "title": "Count the instances of Char in a String in a recursive function", "body": "<p>I don't seem to have a \"Table\" module (in GHC).</p>\n\n<p>Your code looks odd: you seem to loop over the all the chars and then try to loop again when counting (but only over the tail of the list).</p>\n\n<p>There is a \"count\" function in the Table module linked in the other comment.</p>\n\n<p>You should probably do something like</p>\n\n<pre><code>Table.insert table x ((count table x) + 1)\n</code></pre>\n\n<p>and remove your \"count\" function.</p>\n\n<p>Addition: you also need to handle the first occurrence of a char in the table.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 7518738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7b03512c741b0d19d0717486edb15f?s=128&d=identicon&r=PG&f=1", "display_name": "fjarino", "link": "https://stackoverflow.com/users/7518738/fjarino"}, "is_accepted": false, "score": 1, "last_activity_date": 1486494333, "creation_date": 1486494333, "answer_id": 42097909, "question_id": 42096008, "link": "https://stackoverflow.com/questions/42096008/count-the-instances-of-char-in-a-string-in-a-recursive-function/42097909#42097909", "title": "Count the instances of Char in a String in a recursive function", "body": "<p>Your Table looks a lot like a Map. So, if you can use Maps you could try the following:</p>\n\n<pre><code>import qualified Data.Map as M\n\ncharacterCounts :: [Char] -&gt; M.Map Char Int\ncharacterCounts = foldr ((flip $ M.insertWith (+)) 1) M.empty\n</code></pre>\n\n<p>Now, <code>characterCounts \"atraa\"</code> returns <code>fromList [('a',3),('r',1),('t',1)]</code>, i.e. a <code>Map Char Int</code> similar to the <code>Table Char Int</code> you are asking for. It should be easy to implement a conversion, if needed.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7530121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deeeb24f64d75924c74fb68ff930d9be?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo DM", "link": "https://stackoverflow.com/users/7530121/ricardo-dm"}, "edited": false, "score": 0, "creation_date": 1486511801, "post_id": 42101919, "comment_id": 71374643, "body": "Bingo! I was thinking of recursion backwardsly!"}], "tags": [], "owner": {"reputation": 201, "user_id": 7530714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0086b2237d1ccadf46971001dc048f9?s=128&d=identicon&r=PG&f=1", "display_name": "shortmanikos", "link": "https://stackoverflow.com/users/7530714/shortmanikos"}, "is_accepted": false, "score": 1, "last_activity_date": 1486510048, "creation_date": 1486510048, "answer_id": 42101919, "question_id": 42096008, "link": "https://stackoverflow.com/questions/42096008/count-the-instances-of-char-in-a-string-in-a-recursive-function/42101919#42101919", "title": "Count the instances of Char in a String in a recursive function", "body": "<p>When you call characterCountsAux xs _ you are giving your function the remainder of the list. That means that on the 4th iteration you are calling</p>\n\n<pre><code>characterCountsAux \"aa\" T [('a',3),('t',1),('r',1)]\n</code></pre>\n\n<p>which changes the table to T [('a',2),('t',1),('r',1)] and on the next iteration we have</p>\n\n<pre><code>characterCountsAux \"a\" T [('a',2),('t',1),('r',1)]\n</code></pre>\n\n<p>which gives you the final T[('a',1),('t',1),('r',1)].</p>\n\n<p>A naive solution would be removing all occurrences of x from xs i.e.</p>\n\n<pre><code>characterCountsAux (x:xs) table = characterCountsAux (filter (/= x) xs) (Table.insert (table) x (count x (x:xs) ))\n</code></pre>\n\n<p>Of course it doesn't look very efficient...</p>\n"}], "owner": {"reputation": 33, "user_id": 7530121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deeeb24f64d75924c74fb68ff930d9be?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo DM", "link": "https://stackoverflow.com/users/7530121/ricardo-dm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1486510048, "creation_date": 1486487788, "last_edit_date": 1486487950, "question_id": 42096008, "link": "https://stackoverflow.com/questions/42096008/count-the-instances-of-char-in-a-string-in-a-recursive-function", "title": "Count the instances of Char in a String in a recursive function", "body": "<p>I am trying to count the number of characters in a string coupled with a recursive function but it does not seem to be working.</p>\n\n<pre><code>{- characterCounts s\n   PRE:  True\nPOST: a table that maps each character that occurs in s to the number of\n     times the character occurs in s\nEXAMPLES:\n -}\ncharacterCounts :: String -&gt; Table Char Int\ncharacterCounts [] = Table.empty\ncharacterCounts s = characterCountsAux s Table.empty\n\ncharacterCountsAux:: String -&gt; Table Char Int -&gt; Table Char Int\ncharacterCountsAux [] table = table\ncharacterCountsAux (x:xs) table = characterCountsAux xs (Table.insert (table) x (count x (x:xs) ))\n\n\ncount:: Char -&gt; String -&gt; Int\ncount c s = length $ filter (==c) s\n</code></pre>\n\n<p>so in case I do: <code>characterCounts \"atraa\"</code> I should get <code>T [('a',3),('t',1),('r',1)]</code> but instead I get <code>T [('a',1),('t',1),('r',1)]</code>. </p>\n\n<p>Suggestions will be appreciated. </p>\n"}, {"tags": ["function", "haskell", "composition"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486485619, "post_id": 42095100, "comment_id": 71360902, "body": "Iirc, composure requires the function to only accept 1 argument. The binary operators each take 2"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486485656, "post_id": 42095100, "comment_id": 71360929, "body": "And why not just fold over the list using <code>+</code>?"}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486485660, "post_id": 42095100, "comment_id": 71360932, "body": "@Carcigenicate hmm, that&#39;s strange. I wouldn&#39;t have expected that to be the case. Is there any way to do it though? - edit: and what&#39;s fold, and what list?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486486067, "post_id": 42095100, "comment_id": 71361234, "body": "@theonlygusti: a list is a type <code>[a]</code>. <code>foldl</code> runs a function over the elements of a list so if you give <code>(+)</code> as function, <code>foldl (+) 0 ls</code> will return <code>0+ls!!0+ls!!1+...+ls!!n</code> (but more efficient than using <code>(!!)</code>)."}, {"owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486486148, "post_id": 42095100, "comment_id": 71361299, "body": "@WillemVanOnsem I know what a list is, I just don&#39;t get where Carcigenicate is seeing a list within my code"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486486905, "post_id": 42095100, "comment_id": 71361823, "body": "@theonlygusti It looks like you&#39;re just trying to add a series of numbers, so putting them in a list and summing them seemed like an easy solution."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1486486598, "last_edit_date": 1486486598, "creation_date": 1486486267, "answer_id": 42095524, "question_id": 42095100, "link": "https://stackoverflow.com/questions/42095100/chain-the-addition-operator-into-a-function-that-accepts-3-arguments/42095524#42095524", "title": "&quot;chain&quot; the addition operator into a function that accepts 3 arguments?", "body": "<p>Although this introduces some noise, you could use <code>uncurry :: (a -&gt; b -&gt; c) -&gt; (a,b) -&gt; c</code> and <code>curry :: ((a,b) -&gt; c) -&gt; a -&gt; b -&gt; c</code> to temporary store the arguments of the second plus in one tuple:</p>\n\n<pre><code>curry $ (+) . uncurry (+) :: Num a =&gt; a -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>or perhaps more semantically readable:</p>\n\n<pre><code>curry ((+) . uncurry (+)) :: Num a =&gt; a -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p><code>uncurry</code> thus takes a function (here <code>(+)</code>) and transforms it into a function: <code>uncurry (+) :: Num a =&gt; (a,a) -&gt; a</code>. So as a result you have transformed the <code>(+)</code> into a <strong>function that takes a tuple</strong>.</p>\n\n<p>Now we can use <code>(.)</code> to make a composition with the first <code>(+)</code>:</p>\n\n<pre><code>(+) . uncurry (+) :: Num a =&gt; (a,a) -&gt; (a -&gt; a)\n</code></pre>\n\n<p>So now we have a function that takes one argument (the tuple <code>(a,a)</code>) and produces a function that takes an <code>a</code> (the second operand of the first <code>(+)</code>) and calculates the sum. The problem is of course that we want to get rid of the tuple. We can do so by passing the function into a <code>curry</code>. That transforms the tuple-function (<code>(a,a) -&gt; (a -&gt; a)</code>) into a function taking the arguments separately (<code>a -&gt; (a -&gt; (a -&gt; a))</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1486487475, "post_id": 42095530, "comment_id": 71362196, "body": "It would be illustrative to analyze the working of <code>((+) .) . (+)</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 11, "last_activity_date": 1486491741, "last_edit_date": 1486491741, "creation_date": 1486486289, "answer_id": 42095530, "question_id": 42095100, "link": "https://stackoverflow.com/questions/42095100/chain-the-addition-operator-into-a-function-that-accepts-3-arguments/42095530#42095530", "title": "&quot;chain&quot; the addition operator into a function that accepts 3 arguments?", "body": "<p><a href=\"http://pointfree.io\">http://pointfree.io</a> gives the point-free version of <code>\\a b c -&gt; a + b + c</code> as <code>((+) .) . (+)</code>.</p>\n\n<p>Informally, composition only works \"intuitively\" for first-order functions, which neither take functions as arguments nor return functions as values. <code>(+)</code> is a higher-order function; it takes a value of type <code>Num a =&gt; a</code>, and returns a function of type <code>Num a =&gt; a -&gt; a</code>. When you try to compose higher-order functions in a naive fashion, the result is not what you expect:</p>\n\n<pre><code>:t (+) . (+)\n(+) . (+) :: (Num a, Num (a -&gt; a)) =&gt; a -&gt; (a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n\n<p>Consider the definitions of the two functions:</p>\n\n<pre><code>(+) :: Num z =&gt; z -&gt; z -&gt; z\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\nf . g = \\x -&gt; f (g x)\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>(+) . (+) == (.) (+) (+)\n          == \\x -&gt; (+) ((+) x)\n</code></pre>\n\n<p>Because of currying, you wind up passing a function, not a number, as the first argument of the first <code>(+)</code>.</p>\n\n<hr>\n\n<p>So how do we get from <code>h a b c = a + b + c</code> to <code>h = ((+) .) . (+)</code>? Start by rewriting the infix expression as a prefix expression, using the fact that <code>(+)</code> is left-associative.</p>\n\n<pre><code>\\a b c -&gt; a + b + c\n     == \\a b c -&gt; ((+) a b ) + c\n     == \\a b c -&gt; (+) ((+) a b) c\n</code></pre>\n\n<p>Next, we alternately apply eta conversion to eliminate an argument and composition to move an argument into position to be eliminated. I've tried to be very explicit about identifying the functions use for the application of composition.</p>\n\n<pre><code>     == \\a b -&gt; (+) ((+) a b)      -- eta conversion to eliminate c\n     == \\a b -&gt; (+) (((+) a) b)    -- parentheses justified by currying\n     --          f      g          -- f = (+), g = ((+) a)\n     -- \\a b -&gt;  f  (   g    b)\n     -- \\a b -&gt; (f   .  g)   b     -- definition of (.)\n     == \\a b -&gt; ((+) . ((+) a)) b\n     == \\a -&gt; (+) . ((+) a)        -- eta conversion to eliminate b\n     == \\a -&gt; (.) (+) ((+) a)      -- prefix notation\n     == \\a -&gt; ((.) (+)) ((+) a)    -- parentheses justified by currying\n     == \\a -&gt; ((+) . )((+) a)      -- back to a section of (.)\n     --           f       g        -- f = ((+) .), g = (+)\n     -- \\a -&gt;     f     (g a)\n     -- \\a -&gt; (   f   .   g) a     -- definition of (.)\n     == \\a -&gt; (((+) .) . (+)) a\n     == ((+) .) . (+)              -- eta conversion to eliminate a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486486971, "post_id": 42095698, "comment_id": 71361863, "body": "I think you should write <code>foldr (+) 0 nums</code> (with brackets) and <code>=</code> instead of <code>::</code> in the assignment. It is usually also more memory efficient to use <code>foldl</code> over <code>foldr</code> given the function is commutative."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486487059, "post_id": 42095698, "comment_id": 71361935, "body": "@WillemVanOnsem Whoops. Idk how I ended up using colons in place of a equals. And thanks, I&#39;ll change the fold."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486487140, "post_id": 42095698, "comment_id": 71361989, "body": "you still need to put brackets over <code>(+)</code> otherwise Haskell sees this as <code>(+) foldl 0</code>..."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486487208, "post_id": 42095698, "comment_id": 71362033, "body": "@WillemVanOnsem Thanks. Evidently it&#39;s been too long since I&#39;ve written Haskell. I only answered because at the time I started writing, no one else had shown an interest in the question."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 4, "last_activity_date": 1486662569, "last_edit_date": 1486662569, "creation_date": 1486486795, "answer_id": 42095698, "question_id": 42095100, "link": "https://stackoverflow.com/questions/42095100/chain-the-addition-operator-into-a-function-that-accepts-3-arguments/42095698#42095698", "title": "&quot;chain&quot; the addition operator into a function that accepts 3 arguments?", "body": "<p>Note the signature of the function composition operator:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n          ^            ^          ^\n               Functions\n</code></pre>\n\n<p>It takes 2 functions, each which take 1 argument, and returns a function that takes an argument of the same type as the second function, and returns the same type as the first. </p>\n\n<p>Your attempt to compose two <code>+</code>s didn't work since <code>+</code> takes 2 arguments, so without some hackish/creative workaround, this isn't possible. </p>\n\n<p>At this point, I'd say forcing composition when it doesn't fit the problem is just going to make your life more difficult. </p>\n\n<p>If you want to sum up multiple numbers, you could write a function like:</p>\n\n<pre><code>sum :: [Int] -&gt; Int\nsum nums = foldl (+) 0 nums\n</code></pre>\n\n<p>Or, since <code>nums</code> appears at the back of the definition, it can be dropped altogether, yielding a \"point-free\" form:</p>\n\n<pre><code>sum :: [Int] -&gt; Int\nsum = foldl (+) 0\n</code></pre>\n\n<p>It reduces/folds <code>+</code> over a list of numbers. If you haven't used folds yet, <strong><em>look into them now</em></strong>. They are one of the main ways to achieve looping in Haskell. It's essentially \"implicit recursion\" when you're dealing with lists, or anything else iterable. </p>\n\n<p>With the above function defined, you can use it like:</p>\n\n<pre><code>sum [1, 2  3, 4, 5] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 8, "last_activity_date": 1486500392, "creation_date": 1486500392, "answer_id": 42099678, "question_id": 42095100, "link": "https://stackoverflow.com/questions/42095100/chain-the-addition-operator-into-a-function-that-accepts-3-arguments/42099678#42099678", "title": "&quot;chain&quot; the addition operator into a function that accepts 3 arguments?", "body": "<p>You need this strange operator <code>(.).(.)</code>, which is sometimes defines as <code>.:</code> (think of 3 dots ...)</p>\n\n<p>In ghci</p>\n\n<pre><code>Prelude&gt; let (.:) = (.).(.)\nPrelude&gt; let f = (+) .: (+) \nPrelude&gt; f 1 2 3 \n&gt; 6\n</code></pre>\n\n<p>Note this operator can also be defined as <code>&lt;$$&gt; = fmap . fmap</code>.</p>\n"}], "owner": {"reputation": 7892, "user_id": 3310334, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/BTb0z.jpg?s=128&g=1", "display_name": "theonlygusti", "link": "https://stackoverflow.com/users/3310334/theonlygusti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 42095530, "answer_count": 4, "score": 6, "last_activity_date": 1486662569, "creation_date": 1486485049, "question_id": 42095100, "link": "https://stackoverflow.com/questions/42095100/chain-the-addition-operator-into-a-function-that-accepts-3-arguments", "title": "&quot;chain&quot; the addition operator into a function that accepts 3 arguments?", "body": "<p>I'd like to compose the addition operator <code>(+)</code> to make a function of this type:</p>\n\n<pre><code>Num a =&gt; a -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Like, the equivalent of this:</p>\n\n<pre><code>(\\a b c -&gt; a + b + c)\n</code></pre>\n\n<p>but without having to resort to lambdas.</p>\n\n<hr>\n\n<p>I tried already</p>\n\n<pre><code>((+) . (+))\n</code></pre>\n\n<p>which I would have expected to work but surprisingly didn't.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1486542656, "post_id": 42091664, "comment_id": 71385140, "body": "What if there are many <code>x</code> in the array ? Basically, arrays are for accessing by index and if you need to find element&#39;s index then array is not the right data structure."}, {"owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1486563757, "post_id": 42091664, "comment_id": 71399801, "body": "Thanks Ankur. In my case, I know there is no duplicate data in the array...I wanted to access data by a tuple and that&#39;s why I used Array.  In that case, what data structure would you recommend?"}], "answers": [{"comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1486477117, "post_id": 42092099, "comment_id": 71354454, "body": "Why doesn&#39;t <code>array</code> have its own <code>find</code> or in this case <code>elemIndex</code>  / <code>elemIndices</code>?"}, {"owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1486477961, "post_id": 42092099, "comment_id": 71355082, "body": "@Michael You can use <code>find</code> because <code>Array</code> has a <code>Foldable</code> instance. I don&#39;t know why there is not a <code>elemIndex</code> for <code>Array</code>."}, {"owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "edited": false, "score": 0, "creation_date": 1486480812, "post_id": 42092099, "comment_id": 71357276, "body": "Thank you! Just a small thing.. I added fromJust fst $ fromJust $ find ((== &#39;a&#39;) . snd) $ assocs lowerCase"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1486481923, "post_id": 42092099, "comment_id": 71358138, "body": "Eii000 what about when the element doesn&#39;t exist?"}, {"owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "edited": false, "score": 0, "creation_date": 1486563609, "post_id": 42092099, "comment_id": 71399690, "body": "Thanks Thomas! I check the output from &quot;find ((== &#39;a&#39;) . snd) $ assocs lowerCase &quot; and run the rest when it&#39;s not Nothing."}], "tags": [], "owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "is_accepted": false, "score": 2, "last_activity_date": 1486476920, "creation_date": 1486476920, "answer_id": 42092099, "question_id": 42091664, "link": "https://stackoverflow.com/questions/42091664/finding-the-index-of-element-in-an-array-haskell/42092099#42092099", "title": "Finding The Index of Element in an Array - Haskell", "body": "<pre><code>fst &lt;$&gt; find ((== 'a') . snd) $ assocs lowerCase\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "edited": false, "score": 2, "creation_date": 1557009497, "post_id": 55987261, "comment_id": 98623594, "body": "Please add some explanation."}, {"owner": {"reputation": 490, "user_id": 10907391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca22ed936e2ff650833d947c8e93762?s=128&d=identicon&r=PG&f=1", "display_name": "DanBrezeanu", "link": "https://stackoverflow.com/users/10907391/danbrezeanu"}, "reply_to_user": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "edited": false, "score": 0, "creation_date": 1557144808, "post_id": 55987261, "comment_id": 98655429, "body": "Done. Hope this helps"}], "tags": [], "owner": {"reputation": 490, "user_id": 10907391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ca22ed936e2ff650833d947c8e93762?s=128&d=identicon&r=PG&f=1", "display_name": "DanBrezeanu", "link": "https://stackoverflow.com/users/10907391/danbrezeanu"}, "is_accepted": false, "score": 1, "last_activity_date": 1557155222, "last_edit_date": 1557155222, "creation_date": 1557008202, "answer_id": 55987261, "question_id": 42091664, "link": "https://stackoverflow.com/questions/42091664/finding-the-index-of-element-in-an-array-haskell/55987261#55987261", "title": "Finding The Index of Element in an Array - Haskell", "body": "<p>To get all the indices a certain element appears in your <code>Data.Array</code> the following list comprehension can be used:</p>\n\n<pre><code>results = [fst x | x &lt;- (assocs lowerCase), snd x == 'a']\n</code></pre>\n\n<p><code>assocs</code> has the following prototype:</p>\n\n<pre><code>assocs :: Ix i =&gt; Array i e -&gt; [(i, e)]\n</code></pre>\n\n<p>It basically flattens a <code>Data.Array</code> in a <code>List</code> containing <code>(i, e)</code> pairs.\nFor:</p>\n\n<pre><code>a = listArray ((0,0),(2,2)) ['a'..]\n</code></pre>\n\n<p><code>assocs a</code> will output </p>\n\n<pre><code>[((0,0),'a'),((0,1),'b'),((0,2),'c'),((1,0),'d'),((1,1),'e'),((1,2),'f'),((2,0),'g'),((2,1),'h'),((2,2),'i')]\n</code></pre>\n\n<p>Now, in our list comprehension, we have <code>x &lt;- (assocs a)</code>, so <code>x</code> is generated by the list <code>assocs a</code>.</p>\n\n<p>The list outputed by the list comprehension will contain only <code>fst x</code> where </p>\n\n<pre><code>snd x == theElementWeAreLookingFor\n</code></pre>\n\n<p>Every <code>x</code> generated by <code>assocs a</code> is  checked and if the condition <code>snd x == 'a'</code> is met then <code>fst a</code> (the index) will be inserted in the output list.</p>\n\n<p>Once the list is generated, it can be checked whether there are none, one or more outputs. </p>\n\n<pre><code>getElementIndex :: Array (Int, Int) Char -&gt; Char -&gt; Maybe (Int, Int)\ngetElementIndex a e\n   | null results = Nothing\n   | othwerwise   = Just $ head results\n   where results = [fst x | x &lt;- (assocs a), snd x == e]\n</code></pre>\n\n<p>A imperative pseduocode could look like:</p>\n\n<pre><code>results = []\n\nfor_each x in a.toList():\n   if x.second == 'a':\n      results.append(x.first)\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557155222, "creation_date": 1486475732, "last_edit_date": 1486476048, "question_id": 42091664, "link": "https://stackoverflow.com/questions/42091664/finding-the-index-of-element-in-an-array-haskell", "title": "Finding The Index of Element in an Array - Haskell", "body": "<p>Which function can I use to find its index of an element in an Array?\nFor example, I want to find the index of <code>'x'</code> in an <code>Array</code> (<code>Data.Array</code>)</p>\n\n<pre><code>lowerCase = listArray ((0,0),(1,12)) ['a'..]\n</code></pre>\n"}, {"tags": ["haskell", "keycode", "xmonad", "keyboard-layout", "xmodmap"], "owner": {"reputation": 341, "user_id": 6754986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IYIfl.png?s=128&g=1", "display_name": "LinFelix", "link": "https://stackoverflow.com/users/6754986/linfelix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1486565783, "creation_date": 1486470082, "last_edit_date": 1486565783, "question_id": 42089789, "link": "https://stackoverflow.com/questions/42089789/mapping-pressing-left-and-right-modifier-key-to-esc", "title": "Mapping pressing left and right modifier key to ESC", "body": "<p>I am using <a href=\"http://xmonad.org/\" rel=\"nofollow noreferrer\">XMonad</a> and the <a href=\"http://wiki.neo-layout.org/\" rel=\"nofollow noreferrer\">neo/neo2-keyboard-layout</a>.\nI would like to get ESC when I press both modifier keys for Level3</p>\n\n<p>the key-code and name are: <br/>\n * 66 ISO_Level3_Shift <br/>\n * 51 ISO_Level3_Shift <br/></p>\n\n<p>I think it should be possible with either using xmodmap or xkeyboard-config or through the <a href=\"http://xmonad.org/\" rel=\"nofollow noreferrer\">XMonad</a> config.</p>\n\n<p>With xmodmap I fail to set Escape only to Mod3 on keycode 66 and in the Xmonad configuration i fail to use keycodes or i don't see how <a href=\"http://xmonad.org/xmonad-docs/xmonad-contrib/XMonad-Util-EZConfig.html\" rel=\"nofollow noreferrer\">EZConfig</a> is going to help me here.</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1486468161, "post_id": 42089091, "comment_id": 71348254, "body": "Type signatures, please. And why not remove some of the case-clauses that aren&#39;t relevant to the problem?"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1486468675, "post_id": 42089091, "comment_id": 71348591, "body": "Instead of put all of your code here, please make <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486468965, "post_id": 42089091, "comment_id": 71348779, "body": "Not <i>nomads</i> but <i>monads</i>."}, {"owner": {"reputation": 31, "user_id": 7528431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd349292f82143a23bb0a385a7c0b0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Xui", "link": "https://stackoverflow.com/users/7528431/xui"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1486470278, "post_id": 42089091, "comment_id": 71349650, "body": "fixed, sorry about that.  @leftaroundabout I included what &#39;:t&#39; returned, or do you mean for me to define them?"}], "answers": [{"comments": [{"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 0, "creation_date": 1486471224, "post_id": 42090123, "comment_id": 71350222, "body": "What happened is haskell is hostile to &quot;printf debugging&quot; from pure functions."}], "tags": [], "owner": {"reputation": 31, "user_id": 7528431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd349292f82143a23bb0a385a7c0b0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Xui", "link": "https://stackoverflow.com/users/7528431/xui"}, "is_accepted": false, "score": 0, "last_activity_date": 1486471236, "last_edit_date": 1486471236, "creation_date": 1486471101, "answer_id": 42090123, "question_id": 42089091, "link": "https://stackoverflow.com/questions/42089091/getting-char-instead-of-io-string/42090123#42090123", "title": "Getting [Char] instead of IO() String", "body": "<p>Actually I've answered my own question. The following seems to work:</p>\n\n<pre><code>a = \"b,b,b/b,b,b/b,b,b,b/e,e,e/w,w,w,w/w,w,w/w,w,w,w\"\nn = length a\n\neLoopCase i =\n    if i &lt; n\n        then\n            case a !! i of\n                'e' -&gt; \"(\" ++ \"found an e\" ++ \"),\" ++ eLoopCase (i+1)\n                'w' -&gt; \"\" ++ eLoopCase (i+1)\n                'b' -&gt; \"\" ++ eLoopCase (i+1)\n                ',' -&gt; eLoopCase (i+1)\n                '/' -&gt; eLoopCase (i+1)\n        else \"\"\n</code></pre>\n\n<p>I'm still curious as to what happened.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7528431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd349292f82143a23bb0a385a7c0b0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Xui", "link": "https://stackoverflow.com/users/7528431/xui"}, "edited": false, "score": 0, "creation_date": 1486476984, "post_id": 42090274, "comment_id": 71354363, "body": "Thanks! I&#39;ll look into pattern matching and imperative style. I was looking for a way to keep iterating on the whole list after I found an e. For example the answer I posted returns <code>(found an e),(found an e),(found an e),</code>. Also the type of eLoopCase is IO String and I&#39;m looking for [Char]"}], "tags": [], "owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "is_accepted": false, "score": 4, "last_activity_date": 1486475136, "last_edit_date": 1486475136, "creation_date": 1486471570, "answer_id": 42090274, "question_id": 42089091, "link": "https://stackoverflow.com/questions/42089091/getting-char-instead-of-io-string/42090274#42090274", "title": "Getting [Char] instead of IO() String", "body": "<p><code>eLoopCase</code> is returning nothing because you have <code>return ()</code> at all the \"ends\" of it. I think you're after something like this (Notice appending the current character to the result of the recursive call in the <code>x == 'w' || x == 'b'</code> branch):</p>\n\n<pre><code>a :: String\na = \"b,b,b,b/b,b,b/b,b,b,b/e,e,e/w,w,w,w/w,w,w/w,w,w,w\"\n\neLoopCase :: String -&gt; IO String\neLoopCase [] = return []\neLoopCase (x:xs)\n  | x == 'e' = do\n      putStrLn \"(found an e)\"\n      return [x]\n  | x == ',' || x == '/' =\n      eLoopCase xs\n  | x == 'w' || x == 'b' = do\n      rest &lt;- eLoopCase xs\n      return (x : rest)\n  | otherwise = do\n      putStrLn (\"Encountered invalid character: \" ++ show x)\n      return []\n</code></pre>\n\n<p>General problems with your code:</p>\n\n<ul>\n<li>The program you wrote is very imperative in style. This is something I would urge you to try to move away from while writing Haskell.</li>\n<li>Prefer pattern matching on lists over indexing with <code>!!</code>.</li>\n</ul>\n\n<p>I should note that the function I provided has flaws of its own. It presupposes that the strings provided to it will only consist of a couple different chars. A way to improve it would be to add an <code>otherwise</code> branch to the guards. (Edit: Added to the snippet above)</p>\n\n<p>I think it's also worth pointing out that this function really need not depend on IO at all to work. Look into other \"pure\" alternatives for doing error handling/reporting such as <code>Either</code>, <code>Maybe</code>, and <code>Writer</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "edited": false, "score": 0, "creation_date": 1486481793, "post_id": 42092342, "comment_id": 71358018, "body": "Just as a heads up, the code you posted doesn&#39;t compile."}, {"owner": {"reputation": 31, "user_id": 7528431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd349292f82143a23bb0a385a7c0b0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Xui", "link": "https://stackoverflow.com/users/7528431/xui"}, "edited": false, "score": 0, "creation_date": 1486482355, "post_id": 42092342, "comment_id": 71358430, "body": "Thanks, you used a lot of functions I thought of using but couldn&#39;t!"}], "tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1486482589, "last_edit_date": 1486482589, "creation_date": 1486477636, "answer_id": 42092342, "question_id": 42089091, "link": "https://stackoverflow.com/questions/42089091/getting-char-instead-of-io-string/42092342#42092342", "title": "Getting [Char] instead of IO() String", "body": "<p>I'm glad you've decided to try to learn Haskell. You can do a lot better than eLoopCase. I'll tell you how, but first I'll explain the problem you were having in your original question and how you fixed it.</p>\n\n<p>As originally written, eLoopCase is has a type <code>Int -&gt; IO ()</code>, meaning it is a function which takes an <code>Int</code> and returns an input output action. IOW, the type tells you that if you give it a number it will do <em>something</em>. If you look at the code you can see that that something is just printing out strings, but it could have been almost anything.</p>\n\n<p>In your answer, you rewrote <code>eLoopCase</code> to construct strings directly via the <code>++</code> operator, instead of printing them out to the terminal via putStr. This is the reason your rewritten function has the type that it does. It also explains why you no longer need the <code>return ()</code> statements, which are the \"Do nothing while returning a <code>()</code> value\" IO actions.</p>\n\n<p>I hope that clears things up a little. That said, <code>eLoopCase</code> can be tremendously improved. </p>\n\n<p>Haskell programs are efficiently written when the control logic matches the data structure. For instance, this program is iterating through a list. A list is defined as the data which is either an empty list or an element and more list, as seen in the declaration below.</p>\n\n<pre><code>data List a = []\n            | a : List a\n</code></pre>\n\n<p>Consequently, programs which iterate through a list will be based on decisions for those two constructors. For example (using the synonym <code>String</code> for <code>[Char]</code>), <code>eLoopCase</code> can be rewritten as</p>\n\n<pre><code>eLoopCase' :: String -&gt; String\neLoopCase' []     = \"\"\neLoopCase' (a:as) = evalCase a ++ eLoopCase' as\n\nevalCase a = case a of\n  'e' -&gt; \"(\" ++ \"found an e\" ++ \"),\"\n  'w' -&gt; \"\"\n  'b' -&gt; \"\"\n  ',' -&gt; \"\"\n  '/' -&gt; \"\"\n  _   -&gt; \"\"\n</code></pre>\n\n<p>Notice <code>eLoopCase'</code> needs to be fed <code>a</code> as an input as it is no longer hard coded into the body of the function--a good thing. It also does away with the index <code>i</code> and errors arising from using <code>!!</code> (try calling <code>eLoopCase (-1)</code>).</p>\n\n<p>Having practice in writing recursive functions such as <code>eLoopCase'</code> is a good start. An evolution in programming is to see what you are intending to do with that loop and applying appropriate patterns. </p>\n\n<p>For instance, since you want to evaluate every element in a list by a certain function, use a <code>map</code>. Specifically <code>map evalCase</code> to go from a list of characters to your list of strings, then use <code>concat</code> to append all those lists together:</p>\n\n<pre><code>eLoopCase'' = concat . map evalCase\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7528431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd349292f82143a23bb0a385a7c0b0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Xui", "link": "https://stackoverflow.com/users/7528431/xui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 1, "accepted_answer_id": 42092342, "answer_count": 3, "score": 1, "last_activity_date": 1486482589, "creation_date": 1486467995, "last_edit_date": 1486470205, "question_id": 42089091, "link": "https://stackoverflow.com/questions/42089091/getting-char-instead-of-io-string", "title": "Getting [Char] instead of IO() String", "body": "<p>I'm a new to Haskell. I'm reading an input string (a) and want to return a string when I find a character (e) inside. Now my whole source code:</p>\n\n<pre><code>a = \"b,b,b,b/b,b,b/b,b,b,b/e,e,e/w,w,w,w/w,w,w/w,w,w,w\"\nn = length a\n\nsimpleCase n =\n    case n of\n        'a' -&gt; \"hey cutie\"\n\neLoopCase i =\n    if i &lt; n\n        then do\n            let char = a !! i\n            case char of\n                'e' -&gt; putStr $ \"(\" ++ \"found an e\" ++ \"),\"\n                'w' -&gt; return ()\n                'b' -&gt; return ()\n                ',' -&gt; eLoopCase (i+1)\n                '/' -&gt; eLoopCase (i+1)\n            if (char == ',' || char == '/') == False\n                then eLoopCase (i+1)\n                else return ()\n        else return ()\n</code></pre>\n\n<p>simpleCase gives me back a string but eLoopCase gives me an IO() back. It works, however I'd like for eLoopCase to give an String back so I can work on it. </p>\n\n<pre><code>:t simpleCase \nsimpleCase :: Char -&gt; [Char]\n:t eLoopCase \neLoopCase :: Int -&gt; IO ()\n</code></pre>\n\n<p>I understand that this has something to do with monads,<code>then do</code> and <code>putStr</code>, this is where my understanding ends. Removing <code>do</code> gives a parse error.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1486465091, "post_id": 42087799, "comment_id": 71346128, "body": "That&#39;s not really &#39;cabal hell&#39;; You seem to have a dependency on an old deprecated package that you probably shouldn&#39;t be having."}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 1, "creation_date": 1486470922, "post_id": 42087799, "comment_id": 71350033, "body": "Considered using stack?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 1, "creation_date": 1486481905, "post_id": 42087799, "comment_id": 71358128, "body": "@Reactormonk Stack is a great tool, but it isn&#39;t an automatic solution for every dependency management issue. In this case, the symptoms indicate that, without making additional adjustments, the OP would have run into the exact same problem with Stack (cf. Cubic&#39;s comment)."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1486484671, "post_id": 42087799, "comment_id": 71360193, "body": "Is <code>prod</code> your local package? How did you create its <code>.cabal</code> file? Maybe you were following out-dated instructions, or using an old version of <code>propellor</code> to create it."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1486493098, "last_edit_date": 1495540407, "creation_date": 1486487804, "answer_id": 42096013, "question_id": 42087799, "link": "https://stackoverflow.com/questions/42087799/could-not-resolve-dependencies-with-cabal-due-to-monadcatchio-transformers/42096013#42096013", "title": "&quot;Could not resolve dependencies&quot; with cabal due to MonadCatchIO-transformers", "body": "<p>The first thing you should do when facing unsatisfiable dependencies for Hackage packages is <a href=\"https://hackage.haskell.org/package/MonadCatchIO-transformers\" rel=\"nofollow noreferrer\">checking the package documentation at Hackage</a> to have a broader picture of the problem. In this case, the documentation reveals that <em>MonadCatchIO-transformers</em> was deprecated in favour of the <a href=\"https://hackage.haskell.org/package/MonadCatchIO-transformers-0.3.1.3\" rel=\"nofollow noreferrer\"><em>exceptions</em></a> package, that provides a similar interface (which explains why <em>MonadCatchIO-transforemrs</em> wasn't updated for <em>base</em> 4.9). That being so, you have basically three approaches for getting your package to build:</p>\n\n<h3>1. Switch your code to <em>exceptions</em></h3>\n\n<p>Since <em>MonadCatchIO-transformers</em> appears to be a dependency that you are directly using in your code (as opposed to a transitive dependency), the recommended long-term solution is updating your code to use <em>exceptions</em> rather than <em>MonadCatchIO-transformers</em>.</p>\n\n<h3>2. Use GHC 7.10 for this project</h3>\n\n<p>If you can't, or don't want to, switch to <em>exceptions</em> right now, an alternative is setting up a parallel GHC 7.10.x installation, so that you can use <em>base</em> 4.8. Suggestions of ways to conveniently using <em>cabal-install</em> with multiple versions of GHC are presented in <a href=\"https://stackoverflow.com/q/7770100/2751851\"><em>Using cabal with multiple GHC versions</em></a> (through <em>cabal</em> settings -- be sure to also read the more recent answers further down the page) and in <a href=\"http://www.edsko.net/2015/03/09/sandboxes-revisited/\" rel=\"nofollow noreferrer\">this blog post by Edsko de Vries</a> (by managing your bash environment). Another possibility is using <a href=\"https://www.haskellstack.org/\" rel=\"nofollow noreferrer\">Stack</a> (rather than <em>cabal-install</em>) to build this specific project and switching to a resolver that provides <em>base</em> 4.8 and <em>MonadCatchIO-transformers</em> (such as the <a href=\"https://www.stackage.org/lts-6.30\" rel=\"nofollow noreferrer\">LTS 6.30</a> Stackage snapshot), as Stack can install and manage alternative GHC versions for projects that require it (cf. the <code>stack setup</code> command). Stack doesn't interfere with your usual <em>cabal-install</em> environment or with your system-wide GHC installation; that being so, if you switch this project to Stack you can remain using <em>cabal-install</em> everywhere else just fine.</p>\n\n<h3>3. Adjust the upper bounds of <em>MonadCatchIO-transformers</em></h3>\n\n<p>There is also approach of installing a custom version of <em>MonadCatchIO-transformers</em> with adjusted upper bounds of <em>base</em> and <em>transformers</em>. While that may be the quickest way to get it up and running, in this case it is also the least sustainable one, considering that <em>MonadCatchIO-transformers</em> <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2013-November/111309.html\" rel=\"nofollow noreferrer\">has been deprecated for several years already</a>. As for why that didn't work for you...</p>\n\n<blockquote>\n  <p>I have tried following the advice of <a href=\"https://stackoverflow.com/questions/12904909/what-to-do-if-libraries-require-a-different-version-of-base\">this</a> post (editing the configuration of MonadCatchIO-transformers and then installing) to override these requirements, but somehow get the same error message.</p>\n</blockquote>\n\n<p>... the fact you got <em>literally</em> the same error message suggests that <em>cabal-install</em> didn't pick your custom <em>MonadCatchIO-transformers</em> version. Have you changed the version of <em>MonadCatchIO-transformers</em>, both in the .cabal file you changed (as suggested in the Q&amp;A you linked to) and in the .cabal file of your project?</p>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 42096013, "answer_count": 1, "score": 1, "last_activity_date": 1486494000, "creation_date": 1486464385, "last_edit_date": 1495541824, "question_id": 42087799, "link": "https://stackoverflow.com/questions/42087799/could-not-resolve-dependencies-with-cabal-due-to-monadcatchio-transformers", "title": "&quot;Could not resolve dependencies&quot; with cabal due to MonadCatchIO-transformers", "body": "<p>I am trying to build a package to deploy using <a href=\"https://propellor.branchable.com/\" rel=\"nofollow noreferrer\">propellor</a>, and have not even been able to get it to configure due to dependency issues.</p>\n\n<p>Here is the error message that I get:</p>\n\n<pre><code>$ cabal new-configure\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: prod-0.0.1 (user goal)\ntrying: base-4.9.1.0/installed-4.9... (dependency of prod-0.0.1)\ntrying: transformers-0.5.2.0/installed-0.5... (dependency of propellor-2.17.0)\nnext goal: MonadCatchIO-transformers (dependency of prod-0.0.1)\nrejecting: MonadCatchIO-transformers-0.3.1.3 (conflict:\nbase==4.9.1.0/installed-4.9..., MonadCatchIO-transformers =&gt; base&lt;4.9)\nrejecting: MonadCatchIO-transformers-0.3.1.2,\nMonadCatchIO-transformers-0.3.1.1, MonadCatchIO-transformers-0.3.1.0\n(conflict: base==4.9.1.0/installed-4.9..., MonadCatchIO-transformers =&gt;\nbase&lt;4.8)\nrejecting: MonadCatchIO-transformers-0.3.0.0,\nMonadCatchIO-transformers-0.2.2.3, MonadCatchIO-transformers-0.2.2.2,\nMonadCatchIO-transformers-0.2.2.1, MonadCatchIO-transformers-0.2.2.0,\nMonadCatchIO-transformers-0.2.1.0, MonadCatchIO-transformers-0.2.0.0\n(conflict: base==4.9.1.0/installed-4.9..., MonadCatchIO-transformers =&gt;\nbase&lt;4.7)\nrejecting: MonadCatchIO-transformers-0.1.0.1 (conflict:\ntransformers==0.5.2.0/installed-0.5..., MonadCatchIO-transformers =&gt;\ntransformers==0.1.*)\nrejecting: MonadCatchIO-transformers-0.1.0.0,\nMonadCatchIO-transformers-0.0.2.0, MonadCatchIO-transformers-0.0.1.0\n(conflict: transformers==0.5.2.0/installed-0.5..., MonadCatchIO-transformers\n=&gt; transformers&lt;0.2)\nDependency tree exhaustively searched.\n</code></pre>\n\n<p>It seems that the package 'MonadCatchIO-transformers' package requires an older version of 'base', and a much older version of transformers.</p>\n\n<p>I have tried following the advice of <a href=\"https://stackoverflow.com/questions/12904909/what-to-do-if-libraries-require-a-different-version-of-base\">this</a> post (editing the configuration of MonadCatchIO-transformers and then installing) to override these requirements, but somehow get the same error message.</p>\n\n<p>I have also tried many other things including this with and without sandboxes, and reinstalling my entire ghc, etc. Is there any way out of this cabal hell?</p>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486461997, "post_id": 42086861, "comment_id": 71344059, "body": "As you would for any other data type - pass it an argument of the right type! <code>Test id :: Test a a</code>, <code>Test (\\b -&gt; if b then Nothing else Just ()) :: Test Bool (Maybe ())</code>, etc."}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486462756, "post_id": 42086861, "comment_id": 71344569, "body": "@Alec this comment isn&#39;t constructive -- can you please explain??"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1486462961, "post_id": 42086861, "comment_id": 71344703, "body": "I apologize if I came off as disingenuous, that wasn&#39;t the intention. My point was that even if <code>runTest</code> is peculiarly named, it still is just a field - to construct a <code>Test</code>, you pass it a function (to fill the <code>runTest</code> field). That function is your &quot;implementation&quot; of <code>runTest</code>."}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486463007, "post_id": 42086861, "comment_id": 71344742, "body": "@Alec that helps thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1486480467, "creation_date": 1486480467, "answer_id": 42093364, "question_id": 42086861, "link": "https://stackoverflow.com/questions/42086861/implementing-function-interfaces-defined-inside-record-syntax/42093364#42093364", "title": "Implementing function interfaces defined inside record syntax?", "body": "<p>If </p>\n\n<pre><code>t :: Test a b\n</code></pre>\n\n<p>then what is the type of </p>\n\n<pre><code>runTest t :: ? \n</code></pre>\n\n<p>Well, yes, <code>runTest t :: a -&gt; b</code>. It is effectively the same as a function from <code>a</code> to <code>b</code>. Likewise, <code>Reader e a</code> is effectively a function with an <code>e</code> as its first argument. </p>\n\n<p>You asked about implemenation, I'm assuming you mean how to implement the Reader Monad? Reader's monad implementation lets you compose multiple functions who all have <code>e</code> as their first argument, and handles distributing a single <code>e</code> to all those first inputs. The <code>e</code> supplied will be the input to your function <code>(runReader r) :: e -&gt; a</code></p>\n\n<p>I'm not sure if I'm running off track here, let me know and I'll flesh out the reader monad a little. </p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 2, "accepted_answer_id": 42093364, "answer_count": 1, "score": 0, "last_activity_date": 1486480467, "creation_date": 1486461721, "question_id": 42086861, "link": "https://stackoverflow.com/questions/42086861/implementing-function-interfaces-defined-inside-record-syntax", "title": "Implementing function interfaces defined inside record syntax?", "body": "<p>I'm covering the reader monad at the moment, and I've come across <code>runReader</code>:</p>\n\n<pre><code>newtype Reader e a = Reader {runReader :: (e -&gt; a)}\n</code></pre>\n\n<p>I understand that here the data constructor <code>Reader</code> is enabling two different types (<code>e</code> and <code>a</code>) to be passed into the type constructor <code>Reader</code> that uses record syntax to contain a function <code>runReader ::</code> that operates on <code>e</code> and <code>a</code>.</p>\n\n<p>I'm trying implement a test of this:</p>\n\n<pre><code>newtype Test a b = Test {runTest :: (a -&gt; b)}\n</code></pre>\n\n<p>How do I go about creating the implementation of <code>runTest</code>? </p>\n"}, {"tags": ["haskell", "types", "algebra", "domain-model"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1486449507, "post_id": 42083095, "comment_id": 71337109, "body": "There is a suggestion to <code>Use MultiParamTypeClasses to allow multi-parameter classes</code>, I suggest you take it.  Put <code>{-# LANGAUGE MultiParamTypeClasses #-}</code> on the first line of the file to enable it."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1486449585, "post_id": 42083095, "comment_id": 71337145, "body": "This will &quot;work&quot;, but you will run into other problems when you attempt to use any methods of <code>BookMessage</code>.  I&#39;m not sure what <code>b</code> is supposed to be there..."}, {"owner": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1486449778, "post_id": 42083095, "comment_id": 71337239, "body": "@luqui: <code>BookMessage</code> extends <code>ExchangeMessage</code>: <code>b</code> is the type of the <code>Exchange</code> that comes from <code>ExchangeMessage</code>."}, {"owner": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1486449837, "post_id": 42083095, "comment_id": 71337267, "body": "@luqui: I&#39;m not sure if this is an optimal way to model this domain. I will resort to <code>MultiParamTypeClasses</code> if there is no better way to deal with this."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1486497542, "post_id": 42083095, "comment_id": 71367985, "body": "Your classes serve no purpose. Just use functions."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1486516559, "post_id": 42083095, "comment_id": 71376049, "body": "Something else came to mind:  Haskell is not an OO language, so the transition can be tough.  A technique you might try, since your brain isn&#39;t used to functional modeling, is writing some of the client code of your library directly, and then refactoring until you find the library that it should be using."}], "answers": [{"comments": [{"owner": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "edited": false, "score": 0, "creation_date": 1486450602, "post_id": 42083387, "comment_id": 71337582, "body": "So concrete exchanges and messages from different exchanges might have varying fields, e.g.  <code>data MyExchange1 = MyExchange1 ExchangeName Currency Currency OpenTime CloseTime</code> And <code>data MyExchange2 = MyExchange2 ExchangeName Currency Currency Precision</code>  But I would like to run common methods on them, and treat them as I would treat abstract class in OOP. What&#39;s the analogy for this in Haskell?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "edited": false, "score": 0, "creation_date": 1486451275, "post_id": 42083387, "comment_id": 71337893, "body": "@ak. that sounds like a good use of a typeclass then, I think you were just overdoing it in your model.  Start concrete, and as you notice duplication factor out into classes, which will ensure your abstractions are well-motivated.  Hard to give specific advice without seeing the duplication you are trying to avoid specifically."}, {"owner": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "edited": false, "score": 0, "creation_date": 1486452168, "post_id": 42083387, "comment_id": 71338371, "body": "I added a bit more info into the question regarding usage of these type classes. Basically I&#39;m building a library where I define some abstract interfaces, and the specifics are coming in the user apps."}, {"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 0, "creation_date": 1486467631, "post_id": 42083387, "comment_id": 71347909, "body": "You can keep common functions by compositions too. You&#39;ll just have to extract the relevant sub-part at the calling site."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 4, "last_activity_date": 1486450339, "last_edit_date": 1486450339, "creation_date": 1486449837, "answer_id": 42083387, "question_id": 42083095, "link": "https://stackoverflow.com/questions/42083095/modeling-exchange-in-haskell/42083387#42083387", "title": "Modeling exchange in Haskell", "body": "<p>First order of business, take GHC's suggestion and enable <code>MultiParamTypeCLasses</code> at the top of the file.</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n</code></pre>\n\n<p>This is a very common extension, and it will fix the immediate problem.</p>\n\n<p><em>However</em> there appear to be some modeling issues and if you proceed with this design you will surely hit some problems you didn't expect.  I can go into all the details of what your code means, but I'm not sure that would be very helpful.  Instead I'll just point you in the right direction, I think, which is to use <code>data</code> records instead of typeclasses.  Haskell typeclasses do not correspond to classes in other OO langauges and it confuses many beginners.  But I think you want to model it like this:</p>\n\n<pre><code>data Exchange = Exchange \n    { name :: ExchangeName\n    , base :: Currency\n    , quote :: Currency \n    }\n\ndata Message = Message\n    { time :: Time }\n\n-- etc.\n</code></pre>\n\n<p>which will simplify everything for you, and this acts more like OO classes than your model.  Keep in mind that records can have functions and other complex data structures as fields, which is how you get the analog of virtual methods, for example:</p>\n\n<pre><code>data MessageLogger = MessageLogger\n    { log :: String -&gt; IO () }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "edited": false, "score": 0, "creation_date": 1486494080, "post_id": 42089270, "comment_id": 71366032, "body": "@bartabelle: Would it benefit to at least have a type class that defines a function <code>MyExchange -&gt; Exchange</code> or <code>MyExchangeMessage -&gt; Message</code>? The reason is that I&#39;d like to be able to take a list of messages <code>[Message]</code> and fold them in some way, where the predicate of the fold would pattern match messages against specific data constructors. Does this makes sense?"}, {"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "reply_to_user": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "edited": false, "score": 0, "creation_date": 1486505914, "post_id": 42089270, "comment_id": 71372386, "body": "That type class might be useful, I can&#39;t really comment on your specific use case. However, creating new type classes is the exception more than the rule, see for example the <a href=\"https://hackage.haskell.org/package/astar-0.3.0.0/docs/Data-Graph-AStar.html\" rel=\"nofollow noreferrer\">astar API</a>. You&#39;ll notice how there are no typeclasses such as <code>HasNeighbors</code>, <code>Localized</code> or <code>Distanceable</code>. Just plain functions, and the API is really good."}], "tags": [], "owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "is_accepted": false, "score": 3, "last_activity_date": 1486468534, "creation_date": 1486468534, "answer_id": 42089270, "question_id": 42083095, "link": "https://stackoverflow.com/questions/42083095/modeling-exchange-in-haskell/42089270#42089270", "title": "Modeling exchange in Haskell", "body": "<p>First of all, you will probably not be able to write a class instance for <code>ExchangeMessage</code>. The reason is that the <code>exchange</code> function must be able to return <em>any</em> type <code>e</code>. If you want to keep this way, you will need to provide a way to build an arbitrary exchange!</p>\n\n<pre><code>class Exchange a where\n  name :: a -&gt; ExchangeName\n  base :: a -&gt; Currency\n  quote :: a -&gt; Currency\n  build :: Time -&gt; a\n</code></pre>\n\n<p>This is the only possible signature for <code>build</code>, as all you can know from an exchange is that it has a <code>Time</code> you can query, and it's probably useless.</p>\n\n<p>What I would think is a better design is to have concrete types for all those classes you defined. For example:</p>\n\n<pre><code>data Exchange = Exchange { getName  :: ExchangeName\n                         , getBase  :: Currency\n                         , getQuote :: Currency\n                         } deriving (Show, Eq)\n</code></pre>\n\n<p>Then, once you have written the functions that work with these concrete types, you can either:</p>\n\n<ul>\n<li>write functionsof type <code>MyExchange -&gt; Exchange</code> for example, to adapt functions expecting an <code>Exchange</code></li>\n<li>use classy lenses, so as to directly write functions that will consume abitrary types</li>\n</ul>\n\n<p>All in all, for that kind of applications, if you want to be fancy with types I would suggest to use phantom types for your currencies, so that you'll statically enforce for example you can only compute the sum of two amounts of money using the same currency. Using typeclasses to mimic the habits of OO will not produce APIs that are nice to use or code that is clear.</p>\n"}], "owner": {"reputation": 3207, "user_id": 151186, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/09ab9696ff673467e6d85be940a08b1b?s=128&d=identicon&r=PG", "display_name": "ak.", "link": "https://stackoverflow.com/users/151186/ak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 42083387, "answer_count": 2, "score": 2, "last_activity_date": 1486468534, "creation_date": 1486448651, "last_edit_date": 1486452683, "question_id": 42083095, "link": "https://stackoverflow.com/questions/42083095/modeling-exchange-in-haskell", "title": "Modeling exchange in Haskell", "body": "<p>I'm new to Haskell, and I'm looking to model stock exchange library. It's meant to be a library, hence specifics to be defined by the user. The way I intend to use this is to have users define things like this. </p>\n\n<pre><code>data MyExchange = MyExchange { name :: ExchangeName\n                             , base :: Currency\n                             , quote :: Currency }\n                             deriving (Eq, Show)\n\ninstance Exchange MyExchange\n\ndata MyExchangeBookMessage = \n        MyExchangeBookMessage { time :: Time\n                              , exchange :: MyExchange\n                              , price :: Price \n                              , side :: Side\n                              , amount :: Maybe Amount }\n                              deriving (Eq, Show)\n\ninstance ExchangeBookMessage MyExchangeBookMessage\n</code></pre>\n\n<p>I've tried the following, but immediately ran into some limitations of type classes. Below is the code and the error message. Specifically what are the alternatives to parameterizing type classes with multiple types?</p>\n\n<p>Here is the code for the library</p>\n\n<pre><code>module Lib where\n\ndata Side = Buy | Sell deriving (Eq, Show)\n\nnewtype Amount = Amount Rational deriving (Eq, Show)\n\nnewtype Price = Price Rational deriving (Eq, Show)\n\nnewtype Currency = Currency String deriving (Eq, Show)\n\nnewtype Time = Time Integer deriving (Eq, Show)\n\ntype ExchangeName = String\n\nclass Exchange a where\n  name :: a -&gt; ExchangeName\n  base :: a -&gt; Currency\n  quote :: a -&gt; Currency\n\n\nclass Message a where\n  time :: a -&gt; Time\n\nclass (Message a, Exchange e) =&gt; ExchangeMessage a e where\n  exchange :: a -&gt; e\n\nclass ExchangeMessage a b =&gt; BookMessage a b where\n  price :: a -&gt; Price\n  side :: a -&gt; Side\n  amount :: a -&gt; Maybe Amount\n</code></pre>\n\n<p>And the error message:</p>\n\n<pre><code>src/Lib.hs:22:1: error:\n    \u2022 Too many parameters for class \u2018ExchangeMessage\u2019\n      (Use MultiParamTypeClasses to allow multi-parameter classes)\n    \u2022 In the class declaration for \u2018ExchangeMessage\u2019\n</code></pre>\n\n<p>Later I would like to be able to implement type classes like this:</p>\n\n<pre><code>class Strategy s where\n  run (Message m, Action a) =&gt; s -&gt; m -&gt; a\n</code></pre>\n\n<p>In the <code>Strategy</code> implementations the <code>run</code> function will take an abstract message m, pattern match it against relevant <code>Message</code> data constructors and return specific action.</p>\n\n<p>I'm porting some Scala code. in Scala I was using a hierarchy of traits with concrete case classes at the bottom:</p>\n\n<pre><code>trait Exchange { \n  def name: String\n  def base: Currency\n  def quote: Currency \n}\n\ncase class MyExchange(base: Currency, quote: Currency) {\n  val name = \"my-exchange\"\n}\n\ntrait Message {\n  def time: Long\n}\n\ntrait ExchangeMessage extends Message {\n  def exchange: Exchange\n}\n\ntrait BookMessage extends ExchangeMessage {\n  def price: Double\n  def side: Side\n  def amount: Option[Double]\n}\n\ncase class MyBookMessage(time: Long, price: Double, side: Side, amount: Option[Double]) {\n  def exchange: Exchange = MyExchange(...)\n}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1486448802, "post_id": 42083081, "comment_id": 71336831, "body": "In GHC 8, you can use the <code>DuplicateRecordFields</code> extension to allow this by adding <code>{-# LANGUAGE DuplicateRecordFields #-}</code> to the top of your file."}, {"owner": {"reputation": 148, "user_id": 2477035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1380a31e6e8acf9a0aa4a405dac33e00?s=128&d=identicon&r=PG", "display_name": "Pratyush Rathore", "link": "https://stackoverflow.com/users/2477035/pratyush-rathore"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1486449081, "post_id": 42083081, "comment_id": 71336926, "body": "Thanks. Turns out, I am using 7.6.3.  Anyways, apart from getting it to work, I would like to understand the philosophy as to why this does not work by default?"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 7131301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95feecfe61cbcdf86514a34cdc248623?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas By", "link": "https://stackoverflow.com/users/7131301/tomas-by"}, "is_accepted": true, "score": 6, "last_activity_date": 1486449423, "creation_date": 1486449423, "answer_id": 42083269, "question_id": 42083081, "link": "https://stackoverflow.com/questions/42083081/how-to-declare-two-data-types-containing-same-variable-in-haskell/42083269#42083269", "title": "How to declare two data types containing same variable in haskell?", "body": "<p>The problem here, I believe, is that Haskell defines access functions for all the fields in a record, so you get one function</p>\n\n<pre><code>name :: Person -&gt; String\n</code></pre>\n\n<p>and then one</p>\n\n<pre><code>name :: PetAnimal -&gt; String\n</code></pre>\n\n<p>which is what the compiler does not like.</p>\n\n<p>You could change one or both of the names, or put them in different modules.</p>\n"}, {"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1486481677, "creation_date": 1486481677, "answer_id": 42093805, "question_id": 42083081, "link": "https://stackoverflow.com/questions/42083081/how-to-declare-two-data-types-containing-same-variable-in-haskell/42093805#42093805", "title": "How to declare two data types containing same variable in haskell?", "body": "<p>Type Classes are another way to achieve a common interface that you may consider.</p>\n\n<pre><code>data Person = Person { personname :: String -- and some other details\n                     } \n\ndata PetAnimal = PetAnimal { petanimalname :: String  \n                           } \n\nclass HasName a where\n  name :: a -&gt; String\n\ninstance HasName PetAnimal where\n   name = petanimalname\n\ninstance HasName Person where\n   name = personname\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 2477035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1380a31e6e8acf9a0aa4a405dac33e00?s=128&d=identicon&r=PG", "display_name": "Pratyush Rathore", "link": "https://stackoverflow.com/users/2477035/pratyush-rathore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "closed_date": 1486488982, "accepted_answer_id": 42083269, "answer_count": 2, "score": 1, "last_activity_date": 1486481677, "creation_date": 1486448564, "last_edit_date": 1486449953, "question_id": 42083081, "link": "https://stackoverflow.com/questions/42083081/how-to-declare-two-data-types-containing-same-variable-in-haskell", "closed_reason": "Duplicate", "title": "How to declare two data types containing same variable in haskell?", "body": "<p>In a module, I want to add two classes like this. </p>\n\n<pre><code>data Person = Person { name :: String -- and some other details\n                     } \n\ndata PetAnimal = PetAnimal { name :: String  \n                           } \n</code></pre>\n\n<p>I assumed this would work but ghc complains about multiple declrations of name. How do I accomplish this?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1486446218, "post_id": 42082162, "comment_id": 71335812, "body": "What&#39;s the compiler error ?"}, {"owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1486497690, "post_id": 42082162, "comment_id": 71368077, "body": "Oops, added to the question @Sibi"}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1486590924, "post_id": 42082162, "comment_id": 71416793, "body": "<code>registerR</code> doesn&#39;t seem to correspond to convention. Is it handler? Is there <code>RegisterR</code>?"}, {"owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "edited": false, "score": 0, "creation_date": 1486683465, "post_id": 42082162, "comment_id": 71464226, "body": "I have to use <code>registerR</code>, otherwise:     Not in scope: data constructor \u2018RegisterR\u2019     Perhaps you meant one of these:       \u2018Register\u2019 (imported from Yesod.Auth.Message),       variable \u2018registerR\u2019 (imported from Yesod.Auth.Email)     In the splice: $(widgetFile &quot;registrationpage&quot;)"}, {"owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "edited": false, "score": 0, "creation_date": 1486683513, "post_id": 42082162, "comment_id": 71464251, "body": "But well.. that works anyways, the problem is the StaticR reference"}, {"owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1486918455, "post_id": 42082162, "comment_id": 71542602, "body": "Hmm, I can&#39;t quite decipher the type error. The problem should not be in using <code>StaticR</code>, since then <code>HomeR</code> should also give an error. I just tried referring to it in my own custom register handler and it works fine. One thing though, you might need to do <code>touch Settings&#47;StaticFiles.hs</code> to make it pick up new static files."}, {"owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1486918530, "post_id": 42082162, "comment_id": 71542632, "body": "Also, how is your <code>registrationForm</code> form defined? It might be the case that you are returning <code>(userRes, widget)</code> instead of <code>return (userRes, widget)</code>, with the former case not working."}], "owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1486497663, "creation_date": 1486444096, "last_edit_date": 1486497663, "question_id": 42082162, "link": "https://stackoverflow.com/questions/42082162/yesod-access-staticr-image-from-authr", "title": "Yesod: access StaticR image from AuthR", "body": "<p>So I have a widget for the a registration form in the Auth subsite:</p>\n\n<pre><code>customRegisterHandler = do\n(widget, enctype) &lt;- lift $ generateFormPost registrationForm\ntoParentRoute &lt;- getRouteToParent\nlift $ authLayout $ do\n    setTitle \"Reg\"\n    $(widgetFile \"registrationpage\")\n</code></pre>\n\n<p>But I need a logo (in StaticR) pointing to the homepage:</p>\n\n<pre><code>&lt;a href=\"@{HomeR}\"&gt;\n    &lt;img src='@{StaticR img_logo_name_png}'&gt;\n\n&lt;form method=\"post\" action=\"@{toParentRoute registerR}\" enctype=#{enctype}&gt;\n    &lt;div #registerForm .form-group&gt;\n        ^{widget}\n    &lt;button .btn .btn-success&gt;Reg\n</code></pre>\n\n<p>That of course gives me a compiler error, how could I achieve that?</p>\n\n<p><strong>Edit</strong>, compiler error:</p>\n\n<pre><code>    Couldn't match type \u2018master\u2019 with \u2018App\u2019\n  \u2018master\u2019 is a rigid type variable bound by\n           the type signature for\n             customRegisterHandler :: (YesodAuthEmail master,\n                                       YesodAuth master) =&gt;\n                                      HandlerT Auth (HandlerT master IO) Html\n           at Foundation.hs:323:26\nExpected type: WidgetT\n                 master IO (Route App -&gt; [(Text, Text)] -&gt; Text)\n  Actual type: WidgetT\n                 master\n                 IO\n                 (Route (HandlerSite (WidgetT master IO)) -&gt; [(Text, Text)] -&gt; Text)\nRelevant bindings include\n  toParentRoute :: Route Auth -&gt; Route master\n    (bound at Foundation.hs:326:5)\n  widget :: WidgetT master IO () (bound at Foundation.hs:325:6)\n  customRegisterHandler :: HandlerT Auth (HandlerT master IO) Html\n    (bound at Foundation.hs:324:1)\nIn the first argument of \u2018(&gt;&gt;=)\u2019, namely \u2018getUrlRenderParams\u2019\nIn a stmt of a 'do' block:\n  (getUrlRenderParams\n   &gt;&gt;=\n     (\\ urender_aQgm\n        -&gt; (asWidgetT GHC.Base.. toWidget)\n             (toHtml (\\ u_aQgn -&gt; urender_aQgm u_aQgn [] HomeR))))\n</code></pre>\n"}, {"tags": ["haskell", "emacs", "org-mode", "literate-programming", "org-babel"], "comments": [{"owner": {"reputation": 1278, "user_id": 1185179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/776f28ab850903865a90b52c2f90a220?s=128&d=identicon&r=PG", "display_name": "brittAnderson", "link": "https://stackoverflow.com/users/1185179/brittanderson"}, "edited": false, "score": 0, "creation_date": 1486475314, "post_id": 42081379, "comment_id": 71353156, "body": "You might find this other question useful: <a href=\"http://stackoverflow.com/questions/42081379/how-to-set-up-org-babel-for-haskell-with-stack\" title=\"how to set up org babel for haskell with stack\">stackoverflow.com/questions/42081379/&hellip;</a>"}, {"owner": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1486487343, "post_id": 42081379, "comment_id": 71362106, "body": "You need to load <code>ob-haskell.el</code>  (or add haskell to <code>org-babel-load-languages</code> and restart emacs) before you can try evaluating haskell code blocks. That should get rid of the &quot;No org-babel-execute function for haskell&quot; message at least."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 1278, "user_id": 1185179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/776f28ab850903865a90b52c2f90a220?s=128&d=identicon&r=PG", "display_name": "brittAnderson", "link": "https://stackoverflow.com/users/1185179/brittanderson"}, "edited": false, "score": 1, "creation_date": 1486528398, "post_id": 42081379, "comment_id": 71379025, "body": "@brittUWaterloo, I believe you linked to this very question of mine."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1486528416, "post_id": 42081379, "comment_id": 71379035, "body": "@Nick, ob-haskell.el from where?"}, {"owner": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1486573491, "post_id": 42081379, "comment_id": 71406931, "body": "It&#39;s part of &quot;official&quot; org-mode: you should be able to just say <code>(require &#39;ob-haskell)</code> and get it loaded. But I&#39;m not sure whether it is going to help with anything other than that initial problem, which you might (or might not) have gotten past by now."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1486788104, "post_id": 42081379, "comment_id": 71509114, "body": "Thanks, @Nick.  Yep, you&#39;re right, I loaded that and same hanging message."}, {"owner": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "edited": false, "score": 0, "creation_date": 1487348523, "post_id": 42081379, "comment_id": 71760211, "body": "&quot;org-babel-haskell-eoe&quot; is a marker that ob-haskell uses to separate the results from the rest of the interpreter output, so that it can cut out the chaff and present the results in the org-mode buffer."}], "answers": [{"tags": [], "owner": {"reputation": 4583, "user_id": 2561714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d92663322e652223379492f83bbaa?s=128&d=identicon&r=PG", "display_name": "NickD", "link": "https://stackoverflow.com/users/2561714/nickd"}, "is_accepted": false, "score": 6, "last_activity_date": 1493689453, "last_edit_date": 1493689453, "creation_date": 1487348155, "answer_id": 42302563, "question_id": 42081379, "link": "https://stackoverflow.com/questions/42081379/how-to-set-up-org-babel-for-haskell-with-stack/42302563#42302563", "title": "How to set up org-babel for Haskell with Stack", "body": "<p>This is <em>not</em> a complete answer: in particular, it does not even mention Stack. But I (a complete ignoramus on Haskell) wanted to find out what it would take to get the OP's test program to run in babel. Here's what I found:</p>\n\n<ul>\n<li><p>You need a haskell interpreter ;-) I'm on Fedora 24, so I installed the ghc-compiler package and I got ghci.</p></li>\n<li><p>You need <code>haskell-mode</code>. I installed that from MELPA, using the emacs package manager. That also installed <code>inf-haskell.el</code></p></li>\n<li><p>By default, <code>inf-haskell</code> wants to run <code>hugs</code>, so I customized <code>haskell-program-name</code> and set it to \"ghci\".</p></li>\n<li><p><code>M-x load-library RET ob-haskell RET</code></p></li>\n<li><p>C-c C-c on the code block: the first time it fails and the <em>Messages</em> buffer shows \"Buffer haskell.org does not exist or has no process\".</p></li>\n<li><p>But if you do it C-c C-c on the code block again, it succeeds!</p></li>\n</ul>\n\n<p>Obviously, <code>ob-haskell.el</code> needs some work - and that's before we even get to Stack, of which I know even less than I know of Haskell, so I'll leave that as an exercise for the interested reader :-) </p>\n\n<p>EDIT: Re. version info (requested in a comment): I keep close to the bleeding edge. At this point in time (2017-05-01), I run <code>Org mode version 9.0.5 (release_9.0.5-444-g998576 @ /home/nick/elisp/org-mode/lisp/)</code> and <code>GNU Emacs 26.0.50 (build 1, x86_64-pc-linux-gnu, GTK+ Version 3.20.10) of 2017-04-14</code></p>\n"}, {"tags": [], "owner": {"reputation": 289, "user_id": 3058777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d4b39d6178c817b17903dc2b08cd0d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Testare", "link": "https://stackoverflow.com/users/3058777/testare"}, "is_accepted": false, "score": 0, "last_activity_date": 1515695639, "creation_date": 1515695639, "answer_id": 48213756, "question_id": 42081379, "link": "https://stackoverflow.com/questions/42081379/how-to-set-up-org-babel-for-haskell-with-stack/48213756#48213756", "title": "How to set up org-babel for Haskell with Stack", "body": "<p>It is probably because of the custom prompt: I had the same issue, and when I removed \":set +t\" and \":set prompt \"GHCI >\" from ~/.ghci, it worked. I fiddled with it some, and it seems it will work so long as your custom prompt doesn't have any spaces in it except the end (I changes mine to \"GHCI> \" and it works). It seems to be that the regular expression it parses the information from assumes the prompt will have no spaces in it.</p>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 246387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5f1ece756283052f00c4b9c3987b6dd9?s=128&d=identicon&r=PG", "display_name": "Azriel", "link": "https://stackoverflow.com/users/246387/azriel"}, "is_accepted": false, "score": 1, "last_activity_date": 1552915379, "creation_date": 1552915379, "answer_id": 55222413, "question_id": 42081379, "link": "https://stackoverflow.com/questions/42081379/how-to-set-up-org-babel-for-haskell-with-stack/55222413#55222413", "title": "How to set up org-babel for Haskell with Stack", "body": "<p>what i did after installed <code>stack</code> and <code>ghci</code> (with stack itself)), was to install <code>intero</code> in emacs and then add those to <code>init.el</code>:  </p>\n\n<pre><code> (setq haskell-process-type 'stack-ghci)\n ((org-babel-do-load-languages\n     'org-babel-load-languages\n        '((haskell . t)))\n</code></pre>\n\n<p>after that i can C-c C-c in haskell code block and i get a result under the code block.</p>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2902, "favorite_count": 4, "answer_count": 3, "score": 19, "last_activity_date": 1552915379, "creation_date": 1486439395, "last_edit_date": 1495540027, "question_id": 42081379, "link": "https://stackoverflow.com/questions/42081379/how-to-set-up-org-babel-for-haskell-with-stack", "title": "How to set up org-babel for Haskell with Stack", "body": "<p>I'm running:</p>\n\n<ul>\n<li>GNU Emacs 24.4.1 </li>\n<li>Stack Version 1.3.3</li>\n<li>org-mode</li>\n<li>haskell-mode</li>\n</ul>\n\n<p>I've looked through:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/27002877/emacs-org-mode-literate-haskell\">Emacs Org-Mode &amp; Literate Haskell</a></li>\n<li><a href=\"https://gist.github.com/reetinder/4022989\" rel=\"noreferrer\">https://gist.github.com/reetinder/4022989</a></li>\n<li><a href=\"https://wiki.haskell.org/Emacs/Literate_programming\" rel=\"noreferrer\">https://wiki.haskell.org/Emacs/Literate_programming</a></li>\n<li><a href=\"https://wiki.haskell.org/Literate_programming\" rel=\"noreferrer\">https://wiki.haskell.org/Literate_programming</a></li>\n<li><a href=\"https://github.com/haskell/haskell-mode/issues/1429\" rel=\"noreferrer\">https://github.com/haskell/haskell-mode/issues/1429</a></li>\n</ul>\n\n<p>While the gist above looks promising, I haven't found anything that looked to be an authoritative way to get org-haskell running (eg, nothing on melpa), and certainly nothing aimed specifically at whatever intricacy running a stack environment rather than using my global ghc would entail.</p>\n\n<p>When I try to:</p>\n\n<pre><code>#+BEGIN_SRC haskell\nlet x = \"test\"\nputStrLn x\n#+END_SRC\n</code></pre>\n\n<p>I get</p>\n\n<blockquote>\n  <p>executing Haskell code-block</p>\n</blockquote>\n\n<p>...which hangs forever.  When I C-g, I see:</p>\n\n<pre><code>GHCi, version 7.6.3: http://www.haskell.org/ghc/  :? for help\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\nSome flags have not been recognized: prompt2, ghci     | \nghci    \u03bb&gt; let x = \"TESTING!\"\nputStrLn x\n\"org-babel-haskell-eoe\"\nPrelude| \n&lt;interactive&gt;:4:1: parse error on input `putStrLn'\nghci    \u03bb&gt; \"org-babel-haskell-eoe\"\n</code></pre>\n\n<p>When I tab to the haskell buffer, I see it has genuinely evaluated what I sent, it just has this org-babel-haskell-eoe error and never returns control to my org session.</p>\n\n<p>Any chance this is because I have a custom prompt?  Using the lambda instead of Prelude> ?</p>\n"}, {"tags": ["haskell", "random"], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 10, "last_activity_date": 1486421182, "creation_date": 1486421182, "answer_id": 42078656, "question_id": 42078395, "link": "https://stackoverflow.com/questions/42078395/how-to-use-a-random-generator-using-function-with-fmap-in-haskell/42078656#42078656", "title": "How to use a random generator-using function with fmap in haskell?", "body": "<p>I cannot say anything about the neural networks side of this problem (I hope someone posts something about that). From a general Haskeller's perspective, it looks like you should be doing your computation inside some sort of random monad. For example, <a href=\"https://hackage.haskell.org/package/MonadRandom-0.5/docs/Control-Monad-Random-Class.html#t:MonadRandom\"><code>MonadRandom</code></a>.</p>\n\n<p>Then, your <code>rmap</code>'s signature turns into something like:</p>\n\n<pre><code>rmap :: MonadRandom m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\n</code></pre>\n\n<p>Just looking at that signature, you may realize that <code>rmap</code> is <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html#v:traverse\"><code>traverse</code></a> in disguise.</p>\n\n<p>The key pattern to recognize here is that things that look like <code>StdGen -&gt; a -&gt; (b,StdGen)</code> can be transformed into <code>a -&gt; m b</code> for a random monad (that may even be <code>IO</code>). Once you see that, you can start using the full power of Haskell's monad utilities.</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 8, "last_activity_date": 1486426039, "last_edit_date": 1486426039, "creation_date": 1486421501, "answer_id": 42078731, "question_id": 42078395, "link": "https://stackoverflow.com/questions/42078395/how-to-use-a-random-generator-using-function-with-fmap-in-haskell/42078731#42078731", "title": "How to use a random generator-using function with fmap in haskell?", "body": "<p>This is what the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html\"><code>Traversable</code></a> class is for. <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html#v:mapAccumL\"><code>mapAccumL</code></a> (along with its back-to-front twin <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html#v:mapAccumR\"><code>mapAccumR</code></a>) is a higher-order function which captures a sort of generalised fold-and-map operation, statefully working across a traversable structure and transforming the elements. Your randomised mapping function is an example of this pattern - as you can see, <code>mapAccumL</code>'s type matches the type of your function quite closely:</p>\n\n<pre><code>mapAccumL :: Traversable t =&gt; (a      -&gt; b -&gt; (a, c))      -&gt; a      -&gt; t b -&gt; (a, t c)\nrmap      ::                  (StdGen -&gt; a -&gt; (b, StdGen)) -&gt; StdGen -&gt; [a] -&gt; ([b], StdGen)\n</code></pre>\n\n<p>We can set <code>t ~ []</code> and <code>a ~ StdGen</code>, so that <code>rmap</code> is basically another name for <code>mapAccumL</code>, after some tuple-flipping.</p>\n\n<pre><code>rmap f z = swap . mapAccumL (\\x y -&gt; swap (f x y)) z\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 3537183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca53f55c0774cbd11d7071ac6bc8422?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Klinkhammer", "link": "https://stackoverflow.com/users/3537183/eric-klinkhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 1, "accepted_answer_id": 42078731, "answer_count": 2, "score": 7, "last_activity_date": 1486426039, "creation_date": 1486419912, "last_edit_date": 1486421140, "question_id": 42078395, "link": "https://stackoverflow.com/questions/42078395/how-to-use-a-random-generator-using-function-with-fmap-in-haskell", "title": "How to use a random generator-using function with fmap in haskell?", "body": "<p>I am researching with evolutionary neural networks, and am using HNN. My first question is if there exist any evolutionary algorithm frameworks in Haskell already, as I was not able to find any?</p>\n\n<p>I am currently struggling to find a way to mutate the weights of the neural network in a general way. At the moment, I am trying to map a random function (of of the form <code>(RandomGen g) =&gt; g -&gt; a -&gt; (b,g)</code>) over the <code>HMatrix</code> of weights.</p>\n\n<p>I would like a generalizable way to modify an existing fmap (or fold?) to make use of a random function if it can be done. For example, I might have a function that may or may not add some Gaussian noise to its input, and would like that to apply to the entire network. The problem I'm having is how to work with the random number generators.</p>\n\n<p>For map, I am currently doing the following:</p>\n\n<pre><code>rmap :: (StdGen -&gt; a -&gt; (b,StdGen)) -&gt; StdGen -&gt; [a] -&gt; ([b],StdGen)\nrmap _ g [] = ([],g)\nrmap f g (x:xs) = let (mapped, g') = rmap f g xs\n                      (rVal, g'')  = f g' x\n                   in (rVal:mapped, g'')\n</code></pre>\n\n<p>This seems like a hack to me, and I was hoping some of the better haskellers might have some advice on how to deal with this randomness more effectively?</p>\n"}, {"tags": ["haskell", "heist"], "comments": [{"owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 0, "creation_date": 1486414247, "post_id": 42075687, "comment_id": 71325425, "body": "Does <code>renderTemplate</code> work with a very simple template with no splices (maybe even just <code>&lt;html&gt;&lt;&#47;html&gt;</code>) and <code>id</code> for your <code>(HeistState IO -&gt; HeistState IO)</code> function?"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "edited": false, "score": 0, "creation_date": 1486466489, "post_id": 42075687, "comment_id": 71347142, "body": "Same result with the above suggestions."}], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": true, "score": 1, "last_activity_date": 1491155589, "last_edit_date": 1491155589, "creation_date": 1486562511, "answer_id": 42115188, "question_id": 42075687, "link": "https://stackoverflow.com/questions/42075687/rendering-a-heist-template-returns-nothing/42115188#42115188", "title": "Rendering a heist template returns nothing", "body": "<p>Finally figured this out... I needed to specify a template location...</p>\n\n<pre><code>renderTemplate :: String -&gt; (HeistState IO -&gt; HeistState IO) -&gt; ActionM ()\nrenderTemplate fileName hsBinding = do\n  let emptyI = return () :: MapSyntax Text (I.Splice IO)\n  let emptyC = return () :: MapSyntax Text (HeistCom.Splice IO)\n  let emptyA = return () :: MapSyntax Text (AttrSplice IO)\n  let templateLocations = [Heist.loadTemplates \"templates/\"]\n  let spliceConfig = SpliceConfig emptyI emptyI emptyC emptyA templateLocations (\\_ -&gt; False):: SpliceConfig IO\n  heist &lt;- lift $ Heist.initHeist (HeistConfig spliceConfig \"\" True)\n  case heist of\n    Right heist' -&gt; do\n      rendered &lt;- lift $ I.renderTemplate (hsBinding heist') $ convertString fileName\n      case (rendered) of\n        Just (builder, _) -&gt; do\n          html . convertString $ toLazyByteString builder\n        Nothing -&gt; error \"heist error\"\n    Left a -&gt; error . convertString $ show a\n</code></pre>\n\n<p>And the render path should not have the directory specified:</p>\n\n<pre><code>renderTemplate \"compareForm\"  $ I.bindSplice \"test\" $ I.textSplice \"abcxyz\"\n</code></pre>\n\n<p>The above might not work for compiled templates, one would probably need to modify this line (probably the <code>(\\_ -&gt; False)</code>:\n<code>let spliceConfig = SpliceConfig emptyI emptyI emptyC emptyA templateLocations (\\_ -&gt; False):: SpliceConfig IO</code></p>\n\n<p>There are potential performance implications with the above, see <a href=\"https://github.com/snapframework/heist/issues/102\" rel=\"nofollow noreferrer\">https://github.com/snapframework/heist/issues/102</a></p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 42115188, "answer_count": 1, "score": 0, "last_activity_date": 1491155589, "creation_date": 1486409043, "question_id": 42075687, "link": "https://stackoverflow.com/questions/42075687/rendering-a-heist-template-returns-nothing", "title": "Rendering a heist template returns nothing", "body": "<pre><code>import Data.String.Conversions\nimport Data.Maybe (isJust)\nimport qualified Heist\nimport qualified Heist.Interpreted as I\nimport qualified Heist.Compiled as HeistCom\nimport Heist.Internal.Types\nimport qualified Text.XmlHtml as X\nimport Data.List (sortBy)\nimport Data.Map.Syntax\nimport Data.ByteString.Builder (toLazyByteString)\n\nrenderTemplate :: String -&gt; (HeistState IO -&gt; HeistState IO) -&gt; ActionM ()\nrenderTemplate fileName hsBinding = do\n  let emptyI = return () :: MapSyntax Text (I.Splice IO)\n  let emptyC = return () :: MapSyntax Text (HeistCom.Splice IO)\n  let emptyA = return () :: MapSyntax Text (AttrSplice IO)\n  let spliceConfig = SpliceConfig emptyI emptyI emptyC emptyA [] (\\_ -&gt; False):: SpliceConfig IO\n  heist &lt;- lift $ Heist.initHeist (HeistConfig spliceConfig \"\" True)\n  case heist of\n    Right heist' -&gt; do\n      rendered &lt;- lift $ I.renderTemplate (hsBinding heist') $ convertString fileName\n      case (rendered) of\n        Just (builder, _) -&gt; do\n          lift $ print $ toLazyByteString builder\n        Nothing -&gt; error \"heist error\"\n    Left a -&gt; error . convertString $ show a\n</code></pre>\n\n<p>I'm calling the function this way:</p>\n\n<pre><code>renderTemplate \"templates/compareForm\"  $ I.bindSplice \"test\" $ I.textSplice \"abcxyz\"\n</code></pre>\n\n<p>I'm guessing it's to do with the config. I have not thoroughly thought through the above config.</p>\n\n<p>Unfortunately the above is just generating an error of \"heist error\" (the second last line). So my question is why? My next step would be to investigate the <code>Heist.Interpreted.renderTemplate</code> function.</p>\n"}, {"tags": ["haskell", "syntax", "parse-error", "let", "do-notation"], "answers": [{"comments": [{"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "edited": false, "score": 0, "creation_date": 1486420472, "post_id": 42074538, "comment_id": 71328626, "body": "Why are two spaces not enough to make it part of the <code>do</code> block? Note that it&#39;s not directly part of the <code>let</code>, since no value is assigned to it."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "edited": false, "score": 1, "creation_date": 1486421505, "post_id": 42074538, "comment_id": 71329024, "body": "@Turion Haskell\u2019s layout rules require that everything on the RHS of a <code>let</code> or <code>where</code> be indented <i>at least</i> as far as the first column of the pattern on the LHS. In your first example, <code>baz</code> isn\u2019t indented as far as <code>bar</code>, which is not okay, but in the second example it is."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1486404914, "creation_date": 1486404914, "answer_id": 42074538, "question_id": 42074429, "link": "https://stackoverflow.com/questions/42074429/why-is-this-a-parse-error-in-do-notation/42074538#42074538", "title": "Why is this a parse error in do notation?", "body": "<p>The problem is the indentation puts <code>baz</code> in no-mans land. It isn't indented far enough to be part of the <code>let</code> expression, but it is indented too far to be the next part of the <code>do</code> expression containing the <code>let</code> expression.</p>\n"}], "owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 42074538, "answer_count": 1, "score": 1, "last_activity_date": 1486404914, "creation_date": 1486404467, "question_id": 42074429, "link": "https://stackoverflow.com/questions/42074429/why-is-this-a-parse-error-in-do-notation", "title": "Why is this a parse error in do notation?", "body": "<p>Consider the following code:</p>\n\n<pre><code>foo = do\n  let bar = do\n    baz\n  bar\n</code></pre>\n\n<p>It doesn't parse in <code>ghc</code>, version 8. It complains about the line containing <code>baz</code>. This code does parse, though:</p>\n\n<pre><code>foo = do\n  let bar = do\n      baz\n  bar\n</code></pre>\n\n<p>I find this confusing. What's the essential difference between the two versions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1486402057, "post_id": 42073692, "comment_id": 71318698, "body": "Well what about <code>sudokuElements [] _</code>? and <code>sudokuElements ((x:_):_)</code> and <code>sudokuElements ([x]:([xs]:_))</code>, etc."}, {"owner": {"reputation": 1, "user_id": 5536499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c521f70c4a84818ee65cc6fe758c731e?s=128&d=identicon&r=PG&f=1", "display_name": "Umar", "link": "https://stackoverflow.com/users/5536499/umar"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486402508, "post_id": 42073692, "comment_id": 71318966, "body": "I tried it but it gives the error &#39;Equations of sudokoElements have different number of arguments&#39;..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486402551, "post_id": 42073692, "comment_id": 71319000, "body": "Enable warnings with <code>-Wall</code> and GHC will tell you what cases you missed. I also notice that the last pattern has a guard! When that is false, the function is undefined. Worse, it is <i>always</i> false since <code>[x]:[[xs]] == [inputBoardElements]</code> compares a list of length 2 to a list of length 1..."}, {"owner": {"reputation": 1, "user_id": 5536499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c521f70c4a84818ee65cc6fe758c731e?s=128&d=identicon&r=PG&f=1", "display_name": "Umar", "link": "https://stackoverflow.com/users/5536499/umar"}, "edited": false, "score": 0, "creation_date": 1486403226, "post_id": 42073692, "comment_id": 71319396, "body": "Yes i made the last case as undefined...but some patterns are still missing i think, which are they??"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486408980, "post_id": 42073692, "comment_id": 71322679, "body": "<i>Most</i> patterns are missing. Judging from your first equation, for example, you appear to think that <code>[[]]</code> is the empty list of type <code>[[BoardElement]]</code>. It is not; it is a list containing a single empty list. <code>[]</code> is the empty list of type <code>[[BoardElement]]</code>, just as it is for lists of <i>any</i> type <code>[a]</code> (no matter what <code>a</code> is)."}, {"owner": {"reputation": 1, "user_id": 5536499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c521f70c4a84818ee65cc6fe758c731e?s=128&d=identicon&r=PG&f=1", "display_name": "Umar", "link": "https://stackoverflow.com/users/5536499/umar"}, "edited": false, "score": 0, "creation_date": 1486419669, "post_id": 42073692, "comment_id": 71328277, "body": "Can you please tell which patterns are missing??"}, {"owner": {"reputation": 1, "user_id": 5536499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c521f70c4a84818ee65cc6fe758c731e?s=128&d=identicon&r=PG&f=1", "display_name": "Umar", "link": "https://stackoverflow.com/users/5536499/umar"}, "edited": false, "score": 0, "creation_date": 1486571516, "post_id": 42073692, "comment_id": 71405525, "body": "i&#39;m writing the following as the base cases now: sudokuElements [] _ = [] sudokuElements _ [] = [] sudokuElements ([]:_) (<i>:</i>) = []  But still i get the error non-exhaustive patterns in the function sudokuElements...whats wrong with the code??"}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 2249759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e2c871a2d9f70e16c7593b73c5c062?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/2249759/martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1486425714, "creation_date": 1486425714, "answer_id": 42079472, "question_id": 42073692, "link": "https://stackoverflow.com/questions/42073692/the-following-code-gives-the-error-non-exhaustive-pattern-in-function-sudokuele/42079472#42079472", "title": "The following code gives the error &#39;Non-exhaustive pattern in function sudokuElements&#39;...whats wrong with the code? How can i correct it?", "body": "<p>I guess you can fix this by adding <code>sudokuElements _ _ = []</code> to the <em>end</em> of your definition, so:</p>\n\n<pre><code>sudokuElements ([x]:[[xs]]) (y:[ys])\n    | ([x]:[[xs]]) == [inputBoardElements] &amp;&amp; (y:[ys]) == inputBoardEmpty =\n        [\n            (j, i) |\n            i &lt;- (validVals [x] y),\n            j &lt;- [y]\n        ] : sudokuElements [[xs]] [ys]\nsudokuElements _ _ = []\n</code></pre>\n\n<p>For the missing patterns please have a look at chepners comment, he explained it quite well:</p>\n\n<blockquote>\n  <p>Most patterns are missing. Judging from your first equation, for example, you appear to think that <code>[[]]</code> is the empty list of type <code>[[BoardElement]]</code>. It is not; it is a list containing a single empty list. <code>[]</code> is the empty list of type <code>[[BoardElement]]</code>, just as it is for lists of any type <code>[a]</code> (no matter what a is). \n  Are we solving your homework assignment here ;) </p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 5536499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c521f70c4a84818ee65cc6fe758c731e?s=128&d=identicon&r=PG&f=1", "display_name": "Umar", "link": "https://stackoverflow.com/users/5536499/umar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1486425714, "creation_date": 1486401901, "last_edit_date": 1486402892, "question_id": 42073692, "link": "https://stackoverflow.com/questions/42073692/the-following-code-gives-the-error-non-exhaustive-pattern-in-function-sudokuele", "title": "The following code gives the error &#39;Non-exhaustive pattern in function sudokuElements&#39;...whats wrong with the code? How can i correct it?", "body": "<pre><code>sudokuElements :: [[BoardElement]] -&gt; [Coords] -&gt; [[BoardElement]]\nsudokuElements [[]] _ = [[]]\nsudokuElements _ [] = [[]]\nsudokuElements ([x]:[[xs]]) (y:[ys])\n    | ([x]:[[xs]]) == [inputBoardElements] &amp;&amp; (y:[ys]) == inputBoardEmpty =\n        [\n            (j, i) |\n            i &lt;- (validVals [x] y),\n            j &lt;- [y]\n        ] : sudokuElements [[xs]] [ys]\n</code></pre>\n"}, {"tags": ["haskell", "opengl", "glut"], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 7325954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/391363977868442/picture?type=large", "display_name": "Jaskirat Singh", "link": "https://stackoverflow.com/users/7325954/jaskirat-singh"}, "edited": false, "score": 2, "creation_date": 1522830852, "post_id": 42078615, "comment_id": 86300647, "body": "Actually I also faced the same problem. I was not able to know where the dll file was to be copied. So, what I did was :                                                             sudo apt-get install haskell-platform                                     The glutInit function is provided by freeglut(as mentioned in the answer) which is installed using the above command."}], "tags": [], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "is_accepted": false, "score": 4, "last_activity_date": 1486422219, "last_edit_date": 1486422219, "creation_date": 1486421024, "answer_id": 42078615, "question_id": 42072958, "link": "https://stackoverflow.com/questions/42072958/haskell-with-opengl-unknown-glut-entry-glutinit/42078615#42078615", "title": "Haskell with OpenGL. (Unknown GLUT entry glutInit)", "body": "<p>I've encountered same problem and found the <a href=\"https://www.reddit.com/r/haskellquestions/comments/31kb85/having_trouble_getting_gloss_to_install_on_windows/\" rel=\"nofollow noreferrer\">solution</a>.</p>\n\n<p>Use <a href=\"http://files.transmissionzero.co.uk/software/development/GLUT/freeglut-MinGW.zip\" rel=\"nofollow noreferrer\">this</a>(<a href=\"http://www.transmissionzero.co.uk/software/freeglut-devel/\" rel=\"nofollow noreferrer\">source</a>). Copy <code>freeglut/bin/(platform)/freeglut.dll</code> to your executable path and rename it to <code>glut32.dll</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 7524307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f26b53f6142c84a187acb087c30fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas Jonasson", "link": "https://stackoverflow.com/users/7524307/jonas-jonasson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3731, "favorite_count": 0, "closed_date": 1487168987, "answer_count": 1, "score": 2, "last_activity_date": 1486422219, "creation_date": 1486399465, "question_id": 42072958, "link": "https://stackoverflow.com/questions/42072958/haskell-with-opengl-unknown-glut-entry-glutinit", "closed_reason": "Duplicate", "title": "Haskell with OpenGL. (Unknown GLUT entry glutInit)", "body": "<p>I need help getting OpenGL and GLUT to work using Haskell.</p>\n\n<p>Running a windows 10 system.\nI have installed the OpenGL package using <code>cabal</code>, but when I try to run the following program (and similar tutorial-like short programs):</p>\n\n<pre><code>import Graphics.UI.GLUT\n\nmain :: IO ()\nmain = do\n  (_progName, _args) &lt;- getArgsAndInitialize\n  _window &lt;- createWindow \"Hello World\"\n  displayCallback $= display\n  mainLoop\n\ndisplay :: DisplayCallback\ndisplay = do\n  clear [ ColorBuffer ]\n  flush\n</code></pre>\n\n<p>All I get is: </p>\n\n<pre><code>main: user error (unknown GLUT entry glutInit)\n</code></pre>\n\n<p>I have looked around for solutions but come up empty handed.</p>\n"}, {"tags": ["list", "function", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486401807, "post_id": 42072187, "comment_id": 71318545, "body": "You could rewrite the function as <code>h s = zipWith (&lt;=) s (tail s)</code> which might make it easier to read."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486407400, "post_id": 42072187, "comment_id": 71321811, "body": "@Taren: not entirely because the original <code>h</code> will return <code>[]</code> for the empty list whereas you definition will crash. But I admit it is a detail :)."}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486407754, "post_id": 42072187, "comment_id": 71321997, "body": "@WillemVanOnsem Actually, if s is empty (tail s) is never evaluated and it works fine! All hail to laziness or something."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 1, "creation_date": 1486407854, "post_id": 42072187, "comment_id": 71322060, "body": "@Taren: Well here you run in <i>undefined</i> behavior :). It has nothing to do with laziness itself, but with the fact that the first operand is evaluated first. One could write a <code>zip</code> function that first verifies the second operand :) for instance <code>zipWith f _ [] = []</code>, <code>zipWith f [] _ = []</code>, <code>zipWith f (x:xs) (y:ys) = (f x y) : zipWith f xs ys</code> could fail :)"}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486407965, "post_id": 42072187, "comment_id": 71322111, "body": "@WillemVanOnsem Can&#39;t think of any function in the prelude that is lazy in its first argument but you are totally right."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1486458636, "post_id": 42072187, "comment_id": 71341831, "body": "@WillemVanOnsem Not really undefined: the <a href=\"https://www.haskell.org/onlinereport/standard-prelude.html\" rel=\"nofollow noreferrer\">Haskell report</a> gives a specification of zipWith. Your definition wouldn&#39;t be compatible."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1486397700, "creation_date": 1486397700, "answer_id": 42072370, "question_id": 42072187, "link": "https://stackoverflow.com/questions/42072187/lists-in-functional-programming-more-specifically-in-haskell/42072370#42072370", "title": "Lists in functional programming, more specifically in Haskell", "body": "<blockquote>\n  <p>what does the third condition <code>h (x:y:ys) = (x &lt;= y): (h (y:ys))</code> really mean ?</p>\n</blockquote>\n\n<p>Well it is short for:</p>\n\n<pre><code>h (x:<b>(y:ys)</b>) = (x &lt;= y): (h (y:ys))</code></pre>\n\n<p>Well it matches given the list contains <strong>at least two elements</strong>. In that case it compares the first with the second element <code>x &lt;= y</code> and if the outcome, a <code>Bool</code> is placed in the head of the resulting list. It next does a recursive call to <code>h</code> with the second element and the remaining elements.</p>\n\n<p>So what does the function calculates? <strong>(1)</strong> For a given list of <em>n</em> elements, it returns a list of <em>n-1</em> booleans that says for every two consecutive numbers whether the list is (not strictly) increasing. So to answer you first question.</p>\n\n<p>Furthermore for a given list of <em>n</em> elements, it returns a list of <em>n-1</em> elements, so if you give it a list of 100 elements, it <strong>(2)</strong> returns a list of 99 elements.</p>\n\n<p>Finally for <code>h [1..5]</code> it means we will get <strong>(3)</strong> <code>[True,True,True,True]</code> and for <code>h [1,2,1,2,1]</code> we will get <strong>(4)</strong> <code>[True,False,True,False]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1486397769, "creation_date": 1486397769, "answer_id": 42072393, "question_id": 42072187, "link": "https://stackoverflow.com/questions/42072187/lists-in-functional-programming-more-specifically-in-haskell/42072393#42072393", "title": "Lists in functional programming, more specifically in Haskell", "body": "<p>The full type of <code>h</code> is <code>Ord a =&gt; [a] -&gt; [Bool]</code>.</p>\n\n<ol>\n<li><p>The first two equations imply that both the input and output are lists of some type. For our first pass, we'll assume <code>h :: [a] -&gt; [b]</code>; we'll figure out what constraints, if any, belong on <code>a</code> and <code>b</code> next.</p></li>\n<li><p>The first two values in the input list in the 3rd equation are used by <code>(&lt;=) :: Ord a =&gt; a -&gt; a -&gt; Bool</code>, so we now know that the input list must be <code>Ord a =&gt; [a]</code>.</p></li>\n<li><p>Further, the result of <code>(&lt;=)</code> is prepended to the return value of the recursive call to <code>h</code>. For that to work, since <code>(:) :: a -&gt; [a] -&gt; [a]</code>, we know that <code>h</code> must return a value of type <code>[Bool]</code>.</p></li>\n</ol>\n"}], "owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 42072370, "answer_count": 2, "score": 1, "last_activity_date": 1486399757, "creation_date": 1486397177, "last_edit_date": 1486399757, "question_id": 42072187, "link": "https://stackoverflow.com/questions/42072187/lists-in-functional-programming-more-specifically-in-haskell", "title": "Lists in functional programming, more specifically in Haskell", "body": "<p>I am studying Haskell and saw this question :</p>\n\n<pre><code>h [] = []\nh [x] = []\nh (x:y:ys) = (x &lt;= y): (h (y:ys)) \n</code></pre>\n\n<p>the questions are, (1) what is the output type of <code>h</code>? (2) if length of <code>xs</code> is 100 then what is length of <code>h xs</code>? (3) calculate <code>h [1..5]</code> and (4) <code>h [1,2,1,2,1]</code></p>\n\n<p>I don't understand how to proceed with this.  What does the third condition <code>h (x:y:ys) = (x &lt;= y): (h (y:ys))</code> mean ?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 2, "creation_date": 1486386564, "post_id": 42067603, "comment_id": 71308383, "body": "Sadly, the typeclass hierarchy for &quot;numbers&quot; (or &quot;basic algebra stuff&quot;, or whatever one should call it) was quite badly thought out from the beginning. Maybe you are better off sidestepping it completely for your <code>Complex a</code>? There exists <a href=\"https://hackage.haskell.org/package/numeric-prelude\" rel=\"nofollow noreferrer\">an alternative hierarchy</a>, but it&#39;s maybe a bit overkill for your situation.  Said differently: You seem to want a principled way to make a typeclass for complex numbers. The standard typeclasses like <code>Num</code> that you are wanting to work with are very ad-hoc :-("}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 2, "creation_date": 1486398029, "post_id": 42067603, "comment_id": 71316263, "body": "@gspr: the number hierarchy may not be optimal, but in practice it works quite fine. As far as this use case is concerned \u2013 in almost all real-world applications of complex numbers, you would require <code>Floating</code> anyway; complex numbers are mostly useful in a context of roots and/or exponentials (to describe oscillations)."}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1486398452, "post_id": 42067603, "comment_id": 71316559, "body": "@leftaroundabout: Agreed, although one might imagine a practical and useful instance for <code>Ratio Integer</code> too."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 1, "creation_date": 1486398488, "post_id": 42067603, "comment_id": 71316581, "body": "@gspr while such numbers <i>can</i> make sense, they aren&#39;t adequately represented by <code>Data.Complex.Complex Rational</code>. <a href=\"http://hackage.haskell.org/package/cyclotomic\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/cyclotomic</a> has a proper implementation."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1486405957, "creation_date": 1486405957, "answer_id": 42074791, "question_id": 42067603, "link": "https://stackoverflow.com/questions/42067603/different-type-constraints-for-the-same-instance/42074791#42074791", "title": "Different type constraints for the same instance", "body": "<p>The main source of pain here is that the Prelude's number hierarchy was defined to not be too complex - for most things, it works just fine. This is one of those edge cases where is doesn't really (although as @leftaroundabout points out, I'm not sure there are many applications for a <code>Complex</code> over something that is <em>not</em> <code>Floating</code>).</p>\n\n<p>Your options are to</p>\n\n<ul>\n<li>Add a <code>Floating a</code> constraint on <code>Num (Complex a)</code>. This is what feels most natural to me and makes the most sense from a type class perspective - shoehorning in <code>instance Num a =&gt; Num (Complex a)</code> breaks the <code>Num</code> abstraction because it has no notion of <code>abs</code>.</li>\n<li><p>Use a finer-grain numeric hierarchy. The <a href=\"https://hackage.haskell.org/package/numeric-prelude-0.4.2\" rel=\"noreferrer\"><code>numeric-prelude</code></a> comes to mind. In that, you will find the following (spread out over multiple modules):</p>\n\n<pre><code>class (Field.C a) =&gt; Algebraic.C a where\n  sqrt :: a -&gt; a\n\nclass (Ring.C a) =&gt; Field.C a where\n  (/)           :: a -&gt; a -&gt; a\n  recip         :: a -&gt; a\n  fromRational' :: Rational -&gt; a\n  (^-)          :: a -&gt; Integer -&gt; a\n\nclass (Ring.C a) =&gt; Absolute.C a where\n  abs    :: a -&gt; a\n  signum :: a -&gt; a\n\nclass (Additive.C a) =&gt; Ring.C a where\n  (*)         :: a -&gt; a -&gt; a\n  one         :: a\n  fromInteger :: Integer -&gt; a \n  (^)         :: a -&gt; Integer -&gt; a\n\nclass Additive.C a where\n  zero     :: a\n  (+), (-) :: a -&gt; a -&gt; a\n  negate   :: a -&gt; a\n</code></pre>\n\n<p>In your case, you would be making instances <code>instance Additive.C a =&gt; Additive.C (Complex a)</code>, <code>instance Ring.C a =&gt; Ring.C (Complex a)</code>, and <code>instance Algebraic.C a =&gt; Absolute.C (Complex a)</code>.</p></li>\n<li><p>If I haven't yet managed to convince you to abandon this madness, feel free to check out <a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap\" rel=\"noreferrer\">this page on advanced overlap</a>. Aside from being complex and boilerplate heavy (and needing to turn on a ton of language extensions), this solution isn't quite general (you'll still have to hand-pick which types go to which instance).</p></li>\n</ul>\n"}], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 42074791, "answer_count": 1, "score": 6, "last_activity_date": 1486405957, "creation_date": 1486383415, "question_id": 42067603, "link": "https://stackoverflow.com/questions/42067603/different-type-constraints-for-the-same-instance", "title": "Different type constraints for the same instance", "body": "<p>I'm defining my own complex number data type as a learning exercise, and I've run into trouble overloading <code>abs</code> along with the other members of <code>Num</code>. As far as I know, only one instance definition is allowed per typeclass, but if I could I'd do something like this:</p>\n\n<pre><code>instance Num a =&gt; Num (Complex a) where\n    (+) (Complex ra ia) (Complex rb ib) = Complex (ra + rb) (ia + ib)\n    (-) (Complex ra ia) (Complex rb ib) = Complex (ra - rb) (ia - ib)\n    (*) (Complex ra ia) (Complex rb ib) = Complex (ra*rb - ia*ib) (ra*ib + rb*ia)\n    fromInteger r = Complex (fromInteger r) 0\n\ninstance Floating a =&gt; Num (Complex a) where\n    abs (Complex r i) = Complex (sqrt $ r^2 + i^2) 0\n</code></pre>\n\n<p>or</p>\n\n<pre><code>instance Floating a =&gt; Floating (Complex a) where\n    abs (Complex r i) = Complex (sqrt $ r^2 + i^2) 0\n</code></pre>\n\n<p>Because none of the members other than <code>abs</code> require <code>Floating</code> types, and I don't want to limit them to only <code>Floating</code> types, but the <code>abs</code> function is super important, and I don't want to unnecessarily exclude it.<br>\nIs there some way I can have the functions <code>(+)</code>, <code>(-)</code>, and <code>(*)</code> work on all numeric types, while still implementing <code>abs</code>?</p>\n\n<p>According to <a href=\"https://downloads.haskell.org/~ghc/7.0.1/docs/html/users_guide/type-class-extensions.html\" rel=\"noreferrer\">7.6.3.4. Overlapping instances</a> in the GHC system guide, multiple instances can overlap if they differ on the type constraint(?) outside of the context (eg <code>instance C [a]</code> and <code>instance C [Int]</code>), with the compiler choosing the most specific instance for a given case, but it doesn't mention anything about only the context differing (eg <code>instance C [a]</code> and <code>instance Integral a =&gt; C [a]</code>).</p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 704, "user_id": 939572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadfb25285dc4e9a3caf81e2277d77b?s=128&d=identicon&r=PG", "display_name": "GarethR", "link": "https://stackoverflow.com/users/939572/garethr"}, "edited": false, "score": 4, "creation_date": 1486379056, "post_id": 42065671, "comment_id": 71303737, "body": "I&#39;d say that 0 is a perfectly reasonable answer to the question, &quot;what the maximum consecutive occurrences of Orange on this list?&quot;.  Given that you have such a function, you could just call it and compare the answer with 0:"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1486382090, "post_id": 42065671, "comment_id": 71305585, "body": "Adding a <code>Maybe</code> wrapper is a good idea when you have the same value (e.g. <code>0</code>) returned for two different reasons. I.e. when you want to distinguish <code>Nothing</code> and <code>Just 0</code>. Here, after you add the wrapper, you will never return <code>Just 0</code>. In such case, there is little to gain in adding the wrapper. Concretely, would you like to have <code>length :: [a] -&gt; Maybe Int</code> instead of the regular one?"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 1, "creation_date": 1486387002, "post_id": 42065671, "comment_id": 71308677, "body": "<code>max x y = if x &lt;= y then y else x</code> from <a href=\"https://www.stackage.org/haddock/lts-7.19/ghc-prim-0.5.0.0/src/GHC-Classes.html#Ord\" rel=\"nofollow noreferrer\">source</a>, I can&#39;t think of better custom build function for that simple logic."}], "answers": [{"comments": [{"owner": {"reputation": 2445, "user_id": 4468969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6b05d7f3493f7c284f67b1f2c1557f58?s=128&d=identicon&r=PG", "display_name": "Andi Pavllo", "link": "https://stackoverflow.com/users/4468969/andi-pavllo"}, "edited": false, "score": 0, "creation_date": 1486386234, "post_id": 42065840, "comment_id": 71308188, "body": "Would you mind explaining the code in the <code>where</code>? I&#39;m still a newbie in functional programming"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 2445, "user_id": 4468969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6b05d7f3493f7c284f67b1f2c1557f58?s=128&d=identicon&r=PG", "display_name": "Andi Pavllo", "link": "https://stackoverflow.com/users/4468969/andi-pavllo"}, "edited": false, "score": 0, "creation_date": 1486386664, "post_id": 42065840, "comment_id": 71308454, "body": "@AndiPavllo: better?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1486387136, "last_edit_date": 1486387136, "creation_date": 1486377878, "answer_id": 42065840, "question_id": 42065671, "link": "https://stackoverflow.com/questions/42065671/issues-while-trying-to-use-maybe/42065840#42065840", "title": "Issues while trying to use Maybe", "body": "<p>I don't get why you make it that hard: simply use <code>scanl</code> to determine the \"consecutive counts\", then apply <code>maximum</code> on it, and in case the result is <code>0</code>, return <code>Nothing</code>, else <code>Just ...</code>:</p>\n\n<pre><code>findMaxSubStr fruits | maxc == 0 = Nothing\n                     | otherwise = Just maxc\n    where maxc = maximum counts\n          counts = scanl f 0 fruits\n          f x Orange = x+1\n          f _ _      = 0\n</code></pre>\n\n<p>This being said I don't get why you want to return <code>Nothing</code>. In this case zero is a perfectly valid answer. <code>Maybe</code> is usually used to return some kind of \"exception\" answer. Like <code>find</code> that might fail to find an element.</p>\n\n<p><strong>The code works as follows:</strong></p>\n\n<p>first we perform a <code>scanl</code>. <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\"><code>scanl</code></a> passes some sort of <em>accumulator</em> through a list: for each element it calls the function (here <code>f</code>) with the accumulator and the object in the list. The result is the \"new\" accumulator. This result is then returned as an element in the resulting list, and reused to pass the accumulator to the next element. So in general it is something like:</p>\n\n<pre><code>-- example of scanl for three elements (this is not its real implementation)\nscanl f acc0 [xa,xb,xc] = [acc1,acc2,acc3]\n    where acc1 = f acc0 xa\n          acc2 = f acc1 xb\n          acc3 = f acc2 xc\n</code></pre>\n\n<p>In this case the accumulator is the <em>length of the sequence of <code>Orange</code>s <strong>thus far</em></strong>: so <code>[Orange,Apple,Apple,Orange,Orange,Orange,Apple,Orange]</code> will map on <code>[1,0,0,1,2,3,0,1]</code> this result will be stored in <code>counts</code>.</p>\n\n<p>Now we calculate the <code>maximum</code> of that list <code>counts</code>. So the result - <code>maxc</code> - is the maximum of the <code>counts</code> and thus the length of the <em>longest</em> (not the current) sequences of oranges.</p>\n\n<p>Next in the function definition we inspect whether that value is equal to <code>0</code>. If that is the case, we return <code>Nothing</code>. Otherwise we return <code>Just maxc</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1486410840, "post_id": 42070973, "comment_id": 71323655, "body": "The goal is to count the longest sequence of consecutive <code>Orange</code>s, though, not the total number of oranges."}, {"owner": {"reputation": 181, "user_id": 7518738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7b03512c741b0d19d0717486edb15f?s=128&d=identicon&r=PG&f=1", "display_name": "fjarino", "link": "https://stackoverflow.com/users/7518738/fjarino"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1486412204, "post_id": 42070973, "comment_id": 71324405, "body": "Thanks @Ryan, I&#39;ve edited the answer to provide the length of the longest sequence of oranges now."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1486412563, "post_id": 42070973, "comment_id": 71324594, "body": "Could do <code>numOranges = uncurry max $ \u2026</code> and <code>countOranges t Orange = (1+) &lt;$&gt; t</code> and <code>countOranges (x, y) _ = (max x y, 0)</code> to make fewer comparisons."}, {"owner": {"reputation": 181, "user_id": 7518738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7b03512c741b0d19d0717486edb15f?s=128&d=identicon&r=PG&f=1", "display_name": "fjarino", "link": "https://stackoverflow.com/users/7518738/fjarino"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1486417412, "post_id": 42070973, "comment_id": 71327129, "body": "Great @Ryan Answer updated according your suggestions."}], "tags": [], "owner": {"reputation": 181, "user_id": 7518738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7b03512c741b0d19d0717486edb15f?s=128&d=identicon&r=PG&f=1", "display_name": "fjarino", "link": "https://stackoverflow.com/users/7518738/fjarino"}, "is_accepted": false, "score": 1, "last_activity_date": 1486417350, "last_edit_date": 1486417350, "creation_date": 1486393606, "answer_id": 42070973, "question_id": 42065671, "link": "https://stackoverflow.com/questions/42065671/issues-while-trying-to-use-maybe/42070973#42070973", "title": "Issues while trying to use Maybe", "body": "<p>Here you can find a definition of your <code>findMaxSubStr</code> function which uses a fold to directly calculate the length of the longest sequence of oranges in the list without creating an intermediate list:</p>\n\n<pre><code>import Data.List (foldl')\n\nfindMaxSubStr :: [Fruit] -&gt; Maybe Int\nfindMaxSubStr fruits =\n  case numOranges of\n    0 -&gt; Nothing\n    n -&gt; Just n\n  where\n    numOranges = uncurry max $ foldl' countOranges (0, 0) fruits\n    countOranges t Orange = (1+) &lt;$&gt; t\n    countOranges (x,y) _ = (max x y, 0)\n</code></pre>\n\n<p>In <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl%27\" rel=\"nofollow noreferrer\">this page</a> you can find a discussion on when to use <code>foldl'</code> versus using <code>foldr</code> or <code>foldl</code>, together with examples showing how these fold functions work.</p>\n\n<p>A tuple is used to track the length of Orange sequences. First value keeps the length of the longest sequence found, second element stores the length of the current sequence.</p>\n\n<p>Original implementation of <code>where</code> block was:</p>\n\n<pre><code>where\n  numOranges = fst $ foldl' countOranges (0, 0) fruits\n  countOranges (x, y) Orange = let y' = y+1 in (max x y', y')\n  countOranges (x, _) _  = (x, 0)\n</code></pre>\n\n<p>I've edited the answer following @Ryan suggestions (see comment below) and here are some notes describing how the solution works now:</p>\n\n<p><code>countOranges t Orange = (1+) &lt;$&gt; t</code> takes advantage of the fact that 2-tuples are functors and the <code>&lt;$&gt;</code> operator applies the function passed as first parameter (i.e. <code>(1+)</code> in our case) to the second element of the 2-tuple. Thus, in the counter <code>(x, y)</code> we increase <code>y</code> while finding oranges, without touching <code>x</code>, i.e. we are calculating the length of the current orange sequence (when we find one).</p>\n\n<p>When we find an apple, <code>countOranges (x,y) _ = (max x y, 0)</code> will update the <code>x</code> in <code>(x,y)</code> and reset <code>y</code> to <code>0</code>. You can see that <code>x</code> will hold the length of the longest sequence of oranges found so far.</p>\n\n<p>If the longest sequence of oranges occurs at the end of the fruits list, the update of <code>x</code> described in previous paragraph will not happen. That's the reason we still need <code>numOranges = uncurry max $ ...</code> to get the max value from the <code>(x, y)</code> tuple returned by <code>foldl'</code>.</p>\n"}], "owner": {"reputation": 2445, "user_id": 4468969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6b05d7f3493f7c284f67b1f2c1557f58?s=128&d=identicon&r=PG", "display_name": "Andi Pavllo", "link": "https://stackoverflow.com/users/4468969/andi-pavllo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 42065840, "answer_count": 2, "score": 0, "last_activity_date": 1486417350, "creation_date": 1486377443, "last_edit_date": 1486393136, "question_id": 42065671, "link": "https://stackoverflow.com/questions/42065671/issues-while-trying-to-use-maybe", "title": "Issues while trying to use Maybe", "body": "<p>I made the following Haskell function that checks the maximum consecutive occurrences of <code>Orange</code> on a list:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>import Data.Maybe\ndata Fruit = Apple | Orange\nfindMaxSubStr :: [Fruit] -&gt; Maybe Int\n\nfindMaxSubStr xs = val xs 0 0\n    where val [] prev current = (max prev current)\n          val (Apple:xs) prev current = val xs (max prev current) 0\n          val (Orange:xs) prev current = val xs prev (current + 1)\n</code></pre>\n\n\n\n<p>I'm now trying to integrate Maybe type, in case the occurrences are 0. For example, I want <code>[]</code> and <code>[Apple, Apple]</code> to produce <code>Nothing</code> instead of <code>0</code>. How should I proceed?</p>\n\n<p>Moreover, instead of using the prebuilt <code>max</code> function, what's the best way to proceed in case I want to create my own function in order to check the max value?</p>\n"}, {"tags": ["haskell", "evaluation"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 4, "creation_date": 1486378748, "post_id": 42065665, "comment_id": 71303543, "body": "Why can\u2019t that be true? That\u2019s exactly what happens. (Except it\u2019s <code>add 1 1</code>, <code>add 1 2</code>, and <code>add 1 3</code>.)"}, {"owner": {"reputation": 83, "user_id": 7519086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d51672ccf81597ea02e16869fe1df1?s=128&d=identicon&r=PG&f=1", "display_name": "user1299292", "link": "https://stackoverflow.com/users/7519086/user1299292"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1486379675, "post_id": 42065665, "comment_id": 71304151, "body": "Oh I forgot the x in every row, so i would have add 1 1 : add 1 2 : add 1 3 : []. Then it&#39;s making sense, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 919, "user_id": 5017858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OfAr1.png?s=128&g=1", "display_name": "Sam Marinelli", "link": "https://stackoverflow.com/users/5017858/sam-marinelli"}, "is_accepted": false, "score": 2, "last_activity_date": 1486669610, "creation_date": 1486669610, "answer_id": 42145552, "question_id": 42065665, "link": "https://stackoverflow.com/questions/42065665/evaluation-strategy-of-haskell/42145552#42145552", "title": "Evaluation strategy of haskell", "body": "<p><code>add 1</code> is the unary function <code>f</code>, not <code>add</code>.  So you end up with the following.</p>\n\n<pre><code>map (add 1) [1,2,3]\n    == add 1 1 : map (add 1) [2,3]\n    == add 1 1 : add 1 2 : map (add 1) [3]\n    == add 1 1 : add 1 2 : add 1 3 : map (add 1) []\n    == 2 : 3 : 4 : []\n    == [2,3,4]\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7519086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d51672ccf81597ea02e16869fe1df1?s=128&d=identicon&r=PG&f=1", "display_name": "user1299292", "link": "https://stackoverflow.com/users/7519086/user1299292"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486669610, "creation_date": 1486377438, "last_edit_date": 1486416092, "question_id": 42065665, "link": "https://stackoverflow.com/questions/42065665/evaluation-strategy-of-haskell", "title": "Evaluation strategy of haskell", "body": "<p>If I have these functions:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\nadd a b = a+b\n\n\nmap :: (a-&gt;b) -&gt; [a] -&gt; [b]\nmap f [] = []\nmap f (x:xs) = f x : map f xs\n</code></pre>\n\n<p>When I call <code>map (add 1) [1,2,3]</code> the output is <code>[2,3,4]</code> but how does the evaluation of Haskell work in this case?</p>\n\n<p>My ideas:</p>\n\n<p>It matches with the second pattern because map is a function and [1,2,3] a list.</p>\n\n<p>Then we would have:</p>\n\n<pre><code>map (add 1) [1,2,3]\n= add 1 : map add [2,3]\n= add 1 : add 2 : map add [3]\n= add 1 : add 2 : add 3 : map add []\n= add 1 : add 2 : add 3 : []\n</code></pre>\n\n<p>However this cannot be true. Can someone help me please?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 1, "creation_date": 1486379879, "post_id": 42065602, "comment_id": 71304271, "body": "I think you just have to define <code>jellybean</code> in terms of <code>banana</code> and <code>unicorn</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1486389274, "post_id": 42065602, "comment_id": 71310170, "body": "You do realize that <code>Misty</code> is <code>Monad</code>, <code>banana</code> is <code>=&lt;&lt;</code> (flipped <code>&gt;&gt;=</code>), <code>unicorn</code> is <code>return</code>, and <code>jellybean</code> is <code>join</code>, right?"}], "answers": [{"tags": [], "owner": {"reputation": 6075, "user_id": 147442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5cb67e96d4c724cfac0ff043b11c87e?s=128&d=identicon&r=PG&f=1", "display_name": "R&#252;diger Hanke", "link": "https://stackoverflow.com/users/147442/r%c3%bcdiger-hanke"}, "is_accepted": true, "score": 5, "last_activity_date": 1486380497, "last_edit_date": 1486380497, "creation_date": 1486379792, "answer_id": 42066439, "question_id": 42065602, "link": "https://stackoverflow.com/questions/42065602/generic-nested-monad-manipulation/42066439#42066439", "title": "Generic nested monad manipulation?", "body": "<p>I think you don't have to extend the class, or add a subclass. Consider what the type signature of <code>banana</code> looks like if you would pick <code>m a</code> for the <code>a</code> in the signature of <code>banana</code> (the type variable <code>a</code> can stand for any type, so also for <code>m a</code>):</p>\n\n<pre><code>banana :: Misty m =&gt; (m a -&gt; m b) -&gt; m (m a) -&gt; m b\n</code></pre>\n\n<p>Do you see that this already starts to look quite close to <code>jellybean</code>? You only have to \"get rid\" of the first argument, and make <code>b</code> to be the same as <code>a</code>. The easiest way to achieve this would be to use the identity function <code>id</code>:</p>\n\n<pre><code>jellybean :: (Misty m) =&gt; m (m a) -&gt; m a\njellybean x = banana id x\n</code></pre>\n\n<p>A nice way to see the second step easier is that once you discover that you could use the first argument to <code>jellybean</code> as the second of <code>banana</code> is to use a <em>typed hole</em>:</p>\n\n<pre><code>jellybean :: (Misty m) =&gt; m (m a) -&gt; m a\njellybean x = banana _ x\n</code></pre>\n\n<p>On loading this into the REPL, Haskell will print out:</p>\n\n<pre><code> Found hole `_' with type: m a -&gt; m a\n</code></pre>\n\n<p>So you see what you'll need here to make this typecheck in this context.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 2, "accepted_answer_id": 42066439, "answer_count": 1, "score": 1, "last_activity_date": 1486380497, "creation_date": 1486377225, "question_id": 42065602, "link": "https://stackoverflow.com/questions/42065602/generic-nested-monad-manipulation", "title": "Generic nested monad manipulation?", "body": "<p>I've been <a href=\"http://blog.tmorris.net/posts/20-intermediate-haskell-exercises/\" rel=\"nofollow noreferrer\">given</a> the following class interface: </p>\n\n<pre><code>class Misty m where\n  banana :: (a -&gt; m b) -&gt; m a -&gt; m b\n  unicorn :: a -&gt; m a\n</code></pre>\n\n<p>And now I'm required to modify this to enable:</p>\n\n<pre><code>jellybean :: (Misty m) =&gt; m (m a) -&gt; m a\n</code></pre>\n\n<p>I believe the question is pushing me to add a subclass of <code>Misty</code>, with multi parameters: </p>\n\n<pre><code>class Misty m =&gt; VeryMisty m a where\n  ... banana' (Just (Just v)) = banana --? \n</code></pre>\n\n<p>I'm unsure how to create a function in <code>Misty</code> to operate on this nested monad? </p>\n\n<p>I'm also unsure whether my approach is correct and/or the simplest?</p>\n"}, {"tags": ["haskell", "operator-overloading", "typeclass"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1486376609, "post_id": 42065264, "comment_id": 71302205, "body": "<code>(&#47;)</code> is defined in <code>RealFloat</code>."}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1486376651, "post_id": 42065264, "comment_id": 71302236, "body": "<code>Complex.hs:20:5: \u2018&#47;\u2019 is not a (visible) method of class \u2018RealFloat\u2019</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1486376671, "post_id": 42065264, "comment_id": 71302241, "body": "No in <code>Fractional</code>."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1486376744, "post_id": 42065264, "comment_id": 71302289, "body": "When I use <code>:info &#47;</code> or <code>:i &#47;</code> in ghci, I see that it\u2019s a member of <code>Fractional</code>. Using your definition of <code>&#47;</code> in <code>Fractional</code> compiled successfully for me, with a warning that the <code>fromRational</code> member isn\u2019t defined. What was the error message you saw?"}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 0, "creation_date": 1486376751, "post_id": 42065264, "comment_id": 71302295, "body": "Yeah so far I&#39;ve tried <code>Num</code>, <code>Fractional</code>, <code>Floating</code>, and <code>RealFloat</code> and got the same error each time"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1486376755, "post_id": 42065264, "comment_id": 71302299, "body": "OT but <code>Num a =&gt; Show Complex a</code>. Why not <code>Show a =&gt;</code>?"}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1486376915, "post_id": 42065264, "comment_id": 71302389, "body": "Oh heck, when I tried <code>Fractional</code> it gave a different error, and seems to work fine otherwise. By that point I must have skimmed over the content of the error. The error was relating to @n.m.&#39;s comment about excluding <code>Show</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1486377018, "post_id": 42065264, "comment_id": 71302452, "body": "Sorry my bad, Fractional, not RealFloat!"}], "answers": [{"comments": [{"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 0, "creation_date": 1486377172, "post_id": 42065480, "comment_id": 71302567, "body": "for <code>Show</code>, I found <code>a</code> needs to be <code>Num</code> and <code>Ord</code> in order to use <code>&lt;</code> and <code>negate</code>, in addition to <code>Show</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 0, "creation_date": 1486377229, "post_id": 42065480, "comment_id": 71302594, "body": "@ZoeyHewll: ah, you are correct on that part, did not notice the comparison and <code>negate</code> call."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1486377210, "last_edit_date": 1486377210, "creation_date": 1486376877, "answer_id": 42065480, "question_id": 42065264, "link": "https://stackoverflow.com/questions/42065264/typeclasses-for-overloading-division/42065480#42065480", "title": "Typeclasses for overloading division", "body": "<p>When you type <code>:t (/)</code> in <code>ghci</code>, you will obtain:</p>\n\n<pre><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>So that means it is a member of <code>Fractional</code>, not <code>Floating</code>. You can thus rewrite it to:</p>\n\n<pre><code>instance <b>Fractional</b> a => <b>Fractional</b> (Complex a) where\n    (/) a b@(Complex r i) = fmap (/(r^2 - i^2)) (a * (conjugate b))</code></pre>\n\n<p>And since we are nitpicking, you also have to add brackets to your <code>Show</code> instance:</p>\n\n<p><pre><code>instance Num a => Show <b>(</b>Complex a<b>)</b> where\n    show (Complex r i)\n        | i &lt; 0 = show r ++ \" - i\" ++ show (negate i)\n        | otherwise = show r ++ \" + i\" ++ show i</pre></code></p>\n"}], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "accepted_answer_id": 42065480, "answer_count": 1, "score": 3, "last_activity_date": 1486377210, "creation_date": 1486376258, "question_id": 42065264, "link": "https://stackoverflow.com/questions/42065264/typeclasses-for-overloading-division", "title": "Typeclasses for overloading division", "body": "<p>I'm defining my own complex number data type as a learning exercise, and I've run into trouble overloading the <code>(/)</code> operator. It seems I can't include it in an instance of <code>Floating</code> or <code>Fractional</code>, with the compiler saying that <code>(/)</code> isn't a visible method of those classes. Is there a (preferably numeric) typeclass which will allow me to overload this operator? eg.</p>\n\n<pre><code>instance SOMECLASS a =&gt; SOMECLASS (Complex a) where\n    (/) a b@(Complex r i) = fmap (/(r^2 - i^2)) (a * (conjugate b))\n</code></pre>\n\n<p>Here's the current implementation implementation for those interested:</p>\n\n<pre><code>module Complex where\ndata Complex a = Complex {real :: a, imaginary :: a}\n\ni = Complex 0 1\n\ninstance Num a =&gt; Show Complex a where\n    show (Complex r i)\n        | i &lt; 0 = show r ++ \" - i\" ++ show (negate i)\n        | otherwise = show r ++ \" + i\" ++ show i\n\ninstance Functor Complex where\n    fmap f (Complex r i) = Complex (f r) (f i)\n\ninstance Num a =&gt; Num (Complex a) where\n    (+) (Complex ra ia) (Complex rb ib) = Complex (ra + rb) (ia + ib)\n    (-) (Complex ra ia) (Complex rb ib) = Complex (ra - rb) (ia - ib)\n    (*) (Complex ra ia) (Complex rb ib) = Complex (ra*rb - ia*ib) (ra*ib + rb*ia)\n\ninstance Floating a =&gt; Floating (Complex a) where\n    (/) a b@(Complex r i) = fmap (/(r^2 - i^2)) (a * (conjugate b))\n\nconjugate :: Num a =&gt; Complex a -&gt; Complex a\nconjugate (Complex r i) = Complex r (negate i)\n</code></pre>\n"}, {"tags": ["haskell", "types", "monads"], "comments": [{"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 1, "creation_date": 1486370051, "post_id": 42063167, "comment_id": 71298272, "body": "You are looking for Kliesli composition <code>(&gt;=&gt;)</code> Check here <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:-62--61--62-\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/&hellip;</a>"}, {"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 1, "creation_date": 1486370162, "post_id": 42063167, "comment_id": 71298339, "body": "Additionally <code>IO (Maybe a) ~ MaybeT IO a</code> and <code>MaybeT</code> is defined in <a href=\"http://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Monad-Trans-Maybe.html#v:MaybeT\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/transformers-0.5.2.0/docs/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486390326, "post_id": 42063502, "comment_id": 71310891, "body": "After refactoring, would it make sense to regeneralize the <code>rest</code> functions, to recapture the flavor of the original functions? E.g., <code>rest1 :: MonadTrans mt =&gt; Value1 -&gt; mt IO Value2</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486407463, "post_id": 42063502, "comment_id": 71321848, "body": "@chepner I would definitely say yes; though I&#39;m not sure your particular type makes sense. Something like <code>rest1 :: (MonadIO m, MonadPlus m) =&gt; Value1 -&gt; m Value2</code> would express that <code>rest1</code> may do some IO (<code>MonadIO</code>) and may not succeed (<code>MonadPlus</code>)."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 6, "last_activity_date": 1486371292, "last_edit_date": 1592644375, "creation_date": 1486370464, "answer_id": 42063502, "question_id": 42063167, "link": "https://stackoverflow.com/questions/42063167/how-to-chain-a-io-m-b-functions/42063502#42063502", "title": "How to chain a -&gt; IO (m b) functions", "body": "<blockquote>\n<p>There are functions with signatures like:</p>\n<pre><code>a -&gt; IO (m b)\nb -&gt; IO (m c)\nc -&gt; IO (m d)\n</code></pre>\n<p>How do I chain them in</p>\n<pre><code>a -&gt; IO (m d)\n</code></pre>\n</blockquote>\n<p>In general, you might not be able to. For example, if <code>m</code> is <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Functor-Const.html#t:Const\" rel=\"noreferrer\"><code>Const</code></a>, I'm not sure asking this even makes sense. In general, you probably expect <code>m</code> to be a <code>Monad</code>. However, note that even if <code>m</code> <em>is</em> a <code>Monad</code>, its composition with <code>IO</code> may not be (<a href=\"https://stackoverflow.com/questions/13034229/concrete-example-showing-that-monads-are-not-closed-under-composition-with-proo\">see this</a>).</p>\n<blockquote>\n<pre><code>Value1 -&gt; IO (Maybe Value2)\nValue2 -&gt; IO (Maybe Value3)\nValue3 -&gt; IO (Maybe Value4)\n</code></pre>\n</blockquote>\n<p>Ah, Now you are talking! The abstraction you are looking for here is <a href=\"https://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Monad-Trans-Maybe.html#t:MaybeT\" rel=\"noreferrer\"><code>MaybeT</code></a> and Kleisli composition <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:-62--61--62-\" rel=\"noreferrer\"><code>(&gt;=&gt;)</code></a>. Then, for example,</p>\n<pre><code>import Control.Monad ((&gt;=&gt;))\nimport Control.Monad.Trans.Maybe (MaybeT(..))\n\nrest1 :: Value1 -&gt; IO (Maybe Value2)\nrest2 :: Value2 -&gt; IO (Maybe Value3)\nrest3 :: Value3 -&gt; IO (Maybe Value4)\n\nrest4 :: Value1 -&gt; IO (Maybe Value4)\nrest4 x = runMaybeT ((MaybeT . rest1 &gt;=&gt; MaybeT . rest2 &gt;=&gt; MaybeT . rest3) x)\n</code></pre>\n<p>That still looks a bit ugly. The thing to do is probably to refactor your <code>rest1</code>, <code>rest2</code>, and <code>rest3</code> functions. As has been pointed out in the comments <code>MaybeT IO a</code> can be converted to and from <code>IO (Maybe a)</code> (in fact that is exactly what <code>runMaybeT</code> and <code>MaybeT</code> do).</p>\n<pre><code>import Control.Monad ((&gt;=&gt;))\nimport Control.Monad.Trans.Maybe (MaybeT(..))\n\nrest1 :: Value1 -&gt; MaybeT IO Value2\nrest2 :: Value2 -&gt; MaybeT IO Value3\nrest3 :: Value3 -&gt; MaybeT IO Value4\n\nrest4 :: Value1 -&gt; MaybeT IO Value4\nrest4 = rest1 &gt;=&gt; rest2 &gt;=&gt; rest3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1486376171, "post_id": 42064702, "comment_id": 71301917, "body": "Looks like you don\u2019t need the <code>liftIO</code>, and <code>&gt;&gt;= return . join</code> is <code>fmap join</code>."}, {"owner": {"reputation": 322, "user_id": 74365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a163c6d4d2b0b010339e46b02d335cea?s=128&d=identicon&r=PG", "display_name": "Koray Al", "link": "https://stackoverflow.com/users/74365/koray-al"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1486384338, "post_id": 42064702, "comment_id": 71306947, "body": "for the part with <code>&gt;&gt;= return . join</code> I wanted to separate the final step. so if one wanted to add more steps (ie.  <code>d -&gt; IO (m e)</code> )  to this example, they would just add another line with <code>&gt;&gt;= traverse fd . join</code> before the last line."}], "tags": [], "owner": {"reputation": 322, "user_id": 74365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a163c6d4d2b0b010339e46b02d335cea?s=128&d=identicon&r=PG", "display_name": "Koray Al", "link": "https://stackoverflow.com/users/74365/koray-al"}, "is_accepted": false, "score": 2, "last_activity_date": 1486384123, "last_edit_date": 1486384123, "creation_date": 1486374474, "answer_id": 42064702, "question_id": 42063167, "link": "https://stackoverflow.com/questions/42063167/how-to-chain-a-io-m-b-functions/42064702#42064702", "title": "How to chain a -&gt; IO (m b) functions", "body": "<p>if m has an instance of <code>Traversable</code> (<code>Maybe</code> has one) here is another alternative:</p>\n\n<pre><code>import           Control.Monad (join)\n\nf :: (Traversable m, Monad m)\n  =&gt; (a -&gt; IO (m b))\n  -&gt; (b -&gt; IO (m c))\n  -&gt; (c -&gt; IO (m d))\n  -&gt; a\n  -&gt; IO (m d)\nf fa fb fc a = fa a\n           &gt;&gt;= traverse fb\n           &gt;&gt;= fmap join . traverse fc . join\n</code></pre>\n"}], "owner": {"reputation": 460, "user_id": 2925132, "user_type": "registered", "profile_image": "https://graph.facebook.com/1835296433/picture?type=large", "display_name": "Yury Sukhoverkhov", "link": "https://stackoverflow.com/users/2925132/yury-sukhoverkhov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 2, "accepted_answer_id": 42063502, "answer_count": 2, "score": 1, "last_activity_date": 1486463258, "creation_date": 1486369218, "last_edit_date": 1486463258, "question_id": 42063167, "link": "https://stackoverflow.com/questions/42063167/how-to-chain-a-io-m-b-functions", "title": "How to chain a -&gt; IO (m b) functions", "body": "<p>There are functions with signatures like:</p>\n\n<pre><code>a -&gt; IO (m b)\nb -&gt; IO (m c)\nc -&gt; IO (m d)\n</code></pre>\n\n<p>How do I chain them in </p>\n\n<pre><code>a -&gt; IO (m d)\n</code></pre>\n\n<p>?</p>\n\n<p>Practical application: say there a set of REST endpoints. Each of the return a value and next one is requires the value returned by previous as an argument.</p>\n\n<p>So functions for fetching from the endpoints are like:</p>\n\n<pre><code>Value1 -&gt; IO (Maybe Value2)\nValue2 -&gt; IO (Maybe Value3)\nValue3 -&gt; IO (Maybe Value4)\n</code></pre>\n"}, {"tags": ["haskell", "induction"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1486372418, "post_id": 42063063, "comment_id": 71299543, "body": "I\u2019m rusty, but I think you can prove <code>zip xs ys !! 0 = (xs !! 0, ys !! 0)</code> by equational reasoning and expanding the definitions of <code>zip</code> and <code>!!</code>, then prove that if <code>zip xs ys !! n = (xs !! n, ys !! n)</code> then <code>zip xs ys !! n + 1 = (xs !! n + 1, ys !! n + 1)</code>."}, {"owner": {"reputation": 41, "user_id": 6191920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52c21692a963365dfeedd7e9d12cc96?s=128&d=identicon&r=PG&f=1", "display_name": "jmply", "link": "https://stackoverflow.com/users/6191920/jmply"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1486378842, "post_id": 42063063, "comment_id": 71303601, "body": "Thanks for the answer. I forgot to mention it should be structural induction over the length of the list. That is xs becomes (x:xs) in the induction step."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6191920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52c21692a963365dfeedd7e9d12cc96?s=128&d=identicon&r=PG&f=1", "display_name": "jmply", "link": "https://stackoverflow.com/users/6191920/jmply"}, "edited": false, "score": 0, "creation_date": 1486380341, "post_id": 42066489, "comment_id": 71304567, "body": "Thank you for your answer! In the final case where you use the IH, wouldnt this be considered Induction over n? Also where did you get the function definitions?"}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "reply_to_user": {"reputation": 41, "user_id": 6191920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52c21692a963365dfeedd7e9d12cc96?s=128&d=identicon&r=PG&f=1", "display_name": "jmply", "link": "https://stackoverflow.com/users/6191920/jmply"}, "edited": false, "score": 0, "creation_date": 1486380708, "post_id": 42066489, "comment_id": 71304760, "body": "By no means! The induction is over <code>xs</code>. The IH is forall ys. forall n.  n &gt;= 0 /\\ n &lt; min (length xs) (length ys) -&gt; zip xs ys !! n = (xs !! n , ys !! n). The need for case analysis on <code>n</code> and <code>ys</code> is just to &quot;massage&quot; the goal to manipulate it easily using equational reasoning."}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "reply_to_user": {"reputation": 41, "user_id": 6191920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52c21692a963365dfeedd7e9d12cc96?s=128&d=identicon&r=PG&f=1", "display_name": "jmply", "link": "https://stackoverflow.com/users/6191920/jmply"}, "edited": false, "score": 0, "creation_date": 1486380883, "post_id": 42066489, "comment_id": 71304864, "body": "If you think that the answer is fine, please mark it as an answer."}], "tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": true, "score": 1, "last_activity_date": 1486379924, "creation_date": 1486379924, "answer_id": 42066489, "question_id": 42063063, "link": "https://stackoverflow.com/questions/42063063/structural-induction-zip-xs-ysn-xsn-ysn/42066489#42066489", "title": "Structural Induction - (zip xs ys)!!n = (xs!!n, ys!!n)", "body": "<p>First, I'll give definitions of <code>zip</code> and <code>!!</code>:</p>\n\n<pre><code>zip :: [a] -&gt; [b] -&gt; [(a,b)]\nzip [] [] = []                             -- (zip-1)\nzip (x:xs) (y:ys) = (x,y) : zip xs ys      -- (zip-2)\nzip _ _ = []                               -- (zip-3)\n\n(!!) :: [a] -&gt; Int -&gt; a\n(x : _) !! 0 = x                           -- (!!-1)\n(_ : xs) !! n = xs !! (n - 1)              -- (!!-2)\n</code></pre>\n\n<p>Let xs, ys and n arbitrary. Now, suppose that <code>n &gt;=0</code> and <code>n &lt; min (length xs) (length ys)</code>. We proceed by induction on <code>xs</code>.</p>\n\n<ul>\n<li>Case <code>xs = []</code>. Now we do case analysis on <code>ys</code>. In both cases, we have that  there's no <code>n &gt;=0</code> and <code>n &lt; min (length xs) (length ys)</code>. So, this case is trivially true.</li>\n<li>Case <code>xs = x : xs'</code>. We proceed by case analysis on <code>ys</code>. </li>\n<li>Case <code>xs = x : xs'</code> and <code>ys = []</code>. Again, we have the theorem trivially true since there's no <code>n</code> such that that <code>n &gt;=0</code> and <code>n &lt; min (length xs) (length ys)</code>.</li>\n<li>Case <code>xs = x : xs'</code> and <code>ys = y : ys'</code>. Now we do case analysis on <code>n</code>.</li>\n<li><p>Case <code>xs = x : xs'</code>, <code>ys = y : ys'</code> and <code>n = 0</code>. We have that</p>\n\n<pre><code>zip (x : xs') (y : ys') !! 0 = {by equation (zip-2)}\n(x,y) : zip xs' ys'     !! 0 = {by equation (!!-1)}\n(x,y)                        = {by equation (!!-1) - backwards}\n((x : xs') !! 0, (y : ys') !! 0).\n</code></pre></li>\n<li><p>Case <code>xs = x : xs'</code>, <code>ys = y : ys'</code> and <code>n = n' + 1</code>. </p>\n\n<pre><code> zip (x : xs') (y : ys') !! (n + 1) = {by equation zip-2}\n (x,y) : zip xs' ys' !! (n + 1) = {by equation (!!-2)}\n zip xs' ys' !! n               = {by induction hypothesis}\n (xs' !! n , ys' !! n)          = {by equation (!!-2) backwards}\n ((x : xs') !! (n + 1), (y : ys') !! (n + 1))\n</code></pre>\n\n<p>QED</p></li>\n</ul>\n\n<p>Hope that this helps.</p>\n"}], "owner": {"reputation": 41, "user_id": 6191920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52c21692a963365dfeedd7e9d12cc96?s=128&d=identicon&r=PG&f=1", "display_name": "jmply", "link": "https://stackoverflow.com/users/6191920/jmply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 42066489, "answer_count": 1, "score": 1, "last_activity_date": 1486379924, "creation_date": 1486368781, "last_edit_date": 1486378855, "question_id": 42063063, "link": "https://stackoverflow.com/questions/42063063/structural-induction-zip-xs-ysn-xsn-ysn", "title": "Structural Induction - (zip xs ys)!!n = (xs!!n, ys!!n)", "body": "<p>Given <code>n &gt;= 0 and n &lt; min (length xs) (length ys)</code>\nshow that <code>(zip xs ys)!!n = (xs!!n, ys!!n)</code> with structural Induction over xs.</p>\n\n<p>Is it even possible to do this in a clean way? I cant find any spots where I can use the <code>Induction Hypothesis</code>.</p>\n"}, {"tags": ["haskell", "math", "functional-programming"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1486366730, "post_id": 42062261, "comment_id": 71296858, "body": "The first obvious problem is that you have a type variable <code>d</code> instead of <code>Double</code> in <code>derivative :: (Exp d) =&gt; e -&gt; d</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1486368399, "post_id": 42062261, "comment_id": 71297490, "body": "I recommend you not use a type class here - it doesn&#39;t really have any purpose. Instead, make yourself an <code>Exp</code> data type: <code>data Exp = Number Double | Variable Char | Exp :* Exp | Exp :+ Exp</code> and then define <code>derivative :: Char -&gt; Exp -&gt; Exp</code> where the first argument is the variable with respect to which you are deriving."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486373313, "post_id": 42062261, "comment_id": 71300073, "body": "The problem here is that you want to return <i>some</i> type <code>d</code>, but your declaration states <code>derivative</code> returns <i>any</i> <code>d</code>, whatever the <i>caller</i> might choose. So, you used universal quantification instead of existential quantification. Haskell does not have existentials. One can define them e.g. with a custom GADT, but they look wrong for this -- Alec above suggests a much simpler alternative."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1486376392, "post_id": 42062261, "comment_id": 71302058, "body": "It looks like you&#39;re thinking in terms of object-oriented classes, with <code>Exp</code> as an abstract base class. Except for the term &quot;class&quot;, type classes aren&#39;t very much like OO classes. A sum type, like @Alec suggests, is a much better fit."}], "answers": [{"tags": [], "owner": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "is_accepted": false, "score": 5, "last_activity_date": 1486367776, "last_edit_date": 1495541821, "creation_date": 1486367292, "answer_id": 42062701, "question_id": 42062261, "link": "https://stackoverflow.com/questions/42062261/creating-a-typeclass-that-returns-another-instance-of-that-typeclass-in-haskell/42062701#42062701", "title": "Creating a typeclass that returns another instance of that typeclass in haskell", "body": "<p>When you write</p>\n\n<pre><code>class Exp e where \n    derivative :: (Exp d) =&gt; e -&gt; d\n</code></pre>\n\n<p>you declare that any type <code>e</code> which is in the <code>Exp</code> class should have a function <code>derivative :: e -&gt; d</code>. Note that <code>e</code> here is a very specific class, but <code>d</code> is only said to be in <code>Exp</code>. It's almost an <em>arbitrary</em> type. So you're trying to define a function which, given an argument, returns a value of <em>arbitrary</em> type, belonging to <code>Exp</code></p>\n\n<p>Selection of <code>d</code> is left to the compiler depending on context, like <a href=\"https://stackoverflow.com/questions/11420126/does-haskell-have-return-type-overloading\">with <code>fromInteger</code></a>. So you're not saying \"for each <code>e</code> there is a <code>d</code> belonging to <code>Exp</code> such that <code>derivative</code> will return <code>d</code>\", you say that \"for each <code>e</code> <em>all</em> <code>d</code> belonging to <code>Exp</code> are such that <code>derivative</code> will return <code>d</code>\". If you want to say the former, you will probably have to use multi-parameterized classes and functional dependencies (to specify that type of the output is uniquely determined by type of the input).</p>\n\n<p>If we replace <code>e</code> with some specific type, you're trying to implement the following:</p>\n\n<pre><code>derivative :: Exp d =&gt; Double -&gt; d\nderivative = (0::Double)\n</code></pre>\n\n<p>Which is not something you can do, because not all <code>Exp</code>s are doubles. Say, <code>Operator Double Double</code> (which is in <code>Exp</code>) is clearly not a <code>Double</code>. Even more artificial example with the same problem:</p>\n\n<pre><code>derivative :: Double -&gt; a\nderivative = (0::Double)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": false, "score": 1, "last_activity_date": 1486505766, "creation_date": 1486505766, "answer_id": 42101062, "question_id": 42062261, "link": "https://stackoverflow.com/questions/42062261/creating-a-typeclass-that-returns-another-instance-of-that-typeclass-in-haskell/42101062#42101062", "title": "Creating a typeclass that returns another instance of that typeclass in haskell", "body": "<p>There are ways to achieve the desired behavior, one is using <code>FunctionalDependencies</code> and <code>MultiParamTypeClasses</code>, while the other one is using <code>TypeFamilies</code>, which is showed below:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE TypeFamilies #-}\nmodule Main where\n\nclass Exp e where\n    type ResExp e :: * -- type family of resulting expression\n    derivative :: (Exp (ResExp e)) =&gt; e -&gt; ResExp e\n\ninstance Exp Double where\n    type ResExp Double = Double\n    derivative a = 0\n\n\ninstance Exp Char where\n    type ResExp Char = Double\n    derivative c = 1\n</code></pre>\n\n<p>But when it comes to the instance for <code>Operator</code>, there are two bugs in implementation:</p>\n\n<ol>\n<li>Attempt to construct an infinite type</li>\n<li><code>derivative (f :* g)</code> and <code>derivative (f :+ g)</code> have different return types.</li>\n</ol>\n\n<p>Here is a way how to solve this problem though:</p>\n\n<pre><code>data Mult a b = a :* b\n\ndata Plus a b = a :+ b\n\ninstance (Exp a, Exp b, Exp (ResExp a), Exp (ResExp b)) =&gt; Exp (Plus a b) where\n    type ResExp (Plus a b) = (Plus (ResExp a) (ResExp b))\n    derivative (f :+ g) = derivative f :+ derivative g\n\n\ninstance (Exp a, Exp b, Exp (ResExp a), Exp (ResExp b)) =&gt; Exp (Mult a b) where\n    type ResExp (Mult a b) = Plus (Mult (ResExp a) b) (Mult a (ResExp b))\n    derivative (f :* g) = ((derivative f) :* g) :+ (f :* (derivative g))\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6747500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4bGc.png?s=128&g=1", "display_name": "ThinkRedstone", "link": "https://stackoverflow.com/users/6747500/thinkredstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1486505766, "creation_date": 1486365572, "last_edit_date": 1486366264, "question_id": 42062261, "link": "https://stackoverflow.com/questions/42062261/creating-a-typeclass-that-returns-another-instance-of-that-typeclass-in-haskell", "title": "Creating a typeclass that returns another instance of that typeclass in haskell", "body": "<p>I'm trying to create a a system to derive symbolic functions, and I have a problem:</p>\n\n<p>I have a typeclass for expressions, <code>Exp</code>, that defines a derivative function:</p>\n\n<pre><code>class Exp e where \n    derivative :: (Exp d) =&gt; e -&gt; d\n</code></pre>\n\n<p>I want that class to have a few instances:</p>\n\n<pre><code>data Operator a b = a :* b | a :+ b\n\ninstance (Exp a, Exp b) =&gt; Exp (Operator a b)  where\n    derivative (f :* g) = ((derivative f) :* g) :+ (f :* (derivative g)) --The derivative of the multiplication of two expressions \n    derivative (f :+ g) = derivative f :+ derivative g --The derivative of the addition of two expressions\n\ninstance Exp Double where\n    derivative a = (0 :: Double)  --The derivative of a constant value is 0\n\n\ninstance Exp Char where\n    derivative c = (1 :: Double) --The derivative of just a variable is one\n</code></pre>\n\n<p>what I get I compile with ghci is:</p>\n\n<pre><code>math.hs:19:21: error:\n\u2022 Couldn't match expected type \u2018d\u2019 with actual type \u2018Double\u2019\n  \u2018d\u2019 is a rigid type variable bound by\n    the type signature for:\n      derivative :: forall d. Exp d =&gt; Double -&gt; d\n    at math.hs:19:5\n\u2022 In the expression: (0 :: Double)\n  In an equation for \u2018derivative\u2019: derivative a = (0 :: Double)\n  In the instance declaration for \u2018Exp Double\u2019\n\u2022 Relevant bindings include\n    derivative :: Double -&gt; d (bound at math.hs:19:5)\n\nmath.hs:22:21: error:\n\u2022 Couldn't match expected type \u2018d\u2019 with actual type \u2018Double\u2019\n  \u2018d\u2019 is a rigid type variable bound by\n    the type signature for:\n      derivative :: forall d. Exp d =&gt; Char -&gt; d\n    at math.hs:22:5\n\u2022 In the expression: (1 :: Double)\n  In an equation for \u2018derivative\u2019: derivative c = (1 :: Double)\n  In the instance declaration for \u2018Exp Char\u2019\n\u2022 Relevant bindings include\n    derivative :: Char -&gt; d (bound at math.hs:22:5)\n\nmath.hs:28:27: error:\n\u2022 Couldn't match expected type \u2018d\u2019\n              with actual type \u2018Operator (Operator a0 b) (Operator a b0)\u2019\n  \u2018d\u2019 is a rigid type variable bound by\n    the type signature for:\n      derivative :: forall d. Exp d =&gt; Operator a b -&gt; d\n    at math.hs:27:5\n\u2022 In the expression: derivative f :+ derivative g\n  In an equation for \u2018derivative\u2019:\n      derivative (f :+ g) = derivative f :+ derivative g\n  In the instance declaration for \u2018Exp (Operator a b)\u2019\n\u2022 Relevant bindings include\n    g :: b (bound at math.hs:28:22)\n    f :: a (bound at math.hs:28:17)\n    derivative :: Operator a b -&gt; d (bound at math.hs:27:5)\n</code></pre>\n\n<p>My question is this: why are my instance decelerations problematic? The derivative in each always resolves into an instance of <code>Exp</code> that is required by the type constrain of <code>derivative</code>, so why can't it match the type?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486340269, "post_id": 42058823, "comment_id": 71290167, "body": "Just a tip: to format large code chunks, highlight it, and press ctrl+k. Only. Use &quot;`&quot; s for small pieces."}, {"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 1, "creation_date": 1486340375, "post_id": 42058823, "comment_id": 71290182, "body": "Please try to express how the last line constructs its result in English. I think that will make it clear how it works."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486352237, "post_id": 42058823, "comment_id": 71292285, "body": "I can&#39;t help myself from pointing out this one-line gem that does what you want. It uses <code>filterM</code> from <code>Control.Monad</code>. <code>subset = filterM (const [False,True])</code>. And with just that, you get the same output (albeit arranged differently) as <code>subset</code> - it isn&#39;t even less efficient!"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486367483, "post_id": 42058823, "comment_id": 71297153, "body": "@Alec <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:subsequences\" rel=\"nofollow noreferrer\"><code>Data.List.subsequences</code></a>. Will also take only a single import."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1486368210, "post_id": 42058823, "comment_id": 71297430, "body": "@Zeta Oh of course. I have a fondness for that particular definition because IMO it brings out some of the best of Haskell - being able to define relatively complex operations succinctly in terms of highly polymorphic library functions. There is absolutely no boilerplate."}], "answers": [{"tags": [], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "is_accepted": true, "score": 2, "last_activity_date": 1486344291, "creation_date": 1486344291, "answer_id": 42059210, "question_id": 42058823, "link": "https://stackoverflow.com/questions/42058823/haskell-recursion-subsets/42059210#42059210", "title": "Haskell Recursion Subsets", "body": "<p>The last line says that the set of subsets of <code>x:xs</code> is the set of subsets of <code>xs</code> along with <code>x</code> added to each of those sets.</p>\n\n<p>Another way of putting it is that</p>\n\n<pre><code>zs &lt;- [ys,(x:ys)]\n</code></pre>\n\n<p>generates exactly two sets, <code>ys</code> and <code>x:ys</code> for each <code>ys</code> which is one of the subsets of <code>xs</code>. </p>\n"}], "owner": {"reputation": 13, "user_id": 7467186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2adbbe086d6b6a27aa0181cf7078f7fc?s=128&d=identicon&r=PG&f=1", "display_name": "dennisthemenace", "link": "https://stackoverflow.com/users/7467186/dennisthemenace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 1, "accepted_answer_id": 42059210, "answer_count": 1, "score": 1, "last_activity_date": 1486344291, "creation_date": 1486340069, "last_edit_date": 1486340285, "question_id": 42058823, "link": "https://stackoverflow.com/questions/42058823/haskell-recursion-subsets", "title": "Haskell Recursion Subsets", "body": "<p>i am new to Haskell. i am find it hard to understand  the below subset program  with recursion.what is the way it evaluates?</p>\n\n<pre><code>subset :: [a] -&gt; [[a]]\nsubset [] = [[]]\nsubset (x:xs) = [zs | ys &lt;- subset xs, zs &lt;- [ys,(x:ys)]]\n</code></pre>\n\n<hr>\n\n<p>output: <code>[[],[1],[2],[1,2],[3],[1,3],[2,3],[1,2,3]]</code></p>\n\n<p>When i manually evaluate it is summing up as below</p>\n\n<p>Manual Output:   <code>[],[3],[2],[1,2]</code></p>\n\n<p>I am missing some logic here can you please help me understand the above recursion concept and which part of guard statement will be evaluated first ,order of evaluation?</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 784, "user_id": 4541907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mA4xz.gif?s=128&g=1", "display_name": "sbowde4", "link": "https://stackoverflow.com/users/4541907/sbowde4"}, "edited": false, "score": 1, "creation_date": 1486326768, "post_id": 42056787, "comment_id": 71286371, "body": "Thank you so much, I didn&#39;t even think to do a base case. I had seen the (x:xs) before, but was not sure exactly what it meant. This is probably the most informative answer I have ever gotten on stackoverflow. Thank you!"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1486353151, "post_id": 42056787, "comment_id": 71292461, "body": "Note that this doesn&#39;t handle the cases where the lists are different lengths.  You should probably consider how to do that, even if it&#39;s not needed for the assignment."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1486354709, "post_id": 42056787, "comment_id": 71292789, "body": "@Carl: Well I left that out deliberately since the <i>dot product</i> over two vectors with different length is rather undefined. You can assume that the &quot;virtual tails&quot; contain zeros, but it is likely something is wrong with the code that generates the vectors."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 11, "last_activity_date": 1486333391, "last_edit_date": 1486333391, "creation_date": 1486325697, "answer_id": 42056787, "question_id": 42056615, "link": "https://stackoverflow.com/questions/42056615/obtaining-values-from-an-array/42056787#42056787", "title": "Obtaining Values from an Array", "body": "<p>This is technically speaking <strong>not an array</strong>, but a <strong>(linked-)list</strong>. That is something different. A list is defined as:</p>\n\n<pre><code>data [a] = [] | (a:[a])\n</code></pre>\n\n<p>So it is a data-type that has two constructors:</p>\n\n<ul>\n<li>the empty list <code>[]</code> which is used to signal the end of a list; and</li>\n<li>the <code>cons</code> that has two elements: an <code>a</code> (the item) and a reference to the tail (a <code>[a]</code>).</li>\n</ul>\n\n<p>Now that we know that you can use <strong>pattern</strong> matching to extract elements (and do tests). For instance in the following function:</p>\n\n<pre><code>head :: [a] -&gt; a\nhead (x:_) = x\n</code></pre>\n\n<p>Here <code>head</code> expects to see a <code>cons</code> construct and it <em>extracts</em> the head (the element of the first node) and returns that. Or for instance:</p>\n\n<pre><code>second :: [a] -&gt; a\nsecond (_:(x:_)) = x\n</code></pre>\n\n<p>here again you use pattern matching to extract the second element.</p>\n\n<p>Another way to obtain elements is using the <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:-33--33-\"><code>(!!) :: [a] -&gt; Int -&gt; a</code></a>. operator. You can obtain the <em>i</em>-th element (zero-based), by using:</p>\n\n<pre><code>list!!i\n</code></pre>\n\n<p>which is equivalent to <code>list[i]</code> in Java semantically. Mind however that - as said before - these are linked lists, so obtaining the <em>i</em>-th element requires <em>O(i)</em> computational effort. Although this may look like a detail it can become a bit dramatic when you want to fetch an object with a large index. Furthermore since <code>(!!)</code> is called, you are less certain there is such element: you have not that much guarantees that the list is indeed long enough. It is therefore wise to use pattern matching and look for clever ways to exploit the linked list data structure.</p>\n\n<p>For your example for the dot product, you can for instance first use pattern matching like:</p>\n\n<pre><code>dot (x:xs) (y:ys) = ...\n</code></pre>\n\n<p>and so you have extracted the <em>heads</em> <code>x</code> and <code>y</code> from the lists. And then you can multiply them and add them to the dot product of the remainder of the list:</p>\n\n<pre><code>dot (x:xs) (y:ys) = x*y + dot xs ys\n</code></pre>\n\n<p>now you only still need to define <strong>base case(s)</strong> like for instance:</p>\n\n<pre><code>dot [] [] = 0.0\n</code></pre>\n\n<p>so putting it all together:</p>\n\n<pre><code>dot :: [Float] -&gt; [Float] -&gt; Float\ndot [] [] = 0.0\ndot (x:xs) (y:ys) = x*y + dot xs ys\n</code></pre>\n"}], "owner": {"reputation": 784, "user_id": 4541907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mA4xz.gif?s=128&g=1", "display_name": "sbowde4", "link": "https://stackoverflow.com/users/4541907/sbowde4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 42056787, "answer_count": 1, "score": 2, "last_activity_date": 1486333391, "creation_date": 1486324819, "last_edit_date": 1486333341, "question_id": 42056615, "link": "https://stackoverflow.com/questions/42056615/obtaining-values-from-an-array", "title": "Obtaining Values from an Array", "body": "<p>I am incredibly new to Haskell, and I am having trouble with some homework. I do not understand how to properly take in an array, and use the data with in it. </p>\n\n<p>for example in java I would have something like</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>int[] arr = {...};\narr[0];\narr[1];\n</code></pre>\n\n<p>In my Haskell problem I have</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>dot :: [Float] -&gt; [Float] -&gt; Float\n-- enter code here\n</code></pre>\n\n<p>I can not find a way to use the data inside the float array. My professors example for this problem uses Vectors, but we have to use a <code>[Float]</code></p>\n\n<p>I'm not asking for anyone to do the problem, just an explanation on how to use the array.</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486327262, "post_id": 42055317, "comment_id": 71286569, "body": "The type of <code>varE n</code> is <code>Q Exp</code>. <code>Q</code> is a monad so you can write <code>varE n &gt;&gt;= (_ :: Exp -&gt; Q a) :: Q a</code>. Even simpler, use <code>VarE</code> instead of <code>varE</code>."}, {"owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486357213, "post_id": 42055317, "comment_id": 71293405, "body": "Thanks, it wasn&#39;t that easy with VarE (to me) but I got it compiling and almost doing whats required and can go fwd now: see the updated question (its formulation is a bit awkward in the updated form). If you make an answer from your hint I&#39;m willing to accept it. I didn&#39;t get (yet) your varE n &gt;&gt;= -hint but I&#39;ll try that one too later."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486368426, "post_id": 42055317, "comment_id": 71297503, "body": "You can write <code>$(lstF &#39;d)</code> as <code>$(listE $ map (\\fn -&gt; [| show ($(varE fn) d) |] ) fnms)</code> which has nested quotes, which often leads to nearly incomprehensible errors - it avoids using &#39;low level&#39; things though. You can also write it as <code>return $ ListE $ map (\\fn -&gt; AppE (VarE &#39;show) (AppE (VarE fn) (VarE &#39;d))) fnms</code>, which is only slightly larger but has no quotes. I&#39;m not sure what you&#39;re asking, as it seems <code>tpl2</code> already does what you want (i.e. &quot;when user want to tell the fields&quot; - the function takes a list of names - this is &#39;specified by the user&#39;)"}, {"owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486397037, "post_id": 42055317, "comment_id": 71315611, "body": "Thanks again for clarification and yes, now it does what I was asking for with your help (without stopping to some minor details). The main point was to be able to read &quot;the fields&quot;. So if you put something as an answer, I&#39;ll definitely accept it."}], "owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486356948, "creation_date": 1486317127, "last_edit_date": 1486356948, "question_id": 42055317, "link": "https://stackoverflow.com/questions/42055317/how-to-use-a-name-list-in-a-template-haskell-function", "title": "How to use a Name list in a Template Haskell function?", "body": "<p>I'd like to parameterize the template so that the user could give a list <code>Name</code>'s defining methods. </p>\n\n<p>The following example tries to be minimal. There is a <code>data D1</code> that contains fields, unknown in advance (to the template). Users wants to derive an instance that uses some of the fields and thus, it has to be told by the user next to declaring the data structure. The data structures are similar, for which we want to derive instances: however, the number of fields can vary.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule Main where\n\nimport Language.Haskell.TH\nimport Data.List (intercalate)\n\ndata D1 = D1 \n  { f1 :: Int\n  , f2 :: String\n  , f3 :: Double\n  } deriving (Show, Eq)\n\nclass Show2 a where\n  show2 :: a -&gt; String\n\n{-\ninstance Show2 D1 where\n  show2 d1 = \"1: \" ++ show (f1 d1) ++ \" and 2: \" ++ show (f3 d1)\n -}\n\ntpl1 :: Name -&gt; Q [Dec]\ntpl1 nm = \n  [d|\n    instance Show2 $(conT nm) where\n      show2 d1 = \"1: \" ++ show (f1 d1) ++ \" and 2: \" ++ show (f3 d1)\n   |]\n\n\ntpl2 :: Name -&gt; [Name] -&gt; Q [Dec]\ntpl2 nm fnms = do\n  -- let showName d n = show $(varE n) d  -- stage restriction\n  -- let showGo1 d n = [| show $(showName n) d |]  -- stage error \n  -- UPDATED based on a given hint:\n  let nmFs = return $ ListE (map VarE fnms) :: Q Exp -- compiles, but [Int, Double] is a problem\n      valF f d = AppE (VarE f) (VarE d) :: Exp\n      anmFs2 f d = return $ AppE (VarE 'GHC.Show.show) (valF f d ) :: Q Exp -- compiles and works with head\n      anmFs3 d f = AppE (VarE 'GHC.Show.show) (valF f d ) :: Exp \n      lstF d = return $\u00a0ListE (map (anmFs3 d) fnms)  :: Q Exp -- UPDATE ends\n  [d|\n    instance Show2 $(conT nm) where\n      -- UPDATED based on a given hint:\n      show2 d = intercalate \", \" $(lstF 'd) \n      -- show2 d = $(anmFs2 (head fnms) 'd) -- compiles and works, but only head here\n      -- show2 d = intercalate \", \" (map (\\n -&gt; show ( n d ) ) $(nmFs) ) -- compiles, [Int, Double] is a problem\n      -- UPDATE ends\n      -- show2 d = intercalate \", \" (map (\\n -&gt; show ( $(varE n) d) ) fnms )     -- stage error\n      -- show2 d = intercalate \", \" (map ( $(showName d) ) fnms ) -- showName in brackets in other module -&gt; stage error\n      -- show2 d = intercalate \", \" (map ( $(showGo1 d) ) fnms ) -- showName in brackets in other module -&gt; stage error\n   |]\n\n-- wishing to use, after data decl D1, like \n-- $(tpl2 ''D1 ['f1, 'f3])\n\nmain = do\n let d = D1 1 \"hmm\" 2.0\n -- putStrLn $ show2 d\n putStrLn $ \"hmm\"\n</code></pre>\n\n<p>The template could be written by using the instance or clause shown below and the combinators given in the th-lib. However, it feels a bit tedious and by using splices and brackets it would be much nicer. </p>\n\n<p>So, the question is how to write the show2 when user want to tell the fields? (Is the only option to use low-level facilities?)</p>\n\n<pre><code>-- ghci:\n-- pure []; $(tpl1 ''D1)\n-- &lt;interactive&gt;:12:1-7: Splicing declarations pure [] ======&gt;\n-- &lt;interactive&gt;:12:12-20: Splicing declarations\n--  tpl1 ''D1\n--   ======&gt;\n--   instance Show2 D1 where\n--     show2 d1_a5yR\n--       = (\"1: \" ++ ((show (f1 d1_a5yR)) \n--       ++ (\" and 2: \" ++ (show (f3 d1_a5yR)))))\n-- and\n-- $(tpl1 ''D1 &gt;&gt;= stringE . show)\n-- gives a representation mimickable with combinators. \n-- [InstanceD Nothing [] (AppT (ConT Main.Show2) (ConT Main.D1)) \n-- [FunD\n--   Main.show2 \n--     [Clause [VarP d1_6989586621679033595] \n--      (NormalB (InfixE (Just (LitE (StringL \\\"1: \\\"))) (VarE     GHC.Base.++) \n--       (Just (InfixE (Just (AppE (VarE GHC.Show.show) \n--        (AppE (VarE Main.f1) (VarE d1_6989586621679033595)))) (VarE\n--        GHC.Base.++) (Just (InfixE (Just (LitE (StringL \\\" and 2: \\\"))) (VarE\n--        GHC.Base.++) (Just (AppE (VarE GHC.Show.show) (AppE (VarE     Main.f3) (VarE\n--        d1_6989586621679033595)))))))\n--       ))\n--      ) \n--      []\n--     ]\n-- ]\n-- ]\n--\n</code></pre>\n"}, {"tags": ["list", "function", "haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486317244, "post_id": 42055247, "comment_id": 71282869, "body": "Can you explain the last two lines, because they do not seem to make much sense to me..."}, {"owner": {"reputation": 37, "user_id": 7442604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58fcce2425f6509e1fe489a8febf9442?s=128&d=identicon&r=PG&f=1", "display_name": "J.Dean", "link": "https://stackoverflow.com/users/7442604/j-dean"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486317716, "post_id": 42055247, "comment_id": 71283036, "body": "I think you mean the last 2 of my Code. So If x is an element of the list (y:ys) then create the list without the x. And i&#39;ve tried sth with recursion to do the same with xs but now it should check the first element of ys and Looks if there is one of it in xs."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486319933, "post_id": 42055247, "comment_id": 71283814, "body": "But you do not perform a recursive call, with the filtered list."}], "answers": [{"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 0, "last_activity_date": 1486319955, "creation_date": 1486319955, "answer_id": 42055763, "question_id": 42055247, "link": "https://stackoverflow.com/questions/42055247/haskell-about-recursion-in-list-function/42055763#42055763", "title": "Haskell about recursion in list function", "body": "<p>Pretending not to have any experience with this domain of problems or be very familiar with the functions in <code>base</code>, I'll rephrase your problem statement to describe the operation we want and show you how I'd approach it:</p>\n\n<blockquote>\n  <p>The result of <code>fun</code> on two lists is: all of the Elements of the first\n  list,who aren't in the second and all of the second List, who aren't\n  in the first.</p>\n</blockquote>\n\n<p>To begin expressing this in code, replace \"is\" with <code>=</code>:</p>\n\n<pre><code>func l1 l2 = (elementsOfFirstNotInSecond l1 l2) ++(elementsOfFirstNotInSecond l2 l1)\n</code></pre>\n\n<p>Now we need to implement <code>elementsOfFirstNotInSecond</code>, so let's start with words:</p>\n\n<blockquote>\n  <p><code>elementsOfFirstNotInSecond</code> on two lists is: if <code>l1</code> is the empty\n  list then the empty list, otherwise if the head of <code>l1</code> (we'll call it\n  \"<code>x</code>\") is a member of <code>l2</code> then <code>x</code> consed onto\n  <code>elementsOfFirstNotInSecond</code> of the <em>tail</em> of <code>l1</code> and <code>l2</code>. Otherwise\n  (if <code>x</code> was <em>not</em> in <code>l2</code>) it's <em>just</em> <code>elementsOfFirstNotInSecond</code> of\n  the tail of <code>l1</code> and <code>l2</code></p>\n</blockquote>\n\n<p>See if you can translate that to haskell, using not-yet-implemented functions (e.g. you might want to use (<code>isAMemberOf :: Int -&gt; [Int] -&gt; Bool</code>), and repeat the excercie.</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 7442604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58fcce2425f6509e1fe489a8febf9442?s=128&d=identicon&r=PG&f=1", "display_name": "J.Dean", "link": "https://stackoverflow.com/users/7442604/j-dean"}, "edited": false, "score": 0, "creation_date": 1486324107, "post_id": 42055929, "comment_id": 71285378, "body": "and how is a simpler or better way to solve it ? I just thought that i Need to use recursion if i want to solve this Kind of Problems."}, {"owner": {"reputation": 284, "user_id": 5738913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18eb2aec3b5e7f2bdcd975e7583fad0e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/5738913/abhishek-kumar"}, "reply_to_user": {"reputation": 37, "user_id": 7442604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58fcce2425f6509e1fe489a8febf9442?s=128&d=identicon&r=PG&f=1", "display_name": "J.Dean", "link": "https://stackoverflow.com/users/7442604/j-dean"}, "edited": false, "score": 0, "creation_date": 1486325627, "post_id": 42055929, "comment_id": 71285960, "body": "Well,for start you can use very simple function func x y = (x <code>union</code> y) \\\\ (x <code>intersect</code> y) .Remember to import Data.List"}, {"owner": {"reputation": 284, "user_id": 5738913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18eb2aec3b5e7f2bdcd975e7583fad0e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/5738913/abhishek-kumar"}, "reply_to_user": {"reputation": 37, "user_id": 7442604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58fcce2425f6509e1fe489a8febf9442?s=128&d=identicon&r=PG&f=1", "display_name": "J.Dean", "link": "https://stackoverflow.com/users/7442604/j-dean"}, "edited": false, "score": 0, "creation_date": 1486326258, "post_id": 42055929, "comment_id": 71286198, "body": "Backticks are not there due to formatting of code by SO.So you can use this version <code>func x y = (union x y) \\\\ (intersect x y)</code> or its inline equivalent in the above comment with backticks."}], "tags": [], "owner": {"reputation": 284, "user_id": 5738913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18eb2aec3b5e7f2bdcd975e7583fad0e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kumar", "link": "https://stackoverflow.com/users/5738913/abhishek-kumar"}, "is_accepted": false, "score": -1, "last_activity_date": 1486320933, "creation_date": 1486320933, "answer_id": 42055929, "question_id": 42055247, "link": "https://stackoverflow.com/questions/42055247/haskell-about-recursion-in-list-function/42055929#42055929", "title": "Haskell about recursion in list function", "body": "<p>Since you want recursion and are new with haskell,so solution(movin' in your direction) would be something like </p>\n\n<pre><code>func (x:xs) (y:ys) | elem x (y:ys) &amp;&amp; (not (elem y (x:xs))) = func xs (filter (/=x) (y:ys))\n                   | (not (elem x (y:ys))) &amp;&amp; (elem y (x:xs)) = func (filter (/=y) (x:xs)) ys\n                   | (elem x (y:ys)) &amp;&amp; (elem y (x:xs)) = func (filter (/=y) (xs)) (filter (/=x) (ys))\n                   | otherwise = x : y : (func xs ys)\n</code></pre>\n\n<p>But you can see how ugly and imbecile this is at later stages in your learning path.\nI suggest you go with simpler and concise alternative.</p>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": false, "score": 0, "last_activity_date": 1486388289, "creation_date": 1486388289, "answer_id": 42069182, "question_id": 42055247, "link": "https://stackoverflow.com/questions/42055247/haskell-about-recursion-in-list-function/42069182#42069182", "title": "Haskell about recursion in list function", "body": "<p>Does output order matter? </p>\n\n<p>If not, you could just use list difference <code>(\\\\)</code> from <code>Data.List</code></p>\n\n<pre><code>Prelude &gt; import Data.List\nPrelude Data.List&gt; as = [3,2,1,4]\nPrelude Data.List&gt; bs = [2,5,1]\nPrelude Data.List&gt; notinSec = as \\\\ bs\nPrelude Data.List&gt; notinFst = bs \\\\ as\nPrelude Data.List&gt; ans = notinSec ++ notinFst \nPrelude Data.List&gt; ans\n[3,4,5]\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7442604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58fcce2425f6509e1fe489a8febf9442?s=128&d=identicon&r=PG&f=1", "display_name": "J.Dean", "link": "https://stackoverflow.com/users/7442604/j-dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1486388289, "creation_date": 1486316667, "last_edit_date": 1486316845, "question_id": 42055247, "link": "https://stackoverflow.com/questions/42055247/haskell-about-recursion-in-list-function", "title": "Haskell about recursion in list function", "body": "<p>i'm tryin to create a function(i'm new in haskell) which Needs two lists and Returns one List. The List should have all of the  Elements of the first list,who aren't in the second and all of the second List, who aren't in the first.</p>\n\n<p>So:  <code>func [3,2,1,4] [2,5,1]</code> should return <code>[3,4,5]</code></p>\n\n<p>I think my Code goes to the right direction, but somewhere in it is a big mistake.</p>\n\n<pre><code>func :: [Int] -&gt; [Int] -&gt; [Int]\nfunc [] a = a\nfunc a [] = a\nfunc (x:xs) (y:ys) | elem x (y:ys) = filter (/=x) (y:ys)\n                   | otherwise = func ys xs\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 5081136, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42d7bb3df8aa37471fd8a058b4b0faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Tal", "link": "https://stackoverflow.com/users/5081136/tal"}, "edited": false, "score": 0, "creation_date": 1486317638, "post_id": 42055323, "comment_id": 71283009, "body": "thanks, i guess i just took their guarantee to the extreme :)"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 8, "last_activity_date": 1486317160, "creation_date": 1486317160, "answer_id": 42055323, "question_id": 42055237, "link": "https://stackoverflow.com/questions/42055237/guarantee-of-sameness-of-output-after-switching-order-in-functional-programming/42055323#42055323", "title": "Guarantee of sameness of output after switching order in functional programming", "body": "<p>When you compare <code>x(y(a))</code> to <code>y(x(a))</code>, those two expressions are not equivalent because <code>x</code> and <code>y</code> aren't called with the same arguments in each. In the first expression <code>x</code> is called with the argument <code>y(a)</code> and <code>y</code> is called with the argument <code>a</code>. Whereas in the second <code>y</code> is called with <code>x(a)</code>, not <code>a</code>, as its argument and <code>x</code> is called with <code>a</code>, not <code>y(a)</code>. So: different arguments, (possibly) different results.</p>\n\n<p>When people say that the order does not matter, they mean that in the following code:</p>\n\n<pre><code>a = f(x)\nb = g(y)\n</code></pre>\n\n<p>you can switch the definition of <code>a</code> and <code>b</code> without affecting their values. That is it makes no difference whether <code>f</code> is called before <code>g</code> or vice versa. This is clearly not true for the following code:</p>\n\n<pre><code>a = getchar()\nb = getchar()\n</code></pre>\n\n<p>If you switch <code>a</code> and <code>b</code> here, their values are switched as well, because <code>getchar</code> returns a (possibly) different character each time that it's called. So a purely functional language can't have a function exactly like <code>getchar</code>.</p>\n"}], "owner": {"reputation": 137, "user_id": 5081136, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42d7bb3df8aa37471fd8a058b4b0faf9?s=128&d=identicon&r=PG&f=1", "display_name": "Tal", "link": "https://stackoverflow.com/users/5081136/tal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486348128, "creation_date": 1486316607, "last_edit_date": 1486348128, "question_id": 42055237, "link": "https://stackoverflow.com/questions/42055237/guarantee-of-sameness-of-output-after-switching-order-in-functional-programming", "title": "Guarantee of sameness of output after switching order in functional programming", "body": "<p>I started reading some of Haskell's documentation, and there's a fundamental concept I just don't understand. I read about it in other places as well, but I want to understand it once and for all.</p>\n\n<p>In many places discussing functional programing, I keep reading that if the functions you're using are pure (have no side effects, and give same response for the same input at every call) then you can switch the order in which they are called when composing them, with it being guaranteed that the output of this composed call will remain the same regardless of the order.</p>\n\n<p>For example, here is <a href=\"https://wiki.haskell.org/IO_inside\" rel=\"nofollow noreferrer\">an entry from the Haskell Wiki</a>:</p>\n\n<blockquote>\n  <p>Haskell is a pure language, which means that the result of any\n  function call is fully determined by its arguments. Pseudo-functions\n  like rand() or getchar() in C, which return different results on each\n  call, are simply impossible to write in Haskell. Moreover, Haskell\n  functions can't have side effects, which means that they can't effect\n  any changes to the \"real world\", like changing files, writing to the\n  screen, printing, sending data over the network, and so on. These two\n  restrictions together mean that any function call can be replaced by\n  the result of a previous call with the same parameters, and the\n  language guarantees that all these rearrangements will not change the\n  program result!</p>\n</blockquote>\n\n<p>But when I fiddle with this idea I can quickly think of examples that contradict the statement above. For instance, let's say I have two functions (I will use pseudo code rather than Haskell):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>x(a)-&gt;a+3\n\ny(a)-&gt;a*3\n\n\nz(a)-&gt;x(y(a))\n\nw(a)-&gt;y(x(a))\n</code></pre>\n\n<p>Now, if we execute <code>z</code> and <code>w</code>, we get:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>z(5) //gives 3*5+3=18\n\nw(5) //gives (5+3)*3=24\n</code></pre>\n\n<p>That being so, I think I misunderstood the promised guarantee they speak about. Can anybody explain it to me?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1486332783, "post_id": 42054807, "comment_id": 71288505, "body": "This seems like a code review request, unless I&#39;m missing the question here"}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1486333469, "post_id": 42054807, "comment_id": 71288665, "body": "My actual question was <i>&quot;Is there a way to get all combinations of applying a function to single elements using lenses? i.e. f 1 2 [(1, 0), (1, 2)] = [[(2, 0) (1, 2)], [(1, 0), (2, 2)]]&quot;</i>. Should I emphasize that in some way?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1486394903, "post_id": 42054807, "comment_id": 71314034, "body": "I probably just need to read more carefully"}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486383248, "post_id": 42058166, "comment_id": 71306261, "body": "That&#39;s really cool although I think I might have to study up on category theory to fully appreciate what&#39;s happening here. I think it would be possible to change both fields with <code>map (peek dst) . holesOf (traverse . both . filter (== src))</code> as well. Sadly this solution is REALLY slow. Like, 80-100 times slower than my previous two. Still happy that it is possible at all, though!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486434478, "post_id": 42058166, "comment_id": 71332619, "body": "@Taren (1) &quot;I think it would be possible to change both fields with [...] as well&quot; -- Either with that, or by changing <code>changeFloor</code> to your favourite spelling of <code>set (both . filtered (== src)) dst</code>. (2) &quot;Sadly this solution is REALLY slow&quot; -- Just to be sure: are you compiling with <code>-O2</code>? I have just done a few tests (outside of the context of your original problem) which suggest <code>-O2</code> can speed up this <code>peeks</code>/<code>holesOf</code> combo by ~100x; that might make it competitive with your other solution, if you weren&#39;t using it yet."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1486443155, "last_edit_date": 1486443155, "creation_date": 1486334501, "answer_id": 42058166, "question_id": 42054807, "link": "https://stackoverflow.com/questions/42054807/generating-all-ways-of-applying-a-function-to-a-single-element-with-lens/42058166#42058166", "title": "Generating all ways of applying a function to a single element with lens", "body": "<blockquote>\n  <p>An easy solution could use a function that returns all options of moving a single item from floor x to floor y. Is there a way to get all combinations of applying a function to a single element using lenses? i.e. <code>f 1 2 [(1, 0), (1, 2)] = [[(2, 0) (1, 2)], [(1, 0), (2, 2)]]</code></p>\n</blockquote>\n\n<p><a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Traversal.html#v:holesOf\" rel=\"nofollow noreferrer\"><code>holesOf</code></a> can do that. Quoting the relevant simplified signature from the documentation:</p>\n\n<blockquote>\n<pre><code>holesOf :: Traversal' s a -&gt; s -&gt; [Pretext' (-&gt;) a s]\n</code></pre>\n</blockquote>\n\n<p>Given a traversal, <code>holesOf</code> will generate a list of contexts focused on each element targeted by the traversal. <code>peeks</code> from <a href=\"https://hackage.haskell.org/package/comonad-5/docs/Control-Comonad-Store.html\" rel=\"nofollow noreferrer\"><code>Control.Comonad.Store</code></a> can then be used to, from each context, modify the focused target and recreate the surrounding structure:</p>\n\n<pre><code>import Control.Lens\nimport Control.Comonad.Store\n\n-- allMoves :: Int -&gt; Int -&gt; State -&gt; [State]\nallMoves :: (Traversable t, Eq a) =&gt; a -&gt; a -&gt; t (a, b) -&gt; [t (a, b)]\nallMoves src dst its = peeks (changeFloor src dst) &lt;$&gt; holesOf traverse its\n    where\n    -- changeFloor :: Int -&gt; Int -&gt; (Int, Int) -&gt; (Int, Int)\n    changeFloor src dst = over both (\\x -&gt; if x == src then dst else x)\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; allMoves 1 2 [(1,0),(1,2)]\n[[(2,0),(1,2)],[(1,0),(2,2)]]\n</code></pre>\n"}], "owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 42058166, "answer_count": 1, "score": 1, "last_activity_date": 1486443155, "creation_date": 1486314205, "last_edit_date": 1486335246, "question_id": 42054807, "link": "https://stackoverflow.com/questions/42054807/generating-all-ways-of-applying-a-function-to-a-single-element-with-lens", "title": "Generating all ways of applying a function to a single element with lens", "body": "<p>This question is based on to the <a href=\"http://adventofcode.com/2016/day/11\" rel=\"nofollow noreferrer\">11th</a> advent of code task. It basically is a more general version of the river crossing puzzle, you can go up and down floors while carrying one or two items each step. The goal is to bring up all items to the 4th floor.<br>\nThis is fairly straightforward to solve with an A* search but finding the neighboring states is somewhat annoying.</p>\n\n<p>When solving the puzzle originally I just created masks for all items on the current floor and then used the list monad to generate the combinations - slow and awkward but it works. I figured that there would be an elegant solution using lenses, though.</p>\n\n<p>An easy solution could use a function that returns all options of moving a single item from floor x to floor y. Is there a way to get all combinations of applying a function to a single element using lenses? i.e. <code>f 1 2 [(1, 0), (1, 2)] = [[(2, 0) (1, 2)], [(1, 0), (2, 2)]]</code></p>\n\n<hr>\n\n<p>For the sake of reference, this is the best I could come up with so far, slightly simplified:</p>\n\n<pre><code>import Control.Lens\nimport Data.List (sort)\nimport Data.Set (fromList, Set)\n\ntype GenFloor = Int\ntype ChipFloor = Int\ntype State = [(GenFloor, ChipFloor)]\n\nneighborStates :: Int -&gt; State -&gt; Set State\nneighborStates currentFloor state = finalize $ createStatesTowards =&lt;&lt; [pred, succ]\n  where\n    createStatesTowards direction = traverseOf (traverse . both) (moveTowards direction) state\n    moveTowards direction i\n      | i == currentFloor = [direction i, i]\n      | otherwise         = [i]\n\n    finalize = fromList . map sort . filter valid\n    valid = (&amp;&amp;) &lt;$&gt; validCarry &lt;*&gt; validFloors\n    validCarry = (`elem` [1..2]) . carryCount \n    carryCount = length . filter (uncurry (/=)) . zip state\n    validFloors = allOf (traverse . each) (`elem` [1..4])\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 2, "creation_date": 1486314092, "post_id": 42054650, "comment_id": 71281742, "body": "You might want to rewrite this using folds and maps instead of recursing directly. This would allow you to attach a <code>where</code> or a <code>let</code> binding where you&#39;d define your <code>avg</code> as something along the lines of <code>(foldr (+) 0 xs) &#47; length xs</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1486314251, "post_id": 42054764, "comment_id": 71281802, "body": "Ah, we&#39;ve written the same program. I&#39;ll delete my answer for brevity&#39;s sake :)"}, {"owner": {"reputation": 2445, "user_id": 4468969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6b05d7f3493f7c284f67b1f2c1557f58?s=128&d=identicon&r=PG", "display_name": "Andi Pavllo", "link": "https://stackoverflow.com/users/4468969/andi-pavllo"}, "edited": false, "score": 0, "creation_date": 1486314265, "post_id": 42054764, "comment_id": 71281805, "body": "You nailed it, I don&#39;t know how I could not think it, thanks!"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 6, "last_activity_date": 1486313969, "creation_date": 1486313969, "answer_id": 42054764, "question_id": 42054650, "link": "https://stackoverflow.com/questions/42054650/save-variable-and-use-it-on-recursion/42054764#42054764", "title": "Save variable and use it on recursion", "body": "<p>Move the recursion into a helper function. That function can either take the average as a parameter or you could define locally to <code>printVariance</code> and define another local variable holding the average, which the function could then access.</p>\n\n<p>In code:</p>\n\n<pre><code>printVariance :: [Float] -&gt; IO ()\nprintVariance xs = loop xs\n  where\n    average = avg xs\n    loop [] = return ()\n    loop (x:xs)\n      | x &gt;= average = print (x - average) &gt;&gt; loop xs\n      | otherwise = loop xs\n</code></pre>\n\n<p>PS: It would be good design to separate the IO from the program logic. So I'd recommend you make your function simply produce a list of the values you want, rather than printing them and move the IO into a separate function (or just <code>main</code>).</p>\n\n<p>PPS: You're not really calculating the variance, so I'd recommend naming the function something else.</p>\n"}], "owner": {"reputation": 2445, "user_id": 4468969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6b05d7f3493f7c284f67b1f2c1557f58?s=128&d=identicon&r=PG", "display_name": "Andi Pavllo", "link": "https://stackoverflow.com/users/4468969/andi-pavllo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 42054764, "answer_count": 1, "score": 1, "last_activity_date": 1486339789, "creation_date": 1486313267, "last_edit_date": 1486339789, "question_id": 42054650, "link": "https://stackoverflow.com/questions/42054650/save-variable-and-use-it-on-recursion", "title": "Save variable and use it on recursion", "body": "<p>Suppose I have the following function</p>\n\n<pre><code>printVariance :: [Float] -&gt; IO ()\nprintVariance [] = return ()\nprintVariance (x:xs)\n    | x &gt;= avg (x:xs) = print (x - avg (x:xs)) &gt;&gt; printVariance xs\n    | otherwise       = printVariance xs\n</code></pre>\n\n<p>Which gets a list, checks which elements are bigger than the average and prints their <code>value - avg</code>.</p>\n\n<p>My problem is that the <code>avg</code> value changes every step. How can I define it just once and use its value for the recursion?</p>\n"}, {"tags": ["haskell", "functor"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 9, "last_activity_date": 1486313540, "creation_date": 1486313540, "answer_id": 42054696, "question_id": 42054569, "link": "https://stackoverflow.com/questions/42054569/arrow-operator-in-functor-instance-declarations/42054696#42054696", "title": "Arrow operator in functor instance declarations?", "body": "<p>We have:</p>\n\n<pre><code>class Fluffy f where\n  furry :: (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>We want to define:</p>\n\n<pre><code>instance Fluffy ((-&gt;) t) where\n  furry = ...\n</code></pre>\n\n<p>This means that in the above instance <code>furry</code> should have the type <code>(a -&gt; b) -&gt; f a -&gt; f b</code> where <code>f</code> is <code>((-&gt;) t)</code>, or in other words:</p>\n\n<pre><code>furry :: (a -&gt; b) -&gt; ((-&gt;) t) a -&gt; ((-&gt;) t) b\n</code></pre>\n\n<p>Just as <code>((+) 2) 3</code> is the same as <code>2 + 3</code>, <code>((-&gt;) X) Y</code> is the same as <code>X -&gt; Y</code> (it's curried operator application and it even works at the type level):</p>\n\n<pre><code>furry :: (a -&gt; b) -&gt; (t -&gt; a) -&gt; (t -&gt; b)\n</code></pre>\n\n<p>We can read the above signature as \"<em>given a function from <code>a</code> to <code>b</code> and a function from <code>t</code> to <code>a</code>, return a function from <code>t</code> to <code>b</code></em>\".</p>\n\n<p>Now you just have to implement it. :-)</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1486313586, "creation_date": 1486313586, "answer_id": 42054703, "question_id": 42054569, "link": "https://stackoverflow.com/questions/42054569/arrow-operator-in-functor-instance-declarations/42054703#42054703", "title": "Arrow operator in functor instance declarations?", "body": "<p>We define the <code>Functor</code> instance as such:</p>\n\n<pre><code>instance Functor ((-&gt;) a) where\n    fmap f g = \\a -&gt; f (g a)\n    -- Pointfree definition: fmap = (.)\n</code></pre>\n\n<p>That is to say, the <code>(-&gt;)</code> functor is comparable to a container that can only be 'opened' by getting some value of type <code>a</code> and 'opening' the container with it. Any <code>fmap</code> is then just changing the value after we 'open' the container. Ie: composing functions.</p>\n\n<p>This is a bit like the <code>Maybe</code> functor in that I can apply a function to the value if it exists, but for the <code>(-&gt;)</code> functor I'm doing that before we know what it is. </p>\n\n<p>But remember that all monads are functors, since we could just define <code>fmap</code> as so:</p>\n\n<pre><code>fmap f m = m &gt;&gt;= (\\a -&gt; return (f a))\n</code></pre>\n\n<p>So if you understand what that would do in the <code>Monad</code> instance it should be clear what it does in the <code>Functor</code> instance.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 1, "accepted_answer_id": 42054696, "answer_count": 2, "score": 2, "last_activity_date": 1486313586, "creation_date": 1486312714, "last_edit_date": 1495535367, "question_id": 42054569, "link": "https://stackoverflow.com/questions/42054569/arrow-operator-in-functor-instance-declarations", "title": "Arrow operator in functor instance declarations?", "body": "<p>I'm going through <a href=\"http://blog.tmorris.net/posts/20-intermediate-haskell-exercises/\" rel=\"nofollow noreferrer\">these</a> Haskell 'intermediate' exercises, I've made the following instances:</p>\n\n<pre><code>class Fluffy f where\n  furry :: (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance Fluffy [] where\n  furry f [] = []\n\ninstance Fluffy Maybe where\n  furry f (Just e) = Just (f e)\n  furry f (Nothing) = Nothing\n</code></pre>\n\n<p>However, the third question syntax has stumped me: </p>\n\n<pre><code>instance Fluffy ((-&gt;) t) where\n  ...\n</code></pre>\n\n<p>I've read up on the arrow operator and also read the answer to <a href=\"https://stackoverflow.com/questions/9136421/where-can-i-read-up-on-the-haskell-operator\">this</a> which explains the role  of <code>(-&gt;)</code> in a Monad instance. However I don't quite understand how <code>(-&gt;)</code> works in the context of Functors?</p>\n"}, {"tags": ["haskell", "dynamic"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1486311153, "post_id": 42054150, "comment_id": 71280684, "body": "The type signature for <code>dataList</code> makes no sense. You should start there. (Also, your implementation is effectively <code>id :: [a] -&gt; [a]</code>, which does nothing.)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1486311304, "post_id": 42054150, "comment_id": 71280741, "body": "Try defining a simpler version first. What would you have to write to get <code>dataList (DataNode 42)</code> to return <code>[42]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1486410006, "creation_date": 1486410006, "answer_id": 42075929, "question_id": 42054150, "link": "https://stackoverflow.com/questions/42054150/dynamic-tree-to-list-in-haskell/42075929#42075929", "title": "Dynamic Tree to List in Haskell", "body": "<p>The simplest way is to let your (modern version of GHC) compiler define it for you. The following sets the appropriate language extension, and sets your desired definition to be the default <code>toList</code> definition. I included the assignment, but usually you would just call <code>toList</code>. </p>\n\n<pre><code>{-# Language DeriveFoldable #-}\nmodule MultTreeList  where\n\nimport Data.Foldable(toList)\n\ndata MultTree a = DataNode a | IndexNode a a [MultTree a] \n   deriving (Foldable,Show)\n\nt1 :: MultTree Int\nt1 =  IndexNode 3 42 [IndexNode 3 15 [DataNode 3, DataNode 11, DataNode 12], IndexNode 9 42 [DataNode 42, DataNode 23]]\n\ndataList :: MultTree a -&gt; [a]\ndataList = toList\n</code></pre>\n\n<p>Note the type signature. Your question supposes a signature of <code>MultTree -&gt; [DataNode] -&gt; [Int]</code>. This is bad on a few counts. One you forgot the type parameter of MultiTree. Second DataNode is a type constructor, not a type. Including a constructor in a type signature is not allowed. It would be a bit like specifying an <code>add</code> function such as</p>\n\n<pre><code>add1 :: Int -&gt; 1 -&gt; Int\n</code></pre>\n\n<p>to represent a function which adds one to an Int. I think you intended for a type signature such as I wrote.</p>\n\n<p>Loading the module in GHCI.</p>\n\n<pre><code>*MultTreeList&gt; dataList t1\n[3,42,3,15,3,11,12,9,42,42,23]\n</code></pre>\n\n<p>Failing the above method, you need a way to map your two constructors to the appropriate list constructions. You have two patterns which need to be addressed, </p>\n\n<pre><code>dataList (DataNode a) = ?\ndataList (IndexNode a b mts) = ??\n</code></pre>\n\n<p>I'll help get you started.</p>\n\n<pre><code>dataList (DataNode a) = [a]\ndataList (IndexNode a b mts) = a : b :  (??? mts)\n</code></pre>\n\n<p>Note the type signature of <code>??? :: [MultTree a] -&gt; [a]</code></p>\n"}], "owner": {"reputation": 9, "user_id": 7519583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d948cc32868578945c0d705c478968ee?s=128&d=identicon&r=PG&f=1", "display_name": "Finn", "link": "https://stackoverflow.com/users/7519583/finn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486410006, "creation_date": 1486310457, "last_edit_date": 1486310946, "question_id": 42054150, "link": "https://stackoverflow.com/questions/42054150/dynamic-tree-to-list-in-haskell", "title": "Dynamic Tree to List in Haskell", "body": "<p>I would like to get a list of the elements of my dynamic tree.</p>\n\n<p>I have two types of nodes:</p>\n\n<ul>\n<li>Indexnodes, which can store two numbers and any amount of children/subtrees (no subtrees are also allowed)</li>\n<li>Datanodes, which can store a number.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/HiYvl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HiYvl.jpg\" alt=\"An example how it can look like\"></a></p>\n\n<pre><code>data MultTree a = DataNode a | IndexNode a a [MultTree a] deriving Show\n\nt1 :: MultTree Int\nt1 =  IndexNode 3 42 [IndexNode 3 15 [DataNode 3, DataNode 11, DataNode 12], IndexNode 9 42 [DataNode 42, DataNode 23]]\n\ndataList:: MultTree -&gt; [DataNode] -&gt; [Int]\ndataList[] = []\ndataList(x:xs) = x : dataList xs\n</code></pre>\n\n<p>The list has to include all datanodes. So for <code>dataList t1</code> the list should look like <code>[3, 11, 12, 42, 23]</code>.</p>\n\n<p>The function <code>dataList</code>, which I have coded does not work.</p>\n\n<p>Does someone have an idea how I can solve it?</p>\n"}, {"tags": ["haskell", "types", "monads", "overlapping-instances"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486328856, "post_id": 42053915, "comment_id": 71287134, "body": "The error is not related to <code>test</code> - the <code>Monad</code> and <code>Applicative</code> instances fail with an overlap error, because your instances are overlapping very badly. The only constraint of the form <code>SuperClass1 a b</code> that the compiler will be able to solve here is <code>SuperClass1 a a</code> - that is, when the types are a-priori known to be the same. In all other cases, it will give you an error. (also note, GHC doesn&#39;t even know that <code>SuperClass1 Functor c</code> implies <code>Functor</code> when <code>c</code> holds - as far as it is concerned, <code>SuperClass1</code> actually contains no information)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1487241146, "post_id": 42053915, "comment_id": 71698819, "body": "not sure if it&#39;s related to what you&#39;re asking but reading it as Prolog, <code>(SuperClass1 b c, Class1 c h) =&gt; SuperClass1 b h</code> should be <code>(Class1 c h, SuperClass1 b c) =&gt; SuperClass1 b h</code>. See if this changes anything. Shooting in the dark here. :)"}], "answers": [{"comments": [{"owner": {"reputation": 11510, "user_id": 5852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba340386ad2afc76d4a9602410b4e449?s=128&d=identicon&r=PG", "display_name": "Sjoerd Visscher", "link": "https://stackoverflow.com/users/5852/sjoerd-visscher"}, "edited": false, "score": 0, "creation_date": 1487233316, "post_id": 42244888, "comment_id": 71693196, "body": "Great solution, thanks! I&#39;ll give the bounty when I get the chance to check the solution this weekend."}, {"owner": {"reputation": 11510, "user_id": 5852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba340386ad2afc76d4a9602410b4e449?s=128&d=identicon&r=PG", "display_name": "Sjoerd Visscher", "link": "https://stackoverflow.com/users/5852/sjoerd-visscher"}, "edited": false, "score": 0, "creation_date": 1487518612, "post_id": 42244888, "comment_id": 71810948, "body": "Got it working, see <a href=\"https://hackage.haskell.org/package/free-functors-0.7.1/docs/src/Data-Constraint-Class1.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/free-functors-0.7.1/docs/src/&hellip;</a>  Using type families like this is a really neat trick!"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1487195574, "last_edit_date": 1487195574, "creation_date": 1487149535, "answer_id": 42244888, "question_id": 42053915, "link": "https://stackoverflow.com/questions/42053915/unexpected-overlapping-instances-error/42244888#42244888", "title": "Unexpected Overlapping instances error", "body": "<blockquote>\n  <p>But somehow GHC is smart enough to understand that <code>SuperClass1 Applicative c</code> implies <code>SuperClass1 Functor c</code>, because it doesn't complain about a missing constraint. </p>\n</blockquote>\n\n<p>I fear you are being too hopeful - GHC is probably working its way from the other end and giving up immediately: it sees <code>fmap</code> and tries to check that <code>HFree</code> is a <code>Functor</code>. It has only one instance to pick from: <code>SuperClass1 Functor c =&gt; Functor (HFree c f)</code>. Then, it starts trying to satisfy the constraint on that instance (<code>SuperClass1 Functor c</code>) and suddenly realizes it doesn't know what to do - there are two instances it could pick:</p>\n\n<ul>\n<li><code>SuperClass1 b b</code></li>\n<li><code>SuperClass1 b h</code></li>\n</ul>\n\n<p>Notice that I left out the constraints on these instances - that's because <em>GHC needs to commit to an instance before even looking at the constraints on the left hand side</em>. With that said, @user2407038's comment is quite true: your instances overlap pretty badly - GHC doesn't know a priori  if it should try to unify <code>b ~ Functor</code> and <code>b ~ c</code> or <code>b ~ Functor</code> and <code>h ~ c</code>. Both could work.</p>\n\n<p>If it was the case that picking <em>either</em> would work, you should turn on <code>IncoherentInstances</code>. This is, unfortunately, not the case here. You <em>know</em> that you want the second instance picked, but GHC doesn't.</p>\n\n<hr>\n\n<p>I've recently been <a href=\"https://gist.github.com/harpocrates/38ec83098cd45d7e8bccbb2d7001acb5\" rel=\"nofollow noreferrer\">toying around with a similar sort of problem but in relation to subtyping</a> but no matter how you go about it, instance resolution is really hard. My advice to you is to use type families when you can. </p>\n\n<h1>EDIT</h1>\n\n<p>Here is a solution to get your code to compile, except relying on type families instead of type-classes. The setup machinery is</p>\n\n<pre><code>{-# LANGUAGE PolyKinds, ConstraintKinds, TypeFamilies, UndecidableInstances, DataKinds, TypeOperators #-}\n\nimport Data.Kind (Constraint)\n\n-- Find transitively all the superclasses of a constraint (including itself)\ntype family SuperClasses (x :: k -&gt; Constraint) :: [k -&gt; Constraint]\ntype instance SuperClasses Functor = '[Functor]\ntype instance SuperClasses Applicative = Applicative ': SuperClasses Functor\ntype instance SuperClasses Monad = Monad ': SuperClasses Applicative\n\n-- Type level version of `elem` which is a Constraint\ntype family Elem (x :: k) (xs :: [k]) :: Constraint where\n  Elem a (a ': bs) = ()\n  Elem a (b ': bs) = Elem a bs\n\n-- Type level version of checking the first list is a subset of the second\ntype family Subset (xs :: [k]) (ys :: [k]) :: Constraint where\n  Subset '[] bs = ()\n  Subset (a ': as) bs = (Elem a bs, Subset as bs)\n\n-- Tell us whether the constraint x is a sub-constraint (thereby implied by) y\ntype x &lt;: y = SuperClasses x `Subset` SuperClasses y\n</code></pre>\n\n<p>Then, applied to <code>Functor</code>, <code>Applicative</code>, and <code>Monad</code>, we need</p>\n\n<pre><code>-- I've cropped the body of HFree since it is of no interest here\ndata HFree c f a\n\ninstance Functor     &lt;: c =&gt; Functor     (HFree c f)\ninstance Applicative &lt;: c =&gt; Applicative (HFree c f)\ninstance Monad       &lt;: c  =&gt; Monad      (HFree c f)\n</code></pre>\n\n<p>And here are some tests</p>\n\n<pre><code>-- Compiles\ntest1 :: (a -&gt; b) -&gt; HFree Monad f a -&gt; HFree Monad f b\ntest1 = fmap\n\n-- Compiles\ntest2 :: a -&gt; HFree Monad f a\ntest2 = pure\n\n-- Doesn't compile\ntest3 :: a -&gt; HFree Functor f a\ntest3 = pure\n</code></pre>\n"}], "owner": {"reputation": 11510, "user_id": 5852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba340386ad2afc76d4a9602410b4e449?s=128&d=identicon&r=PG", "display_name": "Sjoerd Visscher", "link": "https://stackoverflow.com/users/5852/sjoerd-visscher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 42244888, "answer_count": 1, "score": 2, "last_activity_date": 1487271448, "creation_date": 1486309236, "last_edit_date": 1487271448, "question_id": 42053915, "link": "https://stackoverflow.com/questions/42053915/unexpected-overlapping-instances-error", "title": "Unexpected Overlapping instances error", "body": "<p>I have the following code. <code>Class1</code> instances say what the direct superclass is of a class, <code>SuperClass1</code> automatically traverses <code>Class1</code> to find all superclasses. (I have omitted the actual methods of these classes because they are not relevant for my issue.)</p>\n\n<pre><code>{-# LANGUAGE PolyKinds, RankNTypes, ConstraintKinds, FlexibleInstances, UndecidableInstances, MultiParamTypeClasses, FunctionalDependencies #-}\n\nclass Class1 b h | h -&gt; b\ninstance Class1 Functor Applicative\ninstance Class1 Applicative Monad\n\nclass SuperClass1 b h\ninstance {-# OVERLAPPING #-} SuperClass1 b b\ninstance {-# OVERLAPPABLE #-} (SuperClass1 b c, Class1 c h) =&gt; SuperClass1 b h\n</code></pre>\n\n<p>This works great! Now I want to use it like this:</p>\n\n<pre><code>newtype HFree c f a = HFree { runHFree :: forall g. c g =&gt; (forall b. f b -&gt; g b) -&gt; g a }\n\ninstance SuperClass1 Functor c =&gt; Functor (HFree c f)\ninstance SuperClass1 Applicative c =&gt; Applicative (HFree c f)\ninstance SuperClass1 Monad c =&gt; Monad (HFree c f)\n\ntest :: (a -&gt; b) -&gt; HFree Monad f a -&gt; HFree Monad f b\ntest = fmap\n</code></pre>\n\n<p>(I.e. I can give an instance of <code>Functor</code> for <code>Hfree c f</code> whenever <code>Functor</code> is a superclass of <code>c</code>.)</p>\n\n<p>And this gives this error in the Applicative instance (and similar for the Monad instance):</p>\n\n<pre><code>\u2022 Overlapping instances for SuperClass1 Functor c1\n    arising from the superclasses of an instance declaration\n  Matching instances:\n    instance [overlappable] forall k k k (b :: k) (c :: k) (h :: k).\n                            (SuperClass1 b c, Class1 c h) =&gt;\n                            SuperClass1 b h\n      -- Defined at superclass.hs:17:31\n    instance [overlapping] forall k (b :: k). SuperClass1 b b\n      -- Defined at superclass.hs:16:30\n  (The choice depends on the instantiation of \u2018c1, k1\u2019\n   To pick the first instance above, use IncoherentInstances\n   when compiling the other instance declarations)\n\u2022 In the instance declaration for \u2018Applicative (HFree c f)\u2019\n</code></pre>\n\n<p>As far as I understand, what happens is that an Applicative instance requires a Functor instance, so the Applicative instance also needs the <code>SuperClass1 Functor c</code> constraint from Functor. And indeed if I add this, the error goes away. (This is what I currently have: <a href=\"http://hackage.haskell.org/package/free-functors-0.7/docs/Data-Functor-HFree.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/free-functors-0.7/docs/Data-Functor-HFree.html</a>)</p>\n\n<p>But somehow GHC is smart enough to understand that <code>SuperClass1 Applicative c</code> implies <code>SuperClass1 Functor c</code>, because it doesn't complain about a missing constraint. Instead it gets stuck on an overlapping instances error. It would be great if there's a way to fix the error, but I can't figure out how!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 5, "creation_date": 1486301152, "post_id": 42052538, "comment_id": 71277293, "body": "Are you sure that&#39;s the type you get for the whole definition? It looks like the type you&#39;d get for only the second case. If you&#39;re typing the function into GHCi, you&#39;ll need to define the function within a single <code>let</code>. If you use two <code>let</code>s, the second one just replaces the first."}, {"owner": {"reputation": 83, "user_id": 7519086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d51672ccf81597ea02e16869fe1df1?s=128&d=identicon&r=PG&f=1", "display_name": "user1299292", "link": "https://stackoverflow.com/users/7519086/user1299292"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1486301281, "post_id": 42052538, "comment_id": 71277326, "body": "Ok thx I&#39;ll try it"}, {"owner": {"reputation": 83, "user_id": 7519086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d51672ccf81597ea02e16869fe1df1?s=128&d=identicon&r=PG&f=1", "display_name": "user1299292", "link": "https://stackoverflow.com/users/7519086/user1299292"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1486301446, "post_id": 42052538, "comment_id": 71277370, "body": "Aah now I get: ([t1] -&gt; t) -&gt; [([t1] -&gt; t) -&gt; [t1] -&gt; t] -&gt; t"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7519086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d51672ccf81597ea02e16869fe1df1?s=128&d=identicon&r=PG&f=1", "display_name": "user1299292", "link": "https://stackoverflow.com/users/7519086/user1299292"}, "edited": false, "score": 0, "creation_date": 1486303653, "post_id": 42052908, "comment_id": 71278026, "body": "Thank you for the detailed explantation! It&#39;s a good idea with the Questionmarks!"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 6, "last_activity_date": 1486303098, "creation_date": 1486303098, "answer_id": 42052908, "question_id": 42052538, "link": "https://stackoverflow.com/questions/42052538/understanding-the-type-of-this-haskell-function/42052908#42052908", "title": "Understanding the type of this Haskell function", "body": "<blockquote>\n  <p>I just have two \"Inputs\" or not?</p>\n</blockquote>\n\n<p>Yes, you have two parameters (technically one because of the way currying works).</p>\n\n<blockquote>\n  <p>With :info a I get: <code>([t1] -&gt; t) -&gt; [([t1] -&gt; t) -&gt; [t1] -&gt; t] -&gt; t</code></p>\n</blockquote>\n\n<p>This means the first parameter has type <code>[t1] -&gt; t</code> (so it's a function that takes a list of <code>t1</code>s and produces a <code>t</code>), the second parameter has type <code>[([t1] -&gt; t) -&gt; [t1] -&gt; t]</code> (a list of functions that take a function of type <code>[t1] -&gt; t</code> and a list of <code>t1</code>s and produce a <code>t</code>) and the result has type <code>t</code>.</p>\n\n<blockquote>\n  <p>But I cannot understand why.</p>\n</blockquote>\n\n<p>Let's look at the code:</p>\n\n<pre><code>a x (b:bs) =\n</code></pre>\n\n<p>The first parameter is just a variable pattern, so its type is anything. The second one is a list pattern, so it must be a list.</p>\n\n<p>So if we use numbered question marks to denote types we don't know yet, we so far know the following:</p>\n\n<pre><code>x :: ?1\nb :: ?2\nbs :: [?2]\na :: ?1 -&gt; [?2] -&gt; ?3\n</code></pre>\n\n<p>Now let's look at the body:</p>\n\n<pre><code>a (b x) bs\n</code></pre>\n\n<p><code>b</code> is applied to <code>x</code>, so <code>b</code> must be a function that takes the type of <code>x</code> as its parameter. The result of <code>b x</code> is used as the first argument to <code>a</code>, so the result type of <code>b</code> must also match the type of <code>x</code>. Thus <code>?2</code> must be <code>?1 -&gt; ?1</code> and we get:</p>\n\n<pre><code>x :: ?1\nb :: ?1 -&gt; ?1\nbs :: [?1 -&gt; ?1]\na :: ?1 -&gt; [?1 -&gt; ?1] -&gt; ?3\n</code></pre>\n\n<p>Now let's take a look at the second body (<code>b</code> and <code>bs</code> are now no longer in scope, technically there's a new <code>b</code>, but it's not used, so we'll ignore it):</p>\n\n<pre><code>x []\n</code></pre>\n\n<p>Here <code>x</code> is applied to an empty list. So it must also be a function and its parameter type is some sort of list. Since the result of <code>x []</code> is also the result of the <code>a</code>, <code>x</code>'s result type must be <code>?3</code>. So we get <code>?1 = [?4] -&gt; ?3</code> and thus:</p>\n\n<pre><code>a :: ([?4] -&gt; ?3) -&gt; [([?4] -&gt; ?3) -&gt; ([?4] -&gt; ?3)] -&gt; ?3\n</code></pre>\n\n<p>Since <code>-&gt;</code> is right-associative, we can get rid of the parentheses at the end there and get:</p>\n\n<pre><code>a :: ([?4] -&gt; ?3) -&gt; [([?4] -&gt; ?3) -&gt; [?4] -&gt; ?3] -&gt; ?3\n</code></pre>\n\n<p>And now, since that's all the type information we have, all the question marks that are left are actual type variables, so we can replace them with arbitrary type variable names. If we choose <code>?3 = t</code> and <code>?4 = t1</code>, we get the exact output of <code>info</code> (but of course we could name them anything else and the type would still be equivalent).</p>\n"}, {"tags": [], "owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "is_accepted": false, "score": 1, "last_activity_date": 1486312271, "last_edit_date": 1486312271, "creation_date": 1486311896, "answer_id": 42054408, "question_id": 42052538, "link": "https://stackoverflow.com/questions/42052538/understanding-the-type-of-this-haskell-function/42054408#42054408", "title": "Understanding the type of this Haskell function", "body": "<p>If you only look at the first half of the definition we get a nice type:</p>\n\n<pre><code>a :: t -&gt; [t -&gt; t] -&gt; t1\na x (b:bs) = a (b x) bs\n</code></pre>\n\n<p>We take a value and apply a bunch of functions from the list to it. We don't know yet what happens after we run out of functions because we haven't looked at the second part yet.</p>\n\n<p>Lets try to imagine another ending first:</p>\n\n<pre><code>a :: t -&gt; [t -&gt; t] -&gt; t\na x [] = x\n</code></pre>\n\n<p>When we are done we return our final value. Note that this solved our uncertain return type. Since we just do reversed function application over a list we could just fold with reversed function application over the list and get the same function:</p>\n\n<pre><code>a :: t -&gt; [t -&gt; t] -&gt; t\na = foldl (flip ($))\n</code></pre>\n\n<p>But that isn't how our function ends in reality. It ends with</p>\n\n<pre><code>a x [] = x []\n</code></pre>\n\n<p>Here is what we just learned: <code>x</code>  is a function that takes an list of somethings and returns something. What these somethings are we can't say so lets call them <code>t1</code> and <code>t2</code>. We know <code>x</code>'s type is <code>t</code> so we can just replace all occurrences of <code>t</code> in our first function with <code>[t1] -&gt; t2</code>:</p>\n\n<pre><code>a :: ([t1] -&gt; t2) -&gt; [([t1] -&gt; t2) -&gt; ([t1] -&gt; t2)] -&gt; t2\n</code></pre>\n\n<p>And that is how that type signature happened! We also know that it is equivalent to:</p>\n\n<pre><code>a x ls = foldl (flip ($)) x ls $ []\n</code></pre>\n\n<p>which still is a weird function.</p>\n"}], "owner": {"reputation": 83, "user_id": 7519086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d51672ccf81597ea02e16869fe1df1?s=128&d=identicon&r=PG&f=1", "display_name": "user1299292", "link": "https://stackoverflow.com/users/7519086/user1299292"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 42052908, "answer_count": 2, "score": 4, "last_activity_date": 1486338375, "creation_date": 1486300895, "last_edit_date": 1486338375, "question_id": 42052538, "link": "https://stackoverflow.com/questions/42052538/understanding-the-type-of-this-haskell-function", "title": "Understanding the type of this Haskell function", "body": "<p>I'm new to Haskell and I have a question about the following code:</p>\n\n<pre><code>a x (b:bs) = a (b x) bs\na x b = x []\n</code></pre>\n\n<p>What is the general type of these patterns?</p>\n\n<p>With <code>:info</code> a I get: <code>([t1] -&gt; t) -&gt; [([t1] -&gt; t) -&gt; [t1] -&gt; t] -&gt; t</code></p>\n\n<p>However, I cannot understand why. Does <code>a</code> have just two \"inputs\" or not? </p>\n"}, {"tags": ["haskell", "monads", "forall"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 6, "creation_date": 1486291640, "post_id": 42050202, "comment_id": 71274501, "body": "Not sure why all the answers are so wordy. In one sentence: you\u2019re right; it doesn\u2019t change anything and is just there to be explicit."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486295308, "post_id": 42050202, "comment_id": 71275514, "body": "The <code>forall a b. &lt;..&gt;</code> in the type of <code>&gt;&gt;=</code> <i>is</i> bound to a specific function - the function <code>m a -&gt; (a -&gt; m b) -&gt; m b</code>. You can also have a <code>forall</code> without a function, e.g. <code>[] :: forall a . [a]</code>, <code>empty :: forall f a . Alternative f =&gt; f a</code>."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1486303978, "post_id": 42050202, "comment_id": 71278153, "body": "@Ryan When I get the answer: &quot;Because everything is implicitly qualified.&quot; my follow-up question is often &quot;Why?&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1486299717, "post_id": 42050340, "comment_id": 71276838, "body": "Thanks Malcolm, this is a great answer."}], "tags": [], "owner": {"reputation": 38714, "user_id": 45668, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4288118e4836464de401d53b60466dd?s=128&d=identicon&r=PG", "display_name": "Malcolm", "link": "https://stackoverflow.com/users/45668/malcolm"}, "is_accepted": true, "score": 6, "last_activity_date": 1486290078, "last_edit_date": 1486290078, "creation_date": 1486286133, "answer_id": 42050340, "question_id": 42050202, "link": "https://stackoverflow.com/questions/42050202/understanding-forall-in-monad-function/42050340#42050340", "title": "Understanding forall in Monad &#39;&gt;&gt;=&#39; function?", "body": "<p>Basically, when you don't use <code>forall</code>, all the types are global in the function definition, which means they are all deduced when the function is called. With <code>forall</code> you can forego that for the function taking <code>x</code> until it is called itself.</p>\n\n<p>So in the first one you have a function which takes <code>x</code> and gives <code>c x</code>, then you have a tuple with <code>a</code> and <code>b</code> and you expect a tuple with <code>c a</code> and <code>c b</code>. Since you already said that the first function accepts <code>x</code>, you can make <code>x</code> become the same as <code>a</code>, but it won't be <code>b</code> then because <code>x</code> is defined once for the whole declaration. So you can't make the function accept both <code>a</code> and <code>b</code>.</p>\n\n<p>However, in the second case the <code>x</code> scope is limited to the function taking <code>x</code>. We're basically saying that there is a function which takes something and makes <code>c</code> with that something, and it can be any type. That enables us to first feed <code>a</code> to it and then <code>b</code>, and it will work. <code>x</code> doesn't have to be something singular now outside.</p>\n\n<p>What you are seeing in the <code>Monad</code> definition is the \"ExplicitForAll\" language extension. There is a description on <a href=\"https://prime.haskell.org/wiki/ExplicitForall\" rel=\"nofollow noreferrer\">Haskell Prime</a> for this extension</p>\n\n<blockquote>\n  <p>ExplicitForAll enables the use of the keyword 'forall' to explicitly state that a type is polymorphic in its free type variables. It does not allow any types to be written that cannot already be written; it just allows the programmer to explicitly state the (currently implicit) quantification.</p>\n</blockquote>\n\n<p>This language extension is purely visual, allows you to write out the variables explicitly which you previously couldn't. You can simply omit <code>forall a b.</code> from the <code>Monad</code> declaration, and the program will functionally stay exactly the same.</p>\n\n<p>Say, with this extension you could rewrite the <code>liftTupe</code> as <code>forall a b x. (x -&gt; c x) -&gt; (a, b) -&gt; (c a, c b)</code>. The definition is the same and it functions the same, but readers will now clearly see that the type variables are all defined on the topmost level.</p>\n"}, {"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": false, "score": 3, "last_activity_date": 1486287774, "last_edit_date": 1486287774, "creation_date": 1486286524, "answer_id": 42050388, "question_id": 42050202, "link": "https://stackoverflow.com/questions/42050202/understanding-forall-in-monad-function/42050388#42050388", "title": "Understanding forall in Monad &#39;&gt;&gt;=&#39; function?", "body": "<p>All type variables in Haskell's type system are quantified by a <code>forall</code>. However, GHC can infer the quantification in many cases so you don't need to write them in source code. </p>\n\n<p>For example the type of <code>liftTuple</code> with the <code>forall</code> explicit is</p>\n\n<pre><code>liftTuple :: forall c a b. (forall x. x -&gt; c x) -&gt; (a, b) -&gt; (c a, c b)\n</code></pre>\n\n<p>And for <code>&gt;&gt;=</code> the case is the same. </p>\n"}, {"tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": false, "score": 5, "last_activity_date": 1486289406, "last_edit_date": 1486289406, "creation_date": 1486286630, "answer_id": 42050404, "question_id": 42050202, "link": "https://stackoverflow.com/questions/42050202/understanding-forall-in-monad-function/42050404#42050404", "title": "Understanding forall in Monad &#39;&gt;&gt;=&#39; function?", "body": "<p>Every function you write is implicitly universally quantified over its type variables:</p>\n\n<pre><code>id :: a -&gt; a           -- this is actually universally quantified over a\nid :: forall a. a -&gt; a\nid x = x\n</code></pre>\n\n<p>You can actually turn this behaviour on with the <a href=\"https://prime.haskell.org/wiki/ExplicitForall\" rel=\"nofollow noreferrer\"><code>ExplicitForall</code></a> language pragma.</p>\n\n<p>This property is very useful, since it constrains you from writing code that only works with some types. Think about what the <code>id</code> function can do: it can either return its argument or loop forever. These are the only two things it can do and you can figure that out based on its type signature.</p>\n\n<p>Enforcing all instances of polymorphic function to behave the same way, irrespective of the type argument is called <em>parametricity</em> and is explained in <a href=\"https://bartoszmilewski.com/2014/09/22/parametricity-money-for-nothing-and-theorems-for-free/\" rel=\"nofollow noreferrer\">this</a> blog post by Bartosz Milewski. The TL;DR is: Using parametricity, we can guarantee that some reorderings in out program's structure do not affect it's behaviour. For a mathematically more rigorous treatment of this, see <a href=\"http://ttic.uchicago.edu/~dreyer/course/papers/wadler.pdf\" rel=\"nofollow noreferrer\">Theorems for free!</a> by Philip Wadler.</p>\n"}, {"comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1486310021, "post_id": 42053906, "comment_id": 71280293, "body": "Actually, you don&#39;t need <code>Monad</code>, <code>pure</code> from <code>Applicative</code> is good enough. And actually actually <code>Pointed</code> is even weaker."}, {"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1486332654, "post_id": 42053906, "comment_id": 71288465, "body": "Good point! Is applicative a superclass of monad in the language standard yet?"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1486333597, "post_id": 42053906, "comment_id": 71288699, "body": "Yes, I believe since GHC 7.8. If you want to look it up it&#39;s called the AMP or Applicative-Monad proposal."}], "tags": [], "owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "is_accepted": false, "score": 2, "last_activity_date": 1486309823, "last_edit_date": 1486309823, "creation_date": 1486309211, "answer_id": 42053906, "question_id": 42050202, "link": "https://stackoverflow.com/questions/42050202/understanding-forall-in-monad-function/42053906#42053906", "title": "Understanding forall in Monad &#39;&gt;&gt;=&#39; function?", "body": "<p>The forall in the monad definition is only to make the universal quantification more explicit. If you have a type variable without further restrictions it is universal by default, i.e. can be anything.</p>\n\n<p>So lets look at the difference between the two uses of forall and how haskell might see them:</p>\n\n<p>Implicit:</p>\n\n<pre><code>foo ::  (x -&gt; f x) -&gt; a -&gt; b -&gt; (f a, f b)\n-- same as\nfoo :: forall f x a b . (x -&gt; f x) -&gt; a -&gt; b -&gt; (f a, f b)\n-- our function is applied to a, so x is equal to a\nfoo :: forall f x a b . (x ~ a) =&gt; (x -&gt; f x) -&gt; a -&gt; b -&gt; (f a, f b)\n-- our function is also applied to b, so x is equal to b\nfoo :: forall f x a b . (x ~ a, x ~ b) =&gt; (x -&gt; f x) -&gt; a -&gt; b -&gt; (f a, f b)\n</code></pre>\n\n<p>Uh oh, (x ~ a, x~ b) would require (a ~ b). That would be inferred without annotation but since we explicitly used different type variables everything blows up. To solve this we need f to stay polymorphic within our function.</p>\n\n<p>Standard haskell can't express this so we are going to need rank2types or rankntypes. With that we can write:</p>\n\n<pre><code>foo ::  (forall x . x -&gt; f x) -&gt; a -&gt; b -&gt; (f a, f b)\n</code></pre>\n\n<p>Note that is the forall is part of the function type. This way it stays polymorphic in our function and we can apply it to different types without everything blowing up!</p>\n\n<p>Note that we also could just do:</p>\n\n<pre><code>foo :: Monad m =&gt; a -&gt; b -&gt; (m a, m b)\nfoo a b = (return a, return b)\n</code></pre>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 2, "accepted_answer_id": 42050340, "answer_count": 4, "score": 11, "last_activity_date": 1486309823, "creation_date": 1486285083, "last_edit_date": 1495541354, "question_id": 42050202, "link": "https://stackoverflow.com/questions/42050202/understanding-forall-in-monad-function", "title": "Understanding forall in Monad &#39;&gt;&gt;=&#39; function?", "body": "<p>Following <a href=\"https://stackoverflow.com/questions/3071136/what-does-the-forall-keyword-in-haskell-ghc-do\">this</a> answer, I've implemented a generic lift function in my program: </p>\n\n<pre><code>liftTupe :: (x -&gt; c x) -&gt; (a, b) -&gt; (c a, c b) --This will error\nliftTuple :: (forall x. x -&gt; c x) -&gt; (a, b) -&gt; (c a, c b)\n</code></pre>\n\n<p>I understand, that in this context, <code>forall</code> is enabling <code>x</code> to be of any type (<code>[]</code>, <code>Maybe</code> etc..).</p>\n\n<p>I'm now looking into the definition of <code>&gt;&gt;=</code> in Monads:</p>\n\n<pre><code>class Applicative m =&gt; Monad m where\n   (&gt;&gt;=) :: forall a b. m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>I'm can't understand the role of this <code>forall</code> in the function definition? As, unlike <code>liftTuple</code>, it's not bound to a specific function (<code>x -&gt; c x</code>)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486280379, "post_id": 42049629, "comment_id": 71271793, "body": "You might want to add a base case for the empty list: <code>qs [] = []</code>."}, {"owner": {"reputation": 45645, "user_id": 1056563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc888aa658ab0e0d2a4d305ad7f69123?s=128&d=identicon&r=PG", "display_name": "StephenBoesch", "link": "https://stackoverflow.com/users/1056563/stephenboesch"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486280541, "post_id": 42049629, "comment_id": 71271825, "body": "@Alec  that did it . please create an answer"}], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "edited": false, "score": 0, "creation_date": 1486312672, "post_id": 42049708, "comment_id": 71281215, "body": "Worth noting the -Wincomplete-patterns flag, automatically set with -Wall. With that you&#39;d get a warning with both ghc/ghci: <code>-warning: [-Wincomplete-patterns]     Pattern match(es) are non-exhaustive     In an equation for `qs&#39;: Patterns not matched: []</code>"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1486280986, "creation_date": 1486280986, "answer_id": 42049708, "question_id": 42049629, "link": "https://stackoverflow.com/questions/42049629/exception-for-non-exhaustive-pattern/42049708#42049708", "title": "Exception for non-exhaustive pattern", "body": "<p>The error message <code>Non-exhaustive patterns in function qs</code> means the pattern matches for <code>qs</code> don't cover the full range of inputs <code>qs</code> accepts. In this case, you are missing the case for the empty list.</p>\n\n<pre><code>:{\nqs [] = []\nqs (x:xs) = qs left ++ [x] ++ qs right\n  where left = [ y | y &lt;- xs, y &lt; x]\n        right = [ y | y &lt;- xs, y &gt;= x ]\n:}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45645, "user_id": 1056563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc888aa658ab0e0d2a4d305ad7f69123?s=128&d=identicon&r=PG", "display_name": "StephenBoesch", "link": "https://stackoverflow.com/users/1056563/stephenboesch"}, "edited": false, "score": 0, "creation_date": 1486307953, "post_id": 42050577, "comment_id": 71279489, "body": "Thx for the <code>:set -Wall</code> tip"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1486287824, "creation_date": 1486287824, "answer_id": 42050577, "question_id": 42049629, "link": "https://stackoverflow.com/questions/42049629/exception-for-non-exhaustive-pattern/42050577#42050577", "title": "Exception for non-exhaustive pattern", "body": "<p>As Alec said, you forgot to handle the empty list case.</p>\n\n<p>To avoid this kind of error in the future, I strongly recommend you turn on warnings using <code>-Wall</code>. Doing that makes GHC check that patterns are exhaustive at compile-time (definition-time).</p>\n\n<pre><code>Prelude&gt; :set -Wall\nPrelude&gt; :{\nPrelude| qs(x:xs) = qs left ++ [x] ++ qs right\nPrelude|   where left = [ y | y &lt;- xs, y &lt; x]\nPrelude|         right = [ y | y &lt;- xs, y &gt;= x ]\nPrelude| :}\n\n&lt;interactive&gt;:12:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018qs\u2019: Patterns not matched: []\n</code></pre>\n\n<p>As you can see, it points out that <code>[]</code> was not matched.</p>\n\n<p>Here's another example, where we handle the empty list and the lists starting by <code>x,y</code>, but we forget to handle lists containing one element (pattern of the form <code>[_]</code>).</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| f [] = 0\nPrelude| f (x:y:xs) = 0\nPrelude| :}\n\n&lt;interactive&gt;:18:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018f\u2019: Patterns not matched: [_]\n</code></pre>\n\n<p>Adding <code>f [x] = 0</code> would suffice. (Of course, we then get warnings for all the unused variables occurring in these patterns.. :) )</p>\n"}], "owner": {"reputation": 45645, "user_id": 1056563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc888aa658ab0e0d2a4d305ad7f69123?s=128&d=identicon&r=PG", "display_name": "StephenBoesch", "link": "https://stackoverflow.com/users/1056563/stephenboesch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 42049708, "answer_count": 2, "score": 1, "last_activity_date": 1486348531, "creation_date": 1486280222, "last_edit_date": 1486348531, "question_id": 42049629, "link": "https://stackoverflow.com/questions/42049629/exception-for-non-exhaustive-pattern", "title": "Exception for non-exhaustive pattern", "body": "<p>I tried running this kinda neat/concise <code>quicksort</code> implementation in GHCi:</p>\n\n<pre><code>:{\nqs(x:xs) = qs left ++ [x] ++ qs right\n  where left = [ y | y &lt;- xs, y &lt; x]\n        right = [ y | y &lt;- xs, y &gt;= x ]\n:}\nprint $ qs [1,123,42,90,24,12,3]\n</code></pre>\n\n<p>The result is :</p>\n\n<pre><code>*** Exception: &lt;interactive&gt;:(38,1)-(40,42): Non-exhaustive patterns in function qs\n</code></pre>\n\n<p>What is the relationship of the \"where\" statement to matcher completeness - and why is it missing cases?</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1486261181, "post_id": 42047882, "comment_id": 71268574, "body": "Thanks! Is there a specific field in the <code>.cabal</code> file that I can use for <code>PKGNAME</code>? I&#39;ve tried values in <code>Name:</code>, and <code>executable:</code>.  But GHC says it cannot load the interface."}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "reply_to_user": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1486261274, "post_id": 42047882, "comment_id": 71268588, "body": "Its the <code>name:</code> field in your .cabal, with <code>-</code> replaced by <code>_</code>."}, {"owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1486262013, "post_id": 42047882, "comment_id": 71268706, "body": "Very nice! One additional question: after adding <code>import Paths_PKGNAME</code>, <code>cabal build</code> can build successfully, but GHCi  would complain: <code>Failed to load interface for \u2018Paths_...</code>. Is there a way to fix this as well?"}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "reply_to_user": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "edited": false, "score": 0, "creation_date": 1486278996, "post_id": 42047882, "comment_id": 71271490, "body": "You will need to use GHCi through &#39;cabal repl&#39;."}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 5, "last_activity_date": 1486260827, "creation_date": 1486260827, "answer_id": 42047882, "question_id": 42047831, "link": "https://stackoverflow.com/questions/42047831/getting-the-cabal-version-of-a-ghc-compiled-program/42047882#42047882", "title": "Getting the cabal version of a GHC compiled program?", "body": "<p>Yes you can:</p>\n\n<pre><code>import Paths_PKGNAME\n\nmain = print version\n</code></pre>\n\n<p>Cabal will create a module <code>Paths_PKGNAME</code> (where <code>PKGNAME</code> is the name of your package) which contains among other things the version of the package. More info in the <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#accessing-data-files-from-package-code\">users guide</a>.</p>\n"}], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 42047882, "answer_count": 1, "score": 1, "last_activity_date": 1486260827, "creation_date": 1486260218, "question_id": 42047831, "link": "https://stackoverflow.com/questions/42047831/getting-the-cabal-version-of-a-ghc-compiled-program", "title": "Getting the cabal version of a GHC compiled program?", "body": "<p>If I compile an executable using GHC's <code>cabal build</code>, is there a way to get the version number as stated in the project <code>.cabal</code> file, from inside the <code>main</code> function?</p>\n\n<p>For example, we can get the main program name using:</p>\n\n<pre><code>import System.Environment\nmain = do\n    progName &lt;- getProgName\n    ...\n</code></pre>\n\n<p>Can we somehow write a similar function <code>getProgVer</code> to get the cabal-defined version number?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486248944, "post_id": 42046459, "comment_id": 71266149, "body": "How are you loading the file? The <code>&lt;interactive&gt;</code> parts of the error message makes me think that you are inputting the example in a GHCI session directly, are you sure the extensions are on? (The example works fine when loaded from a file on my end)"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486250049, "post_id": 42046459, "comment_id": 71266382, "body": "Loaded a file with the parts above the <code>data Example</code> definition.  Entered the second part in ghci."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486250752, "post_id": 42046459, "comment_id": 71266566, "body": "If it&#39;s all in a file, everything&#39;s fine.  But I can&#39;t test and define these datatypes in ghci?"}], "answers": [{"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1486251171, "post_id": 42046849, "comment_id": 71266649, "body": "Huh. So when have overloadedstrings, etc. and I&#39;m working on an interactive session, I have to always start by re-declaring those, even if I source a file where they&#39;re declared?"}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1486251764, "post_id": 42046849, "comment_id": 71266809, "body": "Seems to be that way currently, I must say I was surprised! See the linked ticket for how this could change in the future (note that the original proposal was written 8 years ago.)"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1486252065, "post_id": 42046849, "comment_id": 71266882, "body": "Fascinating.  (1) In the course of Haskell development, do you just have a workflow that doesn&#39;t use ghci at all, or do you find yourself always importing the same set of stuff at the start of interactive sessions?  (2) can this really be so?  I feel like I&#39;ve not redundantly declared OverloadedStrings in ghci, but have been able to test things using it, I think?"}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1486252639, "post_id": 42046849, "comment_id": 71267011, "body": "(1) I use GHCi constantly, with the help of the emacs mode <code>haskell-mode</code>, which essentially loads files like <code>:load file.hs</code> does. (2) I can&#39;t remember any troubles with OverloadedStrings either... Strange!"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1486265629, "post_id": 42046849, "comment_id": 71269275, "body": "I signed up for the GHC trac and added a comment linking to this question on that ticket.  Thank you for your help. <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11469#comment:4\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/11469#comment:4</a>"}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 3, "last_activity_date": 1486253135, "last_edit_date": 1486253135, "creation_date": 1486250847, "answer_id": 42046849, "question_id": 42046459, "link": "https://stackoverflow.com/questions/42046459/haskell-optarse-generic-example-failing-on-typeoperators-and-datakinds/42046849#42046849", "title": "Haskell Optarse Generic example failing on TypeOperators and DataKinds", "body": "<p>The problem is that GHCi does not inherit the extensions from the file you loaded.</p>\n\n<p>To see which extensions are loaded in GHCi use <code>:show language</code> and to enable an extension, for example <code>TypeOperators</code>, use <code>:set -XTypeOperators</code>.</p>\n\n<p>There is a feature request (GHC ticket <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11469\" rel=\"nofollow noreferrer\">#11469</a>) to make GHCi include language extensions from the loaded file, but it seems to have little recent activity.</p>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 42046849, "answer_count": 1, "score": 1, "last_activity_date": 1486253135, "creation_date": 1486248010, "question_id": 42046459, "link": "https://stackoverflow.com/questions/42046459/haskell-optarse-generic-example-failing-on-typeoperators-and-datakinds", "title": "Haskell Optarse Generic example failing on TypeOperators and DataKinds", "body": "<p>I'm looking at this page on <a href=\"https://hackage.haskell.org/package/optparse-generic-1.1.4/docs/Options-Generic.html\" rel=\"nofollow noreferrer\">optparse-generic</a>.</p>\n\n<p>with this version of optparse:</p>\n\n<pre><code>$ stack install optparse-generic-1.1.4\noptparse-generic-1.1.4: download\noptparse-generic-1.1.4: configure\noptparse-generic-1.1.4: build\noptparse-generic-1.1.4: copy/register\n</code></pre>\n\n<p>When I try to run this sample code exactly as given:</p>\n\n<pre><code>{-# LANGUAGE DataKinds         #-}\n{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TypeOperators     #-}\n\nimport Options.Generic\n\ndata Example = Example\n    { foo :: Int    &lt;?&gt; \"Documentation for the foo flag\"\n    , bar :: Double &lt;?&gt; \"Documentation for the bar flag\"\n    } deriving (Generic, Show)\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>&lt;interactive&gt;:10:14-56: error:\n    Illegal operator \u2018&lt;?&gt;\u2019 in type \u2018Int &lt;?&gt; \"Documentation for the foo flag\"\u2019\n      Use TypeOperators to allow operators in types\n\n&lt;interactive&gt;:10:25-56: error:\n    Illegal type: \u2018\"Documentation for the foo flag\"\u2019\n      Perhaps you intended to use DataKinds\n\n&lt;interactive&gt;:11:14-56: error:\n    Illegal operator \u2018&lt;?&gt;\u2019 in type \u2018Double &lt;?&gt; \"Documentation for the bar flag\"\u2019\n      Use TypeOperators to allow operators in types\n\n&lt;interactive&gt;:11:25-56: error:\n    Illegal type: \u2018\"Documentation for the bar flag\"\u2019\n      Perhaps you intended to use DataKinds\n\u03bb&gt; \n</code></pre>\n\n<p>As you can see, I have both DataKinds and TypeOperators enabled.  How can I debug what's happening here?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1486244473, "post_id": 42045914, "comment_id": 71264916, "body": "You have to enclose negative numbers in parenthesis: <code>mod (-9) 7</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486244478, "post_id": 42045914, "comment_id": 71264918, "body": "For your second question, try <code>mod (-9) 7</code>. <code>-</code> is a the only unary operator in Haskell, but to get it to parse as such, you often need extra parens."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1486244869, "post_id": 42045914, "comment_id": 71265027, "body": "This is not the only question in this post. Why close it?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1486245175, "post_id": 42045914, "comment_id": 71265113, "body": "Reopened, sorry @melpomene and everyone involved."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 7, "last_activity_date": 1486245829, "last_edit_date": 1592644375, "creation_date": 1486245829, "answer_id": 42046147, "question_id": 42045914, "link": "https://stackoverflow.com/questions/42045914/how-mod-calculate/42046147#42046147", "title": "How mod calculate", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:mod\" rel=\"noreferrer\"><code>mod</code> is specified</a> as</p>\n<blockquote>\n<p>integer modulus, satisfying</p>\n<pre><code>(x `div` y)*y + (x `mod` y) == x\n</code></pre>\n</blockquote>\n<p>and <code>div</code> as</p>\n<blockquote>\n<p>integer division truncated toward negative infinity</p>\n</blockquote>\n<p>In your case <code>x</code> is <code>-9</code> and <code>y</code> is <code>7</code>.</p>\n<p>-9 / 7 is -1.2857..., which (rounded down) is -2. Thus <code>(-9) `div` 7</code> is <code>-2</code>.</p>\n<p>Looking at the equation above, we have <code>((-9) `div` 7)*7 + ((-9) `mod` 7) == (-9)</code>, which becomes <code>(-2)*7 + ((-9) `mod` 7) == (-9)</code>, which in turn simplifies to <code>(-14) + ((-9) `mod` 7) == (-9)</code>, <code>(-9) `mod` 7 == (-9) - (-14)</code>, and finally <code>(-9) `mod` 7 == 5</code> (because -9 + 14 is 5).</p>\n<hr />\n<p>As for your second question: Haskell parses <code>mod -9 7</code> as <code>mod - (9 7)</code>, i.e. take the <code>mod</code> function and subtract from it the result of applying <code>9</code> to <code>7</code>. This makes no sense because <code>9</code> is not a function (so you can't apply it) and <code>mod</code> is not a number (so you can't subtract from it).<sup>1</sup></p>\n<p>The fix is to use <code>mod (-9) 7</code> to force <code>-</code> to be parsed as a unary operator (negating <code>9</code>) instead of a binary infix operator.</p>\n<p><sup>1</sup> As the error message hints, there actually is a way to make ghc swallow this code. It involves defining interesting instances of <code>Num</code>, but I won't go into that here.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1486246021, "creation_date": 1486246021, "answer_id": 42046178, "question_id": 42045914, "link": "https://stackoverflow.com/questions/42045914/how-mod-calculate/42046178#42046178", "title": "How mod calculate", "body": "<p>First of all, as is already specified in the comments, if you write <code>-9</code> without brackets, it is interpreted as a function, not as a negative number.</p>\n\n<p>Now for the <code>mod</code> part: there is a difference between <strong>modulo</strong> (<a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:mod\" rel=\"nofollow noreferrer\"><code>mod :: Integral i =&gt; i -&gt; i -&gt; i</code></a>) and <strong>remainder</strong> (<a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:rem\" rel=\"nofollow noreferrer\"><code>rem :: Integral i =&gt; i -&gt; i -&gt; i</code></a>):</p>\n\n<blockquote>\n<pre><code><b>mod :: Integral i => i -> i -> i</b></code></pre>\n  \n  <p>integer modulus, satisfying</p>\n\n<pre><code>(x `div` y)*y + (x `mod` y) == x\n</code></pre>\n  \n  <hr>\n\n<pre><code><b>rem :: Integral i => i -> i -> i</b></code></pre>\n  \n  <p>integer remainder, satisfying:</p>\n\n<pre><code>(x `quot` y)*y + (x `rem` y) == x\n</code></pre>\n</blockquote>\n\n<p>So if both the <em>numerator</em> and denominator are positive, there is no difference, because the <code>quot</code> (which is division truncated towards zero) and <code>div</code> (floored division) are equivalent.</p>\n\n<p>However when the <strong>numerator</strong> is negative, <code>mod</code> will still be positive, because the <code>div</code> is floored, and this (<code>(div x y)*y</code>) will be lower or equal to the actual result. Whereas the <code>rem</code> will be negative.</p>\n\n<p>If on the other hand the <strong>denominator</strong> is negative, the result <code>mod</code> will be negative, whereas for the <code>rem</code> it will again depend on the sign of the sign of the numerator.</p>\n\n<p>So <code>mod</code> always takes the sign of the denominator whereas for <code>rem</code> it depends on the sign of the numerator.</p>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1486246821, "creation_date": 1486246821, "answer_id": 42046290, "question_id": 42045914, "link": "https://stackoverflow.com/questions/42045914/how-mod-calculate/42046290#42046290", "title": "How mod calculate", "body": "<p>I guess you are expecting -2. The mathematical definition of modulo is a natural number ( >=0), so it has to return 5 (-2 +7) instead of -5.</p>\n\n<p>If you want a function which returns -2 instead (as most languages do) you can use the <code>rem</code> function (remainder)</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 42046147, "answer_count": 3, "score": 1, "last_activity_date": 1486246821, "creation_date": 1486244382, "question_id": 42045914, "link": "https://stackoverflow.com/questions/42045914/how-mod-calculate", "title": "How mod calculate", "body": "<p>I have following operation:</p>\n\n<pre><code>Prelude&gt; mod (3 - 12) 7\n</code></pre>\n\n<p>As result I've got 5.  </p>\n\n<p>Why is the result is 5?  </p>\n\n<p>And when I try something like this:</p>\n\n<pre><code>Prelude&gt; mod -9 7\n</code></pre>\n\n<p>Then I've got error:</p>\n\n<pre><code>&lt;interactive&gt;:6:1: error:\n    \u2022 Non type-variable argument\n        in the constraint: Num (t -&gt; a -&gt; a -&gt; a)\n      (Use FlexibleContexts to permit this)\n    \u2022 When checking the inferred type\n        it :: forall a t.\n              (Num (t -&gt; a -&gt; a -&gt; a), Num (a -&gt; a -&gt; a), Num t, Integral a) =&gt;\n              a -&gt; a -&gt; a\n</code></pre>\n\n<p>Why?</p>\n\n<p>I've forgot to mention, that I just start learning haskell.</p>\n"}, {"tags": ["haskell", "taylor-series"], "comments": [{"owner": {"reputation": 113, "user_id": 7200922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9yJO.jpg?s=128&g=1", "display_name": "Fireapprentice", "link": "https://stackoverflow.com/users/7200922/fireapprentice"}, "edited": false, "score": 0, "creation_date": 1486242345, "post_id": 42045590, "comment_id": 71264287, "body": "might just me being tired, I worked through 10h today, so it might just be something really dumb, if that is please do excuse me"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1486287269, "post_id": 42045590, "comment_id": 71273414, "body": "your question seem incomplete, how is it related to <code>Taylor series</code>? You might want to add more complete (<a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>) code."}, {"owner": {"reputation": 113, "user_id": 7200922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9yJO.jpg?s=128&g=1", "display_name": "Fireapprentice", "link": "https://stackoverflow.com/users/7200922/fireapprentice"}, "reply_to_user": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1486382069, "post_id": 42045590, "comment_id": 71305570, "body": "The Taylor sequence is a sequence for calculatign exponential function / sin / cos etc. as stated in the question my code was related to the taylor sequence for the exponential function e^x. I thought that this would be common knowledge, I am sorry if that was not the case. Thanks for your time though"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 7200922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9yJO.jpg?s=128&g=1", "display_name": "Fireapprentice", "link": "https://stackoverflow.com/users/7200922/fireapprentice"}, "is_accepted": true, "score": 6, "last_activity_date": 1486269537, "last_edit_date": 1486269537, "creation_date": 1486242917, "answer_id": 42045679, "question_id": 42045590, "link": "https://stackoverflow.com/questions/42045590/taylor-sequence-for-the-exponential-function-in-haskell/42045679#42045679", "title": "Taylor sequence for the exponential function in Haskell", "body": "<p>Okay, I figured it out. The problem was that <code>bottom</code> wasn't actually a list of all possible factorials.</p>\n\n<p>To solve the problem, I had to use <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\"><code>scanl</code></a> instead of <code>foldr</code>:</p>\n\n<pre><code>bottom = scanl (*) 1 [1..]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": false, "score": 1, "last_activity_date": 1486286838, "creation_date": 1486286838, "answer_id": 42050442, "question_id": 42045590, "link": "https://stackoverflow.com/questions/42045590/taylor-sequence-for-the-exponential-function-in-haskell/42050442#42050442", "title": "Taylor sequence for the exponential function in Haskell", "body": "<p>You could test each function separately in GHCi to see if it is the same thing you design to be.</p>\n\n<p>For example, your first definition of <code>bottom</code></p>\n\n<pre><code>Prelude&gt; bottom = foldr (*) 1 [1..]\nPrelude&gt; :t bottom\nbottom :: (Num b, Enum b) =&gt; b\n</code></pre>\n\n<p>doesn't give a list. This obviously not the right input for <code>zipWith</code></p>\n\n<pre><code>Prelude&gt; :t zipWith\nzipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\n</code></pre>\n\n<p>Compared with correct one</p>\n\n<pre><code>Prelude&gt; bottom = scanl (*) 1 [1..]\nPrelude&gt; :t bottom\nbottom :: (Num b, Enum b) =&gt; [b]\n</code></pre>\n\n<p>which give a list.</p>\n"}], "owner": {"reputation": 113, "user_id": 7200922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9yJO.jpg?s=128&g=1", "display_name": "Fireapprentice", "link": "https://stackoverflow.com/users/7200922/fireapprentice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 42045679, "answer_count": 2, "score": -3, "last_activity_date": 1486286838, "creation_date": 1486242275, "last_edit_date": 1486269663, "question_id": 42045590, "link": "https://stackoverflow.com/questions/42045590/taylor-sequence-for-the-exponential-function-in-haskell", "title": "Taylor sequence for the exponential function in Haskell", "body": "<p>I tried to implement the Taylor sequence for the exponential function and I get a huge load of errors, which I don't fully understand, as all the code segments in themselves work... Could someone explain the error and a workaround please: </p>\n\n<pre><code>top x = map (x^) [0..]\nbottom = foldr (*) 1 [1..]\nwhole x = zipWith (/) (top x) bottom\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "quickcheck", "state-monad"], "comments": [{"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486244753, "post_id": 42045100, "comment_id": 71264999, "body": "The properties you want to test are likely specific to your program. Perhaps you can extrapolate from your HUnit tests to find some more general properties that should hold."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1486530336, "post_id": 42045100, "comment_id": 71379686, "body": "Yeah, it&#39;d help to know more about your domain, and to have a running program, but some suggestions:  is there some sequence of events that must occur to reach some state? For example, on a web site, there might be a login and password before a  &quot;view the sensitive info&quot; page. Or, in a vending machine, all events must end in one of: returned change, or vended drink.  Or, if you&#39;re modelling an office process, the event &quot;cut a check&quot; must the proceeded by a &quot;issued purchase order&quot;, ..., &quot;received invoice&quot;, ....."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1486763208, "post_id": 42045100, "comment_id": 71503317, "body": "Also, since the number of states is finite, have a look at <a href=\"https://www.cs.york.ac.uk/fp/smallcheck/smallcheck.pdf\" rel=\"nofollow noreferrer\">Smallcheck</a>."}], "owner": {"reputation": 46, "user_id": 6086542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fcac7692b0228b86c261bfb93de4b7b?s=128&d=identicon&r=PG", "display_name": "Boulougou", "link": "https://stackoverflow.com/users/6086542/boulougou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486239231, "creation_date": 1486239231, "question_id": 42045100, "link": "https://stackoverflow.com/questions/42045100/quickcheck-and-state-monad", "title": "QuickCheck and State monad", "body": "<p>I have written a Haskell module that contains functions that operate on some state. Let's say that the code looks like this (the actual functions may return an actual result instead of <code>()</code>, but this is irrelevant to the question):</p>\n\n<pre><code>data StateContext = StateContext {\n  -- some records\n}\n\nhandleEventA :: EventA -&gt; State StateContext ()\nhandleEventB :: EventB -&gt; State StateContext ()\nhandleEventC :: EventC -&gt; State StateContext ()\n</code></pre>\n\n<p>As you can imagine the behavior of each function depends on the current state. For example <code>handleEventA &gt;&gt; handleEventB</code> will not produce the same result as <code>handleEventB &gt;&gt; handleEventA</code>. So I have several HUnit tests that verify the behavior of each function at several states.</p>\n\n<p>But now I would like to write more tests, that exercise all functions at all possible states (the number of states is finite). Writing them with HUnit would be quite labor-itensive, so I thought that using QuickCheck might be helpful in that case (I have only used it before for trivial functions). </p>\n\n<p>But I cannot see which properties should I test, or what kind of data should the test generate. I suspect that the test should generate random sequence of events (e.g. <code>handleEventB &gt;&gt; handleEventC &gt;&gt; handleEventA</code> etc), but I cannot see what properties should be satisfied.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1486238147, "post_id": 42044519, "comment_id": 71262965, "body": "You can find answer on question why not just <code>x</code> in this question: <a href=\"http://stackoverflow.com/questions/32058506/why-does-maybe-include-just\" title=\"why does maybe include just\">stackoverflow.com/questions/32058506/&hellip;</a>"}, {"owner": {"reputation": 1114, "user_id": 2615905, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OI2B4.jpg?s=128&g=1", "display_name": "T_01", "link": "https://stackoverflow.com/users/2615905/t-01"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1486238896, "post_id": 42044519, "comment_id": 71263157, "body": "oh, i wasnt able to find this question... thank you!"}], "owner": {"reputation": 1114, "user_id": 2615905, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OI2B4.jpg?s=128&g=1", "display_name": "T_01", "link": "https://stackoverflow.com/users/2615905/t-01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "closed_date": 1486239361, "answer_count": 0, "score": 0, "last_activity_date": 1486235724, "creation_date": 1486235724, "question_id": 42044519, "link": "https://stackoverflow.com/questions/42044519/haskell-not-a-data-constructor", "closed_reason": "Duplicate", "title": "Haskell &quot;Not a data constructor&quot;", "body": "<p>Im trying my first steps in Haskell, and wanted to define my own parameterized Data type.\nLets assume i have the following:</p>\n\n<pre><code>data Sth x = Foo x | Bar x\nt1 :: Sth Int\nt1 = Foo 5\nt2 :: Sth Int\nt2 = Bar 5\n</code></pre>\n\n<p>this is a correct definition, right? (At least i tried something like this).\nBut now, i wanted to give my 'Sth' the possibility to be only 'x', so I want to write something like this:</p>\n\n<pre><code>t3 :: Sth Int\nt3 = 5\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>data Sth x = Foo x | Bar x | x\n</code></pre>\n\n<p>but I get the error \"not a data constructor: x\" </p>\n\n<p>Why?</p>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486232514, "post_id": 42043765, "comment_id": 71260974, "body": "Fully replace the brackets, or is it allowed to introduce new ones?"}, {"owner": {"reputation": 87, "user_id": 2363023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e4f8e5d6e3c67271ebe202d08b3a1e6?s=128&d=identicon&r=PG", "display_name": "Ware", "link": "https://stackoverflow.com/users/2363023/ware"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486232676, "post_id": 42043765, "comment_id": 71261032, "body": "Fully replace, yes."}, {"owner": {"reputation": 87, "user_id": 2363023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e4f8e5d6e3c67271ebe202d08b3a1e6?s=128&d=identicon&r=PG", "display_name": "Ware", "link": "https://stackoverflow.com/users/2363023/ware"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1486233025, "post_id": 42043765, "comment_id": 71261145, "body": "Use of the where clause works and scales up well to more complex examples. <code>mul s 5 where s = add 2 3</code>"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1486235683, "post_id": 42044247, "comment_id": 71262097, "body": "If and only if the actual used function has that property, see &quot;the mul and add functions are filler&quot;."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1486241322, "post_id": 42044247, "comment_id": 71263960, "body": "Certainly, that line was intended to be interpreted as a precondition."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 0, "last_activity_date": 1486234414, "creation_date": 1486234414, "answer_id": 42044247, "question_id": 42043765, "link": "https://stackoverflow.com/questions/42043765/can-this-expression-be-written-without-brackets-or-back-ticks/42044247#42044247", "title": "Can this expression be written without brackets or back-ticks?", "body": "<p>You could use the algebraic properties of mul:</p>\n\n<pre><code>mul 5 $ add 2 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1486267521, "post_id": 42048196, "comment_id": 71269511, "body": "I think that is as close as we can get if the requirements of the OP are taken literally."}], "tags": [], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "is_accepted": false, "score": 1, "last_activity_date": 1486267488, "last_edit_date": 1486267488, "creation_date": 1486264760, "answer_id": 42048196, "question_id": 42043765, "link": "https://stackoverflow.com/questions/42043765/can-this-expression-be-written-without-brackets-or-back-ticks/42048196#42048196", "title": "Can this expression be written without brackets or back-ticks?", "body": "<p>You can use the combinator <code>flip</code> to allow you to reverse the order of the arguments. each following line is equivalent:</p>\n\n<pre><code>mul (add 2 3) 5\n(flip mul) 5 (add 2 3)\nflip mul 5 $ add 2 3\n</code></pre>\n\n<p><code>flip</code> is defined as simply:</p>\n\n<pre><code>flip :: (a -&gt; b -&gt; c) -&gt; (b -&gt; a -&gt; c)\nflip f b a = f a b\n</code></pre>\n\n<p>However, I don't believe the two operators <code>.</code> and <code>$</code> alone are sufficient</p>\n"}], "owner": {"reputation": 87, "user_id": 2363023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e4f8e5d6e3c67271ebe202d08b3a1e6?s=128&d=identicon&r=PG", "display_name": "Ware", "link": "https://stackoverflow.com/users/2363023/ware"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1486294418, "creation_date": 1486231725, "last_edit_date": 1486294418, "question_id": 42043765, "link": "https://stackoverflow.com/questions/42043765/can-this-expression-be-written-without-brackets-or-back-ticks", "title": "Can this expression be written without brackets or back-ticks?", "body": "<pre><code>mul (add 2 3) 5\n</code></pre>\n\n<p>Can the dot (<code>.</code>) and dollar (<code>$</code>) operators alone replace the brackets?\nThe <code>mul</code> and <code>add</code> functions are filler, i.e. the order of application must stay the same.\nThis is an exercise to better understand the aforementioned operators.</p>\n"}, {"tags": ["haskell", "monads", "functor", "applicative"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1486230358, "post_id": 42043385, "comment_id": 71260203, "body": "You are correct, as I agree that is a terrible definition for applicative functors. Without <code>&lt;*&gt;</code>, that definition seems incomplete. I am racking my brain to see if you could derive <code>&lt;*&gt;</code> just from return/fmap, and I don&#39;t think it&#39;s possible."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1486232872, "post_id": 42043385, "comment_id": 71261096, "body": "@haoformayor you cannot. Just <a href=\"http://stackoverflow.com/a/34933736/1139697\">count the <code>f</code>s</a>: both <code>fmap</code> and <code>return</code> increase the count of <code>f</code>s in the type, whereas <code>&lt;*&gt;</code> keeps it constant."}, {"owner": {"reputation": 378, "user_id": 6768080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/86823b9162e2d786d30dbecf7d95edad?s=128&d=identicon&r=PG&f=1", "display_name": "Periata Breatta", "link": "https://stackoverflow.com/users/6768080/periata-breatta"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1486254690, "post_id": 42043385, "comment_id": 71267410, "body": "I have to say, I&#39;ve <i>never</i> understood wikipedia&#39;s definition of <i>any</i> advanced mathematical concept without already having at least some degree of understanding of it to start with.  I simply would never go there for this kind of learning, as  I would just end up getting very confused... even after @Zeta&#39;s edits I find the article very confusing.  So, it&#39;s a strong lax monoidal functor... but what does that mean?  The monoidal functor article doesn&#39;t help, because it suggests that &quot;strong&quot; and &quot;lax&quot; are mutually exclusive..."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 378, "user_id": 6768080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/86823b9162e2d786d30dbecf7d95edad?s=128&d=identicon&r=PG&f=1", "display_name": "Periata Breatta", "link": "https://stackoverflow.com/users/6768080/periata-breatta"}, "edited": false, "score": 2, "creation_date": 1486289630, "post_id": 42043385, "comment_id": 71274062, "body": "@PeriataBreatta someone should rewrite that article. Without Haskell knowledge, it&#39;s useless. With Haskell knowledge, it&#39;s mostly useless :/."}, {"owner": {"reputation": 125, "user_id": 2640924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24a2f150fb988187c4950ad1315d79b?s=128&d=identicon&r=PG&f=1", "display_name": "mmlab", "link": "https://stackoverflow.com/users/2640924/mmlab"}, "edited": false, "score": 0, "creation_date": 1486309578, "post_id": 42043385, "comment_id": 71280126, "body": "That article was suggesting a nice (but unfortunately wrong) thing: that there was a simple progression from functor to applicative and finally to monad, just by progressively adding class methods. Start with a functor with an fmap, then add a return and you get an applicative, then again add a join and you&#39;ll have a monad. That seemed nice to me, given that functor is a superclass of applicative which is in turn a superclass of monad; but it doesn&#39;t work with fmap, return and join. Maybe that could work with some other typeclass methods?"}], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 7501619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfb3e55ff104cf8485859d00fc6ecbcb?s=128&d=identicon&r=PG&f=1", "display_name": "Taren", "link": "https://stackoverflow.com/users/7501619/taren"}, "is_accepted": false, "score": 7, "last_activity_date": 1486231976, "creation_date": 1486231976, "answer_id": 42043804, "question_id": 42043385, "link": "https://stackoverflow.com/questions/42043385/i-cant-understand-wikipedias-definition-of-applicative-functor/42043804#42043804", "title": "I can&#39;t understand Wikipedia&#39;s definition of &quot;applicative functor&quot;", "body": "<p>You are correct, applicative functors require <code>&lt;*&gt;</code> as well as <code>pure</code> for a minimal definition.  It's worth noting that we can get <code>fmap</code> from those, though:</p>\n\n<pre><code>fmap f a = pure f &lt;*&gt; a\n</code></pre>\n\n<p>Similarly we can get the applicative definition from monads:</p>\n\n<pre><code>pure = return\nf' &lt;*&gt; a' = do\n    f &lt;- f'\n    a &lt;- a'\n    return $ f a\n</code></pre>\n\n<p>You could look at applicatives functors a generalization of functors to multi argument functions or as combining values with context horizontally:</p>\n\n<pre><code>liftA2 f a b = f &lt;$&gt; a &lt;*&gt; b\nfmap :: (a -&gt; b) -&gt; (f a -&gt; f b)\nliftA2 :: (a -&gt; b -&gt; c) -&gt; (f a -&gt; f b -&gt; f c)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1486232494, "post_id": 42043846, "comment_id": 71260964, "body": "Note that I use &quot;was not correct&quot;. I&#39;ve took the courtesy to fix the article."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486234938, "post_id": 42043846, "comment_id": 71261807, "body": "@adamse Whoops, accidentally used posted <code>(&gt;&gt;=)</code> instead of <code>(&lt;*&gt;)</code>. Sorry for the inconvenience."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 9, "last_activity_date": 1486235643, "last_edit_date": 1486235643, "creation_date": 1486232199, "answer_id": 42043846, "question_id": 42043385, "link": "https://stackoverflow.com/questions/42043385/i-cant-understand-wikipedias-definition-of-applicative-functor/42043846#42043846", "title": "I can&#39;t understand Wikipedia&#39;s definition of &quot;applicative functor&quot;", "body": "<p>The article was not correct. Assume we have a monad <code>m</code> without <code>join</code>, or a functor with <code>return</code>. We can define <code>pure</code> immediately:</p>\n\n<pre><code>pure :: Monad m =&gt; a -&gt; m a\npure = return\n</code></pre>\n\n<p>We cannot, however, define <code>(&lt;*&gt;)</code> with <code>fmap</code> and <code>return</code> only. All we have is <code>fmap</code>, so we would end up with <code>m (m a)</code> if we try to use an <code>m (a -&gt; b)</code>. At that point we need <code>join</code> or its equivalent <code>(&gt;&gt;=)</code>:</p>\n\n<pre><code>(&lt;*&gt;) :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b\nf &lt;*&gt; x = join (fmap (flip fmap x) f)\n\n-- or, easier to read:\n-- f &lt;*&gt; x = do\n--   f' &lt;- f\n--   x' &lt;- x\n--   return f' x'\n</code></pre>\n\n<p>An applicative functor is like a functor with <code>return</code> and <code>ap</code>, but no <code>join</code>. So yes, you were completely right, Wikipedia missed the operation of applicative (see <a href=\"http://www.staff.city.ac.uk/~ross/papers/Applicative.pdf\">the original paper</a>).</p>\n\n<p>By the way, if you add only <code>pure</code>, you get a <a href=\"https://hackage.haskell.org/package/pointed\">pointed functor</a>. The <a href=\"https://wiki.haskell.org/Typeclassopedia#Applicative\">typeclassopedia</a> provides a better overview over <code>Applicative</code> than the Wikipedia article, though.</p>\n"}], "owner": {"reputation": 125, "user_id": 2640924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24a2f150fb988187c4950ad1315d79b?s=128&d=identicon&r=PG&f=1", "display_name": "mmlab", "link": "https://stackoverflow.com/users/2640924/mmlab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 1, "accepted_answer_id": 42043846, "answer_count": 2, "score": 12, "last_activity_date": 1486555961, "creation_date": 1486229671, "last_edit_date": 1495542299, "question_id": 42043385, "link": "https://stackoverflow.com/questions/42043385/i-cant-understand-wikipedias-definition-of-applicative-functor", "title": "I can&#39;t understand Wikipedia&#39;s definition of &quot;applicative functor&quot;", "body": "<p>Studying functors, applicative functors and monads in Haskell, I found this definition on <a href=\"https://en.wikipedia.org/wiki/Applicative_functor\" rel=\"nofollow noreferrer\">Wikipedia</a>:</p>\n\n<blockquote>\n  <p>In functional programming, specifically Haskell, an <strong>applicative\n  functor</strong> is a structure that is like a <strong>monad</strong> (<code>return</code>, <code>fmap</code>, <code>join</code>)\n  without <code>join</code>, or like a <strong>functor</strong> with <code>return</code>.</p>\n</blockquote>\n\n<p>I can't understand: it seems to me that providing <code>return</code> (i.e. <code>pure</code>) to a functor is not sufficient to obtain an applicative functor, because you need to provide <code>ap</code> (i.e. <code>&lt;*&gt;</code>) too, which cannot be defined in terms of <code>fmap</code> and <code>return</code> only. Did I miss something or Wikipedia's definition is not absolutely correct?</p>\n\n<p>EDIT 2017-02-08: I found other useful insights on this question in <a href=\"https://stackoverflow.com/questions/41400846/applicative-functors-as-monoidal-functors\">this</a> answer.</p>\n"}, {"tags": ["json", "haskell", "record", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "edited": false, "score": 0, "creation_date": 1486229909, "post_id": 42043000, "comment_id": 71260017, "body": "Works great. I wasn&#39;t sure if it would be possible. Thank you :)."}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 2, "last_activity_date": 1486228695, "last_edit_date": 1486228695, "creation_date": 1486227373, "answer_id": 42043000, "question_id": 42042761, "link": "https://stackoverflow.com/questions/42042761/how-to-automatically-convert-a-record-in-makefields-lens-format-to-json-with-f/42043000#42043000", "title": "How to automatically convert a record in &quot;makeFields&quot; lens format to JSON with fields matching lenses?", "body": "<p>You can derive <code>FromJSON</code>/<code>ToJSON</code> using template Haskell from <a href=\"https://www.stackage.org/haddock/lts-7.15/aeson-0.11.2.1/Data-Aeson-TH.html\" rel=\"nofollow noreferrer\"><code>Data.Aeson.TH</code></a> which allows for some modifications:</p>\n\n<pre><code>import Data.Aeson.TH\nimport Data.Char\n\nderiveJSON\n  defaultOptions {fieldLabelModifier = (_head %~ toLower) . drop 15}\n  ''ArticlePreview\n\nt :: ArticlePreview\nt = ArticlePreview \"\" \"\" \"\" \"\" \"\" \"\" \"\" (Just 12)\n</code></pre>\n\n<p>Then you get:</p>\n\n<pre><code>GHCI&gt; encode t\n\"{\\\"name\\\":\\\"\\\",\\\"perex\\\":\\\"\\\",\\\"authorName\\\":\\\"\\\",\\\"authorUrl\\\":\\\"\\\",\\\"date\\\":\\\"\\\",\\\"categoryName\\\":\\\"\\\",\\\"categoryUrl\\\":\\\"\\\",\\\"commentsCount\\\":12}\"\n</code></pre>\n"}], "owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 42043000, "answer_count": 1, "score": 0, "last_activity_date": 1486228695, "creation_date": 1486226114, "question_id": 42042761, "link": "https://stackoverflow.com/questions/42042761/how-to-automatically-convert-a-record-in-makefields-lens-format-to-json-with-f", "title": "How to automatically convert a record in &quot;makeFields&quot; lens format to JSON with fields matching lenses?", "body": "<pre><code>data ArticlePreview = ArticlePreview\n  { _articlePreviewName          :: T.Text\n  , _articlePreviewPerex         :: T.Text\n  , _articlePreviewAuthorName    :: T.Text\n  , _articlePreviewAuthorUrl     :: T.Text\n  , _articlePreviewDate          :: T.Text\n  , _articlePreviewCategoryName  :: T.Text\n  , _articlePreviewCategoryUrl   :: T.Text\n  , _articlePreviewCommentsCount :: Maybe Integer\n  } deriving (Show, Eq, Generic)\n\nmakeFields ''ArticlePreview\n</code></pre>\n\n<p>I tried Aeson:</p>\n\n<pre><code>instance ToJSON ArticlePreview\ninstance FromJSON ArticlePreview\n\nencodeToString :: ToJSON a =&gt; a -&gt; String\nencodeToString = CL.unpack . encode\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>{\"_articlePreviewCommentsCount\":17,\"_articlePreviewAuthorName\":\"x\",\"_articlePreviewName\":\"x\",\"_articlePreviewCategoryName\":\"x\",\"_articlePreviewAuthorUrl\":\"x\",\"_articlePreviewCategoryUrl\":\"x\",\"_articlePreviewDate\":\"x\",\"_articlePreviewPerex\":\"x\"}\n</code></pre>\n\n<p>Desired output:</p>\n\n<pre><code>{\"commentsCount\":17,\"authorName\":\"x\",\"name\":\"x\",\"categoryName\":\"x\",\"authorUrl\":\"x\",\"categoryUrl\":\"x\",\"date\":\"x\",\"perex\":\"x\"}\n</code></pre>\n\n<p>I don't insist on Aeson, but it must be automatic (without manual definition that e.g. <code>_articlePreviewCommentsCount</code> maps to <code>commentsCount</code>).</p>\n"}, {"tags": ["ubuntu", "haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1486226398, "post_id": 42042740, "comment_id": 71258792, "body": "You&#39;ll find a lot of info related to this <a href=\"https://www.google.de/search?q=site%3Agithub.com%2Fcommercialhaskell%2Fstack%2Fissues+fpic\" rel=\"nofollow noreferrer\">on stack/issues</a>. One thing that should work is using a nightly resolver / ghc-8.0.2."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486234215, "post_id": 42042740, "comment_id": 71261542, "body": "It seems that this is a strange bug caused by GHC/GCC/linking.. or so the <a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/faq.md\" rel=\"nofollow noreferrer\">stack faq</a> claims, pointing to <a href=\"https://ghc.haskell.org/trac/ghc/ticket/12759\" rel=\"nofollow noreferrer\">this</a> trac ticket, but that ticket claims it was fixed in 8.0! Either it was not fixed or it is only stack that still somehow has the bug - you&#39;ll need to find a version of GHC working on your machine and point stack to that."}, {"owner": {"reputation": 6400, "user_id": 1245418, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7005b0353700331ae983ee90c81b2e69?s=128&d=identicon&r=PG", "display_name": "Evan Zamir", "link": "https://stackoverflow.com/users/1245418/evan-zamir"}, "edited": false, "score": 0, "creation_date": 1541886562, "post_id": 42042740, "comment_id": 93372935, "body": "I&#39;m running into this problem and can&#39;t seem to find a fix. For me it&#39;s ghc-8.4.4."}], "owner": {"reputation": 61, "user_id": 7064147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5aa116e68037a80506d7beb589026f?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Pi\u0119kos", "link": "https://stackoverflow.com/users/7064147/piotr-pi%c4%99kos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 963, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1486225975, "creation_date": 1486225975, "question_id": 42042740, "link": "https://stackoverflow.com/questions/42042740/ghc-failed-to-compile-a-sanity-check", "title": "ghc failed to compile a sanity check", "body": "<p>I've recently been trying to use haskell-stack, but whenever i try to do stack setup i get </p>\n\n<blockquote>\n  <p>The GHC located at\n  /home/piotrek/.stack/programs/x86_64-linux/ghc-8.0.1/bin/ghc failed to\n  compile a sanity check. Please see:</p>\n\n<pre><code>http://docs.haskellstack.org/en/stable/install_and_upgrade/\n</code></pre>\n  \n  <p>for more information. Exception was: Running\n  /home/piotrek/.stack/programs/x86_64-linux/ghc-8.0.1/bin/ghc\n  /tmp/stack-sanity-check3118/Main.hs -no-user-package-db in directory\n  /tmp/stack-sanity-check3118/ exited with ExitFailure 1</p>\n  \n  <p>[1 of 1] Compiling Main             (\n  /tmp/stack-sanity-check3118/Main.hs,\n  /tmp/stack-sanity-check3118/Main.o ) Linking\n  /tmp/stack-sanity-check3118/Main ...</p>\n  \n  <p>/usr/bin/ld: /tmp/stack-sanity-check3118/Main.o: relocation\n  R_X86_64_32S against symbol `stg_bh_upd_frame_info' can not be used\n  when making a shared object; recompile with -fPIC</p>\n</blockquote>\n\n<p>and many other messages like the last one about relocation.\nI use ubuntu 16.10, installed stack by apt-get.</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486211975, "post_id": 42040169, "comment_id": 71254389, "body": "Your <code>dataIntervalsubtrees</code> <code>minValue</code> and <code>maxValue</code> are not defined, afaik?"}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486212307, "post_id": 42040169, "comment_id": 71254477, "body": "@WillemVanOnsem : sorry, I have updated my Question."}, {"owner": {"reputation": 533, "user_id": 919930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vmekk.jpg?s=128&g=1", "display_name": "Slaven Glumac", "link": "https://stackoverflow.com/users/919930/slaven-glumac"}, "edited": false, "score": 0, "creation_date": 1486213512, "post_id": 42040169, "comment_id": 71254819, "body": "If you say: &quot;Now I try to achieve that in IndexNode the smaller Int value is set to the smallest DataNode of the subtree and the bigger Int value is set to the biggest DataNode of the subtree.&quot; isn&#39;t it required that type b is Int due to IndexNode Int Int ...? Furthermore, just for clarification, are DataNodes are always leafs of the tree?"}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "reply_to_user": {"reputation": 533, "user_id": 919930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Vmekk.jpg?s=128&g=1", "display_name": "Slaven Glumac", "link": "https://stackoverflow.com/users/919930/slaven-glumac"}, "edited": false, "score": 0, "creation_date": 1486214558, "post_id": 42040169, "comment_id": 71255110, "body": "@SlavenGlumac: In my explanation was a &quot;value of&quot; missing. I have updated my post. So the smaller int of an IndexNode is set to the smallest value you can find in the leafs of the subtree. And the bigger Int of the IndexNode is set to the biggest value you can find in the leafs of the subtree.  Yes, DataNodes are always leafs."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486234623, "post_id": 42040169, "comment_id": 71261673, "body": "Instead of <code>map (dataInterval subtrees)</code> you want <code>map dataInterval subtrees</code> - this is actually just what the type error is telling you - besides that it seems like your code compiles just fine."}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1486234853, "post_id": 42040169, "comment_id": 71261765, "body": "I have removed the the curved bracket and get an error. I would really appreciate it if you post some code. My error message: Couldn&#39;t match expected type <code>MultTree Int&#39;                   with actual type </code>[MultTree a]&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1486302472, "post_id": 42045165, "comment_id": 71277702, "body": "<code>flattenSubtrees = concatMap dataList</code> why should&#39;t here be a parameter? like <code>flattenSubtrees = concatMap dataList subtrees</code> ?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1486321754, "post_id": 42045165, "comment_id": 71284499, "body": "@jublikon Because I used eta-reduction here. <code>flattenSubtrees = concatMap dataList subtrees</code> is not valid definition because compiler doesn&#39;t know what is <code>subtrees</code>. Other valid definition is <code>flattenSubtrees subtrees = concatMap dataList subtrees</code> but, as I said, this definition is eta-equivalent to <code>flattenSubtrees = concatMap dataList</code>. Or in human words, you can remove common suffix of parts to the left and to the right of <code>=</code> sign."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 2, "last_activity_date": 1486241523, "last_edit_date": 1486241523, "creation_date": 1486239642, "answer_id": 42045165, "question_id": 42040169, "link": "https://stackoverflow.com/questions/42040169/return-tree-for-function-with-non-binary-tree/42045165#42045165", "title": "Return tree for function with non-binary tree", "body": "<p>I will post answer on your question also answering your last comment:</p>\n\n<blockquote>\n  <p>I have removed the the curved bracket and get an error. I would really appreciate it if you post some code. My error message: Couldn't match expected type MultTree Int' with actual type [MultTree a]' </p>\n</blockquote>\n\n<p>The problem here is that you specify type of <code>minBound :: Int</code>. But in type of your function you said that you have tree of any type <code>a</code> which is <code>Ord</code>.</p>\n\n<pre><code>dataInterval:: (Ord a) =&gt; MultTree a -&gt; MultTree a\n</code></pre>\n\n<p>So, <code>Int</code> is not equals to <code>a</code>. If you don't want your tree be polymorphic, you can just have <code>dataInterval :: MultTree Int -&gt; MultTree Int</code> for example.\nBut this is not the best solution. You can use <code>minBound</code> and <code>maxBound</code> for polymorphic type but you need to add <code>Bounded</code> constraint to <code>a</code> in type signature. And you don't need to specify type of <code>minBound</code> in your function because <em>Haskell</em> has type inference. So here is complete working example (I also removed some <code>()</code> because <em>Haskell</em> is not <em>Lisp</em>):</p>\n\n<pre><code>data MultTree b = DataNode b | IndexNode b b [MultTree b] deriving (Show)\n\nt2 :: MultTree Int\nt2 = IndexNode 3 42 [ IndexNode 7 8 [ DataNode 3\n                                     , DataNode 5\n                                     , DataNode 7\n                                     , DataNode 9\n                                     ]\n                    , DataNode 6\n                    , IndexNode 10 23 [ DataNode 99\n                                      , DataNode 78\n                                      , DataNode 24\n                                      ]\n                    ]\n\ndataList :: MultTree a -&gt; [a]\ndataList (DataNode x)             = [x]\ndataList (IndexNode _ _ subtrees) = flattenSubtrees subtrees\n\nflattenSubtrees :: [MultTree a] -&gt; [a]\nflattenSubtrees = concatMap dataList\n\nmaxValue :: Ord a =&gt; [MultTree a] -&gt; a\nmaxValue trees = maximum (flattenSubtrees trees)\n\nminValue :: Ord a =&gt; [MultTree a] -&gt; a\nminValue trees = minimum (flattenSubtrees trees)\n\ndataInterval :: (Bounded a, Ord a) =&gt; MultTree a -&gt; MultTree a\ndataInterval (DataNode x) = DataNode x\ndataInterval node@(IndexNode x y [])\n      | x &gt; y  = IndexNode maxBound minBound []\n      | x &lt; y  = IndexNode minBound maxBound []\n      | x == y = node\ndataInterval (IndexNode x y subtrees)\n      | x &gt; y  = IndexNode (maxValue subtrees) (minValue subtrees) mappedSubtrees\n      | x &lt; y  = IndexNode (minValue subtrees) (maxValue subtrees) mappedSubtrees\n      | x == y = IndexNode x y mappedSubtrees\n  where\n    mappedSubtrees = map dataInterval subtrees\n</code></pre>\n\n<p>I want to notice that this function implementation is not efficient. Because you traverse full tree each time you need to evaluate min and max values whereas in reality it's enough to traverse only last level after you found result for <code>subtrees</code>. Result of function call on <code>t2</code> is:</p>\n\n<pre><code>ghci&gt; dataInterval t2 \nIndexNode 3 99 [IndexNode 3 9 [DataNode 3,DataNode 5,DataNode 7,\nDataNode 9],DataNode 6,IndexNode 24 99 [DataNode 99,DataNode 78,\nDataNode 24]]\n</code></pre>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 42045165, "answer_count": 1, "score": 1, "last_activity_date": 1486241523, "creation_date": 1486210091, "last_edit_date": 1486218682, "question_id": 42040169, "link": "https://stackoverflow.com/questions/42040169/return-tree-for-function-with-non-binary-tree", "title": "Return tree for function with non-binary tree", "body": "<p>I have a non-binary tree: </p>\n\n<pre><code>data MultTree b = DataNode b | IndexNode Int Int [MultTree b] deriving (Show)\n</code></pre>\n\n<p><strong>Note</strong>: <code>DataNode's</code> are treated like leafs and <code>IndexNode's</code> like branches. </p>\n\n<p>Now I try to achieve that in <code>IndexNode</code> the smaller <code>Int</code> value is set to the smallest value of <code>DataNode</code> of the subtree and the bigger <code>Int</code> value is set to the biggest value of <code>DataNode</code> of the subtree. </p>\n\n<p>For <code>IndexNode's</code> without a subtree the smaller <code>Int</code> value is set to <code>minBound::Int</code> and the bigger one to <code>maxBound::Int</code></p>\n\n<p>This is my function so far: </p>\n\n<pre><code>dataInterval:: (Ord a) =&gt; MultTree a -&gt; MultTree a\ndataInterval (DataNode x) = (DataNode x)\ndataInterval(IndexNode x y [])\n      | x &gt; y  = (IndexNode (maxBound :: Int) (minBound :: Int) [])\n      | x &lt; y  = (IndexNode (minBound :: Int) (maxBound :: Int) [])\n      | x == y = (IndexNode x y [])\ndatenInterval (IndexNode x y subtrees)\n      | x &gt; y  = (IndexNode (maxValue subtrees) (minValue subtrees) (map (dataInterval subtrees)))\n      | x &lt; y  = (IndexNode (minValue subtrees) (maxValue subtrees) (map (dataInterval subtrees)))\n      | x == y = (IndexNode x y (map (dataInterval subtrees)))\n</code></pre>\n\n<p>have to call the function <code>dataInterval</code> recursively. </p>\n\n<p>Now I do not know how to do that, because <code>dataInterval</code> expects a tree but somehow I have to call the complete list. <code>dataInterval</code> does not allow that.</p>\n\n<p><strong>Question</strong>: How can I achieve calling <code>dataInterval</code> recursively by using the subtrees in the list? So each tree of <code>subtrees</code> list will be called ?</p>\n\n<p>I think it might be some functionality like map, but returning subtrees instead of a list.</p>\n\n<p>At the moment the <strong>error message</strong> looks like that: </p>\n\n<blockquote>\n  <p>Couldn't match expected type MultTree a2\n                    with actual type [MultTree a]\n      * In the first argument of datenIntervalle, namely subtrees\n        In the first argument of map, namely (datenIntervalle subtrees)\n        In the third argument of  IndexNode, namely\n          (map (datenIntervalle subtrees))</p>\n</blockquote>\n\n<p><strong>sample tree &amp; complete code:</strong></p>\n\n<pre><code>t2 :: MultTree Int\nt2 = IndexNode 3 42 [IndexNode 7 8 [DataNode 3, DataNode 5, DataNode 7, DataNode 9], DataNode 6, IndexNode 10 23 [DataNode 99, DataNode 78, DataNode 24]]\n\ndataList:: MultTree a -&gt; [a]\ndataList(DataNode x) = [x]\ndataList(IndexNode _ _ subtress) = concat' (map dataList subtress)\n\nmaxValue :: (Ord a) =&gt; MultTree a -&gt; a\nmaxValue tree = maximum (dataList tree)\n\nminValue :: (Ord a) =&gt; MultTree a -&gt; a\nminValue tree = minimum (dataList tree)\n\ndataInterval:: (Ord a) =&gt; MultTree a -&gt; MultTree a\ndataInterval(DataNode x) = (DataNode x)\ndataInterval(IndexNode x y [])\n      | x &gt; y  = (IndexNode (maxBound :: Int) (minBound :: Int) [])\n      | x &lt; y  = (IndexNode (minBound :: Int) (maxBound :: Int) [])\n      | x == y = (IndexNode x y [])\ndataInterval(IndexNode x y subtrees)\n      | x &gt; y  = (IndexNode (maxValue subtrees) (minValue subtrees) (map (dataInterval subtrees)))\n      | x &lt; y  = (IndexNode (minValue subtrees) (maxValue subtrees) (map (dataInterval subtrees)))\n      | x == y = (IndexNode x y (map (dataInterval subtrees)))\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486209760, "post_id": 42039850, "comment_id": 71253697, "body": "Could you share your <code>stack.yaml</code> and any error messages you get?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486213500, "post_id": 42039850, "comment_id": 71254812, "body": "Done. Although I got the impression that you simply <i>cannot</i> use relative paths right now, hence the title."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486213776, "post_id": 42039850, "comment_id": 71254876, "body": "FYI, <a href=\"https://docs.haskellstack.org/en/latest/yaml_configuration/\" rel=\"nofollow noreferrer\">the docs</a> mention that the path <i>should</i> be absolute."}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486214437, "post_id": 42039850, "comment_id": 71255076, "body": "Isn&#39;t it possible to use the <code>extra-lib-dirs</code> in a .cabal file instead?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1486217643, "post_id": 42039850, "comment_id": 71255994, "body": "Doesn&#39;t work. It complains about a missing library (OpenAL32). I&#39;ve added the relevant portion from my .cabal file"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1487145511, "post_id": 42039850, "comment_id": 71645598, "body": "@adamse Seems like both <code>Cabal</code> and <code>Stack</code> restrict you to using absolute paths, which leads to my original question..."}], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486860652, "creation_date": 1486207884, "last_edit_date": 1486860652, "question_id": 42039850, "link": "https://stackoverflow.com/questions/42039850/why-doesnt-stack-allow-relative-paths", "title": "Why doesn&#39;t Stack allow relative paths?", "body": "<p>I'm working on a library which depends on an external C library, and would like to bundle the headers and lib files with my project. The <code>stack.yaml</code> file requires all paths to be absolute, which is clearly not ideal for this purpose.</p>\n\n<p>As per @adamse's request, here is my <code>stack.yaml</code>:</p>\n\n<pre><code>flags: {}\n\nextra-package-dbs: []\npackages:\n- '.'\nextra-deps:\n- ALUT-2.4.0.2\n- OpenAL-1.7.0.4\nresolver: lts-7.2\nextra-lib-dirs:\n- './dependencies/freealut/admin/VisualStudio6/alut/x64/Release'\n- './dependencies/openal-soft-1.16.0-bin/openal-soft-1.16.0-bin/libs/Win64'\n</code></pre>\n\n<p>and the error message:</p>\n\n<pre><code>Could not parse 'C:\\Users\\Jonatan\\Desktop\\Haskell\\modules\\AbbeyRoad\\stack.yaml':\nAeson exception:\nError in $['extra-lib-dirs'][0]: failed to parse field 'extra-lib-dirs': InvalidAbsDir \"./dependencies/freealut/admin/VisualStudio6/alut/x64/Release\"\nSee http://docs.haskellstack.org/en/stable/yaml_configuration/\n</code></pre>\n\n<p><code>.cabal</code>:</p>\n\n<pre><code>  extra-libraries:     OpenAL32, alut\n  extra-lib-dirs:      ./dependencies/freealut/admin/VisualStudio6/alut/x64/Release, ./dependencies/openal-soft-1.16.0-bin/openal-soft-1.16.0-bin/libs/Win64\n</code></pre>\n"}, {"tags": ["haskell", "types", "tree", "functional-programming", "variadic-functions"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 2, "creation_date": 1486207268, "post_id": 42039618, "comment_id": 71252971, "body": "Why not use a list? <code>data MultTree a = Index a a [MultTree a] | Data a</code>?"}, {"owner": {"reputation": 11, "user_id": 7515273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4960e54e38fded48c568df6746715c58?s=128&d=identicon&r=PG&f=1", "display_name": "knockz", "link": "https://stackoverflow.com/users/7515273/knockz"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1486207443, "post_id": 42039618, "comment_id": 71253014, "body": "I tried it, but the types of the elements may vary, since there could be [Index 1 2 [Index 3 4 [Data 5]]] or [Index 1 2 [Data 3]] in the list at the same time and as far as i can tell those types don&#39;t match."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 3, "creation_date": 1486207747, "post_id": 42039618, "comment_id": 71253103, "body": "Do you get an error in GHC? The types shoud match just fine, since all items of the list are of type <code>MultTree a</code>, and the trees themselves are well-defined."}, {"owner": {"reputation": 11, "user_id": 7515273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4960e54e38fded48c568df6746715c58?s=128&d=identicon&r=PG&f=1", "display_name": "knockz", "link": "https://stackoverflow.com/users/7515273/knockz"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1486208196, "post_id": 42039618, "comment_id": 71253254, "body": "Thank! You are right, seems like i made a mistake before. And there is no other way you know to solve the Problem? I&#39;m pretty new to Haskell :)"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1486208501, "post_id": 42039618, "comment_id": 71253340, "body": "This looks fine to me, so have a go at it!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486210314, "post_id": 42039618, "comment_id": 71253884, "body": "<code>Index</code> and <code>Data</code> are both constructors for the same type <code>MultTree a</code> so everything matches. Every constructor does not define its own type, there only <code>MultTree a</code> here."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486215367, "post_id": 42039618, "comment_id": 71255352, "body": "You and <a href=\"http://stackoverflow.com/users/4125633/jublikon\">jublikon</a> appear to have the same homework problem."}], "owner": {"reputation": 11, "user_id": 7515273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4960e54e38fded48c568df6746715c58?s=128&d=identicon&r=PG&f=1", "display_name": "knockz", "link": "https://stackoverflow.com/users/7515273/knockz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486208558, "creation_date": 1486206462, "last_edit_date": 1486208558, "question_id": 42039618, "link": "https://stackoverflow.com/questions/42039618/haskell-something-similar-to-varargs-for-own-datatypes", "title": "Haskell, something similar to varargs for own datatypes?", "body": "<p>I'm looking for something similar in Haskell as varargs are in Java.</p>\n\n<p>For University I have to create a treelike data structure that consists of two types of knots:</p>\n\n<p>1) Index-knots: consisting of 2 (here) Ints, followed by any amount of other knots</p>\n\n<p>2) Data-knots: consisting of 1 (here) Int</p>\n\n<p>My approach looks like this:</p>\n\n<pre><code>data MultTree a = Index a a <b>(MultTree a)</b> | Data a deriving Show</code></pre>\n\n<p>The bold Text is what has to be any amount of MultTrees.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1486200901, "post_id": 42038055, "comment_id": 71251099, "body": "Is your intent to have it work like <code>place (One x) = x; place (Two x) = x</code> ?"}, {"owner": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1486201640, "post_id": 42038055, "comment_id": 71251297, "body": "Yes, instead of having one function for every constructor I want to have just one function for all of them."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1486202419, "post_id": 42038055, "comment_id": 71251527, "body": "Make your question self-contained by defining <code>Point</code>."}, {"owner": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1486203373, "post_id": 42038055, "comment_id": 71251857, "body": "@Jubobs updated my question"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "edited": false, "score": 0, "creation_date": 1486203537, "post_id": 42039044, "comment_id": 71251914, "body": "Still not entirely what I was expecting, your suggestion is ok if you have a few constructors but what if you have 10 and they all have a shared function, then with your solution I would have to repeat <code>{ place :: a }</code> 10 times. There must be a better way."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "edited": false, "score": 0, "creation_date": 1486203666, "post_id": 42039044, "comment_id": 71251960, "body": "@DovydasRup\u0161ys Not if you factor your data correctly, as suggested below."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "edited": false, "score": 0, "creation_date": 1486203865, "post_id": 42039044, "comment_id": 71252027, "body": "@DovydasRup\u0161ys I don&#39;t think there&#39;s a much easier way. You could autogenerate the function you want with Template Haskell, which can generate code for you as in a macro system, but setting it up for this would require some care. If you have a very large amount of types/constructors, it could be worth it, but otherwise it requires too much effort."}, {"owner": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "edited": false, "score": 0, "creation_date": 1486204361, "post_id": 42039044, "comment_id": 71252173, "body": "I&#39;m failing to see how the above factorization applies, I don&#39;t even see where the factorization is happening. Is the meaning of factorization the same in functional languages as it is in empirical?"}, {"owner": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "edited": false, "score": 0, "creation_date": 1486204621, "post_id": 42039044, "comment_id": 71252225, "body": "Wait, nvm I think I get it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "edited": false, "score": 0, "creation_date": 1486210153, "post_id": 42039044, "comment_id": 71253829, "body": "@DovydasRup\u0161ys In FP factorization is also used for code rearrangement, but on types it usually means to convert a sum-of-products type like <code>Either (a,b) (a,c)</code> isolating the common factor as in the product-of-sum <code>(a, Either b c)</code> -- this follows roughly the same rules as arithmetics."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1486242083, "post_id": 42039044, "comment_id": 71264212, "body": "@chi isn&#39;t it <i>exactly</i> the same rules as arithmetic, when you consider the types algebraically? a * b + a * c = a * (b + c)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1486242573, "post_id": 42039044, "comment_id": 71264362, "body": "@Carl Yes, sure. Types satisfy all the ring laws except for additive inverses which do not exist. (i.e. all the semiring laws)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1486203655, "last_edit_date": 1486203655, "creation_date": 1486202739, "answer_id": 42039044, "question_id": 42038055, "link": "https://stackoverflow.com/questions/42038055/how-to-write-a-generic-function-for-any-data-constructor/42039044#42039044", "title": "How to write a generic function for any data constructor?", "body": "<p>Use a record for the common fields</p>\n\n<pre><code>data Piece a = One { place :: a } | Two { place :: a }\n-- place automatically defined\n</code></pre>\n\n<p>Or factorize the common data</p>\n\n<pre><code>data Piece a = Piece Bool a\n\nplace :: Piece a -&gt; a\nplace (Piece _ x) = x\n\n-- optionally:\npattern One x = Piece False x\npattern Two x = Piece True  x\n</code></pre>\n\n<p>In the general case, instead of <code>Bool</code> you have to use a custom sum type to express the rest of the factorization. E.g.</p>\n\n<pre><code>data T a = A Int a | B Bool a\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>data T a = T (Either Int Bool) a\n-- optionally:\npattern A n x = T (Left n)  x\npattern B b x = T (Right b) x\n</code></pre>\n\n<p>Template Haskell could also solve this, but it is overkill, IMO.</p>\n"}], "owner": {"reputation": 75, "user_id": 5704883, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/933534606729879/picture?type=large", "display_name": "Dovydas Rup\u0161ys", "link": "https://stackoverflow.com/users/5704883/dovydas-rup%c5%a1ys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 42039044, "answer_count": 1, "score": 1, "last_activity_date": 1486237794, "creation_date": 1486195648, "last_edit_date": 1486237794, "question_id": 42038055, "link": "https://stackoverflow.com/questions/42038055/how-to-write-a-generic-function-for-any-data-constructor", "title": "How to write a generic function for any data constructor?", "body": "<p>Suppose I have these definitions of a data in Haskell.</p>\n\n<pre><code>data Point a = Point a a\ndata Piece a = One a | Two a\n</code></pre>\n\n<p>and I want to have one function like</p>\n\n<pre><code>place :: Num a =&gt; Piece (Point a) -&gt; Point a\nplace (Piece x) = x\n</code></pre>\n\n<p>how do I do this since haskell doesn't allow functions of that particular form.</p>\n\n<p><strong>Solution</strong></p>\n\n<p>The problem was my data definition (many years of empirical programming is interfering here...). I wanted my Piece data to effectively be 2 different things, a Piece and also a kind of piece, I tried to achieve this with inheritance which was just a bad approach. Separating data in the following way solved the problem.</p>\n\n<pre><code>data PieceKind = One | Two | ... | n\ndata Piece a b = Piece a PieceKind\n</code></pre>\n\n<p>This way my Piece effectively has two attributes \"a\" (in my case this is a position of a piece) and also PieceKind, this way I was able to write the place function without having to repeat it for every kind of piece in the following way:</p>\n\n<pre><code>place :: Num a =&gt; Piece (Point a) PieceKind -&gt; Point a\nplace (Piece x _) = x\n</code></pre>\n\n<p>In addition I was also able to write functions for a particular kind of a Piece:</p>\n\n<pre><code>place :: Num a =&gt; Piece (Point a) PieceKind -&gt; Point a\nplace (Piece _ One) = ...\n</code></pre>\n\n<p>and this is what I really wanted.</p>\n"}, {"tags": ["haskell", "monads", "alternative-functor", "monadplus"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1486190073, "post_id": 42037064, "comment_id": 71248509, "body": "<code>MonadPlus</code> is stronger than <code>Alternative</code> and you don&#39;t need <code>MonadPlus</code> to write <code>guard</code> - the type with <code>Alternative</code> is the most general type, i.e. the inferred one. Why would one give it a stronger type? (Note the wikibooks page is outdated post-AMP, so ghc 8 and up? I don&#39;t actually remember..)"}, {"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1486190267, "post_id": 42037064, "comment_id": 71248552, "body": "@user2407038 Don&#39;t we need the stronger laws (left zero, right zero) if guard is supposed to do &quot;short-circuiting&quot;?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486192204, "post_id": 42037064, "comment_id": 71248956, "body": "You get &#39;short circuiting&#39; in the <code>Applicative</code> context: <code>guard False *&gt; x = empty</code> and <code>guard True *&gt; x = x</code>; it simply also works for <code>Monad</code> in the same natural way as all things which work for <code>Applicative</code> will work for <code>Monad</code>."}, {"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486192804, "post_id": 42037064, "comment_id": 71249094, "body": "@user2407038 But AFAIK <code>Alternative</code> doesn&#39;t mandate the <code>empty *&gt; x == empty</code> law. So it might not be true for all instances. Am I right?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1486222418, "post_id": 42037064, "comment_id": 71257547, "body": "It&#39;s a documentation issue. <code>guard</code> was <code>MonadPlus m =&gt; ...</code>, but every <code>MonadPlus</code> is now  an <code>Alternative</code>, and by default <code>mzero = empty</code> and <code>mplus = (&lt;|&gt;)</code>. Therefore, if you have a type that&#39;s both a <code>Monad</code> and an <code>Alternative</code>, it should hold those laws. However, that should be stated in either the <code>class Alternative</code> or the <code>class Monad</code> documentation. That being said, the functionality of <code>guard</code> wasn&#39;t reduced. <code>mzero</code> is <code>empty</code> on all common <code>MonadPlus</code> instances."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486243841, "post_id": 42037064, "comment_id": 71264720, "body": "@user2407038 That Wikibooks page was updated recently (~2 months ago) to account for the AMP. (Older versions of it didn&#39;t cover <code>Alternative</code>, only <code>MonadPlus</code>.)"}], "answers": [{"comments": [{"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 0, "creation_date": 1492475117, "post_id": 43461438, "comment_id": 73979208, "body": "AFAIK the function was defined with a MonadPlus constraint and latter changed to Applicative."}], "tags": [], "owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "is_accepted": false, "score": 0, "last_activity_date": 1492473435, "last_edit_date": 1495542345, "creation_date": 1492473435, "answer_id": 43461438, "question_id": 42037064, "link": "https://stackoverflow.com/questions/42037064/why-guard-is-not-defined-with-a-monadplus-constraint/43461438#43461438", "title": "Why `guard` is not defined with a MonadPlus constraint?", "body": "<p><code>guard</code> has an <code>Applicative</code> constraint because you don't need to perform monadic operations on it to define the function.</p>\n\n<p>It's definition is (copied from the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/Control.Monad.html#guard\" rel=\"nofollow noreferrer\">Hackage source</a>):</p>\n\n<pre><code>guard           :: (Alternative f) =&gt; Bool -&gt; f ()\nguard True      =  pure ()\nguard False     =  empty\n</code></pre>\n\n<p>If it had specified <code>MonadPlus</code> instead of <code>Alternative</code>, it wouldn't have gained anything.  <code>MonadPlus</code> is a subclass of <code>Alternative</code>, so all <code>MonadPlus</code> instances can use <code>guard</code>, but not all <code>Alternatives</code> could use it.</p>\n\n<p>(Although there would be <em>very</em> few cases of excluded <code>Alternatives</code> -- both cases mentioned <a href=\"https://stackoverflow.com/questions/13122489/what-s-an-example-of-a-monad-which-is-an-alternative-but-not-a-monadplus\">here</a> have an instance of <code>MonadPlus</code> even though they don't satisfy the left-distributive rule.)</p>\n\n<p>In general, it's better to stick to the bare minimum restrictions needed to write a function, even if the intended use is more specific.  This way, there is nothing excluded that shouldn't be, and no complaints from people whose types could work for it, but aren't monads.</p>\n\n<p>Coincidentally, the <a href=\"https://www.haskell.org/hoogle/?hoogle=guard\" rel=\"nofollow noreferrer\">Hoogle search results</a> incorrectly show a <code>MonadPlus</code> restriction instead, though if you click the link it is correct.</p>\n"}], "owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1613795941, "creation_date": 1486187967, "last_edit_date": 1613795941, "question_id": 42037064, "link": "https://stackoverflow.com/questions/42037064/why-guard-is-not-defined-with-a-monadplus-constraint", "title": "Why `guard` is not defined with a MonadPlus constraint?", "body": "<p>I am currently reading about the Alternative/MonadPlus typeclasses in <a href=\"https://en.wikibooks.org/wiki/Haskell/Alternative_and_MonadPlus\" rel=\"nofollow noreferrer\">wikibooks</a>. It describes the difference very well. However, one puzzling part is the <code>guard</code> function, which I am assuming, is used for \"short-circuiting\" a computation. (Am I right?)</p>\n\n<p>The function <code>guard</code> although defined in <code>Control.Monad</code> has an <code>Alternative</code> constraint, as following (<a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/Control.Monad.html#guard\" rel=\"nofollow noreferrer\">link</a>).</p>\n\n<pre><code>guard           :: (Alternative f) =&gt; Bool -&gt; f ()\nguard True      =  pure ()\nguard False     =  empty\n</code></pre>\n\n<p>But the above article, mentions that only the <code>MonadPlus</code> is required to enforce the left zero and right zero laws (Hence the stronger claim).</p>\n\n<pre><code>mzero &gt;&gt;= f  =  mzero -- left zero\nm &gt;&gt; mzero   =  mzero -- right zero\n</code></pre>\n\n<p>Given the purpose of the <code>guard</code> function, shouldn't it be defined with a <code>MonadPlus</code> constraint? Don't we need the stronger laws if <code>guard</code> is supposed to \"short-circuit\" the computation? I am curious about the reason behind the specific design choice.</p>\n\n<p>p.s.: I don't know what is a better way to describe the \"cancelling the upfront computation\" behavior other than the word \"short-circuiting\"?</p>\n"}, {"tags": ["haskell", "recursion", "tree"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1486157471, "post_id": 42033246, "comment_id": 71241171, "body": "Read about DFS and BFS."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1486157891, "post_id": 42033246, "comment_id": 71241358, "body": "How is that helpful advice? We&#39;re not searching anything, but rather traversing, and whether we do it breadth-first or depth-first doesn&#39;t make a correctness difference."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1486157990, "post_id": 42033246, "comment_id": 71241408, "body": "@amalloy DFS = &quot;vertical recursion&quot;. BFS=&quot;horizontal&quot;. So it is helpful at least to have the correct terminology. And BFS is what I believe the OP is actually looking for."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1486158396, "post_id": 42033246, "comment_id": 71241575, "body": "@amalloy  Perhaps, if you find the &quot;search&quot; misleading here, the formally correct names would be &quot;level-order traversal&quot; for BFS, and &quot;post/pre/in-order&quot; traversal for DFS. But I think these terms even being more correct are much less commonly used and more confusing."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1486158683, "post_id": 42033246, "comment_id": 71241681, "body": "If you read the code OP has written for what he thinks &quot;vertical recursion&quot; is, it&#39;s clear that it does not mean DFS, because currently the implementation might better be called a &quot;depth-only&quot; search, where the code only explores the leftmost branch. The OP is asking how to search all the branches of a tree <i>at all</i>, not what order is best to explore them in."}], "answers": [{"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 4, "last_activity_date": 1486160687, "creation_date": 1486160687, "answer_id": 42033965, "question_id": 42033246, "link": "https://stackoverflow.com/questions/42033246/vertical-and-horizontal-recursion-in-a-tree/42033965#42033965", "title": "vertical and horizontal recursion in a tree", "body": "<p>Here is a solution for getting the maximum branching factor:</p>\n\n<pre><code>grad :: MultTree a -&gt; Int\ngrad (DataNode _) = 0\ngrad (IndexNode _ _ subtrees) =\n  -- take the maximum of this tree and of the \n  -- maximum branching factor of all subtrees\n  maximum (length subtrees : map grad subtrees)\n</code></pre>\n\n<p>The key is that I get the <code>grad</code> of each subtree using <code>map</code>.</p>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "accepted_answer_id": 42033965, "answer_count": 1, "score": 1, "last_activity_date": 1486217561, "creation_date": 1486157158, "last_edit_date": 1486217561, "question_id": 42033246, "link": "https://stackoverflow.com/questions/42033246/vertical-and-horizontal-recursion-in-a-tree", "title": "vertical and horizontal recursion in a tree", "body": "<p>I have a tree data structure in Haskell: </p>\n\n<pre><code>data MultTree b = DataNode b | IndexNode Int Int [MultTree b] deriving (Show)\n</code></pre>\n\n<p>The task is, to return the hightest number of branches that exists in a tree (so the cardinality of the longest list of an <code>IndexNode</code>). </p>\n\n<p>To achieve that I have written a function: </p>\n\n<pre><code>grad :: MultTree t -&gt; Int\ngrad DataNode _       = 0\ngrad IndexNode _ _ [] = 0\ngrad IndexNode _ _ (x:xs)\n              | isIndexNodeCheck x = max ((countList (x:xs)) (grad x))\n</code></pre>\n\n<p><strong>Question:</strong> How can I achieve that the function does not only dive deeper in the tree levels but also checks the next element of <code>xs</code> ? \nIf a write another guard the code will be not run because Haskell always takes the first pattern that matches. </p>\n\n<p>So currently the function should work for vertical recursion but I would like to need to know how to do it also horizontally. </p>\n\n<p>Here is my complete code: </p>\n\n<pre><code>data MultTree b = DataNode b | IndexNode Int Int [MultTree b] deriving (Show)\n\nt2 :: MultTree Int\nt2 = IndexNode 3 42 [IndexNode 7 8 [DataNode 3, DataNode 5, DataNode 7], DataNode 6, IndexNode 10 23 [DataNode 99, DataNode 78, DataNode 24]]\n\ncountList :: [a] -&gt; Int\ncountList [] = 0\ncountList (x:xs) = 1 + countList xs\n\nisIndexNodeCheck :: MultTree a -&gt; Bool\nisIndexNodeCheck (DataNode _) = False\nisIndexNodeCheck (IndexNode _ _ _) = True\n\ngrad :: MultTree t -&gt; Int\ngrad DataNode _       = 0\ngrad IndexNode _ _ [] = 0\ngrad IndexNode _ _ (x:xs)\n              | isIndexNodeCheck x = max ((countList (x:xs)) (grad x))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1486154643, "post_id": 42032697, "comment_id": 71239941, "body": "What about just <code>length</code>?"}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486154720, "post_id": 42032697, "comment_id": 71239978, "body": "Well, you are right that would be an option. On the other hand I would like to see how I could do that function by myself"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1486154720, "post_id": 42032697, "comment_id": 71239979, "body": "And remove the <code>(Num) =&gt;</code>. The way you&#39;ve written it looks illegal, and a Typeclass restriction is unnecessary since you never use the elements directly. Just change the signature to <code>countList :: [a] -&gt; Integer</code>, since you have a list of anything, and want to return a number."}], "answers": [{"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 2, "last_activity_date": 1486154821, "creation_date": 1486154821, "answer_id": 42032763, "question_id": 42032697, "link": "https://stackoverflow.com/questions/42032697/count-list-for-any-object/42032763#42032763", "title": "Count list for any object", "body": "<p>The signature of the function is wrong. You want to take it a list of an arbitraty type <code>a</code> and return an integer:</p>\n\n<pre><code>countList :: [a] -&gt; Int\n</code></pre>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 42032763, "answer_count": 1, "score": 0, "last_activity_date": 1486217570, "creation_date": 1486154529, "last_edit_date": 1486217570, "question_id": 42032697, "link": "https://stackoverflow.com/questions/42032697/count-list-for-any-object", "title": "Count list for any object", "body": "<p>I have a data structure like that: </p>\n\n<pre><code>data MultTree b = DataNode b | IndexNode Int Int [MultTree b] deriving (Show)\n</code></pre>\n\n<p>For working with that structure recursively I need a function that counts the objects of a list. Is there a universial one for any type of object?</p>\n\n<p>My compiler does accept only Num as a parameter:</p>\n\n<pre><code>countList :: (Num) =&gt; [a] -&gt; a\ncountList [] = 0\ncountList (x:xs) = 1 + countList xs\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1486265354, "post_id": 42032854, "comment_id": 71269238, "body": "I like this. So sometimes I need to decode a &quot;type minus a field&quot;, such as when a user POSTs a Comment minus an ID, how do you derive the FromJSON for &quot;Comment minus ID&quot;?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1486269431, "post_id": 42032854, "comment_id": 71269839, "body": "@Josh.F There is no deriving involved here. There is only one original type involved. I remove or add a specific key using my helper functions."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1486301764, "post_id": 42032854, "comment_id": 71277479, "body": "@Sibi, it&#39;s a compromise I don&#39;t want to do. I think it&#39;s loosing too much type safety and declarativity, I mean having to read the handler code to see what data is used is something I don&#39;t want when using Haskell."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1486155208, "creation_date": 1486155208, "answer_id": 42032854, "question_id": 42032338, "link": "https://stackoverflow.com/questions/42032338/how-to-deal-with-incomplete-json-record-types-ie-missing-required-fields-which/42032854#42032854", "title": "How to deal with incomplete JSON/Record types (IE missing required fields which I&#39;ll later fill in)?", "body": "<p>I'm also looking for a nice way to solve this. :-)</p>\n\n<p>What I usually do in my code is to operate directly on the Aeson's type <code>Value</code>. This is some of the sample code taken from my current project:</p>\n\n<pre><code>import qualified Data.HashMap.Strict as HM\n\nremoveKey :: Text -&gt; Value -&gt; Value\nremoveKey key (Object xs) = Object $ HM.delete key xs\nremoveKey _ ys = ys\n</code></pre>\n\n<p>I directly operate on the value <code>Object</code> and remove the particular key present in the javascript object.</p>\n\n<p>And in the Yesod handler code, I do this processing:</p>\n\n<pre><code>myHandler :: Handler RepJson\nmyHandler = do\n    userId &lt;- insert $ User \"sibi\" 23\n    guser &lt;- getJuser user\n    let guser' =  removeKey \"someId\" $ toJSON guser\n    return $ repJson $ object [ \"details\" .= guser' ]\n</code></pre>\n\n<p>In some cases, I actually want to add some specific key to the outgoing JSON object. For those, I have specific helper functions defined which operate on the type <code>Value</code>. While this is not perfect, it has been helping me to avoid a lot of boilerplate code.</p>\n"}, {"comments": [{"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1486265136, "post_id": 42034461, "comment_id": 71269208, "body": "I like where this is going. Using your idea could I provide a FromJSON instance (<code>String -&gt; Comment</code>) that could work for either Comment, and Comment minus UID?"}, {"owner": {"reputation": 1791, "user_id": 550026, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a9808a71e03d9b9602aae53622c64d70?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/550026/will"}, "edited": false, "score": 0, "creation_date": 1503567166, "post_id": 42034461, "comment_id": 78673694, "body": "This answer is old as the hills, but I&#39;m wondering if you could share your FromJSON instance for a function like this?  I like this idea but am struggling to implement it."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1503570676, "post_id": 42034461, "comment_id": 78676235, "body": "I don&#39;t remember the exact syntax to parse json but you could do something along <code>parseJson (Object v) = \\user -&gt; User &lt;$&gt; (pure user) &lt;*&gt; v .: &quot;thing&quot;</code>"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 3, "last_activity_date": 1486163384, "creation_date": 1486163384, "answer_id": 42034461, "question_id": 42032338, "link": "https://stackoverflow.com/questions/42032338/how-to-deal-with-incomplete-json-record-types-ie-missing-required-fields-which/42034461#42034461", "title": "How to deal with incomplete JSON/Record types (IE missing required fields which I&#39;ll later fill in)?", "body": "<p>What I usually do to  get a type minus a field is just to have a function which take that field and return the type. In your case you just need to declare an JSON instance for <code>UserId -&gt; Comment</code>. Ok it doesn't seem natural and you have to go it manually but it actually works really well, especially as there is only one field of type UserId  in Comment.</p>\n"}, {"comments": [{"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1486265024, "post_id": 42035080, "comment_id": 71269191, "body": "ah, nice, but could there not be a more generalized pattern like this? Ex what if the data isn&#39;t about uid, but some other arbitrary thing? (I actually like your idea though since that covers some large percent of use cases)"}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "reply_to_user": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1486288794, "post_id": 42035080, "comment_id": 71273849, "body": "I&#39;m sure you could generalise this in many directions, perhaps at the cost of making it slightly harder to work with."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 1, "creation_date": 1486300129, "post_id": 42035080, "comment_id": 71276958, "body": "It is similar to what is done at the database level, by Persistent. You can read some explanation here <a href=\"http://www.yesodweb.com/book/persistent#persistent_insert\" rel=\"nofollow noreferrer\">yesodweb.com/book/persistent#persistent_insert</a>"}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1486319903, "post_id": 42035080, "comment_id": 71283798, "body": "@Jean-BaptistePotonnier thanks for pointing that out. That clarifies a bit, but doesn&#39;t quite answer the case of relational data, IE when an object has an ID, and it&#39;s owner&#39;s ID. Or maybe it does answer that case, but I don&#39;t see it yet :)"}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 2, "last_activity_date": 1486167653, "creation_date": 1486167653, "answer_id": 42035080, "question_id": 42032338, "link": "https://stackoverflow.com/questions/42032338/how-to-deal-with-incomplete-json-record-types-ie-missing-required-fields-which/42035080#42035080", "title": "How to deal with incomplete JSON/Record types (IE missing required fields which I&#39;ll later fill in)?", "body": "<p>A solution I like is to use a wrapper for things that come from/go to the DB:</p>\n\n<pre><code>data Authenticated a = Authenticated\n  { uid :: Uid\n  , thing :: a\n  } deriving (Show)\n</code></pre>\n\n<p>Then you can have <code>Comment</code> be just <code>SimpleComment</code> and turn it into an <code>Authenticated Comment</code> once you know the user id.</p>\n"}], "owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 42035080, "answer_count": 3, "score": 7, "last_activity_date": 1487978271, "creation_date": 1486152872, "last_edit_date": 1487978271, "question_id": 42032338, "link": "https://stackoverflow.com/questions/42032338/how-to-deal-with-incomplete-json-record-types-ie-missing-required-fields-which", "title": "How to deal with incomplete JSON/Record types (IE missing required fields which I&#39;ll later fill in)?", "body": "<p>EDIT: For those with similar ailments, I found this is related to the \"Extensible Records Problem\", something I will personally research more into.</p>\n\n<hr>\n\n<p>EDIT2: I have started to solve this (weeks later now) by being pretty explicit about data types, and having multiple data types per semantic unit of data. For example, if the database holds an <code>X</code>, my code has an <code>XAction</code> for representing things I want to do with an <code>X</code>, and <code>XResponse</code> for relaying <code>X</code>s to an http client. And then I need to build the supporting code for shuttling bits between instances. Not ideal, but, I like that it's explicit, and hopefully when my models crystallize, it shouldn't really need much up keep, and should be very reliable.</p>\n\n<hr>\n\n<p>I'm not sure what the correct level of abstraction is for tackling this problem (ie records? or Yesod?) So I'll just lay out the simple case.</p>\n\n<h2>Simple Case / TL;DR</h2>\n\n<p>I want to decode a request body into a type </p>\n\n<p><code>data Comment = Comment {userid :: ..., comment :: ...}</code></p>\n\n<p>but actually I don't want the request body to contain <code>userid</code>, the server will supply that based on their Auth Headers, (or wherever I want to get data to default fill a field).</p>\n\n<p>So they actually pass me something like:</p>\n\n<p><code>data SimpleComment = SimpleComment {comment :: ...} deriving (Generic, FromJSON)</code></p>\n\n<p>And I turn it into a <code>Comment</code>. But maintaining both nearly-identical types simultaneously is a hassle, and not DRY.</p>\n\n<p>How do I solve this problem?</p>\n\n<hr>\n\n<h2>Details on Problem</h2>\n\n<p>I have a record type:</p>\n\n<p><code>data Comment = Comment {userid :: ..., comment :: ...}</code></p>\n\n<p>I have a POST route:</p>\n\n<pre><code>postCommentR :: Handler Value\npostCommentR = do\n  c &lt;- requireJsonBody :: (Handler Comment)\n  insertedComment &lt;- runDB ...\n  returnJson insertedComment\n</code></pre>\n\n<p>Notice that the Route requires that the user supply their <code>userid</code> (in the <code>Comment</code> type, which is at least redundant since their id is associated with their auth headers. At worst, it means I need to check that users are adding their own id, or throwing away their supplied id, in which case why did they supply it in the first case.</p>\n\n<p>So, I want a record type that's <code>Comment</code> minus <code>userid</code>, but I don't know how to do that intelligently.</p>\n\n<hr>\n\n<h2>My Current (awful but working) Solution</h2>\n\n<p>So I made a custom type with derived <code>FromJSON</code> (for the request body) which is almost completely redundant with the <code>Comment</code> type.</p>\n\n<p><code>data SimpleComment = SimpleComment {comment :: ...} deriving (Generic, FromJSON)</code></p>\n\n<p>Then my new route needs to decode the request body according to this, and then merge a <code>SimpleComment</code> with a <code>userid</code> field to make it a <code>Comment</code>:</p>\n\n<pre><code>postComment2R :: Handler Value\npostComment2R = do\n  c &lt;- requireJsonBody :: (Handler SimpleComment)\n  (uid, _) requireAuthPair\n  insertedComment &lt;- runDB $ insertEntity (Comment { commentUserid  = uid\n                                                   , commentComment = comment c})\n  returnJson ...\n</code></pre>\n\n<p>Talk about boilerplate. And my use case is more complex than this simple <code>Comment</code> type. </p>\n\n<p>If it factors in, you might be able to tell, I'm using the <strong>Yesod Scaffolding</strong>.</p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 0, "last_activity_date": 1486189933, "creation_date": 1486189933, "answer_id": 42037325, "question_id": 42031937, "link": "https://stackoverflow.com/questions/42031937/parse-json-with-aeson/42037325#42037325", "title": "Parse JSON with Aeson", "body": "<p>I'm going to start from the end then get back to your questions.</p>\n\n<p><strong>Solving With Class</strong></p>\n\n<p>Typically you make a Haskell data type for each of your JSON types and write <code>FromJSON</code> classes that implement the parser.  You don't have to, but it does lighten the mental load and fall inline with what you might observe in other project.  To that end lets make just a couple types <code>My</code> for your elements and <code>Mys</code> for a list of these elements:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport           Data.Aeson\nimport qualified Data.ByteString.Lazy.Char8 as L8\nimport qualified Data.Vector as V\n\nsample :: L8.ByteString\nsample = \"{\\\"k1\\\":{\\\"k2\\\":[{\\\"a\\\": 3, \\\"b\\\": 4, \\\"c\\\": 2}, {\\\"a\\\": 1, \\\"b\\\": 2, \\\"c\\\": 9}]}, \\\"irrelevant\\\": \\\"x\\\"} \"\n\nnewtype Mys = Mys [My]\n    deriving (Eq,Ord,Show)\ndata My = My Int Int\n    deriving (Eq,Ord,Show)\n</code></pre>\n\n<p>Ok, no issues.  Now we can extract from your <code>k1</code> record a list of the a-b-c objects and run the <code>My</code> parser on these objects to get just the <code>a</code> and <code>b</code> values:</p>\n\n<pre><code>instance FromJSON Mys where\n  parseJSON (Object v) = do\n   do k1Val &lt;- v .: \"k1\"\n      case k1Val of\n        Object k1 -&gt;\n          do k2Val &lt;- k1 .: \"k2\"\n             Mys . V.toList &lt;$&gt; mapM parseJSON k2Val\n        _         -&gt; fail \"k1 was not an Object\"\n  parseJSON o = fail $ \"Invalid type for Mys: \" ++ show o\n</code></pre>\n\n<p>That is, to parse a <code>Mys</code> we need an object, the object must have a <code>k1</code> entry that is another object.  <code>k1</code> must have a <code>k2</code> entry which we can parse as a <code>Vector</code> of <code>My</code> values.</p>\n\n<pre><code>instance FromJSON My where\n  parseJSON (Object v) = My &lt;$&gt; v .: \"a\" &lt;*&gt; v .: \"b\"\n  parseJSON o = fail $ \"Invalid type for My: \" ++ show o\n</code></pre>\n\n<p>And the <code>My</code> data is just a parsing of <code>a</code> and <code>b</code> fields as <code>Int</code>. Behold:</p>\n\n<pre><code>&gt; decode sample :: Maybe Mys\nJust (Mys [My 3 4,My 1 2])\n</code></pre>\n\n<p><strong>Without Class</strong></p>\n\n<p>You asked about <code>:t (fromJust $ (decode sample :: Maybe Object)) .: \"k1\"</code>, which is just a fancy way of asking about the type of <code>.:</code>:</p>\n\n<pre><code>&gt; :t (.:)\n(.:) :: FromJSON a =&gt; Object -&gt; Text -&gt; Parser a\n</code></pre>\n\n<p>So you are providing an Object and Text to get a <code>Parser</code>, as you said.  I wouldn't advise using the <code>Parser</code> monad <em>again</em> - you effectively just used it for <code>decode</code>.  In short I'd say no, you weren't on a path to happiness.</p>\n\n<p>If you aren't going to use the API as designed then just forget the combinators and use the data types directly.  That is, lots of <code>case</code> destruction of the <code>Value</code> types.  First is k1 which is an <code>Object</code> (just a <code>HashMap</code>) then extract the k2 value which is an <code>Array</code> (a <code>Vector</code>), finally for each element of the Vector you extract out an Object again and lookup the <code>a</code> and <code>b</code> keys there.  I was going to write it up for example, but it is exceedingly ugly if you don't at least allow yourself a <code>Maybe</code> monad.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 4544037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ded10e98957fa5559deba7cb27db496?s=128&d=identicon&r=PG", "display_name": "Mike Pilgrem", "link": "https://stackoverflow.com/users/4544037/mike-pilgrem"}, "is_accepted": false, "score": 0, "last_activity_date": 1486212387, "creation_date": 1486212387, "answer_id": 42040537, "question_id": 42031937, "link": "https://stackoverflow.com/questions/42031937/parse-json-with-aeson/42040537#42040537", "title": "Parse JSON with Aeson", "body": "<p>The tutorial <a href=\"https://artyom.me/aeson\" rel=\"nofollow noreferrer\">'Aeson: the tutorial' by Artyom</a> may help you, as it helped me.</p>\n\n<p>Following it, I arrived at the following code. It extends <code>sample</code> to allow the processing of different samples (some with a variety of defects) to be examined. <code>main</code> expects the identity of the sample that is to be processed to be supplied as the first argument to the compiled executable.</p>\n\n<p>Starting at the bottom of the JSON structure, and working upwards, function <code>parseMy :: Value -&gt; Parser My</code> processes an object with 'a' 'b' keys to yield a <code>My</code> (if successful); intermediate helper function <code>parseMyList'</code> processes an array of such objects to yield a list of <code>My</code>; and <code>parseMyList</code> processes an object with key 'k1', yielding in turn an object with key 'k2', to also yield a list of <code>My</code>.</p>\n\n<p>In <code>main</code>, <code>parse</code> applies <code>parseMyList :: Value -&gt; Parser [My]</code> to the result of <code>decode</code> (if it was successful).</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main (main) where\n\nimport           Data.Aeson ((.:), decode, Value)\nimport           Data.Aeson.Types (parse, Parser, withArray, withObject)\nimport qualified Data.ByteString.Lazy.Char8 as L8 (ByteString)\nimport qualified Data.Vector as V (toList)\nimport           System.Environment (getArgs)\n\ndata My = My Int Int deriving (Show)\n\nsample :: String -&gt; L8.ByteString\nsample \"1\" = \"{\\\"k1\\\":{\\\"k2\\\":[{\\\"a\\\": 3, \\\"b\\\": 4, \\\"c\\\": 2}, {\\\"a\\\": 1, \\\"b\\\": 2, \\\"c\\\": 9}]}, \\\"irrelevant\\\": \\\"x\\\"} \"\nsample \"2\" = \"{\\\"k1\\\":{\\\"k2\\\":[{\\\"a\\\": 3, \\\"b\\\": 4, \\\"c\\\": 2}, {\\\"a\\\": 1, \\\"c\\\": 9}]}, \\\"irrelevant\\\": \\\"x\\\"} \"\nsample \"3\" = \"{\\\"k1\\\":{\\\"k3\\\":[{\\\"a\\\": 3, \\\"b\\\": 4, \\\"c\\\": 2}, {\\\"a\\\": 1, \\\"b\\\": 2, \\\"c\\\": 9}]}, \\\"irrelevant\\\": \\\"x\\\"} \"\nsample \"4\" = \"{\\\"k1\\\":{\\\"k2\\\":[{\\\"a\\\": 3, \\\"b\\\": 4, \\\"c\\\": 2}]}, \\\"irrelevant\\\": \\\"x\\\"} \"\nsample _   = \"Error\"\n\nparseMy :: Value -&gt; Parser My\nparseMy = withObject \"object\" $ \\o -&gt; do\n    a &lt;- o .: \"a\"\n    b &lt;- o .: \"b\"\n    return $ My a b\n\nparseMyList' :: Value -&gt; Parser [My]\nparseMyList' = withArray \"array\" $ \\arr -&gt;\n    mapM parseMy (V.toList arr)\n\nparseMyList :: Value -&gt; Parser [My]\nparseMyList = withObject \"object\" $ \\o -&gt; do\n    k1 &lt;- o .: \"k1\"\n    k2 &lt;- k1 .: \"k2\"\n    parseMyList' k2 \n\nmain :: IO ()\nmain = do\n    args &lt;- getArgs\n    case args of\n        []  -&gt; fail \"expected sample identity as the first argument\"\n        n:_ -&gt; do\n            putStrLn $ \"Processing sample \" ++ n\n            case decode (sample n) of\n                Just result -&gt; print $ parse parseMyList result\n                Nothing     -&gt; fail \"decoding failed\"\n</code></pre>\n"}], "owner": {"reputation": 5352, "user_id": 4896150, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/74d0c938f3f71d6ee14db4f6b9d222c2?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Harald", "link": "https://stackoverflow.com/users/4896150/anton-harald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1157, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1486212387, "creation_date": 1486151264, "question_id": 42031937, "link": "https://stackoverflow.com/questions/42031937/parse-json-with-aeson", "title": "Parse JSON with Aeson", "body": "<p>Cosider the following JSON structure:</p>\n\n<pre><code>{\"k1\":\n  {\"k2\":\n    [{\"a\": 3, \"b\": 4, \"c\": 2},\n     {\"a\": 1, \"b\": 2, \"c\": 9}]},\n \"irrelevant\": \"x\"}\n</code></pre>\n\n<p>and Haskell data type:</p>\n\n<pre><code>data My = My Int Int\n</code></pre>\n\n<p>The above JSON should be parsed to a List of My: <code>[My]</code>, whereas the two Int should each be taken from the \"a\" and \"b\" key of the JSON array:</p>\n\n<pre><code>[My 3 4, My 1 2]\n</code></pre>\n\n<p>Admittedly I'm already facing troubles with the simplest parts of it.</p>\n\n<p>Here's how I started using Aeson:</p>\n\n<pre><code>import           Data.Aeson\nimport qualified Data.ByteString.Lazy.Char8 as L8\n\nsample :: L8.ByteString\nsample = \"{\\\"k1\\\":{\\\"k2\\\":[{\\\"a\\\": 3, \\\"b\\\": 4, \\\"c\\\": 2}, {\\\"a\\\": 1, \\\"b\\\": 2, \\\"c\\\": 9}]}, \\\"irrelevant\\\": \\\"x\\\"} \"\n</code></pre>\n\n<p>At the repl:</p>\n\n<pre><code>decode sample :: Maybe Object\nJust (Object (fromList [(\"irreleva...\n</code></pre>\n\n<p>This works as expected, the JSON is parsed. However the next step, getting the Object at key \"k1\", does not work:</p>\n\n<pre><code>:t (fromJust $ (decode sample :: Maybe Object)) .: \"k1\"\n...\n  :: FromJSON a =&gt; aeson-0.11.2.1:Data.Aeson.Types.Internal.Parser a\n</code></pre>\n\n<p>I'm receiving a <code>Parser a</code> type here, I'd need/expect getting another <code>Object</code> or <code>Maybe Object</code> at this point.</p>\n\n<p>Am I on the right path?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1486143231, "post_id": 42029676, "comment_id": 71234166, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/22778098/haskell-ghc-cannot-deduce-type-rigid-type-variable-bound-by-the-type-signature\">Haskell: GHC cannot deduce type. Rigid type variable bound by the type signature error</a>"}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1486146357, "post_id": 42029676, "comment_id": 71235884, "body": "Shouldn&#39;t v also be <code>rTrim</code>&#39;d for <code>TxtME</code> and <code>TxtNME</code>?"}, {"owner": {"reputation": 368, "user_id": 2492166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/54b4fd0a3406e65b532e27dfd9b3ad0d?s=128&d=identicon&r=PG", "display_name": "Iron Gremlin", "link": "https://stackoverflow.com/users/2492166/iron-gremlin"}, "reply_to_user": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1486147806, "post_id": 42029676, "comment_id": 71236636, "body": "@Gurkenglas - Nice catch. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 368, "user_id": 2492166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/54b4fd0a3406e65b532e27dfd9b3ad0d?s=128&d=identicon&r=PG", "display_name": "Iron Gremlin", "link": "https://stackoverflow.com/users/2492166/iron-gremlin"}, "edited": false, "score": 0, "creation_date": 1486147133, "post_id": 42029770, "comment_id": 71236303, "body": "Thanks! This worked perfectly and was much less work than I&#39;d feared."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1486142774, "creation_date": 1486142774, "answer_id": 42029770, "question_id": 42029676, "link": "https://stackoverflow.com/questions/42029676/trouble-with-rigid-type-variables/42029770#42029770", "title": "Trouble with rigid type variables", "body": "<p>Turn on <code>Rank2Types</code> (e.g. by putting <code>{-# LANGUAGE Rank2Types #-}</code> at the top of your file) and write</p>\n\n<pre><code>--         vvvvvvvvv difference is here\nprocP ::  (forall a. (a-&gt;Bool) -&gt; [a] -&gt; Bool) -&gt; String -&gt; Comperator -&gt; ([String] -&gt; Bool)\n</code></pre>\n"}], "owner": {"reputation": 368, "user_id": 2492166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/54b4fd0a3406e65b532e27dfd9b3ad0d?s=128&d=identicon&r=PG", "display_name": "Iron Gremlin", "link": "https://stackoverflow.com/users/2492166/iron-gremlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 42029770, "answer_count": 1, "score": 1, "last_activity_date": 1486142774, "creation_date": 1486142450, "question_id": 42029676, "link": "https://stackoverflow.com/questions/42029676/trouble-with-rigid-type-variables", "title": "Trouble with rigid type variables", "body": "<p>I'm trying to build a parser for a simplistic DSL.</p>\n\n<p>I'm running into trouble with the following function:</p>\n\n<pre><code>procP ::  ((a-&gt;Bool) -&gt; [a] -&gt; Bool) -&gt; String -&gt; Comperator -&gt; ([String] -&gt; Bool)\nprocP q v c =\n  case c of\n      NumE   -&gt; q ((==) . unMay . readDouble $ v) . mapMaybe readDouble\n      NumNE  -&gt; q ((/=) . unMay . readDouble $ v) . mapMaybe readDouble\n      NumLTE -&gt; q ((&lt;=) . unMay . readDouble $ v) . mapMaybe readDouble\n      NumLT  -&gt; q ((&lt;)  . unMay . readDouble $ v) . mapMaybe readDouble\n      NumGTE -&gt; q ((&gt;=) . unMay . readDouble $ v) . mapMaybe readDouble\n      NumGT  -&gt; q ((&gt;)  . unMay . readDouble $ v) . mapMaybe readDouble\n      Exists -&gt; q notBlanks\n      DatE   -&gt; q ((==) . unMay . p_date $ v ) . mapMaybe p_date\n      DatNE  -&gt; q ((/=) . unMay . p_date $ v ) . mapMaybe p_date\n      DatLTE -&gt; q ((&lt;=) . unMay . p_date $ v ) . mapMaybe p_date\n      DatLT  -&gt; q ((&lt;)  . unMay . p_date $ v ) . mapMaybe p_date\n      DatGTE -&gt; q ((&gt;=) . unMay . p_date $ v ) . mapMaybe p_date\n      DatGT  -&gt; q ((&gt;)  . unMay . p_date $ v ) . mapMaybe p_date\n      TxtE   -&gt; q (==v)\n      TxtME  -&gt; (q (==v)) . map (rTrim)\n      TxtNME -&gt; (q (/=v)) . map (rTrim)\n      TxtNE  -&gt; q (/= v) \n</code></pre>\n\n<p>The breakdown here is as follows:</p>\n\n<p><code>q</code> is some function that works like <code>any</code> from prelude. There are a couple different variations, but the type signature should be more or less the same - given a predicate and a list, return a bool.</p>\n\n<p><code>v</code> is a string input for purposes of comparison, it helps construct the predicate. </p>\n\n<p><code>c</code> is a token type constructed by the parser that represents what type of comparison we should use in the predicate.</p>\n\n<p><code>unMay</code> is a stupid hack function to \"unwrap\" a <code>Just</code> value or error on <code>Nothing</code>. </p>\n\n<p><code>readDouble</code> and <code>p_date</code> are functions that take a <code>String</code> and return either a <code>Maybe Day</code> or <code>Maybe Double</code>, respectively.</p>\n\n<p>The design intent here is that the we're using the <code>Comparator</code> token to tell us what type to change the input <code>String</code>s to internally, so that I can choose whether to compare against a value as a <code>String</code>, <code>Day</code>, or <code>Double</code>, respectively. </p>\n\n<p>Sort of like a super basic version of what Perl does with <code>==</code> vs <code>eq</code>, but with less coercion and more nasty error messages.</p>\n\n<p>The problem I'm having is that this doesn't type check, because the predicate getting passed to <code>q</code> ends up presenting as type <code>Double-&gt;Bool</code> instead of <code>a-&gt;Bool</code>, and so I get an error about how <code>a</code> is a rigid type variable.</p>\n\n<p>The error more or less makes sense to me, but I'm having a lot of trouble thinking of a way to get around the problem.</p>\n\n<p>Does anyone have any advice on how to re-structure this?</p>\n"}, {"tags": ["windows", "macos", "performance", "haskell"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 5, "creation_date": 1486140224, "post_id": 42028962, "comment_id": 71232465, "body": "Windows takes longer to spawn a process than *nix, and your execution times are very short, so you may just be seeing the effect of this difference. Try making your program run for a longer time (e.g. add an outer loop, to make execution time around 1s or more) to see if the times get closer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1486140259, "post_id": 42028962, "comment_id": 71232483, "body": "<a href=\"http://stackoverflow.com/help/mcve\">Here is some guidance on creating an MCVE.</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1486141554, "post_id": 42028962, "comment_id": 71233204, "body": "Paul R&#39;s guess is likely right. To go beyond it, though, we&#39;ll need to see your program."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1486142473, "post_id": 42028962, "comment_id": 71233730, "body": "And GPU doesn&#39;t matter \u2013 it&#39;s normally not used by programs at all except for graphics (duh). Only with GPGPU libraries like OpenCL can you outsource signal processing etc. to the GPU. In Haskell you can use <a href=\"http://hackage.haskell.org/package/accelerate\" rel=\"nofollow noreferrer\">accelerate</a> for this. But this is still quite advanced; for simple programs you&#39;ll generally keep it to the CPU alone."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1486142740, "post_id": 42028962, "comment_id": 71233896, "body": "Generally speaking, it&#39;s utterly useless to compare <i>program execution times</i> in the range of milliseconds as a measure for number-crunching performance; your results will always be dominated by initialision stuff. Startup time can be important for scripting and testing, but for actual computation-heavy production code it&#39;s pretty much completely irrelevant."}, {"owner": {"reputation": 303, "user_id": 4173209, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/caf52eb0e43490cabe3bb0cc1f850dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Valerie94", "link": "https://stackoverflow.com/users/4173209/valerie94"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1486144004, "post_id": 42028962, "comment_id": 71234578, "body": "@leftaroundabout What methods of profiling my code would you recommend to profile my code? I&#39;m profiling my code as in <i>Parallel and Concurrent Haskell</i>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1486146336, "post_id": 42028962, "comment_id": 71235870, "body": "@Valerie94: well, if you&#39;ve not used used e.g. UNIX <code>time</code> but GHC&#39;s <code>+RTS -s</code> option \u2013 that is <i>ok</i> to use for simple profiling; just make sure your examples actually do enough work so the result is in fact representative of the <i>computations</i>, 1 second a least. However, <a href=\"http://hackage.haskell.org/package/criterion\" rel=\"nofollow noreferrer\"><code>criterion</code></a> is much better for reliable results."}], "owner": {"reputation": 303, "user_id": 4173209, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/caf52eb0e43490cabe3bb0cc1f850dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Valerie94", "link": "https://stackoverflow.com/users/4173209/valerie94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486140007, "creation_date": 1486140007, "question_id": 42028962, "link": "https://stackoverflow.com/questions/42028962/performance-difference-between-os-x-and-windows", "title": "Performance difference between OS X and Windows", "body": "<p>I've written a signal processing program in Haskell. I've developed the program on my MacBook Pro, using OS X. I also own a desktop which runs Windows. Since my desktop has a more powerful CPU and GPU, I wanted to test my program on it to see how much quicker it would process certain signals, but I did not expect the results. </p>\n\n<p>On my MacBook Pro, the program finishes in an average of 0.013s. On my Windows desktop, the program finishes in an average of 0.090s. This was extremely surprising to me and I started doubting the power of my desktop. </p>\n\n<p>I also have Windows installed on my MacBook Pro in bootcamp, so I decided to test the program that way as well. In Windows (bootcamp), the program finishes in an average of 0.109s. </p>\n\n<p>How is this possible. Is it normal for there to be a performance difference between Windows and OS X for Haskell. Am I missing something? </p>\n"}, {"tags": ["haskell", "types", "functor"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1486132459, "creation_date": 1486132459, "answer_id": 42026627, "question_id": 42026435, "link": "https://stackoverflow.com/questions/42026435/writing-a-generic-functor-instance-across-type-constructors/42026627#42026627", "title": "Writing a generic functor instance across type constructors?", "body": "<p>As far as I know this is not possible, simply because there can be multiple constructors and it is unknown whether a generic constructor <code>Foo</code> can take any attribute as type.</p>\n\n<p>Say for instance you have a type called:</p>\n\n<pre><code>data Foo a = Bar Int | Qux a\n</code></pre>\n\n<p>Now it means you cannot abstract away the constructor. As long as it is <code>Qux</code>, there is no problem, but <code>Bar</code> always expects an <code>Int</code> and thus will error. Since you here define an <code>instance</code> over any kind of <code>c</code>, there will be cases where this does not work. Note furthermore that the <code>c</code> in your <code>instance</code> declaration has nothing to do with the <code>c</code> in your definition of <code>t</code>. In other words: constructors can imply type constraints so you cannot simply factor them out.</p>\n\n<p>A remark on your question is that you can generalize both you <code>class</code> defintion and <code>instance</code>:</p>\n\n<pre><code>class FC c where\n  t :: (a -&gt; b) -&gt; c a -&gt; c b\n\ninstance FC Test where\n  t f (Test a) = Test (f a) \n  t f Emp = Emp\n</code></pre>\n\n<p>So you can remove the <code>a</code> in the <code>class</code> definition. This is not equivalent with your questions since here you say that it can work for any <code>a</code>. Whereas when you define a class <code>FC c a</code> you can decide for which <code>a</code>s you want implement an <code>instance</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1486132956, "last_edit_date": 1486132956, "creation_date": 1486132602, "answer_id": 42026665, "question_id": 42026435, "link": "https://stackoverflow.com/questions/42026435/writing-a-generic-functor-instance-across-type-constructors/42026665#42026665", "title": "Writing a generic functor instance across type constructors?", "body": "<p>As you've learned, <code>c a</code> is not a syntactically valid pattern. But reading your question instead as a feature proposal: How would that work? Not every <code>Functor</code> has a single-element constructor which can be mapped over according to your pattern. Some examples:</p>\n\n<pre><code>data Pair a = Pair a a  -- more than one element\ninstance Functor Pair where\n    fmap f (Pair x y) = Pair (f x) (f y)\n\ndata Proxy a = Proxy  -- no elements\ninstance Functor Proxy where\n    fmap f Proxy = Proxy\n\nnewtype Cont r a = Cont { runCont :: (a -&gt; r) -&gt; r }  -- element appears in a double-negative position\ninstance Functor (Cont r) where\n    fmap f (Cont g) = Cont (g . (. f))\n</code></pre>\n\n<p>In any case, I don't think the idea of a \"generic instance\" really makes sense. The instance is where you put your type-specific code. (It has to go somewhere!)</p>\n\n<p>If you want to exert less effort in writing <code>Functor</code> instances you can use GHC's <code>DeriveFunctor</code> extension.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\ndata Pair a = Pair a a deriving Functor\n\ndata Proxy a = Proxy deriving Functor\n\nnewtype Cont r a = Cont { runCont :: (a -&gt; r) -&gt; r } deriving Functor\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": false, "score": 4, "last_activity_date": 1486161148, "last_edit_date": 1486161148, "creation_date": 1486134500, "answer_id": 42027272, "question_id": 42026435, "link": "https://stackoverflow.com/questions/42026435/writing-a-generic-functor-instance-across-type-constructors/42027272#42027272", "title": "Writing a generic functor instance across type constructors?", "body": "<p>You can do something very generic using <code>GHC.Generic</code>. Here is an incomplete example for a generic <code>FC</code> class definition (this is exactly what the <a href=\"https://github.com/dreixel/generic-deriving/blob/master/src/Generics/Deriving/Functor.hs\" rel=\"nofollow noreferrer\">generic-deriving</a> package does):</p>\n\n<p>First some extensions and importing the generics machinery</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE DefaultSignatures #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE TypeOperators #-}\n\nimport GHC.Generics\n</code></pre>\n\n<p>Then we define a class which mirrors your <code>FC</code> but we only have instances for the generic types</p>\n\n<pre><code>class GFC c where\n  gt :: (a -&gt; b) -&gt; c a -&gt; c b\n\n-- Constructors without arguments (Empty)\ninstance GFC U1 where\n  gt _ U1 = U1\n\n-- Constructors where the parameter appears (Test a)\ninstance GFC Par1 where\n  gt f (Par1 a) = Par1 (f a)\n\n-- Sums (| in datatype definitions)\ninstance (GFC f, GFC g) =&gt; GFC (f :+: g) where\n  gt f (L1 a) = L1 (gt f a)\n  gt f (R1 a) = R1 (gt f a)\n\n-- Meta information wrapper\ninstance GFC f =&gt; GFC (M1 i c f) where\n  gt f (M1 a) = M1 (gt f a)\n\n-- ... the rest of the instances for the generic types here.\n-- But these 4 instances are all that is needed for your `Test` type.\n</code></pre>\n\n<p>Then you can have a default implementation for <code>FC</code> based on the above \"generic\" <code>FC</code>:</p>\n\n<pre><code>class FC c where\n  t :: (a -&gt; b) -&gt; c a -&gt; c b\n  default -- DefaultSignatures allows us to do this\n    t :: (Generic1 c, GFC (Rep1 c)) =&gt; (a -&gt; b) -&gt; c a -&gt; c b\n  t f = to1 . gt f . from1 \n  -- turn something with Generic1 into its generic representation, \n  -- use the generic `gt` and then turn it back into its actual \n  -- representation\n\ndata Test a = Test a | Empty\n  deriving (Generic1, Show)\n\ninstance FC Test\n</code></pre>\n\n<p>And it works:</p>\n\n<pre><code>GHCI&gt; t (==0) (Test (1 :: Int))\nTest False\n</code></pre>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 1, "accepted_answer_id": 42026665, "answer_count": 3, "score": 3, "last_activity_date": 1573920707, "creation_date": 1486131892, "last_edit_date": 1573920707, "question_id": 42026435, "link": "https://stackoverflow.com/questions/42026435/writing-a-generic-functor-instance-across-type-constructors", "title": "Writing a generic functor instance across type constructors?", "body": "<p>I'm learning basic type classes and have written my own implementation of <code>functor</code> for my type <code>Test a</code> (behaves just like <code>Maybe</code>):</p>\n\n<pre><code>data Test a = Test a | Emp\n\nclass FC c a where\n  t :: (a -&gt; b) -&gt; c a -&gt; c b\n\ninstance FC Test a where\n  t f (Test a) = Test (f a) \n  t f (Emp) = Emp\n\ninstance FC Maybe a where\n  t f (Just a) = Just (f a) \n  t f (Nothing) = Nothing\n</code></pre>\n\n<p>Is it possible to implement something like: </p>\n\n<pre><code>instance FC c where\n  t f (c v) = c (f v)\n</code></pre>\n\n<p>Error: </p>\n\n<pre><code>Parse error in pattern: c\n</code></pre>\n\n<p>In other words, abstract away the type constructor, replace with <code>c</code> and <code>v</code>, therefore creating a general instance that can be applied to any value with a context?</p>\n"}, {"tags": ["list", "haskell", "tree"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1486126676, "last_edit_date": 1486126676, "creation_date": 1486126305, "answer_id": 42024777, "question_id": 42024561, "link": "https://stackoverflow.com/questions/42024561/tree-optional-number-of-subtress/42024777#42024777", "title": "Tree: Optional number of subtress", "body": "<p>Make each one a <code>Maybe</code>:</p>\n\n<pre><code>data MultTree b = DataNode b\n                | IndexNode Int Int (Maybe (MultTree b)) (Maybe (MultTree b)) (Maybe (MultTree b))\n</code></pre>\n\n<p>You still need to provide all the arguments, but a node with only one child might be, for example, <code>IndexNode 3 6 Nothing (Just (DataNode \"hi\")) Nothing</code>.</p>\n\n<p>Alternately, you could simply specify that an <code>IndexNode</code> takes a <em>list</em> of <code>MultTree</code> values, and only allow an <code>IndexNode</code> to be created by a smart constructor that checks the number of <code>MultTree</code> values being added to it.</p>\n\n<pre><code>data MultTree b = DataNode b | IndexNode Int Int [MultTree b]\n\nmkIndexNode :: Int -&gt; Int -&gt; [MultTree b] -&gt; MultTree b\nmkIndex x y nodes | length nodes &gt; 3 = error \"Too many nodes\"\n                  | otherwise = IndexNode x y nodes\n</code></pre>\n\n<p>You can replace the error with your preferred method of dealing with partial functions. (<code>Maybe</code>, <code>Either</code>, etc.)</p>\n"}, {"comments": [{"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1486129086, "post_id": 42024895, "comment_id": 71225016, "body": "Great answer! It would be gread if you explain how to get the subtrees if I would like to do some recursion on an existing tree."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1486129593, "post_id": 42024895, "comment_id": 71225308, "body": "@jublikon Edited."}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1486130513, "post_id": 42024895, "comment_id": 71225913, "body": "Thank you! What do the _ _ mean ? I understand that operator for Lists but here I am not able to see a syntax"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 2, "creation_date": 1486131955, "post_id": 42024895, "comment_id": 71226823, "body": "@jublikon The <code>_</code> pattern matches any value and does not give it a name. Compare, e.g., the <code>t1</code> pattern, which matches any value and names it <code>t1</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1486129564, "last_edit_date": 1486129564, "creation_date": 1486126634, "answer_id": 42024895, "question_id": 42024561, "link": "https://stackoverflow.com/questions/42024561/tree-optional-number-of-subtress/42024895#42024895", "title": "Tree: Optional number of subtress", "body": "<p>Define your own type containing from zero to three things:</p>\n\n<pre><code>data From0To3 a = Zero | One a | Two a a | Three a a a\n   deriving (Show)\ndata MultTree b = DataNode b | IndexNode Int Int (From0To3 (MultTree b))\n   deriving (Show)\n\nt2 :: MultTree Int\nt2 = IndexNode 3 42 \n     (Two (IndexNode 3 15 \n             (Three (DataNode 3) (DataNode 11) (DataNode 12)))\n          (IndexNode 19 42\n             (Two (DataNode 42) (DataNode 23))))\n</code></pre>\n\n<p>As requested, here's how to dissect such a tree. For instance, the following computes the height of a tree.</p>\n\n<pre><code>height :: MultTree a -&gt; Int\nheight (DataNode _)         = 1\nheight (IndexNode _ _ Zero) = 1\nheight (IndexNode _ _ (One t1)) =\n   1 + height t1\nheight (IndexNode _ _ (Two t1 t2)) =\n   1 + (height t1 `max` height t2)\nheight (IndexNode _ _ (Three t1 t2 t3)) =\n   1 + (height t1 `max` height t2 `max` height t3)\n</code></pre>\n\n<p>When writing this kind of pattern matching, I strongly recommend to turn on warnings (<code>-Wall</code>) so that GHC will tell us if we forget to handle a case.</p>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 42024895, "answer_count": 2, "score": 0, "last_activity_date": 1486129564, "creation_date": 1486125634, "last_edit_date": 1486126271, "question_id": 42024561, "link": "https://stackoverflow.com/questions/42024561/tree-optional-number-of-subtress", "title": "Tree: Optional number of subtress", "body": "<p>I have a <code>data</code> structure in Haskell that lets me to build a tree. </p>\n\n<pre><code>data MultTree b = DataNode b | IndexNode Int Int (MultTree b) (MultTree b) (MultTree b) deriving (Show)\n</code></pre>\n\n<p>In that case it is only possible to have <code>IndexNode</code> that needs three <code>MultTree's</code> as parameters. </p>\n\n<p>How can I make <code>IndexNode</code> able to receive 0, 1, 2 or 3 <code>MultTree's</code> ?\nImplementing <code>IndexNode</code> with just different number of parameters does not seem to work.</p>\n\n<p>So in the end I would like to create a tree like that: </p>\n\n<pre><code>t2 :: MultTree Int\nt2 = IndexNode 3 42 (IndexNode 3 15 (3) (11) (12)) (IndexNode 19 42 (42) (23))\n</code></pre>\n"}, {"tags": ["unix", "haskell", "command-line"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1486095514, "post_id": 42016605, "comment_id": 71208191, "body": "i successfully touched many files using this code. is it possible you have a weird cwd?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486113655, "post_id": 42016605, "comment_id": 71215582, "body": "By the way, <code>touch</code> is often also used to update the timestamp of an existing file."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 1, "creation_date": 1486117328, "post_id": 42016605, "comment_id": 71217892, "body": "The exception is being thrown at <code>openFile</code>, but your code snippet doesn&#39;t include that. Could you update it to include that?"}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1486117582, "post_id": 42016605, "comment_id": 71218052, "body": "Also, to add emphasis on your quote: &quot;If the file does not exist <i>and it is opened for output</i>, it should be created&quot;. Without seeing <code>openFile</code>, I would guess that maybe you&#39;re not opening it with the correct mode."}, {"owner": {"reputation": 198, "user_id": 3217109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee206f12f5d313f2f2bc3955d52d58b6?s=128&d=identicon&r=PG&f=1", "display_name": "Zylviij", "link": "https://stackoverflow.com/users/3217109/zylviij"}, "reply_to_user": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1486131375, "post_id": 42016605, "comment_id": 71226458, "body": "@ocharles <code>appendFile</code> calls <code>withFile</code>. In turn, <code>withFile</code> calls <code>openFile</code>, you can check the source here <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/System.IO.html#appendFile\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/src/&hellip;</a>"}, {"owner": {"reputation": 198, "user_id": 3217109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee206f12f5d313f2f2bc3955d52d58b6?s=128&d=identicon&r=PG&f=1", "display_name": "Zylviij", "link": "https://stackoverflow.com/users/3217109/zylviij"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486131458, "post_id": 42016605, "comment_id": 71226510, "body": "@chi so, whether or not the file exists, it should be opened and saved? I will edit my question"}, {"owner": {"reputation": 198, "user_id": 3217109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee206f12f5d313f2f2bc3955d52d58b6?s=128&d=identicon&r=PG&f=1", "display_name": "Zylviij", "link": "https://stackoverflow.com/users/3217109/zylviij"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1486131639, "post_id": 42016605, "comment_id": 71226624, "body": "@haoformayor This was something that confused me about the documentation, are the <code>FilePath</code>s absolute location, relative location, or both? Can I use &quot;~/foo.bar&quot;?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 2, "creation_date": 1486137138, "post_id": 42016605, "comment_id": 71230359, "body": "The <code>FilePath</code> is the same as the OS&#39;s conception of a file path, so it can be absolute or relative, but you cannot use <code>~</code> to mean your home directory, since that is a shell feature. If the filename you are using is really just <code>file.dat</code>, the error only makes sense if your code has a current working directory that has been deleted or similar (what @haoformayor said)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486152485, "post_id": 42016605, "comment_id": 71238874, "body": "@Zylviij I think so. I am unsure about how <code>touch</code> is implemented."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1486154939, "post_id": 42016605, "comment_id": 71240093, "body": "Please edit to include how you are calling <code>touch</code>  -  that is the code (or work flow) with the error, it is not in what you have shown."}], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 3217109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee206f12f5d313f2f2bc3955d52d58b6?s=128&d=identicon&r=PG&f=1", "display_name": "Zylviij", "link": "https://stackoverflow.com/users/3217109/zylviij"}, "edited": false, "score": 0, "creation_date": 1486160307, "post_id": 42032841, "comment_id": 71242322, "body": "You are correct as to what my error was. I had suspected that this was the error but forgot to restart my ghci session."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1486155145, "creation_date": 1486155145, "answer_id": 42032841, "question_id": 42016605, "link": "https://stackoverflow.com/questions/42016605/haskell-implement-unix-touch-command/42032841#42032841", "title": "Haskell Implement Unix &quot;touch&quot; command", "body": "<p>In the future please paste all the code you are using that creates the error.  This includes both the imports and the invocation.  In your case it seems you are running something with a shell expansion character:</p>\n\n<pre><code>*Main&gt; touch \"~/foobar\"\n*** Exception: ~/foobar: openFile: does not exist (No such file or directory)\n</code></pre>\n\n<p>The <code>~</code> is typically expanded by a shell (there also exists a C library that can do that rewriting for you).  Most languages actually interpret that as a literal part of the path... but the <code>~</code> directory probably doesn't exist or that symbol might not even be valid depending on your platform.</p>\n\n<p>Instead try a valid file path:</p>\n\n<pre><code>*Main&gt; touch \"/tmp/thisfile\"\n*Main&gt;\nLeaving GHCi.\n% ls -l /tmp/thisfile\n-rw-rw-r--. 1 theuser theuser 0 Feb  3 12:51 /tmp/thisfile\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "is_accepted": true, "score": 4, "last_activity_date": 1526062953, "creation_date": 1526062953, "answer_id": 50298141, "question_id": 42016605, "link": "https://stackoverflow.com/questions/42016605/haskell-implement-unix-touch-command/50298141#50298141", "title": "Haskell Implement Unix &quot;touch&quot; command", "body": "<p><strong>Use <a href=\"https://hackage.haskell.org/package/unix-2.7.2.2/docs/System-Posix-Files-ByteString.html#v:touchFile\" rel=\"nofollow noreferrer\"><code>touchFile</code></a></strong> from the <code>unix</code> package (<code>System.Posix.Files.ByteString</code>).</p>\n\n<hr>\n\n<p><code>appendFile name \"\"</code> does <strong>not</strong> work like <code>touch</code>; <code>appendFile</code> is a no-op when the string to append is empty.</p>\n\n<p>You can confirm this by running <code>stat</code> on the file before and after and comparing the modification times.</p>\n"}], "owner": {"reputation": 198, "user_id": 3217109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee206f12f5d313f2f2bc3955d52d58b6?s=128&d=identicon&r=PG&f=1", "display_name": "Zylviij", "link": "https://stackoverflow.com/users/3217109/zylviij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 1, "accepted_answer_id": 50298141, "answer_count": 2, "score": 3, "last_activity_date": 1526062953, "creation_date": 1486094864, "last_edit_date": 1486160391, "question_id": 42016605, "link": "https://stackoverflow.com/questions/42016605/haskell-implement-unix-touch-command", "title": "Haskell Implement Unix &quot;touch&quot; command", "body": "<p>I'm trying to implement the <a href=\"https://en.wikipedia.org/wiki/Touch_(Unix)\" rel=\"nofollow noreferrer\"><code>touch</code></a> command from the unix command line, but it seems that my last line throws an exception: <code>** Exception: ~/.todo: openFile: does not exist (No such file or directory)</code></p>\n\n<pre><code>main = touch \"~/.todo\"\n\ntouch :: FilePath -&gt; IO ()\ntouch name = do\n  exists &lt;- doesFileExist name\n  unless exists $ appendFile name \"\"\n</code></pre>\n\n<p>If there is any OS specific behavior, I'm testing from macOS Sierra.</p>\n\n<p>I feel as if this error is strange in that the documentation for <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/System-IO.html\" rel=\"nofollow noreferrer\"><code>openFile</code></a> states that </p>\n\n<blockquote>\n  <p>If the file does not exist and it is opened for output, it should be created as a new file. </p>\n</blockquote>\n\n<p>Any suggestions as to how to fix this?</p>\n\n<p><strong>Edit:</strong> According to @chi, the <code>touch</code> command should always open the file, even if it already exists, because it will then update the file's last modified date.</p>\n\n<pre><code>touch :: FilePath -&gt; IO ()\ntouch name = appendFile name \"\"\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "ghc", "haskell-platform"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 3, "creation_date": 1486100999, "post_id": 42016356, "comment_id": 71209753, "body": "How about just <a href=\"https://haskell-lang.org/get-started/osx\" rel=\"nofollow noreferrer\">installing the Stack build tool</a> via <code>curl -sSL https:&#47;&#47;get.haskellstack.org&#47; | sh</code>? That page has some tutorials to get started using it."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1486106352, "post_id": 42016356, "comment_id": 71211885, "body": "So <code>which ghc</code> turns up nothing?"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1517004553, "creation_date": 1517004553, "answer_id": 48470289, "question_id": 42016356, "link": "https://stackoverflow.com/questions/42016356/haskell-download-on-mac-not-working/48470289#48470289", "title": "Haskell download on Mac not working", "body": "<p>For the record, if the html file opens, that means that something <em>was</em> installed.</p>\n\n<p>In particular, the file that opens will have a url like:</p>\n\n<p><code>file:///Library/Haskell/ghc-8.2.1-x86_64/doc/start.html</code></p>\n\n<p>That url itself contains the directory in which things were installed.</p>\n"}], "owner": {"reputation": 197, "user_id": 6498369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0940eeee1b9093031291a16199eaf8ed?s=128&d=identicon&r=PG&f=1", "display_name": "MandyLB", "link": "https://stackoverflow.com/users/6498369/mandylb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517004553, "creation_date": 1486093210, "question_id": 42016356, "link": "https://stackoverflow.com/questions/42016356/haskell-download-on-mac-not-working", "title": "Haskell download on Mac not working", "body": "<p>So, I'm tying to install Haskell onto my Macbook, but nothing is working. I've downloaded the 64bit full from Haskell.org, opened it up and gone through the installation process, it tells me it's completed and opens up an html page with more info, then nothing. The files should have been installed under my Library folder, but they're not there. It seems like nothing was installed. I've tried the core version as well, same problem.</p>\n\n<p>I need this for a course, and it's become extremely tiresome not being able to use my laptop for the work. Any help would be appreciated.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1486101079, "post_id": 42015869, "comment_id": 71209785, "body": "I don&#39;t remember the details from that module, but from your description, it looks like an oversight in the yesod-auth package, and we should just add the function as a method in the type class."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1486143206, "post_id": 42015869, "comment_id": 71234149, "body": "I recently added JSON support to the Email Auth module. So you can use that as a workaround for now."}, {"owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "edited": false, "score": 0, "creation_date": 1486146557, "post_id": 42015869, "comment_id": 71235993, "body": "Yesod-Auth defines <code>loginHandler</code> apparently, and it says: &quot;&quot;Override if you need fancy widget containers, additional functionality, or an entirely custom page.&quot;&quot;, but If I make a new handler and a widget it needs a form with the email and passwords input, but not sure what to do with that input afterwards"}, {"owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1486918954, "post_id": 42015869, "comment_id": 71542793, "body": "I, personally, had little luck getting my override to <code>loginHandler</code> working, so an alternative is also to override <code>authLayout</code> in the <code>YesodAuth</code> instance, and then add your own styles to the layout file there."}, {"owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "reply_to_user": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1486948696, "post_id": 42015869, "comment_id": 71552631, "body": "@Tehnix oh! didn&#39;t thought about that, it will do the trick in the mean while, thanks!"}, {"owner": {"reputation": 2987, "user_id": 2740693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f1b2ed386aa9b8b11e445f272261b70a?s=128&d=identicon&r=PG", "display_name": "Christian Di Lorenzo", "link": "https://stackoverflow.com/users/2740693/christian-di-lorenzo"}, "edited": false, "score": 0, "creation_date": 1490195081, "post_id": 42015869, "comment_id": 73005608, "body": "@DanielCampoverde-alx741 I&#39;ve tried overriding getting the <code>authLayout</code> but can&#39;t seem to get the types right. Would you mind posting your solution (or at least what you can of it)?"}, {"owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "reply_to_user": {"reputation": 2987, "user_id": 2740693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f1b2ed386aa9b8b11e445f272261b70a?s=128&d=identicon&r=PG", "display_name": "Christian Di Lorenzo", "link": "https://stackoverflow.com/users/2740693/christian-di-lorenzo"}, "edited": false, "score": 0, "creation_date": 1490283249, "post_id": 42015869, "comment_id": 73053063, "body": "@ChristianDiLorenzo my solution was a hack, but now there is a way. Will post it here in a moment"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "is_accepted": true, "score": 1, "last_activity_date": 1490284413, "last_edit_date": 1490284413, "creation_date": 1490283491, "answer_id": 42980667, "question_id": 42015869, "link": "https://stackoverflow.com/questions/42015869/custom-widget-for-email-login-in-yesod/42980667#42980667", "title": "Custom widget for email login in Yesod", "body": "<p>There was no way to achieve that at the moment, so I just wrote a bunch of hacky JS in <code>default-layout.julius</code> to modify the DOM on the fly whenever the right elements are found and adding CSS attributes as well.</p>\n\n<p>But now the <code>yesod-auth</code> package exports <code>emailLoginHandler</code> (<a href=\"https://www.stackage.org/haddock/lts-8.4/yesod-auth-1.4.17/Yesod-Auth-Email.html#v:emailLoginHandler\" rel=\"nofollow noreferrer\">here</a>) and <code>defaultEmailLoginHandler</code> as well so it's now easy to modify it just like the other default handlers in the module.</p>\n"}], "owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 42980667, "answer_count": 1, "score": 2, "last_activity_date": 1490284413, "creation_date": 1486089771, "question_id": 42015869, "link": "https://stackoverflow.com/questions/42015869/custom-widget-for-email-login-in-yesod", "title": "Custom widget for email login in Yesod", "body": "<p>I'm trying to define a custom widget (custom Cassius styles in particular) for the Email Login form. The Email Auth plugin expose default handlers for</p>\n\n<ul>\n<li>registerHandler</li>\n<li>forgotPasswordHandler</li>\n<li>setPasswordHandler</li>\n</ul>\n\n<p>(<a href=\"https://www.stackage.org/haddock/lts-7.18/yesod-auth-1.4.15/Yesod-Auth-Email.html#g:5\" rel=\"nofollow noreferrer\">https://www.stackage.org/haddock/lts-7.18/yesod-auth-1.4.15/Yesod-Auth-Email.html#g:5</a>)</p>\n\n<p>But there is no one for the login handler, which default widget seems to be defined in the non-exported function <code>emailLoginHandler</code> here: <a href=\"https://www.stackage.org/haddock/lts-7.18/yesod-auth-1.4.15/src/Yesod.Auth.Email.html#emailLoginHandler\" rel=\"nofollow noreferrer\">https://www.stackage.org/haddock/lts-7.18/yesod-auth-1.4.15/src/Yesod.Auth.Email.html#emailLoginHandler</a></p>\n\n<p>I'd like to have <code>login.hamlet</code> and <code>login.cassius</code> in <code>templates/</code>. How could I do that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1486086834, "post_id": 42015459, "comment_id": 71206124, "body": "<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:-33--33-\" rel=\"nofollow noreferrer\"><code>(!!) :: [a] -&gt; Int -&gt; a</code></a> takes a list and an index and returns the element of the list at the index."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1486087448, "post_id": 42015459, "comment_id": 71206251, "body": "Might be better written as <code>[x | (i, row) &lt;- zip [0..] m, (j, x) &lt;- zip [0..] row, even (i + j)]</code>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1486142491, "post_id": 42015459, "comment_id": 71233743, "body": "Please see the haskell tag <a href=\"http://stackoverflow.com/tags/haskell/info\">info section</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7054784, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4161a0f747ee190d8b675b34d8358d7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7054784", "link": "https://stackoverflow.com/users/7054784/user7054784"}, "edited": false, "score": 0, "creation_date": 1486087092, "post_id": 42015496, "comment_id": 71206177, "body": "I understood it Thanks :)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1486153472, "post_id": 42015496, "comment_id": 71239363, "body": "The prelude <code>!!</code> on that results page is the only one which is even remotely common, fwiw"}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 3, "last_activity_date": 1486086790, "last_edit_date": 1592644375, "creation_date": 1486086790, "answer_id": 42015496, "question_id": 42015459, "link": "https://stackoverflow.com/questions/42015459/haskell-operator-combination/42015496#42015496", "title": "Haskell !! operator combination", "body": "<p>It depends on what's imported. <a href=\"https://www.stackage.org/lts/hoogle?q=(!!)\" rel=\"nofollow noreferrer\">There are many functions named (!!)</a>.</p>\n<p>Most likely it refers to <a href=\"https://www.stackage.org/haddock/lts-7.18/base-4.9.0.0/Prelude.html#v:-33--33-\" rel=\"nofollow noreferrer\">the one in <code>Prelude</code></a>:</p>\n<blockquote>\n<p><code>(!!) :: [a] -&gt; Int -&gt; a</code></p>\n<p>List index (subscript) operator, starting from 0. It is an instance of the more general <a href=\"https://www.stackage.org/haddock/lts-7.18/base-4.9.0.0/Data-List.html#v:genericIndex\" rel=\"nofollow noreferrer\"><code>genericIndex</code></a>, which takes an index of any integral type.</p>\n</blockquote>\n<p>Some simple examples:</p>\n<ul>\n<li><code>&quot;abcde&quot; !! 2 == 'c'</code></li>\n<li><code>[&quot;zero&quot;, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;] !! 2 == &quot;two&quot;</code></li>\n<li><code>[0..99] !! 24 == 24</code></li>\n</ul>\n"}], "owner": {"reputation": 41, "user_id": 7054784, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4161a0f747ee190d8b675b34d8358d7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7054784", "link": "https://stackoverflow.com/users/7054784/user7054784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486086946, "creation_date": 1486086436, "last_edit_date": 1486086946, "question_id": 42015459, "link": "https://stackoverflow.com/questions/42015459/haskell-operator-combination", "title": "Haskell !! operator combination", "body": "<p>In the following code, what does <code>m!!i!!j</code> stand for? Any examples will be helpful.</p>\n\n<pre><code>matrixElements :: [[t]] -&gt; [t]\nmatrixElements m =\n   [m!!i!!j | i&lt;-[0..length m - 1],\n              j&lt;-[0..length(head m) - 1],\n              even(i + j)]\n\nmain = assertEqual [1,3,5,7,9] $ matrixElements [[1,2,3], [4,5,6], [7,8,9]]\n</code></pre>\n"}, {"tags": ["haskell", "luhn"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 2, "creation_date": 1486075126, "post_id": 42013519, "comment_id": 71202779, "body": "1. It would help if you gave your functions more descriptive names. It&#39;s very hard to tell what&#39;s going on here. 2. Before assuming the first part works based on a couple tests, I&#39;d do further testing before I move on. I&#39;ve wasted a lot of time excluding checking a piece of code for a bug because I thought I had thoroughly tested it... and hadn&#39;t."}, {"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486075426, "post_id": 42013519, "comment_id": 71202909, "body": "Sorry by the name of the functions. I had to translate to english many words and I forgot to translate the name of the functions too."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486075526, "post_id": 42013519, "comment_id": 71202946, "body": "Well, to be honest, I don&#39;t know what the Luhn algorithm is or how to implement it, but for anyone who can help you with it, you should try to make it as easy as possible for them."}, {"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486075696, "post_id": 42013519, "comment_id": 71203001, "body": "I want to say here again that I&#39;m almost sure that <code>luhn</code> is correct. Only I have to write better <code>sigLuhn</code>."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486075792, "post_id": 42013519, "comment_id": 71203039, "body": "OK, well, unfortunately, I can&#39;t help with that part. I&#39;d say start debugging by checking each helper function to ensure they&#39;re returning what you&#39;d expect."}], "answers": [{"comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486090692, "post_id": 42015740, "comment_id": 71207046, "body": "You should explain your changes. This is fairly vague as is."}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1486105692, "post_id": 42015740, "comment_id": 71211576, "body": "You have to know what the Luhn algorithm does. Given that, doubleAndSum sums the digits, doubling even digit from the right. If a doubled digit exceeds 9, those digits are summed also. myLuhn converts the input Int to a list of single-digit Ints, calls doubleAndSum on the list, and returns True or False depending on whether the sum mod10 is 0."}], "tags": [], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "is_accepted": false, "score": 1, "last_activity_date": 1486088720, "creation_date": 1486088720, "answer_id": 42015740, "question_id": 42013519, "link": "https://stackoverflow.com/questions/42013519/luhn-algorithm-in-haskell/42015740#42015740", "title": "Luhn algorithm in Haskell", "body": "<p>I assigned it in a class last fall. Here's one of the best solutions.</p>\n\n<pre><code>doubleAndSum :: [Int] -&gt; Int\ndoubleAndSum = fst . foldr (\\i (acc, even) -&gt; (acc + nextStep even i, not even)) (0,False)\n  where \n    nextStep even i\n        | even      = (uncurry (+) . (`divMod` 10) . (*2)) i\n        | otherwise = i \n\nmyLuhn :: Int -&gt; Bool\nmyLuhn = (0 ==) . (`mod` 10) . doubleAndSum . (map (read . (: \"\"))) . show\n\ntestCC :: [Bool]\ntestCC = map myLuhn [49927398716, 49927398717, 1234567812345678, 1234567812345670]\n-- =&gt; [True,False,False,True]\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486088720, "creation_date": 1486074524, "last_edit_date": 1486082563, "question_id": 42013519, "link": "https://stackoverflow.com/questions/42013519/luhn-algorithm-in-haskell", "title": "Luhn algorithm in Haskell", "body": "<p>I think I have computed <a href=\"https://en.wikipedia.org/wiki/Luhn_algorithm\" rel=\"nofollow noreferrer\">Luhn algorithm</a> correctly in Haskell:</p>\n\n<pre><code>f1 :: Integer -&gt; [Integer]\nf1 x = if x &lt; 10 then [x] else (f1 (div x 10))++[mod x 10]\n\nf2 :: [Integer] -&gt; [Integer]\nf2 xs = [(!!) xs (x - 1) | x &lt;- [1..(length xs)] , even x]\n\nf3 :: [Integer] -&gt; [Integer]\nf3 xs = if mod (length xs) 2 /= 0 then (f2 xs) else (f2 (0:xs))\n\nf4 :: [Integer] -&gt; [Integer]\nf4 xs = map (*2) (f3 xs)\n\nf5 :: [Integer] -&gt; [[Integer]]\nf5 xs = map f1 xs\n\nf6 :: [[Integer]] -&gt; [Integer]\nf6 [] = []\nf6 (xs : xss) = xs++(f6 xss)\n\nf7 :: [Integer] -&gt; [Integer]\nf7 xs = [(!!) xs (x - 1) | x &lt;- [1..(length xs)] , odd x]\n\nf8 :: [Integer] -&gt; [Integer]\nf8 xs = if mod (length xs) 2 /= 0 then (f7 xs) else (f7 (0:xs))\n\nf9 :: [Integer] -&gt; [Integer]\nf9 xs = (f8 xs) ++ (f4 xs)\n\nf :: Integer -&gt; Integer\nf x = sum (f6 (f5 (f9 xs)))\n   where xs = f1 x\n\nluhn :: Integer -&gt; Bool\nluhn x = if mod (f x) 10 == 0 then True else False\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>luhn 49927398716 ==&gt; True\nluhn 49927398717 ==&gt; False\n</code></pre>\n\n<p>Now I have to make a new function <code>sigLuhn</code> such that, given an integer <code>n</code>, with <code>luhn n == True</code>, then <code>sigLuhn n</code> gives the digit (or digits) such that if we add the digit to the final to <code>n</code>, then the new number verifies the Luhn algorithm too; if <code>luhn n == False</code> the function gives an error. For example,</p>\n\n<pre><code>sigLuhn 49927398716 ==&gt; [8]\n</code></pre>\n\n<p>because if we call <code>n = 49927398716</code> then</p>\n\n<pre><code>luhn (10*n + 8) ==&gt; True\n</code></pre>\n\n<p>being <code>8</code> the lowest integer from <code>0</code>. My thought is the next:</p>\n\n<pre><code>g1 :: Integer -&gt; Integer\ng1 x = div 10 x + 1\n\ng2 :: Integer -&gt; Integer -&gt; Integer\ng2 x y = x*(floor (10)^(g1 y)) + y\n\ng3 :: Integer -&gt; [Bool]\ng3 x = [luhn (g2 x y) | y &lt;- [1..]]\n\ng4 :: [Bool] -&gt; Int\ng4 xs = minimum (elemIndices True xs)\n\ng :: Integer -&gt; Int\ng x = g4 (g3 x)\n\nsigLuhn :: Integer -&gt; [Int]\nsigLuhn x = if (luhn x) then [g x] else error \"The conditions of Luhn's algorithm are not valid\"\n</code></pre>\n\n<p>The code doesn't give error but <code>sigLuhn</code> is not correct with this code. In short, if we assume that the function <code>luhn</code> is good, can you help me to write <code>sigLuhn</code> correctly? Thank you very much.</p>\n"}, {"tags": ["string", "haskell", "unicode", "utf-8"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1486083859, "post_id": 42013076, "comment_id": 71205400, "body": "I feel like your problem is a bit under-specified - which characters would you like to have printed in the form <code>\\...</code> and which characters would you like to be printed literally? Aside from that question, this is quite a simple problem."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1486095681, "post_id": 42013076, "comment_id": 71208238, "body": "honestly, your code seems like the best way. in the example you gave, you can elide the call to <code>packChars</code> if you turn on -XOverloadedStrings"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486115400, "post_id": 42013076, "comment_id": 71216710, "body": "@Alec Thank you for this remark. The <code>\\u...</code> characters come from a Javascript program. According to my understanding, it generates these characters from <code>\\u007F</code> to <code>\\uFFFF</code>. Concretely, I &quot;receive&quot; a string containing literal characters and such <code>\\u...</code> characters, and I want to replace the <code>\\u....</code> characters."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1486119648, "post_id": 42013076, "comment_id": 71219337, "body": "@haoformayor Surprising. This looks like killing a fly with a hammer :)"}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486146599, "post_id": 42028624, "comment_id": 71236016, "body": "<code>replicateA</code> exists... in <code>Control.Monad</code>... as <code>replicateM</code>. But its constraint is still <code>Applicative</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1486159428, "post_id": 42028624, "comment_id": 71241978, "body": "@Alec That&#39;s horrible. We have quite a bit of AMP fallout to clean up yet, it seems. Thanks for pointing it out."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1486162106, "post_id": 42028624, "comment_id": 71242929, "body": "Thank you Daniel. I&#39;ll try this week-end or next week. Please don&#39;t worry if I don&#39;t quickly upvote or accept the answer. This sounds very instructive."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1486138856, "creation_date": 1486138856, "answer_id": 42028624, "question_id": 42013076, "link": "https://stackoverflow.com/questions/42013076/convert-unescaped-unicode-to-utf8-integer/42028624#42028624", "title": "Convert unescaped unicode to utf8 integer", "body": "<p>Here's a nice simple parser written using <a href=\"http://hackage.haskell.org/package/regex-applicative\" rel=\"nofollow noreferrer\">regex-applicative</a>. First some imports and other nonsense that isn't worth reading:</p>\n\n<pre><code>import Data.Char\nimport Data.Maybe\nimport Numeric\nimport Text.Regex.Applicative\n\n-- no idea why this isn't in Control.Applicative\nreplicateA :: Applicative f =&gt; Int -&gt; f a -&gt; f [a]\nreplicateA n act = sequenceA (replicate n act)\n</code></pre>\n\n<p>Now, we want to parse an escaped character. We'll use a regex that matches characters and returns a character, so it's an <code>RE Char Char</code>. Ideally I'd write it this way:</p>\n\n<pre><code>escaped :: RE Char Char\nescaped = do\n    string \"\\\\u\"\n    digits &lt;- replicateM 4 (psym isHexDigit)\n    return . chr . fst . head . readHex $ digits\n</code></pre>\n\n<p>The <code>head</code> is safe because we've ensured that <code>readHex</code> will only be passed hex digits, and therefore will succeed. We can <em>almost</em> write it like that, except that <code>RE Char</code> is not a <code>Monad</code>. With newish GHC's you can probably turn on <code>ApplicativeDo</code> and be done with it, but it's not so bad to write in applicative style ourselves anyway and support all GHC's, so let's do that:</p>\n\n<pre><code>escaped :: RE Char Char\nescaped\n    =   chr . fst . head . readHex\n    &lt;$&gt; (string \"\\\\u\"\n     *&gt;  replicateA 4 (psym isHexDigit)\n        )\n</code></pre>\n\n<p>Anyway, once we have a regex for decoding a single escaped character, it's easy to produce a regex for decoding all the escaped characters and passing unescaped characters through unchanged: <code>many (escaped &lt;|&gt; anySym)</code>. Since this regex will always succeed, we can ignore the <code>Maybe</code>-ness of <code>(=~)</code> hedging its bets about whether an expression will match, and write</p>\n\n<pre><code>decodeHex :: String -&gt; String\ndecodeHex = fromJust . (=~ many (escaped &lt;|&gt; anySym))\n</code></pre>\n\n<p>Let's try it in ghci:</p>\n\n<pre><code>&gt; decodeHex \"\\\\u00b5ABC\"\n\"\\181ABC\"\n&gt; decodeHex \"\\\\u00bABC\"\n\"\\186BC\"\n&gt; decodeHex \"\\\\udefg\"\n\"\\\\udefg\"\n</code></pre>\n\n<p>The advantage of writing our own parser like this instead of relying on something like <code>decode</code> is that we gain control and confidence over exactly which transformations are being done; for example, since we know <code>\\u</code> will always be followed by <em>four</em> hex digits, we can only transform it when that happens, in case the original, pre-Javascript text contained <code>\\\\udefg</code> and we want that to appear in the final output, rather than <code>\\3567g</code>; and we don't have to worry that it is trying to de-escape other things that we don't want it to do; and we don't have to \"extra-escape\" our string before we hand it off, either, as you do with adding the extra quotes around it. And of course, the disadvantage is that we had to engineer it ourselves, and probably have less confidence in its correctness since it hasn't been battle-hardened by a thousand users!</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 42028624, "answer_count": 1, "score": 7, "last_activity_date": 1486138856, "creation_date": 1486072638, "last_edit_date": 1486128429, "question_id": 42013076, "link": "https://stackoverflow.com/questions/42013076/convert-unescaped-unicode-to-utf8-integer", "title": "Convert unescaped unicode to utf8 integer", "body": "<p>Firstly, I apologize if the terms \"unescaped unicode\" and \"utf8 integer\" are not correct; I don't really know what I'm talking about when I'm talking about encoding.</p>\n\n<p>As a concrete example, I would like to convert the string <code>\"\\\\u00b5ABC\"</code> to the string <code>\"\\181ABC\"</code> (<code>\\u00b5</code> and <code>\\181</code> correspond to <code>\u00b5</code>). By \"string\" I mean <code>String</code> or <code>Text</code>.</p>\n\n<p>I know how to achieve this by using a tortuous (and perhaps laughable) way:</p>\n\n<pre><code>import Data.Aeson (decode)\nimport Data.ByteString.Lazy (packChars)\nimport Data.Text (Text)\ndecode (packChars \"\\\"\\\\u00b5ABC\\\"\") :: Maybe Text\n</code></pre>\n\n<p>I am ready to bet there exists a more direct way...</p>\n\n<h2>Edit</h2>\n\n<p>Following @Alec's comment, I provide more context. In the background, there is a Javascript program that receives a character string and replaces the characters in this string by their unicode representation <code>\\\\uxxxx</code> <em>when this unicode representation is between <code>\\u007F</code> and <code>\\uFFFF</code></em>. </p>\n\n<p>On the Haskell side, I receive this new string, and I want to replace the <code>\\\\uxxxx</code> with their corresponding utf8 integer representations. </p>\n"}, {"tags": ["csv", "haskell", "text", "attoparsec"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1486083581, "post_id": 42012084, "comment_id": 71205340, "body": "The issue is that <code>field</code> accepts the empty string (due to <code>takeWhile</code>), so <code>sepBy1 field &quot;,&quot;</code> accepts the empty string (and &quot;,&quot; &quot;,,&quot; etc) , and <code>sepBy1 record eol</code> accepts &quot;&quot; &quot;\\n&quot; &quot;\\n\\n&quot; etc. If the empty string is actually a valid field(CSV is very general so this is really a design choice), then the &quot;wanted behaviour&quot; would be wrong as those actually are different tables! If it is not, you should fix <code>field</code> and you&#39;re done since <code>parseOnly</code> already ignores all trailing input which is not recognized."}], "owner": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1486068720, "creation_date": 1486068720, "question_id": 42012084, "link": "https://stackoverflow.com/questions/42012084/csv-parsing-issue-with-attoparsec", "title": "CSV Parsing Issue with Attoparsec", "body": "<p>Here is my code that does CSV parsing, using the <code>text</code> and <code>attoparsec</code>\nlibraries: </p>\n\n<pre><code>import qualified Data.Attoparsec.Text as A\nimport qualified Data.Text as T\n\n-- | Parse a field of a record.\nfield :: A.Parser T.Text -- ^ parser\nfield = fmap T.concat quoted &lt;|&gt; normal A.&lt;?&gt; \"field\"\n  where\n    normal  = A.takeWhile (A.notInClass \"\\n\\r,\\\"\")     A.&lt;?&gt; \"normal field\"\n    quoted  = A.char '\"' *&gt; many between &lt;* A.char '\"' A.&lt;?&gt; \"quoted field\"\n    between = A.takeWhile1 (/= '\"') &lt;|&gt; (A.string \"\\\"\\\"\" *&gt; pure \"\\\"\")\n\n\n-- | Parse a block of text into a CSV table.\ncomma :: T.Text                   -- ^ CSV text\n      -&gt; Either String [[T.Text]] -- ^ error | table\ncomma text\n  | T.null text = Right []\n  | otherwise   = A.parseOnly table text\n  where\n    table  = A.sepBy1 record A.endOfLine A.&lt;?&gt; \"table\"\n    record = A.sepBy1 field (A.char ',') A.&lt;?&gt; \"record\"\n</code></pre>\n\n<p>This works well for a variety of inputs but is not working in case that there\nis a trailing <code>\\n</code> at the end of the input.</p>\n\n<p>Current behaviour:</p>\n\n<pre><code>&gt; comma \"hello\\nworld\"\nRight [[\"hello\"],[\"world\"]]\n\n&gt; comma \"hello\\nworld\\n\"\nRight [[\"hello\"],[\"world\"],[\"\"]]\n</code></pre>\n\n<p>Wanted behaviour:</p>\n\n<pre><code>&gt; comma \"hello\\nworld\"\nRight [[\"hello\"],[\"world\"]]\n\n&gt; comma \"hello\\nworld\\n\"\nRight [[\"hello\"],[\"world\"]]\n</code></pre>\n\n<p>I have been trying to fix this issue but I ran out of idaes. I am almost\ncertain that it will have to be something with <code>A.endOfInput</code> as that is the\nsignificant anchor and the only \"bonus\" information we have. Any ideas on how\nto work that into the code?</p>\n\n<p>One possible idea is to look at the end of the string before running the\nAttoparsec parser and removing the last character (or two in case of <code>\\r\\n</code>)\nbut that seems to be a hacky solution that I would like avoid in my code.</p>\n\n<p>Full code of the library can be found here: <a href=\"https://github.com/lovasko/comma\" rel=\"nofollow noreferrer\">https://github.com/lovasko/comma</a></p>\n"}, {"tags": ["haskell", "path", "ghc", "cabal", "ghcjs"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1486069185, "post_id": 42011646, "comment_id": 71199806, "body": "Do you have <code>~&#47;.cabal&#47;bin</code> in your path? GHCjs should be there, I think."}], "answers": [{"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 0, "last_activity_date": 1486069354, "creation_date": 1486069354, "answer_id": 42012223, "question_id": 42011646, "link": "https://stackoverflow.com/questions/42011646/how-do-i-add-ghcjs-to-path/42012223#42012223", "title": "how do I add ghcjs to path?", "body": "<p><code>cabal</code> installs binaries in <code>$HOME/.cabal/bin</code> on Linux like systems. To add that to your path you can put</p>\n\n<pre><code>PATH=\"$PATH:$HOME/.cabal/bin\"\n</code></pre>\n\n<p>in your shells configuration file (which would be <code>~/.bashrc</code> if you're using Bash).</p>\n"}], "owner": {"reputation": 6238, "user_id": 737051, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4cbfcdd51d0ec56844b3540f62d06af3?s=128&d=identicon&r=PG", "display_name": "john mangual", "link": "https://stackoverflow.com/users/737051/john-mangual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 42012223, "answer_count": 1, "score": 0, "last_activity_date": 1486069354, "creation_date": 1486067038, "question_id": 42011646, "link": "https://stackoverflow.com/questions/42011646/how-do-i-add-ghcjs-to-path", "title": "how do I add ghcjs to path?", "body": "<p>In order to install <a href=\"https://github.com/ghcjs/ghcjs\" rel=\"nofollow noreferrer\">ghcjs</a> I upgraded to Ubuntu 16.04</p>\n\n<p>No problem with requirements.  <code>alex</code> and <code>happy</code> where automitcally installed.  Then:</p>\n\n<pre><code>$ git clone https://github.com/ghcjs/ghcjs.git\n$ cabal install ./ghcjs\n</code></pre>\n\n<p>However, I cannot call ghcjs from terminal.  Perhaps it's not in PATH?</p>\n\n<pre><code>$ ghcjs-boot --dev\nghcjs: command not found\n</code></pre>\n\n<p>How do I add to path?</p>\n"}, {"tags": ["selenium", "haskell", "selenium-webdriver", "scotty"], "answers": [{"tags": [], "owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "is_accepted": true, "score": 0, "last_activity_date": 1486195835, "creation_date": 1486195835, "answer_id": 42038068, "question_id": 42011525, "link": "https://stackoverflow.com/questions/42011525/how-to-combine-webdriver-and-scotty-monads/42038068#42038068", "title": "How to combine WebDriver and Scotty monads", "body": "<p>Kind guy <a href=\"https://www.reddit.com/user/ForTheFunctionGod\" rel=\"nofollow noreferrer\">ForTheFunctionGod</a> on reddit <a href=\"https://www.reddit.com/r/haskellquestions/comments/5rv2fc/how_to_combine_webdriver_and_scotty_monads/ddbbgvv/\" rel=\"nofollow noreferrer\">answered it</a>, here it is:</p>\n\n<p>There's your problem:</p>\n\n<pre><code>lift $ scottyT 3000 _ routes\n</code></pre>\n\n<p>Since the return type of <code>scottyT</code> is</p>\n\n<pre><code>MonadIO n =&gt; n\n</code></pre>\n\n<p>You don't need to lift it - it can fit into any monad that can perform IO actions. <code>WD</code> is such a monad - note its <code>MonadIO</code> instance. You'd only need to lift <code>scottyT</code> if its return type would be a simple <code>IO</code>.</p>\n\n<p>Type classes like <code>MonadIO</code>, <code>MonadState</code>, etc. mostly obviate the need to manually lift computations. Whereas you'd need to lift a function to type <code>IO Int</code> if you wanted to embed it into <code>StateT s IO Int</code>, you wouldn't need to lift a function of type <code>MonadIO m =&gt; m a</code>, because <code>StateT s IO</code> already is an instance of <code>MonadIO</code>, so <code>m</code> can be instantiated to it.</p>\n\n<p>As for the hole: it has to be of type</p>\n\n<pre><code>WD Response -&gt; IO Response\n</code></pre>\n\n<p>The only way to make this work is to use <code>runSession</code> or one of its friends. I don't know Selenium that well, but, presumably, you can re-use your already opened session's id:</p>\n\n<pre><code>runWD :: WDSession -&gt; WD a -&gt; IO a\n\nstartServer = startMyBrowser $ do\n   sessionID &lt;- getSession\n   scottyT 3000 (runWD sessionID) routes\n   stopMyBrowser\n</code></pre>\n\n<p>I haven't tried this out, but the types should check out. I hope it helps!</p>\n\n<hr>\n\n<p>It definitely did :).</p>\n"}], "owner": {"reputation": 3335, "user_id": 1017211, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/7vlEI.png?s=128&g=1", "display_name": "monnef", "link": "https://stackoverflow.com/users/1017211/monnef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 42038068, "answer_count": 1, "score": 0, "last_activity_date": 1486195835, "creation_date": 1486066559, "last_edit_date": 1486123574, "question_id": 42011525, "link": "https://stackoverflow.com/questions/42011525/how-to-combine-webdriver-and-scotty-monads", "title": "How to combine WebDriver and Scotty monads", "body": "<p>I am beginner, so please bear with me.</p>\n\n<p>I have a following code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Lib where\n\nimport           Control.Monad.IO.Class\nimport           Control.Monad.Trans.Class\nimport           Data.Monoid               ((&lt;&gt;))\nimport qualified Data.Text                 as T\nimport qualified Data.Text.Lazy            as TL\nimport           Test.WebDriver\n--import           Web.Scotty\nimport           Web.Scotty.Trans\n\nfirefoxConfig :: WDConfig\nfirefoxConfig = defaultConfig\n\nstartMyBrowser :: WD a -&gt; IO a\nstartMyBrowser = runSession firefoxConfig\n\nstopMyBrowser = closeSession\n\nsomeFunc :: WD String\nsomeFunc = do\n  openPage \"http://maslo.cz\"\n  captionElem &lt;- findElem (ByCSS \"h2\")\n  text &lt;- getText captionElem\n  return $ T.unpack text\n\nhelloAction :: ActionT TL.Text WD ()\nhelloAction = do\n  a &lt;- lift someFunc\n  text $ \"got this for you: \" &lt;&gt; TL.pack a\n\nroutes :: ScottyT TL.Text WD ()\nroutes = get \"/hello\" helloAction\n\nstartServer = startMyBrowser $ do\n  lift $ scottyT 3000 _ routes\n  stopMyBrowser\n</code></pre>\n\n<p>I am not sure if even those filled parts are right - it is supposed to start a Selenium session (<code>startMyBrowser</code>), spin up a web server (the <code>scottyT</code> part) and after web server stops it should end the Selenium session (<code>stopMyBrowser</code>).</p>\n\n<p>After fiddling with types I got to that code above and it seems that I only miss one piece - the hole.</p>\n\n<p>Please, if you make it working, try to explain your solution and/or add some links to more materials. I would love to understand those damned transformers.</p>\n\n<p>Edit 1:\nHere are the errors:</p>\n\n<pre><code>  \u2022 Couldn't match type \u2018t0 m0\u2019 with \u2018WD\u2019\n    Expected type: WD ()\n      Actual type: t0 m0 ()\n  \u2022 In a stmt of a 'do' block: lift $ scottyT 3000 _ routes\n    In the second argument of \u2018($)\u2019, namely\n      \u2018do { lift $ scottyT 3000 _ routes;\n            stopMyBrowser }\u2019\n    In the expression:\n      startMyBrowser\n      $ do { lift $ scottyT 3000 _ routes;\n             stopMyBrowser }\n\n\n  \u2022 Found hole:\n      _ :: WD wai-3.2.1.1:Network.Wai.Internal.Response\n           -&gt; IO wai-3.2.1.1:Network.Wai.Internal.Response\n  \u2022 In the second argument of \u2018scottyT\u2019, namely \u2018_\u2019\n    In the second argument of \u2018($)\u2019, namely \u2018scottyT 3000 _ routes\u2019\n    In a stmt of a 'do' block: lift $ scottyT 3000 _ routes\n  \u2022 Relevant bindings include\n      startServer :: IO () (bound at src/Lib.hs:37:1)\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1486063180, "post_id": 42010346, "comment_id": 71196550, "body": "Your second guard look wrong to me, if I understand your requirements properly. Moreover, I don&#39;t think you can rule out this case from the start, your function has to just run forever anyway."}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486063839, "post_id": 42010441, "comment_id": 71196911, "body": "But haskell gives me an error when I define <code>g</code>: Not in scope <code>fromJust</code> and also with <code>findIndex</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486063978, "post_id": 42010441, "comment_id": 71197004, "body": "@joseabp91: you should <code>import Data.List</code> and <code>import Data.Maybe</code>."}, {"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486064366, "post_id": 42010441, "comment_id": 71197261, "body": "I have written <code>import Data.List</code> and <code>import Data.Maybe</code> but why <code>g</code> doesn&#39;t take any argument in your definition?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 1, "creation_date": 1486064540, "post_id": 42010441, "comment_id": 71197352, "body": "because of <i>eta-reduction</i>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 1, "creation_date": 1486064817, "post_id": 42010441, "comment_id": 71197518, "body": "@joseabp91: <code>f x = g (h x)</code> is equivalent to: <code>f = g . h</code>,"}, {"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486064871, "post_id": 42010441, "comment_id": 71197547, "body": "I know but my error is very strange: &gt;     Couldn&#39;t match expected type <code>a -&gt; Maybe a1&#39; &gt;           against inferred type </code>Maybe Int&#39; &gt;    In the second argument of <code>(.)&#39;, namely </code>findIndex id xs&#39; &gt;    In the expression: fromJust . findIndex id xs &gt;    In the definition of `g&#39;: &gt;        g xs = fromJust . findIndex xs"}, {"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486064959, "post_id": 42010441, "comment_id": 71197603, "body": "Is there any more elementary way?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486064997, "post_id": 42010441, "comment_id": 71197623, "body": "@joseabp91: this is not strange, if you feed the argument explicitly, you either have to use brackets or <code>$</code>: <code>g xs = fromJust (findIndex xs)</code> or <code>g xs = fromJust $ findIndex xs</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486065048, "post_id": 42010441, "comment_id": 71197654, "body": "@joseabp91: actually using the dots is in my opinion a more elementary way."}, {"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486065268, "post_id": 42010441, "comment_id": 71197767, "body": "My program still does not work. I&#39;ll keep trying, thank you very much"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486070314, "post_id": 42010441, "comment_id": 71200410, "body": "@joseabp91: in case you want 1-indexed results, the answer is <code>g xs = (1+) $ fromJust $ findIndex id xs</code>. Sorry I forgot (well you forgot) the <code>id</code>."}, {"owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "edited": false, "score": 0, "creation_date": 1486076841, "post_id": 42010441, "comment_id": 71203424, "body": "I asked this by this questio I have created: <a href=\"http://stackoverflow.com/questions/42013519/luhn-algorithm-in-haskell\" title=\"luhn algorithm in haskell\">stackoverflow.com/questions/42013519/luhn-algorithm-in-haske&zwnj;&#8203;ll</a>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1486064050, "last_edit_date": 1486064050, "creation_date": 1486062677, "answer_id": 42010441, "question_id": 42010346, "link": "https://stackoverflow.com/questions/42010346/find-next-true-in-a-list-in-haskell/42010441#42010441", "title": "Find next true in a list in Haskell", "body": "<p>Probably the easiest way to do this is using <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:findIndex\" rel=\"nofollow noreferrer\"><code>findIndex :: (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int</code></a>:</p>\n\n<pre><code>import Data.List(findIndex)\nimport Data.Maybe(fromJust)\n\ng = fromJust . findIndex id\n</code></pre>\n\n<p>Here you thus use <code>id</code> as \"predicate\" such that <code>True</code> is accepted and <code>False</code> fails the test. Since in your question you state you know such element always exists, you can use <code>fromJust</code> to \"<em>chomp of the <code>Just</code></em>\" so to speak.</p>\n\n<p>In your examples you seem to use \"1-indexed\" lists, in that case you can define:</p>\n\n<pre><code>-- 1-indexed\nimport Data.List(findIndex)\nimport Data.Maybe(fromJust)\n\ng = (1+) . fromJust . findIndex id\n</code></pre>\n\n<p>In <code>ghci</code>:</p>\n\n<pre><code>Prelude Data.Maybe Data.List&gt; let g = (1+) . fromJust . findIndex id\nPrelude Data.Maybe Data.List&gt; g [False , False , False , False , True , False , True]\n5\nPrelude Data.Maybe Data.List&gt; g [False , True , True , False , False]\n2\nPrelude Data.Maybe Data.List&gt; g []\n*** Exception: Maybe.fromJust: Nothing\nPrelude Data.Maybe Data.List&gt; g [False,False]\n*** Exception: Maybe.fromJust: Nothing\n</code></pre>\n\n<p>A final note: it should be:</p>\n\n<pre><code>     | not (<b>or</b> xs) = error \"There is no True in your list\"</code></pre>\n\n<p>and not</p>\n\n<pre><code>     | not (<b>and</b> xs) = error \"There is no True in your list\"</code></pre>\n\n<p>since <code>and</code> is only <code>True</code> if <strong>all</strong> elements are <code>True</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1486063375, "creation_date": 1486063375, "answer_id": 42010645, "question_id": 42010346, "link": "https://stackoverflow.com/questions/42010346/find-next-true-in-a-list-in-haskell/42010645#42010645", "title": "Find next true in a list in Haskell", "body": "<p>another approach, without error handling</p>\n\n<pre><code>&gt; fst . head . filter snd . zip [1..]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 2, "last_activity_date": 1486069142, "creation_date": 1486069142, "answer_id": 42012178, "question_id": 42010346, "link": "https://stackoverflow.com/questions/42010346/find-next-true-in-a-list-in-haskell/42012178#42012178", "title": "Find next true in a list in Haskell", "body": "<p>I'd think that</p>\n\n<pre><code>(1+) . length . takeWhile not\n</code></pre>\n\n<p>should do that. You can leave out the <code>(1+)</code> if you go for 0 based indexes, that is, indexes that would work with <code>(!!)</code></p>\n"}], "owner": {"reputation": 225, "user_id": 7222740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f90d44093611c5fa4c8848ca59eea09?s=128&d=identicon&r=PG&f=1", "display_name": "joseabp91", "link": "https://stackoverflow.com/users/7222740/joseabp91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 42010441, "answer_count": 3, "score": 0, "last_activity_date": 1486069142, "creation_date": 1486062343, "last_edit_date": 1486063133, "question_id": 42010346, "link": "https://stackoverflow.com/questions/42010346/find-next-true-in-a-list-in-haskell", "title": "Find next true in a list in Haskell", "body": "<p>I have to find a function <code>g : [Bool] -&gt; Integer</code> such that <code>g</code> gives lowest ubication where <code>True</code> is in a list of booleans. For example,</p>\n\n<blockquote>\n<pre><code>g [False , False , False , False , True , False , True] ==&gt; 5\ng [False , True , True , False , False] ==&gt; 2\ng [] ==&gt; ***Exception: empty list\ng [False , False] ==&gt; ***Exception: There is no True in your list\n</code></pre>\n</blockquote>\n\n<p>I am not too interested in cases where the function takes <code>[]</code> or a list where there is no <code>True</code> because I am working on a program where the boolean list is infinite and it's proved that there always exist True. I think a beginning of the definition of the following:</p>\n\n<blockquote>\n<pre><code>g :: [Bool] -&gt; Integer\ng xs | xs == [] = error \"empty list\"\n     | not (and xs) = error \"There is no True in your list\"\n     | otherwise = ...\n</code></pre>\n</blockquote>\n\n<p>Can you help me to find <code>...</code>, please? Thank you very much.</p>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1486061910, "post_id": 42010057, "comment_id": 71195866, "body": "Unless the price of a pineapple/apple can change, none of these need even <code>State</code> - just filtering your list of products to get a count of all the apples or pineapples. Then it just comes down to arithmetic on those two numbers."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 0, "last_activity_date": 1486062825, "creation_date": 1486062825, "answer_id": 42010483, "question_id": 42010057, "link": "https://stackoverflow.com/questions/42010057/functional-programming-solution/42010483#42010483", "title": "Functional Programming Solution", "body": "<p>To do the second problem (for which the solution can be modified to solve the third problem) this can be solved pretty easily using recursion</p>\n\n<pre><code>totalPriceWithBuy2ApplesGet1HalfOff :: [Product] -&gt; Int\ntotalPriceWithBuy2ApplesGet1HalfOff = go 0\n    where\n        -- It doesn't matter how many apples you've seen, the total\n        -- price of 0 items is 0\n        go applesSeen [] = 0\n        -- If you've seen 2 apples already and the next product is\n        -- an Apple, give discount\n        go 2 (Product \"Apple\" price : products) =\n            price `div` 2 + go 0 products\n        -- If applesSeen is some other number and you encounter an apple,\n        -- add its price and increment applesSeen\n        go applesSeen (Product \"Apple\" price : products) =\n            price + go (applesSeen + 1) products\n        -- For any other product just add the price to the total and recurse\n        go applesSeen (Product _ price : products) =\n            price + go applesSeen products\n</code></pre>\n\n<p>This would work even when your apples aren't all the same price, although that'd be a really strange store to shop at.</p>\n"}], "owner": {"reputation": 1397, "user_id": 3975711, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756de1bfefa4329d2d23dd5975c24306?s=128&d=identicon&r=PG&f=1", "display_name": "Sergii Vorobei", "link": "https://stackoverflow.com/users/3975711/sergii-vorobei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486062825, "creation_date": 1486061338, "question_id": 42010057, "link": "https://stackoverflow.com/questions/42010057/functional-programming-solution", "title": "Functional Programming Solution", "body": "<p>I'm kind of newbie in FP and Haskell and trying to solve some trivial tasks. E.g we have array of products:</p>\n\n<pre><code>data Product = Product String Int\nlet apple = Product \"Apple\" 15\nlet pineapple = Product \"Pineapple\" 20\nlet products = [apple, pineapple]\n</code></pre>\n\n<p>The tasks:</p>\n\n<ul>\n<li>calculate total price of products (this is simple, e.g I can use foldl)</li>\n<li>calculate total price if every third apple has a discount 0.5</li>\n<li>calculate total price if the pineapple is free in case of buying each two apples.</li>\n</ul>\n\n<p>In traditional imperative programming this is quite simple, e.g I can use different calculation strategies for this.\nHow can I solve this in Haskell? Should I use State monad or there are other solutions? Could you please provide some algorithm steps or code?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1486057728, "post_id": 42008845, "comment_id": 71193623, "body": "The original looks pretty good to me. Simple and clear."}, {"owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "edited": false, "score": 4, "creation_date": 1486064555, "post_id": 42008845, "comment_id": 71197368, "body": "I would remove the <code>NoFile</code> constructor, and instead use <code>Maybe File</code> in the right places. <code>NoFile</code> is a very strange kind of <code>File</code>. Haskell isn&#39;t Java!"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1486065279, "post_id": 42008845, "comment_id": 71197774, "body": "Why do you need NoFile over Maybe?"}], "answers": [{"comments": [{"owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "edited": false, "score": 2, "creation_date": 1486059321, "post_id": 42009426, "comment_id": 71194503, "body": "You&#39;re trading one evil for another. In one case you have code duplication. In the other, you have annoying extra injections and projections."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "edited": false, "score": 1, "creation_date": 1486062144, "post_id": 42009426, "comment_id": 71196009, "body": "@pyon Pattern synonyms can simplify the needed injections/projections, at the cost of more boilerplate code in the definitions."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "edited": false, "score": 1, "creation_date": 1486062373, "post_id": 42009426, "comment_id": 71196134, "body": "@pyon you&#39;ll have to propose something you consider non-evil then; to me they are (without other context) all equally fine, and this whole discussion a little boring tbh. In addition to pattern synonyms: basic records, alternate records libraries like <code>lens</code>, <code>RecordWildCards</code>, view patterns, etc."}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 4, "last_activity_date": 1486062471, "last_edit_date": 1486062471, "creation_date": 1486059162, "answer_id": 42009426, "question_id": 42008845, "link": "https://stackoverflow.com/questions/42008845/embedding-inheriting-one-data-constructor-in-another/42009426#42009426", "title": "&quot;Embedding/inheriting&quot; one `data` constructor in another?", "body": "<p>All of the following are equivalent/isomorphic, as I think you've discovered:</p>\n\n<pre><code>data F = U | X A B | Y A B C\n\ndata F = U | X AB | Y AB C\ndata AB = AB A B\n\ndata F = U | X A B (Maybe C)\n</code></pre>\n\n<p>So the color of the bike shed really depends on the context (e.g. do you have use for an <code>AB</code> elsewhere?) and your own aesthetic preferences.</p>\n\n<p>It might clarify things and help you understand what you're doing to have some sense of <a href=\"http://chris-taylor.github.io/blog/2013/02/10/the-algebra-of-algebraic-data-types/\" rel=\"nofollow noreferrer\">the algebra of algebraic data types</a></p>\n\n<p>We call types like <code>Either</code> \"sum types\" and types like <code>(,)</code> \"product types\" and they are subject to the same kinds of transformations you're familiar with like factoring</p>\n\n<pre><code>f = 1 +            (a * b) + (a * b * c) \n  = 1 + ((a * b) * (  1    +          c))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": true, "score": 3, "last_activity_date": 1486119327, "last_edit_date": 1486119327, "creation_date": 1486090103, "answer_id": 42015937, "question_id": 42008845, "link": "https://stackoverflow.com/questions/42008845/embedding-inheriting-one-data-constructor-in-another/42015937#42015937", "title": "&quot;Embedding/inheriting&quot; one `data` constructor in another?", "body": "<p>As others have noted, the <code>NoFile</code> constructor is probably not necessary, but you can keep it if you want. If you feel your code is more readable and/or better understood with it, then I say keep it.</p>\n\n<p>Now the trick with combining the other two constructors is by hiding the <code>content</code> field. You were on the right track by parameterizing <code>File</code>, but that alone isn't enough since then we can have <code>File Foo</code>, <code>File Bar</code>, etc. Fortunately, GHC has some nifty ways to help us.</p>\n\n<p>I'll write out the code here and then explain how it works.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE DataKinds #-}\n\nimport Data.Void\n\ndata Desc = Info | Full\n\ntype family Content (a :: Desc) where\n  Content Full = String\n  Content    _ = Void\n\ndata File a = File\n  { path :: FilePath\n  , modTime :: UTCTime\n  , content :: Content a\n  }\n</code></pre>\n\n<p>There are a few things going on here. </p>\n\n<p>First, note that in the <code>File</code> record, the <code>content</code> field now has type <code>Content a</code> instead of just <code>a</code>. <code>Content</code> is a type family,  which is (in my opinion) a confusing name for type-level function. That is, the compiler replaces <code>Content a</code> with some other type based on what <code>a</code> is and how we've defined <code>Content</code>.</p>\n\n<p>We defined <code>Content Full</code> to be <code>String</code>, so that when we have a value <code>f1 :: File Full</code>, its content field will have a <code>String</code> value. On the other hand, <code>f2 :: File Info</code> will have a <code>content</code> field with type <code>Void</code> which has no values.  </p>\n\n<p>Cool right? But what's preventing us from having <code>File Foo</code> now? </p>\n\n<p>That's where <code>DataKinds</code> comes to the rescue. It \"promotes\" the data type <code>Desc</code> to a kind (the type of types in Haskell) and type constructors ,<code>Info</code> and <code>Full</code>, to types of kind <code>Desc</code> instead of merely values of type <code>Desc</code>.</p>\n\n<p>Notice in the declaration of <code>Content</code> that I have annotated <code>a</code>. It looks like a type annotation, but <code>a</code> is already a type. This is a kind annotation. It forces <code>a</code> to be something of kind <code>Desc</code> and the only types of kind <code>Desc</code> are <code>Info</code> and <code>Full</code>.</p>\n\n<p>By now you're probably totally sold on how awesome this is, but I should warn you there's no free lunch. In particular, this is a <em>compile</em>-time construction. Your single <code>File</code> type becomes two different types. This can cause other related logic (producers and consumers of <code>File</code> records) to become complicated. If your use case doesn't mix <code>File Info</code> records with <code>File Full</code> records, then this is the way to go. On the other hand, if you want to do something like have a list of <code>File</code> records which can be a mixture of both types, then you're better off just making the type of your <code>content</code> field <code>Maybe String</code>.</p>\n\n<p>Another thing is, how exactly do you make a <code>File Info</code> since there's no value of <code>Void</code> to use for the <code>content</code> field?  Well, technically it should be ok to use <code>undefined</code> or <code>error \"this should never happen\"</code> since it is (morally) impossible to have a function of type <code>Void -&gt; a</code>, but if that makes you feel uneasy (and it probably should), then just replace <code>Void</code> with <code>()</code>. Unit is almost as useless and doesn't require 'values' of bottom.</p>\n"}], "owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 42015937, "answer_count": 2, "score": 2, "last_activity_date": 1486119327, "creation_date": 1486057221, "question_id": 42008845, "link": "https://stackoverflow.com/questions/42008845/embedding-inheriting-one-data-constructor-in-another", "title": "&quot;Embedding/inheriting&quot; one `data` constructor in another?", "body": "<p>Consider the following fragment:</p>\n\n<pre><code>data File\n    = NoFile\n    | FileInfo {\n        path :: FilePath,\n        modTime :: Data.Time.Clock.UTCTime\n    }\n    | FileFull {\n        path :: FilePath,\n        modTime :: Data.Time.Clock.UTCTime,\n        content :: String\n    }\n    deriving Eq\n</code></pre>\n\n<p>That duplication is a bit of a \"wart\", though in this one-off instance not particularly painful. In order to further improve my understanding of Haskell's rich type system, what might be preferred \"clean\"/\"idiomatic\" approaches for refactoring <strong>other</strong> than <em>either</em> simply creating a separate <code>data</code> record type for the 2 duplicate fields (then replacing them with single fields of that new <code>data</code> type) <em>or</em> replacing the <code>FileFull</code> record notation with something like <code>| FileFull File String</code>, which wouldn't be quite clean either (as here one would only want <code>FileInfo</code> in there for example, not <code>NoFile</code>)?</p>\n\n<p>(Both these \"naive\" approaches would be somewhat intrusive/annoying with respect to having to then fix up many modules manually throughout the rest of the code-base here.)</p>\n\n<p>One thing I considered would be parameterizing like so:</p>\n\n<pre><code>data File a\n    = NoFile\n    | FileMaybeWithContent {\n        path :: FilePath,\n        modTime :: Data.Time.Clock.UTCTime\n        content :: a\n    }\n    deriving Eq\n</code></pre>\n\n<p>Then for those \"just info, not loaded\" contexts <code>a</code> would be <code>()</code>, otherwise <code>String</code>. Seems too general anyway, we want either <code>String</code> or nothing, leading us to <code>Maybe</code>, doing once again away with the <code>a</code> parameter.</p>\n\n<p>Of course we've been there before: <code>content</code> could just be done with <code>Maybe String</code> of course, then \"refactor any compile errors away\" and \"done\". That'll probably be the order of the day, but knowing Haskell and the many funky GHC extensions.. <em>who knows</em> just <em>what</em> exotic theoretic trick/axiom/law I've been missing, right?! See, the differently-named \"semantic insta-differentiator\" between a \"just meta-data info\" value and a \"file content with meta info\" value does work well throughout the rest of the code-base as far as eased comprehension.</p>\n\n<p>(And yes, I perhaps should have removed <code>NoFile</code> and used <code>Maybe File</code>s throughout, but then... not sure whether there's really a <em>solid</em> reason to do so and a different question altogether anyway..)</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1486060119, "post_id": 42008609, "comment_id": 71194889, "body": "Related: <a href=\"http://stackoverflow.com/q/12286315/2751851\"><i>When to use a type class, when to use a type</i></a> (though it is more about what are the <i>good</i> uses of type classes, I suspect you can find at least some of your answer if you read between the lines)."}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486108988, "post_id": 42008609, "comment_id": 71213025, "body": "@duplode should I delete this question? It&#39;s got quite a few close flags"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486141023, "post_id": 42008609, "comment_id": 71232914, "body": "Well, it is a broad question indeed, and it might be difficult to give it a comprehensive or conclusive answer (there are many ways to use classes to structure programs and libraries, and not everyone likes all of them). I considered closing your question as a duplicate of the one I linked to, but that might be a bit of a stretch. I wonder if there is a narrower question lying inside it that could net you an useful answer... So I would leave it here at least for a little longer, to see if we can e.g. narrow it down a bit or find a good duplicate -- @everyone: suggestions welcome!"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1486056506, "creation_date": 1486056506, "question_id": 42008609, "link": "https://stackoverflow.com/questions/42008609/what-are-the-common-uses-of-type-classes", "title": "What are the common uses of type classes?", "body": "<p>I'm going through type classes using <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">this</a> resource, I've come up with two uses:</p>\n\n<p>a) Enabling functions to take different types without having to redefine the function interface: </p>\n\n<pre><code>class MyClass a where   \n  myFunc :: a -&gt; Bool\n\ninstance MyClass Int where\n  myFunc 1 = False\n  myFunc x = intFunction x\n\ninstance MyClass String where \n  myFunc \"hello\" = False\n  myFunc y = stringFunction\n\nintFunction :: a -&gt; Bool\nintFunction i\n   | i &gt; 100 = True\n   | otherwise = False\n\nstringFunction :: a -&gt; Bool\nstringFunction s \n   | length s &gt; 10  = False\n   | otherwise = True\n</code></pre>\n\n<p>b) Importing functionality into polymorphic functions:</p>\n\n<pre><code>class Operator a b where\n  (^&amp;) :: a -&gt; b -&gt; Bool\n\ninstance Operator a b where\n  \"hello\" ^&amp; 0   = True\n  x ^&amp; y = False\n\nexampleFunc :: (Operator a b) =&gt; a -&gt; b -&gt; Bool\nexampleFunc e1 e2 = e1 ^&amp; e2\n</code></pre>\n\n<p>Questions:</p>\n\n<p>1) What are the other uses of type classes in Haskell?</p>\n\n<p>2) How are type classes generally used in large programs? </p>\n\n<p><strong>N.B Apologies if this is a very broad question, I'm just trying to get a feel as to how I can structure my programs around type classes</strong></p>\n"}, {"tags": ["haskell", "hakyll"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486048079, "post_id": 42004666, "comment_id": 71187248, "body": "Please edit your question to add enough explanation so that we don&#39;t have to guess what you are trying to do (&quot;making <code>ghc --make site.hs</code> work&quot; just isn&#39;t specific enough). If you are unsure about how to prepare and organise your question, consider having a look at recent questions with positive score in the <a href=\"https://stackoverflow.com/questions/tagged/haskell\">haskell</a> tag to see what works well here."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1486055008, "post_id": 42004666, "comment_id": 71191968, "body": "The issue is that <code>getMetadata</code> returns a type of <code>Metadata</code> which is an alias for an <code>aeson</code> <code>Object</code> which is an alias for <code>HashMap</code>, but there&#39;s an attempt to access the value using the <code>Map</code> <code>findWithDefault</code> instead of the appropriate <code>HashMap</code> lookup function (<code>lookupDefault</code>?)."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486061009, "post_id": 42004666, "comment_id": 71195374, "body": "@duplode I think the original question included the exact error message that was displayed, albeit formatted unpleasantly. I formatted things and included the relevant code snippet from the repository."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1486061489, "post_id": 42004666, "comment_id": 71195602, "body": "@ryachza The point is that the OP isn&#39;t supposed to simply paste raw output from their terminal with zero explanation or formatting and expect us to pick up the pieces. I&#39;m all for being patient with imperfect questions, but this is a bit much."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1486061646, "post_id": 42004666, "comment_id": 71195693, "body": "@duplode I guess I just struggled with the &quot;unclear what you&#39;re asking&quot; vote, since I found it to be perfectly clear what was being asked. I completely agree that some effort should have been made to format the question, but &quot;unclear what your asking&quot; and general advice to review other questions seems much less helpful than either directly addressing the formatting, or demonstrating how this question in particular could be improved."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1486062952, "post_id": 42004666, "comment_id": 71196455, "body": "@ryachza &quot;This piece of code somewhere in another site is broken, how to fix it?&quot; is not a proper question here. It is not clear at all without undue effort from the readers. The formatting is far less serious problem, and I wouldn&#39;t have voted to close just because of it. I wouldn&#39;t have voted to close as unclear if the OP had at least attempted to explain what is going on, or to pinpoint the relevant piece of code."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486065200, "post_id": 42004666, "comment_id": 71197733, "body": "@duplode &quot;I performed this sequence of actions, I don&#39;t understand the error message I&#39;m seeing&quot;. The fact that the code was on another site I&#39;ll admit was maybe not ideal but GitHub is common enough that it wasn&#39;t bad, and honestly I preferred that over potentially copying the 100+ lines and if the asker didn&#39;t understand the error linking to the repository allows readers to see the full context. For me (and you&#39;re of course welcome to feel differently), the <i>only</i> issue was the formatting (so I tried to correct it). I didn&#39;t even give anything else a second thought."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1486068242, "post_id": 42004666, "comment_id": 71199295, "body": "@ryachza GitHub isn&#39;t better. With 100+ lines, we ask the OP to trim it down (&quot;Your error says line 29. What is it in your code?&quot;). With everything on GitHub, we ask the OP to copy the key parts here so that the question stands on its own (cf. the &quot;Help others reproduce the problem&quot; section <a href=\"http://stackoverflow.com/help/how-to-ask\">here</a>). Before that, though, there has to be some explanation, so that visitors other than us three can land here and have a general idea of the issue immediately -- &quot;I&#39;m trying to build a Hakyll site, and I&#39;m getting this error from this piece of code.&quot;"}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486127781, "post_id": 42004666, "comment_id": 71224220, "body": "@duplode I suppose we can simply disagree. I would consider many of your points to be subjective, and the items where we agree there seems to be a difference in preference for method of response/education. The question appears to no longer be &quot;on hold&quot; so, until next time I guess."}, {"owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1486134353, "post_id": 42004666, "comment_id": 71228397, "body": "@ryachza, could u pls tell me concretely how should i modify site.hs?"}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1486136075, "post_id": 42004666, "comment_id": 71229644, "body": "@fisherman I think my earliest comment indicates a possible solution (use <code>lookupDefault</code> in <code>Data.HashMap</code>), but if there have been other API breaking changes you may encounter additional errors. I think the answer provided below provides another possibility - use an older version of Hakyll."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1486160049, "post_id": 42004666, "comment_id": 71242217, "body": "@ryachza We can agree to disagree. I should note, though, that my points are not subjective; they come straight from the site rules on what is expected of questions here. It&#39;s fine if you e.g. dislike the rules or think I&#39;m a pedant for insisting this much on them, but in any case I&#39;m not making stuff up."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486160541, "post_id": 42004666, "comment_id": 71242408, "body": "@fisherman Please take my comments here into account next time you ask a question. A little more care in preparing your question will lead to quicker replies and better answers, as well as making things easier for those trying to help you."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486262312, "post_id": 42004666, "comment_id": 71268763, "body": "@fisherman Replying to your comment to gallais&#39; answer: That&#39;s good to hear. <a href=\"http://stackoverflow.com/help/how-to-ask\">This page at the Help Center</a> has good advice on what you should include in your future questions."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1499617638, "post_id": 42004666, "comment_id": 76971018, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37801054/m-map-sudden-expected-type-error\">M.Map sudden expected type error</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1486161804, "post_id": 42025226, "comment_id": 71242841, "body": "The change to what <code>Metadata</code> is happened in <i>hakyll</i> 4.8.0.0. <i>aeson</i>&#39;s <code>Object</code> is involved because Hakyll now uses the <i>yaml</i> package to handle the YAML metadata, and that, in turn, is built upon the <i>aeson</i> infrastructure."}, {"owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486261530, "post_id": 42025226, "comment_id": 71268626, "body": "@duplode, ok,later i will describe my questions in detail.for the current question,could u ALSO pls tell me concretely how should i modify site.hs? THANK U VERY MUCH."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 3, "last_activity_date": 1486127731, "creation_date": 1486127731, "answer_id": 42025226, "question_id": 42004666, "link": "https://stackoverflow.com/questions/42004666/type-error-involving-hashmap-and-map-when-building-a-site/42025226#42025226", "title": "Type error involving HashMap and Map when building a site", "body": "<p>The problem here is that the representation of <code>Metadata</code> has changed since version <code>4.4.2.0</code> of hakyll (the lower bound in the <code>.cabal</code> of the project you're trying to build).</p>\n\n<p>In 4.4.2.0, <a href=\"https://hackage.haskell.org/package/hakyll-4.4.2.0/docs/Hakyll-Core-Metadata.html\" rel=\"nofollow noreferrer\"><code>Metadata</code> is a <code>Map String String</code></a></p>\n\n<p>In 4.9.5.0 (the latest), <a href=\"https://hackage.haskell.org/package/hakyll-4.9.5.0/docs/Hakyll-Core-Metadata.html#t:Metadata\" rel=\"nofollow noreferrer\"><code>Metadata</code> is an <code>Object</code></a>.</p>\n\n<p>You need to either use an older version of Hakyll (e.g. by adding an upper bound in the <code>.cabal</code> file ensuring that <code>Metadata</code>'s representation matches the one in version 4.4.2.0) or update the code to take into account the newer interface and bump the lower bound.</p>\n"}], "owner": {"reputation": 10341, "user_id": 2309581, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10436db746e1d57fbdb861fc4a155481?s=128&d=identicon&r=PG", "display_name": "fisherman", "link": "https://stackoverflow.com/users/2309581/fisherman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1496559749, "creation_date": 1486045365, "last_edit_date": 1496559749, "question_id": 42004666, "link": "https://stackoverflow.com/questions/42004666/type-error-involving-hashmap-and-map-when-building-a-site", "title": "Type error involving HashMap and Map when building a site", "body": "<p>I'm trying to build <a href=\"https://github.com/relrod/blog\" rel=\"nofollow noreferrer\">this Hakyll blog</a>. On trying to compile <code>site.hs</code>, the site-building program...</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>root@AR:/usr/local# git clone https://github.com/relrod/blog elrod.me\nroot@AR:/usr/local# cd elrod.me\nroot@AR:/usr/local/elrod.me# ghc --make site.hs\n</code></pre>\n\n<p>... I get the following type error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[1 of 1] Compiling Main ( site.hs, site.o ) site.hs:28:70: error:\n  Couldn't match type \u2018unordered-containers-0.2.7.2:Data.HashMap.Base.HashMap Data.Text.Internal.Text aeson-1.1.0.0:Data.Aeson.Types.Internal.Value\u2019 with \u2018M.Map [Char] a1\u2019\n  Expected type: M.Map [Char] a1\n    Actual type: Metadata\n\n  In the third argument of \u2018M.findWithDefault\u2019, namely \u2018metadata\u2019\n  In the expression: M.findWithDefault \"No title\" \"title\" metadata\n  In an equation for \u2018title\u2019: title = M.findWithDefault \"No title\" \"title\" metadata\n\n  Relevant bindings include title :: a1 (bound at site.hs:28:25)\n</code></pre>\n\n<p>How can I fix it? Below are the relevant parts of <code>site.hs</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\nimport qualified Data.Map as M\nimport Data.Monoid ((&lt;&gt;))\nimport Hakyll\nimport Text.Pandoc.Options (readerSmart)\n\nmain :: IO ()\nmain = hakyll $ do\n    -- etc.\n    match \"posts/*\" $ do\n        route $ setExtension \"html\"\n        compile $ do\n            let safetitle = field \"safetitle\" $ \\item -&gt; do\n                    metadata &lt;- getMetadata (itemIdentifier item)\n                    let title = M.findWithDefault \"No title\" \"title\" metadata\n                    return $ concatMap (\\x -&gt; if x == '\\'' then \"\\\\'\" else [x]) title\n            pandocCompilerWith defaultHakyllReaderOptions {readerSmart = False} defaultHakyllWriterOptions\n                &gt;&gt;= saveSnapshot \"content\"\n                &gt;&gt;= loadAndApplyTemplate \"templates/post.html\"    (postCtx tags &lt;&gt; safetitle)\n                &gt;&gt;= loadAndApplyTemplate \"templates/default.html\" defaultContext\n                &gt;&gt;= relativizeUrls\n   -- etc.\n</code></pre>\n"}, {"tags": ["haskell", "monads", "alternative-functor", "monadplus"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486045360, "post_id": 42004616, "comment_id": 71185266, "body": "You can use <code>[[]] Int</code> as lower monad."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1486046173, "post_id": 42004616, "comment_id": 71185859, "body": "@WillemVanOnsem No, because the expression <code>return s</code> doesn&#39;t contain any information about <code>sx</code>; simply providing a concrete return type doesn&#39;t help that."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486046309, "post_id": 42004616, "comment_id": 71185948, "body": "@chepner: yeah I know it will not behave differently for that specific monad. I only had the idea to solve the problem the other way around: give it a list of lists instead of a list of items."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486048584, "post_id": 42005081, "comment_id": 71187605, "body": "Waiting for votes to tell me if I&#39;m technically right, or just flat out wrong."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1486049173, "post_id": 42005081, "comment_id": 71188021, "body": "You are not technically right, but merely because the class in question is <code>MonadPlus</code>, which offers the workaround shown in marc&#39;s answer. That this is impossible in the general case is still a point worth making. I suggest editing your answer to make this subtlety clear and/or point towards marc&#39;s answer for the sake of contrast."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1486049660, "last_edit_date": 1495542813, "creation_date": 1486046497, "answer_id": 42005081, "question_id": 42004616, "link": "https://stackoverflow.com/questions/42004616/haskell-function-which-acts-differently-depending-on-the-monad-type/42005081#42005081", "title": "Haskell function which acts differently depending on the monad type", "body": "<p>In general, you can't do this, because the function cannot know which <code>Foo</code> instance will be used when the function is called, meaning it has no basis for deciding to return <code>return s</code> or <code>return (s:sx)</code>.</p>\n\n<p>In this particular case, there is a workaround (see <a href=\"https://stackoverflow.com/a/42005779/1126841\">@marc's answer</a>) when <code>Foo</code> is <code>MonadPlus</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1486048509, "post_id": 42005779, "comment_id": 71187552, "body": "Any unease/controversy about <code>MonadPlus</code> might be avoided by switching to <code>Alternative</code> and <code>asum</code>, if the <code>MonadPlus</code> constraint isn&#39;t a hard requirement for the OP."}], "tags": [], "owner": {"reputation": 5855, "user_id": 842658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7803680028e20c68aa8d54c935d681fb?s=128&d=identicon&r=PG", "display_name": "marc", "link": "https://stackoverflow.com/users/842658/marc"}, "is_accepted": true, "score": 5, "last_activity_date": 1486048311, "creation_date": 1486048311, "answer_id": 42005779, "question_id": 42004616, "link": "https://stackoverflow.com/questions/42004616/haskell-function-which-acts-differently-depending-on-the-monad-type/42005779#42005779", "title": "Haskell function which acts differently depending on the monad type", "body": "<p>In your particular use-case, you could take advantage of <code>msum</code>:</p>\n\n<pre><code>putInMonad :: MonadPlus m =&gt; [a] -&gt; m a\nputInMonad x = msum $ map return x\n</code></pre>\n\n<p>Then both examples will work:</p>\n\n<pre><code>% putInMonad [1,2,3,4] :: Maybe Int\nJust 1\n% putInMonad [1,2,3,4] :: [Int]\n[1,2,3,4]\n</code></pre>\n\n<p>Note however that <code>Maybe</code> is not exactly <code>MonadPlus</code>, since <code>mplus</code> there is not associative.</p>\n"}], "owner": {"reputation": 13, "user_id": 7506135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ac79d85f471def27f9d56573d5610c?s=128&d=identicon&r=PG&f=1", "display_name": "axyz", "link": "https://stackoverflow.com/users/7506135/axyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 42005779, "answer_count": 2, "score": 1, "last_activity_date": 1613796035, "creation_date": 1486045251, "last_edit_date": 1613796035, "question_id": 42004616, "link": "https://stackoverflow.com/questions/42004616/haskell-function-which-acts-differently-depending-on-the-monad-type", "title": "Haskell function which acts differently depending on the monad type", "body": "<p>I'm trying to implement a function which usually puts the first element of a list in a monad, but if the monad is a list it returns the whole list:</p>\n\n<pre><code>putInMonad :: MonadPlus m =&gt; [a] -&gt; m a\nputInMonad (s:sx) = return s\nputInMonad _ = mzero\n</code></pre>\n\n\n\n<pre><code>putInMonad [1,2,3] :: Maybe Int\n</code></pre>\n\n<p>Should return <code>Just 1</code>, and </p>\n\n<pre><code>putInMonad [1,2,3] :: [] Int\n</code></pre>\n\n<p>should return <code>[1,2,3]</code>.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1486050929, "post_id": 42004565, "comment_id": 71189238, "body": "What is the definition of the class <code>Lookup</code>?"}, {"owner": {"reputation": 1004, "user_id": 3088265, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/99c2e5db7086c4dc0a5bd9aada58f162?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Vock", "link": "https://stackoverflow.com/users/3088265/richard-vock"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1486051402, "post_id": 42004565, "comment_id": 71189591, "body": "@ReidBarton: I added in the end of the question."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1486056108, "post_id": 42004565, "comment_id": 71192621, "body": "If a <code>Matrix</code> contains an <code>Elem a b</code> constraint, then why do the operations on <code>Matrix</code> also need a <code>Elem a b</code> context?"}, {"owner": {"reputation": 1004, "user_id": 3088265, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/99c2e5db7086c4dc0a5bd9aada58f162?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Vock", "link": "https://stackoverflow.com/users/3088265/richard-vock"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1486119839, "post_id": 42004565, "comment_id": 71219456, "body": "That is a very good question. Just to be sure I double checked it and they indeed all have that constraint: <a href=\"https://hackage.haskell.org/package/eigen-2.1.6/docs/Data-Eigen-Matrix.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/eigen-2.1.6/docs/&hellip;</a>. Almost all functions are of the kind &quot;cast $ f $ unsafeIndex $ values&quot; where f is the operation and values is a (Storable.Vector b). Maybe cast is typewise underdetermined without the constraint in the function definition. As an example I will add the definition of unsafeCoeff to my question."}], "answers": [{"comments": [{"owner": {"reputation": 1004, "user_id": 3088265, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/99c2e5db7086c4dc0a5bd9aada58f162?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Vock", "link": "https://stackoverflow.com/users/3088265/richard-vock"}, "edited": false, "score": 0, "creation_date": 1486046336, "post_id": 42004732, "comment_id": 71185969, "body": "I should have pointed out that Matrix and Elem are part of the haskell-eigen library. I did heavily modify this library in order to factor out some statefulness, but changing these restrictions would amount to a complete rewrite of the library."}], "tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": false, "score": 0, "last_activity_date": 1486045535, "creation_date": 1486045535, "answer_id": 42004732, "question_id": 42004565, "link": "https://stackoverflow.com/questions/42004565/simplfying-kind-by-fixating-parameter/42004732#42004732", "title": "Simplfying kind by fixating parameter", "body": "<p>The compiler doesn't always suggest the right hint, but in this case, when it says <code>No instance for (Elem a (CType a))</code>, it really does mean that. You've given it the constraint <code>Elem a b</code>, where <code>b</code> is determined by the first argument to the function. However, you must be calling something that requires <code>b ~ CType a</code>. This is what the compiler can't figure out. You need to restrict the type of your function to <code>Matrix a (CType a) -&gt; some -&gt; other -&gt; params -&gt; result</code>, and change the constraint <code>Elem a b</code> to <code>Elem a (CType a)</code>. </p>\n\n<p>It might be convenient to define synonyms for these:</p>\n\n<pre><code>type CMatrix a = Matrix a (CType a)\ntype CElem = (Elem a (CType a)) -- requires -XConstraintSynonyms\n</code></pre>\n\n<p>An even better alternative might be to remove the functional dependency on <code>Elem</code>, if you always intend for <code>b ~ CType a</code>. Even if you don't want <code>b ~ CType a</code> always, you can still remove the functional dependency and make <code>CType</code> an associated type of <code>Elem</code>:</p>\n\n<pre><code>class (Num a, Cast a (ElemType a), Cast (ElemType a) a, Storable (ElemType a), Code (ElemType a)) =&gt; Elem a where\n  type ElemType a\n  ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1004, "user_id": 3088265, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/99c2e5db7086c4dc0a5bd9aada58f162?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Vock", "link": "https://stackoverflow.com/users/3088265/richard-vock"}, "edited": false, "score": 0, "creation_date": 1486120097, "post_id": 42008599, "comment_id": 71219616, "body": "That does work. Didn&#39;t even know I can pattern match on a constructor in an alias (if that is what is happening here). Where does one learn such trickery? All books I have found are just yet another explanation of monads... Works and improves my understanding, so accepted."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 2, "last_activity_date": 1486134746, "last_edit_date": 1486134746, "creation_date": 1486056478, "answer_id": 42008599, "question_id": 42004565, "link": "https://stackoverflow.com/questions/42004565/simplfying-kind-by-fixating-parameter/42008599#42008599", "title": "Simplfying kind by fixating parameter", "body": "<p>You should be able to write</p>\n\n<pre><code>type instance Key MatX = (Int, Int)\ninstance Lookup MatX where\n    lookup (i,j) (MatX m@(Matrix {})) = Just $ unsafeCoeff i j m\n</code></pre>\n\n<p>Pattern matching on the <code>Matrix</code> constructor brings the <code>Elem a b</code> constraint it contains into scope. (It's weird that the <code>eigen</code> library makes you do this though since it has to match on the <code>Matrix</code> constructor anyways.)</p>\n\n<hr>\n\n<p>Edited to add more explanation. The definition of <code>lookup</code> above is a shorter way to write</p>\n\n<pre><code>lookup (i,j) (MatX m) = case m of\n    Matrix _ _ _ -&gt; Just $ unsafeCoeff i j m\n</code></pre>\n\n<p>For pattern matching, see <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-580003.17\" rel=\"nofollow noreferrer\">section 3.17</a> of the Haskell Report. The pattern match on <code>Matrix</code> looks useless, since it doesn't bind any variables; but it does invisibly bind an <code>Elem</code> constraint, which is used in the call to <code>unsafeCoeff</code>.</p>\n"}], "owner": {"reputation": 1004, "user_id": 3088265, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/99c2e5db7086c4dc0a5bd9aada58f162?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Vock", "link": "https://stackoverflow.com/users/3088265/richard-vock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 42008599, "answer_count": 2, "score": 0, "last_activity_date": 1486134746, "creation_date": 1486045129, "last_edit_date": 1495539930, "question_id": 42004565, "link": "https://stackoverflow.com/questions/42004565/simplfying-kind-by-fixating-parameter", "title": "Simplfying kind by fixating parameter", "body": "<p>This is a follow-up to <a href=\"https://stackoverflow.com/questions/41981611/bind-type-parameter\" title=\"this question\">this question</a>, but the problem is slightly different in application and reason so I chose to ask a new question.</p>\n\n<p>Consider these definitions (<em>edit: These are part of an external library</em>):</p>\n\n<pre><code>class (Num a, Cast a b, Cast b a, Storable b, Code b) =&gt; Elem a b | a -&gt; b where\n\ndata Matrix a b where\n    Matrix :: Elem a b =&gt; !Int -&gt; !Int -&gt; !(Vector b) -&gt; Matrix a b\n\ninstance Elem Float CFloat where\ninstance Elem Double CDouble where\ninstance Elem (Complex Float) (CComplex CFloat) where\ninstance Elem (Complex Double) (CComplex CDouble) where\n</code></pre>\n\n<p>In other words a floating point matrix with underlying C type \"fixed\" by the functional dependency Elem.</p>\n\n<p>Now in order to implement some instances for certain container specific classes (in my specific case for the <a href=\"https://hackage.haskell.org/package/keys-3.11/docs/Data-Key.html#t:Lookup\" rel=\"nofollow noreferrer\" title=\"Lookup\">Lookup</a> class, but Ixed from lens might be another candidate) I need a Matrix type with one type parameter.</p>\n\n<p>I tried the following:</p>\n\n<pre><code>type family CType a where\n    CType Double = CDouble\n    CType Float = CFloat\n    CType (Complex Double) = (CComplex CDouble)\n    CType (Complex Float) = (CComplex CFloat)\n\n newtype MatX a = MatX { getMatX :: Matrix a (CType a) }\n</code></pre>\n\n<p>Note that I am not allowed to simply omit the \"b\" type in the newtype declaration so the type synonym serves as a means to fix the internal type.</p>\n\n<p>However, all functions on the Matrix type have types like</p>\n\n<pre><code>(Elem a b) =&gt; Matrix a b -&gt; some -&gt; other -&gt; params -&gt; result\n</code></pre>\n\n<p>As an example the unsafeCoeff function looks like this:</p>\n\n<pre><code>unsafeCoeff :: Elem a b =&gt; Int -&gt; Int -&gt; Matrix a b -&gt; a\nunsafeCoeff row col (Matrix rows _ vals) = cast $ Data.Vector.Storable.unsafeIndex vals $ col * rows + row\n</code></pre>\n\n<p>using this type MatX like for example:</p>\n\n<pre><code>instance Lookup MatX where\n    lookup (i,j) m = Just $ unsafeCoeff i j (getMatX m)\n</code></pre>\n\n<p>gives me the error \"No instance for (Elem a (CType a))\". Since I am not allowed to specify these instances (since type synonyms are not allowed in instance declarations) I am kind of stuck at this point. I see why the compiler cannot assume that Elem a (CType a) is indeed given, but I don't know how to specify this relation.</p>\n\n<p>Bonus:</p>\n\n<p>I also tried to just do this:</p>\n\n<pre><code>instance Lookup (Matrix a) where\n    lookup (i,j) m = Just $ unsafeCoeff i j m :: Maybe a\n</code></pre>\n\n<p>But then \"b\" is the element type of the container and the lookup function must return (the unspecified) b.</p>\n\n<p>Edit: For completeness sake the definition of Lookup from the link above:</p>\n\n<pre><code>type family Key f \n\nclass Lookup f where\n    lookup :: Key f -&gt; f a -&gt; Maybe a \n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 1354, "user_id": 3027554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a52e97f946b17d363caca57df2692b0?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Hegemann", "link": "https://stackoverflow.com/users/3027554/christoph-hegemann"}, "edited": false, "score": 1, "creation_date": 1486038724, "post_id": 42002091, "comment_id": 71180811, "body": "Does simply adding <code>_Just</code> in between help? I can&#39;t test it currently unfortunately."}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "reply_to_user": {"reputation": 1354, "user_id": 3027554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a52e97f946b17d363caca57df2692b0?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Hegemann", "link": "https://stackoverflow.com/users/3027554/christoph-hegemann"}, "edited": false, "score": 1, "creation_date": 1486039065, "post_id": 42002091, "comment_id": 71181051, "body": "Yeah. <code>(authorityL .&gt; _Just .&gt; authorityHostL .&gt; hostBSL)</code> works."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 1354, "user_id": 3027554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a52e97f946b17d363caca57df2692b0?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Hegemann", "link": "https://stackoverflow.com/users/3027554/christoph-hegemann"}, "edited": false, "score": 1, "creation_date": 1486049706, "post_id": 42002091, "comment_id": 71188413, "body": "@ChristophHegemann You should probably post that as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 1354, "user_id": 3027554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a52e97f946b17d363caca57df2692b0?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Hegemann", "link": "https://stackoverflow.com/users/3027554/christoph-hegemann"}, "is_accepted": true, "score": 0, "last_activity_date": 1486113804, "creation_date": 1486113804, "answer_id": 42020822, "question_id": 42002091, "link": "https://stackoverflow.com/questions/42002091/how-do-i-combine-lenses-which-contain-context/42020822#42020822", "title": "How do I combine lenses which contain context?", "body": "<p>You can add a <code>_Just</code> in between to only focus in on the successful results.</p>\n\n<pre><code>(authorityL . _Just . authorityHostL . hostBSL)\n</code></pre>\n\n<p>does the trick like it's said in the comments.</p>\n"}], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 42020822, "answer_count": 1, "score": 0, "last_activity_date": 1486113804, "creation_date": 1486037886, "question_id": 42002091, "link": "https://stackoverflow.com/questions/42002091/how-do-i-combine-lenses-which-contain-context", "title": "How do I combine lenses which contain context?", "body": "<p>I'm starting from <a href=\"https://hackage.haskell.org/package/uri-bytestring-0.2.2.1/docs/URI-ByteString.html#v:authorityL\" rel=\"nofollow noreferrer\"><code>authorityL</code></a> via <code>authorityHostL</code> to <code>hostBSL</code> - I know you can combine lenses via</p>\n\n<pre><code>(authorityL . authorityHostL . hostBSL)\n</code></pre>\n\n<p>but that fails with <code>Couldn't match type \u2018Authority\u2019 with \u2018Maybe Authority\u2019</code>. How do I properly deal with the <code>Maybe</code> here?</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 2, "creation_date": 1486026241, "post_id": 41997909, "comment_id": 71172504, "body": "The type of the Church-encoded booleans would be <code>forall a. a -&gt; a -&gt; a</code>. It cannot be specialised to either the type of your <code>t</code> or <code>f</code> but that&#39;s not surprising: their type leaks information about the boolean they represent."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1486026727, "creation_date": 1486026727, "answer_id": 41998173, "question_id": 41997909, "link": "https://stackoverflow.com/questions/41997909/type-synonym-for-lambda-based-church-booleans/41998173#41998173", "title": "Type synonym for lambda-based/church booleans", "body": "<p>Given that <a href=\"https://en.wikipedia.org/wiki/Church_encoding#Church_Booleans\">Church Booleans</a> basically either choose the first or the second parameter, and you want to use them in something like</p>\n\n<pre><code>if' :: Boolean -&gt; a -&gt; a -&gt; a\nif' b tval fval = b tval fval\n</code></pre>\n\n<p>such that</p>\n\n<pre><code>if' t 1 0 == 1\nif' f 1 0 == 0\n</code></pre>\n\n<p>you have to restrict the type to a single type variable <code>a</code>:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\ntype Boolean = forall a. a -&gt; a -&gt; a\n</code></pre>\n\n<p>Here's an <a href=\"http://statusfailed.com/blog/2014/09/23/church-booleans-in-haskell-and-morte.html\">article that covers Church Booleans in Haskell in detail</a>.</p>\n"}], "owner": {"reputation": 2259, "user_id": 1296709, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0889dc642429982e711f0077f794df70?s=128&d=identicon&r=PG", "display_name": "derabbink", "link": "https://stackoverflow.com/users/1296709/derabbink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 41998173, "answer_count": 1, "score": 4, "last_activity_date": 1486026988, "creation_date": 1486025915, "last_edit_date": 1486026988, "question_id": 41997909, "link": "https://stackoverflow.com/questions/41997909/type-synonym-for-lambda-based-church-booleans", "title": "Type synonym for lambda-based/church booleans", "body": "<p>Assume that true (<code>t</code>) and false (<code>f</code>) are defined as follows:</p>\n\n<pre><code>&gt; let t = \\x -&gt; \\_ -&gt; x\nt :: t1 -&gt; t -&gt; t1\n&gt; let f = \\_ -&gt; \\y -&gt; y\nf :: t1 -&gt; t -&gt; t\n</code></pre>\n\n<p>Is there a way to define a type synonym that can capture the type of both boolean values?</p>\n"}, {"tags": ["debugging", "haskell", "io", "monads", "seq"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1486012572, "post_id": 41994455, "comment_id": 71166146, "body": "Please see <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>. Most of your imports are irrelevant, here. <code>sillyIO</code> is defined nowhere. <code>sillyDebug = (trace (show x) False) `seq` (x + y)</code> doesn&#39;t even compile. And describe the problem you&#39;re facing. What did you expect? What do you get?"}, {"owner": {"reputation": 384, "user_id": 6246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/963512280411360/picture?type=large", "display_name": "Clite Tailor", "link": "https://stackoverflow.com/users/6246431/clite-tailor"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1486014622, "post_id": 41994455, "comment_id": 71166860, "body": "Sorry, it&#39;s my fault :3"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1486098307, "post_id": 41994455, "comment_id": 71208924, "body": "This problem is about the difference between <i>evaluating</i> an expression and <i>executing</i> a monadic action, but I think it\u2019s also worth making a note about <code>seq</code>. <code>a `seq` b</code> doesn\u2019t exactly force evaluation of <code>a</code>. It generates a dependency between thunks, so <i>if</i> <code>b</code> is evaluated, then <code>a</code> is too. <code>print (snd (x `seq` y, z))</code> never evaluates <code>x</code> because it never evaluates <code>y</code>."}, {"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1599915077, "post_id": 41994455, "comment_id": 112926345, "body": "Related: <a href=\"https://stackoverflow.com/questions/24775528/why-cant-haskell-be-tricked-into-performing-io-operations-by-using-strict-evalu\" title=\"why cant haskell be tricked into performing io operations by using strict evalu\">stackoverflow.com/questions/24775528/&hellip;</a> ."}], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 4, "last_activity_date": 1486012666, "creation_date": 1486012666, "answer_id": 41994672, "question_id": 41994455, "link": "https://stackoverflow.com/questions/41994455/use-seq-and-print-in-haskell/41994672#41994672", "title": "Use `seq` and print in haskell", "body": "<p>Merely evaluating some <code>IO</code> action doesn\u2019t do anything at all. You can think of <code>IO</code> sort of like a really big sum type of all the possible side-effectful things Haskell <em>can</em> do, even if it isn\u2019t actually implemented like that at all. Something like this:</p>\n\n<pre><code>data IO a where\n  PutStrLn :: String -&gt; IO ()\n  ReadFile :: FilePath -&gt; IO String\n  ExitWith :: ExitCode -&gt; IO a\n  ...\n</code></pre>\n\n<p>One of the <code>IO</code> constructors in this theoretical visualization would be a <code>Sequence</code> constructor, with a type signature like this:</p>\n\n<pre><code>  Sequence :: IO a -&gt; (a -&gt; IO b) -&gt; IO b\n</code></pre>\n\n<p>This constructor is used to implement <code>&gt;&gt;=</code> for the <code>IO</code> type.</p>\n\n<p>Inside of GHC is a magical function called <code>magicallyExecuteIO</code> with type <code>IO a -&gt; a</code>, which coordinates for each action to actually perform its corresponding side-effect. (Incidentally, this function is also sometimes pronounced <code>unsafePerformIO</code>.) GHC implicitly calls <code>magicallyExecuteIO</code> on the result of your program\u2019s <code>main</code> function, as well as on expressions written in GHCi.</p>\n\n<p>However, without using <code>magicallyExecuteIO</code>, evaluating one of the <code>IO</code> constructors like <code>PutStrLn</code> doesn\u2019t do anything. In this implementation, it would just work like any other data constructor:</p>\n\n<pre><code>ghci&gt; Just (PutStrLn \"hello!\")\nJust (PutStrLn \"hello!\") :: Maybe (IO ())\n</code></pre>\n\n<p>(I\u2019ve wrapped it with <code>Just</code> to prevent GHCi from running the <code>IO</code> action.)</p>\n\n<p>Of course, GHC\u2019s actual <code>IO</code> type isn\u2019t implemented this way, but that\u2019s really just an implementation detail. Evaluating an <code>IO a</code> value doesn\u2019t cause a side-effect to happen any more than evaluating a <code>Maybe a</code> value does. Only <code>magicallyExecuteIO</code> can do that.</p>\n"}], "owner": {"reputation": 384, "user_id": 6246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/963512280411360/picture?type=large", "display_name": "Clite Tailor", "link": "https://stackoverflow.com/users/6246431/clite-tailor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 41994672, "answer_count": 1, "score": 1, "last_activity_date": 1486094581, "creation_date": 1486011426, "last_edit_date": 1486094581, "question_id": 41994455, "link": "https://stackoverflow.com/questions/41994455/use-seq-and-print-in-haskell", "title": "Use `seq` and print in haskell", "body": "<p>I know that this is a little bit tricky but i wonder why it doesn't work!</p>\n\n<pre><code>module Main where\n\nsillyDebug :: Int -&gt; Int -&gt; Int\nsillyDebug x y =\n    (print x) `seq` (x + y)\n\nmain :: IO ()\nmain = do\n    print (sillyDebug 1 2)\n</code></pre>\n\n<p>while its ideal is the same as</p>\n\n<pre><code>sillyDebug = (trace (show x) False) `seq` (x + y)\n</code></pre>\n\n<p>Is it related to lazy evaluation or side effect in haskell?\n<a href=\"https://hackhands.com/lazy-evaluation-works-haskell/\" rel=\"nofollow noreferrer\">https://hackhands.com/lazy-evaluation-works-haskell/</a></p>\n"}, {"tags": ["list", "haskell", "types", "tuples"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1486038242, "post_id": 41994282, "comment_id": 71180511, "body": "If you change the type of <code>sumTotal</code> to <code>(Int,Int,Int) -&gt; Int</code>, then <code>maxTotal = maximum . fmap sumTriple</code>."}], "answers": [{"comments": [{"owner": {"reputation": 655, "user_id": 1132309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d020192063e77952151acc9a1125130b?s=128&d=identicon&r=PG", "display_name": "Fabien R", "link": "https://stackoverflow.com/users/1132309/fabien-r"}, "edited": false, "score": 0, "creation_date": 1486205794, "post_id": 41994376, "comment_id": 71252555, "body": "Your algorithm seems not clear. Why do you need <code>sumTriple</code> ?"}, {"owner": {"reputation": 65, "user_id": 2831896, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71b99ef86e639eaf77c295a4d3dc2599?s=128&d=identicon&r=PG&f=1", "display_name": "rafro4", "link": "https://stackoverflow.com/users/2831896/rafro4"}, "reply_to_user": {"reputation": 655, "user_id": 1132309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d020192063e77952151acc9a1125130b?s=128&d=identicon&r=PG", "display_name": "Fabien R", "link": "https://stackoverflow.com/users/1132309/fabien-r"}, "edited": false, "score": 0, "creation_date": 1486421442, "post_id": 41994376, "comment_id": 71328996, "body": "No need for it, I omitted it after I added the above line"}], "tags": [], "owner": {"reputation": 65, "user_id": 2831896, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71b99ef86e639eaf77c295a4d3dc2599?s=128&d=identicon&r=PG&f=1", "display_name": "rafro4", "link": "https://stackoverflow.com/users/2831896/rafro4"}, "is_accepted": false, "score": 1, "last_activity_date": 1486010879, "creation_date": 1486010879, "answer_id": 41994376, "question_id": 41994282, "link": "https://stackoverflow.com/questions/41994282/how-do-you-use-pattern-matching-with-lists-of-tuples-in-haskell/41994376#41994376", "title": "How do you use pattern matching with lists of tuples in Haskell?", "body": "<p>Turns out my definitions for maxTotal were incomplete. All I had to add was this:</p>\n\n<pre><code>maxTotal [(x,y,z)] = x + y + z\n</code></pre>\n\n<p>Case closed.</p>\n"}], "owner": {"reputation": 65, "user_id": 2831896, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71b99ef86e639eaf77c295a4d3dc2599?s=128&d=identicon&r=PG&f=1", "display_name": "rafro4", "link": "https://stackoverflow.com/users/2831896/rafro4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486010879, "creation_date": 1486010179, "question_id": 41994282, "link": "https://stackoverflow.com/questions/41994282/how-do-you-use-pattern-matching-with-lists-of-tuples-in-haskell", "title": "How do you use pattern matching with lists of tuples in Haskell?", "body": "<p>I've been trying to write a function that takes a list of tuples (in my case, three Int values within the tuple) and returns the maximum sum of any of the tuples in the list. </p>\n\n<p>This is my current attempt at doing so:</p>\n\n<pre><code>type Triples = [(Int, Int, Int)]\nmaxTotal :: Triples -&gt; Int\nmaxTotal [] = error \"ERROR: NO TUPLES\"\nmaxTotal ((x,y,z):rest)\n  | sumTriple x y z &gt; maxTotal rest = sumTriple x y z\n  | otherwise = maxTotal rest\n\nsumTriple :: Int -&gt; Int -&gt; Int -&gt; Int\nsumTriple x y z = x + y + z\n</code></pre>\n\n<p>However, every time I run this function, I end up with my error output... Is Haskell treating my input list of tuples as an empty list or am I cycling through to the end of the list in my \"otherwise\" guard then reaching the error?</p>\n"}, {"tags": ["haskell", "operators", "typeclass", "composition"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1486007647, "post_id": 41993701, "comment_id": 71164793, "body": "This is a fine question as it stands, but my curiosity overwhelms me: why have you been trying to implement that?"}, {"owner": {"reputation": 2050, "user_id": 3024983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/px3w6.jpg?s=128&g=1", "display_name": "Veritas", "link": "https://stackoverflow.com/users/3024983/veritas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1486007938, "post_id": 41993701, "comment_id": 71164865, "body": "@DanielWagner for educational reasons / fun"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1486041515, "post_id": 41993701, "comment_id": 71182632, "body": "You might compare with <code>f &lt;$&gt; g1 &lt;*&gt; g2 &lt;*&gt; ... &lt;*&gt; gn == \\x -&gt; f (g1 x) (g2 x) ... (gn x)</code>."}, {"owner": {"reputation": 2050, "user_id": 3024983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/px3w6.jpg?s=128&g=1", "display_name": "Veritas", "link": "https://stackoverflow.com/users/3024983/veritas"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486050973, "post_id": 41993701, "comment_id": 71189280, "body": "@chepner I am aware of the Applicative usage of functions but it requires <code>gi</code>s of same first argument type and the end result is a single argument function."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1486051187, "post_id": 41993701, "comment_id": 71189435, "body": "My point is that you have a similar, asymmetric requirement with the first function in the chain. <code>f &lt;$.$&gt; g &lt;$.$&gt; h</code> won&#39;t do what you want for the same reasons that <code>f &lt;*&gt; g &lt;*&gt; h</code> and <code>f &lt;$&gt; g &lt;*&gt; h</code> are different; your desired outcome is closer the latter than the former. I&#39;d describe your outcome as being more similar to a generalized <code>on</code> than a generalized composition."}, {"owner": {"reputation": 2050, "user_id": 3024983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/px3w6.jpg?s=128&g=1", "display_name": "Veritas", "link": "https://stackoverflow.com/users/3024983/veritas"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1486052243, "post_id": 41993701, "comment_id": 71190144, "body": "@chepner I am not sure that a generalized <code>on</code> is that similar, it already functions differently for two argument functions while the required operator acts as composition for single argument functions. As for requiring a different first operator, I thought that since I will /probably/ need language extensions I could overoad it&#39;s usage if needed - I guess this is c++ metaprogramming haunting me."}], "owner": {"reputation": 2050, "user_id": 3024983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/px3w6.jpg?s=128&g=1", "display_name": "Veritas", "link": "https://stackoverflow.com/users/3024983/veritas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486006095, "creation_date": 1486006095, "question_id": 41993701, "link": "https://stackoverflow.com/questions/41993701/haskell-generalized-composition", "title": "Haskell - Generalized Composition", "body": "<p>I've been trying to implement a generalized composition operator <code>&lt;$.$&gt;</code> such that:</p>\n\n<pre><code>f &lt;$.$&gt; g1 &lt;$.$&gt; g2 &lt;$.$&gt; .. &lt;$.$&gt; gn = \\x1 x2 .. xn -&gt; f (g1 x1) (g2 x2) .. (gn xn) \n</code></pre>\n\n<p>It /should/ be possible to implement this with type classes and some additional language extensions. My main idea was to make the operator mark each level so that the next operators will compose the appropriate arguments. </p>\n\n<p>Unfortunately I am getting stuck in the implementation details since I am not yet experienced with such abuse of type classes and I am not completely aware of which language extensions are required. Any help is appreciated!</p>\n"}]