[{"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1474502833, "post_id": 39628091, "comment_id": 66561974, "body": "Those types look pretty different to me - one of them&#39;s <code>a -&gt; a</code> and the other&#39;s <code>a -&gt; b</code>. Plus, type classes don&#39;t allow you to choose behaviour based on which instances are in scope - someone could add an instance later. It&#39;s all resolved at compile time"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1474534706, "post_id": 39628091, "comment_id": 66573475, "body": "This looks as an XY problem. Why do you need those two functions to share the same name?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1474507441, "last_edit_date": 1474507441, "creation_date": 1474503172, "answer_id": 39628330, "question_id": 39628091, "link": "https://stackoverflow.com/questions/39628091/defining-a-function-for-multiple-types/39628330#39628330", "title": "Defining a Function for Multiple Types", "body": "<p>With a typeclass.</p>\n\n<pre><code>class    TowardsZero a      where towardsZero :: Integral b =&gt; a -&gt; b\ninstance TowardsZero Int    where towardsZero = fromIntegral\ninstance TowardsZero Double where towardsZero = truncate\n-- and so on\n</code></pre>\n\n<p>Possibly a class with an associated type family constraint is closer to what you wrote (though perhaps not closer to what you had in mind):</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nimport GHC.Exts\n\nclass TowardsZero a where\n    type RetCon a b :: Constraint\n    towardsZero :: RetCon a b =&gt; a -&gt; b\n\ninstance TowardsZero Int where\n    type RetCon Int b = Int ~ b\n    towardsZero = id\n\ninstance TowardsZero Double where\n    type RetCon Double b = Integral b\n    towardsZero = truncate\n\n-- and so on\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1474503239, "post_id": 39628332, "comment_id": 66562091, "body": "That&#39;s pretty clever!"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1474503362, "post_id": 39628332, "comment_id": 66562112, "body": "You haven&#39;t really done anything... you still need to decide somewhere whether to construct a <code>T1</code> or a <code>T2</code>, and at that point you might as well decide whether to say <code>trunc</code> or <code>id</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1474503471, "post_id": 39628332, "comment_id": 66562144, "body": "@luqui I agree. It&#39;s not very idiomatic Haskell to try to dispatch runtime behaviour based on type class availability (which is how I&#39;m interpreting OP&#39;s question)"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1474503796, "last_edit_date": 1474503796, "creation_date": 1474503182, "answer_id": 39628332, "question_id": 39628091, "link": "https://stackoverflow.com/questions/39628091/defining-a-function-for-multiple-types/39628332#39628332", "title": "Defining a Function for Multiple Types", "body": "<p>I don't recommend this, but you can hack at it with a GADT:</p>\n\n<pre><code>data T a where\n    T1 :: a -&gt; T a\n    T2 :: RealFrac a =&gt; a -&gt; T b\n\nfunc :: Integral a =&gt; T a -&gt; a\nfunc (T1 x) = x\nfunc (T2 x) = truncate x\n</code></pre>\n\n<p>The <code>T</code> type says, \"Either you already know the type of the value I'm wrapping up, or it's some unknown instance of <code>RealFrac</code>\". The <code>T2</code> constructor existentially quantifies <code>a</code> and packs up a <code>RealFrac</code> dictionary, which we use in the second clause of <code>func</code> to convert from (unknown) <code>a</code> to <code>b</code>. Then, in <code>func</code>, I'm applying an <code>Integral</code> constraint to the <code>a</code> which may or may not be inside the <code>T</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1474503559, "post_id": 39628350, "comment_id": 66562157, "body": "&quot;I claim that whenever you would need the former rather than the latter signature, you already know enough to replace trunc by id in your source&quot; - this is the right answer. I was trying to articulate something along those lines in an edit to my answer but I needn&#39;t bother now :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1474507263, "post_id": 39628350, "comment_id": 66562841, "body": "I propose a solution for which <code>trunc (3 :: Int)</code> infers the type <code>Int</code> rather than <code>Integral b =&gt; b</code>, and for which <code>trunc (3 :: Double)</code> is still polymorphic over the <code>Integral</code> instance; you may like it."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1474507361, "post_id": 39628350, "comment_id": 66562865, "body": "@DanielWagner ah cool, that is nice, addresses the performance issue I was worried about."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1474503647, "last_edit_date": 1474503647, "creation_date": 1474503316, "answer_id": 39628350, "question_id": 39628091, "link": "https://stackoverflow.com/questions/39628091/defining-a-function-for-multiple-types/39628350#39628350", "title": "Defining a Function for Multiple Types", "body": "<p>This is known as <em>ad hoc polymorphism</em>, where you execute different code depending on the type.  The way this is done in Haskell is using typeclasses.  The most direct way is to define a new class</p>\n\n<pre><code>class Truncable a where\n    trunc :: Integral b =&gt; a -&gt; b\n</code></pre>\n\n<p>And then you can define several concrete instances.</p>\n\n<pre><code>instance Truncable Integer where trunc = fromInteger\ninstance Truncable Double where trunc = truncate\n</code></pre>\n\n<p>This is unsatisfying because it requires an instance for each concrete type, when there are really only two families of identical-looking instances.  Unfortunately, this is one of the cases where it is hard to reduce boilerplate, for technical reasons (being able to define \"instance families\" like this interferes with the open-world assumption of typeclasses, among other difficulties with type inference).  As a hint of the complexity, note that your definition assumes that there is no type that is both <code>RealFrac</code> and <code>Integral</code>, but this is not guaranteed -- which implementation should we pick in this case?</p>\n\n<p>There is another issue with this typeclass solution, which is that the <code>Integral</code> version doesn't have the type</p>\n\n<pre><code>trunc :: Integral a =&gt; a -&gt; a\n</code></pre>\n\n<p>as you specified, but rather</p>\n\n<pre><code>trunc :: (Integral a, Integral b) =&gt; a -&gt; b\n</code></pre>\n\n<p>Semantically this is not a problem, as I don't believe it is possible to end up with some polymorphic code where you don't know whether the type you are working with is <code>Integral</code>, but you do need to know that when it is, the result type is the same as the incoming type.  That is, I claim that whenever you would need the former rather than the latter signature, you already know enough to replace <code>trunc</code> by <code>id</code> in your source.  (It's a gut feeling though, and I would love to be proven wrong, seems like a fun puzzle)  </p>\n\n<p>There may be performance implications, however, since you might unnecessarily call <code>fromIntegral</code> to convert a type to itself, and I think the way around this is to use <a href=\"https://downloads.haskell.org/~ghc/7.0.1/docs/html/users_guide/rewrite-rules.html\" rel=\"nofollow\"><code>{-# RULES #-}</code> definitions</a>, which is a dark scary bag of complexity that I've never really dug into, so I don't know how hard or easy this is.</p>\n"}], "owner": {"reputation": 315, "user_id": 4175994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iLwio.jpg?s=128&g=1", "display_name": "IDon&#39;tUnderstandOOP", "link": "https://stackoverflow.com/users/4175994/idontunderstandoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2014, "favorite_count": 0, "accepted_answer_id": 39628330, "answer_count": 3, "score": 1, "last_activity_date": 1474507441, "creation_date": 1474501198, "question_id": 39628091, "link": "https://stackoverflow.com/questions/39628091/defining-a-function-for-multiple-types", "title": "Defining a Function for Multiple Types", "body": "<p>How is a function defined for different types in Haskell?\nGiven</p>\n\n<pre><code>func :: Integral a =&gt; a -&gt; a\nfunc x = x\nfunc' :: (RealFrac a , Integral b) =&gt; a -&gt; b\nfunc' x = truncate x\n</code></pre>\n\n<p>How could they be combined into one function with the signature</p>\n\n<pre><code>func ::  (SomeClassForBoth a, Integral b) =&gt; a -&gt; b\n</code></pre>\n"}, {"tags": ["haskell", "reflex"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1474481612, "post_id": 39623534, "comment_id": 66552855, "body": "<code>OverloadedString</code> ensures that a string literal has type <code>IsString a =&gt; a</code> instead of simply <code>String</code>. It doesn&#39;t directly affect the type signatures of functions that are already defined to work with <code>String</code> values."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1474482397, "post_id": 39623534, "comment_id": 66553253, "body": "I suspect the problem is that <code>show</code> returns a <code>String</code>; does <code>fmap (pack . show) $ _textInput_keypress t</code> work?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1474488600, "post_id": 39623534, "comment_id": 66556645, "body": "For Haskell experts but reflex non-experts: <a href=\"http://hackage.haskell.org/package/reflex-0.4.0/docs/Reflex-Dynamic.html#v:holdDyn\" rel=\"nofollow noreferrer\"><code>holdDyn :: MonadHold t m =&gt; a -&gt; Event t a -&gt; m (Dynamic t a)</code></a>."}, {"owner": {"reputation": 387, "user_id": 4472313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/xhNmO.jpg?s=128&g=1", "display_name": "Chandler Squires", "link": "https://stackoverflow.com/users/4472313/chandler-squires"}, "edited": false, "score": 2, "creation_date": 1474500130, "post_id": 39623534, "comment_id": 66561376, "body": "Changing <code>show</code> to <code>tshow</code>, where <code>tshow x = pack $ show x</code>, as per chepner&#39;s suggestion, worked for me"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1474504188, "post_id": 39623534, "comment_id": 66562288, "body": "@ChandlerSquires For engineering reasons I wouldn&#39;t use <code>pack . show</code> - you&#39;re paying the efficiency costs of using <code>String</code> <i>and</i> the complexity costs of using <code>Text</code>. As a rule <code>pack</code> should be avoided. Serialise your data to <code>Text</code> directly, using eg <a href=\"https://hackage.haskell.org/package/text-show\" rel=\"nofollow noreferrer\"><code>text-show</code></a>"}], "owner": {"reputation": 387, "user_id": 4472313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/xhNmO.jpg?s=128&g=1", "display_name": "Chandler Squires", "link": "https://stackoverflow.com/users/4472313/chandler-squires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474480864, "creation_date": 1474480864, "question_id": 39623534, "link": "https://stackoverflow.com/questions/39623534/haskell-reflex-type-error-on-strings", "title": "Haskell Reflex: type error on Strings", "body": "<p>I'm working through the reflex-frp examples on the github page and got stuck on the Dynamics and Events section. I try to use ghcjs to compile the following code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Reflex\nimport Reflex.Dom\n\nmain = mainWidget $ el \"div\" $ do\n    t &lt;- textInput def\n    text \"Last key pressed: \"\n    let keypressEvent = fmap show $ _textInput_keypress t\n    keypressDyn &lt;- holdDyn \"None\" keypressEvent\n    dynText keypressDyn\n</code></pre>\n\n<p>but I get the error</p>\n\n<pre><code>eventTest.hs:11:13: error:\n    \u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Data.Text.Internal.Text\u2019\n      Expected type: Dynamic\n                       (SpiderTimeline Global) Data.Text.Internal.Text\n        Actual type: Dynamic (SpiderTimeline Global) String\n</code></pre>\n\n<p>I understand that the String should be parsed instead as Data.Text.Internal.Text, but don't know how to make this happen - I thought the OverloadedStrings statement at the top was supposed to resolve this issue. Does anybody know how to fix this error?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474470150, "post_id": 39620043, "comment_id": 66546151, "body": "This is not a good <code>Ord</code> instance, since different values will compare as equal even if they differ in the <code>Coordinate</code> field. Also, how is <code>Empty</code> supposed to compare?"}, {"owner": {"reputation": 563, "user_id": 154755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8011979162518805b3bb4364fc27f88?s=128&d=identicon&r=PG", "display_name": "davorb", "link": "https://stackoverflow.com/users/154755/davorb"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474471551, "post_id": 39620043, "comment_id": 66547087, "body": "@leftroundabout yes, you&#39;ve made me realize that <code>Ord</code> really isn&#39;t what I&#39;m after. It feels like in Haskell, you spend a lot of time trying to work around the type system, only to realize that you should have been listening to it instead."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474472499, "post_id": 39620043, "comment_id": 66547720, "body": "You might consider defining a new type for your <code>Ord</code> instance, rather defining it directly on <code>Cell</code> (much like there is no <code>Monoid</code> instance for any numeric type, but rather separate instances for <code>Product</code> and <code>Sum</code> types)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1474474313, "post_id": 39620043, "comment_id": 66548875, "body": "@chepner: possible, but I daresay it&#39;s better to not define any <code>Ord</code> instance at all but simply work with helpers like <code>comparing</code> if e.g. sorting of some <code>Cell</code>s is needed."}], "answers": [{"tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": true, "score": 4, "last_activity_date": 1474470025, "creation_date": 1474470025, "answer_id": 39620137, "question_id": 39620043, "link": "https://stackoverflow.com/questions/39620043/haskell-instance-ord-difficulties/39620137#39620137", "title": "Haskell instance Ord difficulties", "body": "<p>You could define an auxiliary function:</p>\n\n<pre><code>extractInt :: Cell -&gt; Int\nextractInt (FromLeft _ x) = x\nextractInt (FromTop _ x) = x\nextractInt (FromDiagonal _ x) = x\nextractInt Empty = ???\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>instance Ord Cell where\n  compare c1 c2 = compare (extractInt c1) (extractInt c2)\n</code></pre>\n\n<p><strong>But be carefull</strong>: The above instance violates the antisymmetry law that states that if <code>x&lt;=y</code> and <code>y&lt;=x</code> then <code>x==y</code>. So it is not really defining an order but rather a preorder.</p>\n"}], "owner": {"reputation": 563, "user_id": 154755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8011979162518805b3bb4364fc27f88?s=128&d=identicon&r=PG", "display_name": "davorb", "link": "https://stackoverflow.com/users/154755/davorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 39620137, "answer_count": 1, "score": 0, "last_activity_date": 1474470025, "creation_date": 1474469838, "question_id": 39620043, "link": "https://stackoverflow.com/questions/39620043/haskell-instance-ord-difficulties", "title": "Haskell instance Ord difficulties", "body": "<p>I have a type that looks like this, and I would like the <code>compare</code> function to only take into account the size of the integer.</p>\n\n<pre><code>data Cell = FromLeft Coordinate Int\n          | FromTop Coordinate Int\n          | FromDiagonal Coordinate Int\n          | Empty Coordinate\n  deriving (Eq, Read, Show)\n</code></pre>\n\n<p>The following code works, but I would prefer something more elegant</p>\n\n<pre><code>instance Ord Cell where\n  compare (FromLeft _ x) (FromLeft _ y) = compare x y\n  compare (FromRight _ x) (FromLeft _ y) = compare x y\n  [...]\n</code></pre>\n"}, {"tags": ["haskell", "generic-programming"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1474469636, "post_id": 39619805, "comment_id": 66545788, "body": "The first class expects its &quot;argument&quot; <code>f</code> to have kind <code>* -&gt; *</code> (since it uses it as <code>f a</code>) but your class argument <code>a</code> (of <code>GDefault</code>) expects only a type (so kind <code>*</code>), but you are still feeding it something of kind <code>* -&gt; *</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474472451, "post_id": 39619805, "comment_id": 66547682, "body": "It&#39;s very unclear what this question is asking - the typechecker <i>told</i> you why the latter code doe not compile! Even if your &quot;problem comes down to this&quot; perhaps you should describe the actual problem."}, {"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1474474827, "post_id": 39619805, "comment_id": 66549181, "body": "I feel quite dumb, it&#39;s actually what Alec suggests..."}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 3, "last_activity_date": 1474496431, "last_edit_date": 1474496431, "creation_date": 1474490737, "answer_id": 39626286, "question_id": 39619805, "link": "https://stackoverflow.com/questions/39619805/rep-type-in-ghc-generics/39626286#39626286", "title": "Rep type in GHC Generics", "body": "\n\n<p>The compiler error here is helpful, but only in that annoying way where it tells you exactly what is wrong but not <em>why</em> it is wrong.</p>\n\n<blockquote>\n  <p>Expected a type but \"Rep a\" has kind \"* -> *\".</p>\n</blockquote>\n\n<p>So the problem here is that <code>Rep</code> (a type family) needs two arguments (call them <code>a</code> and <code>p</code>, as in <code>Rep a p</code>); it as a type-level function maps these two type arguments into the \"generic\" type. For example,</p>\n\n<pre><code>data Empty deriving Generic\n\ninstance Generic Empty where\n  type Rep Empty =\n    D1 ('MetaData \"Empty\" \"Main\" \"package-name\" 'False) V1\n\n-- taken from https://hackage.haskell.org/package/base-4.9.0.0/docs/GHC-Generics.htm\n</code></pre>\n\n<ul>\n<li><p><code>a</code>, e.g. <code>Empty</code>, represents the type from which we are genericizing.</p></li>\n<li><p><code>p</code> is a dummy type so that we can reuse our representation types for higher-level types (<a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/GHC-Generics.html\" rel=\"nofollow\">see <code>Generic1</code> in the documentation</a>).</p></li>\n</ul>\n\n<p>So, in the above example, <code>Rep Empty p</code> would simplify to <code>D1 ('MetaData ...) V1 p</code>.</p>\n\n<p>We can usually ignore <code>p</code> except when it comes to defining new typeclasses that take advantage of generics. We <em>want</em> to pattern match on on types like <code>D1 ('MetaData ...) V1 p</code> but we need some way of handling the extra parameter.</p>\n\n<p>A trick then is to treat <code>D1 ('MetaData ...) V1</code> like a higher-level type (like a functor). This is our <code>f</code> in <code>GDefault</code>.</p>\n\n<pre><code>class GDefault f where\n  gdef :: f a\n</code></pre>\n\n<p>Yes <code>a</code> will always be this stupid parameter that we will never use, but in return for line noise we get the ability to pattern match on the <code>f</code> in our instances. Here are four instances that allow for automatic generic <code>def</code> implementations for product types (<code>:*:</code> being a lifted tuple):</p>\n\n<pre><code>instance GDefault U1 where\n  gdef = U1\n\ninstance Default a =&gt; GDefault (K1 i a) where\n  gdef = K1 def\n\ninstance (GDefault a, GDefault b) =&gt; GDefault (a :*: b) where\n  gdef = gdef :*: gdef\n\ninstance GDefault a =&gt; GDefault (M1 i c a) where\n  gdef = M1 gdef\n</code></pre>\n\n<p>This, along with some sensible defaults for the numeric tower, will let us define datatypes like <code>data Foo = Foo Int Char Float deriving (Show, Generic)</code> and evaluate <code>show (def :: Foo)</code> to <code>\"Foo 0 0 0.0\"</code>.</p>\n\n<p>Your code had <code>gdef :: a</code>, which is the wrong kind. We want <code>gdef :: f a</code> because the typeclass is defined on types with kind <code>* -&gt; *</code>, hence the error message.</p>\n\n<p>And to take advantage of this helper class, we do much as you did:</p>\n\n<pre><code>class Default a where\n  def :: a\n\n  default def :: (Generic a, GDefault (Rep a)) =&gt; a\n  def = to gdef\n</code></pre>\n\n<p><code>to :: Rep a x -&gt; a</code> introduces a spurious <code>x</code>, which unifies with our <code>gdef :: f a</code> to produce <code>f ~ Rep a</code>, throwing away the <code>x</code> and being exactly what we intended.</p>\n\n<p><a href=\"https://github.com/mauke/data-default/blob/master/data-default-class/Data/Default/Class.hs\" rel=\"nofollow\">You can see this approach elaborated in the <code>data-default</code> package.</a></p>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 39626286, "answer_count": 1, "score": 1, "last_activity_date": 1474496431, "creation_date": 1474469123, "question_id": 39619805, "link": "https://stackoverflow.com/questions/39619805/rep-type-in-ghc-generics", "title": "Rep type in GHC Generics", "body": "<p>I am trying to build a <code>Default</code> class that automagically knows how to create default values. So I read the <a href=\"https://wiki.haskell.org/GHC.Generics\" rel=\"nofollow\">relevan wiki page</a> and my problem comes down to this: Why does this typecheck:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DefaultSignatures #-}\n\nimport GHC.Generics\n\n-- From https://wiki.haskell.org/GHC.Generics (sort of)\nclass GSerialize f where\n  gput :: f a -&gt; [Int]\nclass Serialize a where\n  put :: a -&gt; [Int]\n  default put :: (Generic a, GSerialize (Rep a)) =&gt; a -&gt; [Int]\n  put a = gput (from a)\n</code></pre>\n\n<p>But this doesn't</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE DefaultSignatures #-}\n\nimport GHC.Generics\n\nclass GDefault a where\n  gdef :: a\nclass Default a where\n  def :: a\n  default def :: (Generic a, GDefault (Rep a)) =&gt; a\n  def = gdef . from\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>\u2022 Expecting one more argument to \u2018Rep a\u2019\n  Expected a type, but \u2018Rep a\u2019 has kind \u2018* -&gt; *\u2019\n\u2022 In the first argument of \u2018GDefault\u2019, namely \u2018Rep a\u2019\n  In the type signature:\n    def :: (Generic a, GDefault (Rep a)) =&gt; a\n  In the class declaration for \u2018Default\u2019\n</code></pre>\n"}, {"tags": ["list", "haskell", "list-comprehension", "product"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6857949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7e6af79e59c5cd8efa3347eaebc076?s=128&d=identicon&r=PG&f=1", "display_name": "EL-", "link": "https://stackoverflow.com/users/6857949/el"}, "edited": false, "score": 0, "creation_date": 1474461926, "post_id": 39614885, "comment_id": 66540275, "body": "Thank you , it worked. It was much less complicated than I thought. How would you write it more efficiently? Maybe like this? :                                              power :: Integer -&gt; Integer -&gt; Integer      power n k | k &lt; 0 = error &quot;power: negative argument&quot;      power n 0 = 1      power n k = n * power n (k-1)"}, {"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "reply_to_user": {"reputation": 15, "user_id": 6857949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7e6af79e59c5cd8efa3347eaebc076?s=128&d=identicon&r=PG&f=1", "display_name": "EL-", "link": "https://stackoverflow.com/users/6857949/el"}, "edited": false, "score": 1, "creation_date": 1474462056, "post_id": 39614885, "comment_id": 66540374, "body": "Look at how <code>^</code> is <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/GHC.Real.html#%5E\" rel=\"nofollow noreferrer\">defined</a> in <code>base</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 15, "user_id": 6857949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7e6af79e59c5cd8efa3347eaebc076?s=128&d=identicon&r=PG&f=1", "display_name": "EL-", "link": "https://stackoverflow.com/users/6857949/el"}, "edited": false, "score": 3, "creation_date": 1474465868, "post_id": 39614885, "comment_id": 66543089, "body": "@EL- There are better algorithms around. E.g. you can exploit <code>pow a (2*n) = pow (a*a) n</code> and <code>pow a (2*n+1) = a * pow (a*a) n</code> to obtain an algorithm that only performs <code>log n</code> operations instead of <code>n</code>. For large <code>n</code>, this is much more efficient."}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": true, "score": 2, "last_activity_date": 1474458322, "last_edit_date": 1474458322, "creation_date": 1474456166, "answer_id": 39614885, "question_id": 39614842, "link": "https://stackoverflow.com/questions/39614842/how-do-i-calculate-a-power-function-by-constructing-a-list-with-k-elements-all/39614885#39614885", "title": "How do I calculate a power function by constructing a list with k elements, all being n, and then using the function product", "body": "<p>Here's a way to do it with list comprehensions:</p>\n\n<pre><code>power1 n k = product [n | _ &lt;- [1 .. k]]\n</code></pre>\n\n<p>Note though, that both this way and the one you wrote are not very efficient.</p>\n"}], "owner": {"reputation": 15, "user_id": 6857949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7e6af79e59c5cd8efa3347eaebc076?s=128&d=identicon&r=PG&f=1", "display_name": "EL-", "link": "https://stackoverflow.com/users/6857949/el"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 39614885, "answer_count": 1, "score": 1, "last_activity_date": 1474458322, "creation_date": 1474456026, "question_id": 39614842, "link": "https://stackoverflow.com/questions/39614842/how-do-i-calculate-a-power-function-by-constructing-a-list-with-k-elements-all", "title": "How do I calculate a power function by constructing a list with k elements, all being n, and then using the function product", "body": "<p>I have succeeded with one method:</p>\n\n<pre><code>power1 :: Integer -&gt; Integer -&gt; Integer\npower1 n k | k &lt; 0 = error \"power not defined for negative exponent\"\n           | otherwise = product (replicate (fromInteger k) n)\n</code></pre>\n\n<p>But how do you do it with a list comprehension inside a function? I have tried to solve it for hours but I can't quite comprehend it.</p>\n\n<pre><code>power1 :: Integer -&gt; Integer -&gt; Integer\npower1 n k=product\n</code></pre>\n"}, {"tags": ["haskell", "monads", "do-notation"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474478970, "post_id": 39614816, "comment_id": 66551462, "body": "with lambda-case it is equivalent to <code>let f = (\\case pattern -&gt; do { act2; ... ; actN } ; _ -&gt; fail &quot;...&quot;) in act1 &gt;&gt;= f</code>."}], "answers": [{"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 7, "creation_date": 1474457092, "post_id": 39615106, "comment_id": 66537038, "body": "&quot;Remember, that&#39;s a let \u2026 in\u2026 expression, not do&#39;s let&quot; A do&#39;s let wouldn&#39;t be any different in this regard though."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1474456759, "creation_date": 1474456759, "answer_id": 39615106, "question_id": 39614816, "link": "https://stackoverflow.com/questions/39614816/monadic-desugaring-haskell/39615106#39615106", "title": "monadic desugaring haskell", "body": "<blockquote>\n  <p>I am having trouble understanding is how you can have two pattern matching cases in a let clause? </p>\n</blockquote>\n\n<p>Well, you can:</p>\n\n<pre><code>example :: Int -&gt; Int\nexample n = \n  let f 0 = 1\n      f x = x * f (x - 1)\n  in  f n\n</code></pre>\n\n<p>Remember, that's a <code>let \u2026 in\u2026</code> expression, not <code>do</code>'s <code>let</code>. And for all bindings in such an expression, (almost) the same rules as for your usual top-level expressions hold, e.g. you can use pattern matching.</p>\n\n<p>Maybe it gets a little bit easier if you transform it to <code>where</code>:</p>\n\n<pre><code>example :: Int -&gt; Int\nexample n = f n\n  where            \n      f 0 = 1\n      f x = x * f (x - 1)\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 5738619, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/489ffbc19dae2212663f027806a6a95f?s=128&d=identicon&r=PG&f=1", "display_name": "Zubair", "link": "https://stackoverflow.com/users/5738619/zubair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 39615106, "answer_count": 1, "score": 1, "last_activity_date": 1474456759, "creation_date": 1474455949, "question_id": 39614816, "link": "https://stackoverflow.com/questions/39614816/monadic-desugaring-haskell", "title": "monadic desugaring haskell", "body": "<p>Reading the chapter on monads in real world Haskell. I came across the desugaring of the do notation, specifically when we have something like <code>pattern &lt;- action</code>.</p>\n\n<pre><code>-- file: ch14/Do.hs\ndoNotation3 =\n  do pattern &lt;- act1\n     act2\n     {- ... etc. -}\n     actN\n</code></pre>\n\n<p>The above example is desugared into:</p>\n\n<pre><code>-- file: ch14/Do.hs\ntranslated3 =\n  let f pattern = do act2\n                   {- ... etc. -}\n                   actN\n      f _     = fail \"...\"\n      in act1 &gt;&gt;= f\n</code></pre>\n\n<p>I am having trouble understanding is how you can have two pattern matching cases in a let clause? </p>\n\n<p>I don't understand how you can have <code>f pattern</code> and <code>f _</code> in the same let clause. I tried looking up if you can have multiple pattern matches in a let clause, but from what I have seen, most people use a case statement to do that.</p>\n\n<p>I would like some help in understanding what is actually going on here?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1474451690, "post_id": 39613098, "comment_id": 66533402, "body": "If <code>resized</code> has type <code>Either CV.CvException (M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D])</code> you&#39;re saying <code>resizeImage</code> returns an <code>Either e (Either CV.CvException (M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D]))</code>? Or does <code>resizeImage</code> return an <code>Either CV.CvException (M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D])</code>? In that case <code>resized</code> is a <code>(M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D])</code>"}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1474451935, "post_id": 39613098, "comment_id": 66533578, "body": "@Lee Thank you for your answer. <code>resizeImage</code> returns an <code>Either CV.CvException (M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D])</code>. But, as you can see in the error message, resized is an <code>Either CV.CvException (M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D])</code> Isn&#39;t it?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1474452184, "post_id": 39613098, "comment_id": 66533754, "body": "If you have an expression <code>x</code> of type <code>Either e a</code> then within <code>do</code> notation, in <code>v &lt;- x</code>, <code>v</code> has type <code>a</code>. So that means <code>resized</code> has type <code>M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D]</code> and you don&#39;t need to use <code>getImageFromEither</code>. Does it work if you use <code>newImage &lt;- resizeImage copy</code>?"}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1474452599, "post_id": 39613098, "comment_id": 66534042, "body": "@Lee Nope, I got this error <code>Couldn&#39;t match expected type \u2018M.Mat shape0 channels0 depth0\u2019 with actual type \u2018Either CV.CvException (M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D]) channels depth)\u2019</code> . It means that <code>resized</code> isn&#39;t <code>M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D]) channels depth</code> :("}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1474453001, "post_id": 39613098, "comment_id": 66534297, "body": "@Lee But if I do this: <code>case resized of Left cvError -&gt; print (&quot;nope&quot;) Right image -&gt; do putStrLn (show (getHandW image))</code>. It works, but I need it in a function an get <code>image</code> back (getHanW returns the image shape, it was just an example.)"}], "answers": [{"comments": [{"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1474454560, "post_id": 39614075, "comment_id": 66535332, "body": "Thank you! It works perfectly. Just a thing. I would like to use the second way, but it doesn&#39;t work for me as I need <i>return newImage</i> at some time. When I write <code>Right newImage -&gt; do</code> and then <code>return newImage</code>, it says <code>Couldn&#39;t match expected type \u2018IO ()\u2019 with actual type \u2018M.Mat (&#39;CV.S &#39;[&#39;CV.D, &#39;CV.D]) channels depth\u2019</code> So, how could I return <i>newImage</i> ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1474454766, "post_id": 39614075, "comment_id": 66535484, "body": "<code>return newImage</code> looks correct... are you sure you declared <code>cropImage</code> to return <code>IO (M.Mat ...)</code> and not <code>IO ()</code> ? I wonder why the expected type is <code>IO ()</code> there according to the error."}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1474455114, "post_id": 39614075, "comment_id": 66535732, "body": "I can <code>return newImage</code> if I write <code>let newImage = ...</code> but I can&#39;t return it if I write it inside the <code>case ... of... </code> I don&#39;t know why."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1474455276, "post_id": 39614075, "comment_id": 66535842, "body": "Can you post your new code snippet somewhere? It&#39;s hard to tell otherwise."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 1, "creation_date": 1474455406, "post_id": 39614075, "comment_id": 66535920, "body": "@ChuckAguilar My best guess is that you are accidentally returning <code>IO ()</code> in the <code>Left</code> branch, and both branches must have the same type. The compiler complains that the second does not match the first, while it&#39;s actually the first one which does not match the second. (Wild guessing here...)"}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1474455821, "post_id": 39614075, "comment_id": 66536208, "body": "Here&#39;s the code. [code](<a href=\"http://www.tutorialspoint.com/compile_haskell_online.php?PID=0Bw_CjBb95KQMWXNER050VVZzS0k\" rel=\"nofollow noreferrer\">tutorialspoint.com/&hellip;</a> )"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1474461797, "post_id": 39614075, "comment_id": 66540164, "body": "Indeed both branches must return something (of the same type). So either in the first branch you use something like <code>error</code>, or you have to return the error to the caller. The latter means that the return type is not <code>IO M.Mat</code> but something like <code>IO (Maybe M.Mat)</code> or <code>IO (Either ...)</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1474454268, "last_edit_date": 1474454268, "creation_date": 1474453905, "answer_id": 39614075, "question_id": 39613098, "link": "https://stackoverflow.com/questions/39613098/troubles-with-either-in-haskell/39614075#39614075", "title": "Troubles with &#39;Either&#39; in haskell", "body": "<p>You likely want </p>\n\n<pre><code>cropImage image = do\n    resized  &lt;- resizeImage copy        \n    let newImage = getImageFromEither resized\n    ...\n</code></pre>\n\n<p>Remember that <code>&lt;-</code> is used to run monadic actions, and <code>let .. = ..</code> is used to define pure values. Here, <code>getImageFromEither</code> has not a monadic return type -- it does not perform any action in the monad, it is a plain, regular function.</p>\n\n<p>Also consider the possibility of handling both cases explicitly:</p>\n\n<pre><code>cropImage image = do\n    resized  &lt;- resizeImage copy\n    case resized of\n      Left err -&gt; error (\"resize failed: \" ++ show err)\n      Right newImage -&gt; do\n         ...\n</code></pre>\n\n<p>This also allows you to handle the error more gracefully, e.g. by reporting it to the user. Using <code>error</code> or a partial function like your <code>getImageFromEither</code> is not generally considered good style. Handling errors by crashing is convenient in the short term, but eventually you'll likely want that error to be handled properly.</p>\n"}], "owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 39614075, "answer_count": 1, "score": 0, "last_activity_date": 1474454268, "creation_date": 1474451370, "question_id": 39613098, "link": "https://stackoverflow.com/questions/39613098/troubles-with-either-in-haskell", "title": "Troubles with &#39;Either&#39; in haskell", "body": "<p>I'm trying to use 'Either' in Haskell to get the <em>right</em> value. It is usually easy to do, but I'm getting an error, and I don't know what I'm doing wrong. </p>\n\n<p>What I want to do is this: </p>\n\n<pre><code> cropImage image = do\n    resized  &lt;- resizeImage copy        \n    newImage &lt;- getImageFromEither resized\n    ...\n</code></pre>\n\n<p>where <code>resized</code> is defined as: </p>\n\n<p><code>resized :: Either CV.CvException (M.Mat ('CV.S '['CV.D, 'CV.D]) channels depth)</code></p>\n\n<p>And I want to get <code>M.Mat ('CV.S '['CV.D, 'CV.D]) channels depth</code></p>\n\n<p>to do it, I use this function:</p>\n\n<pre><code>getImageFromEither eitherImage = fromRight eitherImage\n</code></pre>\n\n<p>and: </p>\n\n<pre><code>fromRight :: Either a b -&gt; b\nfromRight (Left _)  = error \"fromRight: Argument takes form 'Left _'\"\nfromRight (Right x) = x\n</code></pre>\n\n<p>And I thought it should work. But I get this error: </p>\n\n<pre><code>    Couldn't match kind \u2018*\u2019 with \u2018CV.DS *'\n    When matching types\n      m :: * -&gt; *\n      M.Mat ('CV.S '['CV.D, 'CV.D]) channels :: CV.DS * -&gt; *\n    Expected type: Either CV.CvException (m t0)\n      Actual type: Either\n                     CV.CvException (M.Mat ('CV.S '['CV.D, 'CV.D]) channels depth)\n    Relevant bindings include\n      resized :: Either\n                   CV.CvException (M.Mat ('CV.S '['CV.D, 'CV.D]) channels depth)\n        (bound at src/CropImage.hs:25:9)\n      copy :: M.Mat ('CV.S '[height, width]) channels depth\n        (bound at src/CropImage.hs:32:17)\n      image :: M.Mat ('CV.S '[height, width]) channels depth\n        (bound at src/CropImage.hs:24:11)\n      cropImage :: M.Mat ('CV.S '[height, width]) channels depth\n                   -&gt; m (Either\n                           CV.CvException (M.Mat ('CV.S '['CV.D, 'CV.D]) channels depth))\n        (bound at src/CropImage.hs:24:1)\n    In the first argument of \u2018getImageFromEither\u2019, namely \u2018resized\u2019\n    In a stmt of a 'do' block: newImage &lt;- getImageFromEither resized\n</code></pre>\n\n<p>I don't have an idea what's wrong. I see the code right, but I'm blind with the error. </p>\n"}, {"tags": ["haskell", "smallcheck"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474477392, "post_id": 39608262, "comment_id": 66550670, "body": "My understanding of smallcheck is that it (tries to) exhaustively search the entire domain in some &#39;fair&#39; manner. Any value which can be produced by <code>auxShB</code> should also eventually be in the <code>series</code> for <code>Shape</code>. If you want to observe examples with specific properties, you have to write a different <code>Series</code> which only generates things with that property. I believe that there are duplicates because <code>auxTriplet</code> is not an injection (and therefore, neither is <code>auxShB</code>). Consider writing your <code>Shape</code> type to be correct by construction."}], "owner": {"reputation": 799, "user_id": 1964881, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/bVDPU.png?s=128&g=1", "display_name": "Gspia", "link": "https://stackoverflow.com/users/1964881/gspia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1474436104, "creation_date": 1474436104, "last_edit_date": 1495535651, "question_id": 39608262, "link": "https://stackoverflow.com/questions/39608262/smallcheck-series-generation-and-duplicates-the-parameters-have-relations", "title": "SmallCheck series generation and duplicates (the parameters have relations)", "body": "<p>The following data structure can be tested with the Tasty-SmallCheck related code that follows. There is a relation that has to hold with the constructor ShB: the second and the third positive integers should be at most as large as the first one. </p>\n\n<pre><code>data Shape = ShA Int Int Bool \n  | ShB Int Int Int Bool Bool \n  deriving (Show,Read,Eq)\n</code></pre>\n\n<p>The constructor ShA should have positive Int's but otherwise there is no relation between the parameters. </p>\n\n<pre><code>auxShA :: (Positive Int, Positive Int, Bool) -&gt; Shape\nauxShA (i,j,b) = ShA (fromIntegral i) (fromIntegral j) b\n\nauxShB :: (Positive Int, Positive Int, Positive Int) -&gt; Bool -&gt; Bool -&gt; Shape\nauxShB (a1,a2,a3) = ShB i u d\n  where\n  (i,u,d) = auxTriplet (a1,a2,a3)\n\nauxTriplet :: (Positive Int, Positive Int, Positive Int) -&gt; (Int,Int,Int)\nauxTriplet (a,b,c) \n  | a &gt;= b &amp;&amp; a &gt;= c = (fromIntegral a, fromIntegral b, fromIntegral c)\n  | b &gt;= a &amp;&amp; b &gt;= c = (fromIntegral b, fromIntegral a, fromIntegral c)\n  | otherwise        = (fromIntegral c, fromIntegral a, fromIntegral b)\n\nconsB :: (Serial m a1, Serial m a2, Serial m a3, Serial m b, Serial m c) =&gt;\n  ((a1,a2,a3) -&gt; b -&gt; c -&gt; e) -&gt; Series m e\nconsB f = decDepth $\n  f &lt;$&gt; series\n    &lt;~&gt; series\n    &lt;~&gt; series\n\ninstance Monad m =&gt; Serial m Shape where\n  series = cons1 auxShA \\/ consB auxShB\n</code></pre>\n\n<p>The generated cases are otherwise ok but there are duplicates that can be seen e.g. with</p>\n\n<pre><code>list 4 series :: [Shape]\n</code></pre>\n\n<p>The question is, how to generate the test cases with SmallCheck (tasty) when the following holds?</p>\n\n<ul>\n<li>there are properties that has to hold, e.g. the first parameter has to Positive</li>\n<li>what if the first parameter should be larger than 10::Int?</li>\n<li>And continuing, what if the second parameter should between the first - 5 and the first, and the third should be between the second - 5 and the second?</li>\n</ul>\n\n<p>Or, how to generate test cases that dynamically can depend on the previous generated values?</p>\n\n<p>First thought was to write constructors to Shape that check that inputs are valid (e.g. the bullet points above), but the problem of duplicate test case generation would remain with that approach.</p>\n\n<p>The above code uses similar solution as in \n<a href=\"https://stackoverflow.com/questions/36426303/smallcheck-generate-data-satisfying-invariants\">SmallCheck invariant</a> -answer.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1474452227, "post_id": 39607475, "comment_id": 66533788, "body": "&quot;Access Nth element of a list&quot; typically means you probably don&#39;t want to use a list (for performance reasons). Depending what you&#39;re trying to do, of course..."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1474466519, "post_id": 39607514, "comment_id": 66543615, "body": "Of course, if <code>zeroes</code> is really infinite, then <code>drop n zeroes == zeroes</code> :)"}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1474467374, "post_id": 39607514, "comment_id": 66544279, "body": "@chepner: The OP did specify that the list is infinite, but did <i>not</i> specify that all the elements are the same; <code>zeroes</code> seems to be just an example."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1474500171, "post_id": 39607514, "comment_id": 66561386, "body": "You can also replace <code>take</code> + <code>drop</code> with <code>splitAt</code> and save a traversal."}], "tags": [], "owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "is_accepted": true, "score": 4, "last_activity_date": 1474431748, "creation_date": 1474431748, "answer_id": 39607514, "question_id": 39607475, "link": "https://stackoverflow.com/questions/39607475/is-it-possible-to-modify-an-element-in-an-infinite-list/39607514#39607514", "title": "Is it possible to modify an element in an infinite list?", "body": "<p>One way:</p>\n\n<pre><code>(take (n-1) zeroes) ++ [desired_nth_member] ++ (drop n zeroes)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474467006, "post_id": 39608080, "comment_id": 66544008, "body": "For point-free fans, <code>insert = bool id (const val) . (== n)</code>."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 2, "last_activity_date": 1474435053, "creation_date": 1474435053, "answer_id": 39608080, "question_id": 39607475, "link": "https://stackoverflow.com/questions/39607475/is-it-possible-to-modify-an-element-in-an-infinite-list/39608080#39608080", "title": "Is it possible to modify an element in an infinite list?", "body": "<pre><code>setNth :: Int -&gt; a -&gt; [a] -&gt; [a]\nsetNth n val = zipWith insert [0..]\n  where insert i x | i == n = val\n                   | otherwise = x\n\n&gt; take 10 . setNth 5 2 $ repeat 0\n[0,0,0,0,0,2,0,0,0,0]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474489553, "post_id": 39625001, "comment_id": 66557197, "body": "Welcome to StackOverflow, and kudos for an excellent first answer!"}, {"owner": {"reputation": 144, "user_id": 6844896, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mmQx5QYVBG0/AAAAAAAAAAI/AAAAAAAACPI/XmWi8zLqUQw/photo.jpg?sz=128", "display_name": "rlefevre", "link": "https://stackoverflow.com/users/6844896/rlefevre"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474490434, "post_id": 39625001, "comment_id": 66557673, "body": "@leftaroundabout Thank you, much appreciated."}], "tags": [], "owner": {"reputation": 144, "user_id": 6844896, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mmQx5QYVBG0/AAAAAAAAAAI/AAAAAAAACPI/XmWi8zLqUQw/photo.jpg?sz=128", "display_name": "rlefevre", "link": "https://stackoverflow.com/users/6844896/rlefevre"}, "is_accepted": false, "score": 3, "last_activity_date": 1474487457, "last_edit_date": 1474487457, "creation_date": 1474485976, "answer_id": 39625001, "question_id": 39607475, "link": "https://stackoverflow.com/questions/39607475/is-it-possible-to-modify-an-element-in-an-infinite-list/39625001#39625001", "title": "Is it possible to modify an element in an infinite list?", "body": "<p>Or using <a href=\"https://hackage.haskell.org/package/lens-4.14/docs/Data-List-Lens.html\" rel=\"nofollow\">Lens</a>:</p>\n\n<pre><code>import Control.Lens\n\nsetNth :: Int -&gt; a -&gt; [a] -&gt; [a]\nsetNth = set . ix\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>&gt; take 10 $ setNth 3 42 (repeat 0)\n[0,0,0,42,0,0,0,0,0,0]\n</code></pre>\n\n<p>Actually you don't really need a function:</p>\n\n<pre><code>&gt; take 10 $ (repeat 0) &amp; ix 3 .~ 42\n[0,0,0,42,0,0,0,0,0,0]\n</code></pre>\n\n<p>Note that this can work with <a href=\"https://hackage.haskell.org/package/lens-4.14/docs/Control-Lens-At.html#v:Ixed\" rel=\"nofollow\">a lot more types</a> than just lists:</p>\n\n<pre><code>setNth :: Ixed t =&gt; Index t -&gt; IxValue t -&gt; t -&gt; t\n\n&gt; setNth 1 42 (0,0,0)\n(0,42,0)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3163486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71becfb2f249064258e5d313a6052a90?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Shippey", "link": "https://stackoverflow.com/users/3163486/sam-shippey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 39607514, "answer_count": 3, "score": 1, "last_activity_date": 1474487457, "creation_date": 1474431477, "question_id": 39607475, "link": "https://stackoverflow.com/questions/39607475/is-it-possible-to-modify-an-element-in-an-infinite-list", "title": "Is it possible to modify an element in an infinite list?", "body": "<p>Let's say I have a list of zeroes:</p>\n\n<pre><code>zeroes = repeat 0\n</code></pre>\n\n<p>And I'd like to modify the nth member of that list. Is there a built in for this, or some function I could write to do it? Is this possible in the first place?</p>\n\n<p>Note: Yes, I know you can't really modify anything in haskell without a state monad, so treat it as meaning \"construct a new list exactly identical to but different by one element\".</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474432728, "post_id": 39607246, "comment_id": 66523322, "body": "Use <code>Integer</code> not <code>Int</code>"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474473511, "post_id": 39607246, "comment_id": 66548390, "body": "@Bergi When I change the signature of <code>mwave</code>, it gives and error: <code>Couldn&#39;t match expected type </code>Integer&#39; with actual type <code>Int&#39;</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474473686, "post_id": 39607246, "comment_id": 66548502, "body": "You&#39;d need to change <code>digits</code> as well"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474474041, "post_id": 39607246, "comment_id": 66548719, "body": "@Bergi <code>mwave :: Int -&gt; Integer</code> <code>digits :: Integer -&gt; Int</code> does not work"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474477831, "post_id": 39607246, "comment_id": 66550892, "body": "It&#39;s <code>digits :: Int -&gt; Integer</code> - the return value has the large values, not the parameter"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474479803, "post_id": 39607246, "comment_id": 66551963, "body": "@Bengi. Thanks but it says: <code>Couldn&#39;t match expected type &#39;Integer&#39; with actual type &#39;Int&#39;</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474481331, "post_id": 39607246, "comment_id": 66552722, "body": "Where? Please cite the whole error message"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474481845, "post_id": 39607246, "comment_id": 66552976, "body": "Couldn&#39;t match expected type &#39;Integer&#39; with actual type &#39;Int&#39;       In the expression: n &#39;mod&#39; 10 ^ (100 :: Integer)           In an equation for &#39;digits&#39;:               digits n = n &#39;mod&#39; 10 ^ (100 :: Integer)"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474482694, "post_id": 39607246, "comment_id": 66553425, "body": "Well that&#39;s not the function you posted in your question, no wonder that the type I&#39;m recommending doesn&#39;t match. Is <code>digits</code> supposed to call <code>mwave</code> or not?"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474483051, "post_id": 39607246, "comment_id": 66553631, "body": "Sorry, my bad. I changed the function to test a different case. The actual error is: <code>Couldn&#39;t match expected type &#39;Integer&#39; with actual type &#39;Int&#39;     * In the expression: (mwave n) &#39;mod&#39; 10 ^ (100 :: Integer)       In an equation for &#39;digits&#39;:           digits n = (mwave n) &#39;mod&#39; 10 ^ (100 :: Integer)</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474483350, "post_id": 39607246, "comment_id": 66553780, "body": "And <code>mwave</code> takes an <code>Int</code> and returns an <code>Integer</code> as well? I had assumed that was already established."}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474485728, "post_id": 39607246, "comment_id": 66555053, "body": "No, <code>mwave</code> takes an <code>Int</code> and returns an <code>Int</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474485900, "post_id": 39607246, "comment_id": 66555158, "body": "You had commented you made it <code>mwave :: Int -&gt; Integer</code>\u2026 It needs to return a large value of course, otherwise it&#39;s pointless to try to fit a <code>10^100</code> in it."}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474486011, "post_id": 39607246, "comment_id": 66555216, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/123887/discussion-between-zubin-kadva-and-bergi\">continue this discussion in chat</a>."}], "owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1474446637, "answer_count": 0, "score": 1, "last_activity_date": 1474433506, "creation_date": 1474429896, "last_edit_date": 1474433506, "question_id": 39607246, "link": "https://stackoverflow.com/questions/39607246/how-can-i-compute-the-result-of-some-integer-modulo-10100", "closed_reason": "Duplicate", "title": "How can I compute the result of some integer modulo 10^100?", "body": "<p>I am new to Haskell. I have a code as:</p>\n\n<pre><code>mwave :: Int -&gt; Int\nmwave = (map wave [0..] !!)\n  where wave 0 = 1\n        wave 1 = 1\n        wave n = ((3 * n - 3) * mwave (n - 2) + (2 * n + 1) * mwave (n - 1)) `div` (n + 2)\n\ndigits :: Int -&gt; Int\ndigits n = (mwave n) `mod` 10^100::Integer\n</code></pre>\n\n<blockquote>\n<pre><code>Output:\nwave.exe: divide by zero\n</code></pre>\n</blockquote>\n\n<p>I have to output the answer modulo 10^100. How can I do this?</p>\n"}, {"tags": ["haskell", "type-constraints", "type-families"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1474475842, "post_id": 39607224, "comment_id": 66549757, "body": "You can even write it <a href=\"http://lpaste.net/7701963482375127040\" rel=\"nofollow noreferrer\">once and for all</a> for every arity with GHC 8."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474478242, "post_id": 39607224, "comment_id": 66551095, "body": "@user2407038, cool! Your <code>Arg</code> is very clearly superior to my multiple <code>Arg</code> families. I haven&#39;t dug into the rest yet. One thing I couldn&#39;t find a way to do was work with kinds other than <code>*</code>. Does your approach do so?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474478978, "post_id": 39607224, "comment_id": 66551468, "body": "@user2407038, does your thing allow <code>IsF (Either x) a</code>? It smells like it might not. Also, can you avoid the kind signatures in the tests using a kind class?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474479422, "post_id": 39607224, "comment_id": 66551755, "body": "One more thing: would <code>Arg</code> be one of those rare cases where typelits would actually work well? That would make for a better API."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474493194, "post_id": 39607224, "comment_id": 66559094, "body": "It happily works with kinds other than <code>*</code>, unless you mean the <code>Arg</code> family by itself, in which case, yes, it is written that way - a more powerful <code>Arg</code> is <a href=\"http://lpaste.net/5977620583607697408\" rel=\"nofollow noreferrer\">possible</a> but unnecessary here. <a href=\"http://lpaste.net/8258114670070595584\" rel=\"nofollow noreferrer\">Here</a> is a version in which <code>IsF (Either x) a</code> will also work - it is actually even simpler than the other one. I&#39;m pretty sure you still can&#39;t do induction with type lits, so no, except for the syntactic convenience of writing e.g. <code>Arg .. 3</code> but for this you only need a <code>TypeLits.Nat -&gt; Nat</code> type function."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474521683, "post_id": 39607224, "comment_id": 66566474, "body": "@user2407038, I finally dug into your simplified code some more and figured out most of the answers to my initial &quot;Why is it like that?&quot; questions. That&#39;s a really nifty design that seems to be up to pretty much anything one could want from such."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 8, "last_activity_date": 1474464968, "last_edit_date": 1474464968, "creation_date": 1474429745, "answer_id": 39607224, "question_id": 39606508, "link": "https://stackoverflow.com/questions/39606508/constrain-a-type-family-constraint-to-be-some-pair/39607224#39607224", "title": "Constrain a type family constraint to be &quot;some pair&quot;", "body": "<p>Yes! You can do this!</p>\n\n<h3>Strong, somewhat built-up version</h3>\n\n<p>First, a couple of useful type families:</p>\n\n<pre><code>type family Fst a where\n  Fst (x,y) = x\n\ntype family Snd a where\n  Snd (x,y) = y\n</code></pre>\n\n<p>Now the one you're after:</p>\n\n<pre><code>type IsPair a = a ~ (Fst a, Snd a)\n</code></pre>\n\n<p>Here's a test:</p>\n\n<pre><code>type family Con a where\n  Con (f x y) = f\n\ntest :: IsPair a =&gt; proxy a -&gt; Con a :~: (,)\ntest _ = Refl\n</code></pre>\n\n<p>And an even simpler one that turns out to test a stronger property:</p>\n\n<pre><code> test1 :: IsPair a =&gt; a -&gt; Fst a\n test1 = fst\n</code></pre>\n\n<p>And just to make sure it's satisfied when it should be:</p>\n\n<pre><code>data Dict c where\n  Dict :: c =&gt; Dict c\n\ntest2 :: Dict (IsPair (a, b))\ntest2 = Dict\n</code></pre>\n\n<p>You can, of course, use this to define your <code>F</code>:</p>\n\n<pre><code>type family F t a\ntype instance F Int a = IsPair a\n</code></pre>\n\n<h3>Much simpler, but much less powerful</h3>\n\n<pre><code>type family Con a where\n  Con (f x y) = f\ntype IsPair a = Con a ~ (,)\n</code></pre>\n\n<p>The trouble with this one, compared to the first approach, is that it doesn't actually win you the glorious knowledge that <code>a ~ (Fst a, Snd a)</code>. So it makes a statement, but you can't do a whole heck of a lot with it.</p>\n\n<h3>A little generalization</h3>\n\n<p>Why just pairs? If you toss <code>PolyKinds</code> into the mix, you can get very general:</p>\n\n<pre><code>type family Arg1 a where Arg1 (f x) = x\ntype family Arg2 a where Arg2 (f y x) = y\ntype family Arg3 a where Arg3 (f z y x) = z\ntype family Arg4 a where Arg4 (f w z y x) = w\n\ntype family IsF (f :: k) (a :: *) :: Constraint\ntype instance IsF f a = a ~ f (Arg1 a)\ntype instance IsF f a = a ~ f (Arg2 a) (Arg1 a)\ntype instance IsF f a = a ~ f (Arg3 a) (Arg2 a) (Arg1 a)\ntype instance IsF f a = a ~ f (Arg4 a) (Arg3 a) (Arg2 a) (Arg1 a)\n</code></pre>\n\n<p>You can do this without <code>PolyKinds</code> too, but then you need <code>IsF1</code>, <code>IsF2</code>, etc.</p>\n\n<p>With this in place,</p>\n\n<pre><code>type IsPair a = IsF (,) a\ntype IsMaybe a = IsF Maybe a\n...\n</code></pre>\n\n<p>Tests for the generalization (this stuff only works for GHC 7.10 or later; polykinds is too flaky before that).</p>\n\n<pre><code>data Dict c where\n  Dict :: c =&gt; Dict c\n\ntest1 :: Dict (IsF f (f a))\ntest1 = Dict\n\ntest2 :: Dict (IsF f (f a b))\ntest2 = Dict\n\ntest3 :: Dict (IsF f (f a b c))\ntest3 = Dict\n\ntest4 :: Dict (IsF f (f a b c d))\ntest4 = Dict\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 2, "accepted_answer_id": 39607224, "answer_count": 1, "score": 4, "last_activity_date": 1474464968, "creation_date": 1474424363, "question_id": 39606508, "link": "https://stackoverflow.com/questions/39606508/constrain-a-type-family-constraint-to-be-some-pair", "title": "Constrain a type family constraint to be &quot;some pair&quot;", "body": "<p>Consider the following, where I'm trying to say \"<code>a</code> is a pair\":</p>\n\n<pre><code>type family F t a :: Constraint\ntype instance F Int a = (a ~ (a1, a2))\n</code></pre>\n\n<p>This doesn't work because both <code>a1</code> and <code>a2</code> are not in scope, but is there any way to express this? </p>\n\n<p>Of course in a function signature I can write constraints like <code>(a ~ (a1, a2))</code> even when <code>a1</code> and <code>a2</code> are not mentioned elsewhere, but I need to put this in an instance function signature, which is of course determined by the class. And <code>a</code> in this case is not a parameter to the instance itself, just the instance function, much like <code>Functor</code> only has <code>f</code> as a class parameter, not <code>a</code> and <code>b</code>, so I can't add extra constraints to the instance clause.</p>\n"}, {"tags": ["haskell", "gloss"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1474424848, "post_id": 39606232, "comment_id": 66521432, "body": "Possibly unrelated, but I have some dependency issues which cause <code>play</code> to produce what appears to be an exception (<code>tmp: user error (unknown GLUT entry glutInit)</code>), so perhaps closing the window also causes an unhandled exception?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1474451887, "post_id": 39606232, "comment_id": 66533530, "body": "Looks like a buffering problem. Try to flush stout before exiting <code>hFlush stdout</code>"}, {"owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1474463005, "post_id": 39606232, "comment_id": 66541063, "body": "@mb14 I still get the same problem :-("}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1474466637, "post_id": 39606232, "comment_id": 66543709, "body": "Tested in Windows 10 : on closing, ghci tells <code>freeglut (&lt;interactive&gt;): fghInitialize: CreateDC failed, Screen size info may be incorrect This is quite likely caused by a bad &#39;-display&#39; parameter</code> and then crashes, even with an exception handler around <code>play</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 2, "last_activity_date": 1474493567, "last_edit_date": 1474493567, "creation_date": 1474476215, "answer_id": 39622163, "question_id": 39606232, "link": "https://stackoverflow.com/questions/39606232/why-does-my-program-exit-immediately-after-playing-a-gloss-animation/39622163#39622163", "title": "Why does my program exit immediately after playing a gloss animation?", "body": "<p>Presumably you are using the GLUT backend (the default). Take a look at some of the <a href=\"https://hackage.haskell.org/package/gloss-1.10.2.3/src/Graphics/Gloss/Internals/Interface/Backend/GLUT.hs\" rel=\"nofollow\">source code</a> for <code>gloss</code> (exactly as it appears with comments):</p>\n\n<pre><code>instance Backend GLUTState where\n        initBackendState           = glutStateInit\n        initializeBackend          = initializeGLUT\n\n        -- non-freeglut doesn't like this: (\\_ -&gt; GLUT.leaveMainLoop)\n        exitBackend                = (\\_ -&gt; System.exitWith System.ExitSuccess)\n\n....\n</code></pre>\n\n<p>When it exits the main loop, <code>gloss</code> will call <code>exitBackend</code>, whatever it is. For GLUT, that simply calls <code>System.exitWith</code> which naturally will terminate your program. The more sensible thing to do would be to call <code>leaveMainLoop</code> but as the comment in the code says, implementations of <code>glut</code> other than <code>freeglut</code> don't work well with that function (why? who knows. This is what the authors of gloss claim).</p>\n\n<p>Your potential solutions are to use <code>freeglut</code> specifically and modify the source code of <code>gloss</code> to change <code>exitBackend</code>; or use the GLFW backend, which doesn't have this problem. </p>\n"}], "owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1474505371, "creation_date": 1474422044, "last_edit_date": 1474505371, "question_id": 39606232, "link": "https://stackoverflow.com/questions/39606232/why-does-my-program-exit-immediately-after-playing-a-gloss-animation", "title": "Why does my program exit immediately after playing a gloss animation?", "body": "<p>I am learning how to use the Gloss library to make some animations in Haskell. </p>\n\n<p>Consider the code below which animates a circle that shrinks and expands its radius with time.</p>\n\n<pre><code>import Graphics.Gloss\nimport Graphics.Gloss.Interface.Pure.Game\n\ntype Radius = Float\ntype RealTime   = Float\n\ndata World = World Radius RealTime\n\nmain :: IO ()\nmain\n = do   let initWorld = World 100.0 0\n        let windowSize = (800,800)\n        let windowPosition = (200,200)\n        putStrLn \"Before play\"\n        play (InWindow \"Wobbling Circle\" windowSize windowPosition)\n              white 40 initWorld renderWorld handleEvent stepWorld\n        putStrLn \"After play\"\n\nrenderWorld :: World -&gt; Picture\nrenderWorld (World rad rtime ) = Pictures [ Circle rad ]\n\nhandleEvent :: Event -&gt; World -&gt; World\nhandleEvent _ = id\n\nstepWorld ::  Float -&gt; World -&gt; World -- wobbling circle\nstepWorld  _ (World _ rtime)  = World (100 * sin rtime) (rtime+0.1) \n</code></pre>\n\n<p>I compiled this code with <code>ghc --make -O2 -threaded Main.hs</code> on an Ubuntu 14.04 machine. </p>\n\n<p>When I run the code, the \"Before play\" statement is printed out and then the animation starts as expected. However, when I close the animation window, the code terminates immediately <strong>without</strong> printing the \"After Play\" statement. Why is that? </p>\n"}, {"tags": ["haskell", "monads", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 2, "last_activity_date": 1474426617, "creation_date": 1474426617, "answer_id": 39606804, "question_id": 39606162, "link": "https://stackoverflow.com/questions/39606162/how-is-type-inferred-in-this-snippet/39606804#39606804", "title": "How is type inferred in this snippet?", "body": "<p>The type of <code>parseJSON</code> is <code>FromJSON a =&gt; Value -&gt; Parser a</code>, so if you never use the result, GHC can\u2019t possibly figure out what <code>a</code> is supposed to be: it could be anything at all with a <code>FromJSON</code> instance. When you use it as the return value, then the caller of the <code>parseFoo</code> function will pick a concrete type for <code>b</code>, which will be used to pick the instance for the <code>parseFoo</code> call.</p>\n\n<p>As an aside, your <code>return</code> is totally redundant in this case. You could omit the <code>do</code>, the <code>a &lt;-</code>, and the <code>return</code>, since <code>a &gt;&gt;= return</code> is just <code>a</code> by the monad laws.</p>\n"}], "owner": {"reputation": 46896, "user_id": 385273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eTnXA.png?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/385273/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 39606804, "answer_count": 1, "score": 0, "last_activity_date": 1474426617, "creation_date": 1474421362, "question_id": 39606162, "link": "https://stackoverflow.com/questions/39606162/how-is-type-inferred-in-this-snippet", "title": "How is type inferred in this snippet?", "body": "<p>I'm working through Artyom's Aeson tutorial, and have coded myself this snippet:</p>\n\n<pre><code>parseFoo (Object obj) = do\n    a &lt;- case HM.lookup \"a\" obj of\n        Just x  -&gt; parseJSON x\n        Nothing -&gt; fail \"no field 'a'\"\n\n    return a\n</code></pre>\n\n<p>I've noticed that if I <code>return True</code>, I get an \"ambiguous reference\" error:</p>\n\n<pre><code>No instance for (FromJSON t0) arising from a use of \u2018parseJSON\u2019\nThe type variable \u2018t0\u2019 is ambiguous\nNote: there are several potential instances:\n...\n</code></pre>\n\n<p>The type of the non-ambiguous case is</p>\n\n<pre><code>parseFoo :: FromJSON b =&gt; Value -&gt; Parser b\n</code></pre>\n\n<p>My question is, why (how) does <code>a</code> need the <code>return</code> statement to infer its type?</p>\n"}, {"tags": ["haskell", "shake-build-system"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1474415134, "post_id": 39605371, "comment_id": 66519088, "body": "Also: I&#39;ve tried looking in <a href=\"http://shakebuild.com/manual#running\" rel=\"nofollow noreferrer\">the fine manual</a>, but its section on command-line flags is quite short indeed; it doesn&#39;t mention any of these flags at all. It&#39;s more of a tutorial than a reference manual."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1474421321, "post_id": 39605371, "comment_id": 66520662, "body": "I know this may seem an unreasonable approach, but you may want to <a href=\"https://github.com/ndmitchell/shake\" rel=\"nofollow noreferrer\">use the source, Luke</a>. I think your question is a good one, but it may well be that reading the source is the fastest way to get the answer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1474446681, "post_id": 39605371, "comment_id": 66529969, "body": "@dfeuer I don&#39;t think it&#39;s unreasonable! I just haven&#39;t had the energy to do it (yet), and thought I&#39;d give somebody who already knows the answer a chance to say while I&#39;m recharging."}], "answers": [{"tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": true, "score": 2, "last_activity_date": 1474837590, "creation_date": 1474837590, "answer_id": 39691840, "question_id": 39605371, "link": "https://stackoverflow.com/questions/39605371/how-do-i-skip-a-shake-action/39691840#39691840", "title": "How do I skip a shake Action?", "body": "<p>The observation that there are mixed metaphors is correct, and part of the problem. In the current released version of Shake the flags are taken from Make, which has different semantics to Shake, and thus maps over poorly. In the current HEAD version of Shake it's been rewritten and is much simpler - but let's focus on the released version for now.</p>\n\n<p>In Shake 0.15 (the current released version) a rule can only be skipped if Shake has run it successfully before. As a result, when you <code>rm</code> the Shake database, Shake cannot skip the rule on the test execution as it has never been run before.</p>\n\n<p>Before Shake 0.16 comes out one reliable and simple option is to add a flag to your build system whose presence skips all downloading - so Shake still runs the rule, but the effect of the rule is a no-op.</p>\n"}], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 2, "accepted_answer_id": 39691840, "answer_count": 1, "score": 3, "last_activity_date": 1474837590, "creation_date": 1474414973, "last_edit_date": 1474415332, "question_id": 39605371, "link": "https://stackoverflow.com/questions/39605371/how-do-i-skip-a-shake-action", "title": "How do I skip a shake Action?", "body": "<p>I'd like to download a bunch of web pages with shake, then do some processing on them. However, I'd also like the option to download the pages outside of shake, tell shake I've done so, and let shake continue with the remainder of the processing steps. Right now I'm working step two, \"tell shake I've done some of its work for it\".</p>\n\n<p>To give a minimal example, here's a very short shake script:</p>\n\n<pre><code>import Development.Shake\n\nmain = shakeArgs shakeOptions $ do\n    want [\"test.txt\"]\n    \"test.txt\" %&gt; \\_ -&gt; liftIO (putStrLn \"yikes!\")\n</code></pre>\n\n<p>I would like to find a way to prevent this script from printing <code>yikes!</code> (but still updating the database entry for <code>test.txt</code>). Running this with <code>--help</code>, I see in part:</p>\n\n<pre><code>--touch                     Assume targets are clean.\n</code></pre>\n\n<p>Which sounds promising. However:</p>\n\n<pre><code>% rm -r .shake &amp;&amp; ./test --touch\nyikes!\nBuild completed in 0:01m\n</code></pre>\n\n<p>Perhaps it needs an explicit list of files to mark as new?</p>\n\n<pre><code>% rm -r .shake &amp;&amp; ./test --touch test.txt\nyikes!\nBuild completed in 0:01m\n</code></pre>\n\n<p>Okay. Well, the <code>--help</code> also lists this:</p>\n\n<pre><code>-o FILE, --old-file=FILE, --assume-old=FILE\n                            Consider FILE to be very old and don't remake it.\n</code></pre>\n\n<p>I find that a little puzzling: we now have a \"clean/dirty\" metaphor and a \"old/new\" metaphor, and it's not clear how if at all they are related. Moreover, surely if the file was old that would mean we <em>would</em> want to remake it, right? In any case, it doesn't seem to do what I want:</p>\n\n<pre><code>% rm -r .shake &amp;&amp; ./test -o test.txt\nyikes!\nBuild completed in 0:01m\n</code></pre>\n\n<p>Okay... well, perhaps this option, which says the exact opposite of that one, will do what I want:</p>\n\n<pre><code>-W FILE, --what-if=FILE, --new-file=FILE, --assume-new=FILE\n                        Consider FILE to be infinitely new.\n</code></pre>\n\n<p>No dice:</p>\n\n<pre><code>% r .shake &amp;&amp; ./test -W test.txt\nyikes!\nBuild completed in 0:01m\n</code></pre>\n\n<p>This leaves me with several questions:</p>\n\n<ul>\n<li>Most importantly: how can I ask shake <em>just</em> to update its database entry for <code>test.txt</code> without running the <code>Action</code> associated with <code>test.txt</code>?</li>\n<li>What does <code>--touch</code> do, and why didn't that help?</li>\n<li>What do <code>-o</code>/<code>-W</code> do, and why didn't they help?</li>\n<li>What is the relationship between old/new and clean/dirty?</li>\n</ul>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1474411622, "post_id": 39604814, "comment_id": 66518112, "body": "No there are no repetitions. Here ys is a larger list which elements is of a specific type. And xs is a small list with all the different types. So i have a function that returns true if the values in ys is not different from any of the values in xs."}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": false, "score": 2, "last_activity_date": 1474411236, "creation_date": 1474411236, "answer_id": 39604814, "question_id": 39604775, "link": "https://stackoverflow.com/questions/39604775/how-can-i-check-one-list-against-another-to-see-if-the-second-list-contains-any/39604814#39604814", "title": "How can I check one list against another to see if the second list contains any elements from the first list?", "body": "<p>If there are no repetitions in <code>xs</code> you can do it like that:</p>\n\n<pre><code>null (xy \\\\ ys)\n</code></pre>\n\n<p>You have to <code>import Data.List</code> for the <code>\\\\</code> operator.</p>\n"}], "owner": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1474411236, "creation_date": 1474410913, "question_id": 39604775, "link": "https://stackoverflow.com/questions/39604775/how-can-i-check-one-list-against-another-to-see-if-the-second-list-contains-any", "title": "How can I check one list against another to see if the second list contains any elements from the first list?", "body": "<p>Given two lists <code>xs</code> and <code>ys</code> is there a way to check if any or all (but nothing else) of the values in <code>xs</code> is in <code>ys</code> ?  </p>\n"}, {"tags": ["java", "oop", "haskell", "clojure", "functional-programming"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1474410641, "post_id": 39604613, "comment_id": 66517835, "body": "Depends on the language. There is usually some form of tooling that can locate an arbitrary identifier\u2019s definition, but it varies between different languages."}, {"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1474410870, "post_id": 39604613, "comment_id": 66517899, "body": "So you need a tool to do that, right? For example if you are using a normal text editor or browsing the code from internet, there is no easy way to find source code?"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1474411136, "post_id": 39604613, "comment_id": 66517988, "body": "You can read the imports. Good tooling makes programming easier, though, and I would always encourage using it when it\u2019s available. Writing Java productively without an IDE is nearly impossible. (Also, it\u2019s worth pointing out that the type of <code>myObject</code> is not enough to determine the location of <code>prepare_data</code> in the presence of subtyping/inheritance.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1474411390, "post_id": 39604613, "comment_id": 66518050, "body": "In Java, the class <code>MyObject</code> is always defined in <code>MyObject.java</code>. In other languages, there isn&#39;t necessarily an obvious place to look for the definition of <code>MyObject</code>."}, {"owner": {"reputation": 2528, "user_id": 4905506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmyz0.png?s=128&g=1", "display_name": "Yuri Steinschreiber", "link": "https://stackoverflow.com/users/4905506/yuri-steinschreiber"}, "edited": false, "score": 1, "creation_date": 1474411505, "post_id": 39604613, "comment_id": 66518087, "body": "That&#39;s too broad a question. Depends entirely on the language, and has nothing to do with functional programming. The way different languages deal with namespaces, modules, packages etc. has nothing to do with them being functional or not. You need to search and have tooling support - precisely like in Java. If you have a bunch of imports in your class and have a reference to another class called <code>PrepareData</code>, how would you know what package it belongs to without searching or using your IDE?"}, {"owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "reply_to_user": {"reputation": 2528, "user_id": 4905506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmyz0.png?s=128&g=1", "display_name": "Yuri Steinschreiber", "link": "https://stackoverflow.com/users/4905506/yuri-steinschreiber"}, "edited": false, "score": 0, "creation_date": 1474412405, "post_id": 39604613, "comment_id": 66518364, "body": "@YuriSteinschreiber I just search for a file named <code>PrepareData.java</code>. To find subclasses I grep for <code>extends PrepareData</code>. This is completely doable without an IDE or even on a web interface like GitHub."}, {"owner": {"reputation": 2528, "user_id": 4905506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmyz0.png?s=128&g=1", "display_name": "Yuri Steinschreiber", "link": "https://stackoverflow.com/users/4905506/yuri-steinschreiber"}, "edited": false, "score": 3, "creation_date": 1474413178, "post_id": 39604613, "comment_id": 66518565, "body": "@mahdix - you may have missed the point. There may be multiple files named <code>PrepareData.java</code>, in different packages, maybe in your project, maybe in some jars your projects refers to. How would you know which one to look for? You will have to scan through the packages in your imports, or rely on IDE to tell you where it is. The point is it is not trivial even in Java, in C# it&#39;s already more complicated (you can have multiple classes in the same file.) In short, OOP doesn&#39;t make it easier or different."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1474411651, "creation_date": 1474411651, "answer_id": 39604886, "question_id": 39604613, "link": "https://stackoverflow.com/questions/39604613/how-functions-are-organised-in-functional-programming-languages-like-haskell-or/39604886#39604886", "title": "How functions are organised in functional programming languages like Haskell or Clojure?", "body": "<p>Well, frankly, you sometimes <em>can't</em> find the source. Which is BTW no different in OO languages \u2013 it may simply not be supplied. All you have, in general, is the interface / header file / signature.</p>\n\n<p>More than in OO, the type signature in a strongly typed functional language can really tell you a lot about how to use a function. Often, you won't need any documentation nor source code, you just need to look at the type signature and know what this function is good for and how to use it, simply because there's <em>only one way</em> the types can match.</p>\n\n<p>To find the type signature, most languages will offer you some tool to look it up. In Haskell, you can load the file in question into <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html\" rel=\"nofollow\">GHCi</a>, and then query</p>\n\n<pre><code>YourModule&gt; :i prepare_data\n</code></pre>\n\n<p>which would print out the type signature (and indeed also the module in which this function is defined).</p>\n\n<p>That said, there is in practice a rather more efficient way to get at the signatures, documentation and if necessary also source code: search the internet! In the case of Haskell, there are a couple of great specialised search engines. If you ask <a href=\"https://hayoo.fh-wedel.de/\" rel=\"nofollow\">Hayoo</a> the name of a function like <code>prepare_data</code>, it will search the entire Hackage database (where basically all relevant open-source Haskell projects are hosted) for functions of that name. If the name isn't particularly generic, you should see the correct one on the first page, linked to the documentation with signature, which in turn also has the source code linked online.</p>\n\n<p>If the function name by itself is too ambiguous, you can limit the search to the library in question (you hopefully know that already!) or look up the module directly. As I said, you may learn this from a tool like GHCi, but often it can in fact be seem right from the code: no matter if it's a class or a bunch of functions, <em>they always need to be imported before use</em><sup>\u2020</sup>. So you have at the top of your file something like</p>\n\n<pre><code>import MyData\nimport MyData.Algorithms\nimport MyData.Util\n</code></pre>\n\n<p>which already gives you quite strong hints. You may even have each entity explicitly mentioned:</p>\n\n<pre><code>import MyData(MyData)\nimport MyData.Algorithms(foo, bar)\nimport MyData.Util(baz, prepare_data) -- gotcha!\n</code></pre>\n\n<p>Depends on the language how common this is.</p>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>There are a few languages that do it different, for example Matlab will just search for a <em>file of that name</em> if it encounters a function. Which really works completely horribly badly; fortunately most other languages <em>do</em> require explicit imports.</sub></p>\n"}], "owner": {"reputation": 1393, "user_id": 2535843, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ijgr5.png?s=128&g=1", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2535843/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 39604886, "answer_count": 1, "score": 3, "last_activity_date": 1474411651, "creation_date": 1474410031, "question_id": 39604613, "link": "https://stackoverflow.com/questions/39604613/how-functions-are-organised-in-functional-programming-languages-like-haskell-or", "title": "How functions are organised in functional programming languages like Haskell or Clojure?", "body": "<p>My understanding is that in FP you have a lot of functions working on a few pre-defined data types. </p>\n\n<p>So it's possible to have, for example, 10 different functions called <code>prepare_data</code> each of which acting on a different data type. (e.g. <code>prepare_data</code> for Customer, Company, Resource, ...).\nSo when you see a call to <code>prepare_data</code> function in the code, how can a developer find the definition of that function?</p>\n\n<p>I am coming from OOP background and in OOP when you see something like <code>myObject.prepare_data</code> you can find the definition by looking at the source code file for <code>MyObject</code> class, which can uniquely be identified (where <code>MyObject</code> is the type of <code>myObject</code>). But in FP the code for <code>prepare_data</code> can be located in any of source files in the system. So how is this done in FP?</p>\n"}, {"tags": ["haskell", "haskell-stack", "nixos"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1474528229, "post_id": 39603903, "comment_id": 66569513, "body": "I&#39;m not familiar with the Stack+Nix integration, but does <code>stack exec whereis pg_config</code> find the <code>pg_config</code> location?"}, {"owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1474565863, "post_id": 39603903, "comment_id": 66594371, "body": "@MichaelSnoyman I get &quot;Executable named whereis not found on path&quot;.. The printed path directories do not contain my system path, where most programs are to be found (including <i>whereis</i> and <i>pg_config</i>)."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1474603590, "post_id": 39603903, "comment_id": 66607781, "body": "It sounds like you&#39;ve enabled nix in your config but haven&#39;t specified the necessary packages. I&#39;m not a nix user, so I can&#39;t advise further, but <a href=\"https://docs.haskellstack.org/en/stable/nix_integration/#the-nix-shell\" rel=\"nofollow noreferrer\">this documentation</a> seems to cover the topic."}, {"owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1474646317, "post_id": 39603903, "comment_id": 66631602, "body": "I&#39;ve tried adding some packages to the nix section withtou success, but it certainly makes sense that using things from PATH doesn&#39;t help with reproducible builds. I&#39;ll look into it further in the appropriate channels. Thank you for your attention."}], "answers": [{"comments": [{"owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "edited": false, "score": 2, "creation_date": 1481219035, "post_id": 40190435, "comment_id": 69298905, "body": "This is strange.. setting <code>pure: false</code> didn&#39;t help me at all.. in the end I put <i>postgresql</i> in the packages list to get it working.."}, {"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "reply_to_user": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "edited": false, "score": 0, "creation_date": 1499975318, "post_id": 40190435, "comment_id": 77151948, "body": "@MarceloZabani I am having a similar problem as this question. To which packages list did you add &#39;postgresql&#39; to get it working?"}, {"owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "reply_to_user": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 1, "creation_date": 1500032147, "post_id": 40190435, "comment_id": 77174936, "body": "@mherzl sorry for not answering earlier. I guess you found out where, though!"}, {"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "reply_to_user": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "edited": false, "score": 0, "creation_date": 1500145829, "post_id": 40190435, "comment_id": 77214478, "body": "No worries @MarceloZabani. Yep got it working as described in the answer!"}, {"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1518114899, "post_id": 40190435, "comment_id": 84383237, "body": "<code>pure: false</code> is very important, if application you build requires access to environment. In my case application built with default stack <code>pure: true</code> couldn&#39;t access environment variable DBUS_SESSION_BUS_ADDRESS, which is required by <a href=\"https://hackage.haskell.org/package/fdo-notify-0.3.1/docs/DBus-Notify.html#v:connectSession\" rel=\"nofollow noreferrer\">fdo-notify</a>. Instead it worked fine by with <code>cabal build</code>. TR;DL: <code>pure: false</code> let me use <code>stack</code> again. Many thanks for the hint;-)"}], "tags": [], "owner": {"reputation": 1051, "user_id": 713303, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sbOcy.png?s=128&g=1", "display_name": "modular", "link": "https://stackoverflow.com/users/713303/modular"}, "is_accepted": false, "score": 1, "last_activity_date": 1477128492, "last_edit_date": 1477128492, "creation_date": 1477128162, "answer_id": 40190435, "question_id": 39603903, "link": "https://stackoverflow.com/questions/39603903/haskell-stack-does-not-build-postgresql-libpq-on-nixos/40190435#40190435", "title": "Haskell Stack does not build postgresql-libpq on Nixos", "body": "<p>I had the same problem, and reading the <a href=\"https://docs.haskellstack.org/en/stable/nix_integration/#the-nix-shell\" rel=\"nofollow\">docs</a> linked by Michael Snoyman helped me. You need to add this to your stack.yaml:</p>\n\n<pre><code>nix:\n  enable: true\n  pure: false\n</code></pre>\n\n<p>I was building the package not owned by me, so instead of editing project-specific config I added those those lines to my <em>global</em> config: <code>~/.stack/config.yaml</code>. Alternatively, you can use command-line options:</p>\n\n<pre>stack --nix --no-nix-pure build</pre>\n\n<p>Alternatively to \"non-pure\" build, you should be able to specify all system dependencies in <code>nix-shell</code> to enforce reproducibility, but I didn't try it.</p>\n"}, {"tags": [], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "is_accepted": true, "score": 3, "last_activity_date": 1499988051, "creation_date": 1499988051, "answer_id": 45092333, "question_id": 39603903, "link": "https://stackoverflow.com/questions/39603903/haskell-stack-does-not-build-postgresql-libpq-on-nixos/45092333#45092333", "title": "Haskell Stack does not build postgresql-libpq on Nixos", "body": "<p>I ran into this issue with stack on nixos, and got past it when the nix block of my <code>stack.yaml</code> had been changed to the following.</p>\n\n<pre><code>nix:\n  pure: true\n  enable: true\n  packages: [ postgresql ]\n</code></pre>\n"}], "owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 45092333, "answer_count": 2, "score": 5, "last_activity_date": 1499988051, "creation_date": 1474406439, "question_id": 39603903, "link": "https://stackoverflow.com/questions/39603903/haskell-stack-does-not-build-postgresql-libpq-on-nixos", "title": "Haskell Stack does not build postgresql-libpq on Nixos", "body": "<p>After adding <em>postgresql-libpq</em> to my project's cabal file, <em>stack build</em> fails with the following:</p>\n\n<pre><code>Configuring postgresql-libpq-0.9.1.1...\nsetup: The program 'pg_config' is required but it could not be found.\n</code></pre>\n\n<p>I'm on Nixos and <em>pg_config</em> is both installed and on my PATH:</p>\n\n<pre><code>$ whereis pg_config\npg_config: /nix/store/5bc6hzqkyw8dpi91sqznd3ik42mllwyz-system-path/bin/pg_config\n</code></pre>\n\n<p>I'm using stack 1.0.2, and it seems that it won't update even after <em>nixos-rebuild switch --upgrade</em> on the unstable channel. Is this a mistake on my side or is it something else?</p>\n"}, {"tags": ["performance", "haskell", "recursion", "motzkin-numbers"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1474397747, "post_id": 39601277, "comment_id": 66511845, "body": "memoization might help."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1474398691, "post_id": 39601277, "comment_id": 66512403, "body": "<a href=\"https://wiki.haskell.org/Memoization\" rel=\"nofollow noreferrer\">wiki.haskell.org/Memoization</a>"}], "answers": [{"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1474398750, "post_id": 39601762, "comment_id": 66512437, "body": "I think you are missing parenthesis in the last line before the div (div should apply to the sum of the terms)."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 6, "last_activity_date": 1474399005, "last_edit_date": 1474399005, "creation_date": 1474397673, "answer_id": 39601762, "question_id": 39601277, "link": "https://stackoverflow.com/questions/39601277/haskell-code-running-too-slow/39601762#39601762", "title": "Haskell: Code running too slow", "body": "<p>With n=30, you need to compute <code>wave 29</code> and <code>wave 28</code>, which, in turn, needs to compute <code>wave 28</code>, <code>wave 27</code> twice and <code>wave 26</code> and so forth, this quickly goes in the billions.</p>\n\n<p>You can employ the same trick that is used in computation of the fibonacci numbers:</p>\n\n<pre><code>wave 0 = 1\nwave 1 = 1\nwave n = helper 1 1 2\n    where\n       helper x y k | k &lt;n      = helper y z (k+1)\n                    | otherwise = z\n                    where z = ((3*k-3) * x + (2*k+1) * y) `div` (k+2)\n</code></pre>\n\n<p>This runs in linear time, and the helper has, for every <code>k</code> the values for  <code>wave (k-2)</code> and <code>wave (k-1)</code> ready.</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1474398421, "creation_date": 1474398421, "answer_id": 39601990, "question_id": 39601277, "link": "https://stackoverflow.com/questions/39601277/haskell-code-running-too-slow/39601990#39601990", "title": "Haskell: Code running too slow", "body": "<p>here is a memoized version</p>\n\n<pre><code>wave = ((1:1:map waveCalc [2..]) !!)\n    where waveCalc n = ( (2*n+1)*wave (n-1) + (3*n-3)*wave (n-2) ) `div` (n+2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 10, "last_activity_date": 1474401030, "last_edit_date": 1495535408, "creation_date": 1474401030, "answer_id": 39602672, "question_id": 39601277, "link": "https://stackoverflow.com/questions/39601277/haskell-code-running-too-slow/39602672#39602672", "title": "Haskell: Code running too slow", "body": "<p>There is a standard trick for computing the Fibonacci numbers that can easily be adapted to your problem. The naive definition for Fibonacci numbers is:</p>\n\n<pre><code>fibFunction :: Int -&gt; Integer\nfibFunction 0 = 1\nfibFunction 1 = 1\nfibFunction n = fibFunction (n-2) + fibFunction (n-1)\n</code></pre>\n\n<p>However, this is very costly: since all the leaves of the recursion are <code>1</code>, if <code>fib x = y</code>, then we must perform <code>y</code> recursive calls! Since the Fibonacci numbers grow exponentially, this is a bad state of affairs to be in. But with dynamic programming, we can share the computations needed in the two recursive calls. The pleasing one-liner for this looks like this:</p>\n\n<pre><code>fibList :: [Integer]\nfibList = 1 : 1 : zipWith (+) fibList (tail fibList)\n</code></pre>\n\n<p>This may look a bit puzzling at first; here the <code>fibList</code> argument to <code>zipWith</code> serves as the recursion on two indices ago, while the <code>tail fibList</code> argument serves as the recursion on one index ago, which gives us both the <code>fib (n-2)</code> and <code>fib (n-1)</code> values. The two <code>1</code>s at the beginning are of course the base cases. There are <a href=\"https://stackoverflow.com/q/1105765/791604\">other good questions here on SO</a> that explain this technique in further detail, and you should study this code and those answers until you feel you understand how it works and why it is very fast.</p>\n\n<p>If necessary, one can recover the <code>Int -&gt; Integer</code> type signature from this using <code>(!!)</code>.</p>\n\n<p>Let's try to apply this technique to your function. As with computing Fibonacci numbers, you need the previous and second-to-last values; and additionally need the current index. That can be done by including <code>[2..]</code> in the call to <code>zipWith</code>. Here's how it would look:</p>\n\n<pre><code>waves :: [Integer]\nwaves = 1 : 1 : zipWith3 thisWave [2..] waves (tail waves) where\n    thisWave n back2 back1 = ((3 * n - 3) * back2 + (2 * n + 1) * back1) `div` (n + 2)\n</code></pre>\n\n<p>As before, one can recover the function version with <code>(!!)</code> or <code>genericIndex</code> (if one really needs <code>Integer</code> indices). We can confirm that it computes the same function (but faster, and using less memory) in ghci:</p>\n\n<pre><code>&gt; :set +s\n&gt; map wave [0..30]\n[1,1,2,4,9,21,51,127,323,835,2188,5798,15511,41835,113634,310572,853467,2356779,6536382,18199284,50852019,142547559,400763223,1129760415,3192727797,9043402501,25669818476,73007772802,208023278209,593742784829,1697385471211]\n(6.00 secs, 3,334,097,776 bytes)\n&gt; take 31 waves\n[1,1,2,4,9,21,51,127,323,835,2188,5798,15511,41835,113634,310572,853467,2356779,6536382,18199284,50852019,142547559,400763223,1129760415,3192727797,9043402501,25669818476,73007772802,208023278209,593742784829,1697385471211]\n(0.00 secs, 300,696 bytes)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1474431653, "post_id": 39606791, "comment_id": 66523057, "body": "You will need to use the <code>Integer</code> type for your <code>mwave</code> function. <code>Int</code> does not support 100-digit numbers."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1474446085, "post_id": 39606791, "comment_id": 66529633, "body": "you wanted <code>Integer</code>; <code>Int</code> is no good here (try <code>mwave !! 43</code>).  see <a href=\"https://www.haskell.org/hoogle/?hoogle=%5Ba%5D+-%3E+Integer+-%3E+a\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=%5Ba%5D+-%3E+Integer+-%3E+a</a>."}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474473559, "post_id": 39606791, "comment_id": 66548419, "body": "@WillNess When I change the signature of <code>mwave</code>, it gives and error: <code>Couldn&#39;t match expected type &#39;Integer&#39; with actual type Int&#39;</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1474478291, "post_id": 39606791, "comment_id": 66551127, "body": "yes, <code>!!</code> is the culprit, its type is: .... (try <code>Prelude&gt; :t (!!)</code>) . And the type of <code>genericIndex</code> is: .... . Have you tried the link I provided above?"}, {"owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474487302, "post_id": 39606791, "comment_id": 66555930, "body": "@WillNess, I cannot use external packages other than the ones in <code>Prelude</code>. Can you suggest an alternative?? Thanks."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1474487627, "post_id": 39606791, "comment_id": 66556117, "body": "in that case, give it the big type and sprinkle the <code>fromIntegral</code>s throughout your code for good measure. I.e. instead of <code>a !! n</code> write <code>a !! (fromIntegral n)</code>. Or better, give it the <code>Int -&gt; Integer</code> signature and write <code>(3 * fromIntegral n - 3) * mwave (n - 2) ...</code>. <code>n</code> will be <code>Int</code> (and <code>!!</code> expects <code>Int</code> as its 2nd arg), but the result of <code>mwave n</code> will be <code>Integer</code>, hence <code>fromIntegral n</code> will be <code>Integer</code> and calculation will typecheck."}], "tags": [], "owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "is_accepted": false, "score": 0, "last_activity_date": 1474446165, "last_edit_date": 1474446165, "creation_date": 1474426500, "answer_id": 39606791, "question_id": 39601277, "link": "https://stackoverflow.com/questions/39601277/haskell-code-running-too-slow/39606791#39606791", "title": "Haskell: Code running too slow", "body": "<p>Thanks everyone for your responses. Based on my understanding of <code>Memoization</code>, I have re-written the code as:</p>\n\n<pre><code>mwave :: Int -&gt; Int\nmwave = (map wave [0..] !!)\n  where wave 0 = 1\n        wave 1 = 1\n        wave n = ((3 * n - 3) * mwave (n - 2) + (2 * n + 1) * mwave (n - 1)) `div` (n + 2)\n\ndigits :: Int -&gt; Int\ndigits n = (mwave n) `mod` 10^(100::Int)\n</code></pre>\n\n<p>Any thoughts on how to <strong>output the answer modulo 10^100?</strong></p>\n"}], "owner": {"reputation": 555, "user_id": 5973371, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/57038c49f6bb5b7ab57269bc1f00ab93?s=128&d=identicon&r=PG", "display_name": "Zubin Kadva", "link": "https://stackoverflow.com/users/5973371/zubin-kadva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1488739968, "creation_date": 1474396048, "last_edit_date": 1488739968, "question_id": 39601277, "link": "https://stackoverflow.com/questions/39601277/haskell-code-running-too-slow", "title": "Haskell: Code running too slow", "body": "<p>I have a code which computes a Motzkin number as:</p>\n\n<pre><code>module Main where\n\n    -- Program execution begins here\n    main :: IO ()\n    main = interact (unlines . (map show) . map wave . (map read) . words)\n\n    -- Compute Motzkin number\n    wave :: Integer -&gt; Integer\n    wave 0 = 1\n    wave 1 = 1\n    wave n = ((3 * n - 3) * wave (n - 2) + (2 * n + 1) * wave (n - 1)) `div` (n + 2)\n</code></pre>\n\n<p>But the output for even a simple number as <code>30</code> takes a while to return.</p>\n\n<p>Any optimization ideas??</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 0, "creation_date": 1474395755, "post_id": 39601054, "comment_id": 66510710, "body": "Thanks! I wanted to make sure you pass only String values as function param like in C for example function x(char a){}"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 0, "creation_date": 1474395848, "post_id": 39601054, "comment_id": 66510749, "body": "That is achieved by declaring the type as <code>String -&gt; String</code>."}, {"owner": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 0, "creation_date": 1474395927, "post_id": 39601054, "comment_id": 66510799, "body": "So there is no way of having something like this (String a) =&gt; a -&gt; a ?"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 0, "creation_date": 1474395980, "post_id": 39601054, "comment_id": 66510831, "body": "I&#39;m confused - What do you want that to do?"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 1, "creation_date": 1474396009, "post_id": 39601054, "comment_id": 66510847, "body": "@vodich No, since <code>String</code> is a type, not a constraint on some type."}, {"owner": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 0, "creation_date": 1474396112, "post_id": 39601054, "comment_id": 66510913, "body": "Ok thanks for the help, cheers!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 0, "creation_date": 1474400190, "post_id": 39601054, "comment_id": 66513278, "body": "@vodich What do you want <code>String a =&gt; a -&gt; a</code> to mean that is different from what you believe <code>String -&gt; String</code> means?"}, {"owner": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "edited": false, "score": 0, "creation_date": 1474400570, "post_id": 39601054, "comment_id": 66513504, "body": "I guess I thought you can have String x like in Typeclass Num x and then x is used instead of String -&gt; String x -&gt; x. Nevermind I just read a section about types in &quot;Haskell Programming from first principles&quot; so all is clear now"}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 13, "last_activity_date": 1505239541, "last_edit_date": 1505239541, "creation_date": 1474395316, "answer_id": 39601054, "question_id": 39601008, "link": "https://stackoverflow.com/questions/39601008/why-can-string-not-be-used-in-a-constraint/39601054#39601054", "title": "Why can String not be used in a constraint?", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-String.html#t:String\" rel=\"noreferrer\"><code>String</code></a> is a type:</p>\n\n<pre><code>type String = [Char]\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#t:Num\" rel=\"noreferrer\"><code>Num</code></a> is a class:</p>\n\n<pre><code>class Num a where\n    (+), (-), (*)       :: a -&gt; a -&gt; a\n    negate              :: a -&gt; a\n    abs                 :: a -&gt; a\n    signum              :: a -&gt; a\n    fromInteger         :: Integer -&gt; a\n    negate x            = 0 - x\n</code></pre>\n\n<p>Constraints only involve classes, not types.</p>\n\n<p>Your <code>ltest'</code> has a type parameter, <code>a</code>.<sup>1</sup> This can be expressed explicitly:</p>\n\n<pre><code>ltest' :: forall a. (Num a) =&gt; a -&gt; a\n</code></pre>\n\n<p>This means it works with any type <code>a</code> that has an instance of the <code>Num</code> class.</p>\n\n<p>Your <code>test'</code> doesn't need type parameters, because it only works with one type<sup>2</sup> (the argument can only be of type <code>String</code>). So it also doesn't need any constraints, because there are no type parameters to constrain.</p>\n\n<pre><code>test' :: String -&gt; String\ntest' a = a ++ \" good job\"\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> In other words, <code>ltest'</code> has a <em>polymorphic</em> type.</p>\n\n<p><sup>2</sup> In other words, <code>test'</code> has a <em>monomorphic</em> type.</p>\n"}], "owner": {"reputation": 2696, "user_id": 1352426, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mQFHO.png?s=128&g=1", "display_name": "v0d1ch", "link": "https://stackoverflow.com/users/1352426/v0d1ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1604, "favorite_count": 1, "closed_date": 1474400135, "accepted_answer_id": 39601054, "answer_count": 1, "score": 2, "last_activity_date": 1505239541, "creation_date": 1474395142, "last_edit_date": 1474396069, "question_id": 39601008, "link": "https://stackoverflow.com/questions/39601008/why-can-string-not-be-used-in-a-constraint", "closed_reason": "Duplicate", "title": "Why can String not be used in a constraint?", "body": "<p>How come I can't set a <code>String</code> constraint, but a <code>Num</code> works just fine?</p>\n\n<p>This works:</p>\n\n<pre><code>ltest' :: (Num a) =&gt; a -&gt; a\nltest' a = (\\b -&gt; b * 2) a\n</code></pre>\n\n<p>This does not:</p>\n\n<pre><code>test' :: (String a) =&gt; a -&gt; a\ntest' a = a ++ \" good job\"\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>\u2022 Expecting one fewer argument to \u2018String\u2019\n  Expected kind \u2018* -&gt; Constraint\u2019, but \u2018String\u2019 has kind \u2018*\u2019\n\u2022 In the type signature:\n    test' :: (String a) =&gt; a -&gt; a\n</code></pre>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1474390721, "post_id": 39599346, "comment_id": 66508089, "body": "Try <code>instance Print&#39; HFalse a</code> for your second instance"}, {"owner": {"reputation": 2878, "user_id": 191584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5f4f7f52bd218b462400abf6c8e3065?s=128&d=identicon&r=PG", "display_name": "kloffy", "link": "https://stackoverflow.com/users/191584/kloffy"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1474391633, "post_id": 39599346, "comment_id": 66508567, "body": "Thanks for the suggestion, it sounds reasonable, but unfortunately results in another error (see edit)."}, {"owner": {"reputation": 2878, "user_id": 191584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5f4f7f52bd218b462400abf6c8e3065?s=128&d=identicon&r=PG", "display_name": "kloffy", "link": "https://stackoverflow.com/users/191584/kloffy"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1474392333, "post_id": 39599346, "comment_id": 66508937, "body": "@dfeuer Awesome, that works! If you post a very short explanation in an answer I would be happy to accept it."}], "answers": [{"comments": [{"owner": {"reputation": 2878, "user_id": 191584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5f4f7f52bd218b462400abf6c8e3065?s=128&d=identicon&r=PG", "display_name": "kloffy", "link": "https://stackoverflow.com/users/191584/kloffy"}, "edited": false, "score": 0, "creation_date": 1474392770, "post_id": 39600348, "comment_id": 66509157, "body": "Brilliant, many thanks! I have incorporated the suggestions into a complete working example."}, {"owner": {"reputation": 2878, "user_id": 191584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5f4f7f52bd218b462400abf6c8e3065?s=128&d=identicon&r=PG", "display_name": "kloffy", "link": "https://stackoverflow.com/users/191584/kloffy"}, "edited": false, "score": 0, "creation_date": 1474393421, "post_id": 39600348, "comment_id": 66509449, "body": "Interesting! I don&#39;t mind the proxy though, seems a lot cleaner than <code>undefined</code>. Thanks again!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2878, "user_id": 191584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5f4f7f52bd218b462400abf6c8e3065?s=128&d=identicon&r=PG", "display_name": "kloffy", "link": "https://stackoverflow.com/users/191584/kloffy"}, "edited": false, "score": 0, "creation_date": 1474394601, "post_id": 39600348, "comment_id": 66510083, "body": "@kloffy, uh... actually, that alternate approach doesn&#39;t work here. Sorry! Forget that!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1474394614, "last_edit_date": 1495541963, "creation_date": 1474392599, "answer_id": 39600348, "question_id": 39599346, "link": "https://stackoverflow.com/questions/39599346/avoiding-overlapping-instances-with-closed-type-families-ghc-advancedoverlap/39600348#39600348", "title": "Avoiding Overlapping Instances with Closed Type Families (GHC/AdvancedOverlap)", "body": "<p>The initial error was caused by</p>\n\n<pre><code>instance Show a =&gt; Print' HTrue a where\n  print' _ x = putStrLn (show x)\n\ninstance Print' flag a where\n  print' _ _ = putStrLn \"No show method\"\n</code></pre>\n\n<p>These instances overlap when <code>flag ~ HTrue</code>. The solution to this is to replace the second instance with</p>\n\n<pre><code>instance Print' HFalse a where ...\n</code></pre>\n\n<p>Your next problem was with</p>\n\n<pre><code>instance (ShowPred a ~ flag, Print' flag a) =&gt; Print a where\n  print = print' (undefined :: flag)\n</code></pre>\n\n<p>By default, the <code>flag</code> variable in the instance context is not in scope in the instance body, so <code>undefined :: flag</code> has an ambiguous type. The solution is to enable <code>ScopedTypeVariables</code>.</p>\n\n<p>My final note is that instead of making <code>print'</code> take a value of type <code>flag</code> and then passing it <code>undefined</code>, you should probably use</p>\n\n<pre><code>print' :: proxy flag -&gt; a -&gt; IO ()\n</code></pre>\n\n<p>and then import <code>Data.Proxy</code> to define</p>\n\n<pre><code>print = print' (Proxy :: Proxy flag)\n</code></pre>\n\n<p>The modern proxy-passing approach seems to be quite new, although less-satisfactory versions have been around for some time. See the answer to <a href=\"https://stackoverflow.com/questions/37261593/who-invented-proxy-passing-and-when\">this question</a> for some historical context.</p>\n"}], "owner": {"reputation": 2878, "user_id": 191584, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5f4f7f52bd218b462400abf6c8e3065?s=128&d=identicon&r=PG", "display_name": "kloffy", "link": "https://stackoverflow.com/users/191584/kloffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 1, "accepted_answer_id": 39600348, "answer_count": 1, "score": 2, "last_activity_date": 1474394614, "creation_date": 1474388885, "last_edit_date": 1474392879, "question_id": 39599346, "link": "https://stackoverflow.com/questions/39599346/avoiding-overlapping-instances-with-closed-type-families-ghc-advancedoverlap", "title": "Avoiding Overlapping Instances with Closed Type Families (GHC/AdvancedOverlap)", "body": "<p>Any pointers on how to make the closed type family example from the Haskell Wiki compile?</p>\n\n<p><a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap\" rel=\"nofollow\">GHC/AdvancedOverlap</a> (Solution 3)</p>\n\n<p>Here is the version I tried:</p>\n\n<pre><code>{-# LANGUAGE \n    DataKinds,\n    FlexibleInstances,\n    MultiParamTypeClasses,\n    TypeFamilies,\n    UndecidableInstances #-}\n\ndata HTrue\ndata HFalse\n\ntype family ShowPred a where\n  ShowPred Int   = HTrue\n  ShowPred Bool  = HTrue\n  ShowPred [a]   = ShowPred a\n  ShowPred a     = HFalse\n\nclass Print a where\n  print :: a -&gt; IO ()\n\ninstance (ShowPred a ~ flag, Print' flag a) =&gt; Print a where\n  print = print' (undefined :: flag)\n\nclass Print' flag a where\n  print' :: flag -&gt; a -&gt; IO ()\n\ninstance Show a =&gt; Print' HTrue a where\n  print' _ x = putStrLn (show x)\n\ninstance Print' flag a where\n  print' _ _ = putStrLn \"No show method\"\n</code></pre>\n\n<p>However, this still gives me:</p>\n\n<blockquote>\n  <p>Overlapping instances for Print' flag0 a.</p>\n</blockquote>\n\n<p>(GHC 8.0.1 is the version I am using.)</p>\n\n<p><strong>Edit:</strong> Defining the second instance as <code>Print' HFalse a</code> results in:</p>\n\n<blockquote>\n  <p>Could not deduce (Print' flag0 a) arising from a use of print' from the context: (ShowPred a ~ flag, Print' flag a).</p>\n</blockquote>\n\n<p><strong>Edit:</strong> Here is the example with all the corrections. All credit goes to @dfeuer.</p>\n\n<pre><code>{-# LANGUAGE \n    DataKinds,\n    FlexibleInstances,\n    MultiParamTypeClasses,\n    ScopedTypeVariables,\n    TypeFamilies,\n    UndecidableInstances #-}\n\nimport Prelude hiding (print)\n\nimport Data.Proxy\n\ndata HTrue\ndata HFalse\n\ntype family ShowPred a where\n  ShowPred Int   = HTrue\n  ShowPred Bool  = HTrue\n  ShowPred [a]   = ShowPred a\n  ShowPred a     = HFalse\n\nclass Print a where\n  print :: a -&gt; IO ()\n\ninstance (ShowPred a ~ flag, Print' flag a) =&gt; Print a where\n  print = print' (Proxy :: Proxy flag)\n\nclass Print' flag a where\n  print' :: Proxy flag -&gt; a -&gt; IO ()\n\ninstance Show a =&gt; Print' HTrue a where\n  print' _ x = putStrLn (show x)\n\ninstance Print' HFalse a where\n  print' _ _ = putStrLn \"No show method\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1474379044, "post_id": 39595244, "comment_id": 66500208, "body": "Where is <code>StateFormulaN</code>? What are you <i>hoping</i> to write?"}, {"owner": {"reputation": 31, "user_id": 6853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41743495ab013b01257ce2695f31b28d?s=128&d=identicon&r=PG&f=1", "display_name": "Planteur", "link": "https://stackoverflow.com/users/6853426/planteur"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1474380540, "post_id": 39595244, "comment_id": 66501301, "body": "<code>StateFormulaN</code> was a shortcut for <code>StateFormula1</code> to eg <code>StateFormula6</code> (I have edited my question as this was unclear). I&#39;m hoping to write a system for generating forms with interdependent fields, that should be compilable to JS (with Haste) or to another kind of applications (thus requiring different <code>State</code> instances). If it was possible for the base form code to be ignorant of the specific constraints (while keeping the compilation errors when the constraints actually do not match), the code of each application could directly reuse it, limiting the amount of code generation involved."}, {"owner": {"reputation": 31, "user_id": 6853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41743495ab013b01257ce2695f31b28d?s=128&d=identicon&r=PG&f=1", "display_name": "Planteur", "link": "https://stackoverflow.com/users/6853426/planteur"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1474381366, "post_id": 39595244, "comment_id": 66501899, "body": "Also, this is for a Haskell learning project, which should actually end up in a real-world application (the reason why I chose Haskell for this, besides the language in itself, is the type system, allowing to ensure at compile time that everything is seemingly right, starting from a form configuration written in YAML, and QuickCheck, which should really come in handy for various testing purposes)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1474381564, "post_id": 39595244, "comment_id": 66502048, "body": "Please don&#39;t turn on GHC extensions that you don&#39;t even use, in particular not so adventurous ones as <code>AllowAmbiguousTypes</code> and <code>DeriveAnyClass</code>. Generally, and for StackOverflow questions in particular."}, {"owner": {"reputation": 31, "user_id": 6853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41743495ab013b01257ce2695f31b28d?s=128&d=identicon&r=PG&f=1", "display_name": "Planteur", "link": "https://stackoverflow.com/users/6853426/planteur"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474382121, "post_id": 39595244, "comment_id": 66502472, "body": "@leftaroundabout Sorry, I&#39;ll keep that in mind (those were residuals of my previous tests)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474387038, "post_id": 39595244, "comment_id": 66505791, "body": "You don&#39;t need any constraint on <code>StateFormulaPart</code>, you just need a <code>StateGettable state a</code> constraint in <code>StateFormula1</code> (which also means it must have another paramater - <code>state</code>). In any case, <code>StateFormula1</code> doesn&#39;t seem like a very interesting type, so it isn&#39;t really clear what the actual use case is (you&#39;ve stated what you hope to accomplish, not what you have tried to do)."}, {"owner": {"reputation": 31, "user_id": 6853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41743495ab013b01257ce2695f31b28d?s=128&d=identicon&r=PG&f=1", "display_name": "Planteur", "link": "https://stackoverflow.com/users/6853426/planteur"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474442756, "post_id": 39595244, "comment_id": 66527667, "body": "@user2407038 What I have tried to do is to have generic <code>StateFormula[N]</code> definitions, which could be applied to different <code>State</code> values, while only getting compilation errors when trying to use a <code>StateFormula[N]</code> on a <code>State</code> with non-matching constraints. Anyway, I think that I&#39;m starting to grasp why this isn&#39;t possible - thanks for putting me back on the right track! (if you can post an answer, I will gladly accept it)"}], "owner": {"reputation": 31, "user_id": 6853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41743495ab013b01257ce2695f31b28d?s=128&d=identicon&r=PG&f=1", "display_name": "Planteur", "link": "https://stackoverflow.com/users/6853426/planteur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1474381996, "creation_date": 1474377532, "last_edit_date": 1592644375, "question_id": 39595244, "link": "https://stackoverflow.com/questions/39595244/could-not-deduce-from-the-context-is-it-possible-to-avoid-explicit-constr", "title": "Could not deduce [..] from the context - Is it possible to avoid explicit constraints?", "body": "<p>Given the code below (that can be modified and compiled online <a href=\"http://rextester.com/BDCXL11499\" rel=\"nofollow noreferrer\">here</a>), the compilation gives this error:</p>\n<blockquote>\n<p>Could not deduce (Num a1) arising from a use of \u2018solveFormulaPart\u2019 from the context:</p>\n<p>StateGettable IdState a</p>\n<p>bound by the type signature for:</p>\n<p>solveFormula :: StateGettable IdState a =&gt; IdState -&gt; StateFormula1 a  StateMonad IdState a</p>\n<p>Possible fix: add (Num a1) to the context of the data constructor \u2018StateFormula1\u2019</p>\n</blockquote>\n<p>Is there any solution that could remove the need for having to explicitly give all the constraints on the <code>StateFormula1</code> and <code>StateFormulaPart</code> data constructors? (ideally, the same <code>StateFormula</code> instance should be reusable as-is with any <code>State</code> instance, as long as the underlying type seemingly matches the required constraints at use site)</p>\n<pre><code>{-# LANGUAGE ConstraintKinds        #-}\n{-# LANGUAGE FlexibleContexts       #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE GADTs                  #-}\n{-# LANGUAGE InstanceSigs           #-}\n{-# LANGUAGE MultiParamTypeClasses  #-}\n{-# LANGUAGE TypeFamilies           #-}\n\n\nimport           Control.Monad.Trans.Maybe\nimport           Control.Monad.IO.Class\nimport           Control.Monad.Trans.Class\nimport           GHC.Exts (Constraint)\n\ndata StateFormulaPart a where\n    Constant :: a -&gt; StateFormulaPart a\n    Property :: (StateProperty a) -&gt; StateFormulaPart a\n\n\ntype SFP a = StateFormulaPart a\n\n\ndata StateFormula1 b where\n    StateFormula1 :: SFP a\n                  -&gt; (a -&gt; b)\n                  -&gt; StateFormula1 b\n\n\nclass StateFormula formula where\n    -- todo remove this if the kind can be inferred using another method\n    explicitKind :: formula a -&gt; formula a\n\n\ninstance StateFormula StateFormula1\n\n\ndata StateProperty a =\n    StateProperty { propertyKey     :: String\n                  , propertyDefault ::  a\n                  }\n\n\nclass Monad (StateMonad state) =&gt; State state where\n    type StateMonad state :: * -&gt; *\n    type StateGettable state :: * -&gt; Constraint\n    getPropertyValue :: StateGettable state a =&gt; state -&gt; StateProperty a -&gt; StateMonad state a\n\n\nclass (StateFormula formula, State state) =&gt; StateSolver state formula where\n    solveFormula :: StateGettable state a =&gt; state -&gt; (formula a) -&gt; StateMonad state a\n    solveFormulaPart :: StateGettable state a =&gt; state -&gt; (SFP a) -&gt; StateMonad state a\n    \n\ndata IdState = IdState\n\n\ninstance State IdState where\n    type StateMonad IdState = MaybeT IO\n    type StateGettable IdState = Num\n\n\ninstance StateSolver IdState StateFormula1 where\n    -- solveFormulaPart :: Num a =&gt; IdState -&gt; SFP a -&gt; MaybeT IO a\n    solveFormulaPart s (Constant x) = return x\n    solveFormulaPart s (Property p) = do\n        liftIO $ print (propertyKey p)\n        return (propertyDefault p)\n\n    -- solveFormula :: Num a =&gt; IdState -&gt; StateFormula1 a -&gt; MaybeT IO a\n    solveFormula s (StateFormula1 p1 f) = do\n        x1 &lt;- solveFormulaPart s p1\n        return $ f x1\n    \n\nworkingFormula :: StateFormula1 Int\nworkingFormula = StateFormula1 (Property $ StateProperty &quot;test&quot; 5 :: StateFormulaPart Int) id\n\n\nmain = runMaybeT $ solveFormula IdState workingFormula\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "is_accepted": true, "score": 0, "last_activity_date": 1474446270, "creation_date": 1474446270, "answer_id": 39611184, "question_id": 39594263, "link": "https://stackoverflow.com/questions/39594263/stack-test-contaminating-my-src-dir-with-dump-hi-files/39611184#39611184", "title": "stack test Contaminating My src Dir with dump-hi files", "body": "<p>In my cabal file, I have an entry in <code>ghc-options</code> in <code>test-suite</code> to include a module that I am not exposing. Well, I had been experimenting and had put the fully qualified path as:</p>\n\n<p><code>-i/path/to/my/project/src</code></p>\n\n<p>instead of just:</p>\n\n<p><code>-isrc</code></p>\n\n<p>When the fully qualified path is there, the <code>.dump-hi</code> files get generated during <code>stack test</code>, and when the relative path is there, they do not.</p>\n\n<p>Why I don't know, but that was the solution.</p>\n"}], "owner": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 39611184, "answer_count": 1, "score": 2, "last_activity_date": 1474446270, "creation_date": 1474374917, "question_id": 39594263, "link": "https://stackoverflow.com/questions/39594263/stack-test-contaminating-my-src-dir-with-dump-hi-files", "title": "stack test Contaminating My src Dir with dump-hi files", "body": "<p>I am using stack and GHC 7.10.</p>\n\n<p>When I run <code>stack test</code>, I end up with one <code>.dump-hi</code> file for every one of my <code>.hs</code> files. How can I prevent stack/ghc from generating these files?</p>\n\n<p>Or at least make sure they are deleted by the test process after it finishes?</p>\n"}, {"tags": ["haskell", "haskell-stack", "haddock"], "answers": [{"comments": [{"owner": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "edited": false, "score": 0, "creation_date": 1474613233, "post_id": 39632459, "comment_id": 66611082, "body": "OK. So the index page of the dependencies will not be included in the distribution?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "edited": false, "score": 0, "creation_date": 1474617777, "post_id": 39632459, "comment_id": 66613781, "body": "I don&#39;t know what distribution means here."}, {"owner": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "edited": false, "score": 0, "creation_date": 1474617889, "post_id": 39632459, "comment_id": 66613829, "body": "When you create your package for hackage."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "edited": false, "score": 0, "creation_date": 1474620178, "post_id": 39632459, "comment_id": 66615020, "body": "If you mean <code>stack sdist</code> or <code>stack upload</code>, it never includes generated HTML of any form."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1474528181, "creation_date": 1474528181, "answer_id": 39632459, "question_id": 39591967, "link": "https://stackoverflow.com/questions/39591967/stack-haddock-do-not-generate-docs-for-dependencies/39632459#39632459", "title": "Stack Haddock - Do not generate docs for dependencies", "body": "<p>Those are just index files, containing links to all of the available documented modules. The creation of a local packages + dependencies index does not mean that it is in fact creating documentation for the dependencies, just that it's updating that index for your local packages.</p>\n"}], "owner": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 871, "favorite_count": 0, "accepted_answer_id": 39632459, "answer_count": 1, "score": 4, "last_activity_date": 1474528181, "creation_date": 1474367949, "last_edit_date": 1474443108, "question_id": 39591967, "link": "https://stackoverflow.com/questions/39591967/stack-haddock-do-not-generate-docs-for-dependencies", "title": "Stack Haddock - Do not generate docs for dependencies", "body": "<p>I am generating my haddocks with:</p>\n\n<p><code>stack haddock  --no-haddock-deps</code></p>\n\n<p>My understanding of this option from the help:</p>\n\n<p><code>Enable/disable building Haddocks for dependencies</code></p>\n\n<p>would be that it would not generate haddocks for any dependencies. But this is not the case. It generates two html files:</p>\n\n<p><code>Updating Haddock index for local packages in\n/myDir/.stack-work/install/x86_64-osx/lts-6.16/7.10.3/doc/index.html\nUpdating Haddock index for local packages and dependencies in\n/myDir/.stack-work/install/x86_64-osx/lts-6.16/7.10.3/doc/all/index.html\n</code></p>\n\n<p>I do not want docs for the dependencies. Only my modules. How can I do this?</p>\n"}, {"tags": ["c", "haskell", "ffmpeg", "installation", "cabal"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1474379806, "post_id": 39591891, "comment_id": 66500772, "body": "You need <code>--extra-include-dirs</code> to tell ghc where to find the header file."}, {"owner": {"reputation": 31, "user_id": 3717652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad83a0e9e2800ebe61089bdb7f3d3de?s=128&d=identicon&r=PG&f=1", "display_name": "WirflBirfl", "link": "https://stackoverflow.com/users/3717652/wirflbirfl"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1474387710, "post_id": 39591891, "comment_id": 66506212, "body": "@Thomas M. DuBuisson: Thanks, that got me a step further. Edited my question."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1474392176, "post_id": 39591891, "comment_id": 66508855, "body": "I think you need to escape your slashes.  Ex: <code>--extra-include-dirs=C:\\\\FFmpeg\\\\include</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 3717652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad83a0e9e2800ebe61089bdb7f3d3de?s=128&d=identicon&r=PG&f=1", "display_name": "WirflBirfl", "link": "https://stackoverflow.com/users/3717652/wirflbirfl"}, "is_accepted": false, "score": 0, "last_activity_date": 1474392251, "creation_date": 1474392251, "answer_id": 39600256, "question_id": 39591891, "link": "https://stackoverflow.com/questions/39591891/install-ffmpeg-light-with-cabal/39600256#39600256", "title": "Install ffmpeg-light with cabal", "body": "<p>OK. I figured it out. The --ghc-pkg-options=\"--force\" option was needed.<br><br>\n<code>cabal install ffmpeg-light --extra-lib-dirs=C:\\FFmpeg\\lib --extra-include-dirs=C:\\FFmpeg\\include --ghc-pkg-options=\"--force\"</code></p>\n"}], "owner": {"reputation": 31, "user_id": 3717652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad83a0e9e2800ebe61089bdb7f3d3de?s=128&d=identicon&r=PG&f=1", "display_name": "WirflBirfl", "link": "https://stackoverflow.com/users/3717652/wirflbirfl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1474392251, "creation_date": 1474367678, "last_edit_date": 1474392149, "question_id": 39591891, "link": "https://stackoverflow.com/questions/39591891/install-ffmpeg-light-with-cabal", "title": "Install ffmpeg-light with cabal", "body": "<p>I want to install the ffmpeg-light library from hackage via cabal on Windows 10 (64 bit). So I downloaded ffmpeg and extracted it to C:\\FFmpeg. </p>\n\n<p>At first pkg-config was complaining that it could not find various packages. I solved this problem with .pc files.</p>\n\n<p>When I tried to use the command: <code>cabal install ffmpeg-light</code> cabal complained about missing C-libraries, being exactly those for which I created the .pc files.</p>\n\n<p>Then I tried the command: <code>cabal install ffmpeg-light --extra-lib-dirs=C:\\FFmpeg\\lib</code>. Now I have a different error message, which says:</p>\n\n<pre><code>Enums.hsc:7:32: fatal error: libavcodec/avcodec.h: No such file or directory\n</code></pre>\n\n<p><b>Edit:</b><br>\nThen I tried the following command:</p>\n\n<pre><code>cabal install ffmpeg-light --extra-lib-dirs=C:\\FFmpeg\\lib \\\n                           --extra-include-dirs=C:\\FFmpeg\\include\n</code></pre>\n\n<p>Now first the compiler gives some warnings about deprecated functions in ffmpeg and redundant imports in ffmpeg-light, but compiles 11 of 11. But the build is still not successfull.</p>\n\n<pre><code>In-place registering ffmpeg-light-0.11.1...\nsetup-Simple-Cabal-1.22.5.0-x86_64-windows-ghc-7.10.3.exe:\n'C:\\Haskell\\bin\\ghc-pkg.exe' exited with an error:\nffmpeg-light-0.11.1: Warning: haddock-interfaces:\nC:\\Users\\HOLEYC~1\\AppData\\Local\\Temp\\cabal-tmp-2824\\ffmpeg-light-0.11.1\\dist\\doc\\html\\ffmpeg-light\\ffmpeg-light.haddock\ndoesn't exist or isn't a file\nffmpeg-light-0.11.1: Warning: haddock-html:\nC:\\Users\\HOLEYC~1\\AppData\\Local\\Temp\\cabal-tmp-2824\\ffmpeg-light-0.11.1\\dist\\doc\\html\\ffmpeg-light\ndoesn't exist or isn't a directory\nffmpeg-light-0.11.1: library-dirs: C:FFmpeglib is a relative path which makes\nno sense (as there is nothing for it to be relative to). You can make paths\nrelative to the package database itself by using ${pkgroot}. (use --force to\noverride)\nffmpeg-light-0.11.1: include-dirs: C:FFmpeginclude is a relative path which\nmakes no sense (as there is nothing for it to be relative to). You can make\npaths relative to the package database itself by using ${pkgroot}. (use\n--force to override)\ncabal: Error: some packages failed to install:\nffmpeg-light-0.11.1 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p><b>Some additional information:</b><br><br></p>\n\n<pre><code>cabal version: cabal-install version 1.22.6.0\nusing version 1.22.5.0 of the Cabal library\ngcc version of my installed Haskell platform: 5.2.0\n</code></pre>\n\n<p>Example .pc file I used for pkg-config:</p>\n\n<pre><code>Name: libavcodec\nDescription: Library for ffmpeg\nVersion: 57\nCflags: -IC:\\FFmpeg\\include\nLibs: -LC:\\FFmpeg\\lib -llibavcodec\n</code></pre>\n"}, {"tags": ["haskell", "charts", "haskell-chart"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 7, "last_activity_date": 1474376036, "creation_date": 1474376036, "answer_id": 39594681, "question_id": 39590596, "link": "https://stackoverflow.com/questions/39590596/generate-bytestring-in-haskell-chart/39594681#39594681", "title": "Generate ByteString in Haskell-Chart", "body": "<p>Unfortunately this is not possible is a direct manner. <a href=\"http://hackage.haskell.org/package/Chart-cairo-1.7.1/docs/src/Graphics-Rendering-Chart-Backend-Cairo.html#toFile\"><code>toFile</code></a> calls upon functions in the <a href=\"http://hackage.haskell.org/package/cairo-0.13.1.1\"><code>cairo</code></a> library like <a href=\"http://hackage.haskell.org/package/cairo-0.13.1.1/docs/Graphics-Rendering-Cairo.html#v:withPDFSurface\"><code>withPDFSurface</code></a>, <a href=\"http://hackage.haskell.org/package/cairo-0.13.1.1/docs/Graphics-Rendering-Cairo.html#v:withSVGSurface\"><code>withSVGSurface</code></a> which themselves call into the cairo C-library and only take file names.</p>\n\n<p>You can always write to a temporary file and read the contents back in like this:</p>\n\n<pre><code>import System.IO.Temp  -- from the temporary package\nimport qualified Data.ByteString.Char8 as BS\n\n...\nbs &lt;- withSystemTempFile \"chart-XXXXXXX\" $ \\path _ -&gt; do\n        toFile def path $ do ...\n        BS.readFile path\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 7768228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c92f30f41999c937ad5c44313248ec?s=128&d=identicon&r=PG&f=1", "display_name": "shem", "link": "https://stackoverflow.com/users/7768228/shem"}, "is_accepted": false, "score": 1, "last_activity_date": 1540661638, "creation_date": 1540661638, "answer_id": 53024551, "question_id": 39590596, "link": "https://stackoverflow.com/questions/39590596/generate-bytestring-in-haskell-chart/53024551#53024551", "title": "Generate ByteString in Haskell-Chart", "body": "<p>it's possible but only with Diagrams backend which is slower. </p>\n\n<p>`</p>\n\n<pre><code>import Graphics.Rendering.Chart.State(EC, execEC)\nimport Graphics.Rendering.Chart.Easy\nimport Graphics.Rendering.Chart.Backend.Diagrams\nimport qualified Diagrams.Backend.SVG as DSVG\nimport qualified Diagrams.Prelude as D\nimport qualified Diagrams.TwoD as D2\n\ntoSVG :: (Default r,ToRenderable r) =&gt; EC r () -&gt; IO String\ntoSVG ec = do\n    fontSelector &lt;- _fo_fonts def\n    let cb = render (toRenderable (execEC ec))(_fo_size def)\n    let (w, h) = (800 :: Double, 600 :: Double)\n    let env = createEnv vectorAlignmentFns w h fontSelector\n    let (d, a) = runBackend env cb\n        opts = DSVG.SVGOptions (D2.dims2D w h) Nothing T.empty [] True\n        svg = D.renderDia DSVG.SVG opts d\n    return $ show svg\n</code></pre>\n\n<p>`</p>\n"}], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 1, "accepted_answer_id": 39594681, "answer_count": 2, "score": 6, "last_activity_date": 1546172667, "creation_date": 1474364073, "last_edit_date": 1546172667, "question_id": 39590596, "link": "https://stackoverflow.com/questions/39590596/generate-bytestring-in-haskell-chart", "title": "Generate ByteString in Haskell-Chart", "body": "<p>I use Haskell-Chart according to the example <a href=\"https://github.com/timbod7/haskell-chart/wiki/example-1\" rel=\"noreferrer\">eample-1</a>. Haskell-Chart generates content to file</p>\n\n<pre><code>toFile def \"example1_big.png\" $ do\n...\n</code></pre>\n\n<p>Is it possible generate content of chart to ByteString instead file?\nI can not find a solution in the documentation.</p>\n"}, {"tags": ["haskell", "widget", "handler", "yesod", "flags"], "answers": [{"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1474363833, "creation_date": 1474363833, "answer_id": 39590481, "question_id": 39589232, "link": "https://stackoverflow.com/questions/39589232/yesod-include-a-base-widget-only-once/39590481#39590481", "title": "Yesod - Include a base widget only once", "body": "<p>I think that's the purpose of widget, to allow to insert javascript only once. Your use case seemt to correspond to the described <a href=\"http://www.yesodweb.com/blog/2013/01/adding-css-js\" rel=\"nofollow\">there</a>. You should use <code>addScript</code> in <code>a</code> and it should be only added once.</p>\n"}], "owner": {"reputation": 806, "user_id": 1527537, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5cac7130ae6a4029c6fc00eadc5868e6?s=128&d=identicon&r=PG", "display_name": "Joe Shanahan", "link": "https://stackoverflow.com/users/1527537/joe-shanahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474365305, "creation_date": 1474360301, "last_edit_date": 1474365305, "question_id": 39589232, "link": "https://stackoverflow.com/questions/39589232/yesod-include-a-base-widget-only-once", "title": "Yesod - Include a base widget only once", "body": "<p>I have a <code>Widget</code> <code>a_i</code> that relies on a base <code>Widget</code> <code>b</code>. <code>b</code> contains Javascript that <code>a</code> requires to work.</p>\n\n<p>Currently, the widgets are included on a page like so:</p>\n\n<pre><code>getHomeR = defaultLayout $ do\n  b\n  a_1\n  a_2\n</code></pre>\n\n<p>I want to automatically include <code>b</code> if <code>a_i</code> is used but only do this once for any particular handler run.</p>\n\n<p><code>Widget</code> appears to use <code>IO</code> underneath - can I use this to set some kind of flag which allow <code>b</code> only to be included once? Is there already functionality to set some kind of flag that is exclusive to a single handler thread?</p>\n"}, {"tags": ["haskell", "types", "f#", "domain-driven-design"], "comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 5, "creation_date": 1474332786, "post_id": 39584104, "comment_id": 66478154, "body": "I think this is normally done with a module which hides the data constructor and exposes a function which wraps the data constructor. See the top answer here: <a href=\"http://stackoverflow.com/questions/39531032/using-types-to-force-correctness\" title=\"using types to force correctness\">stackoverflow.com/questions/39531032/&hellip;</a>"}, {"owner": {"reputation": 24860, "user_id": 124259, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d025118a63330a62aeaff66a420e8b1?s=128&d=identicon&r=PG&f=1", "display_name": "John Palmer", "link": "https://stackoverflow.com/users/124259/john-palmer"}, "edited": false, "score": 0, "creation_date": 1474341603, "post_id": 39584104, "comment_id": 66480143, "body": "In f# you could use access modifiers but it would be ugly"}, {"owner": {"reputation": 59630, "user_id": 636019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ba39c7ba510ac2951c010c26afb6a6?s=128&d=identicon&r=PG", "display_name": "ildjarn", "link": "https://stackoverflow.com/users/636019/ildjarn"}, "edited": false, "score": 1, "creation_date": 1474341916, "post_id": 39584104, "comment_id": 66480211, "body": "&quot;<i>Is there a language or type system that supports defining types that can only be instantiated via a specific function.</i>&quot; Well, C++ for one; but I don&#39;t know of any <i>Hindley\u2013Milner-based</i> type system that supports it outright, which seems to be what you&#39;re actually asking."}], "answers": [{"comments": [{"owner": {"reputation": 1325, "user_id": 1840315, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ea1c4692ce54d86dc6722bb9690a0bd0?s=128&d=identicon&r=PG", "display_name": "James Forbes", "link": "https://stackoverflow.com/users/1840315/james-forbes"}, "edited": false, "score": 0, "creation_date": 1474337127, "post_id": 39584216, "comment_id": 66479035, "body": "I was really hoping for the type itself to be bound to the function in the signature instead of taking advantage of module encapsulation.  But this is really helpful and answers the question."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 7, "last_activity_date": 1474355446, "last_edit_date": 1474355446, "creation_date": 1474333395, "answer_id": 39584216, "question_id": 39584104, "link": "https://stackoverflow.com/questions/39584104/nominal-types-bound-to-a-specific-function/39584216#39584216", "title": "Nominal types bound to a specific function", "body": "<p>Create a type, define a function to create values of that type, then export the type and your function but <em>not</em> the type\u2019s data constructor. For example, in Haskell, given your example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module My.Module.NonZeroInteger (NonZeroInteger, createNonZeroInteger) where\n\nnewtype NonZeroInteger = NonZeroInteger Integer\n  deriving (Show, Eq, Ord)\n\ncreateNonZeroInteger :: Integer -&gt; Maybe NonZeroInteger\ncreateNonZeroInteger 0 = Nothing\ncreateNonZeroInteger x = Just $ NonZeroInteger x\n</code></pre>\n\n<p>Consumers of <code>My.Module.NonZeroInteger</code> will be able to create values of type <code>NonZeroInteger</code>, but since the data constructor is not exported, they won\u2019t ever be able to create <code>NonZeroInteger</code>s that are internally <code>0</code>.</p>\n\n<p>The custom constructor function, in this case <code>createNonZeroInteger</code>, is traditionally called a <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow\">\u201csmart constructor\u201d</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 11496, "user_id": 5438433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OJ1qY.png?s=128&g=1", "display_name": "TheInnerLight", "link": "https://stackoverflow.com/users/5438433/theinnerlight"}, "is_accepted": false, "score": 2, "last_activity_date": 1474449790, "last_edit_date": 1474449790, "creation_date": 1474449322, "answer_id": 39612277, "question_id": 39584104, "link": "https://stackoverflow.com/questions/39584104/nominal-types-bound-to-a-specific-function/39612277#39612277", "title": "Nominal types bound to a specific function", "body": "<p>I think it's worth putting on record here that you can do exactly the same thing as Alexis King suggests in F# by making the union case constructors <code>private</code>.</p>\n\n<pre><code>type NonZeroInteger = private NonZeroInteger of int\n\nlet tryCreateNonZeroInteger = function\n    |0 -&gt; None\n    |x -&gt; Some &lt;| NonZeroInteger x\n</code></pre>\n\n<p>The type itself remains publically accessible but it can only be created and decomposed via functions you supply.</p>\n"}], "owner": {"reputation": 1325, "user_id": 1840315, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ea1c4692ce54d86dc6722bb9690a0bd0?s=128&d=identicon&r=PG", "display_name": "James Forbes", "link": "https://stackoverflow.com/users/1840315/james-forbes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 39584216, "answer_count": 2, "score": 1, "last_activity_date": 1474449790, "creation_date": 1474332483, "question_id": 39584104, "link": "https://stackoverflow.com/questions/39584104/nominal-types-bound-to-a-specific-function", "title": "Nominal types bound to a specific function", "body": "<p>Is there a language or type system that supports defining types that can only be instantiated via a specific function.</p>\n\n<p>An example could be a type <code>NonZeroInteger</code> that is bound to the function <code>CreateNonZeroInteger</code>.  Any external code can access the type, receive and return values of this type.  But crucially, a value of that type can only be created by calling the function <code>CreateNonZeroInteger</code></p>\n\n<p><code>NonZeroInteger</code>should be nominally typed.  A value of another type with the same structure should not be comparable or castable to this type.</p>\n"}, {"tags": ["haskell", "caching", "functional-programming", "lazy-evaluation"], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1474411082, "post_id": 39584841, "comment_id": 66517975, "body": "I&#39;ve tested this, and it will memoize the inputs to <code>coprime</code>. Like I said, I need to perform simplification on these arguments before memoizing them, since in general many different inputs will be associated with the same output."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1474431654, "post_id": 39584841, "comment_id": 66523058, "body": "@Myridium yes, read the last sentence of my answer. I suggested that now you could make another function that simplifies the input then calls <code>coprime</code>."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1474433428, "post_id": 39584841, "comment_id": 66523537, "body": "Yes, I did that. As described in my answer, that does not work. I did some tests and it appears to memoize the inputs to <code>coprime</code>, not to <code>coprime&#39;</code> which are the simplified inputs."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1474434608, "post_id": 39584841, "comment_id": 66523898, "body": "I am so confused. Your last iteration is exactly what I was recommending you do. Nonetheless, as long as you have got what you wanted, everything is fine!"}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1474435689, "post_id": 39584841, "comment_id": 66524263, "body": "Ah okay, I see now. That was unclear to me, sorry. I thought you were suggesting the first iteration of my answer. Also, are you sure it is <code>Memo.list Memo.integral</code>, as I&#39;ve read elsewhere that we should use the <code>Memo</code> of the <i>input type</i>, which in this case means <code>Memo.integral</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1474435832, "post_id": 39584841, "comment_id": 66524312, "body": "@Myridium Nice catch - it is indeed the type of the input. I&#39;ve updated my answer in case anyone stumbles on it in the future. I guess it also makes sense to be concerned mainly with the input type as that is the one over which we will need to be doing lookups."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 2, "last_activity_date": 1474435844, "last_edit_date": 1495542890, "creation_date": 1474338739, "answer_id": 39584841, "question_id": 39583995, "link": "https://stackoverflow.com/questions/39583995/global-cafs-in-where-blocks-haskell/39584841#39584841", "title": "Global CAFs in `where` blocks - Haskell", "body": "<p>Functions in general cannot be memoized (<a href=\"https://stackoverflow.com/questions/6090932/how-to-make-a-caf-not-a-caf-in-haskell\">at least in general they can't</a>). If you expect Haskell to memoize functions, that means that it would have to keep at run-time a dictionary of inputs already seen and their corresponding outputs, but then a function call involves a lookup in this dictionary!</p>\n\n<p>However, there are libraries which provide this facility: <a href=\"https://hackage.haskell.org/package/memoize\" rel=\"nofollow noreferrer\"><code>memoize</code></a> and <a href=\"https://hackage.haskell.org/package/data-memocombinators\" rel=\"nofollow noreferrer\"><code>data-memocombinators</code></a> for example. Using the latter of these, for example, I can memoize your example with</p>\n\n<pre><code>import qualified Data.MemoCombinators as Memo\n\ncoprime :: Integer -&gt; [Integer]\ncoprime n = Memo.integral coprime'\n  where\n    coprime' = -- your definition here - can even use `coprime`\n</code></pre>\n\n<p>Then as to your second question, now it <em>is</em> appropriate to make a second function that ends up calling the first.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474487002, "post_id": 39604786, "comment_id": 66555769, "body": "there might still be a way to do what you originally wanted: <code>coprimes = (results !!) where results = map f [0..] ; f n | n==simplify n = realCoprimes n | otherwise = results !! (simplify n)</code>. <code>results</code>, being referenced inside the returned CAF, should get memoized between calls. then <code>coprimes 4</code> will call <code>f 4</code> which will call <code>f 2</code>, store the result at <code>xs !! 2</code>, store the same result at index 4, and return the result (calculating it once). that&#39;s the idea anyway. You may have to give it a specific (monomorphic) type signature, like <code>Int -&gt; [Int]</code>. A polymorphic constant is not memoized."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474487182, "post_id": 39604786, "comment_id": 66555867, "body": "e.g. try <code>~&gt; let fib :: Int -&gt; Integer ; fib = (\\n -&gt; (xs!!(n-1)) + (xs!!(n-2))) where xs = 0:1:map fib [2..]</code>, then run <code>length $ show $ fib 10000</code> twice. <a href=\"https://stackoverflow.com/questions/11466284/how-is-this-fibonacci-function-memoized/11466959#11466959\">see also</a>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474487910, "post_id": 39604786, "comment_id": 66556277, "body": "so the fix for you may be as simple as turning your <code>cprimes relnums = cprime&#39; (mySimplify relnums)</code> into <code>cprimes = \\relnums -&gt; cprime&#39; (mySimplify relnums)</code>."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474527382, "post_id": 39604786, "comment_id": 66569029, "body": "@WillNess - Unfortunately, it appears as though your suggestion does not work. Trying the arguments <code>[2..1000]</code> reveals that all the internal methods associated with <code>cprimes</code> are being called <code>999</code> times. i.e. expensive functions are being called <code>999</code> times. This is in contrast to the method I outlined in my answer where profiling reveals that each of these internal methods is called only <code>607</code> times (the expected number)."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474527540, "post_id": 39604786, "comment_id": 66569117, "body": "@WillNess ...and yet, your method results in a noticeably shorter computation time. This is strange. I don&#39;t know how to reconcile that. Do you know why the .prof file might still be saying there are <code>999</code> entries?"}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474528176, "post_id": 39604786, "comment_id": 66569473, "body": "@WillNess - More investigation reveals that my method has a somewhat shorter computation time, but the garbage collection time more than offsets that. (Ends up using 5GB of RAM...) I find this really surprising, as I fully expected it to be worth the trade-off. Alas, a mathematical result shows that <code>6&#47;pi^2 = 0.608</code> of the total number of computations will still be required, even with memoisation. I guess it&#39;s just not worth it for the garbage collection. Thank you anyhow for your suggestion."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474543917, "post_id": 39604786, "comment_id": 66579477, "body": "<code>realCoprimes</code> can only be called when <code>n==simplify n</code>. <code>coprimes 4 == results !! 4 == f 4 == results !! 2 == f 2 == realCoprimes 2</code>. There will be of course 999 entries in the <i>list</i>. I just tried my code in GHCi, with <code>simplify = product . map fst . factorise</code> and <code>let realCoprimes n = trace (show n++&quot;,&quot;) [i | i&lt;- [1..], gcd n i == 1]</code>, and the memoization between calls <i>was</i> happening for me (i.e. trace outputs seen only for squarefree numbers)"}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474593157, "post_id": 39604786, "comment_id": 66605389, "body": "@WillNess - Indeed, the argument is simplified to a square-free number, but this does not mean that memoisation is working correctly. Try compiling and running <a href=\"http://pastebin.com/gZZ6uAU0\" rel=\"nofollow noreferrer\">this script</a> with a small input of about 10. Maybe I&#39;m mistaken, but it seems like expensive operations are being performed not only for square-frees."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1474594331, "post_id": 39604786, "comment_id": 66605661, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/123996/discussion-between-myridium-and-will-ness\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "is_accepted": false, "score": 0, "last_activity_date": 1474411410, "last_edit_date": 1495535244, "creation_date": 1474411021, "answer_id": 39604786, "question_id": 39583995, "link": "https://stackoverflow.com/questions/39583995/global-cafs-in-where-blocks-haskell/39604786#39604786", "title": "Global CAFs in `where` blocks - Haskell", "body": "<p>I have withdrawn my 'accepted' status from @Alec's answer because I have discovered that the method shown above will only memoize inputs to the <code>coprime</code> function. As stated in the question, I need to do some simplification on the input argument before memoizing it, as otherwise I will be storing the exact same data for multiple arguments. So here was my first attempt at working around this:</p>\n\n<pre><code>cprimes :: [Integer] -&gt; [Integer]\ncprimes relnums = cprime' (mySimplify relnums)\n  where\n    mySimplify relnums = ....\n    cprimes' = (Memo.list Memo.integral) cprimes''\n    cprimes'' relnums = ....\n</code></pre>\n\n<p>However, it seems that memoization here does not take place in the <strong>global context</strong> at least. Results are recomputed when <code>cprimes</code> is called with the same arguments. I suspect the result is being memoized within the one call to <code>cprimes</code> and then garbage collected, because <code>cprimes'</code> is defined within the <code>where</code> block.</p>\n\n<p>This was my second attempt at a workaround:</p>\n\n<pre><code>cprimes :: [Integer] -&gt; [Integer]\ncprimes relnums       = cprimetables (mySimplify relnums)\ncprimetables = (Memo.list Memo.integral) cprimes'\n  where\n    mySimplify relnums = ...\n    cprimes'   relnums = ...\n</code></pre>\n\n<p>Now this works as expected. However, it exposes the <code>cprimestable</code> function to anything that imports this module, which is not something I want. It's an internal implementation, and not meant to be called by the outside world. This is why I tried to put it in a <code>where</code> block in the first place.</p>\n\n<hr>\n\n<p>So in the end, I used this second method in combination with explicitly stating the exports from my module. It goes like this:</p>\n\n<pre><code>module PrimeStuff ( cprimes,\n                    ...\n                  )\n  where\n\n ...\n\ncprimes :: [Integer] -&gt; [Integer]\ncprimes relnums       = cprimetables (mySimplify relnums)\ncprimetables = (Memo.list Memo.integral) cprimes'\n  where\n    mySimplify relnums = ...\n    cprimes'   relnums = ...\n</code></pre>\n\n<p>This way, it seems as though the memoized results in <code>cprimestable</code> are not garbage collected prematurely. It also hides this implementation so that anything importing this module is only aware of the function <code>cprimes</code> which will take as an argument any list of integers.</p>\n\n<hr>\n\n<p>Helpful resources from stackoverflow.com in finding out how to do this were <a href=\"https://stackoverflow.com/questions/8176433/data-memocombinators-where-can-i-find-examples\">this</a> for learning about memoization, and <a href=\"https://stackoverflow.com/questions/14379185/function-privacy-and-unit-testing-haskell\">this</a> for learning about 'implementation-hiding'.</p>\n"}], "owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1474435844, "creation_date": 1474331466, "last_edit_date": 1474331792, "question_id": 39583995, "link": "https://stackoverflow.com/questions/39583995/global-cafs-in-where-blocks-haskell", "title": "Global CAFs in `where` blocks - Haskell", "body": "<p>I'm going to implement a function which takes in an <code>Integer</code> and outputs a lazy, infinite list of coprime <code>Integer</code>s.</p>\n\n<pre><code>coprime 2 = [1,3..]\ncoprime 3 = [1,2,4,5,7,8,....]\n</code></pre>\n\n<p>I expect that these lists will be accessed multiple times, so I want their values stored as CAFs. (Forgive me if I'm using that term incorrectly) Okay, so that's fine because that will be done automatically by the compiler (I think). But what about distinct inputs which are <em>guaranteed</em> to have the same output? For instance:</p>\n\n<pre><code>coprime 2 = [1,3..]\ncoprime 4 = [1,3..]\n</code></pre>\n\n<p>How can I make sure that these two patterns call upon the same CAF so that the result doesn't have to be recomputed?</p>\n\n<hr>\n\n<p>My first thought is to try implementing <code>coprime</code> so that <code>coprime 2</code> and <code>coprime 4</code> actually call a local function with the same argument. A minimal example:</p>\n\n<pre><code>coprime n\n  | n == 4    = realcoprime 2\n  | otherwise = realcoprime n\n    where\n      realcoprime n = .....\n</code></pre>\n\n<p>But do all calls to <code>coprime</code> share the same CAF values associated with <code>realcoprime</code>? And if so, won't they be garbage collected prematurely because they're not in the global scope?</p>\n"}, {"tags": ["haskell", "types", "ml", "idris", "maybe"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 12, "creation_date": 1474323502, "post_id": 39582869, "comment_id": 66475775, "body": "<code>data Maybe a = a | Nothing</code> is not valid Haskell\u2014it won\u2019t compile. That definition would effectively imply <code>Maybe a</code> is a <i>union</i> of any value or <code>Nothing</code>, but that\u2019s pretty useless, since <code>Nothing</code> is also \u201cany value\u201d. (Haskell\u2019s type system doesn\u2019t support untagged unions like this at all, since that would require some notion of \u201csubtyping\u201d, which Haskell does not have.)"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1474384265, "post_id": 39582869, "comment_id": 66503864, "body": "No, <code>Maybe a</code> would be a union of <code>a</code> or <code>Nothing</code>, and <code>Nothing</code> would normally not be a value of type <code>a</code>, so a type like <code>Maybe Int</code> wouldn&#39;t be useless. Correct that Haskell doesn&#39;t support this though."}], "answers": [{"comments": [{"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 1, "creation_date": 1474374334, "post_id": 39582902, "comment_id": 66496735, "body": "For some reason, I am amused whenever I find that I have to type <code>pure Nothing</code> :)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1474384278, "post_id": 39582902, "comment_id": 66503873, "body": "But why is there supposed to be a difference?"}, {"owner": {"reputation": 2565, "user_id": 1108505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a7e091fdb18efecace362189bc5f0bf5?s=128&d=identicon&r=PG", "display_name": "Tanner Swett", "link": "https://stackoverflow.com/users/1108505/tanner-swett"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1474388023, "post_id": 39582902, "comment_id": 66506428, "body": "@Reid Because applying <code>Maybe</code> to a type creates a new type with one additional value. This means that applying it twice should create a new type with two additional values."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1474396441, "post_id": 39582902, "comment_id": 66511107, "body": "This is not a joke, in my experience, <code>Just Nothing</code> occurs not too often, but from time to time it does."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1474397370, "post_id": 39582902, "comment_id": 66511626, "body": "Of course the semantics of Haskell (and Idris etc.) say that <code>Nothing</code> and <code>Just Nothing</code> are different, but this is just pushing back the question."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1474398025, "post_id": 39582902, "comment_id": 66512014, "body": "And it&#39;s entirely reasonable to consider failure sooner the same as failure later, if you consider failure a computational effect (and have no other observables that happen before the failure)."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 2, "creation_date": 1474723761, "post_id": 39582902, "comment_id": 66653978, "body": "This comes up in the book <a href=\"https://books.google.is/books?id=9apQfCRhvm0C&amp;lpg=PA62&amp;dq=%22land%20of%20lisp%22%20%22nil%22%20%20tear&amp;hl=is&amp;pg=PA61#v=onepage&amp;q&amp;f=false\" rel=\"nofollow noreferrer\">Land of Lisp</a>: <code>(find-if #&#39;null &#39;(2 4 nil 6))</code> correctly returns the element satisfying the <code>null</code> predicate (<code>nil</code>) but this is the same result if no elements had satisfied the predicate! Haskell is much clearer: <code>find (== Nothing) [Just 2, Just 4, Nothing, Just 6]</code> succeeds with <code>Just Nothing</code> (because it found the <code>Nothing</code> in the list) but <code>find (== Nothing) [Just 2, Just 4, Just 6]</code> fails with <code>Nothing</code>."}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1477309951, "post_id": 39582902, "comment_id": 67698752, "body": "@Ingo it happens more often than you think, when using abstractions that you never thought would use <code>Maybe</code> inside"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 26, "last_activity_date": 1474323254, "creation_date": 1474323254, "answer_id": 39582902, "question_id": 39582869, "link": "https://stackoverflow.com/questions/39582869/why-do-maybe-optional-types-use-a-just-some-type-instead-of-the-actual-type/39582902#39582902", "title": "Why do Maybe/Optional types use a Just/Some type instead of the actual type?", "body": "<p>What would then be the difference between</p>\n\n<pre><code>Maybe a\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Maybe (Maybe a)\n</code></pre>\n\n<p>?</p>\n\n<p>There's supposed to be a difference between <code>Nothing</code> and <code>Just Nothing</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": false, "score": 1, "last_activity_date": 1474323821, "creation_date": 1474323821, "answer_id": 39582985, "question_id": 39582869, "link": "https://stackoverflow.com/questions/39582869/why-do-maybe-optional-types-use-a-just-some-type-instead-of-the-actual-type/39582985#39582985", "title": "Why do Maybe/Optional types use a Just/Some type instead of the actual type?", "body": "<p>The problem is that if <code>Maybe</code> was defined the way you propose, i.e. <code>data Maybe a = a | Nothing</code> there would be no way to differentiate <code>a</code> values from <code>Maybe a</code> values (and <code>Maybe (Maybe a)</code> for that matter).</p>\n\n<p>So you may ask, why do we need to have such a distinction? What are the benefits? To give you a concrete example, suppose that we have a SQL table with a <code>integer NOT NULL</code> column. We would represent that with an <code>Int</code> in haskell. Now if we later on changed the database schema to make the column optional by dropping the <code>NOT NULL</code> constraint, we would have to change the haskell representation of the column to <code>Maybe Int</code>. The clear distinction between <code>Int</code> and <code>Maybe Int</code> would make it very easy to refactor our haskell code to account for the new schema. The compiler would complain for things such as extracting a value from the db and treating it as an <code>Int</code> (it might not be an integer, it might be <code>NULL</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1474327491, "post_id": 39583392, "comment_id": 66476985, "body": "Is Haskell type inference decidable?"}, {"owner": {"reputation": 2528, "user_id": 4905506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmyz0.png?s=128&g=1", "display_name": "Yuri Steinschreiber", "link": "https://stackoverflow.com/users/4905506/yuri-steinschreiber"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1474327629, "post_id": 39583392, "comment_id": 66477008, "body": "To paraphrase <i>The hitchhiker&#39;s guide</i>, mostly decidable."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1474328133, "post_id": 39583392, "comment_id": 66477140, "body": "The prosecution rests."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1474354285, "post_id": 39583392, "comment_id": 66484282, "body": "@augustss Usually, I mean what GHC will do in a few years&#39; time, but today, polymorphic recursion will do fine."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1474354970, "post_id": 39583392, "comment_id": 66484661, "body": "But Haskell type &quot;inference&quot; for polymorphic recursion is decidable, since you have to give a type signature. :)"}], "tags": [], "owner": {"reputation": 2528, "user_id": 4905506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmyz0.png?s=128&g=1", "display_name": "Yuri Steinschreiber", "link": "https://stackoverflow.com/users/4905506/yuri-steinschreiber"}, "is_accepted": false, "score": 8, "last_activity_date": 1474326466, "creation_date": 1474326466, "answer_id": 39583392, "question_id": 39582869, "link": "https://stackoverflow.com/questions/39582869/why-do-maybe-optional-types-use-a-just-some-type-instead-of-the-actual-type/39583392#39583392", "title": "Why do Maybe/Optional types use a Just/Some type instead of the actual type?", "body": "<p>I am not sure it is correct to speak of \"benefits\" in this context. What you have here is just a consequence of the way types are implemented in Haskell and ML - basically, Hindley-Milner algebraic type system. This type system essentially assumes that every value belongs to a <em>single</em> type (putting aside Haskell's numeric tower and bottom, which are outside of this discussion.) In other words, there is no <em>subtyping</em>, and that's for a reason - otherwise the type inference would be undecidable.</p>\n\n<p>When you define type <code>Maybe a</code> what you want is to <em>adjoin</em> a single additional value to the type denoted by <code>a</code>. But you can't do it directly - if you could then every value of <code>a</code> would belong to two different types - the original <code>a</code> and <code>Maybe a</code>. Instead, what is done is <code>a</code> is <em>embedded</em> in a new type - you have a canonical injection <code>a -&gt; Just a</code>. In other words, <code>Maybe a</code> is isomorphic to a union of <code>a</code> and <code>Nothing</code> which you can't represent directly in HM type system.</p>\n\n<p>So I don't think that arguments along the lines that such a distinction is beneficial are valid - you can't have a system without it which is still ML or Haskell or any familiar HM-based system. </p>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1474384639, "post_id": 39585679, "comment_id": 66504104, "body": "This argument falls apart somewhere near the end, since languages with subtyping can have real optional (or more generally, union) types. You argue that <code>T</code> and <code>Maybe T</code> must be different, but it doesn&#39;t follow that a value of type <code>T</code> can&#39;t also have type <code>Maybe T</code>."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 10, "last_activity_date": 1474345649, "creation_date": 1474345649, "answer_id": 39585679, "question_id": 39582869, "link": "https://stackoverflow.com/questions/39582869/why-do-maybe-optional-types-use-a-just-some-type-instead-of-the-actual-type/39585679#39585679", "title": "Why do Maybe/Optional types use a Just/Some type instead of the actual type?", "body": "<p>The key problem of allowing any value to be <code>null</code> (the \"billion-dollar mistake\") is that interfaces receiving a value of a type <code>T</code> have no way to declare whether or not they can handle a <code>null</code>, and interfaces that provide one have no way to declare whether or not they might produce <code>null</code>. This means that <strong>all</strong> of the operations that are usable on <code>T</code> essentially \"might not work\" when you pass them a <code>T</code>, which is a pretty gaping hole in all of the guarantees supposedly provided by compile-time type-checks.</p>\n\n<p>The Maybe/Optional solution to this is to say that the type <code>T</code> <strong>does not contain</strong> a <code>null</code> value (in languages that had this from the beginning, that's literal; in languages adopting an Optional type later without removing support for <code>null</code>, then that's only a convention that requires discipline). So now all of the operations whose type says they accept a <code>T</code> <strong>should</strong> work when I pass them a <code>T</code>, regardless of where I got the <code>T</code> (if you haven't managed to design to \"make illegal states unrepresentable\" then there will of course be other reasons why an object can be in an invalid state and cause failure, but at least when you pass a <code>T</code> there'll actually be <em>something</em> there).</p>\n\n<p>Sometimes we do need a value that can be \"either a <code>T</code> or nothing\". It's <strong>such</strong> a common case that pervasive <code>null</code> seemed like a good idea at the time, after all. Enter the <code>Maybe T</code> type. But to avoid falling back into exactly the same old trap, where I get a possibly-null <code>T</code> value and pass it to something that can't handle <code>null</code>, we need that <strong>none of the operations on <code>T</code> can be used on a <code>Maybe T</code> directly</strong>. Getting a type error from trying to do that is the entire point of the exercise. So my <code>T</code> values can't be directly members of <code>Maybe T</code>; I need to wrap them up <em>inside</em> a <code>Maybe T</code>, so that if I have a <code>Maybe T</code> I'm forced to write code that handles <em>both</em> cases (and only in the case for actually having a <code>T</code> can I call operations that work on <code>T</code>).</p>\n\n<p>Whether this makes a word like <code>Just</code> or <code>Some</code> appear in the source code, and whether or not this is actually implemented with additional boxing/indirection in memory (some languages do represent a <code>Maybe T</code> as a nullable pointer to <code>T</code> internally), all of that is irrelevant. But the <code>Just a</code> case <strong>must</strong> be different from simply having an <code>a</code> value.</p>\n"}, {"tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1474374135, "creation_date": 1474374135, "answer_id": 39593998, "question_id": 39582869, "link": "https://stackoverflow.com/questions/39582869/why-do-maybe-optional-types-use-a-just-some-type-instead-of-the-actual-type/39593998#39593998", "title": "Why do Maybe/Optional types use a Just/Some type instead of the actual type?", "body": "<p>The benefit of the constructor (<code>Just</code> or <code>Some</code>) is that it provides a way to distinguish between the branches of the data type. That is, it avoids ambiguity.</p>\n\n<p>For example if we were relying on type inference, then the type of x in the following seems fairly straightforward \u2014 <code>String</code>.</p>\n\n<pre><code>x = \"Hello\"\n</code></pre>\n\n<p>However, if we allowed your definition of <code>Maybe</code>, how would we know whether <code>x</code> was <code>String</code>, a <code>Maybe String</code> or a <code>Maybe (Maybe String)</code> etc.</p>\n\n<p>Also consider a data type with more than two cases:</p>\n\n<pre><code>data Tree a\n  = Empty\n  | Node (Tree a) (Tree a)\n  | Leaf a\n</code></pre>\n\n<p>If we simply removed the constructors (other than <code>Empty</code>), following your suggestion for <code>Maybe</code>, we'd end up with:</p>\n\n<pre><code>data Tree a\n  = Empty\n  | (Tree a) (Tree a)\n  | a\n</code></pre>\n\n<p>I hope you can see that the ambiguity gets even worse.</p>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 3562369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/C3H1J.png?s=128&g=1", "display_name": "RKS", "link": "https://stackoverflow.com/users/3562369/rks"}, "is_accepted": false, "score": 0, "last_activity_date": 1474648764, "creation_date": 1474648764, "answer_id": 39665683, "question_id": 39582869, "link": "https://stackoverflow.com/questions/39582869/why-do-maybe-optional-types-use-a-just-some-type-instead-of-the-actual-type/39665683#39665683", "title": "Why do Maybe/Optional types use a Just/Some type instead of the actual type?", "body": "<p>Consider this <em>somewhat</em> equivalent of Maybe in C++/Java'ish psuedocode...</p>\n\n<pre><code>template&lt;class T&gt;\nabstract class Maybe&lt;T&gt; { ... }\n\ntemplate&lt;class T&gt;\nclass Just&lt;T&gt; : Maybe&lt;T&gt; {\n    // constructor\n    Just&lt;T&gt; (T val) { ... }\n\n    ...\n}\n\ntemplate&lt;class T&gt;\nclass Nothing&lt;T&gt; : Maybe&lt;T&gt; {\n    // constructor\n    Nothing () { ... }\n\n    ...\n}\n</code></pre>\n\n<p>That is not specific to Maybe, it can be applied to any ADT. Now what exactly will</p>\n\n<pre><code>data Maybe a = a | Nothing\n</code></pre>\n\n<p>model into ? (assuming that its legal syntax).</p>\n\n<p>If you were to write a switch statement, to 'pattern match' against types, what will u match against (the switch is on the TYPE not the value), something like this (not necessarily valid code) :</p>\n\n<pre><code>switch (typeof (x)) {\n    case Just&lt;a&gt; : ...\n    case Nothing&lt;a&gt; : ...\n    default : ... // Here you dont have any 'a' to get the inner type\n}\n</code></pre>\n"}], "owner": {"reputation": 31438, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 1, "answer_count": 6, "score": 10, "last_activity_date": 1474648764, "creation_date": 1474323046, "last_edit_date": 1474330379, "question_id": 39582869, "link": "https://stackoverflow.com/questions/39582869/why-do-maybe-optional-types-use-a-just-some-type-instead-of-the-actual-type", "title": "Why do Maybe/Optional types use a Just/Some type instead of the actual type?", "body": "<p>In Idris, the <code>Maybe</code> type is defined as followed:  </p>\n\n<pre><code>data Maybe a = Just a | Nothing  \n</code></pre>\n\n<p>It's defined similarly in Haskell:  </p>\n\n<pre><code> data Maybe a = Just a | Nothing\n     deriving (Eq, Ord)\n</code></pre>\n\n<p>Here's the ML version:  </p>\n\n<pre><code>datatype 'a option = NONE | SOME of 'a\n</code></pre>\n\n<p>What are the benefits of using <code>Just</code> and <code>Some</code>?<br>\nWhy not define the type without them?  </p>\n\n<p>example:</p>\n\n<pre><code>data Maybe a = a | Nothing\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1474314148, "post_id": 39580424, "comment_id": 66471776, "body": "I feel like there&#39;s an interesting question here, but quite what you&#39;re asking isn&#39;t clear to me."}, {"owner": {"reputation": 165, "user_id": 6641733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UiaQz.jpg?s=128&g=1", "display_name": "Ophirr33", "link": "https://stackoverflow.com/users/6641733/ophirr33"}, "edited": false, "score": 0, "creation_date": 1474314446, "post_id": 39580424, "comment_id": 66471920, "body": "Something like:  <code>let func f input registered = filter (not . (`elem` (map f registered)) . f) input</code>? Not 100% sure what&#39;s being asked."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474314707, "post_id": 39580424, "comment_id": 66472048, "body": "I feel like you want structural records - the built-in record system will not help you here but there are plenty of libraries implementing records to choose from."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1474374702, "post_id": 39580424, "comment_id": 66496983, "body": "Consider this a novice question about structuring and efficiency of Haskell code. The &quot;logic&quot; is a simple set intersection. The mapping is creating temporary sets from database and user input. The hidden topic is related to having two types share the same (in terms of semantics) field."}], "answers": [{"comments": [{"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1474478652, "post_id": 39603439, "comment_id": 66551312, "body": "I didn&#39;t notice that <code>b</code> is unconstrained in: <code>intersection :: Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a</code>. It seems that <code>Map</code> in <code>Map k b</code> is an over-constrained parameter allowing for efficient computation with type-class uniqueness."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1474404370, "creation_date": 1474404370, "answer_id": 39603439, "question_id": 39580424, "link": "https://stackoverflow.com/questions/39580424/decouple-logic-from-transformation-when-filtering-records/39603439#39603439", "title": "Decouple logic from transformation when filtering records", "body": "<p>I propose something like this: we will use <code>Data.Map</code> to give two mappings that share a key space. Building these <code>Map</code>s will correspond to the \"predicate\" part; this will be cleanly separated from computing the \"intersection\" or other combining function. We start with the same setup as yours:</p>\n\n<pre><code>import Data.Map (Map)\nimport qualified Data.Map as M\n\ndata Athlete = Athlete { name :: String } deriving Show\nregistered = map Athlete [\"John\", \"Mike\"]\ninput = map Athlete [\"John\", \"Ann\"]\n</code></pre>\n\n<p>Now we will build our two maps. For exposition, I will name them; but in your code you may choose to inline their definitions to avoid having to choose a crappy name.</p>\n\n<pre><code>registeredMap :: Map String Athlete\nregisteredMap = M.fromList [(name athlete, athlete) | athlete &lt;- registered]\n\ninputMap :: Map String Athlete\ninputMap = M.fromList [(name athlete, athlete) | athlete &lt;- input]\n</code></pre>\n\n<p>I stress here that we have <em>happened</em> to use <code>name</code> as the selector for both cases here, and <em>happened</em> to use the same type <code>Athlete</code> as the value types for both maps, but neither of these is required for the next part -- just coincidence. The key non-coincidental bit as that the key spaces are the same, as otherwise intersection would not make sense. This addresses your design concern of later needing to change one accessor or the other, or change one underlying type or the other.</p>\n\n<p>Now intersection is as simple as using the existing library function <code>intersection</code>.</p>\n\n<pre><code>registeredInputAthletes :: [Athlete]\nregisteredInputAthletes = M.elems (M.intersection registeredMap inputMap)\n</code></pre>\n\n<p>This has value <code>[Athlete { name = \"John\" }]</code>.</p>\n\n<p>If it is a need, one could also use <code>intersectionWith</code> to combine the two contained values rather than keeping the one from the left-hand argument and ignoring the right-hand argument.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 39603439, "answer_count": 1, "score": 0, "last_activity_date": 1474404370, "creation_date": 1474312229, "question_id": 39580424, "link": "https://stackoverflow.com/questions/39580424/decouple-logic-from-transformation-when-filtering-records", "title": "Decouple logic from transformation when filtering records", "body": "<p>Below is a simplified example of a problem I have with larger records and functions doing some data manipulation. In my actual code <code>name</code> is an accessor like:</p>\n\n<p><code>name = snd . fst . fst</code></p>\n\n<p>However I'm not content with readability as <code>name</code> is not the only one thing I want to check against. Is there a simpler, idiomatic way to decouple logic from field transformation based on this example?</p>\n\n<pre><code>&gt; data Athlete = Athlete { name :: String } deriving Show\n\n&gt; let registered = map Athlete [\"John\", \"Mike\"]\n&gt; let input = map Athlete [\"John\", \"Ann\"]\n\n&gt; filter (not . (`elem` (map name registered)) . name) input\n[Athlete {name = \"Ann\"}]\n</code></pre>\n\n<p>Part of the problem is that predicate does not only depend on the argument itself and does not necessarily check for equality of <code>Athlete</code>. Since I explicitly do not want test for equality, ideally, the logic part should remain unchanged if the <code>input</code> type changed to the following:</p>\n\n<pre><code>&gt; data AthleteInput = AthleteInput { name :: String } deriving Show\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "edited": false, "score": 1, "creation_date": 1474304156, "post_id": 39578127, "comment_id": 66466578, "body": "The type of <code>answers</code> is <code>Entryt -&gt; [Answer]</code>."}, {"owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "reply_to_user": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "edited": false, "score": 0, "creation_date": 1474304248, "post_id": 39578127, "comment_id": 66466617, "body": "what do we gain by explicitly writing (answers entry)?"}], "answers": [{"tags": [], "owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "is_accepted": false, "score": 3, "last_activity_date": 1474305537, "last_edit_date": 1474305537, "creation_date": 1474304910, "answer_id": 39578515, "question_id": 39578127, "link": "https://stackoverflow.com/questions/39578127/understanding-a-haskell-function/39578515#39578515", "title": "Understanding a Haskell function", "body": "<p><code>answers</code> doesn't have type <code>[Answer]</code>. It has type <code>Entryt -&gt; [Answer]</code>.</p>\n\n<p>\u201cBut why?\u201d You may ask.</p>\n\n<p>Each <code>Entryt</code> has its own list of answers, which may vary from one <code>Entryt</code> to another. Thus, <code>answers</code> is a function that takes an <code>Entryt</code> and returns its list of answers.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 5, "last_activity_date": 1474306144, "creation_date": 1474306144, "answer_id": 39578861, "question_id": 39578127, "link": "https://stackoverflow.com/questions/39578127/understanding-a-haskell-function/39578861#39578861", "title": "Understanding a Haskell function", "body": "<p><code>answers</code> is a getter function that retrieves a given entries answer list, so <code>totnChars entry = myLoop (answers entry)</code> defines a function that takes an entry and applies <code>myLoop</code> to that entry's answer list.</p>\n\n<blockquote>\n  <p>Does it mean that entry must be of type answers?</p>\n</blockquote>\n\n<p>No. The syntax to say that something must be of a given type would be <code>expression :: Type</code>, but <code>answers</code> isn't a type. Type names always start with capital letters in Haskell. You can introduce a type <em>variable</em> named <code>answers</code>, but there'd be no point in that. And that's absolutely not what's happening here. <code>answers entry</code> is just a plain old function application.</p>\n\n<blockquote>\n  <p>But isn't entry of type Entryt?</p>\n</blockquote>\n\n<p>Yes, it is.</p>\n"}], "owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 39578861, "answer_count": 2, "score": 1, "last_activity_date": 1474306144, "creation_date": 1474303478, "last_edit_date": 1474303729, "question_id": 39578127, "link": "https://stackoverflow.com/questions/39578127/understanding-a-haskell-function", "title": "Understanding a Haskell function", "body": "<p>I am wondering what is the use of <code>(answers entry)</code>  in  <code>totnChars entry = myLoop (answers entry)</code> . Does it mean that entry must be of type <code>answers</code>? But isn't <code>entry</code> of type <code>Entryt</code>?</p>\n\n<pre><code>type Question = [Char]\ntype Answer = [Char]\ntype Music = [Char]\ndata Entryt = MyEntry {\n                       questions :: [Question],\n                       answers :: [Answer],\n                       music :: Music,\n                       time :: Float\n                      } deriving (Show, Eq) \n\n\n\ntotnChars :: Entryt -&gt; Int\ntotnChars entry = myLoop (answers entry)\n\nmyLoop :: [Answer] -&gt; Int\nmyLoop [] = 0 \nmyLoop (x:rest) = (nChars x 0) + (myLoop rest)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "erlang", "code-analysis", "static-analysis"], "comments": [{"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 0, "creation_date": 1474276198, "post_id": 39569164, "comment_id": 66448548, "body": "I think <a href=\"http://stackoverflow.com/questions/3431225/tools-for-generating-haskell-function-dependency-control-flow-graph\">this</a> is close to what you need."}, {"owner": {"reputation": 2389, "user_id": 2345370, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7f2ad519f77a20c173a0b5174a900c2d?s=128&d=identicon&r=PG", "display_name": "Not an ID", "link": "https://stackoverflow.com/users/2345370/not-an-id"}, "reply_to_user": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 0, "creation_date": 1474277205, "post_id": 39569164, "comment_id": 66449168, "body": "yeah... it does"}], "owner": {"reputation": 2389, "user_id": 2345370, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7f2ad519f77a20c173a0b5174a900c2d?s=128&d=identicon&r=PG", "display_name": "Not an ID", "link": "https://stackoverflow.com/users/2345370/not-an-id"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1474284520, "answer_count": 0, "score": 1, "last_activity_date": 1474276769, "creation_date": 1474275563, "last_edit_date": 1474276769, "question_id": 39569164, "link": "https://stackoverflow.com/questions/39569164/tracing-the-evaluation-of-an-expression-in-functional-programming", "closed_reason": "Duplicate", "title": "Tracing the evaluation of an expression in functional programming", "body": "<p>This question talks about Erlang, but it applies to other functional programming language as well.</p>\n\n<h3>The Question</h3>\n\n<p>Say in the middle of a function definition, there is an expression like this:</p>\n\n<pre><code>A = B + voodoo(C, D)\n</code></pre>\n\n<p>and <code>voodoo</code> is defined as</p>\n\n<pre><code>voodoo(X, Y) -&gt; more_voodoo(more_voodoo1(X), more_voodoo2(Y)).\n</code></pre>\n\n<p>and <code>more_voodoo*</code> is defined like <code>voodoo</code>, the list goes on, after some steps, it ultimately reached literals, BIFs, library functions (later these are called \"border\").</p>\n\n<p>The question is: I want to know how <code>A</code> is defined, how can I generate a graph to illustrate the definition of <code>A</code>? like this:</p>\n\n<pre><code>C -&gt; more_voodoo1 ---+\n                     |-&gt; more_voodoo ---+\nD -&gt; more_voodoo2 ---+                  |-&gt; (+) -&gt; A\n  (graph inferred from context) -&gt; B ---+\n</code></pre>\n\n<p>How the graph is organized is not really important here, as long as it let me clearly see the definition of <code>A</code> (with high enough abstraction and zoom in when necessary).</p>\n\n<p>Intuitively, you can think the program is some threads going through some balls, where the treads represent the data flow and the balls represent functions, and what I want to do is pick the ball that produces <code>A</code>, and <strong>shake</strong> it, as a result, only what related to <code>A</code> is left, all other non-interesting information gets shaked off.</p>\n\n<p>I doubt that there exists off-the-shelf tool for this, so what's your opinion on how to implement a tool for this kind of task? it won't have to be fully automatic, it can try its best and when it gets stuck it can ask the user for instructions (just black box it, user defined borders, etc.), parse the source code? hooks into the compiler? use some kind of \"radio active\" values and then x-ray it?</p>\n\n<h3>Note</h3>\n\n<p>You may wonder, why don't just flow the code and understand it? Well, sometimes the call chain is too long, and it's really hard to keep all the stack at your head, sure, if we try hard enough, we will understand it eventually, but if there is a better way to do it, why not? and to be honest, sometimes these codes are biz logic, not really something interesting to dive into, and this is a once for all solution, once we have the tool, we won't be scratch our head next time. With a graph, you can see clearly where certain data comes from (and it interacts with user better that text, yeah, I know you love pure text, I love it too, but admit it, there are times when GUIs are more convenient than text).</p>\n\n<p>If your call chain is that long, you probably should refactor it, I heard you say. Well, sucks or not, sometimes you are not allowed to change those code.</p>\n"}, {"tags": ["haskell", "bit-manipulation", "bytestring"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1474270276, "post_id": 39567333, "comment_id": 66445315, "body": "For bitwise operations, you can use <code>zipWith</code> and the word level operation."}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1474277313, "post_id": 39567771, "comment_id": 66449230, "body": "&quot;I can&#39;t see any reason why it would be a bad idea&quot; except if this is for a library. Don&#39;t put orphan instances like that in libraries."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1474308482, "post_id": 39567771, "comment_id": 66468838, "body": "Presumably the instance would look like <code>instance (ListLike l a, Bits a) =&gt; Bits l where ...</code>. But then you are overlapping literally every other instance of <code>Bits</code>. Probably not a good idea to do this in <i>that</i> particular way."}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1474381401, "post_id": 39567771, "comment_id": 66501927, "body": "They&#39;re suggesting something like <code>newtype AggregateBits a = AggregateBits a</code> and I suggest using <code>FiniteBits</code> instead of <code>Bits</code> in the precondition,  Also, <code>l</code> is the full type for <code>Listlike</code>, not <code>l a</code>.  Altogether, <code>instance (Listlike l a, FiniteBits a) =&gt; Bits (AggregateBits l) where...</code>"}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1474270781, "creation_date": 1474270781, "answer_id": 39567771, "question_id": 39567333, "link": "https://stackoverflow.com/questions/39567333/bit-wise-operations-on-bytestring/39567771#39567771", "title": "Bit-wise operations on ByteString", "body": "<p>I can't see any reason why it would be a bad idea. If you wanted to be super-general you could implement</p>\n\n<pre><code>instance (Listlike l a, Bits a) =&gt; Bits (l a) where ...\n</code></pre>\n\n<p>This will give you a Bits implementation for any <a href=\"https://hackage.haskell.org/package/ListLike-4.5\" rel=\"nofollow\">list-like</a> type, which happens to <a href=\"https://hackage.haskell.org/package/ListLike-4.5/docs/Data-ListLike-Instances.html\" rel=\"nofollow\">include Bytestrings</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 0, "last_activity_date": 1484064459, "creation_date": 1484064459, "answer_id": 41573222, "question_id": 39567333, "link": "https://stackoverflow.com/questions/39567333/bit-wise-operations-on-bytestring/41573222#41573222", "title": "Bit-wise operations on ByteString", "body": "<p>I found the <a href=\"http://hackage.haskell.org/package/bits-bytestring\" rel=\"nofollow noreferrer\">bits-bytestring</a> package on Hackage providing what you ask for.</p>\n\n<p>But I would be careful with some of the operations, if not all your bytestrings are of the same length. In particular, which bits are set by <code>complement</code> depends on the length of the bytestring.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1484064459, "creation_date": 1474269167, "question_id": 39567333, "link": "https://stackoverflow.com/questions/39567333/bit-wise-operations-on-bytestring", "title": "Bit-wise operations on ByteString", "body": "<p>In Haskell, it seems that bit-wise operations are typically handled via the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Bits.html\" rel=\"nofollow\">Data.Bits module</a> and the Bits class.</p>\n\n<p>I'd like to perform bit-manipulations on ByteStrings of any length (eg set, clear, shift, masks...) but I cannot find an instance of Bits for ByteStrings anywhere. </p>\n\n<p>My question: should I implement the instance myself (probably a good exercise)? If so is there any recommendation to get some \"acceptable performance\"? Or is it a bad idea to try to do bit-manipulations directly on ByteStrings, in which case what would be a better way?</p>\n"}, {"tags": ["haskell", "gtk"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474297207, "post_id": 39566837, "comment_id": 66462300, "body": "Two immediate improvements would be to define <code>bget = builderGetObject bdr</code> and stop defining temporary names that are only used once. <code>return NecControlGUI { winNetControl = bget castToWindow &quot;winNecControl&quot;, ...}</code>"}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "edited": false, "score": 0, "creation_date": 1474304689, "post_id": 39566837, "comment_id": 66466850, "body": "Hm, not sure, but I don&#39;t think LGtk supports Glade files, you would have to define the GUI from scratch with LGtk syntax. I created some fairly complex GUIs with Glade and did lots of this stuff with copy-paste and search/replace. Sure, it&#39;s boring, but somehow you have to relate the content of the glade file to some types and values. If you have only the standard case of getting something out of the glade file and putting it into a record field and you have a default naming convention in Glade, you could write a Haskell code generator, but if that&#39;s worth it, you have to decide..."}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474320546, "post_id": 39566837, "comment_id": 66474644, "body": "@chepner I can\u2019t go without temporary names because <code>builderGetObject</code> returns a monadic value while the record structure works with pure value."}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "reply_to_user": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "edited": false, "score": 0, "creation_date": 1474320719, "post_id": 39566837, "comment_id": 66474717, "body": "@MichaelO I thought of writing a templatehaskell program which could take a Glade file as input and generate the corresponding Haskell code, but I hoped this has already been done :-)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474320762, "post_id": 39566837, "comment_id": 66474729, "body": "Ah, true; I was really thinking of an answer like <code>NecControlGUI &lt;$&gt; bget castToWindow &quot;winNecControl&quot; &lt;*&gt; bget castToEntry &quot;entIPAddress&quot; &lt;*&gt; ...</code>, but that doesn&#39;t let you include the field names for readability."}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474321188, "post_id": 39566837, "comment_id": 66474892, "body": "@chepner Ah, true ; I forgot the applicative way! :o) This way is interesting as it saves 33% of lines. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1474398934, "post_id": 39595790, "comment_id": 66512552, "body": "I tried the applicative way but it doesn&#39;t seem to work, thought I don&#39;t know really why :-/"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1474400624, "post_id": 39595790, "comment_id": 66513528, "body": "What happens if you switch from record syntax to &quot;regular&quot; syntax: <code>data NecControlGUI = NecControlGUI Adjustment Window</code>?"}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1474400932, "post_id": 39595790, "comment_id": 66513697, "body": "Exactly the same ! Could it be that the use of cast functions by builderGetObject is what causes the problem ?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1474401193, "post_id": 39595790, "comment_id": 66513836, "body": "I don&#39;t know. Something too subtle for me to figure out is going on. I mean, <code>builderGetObject bdr castToWindow</code> has type <code>String -&gt; IO Window</code>, right?"}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1474402334, "post_id": 39595790, "comment_id": 66514434, "body": "The signature of builderGetObject is <code>(GObjectClass cls, GlibString string) =&gt; Builder -&gt; (GObject -&gt; cls) -&gt; string -&gt; IO cls</code>, once the cast function set, the final type can be determined."}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1474405169, "post_id": 39595790, "comment_id": 66515817, "body": "I found where the problem came from : it\u2019s the <code>let bget = builderGetObject bdr</code> that causes the problem. If I do not use it, keeping every <code>builderGetObject bdr</code>, everything goes as expected !"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1474378998, "creation_date": 1474378998, "answer_id": 39595790, "question_id": 39566837, "link": "https://stackoverflow.com/questions/39566837/how-to-deal-with-lots-of-widgets-in-haskellgtk/39595790#39595790", "title": "How to deal with lots of widgets in Haskell+GTK?", "body": "<p>It's not what you are looking for, but it is shorter. Use the <code>Applicative</code> instance to combine the calls to <code>builderGetObject</code> with the data constructor.</p>\n\n<pre><code>module GUI where\n\nimport Graphics.UI.Gtk\n\ndata NecControlGUI = NecControlGUI\n    { ...\n    }\n\nloadGUI :: String -&gt; IO NecControlGUI\nloadGUI guiPath = do\n    bdr &lt;- builderNew\n\n    builderAddFromFile bdr guiPath\n\n    let bget = builderGetObject bdr\n\n    NecControlGUI &lt;$&gt; bget castToWindow \"winNecControl\"\n                  &lt;*&gt; bget castToEntry \"entIPAddress\"\n                  &lt;*&gt; bget castToButton \"btnConnection\"\n                  &lt;*&gt; bget castToComboBox \"cbtVideoInput\"\n                  &lt;*&gt; bget castToComboBox \"cbtPIPInput\"\n                  &lt;*&gt; bget castToScale \"sclSharpness\"\n                  &lt;*&gt; bget castToScale \"sclContrast\"\n                  &lt;*&gt; bget castToScale \"sclBrightness\"\n                  &lt;*&gt; bget castToScale \"sclBlackLevel\"\n                  &lt;*&gt; bget castToScale \"sclColorTemparature\"\n                  &lt;*&gt; bget castToComboBox \"cbtGamma\"\n                  &lt;*&gt; bget castToScale \"sclBalance\"\n                  &lt;*&gt; bget castToScale \"sclTreble\"\n                  &lt;*&gt; bget castToScale \"sclBass\"\n                  &lt;*&gt; bget castToScale \"sclVolume\"\n                  &lt;*&gt; bget castToComboBox \"cbtLanguage\"\n                  &lt;*&gt; bget castToScale \"sclMenuDisplayTime\"\n</code></pre>\n"}], "owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 39595790, "answer_count": 1, "score": 1, "last_activity_date": 1474405356, "creation_date": 1474267298, "last_edit_date": 1474405356, "question_id": 39566837, "link": "https://stackoverflow.com/questions/39566837/how-to-deal-with-lots-of-widgets-in-haskellgtk", "title": "How to deal with lots of widgets in Haskell+GTK?", "body": "<p>I have a Glade file describing my interface. Its goal is to control a Nec monitor through local network. Therefore there are lots of widgets controlling how the monitor works:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aQFlu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aQFlu.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need to create the link between what I get/set from/to the monitor and the widgets. This means getting/setting values and attaching functions to widgets.</p>\n\n<p>The <code>Builder</code> from GTK library requires to use IO () and cast every widget in order to call specific functions on them. This is kinda boring and add (unnecessary) lines of code.</p>\n\n<pre><code>module GUI where\n\nimport Graphics.UI.Gtk\n\ndata NecControlGUI = NecControlGUI\n    { winNecControl :: Window\n    , entIPAddress :: Entry\n    , btnConnection :: Button\n    , cbtVideoInput :: ComboBox\n    , cbtPIPInput :: ComboBox\n    , sclSharpness :: Scale\n    , sclContrast :: Scale\n    , sclBrightness :: Scale\n    , sclBlackLevel :: Scale\n    , sclColorTemperature :: Scale\n    , cbtGamma :: ComboBox\n    , sclBalance :: Scale\n    , sclTreble :: Scale\n    , sclBass :: Scale\n    , sclVolume :: Scale\n    , cbtLanguage :: ComboBox\n    , sclMenuDisplayTime :: Scale\n    }\n\nloadGUI :: String -&gt; IO NecControlGUI\nloadGUI guiPath = do\n    bdr &lt;- builderNew\n\n    builderAddFromFile bdr guiPath\n\n    window &lt;- builderGetObject bdr castToWindow \"winNecControl\"\n    ipaddress &lt;- builderGetObject bdr castToEntry \"entIPAddress\"\n    connection &lt;- builderGetObject bdr castToButton \"btnConnection\"\n    videoinput &lt;- builderGetObject bdr castToComboBox \"cbtVideoInput\"\n    pipinput &lt;- builderGetObject bdr castToComboBox \"cbtPIPInput\"\n    sharpness &lt;- builderGetObject bdr castToScale \"sclSharpness\"\n    contrast &lt;- builderGetObject bdr castToScale \"sclContrast\"\n    brightness &lt;- builderGetObject bdr castToScale \"sclBrightness\"\n    blacklevel &lt;- builderGetObject bdr castToScale \"sclBlackLevel\"\n    colortemperature &lt;- builderGetObject bdr castToScale \"sclColorTemparature\"\n    gamma &lt;- builderGetObject bdr castToComboBox \"cbtGamma\"\n    balance &lt;- builderGetObject bdr castToScale \"sclBalance\"\n    treble &lt;- builderGetObject bdr castToScale \"sclTreble\"\n    bass &lt;- builderGetObject bdr castToScale \"sclBass\"\n    volume &lt;- builderGetObject bdr castToScale \"sclVolume\"\n    language &lt;- builderGetObject bdr castToComboBox \"cbtLanguage\"\n    menudisplaytime &lt;- builderGetObject bdr castToScale \"sclMenuDisplayTime\"\n\n    return NecControlGUI\n        { winNecControl = window\n        , entIPAddress = ipaddress\n        , btnConnection = connection\n        , cbtVideoInput = videoinput\n        , cbtPIPInput = pipinput\n        , sclSharpness = sharpness\n        , sclContrast = contrast\n        , sclBrightness = brightness\n        , sclBlackLevel = blacklevel\n        , sclColorTemperature = colortemperature\n        , cbtGamma = gamma\n        , sclBalance = balance\n        , sclTreble = treble\n        , sclBass = bass\n        , sclVolume = volume\n        , cbtLanguage = language\n        , sclMenuDisplayTime = menudisplaytime\n        }\n</code></pre>\n\n<p>Is there a way to automate this part?</p>\n\n<p>I heard of LGtk, but is it the only way to do it?</p>\n\n<p><strong>Edit 2016-09-20 1</strong></p>\n\n<p>I tried to go the applicative way, but it doesn't seem that Haskell like combining applicative IO ? (but it's probably me)</p>\n\n<pre><code>module NecControlGUI where\n\nimport Graphics.UI.Gtk\n\ndata NecControlGUI = NecControlGUI\n    { adjBalance :: Adjustment\n    , winNecControl :: Window\n    }\n\nloadNecControlGUI :: String -&gt; IO NecControlGUI\nloadNecControlGUI guiPath = do\n    bdr &lt;- builderNew\n    builderAddFromFile bdr guiPath\n    let bget = builderGetObject bdr\n    NecControlGUI &lt;$&gt; bget castToAdjustment \"adjBalance\"\n                  &lt;*&gt; bget castToWindow \"winNecControl\"\n</code></pre>\n\n<p>Compiling outputs the following errors:</p>\n\n<pre><code>.../src/NecControlGUI.hs:16:23: error:\n    \u2022 Couldn't match type \u2018Adjustment\u2019 with \u2018Window\u2019\n      Expected type: IO Window\n        Actual type: IO Adjustment\n    \u2022 In the second argument of \u2018(&lt;*&gt;)\u2019, namely\n        \u2018bget castToWindow \"winNecControl\"\u2019\n      In a stmt of a 'do' block:\n        NecControlGUI &lt;$&gt; bget castToAdjustment \"adjBalance\"\n        &lt;*&gt; bget castToWindow \"winNecControl\"\n      In the expression:\n        do { bdr &lt;- builderNew;\n             builderAddFromFile bdr guiPath;\n             let bget = builderGetObject bdr;\n             NecControlGUI &lt;$&gt; bget castToAdjustment \"adjBalance\"\n             &lt;*&gt; bget castToWindow \"winNecControl\" }\n\n.../src/NecControlGUI.hs:16:28: error:\n    \u2022 Couldn't match type \u2018Window\u2019 with \u2018Adjustment\u2019\n      Expected type: GObject -&gt; Adjustment\n        Actual type: GObject -&gt; Window\n    \u2022 In the first argument of \u2018bget\u2019, namely \u2018castToWindow\u2019\n      In the second argument of \u2018(&lt;*&gt;)\u2019, namely\n        \u2018bget castToWindow \"winNecControl\"\u2019\n      In a stmt of a 'do' block:\n        NecControlGUI &lt;$&gt; bget castToAdjustment \"adjBalance\"\n        &lt;*&gt; bget castToWindow \"winNecControl\"\n</code></pre>\n\n<p><strong>Edit 2016-09-20 2</strong></p>\n\n<p>If I get rid of the <code>let bdr = ...</code> statement, everything works as expected.</p>\n"}, {"tags": ["haskell", "hakyll"], "answers": [{"comments": [{"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "edited": false, "score": 0, "creation_date": 1474297885, "post_id": 39567096, "comment_id": 66462765, "body": "That did it. Thanks! :)"}, {"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "edited": false, "score": 0, "creation_date": 1474301786, "post_id": 39567096, "comment_id": 66465199, "body": "Unfortunately, my example Hakyll project is a bit too contrived. In practice, those &quot;links&quot; will actually be posts, which also exist as their own top-level <code>match</code> entry. When I introduce them to <code>myCtx</code>, I get a &quot;Dependency cycle&quot; compile error. Do you know how I&#39;d address that? I&#39;m happy to create another question, if it seems worthwhile."}, {"owner": {"reputation": 4630, "user_id": 160386, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b6044f355342bb055fbb03804d9673e3?s=128&d=identicon&r=PG", "display_name": "Jan Tojnar", "link": "https://stackoverflow.com/users/160386/jan-tojnar"}, "reply_to_user": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "edited": false, "score": 1, "creation_date": 1474311209, "post_id": 39567096, "comment_id": 66470233, "body": "That can be done using <a href=\"https://jaspervdj.be/hakyll/tutorials/05-snapshots-feeds.html\" rel=\"nofollow noreferrer\">snapshots</a>."}], "tags": [], "owner": {"reputation": 4630, "user_id": 160386, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b6044f355342bb055fbb03804d9673e3?s=128&d=identicon&r=PG", "display_name": "Jan Tojnar", "link": "https://stackoverflow.com/users/160386/jan-tojnar"}, "is_accepted": true, "score": 1, "last_activity_date": 1474268338, "last_edit_date": 1592644375, "creation_date": 1474268338, "answer_id": 39567096, "question_id": 39566674, "link": "https://stackoverflow.com/questions/39566674/listfield-always-empty/39567096#39567096", "title": "listField always empty", "body": "<p>When you are loading an item, you need to specify a compilation target with that item \u2013 see <a href=\"https://hackage.haskell.org/package/hakyll-4.8.3.2/docs/Hakyll-Core-Compiler.html#v:load\" rel=\"nofollow noreferrer\">load</a> function.</p>\n<blockquote>\n<p><strong>load</strong> :: (Binary a, Typeable a) =&gt; Identifier -&gt; Compiler (Item a)</p>\n<p>Load an item compiled elsewhere. If the required item is not yet compiled, the build system will take care of that automatically.</p>\n</blockquote>\n<p>Adding a simple (no <code>route</code> is required) compiler should fix it:</p>\n<pre><code>match &quot;nav/*&quot; $ compile pandocCompiler\n</code></pre>\n"}], "owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 39567096, "answer_count": 1, "score": 0, "last_activity_date": 1496560052, "creation_date": 1474266635, "last_edit_date": 1496560052, "question_id": 39566674, "link": "https://stackoverflow.com/questions/39566674/listfield-always-empty", "title": "listField always empty", "body": "<p>I'd like to add a field to <code>defaultContext</code>, which will make a list of links available to all pages. Since I don't think I can change <code>defaultContext</code> itself, I've created a function which adds a <code>listField</code> to <code>defaultContext</code> and replaced all references to <code>defaultContext</code> with it. While the program complies, my new <code>listField</code> is empty. </p>\n\n<p>This is my latest attempt.</p>\n\n<pre><code>-- site.hs\nmatch \"index.html\" $ do\n    route idRoute\n    compile $ do\n        links &lt;- sortByTitle =&lt;&lt; loadAll \"links/*\"\n        let indexCtx =\n                listField \"links\" linkCtx (return links) `mappend`\n                constField \"title\" \"Home\"                `mappend`\n                myCtx\n\n        getResourceBody\n            &gt;&gt;= applyAsTemplate indexCtx\n            &gt;&gt;= loadAndApplyTemplate \"templates/default.html\" indexCtx\n            &gt;&gt;= relativizeUrls\n\nmatch \"templates/*\" $ compile templateBodyCompiler\n\nmyCtx =\n  listField \"navItems\" defaultContext (loadAll \"nav/*\") `mappend`\n  defaultContext\n\n-- nav/item.markdown\n---\ntitle: nav item 1\n---\n\n-- templates/default.html\n&lt;ul&gt;\n    $for(navItems)$\n        $title$\n    $endfor$\n&lt;/ul&gt;\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 0, "creation_date": 1474289554, "post_id": 39565944, "comment_id": 66457004, "body": "The <code>uuagc-cabal</code> program is listed in the <code>stack.yaml</code> file. Shouldn&#39;t it be enough?"}, {"owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "reply_to_user": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 1, "creation_date": 1474299834, "post_id": 39565944, "comment_id": 66464007, "body": "I don&#39;t think so, stack only uses the extra-deps to resolve dependencies, it doesn&#39;t seem to install them aggressively. Without the extra information in the cabal file, there&#39;s no way to know that this package is required as a dependency."}, {"owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "edited": false, "score": 0, "creation_date": 1474304119, "post_id": 39565944, "comment_id": 66466559, "body": "I see <a href=\"https://github.com/commercialhaskell/stack/issues/897\" rel=\"nofollow noreferrer\">#897</a> was fixed in <code>stack</code> upstream. Do I need to wait the release including that fix or can I do something for installing <code>shuflle</code> using <code>stack</code> 1.2.0?"}], "tags": [], "owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1474300607, "last_edit_date": 1474300607, "creation_date": 1474262909, "answer_id": 39565944, "question_id": 39564607, "link": "https://stackoverflow.com/questions/39564607/error-installing-the-shuffle-library-with-stack/39565944#39565944", "title": "Error installing the shuffle library with stack", "body": "<p>It appears that this package requires you to have installed <a href=\"https://hackage.haskell.org/package/uuagc-cabal-1.0.6.0\" rel=\"nofollow\">uuagc-cabal</a> to build it. Starting after Cabal-1.23 these kinds of package dependencies for Setup.hs files can be captured in the <code>custom-setup</code> section of a cabal file.</p>\n\n<p>There are tickets about this functionality for stack that seem to be interlinked from here:</p>\n\n<ul>\n<li><a href=\"https://github.com/commercialhaskell/stack/issues/897\" rel=\"nofollow\">Setup.hs cannot use local snapshot dependencies WAS stack failing to resolve local dependencies of multiple package project #897</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 3, "last_activity_date": 1474309623, "last_edit_date": 1474309623, "creation_date": 1474309303, "answer_id": 39579714, "question_id": 39564607, "link": "https://stackoverflow.com/questions/39564607/error-installing-the-shuffle-library-with-stack/39579714#39579714", "title": "Error installing the shuffle library with stack", "body": "<p>I was able to get this to work by adding the following to stack.yaml:</p>\n\n<pre><code>explicit-setup-deps:\n    shuffle: true\n</code></pre>\n\n<p>For more information, see: <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#explicit-setup-deps\" rel=\"nofollow\">https://docs.haskellstack.org/en/stable/yaml_configuration/#explicit-setup-deps</a></p>\n"}], "owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 39579714, "answer_count": 2, "score": 2, "last_activity_date": 1474309623, "creation_date": 1474252517, "last_edit_date": 1474306363, "question_id": 39564607, "link": "https://stackoverflow.com/questions/39564607/error-installing-the-shuffle-library-with-stack", "title": "Error installing the shuffle library with stack", "body": "<p>Using <code>stack 1.2.0</code> and <code>LTS 7.0</code> I'm getting the following error installing the <a href=\"https://hackage.haskell.org/package/shuffle/\" rel=\"nofollow\">shuffle</a> library:</p>\n\n<pre><code>$ cabal get shuffle\n$ cd shuffle-0.1.3.3\n$ stack build\n...\n/tmp/shuffle-0.1.3.3/Setup.hs:2:1: error:\n    Failed to load interface for \u2018Distribution.Simple.UUAGC\u2019\n    Perhaps you meant\n      Distribution.Simple.UHC (from Cabal-1.24.0.0)\n      Distribution.Simple.GHC (from Cabal-1.24.0.0)\n      Distribution.Simple.JHC (from Cabal-1.24.0.0)\n    Use -v to see a list of the files searched for.\n\n/tmp/shuffle-0.1.3.3/Setup.hs:3:1: error:\n    Failed to load interface for \u2018UU.UUAGC\u2019\n    Use -v to see a list of the files searched for.\n\n--  While building package shuffle-0.1.3.3 using:\n      /usr/local/bin/ghc --make -odir /tmp/shuffle-0.1.3.3/.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/setup -hidir /tmp/shuffle-0.1.3.3/.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/setup -i -i. -package=Cabal-1.24.0.0 -clear-package-db -global-package-db -package-db=/home/asr/.stack/snapshots/x86_64-linux/lts-7.0/8.0.1/pkgdb /tmp/shuffle-0.1.3.3/Setup.hs -o /tmp/shuffle-0.1.3.3/.stack-work/dist/x86_64-linux/Cabal-1.24.0.0/setup/setup\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>I'm using the following <code>stack.yaml</code> file:</p>\n\n<pre><code>resolver: lts-7.0\n\n# Local packages, usually specified by relative directory name\npackages:\n- '.'\nextra-deps:\n- logict-state-0.1.0.2\n- pqueue-1.3.1.1\n- uhc-util-0.1.6.6\n- uuagc-0.9.52.1\n- uuagc-cabal-1.0.6.0\n- uulib-0.9.22\n</code></pre>\n\n<p>Do I need to add/change something in the library or in <code>stack.yaml</code>? (I had no problems using <code>cabal-install</code>).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474237789, "post_id": 39563227, "comment_id": 66436989, "body": "If you could please make that a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It&#39;s a bit annoying when we need to guess what <code>Gen</code> and <code>oneof</code> are."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1474238156, "post_id": 39563227, "comment_id": 66437061, "body": "Is this a question about Quickcheck in particular, or about randomness in general?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474238697, "post_id": 39563227, "comment_id": 66437171, "body": "Since <code>Char</code> is an instance of <code>Enum</code>, you can write <code>letters = [&#39;a&#39;..&#39;z&#39;]</code> to avoid having to type out all the lowercase letters by hand."}, {"owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1474244078, "post_id": 39563227, "comment_id": 66438092, "body": "@Michael  It&#39;s about Quickcheck."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1474247894, "post_id": 39563227, "comment_id": 66438773, "body": "@chepner, one should avoid <code>oneOf</code> here. It will surely be faster to use <code>choose (&#39;a&#39;, &#39;z&#39;)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1474277225, "post_id": 39563294, "comment_id": 66449177, "body": "It might be worth mentioning <code>replicateM</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1474277789, "last_edit_date": 1474277789, "creation_date": 1474238233, "answer_id": 39563294, "question_id": 39563227, "link": "https://stackoverflow.com/questions/39563227/changing-types-in-haskell/39563294#39563294", "title": "Changing Types in Haskell", "body": "<blockquote>\n  <p>Is there a way to change a <code>Gen String</code> to a <code>String</code>?</p>\n</blockquote>\n\n<p>No, emphatically not. For some reason, people coming from other programming languages always seem to think \u201cthey're both string-kinds of types, so surely they're convertible\u201d. Nope! <code>Gen String</code> is something completely, fundamentally different from <code>String</code>. The latter is just a plain data value \u2013 a list of characters. But <code>Gen String</code> is a generator, an <em>action</em> that generates strings. Assuming this can be converted to a string is like assuming a cow can be converted to a milk bottle.</p>\n\n<p>The correct thing is for course for <code>getString</code> to also have a <code>Gen</code> type, because <em>generating</em> strings is what it does.</p>\n\n<pre><code>getString :: Int -&gt; Gen String\n</code></pre>\n\n<p>The question is how to <em>implement</em> that. Well, it's guessworking because you didn't specify what <code>Gen</code> is exactly, but such type constructors in Haskell are usually <a href=\"http://hackage.haskell.org/package/base/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow\">applicative functors</a>. That allows you to write</p>\n\n<pre><code>getString 0 = pure []\ngetString n = (:) &lt;$&gt; lowerAlpha &lt;*&gt; getString (n - 1)\n</code></pre>\n\n<p>As gallais remarks, this can also be written shorter as</p>\n\n<pre><code>getString n = replicateM n lowerAlpha\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1474244687, "creation_date": 1474244687, "answer_id": 39563857, "question_id": 39563227, "link": "https://stackoverflow.com/questions/39563227/changing-types-in-haskell/39563857#39563857", "title": "Changing Types in Haskell", "body": "<p>Perhaps you are looking for <a href=\"https://hackage.haskell.org/package/QuickCheck-2.9.2/docs/Test-QuickCheck.html#v:vectorOf\" rel=\"nofollow\"><code>vectorOf</code></a>, i.e.:</p>\n\n<pre><code>import Test.QuickCheck\n\ngetString :: Int -&gt; Gen String\ngetString n = vectorOf n lowerAlpha\n</code></pre>\n\n<p>To actually generate a random string you can use <a href=\"https://hackage.haskell.org/package/QuickCheck-2.9.2/docs/Test-QuickCheck.html#v:generate\" rel=\"nofollow\"><code>generate</code></a> (requires the IO-monad):</p>\n\n<pre><code>main = do\n  generate (getString 25) &gt;&gt;= putStrLn\n</code></pre>\n\n<p>or just from the GHCI repl:</p>\n\n<pre><code>ghci&gt; generate (getString 25)\n\"siebrxrlvuuxdvhqwcfykqwdc\"\nghci&gt; generate (getString 3)\n\"rcv\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "is_accepted": false, "score": 0, "last_activity_date": 1474260666, "creation_date": 1474260666, "answer_id": 39565585, "question_id": 39563227, "link": "https://stackoverflow.com/questions/39563227/changing-types-in-haskell/39565585#39565585", "title": "Changing Types in Haskell", "body": "<p>Thanks for your assistance. This is what I came up with. Works well. <code>str &lt;- listOf (choose ('a','z'))</code></p>\n"}], "owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1474277789, "creation_date": 1474237442, "question_id": 39563227, "link": "https://stackoverflow.com/questions/39563227/changing-types-in-haskell", "title": "Changing Types in Haskell", "body": "<p>I wish to construct a random string consisting of only alphabetical characters. This is the code I have so far:</p>\n\n<pre><code>letters :: String\nletters = \"abcdefghijklmnopqrstuvwxyz\"\n\n{- | Generates any lower case alpha character.\n-}\nlowerAlpha :: Gen Char\nlowerAlpha = oneof (map return letters)\n\ngetString :: Int -&gt; String\ngetString 0 = []\ngetString n = lowerAlpha : getString (n - 1)\n</code></pre>\n\n<p>getString is passed a random Int between 1 and 25. Because lowerAlpha returns a Gen Char getString wont work as it expects a Char in order to build a String. Is there a way to change a Gen String to a String? This is the line of code where the problem occurs - <code>getString n = lowerAlpha : getString (n - 1)</code></p>\n"}, {"tags": ["haskell", "integration-testing", "cabal"], "comments": [{"owner": {"reputation": 1075, "user_id": 1299428, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/330bcefb9bb0b6a8e071e5c8b2ff9d6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/1299428/sophie"}, "edited": false, "score": 0, "creation_date": 1475004131, "post_id": 39561978, "comment_id": 66763124, "body": "Turns out that idea 2. does not work. I have opened <a href=\"https://github.com/haskell/cabal/issues/3902\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/3902</a> and removed the integration tests from cabal."}], "owner": {"reputation": 1075, "user_id": 1299428, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/330bcefb9bb0b6a8e071e5c8b2ff9d6b?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie", "link": "https://stackoverflow.com/users/1299428/sophie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1474228124, "creation_date": 1474228124, "question_id": 39561978, "link": "https://stackoverflow.com/questions/39561978/haskell-using-cabal-test-for-integration-tests-with-code-coverage", "title": "Haskell: Using `cabal test` for integration tests with code coverage", "body": "<p>Setup: .cabal file with library, executable that depends on the library and a test-suite. The test-suite calls integration test written in python. However, that gives me empty coverage reports from <code>cabal test</code>. I think that's because python calls the executable not the test-suite?</p>\n\n<p>Questions</p>\n\n<ol>\n<li>What is the difference between \"Package coverage report\" and the \"Test coverage report\"?</li>\n<li>Should I call the test-suite binary from python, where the test-suite has a flag such that it behaves like the executable?</li>\n</ol>\n"}, {"tags": ["haskell", "pattern-matching"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 6, "last_activity_date": 1474225270, "creation_date": 1474225270, "answer_id": 39561491, "question_id": 39561427, "link": "https://stackoverflow.com/questions/39561427/why-haskell-disrespects-bound-identifiers-for-pattern-matching/39561491#39561491", "title": "Why Haskell disrespects bound identifiers for pattern matching?", "body": "<p>If bound identifiers had different semantics than unbound identifiers in a pattern match, that could be quite error prone as binding a new identifier could mess up pattern matches anywhere that identifier is in scope.</p>\n\n<p>For example let's say you're importing some module Foo (unqualified). And now the module Foo is changed to add the binding <code>x = 42</code> for some reason. Now in your pattern match you'd suddenly be comparing the first argument against 42 rather than binding it to <code>x</code>. That's a pretty hard to find bug.</p>\n\n<p>So to avoid this kind of scenario, identifier patterns have the same semantics regardless of whether they're already bound somewhere.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "is_accepted": true, "score": 6, "last_activity_date": 1474225443, "creation_date": 1474225443, "answer_id": 39561522, "question_id": 39561427, "link": "https://stackoverflow.com/questions/39561427/why-haskell-disrespects-bound-identifiers-for-pattern-matching/39561522#39561522", "title": "Why Haskell disrespects bound identifiers for pattern matching?", "body": "<p>That's how Haskell's syntax works; <strong>every lowercase-initial variable name in a pattern (re)binds that name</strong>. Any existing binding will be <em>shadowed</em>.</p>\n\n<hr>\n\n<p>But even if that weren't the case, the binding for <code>zero</code> would not be visible to the first alternative, because of how Haskell's syntax works. A similar thing happens in the following version:</p>\n\n<pre><code>f = \\v1 v2 -&gt; case (v1, v2) of\n                  (x, zero) -&gt; Nothing\n                  (x, y)    -&gt; Just $ x / y\n                    where zero = 0\n</code></pre>\n\n<p>The <strong><code>where</code> clause only applies to</strong> the <strong>one alternative</strong> that it's part of, not to the whole list of alternatives. That code is pretty much the same thing as</p>\n\n<pre><code>f = \\v1 v2 -&gt; case (v1, v2) of\n                  (x, zero) -&gt; Nothing\n                  (x, y)    -&gt; let zero = 0 in Just $ x / y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": false, "score": 2, "last_activity_date": 1474225445, "creation_date": 1474225445, "answer_id": 39561523, "question_id": 39561427, "link": "https://stackoverflow.com/questions/39561427/why-haskell-disrespects-bound-identifiers-for-pattern-matching/39561523#39561523", "title": "Why Haskell disrespects bound identifiers for pattern matching?", "body": "<p><code>zero</code> is just a variable that occurs inside a pattern, just like <code>y</code> does in the second line. There is no difference between the two. When a variable that occurs inside a pattern, this introduces a <em>new</em> variable. If there was a binding for that variable already, the new variable shadows the old one.</p>\n\n<p>So you cannot use an already bound variable inside a pattern. Instead, you should do something like that:</p>\n\n<pre><code>f x y | y == zero = Nothing\n  where zero = 0 \nf x y = Just $ x / y \n</code></pre>\n\n<p>Notice that I also moved the <code>where</code> clause to bring it in scope for the first line.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1474225823, "last_edit_date": 1474225823, "creation_date": 1474225452, "answer_id": 39561524, "question_id": 39561427, "link": "https://stackoverflow.com/questions/39561427/why-haskell-disrespects-bound-identifiers-for-pattern-matching/39561524#39561524", "title": "Why Haskell disrespects bound identifiers for pattern matching?", "body": "<p>Because they are very fragile. What does this compute?</p>\n\n<pre><code>f x y z = 2*x + 3*y + z\n</code></pre>\n\n<p>Would you expect this to be equal to</p>\n\n<pre><code>f x 3 z = 2*x + 9 + z\nf _ _ _ = error \"non-exhaustive patterns!\"\n</code></pre>\n\n<p>only because there's a <code>y = 3</code> defined somewhere in the same 1000+ line module?</p>\n\n<p>Also consider this:</p>\n\n<pre><code>import SomeLibrary\nf x y z = 2*x + 3*y + z\n</code></pre>\n\n<p>What if in a future release <code>SomeLibrary</code> defines <code>y</code>? We don't want that to suddenly stop working.</p>\n\n<p>Finally, what if there is no <code>Eq</code> instance for <code>y</code>?</p>\n\n<pre><code>y :: a -&gt; a\ny = id\n\nf :: a -&gt; (a -&gt; a) -&gt; a\nf x y = y x\nf x w = w (w x)\n</code></pre>\n\n<p>Sure, it is a contrived example, but there's no way the runtime can compare the input function to check whether it is equal to <code>y</code> or not.</p>\n\n<p>To disambiguate this, some new languages like Swift uses two different syntaxes. E.g. (pseudo-code)</p>\n\n<pre><code>switch someValue {\n  case .a(x)     : ...  // compare by equality using the outer x\n  case .b(let x) : ...  // redefine x as a new local variable, shadowing the outer one\n}\n</code></pre>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 39561522, "answer_count": 4, "score": -1, "last_activity_date": 1474474626, "creation_date": 1474224886, "last_edit_date": 1474474626, "question_id": 39561427, "link": "https://stackoverflow.com/questions/39561427/why-haskell-disrespects-bound-identifiers-for-pattern-matching", "title": "Why Haskell disrespects bound identifiers for pattern matching?", "body": "<pre><code>f x zero = Nothing\nf x y = Just $ x / y \n  where zero = 0 \n</code></pre>\n\n<p>The literal-bound identifier <code>zero</code> simply matches all after the warning <code>Pattern match(es) are overlapped</code>. </p>\n"}, {"tags": ["haskell", "syntax-error"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1474224792, "last_edit_date": 1474224792, "creation_date": 1474224434, "answer_id": 39561363, "question_id": 39561150, "link": "https://stackoverflow.com/questions/39561150/how-do-i-use-guards-parse-error-on-input/39561363#39561363", "title": "How do I use guards: parse error on input &#39;|&#39;", "body": "<p>Roughly put, guards are used at the left of <code>=</code>, as in</p>\n\n<pre><code>f x y\n   | cond1 x y = ...\n   | cond2 x y = ...\n   | otherwise = ...\n</code></pre>\n\n<p>In your code, simply remove the <code>|</code> -- you do not need guards. <code>if</code> suffices.</p>\n\n<p>Also, using <code>if null, head, tail</code> is unidiomatic, since better alternatives exist. Remember that <code>head,tail</code> will crash your program the day you will forget about the <code>null</code> check. Since pattern matching does not have that issue, it is greatly preferred when possible.</p>\n\n<pre><code>maxsubseqRecurse sofar [] = sofar\nmaxsubseqRecurse sofar (h:newRestOfList) =\n    if newSofar &lt; 0\n    then maxsubseqRecurse 0     newRestOfList\n    else maxsubseqRecurse sofar newRestOfList\n       where\n       newSofar = sofar + h\n</code></pre>\n\n<p>Reintroducing guards, we obtain:</p>\n\n<pre><code>maxsubseqRecurse sofar [] = sofar\nmaxsubseqRecurse sofar (h:newRestOfList)\n   | newSofar &lt; 0 = maxsubseqRecurse 0     newRestOfList\n   | otherwise    = maxsubseqRecurse sofar newRestOfList\n   where\n   newSofar = sofar + h\n</code></pre>\n"}], "owner": {"reputation": 254, "user_id": 4325755, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/afcb6055b5be0c5353a38ed160e05b2b?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Allard", "link": "https://stackoverflow.com/users/4325755/brent-allard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 39561363, "answer_count": 1, "score": -2, "last_activity_date": 1526258980, "creation_date": 1474223094, "last_edit_date": 1526258980, "question_id": 39561150, "link": "https://stackoverflow.com/questions/39561150/how-do-i-use-guards-parse-error-on-input", "title": "How do I use guards: parse error on input &#39;|&#39;", "body": "<p>Edit: This is an old question StackOverflow won't let me delete. At the time I didn't understand when guards were appropriate, and the selected answer gives a good description of that.</p>\n\n<p>I'm trying to write a program in Haskell that takes a list of numbers and returns the value of the largest consecutive subsequence.</p>\n\n<p>I'm getting a compilation error for line 7, the line with the first guard.</p>\n\n<pre><code>maxsubseq list = maxsubseqRecurse 0 list\n\nmaxsubseqRecurse sofar restOfList =\n   if null restOfList\n      then sofar\n      else\n         | if newSofar &lt; 0\n         |     then maxsubseqRecurse 0     newRestOfList\n         |     else maxsubseqRecurse sofar newRestOfList\n         where\n            newSofar = sofar + head restOfList\n            newRestOfList = tail restOfList\n</code></pre>\n\n<p>Why are the guards not valid syntax? My intention is to make the definition of newSofar and newRestOfList available for the three lines where there are guards.</p>\n"}, {"tags": ["haskell", "c2hs"], "answers": [{"tags": [], "owner": {"reputation": 1431, "user_id": 339925, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nVMEY.jpg?s=128&g=1", "display_name": "Paul Young", "link": "https://stackoverflow.com/users/339925/paul-young"}, "is_accepted": false, "score": 0, "last_activity_date": 1475739985, "creation_date": 1475739985, "answer_id": 39890380, "question_id": 39560533, "link": "https://stackoverflow.com/questions/39560533/how-should-i-debug-a-symbol-x-does-not-fit-here-error-when-using-c2hs/39890380#39890380", "title": "How should I debug a &quot;symbol X does not fit here&quot; error when using c2hs?", "body": "<p>As <a href=\"https://github.com/ArbiterLib/Arbiter/pull/66#issuecomment-247861164\" rel=\"nofollow\">Dave Lee pointed out</a>, it's possible to pass use the <code>--c2hs-options</code> flag like so:</p>\n\n<pre><code>cabal ... --c2hs-options=\"-d trace\"\n</code></pre>\n\n<p>I couldn't figure out how to make this work by adding to the <code>.cabal</code> or <code>stack.yaml</code> files, or by passing it on the command like in conjunction with <code>stack build</code> so just copied the command from the output of <code>stack build</code> and manually ran it with the additional flag:</p>\n\n<pre><code>/Users/py/projects/jspahrsummers/Arbiter/bindings/haskell/.stack-work/dist/x86_64-osx/Cabal-1.24.0.0/setup/setup --builddir=.stack-work/dist/x86_64-osx/Cabal-1.24.0.0 build lib:arbiter --ghc-options \" -ddump-hi -ddump-to-file\" --c2hs-options=\"-d trace\"\n</code></pre>\n"}], "owner": {"reputation": 1431, "user_id": 339925, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nVMEY.jpg?s=128&g=1", "display_name": "Paul Young", "link": "https://stackoverflow.com/users/339925/paul-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475739985, "creation_date": 1474219252, "question_id": 39560533, "link": "https://stackoverflow.com/questions/39560533/how-should-i-debug-a-symbol-x-does-not-fit-here-error-when-using-c2hs", "title": "How should I debug a &quot;symbol X does not fit here&quot; error when using c2hs?", "body": "<p>I'm new to using c2hs and having <a href=\"https://github.com/jspahrsummers/Arbiter/pull/66#issuecomment-247859427\" rel=\"nofollow\">this issue</a>.</p>\n\n<p>I'm not sure how to start debugging this, and haven't found anything with a Google search or by looking through the issues on GitHub.</p>\n\n<p>Where should I begin, and what are some resources that could help?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1474217348, "post_id": 39560150, "comment_id": 66430934, "body": "SO isn&#39;t a good site for code review, but it seems to me you want <code>checkPhoneBook :: String -&gt; PhoneBook -&gt; Bool</code>, or <code>... -&gt; PresentInPhoneBook</code> would be okay too, if you have a reason to use a special type for that property."}, {"owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "edited": false, "score": 3, "creation_date": 1474217818, "post_id": 39560150, "comment_id": 66431095, "body": "<a href=\"http://codereview.stackexchange.com/\">Code Review</a> might be a better place to ask this."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1474219903, "post_id": 39560150, "comment_id": 66431853, "body": "Why use a type with as many values as <code>String</code> for <code>IsPresent</code> (resp. <code>IsNotPresent</code>) when you only plan on using the one value <code>&quot;Match&quot;</code> (resp. <code>&quot;No Match&quot;</code>)? It would make much more sense to make them types that only have one value in the first place like <code>type IsPresent = (); type IsNotPresent = ()</code>. But then you get <code>Either () ()</code>, which is basically the same to the machine as <code>Bool</code> or <code>PresentInPhoneBook</code> but less readable to humans. So at the end of all these refactorings, you end up at one of those two types instead of using <code>Either</code> or the <code>IsPresent</code>/<code>IsNotPresent</code> types at all."}], "answers": [{"comments": [{"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1474218553, "post_id": 39560242, "comment_id": 66431344, "body": "What are the scenarios where using &#39;Either&#39; is helpful?"}, {"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1474218646, "post_id": 39560242, "comment_id": 66431375, "body": "@barbrac When you have to return some value for each of the two cases."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1474229276, "post_id": 39560242, "comment_id": 66434782, "body": "@barbrac Think of <code>Either a b</code> as a generalization of <code>Maybe b</code>. <code>Right y</code> is used in the same way as <code>Just y</code>, but <code>Left x</code> allows you to specify a different value <code>x :: a</code> for each possible error, instead of just one catch-all return value of <code>Nothing</code>."}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": true, "score": 1, "last_activity_date": 1474217518, "creation_date": 1474217518, "answer_id": 39560242, "question_id": 39560150, "link": "https://stackoverflow.com/questions/39560150/haskell-either-data-type-and-readability/39560242#39560242", "title": "Haskell &#39;Either&#39; data type and readability?", "body": "<p>I would write it like that:</p>\n\n<pre><code>import Data.Maybe (isJust)\n\ncheckPhoneBook :: String -&gt; PhoneBook -&gt; PresentInPhoneBook\ncheckPhoneBook name pb = isJust (lookup name pb)\n</code></pre>\n\n<p>There is not reason for use to have <code>checkPhoneBook</code> return <code>Either IsPresent IsNotPresent</code>. Just return <code>PresentInPhoneBook</code>. In this case it would also be ok to return a <code>Bool</code>. Also take a note of <a href=\"https://hackage.haskell.org/package/base/docs/Prelude.html#v:lookup\" rel=\"nofollow\">lookup</a> (that I use above). It returns a <code>Maybe</code> value, so you can use it to lookup a name as well as to figure out if a name exists in the phone book.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474235629, "post_id": 39562565, "comment_id": 66436578, "body": "A very valid comment (it baffles me why it is true that so many people think it is a good idea to state redundant truthness by being redundant), but not an answer."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474252956, "post_id": 39562565, "comment_id": 66439722, "body": "@leftaroundabout question was for improvements that make code more readable."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 2, "last_activity_date": 1474231834, "creation_date": 1474231834, "answer_id": 39562565, "question_id": 39560150, "link": "https://stackoverflow.com/questions/39560150/haskell-either-data-type-and-readability/39562565#39562565", "title": "Haskell &#39;Either&#39; data type and readability?", "body": "<p>Is this</p>\n\n<pre><code>if foldRes == True then\n</code></pre>\n\n<p>by accident, or do you find it more readable than just</p>\n\n<pre><code>if foldRes then\n</code></pre>\n\n<p>In the latter case, I'd propose</p>\n\n<pre><code>if (foldRes == True) == True then\n</code></pre>\n\n<p>which must be, by extension, even more readable.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 39560242, "answer_count": 2, "score": 0, "last_activity_date": 1474231834, "creation_date": 1474216983, "question_id": 39560150, "link": "https://stackoverflow.com/questions/39560150/haskell-either-data-type-and-readability", "title": "Haskell &#39;Either&#39; data type and readability?", "body": "<p>I'm learning 'Either' data structures in Haskell and have written the following:</p>\n\n<pre><code>type PhoneBook = [(String, String)] \ncreatePhoneBook :: PhoneBook --Use function to generate instance of type\ncreatePhoneBook = [(\"betty\",\"1212-232\"),\n                   (\"billy\", \"3443-434\"),\n                   (\"derdre\", \"3232-221\")]\n\ndata PresentInPhoneBook = Present | NotPresent deriving (Show, Eq) --Either \ntype IsPresent = String\ntype IsNotPresent = String\n\ncheckPhoneBook :: String -&gt; PhoneBook -&gt; Either IsPresent IsNotPresent\ncheckPhoneBook name pb = if foldRes == True then Left \"Match\" else Right \"No Match\"\nwhere \n    foldRes = foldl (\\acc (key,value) -&gt; if key == name then True else acc) False pb\n</code></pre>\n\n<p>Are there any improvements to make this code more readable? </p>\n\n<p>I appreciate its a trivial example, but I'm just learning at this stage.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1474216835, "post_id": 39560029, "comment_id": 66430753, "body": "Turn on <code>UndecidableInstances</code> and it ought to work. GHC&#39;s termination checker is not particularly sophisticated; using a type family on the RHS of another type family is one of the things that&#39;s forbidden."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1474239078, "post_id": 39560577, "comment_id": 66437226, "body": "To be fair, it&#39;s not the call to <code>+</code> that makes your example non-terminating, it&#39;s the recursive call to <code>Length</code> on a non-smaller argument. GHC rejects nested type families because it can&#39;t be certain <code>+</code> doesn&#39;t mutually-recursively call <code>Length</code> in a way that produces non-termination. Not for any principled reason - just because GHC doesn&#39;t feature a very smart termination checker. A better (read: <i>more complex</i>) system would accept the OP&#39;s definition but not your one."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1474239656, "post_id": 39560577, "comment_id": 66437327, "body": "Ah. I hadn&#39;t ever pondered this too deeply - your comment sure is helpful."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 6, "last_activity_date": 1474219480, "creation_date": 1474219480, "answer_id": 39560577, "question_id": 39560029, "link": "https://stackoverflow.com/questions/39560029/illegal-nested-type-family-application-use-undecidableinstances-to-permit-this/39560577#39560577", "title": "Illegal nested type family application (Use UndecidableInstances to permit this)", "body": "<p>You'll need to turn on <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#ghc-flag--XUndecidableInstances\" rel=\"noreferrer\"><code>UndecideableInstances</code></a>. This extension lifts a bunch of restrictions whose presence ensures that compilation will always terminate. One of these has to do with type families. In your first example, the outer term on the RHS is an actual type, not another call to a type function. On the other hand, in the your second example, the RHS is entirely a call to the type function <code>(+)</code> (not to be mistaken with the value level function of the same name).</p>\n\n<p>GHC complains because it can't tell what you wrote ever terminates. In fact, minor variations of it don't: </p>\n\n<pre><code>type family Length (l :: [*]) :: Nat where\n    Length '[] = 0\n    Length (a ': as) = 1 + Length (a ': as)\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 6765537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de81569281aa0cff6985a18e9e291168?s=128&d=identicon&r=PG&f=1", "display_name": "xuh", "link": "https://stackoverflow.com/users/6765537/xuh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 39560577, "answer_count": 1, "score": 2, "last_activity_date": 1474219480, "creation_date": 1474216215, "question_id": 39560029, "link": "https://stackoverflow.com/questions/39560029/illegal-nested-type-family-application-use-undecidableinstances-to-permit-this", "title": "Illegal nested type family application (Use UndecidableInstances to permit this)", "body": "<p>In GHC 8.0.1, I'm trying to implement a type-level <code>Length</code> function for type-level lists. It compiles: </p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeOperators, TypeFamilies #-}\n\ndata Nat = Z | S Nat\n\ntype family Length (l :: [*]) :: Nat where\n    Length '[] = Z\n    Length (_ ': as) = S (Length as)    \n</code></pre>\n\n<p>But if I use <code>TypeLits</code>, it doesn't compile:</p>\n\n<pre><code>import GHC.TypeLits\n\ntype family Length (l :: [*]) :: Nat where\n    Length '[] = 0\n    Length (_ ': as) = 1 + Length as\n</code></pre>\n\n<p>The compiler gives the following error:</p>\n\n<pre><code>\u2022 Illegal nested type family application \u20181 + Length as\u2019\n  (Use UndecidableInstances to permit this)\n\u2022 In the equations for closed type family \u2018Length1\u2019\n  In the type family declaration for \u2018Length1\u2019\n</code></pre>\n"}, {"tags": ["windows", "haskell", "emacs"], "comments": [{"owner": {"reputation": 514, "user_id": 1375259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yuWQ9.jpg?s=128&g=1", "display_name": "Chakravarthy Raghunandan", "link": "https://stackoverflow.com/users/1375259/chakravarthy-raghunandan"}, "edited": false, "score": 0, "creation_date": 1474270253, "post_id": 39559562, "comment_id": 66445307, "body": "why would want to use ghci inside <code>shell</code> in emacs ? Wouldn&#39;t be easier to just use the <code>haskell-interactive-mode</code> provided by <code>haskell-mode</code> or use <code>intero-mode</code> (if you&#39;re using <code>stack</code>)"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 514, "user_id": 1375259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yuWQ9.jpg?s=128&g=1", "display_name": "Chakravarthy Raghunandan", "link": "https://stackoverflow.com/users/1375259/chakravarthy-raghunandan"}, "edited": false, "score": 0, "creation_date": 1474272448, "post_id": 39559562, "comment_id": 66446436, "body": "That&#39;s what I called haskell comint in the question, it doesn&#39;t work either."}, {"owner": {"reputation": 514, "user_id": 1375259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yuWQ9.jpg?s=128&g=1", "display_name": "Chakravarthy Raghunandan", "link": "https://stackoverflow.com/users/1375259/chakravarthy-raghunandan"}, "edited": false, "score": 0, "creation_date": 1474276107, "post_id": 39559562, "comment_id": 66448505, "body": "Oh sorry about that, my bad.  I just tested it out and it works fine for me (in <code>intero-repl</code> as well as GHCi running in <code>shell</code> in emacs). I&#39;ve no clue as to why its not working in your case. Maybe you can post this in emacs stackexchange to get more visibility than on stackoverflow."}], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1474752391, "creation_date": 1474213808, "question_id": 39559562, "link": "https://stackoverflow.com/questions/39559562/ghci-in-emacs-shell-cannot-be-interrupted-by-c-c-on-windows-10", "title": "GHCI in emacs shell cannot be interrupted by C-c on Windows 10", "body": "<p>After I upgraded from Windows 7 to Windows 10, <code>C-c C-c</code> doesn't interrupt GHCI anymore, be it in the haskell comint, shell or eshell.</p>\n\n<p>Try <code>M-x shell</code> then run GHCI and for example <code>getLine</code>. It will wait for you to type a line, then you can hit <code>C-c C-c</code> and see it doesn't interrupt the <code>getLine</code>. Sometimes hitting <code>C-c C-c</code> again does interrupt it, but not always.</p>\n\n<p>A single <code>C-c</code> works fine in the standard Windows shell (cmd).</p>\n\n<p>Do you know why ?</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "edited": false, "score": 1, "creation_date": 1474213622, "post_id": 39559505, "comment_id": 66429525, "body": "It is not allowed, but try this instead: <code>\\x -&gt; let k = x+1 in k</code>."}, {"owner": {"reputation": 165, "user_id": 4783340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fca6f1178b84e8293ff05526491c36d0?s=128&d=identicon&r=PG&f=1", "display_name": "Arpan Biswas", "link": "https://stackoverflow.com/users/4783340/arpan-biswas"}, "reply_to_user": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "edited": false, "score": 0, "creation_date": 1474213708, "post_id": 39559505, "comment_id": 66429556, "body": "So we can use let but not where. Can we use case?"}, {"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "edited": false, "score": 2, "creation_date": 1474213873, "post_id": 39559505, "comment_id": 66429626, "body": "Yes, <code>case</code> (and <code>let .. in</code> for that matter) are ordinary expressions, so they are allowed. For <code>case</code>, see also the <code>LambdaCase</code> extension."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1474224310, "post_id": 39559622, "comment_id": 66433320, "body": "Interesting. <code>case .. where</code> is, in my experience, quite rare to meed in actual code -- I forgot this was actually possible. :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1474235366, "post_id": 39559622, "comment_id": 66436523, "body": "@chi, I personally use it a decent amount in <code>containers</code>. It&#39;s pretty useful when casing on a view. <code>case viewl xs of y :&lt; ys -&gt; ... where ...</code>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1474214084, "creation_date": 1474214084, "answer_id": 39559622, "question_id": 39559505, "link": "https://stackoverflow.com/questions/39559505/can-we-use-where-in-a-lambda-function-in-haskell/39559622#39559622", "title": "Can we use &#39;where&#39; in a lambda function in Haskell?", "body": "<p>You can use <code>where</code> in certain expressions within a lambda expression, but not just inside.</p>\n\n<pre><code>f = \\x -&gt;\n  case x of\n    Nothing -&gt; 12\n    Just y -&gt; z * 2\n      where z = y + 7\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 4783340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fca6f1178b84e8293ff05526491c36d0?s=128&d=identicon&r=PG&f=1", "display_name": "Arpan Biswas", "link": "https://stackoverflow.com/users/4783340/arpan-biswas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 39559622, "answer_count": 1, "score": 0, "last_activity_date": 1474214084, "creation_date": 1474213514, "question_id": 39559505, "link": "https://stackoverflow.com/questions/39559505/can-we-use-where-in-a-lambda-function-in-haskell", "title": "Can we use &#39;where&#39; in a lambda function in Haskell?", "body": "<p>I was wondering if we can use where in an anonymous function or not. I tried to do it in this way:  </p>\n\n<pre><code>\\x -&gt; k where k = x+1\n</code></pre>\n\n<p>But this gives a parse error on 'where'.</p>\n"}, {"tags": ["windows", "haskell", "threepenny-gui"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474212891, "post_id": 39559309, "comment_id": 66429288, "body": "What browser you use and whether you kill it won&#39;t bother threepenny in the least \u2013 this is all about the server process. In what way did you \u201ckill the Buttons program\u201d (and how exactly did you launch it, anyway)?"}, {"owner": {"reputation": 91, "user_id": 6845640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6552058ade3854a6e0142cba989385c?s=128&d=identicon&r=PG&f=1", "display_name": "John O&#39;D", "link": "https://stackoverflow.com/users/6845640/john-od"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474215478, "post_id": 39559309, "comment_id": 66430244, "body": "I launched it in a bash shell under cygwin with runhaskell Buttons.hs.  I killed it by ^C in the bash shell.  Also, I killed the shell, and checked that no Haskell process or bash process was running using ps.  The browser I used: Chrome, Firefox, and Edge."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474216170, "post_id": 39559309, "comment_id": 66430512, "body": "Well, ^C <i>should</i> be enough, but cygwin terminals may be at times a bit strange with keyboard commands. Note that <code>runhaskell</code> is an alias for <code>runghc</code>, and as such it will turn up in <code>ps</code>. Sure there is no such process left?"}, {"owner": {"reputation": 91, "user_id": 6845640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6552058ade3854a6e0142cba989385c?s=128&d=identicon&r=PG&f=1", "display_name": "John O&#39;D", "link": "https://stackoverflow.com/users/6845640/john-od"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1474220366, "post_id": 39559309, "comment_id": 66431998, "body": "You&#39;re right, you nailed it!  There is a ghc process still running!  In bash, ps -a shows three processes: mintty, ps, bash but I just tried ps in powershell, and it does show ghc running.  Apparently the ^C in bash didn&#39;t actually kill the ghc process, and bash ps didn&#39;t display ghc running.  Using powershell I killed ghc, and now the other samples (Canvas etc) work fine.  You pointed me in the right direction, thanks very much!  Bottom line: don&#39;t assume ^C in bash will kill ghc even if ps doesn&#39;t show ghc running."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1474221070, "post_id": 39559309, "comment_id": 66432232, "body": "Yes, that is: don&#39;t assume ^C <i>in Cygwin</i> will kill the processes. In a native Unix environment, this does work quite reliably!"}], "owner": {"reputation": 91, "user_id": 6845640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6552058ade3854a6e0142cba989385c?s=128&d=identicon&r=PG&f=1", "display_name": "John O&#39;D", "link": "https://stackoverflow.com/users/6845640/john-od"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474212259, "creation_date": 1474212259, "question_id": 39559309, "link": "https://stackoverflow.com/questions/39559309/how-to-terminate-a-threepenny-gui-process-on-windows", "title": "How to terminate a threepenny gui process on windows?", "body": "<p>I'm trying Threepenny gui in Haskell with ghc-8.0.1, running in cygwin on Windows 10, using Chrome.  But I can get only one of the sample programs to work.</p>\n\n<p>I launched the Buttons example from the Threepenny gui samples (runhaskell Buttons.hs), and the gui displayed fine in Chrome.  Then I closed the Chrome tab, and tried another example (Canvas.hs).  When I entered <a href=\"http://localhost:8023\" rel=\"nofollow\">http://localhost:8023</a> into Chrome, it brought up the Buttons example again, not Canvas.  I've tried several approaches to terminate Buttons, and I've tried most of the other examples in the samples directory, but Buttons always comes up in the browser.  The other examples (Canvas etc.) all run fine in the cygwin bash shell, but Buttons always appears in the browser (and Buttons works interactively).</p>\n\n<p>What I've tried: killing the Buttons program. Using <a href=\"http://127.0.0.1:8023\" rel=\"nofollow\">http://127.0.0.1:8023</a>.  Killing the bash shell and launching a new one.  Killing Chrome and launching a new Chrome process.  Doing ps to make sure no Haskell process is running, then starting a new bash shell.  Trying Firefox.  Trying Edge.  Removing the History (in all three browsers).</p>\n\n<p>Is there a buffer or stream that has to be cleared manually?  How can I run Canvas after having run Buttons: what am I doing wrong? Can a Threepenny application terminate itself cleanly to prevent this problem? </p>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 2, "creation_date": 1474208390, "post_id": 39558488, "comment_id": 66427856, "body": "Finally I came up with something that type checks: <code>instance Functor (Flip K a) where   fmap f (Flip (K x)) = Flip (K (f x))</code>. But right now I can&#39;t explain it to myself (don&#39;t even know whether it is correct)."}], "answers": [{"tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": true, "score": 1, "last_activity_date": 1476091516, "last_edit_date": 1495535654, "creation_date": 1474209407, "answer_id": 39558815, "question_id": 39558488, "link": "https://stackoverflow.com/questions/39558488/how-to-write-the-functor-instance-for-this-type/39558815#39558815", "title": "How to write the Functor instance for this type?", "body": "<p>Let's have a look at your solution:</p>\n\n<pre><code>instance Functor (Flip K a) where\n  fmap f (Flip (K a)) = Flip (K (f b))\n</code></pre>\n\n<p>What does <code>Flip (K a)</code> actually mean?</p>\n\n<p><code>K</code> is the constant functor, which you implemented correctly. It disregards the function <code>f</code> and always returns <code>K a</code>. But what actually happens behind the scenes is that the value <code>K a b</code> is transformed into <code>K a c</code>. Even though the function <code>f</code> was disregarded, the second type of <code>K</code> changed according to the type of <code>f</code>.</p>\n\n<p>Now if we <code>Flip</code> <code>K</code>, we simply turn around the arguments:</p>\n\n<pre><code>Flip (K a b) == K b a\n</code></pre>\n\n<p>Instead of having a constant value and ignoring the function, we have a changing value and a constant \"ignored\" type. Looking at the implementation with explicit type signatures we get:</p>\n\n<pre><code>instance Functor (Flip K a) where\n  fmap :: (b -&gt; c) -&gt; Flip K a b -&gt; Flip K a c -- or:\n  fmap :: (b -&gt; c) -&gt; K b a -&gt; K c a\n  fmap f (Flip (K a)) = Flip (K (f b))\n</code></pre>\n\n<p>As you already concluded, the only possible implementation is the one above.</p>\n\n<p>You can actually see the use cases of a <code>Constant</code> functor in <a href=\"https://stackoverflow.com/questions/39951758/foldable-monoid-and-monad/\">this</a> question.</p>\n"}], "owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 39558815, "answer_count": 1, "score": 1, "last_activity_date": 1476091516, "creation_date": 1474207542, "question_id": 39558488, "link": "https://stackoverflow.com/questions/39558488/how-to-write-the-functor-instance-for-this-type", "title": "How to write the Functor instance for this type?", "body": "<p>I'm struggling with an exercise from <a href=\"http://haskellbook.com/\" rel=\"nofollow\">Haskell Book</a> (Chapter 16. Functor). Given the following, it expects me to define <code>fmap</code>:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\nnewtype Flip f a b = \n   Flip (f b a) \n   deriving (Eq, Show)\n\nnewtype K a b = \n  K a\n\ninstance Functor (Flip K a) where\n   fmap = undefined\n</code></pre>\n\n<p>In a previous exercise I've already done the following:</p>\n\n<pre><code> data K a b =\n   K a\n\n instance Functor (K a) where\n   fmap f (K x) = K x\n</code></pre>\n\n<p>But for this <code>Flip a b</code>, I can't even understand how to get started, e.g. how to continue <code>fmap f Flip ...</code>.</p>\n\n<p>I thought maybe before doing that I should also write a functor for the newtype <code>K a b</code>, similar to what I did <code>data K a b</code>:</p>\n\n<pre><code>instance Functor (K a) where\n  fmap f (K x) = K x\n</code></pre>\n\n<p>But I can't understand how to proceed to the Functor instance for <code>Flip f a b</code>.</p>\n\n<p>Any ideas, hints? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9524, "user_id": 1403794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1420515a7407d0b5867ad3fe6f37f0?s=128&d=identicon&r=PG", "display_name": "Kris Vandermotten", "link": "https://stackoverflow.com/users/1403794/kris-vandermotten"}, "edited": false, "score": 0, "creation_date": 1474204846, "post_id": 39558061, "comment_id": 66426809, "body": "You may want to read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 6258, "user_id": 1527018, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62e4e73fe7386a5e9401f90dc98c7584?s=128&d=identicon&r=PG", "display_name": "mic4ael", "link": "https://stackoverflow.com/users/1527018/mic4ael"}, "edited": false, "score": 1, "creation_date": 1474204855, "post_id": 39558061, "comment_id": 66426811, "body": "more details about what exactly &quot;crush program&quot; means would be really helpful"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 0, "last_activity_date": 1474206448, "creation_date": 1474206448, "answer_id": 39558317, "question_id": 39558061, "link": "https://stackoverflow.com/questions/39558061/why-my-code-cant-work-and-no-error-message/39558317#39558317", "title": "Why my code can&#39;t work and no error message?", "body": "<p>This is much simpler if you define all your conversion factors in one place:</p>\n\n<pre><code>cf :: Weight_unit -&gt; Weight_unit -&gt; Float\ncf G KG = 1 / 1000\ncf G T = 1/1000000\ncf KG T = 1/1000\ncf KG G = 1000\ncf T KG = 1000\ncf T G = 1000000\ncf _ _ = 1\n</code></pre>\n\n<p>Now, your <code>convert</code> function just needs to call <code>cf</code> using the current and target units:</p>\n\n<pre><code>convert :: Weight -&gt; Weight_unit -&gt; Weight\nconvert (Weight v u1) u2 = Weight (v*(cf u1 u2)) u2\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6744061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5271189c8671d9ff9ee098280d23cfa6?s=128&d=identicon&r=PG&f=1", "display_name": "kkkjjj", "link": "https://stackoverflow.com/users/6744061/kkkjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 39558317, "answer_count": 1, "score": 0, "last_activity_date": 1474206448, "creation_date": 1474204741, "question_id": 39558061, "link": "https://stackoverflow.com/questions/39558061/why-my-code-cant-work-and-no-error-message", "title": "Why my code can&#39;t work and no error message?", "body": "<p>I'm new in Haskell and I tried following for practice. It does not have error but it cannot work and crush the program.\nCan anyone tell me why?</p>\n\n<pre><code>type Weight_value = Float\ndata Weight_unit = G | KG | T\n    deriving (Show, Eq)\ndata Weight = Weight {value :: Weight_value, unit :: Weight_unit}\n    deriving (Show)\ninstance Eq Weight where\n    weight_left == weight_right = \n        convert weight_left KG == convert weight_right KG\n\nto_g :: Weight -&gt; Weight\nto_g weight = case weight of\n    Weight gram G   -&gt; Weight gram G\n    Weight kilo KG  -&gt; Weight (kilo*1000) G\n    Weight tone T   -&gt; Weight (tone*1000000)G\n\nto_kg :: Weight -&gt; Weight\nto_kg weight = case weight of\n    Weight gram G   -&gt; Weight (gram/1000) KG\n    Weight kilo KG  -&gt; Weight kilo KG\n    Weight tone T   -&gt; Weight (tone*1000) KG\n\nto_t :: Weight -&gt;Weight\nto_t weight = case weight of\n    Weight gram G   -&gt; Weight (gram/1000000) T\n    Weight kilo KG  -&gt; Weight (kilo/1000) T\n    Weight tone T   -&gt; Weight tone T\n\nconvert :: Weight -&gt; Weight_unit -&gt; Weight\nconvert weight unit = case unit of\n    G       -&gt; to_g         weight\n    KG      -&gt; to_kg        weight\n    T       -&gt; to_t         weight\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 1, "creation_date": 1474212684, "post_id": 39557563, "comment_id": 66429222, "body": "What are <code>Context</code>, <code>Error</code> and <code>Env</code> ? Please  write the modules you import."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474249078, "post_id": 39557563, "comment_id": 66439034, "body": "You&#39;ve stated the problem, but not any attempt to solve it. Substitute your definitions for <code>&gt;&gt;=</code> and <code>return</code> in the monad laws, go from there."}], "owner": {"reputation": 31, "user_id": 2852169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100005050590421/picture?type=large", "display_name": "N&#225;ndor Z. Papp", "link": "https://stackoverflow.com/users/2852169/n%c3%a1ndor-z-papp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474205422, "creation_date": 1474201027, "last_edit_date": 1474205422, "question_id": 39557563, "link": "https://stackoverflow.com/questions/39557563/does-this-monad-instance-follow-the-monadic-laws", "title": "Does this Monad instance follow the monadic laws?", "body": "<p>I am new to Haskell and I'm trying to figure out if the following snippets of code obey the Monad Laws.</p>\n\n<pre><code>newtype SubsM a = SubsM {runSubsM :: Context -&gt; Either Error (a, Env)}\n\ninstance Functor SubsM where\n  fmap f m = m &gt;&gt;= \\a -&gt; return (f a)\n\ninstance Applicative SubsM where\n  pure = return; (&lt;*&gt;) = ap\n\ninstance Monad SubsM where\n    return x = SubsM (\\ctx -&gt; Right (x, fst ctx))\n    SubsM m &gt;&gt;= f = SubsM $ \\c -&gt; case m c of \n        Left(Error s) -&gt; Left(Error s)\n        Right (a, env) -&gt; runSubsM (f a) (env, snd c)\n    fail s = SubsM $ \\c -&gt; Left(Error s)\n</code></pre>\n\n<p>On the right side the monad contains the state, which in this case may contain an error message while on the left side it contains the context. I have been looking up the monadic laws which state that:<br>\n - we need to get the left part of the monad (left identity)<br>\n - we need to get the right part of the monad (right identity)<br>\n - we need to be able to chain functions (associativity)  </p>\n"}, {"tags": ["haskell", "cabal", "build-error"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1474202041, "post_id": 39557158, "comment_id": 66426067, "body": "See <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9237\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/9237</a>."}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1474203111, "post_id": 39557158, "comment_id": 66426341, "body": "@ReidBarton hmmm I saw something like that but I hoped I wouldn&#39;t have to change a system-wide file like that but if it is a bug then that&#39;s the best solution I guess"}], "owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474198513, "creation_date": 1474198161, "last_edit_date": 1474198513, "question_id": 39557158, "link": "https://stackoverflow.com/questions/39557158/cabal-build-for-my-project-fails-linking-llvm-general-package", "title": "cabal build for my project fails linking llvm-general package", "body": "<p>I have a cabal project, when I issue <code>cabal build</code> I get this :</p>\n\n<pre><code>Building phjava-0.1.0.0...\nPreprocessing executable 'phjava' for phjava-0.1.0.0...\n[2 of 3] Compiling CodeGen          ( src/CodeGen.hs, dist/build/phjava/phjava-tmp/CodeGen.o )\n\n&lt;no location info&gt;: error:\n    &lt;command line&gt;: can't load .so/.DLL for: /usr/lib/libcurses.so (-lncursesw: cannot open shared object file: No such file or directory)\n</code></pre>\n\n<p>This is the output with <code>--verbose=3</code> : <a href=\"http://pastebin.com/J7rgGDnL\" rel=\"nofollow\">verbose output</a></p>\n\n<p>This is my cabal file : </p>\n\n<pre><code>name:                 phjava\nversion:              0.1.0.0\nsynopsis:\n-- description:\n-- license:\n-- license-file:\nhomepage:\nauthor:               abnud1\nmaintainer:           ahmad13932013@hotmail.com\ncategory:             Language\n-- copyright:\nbuild-type:           Simple\n-- extra-source-files:\ncabal-version:        &gt;=1.10\n\nexecutable phjava\n  main-is:              Main.hs\n  -- other-modules:\n  -- other-extensions:\n  build-depends:        base &gt;= 4.7 &amp;&amp; &lt; 5 , parsec &lt; 4, containers &lt; 1 , regex-pcre &lt; 1 , parsec-permutation &lt; 1 , transformers &lt; 1 , logfloat &lt; 0.14, llvm-general-pure &lt; 4, llvm-general, mtl &lt; 3\n  hs-source-dirs:       src\n  default-language:     Haskell2010\n  ghc-options: -Wall\n</code></pre>\n\n<p>I have ghc 8.0.1, cabal 1.24, llvm-3.8.1 . I installed llvm-general by cloning the llvm-3.8 branch and running cabal install with -fshared-llvm.</p>\n\n<p>I assure you I have ncurses installed, also <code>libcurses.so</code> file is a symlink to <code>/usr/lib/libncurses.so</code>, I also have <code>/usr/lib/libncursesw.so</code> (which is also a symlink to <code>/usr/lib/libncursesw.so.6</code>).  </p>\n\n<p>Last my OS is Arch Linux 64 bit and I also have ncurses5-compat-libs installed from AUR(and uninstalling it didn't help).  </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1474197224, "post_id": 39557021, "comment_id": 66424798, "body": "What also confuses me is that there is mention of <code>State#</code> and <code>#State#</code> - are those both the same or is there a difference?"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1474197558, "post_id": 39557021, "comment_id": 66424887, "body": "Ahhh! So there is no <code>a#</code> involved then, too?!?!! This might just be the proof that haskell parser is more intelligent at parsing as I am :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1474197736, "post_id": 39557021, "comment_id": 66424925, "body": "You actually need two language extensions for this code: <code>UnboxedTuples</code> for the unboxed tuples and <code>MagicHash</code> to allow identifier names like <code>State#</code>."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1474197942, "post_id": 39557021, "comment_id": 66424962, "body": "@dfeuer Thanks for dropping the google-able name <code>MagicHash</code>!"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1474310517, "post_id": 39557021, "comment_id": 66469844, "body": "I found a good entry point explaining matters: <a href=\"https://downloads.haskell.org/~ghc/6.12.3/docs/html/users_guide/primitives.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/6.12.3/docs/html/users_guide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1874, "user_id": 4607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6bbf7ed20f7a436af3468750f97d680d?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/4607/ben"}, "is_accepted": true, "score": 5, "last_activity_date": 1474264546, "last_edit_date": 1474264546, "creation_date": 1474197141, "answer_id": 39557021, "question_id": 39556936, "link": "https://stackoverflow.com/questions/39556936/what-is-the-meaning-of/39557021#39557021", "title": "What is the meaning of &#39;#&#39;?", "body": "<p>You need a language extension to even be able to use it, that's how special it is!</p>\n\n<p>It doesn't do anything, it's just a special-looking character that the GHC people see to like using in the names of low-level-ish maybe-boxing-related things.</p>\n\n<p>There's <code>(# a, b #)</code> which is the type of an unboxed tuple of <code>a</code> and <code>b</code>, which is what you're seeing there--it's not <code>( #State# , ...</code>, it's <code>(# State#, ...</code>.</p>\n"}], "owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 39557021, "answer_count": 1, "score": 4, "last_activity_date": 1474264546, "creation_date": 1474196572, "last_edit_date": 1474197159, "question_id": 39556936, "link": "https://stackoverflow.com/questions/39556936/what-is-the-meaning-of", "title": "What is the meaning of &#39;#&#39;?", "body": "<pre><code>STM (State# RealWorld -&gt; (#State# RealWorld, a#))\n</code></pre>\n\n<p><code>#</code> does not show up in the list of Haskell operators and google is not yielding anything useful as well. <code>Ghci:&gt;:t (#)</code> states: Variable not in scope.</p>\n\n<p>So what does that character do? And why is it used in the above piece of code (from STM)?</p>\n"}, {"tags": ["haskell", "hash", "libraries"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474195317, "post_id": 39556394, "comment_id": 66424322, "body": "<code>cryptonite</code> is a <i>cryptographic <b>primitive</b> library</i> \u2013 for computing hashes from raw binary data, but it doesn&#39;t really seem to offer an interface for actually hashing Haskell values. I suppose the idea is that you should combine it with your favourite serialisation library for that purpose, e.g. <a href=\"http://hackage.haskell.org/package/cereal\" rel=\"nofollow noreferrer\"><code>cereal</code></a>. There&#39;s also a <a href=\"http://hackage.haskell.org/package/crypto-simple\" rel=\"nofollow noreferrer\"><code>crypto-simple</code></a> library that seems to target applications such as yours."}], "answers": [{"comments": [{"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1474197915, "post_id": 39556727, "comment_id": 66424955, "body": "Thanks, that&#39;s completely correct and I should have checked but my problem is that I need to do a bit more than straight hashing a digest. For instance, I need to concatenate a given ByteString before taking the hash. Eg something like <code>hash (append someBstring hash firstBstring)</code>. I&#39;ll update my question."}, {"owner": {"reputation": 1874, "user_id": 4607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6bbf7ed20f7a436af3468750f97d680d?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/4607/ben"}, "reply_to_user": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1474198024, "post_id": 39556727, "comment_id": 66424985, "body": "You can call <code>hashUpdate</code> multiple times, once on the digest from the previous hashing and once on the extra bytestring(s)."}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1474198558, "post_id": 39556727, "comment_id": 66425129, "body": "Thanks. I don&#39;t think I understand the <code>hasUpdate</code> function properly. How should I use it to hash the contatenation of a given ByteString to the result of a previous hash? Don&#39;t I need to convert the result of the previous hash to ByteString?"}, {"owner": {"reputation": 1874, "user_id": 4607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6bbf7ed20f7a436af3468750f97d680d?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/4607/ben"}, "reply_to_user": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 1, "creation_date": 1474200036, "post_id": 39556727, "comment_id": 66425498, "body": "Updated my answer with an example, does that help?"}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1474204824, "post_id": 39556727, "comment_id": 66426799, "body": "Works like a charm thanks. I&#39;m also impressed with the CLI wizardry. Is it correct to say that I can use <code>hasUpdate</code> as long as I want to append ByteStrings (I meant Digests), but in case I need to do different type of manipulations (eg truncate, etc...) then I would need to convert each hash results back to an intermediary ByteString equivalent?"}, {"owner": {"reputation": 1874, "user_id": 4607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6bbf7ed20f7a436af3468750f97d680d?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/4607/ben"}, "reply_to_user": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1474210558, "post_id": 39556727, "comment_id": 66428539, "body": "You can use <code>hashUpdate</code> to effectively append all kinds of byte-like things. Otherwise check out the <a href=\"https://hackage.haskell.org/package/memory/docs/Data-ByteArray.html#t:ByteArrayAccess\" rel=\"nofollow noreferrer\"><code>ByteArrayAccess</code></a> class that <code>Digest</code>s have an instance for, they support all kinds of bytestring-like operations, and, failing that, offer a generic <code>convert</code> function that should get you a strict <code>ByteString</code>."}], "tags": [], "owner": {"reputation": 1874, "user_id": 4607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6bbf7ed20f7a436af3468750f97d680d?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/4607/ben"}, "is_accepted": true, "score": 3, "last_activity_date": 1474210735, "last_edit_date": 1474210735, "creation_date": 1474195097, "answer_id": 39556727, "question_id": 39556394, "link": "https://stackoverflow.com/questions/39556394/hash-of-hash-functions-in-cryptonite-package/39556727#39556727", "title": "Hash of hash functions in cryptonite package", "body": "<p>The hash functions there in general require a <code>ByteArrayAccess</code> instance for their input. Only <code>hashlazy</code> in particular requires a lazy <code>ByteString</code> specifically.</p>\n\n<p><code>hash (hashlazy x)</code> should work because <code>Digest</code> has an instance of <code>ByteArrayAccess</code>. To hash multiple <code>Digest</code>s together, you can use the underlying <code>hashInit</code>/<code>hashUpdates</code>/<code>hashFinalize</code> functions, passing your all <code>Digest</code>s to <code>hashUpdates</code>.</p>\n\n<p>Quick example:</p>\n\n<pre><code>import System.IO\nimport Crypto.Hash\nimport Crypto.Hash.Algorithms\nimport Data.ByteString.UTF8 as B\n\nmain = do\n  putStr \"Enter something to hash: \" &gt;&gt; hFlush stdout\n  line1 &lt;- fmap B.fromString getLine\n  let hash1 = hash line1 :: Digest SHA512\n  putStrLn $ \"First hash is \" ++ show hash1\n  putStr \"Enter something else to hash: \" &gt;&gt; hFlush stdout\n  line2 &lt;- fmap B.fromString getLine\n  let\n    ctx1 :: Context SHA512\n    ctx1 = hashInit\n    ctx2 = hashUpdate ctx1 hash1\n    ctx3 = hashUpdate ctx2 line2\n    hash2 = hashFinalize ctx3\n  putStrLn $ \"Second hash is \" ++ show hash2\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>Enter something to hash: foo\nFirst hash is f7fbba6e0636f890e56fbbf3283e524c6fa3204ae298382d624741d0dc6638326e282c41be5e4254d8820772c5518a2c5a8c0c7f7eda19594a7eb539453e1ed7\nEnter something else to hash: bar\nSecond hash is b612043d657248615f4c184407f4e5bfc0e6334f86056dfb641cf35ce1e33d86e5349d8e82b3b5018adb07e6b6d653d288e9ed883af624e7f34f12117a620c00\n</code></pre>\n\n<p>Verify:</p>\n\n<pre><code> $ (echo -n foo | sha512sum | head -c 128 | xxd -p -r ; echo -n bar) | sha512sum\n b612043d657248615f4c184407f4e5bfc0e6334f86056dfb641cf35ce1e33d86e5349d8e82b3b5018adb07e6b6d653d288e9ed883af624e7f34f12117a620c00  -\n</code></pre>\n\n<p>Edit 2: Note that if you actually do need to manipulate the digest you get as an array of bytes, you can use the operations on the <a href=\"https://hackage.haskell.org/package/memory/docs/Data-ByteArray.html#t:ByteArrayAccess\" rel=\"nofollow\"><code>BytesArrayAccess</code></a> class, or convert to regular old strict <code>ByteString</code>s from there.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 1, "accepted_answer_id": 39556727, "answer_count": 1, "score": 1, "last_activity_date": 1474267406, "creation_date": 1474192820, "last_edit_date": 1474267406, "question_id": 39556394, "link": "https://stackoverflow.com/questions/39556394/hash-of-hash-functions-in-cryptonite-package", "title": "Hash of hash functions in cryptonite package", "body": "<p>I am trying to use the <a href=\"https://hackage.haskell.org/package/cryptonite-0.20/docs/Crypto-Hash.html\" rel=\"nofollow\">Crypto.Hash module</a> (cryptonite package) and produce \"hash of hash\" results. </p>\n\n<p>The issue is that the signature of the module's hash function is <code>hashlazy :: HashAlgorithm a =&gt; ByteString -&gt; Digest a</code>, so before I can produce a <code>hashlazy (hashlazy x)</code>, I'll need to translate a Digest into a ByteString. </p>\n\n<p>Although there is a digestFromByteString function provided, there is no such function for the reverse (maybe it doesn't make sense for all Digests?). </p>\n\n<p>So the only way I found is to do this :</p>\n\n<pre><code>-- produce a hexadecimal string representation of the digest\nmyHash :: ByteString -&gt; String\nmyHash b = show (hashlazy bs :: Digest SHA256)\n\n-- convert a hexadecimal string into a ByteString\nfromHexString :: String -&gt; ByteString\nfromHexString = undefined \n</code></pre>\n\n<p>and then I can now do <code>hashhash x = myHash $ fromHexString $ myHash x</code>...</p>\n\n<p>But that looks very cumbersome. </p>\n\n<p>My question: Am I using the library functions properly? Did I miss a conversion function somewhere? Or should I do things differently?</p>\n\n<p>=== EDIT 1 ===</p>\n\n<p>I wanted to keep my question simple and avoided other details which I thought weren't important, but I do need to convert the hash result back into a ByteString, as I need to do manipulate it before hashing again. Eg, </p>\n\n<pre><code>-- myByteString is a constant\n-- firstByteString is original input\nfinalResult = hash $ append myByteString (hash firstByteString)\n</code></pre>\n\n<p>=== EDIT 2 ===</p>\n\n<p>I accepted ben's answer, and learned from it, but for future reference, one way to convert Crypto.Hash's <code>Digest a</code> into a <code>ByteString</code> is via the <a href=\"https://hackage.haskell.org/package/memory-0.13\" rel=\"nofollow\">memory package's</a> Data.ByteArray module and the <a href=\"https://hackage.haskell.org/package/memory-0.13/docs/Data-ByteArray.html#v:pack\" rel=\"nofollow\">pack function</a> :</p>\n\n<pre><code>module Main where\n\nimport Data.ByteString\nimport Data.ByteString as BS (pack)\nimport Data.ByteArray (ByteArrayAccess)\nimport qualified Data.ByteArray as BA (unpack)\nimport Crypto.Hash (Digest, hash)\nimport Crypto.Hash.Algorithms (SHA256(..))\n\nsomehash = hash (\"foo\" :: ByteString) :: Digest SHA256\n\ntoByteString :: ByteArrayAccess a =&gt; a -&gt; ByteString\ntoByteString = BS.pack . BA.unpack\n\nsomebytestring = toByteString somehash\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": false, "score": 2, "last_activity_date": 1474193439, "last_edit_date": 1474193439, "creation_date": 1474193071, "answer_id": 39556431, "question_id": 39556393, "link": "https://stackoverflow.com/questions/39556393/basic-haskell-function-types/39556431#39556431", "title": "Basic Haskell function types?", "body": "<blockquote>\n  <p>Both parameters are type 'a' (Ints) and the return parameter is type 'b' (String)?</p>\n</blockquote>\n\n<p>In a Haskell type signature, when you write names that begin with a lowercase letter such as <code>a</code>, the compiler implicitly adds <code>forall a.</code> to the beginning of the type.  So, this is what the compiler actually sees:</p>\n\n<pre><code>randomfunc :: forall a b. a -&gt; a -&gt; b\n</code></pre>\n\n<p>The type signature claims that your function will work for whatever (\"for all\") types <code>a</code> and <code>b</code> the caller throws at you.  But this is not true for your function, since it only works on <code>Int</code> and <code>String</code> respectively.</p>\n\n<p>You need to make your type more specific:</p>\n\n<pre><code>randomfunc :: Int -&gt; Int -&gt; String\n</code></pre>\n\n<p>On the other hand, perhaps you intended to ask the compiler to fill out <code>a</code> and <code>b</code> for you automatically, rather than to claim that it will work for all <code>a</code> and <code>b</code>.  In that case, what you are really looking for is the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/PartialTypeSignatures#named-wildcards\" rel=\"nofollow\">PartialTypeSignatures</a> feature:</p>\n\n<pre><code>{-# LANGUAGE PartialTypeSignatures #-}\n\nrandomfunc :: _a -&gt; _a -&gt; _b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 7, "last_activity_date": 1474249186, "last_edit_date": 1474249186, "creation_date": 1474193275, "answer_id": 39556460, "question_id": 39556393, "link": "https://stackoverflow.com/questions/39556393/basic-haskell-function-types/39556460#39556460", "title": "Basic Haskell function types?", "body": "<p>Not quite. Your function signature indicates: <strong><em>for all</em></strong> types <code>a</code> and <code>b</code>, randomfunc will return something of type <code>b</code> if given two things of type <code>a</code>.</p>\n\n<p>However,  <code>randomFunc</code> returns a <code>String</code> (<code>[Char]</code>). And since you compare <code>e1</code> with <code>2</code> each other, you cannot use <strong>all</strong> <code>a</code>'s, only those that can be used with <code>&gt;</code>:</p>\n\n<pre><code>(&gt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>Note that <code>e1 &gt; 2</code> also needs a way to create such an an <code>a</code> from <code>2</code>:</p>\n\n<pre><code>(&gt; 2) :: (Num a, Ord a) =&gt; a -&gt; Bool\n</code></pre>\n\n<p>So either use a specific type, or make sure that you handle all those constraints correctly:</p>\n\n<pre><code>randomfunc :: Int -&gt; Int -&gt; String\n\nrandomFunc :: (Ord a, Num a) =&gt; a -&gt; a -&gt; String\n</code></pre>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 39556460, "answer_count": 2, "score": 1, "last_activity_date": 1474249186, "creation_date": 1474192811, "question_id": 39556393, "link": "https://stackoverflow.com/questions/39556393/basic-haskell-function-types", "title": "Basic Haskell function types?", "body": "<p>Super basic question - but I can't seem to get a clear answer. The below function won't compile:</p>\n\n<pre><code>randomfunc :: a -&gt; a -&gt; b\nrandomfunc e1 e2\n   | e1 &gt; 2 &amp;&amp; e2 &gt; 2       = \"Both greater\"\n   | otherwise              = \"Not both greater\"\n\nmain = do\n   let x = randomfunc 2 1\n   putStrLn $ show x\n</code></pre>\n\n<p>I'm confused as to why this won't work. Both parameters are type 'a' (Ints) and the return parameter is type 'b' (String)? </p>\n\n<p>Error: </p>\n\n<pre><code>\"Couldn't match expected type \u2018b\u2019 with actual type \u2018[Char]\u2019\"\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "edited": false, "score": 0, "creation_date": 1474193206, "post_id": 39556415, "comment_id": 66423791, "body": "what exactly is it that is being added to the list?"}, {"owner": {"reputation": 2191, "user_id": 2542516, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eNgJg.png?s=128&g=1", "display_name": "Priyatham", "link": "https://stackoverflow.com/users/2542516/priyatham"}, "reply_to_user": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "edited": false, "score": 0, "creation_date": 1474193349, "post_id": 39556415, "comment_id": 66423824, "body": "I think you are asking what <code>ys</code> means. It&#39;s a list of 3 functions, the first function is just <code>f x = x+1</code>, the second one is <code>f x = x+2</code> ..."}, {"owner": {"reputation": 598, "user_id": 2780081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgKtG.jpg?s=128&g=1", "display_name": "c-garcia", "link": "https://stackoverflow.com/users/2780081/c-garcia"}, "edited": false, "score": 0, "creation_date": 1474278124, "post_id": 39556415, "comment_id": 66449746, "body": "As Priyatham states, nothing is added to the list. Each member of the list is applied a function (so a function is called with it being the first argument) and the results are returned in another list.  Enter currying: <code>+</code> is a single argument function (all in Haskell are), that returns another single-argument function."}], "tags": [], "owner": {"reputation": 2191, "user_id": 2542516, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eNgJg.png?s=128&g=1", "display_name": "Priyatham", "link": "https://stackoverflow.com/users/2542516/priyatham"}, "is_accepted": false, "score": 2, "last_activity_date": 1474192956, "creation_date": 1474192956, "answer_id": 39556415, "question_id": 39556309, "link": "https://stackoverflow.com/questions/39556309/haskell-code-explanation/39556415#39556415", "title": "Haskell code explanation", "body": "<p>I don't have ghci at the moment, apologies if something I say is wrong.</p>\n\n<p><code>xs</code> is type <code>[Float]</code> and <code>ys</code> is of type <code>[Float -&gt; Float]</code>(it's a list of functions that each take a <code>Float</code> and return a <code>Float</code>). <code>ys</code> will be <code>[(+) 1, (+) 2, (+) 3]</code> because <code>map</code> applies <code>(+)</code> to each elements in <code>xs</code>. But you cannot print <code>ys</code> because functions do not derive <code>Show</code></p>\n"}, {"tags": [], "owner": {"reputation": 598, "user_id": 2780081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lgKtG.jpg?s=128&g=1", "display_name": "c-garcia", "link": "https://stackoverflow.com/users/2780081/c-garcia"}, "is_accepted": false, "score": 1, "last_activity_date": 1474192966, "creation_date": 1474192966, "answer_id": 39556417, "question_id": 39556309, "link": "https://stackoverflow.com/questions/39556309/haskell-code-explanation/39556417#39556417", "title": "Haskell code explanation", "body": "<p>ys type is <code>[Float -&gt; Float]</code>, a list of functions that receive a number return the number +1 (first elem), the number + 2 (the second) and the number +3 (the last).</p>\n\n<p>Please, bear in mind that <code>+</code> is a is applied with a single argument for each list element so it does return another function.</p>\n\n<p>If you wanted to add all the items in the List, you should use a reduce function, such as <code>foldl</code>.</p>\n\n<p><code>let zs = foldl (+) 0 xs</code></p>\n\n<p>I hope this helps.</p>\n\n<p>Crist\u00f3bal</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1474193773, "creation_date": 1474193773, "answer_id": 39556527, "question_id": 39556309, "link": "https://stackoverflow.com/questions/39556309/haskell-code-explanation/39556527#39556527", "title": "Haskell code explanation", "body": "<blockquote>\n  <p>For the first question I know that <code>xs</code> is of type <code>float</code></p>\n</blockquote>\n\n<p>er, no. <code>xs</code> has type <code>[Float]</code>: a <em>list</em> of floats.</p>\n\n<blockquote>\n  <p>and so should <code>ys</code></p>\n</blockquote>\n\n<p><code>ys</code> does <strong>not</strong> have the same type as <code>xs</code>. You probably think so because you've read that <code>+</code> requires the arguments and result to have the same type:</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>...or if you instantiate it to <code>Float</code> numbers</p>\n\n<pre><code>(+) :: Float -&gt; Float -&gt; Float\n</code></pre>\n\n<p>This is correct, nevertheless <code>(+)</code> is not an <a href=\"https://en.wikipedia.org/wiki/Endomorphism\" rel=\"nofollow\">endomorphism</a> (a function mapping a type to itself, as it would have to be if <code>ys</code> was the same type as <code>xs</code>) because it has <em>two</em> number arguments.</p>\n\n<p>With <code>map (+)</code> you're considering <code>(+)</code> as a function of <em>a single argument</em>, not of two arguments. In most programming languages this would actually be an error, but not so in Haskell: in Haskell, <em>all</em> functions actually have only one argument. Functions with \u201cmultiple arguments\u201d are really just <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow\">functions on interesting types, that make it seem as if you're passing multiple arguments</a>. In particular, the signature of <code>(+)</code> is actually shorthand for:</p>\n\n<pre><code>(+) :: Float -&gt; (Float -&gt; Float)\n</code></pre>\n\n<p>So, considered as a one-argument function, <code>(+)</code> actually maps numbers to number-endomorphisms. Hence,</p>\n\n<pre><code>map (+) :: [Float] -&gt; [Float -&gt; Float]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>ys :: [Float -&gt; Float]\n</code></pre>\n\n<p>\u2013 a list of number-functions. Specifically, it's this list:</p>\n\n<pre><code>ys = [(+) 1    , (+) 2    , (+) 3    ]\n   \u2261 [(1+)     , (2+)     , (3+)     ]\n   \u2261 [\\n -&gt; 1+n, \\n -&gt; 2+n, \\n -&gt; 3+n]\n</code></pre>\n\n<p>I could, for example, use it like this:</p>\n\n<pre><code>GHCi&gt; let [f,g,h] = ys in [f 3, g 2, h 1]\n[4,4,4]\nGHCi&gt; map ($ 10) ys -- applies all functions separately to the number 10\n[11,12,13]\nGHCi&gt; foldr ($) 0 ys -- applies all the functions one after another to 0\n6\n</code></pre>\n\n<p>BTW, IMO you're asking the question the wrong way around. In Haskell, you don't want to consider some code and wonder what type it has \u2013 that is more an ML or even Lisp approach. I'd always start with the type signature, and work out the implementation \u201coutside to in\u201d (<a href=\"https://wiki.haskell.org/GHC/Typed_holes\" rel=\"nofollow\">typed holes</a> are very handy for this). This possibility is one of the big advantages of functional programming in comparison to procedural languages.</p>\n"}], "owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1474193773, "creation_date": 1474192219, "question_id": 39556309, "link": "https://stackoverflow.com/questions/39556309/haskell-code-explanation", "title": "Haskell code explanation", "body": "<pre><code>xs = [1,2,3]::[Float]\nys = map (+) xs\n</code></pre>\n\n<p>This was a question in an old test and there is no solution sheet. </p>\n\n<p>The questions:</p>\n\n<p>1) What kind of signature does <code>ys</code> have?</p>\n\n<p>2) Explain why and draw how <code>ys</code> looks like</p>\n\n<p>For the first question I know that <code>xs</code> is of type <code>float</code> and so should <code>ys</code>(I run the program in ghci too).\nAs for the second one I have no idea, because when I run the code nothing happens. When I run it and the run <code>ys</code> on a separate row I get an error. </p>\n\n<p>Can someone help me with a hint?</p>\n"}, {"tags": ["haskell", "null"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1474192456, "post_id": 39556260, "comment_id": 66423593, "body": "<code>null</code> is a prelude function, <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:null\" rel=\"nofollow noreferrer\">check it out</a>. There is no such <code>a</code> that <code>[a]==[]</code>: one is an empty list and the other is not. What real problem are you trying to solve?"}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1474192072, "creation_date": 1474192072, "answer_id": 39556289, "question_id": 39556260, "link": "https://stackoverflow.com/questions/39556260/is-there-a-nullvalue-satisfy-nullvalue/39556289#39556289", "title": "Is there a nullValue satisfy [nullValue] == []?", "body": "<p><code>:</code> is the constructor for non-empty lists. Its result can never be an empty list, no matter which operand you apply it to.</p>\n"}, {"tags": [], "owner": {"reputation": 1874, "user_id": 4607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6bbf7ed20f7a436af3468750f97d680d?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/4607/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1474196552, "creation_date": 1474196552, "answer_id": 39556935, "question_id": 39556260, "link": "https://stackoverflow.com/questions/39556260/is-there-a-nullvalue-satisfy-nullvalue/39556935#39556935", "title": "Is there a nullValue satisfy [nullValue] == []?", "body": "<p>If you can squeeze <code>catMaybe</code> from <code>Data.Maybe</code> in there, you can use <code>Just</code>/<code>Nothing</code> in your list.</p>\n\n<pre><code>foo x = catMaybes . (:[]) $ if x == 0\n                               then Nothing\n                               else Just x\n</code></pre>\n"}], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 39556289, "answer_count": 2, "score": 1, "last_activity_date": 1474196552, "creation_date": 1474191858, "last_edit_date": 1474192506, "question_id": 39556260, "link": "https://stackoverflow.com/questions/39556260/is-there-a-nullvalue-satisfy-nullvalue", "title": "Is there a nullValue satisfy [nullValue] == []?", "body": "<p>I have such program:</p>\n\n<pre><code>foo x = if x == 0\n            then []\n            else [x]\n</code></pre>\n\n<p>But I try to make it this way:</p>\n\n<pre><code>foo x = (:[]) $ if x == 0\n                    then nullValue\n                    else x\n</code></pre>\n\n<p>I have trouble figuring out what <code>nullValue</code> is that satisfy <code>[nullValue] == []</code>, could someone help me out of this? (introducing <code>Maybe</code> would make it worse)</p>\n\n<p>I suppose the hurdle is type system/type check?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "edited": false, "score": 0, "creation_date": 1474217345, "post_id": 39553391, "comment_id": 66430933, "body": "I try to run this code in idone.com according to the guidelines you gave me but pulls error saying prog.hs:5:18: parse error on input `=&#39;  main = do     x &lt;- getLine     putStrLn (show (sumaCifras (read x :: Int)))     sumaCifras:: Int -&gt; Int     sumaCifras x = div x 1000 + mod (div x 100) 10 + mod (div x 10) 10 + mod x 10"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "reply_to_user": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "edited": false, "score": 0, "creation_date": 1474229191, "post_id": 39553391, "comment_id": 66434761, "body": "This may be an indentation problem. Could you paste your full code with indentation? In your example you have indented definition of sumaCifras but it shouldn&#39;t be indented. Also you might want to add some brackets in the equation for sumaCifras, because in current form it will not yield results, you might expect."}, {"owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "edited": false, "score": 0, "creation_date": 1512675593, "post_id": 39553391, "comment_id": 82365142, "body": "How do I read two arguments from for example this function g :: Float -&gt; Float -&gt; Float g n t = 2 - (7/(5**n*t))  with this main? main = getLine &gt;&gt;= (putStrLn . show . g . (read :: String -&gt; Float) (read :: String -&gt; Float))"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "reply_to_user": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "edited": false, "score": 0, "creation_date": 1512771753, "post_id": 39553391, "comment_id": 82406679, "body": "You mean you want to read 2 arguments from stdin and then pass them to your function? Best way would be to use arrows if you want to do it point-free, but without this shortest answer seems to be  <code>main = strg &lt;$&gt; getLine &lt;*&gt; getLine &gt;&gt;= print   where strg = flip ((flip (g . read)) . read)</code>"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "reply_to_user": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "edited": false, "score": 0, "creation_date": 1513191714, "post_id": 39553391, "comment_id": 82561799, "body": "You may read arbitrary number of values and apply function to them with applicative style. For example <code>f &lt;$&gt; getVal &lt;*&gt; getVal &lt;*&gt; getVal &lt;*&gt; getVal where getVal = read &lt;$&gt; getLine</code> where you use &lt;$&gt; to apply pure function to a value under a functor and then &lt;*&gt; to apply function under a functor to another value under a functor"}], "tags": [], "owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "is_accepted": true, "score": 4, "last_activity_date": 1474164360, "creation_date": 1474164360, "answer_id": 39553391, "question_id": 39553257, "link": "https://stackoverflow.com/questions/39553257/use-of-putstrln-to-show-result/39553391#39553391", "title": "Use of putStrLn to show result", "body": "<p>Compiler is having a problem, because you use x in main function, which isn't bound in this scope. At first you must read a value from input and then pass it to your function. You can do it in 2 ways. </p>\n\n<p>More natural for people used to imperative languages is \"do\" syntax, in which it will look like that:</p>\n\n<pre><code>    main = do\n        x &lt;- getLine\n        putStrLn (show (sumaCifras (read x :: Int)))\n</code></pre>\n\n<p>When you want to use x as Int, you must use \"read\" function with type signature, so compiler will know what to expect.</p>\n\n<p>To write it in more functional way, you may use monad transformations, to pass it like that</p>\n\n<pre><code>    main = getLine &gt;&gt;= (\\x -&gt; putStrLn(show (sumaCifras (read x :: Int)))\n</code></pre>\n\n<p>The \">>=\" operator will get result value from first monadic action (in here it is IO action of getting input) and apply it to function on the right (in here it is lambda function that reads input as Integer, applies your function and returns it to putStrLn, which prints it on the screen). \"do\" syntax is essentially just a syntactic sugar for this monadic operations, so it will not affect the execution or performance of program.</p>\n\n<p>You can go one step further in writing it functionally by writing it totally point-free </p>\n\n<pre><code>    main = getLine &gt;&gt;= (putStrLn . show . sumaCifras . (read :: String -&gt; Int))\n</code></pre>\n\n<p>Note that here you have type signature for read function, not for application of this function to argument, hence the String -> Int. In here first executed is the getLine function. Input obtained from it is then passed to the read, where it is casted to Int, next is sumaCifras, which then is casted to String by show and printed with putStrLn.</p>\n"}], "owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "accepted_answer_id": 39553391, "answer_count": 1, "score": 0, "last_activity_date": 1474236427, "creation_date": 1474162267, "last_edit_date": 1474236427, "question_id": 39553257, "link": "https://stackoverflow.com/questions/39553257/use-of-putstrln-to-show-result", "title": "Use of putStrLn to show result", "body": "<p>I am using the Idone.com site and wanted to run this code but do not know the syntax putStrLn to compile from stdin Use this code but strip error.</p>\n\n<pre><code>main = putStrLn (show (sumaCifras x))\nsumaCifras:: Int -&gt; Int\nsumaCifras x = div x 1000 + mod (div x 100) 10 + mod (div x 10) 10 + mod x 10\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching", "non-exhaustive-patterns"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6843997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b017660b4102d1a40ab3635965c51e83?s=128&d=identicon&r=PG&f=1", "display_name": "Erakura", "link": "https://stackoverflow.com/users/6843997/erakura"}, "edited": false, "score": 0, "creation_date": 1474156407, "post_id": 39552782, "comment_id": 66417126, "body": "Thank you for the answer - I missed that <code>[b]</code> would imply a one element list. Replacing it with <code>bs</code> indeed fixed the issue. The first pattern was added as a result of troubleshooting the non-exhaustive pattern error."}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "reply_to_user": {"reputation": 35, "user_id": 6843997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b017660b4102d1a40ab3635965c51e83?s=128&d=identicon&r=PG&f=1", "display_name": "Erakura", "link": "https://stackoverflow.com/users/6843997/erakura"}, "edited": false, "score": 0, "creation_date": 1474158065, "post_id": 39552782, "comment_id": 66417389, "body": "Fun fact - it is possible to write that function in point-free style, which looks like this <code>multiples = filter . ((&#47;=) 0 .) . flip mod</code> Sometimes it&#39;s good exercise to look at that and try to understand all the transformations."}], "tags": [], "owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "is_accepted": false, "score": 4, "last_activity_date": 1474156024, "creation_date": 1474156024, "answer_id": 39552782, "question_id": 39552733, "link": "https://stackoverflow.com/questions/39552733/pattern-matches-are-non-exhaustive/39552782#39552782", "title": "Pattern match(es) are non-exhaustive", "body": "<p>Your pattern </p>\n\n<pre><code>    multiples a [b]\n</code></pre>\n\n<p>expects an Integer (bound to name \"a\") and list of Integer containing one element (bound to name \"b\"). Remove square brackets (which will change type of \"b\" to [Integer]) in this pattern and it should be working. Also you can curry this function to form</p>\n\n<pre><code>    multiples a = filter (\\l -&gt; l `mod` a /= 0)\n</code></pre>\n\n<p>and omit first pattern as it should be covered by filter function.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 6843997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b017660b4102d1a40ab3635965c51e83?s=128&d=identicon&r=PG&f=1", "display_name": "Erakura", "link": "https://stackoverflow.com/users/6843997/erakura"}, "edited": false, "score": 0, "creation_date": 1474156300, "post_id": 39552785, "comment_id": 66417105, "body": "Thank you for the help - I missed the <code>=</code> when copying my code over here. Changing both instances of <code>[b]</code> to <code>bs</code> fixed the issue!"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1474156378, "last_edit_date": 1474156378, "creation_date": 1474156040, "answer_id": 39552785, "question_id": 39552733, "link": "https://stackoverflow.com/questions/39552733/pattern-matches-are-non-exhaustive/39552785#39552785", "title": "Pattern match(es) are non-exhaustive", "body": "<p>Welcome to Stack Overflow! There are a couple of things to fix in your function, but I'll start with the one you seem the most confused about: here <code>[b]</code> is a pattern matching a <em>one-element</em> list, naming its single item <code>b</code>. (<code>[b, c]</code> would be a pattern matching a two-element list, etc.) It's not a pattern matching an arbitrarily long list of <code>b</code>s. GHC is telling you off because you haven't accounted for the case where the function has been given a two-or-more-element list.</p>\n\n<p>If you want to match an arbitrary list of <code>b</code>s, omit the square brackets. Additionally, the first line of your function is not necessary because the second line already deals with that case.</p>\n\n<pre><code>multiples :: Integer -&gt; [Integer] -&gt; [Integer]\nmultiples a bs = filter (\\b -&gt; b `mod` a /= 0) bs\n</code></pre>\n\n<p>Or, using a list comprehension,</p>\n\n<pre><code>multiples :: Integer -&gt; [Integer] -&gt; [Integer]\nmultiples a bs = [b | b &lt;- bs, b `mod` a /= 0]\n</code></pre>\n\n<p>Two more things: I'd name this function <code>withoutMultiples</code> because it <em>filters out</em> multiples of <code>a</code>, and because Haskell functions are curried by default you can omit the <code>bs</code> in the <code>filter</code> version.</p>\n\n<pre><code>withoutMultiples :: Integer -&gt; [Integer] -&gt; [Integer]\nwithoutMultiples a = filter (\\b -&gt; b `mod` a /= 0)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6843997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b017660b4102d1a40ab3635965c51e83?s=128&d=identicon&r=PG&f=1", "display_name": "Erakura", "link": "https://stackoverflow.com/users/6843997/erakura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3023, "favorite_count": 0, "accepted_answer_id": 39552785, "answer_count": 2, "score": 3, "last_activity_date": 1549435566, "creation_date": 1474155562, "last_edit_date": 1549435566, "question_id": 39552733, "link": "https://stackoverflow.com/questions/39552733/pattern-matches-are-non-exhaustive", "title": "Pattern match(es) are non-exhaustive", "body": "<p>I'm trying to create a function that eliminates multiples of a given Integer from a list of Integers, in the form <code>multiples x [y]</code>, where x is the given Integer, and y is the list.</p>\n\n<p>Here's what I have:</p>\n\n<pre><code>multiples :: Integer -&gt; [Integer] -&gt; [Integer]\nmultiples a [] = []\nmultiples a [b] = filter (\\l -&gt; l `mod` a /= 0) [b]\n</code></pre>\n\n<p><code>multiples</code> will fail when called, saying \"Non-exhaustive patterns in function multiples\". So I used <code>ghci -Wall</code> with my file to see what patterns were missing, and it returns this:</p>\n\n<pre><code>multiples.hs:2:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for `multiples': Patterns not matched: _ (_:_:_)\n\nmultiples.hs:2:11: warning: [-Wunused-matches]\n    Defined but not used: `a'\n</code></pre>\n\n<p>I get the feeling I'm missing something really simple with line 2, but I'm a bit stuck. What am I doing wrong?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1474147532, "post_id": 39551523, "comment_id": 66415350, "body": "That&#39;s pretty much what lenses are all about."}], "answers": [{"comments": [{"owner": {"reputation": 1723, "user_id": 1178663, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aee59e011d5f1e561052f8516125a286?s=128&d=identicon&r=PG", "display_name": "okdewit", "link": "https://stackoverflow.com/users/1178663/okdewit"}, "edited": false, "score": 0, "creation_date": 1474158893, "post_id": 39552102, "comment_id": 66417541, "body": "Thanks for your comprehensive explanation! After running a <code>cabal install lens</code> and adding <code>{-# LANGUAGE TemplateHaskell #-}</code> to the top of my file it works perfectly. You also answered another question I had: How to transform fields using functions. Turns out <code>(%~)</code> suits my needs!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1474149861, "last_edit_date": 1474149861, "creation_date": 1474149429, "answer_id": 39552102, "question_id": 39551523, "link": "https://stackoverflow.com/questions/39551523/haskell-replacing-fields-in-a-record-based-on-a-variable/39552102#39552102", "title": "Haskell: Replacing fields in a record based on a variable", "body": "<p>Yes, <a href=\"http://hackage.haskell.org/package/lens\">lens</a>es are exactly what you need.</p>\n\n<pre><code>import Control.Lens\nimport Control.Lens.TH\n\ndata Bike = Bike { _frontwheel, _rearwheel :: Wheel }\nderiving (Show)\nmakeLenses ''Bike\n\nreplaceWheel :: Bike -&gt; Lens' Bike Wheel -&gt; Wheel -&gt; Bike\nreplaceWheel bike position wheel = bike &amp; position .~ wheel\n</code></pre>\n\n<p>To be used just like you wanted:</p>\n\n<pre><code>repairedbike = replaceWheel mybike frontwheel 26\n</code></pre>\n\n<p>You can weaken the signature a bit:</p>\n\n<pre><code>replaceWheel :: Bike -&gt; Setter' Bike Wheel -&gt; Wheel -&gt; Bike\n</code></pre>\n\n<p>which is essentially just a fancy way of saying</p>\n\n<pre><code>replaceWheel :: Bike\n             -&gt; ((Wheel-&gt;Identity Wheel) -&gt; (Bike-&gt;Identity Bike))\n             -&gt; Wheel\n             -&gt; Bike\n</code></pre>\n\n<p>Because <code>Identity</code> is just a type-level isomorphism, you might as well omit it, which ends you up with</p>\n\n<pre><code>replaceWheel :: Bike -&gt; ((Wheel-&gt;Wheel) -&gt; Bike-&gt;Bike) -&gt; Wheel -&gt; Bike\nreplaceWheel bike position wheel = bike &amp; position (const wheel)\n                              -- = position (const wheel) bike\n</code></pre>\n\n<p>which can be called thus:</p>\n\n<pre><code>data Bike = Bike { _frontwheel, _rearwheel :: Wheel } -- no lenses\n\nfrontWheel :: (Wheel -&gt; Wheel) -&gt; Bike -&gt; Bike\nfrontWheel f (Bike fw rw) = Bike (f fw) rw\n\nrepairedbike = replaceWheel mybike frontwheel 26\n</code></pre>\n\n<p>So, indeed you don't strictly speaking need any library for this!</p>\n\n<p>The reasons that it's preferrable to use proper lenses rather than such an ad-hoc approximation include:</p>\n\n<ul>\n<li>More general. A <code>Lens'</code> can be use both to set, get (and traverse) values. This can only awkwardly be expressed without the underlying Rank2-polymorphism that <code>lens</code> uses.</li>\n<li>More concise. The types above have a lot of redundancy; lens gives you short synonyms for these accessors.</li>\n<li>Safer. A function <code>(Wheel -&gt; Wheel) -&gt; Bike -&gt; Bike</code> could do all kind of rubbish; <code>lens</code> requires the lens laws which basically guarantee the lens actually works like a record accessor and nothing more.</li>\n<li>Fast. The combinators in the lens library are written with performance in mind (i.e. support inlining for stream fusion, omitted copying in the state monad etc.).</li>\n</ul>\n\n<hr>\n\n<p>BTW, for functions that \u201cmodify something\u201d it's conventional in Haskell to put the argument to be modified last:</p>\n\n<pre><code>replaceWheel :: Setter' Bike Wheel -&gt; Wheel -&gt; Bike -&gt; Bike\nreplaceWheel position wheel = position .~ wheel\n</code></pre>\n\n<p>... or, even shorter,</p>\n\n<pre><code>replaceWheel = (.~)\n</code></pre>\n"}], "owner": {"reputation": 1723, "user_id": 1178663, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aee59e011d5f1e561052f8516125a286?s=128&d=identicon&r=PG", "display_name": "okdewit", "link": "https://stackoverflow.com/users/1178663/okdewit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 39552102, "answer_count": 1, "score": 2, "last_activity_date": 1474149861, "creation_date": 1474144872, "last_edit_date": 1474145383, "question_id": 39551523, "link": "https://stackoverflow.com/questions/39551523/haskell-replacing-fields-in-a-record-based-on-a-variable", "title": "Haskell: Replacing fields in a record based on a variable", "body": "<p>As an example I have a bike, with a front &amp; rear wheel, which both just have an Int to represent the diameter.</p>\n\n<pre><code>type Wheel = Int\ndata Bike = Bike { frontwheel :: Wheel, rearwheel :: Wheel }\n    deriving (Show)\n\nmybike = Bike 24 26\n</code></pre>\n\n<p>Now I want to replace a wheel, because I don't like that they're different sizes:</p>\n\n<pre><code>replaceFrontWheel :: Bike -&gt; Wheel -&gt; Bike\nreplaceFrontWheel bike wheel = bike { frontwheel = wheel }\n\nrepairedbike = replaceFrontWheel mybike 26 \n</code></pre>\n\n<p>That works!</p>\n\n<p>But what if I wanted a function which could either replace the front <em>or</em> rear wheel? Both wheels are of the Wheel (Int) type after all, so why not do it with a single function which takes the field as a parameter as well:</p>\n\n<pre><code>replaceWheel bike position wheel = bike { position = wheel }\n\nrepairedbike = replaceWheel mybike frontwheel 26 \n</code></pre>\n\n<p>I do understand why that doesn't work. <code>position</code> isn't interpreted as having the value <code>frontwheel</code>, but as the (non-existent) field <code>position</code> of <code>Bike</code>.</p>\n\n<p>Is there a Haskell analogue of (JS) <code>mybike[position] = 26</code> or (PHP) <code>$mybike-&gt;$position =  26</code>? </p>\n\n<p>Is it possible in an elegant way without any external modules? </p>\n\n<p>Otherwise, is it possible using lenses?</p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "answers": [{"tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 1, "last_activity_date": 1474198439, "creation_date": 1474198439, "answer_id": 39557203, "question_id": 39551183, "link": "https://stackoverflow.com/questions/39551183/how-to-serve-static-files-from-the-snap-monad/39557203#39557203", "title": "How to serve static files from the Snap monad?", "body": "<p>\"<a href=\"https://hackage.haskell.org/package/snap-core-1.0.0.0/docs/Snap-Util-FileServe.html\" rel=\"nofollow\">Snap.Util.FileServe</a> [c]ontains web handlers to serve files from a directory.\" </p>\n\n<p>The route will look something like this:</p>\n\n<pre><code>(\"/static\", serveDirectory \"static_directory_name\")\n</code></pre>\n\n<p>For fine-tuning this process you can also use your own <code>DirectoryConfig</code> and use <code>serveDirectoryWith</code>.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 39557203, "answer_count": 1, "score": 1, "last_activity_date": 1474198439, "creation_date": 1474142608, "question_id": 39551183, "link": "https://stackoverflow.com/questions/39551183/how-to-serve-static-files-from-the-snap-monad", "title": "How to serve static files from the Snap monad?", "body": "<p>I have this Snap site with one top-level location:</p>\n\n<pre><code>snapSite :: Snap ()\nsnapSite = do\n    ifTop myHomeHandler\n</code></pre>\n\n<p>In addition to this, how can I serve static files <strong>only if</strong> the request path ends with \".css\" or \".txt\"?</p>\n\n<p>I noticed there is a <code>pathWith</code> function in <code>Snap.Internal.Core</code> that could work, but I'm not sure how to fit it into the <code>Snap</code> monad above.</p>\n"}, {"tags": ["haskell", "wxwidgets", "haskell-stack", "nix", "wxhaskell"], "answers": [{"comments": [{"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1496746938, "post_id": 39560271, "comment_id": 75776008, "body": "How come you&#39;re not using shell.nix?"}], "tags": [], "owner": {"reputation": 39, "user_id": 6843657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e787c0f9edd71285a7943d6ba3b31c?s=128&d=identicon&r=PG&f=1", "display_name": "Houyi Ishkander", "link": "https://stackoverflow.com/users/6843657/houyi-ishkander"}, "is_accepted": false, "score": 1, "last_activity_date": 1474217655, "creation_date": 1474217655, "answer_id": 39560271, "question_id": 39551048, "link": "https://stackoverflow.com/questions/39551048/how-to-use-stack-with-nix-to-build-wxhaskell-project/39560271#39560271", "title": "How to use stack with nix to build wxHaskell project?", "body": "<p>Ok, I figured it out. I was adding the wrong \"attribute name\". Here is the correct stack.yaml file</p>\n\n<pre><code># at this point in time nix supports lts-5.0\nresolver: lts-5.0\n\npackages:\n-'.'\n\nextra-deps: \n- wx-0.92.2.0\n- wxc-0.92.2.0\n- wxcore-0.92.2.0\n- wxdirect-0.92.2.0\n\n# wxwidgets-3.0.2 has the attribute name wxGTK30\n# you also need zlib, mesa_noglu and x11\n\nnix:\n  enable: true\n  packages: [zlib, wxGTK30, mesa_noglu, x11]\n</code></pre>\n\n<p>That seems to build everything properly, and I was able to build a minimal window from here (<a href=\"https://github.com/wxHaskell/wxHaskell/blob/master/samples/wx/Minimal.hs\" rel=\"nofollow\">minimal.hs</a>)</p>\n"}], "owner": {"reputation": 39, "user_id": 6843657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e787c0f9edd71285a7943d6ba3b31c?s=128&d=identicon&r=PG&f=1", "display_name": "Houyi Ishkander", "link": "https://stackoverflow.com/users/6843657/houyi-ishkander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1483471720, "creation_date": 1474141708, "last_edit_date": 1483471720, "question_id": 39551048, "link": "https://stackoverflow.com/questions/39551048/how-to-use-stack-with-nix-to-build-wxhaskell-project", "title": "How to use stack with nix to build wxHaskell project?", "body": "<p>I'm trying to set up a build environment for wxHaskell using Nix and Stack. </p>\n\n<p>I've installed wxWidgets-3.0.2 through nix. This is the relevant portion from by .cabal file</p>\n\n<pre><code>executable hellowx-exe\nhs-source-dirs:     app\nmain-is:            Main.hs\nghc-options:        -threaded -rtsopts -with-rtsopts=-N\nbuild-depends:      base\n                  , hellowx\n                  , wx\n                  , wxc\n                  , wxcore\n                  , wxdirect\n</code></pre>\n\n<p>and the stack.yaml file</p>\n\n<pre><code>resolver: lts-5.0\nextra-deps: \n- wx-0.92.2.0\n- wxc-0.92.2.0\n- wxcore-0.92.2.0\n- wxdirect-0.92.2.0\n</code></pre>\n\n<p>I tried adding </p>\n\n<pre><code>nix:\n  enable: true\n  packages: [wxwidgets]\n</code></pre>\n\n<p>but that wasn't the right way apparently.</p>\n\n<p>So I got rid of the nix part in the .yaml file and tried the command <code>$ stack --nix build</code> which resulted in failure. The log file said</p>\n\n<pre><code>[1 of 1] Compiling Main             ( /run/user/1000/stack8847/wxc-0.92.2.0/Setup.hs, /run/user/1000/stack8847/wxc-0.92.2.0/.stack-work/dist/x86_64-linux-nix/Cabal-1.22.5.0/setup/Main.o )\nLinking /run/user/1000/stack8847/wxc-0.92.2.0/.stack-work/dist/x86_64-linux-nix/Cabal-1.22.5.0/setup/setup ...\nError: wx-config not found, please install wx-config before installing wxc\n</code></pre>\n\n<p>However I do have wx-config and wxwidgets installed through nix. The build process can't find it for some reason. What can I do to set up this build environment? Is there a way to direct the build process to look in the directory containing wx-config? I can't figure out why it can't find it. Its in the PATH.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 3, "creation_date": 1474139824, "post_id": 39550756, "comment_id": 66413258, "body": "The keyword is <a href=\"https://wiki.haskell.org/Lazy_evaluation\" rel=\"nofollow noreferrer\">lazy evaluation</a>."}, {"owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1474140224, "post_id": 39550756, "comment_id": 66413388, "body": "ok so from my understanding this is what i think is happening.  head (tail  [1,1] ++ integerList)?"}, {"owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1474141100, "post_id": 39550756, "comment_id": 66413643, "body": "maybe it is like this instead: head (tail [1] ++  ([1] ++ integerList))?"}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1474141647, "post_id": 39550756, "comment_id": 66413794, "body": "Sorry, I don&#39;t understand the question. <code>head (x : _) = x</code> and <code>tail (_ : xs) = xs</code>, so a function equivalent to <code>head (tail x)</code> could be defined as <code>f (x : (y : _)) = y</code>."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474141667, "post_id": 39551032, "comment_id": 66413802, "body": "The key point to notice is that <code>++</code> doesn&#39;t need to evaluate <code>integerList</code> <i>at all</i> in order to return <code>1 : integerList</code>."}, {"owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "edited": false, "score": 1, "creation_date": 1474141939, "post_id": 39551032, "comment_id": 66413879, "body": "Thank you d3dave. It makes perfect sense now! :) appreciate it"}], "tags": [], "owner": {"reputation": 1260, "user_id": 1467419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78cfc322a3cc06cd4d310515286e3c78?s=128&d=identicon&r=PG", "display_name": "d3dave", "link": "https://stackoverflow.com/users/1467419/d3dave"}, "is_accepted": true, "score": 4, "last_activity_date": 1474142017, "last_edit_date": 1474142017, "creation_date": 1474141540, "answer_id": 39551032, "question_id": 39550756, "link": "https://stackoverflow.com/questions/39550756/haskell-function-process/39551032#39551032", "title": "Haskell function process", "body": "<p><code>head</code> returns the first element of a list. In this case it returns the first element of the list <code>tail integerList</code>. <code>tail</code> returns the original list without the first element. The original list is <code>integerList</code> which is bound to <code>[1] ++ integerList</code>. The <code>++</code> operator concatenates two lists, so the resulting list is <code>1 : integerList</code>. Applying <code>tail</code> to this list gives <code>integerList</code>, so <code>tail integerList</code> simply yields <code>integerList</code>.</p>\n\n<p>Back to the beginning: substitute <code>tail integerList</code> with <code>integerList</code> (since that's what it evaluates to) to get <code>head integerList</code>. Reminder: <code>integerList</code> evaluates to <code>1 : integerList</code>. Applying <code>head</code> to that we get <code>1</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "edited": false, "score": 0, "creation_date": 1474141968, "post_id": 39551039, "comment_id": 66413891, "body": "Thank you for the awesome visual guide! :)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1474141623, "creation_date": 1474141623, "answer_id": 39551039, "question_id": 39550756, "link": "https://stackoverflow.com/questions/39550756/haskell-function-process/39551039#39551039", "title": "Haskell function process", "body": "<p>Let\u2019s expand the definitions:</p>\n\n<pre><code>integerList = [1] ++ integerList\nintegerList = foldr (:) integerList [1]  -- inline (++)\nintegerList = 1 : integerList            -- inline foldr\n</code></pre>\n\n<p>Now it should be clear that <code>integerList</code> is a cyclical linked list, representing an infinite stream of ones:</p>\n\n<pre><code>                  __________\n                 /          \\\n                |           |\n                V           |\n              +---+---+---+ |\nintegerList = | : | o | o | |\n              +---+-|-+-|-+ |\n                    |   \\___/\n                    V\n                  +---+\n                  | 1 |\n                  +---+\n</code></pre>\n\n<p>Just as if you had written the following C:</p>\n\n<pre><code>struct Cell { int head; struct Cell *tail; };\n\nstruct Cell *integerList = malloc(sizeof(struct Cell));\nintegerList-&gt;head = 1;\nintegerList-&gt;tail = integerList;\n</code></pre>\n\n<p>The <code>tail</code> of <code>integerList</code> is <code>integerList</code>, and the <code>head</code> is <code>1</code>. You can manipulate infinite streams with many standard prelude functions such as <code>take</code>, <code>dropWhile</code>, <code>foldr</code>, and so on. For example, <code>take 5 integerList</code> produces <code>[1, 1, 1, 1, 1]</code>. You can also define <code>integerList</code> using the <code>repeat</code> function: <code>integerList = repeat 1</code>.</p>\n"}], "owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 39551032, "answer_count": 2, "score": 3, "last_activity_date": 1474142017, "creation_date": 1474139685, "last_edit_date": 1474140575, "question_id": 39550756, "link": "https://stackoverflow.com/questions/39550756/haskell-function-process", "title": "Haskell function process", "body": "<pre><code>integerList = [1] ++ integerList\n\n(head (tail integerList))\n</code></pre>\n\n<p>I have run this code and the result is <code>1</code> and that it is an endless recursion.\nI am trying to figure out how haskell calculates these functions. Can someone write down the process. I would like to visualize it. Thanks!</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1474171375, "post_id": 39549894, "comment_id": 66419206, "body": "Have you run anything before the call to <code>rawRequestBody</code> which may have called <code>runRequestBody</code> or similar? Any kind of POST form processing could do that."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1474300710, "post_id": 39549894, "comment_id": 66464504, "body": "Yes, this is in a handler for POST."}], "answers": [{"tags": [], "owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1490754580, "creation_date": 1490754580, "answer_id": 43083231, "question_id": 39549894, "link": "https://stackoverflow.com/questions/39549894/how-to-see-raw-request-body-in-yesod/43083231#43083231", "title": "how to see raw request body in yesod?", "body": "<p>Try this </p>\n\n<pre><code>import qualified Data.Conduit.Text as CT\nimport qualified Data.Conduit.List as CL\n\nrawRequestBody $$ CT.decode CT.utf8 =$ CL.consume\n</code></pre>\n"}], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1490754580, "creation_date": 1474134136, "question_id": 39549894, "link": "https://stackoverflow.com/questions/39549894/how-to-see-raw-request-body-in-yesod", "title": "how to see raw request body in yesod?", "body": "<p>For debugging, I'd like to see raw request bodies that are being sent\nto my yesod application. </p>\n\n<p>I know how to use <code>runRequestBody</code> <a href=\"https://www.stackage.org/haddock/lts-7.0/yesod-core-1.4.24/Yesod-Core-Handler.html#v:runRequestBody\" rel=\"nofollow\">https://www.stackage.org/haddock/lts-7.0/yesod-core-1.4.24/Yesod-Core-Handler.html#v:runRequestBody</a></p>\n\n<p>Now there is <code>rawRequestBody</code>. I am using</p>\n\n<pre><code>rawRequestBody Data.Conduit.$$ Data.Conduit.List.consume\n</code></pre>\n\n<p>inside <code>defaultLayout</code> but the result is always empty.</p>\n\n<p>The actual representation is a Conduit, so I suspect that it is already drained at this point. Then when do I get to see this in a state where it holds data? Assume this is possible, then how can I read it without removing its contents?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1474131368, "post_id": 39549204, "comment_id": 66410806, "body": "Often the code we write doesn&#39;t work (or compile) on the first try. Useful things to do are: test short pieces of your code in ghci (and ask their type with <code>:t</code>), trace the execution of your function with pen and paper, compile with <code>-Wall</code>. In your case I&#39;d suggest the pen-and-paper approach. Also you probably want <code>toDigits :: Int -&gt; Maybe (Int, Int)</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1474131637, "post_id": 39549204, "comment_id": 66410886, "body": "Your recursion/termination is broken, so think through the algorithm again.  Take the number &#39;1&#39; for example.  <code>mod 1 10 == 1</code> so you will infinitely call <code>toDigits</code> because you will never reach zero."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1474135036, "post_id": 39549204, "comment_id": 66411921, "body": "@jberryman Why not <code>Int -&gt; (Int, Int)</code>? I can&#39;t picture an <code>Int</code> value that I would map to <code>Nothing</code> given this algorithm."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1474134482, "post_id": 39549573, "comment_id": 66411759, "body": "That fixed his function but his request seemed to be asking for <code>f :: Int -&gt; (Int,Int)</code>, perhaps <code>f x = (x `div` 10, x `mod` 10)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1474134911, "post_id": 39549573, "comment_id": 66411880, "body": "Possibly, although that&#39;s a really boring question: <code>f x = divMod x 10</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1474132245, "creation_date": 1474132245, "answer_id": 39549573, "question_id": 39549204, "link": "https://stackoverflow.com/questions/39549204/haskell-about-how-to-separate-the-last-number-from-a-string-number/39549573#39549573", "title": "Haskell about how to separate the last number from a string number", "body": "<p>You just have <code>div</code> and <code>mod</code> swapped.</p>\n\n<pre><code>toDigits n | n &lt;= 0 = []\n           | otherwise = toDigits (n `div` 10) ++ [n `mod` 10]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6803768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cea024da94ffe0fd392c54e95d54b25?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6803768/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1475881287, "creation_date": 1474130272, "last_edit_date": 1475881287, "question_id": 39549204, "link": "https://stackoverflow.com/questions/39549204/haskell-about-how-to-separate-the-last-number-from-a-string-number", "title": "Haskell about how to separate the last number from a string number", "body": "<p>I have a question about haskell in seperation the last number from a string number. For example, input is (1234), output is (123,4) \nI have done a programming, but it does not work. </p>\n\n<pre><code>toDigits :: Int -&gt; [Int]\ntoDigits n\n | n &lt;= 0        = []\n | otherwise     = toDigits(n `mod` 10) ++ [n `div` 10]\n</code></pre>\n"}, {"tags": ["haskell", "printing", "functional-programming", "line"], "answers": [{"comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 1, "creation_date": 1474131483, "post_id": 39548743, "comment_id": 66410835, "body": "You&#39;re missing the plus signs at the start and end - you&#39;d get them if you did the intercalating the other way round, like <code>intercalate (replicate 4 &#39;-&#39;) (replicate 5 &quot;+&quot;)</code>"}, {"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1474140267, "post_id": 39548743, "comment_id": 66413405, "body": "@DavidFletcher That&#39;s a good idea. I fixed the issue differently to stay as close to the OP as possible."}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": false, "score": 0, "last_activity_date": 1474140072, "last_edit_date": 1474140072, "creation_date": 1474127429, "answer_id": 39548743, "question_id": 39548574, "link": "https://stackoverflow.com/questions/39548574/haskell-print-horizontal-line/39548743#39548743", "title": "Haskell print horizontal line", "body": "<p>Some remarks:</p>\n\n<ul>\n<li>In <code>hyphenList = replicate max \"-\"</code>: <code>\"-\"</code> is a string so <code>hyphenList</code> will be a list of strings. It would be simpler if you used <code>'-'</code> instead. This would make <code>hyphenList</code> a string and this would help you get rid one of the <code>concat</code>s.</li>\n<li>I would rename the variable <code>max</code> because there is already a function called <code>max</code> defined in the <code>Prelude</code>.</li>\n<li>You can use the <a href=\"https://hackage.haskell.org/package/base/docs/Data-List.html#v:intercalate\" rel=\"nofollow\">intercalate</a> function from <code>Data.List</code> to simplify the fold and the other concat.</li>\n<li><code>intercalate</code> will not add separators at the beginning and at the end of the generated string, so they have to be added manually.</li>\n</ul>\n\n<p>So putting it all together you get:</p>\n\n<pre><code>printLine :: [Int] -&gt; String\nprintLine widthList = \"+\" ++ intercalate \"+\" boundList ++ \"+\"\n  where boundList = replicate 4 hyphenList\n        hyphenList = replicate m '-'\n        m = maximum widthList\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "is_accepted": true, "score": 3, "last_activity_date": 1474134242, "creation_date": 1474134242, "answer_id": 39549913, "question_id": 39548574, "link": "https://stackoverflow.com/questions/39548574/haskell-print-horizontal-line/39549913#39549913", "title": "Haskell print horizontal line", "body": "<p>Part of the complication might occur because the function is trying to do too much at once. It's very unlikely that you will be reusing exactly this function any time soon. What's more, the number 4 and possibly even the characters '+' and '-' are \"magic numbers\".</p>\n\n<p>Therefore a first step could be to turn the function into a more reusable one</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>-- | renamed from \"printLine\" because \"print\" has a connotation of I/O in Haskell\nseparator :: Int -&gt; String \nseparator = repeatedLine 4\n\nrepeatedLine :: Int -&gt; Int -&gt; String\nrepeatedLine reps segmentWidth = ...\n</code></pre>\n\n<p>Even if you never reuse the function, the number 4 now has a name (<code>reps</code>) that identifies its purpose.</p>\n\n<p>On to the core function. Your fold is both a <code>reverse</code> and a <code>[\"+\"]:</code>. the reversal is necessary because <code>boundList</code> appends the <code>'+'</code> at the beginning. That's a nice optimization, but it makes the combination more complex. However you do it, it seems you have all these details to handle. But there's an alternative perspective: start at infinity. So you already have</p>\n\n<pre><code>  where segment = '+':replicate segmentWidth '-'\n</code></pre>\n\n<p>Now you want to repeat that. The simplest way to do that is with <code>cycle segment</code>, which produces an infinite list of segments. Now all you have to do is take the right prefix - which moves all the complexity into a few bits of math.</p>\n\n<pre><code>repeatedLine :: Int -&gt; Int -&gt; String\nrepeatedLine reps segmentWidth = take (1+reps*(segmentWidth+1)) $ cycle segment\n  where segment = '+':replicate segmentWidth '-'\n</code></pre>\n\n<p>Bonus: you now have a minimal number of iterations.</p>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 6844896, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mmQx5QYVBG0/AAAAAAAAAAI/AAAAAAAACPI/XmWi8zLqUQw/photo.jpg?sz=128", "display_name": "rlefevre", "link": "https://stackoverflow.com/users/6844896/rlefevre"}, "is_accepted": false, "score": 1, "last_activity_date": 1474190778, "last_edit_date": 1474190778, "creation_date": 1474189794, "answer_id": 39555935, "question_id": 39548574, "link": "https://stackoverflow.com/questions/39548574/haskell-print-horizontal-line/39555935#39555935", "title": "Haskell print horizontal line", "body": "<p>@David Fletcher's comment leads to a nice solution:</p>\n\n<pre><code>printLine :: [Int] -&gt; String\nprintLine xs = intercalate (replicate (maximum xs) '-') (replicate 5 \"+\")\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 2843415, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58ac1c408c45bc187eed4b57b020034b?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/2843415/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 39549913, "answer_count": 3, "score": 0, "last_activity_date": 1474190778, "creation_date": 1474126343, "question_id": 39548574, "link": "https://stackoverflow.com/questions/39548574/haskell-print-horizontal-line", "title": "Haskell print horizontal line", "body": "<p>I'm writing a function 'printLine' that - given a list of ints - returns a string containing a horizontal line. The length of this line should be the max value of the list of ints. For example:</p>\n\n<pre><code>printLine [1, 3, 4, 0]\n</code></pre>\n\n<p>should return:</p>\n\n<pre><code>+----+----+----+----+\n</code></pre>\n\n<p>(Note that the length is decided by the amount of hyphens, not the '+'-signs. There should always be 5 '+'-signs.)</p>\n\n<p>I've written the following code:</p>\n\n<pre><code>printLine :: [Int] -&gt; String\nprintLine widthList = concat $ concat $ foldr (:) [[\"+\"]] boundList\nwhere boundList = replicate 4 ( \"+\" : hyphenList )\n      hyphenList = replicate max \"-\"\n      max = maximum widthList\n</code></pre>\n\n<p>The code is working correctly, however, I feel like I've over-complicated this function. For example, I've used 'concat' twice in a function. Is there a 'cleaner' way to go about this problem?</p>\n"}, {"tags": ["haskell", "functional-programming", "variadic-functions", "polyvariadic"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474126228, "post_id": 39548280, "comment_id": 66409195, "body": "You mean you don&#39;t want <code>g</code>, <code>f</code> and <code>e</code> to be of the same type?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474126334, "post_id": 39548280, "comment_id": 66409226, "body": "Yes, this should be possible, but you have to use some tricks for the type of the first parameter. Have you tried defining it?"}, {"owner": {"reputation": 473, "user_id": 3895039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e76642ac5323616edb410119b0be9b16?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Vong", "link": "https://stackoverflow.com/users/3895039/alex-vong"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474126378, "post_id": 39548280, "comment_id": 66409241, "body": "@Bergi Yes, in such case, I cannot put them into a list and uses <code>foldr</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474126929, "post_id": 39548280, "comment_id": 66409428, "body": "He defined it for exactly 4 arguments; he&#39;s looking for a version that can take an arbitrary number of arguments."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1474127832, "post_id": 39548280, "comment_id": 66409692, "body": "A better question, really, is why do you think you need a polyvariadic function?"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1474127783, "last_edit_date": 1474127783, "creation_date": 1474126992, "answer_id": 39548679, "question_id": 39548280, "link": "https://stackoverflow.com/questions/39548280/haskell-chain-up-elements-with-an-associative-binary-operation/39548679#39548679", "title": "haskell - chain up elements with an associative binary operation", "body": "<p>You can't (at least, not easily), because you need to know how many arguments you are getting ahead of time. Because all functions in Haskell are automatically curried, every function takes exactly one argument and returns one value. Even a simple binary operator takes one argument (the first operand) and returns a function that takes one argument (the second operand) and returns a result. That is, </p>\n\n<pre><code>a + b == (+) a b\n      == ((+) a) b\n</code></pre>\n\n<p>There is no way for your imaginary function <code>p</code> to know from its first argument how many other arguments are going to be given. That is, what should the type of <code>p</code> be?</p>\n\n<pre><code>p :: (a -&gt; a -&gt; a) -&gt; a                -- zero arguments?\np :: (a -&gt; a -&gt; a) -&gt; a -&gt; a           -- one argument?\np :: (a -&gt; a -&gt; a) -&gt; a -&gt; a -&gt; a      -- two arguments?\np :: (a -&gt; a -&gt; a) -&gt; a -&gt; a -&gt; a -&gt; a -- three arguments?\n</code></pre>\n\n<p>Instead, the best you can do is use a fold, which takes an operation and a <em>list</em> of operands.</p>\n\n<pre><code>foldr (+) 0 [h, g, f, e] == h + g + f + e + 0  -- explicit first argument of 0\nfoldr1 (+) [h, g, f, e] == h + g + f + e -- assumes a list of at least one value\n</code></pre>\n\n<hr>\n\n<p>To see what I mean by \"not easily\", look at the implementation of <code>printf</code> in the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/Text.Printf.html\" rel=\"nofollow\">Text.Printf</a> module. Even that is not a good example, because the first argument carries information (the number of placeholders in the format string) that a binary operation alone does not.</p>\n"}, {"tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 2, "last_activity_date": 1474138536, "last_edit_date": 1495540101, "creation_date": 1474138536, "answer_id": 39550582, "question_id": 39548280, "link": "https://stackoverflow.com/questions/39548280/haskell-chain-up-elements-with-an-associative-binary-operation/39550582#39550582", "title": "haskell - chain up elements with an associative binary operation", "body": "<p>Yes, you can create such a function. It is very ugly however, and you will need to explicitly type every argument you are going to pass to make the compiler find the correct instance.</p>\n\n<p>Starting from <a href=\"https://stackoverflow.com/a/3467806/1048572\">the polyvariadic function template</a> you linked, I arrived at</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, InstanceSigs, MultiParamTypeClasses #-}\n\nclass ImplicitChain m a r where\n  p :: m a -&gt; r\n\ninstance Monad m =&gt; ImplicitChain m a (m a) where\n  p :: m a -&gt; m a\n  p x = x\n\ninstance (Monad m, ImplicitChain m b r) =&gt; ImplicitChain m a ((a -&gt; m b) -&gt; r) where\n  p :: m a -&gt; (a -&gt; m b) -&gt; r\n  p x f = p (x &gt;&gt;= f)\n\n\nh :: Int -&gt; [Int]\nh = replicate 2\ng :: Int -&gt; [Int]\ng = (:[])\nf :: Int -&gt; [Int]\nf = flip enumFromTo 2\n\ntest :: [Int]\ntest = p [1::Int] h g f\n</code></pre>\n\n<p>But you were asking whether we can do more generic, so that the binary operation is an argument as well. Yes:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, InstanceSigs, MultiParamTypeClasses, UndecidableInstances #-}\n\nclass ImplicitVariadic a b r where\n  p :: (a -&gt; b -&gt; a) -&gt; r\n\ninstance ImplicitVariadic a b (a -&gt; a) where\n  p :: (a -&gt; b -&gt; a) -&gt; a -&gt; a\n  p _ x = x\n\ninstance (ImplicitVariadic a b (a -&gt; r)) =&gt; ImplicitVariadic a b (a -&gt; b -&gt; r) where\n  p :: (a -&gt; b -&gt; a) -&gt; a -&gt; b -&gt; r\n  p f x y = p f (f x y)\n</code></pre>\n"}], "owner": {"reputation": 473, "user_id": 3895039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e76642ac5323616edb410119b0be9b16?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Vong", "link": "https://stackoverflow.com/users/3895039/alex-vong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 39550582, "answer_count": 2, "score": 0, "last_activity_date": 1474178098, "creation_date": 1474124557, "last_edit_date": 1474178098, "question_id": 39548280, "link": "https://stackoverflow.com/questions/39548280/haskell-chain-up-elements-with-an-associative-binary-operation", "title": "haskell - chain up elements with an associative binary operation", "body": "<p>I am an intermediate schemer, but only a haskell beginner. Here is my problem: </p>\n\n<p>Suppose you have an associative binary operation, says <code>(&gt;&gt;=)</code>. Is there a polyvariadic function <code>p</code> such that <code>p (&gt;&gt;=) h g f e = h &gt;&gt;= g &gt;&gt;= f &gt;&gt;= e</code>?</p>\n\n<p>I am asking this question because <a href=\"https://stackoverflow.com/questions/3467279/how-to-create-a-polyvariadic-haskell-function\">this question</a> says it is possible if the binary operation takes inputs of the same type. I wonder if this can be generalized.</p>\n\n<p>EDIT-1: I try to modify the code in <a href=\"http://okmij.org/ftp/Haskell/vararg-fn.lhs\" rel=\"nofollow\">http://okmij.org/ftp/Haskell/vararg-fn.lhs</a> (the section of Variable number of variably typed arguments) with little progress.</p>\n\n<p>EDIT-2: Simplify the code a bit.</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies, FlexibleInstances #-}\n\n\nmodule Main where\n\n\nclass Lfold f a b | b -&gt; a where \n  lfold :: (a -&gt; (f a) -&gt; (f a)) -&gt; (f a) -&gt; a -&gt; b\n\ninstance Lfold f a (f a) where\n  lfold op rid x = op x rid\n\ninstance Lfold f a b =&gt; Lfold f a (a -&gt; b) where\n  lfold op rid x y = lfold op (op x rid) y\n\n\ntest :: [String]\ntest = lfold (:) [] \"a\" \"b\" \"c\"\n\nmain :: IO ()\nmain = putStrLn $ show test\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": true, "score": 3, "last_activity_date": 1474123728, "creation_date": 1474123728, "answer_id": 39548130, "question_id": 39547881, "link": "https://stackoverflow.com/questions/39547881/improve-overly-complex-haskell-list-mapping/39548130#39548130", "title": "Improve overly complex haskell list mapping?", "body": "<p>I am not sure I understood your problem correctly, but I think what you ask for is to have a function that can check whether all elements of <code>list2</code> are between <code>avg - r</code> and <code>avg + r</code> where <code>avg</code> is the average of <code>list1</code> and <code>r</code> is some number.</p>\n\n<p>If that is correct, here's what I would change in your code:</p>\n\n<ol>\n<li>I would move <code>checkList</code> inside <code>mainFunc</code>. This allows you to reference symbols defined in the <code>where</code> clause directly which can make the code more readable in this case.</li>\n<li>I would make <code>checkList</code> return a boolean instead of an integer as you were using the integer as if it was a boolean anyway. This would also allow you to greatly simplify the definition of the function, which can now be defined using a single boolean expression (no need for multiple cases).</li>\n<li>I would rename <code>checkList</code> to something more descriptive, e.g. <code>checkInRange</code>.</li>\n<li>Finally, I would use the function [all] from Prelude (<a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:all\" rel=\"nofollow\">http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:all</a>) that can check if all elements of a list satisfy a property.</li>\n</ol>\n\n<p>Putting it all together:</p>\n\n<pre><code>mainFunc :: [Int] -&gt; [Int] -&gt; Bool\nmainFunc list1 list2 = all checkInRange list2\n  where\n    checkInRange element = ave - r &lt;= element &amp;&amp; element &lt;= ave + r\n    ave = sum list1 `div` length list1 --Calculate average\n    r = 30 --Create range value \n</code></pre>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 39548130, "answer_count": 1, "score": 2, "last_activity_date": 1474123728, "creation_date": 1474122219, "question_id": 39547881, "link": "https://stackoverflow.com/questions/39547881/improve-overly-complex-haskell-list-mapping", "title": "Improve overly complex haskell list mapping?", "body": "<p>I have two functions that perform the following:</p>\n\n<p>Take two lists of Ints (list1, list2). </p>\n\n<p>Take the average of the first list, and make a range value (r).</p>\n\n<p>Map over list2 to check if each element is within the range, return 0 if outside range.</p>\n\n<p>Convert any list2 elements that are returned as 0 into False and other values to True.</p>\n\n<p>Check is list2 contains any False values.</p>\n\n<p>Code: </p>\n\n<pre><code>checkList :: Int -&gt; Int -&gt; Int -&gt; Int --Check if element is within range\ncheckList element ave r\n   | element &gt;= (ave + (ave + r)) = 0\n   | element &lt;= (ave - (ave + r)) = 0\n   | otherwise = e\n\nmainFunc :: [Int] -&gt; [Int] -&gt; (Int -&gt; Int -&gt; Int -&gt; Int) -&gt; Bool\nmainFunc list1 list2 checkL = elem (False) resultIntToBool --Check for any False elements\n   where\n      resultIntToBool = map (\\element -&gt; if element == 0 then False else True) result --Convert elements to bools\n      result = map (\\element -&gt; checkL element ave r) list2 --Pass each element to checkL\n      ave = sum list1 `div` length list1 --Calculate average\n      r = ave + 30 --Create range value \n</code></pre>\n\n<p>How can I make this code less verbose and more readable? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1474111992, "post_id": 39546328, "comment_id": 66405048, "body": "What is the purpose of <code>MyComp.comp</code>? What does it mean when <code>comp aaa bbb</code> is <code>True</code>? What does it mean when <code>comp aaa bbb</code> is <code>False</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1474112380, "post_id": 39546328, "comment_id": 66405142, "body": "What do you mean by &quot;ethnographically&quot;?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1474112734, "post_id": 39546328, "comment_id": 66405247, "body": "Counterexample: <code>comp &quot;ab&quot; &quot;ba&quot;</code>"}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1474112897, "post_id": 39546328, "comment_id": 66405305, "body": "OP means &quot;lexicographically&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474120575, "post_id": 39546328, "comment_id": 66407512, "body": "<code>MyComp</code> is basically just a reimplementation of <code>Ord</code>."}], "answers": [{"tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": false, "score": 1, "last_activity_date": 1474112637, "creation_date": 1474112637, "answer_id": 39546439, "question_id": 39546328, "link": "https://stackoverflow.com/questions/39546328/haskell-guard-expression-explanation/39546439#39546439", "title": "Haskell guard expression explanation", "body": "<p>It appears from the definition of <code>MyComp</code> that the intention is that <code>comp x y</code> is equivalent to <code>x &lt;= y</code>. Now, the definition <code>instance MyComp a =&gt; MyComp [a]</code> means that if the less-than-or-equal-to relation is defined for values of type <code>a</code>, then it is also defined for values of type <code>[a]</code>, presumably using the <a href=\"https://en.wikipedia.org/wiki/Lexicographical_order\" rel=\"nofollow\">lexicographical order</a>.</p>\n\n<p>The way the lexicographical order works is that if you are comparing two lists, you first compare the first element of the first list with the first element of the second list. If they differ, then you use the result of that comparison as the result of the comparison of the two lists. If on the other hand they are equal, then you look at the second element from both lists and so on. That's what the above code is trying to do: <code>comp x y &amp;&amp; comp y x</code> is like saying that <code>x &lt;= y &amp;&amp; y &lt;= x</code>, which is equivalent to saying that <code>x</code> is equal to <code>y</code>. If the happens. then according to the lexicographical order, you have to discard those two elements and look at the remainder of the two lists.</p>\n"}, {"tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": true, "score": 2, "last_activity_date": 1474112788, "creation_date": 1474112788, "answer_id": 39546459, "question_id": 39546328, "link": "https://stackoverflow.com/questions/39546328/haskell-guard-expression-explanation/39546459#39546459", "title": "Haskell guard expression explanation", "body": "<p><code>comp</code> is basically an extended less-than-or-equals function.</p>\n\n<p>The code you have a question about is about extending a definition of less-than-or-equal from type <code>a</code> to type <code>[a]</code>. It does this with the traditional definition of lexicographic ordering.</p>\n\n<p>Now, as there is no formal relationship between <code>MyComp</code> and <code>Eq</code> you can't really ask <code>x == y</code> - instead, the only way to ask if <code>x</code> and <code>y</code> are equal according to <code>comp</code> is to do the double test you ask about there.</p>\n\n<p>That double test is to handle this case:</p>\n\n<pre><code>\"abcd\" `comp` \"aacd\"\n</code></pre>\n\n<p>Now, this should be false because <code>\"aacd\"</code> should sort before <code>\"abcd\"</code>. But to do that you need to check beyond the first letter. That's what the code you're asking about is doing - it's checking the second (and subsequent) letters in the case where the initial letters are equal.</p>\n\n<p>But you don't always check the subsequent letters! What about the case:</p>\n\n<pre><code>comp \"abcd\" \"baaa\"\n</code></pre>\n\n<p>Obviously, this should be true even though <code>comp 'a' 'b'</code> is true and <code>comp \"bcd\" \"aaa\"</code> is false.</p>\n"}], "owner": {"reputation": 273, "user_id": 4748776, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0b92126fb77d1017fdcfe19fe2ef4054?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleOseven", "link": "https://stackoverflow.com/users/4748776/doubleoseven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 39546459, "answer_count": 2, "score": 0, "last_activity_date": 1474113050, "creation_date": 1474111828, "last_edit_date": 1474113050, "question_id": 39546328, "link": "https://stackoverflow.com/questions/39546328/haskell-guard-expression-explanation", "title": "Haskell guard expression explanation", "body": "<pre><code>comp shows if two words are lexicographically equal or smaller \n\nimport Data.Char\nclass MyComp a where\n   comp :: a -&gt; a -&gt; Bool\ninstance MyComp Char where\n   comp num1 num2 = (ord num1) &lt;= (ord num2)       -- ord :: Char -&gt; Int\n\n\ninstance MyComp a =&gt; MyComp [a] where\n   comp [] _ = True\n   comp _ [] = False\n   comp (x:xs) (y:ys)\n    | comp x y &amp;&amp; comp y x = comp xs ys\n    | comp x y = True\n    | otherwise = False\n</code></pre>\n\n<p>The code above is  little cryptic to me. Can someone explain to me what is going on in the guards? Why are they checking to see if both <code>comp x y</code> and <code>comp y x</code> are true. Shouldn't just </p>\n\n<pre><code>| comp x y = comp xs ys\n| otherwise = False\n</code></pre>\n\n<p>do the trick?</p>\n"}, {"tags": ["haskell", "yesod"], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474111482, "creation_date": 1474111482, "question_id": 39546273, "link": "https://stackoverflow.com/questions/39546273/how-to-debug-msgvaluerequired-in-yesod", "title": "how to debug MsgValueRequired in yesod?", "body": "<p>I have a yesod application that shows <code>MsgValueRequired</code> (english rendering: \"Invalid Arguments: Value is required\") sometimes, and I want to find out why.</p>\n\n<p>Yesod uses this message, e.g., for hidden input fields: <a href=\"https://github.com/yesodweb/yesod/blob/1b5477bc786649cd909b87d5e5230c2ba4015395/yesod-form/Yesod/Form/Fields.hs#L250\" rel=\"nofollow\">https://github.com/yesodweb/yesod/blob/1b5477bc786649cd909b87d5e5230c2ba4015395/yesod-form/Yesod/Form/Fields.hs#L250</a> , and for <code>mreq</code> <a href=\"https://github.com/yesodweb/yesod/blob/e7c6d06d3dca7710b6bad2caa074162170b82a78/yesod-form/Yesod/Form/Functions.hs#L117\" rel=\"nofollow\">https://github.com/yesodweb/yesod/blob/e7c6d06d3dca7710b6bad2caa074162170b82a78/yesod-form/Yesod/Form/Functions.hs#L117</a></p>\n\n<p>But it gives no information on which field is responsible (and my page has lots).</p>\n\n<p>Is there a way to attach some more information (automatically)?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1474111350, "post_id": 39545711, "comment_id": 66404859, "body": "Can you explain, from your first example, what &#39;(\\el -&gt; fOne el ave)&#39; is doing? then i can accept"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 2, "creation_date": 1474112128, "post_id": 39545711, "comment_id": 66405072, "body": "@barbrac That&#39;s the syntax for a function. It&#39;s <code>\\PARAMETER -&gt; BODY</code>, i.e. in this case it&#39;s a function taking a value (<code>el</code>) and returning <code>fOne el ave</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1474130396, "post_id": 39545711, "comment_id": 66410474, "body": "Why flip? Addition is commutative, so just <code>map (fOne ave) list</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1474135044, "post_id": 39545711, "comment_id": 66411922, "body": "@amalloy Addition is, but I think the OP wanted the general case, since she specified &quot;with ave as x&quot;."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1474113391, "last_edit_date": 1474113391, "creation_date": 1474107890, "answer_id": 39545711, "question_id": 39545669, "link": "https://stackoverflow.com/questions/39545669/haskell-passing-argument-to-map-function/39545711#39545711", "title": "Haskell - Passing argument to map function?", "body": "<p>You probably want this:</p>\n\n<pre><code>functionTwo :: [Int] -&gt; (Int -&gt; Int -&gt; Int) -&gt; [Int]\nfunctionTwo list fOne = map (\\el -&gt; fOne el ave) list\n   where \n     ave = sum list `div` length list\n</code></pre>\n\n<p>Above, we use the anonymous function <code>(\\el -&gt; fOne el ave)</code>, which is the function mapping each <code>el</code> to <code>fOne el ave</code>. In this way, we fix the second argument of <code>fOne</code> to the wanted value.</p>\n\n<p>Alternatively,</p>\n\n<pre><code>functionTwo :: [Int] -&gt; (Int -&gt; Int -&gt; Int) -&gt; [Int]\nfunctionTwo list fOne = map (flip fOne ave) list\n   where \n     ave = sum list `div` length list\n</code></pre>\n\n<p>Note <code>div</code> for integer division, <code>/</code> only works on floating point numbers.</p>\n\n<p><code>flip f</code> is the same function as <code>f</code>, but with the first two arguments in the other order.</p>\n\n<p>Also possible: <code>map (`fOne` ave) list</code>.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 39545711, "answer_count": 1, "score": 0, "last_activity_date": 1474113391, "creation_date": 1474107680, "last_edit_date": 1474110437, "question_id": 39545669, "link": "https://stackoverflow.com/questions/39545669/haskell-passing-argument-to-map-function", "title": "Haskell - Passing argument to map function?", "body": "<p>Basic question... I wish to map over a list and apply a function to each element, however I want to execute this from another function:</p>\n\n<pre><code>functionOne :: Int -&gt; Int -&gt; Int --Add x to each element of the list\nfunctionOne element x = element + x \n\nfunctionTwo :: [Int] -&gt; (Int -&gt; Int -&gt; Int) -&gt; [Int]\nfunctionTwo list fOne = map list fOne ave --map list by applying functionOne with ave as x\n   where \n     ave = ((sum list) / length list)\n</code></pre>\n\n<p>Why isn't this working?</p>\n"}, {"tags": ["haskell", "functional-programming", "function-composition"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1474102147, "post_id": 39544678, "comment_id": 66402214, "body": "See <a href=\"http://stackoverflow.com/q/20279306/246886\">stackoverflow.com/q/20279306/246886</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474118082, "post_id": 39544678, "comment_id": 66406811, "body": "You can uncurry <code>(&gt;)</code>, then re-curry the result. <code>gt = curry (boolToInt . (uncurry (&gt;)))</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": false, "score": 0, "last_activity_date": 1474102144, "creation_date": 1474102144, "answer_id": 39544808, "question_id": 39544678, "link": "https://stackoverflow.com/questions/39544678/composite-function-takes-multiple-arguments/39544808#39544808", "title": "Composite function takes multiple arguments", "body": "<p>You can do:</p>\n\n<pre><code>(boolToInt .) . (&gt;)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "edited": false, "score": 0, "creation_date": 1474102554, "post_id": 39544811, "comment_id": 66402340, "body": "Wow, <a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">pointfree.io</a> is cool"}], "tags": [], "owner": {"reputation": 15864, "user_id": 1870153, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/juCKe.png?s=128&g=1", "display_name": "ljedrz", "link": "https://stackoverflow.com/users/1870153/ljedrz"}, "is_accepted": false, "score": 2, "last_activity_date": 1474102163, "creation_date": 1474102163, "answer_id": 39544811, "question_id": 39544678, "link": "https://stackoverflow.com/questions/39544678/composite-function-takes-multiple-arguments/39544811#39544811", "title": "Composite function takes multiple arguments", "body": "<p>The magical <code>pointfree.io</code> has come up with the following solution:</p>\n\n<pre><code>gt :: Int -&gt; Int -&gt; Int\ngt = (boolToInt .) . (&gt;)\n</code></pre>\n"}], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "closed_date": 1474104289, "answer_count": 2, "score": 1, "last_activity_date": 1474102163, "creation_date": 1474101310, "last_edit_date": 1474101811, "question_id": 39544678, "link": "https://stackoverflow.com/questions/39544678/composite-function-takes-multiple-arguments", "closed_reason": "Duplicate", "title": "Composite function takes multiple arguments", "body": "<p>This is my program:</p>\n\n<pre><code>boolToInt True  = 1\nboolToInt False = 0\n\ngt :: Int -&gt; Int -&gt; Int\ngt x y = boolToInt $ (&gt;) x y\n</code></pre>\n\n<p>I try refactoring <code>gt</code> with <code>gt = boolToInt . (&gt;)</code> but getting an error:</p>\n\n<blockquote>\n  <p>\u2018(>)\u2019 is applied to too few arguments</p>\n</blockquote>\n\n<p>The only idea come to me is <code>curry</code> and <code>uncurry</code>, but I suppose it might make <code>gt</code> even more complicated than <code>gt x y = boolToInt $ (&gt;) x y</code>.</p>\n\n<p>Do I have a prettier <em>functional</em> solution to this composition?</p>\n"}, {"tags": ["haskell", "seq"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1474097548, "post_id": 39544075, "comment_id": 66401071, "body": "With your suggested version, <code>seq</code> would be useful on many fewer inputs. <code>seq [1..]</code> would never terminate, for example."}, {"owner": {"reputation": 15864, "user_id": 1870153, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/juCKe.png?s=128&g=1", "display_name": "ljedrz", "link": "https://stackoverflow.com/users/1870153/ljedrz"}, "edited": false, "score": 1, "creation_date": 1474098262, "post_id": 39544075, "comment_id": 66401245, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6872898/haskell-what-is-weak-head-normal-form\">Haskell: What is Weak Head Normal Form?</a>"}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 3, "creation_date": 1474113082, "post_id": 39544075, "comment_id": 66405350, "body": "I don&#39;t know if this will help (just throwing it as a by the way), but <code>seq</code> is there to evaluate a thunk. It&#39;s not there to evaluate thunks recursively. If you want to do it recursively, you can do that too, which is what the package <code>deepseq</code> is about."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1474170116, "post_id": 39544075, "comment_id": 66419030, "body": "FYI, I&#39;ve seen very few situations, aside from benchmarking code, where <code>deepseq</code> is actually the right tool for the job. It&#39;s a very heavy hammer."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1474282211, "post_id": 39544075, "comment_id": 66452241, "body": "@dfeuer Parallelism. It&#39;s essential to that, and for that single use-case I find myself using it quite a bit. I do agree with your notion though; I have not found any use-cases aside from that and benchmarking as you said."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1474286822, "post_id": 39544075, "comment_id": 66455136, "body": "@MasterMastic, ah yes; I forgot about that rather important one."}], "answers": [{"tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": true, "score": 1, "last_activity_date": 1474146521, "creation_date": 1474146521, "answer_id": 39551775, "question_id": 39544075, "link": "https://stackoverflow.com/questions/39544075/why-haskell-seq-function-makes-first-argument-to-whnf/39551775#39551775", "title": "Why haskell seq function makes first argument to WHNF?", "body": "<p>First, Haskell's API has no preference between WHNF and NF : it provides both <code>seq</code> and <code>deepseq</code>.</p>\n\n<p>So maybe your question is why does WHNF exist at all ? Simply put, it is the least evaluation possible. A full calculation would go like this :</p>\n\n<ol>\n<li>unevaluated (thunk)</li>\n<li>WHNF : outmost constructor known</li>\n<li>deeper evaluations</li>\n<li>NF : the value is completely calculated</li>\n</ol>\n\n<p>However, Haskell is lazy, it tries to do as little calculation as possible to get its final result. For example, to compute the length of a list <code>l</code>, Haskell must know whether <code>l</code> is <code>[]</code> or <code>_ : t</code>. Then recursively the same question about <code>t</code>. Therefore it only needs the number of constructors <code>:</code> before the final constructor <code>[]</code>. This is by definition successive WHNFs, which only extract the outmost constructor of a value. </p>\n\n<p>The outmost constructor is the minimal information you must know about a value to actually do something with it, such as selecting a branch in a <code>case of</code>, like in <code>length</code> just above. That is the interest of WHNF over NF.</p>\n\n<p>Note that for simple types like <code>Int</code>, each value is its own constructor (<code>2</code>, <code>-7</code>, <code>15</code>, ...), so WHNF = NF for them.</p>\n\n<p>Finally, you rarely care about all this : it is the compiler's job to execute your program as fast as possible. In the evaluation of <code>foldl (+) 0 [1..100]</code>, if you try to figure out when the list <code>[1..100]</code> finishes in NF you will be completely wrong. The compiler transforms that fold into this tail-recursive loop</p>\n\n<pre><code>let sum ret i =\n              if i == 100 then 100 + ret\n              else sum (ret+i) (i+1) in\n  sum 0 1\n</code></pre>\n\n<p>which means it doesn't evaluate the list at all. Unfortunately there are situations where the compiler cannot know that a value will always be in NF when the final result of the program is produced. Then it is a waste of time and RAM to keep it unevaluated (forming a thunk has a cost) : better <code>deepseq</code> it right from the start. Or your compiler may have performance bugs and you must help it with <code>seq</code> or <code>deepseq</code>. A profiler will tell you what parts of your code are slow.</p>\n"}], "owner": {"reputation": 453, "user_id": 2756490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31bd5947bf7793136ae44e307a2455f4?s=128&d=identicon&r=PG", "display_name": "juhyung park", "link": "https://stackoverflow.com/users/2756490/juhyung-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 39551775, "answer_count": 1, "score": 0, "last_activity_date": 1474146521, "creation_date": 1474097135, "question_id": 39544075, "link": "https://stackoverflow.com/questions/39544075/why-haskell-seq-function-makes-first-argument-to-whnf", "title": "Why haskell seq function makes first argument to WHNF?", "body": "<p>I thinks that seq is hard to understand because it makes first argument to WHNF.</p>\n\n<p>If seq makes first argument to normal form, it will be easy to understand.</p>\n\n<p>What is the benefit of using WHNF over NF?</p>\n\n<p>Why haskell committee choose using WHNF in seq function?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 12, "last_activity_date": 1474089884, "last_edit_date": 1592644375, "creation_date": 1474084558, "answer_id": 39542698, "question_id": 39542675, "link": "https://stackoverflow.com/questions/39542675/calculate-1-x1-x2-xn-in-haskell/39542698#39542698", "title": "calculate `[1, x^1, x^2, ..., x^n]` in Haskell", "body": "<p>For a list where each element is a function of the previous element, you can use <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:iterate\" rel=\"noreferrer\"><code>iterate</code></a>:</p>\n<blockquote>\n<pre><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]\n</code></pre>\n<p><code>iterate f x</code> returns an infinite list of repeated applications of <code>f</code> to <code>x</code>:</p>\n<pre><code>iterate f x == [x, f x, f (f x), ...]\n</code></pre>\n</blockquote>\n<hr />\n<pre><code>Prelude&gt; powerList x n = take (n + 1) $ iterate (* x) 1\nPrelude&gt; powerList 2 0\n[1]\nPrelude&gt; powerList 2 4\n[1,2,4,8,16]\n</code></pre>\n<hr />\n<p>If you wanted to not use <code>iterate</code> or <code>take</code> for practice, I'd start by looking at how <code>iterate</code> is implemented:</p>\n<pre><code>iterate f i = i : iterate f (f i)\n</code></pre>\n<p>To do something similar, our recursive function will need an additional parameter <code>i</code>. This is a pretty common technique when writing recursive functions.</p>\n<pre><code>-- powerList x n = [ 1, x, x^2, ..., x^n ]\npowerList x n = powerList' n 1\n  where\n    -- powerList' n i = [ i, i*x, i*x^2, ..., i*x^n ]\n    powerList' 0 i = [ i ]\n    powerList' n i = i : powerList' (n - 1) (i * x)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1474086273, "post_id": 39542755, "comment_id": 66398968, "body": "The runtime here is quadratic in <code>n</code>; appending to the end of a list is linear, so generally should be avoided."}, {"owner": {"reputation": 1152, "user_id": 4761877, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PdJG-0u7rLc/AAAAAAAAAAI/AAAAAAAAAFk/POj3rkBvbf0/photo.jpg?sz=128", "display_name": "Timothy Murphy", "link": "https://stackoverflow.com/users/4761877/timothy-murphy"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1474087563, "post_id": 39542755, "comment_id": 66399152, "body": "Good point, this was a just my first thought about implementing without iterate. I guess the other option is to create the list with the head the largest element and reverse it when done."}, {"owner": {"reputation": 1152, "user_id": 4761877, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PdJG-0u7rLc/AAAAAAAAAAI/AAAAAAAAAFk/POj3rkBvbf0/photo.jpg?sz=128", "display_name": "Timothy Murphy", "link": "https://stackoverflow.com/users/4761877/timothy-murphy"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1474089408, "post_id": 39542755, "comment_id": 66399406, "body": "Cool. Thanks. I almost always forget about passing along an additional parameter."}], "tags": [], "owner": {"reputation": 1152, "user_id": 4761877, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PdJG-0u7rLc/AAAAAAAAAAI/AAAAAAAAAFk/POj3rkBvbf0/photo.jpg?sz=128", "display_name": "Timothy Murphy", "link": "https://stackoverflow.com/users/4761877/timothy-murphy"}, "is_accepted": false, "score": 1, "last_activity_date": 1474088020, "last_edit_date": 1474088020, "creation_date": 1474085295, "answer_id": 39542755, "question_id": 39542675, "link": "https://stackoverflow.com/questions/39542675/calculate-1-x1-x2-xn-in-haskell/39542755#39542755", "title": "calculate `[1, x^1, x^2, ..., x^n]` in Haskell", "body": "<p>Chris's answer is most likely what you're looking for.</p>\n\n<p>If you'd like to do it without the use of iterate, you can use the following code.</p>\n\n<p>Edit : to avoid appending to the tail of the list (which takes linear time), one can use an auxiliary function <code>powerList'</code> to first compute the list in reverse then reverse the output of that function to correct the order.</p>\n\n<pre><code>powerList' :: Integral a =&gt; a -&gt; a -&gt; [a]\npowerList' _ 0 = [1]\npowerList' x n = do { let l = go x (n - 1)\n                    ; [x * (head l)] ++ l\n                    }\npowerList :: Integral a =&gt; a -&gt; a -&gt; [a]\npowerList x n = reverse (powerList' x n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 2, "last_activity_date": 1522950227, "last_edit_date": 1522950227, "creation_date": 1517503623, "answer_id": 48567806, "question_id": 39542675, "link": "https://stackoverflow.com/questions/39542675/calculate-1-x1-x2-xn-in-haskell/48567806#48567806", "title": "calculate `[1, x^1, x^2, ..., x^n]` in Haskell", "body": "<p>List comprehensions are often a shorthand for generators. Generators are used in other functions for many purposes. List comprehensions are often succinct enough to include in-line in a function. The following is a list comprehension version of your powerList function. It is simply named p. I'm lazy.\nTwo values in the result are a Cartesian product of each with each. The constant that is also the first parameter is needed only once. Go figure. </p>\n\n<pre><code>Prelude&gt; p i j = [(k ^ n) | k &lt;- [i], n &lt;- [0..j]]\nPrelude&gt; p 2 16\n[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536]\n</code></pre>\n\n<p>LOL a glaring fact, the i or k is a constant and a parameter, ready to use.</p>\n\n<pre><code>p i j = [(i ^ n) | n &lt;- [0..j] ]\n</code></pre>\n\n<p>What I find most remarkable about Haskell is that functions like above are specifications rather than directives. Many Haskell functions tell the computer what is wanted instead of what to do to get it, that is, it's greatly declarative which is what is most wanted in a language.</p>\n\n<p><strong>Edit 4/5/2018</strong>\nI am so sorry. Your specification to multiply the last value by a factor was not met by my last functions. Your specification is literally recursive. \"where each element is a simple multiple of the previous element, not n exponent operations.\" The following function does exactly that.</p>\n\n<pre><code>pow l = l ++ pow [(last l) * 2]\n</code></pre>\n\n<p>But like iterate, is infinite. Use <code>take x $ pow [1]</code> to not have it run forever. </p>\n"}], "owner": {"reputation": 12790, "user_id": 1767106, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0065eca502a4a798607e38cefc1ca2ed?s=128&d=identicon&r=PG", "display_name": "clay", "link": "https://stackoverflow.com/users/1767106/clay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 39542698, "answer_count": 3, "score": 1, "last_activity_date": 1522950227, "creation_date": 1474084260, "question_id": 39542675, "link": "https://stackoverflow.com/questions/39542675/calculate-1-x1-x2-xn-in-haskell", "title": "calculate `[1, x^1, x^2, ..., x^n]` in Haskell", "body": "<p>How can I write a <code>powerList</code> function in Haskell like the following? I would like it to build such a list with <code>n</code> multiply operations, where each element is a simple multiple of the previous element, not <code>n</code> exponent operations.</p>\n\n<p>Ideally, the implementation is clean, idiomatic Haskell, and reasonably efficient.</p>\n\n<pre><code>-- powerList x n -&gt; [1, x, x^2, ..., x^n]\n-- For example:\n-- powerList 2 0 -&gt; [1]\n-- powerList 2 1 -&gt; [1, 2]\n-- powerList 2 2 -&gt; [1, 2, 4]\n-- powerList 2 3 -&gt; [1, 2, 4, 8]\n-- powerList 2 4 -&gt; [1, 2, 4, 8, 16]\npowerList :: forall a. Integral a =&gt; a -&gt; a -&gt; [a]\npowerList _ 0 = [1]\npowerList x n = [] -- ??? \n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 3967, "user_id": 3853711, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/SwXly.png?s=128&g=1", "display_name": "Rahn", "link": "https://stackoverflow.com/users/3853711/rahn"}, "is_accepted": true, "score": 6, "last_activity_date": 1474081435, "last_edit_date": 1474081435, "creation_date": 1474081087, "answer_id": 39542445, "question_id": 39542434, "link": "https://stackoverflow.com/questions/39542434/simulate-an-evaluator/39542445#39542445", "title": "Simulate an evaluator", "body": "<p>In your <code>else</code> statement, you search <code>key</code> (rather than <code>x</code>) in every recursion: <code>else base key</code>. Fix it with:</p>\n\n<pre><code>extend :: State -&gt; String -&gt; Int -&gt; State\nextend base key val = \\x -&gt; if key == x\n                                 then val\n                                 else base x\n</code></pre>\n\n<hr>\n\n<p>BTW, you might write:</p>\n\n<pre><code>empty :: State\nempty = \\_ -&gt; 0\n</code></pre>\n\n<p>since <code>empty</code> return <code>0</code> regardless of input.</p>\n"}], "owner": {"reputation": 33, "user_id": 6841600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec15731d8edc1fb0d6d49d645ce6f65?s=128&d=identicon&r=PG&f=1", "display_name": "Cablick", "link": "https://stackoverflow.com/users/6841600/cablick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 39542445, "answer_count": 1, "score": 3, "last_activity_date": 1474081435, "creation_date": 1474080910, "question_id": 39542434, "link": "https://stackoverflow.com/questions/39542434/simulate-an-evaluator", "title": "Simulate an evaluator", "body": "<p>I'm simulating an evaluator with Haskell. It should be simple but I couldn't debug.</p>\n\n<p>Here I define <code>State</code> as a look-up function (<code>String -&gt; Int</code>), an initial state (<code>empty</code>, exception variable evaluates <code>0</code>), and <code>extend</code> to add new key (and it's value) to a <code>base</code> environment:</p>\n\n<pre><code>type State = String -&gt; Int\n\nextend :: State -&gt; String -&gt; Int -&gt; State\nextend base key val = \\x -&gt; if key == x\n                                 then val\n                                 else base key\n\nempty :: State\nempty = \\x -&gt; 0\n</code></pre>\n\n<p>when I test the program:</p>\n\n<pre><code>aState = extend empty  \"A\" 5\nbState = extend aState \"B\" 4\ncState = extend bState \"C\" 3\n</code></pre>\n\n<p>I suppose that <code>cState</code> should be equivalent to a function:</p>\n\n<pre><code>\\x -&gt; if x == \"C\"\n          then 3\n          else if x == \"B\"\n                   then 4\n                   else if x == \"A\"\n                            then 5\n                            else 0\n</code></pre>\n\n<p>But instead, I get <code>cState \"B\" == 0</code> and <code>cState \"A\" == 0</code>.</p>\n\n<p>I can't see what is wrong with <code>extend</code>, could somebody explain to me?</p>\n"}, {"tags": ["haskell", "error-handling", "io"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1474076166, "post_id": 39542022, "comment_id": 66397824, "body": "You need <code>encodingFunction</code> to change, returning <code>Maybe String</code> instead of returning a <code>String</code> that might have an error in at at some point."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1474077698, "post_id": 39542022, "comment_id": 66398043, "body": "@amalloy I have made a change to the <code>encodingfunction</code> and I still have the same issue.  Do I have to change every single function in my program to <code>Maybe</code> type ?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1474097906, "post_id": 39542022, "comment_id": 66401156, "body": "As written, your code should work, although you should be using <code>x</code> rather than <code>output</code> in your <code>writeFile</code> call. If you&#39;re still having problems, please produce a [Minimal, Complete, and Verifiable Example])<a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>) so answerers can see what&#39;s wrong."}], "answers": [{"tags": [], "owner": {"reputation": 1874, "user_id": 4607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6bbf7ed20f7a436af3468750f97d680d?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/4607/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1474197289, "creation_date": 1474197289, "answer_id": 39557041, "question_id": 39542022, "link": "https://stackoverflow.com/questions/39542022/haskell-abort-writefile-on-error/39557041#39557041", "title": "Haskell: abort writeFile on error", "body": "<p>You might wanna force the evaluation of the returned string so that the encoding function is for sure done before you start writing to the file. Mabye you could check its length before printing it.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474197289, "creation_date": 1474075501, "last_edit_date": 1474077646, "question_id": 39542022, "link": "https://stackoverflow.com/questions/39542022/haskell-abort-writefile-on-error", "title": "Haskell: abort writeFile on error", "body": "<p>I have a program that generates JSON and prints it to file.  The function that generates the JSON can fail midway through the code generation.</p>\n\n<p>At the moment when there is a failure in the JSON generation, the code that is generated up to that point still gets written to a file, giving me an incomplete/incorrect output file.</p>\n\n<p>I am trying to figure out how to prevent the bad output from being written. Something like:</p>\n\n<pre><code>main = do\n  let\n     output          =  encodingfunction\n     print' (Just x) =  writeFile \"outputfile\" output\n     print' _        =  putStrLn \"Encoding Failed Miserably\"\n  print' ouput\n  return ()\n\nencodingfunction :: Maybe String\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 418, "user_id": 2124786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07784bb9df5501d79fe7d6692aa56262?s=128&d=identicon&r=PG", "display_name": "enrique", "link": "https://stackoverflow.com/users/2124786/enrique"}, "edited": false, "score": 0, "creation_date": 1474128217, "post_id": 39541110, "comment_id": 66409822, "body": "@enrique Oops! Try it now. :)"}, {"owner": {"reputation": 418, "user_id": 2124786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07784bb9df5501d79fe7d6692aa56262?s=128&d=identicon&r=PG", "display_name": "enrique", "link": "https://stackoverflow.com/users/2124786/enrique"}, "edited": false, "score": 0, "creation_date": 1474150913, "post_id": 39541110, "comment_id": 66416077, "body": "It was hard for me to understand this: <code>case rest of (&#39;-&#39;:rest) ...</code>, until I noticed that the first <code>rest</code> is not the same than second <code>rest</code>. So I suggest using different name, I renamed the second to <code>r</code> in the 4 places used. Otherwise, it is a great solution, simple and clean, with which I understood Read, at last, better than the ubiquitous, but more difficult for the novel, example of Tree. Thanks!"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 418, "user_id": 2124786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07784bb9df5501d79fe7d6692aa56262?s=128&d=identicon&r=PG", "display_name": "enrique", "link": "https://stackoverflow.com/users/2124786/enrique"}, "edited": false, "score": 0, "creation_date": 1474153523, "post_id": 39541110, "comment_id": 66416618, "body": "I guess that&#39;s a good point about <code>rest</code> - let me change the second one to <code>rest&#39;</code>. And you are welcome!"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 2, "last_activity_date": 1474153545, "last_edit_date": 1474153545, "creation_date": 1474066382, "answer_id": 39541110, "question_id": 39540988, "link": "https://stackoverflow.com/questions/39540988/how-to-do-a-read-instance-for-a-simple-custom-format-of-data/39541110#39541110", "title": "How to do a Read instance for a simple custom format of data", "body": "<p>Try something like this:</p>\n\n<pre><code>instance Read Term where\n  readsPrec n s = do\n    (i,rest) &lt;- readsPrec (n+1) s       -- read `i :: Int`\n    return $ case rest of               -- look at the rest of the string\n      ('-':rest') -&gt; (T i False, rest') -- if it starts with '-'...\n      rest' -&gt; (T i True, rest')        -- if it doesn't...\n</code></pre>\n\n<p><code>Read</code> in Haskell follows closely the idea that a parser can be represented by the type <code>String -&gt; [(a, String)]</code> (this type is given the type synonym <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Text-Read.html#t:ReadS\" rel=\"nofollow\"><code>ReadS</code></a>. To familiarize yourself with this idea of parsing, I recommend the reading the following <a href=\"http://www.cs.nott.ac.uk/~pszgmh/pearl.pdf\" rel=\"nofollow\">functional pearl on monadic parsing</a>.</p>\n\n<p>Then, from GHCi:</p>\n\n<pre><code>ghci&gt; read \"[2, 5-, 4, 0-, 1, 6-, 2-]\" :: [Term]\n[2,5-,4,0-,1,6-,2-]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 418, "user_id": 2124786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07784bb9df5501d79fe7d6692aa56262?s=128&d=identicon&r=PG", "display_name": "enrique", "link": "https://stackoverflow.com/users/2124786/enrique"}, "is_accepted": false, "score": 1, "last_activity_date": 1474519505, "creation_date": 1474519505, "answer_id": 39630441, "question_id": 39540988, "link": "https://stackoverflow.com/questions/39540988/how-to-do-a-read-instance-for-a-simple-custom-format-of-data/39630441#39630441", "title": "How to do a Read instance for a simple custom format of data", "body": "<p>I like very much the answer of Alec, which I accepted. But after reading, thinking and trying, I reached another quite simple solution, that I would like to share here. </p>\n\n<p>It uses <code>reads</code> instead of <code>readsPrec</code> because the <code>Term</code> constructor is not infix, so we don't need to manage precedence, and it is not monadic. </p>\n\n<pre><code>instance Read Term where\n  readsPrec _ s = \n    [(T v False, rest)  | (v, '-' : rest) &lt;- reads s] ++ \n    [(T v True , rest)  | (v,       rest) &lt;- reads s]\n</code></pre>\n\n<p>The symmetry with the corresponding <code>Show</code> instance is notable:  </p>\n\n<pre><code>instance Show Term where\n  show (T v True)   = show v\n  show (T v False)  = show v ++ \"-\"\n</code></pre>\n"}], "owner": {"reputation": 418, "user_id": 2124786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07784bb9df5501d79fe7d6692aa56262?s=128&d=identicon&r=PG", "display_name": "enrique", "link": "https://stackoverflow.com/users/2124786/enrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 39541110, "answer_count": 2, "score": 1, "last_activity_date": 1474519505, "creation_date": 1474065389, "question_id": 39540988, "link": "https://stackoverflow.com/questions/39540988/how-to-do-a-read-instance-for-a-simple-custom-format-of-data", "title": "How to do a Read instance for a simple custom format of data", "body": "<p>I'm trying to use a short and easy to read format to show and read my data, and I would like that it could be used from the Haskell interpreter, in order to write hand or copy-paste inputs while I try new functions. </p>\n\n<p>My data is a list of Int numbers, each one with an boolean property, that I associate with <code>+</code> and <code>-</code>, being the first one the default, so it doesn't need explicit representation (as with usual sign). I would like to represent the <code>-</code> after the number, like in this example: </p>\n\n<pre><code>[2, 5-, 4, 0-, 1, 6-, 2-]\n</code></pre>\n\n<p>Note that I can not use the usual sign because I need to be able of assigning <code>-</code> to <code>0</code>, so that <code>0-</code> is different than <code>0</code> (also, may be in the future I will need to use negative numbers, like in <code>[-4-, -2]</code>).</p>\n\n<p>I did the easy part, which is to define the data type for the terms of the list and implement the <code>show</code> function. </p>\n\n<pre><code>data Term = T Int Bool deriving (Eq)\n\ninstance Show Term where\n    show (T v True)   = show v\n    show (T v False)  = show v ++ \"-\"\n</code></pre>\n\n<p>What I don't know is how to do the corresponding <code>read</code> function, or whether I cannot use the <code>-</code> sign, because it is a sign of the Haskell language. Suggestions are welcome. </p>\n"}, {"tags": ["haskell", "remote-desktop", "gnome", "xmonad", "nomachine"], "answers": [{"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 3, "last_activity_date": 1479835553, "last_edit_date": 1479835553, "creation_date": 1479833241, "answer_id": 40747324, "question_id": 39540939, "link": "https://stackoverflow.com/questions/39540939/how-can-i-run-xmonad-on-a-nomachine-remote-desktop/40747324#40747324", "title": "How can I run xmonad on a nomachine remote desktop?", "body": "<p>If you want to just run a plain <code>xmonad</code> session (and not, for example, use <code>xmonad</code> as the window manager of, say, GNOME), then it should suffie to use the option of running a custom command at startup, and simply make that command <code>xmonad</code>.</p>\n"}], "owner": {"reputation": 73, "user_id": 6841265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342d803902dd2ae5ec7d107ab7f76a33?s=128&d=identicon&r=PG&f=1", "display_name": "James Adam Buckland", "link": "https://stackoverflow.com/users/6841265/james-adam-buckland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 40747324, "answer_count": 1, "score": 7, "last_activity_date": 1479835553, "creation_date": 1474064910, "question_id": 39540939, "link": "https://stackoverflow.com/questions/39540939/how-can-i-run-xmonad-on-a-nomachine-remote-desktop", "title": "How can I run xmonad on a nomachine remote desktop?", "body": "<p>I'm trying to configure a NoMachine remote desktop to run xmonad. One thing I keep running into is that the default xmonad <a href=\"http://www.howtogeek.com/114728/how-to-use-xmonad-a-tiling-window-manager-for-linux/\" rel=\"nofollow\">installation instructions</a> require logging out and logging back in. In a remote desktop app like NoMachine, there's no way to log out as a user -- only disconnect from the session.</p>\n\n<p>I have the option to create a new Gnome, KDM, or XDM desktop, or a custom session which can do things like run a default X client script, or a custom command at startup.</p>\n\n<p>Does anyone have experience with how best to configure this?</p>\n"}, {"tags": ["multithreading", "haskell", "ghc"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1474061982, "post_id": 39540247, "comment_id": 66394868, "body": "<code>y `par` (y: __pmap__ f xs)</code> does nothing very useful: it essentially just computes <code>y</code> in parallel with <code>y</code>. Have you tried <code>let y = f x; pm&#39; = __pmap__ f xs in (y `par` pm&#39;) `pseq` (y: pm&#39;)</code>? Preferrably of course use some of the more higher-level parallelism combinators."}, {"owner": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474062191, "post_id": 39540247, "comment_id": 66394942, "body": "thanks. unfortunately that didn&#39;t improve the performance, although it did change the report output"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474062243, "post_id": 39540247, "comment_id": 66394962, "body": "I had the associativity of <code>par</code> and <code>pseq</code> wrong. Possibly it still doesn&#39;t run fast though \u2013 note that you don&#39;t really see any benefits from parallelisation if you don&#39;t actually have a lot of CPU-bound (as opposed to memory-bound) work to be done."}, {"owner": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474062698, "post_id": 39540247, "comment_id": 66395109, "body": "thanks -- still not seeing an improvement. what do you mean by CPU-bound versus memory bound? i would expect parallelism to improve performance in both cases (if by memory-bound you mean waiting on memory fetches)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474063304, "post_id": 39540247, "comment_id": 66395334, "body": "If it&#39;s just the processors independenty fetching cache-lines from main memory, then yes. If they all need to wait for a lazily build shared structure, not so sure. In your example \u2013 I don&#39;t know, what is actually supposed to be the bottleneck there? <code>sort</code> I suppose... that <i>should</i> be parallelisable, but since it&#39;s only <i>O</i> (<i>n</i> \u22c5 log <i>n</i>) it&#39;s of course not granted that its cost wont be outweighted by higher-overhead <i>O</i> (<i>n</i>) prefetching operations."}, {"owner": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1474063537, "post_id": 39540247, "comment_id": 66395398, "body": "i wrote this example to be embarrassingly parallel, so theoretically each list can be constructed and sorted without any interference from any other cores"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "edited": false, "score": 0, "creation_date": 1474903459, "post_id": 39694404, "comment_id": 66711308, "body": "thanks for the suggestion! did that improve the performance for you? i had already tried that in response to comments on the original question and it did not seem to help. note that i also tried the version using forkIO which did not help either. i&#39;ll edit the original question to reflect the new version"}, {"owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "reply_to_user": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "edited": false, "score": 0, "creation_date": 1474903698, "post_id": 39694404, "comment_id": 66711486, "body": "Yes, it does help, provided that you compile with <code>-threaded</code> and use the right <code>-N</code> value. Did you try adding the <code>traceShow</code> that I suggested to see if with say <code>-N3</code>, the array is evaluated 3 elements at a time?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "edited": false, "score": 0, "creation_date": 1474904547, "post_id": 39694404, "comment_id": 66712027, "body": "@CharlesCooper: note that this answer proposes a different associativity from the one I suggested: <code>y `par` (ys `pseq` (y : ys))</code> vs <code>(y `par` ys) `pseq` (y : ys)</code>. Does that make the difference?"}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": false, "score": 1, "last_activity_date": 1474861544, "creation_date": 1474861544, "answer_id": 39694404, "question_id": 39540247, "link": "https://stackoverflow.com/questions/39540247/haskell-parallel-program-not-utilizing-all-cores/39694404#39694404", "title": "Haskell: parallel program not utilizing all cores", "body": "<p>The issue is caused by the definition of <code>__pmap__</code>. Specifically there is a problem in the following expression:</p>\n\n<pre><code>let y = f x\n in y `par` (y: __pmap__ f xs)\n</code></pre>\n\n<p>You would expect that this would cause <code>y</code> and <code>y: __pmap__ f xs</code> to be evaluated in parallel, but this is not the case. What happens is that GHC tries to evaluate them in parallel, but the second subexpression contains <code>y</code>, which is the first subexpression. Because of that, the second subexpression depends on the first one and thus they cannot be evaluated in parallel. The correct way to write the above expression is</p>\n\n<pre><code>let y = f x\n    ys = __pmap__ f xs\n in y `par` (ys `pseq` (y : ys))\n</code></pre>\n\n<p>because the <code>pseq</code> will force <code>ys</code> to be evaluated before <code>y : ys</code> and thus the evaluation of the second subexpression can be started while the evaluation of <code>y</code> is running. See also this <a href=\"https://stackoverflow.com/questions/4576734/why-do-we-need-seq-or-pseq-with-par-in-haskell\">thread</a> for some discussion on this.</p>\n\n<p>So putting it all together, we get the following:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let [one::Int, two] = [15, 1000000]\n  print one\n  print two\n  let __pmap__ f xs = case xs of\n        [] -&gt; []\n        x:xs -&gt; let y = f x\n                    ys = __pmap__ f xs\n                 in y `par` ys `pseq` (y : ys)\n  n &lt;- pure $ sum . concat $ flip __pmap__ [1..one] $ \\i -&gt;\n    traceShow i $ force $ sort $ HM.keys $ HM.fromList $ zip [i..(two + i)] (repeat (0::Int))\n  putStrLn $ \"sum \" &lt;&gt; show n\n  s &lt;- numSparks\n  putStrLn $ \"Num sparks \" &lt;&gt; show s\n</code></pre>\n\n<p>Notice that I've added a <code>traceShow</code> (from <code>Debug.Trace</code>). If you run this with <code>-N1</code> in <code>rtsopts</code> you will see that the list will be evaluated one element at a time, whereas if you use <code>-N3</code>, it will be evaluated 3 elements at a time.</p>\n\n<p>The moral of the story is that <code>par</code> and <code>pseq</code> are easy to misuse and you should therefore prefer higher level solutions such as <code>parMap rdeepseq</code> (which is equivalent to your <code>__pmap__</code>) from <a href=\"https://hackage.haskell.org/package/parallel\" rel=\"nofollow\">parallel</a>.</p>\n"}], "owner": {"reputation": 273, "user_id": 2152666, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eaba144e276b51f8a8b96b3fef0be45a?s=128&d=identicon&r=PG", "display_name": "Charles Cooper", "link": "https://stackoverflow.com/users/2152666/charles-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1474903658, "creation_date": 1474060855, "last_edit_date": 1474903658, "question_id": 39540247, "link": "https://stackoverflow.com/questions/39540247/haskell-parallel-program-not-utilizing-all-cores", "title": "Haskell: parallel program not utilizing all cores", "body": "<p>The following code has the same performance whether compiled with <code>-threaded</code> or without, or when I write the code in a single threaded manner. Both blocks (using <code>par</code> and the commented <code>forkIO/forkOS/forkOn</code>) result in the same performance. In fact, performance is slightly degraded in the parallel version (presumably due to the overhead of parallel GC). Viewing the CPU utilization from a program like <code>htop</code> shows only one CPU getting pegged, which is pretty confusing since my reading of the code is that it should use most of the cores.</p>\n\n<p>The fact that <code>forkOS</code> doesn't use more cores is particularly confusing since the relevant section from <code>ghc/rts/posix/OSThreads.c:forkOS_createThread</code> seems to imply that it forces a call to <code>pthread_create</code>.</p>\n\n<pre><code>-- (Apologies if I have missed an import or two)\n\nimport Data.List\nimport GHC.Conc\nimport Control.Concurrent\nimport Control.DeepSeq\nimport qualified Data.HashMap.Lazy as HM\nmain :: IO ()\nmain = do\n  let [one::Int, two] = [15, 1000000]\n{-\n  s &lt;- numSparks\n  putStrLn $ \"Num sparks \" &lt;&gt; show s\n  n &lt;- getNumCapabilities\n  putStrLn $ \"Num capabilities \" &lt;&gt; show n\n  m &lt;- newEmptyMVar\n  forkIO $ void $ forM [(1::Int)..one] $ \\cpu -&gt; do\n    -- forkOn cpu $ void $ do\n    forkOS $ void $ do\n    -- forkIO $ void $ do\n    -- void $ do\n      putStrLn $ \"core \" &lt;&gt; show cpu\n      s &lt;- return $ sort $ HM.keys $ HM.fromList $ zip [cpu..two + cpu] (repeat (0::Int))\n      putStrLn $ \"core \" &lt;&gt; show cpu &lt;&gt; \" done \" &lt;&gt; show (sum s)\n      putMVar m ()\n  forM [1..one] $ \\i -&gt; takeMVar m\n  let s :: String = \"hey!\"\n  putStrLn s\n-}\n  print one\n  print two\n  let __pmap__ f xs = case xs of\n       [] -&gt; []\n       x:xs -&gt; let y = f x\n                   ys = __pmap__ f xs\n                   in (y `par` ys) `pseq` (y: ys)\n  n &lt;- pure $ sum . concat $ flip __pmap__ [1..one] $ \\i -&gt;\n    force $ sort $ HM.keys $ HM.fromList $ zip [i..(two + i)] (repeat (0::Int))\n  putStrLn $ \"sum \" &lt;&gt; show n\n  s &lt;- numSparks\n  putStrLn $ \"Num sparks \" &lt;&gt; show s\n</code></pre>\n\n<p>Relevant section from my <code>.cabal</code> file</p>\n\n<pre><code>  ghc-options:\n    -threaded\n    -rtsopts\n    \"-with-rtsopts=-N15 -qg1\"\n</code></pre>\n\n<p>Platform information</p>\n\n<pre><code>$ stack --version\nVersion 1.2.0, Git revision 241cd07d576d9c0c0e712e83d947e3dd64541c42 (4054 commits) x86_64 hpack-0.14.0\n$ stack exec ghc -- --version\nThe Glorious Glasgow Haskell Compilation System, version 7.10.3\n$ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 16.04.1 LTS\nRelease:    16.04\nCodename:   xenial\n$ uname -r\n4.4.0-36-generic\n</code></pre>\n\n<p>Why isn't my code getting parallelized?</p>\n\n<p>EDIT: if it's helpful at all, adding the <code>-s</code> runtime flag produces the following report</p>\n\n<pre><code>  21,829,377,776 bytes allocated in the heap\n 126,512,021,712 bytes copied during GC\n      86,659,312 bytes maximum residency (322 sample(s))\n       6,958,976 bytes maximum slop\n             218 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0     41944 colls,     0 par   16.268s  17.272s     0.0004s    0.0011s\n  Gen  1       322 colls,   321 par   237.056s  23.822s     0.0740s    0.2514s\n\n  Parallel GC work balance: 13.01% (serial 0%, perfect 100%)\n\n  TASKS: 32 (1 bound, 31 peak workers (31 total), using -N15)\n\n  SPARKS: 15 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 15 fizzled)\n\n  INIT    time    0.004s  (  0.003s elapsed)\n  MUT     time   12.504s  ( 13.301s elapsed)\n  GC      time  253.324s  ( 41.094s elapsed)\n  EXIT    time    0.000s  (  0.017s elapsed)\n  Total   time  265.920s  ( 54.413s elapsed)\n\n  Alloc rate    1,745,791,568 bytes per MUT second\n\n  Productivity   4.7% of total user, 23.1% of total elapsed\n\ngc_alloc_block_sync: 10725286\nwhitehole_spin: 0\ngen[0].sync: 2171\ngen[1].sync: 1057315\n</code></pre>\n\n<p>EDIT2: Messing with the arena size seems to have helped considerably. I added <code>-H2G -A1G</code> to the RTS options and the time came down from 43s to 5.2s. Is there anything else that can be improved about the situation to get a full 15x speedup?</p>\n\n<p>EDIT3: Edited the code to reflect the <code>par</code>, <code>pseq</code> pattern suggested by two people giving feedback</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack", "cabal-install", "ghc-mod"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1474066325, "post_id": 39540155, "comment_id": 66396083, "body": "Specify the github repo in your <a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/yaml_configuration.md\" rel=\"nofollow noreferrer\"><code>stack.yaml</code></a> file (see esp. &quot;complex package locations&quot;)."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1474079598, "post_id": 39540155, "comment_id": 66398270, "body": "I&#39;d like to download it as a binary for global use on my system, any ideas there?"}], "answers": [{"tags": [], "owner": {"reputation": 728, "user_id": 1929678, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/O6LDU.jpg?s=128&g=1", "display_name": "Bart Louwers", "link": "https://stackoverflow.com/users/1929678/bart-louwers"}, "is_accepted": false, "score": 2, "last_activity_date": 1483201036, "creation_date": 1483201036, "answer_id": 41409974, "question_id": 39540155, "link": "https://stackoverflow.com/questions/39540155/installing-specific-versions-via-stack/41409974#41409974", "title": "Installing specific versions via stack", "body": "<p>This was implemented recently. <a href=\"https://github.com/commercialhaskell/stack/issues/2028\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/2028</a></p>\n\n<p>Just use:</p>\n\n<pre><code>stack install ghc-mod-5.0.0\n</code></pre>\n\n<p>or any other version you like.</p>\n"}], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1483475559, "creation_date": 1474060411, "last_edit_date": 1483475559, "question_id": 39540155, "link": "https://stackoverflow.com/questions/39540155/installing-specific-versions-via-stack", "title": "Installing specific versions via stack", "body": "<p>So I suppose the problem I'm really trying to solve is that when I run ghc-mod I get this error:</p>\n\n<p><code>CabalHelper/Licenses.hs|53 col 18 error| error: Ambiguous occurrence \u2018lookupInstalledPackageId\u2019</code></p>\n\n<p>I found this relevant issue:\n<a href=\"https://github.com/DanielG/ghc-mod/issues/772\" rel=\"nofollow\">https://github.com/DanielG/ghc-mod/issues/772</a></p>\n\n<p>Where it suggests installing ghc-mod from github,\nI'd like to do everything via stack if possible (just to avoid mixing too many environments), but I couldn't find a way to specify either a version or how to specify a github repo with <code>stack install</code>.</p>\n\n<p>I also continually run into errors from stack saying that it found version <code>x</code> when version <code>y</code> was required, but I can't seem to figure out how to get it to install version <code>x</code> anyways.</p>\n\n<p>Anyone know how I can install the latest version of <code>ghc-mod</code>? Preferably with <code>stack</code>.</p>\n"}, {"tags": ["haskell", "logging", "yesod"], "comments": [{"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1488820830, "post_id": 39537563, "comment_id": 72391297, "body": "The change you made says \u201cImport the functions named <code>1</code> and <code>newStdoutLoggerSet</code> from the <code>System.Log.FastLogger</code> module\u201d. I don&#39;t think the module exposes any function called <code>1</code>."}], "owner": {"reputation": 809, "user_id": 3361900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RF3Ix.png?s=128&g=1", "display_name": "Joy", "link": "https://stackoverflow.com/users/3361900/joy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474048798, "creation_date": 1474048798, "last_edit_date": 1495542310, "question_id": 39537563, "link": "https://stackoverflow.com/questions/39537563/yesod-logging-with-system-log-fastlogger", "title": "Yesod Logging with System-Log-FastLogger", "body": "<p>Total n00b here trying to figure out how to log in a site I've inherited from another.  My Yesod app (currently running using yesod devel on an OSX Yosemite machine) is using System-Log-Fastlogger.  I am getting a 500 error on a page I want to troubleshoot (it builds fine using Stack, so it's runtime)... so I add the line     </p>\n\n<pre><code>$(logInfo) \"Greeting from your debugger!\"\n</code></pre>\n\n<p>to my handler.  Builds fine.  Doesn't log.  I know the code is being entered because I see the 500 errors in my yesod devel console.  I saw the info on SO <a href=\"https://stackoverflow.com/questions/20870699/yesod-loginfo-no-output\">Yesod logInfo no output</a> but couldn't figure out where / how to \"replace defaultBufSize with 1\".  Changing the line in Application.hs from</p>\n\n<pre><code>import           System.Log.FastLogger                (defaultBufSize, newStdoutLoggerSet)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>import           System.Log.FastLogger                (1, newStdoutLoggerSet)\n</code></pre>\n\n<p>gives me an error on rebuild.  Also running thru the code over and over and over to fill the buffer doesn't do the trick either.  Flummoxed.  Am I :</p>\n\n<ul>\n<li>not correctly understanding what stdout is in this case</li>\n<li>not grokking how to change the buffer size</li>\n<li>in over my head</li>\n</ul>\n\n<p>Would love to know what other people do for day-to-day debugging (I confess to a lot of js <code>alert(\"Got this far!\");</code> in my workflow).  I'm not sure how to <em>develop</em> in Yesod if I don't know how to <em>debug</em>.</p>\n\n<p>Thanks for any pushes in the right direction!</p>\n\n<p>Joy</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1474044870, "post_id": 39534789, "comment_id": 66387236, "body": "Qualified types are those that have a context, that is, start with <code>Constraint =&gt; ...</code>. The constraint is the &quot;qualification&quot;."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1476410472, "post_id": 39534789, "comment_id": 67344560, "body": "A good starter to get into qualified types and polymorphism  is this blog article about rank n types <a href=\"https://ocharles.org.uk/blog/guest-posts/2014-12-18-rank-n-types.html\" rel=\"nofollow noreferrer\">ocharles.org.uk/blog/guest-posts/2014-12-18-rank-n-types.htm&zwnj;&#8203;l</a>"}], "answers": [{"comments": [{"owner": {"reputation": 771, "user_id": 2852677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2589bf5e2ead9b3e7a39f30ae8a10f9?s=128&d=identicon&r=PG", "display_name": "gogurt", "link": "https://stackoverflow.com/users/2852677/gogurt"}, "edited": false, "score": 0, "creation_date": 1474039323, "post_id": 39534988, "comment_id": 66384203, "body": "Ahhhhhhhh. That was a dumb mistake. My apologies. Thank you. So essentially the domain of the type constructor is the set of all possible types, then?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 771, "user_id": 2852677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2589bf5e2ead9b3e7a39f30ae8a10f9?s=128&d=identicon&r=PG", "display_name": "gogurt", "link": "https://stackoverflow.com/users/2852677/gogurt"}, "edited": false, "score": 0, "creation_date": 1474040194, "post_id": 39534988, "comment_id": 66384757, "body": "More or less. There are some subtleties with kinds which I am sure I don&#39;t fully understand, but <a href=\"https://wiki.haskell.org/Kind\" rel=\"nofollow noreferrer\">wiki.haskell.org/Kind</a> defines ordinary types as having kind <code>*</code> and type constructors as having kind <code>P -&gt; Q</code> where <code>P</code> and <code>Q</code> are kinds. (The extra generality there allows <code>(-&gt;)</code> to have kind <code>* -&gt; * -&gt; *</code>, where <code>P</code> and <code>Q</code> are <code>*</code> and <code>*-&gt;*</code>, respectively.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1474044727, "post_id": 39534988, "comment_id": 66387171, "body": "@chepner Minor terminology correction: &quot;type constructor&quot; is a technical term that is orthogonal to the property of having a kind of the form <code>P -&gt; Q</code>. For example, <code>Int</code> is a type constructor of kind <code>*</code>, and <code>Either Int</code> has an arrow kind but is not a type constructor. By analogy to term constructors: <code>False</code> is a constructor that does not have an arrow type, whereas <code>(+) 0</code> has an arrow in its type but is not a constructor."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474045519, "post_id": 39534988, "comment_id": 66387547, "body": "I don&#39;t think I see why <code>Either Int</code> is not a type constructor, since it takes an argument and returns a type, but perhaps this is not the place for that question."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1474046661, "post_id": 39534988, "comment_id": 66388041, "body": "@chepner, just because that&#39;s not what &quot;type constructor&quot; means."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474047000, "post_id": 39534988, "comment_id": 66388188, "body": "<a href=\"https://wiki.haskell.org/Constructor#Type_constructor\" rel=\"nofollow noreferrer\">wiki.haskell.org/Constructor#Type_constructor</a> describes <code>Tree</code> as a unary type constructor defined by <code>data Tree a = Tip | Node a (Tree a) (Tree a)</code> The only difference I can see between <code>Tree</code> and <code>Either Int</code> is that the former is a single name and the latter is an expression."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1474047149, "post_id": 39534988, "comment_id": 66388273, "body": "@chepner, bingo! :)"}, {"owner": {"reputation": 771, "user_id": 2852677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2589bf5e2ead9b3e7a39f30ae8a10f9?s=128&d=identicon&r=PG", "display_name": "gogurt", "link": "https://stackoverflow.com/users/2852677/gogurt"}, "edited": false, "score": 0, "creation_date": 1474047595, "post_id": 39534988, "comment_id": 66388508, "body": "@chepner: Interesting... can you summarize this comment discussion into your answer? Then I&#39;ll accept. I think it&#39;s useful."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1474048377, "last_edit_date": 1474048377, "creation_date": 1474039155, "answer_id": 39534988, "question_id": 39534789, "link": "https://stackoverflow.com/questions/39534789/how-do-i-understand-the-set-of-valid-inputs-to-a-haskell-type-constructor/39534988#39534988", "title": "How do I understand the set of valid inputs to a Haskell type constructor?", "body": "<p>You just have the type constructor in the wrong place. The following is fine:</p>\n\n<pre><code>idConsPoly :: Num a =&gt; Id (a -&gt; a)\nidConsPoly = MkId undefined\n</code></pre>\n\n<hr>\n\n<p>The type constructor <code>Id</code> here has kind <code>* -&gt; *</code>, which means you can give it any value that has kind <code>*</code> (which includes all \"ordinary\" types) and returns a new value of kind <code>*</code>. In general, you are more concerned with arrow-kinded functions(?), of which type constructors are just one example.</p>\n\n<p><code>TypeProd</code> is a ternary type constructor whose first two arguments have kind <code>* -&gt; *</code>:</p>\n\n<pre><code>-- Based on :*: from Control.Compose\nnewtype TypeProd f g a = Prod { unProd :: (f a, g a) }\n</code></pre>\n\n<p><code>Either Int</code> is an expression whose value has kind <code>* -&gt; *</code> but is not a type constructor, being the partial application of the type constructor <code>Either</code> to the nullary type constructor <code>Int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1474039403, "creation_date": 1474039403, "answer_id": 39535064, "question_id": 39534789, "link": "https://stackoverflow.com/questions/39534789/how-do-i-understand-the-set-of-valid-inputs-to-a-haskell-type-constructor/39535064#39535064", "title": "How do I understand the set of valid inputs to a Haskell type constructor?", "body": "<p>The type signature is almost correct</p>\n\n<pre><code>idConsPoly :: (Num a) =&gt; Id (a -&gt; a)\n</code></pre>\n\n<p>Should be right, though i have no ghc on my phone to test this.\n<sub>\nAlso i think your question is quite broad, thus i deliberately answer only the concrete problem here.\n</sub></p>\n"}, {"comments": [{"owner": {"reputation": 771, "user_id": 2852677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2589bf5e2ead9b3e7a39f30ae8a10f9?s=128&d=identicon&r=PG", "display_name": "gogurt", "link": "https://stackoverflow.com/users/2852677/gogurt"}, "edited": false, "score": 0, "creation_date": 1474047018, "post_id": 39537043, "comment_id": 66388199, "body": "Thanks for this. I&#39;m beginning to understand, I think. Do you happen to know of another source I can take a look at to get a better understanding of your explanation in the 2nd paragraph? I&#39;d really like to get a good handle on this stuff."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 1, "last_activity_date": 1474046590, "creation_date": 1474046590, "answer_id": 39537043, "question_id": 39534789, "link": "https://stackoverflow.com/questions/39534789/how-do-i-understand-the-set-of-valid-inputs-to-a-haskell-type-constructor/39537043#39537043", "title": "How do I understand the set of valid inputs to a Haskell type constructor?", "body": "<p>Also contributing to your confusion is that you've misinterpreted the error message from GHC. It means \"<code>Num a =&gt; a -&gt; a</code> is a polymorphic or qualified type, and therefore illegal (in this context)\".</p>\n\n<p>The last sentence that you quoted from the book is not very well worded, and maybe contributed to that misunderstanding. It's important to realize that in <code>Id (a -&gt; a)</code> the argument <code>a -&gt; a</code> is <em>not</em> a polymorphic type, but just an ordinary type that happens to mention a type variable. The thing which is polymorphic is <code>idIdentity</code>, which can have the type <code>Id (a -&gt; a)</code> for any type <code>a</code>.</p>\n\n<p>In standard Haskell polymorphism and qualification can only appear at the outermost level of the type in a type signature.</p>\n"}], "owner": {"reputation": 771, "user_id": 2852677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b2589bf5e2ead9b3e7a39f30ae8a10f9?s=128&d=identicon&r=PG", "display_name": "gogurt", "link": "https://stackoverflow.com/users/2852677/gogurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 39534988, "answer_count": 3, "score": 0, "last_activity_date": 1474048377, "creation_date": 1474038541, "last_edit_date": 1474039429, "question_id": 39534789, "link": "https://stackoverflow.com/questions/39534789/how-do-i-understand-the-set-of-valid-inputs-to-a-haskell-type-constructor", "title": "How do I understand the set of valid inputs to a Haskell type constructor?", "body": "<p>Warning: very beginner question.</p>\n\n<p>I'm currently mired in the section on algebraic types in the Haskell book I'm reading, and I've come across the following example:</p>\n\n<pre><code>data Id a =\n  MkId a deriving (Eq, Show)\n\nidInt :: Id Integer\nidInt = MkId 10\n\nidIdentity :: Id (a -&gt; a)\nidIdentity = MkId $ \\x -&gt; x\n</code></pre>\n\n<p>OK, hold on. I don't fully understand the <code>idIdentity</code> example. The explanation in the book is that:</p>\n\n<blockquote>\n  <p>This is a little odd. The type <code>Id</code> takes an argument and the data\n  constructor <code>MkId</code> takes an argument of the corresponding polymorphic\n  type. So, in order to have a value of type <code>Id Integer</code>, we need to\n  apply <code>a -&gt; Id a</code> to an <code>Integer</code> value. This binds the <code>a</code> type variable to\n  <code>Integer</code> and applies away the <code>(-&gt;)</code> in the type constructor, giving us\n  <code>Id Integer</code>. We can also construct a <code>MkId</code> value that is an identity\n  function by binding the <code>a</code> to a polymorphic function in both the type\n  and the term level.</p>\n</blockquote>\n\n<p>But wait. Why only fully polymorphic functions? My previous understanding was that <code>a</code> can be <strong>any</strong> type. But apparently constrained polymorphic type doesn't work: <code>(Num a) =&gt; a -&gt; a</code> won't work here, and the GHC error suggests that only completely polymorphic types or \"qualified types\" (not sure what those are) are valid:</p>\n\n<pre><code>f :: (Num a) =&gt; a -&gt; a\nf = undefined\n\nidConsPoly :: Id (Num a) =&gt; a -&gt; a\nidConsPoly = MkId undefined\n\nIllegal polymorphic or qualified type: Num a =&gt; a -&gt; a\nPerhaps you intended to use ImpredicativeTypes\nIn the type signature for \u2018idIdentity\u2019:\n  idIdentity :: Id (Num a =&gt; a -&gt; a)\n</code></pre>\n\n<p><strong>EDIT</strong>: I'm a bonehead. I wrote the type signature below incorrectly, as pointed out by @chepner in his answer below. This also resolves my confusion in the next sentence below...</p>\n\n<p>In retrospect, this behavior makes sense because I haven't defined a <code>Num</code> instance for <code>Id</code>. But then what explains me being able to apply a type like <code>Integer</code> in <code>idInt :: Id Integer</code>?</p>\n\n<p>So in generality, I guess my question is: <strong>What specifically is the set of valid inputs to type constructors?</strong> Only fully polymorphic types? What are \"qualified types\" then? Etc...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1474031285, "post_id": 39531032, "comment_id": 66378851, "body": "With that type, <code>chargeFee</code> would be more accurately named <code>computeFee</code> (you aren&#39;t actually deducting any money from an account), so you can just return 0 for inactive customers."}], "answers": [{"comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1474028036, "post_id": 39531144, "comment_id": 66376732, "body": "I know I can, but I was hoping to get a compile error if someone tried to charge an inactive customer."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1474028559, "post_id": 39531144, "comment_id": 66377058, "body": "But how is the compiler supposed to know which customers are active? That&#39;s not going to be decided until runtime, is it?"}, {"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1474063383, "post_id": 39531144, "comment_id": 66395355, "body": "Let&#39;s say I have dedicated functions which return active and inactive customers (each one uses appropriate where clause is SQL)."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 0, "last_activity_date": 1474027721, "creation_date": 1474027721, "answer_id": 39531144, "question_id": 39531032, "link": "https://stackoverflow.com/questions/39531032/using-types-to-force-correctness/39531144#39531144", "title": "Using types to force correctness", "body": "<p>You could always make <code>chargeFee</code> return a <code>Maybe</code> or <code>Either</code> for illegal actions:</p>\n\n\n\n<pre class=\"lang-haskell prettyprint-override\"><code>chargeFee :: Customer a -&gt; Maybe Int\nchargeFee (Inactive _) = Nothing\nchargeFee (Active cust) = ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 7, "last_activity_date": 1474029029, "creation_date": 1474029029, "answer_id": 39531589, "question_id": 39531032, "link": "https://stackoverflow.com/questions/39531032/using-types-to-force-correctness/39531589#39531589", "title": "Using types to force correctness", "body": "<p>You can accomplish such a thing with phantom types: </p>\n\n<pre><code>module Customer \n   (CustomerKind(..), Customer, {- note: MkCustomer is not exported -}       \n    makeCustomer, activate, chargeFee) where\n\ndata CustomerKind = Active | Inactive \ndata Customer (x :: CustomerKind) = MkCustomer String \n\nmkCustomer :: String -&gt; Customer Inactive \nmkCustomer = MkCustomer \n\n-- perhaps `IO (Customer Active)' or something else\nactivate :: Customer Inactive -&gt; Maybe (Customer Active) \nactivate = ...\n\nchargeFee :: Customer Active -&gt; Int\nchargeFee = ... \n</code></pre>\n\n<p>Here <code>activate</code> will somehow ensure that the given customer can be made active (and do so), producing said active customer. But trying to call <code>chargeFee (mkCustomer ...)</code> is a type error. </p>\n\n<p>Note that <code>DataKinds</code> are not strictly required - the following is equivalent:</p>\n\n<pre><code>data Active \ndata Inactive \n-- everything else unchanged \n</code></pre>\n\n<p>The same can be accomplished without phantom types, by simply declaring two types - <code>ActiveCustomer</code> and <code>InactiveCustomer</code> - but the phantom types approach allows you to write functions which don't care about the type of customer:</p>\n\n<pre><code>customerName :: Customer a -&gt; String \ncustomerName (MkCustomer a) = ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1474057392, "post_id": 39534051, "comment_id": 66393092, "body": "Do I always have to pattern match on <code>AC n</code> and <code>IC n</code> when writing a function which works on anyone (like <code>getName</code>)?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1474063762, "post_id": 39534051, "comment_id": 66395468, "body": "@zoran119 Not necessarily if you factor it out -- see the last edit. The type definition becomes slightly more subtle, though."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1474063705, "last_edit_date": 1474063705, "creation_date": 1474036330, "answer_id": 39534051, "question_id": 39531032, "link": "https://stackoverflow.com/questions/39531032/using-types-to-force-correctness/39534051#39534051", "title": "Using types to force correctness", "body": "<p>A basic way is to use a separate type</p>\n\n<pre><code>data ActiveCustomer   = AC String -- etc.\ndata InactiveCustomer = IC String -- etc.\ndata Customer = Active ActiveCustomer | Inactive InactiveCustomer\n\n-- only works on active\nchargeFee :: ActiveCustomer -&gt; IO ()\nchargeFee (AC n) = putStrLn (\"charged: \" ++ n)\n\n-- works on anyone\ngetName :: Customer -&gt; String\ngetName (Active  (AC n)) = n\ngetName (Inctive (IC n)) = n\n</code></pre>\n\n<p>This can also be done, more or less, in OOP languages: just use a different class for active and inactive customers, possibly inheriting from a common <code>Customer</code> interface / superclass.</p>\n\n<p>With algebraic types you get the benefits of the closed-world assumption, namely that there are no other subtypes of <code>Customer</code>, but often one can live without that.</p>\n\n<hr>\n\n<p>A more advanced way is to use a GADT. <code>DataKinds</code> is optional but is nicer, IMHO. (Warning: untested)</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds #-}\n\ndata CustomerType = Active | Inactive\ndata Customer (t :: CustomerType) where\n   AC :: String -&gt; Customer Active\n   IC :: String -&gt; Customer Inactive\n\n-- only works on active\nchargeFee :: Customer Active -&gt; IO ()\nchargeFee (AC n) = putStrLn (\"charged: \" ++ n)\n\n-- works on anyone\ngetName :: Customer any -&gt; String\ngetName (AC n) = n\ngetName (IC n) = n\n</code></pre>\n\n<p>Alternatively, factor out the tag with a singleton:</p>\n\n<pre><code>data CustomerType = Active | Inactive\ndata CustomerTypeSing (t :: CustomerType) where\n   AC :: CustomerTypeSing Active\n   IC :: CustomerTypeSing Active\ndata Customer (t :: CustomerType) where\n   C :: CustomerTypeSing t -&gt; String -&gt; Customer t\n\n-- only works on active\nchargeFee :: Customer Active -&gt; IO ()\nchargeFee (C _ n) = putStrLn (\"charged: \" ++ n)\n\n-- works on anyone\ngetName :: Customer any -&gt; String\ngetName (C _ n) = n\n\n-- how to build a new customer\nmakeActive :: String -&gt; Customer Active \nmakeActive n = C AC n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "is_accepted": false, "score": 0, "last_activity_date": 1474532210, "last_edit_date": 1474532210, "creation_date": 1474527204, "answer_id": 39632170, "question_id": 39531032, "link": "https://stackoverflow.com/questions/39531032/using-types-to-force-correctness/39632170#39632170", "title": "Using types to force correctness", "body": "<p>All that's required is to tag the type with the active status. I see no need for separate constructors. It's easy to do so like so:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata Active = Active\ndata Inactive = Inactive\n\ndata Customer a where\n  Customer :: String -&gt; Int -&gt; Customer a\n</code></pre>\n\n<p>(p.s. I've added an <code>Int</code> to your data type to represent credit, so you can actually charge the customer in some way.)</p>\n\n<p>So <code>Customer Active</code> represents and \"active\" customer, and likewise <code>Customer Inactive</code> represents an \"inactive\" customer.</p>\n\n<p>We can then \"create\" customers like so:</p>\n\n<pre><code>create :: String -&gt; Int -&gt; Customer a\ncreate = Customer\n\ncreateByStatus :: a -&gt; String -&gt; Int -&gt; Customer a\ncreateByStatus _ = Customer\n</code></pre>\n\n<p>Creating convenience methods is easy:</p>\n\n<pre><code>createActive :: String -&gt; Int -&gt; Customer Active\ncreateActive = create\ncreateInactive :: String -&gt; Int -&gt; Customer Inactive\ncreateInactive = create\n</code></pre>\n\n<p>Note that using <code>create</code> directly you can create silly types like <code>Customer Int</code>. You've got a few options to stop this,</p>\n\n<ol>\n<li>Only expose the convenience methods to your users</li>\n<li>Put a constraint on <code>a</code> in <code>create</code> type classes.</li>\n</ol>\n\n<p>I'll go through option 2 later on.</p>\n\n<p>Now we can write some methods to work on our type:</p>\n\n<pre><code>getName :: Customer a -&gt; String\ngetName (Customer name _) = name\n\ngetCredit :: Customer a -&gt; Int\ngetCredit (Customer _ credit) = credit\n\nchargeCustomer :: Customer Active -&gt; Int -&gt; Customer Active\nchargeCustomer (Customer name credit) charge = Customer name (credit - charge)\n</code></pre>\n\n<p>Note that <code>chargeCustomer</code> only works on active customers. You'l get a type error otherwise.</p>\n\n<p>Now I'm going to write a utility function, <code>castCustomer</code>. </p>\n\n<pre><code>castCustomer :: Customer a -&gt; Customer b\ncastCustomer (Customer name credit) = Customer name credit\n</code></pre>\n\n<p>What <code>castCustomer</code> does is just change any sort of customer into any sort of customer. Think of this as an unsafe cast in C, you shouldn't expose this to your users. But it's useful to write your other functions:</p>\n\n<pre><code>setActiveStatus :: statusToCheck -&gt; Customer currentStatus -&gt; Customer statusToCheck\nsetActiveStatus _ = castCustomer\n</code></pre>\n\n<p>So you can do <code>setActiveStatus Inactive customer</code> and you'll get back <code>customer</code> but inactive. It just uses <code>castCustomer</code> which works for all casts, but <code>setActiveStatus</code>'s own type restricts <code>castCustomer</code> appropriately.</p>\n\n<p>And there's also these simpler utility functions:</p>\n\n<p>Of course one can now write convenience functions:</p>\n\n<pre><code>setActive :: (LegalStatus a) =&gt; Customer a -&gt; Customer Active\nsetActive = castCustomer\n\nsetInactive :: (LegalStatus a) =&gt; Customer a -&gt; Customer Inactive\nsetInactive = castCustomer\n</code></pre>\n\n<p>Finally, one might want a function like this:</p>\n\n<pre><code>getByStatus :: b -&gt; Customer a -&gt; Maybe (Customer b)\n</code></pre>\n\n<p>where we pass a status and a customer, and get that customer returned if they match the status, but otherwise returns <code>Nothing</code>.</p>\n\n<p>We're going to need different implementations depending on the types, so we're going to need a class.</p>\n\n<p>We could write a class like <code>class GetByStatus a b</code> but the problem is that any functions which use this class will have to have an ugly <code>GetByStatus a b</code> in their type signatures constraint clause.</p>\n\n<p>So we're going to make a simpler class:</p>\n\n<pre><code>class LegalStatus a where ...\n</code></pre>\n\n<p>Which is going to have two instances:</p>\n\n<pre><code>instance LegalStatus Active where ...\ninstance LegalStatus Inactive where ...\n</code></pre>\n\n<p>Here's the definitions of the <code>LegalStatus</code> class:</p>\n\n<pre><code>class LegalStatus a where \n  get :: (LegalStatus b) =&gt; Customer b -&gt; Maybe (Customer a)\n  getActive :: Customer a -&gt; Maybe (Customer Active)\n  getInactive :: Customer a -&gt; Maybe (Customer Inactive)\n</code></pre>\n\n<p>This may look confusing, but lets have a look at the instances:</p>\n\n<pre><code>instance LegalStatus Active where\n  get = getActive\n  getActive = Just . castCustomer\n  getInactive _ = Nothing\n\ninstance LegalStatus Inactive where\n  get = getInactive\n  getActive _ = Nothing\n  getInactive = Just . castCustomer \n</code></pre>\n\n<p>What we're doing here is an object orientated technique called <code>https://en.wikipedia.org/wiki/Double_dispatch</code>. This means we don't complicate our signatures. We can now out function like:</p>\n\n<pre><code>getByStatus :: (LegalStatus a, LegalStatus b) =&gt; a -&gt; Customer b -&gt; Maybe (Customer a)\ngetByStatus _ = get\n</code></pre>\n\n<p>Using these functions and <code>catMaybe</code>, it's relatively easy to write functions that say, take a list of customers and return only the active ones:</p>\n\n<pre><code>getAll :: (LegalStatus a, LegalStatus b) =&gt; [Customer a] -&gt; [Customer b]\ngetAll = catMaybes . map get\n\ngetAllByStatus :: (LegalStatus a, LegalStatus b) =&gt; a -&gt; [Customer b] -&gt; [Customer a]\ngetAllByStatus _ = getAll\n\ngetAllActive :: (LegalStatus a) =&gt; [Customer a] -&gt; [Customer Active]\ngetAllActive = getAll\n\ngetAllInactive :: (LegalStatus a) =&gt; [Customer a] -&gt; [Customer Inactive]\ngetAllInactive = getAll\n</code></pre>\n\n<p>It's worth pointing out how magic <code>getAll</code> is (and indeed, many other similar functions in Haskell). Do <code>getAll list</code> and if you put in into a list of active customers, you'll get only the active customers in the list, and similarly, if you put it into a list of inactive customers, you'll only get inactive customers in the list.</p>\n\n<p>I'll illstrate this through the following function, which splits a list of customers who's status is unknown into a list of active customers and a list of inactive customers:</p>\n\n<pre><code>splitCustomers :: (LegalStatus a) =&gt; [Customer a] -&gt; ([Customer Active], [Customer Inactive])\nsplitCustomers l = (getAll l, getAll l)\n</code></pre>\n\n<p>Looking at the implementation of <code>splitCustomers</code>, it looks like the first and second elements of the pair are the same. Indeed they look exactly the same. But they're not, they've got different types, and as a result end up calling different instances and can get totally different results.</p>\n\n<p>There's one other thing to close up if you really want to. You'll probably want to expose the class <code>LegalStatus</code>, as users might want to use it as a constraint in their type signatures, but that means they can write instances of <code>LegalStatus</code>. Like</p>\n\n<pre><code>instance LegalStatus Int where ...\n</code></pre>\n\n<p>They'd be silly to do this but you can stop them if you like. The simplest approach is this:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE ConstraintKinds #-}\n\ntype family RestrictLegalStatus a where\n  RestrictLegalStatus Active = ()\n  RestrictLegalStatus Inactive = ()\n\ntype IsLegalStatus a = (RestrictLegalStatus a ~ ())\n\nclass (IsLegalStatus a) =&gt; LegalStatus a where ...\n</code></pre>\n\n<p>Any attempt to make a new instance will now fail the <code>IsLegalStatus</code> constraint and fail. </p>\n\n<p>This is probably overengineered at this point, and you won't need all this, but I've included it to show some points about type-inference:</p>\n\n<p>So for your reference, here's all the code attached below:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE ConstraintKinds #-}\n\nmodule Main where\n\nimport Data.Maybe (catMaybes)\n\nmain = return ()\n\ndata Active = Active\ndata Inactive = Inactive\n\ntype family RestrictLegalStatus a where\n  RestrictLegalStatus Active = ()\n  RestrictLegalStatus Inactive = ()\n\ntype IsLegalStatus a = (RestrictLegalStatus a ~ ())\n\ndata Customer a where\n  Customer :: String -&gt; Int -&gt; Customer a\n\nclass (IsLegalStatus a) =&gt; LegalStatus a where \n  get :: (LegalStatus b) =&gt; Customer b -&gt; Maybe (Customer a)\n  getActive :: Customer a -&gt; Maybe (Customer Active)\n  getInactive :: Customer a -&gt; Maybe (Customer Inactive)\n\ninstance LegalStatus Active where\n  get = getActive\n  getActive = Just . castCustomer\n  getInactive _ = Nothing\n\ninstance LegalStatus Inactive where\n  get = getInactive\n  getActive _ = Nothing\n  getInactive = Just . castCustomer\n\ngetByStatus :: (LegalStatus a, LegalStatus b) =&gt; a -&gt; Customer b -&gt; Maybe (Customer a)\ngetByStatus _ = get\n\ncreate :: String -&gt; Int -&gt; Customer a\ncreate = Customer\n\ncreateByStatus :: a -&gt; String -&gt; Int -&gt; Customer a\ncreateByStatus _ = Customer\n\ncreateActive :: String -&gt; Int -&gt; Customer Active\ncreateActive = Customer\n\ncreateInactive :: String -&gt; Int -&gt; Customer Inactive\ncreateInactive = Customer\n\ngetName :: Customer a -&gt; String\ngetName (Customer name _) = name\n\ngetCredit :: Customer a -&gt; Int\ngetCredit (Customer _ credit) = credit\n\nchargeCustomer :: Customer Active -&gt; Int -&gt; Customer Active\nchargeCustomer (Customer name credit) charge = Customer name (credit - charge)\n\ncastCustomer :: Customer a -&gt; Customer b\ncastCustomer (Customer name credit) = Customer name credit\n\nsetActiveStatus :: (LegalStatus statusToCheck, LegalStatus currentStatus) =&gt; statusToCheck -&gt; Customer currentStatus -&gt; Customer statusToCheck\nsetActiveStatus _ = castCustomer\n\nsetActive :: (LegalStatus a) =&gt; Customer a -&gt; Customer Active\nsetActive = castCustomer\n\nsetInactive :: (LegalStatus a) =&gt; Customer a -&gt; Customer Inactive\nsetInactive = castCustomer\n\ngetAll :: (LegalStatus a, LegalStatus b) =&gt; [Customer a] -&gt; [Customer b]\ngetAll = catMaybes . map get\n\ngetAllByStatus :: (LegalStatus a, LegalStatus b) =&gt; a -&gt; [Customer b] -&gt; [Customer a]\ngetAllByStatus _ = getAll\n\ngetAllActive :: (LegalStatus a) =&gt; [Customer a] -&gt; [Customer Active]\ngetAllActive = getAll\n\ngetAllInactive :: (LegalStatus a) =&gt; [Customer a] -&gt; [Customer Inactive]\ngetAllInactive = getAll\n\nsplitCustomers :: (LegalStatus a) =&gt; [Customer a] -&gt; ([Customer Active], [Customer Inactive])\nsplitCustomers l = (getAll l, getAll l)\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>Others have pointed out to restrict the statuses using <code>DataKinds</code>. Admittedly this is probably a cleaner approach than my \"constraint on the class\" approach. Note you have to change a few of the functions, because the parameter to the class is no longer an ordinary type but a kind, and only ordinary types can be parameters to functions, you have to wrap raw status functions in a <code>Proxy</code> constructor.</p>\n\n<p>Note with the DataKind approach you can no longer call <code>getByStatus Active</code>... because <code>Active</code> is no longer a value, you need to do:</p>\n\n<pre><code>getByStatus (Proxy :: Proxy Active) ...\n</code></pre>\n\n<p>but feel free to define:</p>\n\n<pre><code>active :: Proxy Active\nactive = Proxy\n</code></pre>\n\n<p>so you can then call:</p>\n\n<pre><code>getByStatus active\n</code></pre>\n\n<p>The full code is below.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n\nmodule Main where\n\nimport Data.Maybe (catMaybes)\nimport Data.Proxy (Proxy)\n\nmain = return ()\n\ndata LegalStatusKind = Active | Inactive\n\ndata Customer (a :: LegalStatusKind) where\n  Customer :: String -&gt; Int -&gt; Customer a\n\nclass LegalStatus (a :: LegalStatusKind) where \n  get :: (LegalStatus b) =&gt; Customer b -&gt; Maybe (Customer a)\n  getActive :: Customer a -&gt; Maybe (Customer Active)\n  getInactive :: Customer a -&gt; Maybe (Customer Inactive)\n\ninstance LegalStatus Active where\n  get = getActive\n  getActive = Just . castCustomer\n  getInactive _ = Nothing\n\ninstance LegalStatus Inactive where\n  get = getInactive\n  getActive _ = Nothing\n  getInactive = Just . castCustomer\n\ngetByStatus :: (LegalStatus a, LegalStatus b) =&gt; Proxy a -&gt; Customer b -&gt; Maybe (Customer a)\ngetByStatus _ = get\n\ncreate :: String -&gt; Int -&gt; Customer a\ncreate = Customer\n\ncreateByStatus :: Proxy a -&gt; String -&gt; Int -&gt; Customer a\ncreateByStatus _ = Customer\n\ncreateActive :: String -&gt; Int -&gt; Customer Active\ncreateActive = Customer\n\ncreateInactive :: String -&gt; Int -&gt; Customer Inactive\ncreateInactive = Customer\n\ngetName :: Customer a -&gt; String\ngetName (Customer name _) = name\n\ngetCredit :: Customer a -&gt; Int\ngetCredit (Customer _ credit) = credit\n\nchargeCustomer :: Customer Active -&gt; Int -&gt; Customer Active\nchargeCustomer (Customer name credit) charge = Customer name (credit - charge)\n\ncastCustomer :: Customer a -&gt; Customer b\ncastCustomer (Customer name credit) = Customer name credit\n\nsetActiveStatus :: (LegalStatus statusToCheck, LegalStatus currentStatus) =&gt; Proxy statusToCheck -&gt; Customer currentStatus -&gt; Customer statusToCheck\nsetActiveStatus _ = castCustomer\n\nsetActive :: (LegalStatus a) =&gt; Customer a -&gt; Customer Active\nsetActive = castCustomer\n\nsetInactive :: (LegalStatus a) =&gt; Customer a -&gt; Customer Inactive\nsetInactive = castCustomer\n\ngetAll :: (LegalStatus a, LegalStatus b) =&gt; [Customer a] -&gt; [Customer b]\ngetAll = catMaybes . map get\n\ngetAllByStatus :: (LegalStatus a, LegalStatus b) =&gt; Proxy a -&gt; [Customer b] -&gt; [Customer a]\ngetAllByStatus _ = getAll\n\ngetAllActive :: (LegalStatus a) =&gt; [Customer a] -&gt; [Customer Active]\ngetAllActive = getAll\n\ngetAllInactive :: (LegalStatus a) =&gt; [Customer a] -&gt; [Customer Inactive]\ngetAllInactive = getAll\n\nsplitCustomers :: (LegalStatus a) =&gt; [Customer a] -&gt; ([Customer Active], [Customer Inactive])\nsplitCustomers l = (getAll l, getAll l)\n</code></pre>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "answer_count": 4, "score": 6, "last_activity_date": 1474532210, "creation_date": 1474027383, "last_edit_date": 1474028079, "question_id": 39531032, "link": "https://stackoverflow.com/questions/39531032/using-types-to-force-correctness", "title": "Using types to force correctness", "body": "<p>Let's say that we have a store management application. It has <code>Customer</code>s and can <code>chargeFee()</code>. It should do so only for active <code>Customer</code>s however.</p>\n\n<p>A common way I've seen this done (Java/pseudocode) is something like this:</p>\n\n<pre><code>class Customer {\n    String name\n    StatusEnum status  // 1=active, 2=inactive\n}    \n\n// and this is how the customers are charged\nfor (c:Customer.listByStatus(StatusEnum.1)) {\n    c.chargeFee()\n}\n</code></pre>\n\n<p>This is OK, but it doesn't stop someone from charging a fee from an inactive <code>Customer</code>. Even if <code>chargeFee()</code> checks the status of the <code>Customer</code>, that's a runtime error/event.</p>\n\n<p>So, keeping the whole 'make illegal states unrepresentable' thing in mind, how would one approach design of this application (in Haskell for example)? I want a compile error if someone tries to charge an inactive customer.</p>\n\n<hr>\n\n<p>I was thinking something like this, but I still doesn't allow me to restrict <code>chargeFee</code> so that an inactive <code>Customer</code> cannot be charged.</p>\n\n<pre><code>data CustomerDetails = CustomerDetails { name :: String }\ndata Customer a = Active a | Inactive a\n\nchargeFee :: Active a -&gt; Int -- this doesn't work, do I need DataKinds?\n</code></pre>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1474027133, "post_id": 39530299, "comment_id": 66376219, "body": "Why not just <code>filter (any (not . isSpace)) . lines</code>?"}, {"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1474032984, "post_id": 39530299, "comment_id": 66380018, "body": "I have abstracted out the details of what I am doing for the purpose of simplifying the question. I am parsing a configuration file, not just into words, but into keys and values of various complex sorts. It seems to me that the parser should be able to discard blank lines as part of its grammar, and that one should not do this at the lexical read of the file level."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1474035409, "post_id": 39530299, "comment_id": 66381650, "body": "Your <code>wordP</code> parses spaces, so the <code>`sepBy` (char &#39; &#39;)</code> does not really do anything."}], "answers": [{"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 4, "last_activity_date": 1474035656, "last_edit_date": 1474035656, "creation_date": 1474035205, "answer_id": 39533693, "question_id": 39530299, "link": "https://stackoverflow.com/questions/39530299/skip-blank-lines-with-parsec/39533693#39533693", "title": "Skip blank lines with Parsec", "body": "<p>Instead of using <code>newline</code>, you could define a custom parser that captures <em>your</em> notion of the end of a line, which would parse at least one <code>newline</code>, and then optionally many empty lines (i.e. whitespaces followed by another newline). You will need the <code>try</code> operator to backtrack if the whitespace is not followed by another newline (or the end of input, I guess):</p>\n\n<p>Code:</p>\n\n<pre><code>-- parse lines\np :: Parser [[String]]\np = lineP `endBy` lineEnd &lt;* eof\n  where lineP = wordP `sepBy` (char ' ')\n        wordP = many $ noneOf \" \\n\"\n\nlineEnd :: Parser ()\nlineEnd = do\n    newline\n    many (try (many (oneOf \" \\t\") &gt;&gt; newline))\n    return ()\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>*Main&gt; run p \"z x c\\n1 2 3\\n    \\na\\n\"\n[[\"z\",\"x\",\"c\"],[\"1\",\"2\",\"3\"],[\"a\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": false, "score": 4, "last_activity_date": 1474041884, "last_edit_date": 1474041884, "creation_date": 1474041339, "answer_id": 39535645, "question_id": 39530299, "link": "https://stackoverflow.com/questions/39530299/skip-blank-lines-with-parsec/39535645#39535645", "title": "Skip blank lines with Parsec", "body": "<p>One approach might be to think of a file as a series of lines that are either blank or non-blank. The following expresses this idea with the expression <code>line &lt;|&gt; emptyLine</code>. The following uses the <code>Maybe</code> datatype to distinguish between the result of parsing a non-blank line, using <code>catMaybes</code> to filter out the <code>Nothing</code>s at the end.</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n    --resolver lts-7.0\n    --install-ghc\n    runghc\n    --package parsec\n-}\n\nimport Prelude hiding (lines)\nimport Data.Maybe (catMaybes)\nimport Text.ParserCombinators.Parsec\n\n-- parse lines\np :: Parser [[String]]\np = catMaybes &lt;$&gt; lines\n  where lines = (line &lt;|&gt; emptyLine) `endBy` newline &lt;* eof\n        line = Just &lt;$&gt; word `sepBy1` spaces1\n        emptyLine = spaces1 &gt;&gt; pure Nothing\n        word = many1 $ noneOf ['\\n', ' ']\n        spaces1 = skipMany1 (char ' ')\n\nmain = parseTest p \"z x c\\n1 2 3\\n    \\na\\n\"\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>[[\"z\",\"x\",\"c\"],[\"1\",\"2\",\"3\"],[\"a\"]]\n</code></pre>\n\n<p>Another approach might be to use <code>Prelude</code> functions along with <code>Data.Char.isSpace</code> to collect the non-blank lines before you get started:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n    --resolver lts-7.0\n    --install-ghc\n    runghc\n    --package parsec\n-}\n\nimport Data.Char\nimport Text.ParserCombinators.Parsec\n\np :: Parser [[String]]\np = line `endBy` newline &lt;* eof where\n  line = word `sepBy1` spaces1\n  word = many1 $ noneOf ['\\n', ' ']\n  spaces1 = skipMany1 (char ' ')\n\nmain = parseTest p (unlines nonBlankLines)\n  where input = \"z x c\\n1 2 3\\n    \\na\\n\"\n        nonBlankLines = filter (not . all isSpace) $ lines input\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>[[\"z\",\"x\",\"c\"],[\"1\",\"2\",\"3\"],[\"a\"]]\n</code></pre>\n\n<p>This is pretty simple and has the additional benefit that using <code>lines</code> will not require a <code>newline</code> at the end of each line (this helps with portability).</p>\n\n<p>Note, there was a small bug with your <code>wordP</code> parser. Also note that, as specified, these parsers do not cope with preceding or trailing spaces (on non-blank lines). I'm imaging that your non-minimal code is more resilient.</p>\n"}], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1474041884, "creation_date": 1474025066, "question_id": 39530299, "link": "https://stackoverflow.com/questions/39530299/skip-blank-lines-with-parsec", "title": "Skip blank lines with Parsec", "body": "<p>New to Parsec, a beginner's question. How can one parse a file of lines where some lines may be blank, consisting only of whitespace followed by a newline? I just want to skip them, not have them in the parsed output.</p>\n\n<pre><code>import Text.ParserCombinators.Parsec\n\n-- alias for parseTest\nrun :: Show a =&gt; Parser a -&gt; String -&gt; IO ()\nrun = parseTest\n\n-- parse lines\np :: Parser [[String]]\np = lineP `endBy` newline &lt;* eof\n  where lineP = wordP `sepBy` (char ' ')\n        wordP = many $ noneOf \"\\n\"\n</code></pre>\n\n<p>Example parse with blank line:</p>\n\n<pre><code>*Main&gt; run p \"z x c\\n1 2 3\\n    \\na\\n\"\n[[\"z x c\"],[\"1 2 3\"],[\"    \"],[\"a\"]]\n</code></pre>\n\n<p>I suspect I am going about this all wrong.</p>\n"}, {"tags": ["haskell", "data-structures", "functional-programming", "big-o"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1474026633, "post_id": 39530111, "comment_id": 66375916, "body": "I don&#39;t understand &quot;the optimal O(n)&quot;. How can <code>inits</code> run in linear time?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1474026746, "post_id": 39530111, "comment_id": 66375976, "body": "Consuming <code>inits [1..n]</code> will always take <code>O(n&#178;)</code> since there are n&#178;/2 elements in the lists. You cannot do better."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474026829, "post_id": 39530111, "comment_id": 66376020, "body": "@Bergi There are only O(n) prefixes for a given list."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474026866, "post_id": 39530111, "comment_id": 66376045, "body": "@chepner but each of the prefix lists contains <code>O(n)</code> elements. Of course, if you just count prefixes (<code>length . inits</code>), <code>map x . scanl y z</code> will always run in <code>O(n)</code> regardless what <code>x</code>, <code>y</code> and <code>z</code> are because they&#39;re never evaluated."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1474028896, "post_id": 39530111, "comment_id": 66377282, "body": "Right; actually running <code>inits</code> doesn&#39;t require you to actually do that. The list of prefixes can be built in O(n) time, and the cost of building an individual prefix is combined with the cost to iterate over it."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1474034185, "post_id": 39530111, "comment_id": 66380829, "body": "Even worse, <code>inits</code> will always use O(n^2) memory if fully evaluated.  This is in contrast to <code>tails</code>, which will only use O(n) memory when fully evaluated.  This is just the nature of singly-linked immutable lists."}], "owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474026057, "creation_date": 1474024371, "last_edit_date": 1474026057, "question_id": 39530111, "link": "https://stackoverflow.com/questions/39530111/does-this-method-of-computing-all-possible-prefixes-of-a-list-run-in-on", "title": "Does this method of computing all possible prefixes of a list run in O(n)?", "body": "<p>Consider the following function from <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/src/Data.OldList.html#inits\" rel=\"nofollow\">Data.List</a> which computes all prefixes of a list in the following way:</p>\n\n<pre><code>inits :: [a] -&gt; [[a]]\ninits = map toListSB . scanl' snocSB emptySB\n</code></pre>\n\n<p>This relies on some data structure referred to as the snocBuilder, implemented as follows:</p>\n\n<pre><code>data SnocBuilder a = SnocBuilder {-# UNPACK #-} !Word [a] [a]\n\n{-# INLINE sb #-}\nsb :: Word -&gt; [a] -&gt; [a] -&gt; SnocBuilder a\nsb lp f r\n  | lp &lt; 255 || (lp .&amp;. (lp + 1)) /= 0 = SnocBuilder lp f r\n  | otherwise                          = SnocBuilder lp (f ++ reverse r) []\n\n-- The empty builder\n\nemptySB :: SnocBuilder a\nemptySB = SnocBuilder 0 [] []\n\n-- Add an element to the end of a queue.\n\nsnocSB :: SnocBuilder a -&gt; a -&gt; SnocBuilder a\nsnocSB (SnocBuilder lp f r) x = sb (lp + 1) f (x:r)\n\n-- Convert a builder to a list\n\ntoListSB :: SnocBuilder a -&gt; [a]\ntoListSB (SnocBuilder _ f r) = f ++ reverse r\n</code></pre>\n\n<p>The comment above this snippet reads like this:</p>\n\n<pre><code>{- A \"SnocBuilder\" is a version of Chris Okasaki's banker's queue that supports\ntoListSB instead of uncons. In single-threaded use, its performance\ncharacteristics are similar to John Hughes's functional difference lists, but\nlikely somewhat worse. In heavily persistent settings, however, it does much\nbetter, because it takes advantage of sharing. The banker's queue guarantees\n(amortized) O(1) snoc and O(1) uncons, meaning that we can think of toListSB as\nan O(1) conversion to a list-like structure a constant factor slower than\nnormal lists--we pay the O(n) cost incrementally as we consume the list. Using\nfunctional difference lists, on the other hand, we would have to pay the whole\ncost up front for each output list. -}\n</code></pre>\n\n<p>But as I understand this, although <code>snocSB</code> runs in O(1) amortised, <code>toListSB</code> runs in O(n). This is because the right list has to be reversed anyway.</p>\n\n<p>This should mean that the <code>inits</code> function takes O(n^2) time as opposed to the optimal O(n). Is this correct? What is a better way to implement inits?</p>\n"}, {"tags": ["haskell", "data-structures", "functional-programming", "deque", "amortized-analysis"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474019888, "post_id": 39528308, "comment_id": 66371929, "body": "If it increases larger and larger, that means reversing (which would be costly to do every time) is becoming rarer and rarer."}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474021154, "post_id": 39528308, "comment_id": 66372772, "body": "@Bergi but, I would have to reverse the right list every time I want to <code>toListSB</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474021318, "post_id": 39528308, "comment_id": 66372891, "body": "Yes, <code>toListSB</code> is not <code>O(1)</code>, it&#39;s <code>O(n)</code>. But calling <code>snocSB</code> n times is only <code>O(n)</code> not <code>O(n&#178;)</code>"}, {"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474022023, "post_id": 39528308, "comment_id": 66373299, "body": "@Bergi but the comment states, <i>we can think of toListSB as an O(1) conversion</i>. Are they wrong, here?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1474022931, "post_id": 39528308, "comment_id": 66373844, "body": "Ah, I didn&#39;t pay attention. Yeah, in Haskell everything is <code>O(0)</code> until it gets consumed :-) Converting to and consuming the list takes <code>O(n)</code> together."}, {"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1474057637, "post_id": 39528308, "comment_id": 66393193, "body": "So the cost is O(N) every N calls so we pay 1/N O(N) each call."}], "answers": [{"comments": [{"owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "edited": false, "score": 0, "creation_date": 1474021545, "post_id": 39528505, "comment_id": 66373023, "body": "This seems to be the analysis of <code>snocSB</code>, I was looking for the time complexity of <code>toListSB</code>"}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1474037728, "post_id": 39528505, "comment_id": 66383215, "body": "<code>toListSB</code> is certainly O(n).  The comment you quoted explains that n <code>snocSB</code> operations followed by a <code>toListSB</code> as a whole requires O(n) work.    It&#39;s curious that the comments talk about an uncons operation but the <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/Data-OldList.html\" rel=\"nofollow noreferrer\">code</a> doesn&#39;t have one."}], "tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 1, "last_activity_date": 1474019472, "creation_date": 1474019472, "answer_id": 39528505, "question_id": 39528308, "link": "https://stackoverflow.com/questions/39528308/how-does-the-following-functional-implementation-of-a-deque-support-extraction-i/39528505#39528505", "title": "How does the following functional implementation of a deque support extraction in amortised constant-time?", "body": "<p>If current length of list is <code>N=2^M</code>, then there were M operations of doubling. The first doubling takes 1 time unit, the second 0 2 time units, the third - 4 and so on. But it is known (geometric progression sum formula) that</p>\n\n<pre><code>1 + 2 + 4 + 8 + ...+2^M = 2^(M+1) - 1 = O(N)\n</code></pre>\n\n<p>So amortized cost per one operation is <code>O(N)/N = O(1)</code></p>\n"}], "owner": {"reputation": 1818, "user_id": 1955231, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/100002848311925/picture?type=large", "display_name": "Agnishom Chattopadhyay", "link": "https://stackoverflow.com/users/1955231/agnishom-chattopadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474041599, "creation_date": 1474018900, "last_edit_date": 1474041599, "question_id": 39528308, "link": "https://stackoverflow.com/questions/39528308/how-does-the-following-functional-implementation-of-a-deque-support-extraction-i", "title": "How does the following functional implementation of a deque support extraction in amortised constant-time?", "body": "<p>In <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/src/Data.OldList.html#emptySB\" rel=\"nofollow\">Data.List</a> module, the following data structure is used</p>\n\n<pre><code>{- We store a front list, a rear list, and the length of the queue.  Because we\nonly snoc onto the queue and never uncons, we know it's time to rotate when the\nlength of the queue plus 1 is a power of 2. Note that we rely on the value of\nthe length field only for performance.  In the unlikely event of overflow, the\nperformance will suffer but the semantics will remain correct.  -}\n\ndata SnocBuilder a = SnocBuilder {-# UNPACK #-} !Word [a] [a]\n\n{- Smart constructor that rotates the builder when lp is one minus a power of\n2. Does not rotate very small builders because doing so is not worth the\ntrouble. The lp &lt; 255 test goes first because the power-of-2 test gives awful\nbranch prediction for very small n (there are 5 powers of 2 between 1 and\n16). Putting the well-predicted lp &lt; 255 test first avoids branching on the\npower-of-2 test until powers of 2 have become sufficiently rare to be predicted\nwell. -}\n\n{-# INLINE sb #-}\nsb :: Word -&gt; [a] -&gt; [a] -&gt; SnocBuilder a\nsb lp f r\n  | lp &lt; 255 || (lp .&amp;. (lp + 1)) /= 0 = SnocBuilder lp f r\n  | otherwise                          = SnocBuilder lp (f ++ reverse r) []\n\n-- The empty builder\n\nemptySB :: SnocBuilder a\nemptySB = SnocBuilder 0 [] []\n\n-- Add an element to the end of a queue.\n\nsnocSB :: SnocBuilder a -&gt; a -&gt; SnocBuilder a\nsnocSB (SnocBuilder lp f r) x = sb (lp + 1) f (x:r)\n\n-- Convert a builder to a list\n\ntoListSB :: SnocBuilder a -&gt; [a]\ntoListSB (SnocBuilder _ f r) = f ++ reverse r\n</code></pre>\n\n<p>A comment above the snippet mentions goes as follows:</p>\n\n<blockquote>\n  <p>The queue guarantees (amortized) O(1) <code>snoc</code> and O(1) <code>uncons</code>,\n  meaning that we can think of <code>toListSB</code> as an O(1) conversion to a\n  list-like structure a constant factor slower than normal lists--we pay\n  the O(n) cost incrementally as we consume the list.</p>\n</blockquote>\n\n<p>I do not understand why <code>toListSB</code> is working in O(1) amortised. Isn't the length of the right list increasing larger and larger between consecutive powers of 2?</p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "answers": [{"comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1474098268, "post_id": 39542967, "comment_id": 66401246, "body": "The main reason is to serve APIs from <code>&#47;api&#47;...</code> URL. Is there a better way of doing this?"}, {"owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "reply_to_user": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 1, "creation_date": 1474696794, "post_id": 39542967, "comment_id": 66647005, "body": "<code>dir &quot;api&quot; apiHandler</code>  (<a href=\"http://hackage.haskell.org/package/snap-core-1.0.0.0/docs/Snap-Core.html#v:dir\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/snap-core-1.0.0.0/docs/&hellip;</a>)"}, {"owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "reply_to_user": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 1, "creation_date": 1474696882, "post_id": 39542967, "comment_id": 66647025, "body": "Or, with the <a href=\"http://hackage.haskell.org/package/snap-core-1.0.0.0/docs/Snap-Core.html#v:route\" rel=\"nofollow noreferrer\">route function</a>...<code>route [(&quot;api&quot;, apiHandler), ...other routes here...]</code>"}], "tags": [], "owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "is_accepted": false, "score": 0, "last_activity_date": 1474087898, "creation_date": 1474087898, "answer_id": 39542967, "question_id": 39527156, "link": "https://stackoverflow.com/questions/39527156/how-to-query-a-database-from-a-snaplet/39542967#39542967", "title": "How to query a database from a snaplet", "body": "<p>Why are you creating this <code>Api</code> snaplet?  Are you reusing the things in <code>Api</code> across two or more web apps?  If not, I would recommend not using a snaplet.  Then everything will work perfectly.  <code>Handler App App</code> will have a <code>HasPostgres</code> instance and you can go on your merry way.</p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474087898, "creation_date": 1474015300, "question_id": 39527156, "link": "https://stackoverflow.com/questions/39527156/how-to-query-a-database-from-a-snaplet", "title": "How to query a database from a snaplet", "body": "<p>My application is defined as:</p>\n\n<pre><code>data App = App { _api :: Snaplet Api, _db :: Snaplet Postgres }\n\nmakeLenses ''App\n\ninstance HasPostgres (Handler b App) where\n    getPostgresState = with db get\n    setLocalPostgresState s = local (set (db . snapletValue) s)\n</code></pre>\n\n<p>where <code>_api</code> is a snaplet I am creating. It is defined as:</p>\n\n<pre><code>data Api = Api\n</code></pre>\n\n<p>I would now like to use <code>query_</code> function inside the <code>Api</code> snaplet. The only way I can do so is to define <code>Api</code> as <code>data Api = Api { _db :: Snaplet Postgres }</code>, but it seems that this will initialise postgres snaplet twice, which I don't think is right. I'm not sure how to get <code>_db</code> from the 'parent' <code>App</code> either.</p>\n\n<p>Am I on the right path here? What's the correct way to access the database in the <code>Api</code> snaplet?</p>\n"}, {"tags": ["haskell", "type-conversion"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1473987320, "post_id": 39522041, "comment_id": 66360373, "body": "<code>myFunction</code> already doesn&#39;t compile, because the type <code>s</code> is not mentioned (as you have pointed out) in the type of the function, so <code>Ctx s</code> arising from <code>fancyFunction</code> results in an ambiguous type error (even <code>fancyFunction . undefined</code> gives such an error). In any case it sees you want a function <code>(Functor f, Coercible a b) =&gt; f a -&gt; f b</code> which is operationally the identity, in which case you may be interested in <a href=\"https://hackage.haskell.org/package/profunctors-5.2/docs/Data-Profunctor-Unsafe.html#v:-35-.\" rel=\"nofollow noreferrer\">profunctors</a> - this uses &#39;unsafe&#39; operations in general but as GHC will tell you.."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1473987391, "post_id": 39522041, "comment_id": 66360383, "body": "&quot;NB: We cannot know what roles the parameters to `f&#39; have; we must assume that the role is nominal &quot; if you fix the unrelated ambiguous type error (by e.g. removing the <code>Ctx s</code> constraint). There is no way to talk about the role of a type variable - this is a known limitation."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1473987622, "post_id": 39522041, "comment_id": 66360432, "body": "I&#39;m pretty sure there is no way around this. The problem is that what you want to do can or cannot be done depending on the role of whatever <code>f</code> is. <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9123\" rel=\"nofollow noreferrer\">This</a> ticket goes into more detail. <a href=\"https://github.com/ekmett/roles/blob/master/src/Data/Roles.hs\" rel=\"nofollow noreferrer\">Here</a> is one of Edward Kmett&#39;s alternative approaches."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1473993232, "last_edit_date": 1473993232, "creation_date": 1473992792, "answer_id": 39522913, "question_id": 39522041, "link": "https://stackoverflow.com/questions/39522041/how-to-coerce-functors-applied-to-coercible-arguments/39522913#39522913", "title": "How to coerce functors applied to coercible arguments", "body": "<p>Unfortunately, <code>Coercible (f a) (f (Decorated s a))</code> really what you want in your constraint given the current state of GHC. Now, the fact that <code>s</code> and <code>a</code> don't show up elsewhere is not something good - it means GHC won't know what to do with them (they are ambiguous)! I won't get into that...</p>\n\n<hr>\n\n<p>Depending on the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#roles\" rel=\"noreferrer\">role</a> of the type parameter fed to the type constructor <code>f</code>, <code>Coercible a b</code> may or may not imply <code>Coercible (f a) (f b)</code>. In this case, we'd want that role to be nominal - but there isn't (yet at least) a way to express this in a constraint. To explain what I mean, consider the following two data definitions:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nimport Data.Coerce\n\n-- type role of `a` is \"representational\"\ndata Data1 a = Data1 a\n\n-- type role of `a` is \"nominal\"\ndata Data2 a = Data2 (TypeFunction a)\ntype family TypeFunction x where\n  TypeFunction Bool = Char\n  TypeFunction _ = ()\n</code></pre>\n\n<p>Then, while it is true that <code>Coercible a b</code> entails <code>Coercible (Data1 a) (Data1 b)</code>, it does <em>not</em> entail <code>Coercible (Data2 a) (Data2 b)</code>. To make this concrete, load up the above in GHCi, then try:</p>\n\n<pre><code>ghci&gt; newtype MyInt = My Int\nghci&gt; let c1 = coerce :: (Data1 MyInt) -&gt; (Data1 Int)\nghci&gt; let c2 = coerce :: (Data2 MyInt) -&gt; (Data2 Int) -- This doesn't work! \n</code></pre>\n\n<p>Unfortunately, there is no built-in constraint based way of enforcing that the role of a type variable is representational. You can make your own classes for this, as Edward Kmett <a href=\"https://github.com/ekmett/roles\" rel=\"noreferrer\">has done</a>, but GHC doesn't automatically create instances of some of these classes the way class instances for <code>Coercible</code> are.</p>\n\n<p>This led to <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9123\" rel=\"noreferrer\">this</a> trac ticket where they discuss the possibility of having a class <code>Representational f</code> with instances generated like for <code>Coercible</code> which could have things like</p>\n\n<pre><code>instance (Representational f, Coercible a b) =&gt; Coercible (f a) (f b)\n</code></pre>\n\n<p>If this was actually a thing today, all you would need in your constraint would be <code>Representational f</code>. Furthermore, as Richard Eisenberg observes on the ticket, we really ought to be able to figure out that <code>a</code> in <code>f a</code> has a representational role for any reasonable functor <code>f</code>. Then, we might not even need any constraint on top of <code>Functor f</code> as <code>Representational</code> could be a superclass of <code>Functor</code>.</p>\n\n<p><a href=\"https://ghc.haskell.org/trac/ghc/wiki/Roles2#join\" rel=\"noreferrer\">Here is a good discussion of the current limitations of roles.</a></p>\n"}, {"tags": [], "owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "is_accepted": false, "score": 3, "last_activity_date": 1562976284, "last_edit_date": 1562976284, "creation_date": 1562276329, "answer_id": 56894434, "question_id": 39522041, "link": "https://stackoverflow.com/questions/39522041/how-to-coerce-functors-applied-to-coercible-arguments/56894434#56894434", "title": "How to coerce functors applied to coercible arguments", "body": "<p>Now that you have <code>QuantifiedConstraints</code>, I think you can do this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Parametric f = (forall a b. (Coercible a b =&gt; Coercible (f a) (f b)) :: Constraint)\n\nnewtype Foo = Foo Int\n\nmyFunction :: (Parametric f) =&gt; f Foo -&gt; f Int\nmyFunction = coerce\n\ntest :: [Int]\ntest = myFunction [Foo 1, Foo 2, Foo 3]\n</code></pre>\n\n<p>This is nice, because an instance of <code>Parametric f</code> witnesses that <code>f</code> is an endofunctor on a category where the objects are types and a morphism between types <code>A</code> and <code>B</code> is an instance of <code>Coercible A B</code>.</p>\n"}], "owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 39522913, "answer_count": 2, "score": 4, "last_activity_date": 1562976284, "creation_date": 1473984260, "question_id": 39522041, "link": "https://stackoverflow.com/questions/39522041/how-to-coerce-functors-applied-to-coercible-arguments", "title": "How to coerce functors applied to coercible arguments", "body": "<p>Consider the following Haskell code:</p>\n\n<pre><code>import Data.Coerce\n\nnewtype Decorated s a = Decorated a\n\nfancyFunction :: Ctx s =&gt; f (Decorated s a) -&gt; r\nfancyFunction = ...\n\ninstance Ctx s =&gt; SomeClass (Decorated s a)\n\nmyFunction :: Functor f =&gt; f a -&gt; r\nmyFunction = fancyFunction . fmap coerce\n</code></pre>\n\n<p>I'd like to make <code>myFunction</code> faster by replacing <code>fmap coerce</code> with <code>coerce</code>. The rationale is that <code>coerce</code> behaves like <code>id</code> and one of the functor laws is <code>fmap id = id</code>.</p>\n\n<p>The only way I can see of doing this is to add <code>Coercible (f a) (f (Decorated s a))</code> to the context but it refers to s which is not referred to anywhere else. Even worse, if <code>a</code> is bound in a universal type, I cannot express the constraint. Is there a constraint I could express in terms of <code>f</code> only to let me use <code>coerce</code> to convert between <code>f a</code> and <code>f (Decorated s a)</code>? </p>\n\n<p>Is this something that the compiler figures out on its own from the fact that <code>f</code> is a functor? If so, does it also work with bifunctors, traversables and bitraverables?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1473985505, "post_id": 39521946, "comment_id": 66359969, "body": "<code>(++)</code> is a prelude function."}], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 1554137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb537e77e97db2071395a0b2a4c8a593?s=128&d=identicon&r=PG", "display_name": "Alexander VoidEx Ruchkin", "link": "https://stackoverflow.com/users/1554137/alexander-voidex-ruchkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1473984397, "last_edit_date": 1473984397, "creation_date": 1473983863, "answer_id": 39521990, "question_id": 39521946, "link": "https://stackoverflow.com/questions/39521946/implement-a-function-like-concat-in-haskell-without-using-any-prelude-functions/39521990#39521990", "title": "Implement a function like concat in Haskell without using any prelude functions", "body": "<p>You are using incorrect patterns.\n<code>[smth]</code> matches list with one element, in your case:</p>\n\n<p><code>[[]]</code> - is list with one empty list\n<code>[(x:xs)]</code> - is list with one element - list <code>(x:xs)</code>, which is not empty</p>\n\n<p>So both cases matches single-element list. That's why function fails on <code>[[3], [5]]</code></p>\n\n<p>Obviously, you may wanted other two cases: empty (<code>[]</code>) and not empty list (<code>(x:xs)</code>)</p>\n\n<pre><code>flatten :: [[a]] -&gt; [a]\nflatten [] = []\nflatten (x:xs) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 9, "last_activity_date": 1473988023, "creation_date": 1473988023, "answer_id": 39522445, "question_id": 39521946, "link": "https://stackoverflow.com/questions/39521946/implement-a-function-like-concat-in-haskell-without-using-any-prelude-functions/39522445#39522445", "title": "Implement a function like concat in Haskell without using any prelude functions", "body": "<p>There are two fundamental patterns to consider when processing a list. Any list must be either:</p>\n\n<ul>\n<li>the empty list (<code>[]</code>)</li>\n<li>a cons cell (<code>_:_</code>)</li>\n</ul>\n\n<p>Since concat acts upon a list-of-lists, we can break that second case down into two cases by pattern matching on the first element of the list, which must be either</p>\n\n<ul>\n<li>the empty list (<code>[]:_</code>)</li>\n<li>a cons cell (<code>(_:_):_</code>)<sup>1</sup></li>\n</ul>\n\n<p>Which gives us three patterns all together:</p>\n\n<pre><code>concat [] = ...\nconcat ([]:xss) = ...\nconcat ((x:xs):xss) = ...\n</code></pre>\n\n<p>See how <em>every</em> list-of-lists <strong>must</strong> match <em>exactly one</em> of those patterns?</p>\n\n<p>Now, given that breakdown, see if you can implement <code>concat</code> only using <code>x</code>, <code>xs</code>, <code>xss</code>, <code>:</code>, <code>[]</code>, and <code>concat</code> itself.</p>\n\n<hr>\n\n<ol>\n<li><em>note that <code>(_:_):_</code> is a different pattern from <code>_:_:_</code>, which is more explictly written <code>_:(_:_)</code>. The former is a pattern for a non-empty list at the head of a list of lists. The latter is a pattern for a list of at least two elements.</em></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 8419, "user_id": 2702781, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e6776aa6608f9af0115c241d84a05a6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nyavro", "link": "https://stackoverflow.com/users/2702781/nyavro"}, "is_accepted": false, "score": 2, "last_activity_date": 1474006558, "creation_date": 1474006558, "answer_id": 39524850, "question_id": 39521946, "link": "https://stackoverflow.com/questions/39521946/implement-a-function-like-concat-in-haskell-without-using-any-prelude-functions/39524850#39524850", "title": "Implement a function like concat in Haskell without using any prelude functions", "body": "<p>Possible solution:</p>\n\n<pre><code>flatten [] = []\nflatten ([]:vs) = flatten vs\nflatten ((x:xs):vs) = x:flatten (xs:vs)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6745378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703ea0e8fadaa18d03fad4ebb37b02c0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben mckenzie", "link": "https://stackoverflow.com/users/6745378/ben-mckenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5685, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1474006558, "creation_date": 1473983519, "question_id": 39521946, "link": "https://stackoverflow.com/questions/39521946/implement-a-function-like-concat-in-haskell-without-using-any-prelude-functions", "title": "Implement a function like concat in Haskell without using any prelude functions", "body": "<p>Im trying to implement a function that can flatten a list of lists. only one layer deep. so if I called <code>flatten [[3],[3, 5]]</code> I would get [3,3,5]. this is my code:</p>\n\n<pre><code>flatten :: [[a]] -&gt; [a]\nflatten [[]] = []\nflatten [(x:xs)] = \n flatten [xs] ++ [x]\n</code></pre>\n\n<p>I am getting an error \"non exhaustive patterns in function flatten\" when I call <code>flatten [[3], [5]]</code></p>\n"}, {"tags": ["haskell", "data-structures", "patricia-trie"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 9, "creation_date": 1473973950, "post_id": 39520359, "comment_id": 66356587, "body": "While this is interesting, I think you should expand on the question. Currently it&#39;s too reliant on external links, SO questions and answers should be mostly self contained."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1474294326, "post_id": 39520359, "comment_id": 66460382, "body": "@Cubic, I think I fixed it."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 3, "creation_date": 1474558860, "post_id": 39520359, "comment_id": 66590155, "body": "Perhaps it would be helpful if you copy into the question the &quot;easy&quot; union/intersection code for the case where you&#39;ve got repeated bounds info, so we can try to modify it to work on the harder case."}], "answers": [{"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 2, "last_activity_date": 1490822270, "creation_date": 1490822270, "answer_id": 43104328, "question_id": 39520359, "link": "https://stackoverflow.com/questions/39520359/is-there-some-way-to-reduce-the-pain-of-range-tracking/43104328#43104328", "title": "Is there some way to reduce the pain of range tracking?", "body": "<blockquote>\n  <p>Is there some abstraction that would allow this to be done automatically?</p>\n</blockquote>\n\n<p>You should be able to define a set of pattern synonyms that give you that. I\u2019ll start from the second-to-last variant of your code, i.e.:</p>\n\n<pre><code>data IntMap1 a = Empty | NonEmpty { topLo :: !Int, child :: !(IntMapNE1 a) }\ndata IntMapNE1 a =\n    Tip a\n  | IntMapNE1 { bound :: !Int\n              , left :: !(IntMapNE1 a)\n              , right :: !(IntMapNE1 a)\n</code></pre>\n\n<p>We tuple such a value with the bound from the parent in an <code>Either</code> (indicating whether it is a low or a high bound).</p>\n\n<pre><code>viewLoHi (Left lo, IntMapNE1 hi left right)\n    = Just (lo, hi, (Left lo, left), (Right hi, right)\nviewLoHi (Right hi, IntMapNE1 lo left right)\n    = Just (lo, hi, (Left lo, left), (Right hi, right)\nviewLoHi _\n    = Nothing\n\npattern Bin' lo hi left right &lt;- (viewLoHi -&gt; Just (lo, hi, left, right))\n</code></pre>\n\n<p>The top-level data type is different, so it needs its own pattern synonym</p>\n\n<pre><code>viewLoHi' (NonEmpty lo child) = viewLoHi (Left lo, child)\nviewLoHi' Empty = Nothing\n\npattern NonEmpty' lo hi left right &lt;- (viewLoHi' -&gt; Just (lo, hi, left, right)\n</code></pre>\n\n<p>Using only <code>NonEmpty'</code> and <code>Bin'</code> as you traverse the tree, the bookkeeping should now be completely hidden. (Code not tested, so there will be typos here)</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 4, "answer_count": 1, "score": 19, "last_activity_date": 1490822270, "creation_date": 1473973566, "last_edit_date": 1474307376, "question_id": 39520359, "link": "https://stackoverflow.com/questions/39520359/is-there-some-way-to-reduce-the-pain-of-range-tracking", "title": "Is there some way to reduce the pain of range tracking?", "body": "<p>There's currently a <a href=\"https://github.com/haskell/containers/pull/340\">pull request</a> by Jonathan S. to replace the implementation of <code>Data.IntMap</code> with one explained in <a href=\"https://github.com/gereeter/bounded-intmap/blob/master/README.md\">this README</a> based on ideas from a <a href=\"https://www.fpcomplete.com/user/edwardk/revisiting-matrix-multiplication/part-4\">blog post</a> by Edward Kmett.</p>\n\n<p>The basic concept Jonathan S. developed from is that an <code>IntMap</code> is a binary tree that looks like this (I've made some slight changes to his development for the sake of consistency):</p>\n\n<pre><code>data IntMap0 a = Empty | NonEmpty (IntMapNE0 a) \ndata IntMapNE0 a =\n    Tip !Int a\n  | Bin { lo :: !Int\n        , hi :: !Int\n        , left :: !(IntMapNE0 a)\n        , right :: !(IntMapNE0 a) }\n</code></pre>\n\n<p>In this representation, each node has a field indicating the least and greatest key contained in the <code>IntMapNE0</code>. Using just a little bit fiddling allows this to be used as a PATRICIA trie. Jonathan noted that this structure has almost twice as much range information as it needs. Following a left or right spine will produce all the same <code>lo</code> or <code>hi</code> bounds. So he cut those out by only including the bound not determined by the ancestors:</p>\n\n<pre><code>data IntMap1 a = Empty | NonEmpty { topLo :: !Int, child :: !(IntMapNE1 a) }\ndata IntMapNE1 a =\n    Tip a\n  | IntMapNE1 { bound :: !Int\n              , left :: !(IntMapNE1 a)\n              , right :: !(IntMapNE1 a)\n</code></pre>\n\n<p>Now each node has either a left bound or a right bound, but not both. A right child will have only a left bound, while a left child will have only a right bound.</p>\n\n<p>Jonathan makes one further change, moving the values out of the leaves and into the internal nodes, which places them exactly where they are determined. He also uses phantom types to help track left and right. The final type (for now, anyway) is</p>\n\n<pre><code>data L\ndata R\nnewtype IntMap a = IntMap (IntMap_ L a) deriving (Eq)\ndata IntMap_ t a = NonEmpty !Int a !(Node t a) | Empty deriving (Eq)\ndata Node t a = Bin !Int a !(Node L a) !(Node R a) | Tip deriving (Eq, Show)\n</code></pre>\n\n<p>Certain aspects of this new implementation are quite attractive. Most importantly, many of the most-used operations are substantially faster. Less importantly, but very nicely, the bit fiddling involved is much easier to understand.</p>\n\n<p>However, there is one serious pain point: passing the missing range information down through the tree. This isn't so bad for lookups, insertions, etc., but gets pretty seriously hairy in the union and intersection code. Is there some abstraction that would allow this to be done automatically?</p>\n\n<p>A couple extremely vague thoughts:</p>\n\n<ol>\n<li><p>Could the phantom types be used with a custom class to tie treatment directly to handedness?</p></li>\n<li><p>The \"missing piece\" nature is somewhat reminiscent of some zippery situations. Might there be a way to use ideas from that realm?</p></li>\n</ol>\n\n<hr>\n\n<p>I've started thinking about using an intermediate type of some sort to provide a symmetrical \"view\" of the structure, but I'm a bit stuck. I can fairly easily convert back and forth between the basic structure and the fancy one, but that conversion is recursive. I need a way to convert only partially, but I don't know nearly enough about fancily built types to get it done.</p>\n"}, {"tags": ["haskell", "ghc", "typeclass"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1473972032, "post_id": 39519977, "comment_id": 66355671, "body": "It can&#39;t.  If I call <code>elm :: Int</code> there is no way to know if it should use the <code>instance Test Int Int</code> vs <code>instance Test () Int</code> vs <code>instance Test FooType Int</code> vs anything else.  Perhaps you should go up a level of abstraction and ask about the problem that led you down this road."}, {"owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1473973125, "post_id": 39519977, "comment_id": 66356212, "body": "That is a bad news... <code>elm</code> was supposed to provide a special element of only one of both types. E.g. <code>instance Test a Int where elm = 0</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "edited": false, "score": 0, "creation_date": 1473973558, "post_id": 39520260, "comment_id": 66356418, "body": "Thank you very much! Yes, factoring out sound very good - I will tried for my real example (a typeclass for a vector space of some field)!  (Actually, I though about using the FunctionalDependencies, but this is indeed not want I really want!)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1506553651, "last_edit_date": 1506553651, "creation_date": 1473973104, "answer_id": 39520260, "question_id": 39519977, "link": "https://stackoverflow.com/questions/39519977/how-to-make-a-tuple-with-components-belonging-to-a-type-class-an-instance-ii/39520260#39520260", "title": "How to make a tuple with components belonging to a type class an instance II", "body": "<p>This has nothing whatsoever to do with tuples. The problem is simply that <code>x</code> occurs in the class head, but not the signature of <code>elm</code> \u2013 so there's no way to determine what to use as the <code>x</code> type, when <code>elm</code> turns up somewhere in your code.</p>\n\n<p>Indeed, if <code>elm</code> is the only method of <code>Test</code>, then there's no need to have that <code>x</code> parameter at all \u2013 simply remove it, and your instance will be fine:</p>\n\n<pre><code>class Test a where\n  elm :: a\ninstance (Test a, Test b) =&gt; Test (a,b) where\n  elm = (elm, elm)\n</code></pre>\n\n<p>More likely, you actually have some other method that does use <code>x</code>, like</p>\n\n<pre><code>class Test x a where\n  elm :: a\n  beech :: x -&gt; a\n</code></pre>\n\n<p>In this case, it might make sense to factor out <code>elm</code> into a simpler superclass:</p>\n\n<pre><code>class PreTest a where\n  elm :: a\nclass (PreTest a) =&gt; Test x a where\n  beech :: x -&gt; a\n</code></pre>\n\n<p>Alternatively, you can obtain the <code>x</code> information in some other way, not through the method's signature. This can be done with a fundep:</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies #-}\nclass Test x a | a-&gt;x where\n  elm :: a\n</code></pre>\n\n<p>This indicates that there can only be exactly one <code>Test _ a</code> instance for any type <code>a</code>, hence the compiler can unambiguously infer <code>x</code> from it.</p>\n\n<p>But I heavily suspect that you don't really want that \u2013 such a class is much less flexible than a full two-parameter class. Modern Haskell tends to favour the largely equivalent associated type synonyms over fundep MultiParamTypeClasses, and mostly uses MTPCs when <code>x</code> and <code>a</code> are really two independent parameters.</p>\n"}], "owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 39520260, "answer_count": 1, "score": 0, "last_activity_date": 1506553651, "creation_date": 1473971889, "question_id": 39519977, "link": "https://stackoverflow.com/questions/39519977/how-to-make-a-tuple-with-components-belonging-to-a-type-class-an-instance-ii", "title": "How to make a tuple with components belonging to a type class an instance II", "body": "<p>This is modification of a question a just ask some minutes ago - but for this situation I got problems...</p>\n\n<p>I have the following problem: I defined a type class and want to declare tuples of types of this class to be instances as well. But I don't know how to get GHC to accept this declaration. Here a very simple example:</p>\n\n<pre><code>class Test x a where\n    elm :: a\n</code></pre>\n\n<p>And know for tuples I want to do something like</p>\n\n<pre><code>instance (Test x a, Test x b) =&gt; Test x (a,b) where\n    elm = (elm, elm)\n</code></pre>\n\n<p>Moreover, I am using</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses      #-}\n{-# LANGUAGE FlexibleInstances          #-}\n</code></pre>\n\n<p>The addition type <code>x</code> causes the trouble here...\nHow can this been done?  Thanks in advance for any suggestions!</p>\n"}, {"tags": ["haskell", "ghc", "typeclass"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1473970926, "post_id": 39519619, "comment_id": 66355120, "body": "Delete <code>:: (a, b)</code>."}, {"owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1473971139, "post_id": 39519619, "comment_id": 66355229, "body": "Thanks! It works! I though a had been trying it first without the type annotation..."}], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "edited": false, "score": 0, "creation_date": 1473971144, "post_id": 39519738, "comment_id": 66355231, "body": "Thanks! It works! I though a had been trying it first without the type annotation..."}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": true, "score": 8, "last_activity_date": 1474015161, "last_edit_date": 1474015161, "creation_date": 1473971019, "answer_id": 39519738, "question_id": 39519619, "link": "https://stackoverflow.com/questions/39519619/how-to-make-a-tuple-with-components-belonging-to-a-type-class-an-instance/39519738#39519738", "title": "How to make a tuple with components belonging to a type class an instance", "body": "<p>Try this instead:</p>\n\n<pre><code>instance (Test a, Test b) =&gt; Test (a,b) where\n    elm = (elm, elm)\n</code></pre>\n\n<p>This should work. The issue with you code, is that the <code>:: (a,b)</code> type annotation that you added is actually confusing GHC instead of helping it. The problem is that when GHC sees <code>a</code> and <code>b</code> it thinks that they represent some arbitrary types. But you don't want them to be arbitrary, you want them to be exact same types referenced in the above line. But GHC doesn't know that. If you leave the type annotation out, GHC will figure the correct types itself. Alternatively, you can change GHC's behavior by enabling the <code>ScopedTypeVariables</code> language extension, by adding the following at the top of your file:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n</code></pre>\n\n<p>This will tell GHC that whenever there is a <code>class</code> definition, the type variables referenced at the top line, will be in scope for the rest of the definition. I am one of those people who think that <code>ScopedTypeVariables</code> should have been on by default but unfortunately this is not the case, mostly for historical &amp; compatibility reasons. In fact, this question provides a good argument why <code>ScopedTypeVariables</code> being off by default is counterintuitive.</p>\n"}], "owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 39519738, "answer_count": 1, "score": 1, "last_activity_date": 1474015161, "creation_date": 1473970490, "last_edit_date": 1473970881, "question_id": 39519619, "link": "https://stackoverflow.com/questions/39519619/how-to-make-a-tuple-with-components-belonging-to-a-type-class-an-instance", "title": "How to make a tuple with components belonging to a type class an instance", "body": "<p>I have the following problem: I defined a type class and want to declare tuples of types of this class to be instances as well. But I don't know how to get GHC to accept this declaration. Here a very simple example:</p>\n\n<pre><code>class Test a where\n    elm :: a\n</code></pre>\n\n<p>And know for tuples I want to do something like</p>\n\n<pre><code>instance (Test a, Test b) =&gt; Test (a,b) where\n    elm = (elm, elm) :: (a,b)\n</code></pre>\n\n<p>(Actually, I want to do something similar for more fancy type classes corresponding to vector spaces.)</p>\n\n<p>How can this been done? Thanks in advance for any suggestions!</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 0, "creation_date": 1473971373, "post_id": 39519436, "comment_id": 66355342, "body": "If they are oprional, then they have default implementation. You can implement them if you want it."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 5, "creation_date": 1473973548, "post_id": 39519436, "comment_id": 66356413, "body": "This is actually quite straightforward: if you think you can write the other functions in ways that are much more efficient than their default implementations in terms of <code>foldr</code>, feel free to do so."}, {"owner": {"reputation": 781, "user_id": 1163717, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cbba7289a669e4ca1fcf1064d0cf22fd?s=128&d=identicon&r=PG&f=1", "display_name": "The Red Fox", "link": "https://stackoverflow.com/users/1163717/the-red-fox"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1474036373, "post_id": 39519436, "comment_id": 66382324, "body": "@Alec That&#39;s simple to say, but it can be quite hard to tell if my function is actually better than the default implementation, since how a certain function behaves under different kinds of arguments. E.g. strict vs lazy values, functions vs non-functions, infinite vs finite values. So it seems like it would require a lot of time to figure that out, which seems like a lot of work just for deciding if it&#39;s worth implementing my own version."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1474036757, "post_id": 39519436, "comment_id": 66382571, "body": "If you look unfavorably on this analysis, it probably means that implementing more than the default <code>foldr</code> would be a premature optimization."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1473973500, "post_id": 39520291, "comment_id": 66356390, "body": "This is a good explanation as to why one might want to add more functions with default implementations to typeclasses, but OP is asking about whether to implement functions in an existing typeclass with default implementations."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1473982517, "post_id": 39520291, "comment_id": 66359315, "body": "I wasn&#39;t as explicit as I could have been; this is an example of where you should (and I don&#39;t know why the <code>Product</code> instance doesn&#39;t<code>) provide a different definition of </code>mconcat`."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1473984265, "post_id": 39520291, "comment_id": 66359715, "body": "Ah! That makes much more sense - that is a very good point. :)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1474016541, "post_id": 39520291, "comment_id": 66369846, "body": "This can be done with <code>mappend (Product 0) _ = Product 0</code>, no need to get <code>mconcat</code> involved"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1473973212, "creation_date": 1473973212, "answer_id": 39520291, "question_id": 39519436, "link": "https://stackoverflow.com/questions/39519436/when-is-it-a-good-idea-to-implement-optional-functions-in-a-typeclass/39520291#39520291", "title": "When is it a good idea to implement optional functions in a Typeclass", "body": "<p>The example I like (and don't understand why it is not part of the actual definition) is <code>mconcat</code> for <code>Product</code>. As a reminder</p>\n\n<pre><code>class Monoid a where\n  mempty :: a\n  mappend :: a -&gt; a -&gt; a\n  mconcat = foldr mappend mempty\n</code></pre>\n\n<p>The <code>Product</code> instance looks like</p>\n\n<pre><code>instance Num a =&gt; Monoid (Product a) where\n  mempty = Product 1\n  (Product x) `mappend` (Product y) = Product (x * y)\n</code></pre>\n\n<p>Now, with the default <code>mconcat</code>, <code>mconcat (map Product [1..10])</code> has to multiply all the numbers together to get the final answer of 0. (In fact, with an infinite list, the function never terminates.)</p>\n\n<p>If <code>mconcat</code> had been replaced with </p>\n\n<pre><code>mconcat = foldr (\\acc v -&gt; if v == Product 0 then Product0 else mappend acc v) mempty\n</code></pre>\n\n<p>then <code>mconcat</code> could return <code>Product 0</code> the first time it sees a <code>Product 0</code> in the list.</p>\n"}], "owner": {"reputation": 781, "user_id": 1163717, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cbba7289a669e4ca1fcf1064d0cf22fd?s=128&d=identicon&r=PG&f=1", "display_name": "The Red Fox", "link": "https://stackoverflow.com/users/1163717/the-red-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473973212, "creation_date": 1473969744, "question_id": 39519436, "link": "https://stackoverflow.com/questions/39519436/when-is-it-a-good-idea-to-implement-optional-functions-in-a-typeclass", "title": "When is it a good idea to implement optional functions in a Typeclass", "body": "<p>I have been implementing the <code>Foldable</code> for one data type that I made and I was wondering if I should implement <code>foldr</code> and the other optional functions in the typeclass.</p>\n\n<p>I looked into the documentation, but that only explains the functions, not if I should implement it on my own version or if the default version is fine. Then I looked into the implementation, which made things even more complicated since some functions use <code>#.</code> instead of <code>.</code> to fix some kind of inefficiency, which I'm not sure my implementation would get rid of or how I find out.</p>\n\n<p>I also tried to google it and search it on Stack Overflow, but couldn't find anything relevant unfortunately.</p>\n\n<p>So how do I decide whether or not I should implement the optional functions of the more complicated typeclasses like <code>Foldable</code>?</p>\n"}, {"tags": ["haskell", "import", "repa"], "answers": [{"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": true, "score": 3, "last_activity_date": 1474032662, "last_edit_date": 1474032662, "creation_date": 1473968168, "answer_id": 39519030, "question_id": 39518281, "link": "https://stackoverflow.com/questions/39518281/not-in-scope-error-when-trying-to-use-repa-package/39519030#39519030", "title": "Not in scope error when trying to use Repa package", "body": "<p>It looks like you have two problems. First, you're importing the module qualified, but using it unqualified. You can add an additional import for definitions that you don't want to have to qualify:</p>\n\n<pre><code>import Data.Array.Repa (D,Z,(:.))\n</code></pre>\n\n<p>The second problem is what the third error message is telling you. You need to turn on the <code>TypeOperators</code> extension. Put this at the top of your file:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6836460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a77b74544f882dd1998c19cf9cb9740?s=128&d=identicon&r=PG&f=1", "display_name": "Behzad.agha", "link": "https://stackoverflow.com/users/6836460/behzad-agha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 39519030, "answer_count": 1, "score": 0, "last_activity_date": 1474032662, "creation_date": 1473965131, "question_id": 39518281, "link": "https://stackoverflow.com/questions/39518281/not-in-scope-error-when-trying-to-use-repa-package", "title": "Not in scope error when trying to use Repa package", "body": "<p>I'm relatively new to Haskell, and I'm trying to use <code>Repa</code> package in a project. I have imported the package in my source code using <code>import qualified Data.Array.Repa as R</code>, but when loading the Haskell file in ghci, I get the following error:</p>\n\n<pre><code>Location_repa.hs:46:26:\nNot in scope: type constructor or class `D'\nPerhaps you meant `R.D' (imported from Data.Array.Repa)\n\nLocation_repa.hs:46:29:\nNot in scope: type constructor or class `Z'\nPerhaps you meant `R.Z' (imported from Data.Array.Repa)\n\nLocation_repa.hs:46:30:\nIllegal operator `:.' in type `Z :. (Dimension :: Int)'\nUse TypeOperators to allow operators in types\n.....\n</code></pre>\n\n<p>And here is the part of source code that uses <code>Repa</code>:</p>\n\n<pre><code>type CoordList = Array D (Z:. (Dimension::Int)) Integer\n</code></pre>\n\n<p>It seems as if the package is not imported (loaded). Using <code>ghc-pkg list repa</code> results in the following:</p>\n\n<pre><code>C:/Program Files/Haskell Platform/7.10.2-a\\lib\\package.conf.d:\n(no packages)\nC:\\Users\\...\\AppData\\Roaming\\ghc\\x86_64-mingw32-7.10.2\\package.conf.d:\nrepa-3.4.1.1\n</code></pre>\n\n<p>What should I do?</p>\n"}, {"tags": ["haskell", "recursion", "fibonacci"], "answers": [{"comments": [{"owner": {"reputation": 913, "user_id": 4661191, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/y1c2n.jpg?s=128&g=1", "display_name": "dsaxton", "link": "https://stackoverflow.com/users/4661191/dsaxton"}, "edited": false, "score": 0, "creation_date": 1473960892, "post_id": 39516888, "comment_id": 66349947, "body": "I&#39;m more interested in how the recursion works, but that&#39;s explained in the answer to the linked question."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 1, "last_activity_date": 1473984196, "last_edit_date": 1473984196, "creation_date": 1473959994, "answer_id": 39516888, "question_id": 39516786, "link": "https://stackoverflow.com/questions/39516786/constructing-the-fibonacci-sequence-in-haskell/39516888#39516888", "title": "Constructing the Fibonacci sequence in Haskell", "body": "<p>The first two values are 0 and 1.  Thereafter, the elements are appended (zipped on) by adding the current and immediately previous series, shifted by one position.</p>\n\n<p>For instance, if the \"current\" list is (0, 1, 1, 2, 3, 5), then the tail is (1, 1, 2, 3, 5).  Adding these gives us ...</p>\n\n<pre><code>fibs = (0, 1, 1, 2, 3, 5)\ntail = (1, 1, 2, 3, 5)\nsum  = (1, 2, 3, 5, 8)\n</code></pre>\n\n<p>This gives us the expression</p>\n\n<pre><code>0: 1: (1, 2, 3, 5, 8)\n</code></pre>\n\n<p>... which results in a one-element extension of the list.  When we recur on this without limit, we get the Fibonacci sequence.</p>\n"}], "owner": {"reputation": 913, "user_id": 4661191, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/y1c2n.jpg?s=128&g=1", "display_name": "dsaxton", "link": "https://stackoverflow.com/users/4661191/dsaxton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "closed_date": 1473960114, "answer_count": 1, "score": -2, "last_activity_date": 1473984196, "creation_date": 1473959672, "question_id": 39516786, "link": "https://stackoverflow.com/questions/39516786/constructing-the-fibonacci-sequence-in-haskell", "closed_reason": "Duplicate", "title": "Constructing the Fibonacci sequence in Haskell", "body": "<p>I'm a complete beginner with Haskell and just encountered the following terse expression for constructing the Fibonacci sequence:</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\n</code></pre>\n\n<p>I think I understand what each individual piece is doing (<code>:</code>, <code>zipWith</code>, <code>tail</code>), and I know some sort of recursion is happening, but am not quite sure how.</p>\n"}, {"tags": ["function", "haskell", "pattern-matching", "functor"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1473954381, "post_id": 39515022, "comment_id": 66346379, "body": "Please provide the definitions of <code>Context</code> and <code>Env</code>, as well as the exact error message you are getting."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1473965785, "post_id": 39515022, "comment_id": 66352571, "body": "Do those definitions matter? <code>fmap</code> is not allowed to touch those at all, since they don&#39;t have an <code>a</code> in them."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1473966048, "post_id": 39515022, "comment_id": 66352702, "body": "You may enjoy <code>type SubsM = Compose ((-&gt;) Context) (Compose (Either Error) ((,) Env))</code>. It is isomorphic to your definition, already has the requisite <code>Functor</code> instance, and even gives you an <code>Applicative</code> instance for free."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1473956989, "post_id": 39515472, "comment_id": 66347893, "body": "I&#39;d handle the <code>Right</code> case first and then just use a wildcard <code>val -&gt; val</code> for <code>Left</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1473965738, "post_id": 39515472, "comment_id": 66352547, "body": "You can&#39;t, because that has the wrong type. <code>val :: Either Error (a, Env)</code>, but you need <code>Either Error (b, Env)</code>."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1473954882, "creation_date": 1473954882, "answer_id": 39515472, "question_id": 39515022, "link": "https://stackoverflow.com/questions/39515022/functor-fmap-pattern-match-function-values-haskell/39515472#39515472", "title": "Functor fmap, pattern match function values, haskell", "body": "<p>You can pattern match on the <code>Either Error (a, Env)</code> with <code>case</code>:</p>\n\n<pre><code>instance Functor SubsM where\n  fmap f (SubsM cf) = SubsM $ \\c -&gt;  case (cf c) of\n    Left err -&gt; Left err\n    Right (v, env) -&gt; Right (f v, env)\n</code></pre>\n\n<p>In the <code>Left</code> case you propagate the error, in the <code>Right</code> case you unpack the resulting pair and apply <code>f</code> to the first element.</p>\n"}, {"tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": false, "score": 5, "last_activity_date": 1473955693, "creation_date": 1473955693, "answer_id": 39515711, "question_id": 39515022, "link": "https://stackoverflow.com/questions/39515022/functor-fmap-pattern-match-function-values-haskell/39515711#39515711", "title": "Functor fmap, pattern match function values, haskell", "body": "<p>Note that you can also use the existing <code>Functor</code> instances for <code>-&gt;</code> and <code>Either</code> to do much of the work for you:</p>\n\n<pre><code>instance Functor SubsM where\n  fmap g (SubsM cf) = SubsM (fmap (fmap (leftfmap g)) cf)\n    where\n      leftfmap f (a, b) = (f a, b)\n</code></pre>\n\n<p>The <code>Functor</code> instance for <code>(,)</code> maps over the right-hand value, not the left-hand one, so you can't use <code>fmap</code> there. You can also write <code>leftfmap</code> as <code>first</code> if you import that function from <code>Control.Arrow</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 7, "last_activity_date": 1473956832, "creation_date": 1473956832, "answer_id": 39516034, "question_id": 39515022, "link": "https://stackoverflow.com/questions/39515022/functor-fmap-pattern-match-function-values-haskell/39516034#39516034", "title": "Functor fmap, pattern match function values, haskell", "body": "<p>I prefer not to have to think, when the machine is quite capable of doing the thinking for you.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nnewtype SubsM a = SubsM {runSubsM :: Context -&gt; Either Error (a, Env)}\n    deriving Functor\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1473960098, "post_id": 39516597, "comment_id": 66349526, "body": "The interested reader might want to compare my answer to Daniel Martin&#39;s answer; they are nearly identical."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1473959875, "last_edit_date": 1473959875, "creation_date": 1473958808, "answer_id": 39516597, "question_id": 39515022, "link": "https://stackoverflow.com/questions/39515022/functor-fmap-pattern-match-function-values-haskell/39516597#39516597", "title": "Functor fmap, pattern match function values, haskell", "body": "<p>Much of the work necessary is already done for you since both <code>Either a b</code> and <code>(,)</code> are instance of the <code>Bifunctor</code> class.</p>\n\n<pre><code>-- Using the tuple instance\nfirst f (x, y) == (f x, y)\n\n-- Using the Either instance\nsecond g (Left err) = Left err   -- basically, id\nfirst g (Right v) = Right (g v)\n</code></pre>\n\n<p>Using these functions, you can shorten this drastically (a step-by-step reduction starting with Lee's answer follows):</p>\n\n<pre><code>import Data.Bifunctor\ninstance Functor SubsM where\n   fmap f = SubsM . second (first f) . runSubsM\n</code></pre>\n\n<p>Would anyone actually write code like this, let alone do so from scratch? Probably not. It's not immediately obvious how it works, but deriving it one\nstep at a time is pretty straightforward, and you might find one of the intermediate steps useful.</p>\n\n<p>I'd probably write something like</p>\n\n<pre><code>instance Functor SubsM where\n  fmap f (SubsM cf) = SubsM $ \\c -&gt; (second . first) f (cf c)\n</code></pre>\n\n<p>which limits the more esoteric parts to the single function <code>(second . first)</code>.</p>\n\n<hr>\n\n<h2>Derivation of the short form</h2>\n\n<p>First, use the <code>Bifunctor</code> instance of <code>(,)</code> to avoid pattern-matching\non the tuple.</p>\n\n<pre><code>-- first f (v, env) == (f v, env)\ninstance Functor SubsM where\n   fmap f (SubsM cf) = SubsM $ \\c -&gt;  case (cf c) of\n      Left err -&gt; Left err\n      Right t -&gt; Right (first f t)\n</code></pre>\n\n<p>Next, use the <code>Bifunctor</code> instance of <code>Either a b</code> to avoid pattern-matching on the return value of <code>cf c</code>:</p>\n\n<pre><code>-- second (first f) (Left err) == Left Err\n-- second (first f) (Right t) == Right (first f) t\ninstance Functor SubsM where\n   fmap f (SubsM cf) = SubsM $ \\c -&gt;  second (first f) (cf c)\n</code></pre>\n\n<p>You can also avoid pattern-matching on the <code>SubsM</code> value by unpacking\nit on the right-hand side with <code>runSubsM</code>:</p>\n\n<pre><code>instance Functor SubsM where\n   fmap f cf = SubsM $ \\c -&gt;  second (first f) ((runSubsM cf) c)\n</code></pre>\n\n<p>Finally, we just start applying function composition to eliminate explict\narguments where possible.</p>\n\n<pre><code>instance Functor SubsM where\n   -- fmap f cf = SubsM $ \\c -&gt;  second (first f) ((runSubsM cf) c)\n   -- fmap f cf = SubsM $ \\c -&gt;  second (first f) . (runSubsM cf) $ c\n   -- fmap f cf = SubsM $ second (first f) . (runSubsM cf)\n   -- One more function composition allows us to drop cf as an\n   -- explicit argument\n   fmap f = SubsM . second (first f) . runSubsM\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2423075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adaa0bae7e6025776f2365d3b37e96e?s=128&d=identicon&r=PG", "display_name": "Honeybomb", "link": "https://stackoverflow.com/users/2423075/honeybomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 39515472, "answer_count": 4, "score": 1, "last_activity_date": 1473959875, "creation_date": 1473953531, "last_edit_date": 1473953611, "question_id": 39515022, "link": "https://stackoverflow.com/questions/39515022/functor-fmap-pattern-match-function-values-haskell", "title": "Functor fmap, pattern match function values, haskell", "body": "<p>I have the following type, and would like to make it a Functor:</p>\n\n<pre><code>newtype SubsM a = SubsM {runSubsM :: Context -&gt; Either Error (a, Env)}\n</code></pre>\n\n<p>So far i got this</p>\n\n<pre><code>instance Functor SubsM where\n    fmap f (SubsM a)  =  SubsM (\\s-&gt;(Right((f a),(fst s))))\n</code></pre>\n\n<p>I get an error because a is not the expected type, my question is how do i pattern match a on the left-hand side? </p>\n"}, {"tags": ["haskell", "window-managers", "xmonad"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1473952537, "post_id": 39514250, "comment_id": 66345160, "body": "\u201cthat window\u201d \u2013 which window?"}, {"owner": {"reputation": 1940, "user_id": 5773806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/438f0f7a7ca24486577712c68a9cb131?s=128&d=identicon&r=PG&f=1", "display_name": "GiftZwergrapper", "link": "https://stackoverflow.com/users/5773806/giftzwergrapper"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1474007179, "post_id": 39514250, "comment_id": 66365183, "body": "the window, of the chat."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1474029913, "post_id": 39514250, "comment_id": 66377946, "body": "Could you amend the question with the output that <code>xwininfo</code> shows after you run this command on the command line and then click on the window?"}], "answers": [{"tags": [], "owner": {"reputation": 1984, "user_id": 6836173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e70051ca136fbc92aa864aef45e8622?s=128&d=identicon&r=PG&f=1", "display_name": "wfehr", "link": "https://stackoverflow.com/users/6836173/wfehr"}, "is_accepted": true, "score": 1, "last_activity_date": 1583754462, "last_edit_date": 1583754462, "creation_date": 1474267356, "answer_id": 39566861, "question_id": 39514250, "link": "https://stackoverflow.com/questions/39514250/xmonad-layout-withim-stays-the-same-size/39566861#39566861", "title": "xmonad layout withIM stays the same size", "body": "<p>I had the same problem and the solution is quite simple.\nYou need to restart your pc (or session) after you changed the rational parameter (e.g. 1%7, or 3%7, ...) and it works.</p>\n"}], "owner": {"reputation": 1940, "user_id": 5773806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/438f0f7a7ca24486577712c68a9cb131?s=128&d=identicon&r=PG&f=1", "display_name": "GiftZwergrapper", "link": "https://stackoverflow.com/users/5773806/giftzwergrapper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 39566861, "answer_count": 1, "score": 1, "last_activity_date": 1583754462, "creation_date": 1473951303, "last_edit_date": 1474033342, "question_id": 39514250, "link": "https://stackoverflow.com/questions/39514250/xmonad-layout-withim-stays-the-same-size", "title": "xmonad layout withIM stays the same size", "body": "<p>I have a problem with xmonad and the XMonad.Layout.IM module.\nI have the following configuration for my layout and no matter to what I change the parameter of \"withIM\", the window stays always the same size.</p>\n\n<p>Config:</p>\n\n<pre><code>   38 import XMonad.Layout.IM\n   39 import XMonad.Layout.Grid\n   40 import XMonad.Layout.FixedColumn\n   41 import XMonad.Layout.Reflect\n   42 import XMonad.Layout.ThreeColumns\n   43 import Data.Ratio ((%))\n</code></pre>\n\n<p>...</p>\n\n<pre><code>   62 sPx = 1\n   63\n   64 verticalLayout = spacing sPx $ avoidStruts $ reflectHoriz $ Tall 1 0.03 0.5\n   65 verticalLayoutLargeScreen = spacing sPx $ avoidStruts $ ThreeCol 1 0.03 0.5\n   66 horizontalLayout = spacing sPx $ avoidStruts $ Mirror $ Tall 1 0.03 0.5\n   67 webdevLayout = spacing sPx $ avoidStruts $ Tall 1 0.03 0.63\n   68 fullscreenLayout = noBorders $ fullscreenFull $ Full\n   69\n   70 myLayout =\n   71     onWorkspace \"2:web\" (webdevLayout ||| fullscreenLayout) $ reflectHoriz $\n   72                     (withIM (1%7) (ClassName \"Chat\")\n   73                     (verticalLayoutLargeScreen ||| Grid ||| Full |||\n   74                     verticalLayout ||| horizontalLayout ||| fullscreenLayout))\n</code></pre>\n\n<p><strong>Update:</strong>\nThis is the output of xwininfo with the \"(1%7)\":</p>\n\n<pre><code>xwininfo: Window id: 0x1400006 \"Profanity\"\n\nAbsolute upper-left X:  3360\nAbsolute upper-left Y:  0\nRelative upper-left X:  3360\nRelative upper-left Y:  0\nWidth: 232\nHeight: 1042\nDepth: 32\nVisual: 0x7a\nVisual Class: TrueColor\nBorder width: 4\nClass: InputOutput\nColormap: 0x1400005 (not installed)\nBit Gravity State: NorthWestGravity\nWindow Gravity State: NorthWestGravity\nBacking Store State: NotUseful\nSave Under State: no\nMap State: IsViewable\nOverride Redirect State: no\nCorners:  +3360+0  -0+0  -0-30  +3360-30\n-geometry 32x74-0+0\n</code></pre>\n\n<p>And the output stays the same, even after changing the parameter to something else.</p>\n"}, {"tags": ["haskell", "happstack"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1473951828, "post_id": 39512246, "comment_id": 66344688, "body": "I only had a short glance on your code but - I would suspect some incorrect parenthization in the <code>map</code> try to use explicit parens instead of <code>$</code> and see if you get any further. Also I would say this is not a minimal &quot;non-working&quot; example - try to remove everything that is not changing the error messages."}], "answers": [{"tags": [], "owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "is_accepted": true, "score": 2, "last_activity_date": 1473962331, "last_edit_date": 1473962331, "creation_date": 1473961910, "answer_id": 39517385, "question_id": 39512246, "link": "https://stackoverflow.com/questions/39512246/haskell-error-couldnt-match-expected-type-serverpartt-io-a0-with-actual-type/39517385#39517385", "title": "Haskell error: couldn&#39;t match expected type \u2018ServerPartT IO a0\u2019 with actual type &#39;[Response]&#39;", "body": "<p><strong>I guess the problem is</strong> that the second statement in your do block is <code>msum (...) ++ [...]</code> which is parsed as <code>(msum [...]) ++ [...]</code>. So the the compiler sees the <code>++</code> and infers that this is a statement in the list monad. But based on the rest of the code, the do block should use the <code>ServerPartT IO</code> monad. That's why you get the first error message that <code>ServerPartT IO a0</code> and <code>\u2018[Response]</code> don't match.</p>\n\n<p><strong>To fix this</strong>, try putting more parentheses:</p>\n\n<pre><code>msum ((...) ++ [...])\n</code></pre>\n\n<p>Or another dollar operator:</p>\n\n<pre><code>msum $ (...) ++ [...]\n</code></pre>\n\n<p><strong>The second error message</strong> is another result of the same problem. Since the compiler infers that the statement is in the list monad, it assumes that the <code>msum</code> belongs to the list monad, too. So the argument of msum should be a list of actions in the list monad (= a list of lists), but it is a list of actions in the <code>ServerPartT IO</code> monad. I expect that this error goes away when you add the missing parentheses and the compiler sees that the <code>msum</code> should be from the <code>ServerPartT IO</code> monad.</p>\n\n<p><strong>The error location</strong> should be provided in the compiler output above the part you copied. There should be a filename, then a colon, then a line number. The compiler also reports the pieces of source code that are relevant to the error. Note that, for example, the first error message doesn't have three unrelated pieces of source code, but that the first piece is a part of the second piece, and the second piece is a part of the third piece. So the compiler starts by showing you the piece with the error, and then larger and larger pieces to provide more context.</p>\n"}], "owner": {"reputation": 87, "user_id": 6332341, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/ee066c3e3b46d2ebed941862a75ee1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Mia.M", "link": "https://stackoverflow.com/users/6332341/mia-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 39517385, "answer_count": 1, "score": 1, "last_activity_date": 1473962331, "creation_date": 1473945952, "question_id": 39512246, "link": "https://stackoverflow.com/questions/39512246/haskell-error-couldnt-match-expected-type-serverpartt-io-a0-with-actual-type", "title": "Haskell error: couldn&#39;t match expected type \u2018ServerPartT IO a0\u2019 with actual type &#39;[Response]&#39;", "body": "<p>When I tried to compile the code, two errors occur.</p>\n\n<p>the first one is:</p>\n\n<pre><code>Couldn't match expected type \u2018ServerPartT IO a0\u2019\n            with actual type \u2018[Response]\u2019\nIn a stmt of a 'do' block:\n  msum\n    (map (\\ (a, b) -&gt; dir a b)\n     $ routes\n         staticDir\n         redirectUrlGraphEmail\n         redirectUrlGraphPost\n         aboutContents\n         privacyContents)\n  ++\n    [do { nullDir;\n          seeOther \"graph\" (toResponse \"Redirecting to /graph\") },\n     notFoundResponse]\nIn the second argument of \u2018($)\u2019, namely\n  \u2018do { decodeBody (defaultBodyPolicy \"/tmp/\" 4096 4096 4096);\n        msum\n          (map (\\ (a, b) -&gt; dir a b)\n           $ routes\n               staticDir\n               redirectUrlGraphEmail\n               redirectUrlGraphPost\n               aboutContents\n               privacyContents)\n        ++\n          [do { nullDir;\n                .... },\n           notFoundResponse] }\u2019\nIn a stmt of a 'do' block:\n  simpleHTTP serverConf\n  $ do { decodeBody (defaultBodyPolicy \"/tmp/\" 4096 4096 4096);\n         msum\n           (map (\\ (a, b) -&gt; dir a b)\n            $ routes\n                staticDir\n                redirectUrlGraphEmail\n                redirectUrlGraphPost\n                aboutContents\n                privacyContents)\n         ++\n           [do { nullDir;\n                 .... },\n            notFoundResponse] }\n</code></pre>\n\n<p>It mentioned three chunks of code, which one </p>\n\n<p>the second one is:</p>\n\n<pre><code>    Couldn't match type \u2018ServerPartT IO\u2019 with \u2018[]\u2019\nExpected type: [[Response]]\n  Actual type: [ServerPartT IO Response]\nIn the first argument of \u2018msum\u2019, namely\n  \u2018(map (\\ (a, b) -&gt; dir a b)\n    $ routes\n        staticDir\n        redirectUrlGraphEmail\n        redirectUrlGraphPost\n        aboutContents\n        privacyContents)\u2019\nIn the first argument of \u2018(++)\u2019, namely\n  \u2018msum\n     (map (\\ (a, b) -&gt; dir a b)\n      $ routes\n          staticDir\n          redirectUrlGraphEmail\n          redirectUrlGraphPost\n          aboutContents\n          privacyContents)\u2019\nIn a stmt of a 'do' block:\n  msum\n    (map (\\ (a, b) -&gt; dir a b)\n     $ routes\n         staticDir\n         redirectUrlGraphEmail\n         redirectUrlGraphPost\n         aboutContents\n         privacyContents)\n  ++\n    [do { nullDir;\n          seeOther \"graph\" (toResponse \"Redirecting to /graph\") },\n     notFoundResponse]\n</code></pre>\n\n<p>I am also not quite sure about the location of the error.</p>\n\n<p>It seems like these two errors have totally opposite meanings. I am confused now. Can anyone help to explain this? Thanks!</p>\n\n<p>The original code is here:</p>\n\n<pre><code>runServer :: IO ()\nrunServer = do\nconfigureLogger\nstaticDir &lt;- getStaticDir\nredirectUrlGraphEmail &lt;- retrieveAuthURL testUrl\nredirectUrlGraphPost &lt;- retrieveAuthURL testPostUrl\naboutContents &lt;- LazyIO.readFile $ markdownPath ++ \"README.md\" \nprivacyContents &lt;- LazyIO.readFile $ markdownPath ++ \"PRIVACY.md\"\n\n-- Start the HTTP server\nsimpleHTTP serverConf $ do\n  decodeBody (defaultBodyPolicy \"/tmp/\" 4096 4096 4096)\n  msum  \n       (map (\\ (a, b) -&gt; dir a b) $ routes staticDir redirectUrlGraphEmail redirectUrlGraphPost aboutContents privacyContents ) ++  \n       [ do\n          nullDir\n          seeOther \"graph\" (toResponse \"Redirecting to /graph\"),    \n          notFoundResponse\n    ]\n</code></pre>\n\n<p>where <code>routes</code> is in another module:</p>\n\n<pre><code>routes :: [Char] -&gt; T.Text -&gt; T.Text -&gt; Text -&gt; Text -&gt; [ (String, ServerPart Response)]\nroutes staticDir redirectUrlGraphEmail redirectUrlGraphPost aboutContents privacyContents = [\n(\"grid\", gridResponse),\n(\"graph\", graphResponse),\n(\"image\", graphImageResponse),\n...\n]\n</code></pre>\n"}, {"tags": ["c++", "c", "opencv", "haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1473926900, "post_id": 39505855, "comment_id": 66328608, "body": "How do you tell GHCi which libraries to search for this symbol?"}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1473927549, "post_id": 39505855, "comment_id": 66328935, "body": "That&#39;s a good question. I don&#39;t know. I don&#39;t see here: <a href=\"https://wiki.haskell.org/CPlusPlus_from_Haskell\" rel=\"nofollow noreferrer\">CPlusPlus from Haskell</a> where he does it. I thought maybe in the cabal file. Something like this: <code>library   hs-source-dirs:      src   exposed-modules:     Lib     build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5   default-language:    Haskell2010</code>  With a ghci option, but I&#39;m not sure."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1473930321, "post_id": 39505855, "comment_id": 66330513, "body": "If you have a cabal file, try <code>cabal repl</code> instead of <code>ghci</code>. Cabal ought to tell ghci which libs to use."}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1473936880, "post_id": 39505855, "comment_id": 66334688, "body": "I tried <code>cabal repl</code> and <code>stack repl</code>, but I&#39;m still getting the same error. Where should I specify the libs? @n.m."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1473938160, "post_id": 39505855, "comment_id": 66335440, "body": "Can you build a standalone executable with Cabal or stack?"}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1473939411, "post_id": 39505855, "comment_id": 66336143, "body": "Sorry, I don&#39;t know what do you exactly mean with standalone. I&#39;ve built it with stack, if that&#39;s your question. The folder contains a cabal file, a Setup.hs, the stack yaml, and the src."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1473941015, "post_id": 39505855, "comment_id": 66337063, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/123431/discussion-between-n-m-and-chuck-aguilar\">continue this discussion in chat</a>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1473948283, "post_id": 39505855, "comment_id": 66342121, "body": "Your program would not work anyways, since OpenCV&#39;s <code>String</code> type is not a C string."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1473948655, "post_id": 39505855, "comment_id": 66342400, "body": "I&#39;d recommend trying to use existing OpenCV bindings like <a href=\"https://github.com/LumiGuide/haskell-opencv\" rel=\"nofollow noreferrer\">github.com/LumiGuide/haskell-opencv</a>."}, {"owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "edited": false, "score": 0, "creation_date": 1473954927, "post_id": 39505855, "comment_id": 66346753, "body": "Yep, it works, thank you! It&#39;s a nice Project."}], "answers": [{"comments": [{"owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "edited": false, "score": 0, "creation_date": 1482320470, "post_id": 39515797, "comment_id": 69724298, "body": "<code>haskell-opencv</code> isn&#39;t avaiable via hackage, is it?"}], "tags": [], "owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "is_accepted": true, "score": 2, "last_activity_date": 1473955960, "creation_date": 1473955960, "answer_id": 39515797, "question_id": 39505855, "link": "https://stackoverflow.com/questions/39505855/calling-a-c-opencv-function-from-haskell/39515797#39515797", "title": "Calling a C opencv function from haskell", "body": "<p>What I was trying doesn't work. \nThe OpenCV api is written in C++. That's why the way to call it is here: <a href=\"https://wiki.haskell.org/CPlusPlus_from_Haskell\" rel=\"nofollow\">C++ from haskell</a>. But when you install OpenCV in \"/usr/lib/\", you don't get a .so file like <em>cv2.so</em>. It means that's quite difficult to use <code>foreign import ccall</code> as the c-name is not built. \nSo, I used what @ReidBarton said \"<a href=\"https://github.com/LumiGuide/haskell-opencv\" rel=\"nofollow\">haskell-opencv</a>\" and it works nicely. Or at least easier than the other way. </p>\n\n<p>Here is a use example:</p>\n\n<pre><code>module Lib\n( someFunc\n) where\n\nimport Control.Monad ( void )\nimport qualified OpenCV as CV\nimport qualified Data.ByteString as B\n\nsomeFunc :: IO ()\nsomeFunc = do\n    img &lt;- CV.imdecode CV.ImreadUnchanged &lt;$&gt; B.readFile \"/some_pic.jpg\"\n    CV.withWindow \"test\" $ \\window -&gt; do\n     CV.imshow window img\n     void $ CV.waitKey 10000\n</code></pre>\n\n<p>in the <code>stack.yaml</code> I added this:</p>\n\n<pre><code>packages:    \n - location:\n    git: https://github.com/LumiGuide/haskell-opencv.git\n    commit: 07afde39fa16f7a4282d4a812e70b9ed33d0f3ef\n - '.'\n</code></pre>\n\n<p>and so looks a part of the cabal file:</p>\n\n<pre><code>library  \n hs-source-dirs:      src\n  exposed-modules:     Lib\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                     , opencv\n                     , bytestring\n  default-language:    Haskell2010\n\n executable simple-exe\n  hs-source-dirs:      app\n  main-is:             Main.hs\n -- ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  build-depends:       base\n                     , simple\n                     , opencv\n                     , bytestring\n  default-language:    Haskell2010\n\n test-suite simple-test\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      test\n  main-is:             Spec.hs\n  build-depends:       base\n                     , simple\n                     , opencv\n                     , bytestring\n -- ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  default-language:    Haskell2010\n</code></pre>\n\n<p>I hope it helps someone. </p>\n"}], "owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 1, "accepted_answer_id": 39515797, "answer_count": 1, "score": 1, "last_activity_date": 1473955960, "creation_date": 1473926310, "question_id": 39505855, "link": "https://stackoverflow.com/questions/39505855/calling-a-c-opencv-function-from-haskell", "title": "Calling a C opencv function from haskell", "body": "<p>I'm trying to use OpenCV with Haskell. My idea is calling the c++ function from Haskell.</p>\n\n<p>Right now I'm doing this: </p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule Lib\n    (\n        someFunc\n    ) where\n\nimport Foreign.C\nimport Foreign.C.String\nimport Foreign.C.Types\nimport Foreign.Ptr\n\ndata LplROI = LplROI {\n    coi :: CInt,\n    xOffset :: CInt,\n    yOffset :: CInt\n}\n\ndata LpImage = LpImage {\n    align :: CInt,\n    alphaChannel :: CInt,\n    borderConst :: CInt,\n    borderMode :: CInt,\n    channelSeq :: CChar,\n    colorModel :: CChar,\n    dataOrder :: CInt,\n    depth :: CInt,\n    height :: CInt,\n    id :: CInt,\n    imageData :: CChar, \n    mageDataOrigin :: CChar,\n    imageId :: CChar,\n    imageSize :: CInt,\n    maskROI :: LpImage,\n    nChannels :: CInt, \n    nSize :: CInt,\n    origin :: CInt,\n    roi :: LplROI,\n    tileInfo :: CChar,\n    width :: CInt,\n    widthStep :: CInt\n}\n\nforeign import ccall \"_ZN2cv6imreadERKNS_6StringEi\" imRead_ImRead :: CString -&gt; CInt -&gt; IO (Ptr LpImage)\n\nsomeFunc = do\n    filename &lt;- newCString \"/home/chuck/Pictures/such-a-bad-day.jpg\"\n    imRead_ImRead filename 1\n</code></pre>\n\n<p>I read this post <a href=\"https://wiki.haskell.org/CPlusPlus_from_Haskell\" rel=\"nofollow\">CPlusPlus from Haskell</a>, and so I got the name <em>_ZN2cv6imreadERKNS_6StringEi</em>. In <em>2.1.1 Finding the mangled named</em>.</p>\n\n<p>But GHCi says: </p>\n\n<blockquote>\n  <p>ByteCodeLink: can't find label\n  During interactive linking, GHCi couldn't find the following symbol:\n    _ZN2cv6imreadERKNS_6StringEi</p>\n</blockquote>\n\n<p>In Python I should \"import cv2\", but I don't know how it works on Haskell.</p>\n\n<p>I also read: <a href=\"https://wiki.haskell.org/FFI_cook_book\" rel=\"nofollow\">FFI cook book</a> But I can't get an answer to my question there.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 43, "user_id": 6383318, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10206492762785284/picture?type=large", "display_name": "TurboCrackers", "link": "https://stackoverflow.com/users/6383318/turbocrackers"}, "reply_to_user": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1473911054, "post_id": 39502677, "comment_id": 66322871, "body": "Nope. I edited my question to reflect what I was trying to ask in more detail. I have one let that is giving output 12, but the other let is not giving any output"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1473911418, "post_id": 39502677, "comment_id": 66322946, "body": "Ah. So <code>let ... in ...</code> is an expression. However, <code>let ...</code> can also occur in a <code>do</code> block. I encourage you to think of GHCi&#39;s behaviour as follows: if you enter something that  just looks like a raw expression, it evaluates it and prints the result. On the other hand, if what you entered looks like it might belong in an <code>IO</code> <code>do</code> block, it will simply execute that action."}, {"owner": {"reputation": 43, "user_id": 6383318, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10206492762785284/picture?type=large", "display_name": "TurboCrackers", "link": "https://stackoverflow.com/users/6383318/turbocrackers"}, "edited": false, "score": 0, "creation_date": 1473911559, "post_id": 39502677, "comment_id": 66322974, "body": "Ohhh thank you!! That makes a ton of sense!"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 6383318, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10206492762785284/picture?type=large", "display_name": "TurboCrackers", "link": "https://stackoverflow.com/users/6383318/turbocrackers"}, "is_accepted": true, "score": 2, "last_activity_date": 1473911646, "creation_date": 1473911646, "answer_id": 39502861, "question_id": 39502677, "link": "https://stackoverflow.com/questions/39502677/why-doesnt-this-ghci-expression-have-any-output/39502861#39502861", "title": "Why doesn&#39;t this GHCi expression have any output?", "body": "<blockquote>\n  <p>Ah. So let ... in ... is an expression. However, let ... can also occur in a do block. I encourage you to think of GHCi's behaviour as follows: if you enter something that just looks like a raw expression, it evaluates it and prints the result. On the other hand, if what you entered looks like it might belong in an IO do block, it will simply execute that action. \n  - @Alec</p>\n</blockquote>\n"}], "owner": {"reputation": 43, "user_id": 6383318, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10206492762785284/picture?type=large", "display_name": "TurboCrackers", "link": "https://stackoverflow.com/users/6383318/turbocrackers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1473925282, "accepted_answer_id": 39502861, "answer_count": 1, "score": 0, "last_activity_date": 1473915438, "creation_date": 1473909956, "last_edit_date": 1473915438, "question_id": 39502677, "link": "https://stackoverflow.com/questions/39502677/why-doesnt-this-ghci-expression-have-any-output", "closed_reason": "Duplicate", "title": "Why doesn&#39;t this GHCi expression have any output?", "body": "<p>Edit: Okay, I know nothing is wrong with this, but I don't know why it isn't giving output</p>\n\n<pre><code>let y = 2 * x where x = sum[1..3]\n</code></pre>\n\n<p>I only wonder, because this other expression DOES give output</p>\n\n<pre><code>let x = sum[1..3] in 2 * x\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 4192, "user_id": 167726, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a26c7545a3a430d80654369b72fb5e3d?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/167726/raj"}, "edited": false, "score": 0, "creation_date": 1473904573, "post_id": 39502065, "comment_id": 66321490, "body": "Thanks for the answer. I&#39;m curious to know if this can this be done using pattern matching."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 4192, "user_id": 167726, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a26c7545a3a430d80654369b72fb5e3d?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/167726/raj"}, "edited": false, "score": 0, "creation_date": 1473904839, "post_id": 39502065, "comment_id": 66321552, "body": "I added an answer for you."}, {"owner": {"reputation": 4192, "user_id": 167726, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a26c7545a3a430d80654369b72fb5e3d?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/167726/raj"}, "edited": false, "score": 0, "creation_date": 1473905691, "post_id": 39502065, "comment_id": 66321749, "body": "@MichaelKohl Thanks for adding a solution using pattern matching. I marked redneb&#39;s solution as the answer because of all the explanation he added. Thanks again for telling me about the intercalate function."}, {"owner": {"reputation": 4192, "user_id": 167726, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a26c7545a3a430d80654369b72fb5e3d?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/167726/raj"}, "edited": false, "score": 0, "creation_date": 1473906334, "post_id": 39502065, "comment_id": 66321876, "body": "I googled to find the source of Data.List and intercalate function  (<a href=\"https://hackage.haskell.org/package/base-4.3.1.0/docs/src/Data-List.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.3.1.0/docs/src/&hellip;</a>) and realized that it is implemented very similar to answers I have received here :-)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1473952907, "post_id": 39502065, "comment_id": 66345435, "body": "I think the above causes <code>strJoin &quot;|&quot; [&quot;foo&quot;] = &quot;foo|&quot;</code> which I don&#39;t think it is the expected output. The base case should be 1, not 2, IMO."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1473953162, "post_id": 39502065, "comment_id": 66345622, "body": "Thanks @chi, I fixed the pattern."}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": false, "score": 3, "last_activity_date": 1473953141, "last_edit_date": 1473953141, "creation_date": 1473904264, "answer_id": 39502065, "question_id": 39501998, "link": "https://stackoverflow.com/questions/39501998/implementing-string-join-function-in-haskell/39502065#39502065", "title": "Implementing String join function in Haskell", "body": "<p>The problem with your solution is that the second pattern also matches elements with one element (in which case <code>xs</code> is <code>[]</code>), so you will have one extra recursive call.</p>\n\n<pre><code>strJoin sep arr = case arr of\n  [] -&gt; \"\"\n  ([x]) -&gt; x   \n  (x : xs) -&gt; x ++ sep ++ strJoin sep xs\n</code></pre>\n\n<p>If you don't want to build this yourself for learning purposes, <code>Data.List</code> has <code>intercalate</code> for this purpose:</p>\n\n<p><a href=\"https://www.haskell.org/hoogle/?hoogle=intercalate\" rel=\"nofollow\">https://www.haskell.org/hoogle/?hoogle=intercalate</a></p>\n\n<pre><code>import Data.List \n\nintercalate \"|\" [\"foo\", \"bar\"]\n</code></pre>\n\n<p>Or you could use <code>concat</code> and <code>intersperse</code> together.</p>\n"}, {"comments": [{"owner": {"reputation": 4192, "user_id": 167726, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a26c7545a3a430d80654369b72fb5e3d?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/167726/raj"}, "edited": false, "score": 0, "creation_date": 1473906761, "post_id": 39502110, "comment_id": 66321967, "body": "Thanks for answering this question. I&#39;m seeing @ for the first time, I&#39;m going to find the explanation of how that works. Btw your second solution is more readable."}], "tags": [], "owner": {"reputation": 16405, "user_id": 6776093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/heFeh.png?s=128&g=1", "display_name": "redneb", "link": "https://stackoverflow.com/users/6776093/redneb"}, "is_accepted": true, "score": 4, "last_activity_date": 1473905721, "last_edit_date": 1473905721, "creation_date": 1473904679, "answer_id": 39502110, "question_id": 39501998, "link": "https://stackoverflow.com/questions/39501998/implementing-string-join-function-in-haskell/39502110#39502110", "title": "Implementing String join function in Haskell", "body": "<p>The problem is in that last line of your code:</p>\n\n<pre><code>(x : xs) -&gt; x ++ sep ++ strJoin sep xs\n</code></pre>\n\n<p>The meaning of the pattern <code>x : xs</code> is that <code>x</code> will match with a single element, namely the first element of the list, and <code>xs</code> will match with a list, namely the list of all elements except the first one. This list can be empty. Specifically, if <code>arr</code> contains a single element then <code>x</code> will match with that single element and <code>xs</code> will match with the rest of the list, which is the empty list. But then, on the right hand side, you effectively have:</p>\n\n<pre><code>x ++ sep ++ strJoin sep []\n</code></pre>\n\n<p>which is equivalent to</p>\n\n<pre><code>x ++ sep ++ \"\"\n</code></pre>\n\n<p>which in turn is the same as</p>\n\n<pre><code>x ++ sep\n</code></pre>\n\n<p>This explains the behavior of your function. So how can we fix that? One solution is to try to change the pattern for that case so that the rule is not used on a list with a single element. One way to do that is like so:</p>\n\n<pre><code>(x : xs @ (_ : _)) -&gt; x ++ sep ++ strJoin sep xs\n</code></pre>\n\n<p>Here <code>xs @ (_ : _)</code> will match with a nonempty list. I will leave the explanation of that as an exercise.\nSo now that rule will not be used on single element lists, as we wanted, but the problem is that there is no rule for such lists anymore. So we need to add a new one. The following will do:</p>\n\n<pre><code>[x] -&gt; x\n</code></pre>\n\n<p>So putting it all together:</p>\n\n<pre><code>strJoin sep arr = case arr of\n    [] -&gt; \"\"\n    (x : xs @ (_ : _)) -&gt; x ++ sep ++ strJoin sep xs\n    [x] -&gt; x\n</code></pre>\n\n<p>Of course there are many other ways to do this, here's one:</p>\n\n<pre><code>strJoin sep arr = case arr of\n    [] -&gt; \"\"\n    [x] -&gt; x\n    (x : xs) -&gt; x ++ sep ++ strJoin sep xs\n</code></pre>\n\n<p>I'll leave it as an exercise how this works.</p>\n"}], "owner": {"reputation": 4192, "user_id": 167726, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a26c7545a3a430d80654369b72fb5e3d?s=128&d=identicon&r=PG", "display_name": "Raj", "link": "https://stackoverflow.com/users/167726/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 1, "accepted_answer_id": 39502110, "answer_count": 2, "score": 0, "last_activity_date": 1473953141, "creation_date": 1473903668, "question_id": 39501998, "link": "https://stackoverflow.com/questions/39501998/implementing-string-join-function-in-haskell", "title": "Implementing String join function in Haskell", "body": "<p>I'm new to Haskell and trying to implement a function that takes a separator and a list to return a concatenated string (Similar to join function in Python)</p>\n\n<pre><code>strJoin sep arr = case arr of\n  [] -&gt; \"\"\n  (x : xs) -&gt; x ++ sep ++ strJoin sep xs\n</code></pre>\n\n<p>When I call this function <code>strJoin \"|\" [\"foo\", \"bar\"]</code> it prints <code>\"foo|bar|\"</code> even though I'd like result to read <code>\"foo|bar\"</code></p>\n\n<p>How can I adjust my pattern match code so that it work differently for the last element?</p>\n"}, {"tags": ["haskell", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 968117, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8b8eb69f0ce6c574c6c913d2a33e3fe5?s=128&d=identicon&r=PG", "display_name": "error_null_pointer", "link": "https://stackoverflow.com/users/968117/error-null-pointer"}, "edited": false, "score": 0, "creation_date": 1473904235, "post_id": 39502047, "comment_id": 66321431, "body": "That was the thought I was coming to from my reading. I was just making sure I was on the right track."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1473915263, "post_id": 39502047, "comment_id": 66323868, "body": "...but it may still be possible with mere <code>Applicative</code>s if you can &quot;peer inside&quot; the implementation of <code>someFun</code>."}, {"owner": {"reputation": 329, "user_id": 968117, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8b8eb69f0ce6c574c6c913d2a33e3fe5?s=128&d=identicon&r=PG", "display_name": "error_null_pointer", "link": "https://stackoverflow.com/users/968117/error-null-pointer"}, "edited": false, "score": 0, "creation_date": 1473943035, "post_id": 39502047, "comment_id": 66338285, "body": "Are you referring to Lift or is there something else?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1473963895, "post_id": 39502047, "comment_id": 66351579, "body": "@DanielWagner I don&#39;t believe it is. <code>LiftA</code> (a.k.a. <code>fmap</code>) needs to be replaced with a function <code>f b -&gt; (b -&gt; f c) -&gt; f c</code>, but this function is exactly <code>(&gt;&gt;=)</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1473965711, "post_id": 39502047, "comment_id": 66352529, "body": "@ReinHenrichs That assumes that we must use <code>someFun</code> as-is from outside. If we can change the source code of <code>someFun</code> to produce a new function <code>someFun&#39;</code>, we may find that we can change the internals in a way that results in a function of type <code>someFun&#39; :: Applicative f =&gt; f a -&gt; f b -&gt; f c</code>. It&#39;s really impossible to say that this can&#39;t be done without seeing the source for <code>someFun</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1473969050, "post_id": 39502047, "comment_id": 66354215, "body": "@DanielWagner I get what you&#39;re saying. On the other hand, if we can change the requirements to suit our solution then we can come up with lots of solutions!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1473972648, "post_id": 39502047, "comment_id": 66355981, "body": "@ReinHenrichs Absolutely! That&#39;s why this is a comment, and not an answer: I believe OP asked the wrong question, and I&#39;m just trying to alert him to possible (in fact, I believe <i>probable</i>) ways his question may be more flexible than he thinks."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 8, "last_activity_date": 1473904062, "creation_date": 1473904062, "answer_id": 39502047, "question_id": 39501933, "link": "https://stackoverflow.com/questions/39501933/avoiding-nested-applicative-i-e-applicative-f-f-f-a/39502047#39502047", "title": "Avoiding nested applicative i.e. Applicative f =&gt; f (f a)", "body": "<p>What you are asking for is <em>the</em> thing that Monads can do but Applicatives <em>cannot</em>. With a Monad instance, this is just <code>join</code>:</p>\n\n<pre><code>join :: Monad m =&gt; m (m a) -&gt; m a\n</code></pre>\n\n<p>What you ask for is impossible, but at least now you have a perfect example of what you can do with a Monad that you can't do with an Applicative.</p>\n"}], "owner": {"reputation": 329, "user_id": 968117, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8b8eb69f0ce6c574c6c913d2a33e3fe5?s=128&d=identicon&r=PG", "display_name": "error_null_pointer", "link": "https://stackoverflow.com/users/968117/error-null-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 1, "accepted_answer_id": 39502047, "answer_count": 1, "score": 1, "last_activity_date": 1473925043, "creation_date": 1473902958, "last_edit_date": 1473925043, "question_id": 39501933, "link": "https://stackoverflow.com/questions/39501933/avoiding-nested-applicative-i-e-applicative-f-f-f-a", "title": "Avoiding nested applicative i.e. Applicative f =&gt; f (f a)", "body": "<p>I have a function:</p>\n\n<pre><code>someFun :: Applicative f =&gt; f a -&gt; b -&gt; f c\nsomeFun x y = \u2026\n</code></pre>\n\n<p>The argument for <code>y</code> that I need to give someFun is an \u201cf b\u201d\nLets say I have values</p>\n\n<pre><code>someX :: Applicative f =&gt; f a\nsomeY :: Applicative f =&gt; f b\n</code></pre>\n\n<p>I tried to do</p>\n\n<pre><code>LiftA (someFun someX) someY\n</code></pre>\n\n<p>But that gives me <code>f (f c)</code></p>\n\n<p>I need to result in an <code>f c</code></p>\n"}]