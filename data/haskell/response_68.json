[{"tags": ["javascript", "node.js", "haskell", "stdout", "stdin"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1461797871, "post_id": 36902239, "comment_id": 61368806, "body": "Could you make your problem more concrete. Is it the Haskell program? Does this work with a simple hell world js program. Does your is program what you expect it to do?"}, {"owner": {"reputation": 4518, "user_id": 2012235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d3ae5ab77f79f70a2b433b7929896e7d?s=128&d=identicon&r=PG", "display_name": "dvlsg", "link": "https://stackoverflow.com/users/2012235/dvlsg"}, "edited": false, "score": 0, "creation_date": 1461797899, "post_id": 36902239, "comment_id": 61368823, "body": "You probably want to take a look at <a href=\"https://nodejs.org/api/process.html#process_process_stdin\" rel=\"nofollow noreferrer\">process.stdin</a> instead of readline. If you want to get stuff back in stdout, you can either pipe to <code>process.stdout</code>, or <code>process.stdout.write</code> or just <code>console.log()</code> if you wanted a quick solution."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461799602, "post_id": 36902239, "comment_id": 61369269, "body": "What exactly is not working as expected?"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 3700129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb3981ed6b4802d918f1cad66c16a7c?s=128&d=identicon&r=PG&f=1", "display_name": "user3700129", "link": "https://stackoverflow.com/users/3700129/user3700129"}, "edited": false, "score": 0, "creation_date": 1461868725, "post_id": 36904450, "comment_id": 61407281, "body": "I tried adding &quot;\\n&quot; to the code but it still doesn&#39;t print anything. How do you check if the javascript received anything?"}], "tags": [], "owner": {"reputation": 1047, "user_id": 1146183, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5152bd68f7c09d1c3172874b3ce2150?s=128&d=identicon&r=PG", "display_name": "Marcus Buffett", "link": "https://stackoverflow.com/users/1146183/marcus-buffett"}, "is_accepted": false, "score": 0, "last_activity_date": 1461812227, "creation_date": 1461812227, "answer_id": 36904450, "question_id": 36902239, "link": "https://stackoverflow.com/questions/36902239/haskell-call-node-js-file-not-working/36904450#36904450", "title": "Haskell call Node.js file not working", "body": "<p>The problem with the Haskell program you have is that paragraphs is not a line of input, just a string, so to fix the issue you can append a newline, something like: </p>\n\n<pre><code>output &lt;- readCreateProcess (shell \"node try2.js\") $ paragraphs ++ \"\\n\"\n</code></pre>\n\n<p>To find this issue I tried replacing <code>question</code> with a shim: </p>\n\n<pre><code>rl.question = function(prompt, cb) {\n  rl.on('line', function(thing) {\n    console.log(prompt);\n    cb(thing);\n  })\n}\n</code></pre>\n\n<p>And that worked, so I knew it was something to do with how <code>question</code> handles stdin. So after this I tried appending a newline and that worked. Which means <code>question</code> requires a 'line' of input, not just any string, unlike <code>on('line')</code>, oddly enough.</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 3700129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb3981ed6b4802d918f1cad66c16a7c?s=128&d=identicon&r=PG&f=1", "display_name": "user3700129", "link": "https://stackoverflow.com/users/3700129/user3700129"}, "is_accepted": false, "score": 1, "last_activity_date": 1461888640, "creation_date": 1461888640, "answer_id": 36927469, "question_id": 36902239, "link": "https://stackoverflow.com/questions/36902239/haskell-call-node-js-file-not-working/36927469#36927469", "title": "Haskell call Node.js file not working", "body": "<p>It took me a really long time but following code works:</p>\n\n<p>Haskell File: </p>\n\n<pre><code>import System.Process\n\nmain :: IO ()\nmain = \n    do \n        putStrLn \"Give me the paragraphs \\n\"\n        paragraphs &lt;- getLine\n        output &lt;- readCreateProcess (shell \"node lexrankReceiver.js\") (paragraphs ++ \"\\n\")\n        putStrLn output\n</code></pre>\n\n<p>NodeJs File:</p>\n\n<pre><code>// Getting this to work took almost a full day. Javascript gets really freaky\n// when using it on terminal. \n\n\n/* Import necessary modules. */ \nvar lexrank = require('./Lexrank/lexrank.js');\nconst readline = require('readline');\n// var Type = require('type-of-is');\n// var utf8 = require('utf8');\n\n\n// Create readline interface, which needs to be closed in the end.\nconst rl = readline.createInterface({\n  input: process.stdin,\n  output: process.stdout\n});\n\n// Set stdin and stdout to be encoded in utf8. Haskell passes string as basic \n// 8-bit unsigned integer array. The output also needs to be encoded so that \n// Haskell can read them\nprocess.stdin.setEncoding('utf8');\nprocess.stdout.setEncoding('utf8');\n\n// If a string is readable, start reading. \nprocess.stdin.on('readable', () =&gt; {\n  var chunk = process.stdin.read();\n\n  if (chunk !== null) {\n\n    var originalText = chunk;\n\n    var topLines = lexrank.summarize(originalText, 5, function (err, toplines, text) {\n      if (err) {\n        console.log(err);\n      }\n\n      // Loop through the result to form a new paragraph consisted of most \n      // important sentences in ascending order. Had to split the 0 index and\n      // the rest indices otherwise the first thing in newParagraphs will be\n      // undefined. \n      var newParagraphs = (toplines[0])['text'];\n\n      for (var i = 1; i &lt; toplines.length; i++) {\n        newParagraphs += (toplines[i])['text'];\n      }\n\n      console.log(newParagraphs);\n\n    });\n  }\n});\n\n// After the output is finished, set end of file. \n// TODO: write a handler for end of writing output.\nprocess.stdin.on('end', () =&gt; {\n  process.stdout.write('\\n');\n});\n\n// It is incredibly important to close readline. Otherwise, input doesn't \n// get sent out. \nrl.close();\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 3700129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb3981ed6b4802d918f1cad66c16a7c?s=128&d=identicon&r=PG&f=1", "display_name": "user3700129", "link": "https://stackoverflow.com/users/3700129/user3700129"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461888640, "creation_date": 1461797012, "last_edit_date": 1461869237, "question_id": 36902239, "link": "https://stackoverflow.com/questions/36902239/haskell-call-node-js-file-not-working", "title": "Haskell call Node.js file not working", "body": "<p>I am trying to write a program in Haskell that takes in the input as a string of sentences, calls a javascript file with that input, and return the output of that javascript file as the output of the Haskell file.  Right now, the output of the javascript file is not printed. It is not clear whether javascript file is called or not. </p>\n\n<p>Here is the script in Haskell: </p>\n\n<pre><code>main :: IO ()\nmain = \n    do \n        putStrLn \"Give me the paragraphs \\n\"\n        paragraphs &lt;- getLine\n        output &lt;- readCreateProcess (shell \"node try2.js\") paragraphs\n        putStrLn output\n</code></pre>\n\n<p>Script in Node.js. The desired output is toplines:</p>\n\n<pre><code>var lexrank = require('./lexrank');\nconst readline = require('readline');\n\nconst rl = readline.createInterface({\n  input: process.stdin,\n  output: process.stdout\n});\n\nrl.question('Hi', (answer) =&gt; {\n\n  var originalText = answer;\n\n  var topLines = lexrank.summarize(originalText, 5, function (err, toplines, text) {\n      if (err) {\n        console.log(err);\n      }\n\n      rl.write(toplines);\n      // console.log(toplines);\n\n      });\n\n  rl.close();\n});\n</code></pre>\n\n<p>I am guessing there is some problem with my way of doing stdin. I am new to Node.js</p>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461787478, "post_id": 36899597, "comment_id": 61363805, "body": "sure - just use different GHC versions"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1461791380, "post_id": 36899597, "comment_id": 61366025, "body": "Because <code>bytestring</code> is not a boot package to GHC. But <code>base</code> is needed for GHC to build."}], "answers": [{"comments": [{"owner": {"reputation": 899, "user_id": 1686629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/783eacdab4a800eab9d786d5f5911fac?s=128&d=identicon&r=PG", "display_name": "Echo Nolan", "link": "https://stackoverflow.com/users/1686629/echo-nolan"}, "edited": false, "score": 1, "creation_date": 1461881080, "post_id": 36902530, "comment_id": 61413584, "body": "This is mostly wrong. <code>base</code> is written entirely in Haskell - it doesn&#39;t have any primitives in it. They&#39;re in <code>ghc-prim</code> which doesn&#39;t even use <code>undefined</code> for that. I would know, <i>I&#39;m debugging the standard library</i>. The question is about modifying the <code>base</code> from the same GHC release. The compiler isn&#39;t changing at all."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1461801453, "last_edit_date": 1461801453, "creation_date": 1461798831, "answer_id": 36902530, "question_id": 36899597, "link": "https://stackoverflow.com/questions/36899597/why-cant-i-replace-libraries-distributed-with-ghc-what-would-happen-if-i-did/36902530#36902530", "title": "Why can&#39;t I replace libraries distributed with GHC? What would happen if I did?", "body": "<p>Most libraries are collections of Haskell modules containing Haskell code. The meaning of those libraries is determined by the code in the modules.</p>\n\n<p>The <code>base</code> package, though, is a bit different. Many of the functions and data types it offers are <em>not</em> implemented in standard Haskell; their meaning is not given by the code contained in the package, but by the compiler itself. If you look at the source of the <code>base</code> package (and the other boot libraries), you will see many operations whose complete definition is simply <code>undefined</code>. Special code in the compiler's runtime system implements these operations and exposes them.</p>\n\n<p>For example, if the compiler didn't offer <code>seq</code> as a primitive operation, there would be no way to implement <code>seq</code> after-the-fact: no Haskell term that you can write down will have the same type and semantics as <code>seq</code> unless it uses <code>seq</code> (or one of the Haskell extensions defined in terms of <code>seq</code>). Likewise many of the pointer operations, <code>ST</code> operations, concurrency primitives, and so forth are implemented in the compiler themselves.</p>\n\n<p>Not only are these operations typically unimplementable, they also are typically very strongly tied to the compiler's internal data structures, which change from one release to the next. So even if you managed to convince GHC to use the <code>base</code> package from a different (version of the) compiler, the most likely outcome would simply be corrupted internal data structures with unpredictable (and potentially disastrous) results -- race conditions, trashing memory, space leaks, segfaults, that kind of thing.</p>\n\n<p>If you need several versions of base, just install several versions of GHC. It's been carefully architected so that multiple versions can peacefully coexist on a single machine. (And in particular installing multiple versions definitely does not require recompiling GHC or even compiling GHC a first time, which seems to be your main concern.)</p>\n"}], "owner": {"reputation": 899, "user_id": 1686629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/783eacdab4a800eab9d786d5f5911fac?s=128&d=identicon&r=PG", "display_name": "Echo Nolan", "link": "https://stackoverflow.com/users/1686629/echo-nolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1461880786, "creation_date": 1461786648, "last_edit_date": 1495541770, "question_id": 36899597, "link": "https://stackoverflow.com/questions/36899597/why-cant-i-replace-libraries-distributed-with-ghc-what-would-happen-if-i-did", "title": "Why can&#39;t I replace libraries distributed with GHC? What would happen if I did?", "body": "<p>I see in <a href=\"https://stackoverflow.com/a/8646135/1686629\">this answer</a> and <a href=\"https://stackoverflow.com/questions/10055986/how-safe-is-it-to-update-base\">this one</a> that \"everything will break horribly\" and Stack won't let me replace base, but it will let me replace bytestring. What's the problem with this? Is there a way to do this safely without recompiling GHC? I'm debugging a problem with the base libraries and it'd be very convenient.</p>\n\n<p>N.B. when I say I want to replace <code>base</code> I mean with a modified version of <code>base</code> from the <em>same</em> GHC version. I'm debugging the library, not testing a program against different GHC releases.</p>\n"}, {"tags": ["haskell", "testing", "graph", "geometry", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5125477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbf12abb42007cd53d25fae5c3e52015?s=128&d=identicon&r=PG&f=1", "display_name": "Fluids", "link": "https://stackoverflow.com/users/5125477/fluids"}, "is_accepted": true, "score": 0, "last_activity_date": 1461788969, "creation_date": 1461788969, "answer_id": 36900251, "question_id": 36898657, "link": "https://stackoverflow.com/questions/36898657/testing-dag-aka-acyclic-graphs-properties-in-haskell-quickcheck/36900251#36900251", "title": "Testing &#39;DAG&#39; aka acyclic graphs properties in Haskell QuickCheck", "body": "<pre><code>prop_dag :: Property\nprop_dag = forAll (dag :: Gen (DAG Int)) $ \\g -&gt; collect (length (edges g)) $ isDAG g\n</code></pre>\n\n<p>This was what I was looking for.</p>\n"}], "owner": {"reputation": 41, "user_id": 5125477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbf12abb42007cd53d25fae5c3e52015?s=128&d=identicon&r=PG&f=1", "display_name": "Fluids", "link": "https://stackoverflow.com/users/5125477/fluids"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 36900251, "answer_count": 1, "score": 0, "last_activity_date": 1461788969, "creation_date": 1461783583, "question_id": 36898657, "link": "https://stackoverflow.com/questions/36898657/testing-dag-aka-acyclic-graphs-properties-in-haskell-quickcheck", "title": "Testing &#39;DAG&#39; aka acyclic graphs properties in Haskell QuickCheck", "body": "<pre><code>module Graph where\n\nimport Control.Monad.State\nimport Data.Maybe\nimport Data.Set as Set\n\n-- | 'Edge' represents an edge entre two nodes.\ndata Edge v = Edge {source :: v, target :: v}\n              deriving (Show,Eq,Ord)\n\ndata Graph v = Graph {nodes :: Set v, edges :: Set (Edge v)}\n               deriving Show\n\n-- | 'Eq' for graphs.\ninstance Ord v =&gt; Eq (Graph v) where\n    g == g' = nodes g == nodes g' &amp;&amp; edges g == edges g'\n\nisValid :: Ord v =&gt; Graph v -&gt; Bool\nisValid g = (Set.map source (edges g) `Set.union` Set.map target (edges g)) `isSubsetOf` nodes g\n\n-- | 'isDAG' tests if a graph is acyclic\nisDAG :: Ord v =&gt; Graph v -&gt; Bool\nisDAG g = isValid g &amp;&amp; all nocycle (nodes g)\n    where nocycle v = all (\\a -&gt; v `notMember` reachable g a) $ Set.map target (adj g v)\n</code></pre>\n\n<h2>I'm trying to use QuickCheck to test 'isDAG', could you give me an property that 'isDAG' abides?</h2>\n\n<pre><code>prop_isDAG :: Graph Int -&gt; Property\nprop_isDAG g = \n</code></pre>\n\n<p>I believe that's the accurate function declaration, if not, feel free to change it! </p>\n\n<hr>\n\n<p>Here is another example that I've made for another function, to guide possible helpers on what i'm looking for: </p>\n\n<pre><code>-- | The function 'isSubgraphOf' tests if the first graph is subgraph of the second.\nisSubgraphOf :: Ord v =&gt; Graph v -&gt; Graph v -&gt; Bool\nisSubgraphOf g g' = isSubsetOf (nodes g) (nodes g') &amp;&amp; isSubsetOf (edges g) (edges g')\n</code></pre>\n\n<p>And this is the QuickCheck property that it abides:</p>\n\n<pre><code>-- QuickCheck proprety to test 'isSubgraphOf'\nprop_isSubgraphOf :: Graph Int -&gt; Property\nprop_isSubgraphOf g = forAll (elements $ elems $ nodes g) $ \\v -&gt; adj g v `isSubsetOf` edges g\n</code></pre>\n"}, {"tags": ["haskell", "operator-keyword"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1461783535, "post_id": 36898572, "comment_id": 61361332, "body": "Why do you want to do this?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1461783598, "post_id": 36898572, "comment_id": 61361369, "body": "Are we talking about generic Haskell, or GHC? You can use <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/bang-patterns.html\" rel=\"nofollow noreferrer\">bang patterns</a> for this."}, {"owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1461783814, "post_id": 36898572, "comment_id": 61361511, "body": "I need this because i am using report and in a function the second argument is never used because of this."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1461889984, "post_id": 36898572, "comment_id": 61416103, "body": "@P_Ferreira that would seem to imply that evaluating the second argument has side effects?"}, {"owner": {"reputation": 3127, "user_id": 7096763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1843972ea822c36c0c024d2ddcc8d7?s=128&d=identicon&r=PG&f=1", "display_name": "MikaelF", "link": "https://stackoverflow.com/users/7096763/mikaelf"}, "edited": false, "score": 0, "creation_date": 1586890134, "post_id": 36898572, "comment_id": 108293899, "body": "I think the asker is referring to a bitwise <code>&amp;</code> like the one in javascript, which happens to act like a non-short-circuiting <code>&amp;&amp;</code> on boolean values."}], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1461786600, "post_id": 36898779, "comment_id": 61363257, "body": "Doesn&#39;t <code>seq</code> also force evaluation? I thought the difference was that <code>seq</code> forces evaluation before returning, and <code>pseq</code> forces evaluation before evaluating the second term."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1461787564, "post_id": 36898779, "comment_id": 61363855, "body": "You may be right. I usually think of <code>b`seq`a</code> as just a guarantee that the runtime does not leave <code>b</code> around as a non-WHNF thunk, without any reliable impact on what it <i>does</i> leave around... but unless <code>b</code> can be optimised away entirely, this probably ensures also that it&#39;s WHNF&#39;d before the result is given."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1461788880, "post_id": 36898779, "comment_id": 61364642, "body": "Technically <code>b `seq` a</code> just means that <code>b `seq` a</code> will be an infinite loop if <code>b</code> is. One optimization that is possible is <code>b `seq` a = a `seq` (b `seq` a)</code>, since this still satisfies that property."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1461784007, "creation_date": 1461784007, "answer_id": 36898779, "question_id": 36898572, "link": "https://stackoverflow.com/questions/36898572/operator-in-haskell/36898779#36898779", "title": "Operator &amp; in haskell?", "body": "<p>There is no good reason why you'd want this, but if you insist...</p>\n\n<pre><code>import Control.Parallel (pseq)\n\n(&amp;&amp;!) :: Bool -&gt; Bool -&gt; Bool\na &amp;&amp;! b = b `pseq` (a&amp;&amp;b)\n</code></pre>\n\n<p>Usually, <a href=\"http://hackage.haskell.org/package/base/docs/Prelude.html#v:seq\" rel=\"nofollow\"><code>seq</code></a> (which doesn't require any imports) will also suffice instead of <a href=\"http://hackage.haskell.org/package/parallel/docs/Control-Parallel.html#v:pseq\" rel=\"nofollow\"><code>pseq</code></a>, but only the latter actually guarantees that <code>b</code> will be evaluated.</p>\n\n<p>Of course, the semantics of this function will be exactly the same as <code>&amp;&amp;</code> alone, it will just be slower in some cases.</p>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1461784253, "post_id": 36898818, "comment_id": 61361756, "body": "Wouldn&#39;t a smart compiler derive that the second argument can only be <code>True</code> or <code>False</code> and thus optimize this away?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 11, "creation_date": 1461784803, "post_id": 36898818, "comment_id": 61362129, "body": "@WillemVanOnsem No, because the second argument can also be <code>undefined</code>.  This definition implies the semantics <code>False .&amp;&amp;. undefined = undefined</code>, whereas the original implies <code>False &amp;&amp; undefined = False</code>.  The compiler is not allowed to change this."}], "tags": [], "owner": {"reputation": 164, "user_id": 6113329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZEvy9.jpg?s=128&g=1", "display_name": "Ross Meikleham", "link": "https://stackoverflow.com/users/6113329/ross-meikleham"}, "is_accepted": true, "score": 6, "last_activity_date": 1461848668, "last_edit_date": 1461848668, "creation_date": 1461784145, "answer_id": 36898818, "question_id": 36898572, "link": "https://stackoverflow.com/questions/36898572/operator-in-haskell/36898818#36898818", "title": "Operator &amp; in haskell?", "body": "<p><code>&amp;&amp;</code> in the prelude is implemented as</p>\n\n<pre><code>(&amp;&amp;) :: Bool -&gt; Bool -&gt; Bool\nTrue  &amp;&amp; x =  x\nFalse &amp;&amp; _ =  False\n</code></pre>\n\n<p>Which means in the case that the first argument is <code>False</code> the second\none is never evaluated. You could always implement your own version to have the behaviour that you want e.g.:</p>\n\n<pre><code>(.&amp;&amp;.) :: Bool -&gt; Bool -&gt; Bool\nTrue  .&amp;&amp;. x =  x\nFalse .&amp;&amp;. False =  False    \nFalse .&amp;&amp;. True = False \n</code></pre>\n\n<p>In which the second second argument is evaluated in either case.</p>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 6024518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kgUBX.jpg?s=128&g=1", "display_name": "C.S.Reddy Gadipally", "link": "https://stackoverflow.com/users/6024518/c-s-reddy-gadipally"}, "is_accepted": false, "score": 0, "last_activity_date": 1586899366, "last_edit_date": 1586899366, "creation_date": 1586886706, "answer_id": 61214042, "question_id": 36898572, "link": "https://stackoverflow.com/questions/36898572/operator-in-haskell/61214042#61214042", "title": "Operator &amp; in haskell?", "body": "<p>I was mislead by the OP's subject \"Operator &amp; in haskell?\"</p>\n\n<p>For those who are here looking for (&amp;) in Haskell</p>\n\n<p><strong>&amp;</strong> is a reverse application operator in Data.Function</p>\n\n<p><code>(&amp;) :: a -&gt; (a -&gt; b) -&gt; b</code></p>\n"}], "owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 0, "accepted_answer_id": 36898818, "answer_count": 3, "score": 2, "last_activity_date": 1586899366, "creation_date": 1461783366, "last_edit_date": 1461783683, "question_id": 36898572, "link": "https://stackoverflow.com/questions/36898572/operator-in-haskell", "title": "Operator &amp; in haskell?", "body": "<p>How to check the second argument between an operation of true and false in haskell? E.g, <code>False &amp;&amp; True</code> will only check the first argument and then will stop the operation. Is there something like <code>False &amp; True</code> in Haskell to check both arguments?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 2, "creation_date": 1461780622, "post_id": 36897548, "comment_id": 61359449, "body": "I just wanted to mention that this data type is equivalent to <code>Either String ()</code>, where <code>Okay = Right ()</code> and <code>Error = Left</code>."}, {"owner": {"reputation": 1352, "user_id": 583925, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c97e6409fc48e6e909a43ca22e058e?s=128&d=identicon&r=PG", "display_name": "Haitham Gad", "link": "https://stackoverflow.com/users/583925/haitham-gad"}, "reply_to_user": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461780769, "post_id": 36897548, "comment_id": 61359546, "body": "Yup, I know that. I&#39;m interested in a more descriptive name though."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461780896, "post_id": 36897548, "comment_id": 61359636, "body": "I think that <code>Either</code> is such a well known type, that any Haskell programmer looking at a type of <code>Either String ()</code> would understand its purpose immediately. Using a different name would probably only make the code more difficult to follow."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1461780947, "post_id": 36897548, "comment_id": 61359664, "body": "@HaithamGad Then just give it a type alias.  It&#39;s standard to use <code>Either</code> to indicate possible failure with an error value.  If you had <code>type ErrorMsg = String</code> then <code>foo ::  a -&gt; Either ErrorMsg b</code>, every Haskeller would immediately understand the purpose of <code>foo</code>."}, {"owner": {"reputation": 1352, "user_id": 583925, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c97e6409fc48e6e909a43ca22e058e?s=128&d=identicon&r=PG", "display_name": "Haitham Gad", "link": "https://stackoverflow.com/users/583925/haitham-gad"}, "edited": false, "score": 0, "creation_date": 1461781887, "post_id": 36897548, "comment_id": 61360270, "body": "Regardless how it&#39;s implemented, I&#39;m just interested in a good name for that type. <code>Either</code> could be idiomatic, but the name is not ideal here."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1461780655, "creation_date": 1461780655, "answer_id": 36897707, "question_id": 36897548, "link": "https://stackoverflow.com/questions/36897548/opposite-of-maybe-data-type/36897707#36897707", "title": "Opposite of Maybe data type", "body": "<p>Your <code>&lt;Type&gt;</code> is equivalent to <code>Either String ()</code>, so you could just have</p>\n\n<pre><code>type CanError = Either String ()\n\nisOkay :: CanError -&gt; Bool\nisOkay = Data.Either.isRight\n\nisError :: CanError -&gt; Bool\nisError = Data.Either.isLeft\n\ngetErrorMsg :: CanError -&gt; Maybe String\ngetErrorMsg (Left msg) = Just msg\ngetErrorMsg _ = Nothing\n</code></pre>\n\n<p>You can use <code>Either String</code> as a Monad/Applicative/Functor, but not <code>CanError</code> since it has kind <code>*</code>, not <code>* -&gt; *</code> as required by each of those typeclasses.  I would recommend just using <code>Either String</code> as is since you get the extra power of Monad/Applicative/Functor/etc., and when you need the equivalent of <code>CanError</code> just have the return type be <code>Either String ()</code> in-line.</p>\n"}, {"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": false, "score": 4, "last_activity_date": 1461780682, "creation_date": 1461780682, "answer_id": 36897715, "question_id": 36897548, "link": "https://stackoverflow.com/questions/36897548/opposite-of-maybe-data-type/36897715#36897715", "title": "Opposite of Maybe data type", "body": "<p>I would use <code>Either String ()</code>, using the common convention that an <code>Either</code> is used to signal errors with information in the <code>Left</code> and the success value in the <code>Right</code>. If you don't actually have a success value, use the unit type <code>()</code>.</p>\n\n<p>Of course, that still needs to be wrapped in some monad, because in Haskell a pure function without a result is not useful. If the purpose of your function is just to check the validity of some data, then it's not an error to return the error string, and I'd go back to using <code>Maybe</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 8, "last_activity_date": 1461785383, "creation_date": 1461785383, "answer_id": 36899216, "question_id": 36897548, "link": "https://stackoverflow.com/questions/36897548/opposite-of-maybe-data-type/36899216#36899216", "title": "Opposite of Maybe data type", "body": "<p>I refute the premise that this type is in a meaningful sense \u201copposite\u201d to <code>Maybe</code>. I also don't agree that <code>Either</code> should generally be understood as an error-signalling type \u2013 that's just quite a natural way of using it, due to the way its monad instance works.</p>\n\n<p>Both <code>Maybe</code> and <code>Either</code> know nothing about errors / failure &ndash; they're just implementations of the abstract concept of a sum type (in the case of <code>Maybe</code> a sum with the unit type).</p>\n\n<p>IMO, you should just use <code>Maybe String</code> for this purpose, or if you like it explicit:</p>\n\n<pre><code>type ErrorMsg = String\ntype PossibleError = Maybe ErrorMsg\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "is_accepted": false, "score": 2, "last_activity_date": 1461828201, "creation_date": 1461828201, "answer_id": 36907964, "question_id": 36897548, "link": "https://stackoverflow.com/questions/36897548/opposite-of-maybe-data-type/36907964#36907964", "title": "Opposite of Maybe data type", "body": "<p>Another example for what perhaps is the general idea behind your question, that success is the exceptional case and failure is the normal case, is <code>EitherR</code> as provided in the <a href=\"https://hackage.haskell.org/package/errors-2.1.2/docs/Data-EitherR.html#t:EitherR\" rel=\"nofollow\">errors package</a> whose <code>Monad</code> instance is suggestively referred to as the \"success\" monad. As the name suggests there's no magic here, it's just a <code>newtype</code> with <code>Monad</code> instances swapped around. The interpretation, however, is interesting.</p>\n\n<p>You can program in a world where success falls through while errors are kept around. As the package documentation indicates, this comes in handy when dealing with stacks of exception handlers.</p>\n"}], "owner": {"reputation": 1352, "user_id": 583925, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c97e6409fc48e6e909a43ca22e058e?s=128&d=identicon&r=PG", "display_name": "Haitham Gad", "link": "https://stackoverflow.com/users/583925/haitham-gad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1461828201, "creation_date": 1461780187, "question_id": 36897548, "link": "https://stackoverflow.com/questions/36897548/opposite-of-maybe-data-type", "title": "Opposite of Maybe data type", "body": "<p>So the <code>Maybe</code> data type is defined like this:</p>\n\n<pre><code>data Maybe a = Just a | Nothing\n</code></pre>\n\n<p>What would you call the data type that's conceptually opposite to <code>Maybe</code>:</p>\n\n<pre><code>data &lt;Type&gt; = Okay | Error String\n</code></pre>\n\n<p>That is, a type that declares the computation successful or holds some error produced by the computation.</p>\n"}, {"tags": ["haskell", "pascals-triangle"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1461775977, "post_id": 36895974, "comment_id": 61356405, "body": "No need to understand monads for this, really. <code>f = unlines . map (intercalate &quot; &quot; . map show)</code> will produce the desired <code>String</code> value out of a <code>[[Int]]</code> value; simply pass the result to <code>putStr</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1461776337, "post_id": 36895974, "comment_id": 61356626, "body": "and <code>intercalate &quot; &quot;</code> is just <code>unwords</code> - you you get it with <code>putStr . unlines . map (unwords . map show)</code>"}, {"owner": {"reputation": 23, "user_id": 5131838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e56450f36497d0e0c0bba9f1731a82?s=128&d=identicon&r=PG&f=1", "display_name": "Master_Pabu", "link": "https://stackoverflow.com/users/5131838/master-pabu"}, "edited": false, "score": 0, "creation_date": 1461776591, "post_id": 36895974, "comment_id": 61356830, "body": "Aah beautiful. I was mixing <code>lines</code> and <code>unlines</code> and <code>map</code> up all wrong. I wasn&#39;t using <code>show</code> the right way. Thanks!"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461777381, "post_id": 36895974, "comment_id": 61357345, "body": "@Carsten Ah yes; I was overcomplicating it."}], "answers": [{"tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": true, "score": 4, "last_activity_date": 1461780300, "last_edit_date": 1461780300, "creation_date": 1461778396, "answer_id": 36896955, "question_id": 36895974, "link": "https://stackoverflow.com/questions/36895974/printing-pascals-triangle-in-haskell/36896955#36896955", "title": "Printing Pascal&#39;s triangle in Haskell", "body": "<p>There are several different ways to do this, but the most straight forward (IMO) is the following.</p>\n\n<pre><code>putStrLn $ intercalate \"\\n\" $ map (intercalate \" \" . map show) output\n</code></pre>\n\n<p>This first converts all of the numbers in the list into strings (using <code>show</code>). Then it converts the innermost lists into strings, where each element is separated by spaces (using <code>intercalate \" \"</code>). Then it converts the <em>outermost</em> list into a string where each element is separated by a <em>newline</em> (using <code>intercalate \"\\n\"</code>). And finally, it pushes the resulting string onto stdout. Replace the last line of your <code>main</code> with this and it should do what you want.</p>\n\n<p>EDIT:\nAs Yakym mentioned in his answer, <code>intercalate \" \"</code> and <code>intercalate \"\\n\"</code> can be replaced with <code>unwords</code> and <code>unlines</code>, making the code above a little more concise (it also removes the need for the import of <code>Data.List</code>).</p>\n\n<pre><code>putStr $ unlines $ map (unwords . map show) output\n</code></pre>\n\n<p>I changed <code>putStrLn</code> to <code>putStr</code> because <code>unlines</code> automatically adds a newline to the end of the output.</p>\n"}, {"comments": [{"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 2, "creation_date": 1461780736, "post_id": 36897311, "comment_id": 61359527, "body": "<code>[0] ++ row</code> could be simplified to <code>0 : row</code>"}, {"owner": {"reputation": 9372, "user_id": 4585963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Yzwc.jpg?s=128&g=1", "display_name": "hilberts_drinking_problem", "link": "https://stackoverflow.com/users/4585963/hilberts-drinking-problem"}, "reply_to_user": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 0, "creation_date": 1461781133, "post_id": 36897311, "comment_id": 61359783, "body": "You are right; I borrowed the line from the Haskell wiki <a href=\"https://wiki.haskell.org/Blow_your_mind\" rel=\"nofollow noreferrer\">wiki.haskell.org/Blow_your_mind</a> - I suppose the above version is due to symmetry."}], "tags": [], "owner": {"reputation": 9372, "user_id": 4585963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Yzwc.jpg?s=128&g=1", "display_name": "hilberts_drinking_problem", "link": "https://stackoverflow.com/users/4585963/hilberts-drinking-problem"}, "is_accepted": false, "score": 2, "last_activity_date": 1461779489, "creation_date": 1461779489, "answer_id": 36897311, "question_id": 36895974, "link": "https://stackoverflow.com/questions/36895974/printing-pascals-triangle-in-haskell/36897311#36897311", "title": "Printing Pascal&#39;s triangle in Haskell", "body": "<p>There are also functions like <code>unlines</code> and <code>unwords</code> that do natural intercalation on string lists.</p>\n\n<pre><code>pascal :: [[Int]]\npascal = iterate (\\row -&gt; zipWith (+) ([0] ++ row) (row ++ [0])) [1]\n\nprintPascal :: [[Int]] -&gt; IO ()\nprintPascal = mapM_ (putStrLn . unwords . map show)\n\n--*Main&gt; printPascal $ take 10 pascal \n--1\n--1 1\n--1 2 1\n--1 3 3 1\n--1 4 6 4 1\n--1 5 10 10 5 1\n--1 6 15 20 15 6 1\n--1 7 21 35 35 21 7 1\n--1 8 28 56 70 56 28 8 1\n--1 9 36 84 126 126 84 36 9 1\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5131838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e56450f36497d0e0c0bba9f1731a82?s=128&d=identicon&r=PG&f=1", "display_name": "Master_Pabu", "link": "https://stackoverflow.com/users/5131838/master-pabu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 36896955, "answer_count": 2, "score": 2, "last_activity_date": 1461780300, "creation_date": 1461775570, "question_id": 36895974, "link": "https://stackoverflow.com/questions/36895974/printing-pascals-triangle-in-haskell", "title": "Printing Pascal&#39;s triangle in Haskell", "body": "<p>I just started learning Haskell, and have been doing a few problems online. Most of the times, I can figure out the solution but I am unable to print it out in the output format that is expected. </p>\n\n<p>For example, I tried doing a Pascal's triangle program. I found out how to generate Pascal's Triangle as a list of lists of Ints, but I cant figure out how to print it.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>import Data.List\npascal n = map liner [0..n]\n    where liner x = map (comb x) [0..x]\n\ncomb n 0 = 1\ncomb 0 r = 0\ncomb n r = comb (n-1) (r-1) * n `div` r \n\nmain = do\n    order &lt;- getLine\n    let output = pascal . (read :: String -&gt; Int) $ order\n    print output \n</code></pre>\n\n<p>Currently, the output is like </p>\n\n<pre><code>[[1],[1,1],[1,2,1],[1,3,3,1]...\n</code></pre>\n\n<p>I want to print it in the form </p>\n\n<pre><code>1\n1 1\n1 2 1\n1 3 3 1\n...\n</code></pre>\n\n<p>How do I do this? I have tried using things like mapM_ or intercalate \" \", with no luck. I'm not into monads yet so I don't understand how mapM works.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461773858, "post_id": 36894975, "comment_id": 61355008, "body": "Is there any way to change the type of <code>(&gt;&gt;)</code> to <code>m a -&gt; m a -&gt; m a</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461773967, "post_id": 36894975, "comment_id": 61355092, "body": "You can actually achieve this with <code>-XRebindableSyntax</code>, but it won&#39;t have anything to do with monads then. @Carsten, this should be an answer! (Actually, it&#39;s more accurate to say it will ignore both <code>1</code> and <code>2</code> \u2013 the list spines are <i>not</i> ignored!)"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 4, "creation_date": 1461774150, "post_id": 36894975, "comment_id": 61355218, "body": "@VladtheImpala Does it have to be the list monad?  The writer monad works similarly as <code>foo = do { tell [1]; tell [2]; tell [3] }</code>, if you then did <code>execWriter foo</code> you would get <code>[1, 2, 3]</code> returned."}], "answers": [{"comments": [{"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "edited": false, "score": 0, "creation_date": 1461776427, "post_id": 36895612, "comment_id": 61356697, "body": "Makes sense. I&#39;ve used Writer for this before, I&#39;ll use that again. Thanks!"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 5, "last_activity_date": 1461779946, "last_edit_date": 1461779946, "creation_date": 1461774351, "answer_id": 36895612, "question_id": 36894975, "link": "https://stackoverflow.com/questions/36894975/list-monad-instance-that-appends-elements/36895612#36895612", "title": "List monad instance that appends elements", "body": "<p>You can get the effect you want with <code>mtl</code>'s <code>Writer</code> monad and nothing crazy:</p>\n\n<pre><code>type AutoList a = Writer [a] ()\n\nfoo :: AutoList Int\nfoo = do\n    tell [1]\n    tell [2]\n    tell [3]\n\ntoList :: AutoList a -&gt; [a]\ntoList = execWriter\n\nmain = print (toList foo)\n</code></pre>\n\n<p>However, you can do an awful hack with <code>-XOverloadedLists</code> to sort-of get it with just list literals.  The caveat is that you have to give a type signature on each line:</p>\n\n<pre><code>{-# LANGUAGE OverloadedLists #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\nmodule AutoList where\n\nimport GHC.Exts\nimport Control.Applicative\nimport Control.Monad.Writer\n\nnewtype AutoListM a r = AutoListM (Writer [a] r) deriving (Functor, Applicative, Monad)\n\ntype AutoList a = AutoListM a ()\n\ninstance IsList (AutoList a) where\n    type Item (AutoList a) = a\n    fromList = AutoListM . tell\n    fromListN n = AutoListM . tell . take n\n    toList (AutoListM w) = execWriter w\n\n\nfoo :: AutoList Int\nfoo = do\n    [1] :: AutoList Int\n    [2] :: AutoList Int\n    [3] :: AutoList Int\n\n\nmain = print (toList foo)\n</code></pre>\n\n<p>It has to be a monad for the do notation, but without the type signatures it can't figure out that it should be <code>r ~ ()</code> in <code>AutoListM Int r</code>.  With explicit type signatures it's able to figure everything out, but I doubt this is the solution you really want, and it's more work than just use <code>Writer</code> and <code>tell</code>.  Also, it's just something you really shouldn't do.</p>\n"}], "owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 36895612, "answer_count": 1, "score": 3, "last_activity_date": 1461779946, "creation_date": 1461772689, "question_id": 36894975, "link": "https://stackoverflow.com/questions/36894975/list-monad-instance-that-appends-elements", "title": "List monad instance that appends elements", "body": "<p>Is it possible to make a Monad instance of List that would work like this?</p>\n\n<pre><code>foo = do\n  [1]\n  [2]\n  [3]\n\nmain = print foo -- prints [1,2,3]\n</code></pre>\n\n<p>To make this work, I would need a constraint that every array have the same type: <code>[Int]</code>.</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1461787721, "post_id": 36896011, "comment_id": 61363952, "body": "It works indeed. I just struggled a bit to mix with my do block. I add to do <code>sendResponseStatus status &gt;&gt;= defaultLayout body</code> and it works. Thanks"}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 0, "creation_date": 1618002896, "post_id": 36896011, "comment_id": 118479976, "body": "Is there a way to do so without throwing an exception?"}], "tags": [], "owner": {"reputation": 430, "user_id": 985170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/98f7b1f60eb4c7ba94d1407f1104612c?s=128&d=identicon&r=PG", "display_name": "phischu", "link": "https://stackoverflow.com/users/985170/phischu"}, "is_accepted": true, "score": 2, "last_activity_date": 1461775687, "creation_date": 1461775687, "answer_id": 36896011, "question_id": 36894281, "link": "https://stackoverflow.com/questions/36894281/how-to-set-the-status-and-send-a-body-with-yesod/36896011#36896011", "title": "How to set the status and send a body with Yesod?", "body": "<p>Probably you are looking for</p>\n\n<p><a href=\"http://haddock.stackage.org/lts-5.14/yesod-core-1.4.20.2/Yesod-Core-Handler.html#v:sendResponseStatus\" rel=\"nofollow\"><code>sendResponseStatus :: (MonadHandler m, ToTypedContent c) =&gt; Status -&gt; c -&gt; m a</code></a>.</p>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 36896011, "answer_count": 1, "score": 1, "last_activity_date": 1461775687, "creation_date": 1461770890, "question_id": 36894281, "link": "https://stackoverflow.com/questions/36894281/how-to-set-the-status-and-send-a-body-with-yesod", "title": "How to set the status and send a body with Yesod?", "body": "<p>I have the following case. The user need to be able to upload a spreadsheet (csv) but if there are errors (for example a value supposed to be a Integer is not a number) I need to display the full csv as a table with a red background on the invalid cell. I would like to set the status to 422, but I haven't find a way to do so. All the ways I found to set a status seems to \"fail\" the handler Monad and doesn't allow to specify a message body. I was expecting a setStatus or equivalent but I can't find it. Is there a way to do it, or is it against Http protocol do to so ?</p>\n"}, {"tags": ["haskell", "graph", "generator", "directed-acyclic-graphs", "quickcheck"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1461772442, "post_id": 36893695, "comment_id": 61353875, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/36398392/arbitrary-instance-for-generating-unbiased-graphs-for-quickcheck\">Arbitrary instance for generating unbiased graphs for quickcheck</a>"}, {"owner": {"reputation": 1, "user_id": 6251950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28651c2cfd3fd2969b642c8708a2f21?s=128&d=identicon&r=PG", "display_name": "Vinho", "link": "https://stackoverflow.com/users/6251950/vinho"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461772762, "post_id": 36893695, "comment_id": 61354141, "body": "It isn&#39;t I checked that and it does not answer my question. What I want to improve are those generators and not the instance. Can you help?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461773108, "post_id": 36893695, "comment_id": 61354422, "body": "I&#39;m not sure what you mean by &quot;improve&quot; the generators. As it stands, this question does not ask any more than the duplicate - both questions ask about writing &quot;less biased&quot; generators."}, {"owner": {"reputation": 1, "user_id": 6251950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28651c2cfd3fd2969b642c8708a2f21?s=128&d=identicon&r=PG", "display_name": "Vinho", "link": "https://stackoverflow.com/users/6251950/vinho"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461775931, "post_id": 36893695, "comment_id": 61356377, "body": "As you can see they are written with &#39;suchThat&#39;, and not according to their properties. How can I write them using QuickCheck property combinators?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1461777338, "post_id": 36893695, "comment_id": 61357319, "body": "The question is a duplicate. The problem is that it didn&#39;t get good answers last time. But asking the same question again isn&#39;t going to fix that."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1461779540, "post_id": 36893695, "comment_id": 61358758, "body": "What do you mean <i>improve those generatorns and not the instance</i>? The definition of <code>arbitrary</code> in the instance is a generator!"}, {"owner": {"reputation": 1, "user_id": 6251950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28651c2cfd3fd2969b642c8708a2f21?s=128&d=identicon&r=PG", "display_name": "Vinho", "link": "https://stackoverflow.com/users/6251950/vinho"}, "edited": false, "score": 0, "creation_date": 1461923756, "post_id": 36893695, "comment_id": 61429645, "body": "Yes but my instance is already done. I just want a different implementation of my generators without using &#39;suchThat&#39;. Not the instance, but those who return Gen (DAG and FOREST)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6251950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28651c2cfd3fd2969b642c8708a2f21?s=128&d=identicon&r=PG", "display_name": "Vinho", "link": "https://stackoverflow.com/users/6251950/vinho"}, "edited": false, "score": 0, "creation_date": 1461906242, "post_id": 36900801, "comment_id": 61419962, "body": "Thank you for your answer.  But do you have any idea of what I should do in order to generate graphs that satisfy the DAG property? Instead of &#39;suchThat&#39; ?   Thank you in advance."}, {"owner": {"reputation": 1305, "user_id": 87721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96f6774b4445eda94b1aacf78c381ba?s=128&d=identicon&r=PG", "display_name": "niteria", "link": "https://stackoverflow.com/users/87721/niteria"}, "reply_to_user": {"reputation": 1, "user_id": 6251950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28651c2cfd3fd2969b642c8708a2f21?s=128&d=identicon&r=PG", "display_name": "Vinho", "link": "https://stackoverflow.com/users/6251950/vinho"}, "edited": false, "score": 1, "creation_date": 1462270161, "post_id": 36900801, "comment_id": 61555364, "body": "The second part of my answer answers this question."}], "tags": [], "owner": {"reputation": 1305, "user_id": 87721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96f6774b4445eda94b1aacf78c381ba?s=128&d=identicon&r=PG", "display_name": "niteria", "link": "https://stackoverflow.com/users/87721/niteria"}, "is_accepted": false, "score": 2, "last_activity_date": 1461790849, "creation_date": 1461790849, "answer_id": 36900801, "question_id": 36893695, "link": "https://stackoverflow.com/questions/36893695/haskell-generating-graphs-with-quickcheck-properties/36900801#36900801", "title": "Haskell Generating graphs with QuickCheck properties", "body": "<p>I believe the question at the core is how to generate DAGs and forests.</p>\n\n<p>What's a forest? Forest is a collection of trees. What's a tree? Tree is a graph where every node except the root has exactly one parent. How do we turn it into an algorithm? Generate a list of nodes. For every node in the list going from the left randomly pick an element to the right of it as its parent and create an edge to it.</p>\n\n<p>What is a DAG? DAG is a directed acyclic graph. What can we do with DAGs? We can topologically order them. What does that mean? It means we can put them in a sequence where every edge goes from left to right. How do we turn it into an algorithm? Generate a list of nodes. For every node in the list going from the left randomly pick a subset of elements to the right of it and create an edge to them.</p>\n"}], "owner": {"reputation": 1, "user_id": 6251950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28651c2cfd3fd2969b642c8708a2f21?s=128&d=identicon&r=PG", "display_name": "Vinho", "link": "https://stackoverflow.com/users/6251950/vinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461790849, "creation_date": 1461769437, "last_edit_date": 1461778367, "question_id": 36893695, "link": "https://stackoverflow.com/questions/36893695/haskell-generating-graphs-with-quickcheck-properties", "title": "Haskell Generating graphs with QuickCheck properties", "body": "<p>Graphs have these properties:</p>\n\n<p>The type 'Edge' represents an edge between two nodes.</p>\n\n<pre><code>data Edge v = Edge {source :: v, target :: v}\n          deriving (Show,Eq,Ord)\n</code></pre>\n\n<p>The 'Graph' type represents a directed graph.</p>\n\n<pre><code>data Graph v = Graph {nodes :: Set v, edges :: Set (Edge v)}\n           deriving Show\n</code></pre>\n\n<p>The fuction 'isDAG' tests if a graph is acyclic.</p>\n\n<pre><code>isDAG :: Ord v =&gt; Graph v -&gt; Bool\nisDAG g = isValid g &amp;&amp; all nocycle (nodes g)\nwhere nocycle v = all (\\a -&gt; v `notMember` reachable g a) $ Set.map target (adj g v)\n</code></pre>\n\n<p>The fuction 'isForest' tests if a valid DAG is a forest (a set of trees)</p>\n\n<pre><code>isForest :: Ord v =&gt; DAG v -&gt; Bool\nisForest g = isDAG g &amp;&amp; all (\\v -&gt; length (adj g v) &lt;= 1) (nodes g)\n</code></pre>\n\n<p>The generators code is:</p>\n\n<p>DAGs generator</p>\n\n<pre><code>dag :: (Ord v, Arbitrary v) =&gt; Gen (DAG v)\ndag = arbitrary `suchThat` isDAG\n</code></pre>\n\n<p>Forests generator</p>\n\n<pre><code>forest :: (Ord v, Arbitrary v) =&gt; Gen (Forest v)\nforest = arbitrary `suchThat` isForest\n</code></pre>\n\n<p>I want to improve the generators Dag and Forest, so they are defined based on their properties and not with 'suchThat'. How can I do it?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell", "trigonometry"], "comments": [{"owner": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "edited": false, "score": 2, "creation_date": 1461768069, "post_id": 36893054, "comment_id": 61350455, "body": "You have a missing parenthesis at the end of the <code>sineApprox</code> line."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1461771244, "post_id": 36893054, "comment_id": 61352962, "body": "Is this Hugs? In ghci, the error is rather more descriptive: <code>parse error (possibly incorrect indentation or mismatched brackets)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1461772271, "last_edit_date": 1461772271, "creation_date": 1461771905, "answer_id": 36894688, "question_id": 36893054, "link": "https://stackoverflow.com/questions/36893054/custom-sine-function-in-functional-programming/36894688#36894688", "title": "Custom sine function in Functional Programming", "body": "<p>As already said in the comments, you've forgotten to close a paren. It'll work like that:</p>\n\n<pre><code>sineApprox x n = ((-1) ^ n) * ((x ** (2*n+1))/facOfN(2*n+1))\n</code></pre>\n\n<p>Note that this problem would have been obvious with a better text editor. Being a beginner, I suggest you switch to <a href=\"https://github.com/gibiansky/IHaskell\" rel=\"nofollow\">iHaskell</a>, which has a very simple interface and yet reasonably powerful editor features.</p>\n\n<p>The problem would <em>also</em> have been obvious if you hadn't used so many unnecessary parens. The following can be omitted just like that, some can be replaced with <code>$</code>. While we're at style...</p>\n\n<pre><code>sumToN f x n   -- checking ==1 is not safe in general\n    | n&lt;=1       = f $ x 1\n    | otherwise  = f x n + f x (n-1)\n\nfacOfN = product [1..n]\n\nsineApprox x n = (-1)^n * x**(2*n+1) / facOfN (2*n+1)\n\nsine x = sumToN . sineApprox x\n</code></pre>\n\n<p>On another note: in general, you should always use type signatures. This code actually has problems because all the counter variables are automaticall floating point (like everything else). They should really be <code>Int</code>s, which requires a conversions in the factorial<sup>&dagger;</sup>:</p>\n\n<pre><code>sumToN :: Num n =&gt; (Int -&gt; n) -&gt; Int -&gt; n\nsumToN f x n\n    | n&lt;1        = 0\n    | otherwise  = f x n + f x (n-1)\n\nfacOfN :: Num n =&gt; Int -&gt; n\nfacOfN = product [1 .. fromIntegral n]\n\nsineApprox :: Fractional n =&gt; n -&gt; Int -&gt; n\nsineApprox x n = (-1)^n * x^(2*n+1) / facOfN (2*n+1)\n\nsine \nsine x = sumToN . sineApprox x\n</code></pre>\n\n<p><hr>\n<sup>&dagger;</sup><sub>BTW, explicitly using factorials is almost always a bad idea, as the numbers quickly get intractibly huge. Also, you're doing a lot of duplicate work. Better multiply as you add along!</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 5159946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e36e06f1ab40a1b519bdc9b029e8de6?s=128&d=identicon&r=PG&f=1", "display_name": "Sen_SZ", "link": "https://stackoverflow.com/users/5159946/sen-sz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461772271, "creation_date": 1461767864, "question_id": 36893054, "link": "https://stackoverflow.com/questions/36893054/custom-sine-function-in-functional-programming", "title": "Custom sine function in Functional Programming", "body": "<p>Please help, I've been trying to get this code to work but I can't find the errors. Below is my code</p>\n\n<pre><code>sumToN f x 1 = f (x 1)\nsumToN f x n = f x n + f x (n-1)\n\nfacOfN 0 = 1\nfacOfN n = n * facOfN (n-1) sgfr\n\nsineApprox x n = ((-1) ^ n) * ((x ** (2*n+1))/facOfN(2*n+1)\nsine x n = sumToN (sineApprox x n)\n</code></pre>\n\n<p>When I try to load the file I get the following error.</p>\n\n<pre><code>ERROR file:F:\\sine.hs:8 - Syntax error in expression (unexpected `;', possibly due to bad layout)\n</code></pre>\n\n<p>Any assistance would be greatly appreciated.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461791970, "post_id": 36891617, "comment_id": 61366314, "body": "I expanded my answer - with some examples"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1461765589, "post_id": 36891844, "comment_id": 61348420, "body": "Indeed. <code>return</code> and <code>fmap return</code> are both <i>right inverses</i> of <code>join</code>."}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "edited": false, "score": 0, "creation_date": 1541931522, "post_id": 36891844, "comment_id": 93380316, "body": "I don&#39;t think<code>fmap return</code> is exactly the counterpart the OP is looking for because it&#39;s more polymorphic than join so it won&#39;t constrain type deduction in the same way, that is <code>fmap return :: Functor outer, Monad inner =&gt; outer a -&gt; outer (inner a)</code> whereas <code>join :: Monad both =&gt; both (both a) -&gt; both a</code>. However, probably the maximally useful but still intuitive right inverse is <code>(fmap pure :: Applicative both =&gt; both a -&gt; both (both a))</code>"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 9, "last_activity_date": 1461791944, "last_edit_date": 1461791944, "creation_date": 1461765061, "answer_id": 36891844, "question_id": 36891617, "link": "https://stackoverflow.com/questions/36891617/is-there-a-builtin-inverse-function-of-control-monads-join/36891844#36891844", "title": "Is there a builtin &quot;inverse function&quot; of Control.Monad&#39;s join?", "body": "<h2>TL;DR - No there is no such function</h2>\n\n<p>First of all I'd like to note: You can view your <code>map (:[])</code> as a <code>map return</code> for the list monad.</p>\n\n<h2>Explanation why no such function can exist (in a sensible way)</h2>\n\n<p>The function <code>join :: m (m a) -&gt; m a</code> is not injective, for example </p>\n\n<ul>\n<li><code>join [\"abc\",\"def\"]</code></li>\n<li><code>join [\"ab\",\"cdef\"]</code></li>\n</ul>\n\n<p>have the same image. Same problem is with other monads:</p>\n\n<ul>\n<li><code>join (Just Nothing)</code></li>\n<li><code>join Nothing</code></li>\n</ul>\n\n<p>So in general an inverse function cannot exist.</p>\n\n<p>But now we know that no <strong>left-inverse</strong> can exist.</p>\n\n<h2>What about the right inverse?</h2>\n\n<p>In all cases you have </p>\n\n<pre><code>join . return = id.\n</code></pre>\n\n<p>I think - but have not proven, same goes for</p>\n\n<pre><code>join . fmap return = id.\n</code></pre>\n\n<h2>Proof.</h2>\n\n<pre><code>(join . return) x =  join (return x) -- with the definition of join\n                  = return x &gt;&gt;= id -- with monad laws (https://wiki.haskell.org/Monad_laws \n                  = id x\n</code></pre>\n\n<p>now we can apply eta reduction (which is just a fany word for dropping <code>x</code>) and get</p>\n\n<pre><code>join . return = id\n</code></pre>\n\n<p>Note: <code>id</code> here is <code>m a -&gt; m a</code>!</p>\n\n<hr>\n\n<p>To make things concrete - let us do this calculation in the list monad <code>[a]</code>.</p>\n\n<pre><code>(join . return) \"wizzup\" = join (return \"(^ \u035c ^)\") -- return = \\x -&gt; [x]\n                                                  -- and join = foldl (++) []\n                         = foldl (++) [] [\"(^ \u035c ^)\"]\n                         = \"(^ \u035c ^)\"\n</code></pre>\n\n<p>and here the version for <code>(join . fmap return)</code></p>\n\n<pre><code>(join . fmap return) \"(^ \u035c ^)\" = (foldl (++) [] . map (\\x -&gt; [x]))\"(^ \u035c ^)\"\n                              = foldl (++) [] [\"(\",\"^\",\" \u035c \",\"^\",\")\"]\n                              = \"(^ \u035c ^)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461775751, "post_id": 36893360, "comment_id": 61356260, "body": "<code>return . join = id</code> is <i>not</i> true, though, which is closer to what the OP is asking for: something at undoes a <code>join</code>."}, {"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461777046, "post_id": 36893360, "comment_id": 61357119, "body": "@chepner: right, I missed that.  The point is that <code>join</code> (almost always) loses information about the argument, so it <i>can&#39;t</i> have a left inverse."}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 5, "last_activity_date": 1461777403, "last_edit_date": 1461777403, "creation_date": 1461768562, "answer_id": 36893360, "question_id": 36891617, "link": "https://stackoverflow.com/questions/36891617/is-there-a-builtin-inverse-function-of-control-monads-join/36893360#36893360", "title": "Is there a builtin &quot;inverse function&quot; of Control.Monad&#39;s join?", "body": "<p>The three monad laws, written in terms of <code>join</code>, are:</p>\n\n<pre><code>join . return = id\njoin . fmap return = id\njoin . join = join . fmap join\n</code></pre>\n\n<p>As you can see, this guarantees that <code>return</code> will be the inverse of <code>join</code> that you're looking for.</p>\n\n<p>And, actually, <code>map (:[]) = map return = fmap return</code> is <em>also</em> a right inverse of <code>join</code>.</p>\n\n<p>Note that this implies that <code>join</code> <em>can't</em> have a left inverse, in any monad where <code>return /= fmap return</code>:</p>\n\n<p>Suppose <code>return /= fmap return</code>, for some monad.  Then there is some action <code>a</code> so that</p>\n\n<pre><code>return a /= fmap return a\n</code></pre>\n\n<p>but</p>\n\n<pre><code>join (return a) = a = join (fmap return a)\n</code></pre>\n\n<p>Your <code>unjoin</code>, applied to <code>a</code>, would have to be <em>both</em> <code>return a</code> and <code>fmap return a</code> (and possibly more values), which is a contradiction.</p>\n\n<p>Note that, for <code>[]</code>:</p>\n\n<pre><code>return [x, y] = [[x, y]]\nfmap return [x, y] = [[x], [y]]\n</code></pre>\n\n<p>For <code>IO</code>:</p>\n\n<pre><code>Prelude&gt; return (print \"Hello\") :: IO (IO ())\nPrelude&gt; fmap return (print \"Hello\") :: IO (IO ())\n\"Hello\"\n</code></pre>\n\n<p>etc.  The only monad I can think of where <code>return</code> and <code>fmap return</code> coincide is <code>Identity</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1461776951, "creation_date": 1461776951, "answer_id": 36896463, "question_id": 36891617, "link": "https://stackoverflow.com/questions/36891617/is-there-a-builtin-inverse-function-of-control-monads-join/36896463#36896463", "title": "Is there a builtin &quot;inverse function&quot; of Control.Monad&#39;s join?", "body": "<p>There is no function <code>unjoin</code> such that <code>unjoin . join == id</code>. Suppose <code>join x</code> evaluates to <code>[\"abc\"]</code>. Now, what was <code>x</code> so that <code>unjoin . join $ x == x</code>? Was it <code>[\"a\", \"b\", \"c\"]</code>? Was it <code>[\"ab\", \"c\"]</code>? Was it <code>[\"a\", \"bc\"]</code>? Or was it one of the infinitely many lists like <code>[\"a\", \"\", \"bc\"]</code> (with empty strings occurring amongst the finite strings)? Once you have applied <code>join</code> to the value, you have lost information necessary to recover the original value.</p>\n\n<p>If <code>join</code> were restricted to lists of lists of exactly one character (no multicharacter strings, no empty strings), then you could indeed define <code>unjoin</code> such that <code>unjoin . join x == x</code>, because <code>unjoin</code> would know\nthat every element of its input could be wrapped in a single list (which is want <code>map return</code> does in the list monad).</p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 36891844, "answer_count": 3, "score": 1, "last_activity_date": 1461791944, "creation_date": 1461764507, "question_id": 36891617, "link": "https://stackoverflow.com/questions/36891617/is-there-a-builtin-inverse-function-of-control-monads-join", "title": "Is there a builtin &quot;inverse function&quot; of Control.Monad&#39;s join?", "body": "<p>I use <code>map (:[])</code> to split <code>String</code> to <code>[[Char]]</code> and wonder if there any builtin function that do the same exist</p>\n\n<pre><code>In [1]: as = \"abcdefg\"\n\nIn [2]: bs = map (:[]) as\n        print bs\n        [\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\"]\n\nIn [3]: import Control.Monad\n        cs = join bs\n        print cs\n        \"abcdefg\"\n</code></pre>\n\n<p>This map is easy to understand, however, I feel something like <code>unjoin . join  = id</code> should exist but didn't found it in hoogle search <code>[a] -&gt; [[a]]</code></p>\n"}, {"tags": ["haskell", "ghc", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461745646, "post_id": 36882594, "comment_id": 61333507, "body": "as it&#39;s a problem inside the package (the error is rather clear - here is the <a href=\"https://hackage.haskell.org/package/MissingH-1.3.0.1/docs/src/System-IO-HVFS.html\" rel=\"nofollow noreferrer\">source</a> in case you are interesed) you can mail the maintainer and ask for a fix - or you can grab the source and fix it locally for you (it&#39;s easy in this case just <i>hide</i>  one of the imported <code>isSymbolicLink</code>s - probably the internal one from <code>PlafCompat</code>)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461745889, "post_id": 36882594, "comment_id": 61333670, "body": "maybe the problem was introduced into newer <code>directory</code> versions - a quick look: <a href=\"https://hackage.haskell.org/package/directory-1.2.5.1/docs/System-Directory.html\" rel=\"nofollow noreferrer\">version 1.2.5.1</a> did not use it and <code>MissingH</code> does not constraint this (this is usually the problem ...) - so you can probably just constraint <code>directory</code> to <code>1.2.5.1</code> and resolve the issue (add <code>directory &lt;= 1.2.5.1</code> to the <code>build-depends</code>) or using <code>cabal install yourGoal --constraint=directory&lt;=1.2.5.1</code>"}, {"owner": {"reputation": 2425, "user_id": 2392147, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/09f00344014ef1858c322172cc0a1be3?s=128&d=identicon&r=PG&f=1", "display_name": "orm", "link": "https://stackoverflow.com/users/2392147/orm"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461767399, "post_id": 36882594, "comment_id": 61349902, "body": "I can see how it can be fixed in the package, however, it seems like this kind of problem appears due to an understandable lack of forward compatibility (ie, one cannot predict which names will be added to imported packages, which will cause conflicts later on).   Isn&#39;t this part what the upper bound in the cabal files dependency list is meant to help enforce though? though  that may not really fix the problem, just give you a different error message at the cabal layer."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1461777528, "post_id": 36882594, "comment_id": 61357444, "body": "@orm This is in general an unsolved problem: if you put in an upper bound then you risk breaking a build that would work perfectly well, but if you don&#39;t put in an upper bound then this kind of thing happens. &quot;stack&quot; (<a href=\"http://www.haskellstack.org/\" rel=\"nofollow noreferrer\">haskellstack.org</a>) offers a combination of packages that are known to build together, which is better than nothing."}], "owner": {"reputation": 2425, "user_id": 2392147, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/09f00344014ef1858c322172cc0a1be3?s=128&d=identicon&r=PG&f=1", "display_name": "orm", "link": "https://stackoverflow.com/users/2392147/orm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461740410, "creation_date": 1461740410, "question_id": 36882594, "link": "https://stackoverflow.com/questions/36882594/build-error-on-dependencies-when-using-cabal", "title": "build error on dependencies when using cabal", "body": "<p>I am building a small project, and when cabal attempts to install MissingH 1.3.0, it runs into a compiler error (name clash):</p>\n\n<pre><code>src/System/IO/HVFS.hs:287:23:\n    Ambiguous occurrence \u2018isSymbolicLink\u2019\n    It could refer to either \u2018System.IO.PlafCompat.isSymbolicLink\u2019,\n                             imported from \u2018System.IO.PlafCompat\u2019 at src/System/IO/HVFS.hs:60:1-27\n                             (and originally defined in \u2018unix-2.7.2.0:System.Posix.Files.Common\u2019)\n                          or \u2018System.Directory.isSymbolicLink\u2019,\n                             imported from \u2018System.Directory\u2019 at src/System/IO/HVFS.hs:63:1-23\ncabal: Error: some packages failed to install:\nMissingH-1.3.0.1 failed during the building phase.\n</code></pre>\n\n<p>The thing that puzzles me is that I'd have thought the versions in the .cabal file either produce a working build, or a contradiction involving the versions required, but not a build error.  I've verified I can build MissingH on its own, but some other packages I depend on seem to cause this problem (here's the other packages I'm naming the .cabal file, in case that helps reproduce the problem). </p>\n\n<pre><code>  build-depends:   base &gt;=4.7 &amp;&amp; &lt;4.8\n                 , groom==0.1.2\n                 , containers&gt;=0.5.7\n                 , sexp==0.7\n                 , bytestring==0.10.6.0\n                 , hashmap==1.3.0.1\n                 , MissingH==1.3.0.1\n</code></pre>\n\n<p>Any pointers?</p>\n"}, {"tags": ["haskell", "build", "compiler-construction", "cabal", "bnfc"], "comments": [{"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1606220386, "post_id": 36879360, "comment_id": 114891570, "body": "Here is an issue about adding support for BNFC to Cabal: <a href=\"https://github.com/haskell/cabal/issues/6726\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/6726</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": false, "score": 3, "last_activity_date": 1461736985, "creation_date": 1461736985, "answer_id": 36881504, "question_id": 36879360, "link": "https://stackoverflow.com/questions/36879360/hooking-up-a-build-tool-in-cabal-haskell/36881504#36881504", "title": "Hooking up a build tool in Cabal (Haskell)", "body": "<p>Apparently cabal doesn't know about bnfc (doesn't appear on <a href=\"https://github.com/haskell/cabal/blob/master/Cabal/Distribution/Simple/Program/Builtin.hs\" rel=\"nofollow\">the list</a>).</p>\n\n<p>Looks like there's no way to do it using just the .cabal file, but there's an example of how to hook up a preprocessor in your <code>Setup.hs</code> in the <a href=\"https://github.com/haskell/cabal/blob/4004b2c38c1e412a84b7ff3e895bb6a61131184b/Cabal/tests/PackageTests/CustomPreProcess/Setup.hs\" rel=\"nofollow\">cabal sources under tests/PackageTests/CustomPreProcess/Setup.hs</a> using the user hook <code>hookedPreProcessors</code> (all hooks are in <a href=\"https://github.com/haskell/cabal/blob/75db3da256f4f413c0d9fdd7b74d00b36d9533c7/Cabal/Distribution/Simple/UserHooks.hs\" rel=\"nofollow\">UserHooks.hs</a>)</p>\n"}], "owner": {"reputation": 311, "user_id": 5803465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7346402b78bdd223b92798bef605773c?s=128&d=identicon&r=PG&f=1", "display_name": "user5803465", "link": "https://stackoverflow.com/users/5803465/user5803465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1461736985, "creation_date": 1461725151, "last_edit_date": 1461729992, "question_id": 36879360, "link": "https://stackoverflow.com/questions/36879360/hooking-up-a-build-tool-in-cabal-haskell", "title": "Hooking up a build tool in Cabal (Haskell)", "body": "<p>I was trying to use <code>bnfc</code> tool to generate a bunch of files, like lexer, parser, etc. for me. This works fine. Now I wanted to clean this up a bit by not having to manually compile the <code>bnfc</code> file and having it generate a number of files which clutter my <code>/src</code> folder. </p>\n\n<p>I tried the Cabal mechanism where you list the tool in <code>build-tools</code> field of the <code>.cabal</code> file and mention the files you expect to be generated by <code>extra-source-files</code> field. This worked for me for Alex and Happy as they are recognised as  build-tools by Cabal but <code>bnfc</code> isn't. Is there a way I can hook up <code>bnfc</code> or any tool in general with Cabal and have Cabal recognise them as build-tools?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461718229, "post_id": 36878340, "comment_id": 61322880, "body": "are the blocks of numbers always contiguous values in groups of 7?"}, {"owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461718295, "post_id": 36878340, "comment_id": 61322893, "body": "@jamshidh They are always in groups of 7 but not always containing consecutive values."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461720811, "post_id": 36878340, "comment_id": 61323506, "body": "For this specific function, I would be tempted to write something like <code>function p = [lo .. lo+6] where lo = 7 * div p 7</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461749458, "post_id": 36878340, "comment_id": 61336047, "body": "@DanielWagner: this function does not return the empty list in case <code>p</code> is less than zero or greater than 20."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1461781551, "post_id": 36878340, "comment_id": 61360045, "body": "@WillemVanOnsem Yes, I know. I consider that a feature. =)"}], "answers": [{"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1461718626, "post_id": 36878409, "comment_id": 61322975, "body": "According to the question, the values are not always contiguous. So this unfortunately won&#39;t work."}, {"owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 1, "creation_date": 1461718665, "post_id": 36878409, "comment_id": 61322988, "body": "Oh wow, why didn&#39;t I think of that! Thanks! This works for some of the conditions. :)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1461741057, "post_id": 36878409, "comment_id": 61330629, "body": "@Sibi: therefore I&#39;ve updated the question with two additional alternatives."}, {"owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 0, "creation_date": 1461764448, "post_id": 36878409, "comment_id": 61347473, "body": "@WillemVanOnsem Let me make sure I&#39;m understanding how the last approach works.  I&#39;m confused about how this portion (\\x -&gt; zip x (repeat x)) works. Is it just generating an infinite list of x values to pair with the input list?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 0, "creation_date": 1461766298, "post_id": 36878409, "comment_id": 61348953, "body": "@heysharynne: no it generates tuples of <code>(i,l)</code> with <code>i</code> an item in the list and <code>l</code> the entire list. I will update the answer."}, {"owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 0, "creation_date": 1461766997, "post_id": 36878409, "comment_id": 61349537, "body": "@WillemVanOnsem Oh I see. It is simply making a tuple of an element in the list and the list that contains it which makes lookup possible. Similar-ish to how hashing work, right?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1461767544, "post_id": 36878409, "comment_id": 61350013, "body": "Yes, but as far as I know a <code>Map</code> is implemented as binary search tree. It simply accepts as input a list of key/value tuples and will store them in the binary search tree."}, {"owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 1, "creation_date": 1461767607, "post_id": 36878409, "comment_id": 61350060, "body": "@WillemVanOnsem Thanks a lot for your help!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1461766722, "last_edit_date": 1495540356, "creation_date": 1461718443, "answer_id": 36878409, "question_id": 36878340, "link": "https://stackoverflow.com/questions/36878340/how-to-shorten-a-haskell-implementation-like-this/36878409#36878409", "title": "How to shorten a Haskell implementation like this?", "body": "<p>What about simple bounds checks?</p>\n\n<pre><code>function p\n    | p &lt; 0 = [] \n    | p &lt; 7 = [0..6]\n    | p &lt; 14 = [7..13]\n    | p &lt; 21 = [14..20]\n    | otherwise = []\n</code></pre>\n\n<p>It will be faster and for some applications use less memory.</p>\n\n<p>If you don't want to perform a bounds check (but an element check), you can still use the shortened list notation.</p>\n\n<hr>\n\n<p>Alternatively, you could construct a helper function that iterates over the lists:</p>\n\n<pre><code>helper (x:xs) p | elem p x = x\n                | otherwise = helper xs p \nhelper [] _ = []\n\nfunction = helper [[0..6],[7..13],[14..20]]\n</code></pre>\n\n<p>Although this is actually longer, you can easily extend the <code>function</code> to use other lists. Note however that this function will be slower, since <code>elem</code> requires <em>O(n)</em> time whereas a bounds check takes <em>O(1)</em> time.</p>\n\n<hr>\n\n<p>You can also - as is suggested in <a href=\"https://stackoverflow.com/a/36878452/67579\">@jamshidh's answer</a> construct a <code>Data.Map</code> which is a datastructure that guarantees <em>O(log n)</em> lookup time:</p>\n\n<pre><code>import Data.Map (Map)\nimport qualified Data.Map as Map\nimport Data.Maybe(fromMaybe)\n\nhelper2 :: Ord a =&gt; [[a]] -&gt; a -&gt; [a]\nhelper2 lst p = fromMaybe [] $ Map.lookup p (Map.fromList $ concatMap (\\x -&gt; zip x (repeat x)) lst)\n\nfunction = helper2 [[0..6],[7..13],[14..20]]\n</code></pre>\n\n<p>For this last piece, it generates <code>(\\x -&gt; zip x (repeat x))</code> generates for a list tuples containing an element of the list <code>e</code> and the entire list <code>l</code>. For example:</p>\n\n<pre><code>Prelude&gt; (\\x -&gt; zip x (repeat x)) [0..6]\n[(0,[0,1,2,3,4,5,6]),(1,[0,1,2,3,4,5,6]),(2,[0,1,2,3,4,5,6]),(3,[0,1,2,3,4,5,6]),(4,[0,1,2,3,4,5,6]),(5,[0,1,2,3,4,5,6]),(6,[0,1,2,3,4,5,6])]\n</code></pre>\n\n<p>This works as follows: <code>x</code> unifies with a list, for instance <code>[0,1,2,3,4,5,6]</code>, now we apply a <code>zip</code> function on <code>[0,1,2,3,4,5,6]</code> and on the infinite list <code>[[0,1,2,3,4,5,6],[0,1,2,3,4,5,6],[0,1,2,3,4,5,6],....]</code>. <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:zip\" rel=\"nofollow noreferrer\"><code>zip</code></a> generates tuples as long as both lists feed elements, so it takes the first element from <code>[0,1,..,6]</code> and the first from <code>[[0,1,..,6],[0,1,..,6],[0,1,..,6],...]</code> so the resulting tuple is <code>(0,[0..6])</code>, next it takes the second element <code>1</code> from the list, and the second item from the <code>repeat</code> function, thus <code>(1,[0..6])</code>. It keeps doing this -- although lazily -- until one of the lists is exhausted which is the case for the first list.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 0, "creation_date": 1461718742, "post_id": 36878452, "comment_id": 61323009, "body": "How does this affect the efficiency of the program? Is it any faster?"}, {"owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 0, "creation_date": 1461718808, "post_id": 36878452, "comment_id": 61323031, "body": "This definitely beats using <code>elem</code>, I believe"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "edited": false, "score": 0, "creation_date": 1461718849, "post_id": 36878452, "comment_id": 61323047, "body": "If you convert to Map (using fromList), then once the mapping is created, it will be much faster, because you won&#39;t have to traverse the list using <code>elem</code>.  I kept it at standard list lookup, but map works the same way."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1461720025, "post_id": 36878452, "comment_id": 61323320, "body": "@jamshidh: only problem I can still think of is that it will not return <code>[]</code> in case not found. You can solve this however using <code>fromMaybe</code>."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1461720194, "post_id": 36878452, "comment_id": 61323362, "body": "@WillemVanOnsem I think the Maybe is actually a better output than empty list (even though the question shows otherwise).  You are correct though, converting is easy."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1461720284, "post_id": 36878452, "comment_id": 61323388, "body": "2nd that. Did +1 btw :)"}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 4, "last_activity_date": 1461718701, "creation_date": 1461718701, "answer_id": 36878452, "question_id": 36878340, "link": "https://stackoverflow.com/questions/36878340/how-to-shorten-a-haskell-implementation-like-this/36878452#36878452", "title": "How to shorten a Haskell implementation like this?", "body": "<p>First create the list of lists</p>\n\n<pre><code>lists = [[0,1,2,3,4,5,6], [7,8,9,10,11,12,13], [14,15,16,17,18,19,20]]\n</code></pre>\n\n<p>Then create a mapping from value to list</p>\n\n<pre><code>theMap = concat $ map (\\x -&gt; zip x (repeat x)) lists\n</code></pre>\n\n<p>This will give you what you need</p>\n\n<pre><code>&gt; lookup 1\nJust [0,1,2,3,4,5,6]\n</code></pre>\n\n<p>Note that the output is a <code>Maybe</code>, in the case you don't supply a value in any list.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461720678, "post_id": 36878663, "comment_id": 61323475, "body": "I&#39;m almost certain that there is a way to take the <i>first</i>, rather than the <i>only</i>, choice of <code>x</code> for which <code>elem p x</code> is true."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1461719995, "creation_date": 1461719995, "answer_id": 36878663, "question_id": 36878340, "link": "https://stackoverflow.com/questions/36878340/how-to-shorten-a-haskell-implementation-like-this/36878663#36878663", "title": "How to shorten a Haskell implementation like this?", "body": "<p>You can use the list monad here.</p>\n\n<pre><code>func p = join $ do x &lt;- [[1,3,5], [2,4,6], [7,8,9]]\n                   guard $ p `elem` x\n                   return x\n</code></pre>\n\n<p>The list of lists are the things you want to check against. The call to <code>guard</code> filters out the choices that don't succeed. As long as the candidate lists are disjoint, at most one will succeed. <code>return x</code> evaluates to either <code>[]</code> or <code>[x]</code> for one of the choices of <code>x</code>, so <code>join</code>\nreduces <code>[x]</code> to <code>[]</code>.</p>\n\n<pre><code>&gt; func 1\n[1,3,5]\n&gt; func 2\n[2,4,6]\n&gt; func 7\n[7,8,9]\n&gt; func 10\n[]\n</code></pre>\n\n<p>As a list comprehension, it would look like</p>\n\n<pre><code>func p = join [x | x &lt;-[[1,3,5],[2,4,6],[7,8,9]], p `elem` x]\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 36878409, "answer_count": 3, "score": 3, "last_activity_date": 1461766722, "creation_date": 1461717984, "last_edit_date": 1461720585, "question_id": 36878340, "link": "https://stackoverflow.com/questions/36878340/how-to-shorten-a-haskell-implementation-like-this", "title": "How to shorten a Haskell implementation like this?", "body": "<p>I have a function with a lot of guards that look like this: </p>\n\n<pre><code>function \n    | p `elem` [0,1,2,3,4,5,6] = [0,1,2,3,4,5,6]\n    | p `elem` [7,8,9,10,11,12,13] = [7,8,9,10,11,12,13]\n    | p `elem` [14,15,16,17,18,19,20] = [14,15,16,17,18,19,20]\n    | otherwise = []\n</code></pre>\n\n<p>I'm sure I can write this much shorter with Haskell. If not, then it's okay. I'm new to Haskell and I would love to become better at it by learning different approaches.</p>\n\n<p>Perhaps using \"map\" may be a good start? But then, I'm not sure how to pass in those specific lists. </p>\n\n<p>The values are not always contiguous. </p>\n"}, {"tags": ["python", "arrays", "haskell", "largenumber"], "comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 2, "creation_date": 1461717579, "post_id": 36878133, "comment_id": 61322697, "body": "Wow, I&#39;ve never heard anyone call Haskell a simple language before. :)"}, {"owner": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461717768, "post_id": 36878133, "comment_id": 61322742, "body": "I dont master it (obviously) but I find it more intuitive and &quot;forgiving&quot; compared to C++ or java for example ... :P"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 2, "creation_date": 1461717833, "post_id": 36878133, "comment_id": 61322764, "body": "Haskell- makes hard things easy, and easy things hard. :)"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "edited": false, "score": 0, "creation_date": 1461717670, "post_id": 36878183, "comment_id": 61322720, "body": "thanks but a big part of my problem is how to insert my 100k digits I have them in a txt format so how could I link &quot;my_digits&quot; to that file? or is there a sensible way to make python calculate pi digit by digit as it goes to fill it into the bins?"}, {"owner": {"reputation": 92930, "user_id": 541038, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a82559ae1ee7ec304fdbae095f063c?s=128&d=identicon&r=PG", "display_name": "Joran Beasley", "link": "https://stackoverflow.com/users/541038/joran-beasley"}, "reply_to_user": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "edited": false, "score": 0, "creation_date": 1461732772, "post_id": 36878183, "comment_id": 61326745, "body": "<code>my_digits = iter(lambda:my_open_file.read(1),None)</code>"}], "tags": [], "owner": {"reputation": 92930, "user_id": 541038, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3a82559ae1ee7ec304fdbae095f063c?s=128&d=identicon&r=PG", "display_name": "Joran Beasley", "link": "https://stackoverflow.com/users/541038/joran-beasley"}, "is_accepted": false, "score": 0, "last_activity_date": 1461716986, "creation_date": 1461716986, "answer_id": 36878183, "question_id": 36878133, "link": "https://stackoverflow.com/questions/36878133/summing-the-digits-of-a-very-large-number/36878183#36878183", "title": "Summing the digits of a very large number", "body": "<pre><code>bins = [0,0,0,0] # four bins\nfor i,n in itertools.izip(itertools.cycle([0,1,2,3]),my_digits):\n    bins[i] += int(n)\n</code></pre>\n\n<p>I guess... and just print it sometimes</p>\n\n<pre><code>bins = [0,0,0,0] # four bins\nnum_bins = 4\nfor i,n in enumerate(my_digits):\n    bins[i%num_bins] += int(n)\n    if i % 100: print( bins ) # every 100 items print \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "edited": false, "score": 0, "creation_date": 1461761548, "post_id": 36889521, "comment_id": 61345057, "body": "Thanks I think I get most of whats happenning here :D only &quot;blury&quot; thing for me is the &quot;(zipWith (+))&quot;  I suppose this adds each digit that lands over the individual chunk?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "edited": false, "score": 0, "creation_date": 1461761768, "post_id": 36889521, "comment_id": 61345236, "body": "exacly <code>zipWith (+) [1,2,3,4] [5,6,7,8] =&gt; [6,8,10,12]</code> note if one list is shorter than the other <code>zipWith</code> shrinks the resultlist to the size of the smaller, so you can handle infinite lists as well <code>zipWith (+) [1] [1..] =&gt; [2]</code>"}, {"owner": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "edited": false, "score": 0, "creation_date": 1461762198, "post_id": 36889521, "comment_id": 61345580, "body": "I havent run the code yet (will do very soon when I go back home and give my feedback if necessary or select this as an answer if everything runs smooth )  I just have my doubts about the print seems to me that the result will be a list of sums of each chunk while I need something more than that (inbetween results of lets say the first 100 &quot;zipWith&quot;s"}, {"owner": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "edited": false, "score": 0, "creation_date": 1461762201, "post_id": 36889521, "comment_id": 61345585, "body": "Also if I wanted to do an other zipWith in parraler (for example one that adds chunks of 4 and one that adds chunks of lets say 8 and then another of 12 etc and print all the result with the inbetween results included) how could I do all together at once instead of run the code several times? could I just  add lines  like let summator = foldl2&#39; (zipWith (+)) . chunksOf 8 let summator = foldl3&#39; (zipWith (+)) . chunksOf 12  And then what would the prin look like (having in mind also the &quot;inbetween results&quot; I meantioned above"}, {"owner": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "edited": false, "score": 0, "creation_date": 1461762270, "post_id": 36889521, "comment_id": 61345665, "body": "and sorry for the bad format still didnt figured out how to draw new lines in the comment section :P I am new to stuckoverflow :P"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1461789586, "last_edit_date": 1461789586, "creation_date": 1461759271, "answer_id": 36889521, "question_id": 36878133, "link": "https://stackoverflow.com/questions/36878133/summing-the-digits-of-a-very-large-number/36889521#36889521", "title": "Summing the digits of a very large number", "body": "<p>This would be a complete implementation in Haskell</p>\n\n<pre><code>import Data.List.Split (chunksOf)\nimport Data.List\nimport Data.Char (digitToInt)\n\nmain :: IO ()\nmain = do digits &lt;- map digitToInt &lt;$&gt; readFile \"pifile.txt\"\n          let summator = foldl1' (zipWith (+)) . chunksOf 4\n          print $ summator digits\n</code></pre>\n\n<p>I will update this with some explanation later this day.</p>\n\n<h1>Update @Comments</h1>\n\n<pre><code>main = do digits &lt;- map digitToInt &lt;$&gt; readFile \"pifile.txt\"\n              let summator = scanl1' (zipWith (+)) . chunksOf 4\n              mapM_ print $ take 100 $ summator digits\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 6135019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v7SqgD1j5VM/AAAAAAAAAAI/AAAAAAAAACw/LPQ98palQzU/photo.jpg?sz=128", "display_name": "papajo", "link": "https://stackoverflow.com/users/6135019/papajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "closed_date": 1487400309, "accepted_answer_id": 36889521, "answer_count": 2, "score": -6, "last_activity_date": 1487358640, "creation_date": 1461716665, "last_edit_date": 1487358640, "question_id": 36878133, "link": "https://stackoverflow.com/questions/36878133/summing-the-digits-of-a-very-large-number", "closed_reason": "Needs more focus", "title": "Summing the digits of a very large number", "body": "<p>I want to sum the digits of the first 100.000 digits of pie (I have text with the numbers),\nbut I want to do it in a specific form.</p>\n\n<p>I want to put the digits in a matrix (or whatever is convenient as a placeholder) with a small number of cells predefined by me and overlap the digits in those cells.</p>\n\n<p>What I mean is this: lets say we have this list of numbers (31415926535)</p>\n\n<p>and lets say we have 4 cells j,j1,j2,j3</p>\n\n<p>in the first run j=3,j1=1,j2=4,j3=1 notice that each cell has been assigned with a number of the list and and the digits that are left in the list are (5926535) so I want to overlap them so that \nj=8 (since its value was 3 and now 5 is added), j1=10 (1 + 9) , j2=6 j3=7</p>\n\n<p>And I want to do that for all my 100k digits</p>\n\n<p>But I want to add an other twist on top of that</p>\n\n<p>I want to print results after x amount of cycles (by cycles I mean one run like in the above example assigning j,j1,j2,j3 with 3,1,4,1 would be the 1st cycle) as well as the final result. </p>\n\n<p>I would prefer a simple language such as python or haskell </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461722268, "post_id": 36878083, "comment_id": 61323906, "body": "<code>AD.jacobian (fmap realToFrac . f1 . fmap realToFrac)</code>"}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461753640, "post_id": 36878083, "comment_id": 61339109, "body": "Thank you @user2407038 ; it works, after diking out all the type annotations. Now I&#39;d like to understand <i>why</i> the type constraints simplify so much, by just applying that double pass of <code>realToFrac</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461767058, "post_id": 36878083, "comment_id": 61349598, "body": "The <code>realToFrac</code> just converts from <code>Reverse s CDouble</code> to <code>CDouble</code> and back. <code>Reverse</code> has an instance <code>(Reifies s Tape, Fractional a) =&gt; Fractional (Reverse s a)</code> and <code>(Reifies s Tape, Real a) =&gt; Real (Reverse s a)</code> which allows this conversion to happen. The use of <code>realToFrac</code> does not simplify the constraint - the type you have given <code>go</code> is just more general than it needs to be to begin with. You say it works for <i>any</i> <code>Mode t</code> (actually it will be <code>Fractional t, Real t</code> now) but its only instantiated with one <code>t</code> - namely <code>Reverse s CDouble</code>."}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461788956, "post_id": 36878083, "comment_id": 61364689, "body": "@user2407038 , do you think there&#39;s a way around this double conversion? Because on one hand it does typecheck, but on the other all the derivatives are zeroed out due to it. I suspect there&#39;s a loss of precision involved"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461745982, "creation_date": 1461716322, "last_edit_date": 1461745982, "question_id": 36878083, "link": "https://stackoverflow.com/questions/36878083/ad-type-unification-error-with-constrained-type-vector", "title": "AD, type unification error with constrained-type Vector", "body": "<p>I need to find the Jacobian of a <code>V.Vector CDouble -&gt; V.Vector CDouble</code> function.</p>\n\n<p>While trying to produce a minimal example from the answer  <a href=\"https://stackoverflow.com/questions/29391114/how-to-do-automatic-differentiation-on-complex-datatypes\">How to do automatic differentiation on complex datatypes?</a> , I still stumble on a knot of type unification problems. The closest I got so far (complete code below) gives me the following error :</p>\n\n<pre><code>    Could not deduce (t ~ CDouble)\n    from the context (a ~ CDouble)\n      bound by the type signature for\n                 jf1 :: a ~ CDouble =&gt; V.Vector a -&gt; V.Vector (V.Vector a)\n      at ADMode.hs:17:8-69\n    or from (AD.Scalar t ~ a, AD.Mode t)\n      bound by the type signature for\n                 go :: (AD.Scalar t ~ a, AD.Mode t) =&gt; V.Vector t -&gt; V.Vector t\n      at ADMode.hs:19:9-74\n      \u2018t\u2019 is a rigid type variable bound by\n          the type signature for\n            go :: (AD.Scalar t ~ a, AD.Mode t) =&gt; V.Vector t -&gt; V.Vector t\n          at ADMode.hs:19:16\n    Expected type: V.Vector t\n      Actual type: V.Vector CDouble\n</code></pre>\n\n<p>Note: I added the instance <code>AD.Mode CDouble</code> and the constraint <code>(a ~ CDouble)</code> on the type of <code>jf1</code>; these, AFAICT, are the only relevant changes w.r.t. the referenced SO answer.</p>\n\n<hr>\n\n<pre><code>{-# language TypeFamilies, RankNTypes, ScopedTypeVariables #-}\nmodule ADMode where\n\nimport Foreign.C.Types\n\nimport qualified Numeric.AD as AD\nimport qualified Data.Vector as V\n\nf1 :: V.Vector CDouble -&gt; V.Vector CDouble\nf1 = V.map (**2)\n\njf1 :: forall a. (a ~ CDouble) =&gt; V.Vector a -&gt; V.Vector (V.Vector a)\njf1 = AD.jacobian go where\n  go :: forall t. (AD.Scalar t ~ a, AD.Mode t) =&gt; V.Vector t -&gt; V.Vector t\n  go x = f1 (V.map AD.auto x)\n\ninstance AD.Mode CDouble where\n  type Scalar CDouble = CDouble\n  -- isKnownConstant _ = True\n  -- isKnownZero x = 0 == x\n  auto = id\n  -- (^/) = (/)\n</code></pre>\n\n<p>I confess I still don't understand the role of the double existential quantification, and how type constraint hints (namely, <code>~</code>) interact with the type inference. On the other hand, I simply wish to make this little contraption work, for the time being ..</p>\n\n<p>Any and all hints and explanations are very welcome. Thank you in advance</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461759574, "post_id": 36878204, "comment_id": 61343425, "body": "<code>sequence [arbitrary | _ &lt;- [1..firstLength]]</code> looks a lot like <code>replicateM firstLength arbitrary</code> to me!"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1461771514, "post_id": 36878204, "comment_id": 61353133, "body": "@epsilonhalbe I also prefer your way, but the comprehensions approach seems to be idiomatic in quickstart for some reason, see <a href=\"https://www.schoolofhaskell.com/user/griba/quick-check-generator-of-pair-List-index-where-index-within-list-range\" rel=\"nofollow noreferrer\">schoolofhaskell.com/user/griba/&hellip;</a>"}, {"owner": {"reputation": 1151, "user_id": 1564252, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/783d740f9740d9873e81e0c2fd713d31?s=128&d=identicon&r=PG", "display_name": "VSZM", "link": "https://stackoverflow.com/users/1564252/vszm"}, "edited": false, "score": 0, "creation_date": 1461776739, "post_id": 36878204, "comment_id": 61356917, "body": "Damn, I kind of forgot about actually generating the values with <code>_ &lt;-</code>.. Sorry for the trivial question, I was coding late hours. Thanks for the answer anyway."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 2, "last_activity_date": 1461717097, "creation_date": 1461717097, "answer_id": 36878204, "question_id": 36877977, "link": "https://stackoverflow.com/questions/36877977/quickcheck-generator-arbitrary-element-of-custom-type/36878204#36878204", "title": "QuickCheck Generator - Arbitrary element of custom type", "body": "<p>This works for me</p>\n\n<pre><code>instance Arbitrary a =&gt; Arbitrary (ZippList a) where\n  arbitrary = sized zipplist where\n    zipplist n = do\n        firstLength &lt;- choose (0, n)\n        let secondLength = n - firstLength\n        firstList &lt;- sequence [arbitrary | _ &lt;- [1..firstLength]]\n        secondList &lt;- sequence [arbitrary | _ &lt;- [1..secondLength]]\n        return $ ZPL (firstList, secondList)\n</code></pre>\n\n<p>Note that the definition of secondLength doesn't use a monad, so you should use <code>let</code></p>\n"}], "owner": {"reputation": 1151, "user_id": 1564252, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/783d740f9740d9873e81e0c2fd713d31?s=128&d=identicon&r=PG", "display_name": "VSZM", "link": "https://stackoverflow.com/users/1564252/vszm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 36878204, "answer_count": 1, "score": -2, "last_activity_date": 1461776751, "creation_date": 1461715617, "last_edit_date": 1461776751, "question_id": 36877977, "link": "https://stackoverflow.com/questions/36877977/quickcheck-generator-arbitrary-element-of-custom-type", "title": "QuickCheck Generator - Arbitrary element of custom type", "body": "<p>I am trying to generate arbitrary sized element for my custom data type:</p>\n\n<pre><code>newtype ZippList a = ZPL ([a], [a])\n    deriving (Show)\n</code></pre>\n\n<p>This is what I got:</p>\n\n<pre><code>instance Arbitrary a =&gt; Arbitrary (ZippList a) where\narbitrary = sized zipplist where\n    zipplist n = do\n        firstLength &lt;- choose(0,n)\n        secondLength &lt;- n - firstLength\n        firstList &lt;- [arbitrary :: Gen a | [1..firstLength]]\n        secondList &lt;- [arbitrary :: Gen a | [1..secondLength]]\n        return $ ZPL (firstList, secondList)\n</code></pre>\n\n<p>However it does not compile. The compilation fails for the generation of the two lists of a. How can I generate an arbitrary a?</p>\n\n<p>Damn, I kind of forgot about actually generating the values with <code>_ &lt;-</code>.. Sorry for the trivial question, I was coding late hours.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461710811, "post_id": 36876995, "comment_id": 61320770, "body": "could you add the complete error message and a complete source code function that throws the error. Also I think your source code is incorrect - the <code>let</code>-statement does not make sense in a file."}, {"owner": {"reputation": 583, "user_id": 701409, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f21305009ffc9ea31ca20ee04d1faecd?s=128&d=identicon&r=PG", "display_name": "McEnroe", "link": "https://stackoverflow.com/users/701409/mcenroe"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461712334, "post_id": 36876995, "comment_id": 61321251, "body": "@epsilonhalbe: done."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461712791, "post_id": 36876995, "comment_id": 61321388, "body": "I have not studied the code thoroughly but my guess would be either memcallback or cpucallback are wrong (add type signature) or <code>nets=</code> should be <code>nets &lt;-</code>"}, {"owner": {"reputation": 583, "user_id": 701409, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f21305009ffc9ea31ca20ee04d1faecd?s=128&d=identicon&r=PG", "display_name": "McEnroe", "link": "https://stackoverflow.com/users/701409/mcenroe"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461714109, "post_id": 36876995, "comment_id": 61321772, "body": "Those parts do work. If you replace <code>nets = </code> with the commented out version on the line above, everything compile and works fine (also, compare with <a href=\"https://github.com/travitch/taffybar/blob/master/taffybar.hs.example\" rel=\"nofollow noreferrer\">github.com/travitch/taffybar/blob/master/taffybar.hs.example</a> ). Except for the obvious issue that I only have a single hardcoded interface. If I do <code>nets &lt;-</code> ghc complains with a parse error that I&#39;m not in a <code>do</code> block."}], "answers": [{"comments": [{"owner": {"reputation": 583, "user_id": 701409, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f21305009ffc9ea31ca20ee04d1faecd?s=128&d=identicon&r=PG", "display_name": "McEnroe", "link": "https://stackoverflow.com/users/701409/mcenroe"}, "edited": false, "score": 0, "creation_date": 1461812400, "post_id": 36878847, "comment_id": 61372610, "body": "Thanks, this does indeed solve the issue. Do you think you could comment in a sentence or two what exactly I was doing (wrong) originally? I&#39;m still trying to develop the language to talk about Haskell code."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 583, "user_id": 701409, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f21305009ffc9ea31ca20ee04d1faecd?s=128&d=identicon&r=PG", "display_name": "McEnroe", "link": "https://stackoverflow.com/users/701409/mcenroe"}, "edited": false, "score": 0, "creation_date": 1461856058, "post_id": 36878847, "comment_id": 61399114, "body": "@McEnroe You might like sigfpe&#39;s <a href=\"http://blog.sigfpe.com/2007/11/io-monad-for-people-who-simply-dont.html\" rel=\"nofollow noreferrer\">introduction to IO</a>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1461721426, "creation_date": 1461721426, "answer_id": 36878847, "question_id": 36876995, "link": "https://stackoverflow.com/questions/36876995/haskell-reading-from-fs-to-dynamically-create-widgets-in-taffybar/36878847#36878847", "title": "Haskell: Reading from FS to &quot;dynamically&quot; create widgets in taffybar", "body": "<p>I haven't tested this as I usually do, since I don't have taffybar installed on this machine, but I suspect the following small change should help you make progress:</p>\n\n<pre><code>main = do\n  let memCfg = defaultGraphConfig { graphDataColors = [(1, 0, 0, 1)] }\n      cpuCfg = defaultGraphConfig { graphDataColors = [ (0, 1, 0, 1)\n                                                      , (1, 0, 1, 0.5)\n                                                      ]\n                                  }\n      clock = textClockNew Nothing \"&lt;span fgcolor='orange'&gt;%a %b %d %H:%M&lt;/span&gt;\" 1\n      pager = taffyPagerNew myPagerConfig\n      mem = pollingGraphNew memCfg 1 memCallback\n      cpu = pollingGraphNew cpuCfg 1 cpuCallback\n      bat = textBatteryNew \"$percentage$% $time$\" 1\n      tray = systrayNew\n\n  -- this line is the only one that changed\n  nets &lt;- fmap  (fmap (netMonitorNew 1)) netDevList\n\n  defaultTaffybar defaultTaffybarConfig { startWidgets = [ pager ]\n                                        , endWidgets = [ tray, clock, mem, cpu] ++ nets ++ [ bat ]\n                                        }\n</code></pre>\n\n<p>There may be other problems, but this should address the one described in the question.</p>\n\n<p>There are plenty of stylistic changes that could/should be made as well, of course; for example, I think I would probably write the last two lines this way instead:</p>\n\n<pre><code>  nets &lt;- netDevList\n  defaultTaffybar ... { ..., endWidgets = ... ++ map netMonitorNew nets ++ ... }\n</code></pre>\n"}], "owner": {"reputation": 583, "user_id": 701409, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f21305009ffc9ea31ca20ee04d1faecd?s=128&d=identicon&r=PG", "display_name": "McEnroe", "link": "https://stackoverflow.com/users/701409/mcenroe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 36878847, "answer_count": 1, "score": 0, "last_activity_date": 1461721426, "creation_date": 1461710033, "last_edit_date": 1461712671, "question_id": 36876995, "link": "https://stackoverflow.com/questions/36876995/haskell-reading-from-fs-to-dynamically-create-widgets-in-taffybar", "title": "Haskell: Reading from FS to &quot;dynamically&quot; create widgets in taffybar", "body": "<p>I'm trying to use taffybar as my status bar (uses Dyre framework so configuration is code). It has a widget that can show network interface statistics. In the default configuration this widget requires a <code>String</code> at compile time. I want it to create a widget per (non-loopback) interface dynamically instead.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>listNetworkDevices :: IO [String]\nlistNetworkDevices = fmap (map takeBaseName) $ getDirectoryContents \"/sys/class/net/\"\n\nfilterOutLoopback :: [String] -&gt; [String]\nfilterOutLoopback = filter (\\y -&gt; not (elem y [\"\", \".\", \"lo\"]))\n\nnetDevList :: IO [String]\nnetDevList = fmap filterOutLoopback listNetworkDevices\n\n...\n\nlet nets = fmap (fmap (netMonitorNew 1)) netDevList\n    ...\ndefaultTaffybar defaultTaffybarConfig {\n    ...\n    endWidgets = [ tray, clock, mem, cpu] ++ nets ++ [ bat ]\n}\n</code></pre>\n\n<p>At this point I'm down to the following compiler error:</p>\n\n<pre><code>Couldn't match expected type \u2018[IO gtk-0.14.2:Graphics.UI.Gtk.Types.Widget]\u2019\n            with actual type \u2018IO [IO gtk-0.14.2:Graphics.UI.Gtk.Types.Widget]\u2019\n</code></pre>\n\n<p>Overall this the error makes sense since I'm making an <code>IO Widget</code> out of every <code>String</code>. So <code>IO [String]</code> turns into <code>IO [IO Widget]</code>.</p>\n\n<p>What I don't understand is how to avoid doing this. Clearly I must have gone wrong at some point but I can't see where. I'm not even sure how to put the issue in words. I would be glad for any pointers!</p>\n\n<p>Relevant material:</p>\n\n<ul>\n<li>endWidgets docs: <a href=\"https://hackage.haskell.org/package/taffybar-0.4.6/docs/System-Taffybar.html#v:endWidgets\" rel=\"nofollow\">https://hackage.haskell.org/package/taffybar-0.4.6/docs/System-Taffybar.html#v:endWidgets</a></li>\n<li>netMonitorNew docs: <a href=\"https://hackage.haskell.org/package/taffybar-0.4.6/docs/System-Taffybar-NetMonitor.html#v:netMonitorNew\" rel=\"nofollow\">https://hackage.haskell.org/package/taffybar-0.4.6/docs/System-Taffybar-NetMonitor.html#v:netMonitorNew</a></li>\n<li>Source on github: <a href=\"https://github.com/travitch/taffybar/tree/master/src/System/Taffybar\" rel=\"nofollow\">https://github.com/travitch/taffybar/tree/master/src/System/Taffybar</a></li>\n</ul>\n\n<p>Edit: complete listing:</p>\n\n<pre><code>import System.Taffybar\nimport System.Taffybar.Systray\nimport System.Taffybar.Pager\nimport System.Taffybar.TaffyPager\nimport System.Taffybar.SimpleClock\nimport System.Taffybar.Battery\nimport System.Taffybar.NetMonitor\nimport System.Taffybar.Weather\nimport System.Taffybar.Widgets.PollingBar\nimport System.Taffybar.Widgets.PollingGraph\nimport System.Information.Memory\nimport System.Information.CPU\nimport System.Directory ( getDirectoryContents )\nimport System.FilePath ( takeBaseName )\nimport Control.Monad\n\nmemCallback = do\n  mi &lt;- parseMeminfo\n  return [memoryUsedRatio mi]\n\ncpuCallback = do\n  (userLoad, systemLoad, totalLoad) &lt;- cpuLoad\n  return [totalLoad, systemLoad]\n\nlistNetworkDevices :: IO [String]\nlistNetworkDevices = fmap (map takeBaseName) $ getDirectoryContents \"/sys/class/net/\"\n\nfilterOutLoopback :: [String] -&gt; [String]\nfilterOutLoopback = filter (\\y -&gt; not (elem y [\"\", \".\", \"lo\"]))\n\nnetDevList :: IO [String]\nnetDevList = fmap filterOutLoopback listNetworkDevices\n\nmyPagerConfig = defaultPagerConfig {}\n\nmain = do\n  let memCfg = defaultGraphConfig { graphDataColors = [(1, 0, 0, 1)] }\n      cpuCfg = defaultGraphConfig { graphDataColors = [ (0, 1, 0, 1)\n                                                      , (1, 0, 1, 0.5)\n                                                      ]\n                                  }\n      clock = textClockNew Nothing \"&lt;span fgcolor='orange'&gt;%a %b %d %H:%M&lt;/span&gt;\" 1\n      pager = taffyPagerNew myPagerConfig\n      mem = pollingGraphNew memCfg 1 memCallback\n      cpu = pollingGraphNew cpuCfg 1 cpuCallback\n      bat = textBatteryNew \"$percentage$% $time$\" 1\n      tray = systrayNew\n\n      --nets = [ netMonitorNew 1 \"wlp0s2\" ]\n      nets = fmap  (fmap (netMonitorNew 1)) netDevList\n\n  defaultTaffybar defaultTaffybarConfig { startWidgets = [ pager ]\n                                        , endWidgets = [ tray, clock, mem, cpu] ++ nets ++ [ bat ]\n                                        }\n</code></pre>\n\n<p>Edit: Error message:</p>\n\n<pre><code>.config/taffybar/taffybar.hs:\n    Couldn't match expected type \u2018[IO\n                                     gtk-0.14.2:Graphics.UI.Gtk.Types.Widget]\u2019\n                with actual type \u2018IO [IO gtk-0.14.2:Graphics.UI.Gtk.Types.Widget]\u2019\n    In the first argument of \u2018(++)\u2019, namely \u2018nets\u2019\n    In the second argument of \u2018(++)\u2019, namely \u2018nets ++ [bat]\u2019\n</code></pre>\n"}, {"tags": ["haskell", "compiler-construction", "jit"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 6, "creation_date": 1461701369, "post_id": 36874748, "comment_id": 61316218, "body": "why would static typechecking prevent one from writing a JIT? In fact, it&#39;s easier to JIT a statically-typed language than a dynamically-typed one."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 2, "creation_date": 1461701450, "post_id": 36874748, "comment_id": 61316261, "body": "A JIT compiler is just a regular compiler that you run a lot :) ."}, {"owner": {"reputation": 497, "user_id": 2989693, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/CiVUC.jpg?s=128&g=1", "display_name": "ShivanKaul", "link": "https://stackoverflow.com/users/2989693/shivankaul"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1461702150, "post_id": 36874748, "comment_id": 61316693, "body": "@TheParamagneticCroissant Hmm, the whole point of a statically typechecked language is that it is typechecked at compile time, right? From what I understand, a JIT compiler would compile source language to native code at run-time. But wouldn&#39;t this defeat the point of static type checking? Perhaps I&#39;m missing something fundamental."}, {"owner": {"reputation": 497, "user_id": 2989693, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/CiVUC.jpg?s=128&g=1", "display_name": "ShivanKaul", "link": "https://stackoverflow.com/users/2989693/shivankaul"}, "edited": false, "score": 0, "creation_date": 1461702342, "post_id": 36874748, "comment_id": 61316797, "body": "Note that I&#39;m talking about the case where I&#39;m compiling .hs to native code, and not .hs -&gt; bytecode/some IR. In the latter case, I understand how the benefits of static type checking would come into play."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461703853, "post_id": 36874748, "comment_id": 61317712, "body": "you are talking about the compiler telling the programmer her mistakes? Yes that&#39;s a bit defeated - but still the JIT could reject programs still faster than running them"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1461704442, "post_id": 36874748, "comment_id": 61318046, "body": "Possible? Sure. You can do the same with C or C++ too...The advantage of JIT is that when compiling it can make use of some runtime information such as: which pieces of code are run more often, how the flow of the code goes on average, which data is being used and its average size/lifetime etc.  This helps in performing optimizations. JITs are a thing for dynamically typed languages because you can exploit runtime type information, but if you already have that a priori you simply have one less thing to worry about."}], "answers": [{"tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": true, "score": 2, "last_activity_date": 1461704749, "creation_date": 1461704749, "answer_id": 36875740, "question_id": 36874748, "link": "https://stackoverflow.com/questions/36874748/is-it-possible-to-write-a-just-in-time-jit-compiler-for-haskell/36875740#36875740", "title": "Is it possible to write a Just In Time (JIT) compiler for Haskell?", "body": "<p>This thesis about compiling a lazy functional language JIT might interest you: <a href=\"https://dl.dropboxusercontent.com/u/3265448/schilling.thesis.final.2014-01-20.pdf\" rel=\"nofollow\">https://dl.dropboxusercontent.com/u/3265448/schilling.thesis.final.2014-01-20.pdf</a></p>\n\n<p>Another two resources that might help on your quest:</p>\n\n<p><a href=\"http://www.dcc.fc.up.pt/~pbv/aulas/linguagens/peytonjones92implementing.pdf\" rel=\"nofollow\">http://www.dcc.fc.up.pt/~pbv/aulas/linguagens/peytonjones92implementing.pdf</a></p>\n\n<p><a href=\"http://research.microsoft.com/en-us/um/people/simonpj/Papers/pj-lester-book/\" rel=\"nofollow\">http://research.microsoft.com/en-us/um/people/simonpj/Papers/pj-lester-book/</a></p>\n"}], "owner": {"reputation": 497, "user_id": 2989693, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/CiVUC.jpg?s=128&g=1", "display_name": "ShivanKaul", "link": "https://stackoverflow.com/users/2989693/shivankaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 1, "closed_date": 1461704997, "accepted_answer_id": 36875740, "answer_count": 1, "score": 1, "last_activity_date": 1461704749, "creation_date": 1461701204, "question_id": 36874748, "link": "https://stackoverflow.com/questions/36874748/is-it-possible-to-write-a-just-in-time-jit-compiler-for-haskell", "closed_reason": "Needs more focus", "title": "Is it possible to write a Just In Time (JIT) compiler for Haskell?", "body": "<p>I'm interested in learning more about how Haskell compiles down to native code. I understand that Haskell is statically typechecked, which is why you might not want to do this. But is it possible? </p>\n"}, {"tags": ["haskell", "types", "grammar", "agda"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1461707204, "post_id": 36874369, "comment_id": 61319376, "body": "It may be the case that your object language&#39;s type system admits a clean interpretation in <code>Set</code>, but it should be clear that not every object language will embed straightforwardly. (Agda doesn&#39;t have linear types, for example.) So: what exactly are you trying to do? Prove theorems about your type system? Write a compiler?"}, {"owner": {"reputation": 792, "user_id": 3550444, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a06f855d0b44ead04edffa576cd943e?s=128&d=identicon&r=PG", "display_name": "Musa Al-hassy", "link": "https://stackoverflow.com/users/3550444/musa-al-hassy"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1462127530, "post_id": 36874369, "comment_id": 61496354, "body": "Neither; the above example comes from writing a grammar that admits well-formed type expressions (of an imperative language) but they are not all enumerated to begin with but rather allow the user of this code to create type(symbol)s when needed."}], "answers": [{"comments": [{"owner": {"reputation": 792, "user_id": 3550444, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a06f855d0b44ead04edffa576cd943e?s=128&d=identicon&r=PG", "display_name": "Musa Al-hassy", "link": "https://stackoverflow.com/users/3550444/musa-al-hassy"}, "edited": false, "score": 0, "creation_date": 1462562222, "post_id": 36880298, "comment_id": 61704498, "body": "I agree with you that in the spirit of separation-of-concerns, the <code>Atom</code> type would be quite useful. Thanks for that."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 3, "last_activity_date": 1461746852, "last_edit_date": 1461746852, "creation_date": 1461731157, "answer_id": 36880298, "question_id": 36874369, "link": "https://stackoverflow.com/questions/36874369/separation-of-concerns-when-is-it-best-to-disassociate-semantics-from-syntax/36880298#36880298", "title": "Separation of Concerns: when is it best to disassociate semantics from syntax?", "body": "<p>I think, first of all you should separate name-arity-semantics part from <code>Type</code>. Since every <code>Type</code> can be coerced to a <code>Set</code>, you can represent semantics as a function from <code>Set</code>s to <code>Set</code> rather than from <code>Type</code>s to <code>Set</code> (this is also strictly positive unlike your <code>Type\u2081</code>). Here is how it looks:</p>\n\n<pre><code>record Atom : Set\u2081 where\n  constructor packAtom\n  field\n    name      : String\n    arity     : \u2115\n    semantics : Func arity Set Set\n\nrecord Type : Set\u2081 where\n  inductive\n  constructor packType\n  field atom : Atom\n\n  open Atom atom\n\n  field parameters : Vec Type arity\n\nmutual\n  \u27e6_\u27e7 : Type -&gt; Set\n  \u27e6 packType (packAtom n ar sem) ts \u27e7 = \u27e6 ts \u27e7s sem\n\n  \u27e6_\u27e7s : \u2200 {ar} -&gt; Vec Type ar -&gt; Func ar Set Set -&gt; Set\n  \u27e6 []     \u27e7s A = A\n  \u27e6 t \u2237 ts \u27e7s F = \u27e6 ts \u27e7s (F \u27e6 t \u27e7) \n</code></pre>\n\n<p>Then your question can be restated as \"is there a way to force <code>arity</code> and <code>semantics</code> to be determined by a <code>name</code>?\". But Agda doesn't enforce global uniqueness of instances. Moreover, it seems like you want to internalize a meta-theorem \"there is a unique <code>semantics</code> for each <code>name</code>\", so you can use it from within your code, but that's just too much to want. Could you give an example of why this is required?</p>\n"}], "owner": {"reputation": 792, "user_id": 3550444, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a06f855d0b44ead04edffa576cd943e?s=128&d=identicon&r=PG", "display_name": "Musa Al-hassy", "link": "https://stackoverflow.com/users/3550444/musa-al-hassy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 3, "answer_count": 1, "score": 4, "last_activity_date": 1461746852, "creation_date": 1461699940, "last_edit_date": 1495540780, "question_id": 36874369, "link": "https://stackoverflow.com/questions/36874369/separation-of-concerns-when-is-it-best-to-disassociate-semantics-from-syntax", "title": "Separation of Concerns: when is it best to disassociate semantics from syntax?", "body": "<h2>Choices</h2>\n\n<p>Typeclasses are brilliant in that they allow us to adjoin extra structure to existing types. Thereby allowing us to defer some design decisions rather than making rushed decision at the time of conception.</p>\n\n<p>On the other hand, in object oriented programming, for example, we are forced to consider what a type needs to do immediately and any additional structure that is apparent, or needed, at a later time would be incorporated into a subtype.</p>\n\n<p>Everything has its purposes. I'm wondering when it would be best to do one or the other, in the context of Agda.</p>\n\n<h2>Non-contrived Example</h2>\n\n<p>Using the following for <code>n</code> -ary functions <code>s \u2192 s \u2192 ... \u2192 s \u2192 t</code>,</p>\n\n<pre><code>Func : \u2200 {\u2113} (a : \u2115) (s : Set \u2113) (t : Set \u2113) \u2192 Set \u2113\nFunc zero s t = t\nFunc (suc a) s t = s \u2192 Func a s t\n</code></pre>\n\n<p>When defining the syntax of a programming language, we might take a <em>type symbol</em> to be a named item that is 'formed' by taking a number of other such named items, and it's meaning is understood by an operation that takes the aforementioned parameters and produces an concrete Agda <code>Set</code>.</p>\n\n<pre><code>record Type\u2081 : Set\u2081 where\n constructor cons\u2081\n field\n  name\u2081      : String\n  arity\u2081     : \u2115\n  paramters\u2081 : Vec Type\u2081 arity\u2081\n  semantics\u2081 : Func arity\u2081 Type\u2081 Set\n\nopen Type\u2081\n</code></pre>\n\n<p>So we package the symbol and the interpretation into one type.\nAlternatively, we can separate the two:</p>\n\n<pre><code>record Type\u2082 : Set\u2081 where \n constructor cons\u2082\n field\n  name\u2082      : String\n  arity\u2082     : \u2115\n  paramters  : Vec Type\u2082 arity\u2082\n\nopen Type\u2082 {{...}}\n\nrecord HasMeaning (t : Type\u2082) : Set\u2081 where\n  field\n    semantics\u2082 : Func (arity\u2082 {{t}}) Type\u2082 Set\n\nopen HasMeaning {{...}}\n</code></pre>\n\n<p>( Note that we needed <code>Type\u2082</code> to live in <code>Set\u2081</code>, even though it really lives in <code>Set</code>, due to using <code>Func</code> above in <code>HasMeaning</code>. )</p>\n\n<p>Which is best and why?\nIn particular, which is better from the point of view of programming and which is better from the view of proving?</p>\n\n<h2>Semantics</h2>\n\n<p>Say we actually want to do things with our type(symbols), such as interpret them as actual Agda types, then we can do so easily with the first definition:</p>\n\n<pre><code>\u27e6_\u27e7\u2081 : Type\u2081 \u2192 Set \n\u27e6 cons\u2081 name\u2081 0 [] semantics\u2081 \u27e7\u2081 = semantics\u2081\n\u27e6 cons\u2081 name\u2081 (suc n) (hd \u2237 tl) semantics\u2081 \u27e7\u2081 = \n     \u27e6 cons\u2081 name\u2081 n tl (semantics\u2081 hd) \u27e7\u2081\n</code></pre>\n\n<p>Nothing clever. If there are no 'parameters' then the semantics-function is necessarily an Agda <code>Set</code> and we're done; otherwise, we feed in the first type parameter to the semantics-function and recurse to obtain a concrete <code>Set</code>.</p>\n\n<p>It's a tad annoying with the second definition since we need to place the typeclass constraint each time we want to use the semantics of a type, which, for me, is a lot!</p>\n\n<pre><code>\u27e6_\u27e7\u2082 : (t : Type\u2082) {{_ : HasMeaning t}} \u2192 Set\n\u27e6 cons\u2082 name\u2082 0 [] \u27e7\u2082 {{s}} = semantics\u2082 {{s}}\n\u27e6 cons\u2082 name\u2082 (suc n) (hd \u2237 tl) \u27e7\u2082 {{s}} = \n     \u27e6 cons\u2082 name\u2082 n tl \u27e7\u2082 \n     {{ record { semantics\u2082 = semantics\u2082 {{s}} hd } }}\n</code></pre>\n\n<p>Even worse, what if we have conflicting semantics instances?\nPerhaps we want at most one instance, how would we achieve that?</p>\n\n<p>So, for my purposes, it seems the first is best...or not..</p>\n\n<h2>Equality</h2>\n\n<p>The second definition clearly admits decidable equality, since naturals and strings have decidable equality. However, the first does not due to the interpretation functions. This problem can be sidestepped by saying two type(symbols) are identical precisely when they have identical names, arties, and parameters; irrespective of interpretation:</p>\n\n<pre><code>postulate eq\u2081-desire : \u2200 {n a p S T} \u2192 cons\u2081 n a p S \u2261 cons\u2081 n a p T\n</code></pre>\n\n<p>Sadly, this does not give us computation and that can be fixed by using <a href=\"https://stackoverflow.com/questions/36803125/mimicking-haskell-canonicity-one-instance-only-of-typeclasses-in-agda\">trustMe</a>.</p>\n\n<h2>Decisions</h2>\n\n<p>As far as I can tell, from the above rambling, the first approach along with <code>trustMe</code> is the way to go. However, I'm not terribly comfortable using <code>trustMe</code> ---I know very little about it.</p>\n\n<p>Any advice on which way to go, or any reasons on which approach to follow, would be most appreciated. Thank-you!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461698000, "post_id": 36873676, "comment_id": 61314182, "body": "well welcome again - I think we know you (no need to create a new account ;) ) - Haskell knows it from the context you are in - think of it like this: <code>put</code> is more like a place-holder - an action - and <code>&gt;&gt;=</code> connects it with the rest of the computation - that&#39;s how it know - because it&#39;s used wiht a <code>&gt;&gt;=</code> of a certain type (or in a <code>do</code> block with a certain type) ... - the details are a bit more complex but probably not important to understand it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1461698566, "post_id": 36873676, "comment_id": 61314536, "body": "It helps me to think of <code>StateT</code> as a <i>plan</i> to execute with <code>runStateT</code>, rather than something that you do <i>now</i>. <code>get</code> and <code>put</code> are just steps in that <i>plan</i>, and not functions that interact with the state <i>now</i>."}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 1, "last_activity_date": 1461698614, "creation_date": 1461698614, "answer_id": 36873988, "question_id": 36873676, "link": "https://stackoverflow.com/questions/36873676/monad-state-and-get-function/36873988#36873988", "title": "Monad State And get function", "body": "<p>When you use the <code>State</code> monad functions <code>get</code> and <code>put</code> and sequence them with <code>do</code> notation or <code>&gt;&gt;=</code>, you are constructing a \"recipe\" (often called an \"action\") for accessing and modifying local state that will eventually be used with some particular state. For example:</p>\n\n<pre><code>increment = do\n  count &lt;- get\n  put (count + 1)\n</code></pre>\n\n<p>This action can then be used with the part of the <code>State</code> interface that lets you run actions by passing in a state. We will use <code>execState</code>, which returns the state and discards the other value, to demonstrate:</p>\n\n<pre><code>&gt; execState increment 1\n2\n</code></pre>\n\n<p><code>execState</code> is what connects the action <code>increment</code> with the state it modifies. <code>increment</code> by itself doesn't contain any state, it is just a recipe for interacting with state that you must evaluate later.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1461715914, "creation_date": 1461715914, "answer_id": 36878021, "question_id": 36873676, "link": "https://stackoverflow.com/questions/36873676/monad-state-and-get-function/36878021#36878021", "title": "Monad State And get function", "body": "<p>The <code>State</code> type (which <code>StateT</code> is a generalization of) is implemented something like this:</p>\n\n<pre><code>newtype State s a = \n    State { -- A function that takes a state of type `s` and \n            -- produces a pair `(a, s)` of a result of type \n            -- `a` and a new state of type `s`.\n            runState :: s -&gt; (a, s) \n          }\n</code></pre>\n\n<p>This type has instances for <code>Functor</code>, <code>Applicative</code> and <code>Monad</code> that allow you to assemble complex <code>State</code> values out of simpler ones:</p>\n\n<pre><code>-- I won't write the code for these here\ninstance Functor (State s) where ...\ninstance Applicative (State s) where ...\ninstance Monad (State s) where ...\n</code></pre>\n\n<p>Basically, <code>State</code> is a shortcut for chaining functions of types that look like <code>s -&gt; (a, s)</code>, but without having to pass around those <code>s</code> values explicitly.  When you're ready to actually \"feed\" a <code>State</code> action with an <code>s</code> value you use one of these operations (depending on which part of the result you want):</p>\n\n<pre><code>runState  :: State s a -&gt; s -&gt; (a, s)\nevalState :: State s a -&gt; s -&gt; a\nexecState :: State s a -&gt; s -&gt; s\n</code></pre>\n\n<p>What <code>put</code> and <code>get</code> do, then, is interact with the \"hidden\" state argument that the <code>State</code> type implicitly passes around in your code.  Their implementations are something like this:</p>\n\n<pre><code>get :: State s s\nget = State (\\s -&gt; (s, s))\n\nput :: s -&gt; State s ()\nput s = State (\\_ -&gt; ((), s))\n</code></pre>\n\n<p>And that's it!</p>\n"}], "owner": {"reputation": 3, "user_id": 6258095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157008abcc6d91b146057208013e3908?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/6258095/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 36873988, "answer_count": 2, "score": 0, "last_activity_date": 1461715914, "creation_date": 1461697602, "last_edit_date": 1461697995, "question_id": 36873676, "link": "https://stackoverflow.com/questions/36873676/monad-state-and-get-function", "title": "Monad State And get function", "body": "<pre><code>type InterpreterMonad  = StateT (Env, Env) (ErrorT String IO ) ()    \n\ninterpreter :: Stmts -&gt; InterpreterMonad\ninterpreter (Statements s EmptyStmts) = interpreteStmt s\ninterpreter (Statements s stmts) = interpreteStmt s &gt;&gt;= \\m -&gt; (interpreter stmts)\n\n\n-- definicja funkcji\n\ninterpreteStmt :: Stmt -&gt; InterpreterMonad \ninterpreteStmt (DefFun  (VarName name) args typ begin statements end) = get &gt;&gt;= \n    \\(envOut, (sInnerEnvFun, sInnerEnvEVal)) -&gt; case (Map.lookup (VarName name) sInnerEnvFun) of\n        Nothing -&gt; put ( ( envOut, ((Map.insert (VarName name) (DefFun  (VarName name) args typ begin statements end) sInnerEnvFun), sInnerEnvEVal)) ) &gt;&gt;= \\_ -&gt; return ()\n        (Just x) -&gt; throwError  \"ee\"\n</code></pre>\n\n<p>Hi, I cannot understand why <code>get</code> and <code>put</code> functions can be called? How the Haskell know \"where\" is state? I have a problem in favour of imperative programming- after all, such function we have to call on object ( as method) or pass state by argument.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1461696647, "post_id": 36873245, "comment_id": 61313412, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2125674/what-is-the-effect-of-type-synonyms-on-instances-of-type-classes-what-does-the\">What is the effect of type synonyms on instances of type classes? What does the TypeSynonymInstances pragma in GHC do?</a>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461697590, "post_id": 36873245, "comment_id": 61313913, "body": "if you look at <code>StateT</code> it&#39;s basically a function and now you have the problem of making a function showable - take <code>id :: a -&gt; a</code> for example - what should <code>show id</code> print?"}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 4, "last_activity_date": 1461697584, "creation_date": 1461697584, "answer_id": 36873668, "question_id": 36873245, "link": "https://stackoverflow.com/questions/36873245/make-type-showable/36873668#36873668", "title": "Make type showable.", "body": "<p><code>type</code> creates a type synonym. If you want to create an instance, you must create it for the target of the type synonym \u2013 in this case, <code>StateT (Env, Env) (ErrorT String IO ) ()</code>. However, GHC can't derive a <code>Show</code> instance for <code>StateT</code> types because <code>StateT</code> is a wrapper around a function type and GHC can't derive <code>Show</code> for function types.</p>\n\n<p>You could write a newtype as follows:</p>\n\n<pre><code>newtype InterpreterMonad = MkInterpreterMonad (StateT (Env, Env) (ErrorT String IO ) ())\n</code></pre>\n\n<p>but this won't allow you to derive <code>Show</code> either, since <code>InterpreterMonad</code> is now a wrapper around a wrapper around a function type.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461697584, "creation_date": 1461696143, "question_id": 36873245, "link": "https://stackoverflow.com/questions/36873245/make-type-showable", "title": "Make type showable.", "body": "<p>How to make type Showable? </p>\n\n<pre><code>type InterpreterMonad  = StateT (Env, Env) (ErrorT String IO ) ()\n</code></pre>\n\n<p>Normally, I would type <code>deriving Show</code> but I have a <code>type</code> not <code>newtype</code> or <code>data</code>.</p>\n\n<p>P.S. How to write above with <code>newtype</code>?</p>\n"}, {"tags": ["haskell", "monad-transformers", "deriving", "newtype"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461696792, "post_id": 36872781, "comment_id": 61313479, "body": "<code>IO</code> must be at the bottom of your monad transformer stack because there <a href=\"http://stackoverflow.com/questions/13056663/why-is-there-no-io-transformer-in-haskell\">is no <code>IOT</code> monad transformer</a>. Something like <code>newtype LangT m a = LangT (RWST .. .. .. m a); newtype Repl a = Repl (MaybeT (InputT (LangT IO)) a)</code> might work for you."}, {"owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461698838, "post_id": 36872781, "comment_id": 61314714, "body": "You&#39;re right, thanks! I knew <code>IO</code> has to be on the bottom, but for some reason it hadn&#39;t occurred to me that the whole stack is linear. I thought you could put another type sort of &quot;off to the side&quot;. Will update the question."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461700589, "post_id": 36872781, "comment_id": 61315766, "body": "<code>LangT</code> needs a <code>MonadIO m =&gt; MonadIO (LangT m)</code> instance (which can probably be derived) because the <code>MonadIO m =&gt; MonadIO (MaybeT m)</code> instance requires it."}], "answers": [{"comments": [{"owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "edited": false, "score": 2, "creation_date": 1461700638, "post_id": 36874145, "comment_id": 61315795, "body": "Thanks! I think I&#39;m (slowly, finally) starting to get an intuition for this stuff."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 7, "last_activity_date": 1461699147, "last_edit_date": 1495540795, "creation_date": 1461699147, "answer_id": 36874145, "question_id": 36872781, "link": "https://stackoverflow.com/questions/36872781/unable-to-derive-applicative-when-combining-two-monad-transformer-stacks/36874145#36874145", "title": "Unable to derive Applicative when combining two monad transformer stacks", "body": "<p>You're trying to compose the two monads, one on top of the another. But in general <a href=\"https://stackoverflow.com/q/13034229/1333025\">monads don't compose this way</a>. Let's have a look at a simplified version of your case. Let's assume we have just <code>Maybe</code> instead of <code>MaybeT ...</code> and <code>Reader</code> instead of <code>Lang</code>. So the type of your monad  would be</p>\n\n<pre><code>Maybe (LangConfig -&gt; a)\n</code></pre>\n\n<p>Now if this were a monad, we would have a total <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:join\" rel=\"nofollow noreferrer\"><code>join</code></a> function, which would have type</p>\n\n<pre><code>join :: Maybe (LangConfig -&gt; Maybe (LangConfig -&gt; a)) -&gt; Maybe (LangConfig -&gt; a)\n</code></pre>\n\n<p>And here a problem comes: What if the argument is a value <code>Just f</code> where</p>\n\n<pre><code>f :: LangConfig -&gt; Maybe (LangConfig -&gt; a)\n</code></pre>\n\n<p>and for some input <code>f</code> returns <code>Nothing</code>? There is no reasonable way how we could construct a meaningful value of <code>Maybe (LangConfig -&gt; a)</code> from <code>Just f</code>. We need to read the <code>LangConfig</code> so that <code>f</code> can decide if its output will be <code>Nothing</code> or <code>Just something</code>, but within <code>Maybe (LangConfig -&gt; a)</code> we can either return <code>Nothing</code> or read <code>LangConfig</code>, not both! So we can't have such a <code>join</code> function.</p>\n\n<p>If you carefully look at monad transformers, you see that sometimes there is just one way how to combine two monads, and it's not their naive composition. In particular, both <code>ReaderT r Maybe a</code> and <code>MaybeT (Reader r) a</code> are isomorphic to <code>r -&gt; Maybe a</code>. As we saw earlier, the reverse isn't a monad.</p>\n\n<p>So the solution to your problem is to construct monad transformers instead of monads. You can either have both as monad transformers:</p>\n\n<pre><code>newtype LangT m a = Lang { unLang :: RWST LangConfig LangLog LangState m a }\nnewtype ReplT m a = Repl { unRepl :: MaybeT (InputT m) a }\n</code></pre>\n\n<p>and use them as <code>LangT (ReplT IO) a</code> or <code>ReplT (LangT IO) a</code> (as described in one of the comments, <code>IO</code> always has to be at the bottom of the stack). Or you can have just one of them (the outer one) as a transformer and another as a monad. But as you're using <code>IO</code>, the inner monad will have to internally include <code>IO</code>.</p>\n\n<p>Note that there is a difference between <code>LangT (ReplT IO) a</code> and <code>ReplT (LangT IO) a</code>. It's similar to the difference between <code>StateT s Maybe a</code> and <code>MaybeT (State s) a</code>: If the former fails with <code>mzero</code>, neither result nor output state is produed. But in the latter fails with <code>mzero</code>, there is no result, but the state will remain available.</p>\n"}], "owner": {"reputation": 1817, "user_id": 429898, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IbMYQ.jpg?s=128&g=1", "display_name": "jefdaj", "link": "https://stackoverflow.com/users/429898/jefdaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 2, "accepted_answer_id": 36874145, "answer_count": 1, "score": 6, "last_activity_date": 1461700453, "creation_date": 1461694659, "last_edit_date": 1461700453, "question_id": 36872781, "link": "https://stackoverflow.com/questions/36872781/unable-to-derive-applicative-when-combining-two-monad-transformer-stacks", "title": "Unable to derive Applicative when combining two monad transformer stacks", "body": "<p>I've written two monads for a domain-specific language I'm developing. The first is <code>Lang</code>, which is supposed to include everything needed to parse the language line by line. I knew I would want reader, writer, and state, so I used the <code>RWS</code> monad:</p>\n\n<pre><code>type LangLog    = [String]\ntype LangState  = [(String, String)]\ntype LangConfig = [(String, String)]\n\nnewtype Lang a = Lang { unLang :: RWS LangConfig LangLog LangState a }\n  deriving\n    ( Functor\n    , Applicative\n    , Monad\n    , MonadReader LangConfig\n    , MonadWriter LangLog\n    , MonadState  LangState\n    )\n</code></pre>\n\n<p>The second is <code>Repl</code>, which uses <a href=\"https://hackage.haskell.org/package/haskeline\" rel=\"nofollow\">Haskeline</a> to interact with a user:</p>\n\n<pre><code>newtype Repl a = Repl { unRepl :: MaybeT (InputT IO) a }\n  deriving\n    ( Functor\n    , Applicative\n    , Monad\n    , MonadIO\n    )\n</code></pre>\n\n<p>Both seem to work individually (they compile and I've played around with their behavior in GHCi), but I've been unable to embed <code>Lang</code> into <code>Repl</code> to parse lines from the user. The main question is, how can I do that?</p>\n\n<p>More specifically, if I write <code>Repl</code> to include <code>Lang</code> the way I originally intended:</p>\n\n<pre><code>newtype Repl a = Repl { unRepl :: MaybeT (InputT IO) (Lang a) }\n  deriving\n    ( Functor\n    , Applicative\n    , Monad\n    , MonadIO\n    , MonadReader LangConfig\n    , MonadWriter LangLog\n    , MonadState  LangState\n    )\n</code></pre>\n\n<p>It mostly typechecks, but I can't derive <code>Applicative</code> (required for <code>Monad</code> and all the rest).</p>\n\n<p>Since I'm new to monad transformers and designing REPLs, I've been studying/cargo-culting from <a href=\"https://github.com/goldfirere/glambda\" rel=\"nofollow\">Glambda</a>'s <code>Repl.hs</code> and <code>Monad.hs</code>. I originally picked it because I will try to use GADTs for my expressions too. It includes a couple unfamiliar practices, which I've adopted but am totally open to changing:</p>\n\n<ul>\n<li><code>newtype</code> + <code>GeneralizedNewtypeDeriving</code> (is this dangerous?)</li>\n<li><code>MaybeT</code> to allow quitting the REPL with <code>mzero</code></li>\n</ul>\n\n<p>Here's my working code so far:</p>\n\n<pre><code>{- LANGUAGE GeneralizedNewtypeDeriving #-}\n\nmodule Main where\n\nimport Control.Monad.RWS.Lazy\nimport Control.Monad.Trans.Maybe\nimport System.Console.Haskeline\n\n-- Lang monad for parsing language line by line\n\ntype LangLog    = [String]\ntype LangState  = [(String, String)]\ntype LangConfig = [(String, String)]\n\nnewtype Lang a = Lang { unLang :: RWS LangConfig LangLog LangState a }\n  deriving\n    ( Functor\n    , Applicative\n    , Monad\n    , MonadReader LangConfig\n    , MonadWriter LangLog\n    , MonadState  LangState\n    )\n\n-- Repl monad for responding to user input\n\nnewtype Repl a = Repl { unRepl :: MaybeT (InputT IO) (Lang a) }\n  deriving\n    ( Functor\n    , Applicative\n    , Monad\n    , MonadIO\n    )\n</code></pre>\n\n<p>And a couple attempts to extend it. First, including <code>Lang</code> in <code>Repl</code> as mentioned above:</p>\n\n<pre><code>newtype Repl a = Repl { unRepl :: MaybeT (InputT IO) (Lang a) }\n deriving\n   ( Functor\n   , Applicative\n   )\n\n--     Can't make a derived instance of \u2018Functor Repl\u2019\n--       (even with cunning newtype deriving):\n--       You need DeriveFunctor to derive an instance for this class\n--     In the newtype declaration for \u2018Repl\u2019\n-- \n-- After :set -XDeriveFunctor, it still complains:\n-- \n--     Can't make a derived instance of \u2018Applicative Repl\u2019\n--       (even with cunning newtype deriving):\n--       cannot eta-reduce the representation type enough\n--     In the newtype declaration for \u2018Repl\u2019\n</code></pre>\n\n<p>Next, trying to just use both of them at once:</p>\n\n<pre><code>-- Repl around Lang:\n-- can't access Lang operations (get, put, ask, tell)\ntype ReplLang a = Repl (Lang a)\n\ntest1 :: ReplLang ()\ntest1 = do\n  liftIO $ putStrLn \"can do liftIO here\"\n  -- but not ask\n  return $ return ()\n\n-- Lang around Repl:\n-- can't access Repl operations (liftIO, getInputLine)\ntype LangRepl a = Lang (Repl a)\n\ntest2 :: LangRepl ()\ntest2 = do\n  _ &lt;- ask -- can do ask\n  -- but not liftIO\n  return $ return ()\n</code></pre>\n\n<p>Not shown: I also tried various permutations of <code>lift</code> on the <code>ask</code> and <code>putStrLn</code> calls. Finally, to be sure this isn't an RWS-specific issue I tried writing <code>Lang</code> without it:</p>\n\n<pre><code>newtype Lang2 a = Lang2\n  { unLang2 :: ReaderT LangConfig (WriterT LangLog (State LangState)) a\n  }\n  deriving\n    ( Functor\n    , Applicative\n    )\n</code></pre>\n\n<p>That gives the same eta-reduce error.</p>\n\n<p>So to recap, the main thing I want to know is how do I combine these two monads? Am I missing an obvious combination of <code>lift</code>s, or arranging the transformer stack wrong, or running into some deeper issue?</p>\n\n<p>Here are a couple possibly-related questions I looked at:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/32572152/tidying-up-monads-turning-application-of-a-monad-transformer-into-newtype-mona\">Tidying up Monads - turning application of a monad transformer into newtype monad</a></li>\n<li><a href=\"https://stackoverflow.com/questions/25693483/generalized-newtype-deriving\">Generalized Newtype DerivingGeneralized Newtype Deriving</a></li>\n<li><a href=\"https://www.reddit.com/r/haskell/comments/3mrkwe/issue_deriving_monadtrans_for_chained_custom/\" rel=\"nofollow\">Issue deriving MonadTrans for chained custom monad transformers</a></li>\n</ul>\n\n<p>Update: my hand-wavy understanding of monad transformers was the main problem. Using <code>RWST</code> instead of <code>RWS</code> so <code>LangT</code> can be inserted between <code>Repl</code> and <code>IO</code> mostly solves it:</p>\n\n<pre><code>newtype LangT m a = LangT { unLangT :: RWST LangConfig LangLog LangState m a }\n  deriving\n    ( Functor\n    , Applicative\n    , Monad\n    , MonadReader LangConfig\n    , MonadWriter LangLog\n    , MonadState  LangState\n    )\n\ntype Lang2 a = LangT Identity a\n\nnewtype Repl2 a = Repl2 { unRepl2 :: MaybeT (LangT (InputT IO)) a }\n  deriving\n    ( Functor\n    , Applicative\n    , Monad\n    -- , MonadIO -- ghc: No instance for (MonadIO (LangT (InputT IO)))\n    , MonadReader LangConfig\n    , MonadWriter LangLog\n    , MonadState  LangState\n    )\n</code></pre>\n\n<p>The only remaining issue is I need to figure out how to make <code>Repl2</code> an instance io <code>MonadIO</code>.</p>\n\n<p>Update 2: All good now! Just needed to add <code>MonadTrans</code> to the list of instances derived for <code>LangT</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30577, "user_id": 476496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197b0087c5bee323d2690c977878f8?s=128&d=identicon&r=PG", "display_name": "Vincent Savard", "link": "https://stackoverflow.com/users/476496/vincent-savard"}, "edited": false, "score": 0, "creation_date": 1461688052, "post_id": 36870568, "comment_id": 61308234, "body": "You stated that <code>main</code> should return a <code>IO ()</code>. What does <code>fold add 2 3</code> return? How can you turn the returned value to a <code>IO ()</code>?"}, {"owner": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "reply_to_user": {"reputation": 30577, "user_id": 476496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197b0087c5bee323d2690c977878f8?s=128&d=identicon&r=PG", "display_name": "Vincent Savard", "link": "https://stackoverflow.com/users/476496/vincent-savard"}, "edited": false, "score": 0, "creation_date": 1461688302, "post_id": 36870568, "comment_id": 61308372, "body": "If I change IO() to Integer it gives &quot;Couldn&#39;t match expected type \u2018IO t0\u2019 with actual type \u2018Integer\u2019&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1461688233, "creation_date": 1461688233, "answer_id": 36870693, "question_id": 36870568, "link": "https://stackoverflow.com/questions/36870568/haskell-passing-a-function-as-a-argument-compilation-error/36870693#36870693", "title": "Haskell - passing a function as a argument compilation error", "body": "<p>The problem is that you've declared <code>main</code> (correctly) as having type <code>IO ()</code>, but <code>fold</code> doesn't return that. The error message is a little more complicated because in <em>theory</em>, <code>add</code> (and thus <code>fold</code>) could return a value of type <code>IO ()</code>, since <code>add</code> can return any type with a <code>Num</code> instance. <code>IO ()</code>, however, is <em>not</em> an instance of <code>Num</code>. The solution is to return an IO action created from the return value of <code>fold</code>. One way to do that is to use the <code>print</code> function (which takes any value with a <code>Show</code> instance and converts it to a <code>String</code> before outputing it).</p>\n\n<pre><code>main = print $ fold add 2 3\n</code></pre>\n"}], "owner": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 36870693, "answer_count": 1, "score": 0, "last_activity_date": 1461688233, "creation_date": 1461687836, "question_id": 36870568, "link": "https://stackoverflow.com/questions/36870568/haskell-passing-a-function-as-a-argument-compilation-error", "title": "Haskell - passing a function as a argument compilation error", "body": "<p>I have a very simple function called 'fold' that takes a function f and executes it. Given a function 'add' and two numbers it calls add with those two numbers and displays the results. However I cannot compile it due to a compilation error below. What is the error specifically stating and what can I do to solve it?</p>\n\n<pre><code>  module Main where\n\n    add x y = x + y\n\n  --fold :: ((a,b)-&gt;c) -&gt; a-&gt;b-&gt;c\n\n    fold f n x = f n x\n\n\n    main :: IO ()\n    main = do \n        fold add 2 3\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/14y4h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/14y4h.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3086, "user_id": 1685709, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/855f8d4f6a851537c9e2e242f04a2c6c?s=128&d=identicon&r=PG", "display_name": "Ayush Goel", "link": "https://stackoverflow.com/users/1685709/ayush-goel"}, "edited": false, "score": 0, "creation_date": 1461687718, "post_id": 36869062, "comment_id": 61308010, "body": "Might be better suited for <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 5790380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba59feb226683e66739e14eca75d73d?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel K", "link": "https://stackoverflow.com/users/5790380/daniel-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1461687842, "last_edit_date": 1461687842, "creation_date": 1461685828, "answer_id": 36869887, "question_id": 36869062, "link": "https://stackoverflow.com/questions/36869062/how-can-i-do-better-my-palidrom-program/36869887#36869887", "title": "How can i do better my palidrom program?", "body": "<p>Firstly, inside a do block, when introducing variables you should use the <strong><code>let</code></strong> keyword. (or use an <code>&lt;-</code> when extracting a monad's value, as you did when reading the file.)</p>\n\n<pre><code>laengeWort = length inhalt\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>let laengeWort = length inhalt\n</code></pre>\n\n<p>Secondly, the <code>laengeWort</code> variable is of type <code>Int</code> , you need to use the <code>show</code> function to convert it to a String. (Haskell doesn't have implicit conversion of types to String like some other languages do.)</p>\n\n<p>Finally, you mistyped <code>isPalindrom</code> as  <code>istPalindrome</code>\nand you forgot to close the parens beginning at <code>then putStrLn (</code></p>\n\n<p>The syntactically correct solution is (I translated it to English):</p>\n\n<pre><code>main = do\n  contents &lt;- readFile \"palindrom.txt\"\n  let contentLength =  length contents\n  if isPalindrome contents then\n    putStrLn (contents ++ \" is a palindrome of length \"++ show contentLength)\n  else\n    putStrLn (contents ++\" is not a palindrome, it has the length \" ++ show contentLength)\n</code></pre>\n\n<hr/>\n\n<p>Also, this solution operates on the entire file as if is a single string/word. From your description it sounds like you'd like to treat each line as a different word. To do that, use the <code>lines</code> function to split the contents by lines, and use <code>partition</code> to filter the words into words that are palindromes and words that are not. Then you can use <code>mapM_</code> to print each word. Here's a fairly concise example(though it doesn't preserve the words order):</p>\n\n<pre><code>import Data.List (partition)\nmain = do\n  contents &lt;- lines `fmap` readFile \"palindrom.txt\"\n  let (palins,notPalins) = partition isPalindrome contents\n  mapM_ (\\w -&gt; putStrLn $ \"the word \" ++ w ++ \" is a palindrome of length \" ++ show (length w)) palins\n  mapM_ (\\w -&gt; putStrLn $ \"the word \" ++ w ++ \" is not a palindrome, it has length\" ++ show (length w)) notPalins\n\nisPalindrome w = w == reverse w\n</code></pre>\n\n<p>I used 'fmap' to map the lines function (which takes a pure string) over\nthe result of readFile (which returns a string in the IO monad), to get a list of strings in the IO monad, and the '&lt;-' operator extracts that list from the monad.\nIt is equivalent to saying:</p>\n\n<pre><code>rawData &lt;- readFile \"palindrom.txt\"\nlet contents = lines rawData\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1461685913, "creation_date": 1461685913, "answer_id": 36869923, "question_id": 36869062, "link": "https://stackoverflow.com/questions/36869062/how-can-i-do-better-my-palidrom-program/36869923#36869923", "title": "How can i do better my palidrom program?", "body": "<p>The problem is that you're using <code>readFile</code>, which will read the entire contents of <code>\"palindrom.txt\"</code> into a single <code>String</code>.  You need to split the contents of the file into lines, then apply <code>isPalindrom</code> to line.  You can do this with the <code>lines</code> built-in function, then use <code>mapM_</code>.  To make it cleaner you can use <code>forM_</code> from <code>Control.Monad</code>, which is just <code>mapM_</code> with the argument order swapped:</p>\n\n<pre><code>mapM_ :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m ()\nforM_ :: Monad m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m ()\n</code></pre>\n\n<p>I prefer it most of the time since it looks more like a for-loop from other languages.  So your code would look like</p>\n\n<pre><code>import Control.Monad (forM_)\n\nmain = do\n    inhalt &lt;- readFile \"palindrom.txt\"\n    forM_ (lines inhalt) (\\wort -&gt; do\n        let laengeWort = length wort\n        putStrLn (if istPalindrom wort\n            then wort ++ \" ist ein Palindrom und hat die Laenge \" ++ show laengeWort\n            else wort ++ \" ist kein Palindrom und hat die Laenge \" ++ show laengeWort\n        )\n    )\n\nistPalindrom w = w == reverse w\n</code></pre>\n\n<p>I also floated the <code>putStrLn</code> up to be before the <code>if</code> statement to make it a little cleaner and to make the lines a little shorter.</p>\n\n<p>You had a few issues with syntax, but that's pretty forgivable when you're a beginner and most of the tutorials out there aren't in your native language.</p>\n\n<p>To clean up this code a little more I would probably pull out the message formatting to another function:</p>\n\n<pre><code>macheNachricht :: String -&gt; String\nmacheNachricht wort =\n    let nachricht = if istPalindrom wort\n            then \" ist ein Palindrom\"\n            else \" ist kein Palindrom\"\n        laengeWort = show (length wort)\n    in wort ++ nachricht ++ \" und hat die Laenge \" ++ laengeWort\n</code></pre>\n\n<p>Then <code>main</code> would look like</p>\n\n<pre><code>main = do\n    inhalt &lt;- readFile \"palindrom.txt\"\n    forM_ (lines inhalt) (\\wort -&gt; putStrLn (macheNachrict wort))\n</code></pre>\n\n<p>This can be reduced further using Haskell's function composition operator <code>.</code>, which is defined as</p>\n\n<pre><code>f . g = \\x -&gt; f (g x)\n</code></pre>\n\n<p>Since this is precisely what we have with <code>\\wort -&gt; putStrLn (macheNachricht wort)</code> as the second argument to <code>forM_</code>, we can just write it as <code>putStrLn . macheNachricht</code>:</p>\n\n<pre><code>main = do\n    inhalt &lt;- readFile \"palindrom.txt\"\n    forM_ (lines inhalt) (putStrLn . macheNachricht)\n</code></pre>\n\n<p>(Sorry if my translation of <code>makeMessage</code> to German as <code>macheNachricht</code> is a little imprecise, I've just started learning German myself and I'm not very good yet.)</p>\n"}], "owner": {"reputation": 53, "user_id": 6255643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0133b22f4ee94a74a7b33257245b7f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ballenavoladora", "link": "https://stackoverflow.com/users/6255643/ballenavoladora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 36869887, "answer_count": 2, "score": -1, "last_activity_date": 1461687842, "creation_date": 1461683726, "last_edit_date": 1461684474, "question_id": 36869062, "link": "https://stackoverflow.com/questions/36869062/how-can-i-do-better-my-palidrom-program", "title": "How can i do better my palidrom program?", "body": "<p>I have problem with my program : The program has to read a file, line to line and has to say if it is a palindrom and the length every word. I'm very very new in Haskell and only have this, but it doesnt work :(</p>\n\n\n\n<pre class=\"lang-haskell prettyprint-override\"><code>main = do\n  inhalt &lt;- readFile \"palindrom.txt\"\n  laengeWort = length inhalt\n  if istPalindrom inhalt\n    then putStrLn (inhalt ++ \" ist ein Palindrom und hat die Laenge \"++ laengeWort\n    else putStrLn (inhalt ++\" ist kein Palindrom und hat die Laenge \" ++ laengeWort)\n\nisPalindrom w = w == reverse w\n</code></pre>\n\n<p>Please help me to complete correctly my program :)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1461685188, "post_id": 36868594, "comment_id": 61306376, "body": "break your code up into smaller parts that can be tested separately, or carefully trace the evaluation on your input with a pen and paper"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461685528, "post_id": 36868594, "comment_id": 61306589, "body": "Your code <a href=\"http://ideone.com/vM5Czo\" rel=\"nofollow noreferrer\">does</a> generate all combinations (it duplicates the last one) but evidently you are not running the code you think you are."}], "answers": [{"tags": [], "owner": {"reputation": 3946, "user_id": 6231376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea33b55396be93411ade85021f41b01?s=128&d=identicon&r=PG&f=1", "display_name": "TeWu", "link": "https://stackoverflow.com/users/6231376/tewu"}, "is_accepted": false, "score": 1, "last_activity_date": 1461721344, "last_edit_date": 1461721344, "creation_date": 1461685562, "answer_id": 36869779, "question_id": 36868594, "link": "https://stackoverflow.com/questions/36868594/modifying-and-adding-to-a-list-in-haskell/36869779#36869779", "title": "Modifying and Adding to a list in Haskell", "body": "<p>You can get into infinite loop when you invoke <code>rotateBWT</code> on string that doesn't contain <code>$</code> character.</p>\n\n<p>There you have a solution that generate output you've shown in example:</p>\n\n<pre><code>type BWT = [String] -- List of Strings for Burrows Wheeler matrix\n\ngenBWTmatrix :: String -&gt; BWT\ngenBWTmatrix str = rotateBWT [str ++ \"$\"]\n\nrotateBWT :: BWT -&gt; BWT\nrotateBWT a = if (head l) == '$' then a\n              else a ++ rotateBWT n\n                where l = last a\n                      n = [(tail l) ++ [head l]]\n\nmain = mapM_ putStrLn $ genBWTmatrix \"BANANA\" -- Prints: BANANA$\n                                              --         ANANA$B\n                                              --         NANA$BA\n                                              --         ANA$BAN\n                                              --         NA$BANA\n                                              --         A$BANAN\n                                              --         $BANANA\n</code></pre>\n\n<p><a href=\"http://ideone.com/G0j3PA\" rel=\"nofollow\"> Run it </a></p>\n"}], "owner": {"reputation": 41, "user_id": 2547393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IfzTb.jpg?s=128&g=1", "display_name": "Hammad", "link": "https://stackoverflow.com/users/2547393/hammad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1599733562, "creation_date": 1461682548, "last_edit_date": 1599733562, "question_id": 36868594, "link": "https://stackoverflow.com/questions/36868594/modifying-and-adding-to-a-list-in-haskell", "title": "Modifying and Adding to a list in Haskell", "body": "<p>I am implementing Burrows-Wheeler Transformation in Haskell. A combination of all cycled strings is generated and stored in a matrix as the first step of the transform. I am using Haskell List to construct the matrix. The list will store the original word on list head and its cyclic combinations down in tail.</p>\n\n<p><a href=\"http://i.stack.imgur.com/KIrRL.png\" rel=\"nofollow\">Here is an Example of a transformed word</a></p>\n\n<p>I have written a function that outputs the first cycled string. However, if I call the function again as a recursion, I face an infinite loop.</p>\n\n<p>Here is the function</p>\n\n<pre><code>type BWT = [String] -- List of Strings for Burrows Wheeler matrix\nsamplebwt = [\"BANANA$\"] -- Sample input\n\nrotateBWT:: BWT -&gt; BWT\nrotateBWT a = if (head (last a)) /= '$' \n    then [tail (head a) ++ [head (head a)]] ++ rotateBWT [tail (head a) ++ [head (head a)]] \n    else a\n\n    rotateBWT samplebwt \n-- returns [\"ANANA$B\"]\n--expected output [\"ANANA$B\", \"NANA$BA\", \"ANA$BNA\", \"NA$BANA\", \"A$BANAN\", \"$BANANA\"]\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["haskell", "functional-programming", "lambda-calculus"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1461679363, "post_id": 36867004, "comment_id": 61301516, "body": "Note: the first is <b>not</b> a function definition. It&#39;s a simple pattern binding. This changes the <i>type</i> when the <code>MonomorphismRestriction</code> is active (which is the default on most versions of Haskell.). So the first function will have a more monomorphic type than the latter.  To avoid this either specify the <code>NoMonomorphismRestriction</code> extension or provide an explicit type signature for the function."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1461679974, "post_id": 36867004, "comment_id": 61302022, "body": "Thanks, could you elaborate? Had I provided a type for <code>fib1</code>, it would have been a function?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1461680285, "post_id": 36867004, "comment_id": 61302323, "body": "@Bakuriu, it <i>is</i> a function definition, because it defines a function! But it&#39;s true that it&#39;s not <i>syntactically</i> a function definition, so the dreaded monomorphism restriction applies. Best by far, I think, for beginners to learn to <i>both</i> turn off the restriction <i>and</i> provide a signature for all top-level bindings. The monomorphism restriction is confusing, and not remotely worth the confusion."}, {"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 0, "creation_date": 1461680291, "post_id": 36867004, "comment_id": 61302332, "body": "There&#39;s also, IIRC, some differences with how they are treated at reduction (related to <a href=\"https://wiki.haskell.org/Super_combinator\" rel=\"nofollow noreferrer\">supercombinators</a>), but I know too little about that (or maybe that only applies to partial applications vs. lambdas?)"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461680633, "post_id": 36867004, "comment_id": 61302645, "body": "@dfeuer What is the difference between a syntactical definition and a regular definition?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461681311, "post_id": 36867004, "comment_id": 61303316, "body": "What I mean is that the <i>form</i> of the definition does not indicate it is defining a function (it does not look like <code>f x ... = ...</code>, but it actually <i>does</i> define one."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1461684974, "post_id": 36867004, "comment_id": 61306228, "body": "Keep in mind that <code>f x = ...</code> is just syntactic sugar for <code>f = \\x -&gt; ...</code>. In some sense, a function definition is anything that assigns a value from a function type to a name."}], "answers": [{"comments": [{"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1461687422, "post_id": 36868115, "comment_id": 61307819, "body": "Thanks, by &quot;sharing&quot; do you mean memoization?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1461689905, "post_id": 36868115, "comment_id": 61309347, "body": "I think the sentence &quot;<code>fib1</code> and <code>fib2</code> are eta-equivalent&quot; is <i>not</i> correct. Eta-equivalence is <i>only</i> between things of the form <code>\\x -&gt; e x</code> and <code>e</code>, that is, a lambda whose body is a function application. But <code>\\x -&gt; let decls in e x</code> has a lambda whose body is a let-binding, <i>not</i> a function application. (And in any case I&#39;m pretty sure eta equivalence isn&#39;t sound with respect to Haskell semantics.) I believe GHC calls this equivalence between lambdas and let bindings <a href=\"https://wiki.haskell.org/GHC/FAQ#When_can_I_rely_on_full_laziness.3F\" rel=\"nofollow noreferrer\">&quot;full laziness&quot;</a>."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1461695705, "post_id": 36868115, "comment_id": 61312826, "body": "The compiler could eta expand fib3 and then beta reduce the lambda, which would give fib2 again."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1461696489, "post_id": 36868115, "comment_id": 61313324, "body": "Perhaps it should be &quot;equivalent up to denotational semantics&quot;? @Ingo Indeed, all three programs have the same denotational semantics - and hence a Haskell compiler is free to replace any one with any other. Their operational semantics may be different, but the operational semantics are really a function of compiler, optimization level, etc."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 5, "last_activity_date": 1461681422, "creation_date": 1461681422, "answer_id": 36868115, "question_id": 36867004, "link": "https://stackoverflow.com/questions/36867004/what-are-the-semantics-of-adding-the-parameter-in-lhs-of-function-definition-in/36868115#36868115", "title": "What are the semantics of adding the parameter in LHS of function definition in haskell?", "body": "<p>Your last point is perhaps the most important one - <code>fib1</code> and <code>fib2</code> <em>are</em> indeed eta-equivalent, and the compiler is completely free to transform one into the other. Since this transformation has no effect on denotational semantics, only operational semantics, it is typically referred to as an optimization, if it \"improves\" the operational semantics of the program. The trouble is that it is hard to tell what \"improves\" really means.</p>\n\n<p>The wiki page states</p>\n\n<blockquote>\n  <p>The compiler cannot know whether you intended this -- while it\n  increases time complexity it may reduce space complexity. </p>\n</blockquote>\n\n<p>This is true - in general, this \"optimization\" may not be an optimization, depending on how you measure performance. So, in general, the compiler will not perform this optimization, leaving the burden of doing so to the programmer if they so desire, unless it is <em>really</em> sure that it will indeed improve the performance of the code.</p>\n\n<p>The difference is a characteristic called sharing. In <code>fib1</code>, the <code>fib'</code> calls in <code>map fib'</code> will be shared between the different calls of <code>fib1</code> inside the <code>fib'</code> function. This means that the entire list <code>map fib' [0..n]</code> must be retained for as long as the function is being computed. This could, in some cases, be bad for performance, but in this case it saves you <em>a lot</em> of recursive function calls. In <code>fib2</code>, each <code>map fib'</code> is computed separately, due to the fact that the parameter is outside the <code>let</code>. Consider this program, which is equivalent to <code>fib1</code> even without optimizations: </p>\n\n<pre><code>fib3 :: Int -&gt; Integer \nfib3 =\n   let fib' 0 = 0\n       fib' 1 = 1\n       fib' n = fib1 (n - 1) + fib1 (n - 2)\n    in \\x -&gt; map fib' [0 ..] !! x\n</code></pre>\n\n<p>The placement of the <code>\\x -&gt; ..</code> is crucial - here it is <code>let fib' = .. in \\x -&gt; map fib' ..</code> but in <code>fib2</code> it is <code>\\x -&gt; let fib' = .. in map fib' ..</code>.</p>\n\n<blockquote>\n  <p>Thus it will not float the definition out from under the binding of x.</p>\n</blockquote>\n\n<p>This will obviously depend on the specific compiler you use and how you compile the program! I assume that this wiki page was written at a time when the compiler wasn't smart enough to figure out this particular example, but with GHC 7.10.3 and <code>-O2</code>, the compiler actually generates <em>identical</em> code for these two programs. </p>\n\n<p>If you compile without optimizations, or interpret, the difference in performance will become apparent. It is not due to the monomorphism restriction - it is there even if you give monomorphic types to the functions:</p>\n\n<pre><code>fib1 :: Int -&gt; Integer \nfib1 = ..\n\nfib2 :: Int -&gt; Integer \nfib2 x = ..\n</code></pre>\n\n<p>The difference is obvious:</p>\n\n<pre><code>&gt;:set +s\n&gt;fib2 32\n2178309\n(10.86 secs, 6,063,137,456 bytes)\n&gt;fib1 32\n2178309\n(0.00 secs, 0 bytes)\n</code></pre>\n"}], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 36868115, "answer_count": 1, "score": 2, "last_activity_date": 1461697189, "creation_date": 1461678760, "last_edit_date": 1461697189, "question_id": 36867004, "link": "https://stackoverflow.com/questions/36867004/what-are-the-semantics-of-adding-the-parameter-in-lhs-of-function-definition-in", "title": "What are the semantics of adding the parameter in LHS of function definition in haskell?", "body": "<p>I'M a beginner in haskell and trying to understand the <a href=\"https://wiki.haskell.org/Let_vs._Where\" rel=\"nofollow\">Let vs Where wiki page</a>. At the end there's an example where adding the parameter <code>x</code> in the left hand side of function definition <code>fib</code> changes the semantics.</p>\n\n<pre><code>fib1 =\n   let fib' 0 = 0\n       fib' 1 = 1\n       fib' n = fib1 (n - 1) + fib1 (n - 2)\n   in  (map fib' [0 ..] !!)\n\nfib2 x =\n   let fib' 0 = 0\n       fib' 1 = 1\n       fib' n = fib2 (n - 1) + fib2 (n - 2)\n   in  map fib' [0 ..] !! x\n</code></pre>\n\n<p>The wiki page states that \"In the second case [<code>fib2</code>], fib' is redefined for every argument x\". I'm looking for a beginner-friendly explanation of why this happens, and in general, are there more such hidden side effects? </p>\n\n<p>The wiki page also has a link to an explanation about <a href=\"https://wiki.haskell.org/Eta_expansion\" rel=\"nofollow\">eta reduction</a>, which states that an expression and its eta-reduction are equivalent. So, if <code>fib2</code> is the eta-abstraction of <code>fib1</code>, why aren't they equivalent? </p>\n"}, {"tags": ["haskell", "types", "io", "type-mismatch"], "answers": [{"tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": true, "score": 4, "last_activity_date": 1461677343, "creation_date": 1461677343, "answer_id": 36866417, "question_id": 36866219, "link": "https://stackoverflow.com/questions/36866219/haskell-type-mismatch-in-do-block/36866417#36866417", "title": "Haskell type mismatch in do block", "body": "<p>You are totally right in that it has to do with the IO operations. First, the proper type for <code>extractLang</code> is <code>Handle -&gt; IO String</code>. Second, a couple of <code>return</code>s is missing (for the same reason): </p>\n\n<pre><code>extractLang :: Handle -&gt; IO String\nextractLang file = do                                \n                   eof &lt;- hIsEOF file\n                   if eof\n                      then do hClose file            \n                              return \"none\"           -- return\n                      else do line &lt;- hGetLine file\n                              if length (words line) == 1\n                                then return line      -- return\n                                else extractLang file\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3502314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6540442f3894f518920c6cc36f298474?s=128&d=identicon&r=PG&f=1", "display_name": "A13XI5", "link": "https://stackoverflow.com/users/3502314/a13xi5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 36866417, "answer_count": 1, "score": 0, "last_activity_date": 1461677343, "creation_date": 1461676914, "question_id": 36866219, "link": "https://stackoverflow.com/questions/36866219/haskell-type-mismatch-in-do-block", "title": "Haskell type mismatch in do block", "body": "<p>While learning Haskell \"for a greater good\" (aka to pass the exams on functional languages),\nI ran into a weird error. I get a Type mismatch error in every do-block (except the first one). To be more accurate, The compiler seems to expect a list of something.</p>\n\n<p>I think it has something to do with the IO operations...</p>\n\n<p>code:</p>\n\n<pre><code>-- chaos.hs\nimport System.IO\n\nmain :: IO ()\nmain = do                                            -- no error\n       inl &lt;- openFile \"dictionary.txt\" ReadMode\n       let lang = extractLang (inl)\n       hClose inl\n\nextractLang :: Handle -&gt; String \nextractLang file = do                                --error\n                   eof &lt;- hIsEOF file\n                   if eof\n                      then do hClose file            --error\n                              \"none\"\n                      else do line &lt;- hGetLine file  --error\n                              if length (words line) == 1\n                                then line\n                                else extractLang file\n</code></pre>\n\n<p>the error log:</p>\n\n<pre><code>chaos.hs:12:27:\nCouldn't match type \u2018IO\u2019 with \u2018[]\u2019\nExpected type: [Bool]\n  Actual type: IO Bool\nIn a stmt of a 'do' block: eof &lt;- hIsEOF file\nIn the expression:\n  do { eof &lt;- hIsEOF file;\n       if eof then\n           do { hClose file;\n                .... }\n       else\n           do { line &lt;- hGetLine file;\n                .... } }\n\nchaos.hs:14:31:\n    Couldn't match type \u2018IO\u2019 with \u2018[]\u2019\n    Expected type: [()]\n      Actual type: IO ()\n    In a stmt of a 'do' block: hClose file\n    In the expression:\n      do { hClose file;\n           \"none\" }\n\nchaos.hs:16:39:\n    Couldn't match type \u2018IO\u2019 with \u2018[]\u2019\n    Expected type: [String]\n      Actual type: IO String\n        In a stmt of a 'do' block: line &lt;- hGetLine file\n        In the expression:\n        do { line &lt;- hGetLine file;\n           if length (words line) == 1 then line else extractLang file\n}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1461676384, "post_id": 36865901, "comment_id": 61299110, "body": "What&#39;s the type of <code>interpeteStmt</code>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461676868, "post_id": 36865901, "comment_id": 61299473, "body": "please take your time and read <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> - you have lot&#39;s of questions like this here and all would greatly benefit from you learning how to provide enough information"}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1461677171, "post_id": 36866144, "comment_id": 61299712, "body": "interpeteStmt returns StateT (EnvFun, EnvEval) (ReaderT EnvEval (ErrorT String IO))"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1461676741, "creation_date": 1461676741, "answer_id": 36866144, "question_id": 36865901, "link": "https://stackoverflow.com/questions/36865901/bind-and-monad-stack/36866144#36866144", "title": "Bind and monad stack", "body": "<p><code>m</code> is a poorly chosen variable name here. The type of <code>&gt;&gt;=</code> is <code>m a -&gt; (a -&gt; m b) -&gt; m b</code>, so the variable <code>m</code> in the body of  <code>i</code> is bound to a value of type <code>a</code>. What type <code>a</code> is depends on what <code>interpeteStmt</code> returns.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 36866144, "answer_count": 1, "score": -4, "last_activity_date": 1461676741, "creation_date": 1461676089, "question_id": 36865901, "link": "https://stackoverflow.com/questions/36865901/bind-and-monad-stack", "title": "Bind and monad stack", "body": "<pre><code>type IM = StateT (EnvFun, EnvEval) (ReaderT EnvEval (ErrorT String IO))\n\n\ni :: Stmts -&gt; IM\ni Statements s (Statements e) = interpeteStmt s &gt;&gt;= \\m  ...\n</code></pre>\n\n<p>And I have a problem with understanding. What is <code>m</code>. Yes, it is that, what <code>bind</code> for monad return. But which monad \"is important\". I cannot just understand because this monad stack makes me troub.e</p>\n"}, {"tags": ["haskell", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6255643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0133b22f4ee94a74a7b33257245b7f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ballenavoladora", "link": "https://stackoverflow.com/users/6255643/ballenavoladora"}, "edited": false, "score": 0, "creation_date": 1461665564, "post_id": 36861801, "comment_id": 61291102, "body": "OK I&#39;ll show you this program"}, {"owner": {"reputation": 53, "user_id": 6255643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0133b22f4ee94a74a7b33257245b7f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ballenavoladora", "link": "https://stackoverflow.com/users/6255643/ballenavoladora"}, "edited": false, "score": 0, "creation_date": 1461665573, "post_id": 36861801, "comment_id": 61291110, "body": "-- waslernstdu1.hs main :: IO() def main = do     putStrLn &quot;Was lernst du?&quot;     sprache &lt;- getLine     putStrLn (&quot;Viel Erfolg beim &quot; ++ sprache ++ &quot; lernen!&quot;)"}], "tags": [], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "is_accepted": false, "score": 2, "last_activity_date": 1461665351, "creation_date": 1461665351, "answer_id": 36861801, "question_id": 36861737, "link": "https://stackoverflow.com/questions/36861737/what-does-it-means-the-type-signature-for-main-lacks-an-accompanying-binding/36861801#36861801", "title": "what does it means &quot;The type signature for \u2018main\u2019 lacks an accompanying binding&quot;?", "body": "<p>You have given a type signature for the <code>main</code> function (i.e. <code>main :: IO ()</code>), but you have not provided an implementation. The implementation will be of the form <code>main = &lt;the implementation&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 4, "last_activity_date": 1461665846, "creation_date": 1461665846, "answer_id": 36861992, "question_id": 36861737, "link": "https://stackoverflow.com/questions/36861737/what-does-it-means-the-type-signature-for-main-lacks-an-accompanying-binding/36861992#36861992", "title": "what does it means &quot;The type signature for \u2018main\u2019 lacks an accompanying binding&quot;?", "body": "<p>You need to remove <code>def</code> before <code>main</code> in your definition. You are defining a function <code>def</code> with a single parameter <code>main</code>:</p>\n\n<pre><code>main :: IO() \nmain = do \n  putStrLn \"Was lernst du?\" \n  sprache &lt;- getLine putStrLn (\"Viel Erfolg beim \" ++ sprache ++ \" lernen!\")\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6255643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0133b22f4ee94a74a7b33257245b7f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ballenavoladora", "link": "https://stackoverflow.com/users/6255643/ballenavoladora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "closed_date": 1461666042, "answer_count": 2, "score": 1, "last_activity_date": 1461665867, "creation_date": 1461665194, "last_edit_date": 1461665867, "question_id": 36861737, "link": "https://stackoverflow.com/questions/36861737/what-does-it-means-the-type-signature-for-main-lacks-an-accompanying-binding", "closed_reason": "Duplicate", "title": "what does it means &quot;The type signature for \u2018main\u2019 lacks an accompanying binding&quot;?", "body": "<p>I'm trying to compile this simple program</p>\n\n<pre><code>main :: IO() \ndef main = do \n  putStrLn \"Was lernst du?\" \n  sprache &lt;- getLine putStrLn (\"Viel Erfolg beim \" ++ sprache ++ \" lernen!\")\n</code></pre>\n\n<p>but I get the following answer in my terminal:</p>\n\n<pre><code>ghc --make waslernstdu1.hs\n[1 of 1] Compiling Main             ( waslernstdu1.hs, waslernstdu1.o )\n\nwaslernstdu1.hs:2:1:\n    The type signature for \u2018main\u2019 lacks an accompanying binding\nassigals-Air:documents thommymuc2004$ \n</code></pre>\n\n<p>How can I resolve this error?</p>\n"}, {"tags": ["haskell", "reflex"], "comments": [{"owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 1, "creation_date": 1461659855, "post_id": 36859279, "comment_id": 61286866, "body": "There is a very nice (although still experimental) formulation of modal dialogs in <a href=\"https://github.com/reflex-frp/reflex-dom-contrib/blob/master/src/Reflex/Dom/Contrib/Widgets/Modal.hs\" rel=\"nofollow noreferrer\">reflex-dom-contrib</a>"}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "reply_to_user": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 0, "creation_date": 1461660211, "post_id": 36859279, "comment_id": 61287129, "body": "We decided for our own implementation for the time being..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1461678769, "post_id": 36859279, "comment_id": 61301027, "body": "The errors are probably due to the fact that the values in the former record updates are unused, so their types will naturally be ambiguous. The essential problem, it seems, is that record updates can change the type of the record. To get the type inference you want, you&#39;ll have to define some way of updating the record (e.g. lenses) in a way that doesn&#39;t change the type."}], "answers": [{"comments": [{"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 0, "creation_date": 1461753936, "post_id": 36885095, "comment_id": 61339321, "body": "I will accept this as an answer - yes, the fact that the update can change the type was unexpected although quite logical."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1461747724, "creation_date": 1461747724, "answer_id": 36885095, "question_id": 36859279, "link": "https://stackoverflow.com/questions/36859279/type-inference-could-not-deduce-monad/36885095#36885095", "title": "Type inference - could not deduce Monad", "body": "<p>As mentioned in the comments, the problem is that record update can <em>change</em> the type of the record (which can be surprising at first). Here's a test in GHCi:</p>\n\n<pre><code>&gt; data T a = T { tA :: a }\n&gt; let x = T \"foo\"\n&gt; :t x\nx :: T [Char]\n&gt; :t x { tA = True }\nx { tA = True } :: T Bool\n</code></pre>\n\n<p>So, we can't define a default:</p>\n\n<pre><code>&gt; let def :: Read a =&gt; T a ; def = T (read \"True\")\n&gt; :t def :: T Bool\ndef :: T Bool :: T Bool\n&gt; :t def { tA = 5 }\n   Could not deduce (Read t0) arising from a use of \u2018def\u2019\n   The type variable \u2018t0\u2019 is ambiguous\n</code></pre>\n\n<p>Indeed, above <code>def</code> could be of any type.</p>\n\n<p>A possible solution could be forcing the update to have the same type by requiring a <code>T a -&gt; T a</code> continuation function.</p>\n\n<pre><code>&gt; let defF :: Read a =&gt; (T a -&gt; T a) -&gt; T a ; defF f = f (T (read \"True\"))\n&gt; :t defF (\\d -&gt; d { tA = False })\ndefF (\\d -&gt; d { tA = False }) :: T Bool\n</code></pre>\n\n<p>Above <code>d</code> is the default which, by construction, must have the same type of the record after the update.</p>\n\n<p>With lenses, there might be better approaches.</p>\n"}], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 1, "accepted_answer_id": 36885095, "answer_count": 1, "score": 6, "last_activity_date": 1461747724, "creation_date": 1461659020, "question_id": 36859279, "link": "https://stackoverflow.com/questions/36859279/type-inference-could-not-deduce-monad", "title": "Type inference - could not deduce Monad", "body": "<p>I am building a way to display a dialog to users.</p>\n\n<pre><code>data DialogConfig t m b e =\n  DialogConfig { _dialogConfig_title :: Dynamic t T.Text\n               , _dialogConfig_content :: b -&gt; m (Dynamic t (Maybe b))\n               , _dialogConfig_footer :: Dynamic t (Maybe b) -&gt; m (Event t e)\n               }\ndialog :: MonadWidget t m =&gt;\n           DialogConfig t m b e -&gt; Event t b -&gt; m (Event t (DialogEvent e))\n</code></pre>\n\n<p>I would like to use some kind of 'default' instance to initialize <code>DialogConfig</code> for the <code>dialog</code> function, so that I could use it as e.g. <code>defaultConfig{_dialogConfig_content=content}</code>. However, I'm fighting with type inferrence. This works:</p>\n\n<pre><code>confirmDialog :: forall t m. MonadWidget t m =&gt;\n                 T.Text -&gt; Event t T.Text -&gt; m (Event t ())\n...\nevt &lt;- dialog\n         (DialogConfig { _dialogConfig_title = constDyn title\n                       , _dialogConfig_content = content\n                       , _dialogConfig_footer = buttons}\n                       ) contentEvt\n</code></pre>\n\n<p>However, when I use some default <code>DialogConfig</code> (e.g. here directly inlining it), it doesn't:</p>\n\n<pre><code>evt &lt;- dialog\n      (DialogConfig { _dialogConfig_title = constDyn mempty\n                    , _dialogConfig_content = const $ return $ constDyn Nothing\n                    , _dialogConfig_footer = const $ return never }\n                    { _dialogConfig_title = constDyn title\n                    , _dialogConfig_content = content\n                    , _dialogConfig_footer = buttons}\n                    ) contentEvt\n</code></pre>\n\n<p>The errors are:</p>\n\n<pre><code>Could not deduce (Reflex t0) arising from a use of \u2018constDyn\u2019 from the context (MonadWidget t m)\nCould not deduce (Monad t1) arising from a use of \u2018return\u2019 from the context (MonadWidget t m)\n</code></pre>\n\n<p>I can use <code>ScopedTypeVariables</code> and type the default config in the <code>confirmDialog</code> as <code>DialogConfig t m a b</code> and that works, however shouldn't it work even without it? It seems to me that the types are rather unambiguous.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 11, "last_activity_date": 1461651859, "creation_date": 1461651859, "answer_id": 36856802, "question_id": 36855718, "link": "https://stackoverflow.com/questions/36855718/object-from-aeson-has-been-imported-but-the-compiler-says-its-not/36856802#36856802", "title": "Object from Aeson has been imported but the compiler says it&#39;s not", "body": "<p>Believe it or not, you have <em>not</em> imported it yet. The <a href=\"https://hackage.haskell.org/package/aeson-0.11.1.4/docs/Data-Aeson.html#v:Object\" rel=\"noreferrer\"><code>Object</code></a> data constructor constructs a <code>Value</code>, so to import it, you should</p>\n\n<pre><code>import Data.Aeson (Value(Object))\n</code></pre>\n\n<p>or similar. You probably thought that you would get it from</p>\n\n<pre><code>import Data.Aeson (Object(..))\n</code></pre>\n\n<p>but this in fact imports the <a href=\"https://hackage.haskell.org/package/aeson-0.11.1.4/docs/Data-Aeson.html#t:Object\" rel=\"noreferrer\"><code>Object</code></a> <em>type alias</em>. Syntactically it also appears to be trying to import any data constructors associated with the <code>Object</code> type -- but since it is an alias, there are none. (I think I might prefer if GHC issued a warning for this kind of thing!)</p>\n"}], "owner": {"reputation": 3025, "user_id": 6250601, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fc7d2f54bb1971ee8fbfeaf100ed42f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sojo", "link": "https://stackoverflow.com/users/6250601/sojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 36856802, "answer_count": 1, "score": 3, "last_activity_date": 1461652960, "creation_date": 1461647424, "last_edit_date": 1461652960, "question_id": 36855718, "link": "https://stackoverflow.com/questions/36855718/object-from-aeson-has-been-imported-but-the-compiler-says-its-not", "title": "Object from Aeson has been imported but the compiler says it&#39;s not", "body": "<p>I'm importing this:</p>\n\n<pre><code>import Data.Aeson (ToJSON(..), FromJSON(..), (.:), (.=), object, Object(..), decode)\n</code></pre>\n\n<p>And I have this:</p>\n\n<pre><code>instance FromJSON Data123 where\n  parseJSON (Object v) =\n    Data123 &lt;$&gt; v .: \"a\"\n      &lt;*&gt; v .: \"b\"\n      &lt;*&gt; v .: \"c\"\n\n  parseJSON _ = mzero\n\ninstance ToJSON Data123 where\n  toJSON (Data123 a b c) =\n    object [\"a\" .= a\n      , \"b\" .= b\n      , \"c\" .= c\n    ]\n</code></pre>\n\n<p>And I have an error saying </p>\n\n<pre><code>Not in scope: data constructor \u2018Object\u2019\n    Perhaps you meant variable \u2018object\u2019 (imported from Data.Aeson)\n</code></pre>\n\n<p>Haven't I imported it already?</p>\n"}, {"tags": ["haskell", "pattern-synonyms"], "comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461631348, "post_id": 36853338, "comment_id": 61275720, "body": "I don&#39;t know the answer to this particular question, but wanted to mention that you can of course do this with a standard data type like <code>data Thing = Int :? Int</code>.  This doesn&#39;t help you here though, unless you want to replace the tuple with a data type."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461631458, "post_id": 36853338, "comment_id": 61275744, "body": "Yeah, in the actual situation, the tuple is a data type with two fields, if that changes anything :)"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461631674, "post_id": 36853338, "comment_id": 61275799, "body": "It does, in fact, as per my comment.  Let me write up an answer then."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461631850, "post_id": 36853338, "comment_id": 61275848, "body": "Actually, on second thought, the sqrt part is still trouble....  You can do what I suggest, but only to store the actual value, not the sqrt.  Is this something you can also work around?"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461631938, "post_id": 36853338, "comment_id": 61275866, "body": "@jamshidh would I be storing the actual value, but using a pattern synonym to get the <i>square</i> out?  does that change things significantly?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461632283, "post_id": 36853338, "comment_id": 61275952, "body": "You could do it with two different inline operators....  Like <code>??:</code> to store, <code>:?</code> to get out.  That might be confusing though.  When you define an inline constructor, it automatically creates the constructor and pattern, so I doubt using the same thing is possible (and probably not desirable, as people would expect the usual behavior)."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461632460, "post_id": 36853338, "comment_id": 61275991, "body": "@jamshidh that&#39;s what I&#39;m doing right now, but it&#39;s a bit unoptimal.  So I was hoping there was a way to be able to merge the two :)  the end goal is that people might be able to only ever work with <code>:?</code> as both a constructor and a deconstructor and never worry about <code>T</code>"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1461632715, "post_id": 36853338, "comment_id": 61276034, "body": "Looks like @dfeuer found a better soln...."}], "answers": [{"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1461632721, "post_id": 36853625, "comment_id": 61276037, "body": "oh, that&#39;s nice!  I wonder if I&#39;m just really bad at looking at the documentation?"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1461632778, "post_id": 36853625, "comment_id": 61276052, "body": "as for the imperfect isomorphism, one of the internally maintained constraints of the <code>Tup</code> type is that it never stores any negative numbers, so this invariance is internally maintained by the library.  The user is never allowed to directly create values types with the <code>T</code> constructor, so exporting only <code>+&#47;-</code> makes things work nicely.  thanks!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 8, "last_activity_date": 1461632492, "creation_date": 1461632492, "answer_id": 36853625, "question_id": 36853338, "link": "https://stackoverflow.com/questions/36853338/manually-specifying-ismorphisms-for-unidirectional-pattern-synonym/36853625#36853625", "title": "Manually specifying ismorphisms for unidirectional pattern synonym", "body": "<p>As of GHC 7.10, you can use</p>\n\n<pre><code>pattern (:?) :: () =&gt; Floating a =&gt; a -&gt; a -&gt; Tup a\npattern (x :? y) &lt;- T x (sqrt-&gt;y) where\n  x :? y = T x (y^2)\n</code></pre>\n\n<p>My main concern is that <code>sqrt</code> and <code>^2</code> are not quite inverses, both because negative numbers don't have real square roots and because floating point arithmetic is imprecise.</p>\n"}], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 36853625, "answer_count": 1, "score": 3, "last_activity_date": 1461654252, "creation_date": 1461630192, "last_edit_date": 1461654252, "question_id": 36853338, "link": "https://stackoverflow.com/questions/36853338/manually-specifying-ismorphisms-for-unidirectional-pattern-synonym", "title": "Manually specifying ismorphisms for unidirectional pattern synonym", "body": "<p>There probably isn't a way to do this, but I just wanted to ask just in case.</p>\n\n<p>I have a data type that's a simple tuple like this:</p>\n\n<pre><code>data Tup a = T a a\n</code></pre>\n\n<p>I have a pattern synonym like this:</p>\n\n<pre><code>pattern (:?) :: () =&gt; Floating a =&gt; a -&gt; a -&gt; Tup a\npattern (x :? y) &lt;- T x (sqrt-&gt;y)\n</code></pre>\n\n<p>That matches on <code>T x y</code>, but gives y square rooted.  so:</p>\n\n<pre><code>let (_ :? y) = T 1 4 in y\n</code></pre>\n\n<p>is</p>\n\n<pre><code>2.0\n</code></pre>\n\n<p>I'd also like to be able to use <code>:?</code> as a constructor, so I'd be able to do cool things like:</p>\n\n<pre><code>1 :? 2\n</code></pre>\n\n<p>evaluating to</p>\n\n<pre><code>T 1.0 4.0\n</code></pre>\n\n<p>Of course I'd have to manually specify the isomorphism, but is there any syntax or language feature that would enable me to get this behavior?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461642917, "post_id": 36853162, "comment_id": 61278445, "body": "do you set it at all? Is there something like <code>yesodMiddleware = defaultYesodMiddleware</code>?"}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461671735, "post_id": 36853162, "comment_id": 61295448, "body": "@Carsten Yes, there is a <code>yesodMiddleware = defaultYesodMiddlewere</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461672888, "post_id": 36853162, "comment_id": 61296263, "body": "well this is strange - can you rgrep (find in file) your project for <code>Crsf</code> and see if maybe it&#39;s still enabled somewhere?"}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461675710, "post_id": 36853162, "comment_id": 61298570, "body": "@Carsten There is neither <code>Csrf</code> nor <code>Crsf</code> in my files."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461690330, "post_id": 36853162, "comment_id": 61309588, "body": "you don&#39;t use any of these right? <a href=\"https://hackage.haskell.org/package/yesod-core-1.4.20.2/docs/Yesod-Core-Handler.html#g:28\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/yesod-core-1.4.20.2/docs/&hellip;</a> - can you post the handler and maybe the complete error?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461690412, "post_id": 36853162, "comment_id": 61309641, "body": "AFAIK this: <code>csrfErrorMessage = &quot;A valid CSRF token wasn&#39;t present in HTTP headers or POST parameters. Because the request could have been forged, it&#39;s been rejected altogether. Check the Yesod.Core.Handler docs of the yesod-core package for details on CSRF protection.&quot;</code> is the error message that should happen"}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461712508, "post_id": 36853162, "comment_id": 61321310, "body": "I don&#39;t use these functions, and the message you posted is exactly what I receive, I am using the scaffolding, yesod-mysql"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461729167, "post_id": 36853162, "comment_id": 61325635, "body": "if you really don&#39;t use it and have disabled the middleware then you should probably open an <a href=\"https://github.com/yesodweb/yesod\" rel=\"nofollow noreferrer\">issue here</a>"}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461798756, "post_id": 36853162, "comment_id": 61369030, "body": "Today I tested the very same thing again, without changing anything, and it worked! Why? I remember I did rebuild and relaunched <code>stack</code>, why didn&#39;t it work? Well... Thank you for trying to help me so far."}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461630381, "creation_date": 1461628922, "last_edit_date": 1461630381, "question_id": 36853162, "link": "https://stackoverflow.com/questions/36853162/yesod-post-disabling-csrf", "title": "Yesod POST disabling CSRF", "body": "<p>I did disable session by using</p>\n\n<pre><code>makeSessionBackend _ = return Nothing\n</code></pre>\n\n<p>As stated in Yesod book, but I am still getting CSRF problems while testing my JSON API. How can I disable this feature properly?</p>\n\n<p>I am getting this message when I make the request with <code>curl</code></p>\n\n<pre><code>The `defaultCsrfMiddleware` Middleware added in Foundation.hs adds a CSRF token the request cookies\n</code></pre>\n\n<p>I am not using <code>defaultCsrfMiddleware</code></p>\n"}, {"tags": ["haskell", "ambiguous", "type-deduction"], "comments": [{"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "edited": false, "score": 0, "creation_date": 1461624270, "post_id": 36852281, "comment_id": 61273622, "body": "I&#39;m basically looking for a language extension or something that allows for <code>data BlackBox = BlackBox {-# UNSKOLEMIZE #-} (forall a. a)</code>, so that this ambiguity can be explicitly ignored, s.t. <code>x :: a</code> in this example allows <code>a</code> to be brought to the top level"}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1461625572, "post_id": 36852281, "comment_id": 61274112, "body": "<code>unsafeCoerce</code> isn&#39;t doing anything here. The problem is putting <code>x</code> <i>into</i> <code>BlackBox</code>, not getting it out. Maybe you meant to make an existential type?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1461625955, "post_id": 36852281, "comment_id": 61274265, "body": "But the specification <code>getBlackBox :: Proxy a -&gt; BlackBox -&gt; a</code> is wrong! It says &quot;for any type <code>a</code> of your choice I can turn any <code>BlackBox</code> into a value of that type&quot;. In reality you can only retrieve an <code>a</code> if the value in the <code>BlackBox</code> was an <code>a</code> all along: you can&#39;t get a <code>Bool</code> out of a <code>BlackBox</code>containing an <code>Int</code>. To make this work you&#39;d need a <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Typeable.html#t:Typeable\" rel=\"nofollow noreferrer\"><code>Typeable a</code></a> dictionary. I suggest you review the design of the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Dynamic.html\" rel=\"nofollow noreferrer\"><code>Dynamic</code></a> library."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1461626074, "post_id": 36852281, "comment_id": 61274308, "body": "I suspect this may be an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. What are you actually trying to do?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461626717, "post_id": 36852281, "comment_id": 61274504, "body": "Do not do this - use <code>GHC.Prim.Any</code>, which is a &quot;black box&quot; for which it is explicitly safe to do this (you don&#39;t need the proxy argument). If you were going to do this, then the datatype you want is <code>data BlackBox = forall a . BlackBox a</code> - the type <code>forall a . a</code> does not unify with some arbitrary type <code>a&#39;</code> and <code>unsafeCoerce</code> cannot do anything to help here (nor are there any language extensions to turn this off, other than <code>-fdefer-type-errors</code>). Your <code>BlackBox</code> does not mean what you think it means."}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461635054, "post_id": 36852281, "comment_id": 61276549, "body": "Thank you @user2407038 - I think Dynamic is the option I was actually looking for"}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461635108, "post_id": 36852281, "comment_id": 61276566, "body": "@BenjaminHodgson You&#39;re exactly correct with this. Sorry about the funny type definition, that was actually a typo. I was wondering how this could be accomplished, but <code>fromDynamic</code> does it perfectly!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1461638676, "post_id": 36852281, "comment_id": 61277451, "body": "@BenjaminHodgson, the <code>Dynamic</code> library won&#39;t have a design worthy of imitation till GHC 8.2, when <code>Typeable</code> is expected to get massively overhauled."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461646965, "post_id": 36852281, "comment_id": 61279545, "body": "@dfeuer <code>Typeable</code> seems to get massively overhauled every three weeks"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461648281, "post_id": 36852281, "comment_id": 61280040, "body": "@BenjaminHodgson, that may be, but the overhaul currently in the works seems to come pretty close to what one would actually <i>want</i> <code>Typeable</code> to be."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461648420, "post_id": 36852281, "comment_id": 61280097, "body": "Specifically, you&#39;ll be able to <i>use</i> the structural information in the <code>TypeRep</code> in all sorts of ways that you currently can&#39;t, because it will be, or perhaps pretend to be, GADT-like."}], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1461645227, "creation_date": 1461623655, "last_edit_date": 1461645227, "question_id": 36852281, "link": "https://stackoverflow.com/questions/36852281/overcoming-skolemization-via-unsafecoerce", "title": "Overcoming skolemization via unsafeCoerce", "body": "<p>Is there any way to overcome skolemization through <code>unsafeCoerce</code>? Consider the following scenario:</p>\n\n<pre><code>data BlackBox = forall a. BlackBox a\n\nmkBlackBox :: a -&gt; (BlackBox, Proxy a)\nmkBlackBox x = (BlackBox x, Proxy)\n\ngetBlackBox :: Proxy a -&gt; BlackBox -&gt; a\ngetBlackBox Proxy (BlackBox x) = unsafeCoerce x\n</code></pre>\n\n<p>if you run this code, you'll find that if <code>unsafeCoerce :: a1 -&gt; b</code> and <code>BlackBox :: a -&gt; BlackBox</code>, then <code>a1</code> does not unify with <code>a</code>. Is there any hope to staple this together, and just assume it works?</p>\n"}, {"tags": ["haskell", "recursion", "recursion-schemes"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461624353, "post_id": 36851766, "comment_id": 61273644, "body": "do you know the type signature <code>zygo</code> and <code>futu</code> should have?"}, {"owner": {"reputation": 1421, "user_id": 814846, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92d418d6934ed583bab89df95974b6bf?s=128&d=identicon&r=PG", "display_name": "haroldcarr", "link": "https://stackoverflow.com/users/814846/haroldcarr"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461628464, "post_id": 36851766, "comment_id": 61275029, "body": "<code>zygo</code> <code>Fix</code> version: <code>zygo :: Functor f =&gt;  (f b -&gt; b) -&gt; (f (a, b) -&gt; a) -&gt; Fix f -&gt; a</code>"}, {"owner": {"reputation": 1421, "user_id": 814846, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92d418d6934ed583bab89df95974b6bf?s=128&d=identicon&r=PG", "display_name": "haroldcarr", "link": "https://stackoverflow.com/users/814846/haroldcarr"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461628615, "post_id": 36851766, "comment_id": 61275067, "body": "<code>futu</code> <code>Mu</code> version: <code>futu :: (Mu b, Functor (PF b)) =&gt; Ann b -&gt; (a -&gt; F b (Futu b a)) -&gt; a -&gt; b</code>  (see see <a href=\"https://hackage.haskell.org/package/pointless-haskell-0.0.9/docs/Generics-Pointless-RecursionPatterns.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/pointless-haskell-0.0.9/docs/&hellip;</a>)"}, {"owner": {"reputation": 1421, "user_id": 814846, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92d418d6934ed583bab89df95974b6bf?s=128&d=identicon&r=PG", "display_name": "haroldcarr", "link": "https://stackoverflow.com/users/814846/haroldcarr"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461769182, "post_id": 36851766, "comment_id": 61351392, "body": "I do not know the list-only type signature - still trying to figure it out."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461840181, "post_id": 36911924, "comment_id": 61386720, "body": "I&#39;ll let someone else provide an answer about futumorphisms because I haven&#39;t quite been able to stuff them into my head yet."}, {"owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "edited": false, "score": 0, "creation_date": 1461857781, "post_id": 36911924, "comment_id": 61400371, "body": "Do I understand correctly then, that a zygomorphism is a special case of a mutumorphism?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "edited": false, "score": 3, "creation_date": 1461858190, "post_id": 36911924, "comment_id": 61400654, "body": "@AlexR Yep! <code>mutu</code> allows <i>each</i> function to depend on the result of the other, whereas <code>zygo</code> allows <i>one</i> function to depend on the result of the other. <code>mutu</code> generalises <code>zygo</code>."}, {"owner": {"reputation": 1421, "user_id": 814846, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92d418d6934ed583bab89df95974b6bf?s=128&d=identicon&r=PG", "display_name": "haroldcarr", "link": "https://stackoverflow.com/users/814846/haroldcarr"}, "edited": false, "score": 0, "creation_date": 1461996427, "post_id": 36911924, "comment_id": 61461011, "body": "Your use-case-based derivation of list-only <code>zygo</code> made it easy to understand the pattern and see when to use it.  Thanks!"}, {"owner": {"reputation": 1421, "user_id": 814846, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92d418d6934ed583bab89df95974b6bf?s=128&d=identicon&r=PG", "display_name": "haroldcarr", "link": "https://stackoverflow.com/users/814846/haroldcarr"}, "edited": false, "score": 0, "creation_date": 1462073058, "post_id": 36911924, "comment_id": 61482067, "body": "One minor observation.  In the examples that no longer traverse the list to determine even/odd, the <code>isEven</code> name is misleading.   As written, it is convention whether ones starts the call with <code>True</code> or <code>False</code> (or one could traverse the list once before the call to determine).  No big deal - and does not take away from the very useful info.  Thanks."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 40, "last_activity_date": 1501458687, "last_edit_date": 1501458687, "creation_date": 1461839287, "answer_id": 36911924, "question_id": 36851766, "link": "https://stackoverflow.com/questions/36851766/histomorphisms-zygomorphisms-and-futumorphisms-specialised-to-lists/36911924#36911924", "title": "Histomorphisms, Zygomorphisms and Futumorphisms specialised to lists", "body": "<p><em>Zygomorphism</em> is the high-falutin' mathsy name we give to folds built from two <em>semi-mutually</em> recursive functions. I'll give an example.</p>\n\n<p>Imagine a function <code>pm :: [Int] -&gt; Int</code> (for <em>plus-minus</em>) which intersperses <code>+</code> and <code>-</code> alternately through a list of numbers, such that <code>pm [v,w,x,y,z] = v - (w + (x - (y + z)))</code>. You can write it out using primitive recursion:</p>\n\n<pre><code>lengthEven :: [a] -&gt; Bool\nlengthEven = even . length\n\npm0 [] = 0\npm0 (x:xs) = if lengthEven xs\n             then x - pm0 xs\n             else x + pm0 xs\n</code></pre>\n\n<p>Clearly <code>pm0</code> is not <a href=\"https://en.wikipedia.org/wiki/Principle_of_compositionality\" rel=\"noreferrer\">compositional</a> - you need to inspect the length of the whole list at each position to determine whether you're adding or subtracting. <em>Paramorphism</em> models primitive recursion of this sort, when the folding function needs to traverse the whole subtree at each iteration of the fold. So we can at least rewrite the code to conform to an established pattern.</p>\n\n<pre><code>paraL :: (a -&gt; [a] -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nparaL f z [] = z\nparaL f z (x:xs) = f x xs (paraL f z xs)\n\npm1 = paraL (\\x xs acc -&gt; if lengthEven xs then x - acc else x + acc) 0\n</code></pre>\n\n<p>But this is inefficient. <code>lengthEven</code> traverses the whole list at each iteration of the paramorphism resulting in an O(n<sup>2</sup>) algorithm.</p>\n\n<hr>\n\n<p>We can make progress by noting that both <code>lengthEven</code> and <code>para</code> can be expressed as a <em>catamorphism</em> with <code>foldr</code>...</p>\n\n<pre><code>cataL = foldr\n\nlengthEven' = cataL (\\_ p -&gt; not p) True\nparaL' f z = snd . cataL (\\x (xs, acc) -&gt; (x:xs, f x xs acc)) ([], z)\n</code></pre>\n\n<p>... which suggests that we may be able to fuse the two operations into a single pass over the list.</p>\n\n<pre><code>pm2 = snd . cataL (\\x (isEven, total) -&gt; (not isEven, if isEven\n                                                      then x - total\n                                                      else x + total)) (True, 0)\n</code></pre>\n\n<p>We had a fold which depended on the result of another fold, and we were able to fuse them into one traversal of the list. Zygomorphism captures exactly this pattern.</p>\n\n<pre><code>zygoL :: (a -&gt; b -&gt; b) -&gt;  -- a folding function\n         (a -&gt; b -&gt; c -&gt; c) -&gt;  -- a folding function which depends on the result of the other fold\n         b -&gt; c -&gt;  -- zeroes for the two folds\n         [a] -&gt; c\nzygoL f g z e = snd . cataL (\\x (p, q) -&gt; (f x p, g x p q)) (z, e)\n</code></pre>\n\n<p>On each iteration of the fold, <code>f</code> sees its answer from the last iteration as in a catamorphism, but <code>g</code> gets to see both functions' answers. <code>g</code> entangles itself with <code>f</code>.</p>\n\n<p>We'll write <code>pm</code> as a zygomorphism by using the first folding function to count whether the list is even or odd in length and the second one to calculate the total.</p>\n\n<pre><code>pm3 = zygoL (\\_ p -&gt; not p) (\\x isEven total -&gt; if isEven\n                                                then x - total\n                                                else x + total) True 0\n</code></pre>\n\n<p>This is classic functional programming style. We have a higher order function doing the heavy lifting of consuming the list; all we had to do was plug in the logic to aggregate results. The construction evidently terminates (you need only prove termination for <code>foldr</code>), and it's more efficient than the original hand-written version to boot.</p>\n\n<blockquote>\n  <p><strong>Aside</strong>: @AlexR points out in the comments that zygomorphism has a big sister called <em>mutumorphism</em>, which captures mutual recursion in all\n  its glory. <code>mutu</code> generalises <code>zygo</code> in that <em>both</em> the folding\n  functions are allowed to inspect the other's result from the previous\n  iteration.</p>\n\n<pre><code>mutuL :: (a -&gt; b -&gt; c -&gt; b) -&gt;\n         (a -&gt; b -&gt; c -&gt; c) -&gt;\n         b -&gt; c -&gt;\n         [a] -&gt; c\nmutuL f g z e = snd . cataL (\\x (p, q) -&gt; (f x p q, g x p q)) (z, e)\n</code></pre>\n  \n  <p>You recover <code>zygo</code> from <code>mutu</code> simply by ignoring the extra argument.\n  <code>zygoL f = mutuL (\\x p q -&gt; f x p)</code></p>\n</blockquote>\n\n<hr>\n\n<p>Of course, all of these folding patterns generalise from lists to the fixpoint of an arbitrary functor:</p>\n\n<pre><code>newtype Fix f = Fix { unFix :: f (Fix f) }\n\ncata :: Functor f =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a\ncata f = f . fmap (cata f) . unFix\n\npara :: Functor f =&gt; (f (Fix f, a) -&gt; a) -&gt; Fix f -&gt; a\npara f = snd . cata (\\x -&gt; (Fix $ fmap fst x, f x))\n\nzygo :: Functor f =&gt; (f b -&gt; b) -&gt; (f (b, a) -&gt; a) -&gt; Fix f -&gt; a\nzygo f g = snd . cata (\\x -&gt; (f $ fmap fst x, g x))\n\nmutu :: Functor f =&gt; (f (b, a) -&gt; b) -&gt; (f (b, a) -&gt; a) -&gt; Fix f -&gt; a\nmutu f g = snd . cata (\\x -&gt; (f x, g x))\n</code></pre>\n\n<p>Compare the definition of <code>zygo</code> with that of <code>zygoL</code>. Also note that <code>zygo Fix = para</code>, and that the latter three folds can be implemented in terms of <code>cata</code>. In foldology everything is related to everything else.</p>\n\n<p>You can recover the list version from the generalised version.</p>\n\n<pre><code>data ListF a r = Nil_ | Cons_ a r deriving Functor\ntype List a = Fix (ListF a)\n\nzygoL' :: (a -&gt; b -&gt; b) -&gt; (a -&gt; b -&gt; c -&gt; c) -&gt; b -&gt; c -&gt; List a -&gt; c\nzygoL' f g z e = zygo k l\n    where k Nil_ = z\n          k (Cons_ x y) = f x y\n          l Nil_ = e\n          l (Cons_ x (y, z)) = g x y z\n\npm4 = zygoL' (\\_ p -&gt; not p) (\\x isEven total -&gt; if isEven\n                                                 then x - total\n                                                 else x + total) True 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461972037, "post_id": 36923571, "comment_id": 61456301, "body": "Your last point about guaranteeing productivity isn&#39;t quite right. It&#39;s more subtle than that. <code>f</code> certainly could loop forever, or throw an exception; there&#39;s no way to be sure in Haskell. The difference is that the second type allows <code>f</code> to return an <code>a</code> (and continue iteration) <i>without returning any <code>b</code>s</i>. In other words <code>futu</code> will always terminate if <code>f</code> does, whereas <code>notFutu</code> can be induced to loop by a terminating <code>f</code>."}, {"owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461986205, "post_id": 36923571, "comment_id": 61458971, "body": "How is your clarification different than my clarification (in the parenthetical)? Not trying to be antagonistic; just curious."}, {"owner": {"reputation": 1421, "user_id": 814846, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92d418d6934ed583bab89df95974b6bf?s=128&d=identicon&r=PG", "display_name": "haroldcarr", "link": "https://stackoverflow.com/users/814846/haroldcarr"}, "edited": false, "score": 0, "creation_date": 1462073107, "post_id": 36923571, "comment_id": 61482071, "body": "Thanks!   BTW:  the recursive call to <code>notFutuL</code> is missing the <code>f</code> argument."}], "tags": [], "owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "is_accepted": false, "score": 13, "last_activity_date": 1462076891, "last_edit_date": 1462076891, "creation_date": 1461870847, "answer_id": 36923571, "question_id": 36851766, "link": "https://stackoverflow.com/questions/36851766/histomorphisms-zygomorphisms-and-futumorphisms-specialised-to-lists/36923571#36923571", "title": "Histomorphisms, Zygomorphisms and Futumorphisms specialised to lists", "body": "<p>Since no one else has answered for <code>futu</code> yet, I'll try to stumble my way through. I'm going to use <code>ListF a b = Base [a] = ConsF a b | NilF</code></p>\n\n<p>Taking the type in <a href=\"https://hackage.haskell.org/package/recursion-schemes-4.1.2/docs/Data-Functor-Foldable.html#v:futu\" rel=\"noreferrer\"><code>recursion-schemes</code></a>: <code>futu :: Unfoldable t =&gt; (a -&gt; Base t (Free (Base t) a)) -&gt; a -&gt; t</code>.</p>\n\n<p>I'm going to ignore the <code>Unfoldable</code> constraint and substitute <code>[b]</code> in for <code>t</code>.</p>\n\n<pre><code>(a -&gt; Base [b] (Free (Base [b]) a)) -&gt; a -&gt; [b]\n(a -&gt; ListF b (Free (ListF b) a)) -&gt; a -&gt; [b]\n</code></pre>\n\n<p><code>Free (ListF b) a)</code> is a list, possibly with an <code>a</code>-typed hole at the end. This means that it's isomorphic to <code>([b], Maybe a)</code>. So now we have:</p>\n\n<pre><code>(a -&gt; ListF b ([b], Maybe a)) -&gt; a -&gt; [b]\n</code></pre>\n\n<p>Eliminating the last <code>ListF</code>, noticing that <code>ListF a b</code> is isomorphic to <code>Maybe (a, b)</code>:</p>\n\n<pre><code>(a -&gt; Maybe (b, ([b], Maybe a))) -&gt; a -&gt; [b]\n</code></pre>\n\n<p>Now, I'm pretty sure that playing type-tetris leads to the only sensible implementation:</p>\n\n<pre><code>futuL f x = case f x of\n  Nothing -&gt; []\n  Just (y, (ys, mz)) -&gt; y : (ys ++ fz)\n    where fz = case mz of\n      Nothing -&gt; []\n      Just z -&gt; futuL f z\n</code></pre>\n\n<p>Summarizing the resulting function, <code>futuL</code> takes a seed value and a function which may produce <em>at least one</em> result, and possibly a new seed value if it produced a result.</p>\n\n<p>At first I thought this was equivalent to </p>\n\n<pre><code>notFutuL :: (a -&gt; ([b], Maybe a)) -&gt; a -&gt; [b]\nnotFutuL f x = case f x of\n  (ys, mx) -&gt; ys ++ case mx of\n    Nothing -&gt; []\n    Just x' -&gt; notFutuL f x'\n</code></pre>\n\n<p>And in practice, perhaps it is, more or less, but the one significant difference is that the real <code>futu</code> guarantees productivity (i.e. if <code>f</code> always returns, you will never be stuck waiting forever for the next list element).</p>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 13, "last_activity_date": 1469320653, "last_edit_date": 1469320653, "creation_date": 1462274846, "answer_id": 37002861, "question_id": 36851766, "link": "https://stackoverflow.com/questions/36851766/histomorphisms-zygomorphisms-and-futumorphisms-specialised-to-lists/37002861#37002861", "title": "Histomorphisms, Zygomorphisms and Futumorphisms specialised to lists", "body": "<p><em>Histomorphism</em> models <em>dynamic programming</em>, the technique of tabulating the results of previous subcomputations. (It's sometimes called <a href=\"https://en.wikipedia.org/wiki/Mathematical_induction#Complete_induction\" rel=\"noreferrer\">course-of-value induction</a>.) In a histomorphism, the folding function has access to a table of the results of earlier iterations of the fold. Compare this with the catamorphism, where the folding function can only see the result of the last iteration. The histomorphism has the benefit of hindsight - you can see all of history.</p>\n\n<p>Here's the idea. As we consume the input list, the folding algebra will output a sequence of <code>b</code>s. <code>histo</code> will jot down each <code>b</code> as it emerges, attaching it to the table of results. The number of items in the history is equal to the number of list layers you've processed - by the time you've torn down the whole list, the history of your operation will have a length equal to that of the list.</p>\n\n<p>This is what the history of iterating a list(ory) looks like:</p>\n\n<pre><code>data History a b = Ancient b | Age a b (History a b)\n</code></pre>\n\n<p><code>History</code> is a list of pairs of things and results, with an extra result at the end corresponding to the <code>[]</code>-thing. We'll pair up each layer of the input list with its corresponding result.</p>\n\n<pre><code>cataL = foldr\n\nhistory :: (a -&gt; History a b -&gt; b) -&gt; b -&gt; [a] -&gt; History a b\nhistory f z = cataL (\\x h -&gt; Age x (f x h) h) (Ancient z)\n</code></pre>\n\n<p>Once you've folded up the whole list from right to left, your final result will be at the top of the stack.</p>\n\n<pre><code>headH :: History a b -&gt; b\nheadH (Ancient x) = x\nheadH (Age _ x _) = x\n\nhistoL :: (a -&gt; History a b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nhistoL f z = headH . history f z\n</code></pre>\n\n<p>(It happens that <code>History a</code> is a <a href=\"https://hackage.haskell.org/package/comonad-5/docs/Control-Comonad.html\" rel=\"noreferrer\">comonad</a>, but <code>headH</code> (n\u00e9e <code>extract</code>) is all we need to define <code>histoL</code>.)</p>\n\n<hr>\n\n<p><code>History</code> labels each layer of the input list with its corresponding result. The <em>cofree comonad</em> captures the pattern of labelling each layer of an arbitrary structure.</p>\n\n<pre><code>data Cofree f a = Cofree { headC :: a, tailC :: f (Cofree f a) }\n</code></pre>\n\n<p>(I came up with <code>History</code> by plugging <code>ListF</code> into <code>Cofree</code> and simplifying.)</p>\n\n<p>Compare this with the <em>free monad</em>,</p>\n\n<pre><code>data Free f a = Free (f (Free f a))\n              | Return a\n</code></pre>\n\n<p><code>Free</code> is a coproduct type; <code>Cofree</code> is a product type. <code>Free</code> layers up a lasagne of <code>f</code>s, with values <code>a</code> at the bottom of the lasagne. <code>Cofree</code> layers up the lasagne with values <code>a</code> at each layer. Free monads are generalised externally-labelled trees; cofree comonads are generalised internally-labelled trees.</p>\n\n<p>With <code>Cofree</code> in hand, we can generalise from lists to the fixpoint of an arbitrary functor,</p>\n\n<pre><code>newtype Fix f = Fix { unFix :: f (Fix f) }\n\ncata :: Functor f =&gt; (f b -&gt; b) -&gt; Fix f -&gt; b\ncata f = f . fmap (cata f) . unFix\n\nhisto :: Functor f =&gt; (f (Cofree f b) -&gt; b) -&gt; Fix f -&gt; b\nhisto f = headC . cata (\\x -&gt; Cofree (f x) x)\n</code></pre>\n\n<p>and once more recover the list version.</p>\n\n<pre><code>data ListF a r = Nil_ | Cons_ a r deriving Functor\ntype List a = Fix (ListF a)\ntype History' a b = Cofree (ListF a) b\n\nhistoL' :: (a -&gt; History' a b -&gt; b) -&gt; b -&gt; List a -&gt; b\nhistoL' f z = histo g\n    where g Nil_ = z\n          g (Cons_ x h) = f x h\n</code></pre>\n\n<blockquote>\n  <p><strong>Aside</strong>: <code>histo</code> is the dual of <code>futu</code>. Look at their types.</p>\n\n<pre><code>histo :: Functor f =&gt; (f (Cofree f a) -&gt; a) -&gt; (Fix f -&gt; a)\nfutu  :: Functor f =&gt; (a  -&gt;  f (Free f a)) -&gt; (a -&gt; Fix f)\n</code></pre>\n  \n  <p><code>futu</code> is <code>histo</code> with the arrows flipped and with <code>Free</code> replaced by\n  <code>Cofree</code>. Histomorphisms see the past; futumorphisms predict the future.\n  And much like <code>cata f . ana g</code> can be fused into a <em>hylomorphism</em>,\n  <code>histo f . futu g</code> can be fused into a\n  <a href=\"http://comonad.com/reader/2008/time-for-chronomorphisms/\" rel=\"noreferrer\"><em>chronomorphism</em></a>.</p>\n</blockquote>\n\n<p>Even if you skip the mathsy parts, <a href=\"http://www.cs.ox.ac.uk/people/nicolas.wu/publications/Histomorphisms.pdf\" rel=\"noreferrer\">this paper by Hinze and Wu</a> features a good, example-driven tutorial on histomorphisms and their usage.</p>\n"}], "owner": {"reputation": 1421, "user_id": 814846, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92d418d6934ed583bab89df95974b6bf?s=128&d=identicon&r=PG", "display_name": "haroldcarr", "link": "https://stackoverflow.com/users/814846/haroldcarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7166, "favorite_count": 29, "accepted_answer_id": 36911924, "answer_count": 3, "score": 38, "last_activity_date": 1563168515, "creation_date": 1461621185, "last_edit_date": 1563168515, "question_id": 36851766, "link": "https://stackoverflow.com/questions/36851766/histomorphisms-zygomorphisms-and-futumorphisms-specialised-to-lists", "title": "Histomorphisms, Zygomorphisms and Futumorphisms specialised to lists", "body": "<p>I ended up figuring it out.  See the video and slides of a talk I gave:</p>\n\n<ul>\n<li><p><a href=\"https://github.com/haroldcarr/presentations/blob/master/2017-05-27-lambdaconf-recursion-schemes.pdf\" rel=\"noreferrer\">slides/pdf</a></p></li>\n<li><p><a href=\"https://www.youtube.com/watch?v=TEvDaKg4XXA\" rel=\"noreferrer\">video</a></p></li>\n</ul>\n\n<p>Original question:</p>\n\n<p>In my effort to understand generic recursion schemes (i.e., that use <code>Fix</code>) I have found it useful to write list-only versions of the various schemes.  It makes it much easier to understand the actual schemes (without the additional overhead of the <code>Fix</code> stuff).</p>\n\n<p>However, I have not yet figured out how to define list-only versions of <code>zygo</code> and <code>futu</code>.</p>\n\n<p>Here are my specialised definitions so far:</p>\n\n<pre><code>cataL :: (a -&gt;        b -&gt; b) -&gt; b -&gt; [a] -&gt; b\ncataL f b (a : as) = f a    (cataL f b as)\ncataL _ b []       = b\n\nparaL :: (a -&gt; [a] -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nparaL f b (a : as) = f a as (paraL f b as)\nparaL _ b []       = b\n\n-- TODO: histo\n\n-- DONE: zygo (see below)\n\nanaL  :: (b -&gt;       (a, b))               -&gt; b -&gt; [a]\nanaL  f b = let (a, b') = f b in a : anaL f b'\n\nanaL' :: (b -&gt; Maybe (a, b))               -&gt; b -&gt; [a]\nanaL' f b = case f b of\n    Just (a, b') -&gt; a : anaL' f b'\n    Nothing      -&gt; []\n\napoL :: ([b] -&gt; Maybe (a, Either [b] [a])) -&gt; [b] -&gt; [a]\napoL f b = case f b of\n    Nothing -&gt; []\n    Just (x, Left c)  -&gt; x : apoL f c\n    Just (x, Right e) -&gt; x : e\n\n-- DONE: futu (see below)\n\nhyloL  :: (a -&gt; c -&gt; c) -&gt; c -&gt; (b -&gt; Maybe (a, b)) -&gt; b -&gt; c\nhyloL f z g = cataL f z . anaL' g\n\nhyloL' :: (a -&gt; c -&gt; c) -&gt; c -&gt; (c -&gt; Maybe (a, c))      -&gt; c\nhyloL' f z g = case g z of\n    Nothing     -&gt; z\n    Just (x,z') -&gt; f x (hyloL' f z' g)\n</code></pre>\n\n<p>How do you define <code>histo</code>, <code>zygo</code> and <code>futu</code> for lists?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 3, "last_activity_date": 1461618981, "creation_date": 1461618981, "answer_id": 36851220, "question_id": 36850967, "link": "https://stackoverflow.com/questions/36850967/how-to-read-line-by-line-from-a-file-in-haskell/36851220#36851220", "title": "How to read line by line from a file in Haskell", "body": "<p>Have a look at the <code>filter</code> function. You may not want to put all processing on a single line, but use a <em>let</em> expression. Also, your indentation is off:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  filecontent &lt;- readFile \"palindrom.txt\"\n  let selected = filter ... filecontent\n  ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "edited": false, "score": 0, "creation_date": 1461620126, "post_id": 36851391, "comment_id": 61271951, "body": "Hi, thanks for your help, can you please explain a little more about how do the &quot;$&quot; operator and the function filter work?    As far as i understand, the filter check if &quot;isPalindrome&quot; in each line of filecontents, if its true, then print, right ? So why would i need unlines here ?   Many thanks !"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "edited": false, "score": 1, "creation_date": 1461629753, "post_id": 36851391, "comment_id": 61275351, "body": "I&#39;ve added more detail."}, {"owner": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "edited": false, "score": 0, "creation_date": 1461660099, "post_id": 36851391, "comment_id": 61287033, "body": "One more question, now if i want to say &quot;...  is a palindrome&quot; everytime i found a palindrom, where should i add the &quot;.. is a palindrome&quot; part ? I can&#39;t say how much thanksful i am:)"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "edited": false, "score": 0, "creation_date": 1461685826, "post_id": 36851391, "comment_id": 61306767, "body": "In the pure method, you can just add to each individual string in the pipeline using <code>map</code>, like this <code>unlines $ map (++ &quot; is a palindrome&quot;) $ filter isPalindrome $ lines fileContent</code>.  With the monadic approach, you can just add to the <code>putStrLn</code>, like this <code>putStrLn $ item ++ &quot; is a palendrome&quot;</code>.  In this case, the monadic approach is probably much easier to understand, although I still like to keep things pure."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 2, "last_activity_date": 1461629733, "last_edit_date": 1461629733, "creation_date": 1461619695, "answer_id": 36851391, "question_id": 36850967, "link": "https://stackoverflow.com/questions/36850967/how-to-read-line-by-line-from-a-file-in-haskell/36851391#36851391", "title": "How to read line by line from a file in Haskell", "body": "<p>Here is one suggested approach</p>\n\n<pre><code>main ::  IO()\nmain = do\n  filecontent &lt;- readFile \"palindrom.txt\"\n  putStrLn (unlines $ filter isPalindrome $ lines filecontent)\n\nisPalindrome w = w==reverse w\n</code></pre>\n\n<p>The part in parens is pure code, it has type <code>String-&gt;String</code>.  It is generally a good idea to isolate pure code as much as possible, because that code tends to be the easiest to reason about, and often is more easily reusable.</p>\n\n<p>You can think of data as flowing from right to left in that section, broken apart by the <code>($)</code> operators.  First you split the content into separate lines, then filter only the palindromes, finally rebuild the full output as a string.  Also, because Haskell is lazy, even though it looks like it is treating the input as a single <code>String</code> in memory, it actually is only pulling the data as needed.</p>\n\n<hr>\n\n<p>Edited to add extra info....</p>\n\n<p>OK, so the heart of the soln is the pure portion:</p>\n\n<pre><code>unlines $ filter isPalindrome $ lines filecontent\n</code></pre>\n\n<p>The way that <code>($)</code> works is by evaluating the function to the right, then using that as the input of the stuff on the left.  In this case, <code>filecontent</code> is the full input from the file (a <code>String</code>, including newline chars), and the output is STDOUT (also a full string including newline chars).</p>\n\n<p>Let's follow sample input through this process, \"abcba\\n1234\\nK\"</p>\n\n<pre><code>unlines $ filter isPalindrome $ lines \"abcba\\n1234\\nK\"\n</code></pre>\n\n<p>First, lines will break this into an array of lines</p>\n\n<pre><code>unlines $ filter isPalindrome [\"abcba\", \"1234\", \"K\"]\n</code></pre>\n\n<p>Note that the output of lines is being fed into the input for filter.</p>\n\n<p>So, what does filter do?  Notice its type</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>This takes 2 input params, the first is a function (which <code>isPalendrome</code> is), the second a list of items.  It will test each item in the list using the function, and its output is the same list input, minus items that the function has chosen to remove (returned <code>False</code> on).  In our case, the first and third items are in fact palendromes, the second not.  Our expression evaluates as follows</p>\n\n<pre><code>unlines [\"abcba\", \"K\"]\n</code></pre>\n\n<p>Finally, <code>unlines</code> is the opposite of <code>lines</code>....  It will concatinate the items again, inserting newlines in between.</p>\n\n<pre><code>\"abcba\\nK\"\n</code></pre>\n\n<p>Since STDIO itself is a <code>String</code>, this is ready for outputting.</p>\n\n<p>Note that is it perfectly OK to output a list of <code>String</code>s using non-pure functions, as follows</p>\n\n<pre><code>forM [\"1\", \"2\", \"3\"] $ \\item -&gt; do\n    putStrLn item\n</code></pre>\n\n<p>This method however mixes pure and impure code, and is considered slightly less idiomatic Haskell code than the former.  You will still see this type of thing a lot though!</p>\n"}], "owner": {"reputation": 622, "user_id": 5121373, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/682a61eacb08098831bb8a0e1bdbd9b0?s=128&d=identicon&r=PG&f=1", "display_name": "Tu\u1ea5n Ph\u1ea1m", "link": "https://stackoverflow.com/users/5121373/tu%e1%ba%a5n-ph%e1%ba%a1m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4274, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1461629733, "creation_date": 1461618005, "question_id": 36850967, "link": "https://stackoverflow.com/questions/36850967/how-to-read-line-by-line-from-a-file-in-haskell", "title": "How to read line by line from a file in Haskell", "body": "<p>im trying to make a programm that should read line by line from a file and check if its a palindrom, if it is, then print.</p>\n\n<p>I'm really new to haskell so the only thing i could do is just print out each line, with this code : </p>\n\n<pre><code>main ::  IO()\n  main = do\n  filecontent &lt;- readFile \"palindrom.txt\"\n  mapM_ putStrLn (lines filecontent)\n\nisPalindrom w = w==reverse w\n</code></pre>\n\n<p>The thing is, i dont know how to go line by line and check if the line is a palindrom ( note that in my file, each line contains only one word). Thanks for any help.</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1461615919, "post_id": 36849909, "comment_id": 61269731, "body": "See this other question: <a href=\"http://stackoverflow.com/questions/35331801/how-can-i-send-programmatically-haskell-expression-to-current-running-ghci-sessi\" title=\"how can i send programmatically haskell expression to current running ghci sessi\">stackoverflow.com/questions/35331801/&hellip;</a>"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1461655316, "post_id": 36849909, "comment_id": 61283903, "body": "I suggest you use the Jupyter API and <a href=\"https://github.com/gibiansky/IHaskell\" rel=\"nofollow noreferrer\">IHaskell</a> instead. I&#39;m pretty sure that there are already some guides on how to embed jupyter consoles into other applications, since there&#39;s plenty of tools already doing this."}], "owner": {"reputation": 93, "user_id": 4312342, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-zN2TptEwHVk/AAAAAAAAAAI/AAAAAAAAAuM/oehOrGT7iTU/photo.jpg?sz=128", "display_name": "NIkita Nezhevskii", "link": "https://stackoverflow.com/users/4312342/nikita-nezhevskii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461614226, "creation_date": 1461614226, "question_id": 36849909, "link": "https://stackoverflow.com/questions/36849909/how-to-use-ghci-inside-another-application", "title": "How to use GHCi inside another application", "body": "<p>Is it possible to use GHCi inside another application?</p>\n\n<p>In particular I want to pass strings to ghci and receive answer as strings for processing. </p>\n\n<p>I know there is way with interactive mode (ghc --interactive ) but this variant does not save context of computation. </p>\n\n<p>So I would like to redirect communications with GHCi through my application. Is it possible to realize?</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 1, "creation_date": 1461613471, "post_id": 36849627, "comment_id": 61268305, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8029046/removing-syntactic-sugar-list-comprehension-in-haskell\">Removing syntactic sugar: List comprehension in Haskell</a>"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1461614624, "post_id": 36849627, "comment_id": 61268965, "body": "Related: <a href=\"http://stackoverflow.com/questions/32093912/all-combinations-of-elements-of-two-lists-in-haskell\" title=\"all combinations of elements of two lists in haskell\">stackoverflow.com/questions/32093912/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "edited": false, "score": 0, "creation_date": 1461614119, "post_id": 36849709, "comment_id": 61268676, "body": "Very nice! Thanks so much!"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1461613550, "creation_date": 1461613550, "answer_id": 36849709, "question_id": 36849627, "link": "https://stackoverflow.com/questions/36849627/all-to-all-pairings-of-two-lists-in-haskell-without-list-comprehension/36849709#36849709", "title": "All-to-all pairings of two lists in Haskell without list comprehension", "body": "<p>well for each <code>x</code> you need all <code>y</code>s so:</p>\n\n<pre><code>\\x -&gt; map (\\y -&gt; (x,y)) ys\n</code></pre>\n\n<p>now you only need to map this over all <code>xs</code></p>\n\n<pre><code>cross xs ys = map (\\x -&gt; map (\\y -&gt; (x,y)) ys) xs\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>&gt; cross [1..3] \"AB\"\n[[(1,'A'),(1,'B')],[(2,'A'),(2,'B')],[(3,'A'),(3,'B')]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "is_accepted": false, "score": 2, "last_activity_date": 1461676790, "creation_date": 1461676790, "answer_id": 36866175, "question_id": 36849627, "link": "https://stackoverflow.com/questions/36849627/all-to-all-pairings-of-two-lists-in-haskell-without-list-comprehension/36866175#36866175", "title": "All-to-all pairings of two lists in Haskell without list comprehension", "body": "<p>While I'm not sure if ApplicativeDo is allowed as part of your \"building blocks\", but if it is, this can easily be implemented by mapping the tuple function over the first list, and applying that list to the second.</p>\n\n<pre><code>import Control.Applicative\n\nlet xs = [1,2,3]\n    ys = [4,5,6]\n\n(,) &lt;$&gt; xs &lt;*&gt; ys\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>[(1,4),(1,5),(1,6),(2,4),(2,5),(2,6),(3,4),(3,5),(3,6)]\n</code></pre>\n"}], "owner": {"reputation": 12714, "user_id": 505306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TjIHR.png?s=128&g=1", "display_name": "smilingbuddha", "link": "https://stackoverflow.com/users/505306/smilingbuddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "accepted_answer_id": 36849709, "answer_count": 2, "score": 1, "last_activity_date": 1461676790, "creation_date": 1461613251, "question_id": 36849627, "link": "https://stackoverflow.com/questions/36849627/all-to-all-pairings-of-two-lists-in-haskell-without-list-comprehension", "title": "All-to-all pairings of two lists in Haskell without list comprehension", "body": "<p>I am reading through Bird and Wadler's nice book in Functional programming\nand trying to solve the exercises in Haskell. </p>\n\n<p>The chapter on  Lists has a section which says that any list comprehension \ncan be implemented in terms of <code>map</code>, <code>filter</code> and <code>concat</code> and subsidiary functions which one might need for <code>map</code></p>\n\n<p>I am having trouble implementing the following expression in terms of these building blocks. </p>\n\n<pre><code>[(x,y) | x&lt;- xs, y&lt;- ys]\n</code></pre>\n\n<p>How would one use map and filter for this? </p>\n\n<p>I got as far as doing </p>\n\n<p><code>concat [ map (\\ a -&gt; (a,x)) ys | x&lt;-xs ]</code></p>\n\n<p>I suspect we have to use currying cleverly here, but i can't seem to figure it out. </p>\n"}, {"tags": ["haskell", "sudoku"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461607902, "post_id": 36847608, "comment_id": 61265039, "body": "it&#39;s not black magic - one way is to use the <code>do</code> notation for the list-monad (it will make all the combinations for you) - sadly it&#39;s impossible to help you out more because there is not a single line of code here and honestly: I don&#39;t want to write down the complete solver for you"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461607965, "post_id": 36847608, "comment_id": 61265081, "body": "if you want to cheat you can have a look at the <a href=\"https://wiki.haskell.org/Sudoku\" rel=\"nofollow noreferrer\">Haskell wiki</a> or this <a href=\"http://www.cs.tufts.edu/~nr/cs257/archive/richard-bird/sudoku.pdf\" rel=\"nofollow noreferrer\">paper</a> most likely your exercise is build on the paper"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1461612946, "post_id": 36848400, "comment_id": 61267982, "body": "Or as an alternative:  1. Write <code>isFinished</code>  2. <code>import Data.SBV</code>  3. <code>sat isFinished</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1461610457, "last_edit_date": 1592644375, "creation_date": 1461609055, "answer_id": 36848400, "question_id": 36847608, "link": "https://stackoverflow.com/questions/36847608/haskell-sudoku-solver/36848400#36848400", "title": "Haskell sudoku solver", "body": "<p>Break it down into steps:</p>\n<ol>\n<li><p>How can you tell if a partial solution is a finished solution? Simple: since a <code>Sudoku</code> is a list of filled positions, a finished solution is a list with 81 elements. (Assuming a standard 9x9 Sudoku puzzle).</p>\n<p>Task: write <code>isFinished :: Sudoku -&gt; Bool</code></p>\n</li>\n<li><p>Given a list of solutions, how do you know when you are done? Easy: every solution on the list is a finished solution. You could test that directly, or check if <code>x == (step x)</code>.</p>\n<p>Task: write <code>partials :: [Sudoku] -&gt; [Sudoku]</code>, which removes finished solutions from its input.</p>\n</li>\n<li><p>To process a list of solutions, you need to apply <code>step</code> to each one and collect the results. This is precisely the type of computation that the list monad is ideal for: <code>partial_solutions &gt;&gt;= step</code>.</p>\n</li>\n<li><p>To implement <code>solve :: Sudoku -&gt; [Sudoku]</code>, it helps to write <code>solve' :: [Sudoku] -&gt; [Sudoku]</code>, where <code>solve initState = solve' [initState]</code>. <code>solve'</code> itself is a fairly straightforward recursive function if you keep 1-3 above in mind.</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 6062169, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mZvxgO6qPjY/AAAAAAAAAAI/AAAAAAAAADA/OwCXNASmr9A/photo.jpg?sz=128", "display_name": "Rich&#225;rd Nagy", "link": "https://stackoverflow.com/users/6062169/rich%c3%a1rd-nagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3228, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1462116276, "creation_date": 1461606544, "last_edit_date": 1461791418, "question_id": 36847608, "link": "https://stackoverflow.com/questions/36847608/haskell-sudoku-solver", "title": "Haskell sudoku solver", "body": "<p>I'm a beginner in functional programming and I'm making a sudoku solver in Haskell.\nSudokus are contained as <code>[(posX,posY),value)]</code>, if a position is blank, it is not in the list.</p>\n\n<p>Currently I have a function, <code>step :: Sudoku -&gt; [Sudoku]</code>. If the sudoku is already solved, it returns a single element list containing that sudoku. If it is not already solved, but can be, it checks for the first blank position that can be clearly written in (so with only one correct number), and adds it to the sudoku. If there is no such blank point (so multiple numbers fit), it gets the first blank point and makes a list containing multiple sudokus with all the different, valid variations of that point. Lastly, if the sudoku cannot be solved, it returns an empty list.</p>\n\n<p>I know it is exhausting but this is how I was assigned to do it, so please bear with me. My next thing to do is to write an actual solving function, using <code>step</code> (which really is just a single step in solving it), and it has to be like this: <code>solve :: Sudoku -&gt; [Sudoku]</code>. It gets a sudoku, and returns all the possible solutions in a list.</p>\n\n<p>The problem is that I have no idea how. It is probably a recursion using black magic, and I cannot get my head around it.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Edit: Here's the full source code, I figured out the last function too, but currently it is very slow. Is there any way to make is faster?</p>\n\n<pre><code>type Pos = (Int, Int)\ntype Cell = (Pos, Int)\ntype Sudoku = [Cell]\ntype Block = Int\n\n--example:\nsudoku :: Sudoku\nsudoku = [((0,0),3),((0,1),6),((0,4),7),((0,5),1),((0,6),2),\n          ((1,1),5),((1,6),1),((1,7),8),\n          ((2,2),9),((2,3),2),((2,5),4),((2,6),7),\n          ((3,4),1),((3,5),3),((3,7),2),((3,8),8),\n          ((4,0),4),((4,3),5),((4,5),2),((4,8),9),\n          ((5,0),2),((5,1),7),((5,3),4),((5,4),6),\n          ((6,2),5),((6,3),3),((6,5),8),((6,6),9),\n          ((7,1),8),((7,2),3),((7,7),6),\n          ((8,2),7),((8,3),6),((8,4),9),((8,7),4),((8,8),3)]\n\n--returns a list of numbers already used in a row\nnumsInRow :: Sudoku -&gt; Int -&gt; [Int]\nnumsInRow sud n = [ i | ((x,y), i) &lt;- sud, x==n ]\n\n--returns a list of numbers already used in a column\nnumsInCol :: Sudoku -&gt; Int -&gt; [Int]\nnumsInCol sud n = [ i | ((x,y), i) &lt;- sud, y==n ]\n\n--returns the index of a block (goes from 0 to 8) in which the given position is contained\nposToBlock :: Pos -&gt; Block\nposToBlock (x,y) = x - (x `mod` 3) + y `div` 3\n\n--returns all the positions in a block\nblockToPositions :: Block -&gt; [Pos]\nblockToPositions n\n   | n `notElem` [0..8] = error (\"blockToPositions: bad block number \" ++ show n)\n   | otherwise = [ (x,y) | x &lt;- [0..8], y &lt;- [0..8], n == (x - (x `mod` 3) + y `div` 3) ]\n\n--returns the numbers already used in a block\nnumsInBlock :: Sudoku -&gt; Block -&gt; [Int]\nnumsInBlock sud n = [ i | ((x,y), i) &lt;- sud, (j,k) &lt;- blockToPositions n, (x,y) == (j,k)]\n\n--decides if all the elements are unique in a list\nallUnique :: Eq a =&gt; [a] -&gt; Bool\nallUnique [] = True\nallUnique (x:xs) \n  | x `elem` xs = False\n  | otherwise = allUnique xs\n\n--returns if a sudoku is valid, so it is 9x9, all the values are between 1 and 9, and there are no repeating numbers in any row, column, or block\nisSudokuPuzzle :: Sudoku -&gt; Bool\nisSudokuPuzzle sud = and [and [ x `elem` [0..8] &amp;&amp; y `elem` [0..8] &amp;&amp; z `elem` [1..9] | ((x,y), z) &lt;- sud ] , and [ allUnique a | a &lt;- [numsInRow sud i | i &lt;- [0..8] ]] , and [ allUnique a | a &lt;- [numsInCol sud i | i &lt;- [0..8] ]] , and [ allUnique a | a &lt;- [numsInBlock sud i | i &lt;- [0..8] ]]]\n\n--returns if a sudoku is filled, so all the fields have values (and only one value)\nisFilled :: Sudoku -&gt; Bool\nisFilled sud = allUnique [ (x,y) | ((x,y), z) &lt;- sud ] &amp;&amp; length [ (x,y) | ((x,y), z) &lt;- sud ] == 81\n\n--a sudoku is solved if it is a valid sudoku and filled\nisSolved :: Sudoku -&gt; Bool\nisSolved sud = isSudokuPuzzle sud &amp;&amp; isFilled sud\n\n--decides if a position is blank (has no value, not filled) in a sudoku\nisBlank :: Sudoku -&gt; Pos -&gt; Bool\nisBlank sud (x,y) = (x,y) `notElem` [ (j,k) | ((j,k),l) &lt;- sud ]\n\n--gives back a list of all empty positions in a sudoku\nblankPositions :: Sudoku -&gt; [Pos]\nblankPositions sud = [ (x,y) | x &lt;- [0..8], y &lt;- [0..8], isBlank sud (x,y) ]\n\n--returns a list of all valid numbers in a position (empty if position is already filled)\npossibleNumsOnPos :: Sudoku -&gt; Pos -&gt; [Int]\npossibleNumsOnPos sud (x,y)  \n   | isBlank sud (x,y) = [ i | i &lt;- [1..9], i `notElem` numsInRow sud x, i `notElem` numsInCol sud y, i `notElem` numsInBlock sud (posToBlock (x,y)) ]\n   | otherwise = []\n\n--returns a list of all the blank positions and their possible values in a sudoku\npossibleNumsForBlankPos :: Sudoku -&gt; [(Pos, [Int])]\npossibleNumsForBlankPos sud = [ ((x,y), possibleNumsOnPos sud (x,y)) | x &lt;- [0..8], y &lt;- [0..8], isBlank sud (x,y)]\n\n--dedices if a sudoku has a solution (so there is still at least one blank and it has at least one valid value)\nhasSolution :: [(Pos, [Int])] -&gt; Bool\nhasSolution [] = False\nhasSolution a = and [ not (null l) | ((j,k),l) &lt;- a ]\n\n--returns a list of blanks that have only one possible valid value\nuniqueNumForBlankPos :: [(Pos, [Int])] -&gt; [(Pos, Int)]\nuniqueNumForBlankPos a = [ ((j,k),head l) | ((j,k),l) &lt;- a, length l == 1 ]\n\n--fills a field in a sudoku with a given value\ninsertElem :: Sudoku -&gt; Pos -&gt; Int -&gt; Sudoku\ninsertElem sud (x,y) n \n   | isBlank sud (x,y) = ((x,y),n):sud\n   | otherwise = error (\"insertElem: position \" ++ show (x,y) ++ \" is not blank\")\n\n\n--If the sudoku is already solved, it returns a single element list containing that sudoku.\n--If it is not already solved, but can be, it checks for the first blank position that has only one possible valid value, and adds it to the sudoku.\n--If there is no such blank point (so all blanks have multiple valid values), it gets the first blank point and makes a list containing multiple sudokus with all the different, valid variations of that point.\n--Lastly, if the sudoku cannot be solved, it returns an empty list.\nstep :: Sudoku -&gt; [Sudoku]\nstep sud\n   | isSolved sud = [sud]\n   | hasSolution (possibleNumsForBlankPos sud) &amp;&amp; not (null (uniqueNumForBlankPos (possibleNumsForBlankPos sud))) = [ insertElem sud (fst (head (uniqueNumForBlankPos (possibleNumsForBlankPos sud)))) (snd (head (uniqueNumForBlankPos (possibleNumsForBlankPos sud)))) ]\n   | hasSolution (possibleNumsForBlankPos sud) &amp;&amp; null (uniqueNumForBlankPos (possibleNumsForBlankPos sud)) = [ insertElem sud (head (blankPositions sud)) x | x &lt;- possibleNumsOnPos sud (head (blankPositions sud)) ]\n   | not (hasSolution (possibleNumsForBlankPos sud)) = []\n\n--It gets a sudoku, and returns all the possible solutions in a list, but currently it is very slow.\nsolve :: Sudoku -&gt; [Sudoku]\nsolve sud \n    | not (isSudokuPuzzle sud) = error \"solve: improper sudoku\"\n    | otherwise = \n     until done f l \n       where \n         l = return sud\n         f (x:xs) = (f xs) ++ step x \n         f [] = []\n         done m = and (map isSolved m ) &amp;&amp; and (map isSudokuPuzzle m)\n</code></pre>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1461605696, "post_id": 36846057, "comment_id": 61263779, "body": "Use the <code>Alternative</code>/<code>MonadPlus</code> instances of <code>Parser</code> : <code>(v .: &quot;active_org&quot;) &lt;|&gt; (v .: &quot;archived_org&quot;)</code>. If you need, you can tell which branch was taken with e.g. <code>((True,) &lt;$&gt; (v .: &quot;active_org&quot;)) &lt;|&gt; ((False,) &lt;$&gt; (v .: &quot;archived_org&quot;))</code>."}, {"owner": {"reputation": 681, "user_id": 1072240, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1ef5bf598c44bbfa8b87fd77ccf2a993?s=128&d=identicon&r=PG", "display_name": "Jason Whittle", "link": "https://stackoverflow.com/users/1072240/jason-whittle"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461609569, "post_id": 36846057, "comment_id": 61266052, "body": "@user2407038 If you\u2019d like to write that up as an answer, I would happily accept it."}], "answers": [{"tags": [], "owner": {"reputation": 681, "user_id": 1072240, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1ef5bf598c44bbfa8b87fd77ccf2a993?s=128&d=identicon&r=PG", "display_name": "Jason Whittle", "link": "https://stackoverflow.com/users/1072240/jason-whittle"}, "is_accepted": true, "score": 3, "last_activity_date": 1461609515, "creation_date": 1461609515, "answer_id": 36848533, "question_id": 36846057, "link": "https://stackoverflow.com/questions/36846057/is-there-a-clean-way-to-retain-information-while-unwrapping-a-json-object-with-a/36848533#36848533", "title": "Is there a clean way to retain information while unwrapping a JSON object with Aeson?", "body": "<p>From an excellent comment by @user2407038, I got it working with the following: </p>\n\n<pre><code>{-# LANGUAGE TupleSections #-}\n\ninstance FromJSON Org where\n  parseJSON (Object v) = ((True,) &lt;$&gt; (v .: \"active_org\"))\n                     &lt;|&gt; ((False,) &lt;$&gt; (v .: \"archived_org\"))\n                     &gt;&gt;= inner\n    where inner (b, Object v') = Org b\n                             &lt;$&gt; v' .: \"id\"\n                             &lt;*&gt; v' .:? \"description\"\n                             &lt;*&gt; v' .:? \"reference\"\n                             &lt;*&gt; v' .: \"version\"\n          inner (_, _) = mzero\n  parseJSON _ = mzero\n</code></pre>\n"}], "owner": {"reputation": 681, "user_id": 1072240, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1ef5bf598c44bbfa8b87fd77ccf2a993?s=128&d=identicon&r=PG", "display_name": "Jason Whittle", "link": "https://stackoverflow.com/users/1072240/jason-whittle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 36848533, "answer_count": 1, "score": 1, "last_activity_date": 1461609515, "creation_date": 1461601575, "question_id": 36846057, "link": "https://stackoverflow.com/questions/36846057/is-there-a-clean-way-to-retain-information-while-unwrapping-a-json-object-with-a", "title": "Is there a clean way to retain information while unwrapping a JSON object with Aeson?", "body": "<p>I\u2019m attempting to parse a JSON object which is described by the following \u201cmodel schema\u201d: </p>\n\n<pre><code>{\n  \"(archived|active)_org\": {\n    \"id\": \"\",\n    \"description\": \"\",\n    \"reference\": \"\",\n    \"bucket_name\": \"\",\n    \"version\": 0\n  }\n}\n</code></pre>\n\n<p>(Taken directly from the <a href=\"https://api.subledger.com/v2/index.html#!/orgs.json/get_org\" rel=\"nofollow\">API documentation</a>.)</p>\n\n<p>I\u2019m trying to use Aeson to parse this into the following type:</p>\n\n<pre><code>data Org = Org { active :: Bool\n               , orgId :: Text\n               , description :: Maybe Text\n               , reference :: Maybe Text\n               , version :: Int\n               } deriving (Show, Eq)\n</code></pre>\n\n<p>I got as far as this: </p>\n\n<pre><code>instance FromJSON Org where\n  parseJSON (Object v) = do\n    Just (Object v') &lt;- v .: \"active_org\"\n    orgId &lt;- v' .: \"id\"\n    description &lt;- v' .:? \"description\"\n    reference &lt;- v' .:? \"reference\"\n    version &lt;- v' .: \"version\"\n    return $ Org True orgId description reference version\n  parseJSON _ = mzero\n</code></pre>\n\n<p>That implementation works as long as the JSON consumed is tagged as an \"active_org\", but of course fails if provided an \"archived_org\". How do I generalize to cover both cases, and change the first argument to the <code>Org</code> value constructor depending on if it\u2019s an \"active_org\" or an \"archived_org\"? </p>\n"}, {"tags": ["haskell", "gadt"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 7, "creation_date": 1461601794, "post_id": 36845953, "comment_id": 61261465, "body": "You have not correctly translated the type of <code>f</code>. In the original code, it could be instantiated with a type <code>Motor&#39; a</code> for any <code>a</code>, but in the non-working code you state that it&#39;s type is precisely the same <code>a</code> as in <code>ProgramT Motor&#39; m a</code>, whereas in the function body you call <code>f</code> on a <code>Motor&#39; b</code> for some other (existentially quantifed) type <code>b</code>. You probably just need a higher rank type: <code>serialNewportT :: (Monad m, MonadIO m) =&gt; (forall x . Motor&#39; x -&gt; m x) -&gt; ProgramT Motor&#39; m a -&gt; m a</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1461603640, "post_id": 36845953, "comment_id": 61262516, "body": "@user2407038 seems like an answer to me"}, {"owner": {"reputation": 829, "user_id": 640078, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/01e5b91ad42c7d309b09d6ae8991a32c?s=128&d=identicon&r=PG", "display_name": "rprospero", "link": "https://stackoverflow.com/users/640078/rprospero"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461660364, "post_id": 36845953, "comment_id": 61287234, "body": "Ugh.  I did a bunch of research on scoped type variables trying to get everything to match, but didn&#39;t look at rank N types.  I guess it&#39;s time to finally learn them.  @user2407038, if you&#39;d like to make this an answer, I&#39;ll give you the credit for it."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 2, "last_activity_date": 1461677880, "creation_date": 1461677880, "answer_id": 36866629, "question_id": 36845953, "link": "https://stackoverflow.com/questions/36845953/do-gadts-break-equational-reasoning-in-haskell/36866629#36866629", "title": "Do GADTs break equational reasoning in Haskell", "body": "<p>You have not correctly translated the type of f. In the original code, the type of <code>f</code> is <code>forall a . (..) =&gt; Motor' a -&gt; m a</code>. It could be instantiated with a type <code>Motor' a</code> for <em>any</em> <code>a</code>, but in the non-working code you state that it's type is precisely the same <code>a</code> as in <code>ProgramT Motor' m a</code>, whereas in the function body you call <code>f</code> on a <code>Motor' b</code> for some other (existentially quantifed) type <code>b</code>. </p>\n\n<p>You just need a higher rank type: </p>\n\n<pre><code>serialNewportT :: (Monad m, MonadIO m) =&gt; (forall x . Motor' x -&gt; m x) -&gt; ProgramT Motor' m a -&gt; m a\n</code></pre>\n"}], "owner": {"reputation": 829, "user_id": 640078, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/01e5b91ad42c7d309b09d6ae8991a32c?s=128&d=identicon&r=PG", "display_name": "rprospero", "link": "https://stackoverflow.com/users/640078/rprospero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 36866629, "answer_count": 1, "score": 1, "last_activity_date": 1461677880, "creation_date": 1461601257, "question_id": 36845953, "link": "https://stackoverflow.com/questions/36845953/do-gadts-break-equational-reasoning-in-haskell", "title": "Do GADTs break equational reasoning in Haskell", "body": "<p>I have the following interpreter using ProgramT from the operational package</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\nimport Control.Monad ((&lt;=&lt;))\nimport Control.Monad.Operational\n\ndata Motor' a where\n  --Define GADT\n\nserialNewportT :: (Monad m, MonadIO m) =&gt; ProgramT Motor' m a -&gt; m a\nserialNewportT = eval &lt;=&lt; viewT\n  where\n    eval :: (Monad m, MonadIO m) =&gt; ProgramViewT Motor' m v -&gt; m v\n    eval (Return x) = return x\n    eval (x :&gt;&gt;= k) = f x &gt;&gt;= serialNewportT  . k\n\nf :: (Monad m, MonadIO m) =&gt; Motor' a -&gt; m a\nf = undefined -- excluded for brevity\n</code></pre>\n\n<p>The code, as it stands, currently type checks just fine.  However, I want to be able to switch out how the interpreter handles different motors, so I want to make <code>f</code> a parameter, instead of having it hard coded in.  I've tried to make this switch with the following code</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\nimport Control.Monad ((&lt;=&lt;))\nimport Control.Monad.Operational\n\ndata Motor' a where\n  --Define GADT\n\nserialNewportT :: (Monad m, MonadIO m) =&gt; (Motor' a -&gt; m a) -&gt; ProgramT Motor' m a -&gt; m a\nserialNewportT f = eval &lt;=&lt; viewT\n  where\n    eval :: (Monad m, MonadIO m) =&gt; ProgramViewT Motor' m v -&gt; m v\n    eval (Return x) = return x\n    eval (x :&gt;&gt;= k) = f x &gt;&gt;= serialNewportT f . k\n</code></pre>\n\n<p>However, this code fails with an error message</p>\n\n<pre><code>Couldn't match type \u2018b\u2019 with \u2018c\u2019\n   \u2018b\u2019 is a rigid type variable bound by\n       a pattern with constructor\n         :&gt;&gt;= :: forall (instr :: * -&gt; *) (m :: * -&gt; *) a b.\n                 instr b -&gt; (b -&gt; ProgramT instr m a) -&gt; ProgramViewT instr m a,\n       in an equation for \u2018eval\u2019\n   \u2018c\u2019 is a rigid type variable bound by\n       the type signature for\n         serialNewportT :: (Monad m, MonadIO m) =&gt;\n                           (Motor' c -&gt; m c) -&gt; ProgramT Motor' m a -&gt; m a\n Expected type: Motor' c\n   Actual type: Motor' b\n</code></pre>\n\n<p>Since I'm just replacing the global name with a local one of the same type, I would have thought that it should have worked without a hitch.  How can I get the types to unify with <code>f</code> as a parameter?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461602746, "post_id": 36845785, "comment_id": 61262024, "body": "why not stick with more readable point-version? I sometimes don&#39;t understand the obsession with point-free"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1461603762, "post_id": 36845785, "comment_id": 61262578, "body": "I&#39;ve incorporated that into my answer, as it&#39;s a good point to emphasize. I like trying to see how far the point-free style can be taken, if only to get a better feel for when it stops being more readable that what you are trying to replace."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1461603602, "last_edit_date": 1461603602, "creation_date": 1461601113, "answer_id": 36845905, "question_id": 36845785, "link": "https://stackoverflow.com/questions/36845785/cant-write-haskell-function-with-the-dot-operator/36845905#36845905", "title": "Can&#39;t write Haskell function with the dot operator", "body": "<p>Point-free style starts to get messy when multi-argument functions are involved. Arguably, something like</p>\n\n<pre><code>(toInteger . digitToInt) $ show n !! x\n</code></pre>\n\n<p>is more readable. Read on for some examples progressing towards a point-free version of this expression.</p>\n\n<hr>\n\n<p>First, <code>show n !! x</code> is actually <code>(!!) (show n) x</code> (because function application has higher precedence that <code>(!!)</code>), so you can't directly compose <code>show</code> and <code>(!!)</code>. Instead, you can write</p>\n\n<pre><code>toInteger (digitToInt ((!!) (show n) x))\n</code></pre>\n\n<hr>\n\n<p>Function application also has higher precedence than composition, so you need to use parentheses:</p>\n\n<pre><code>(toInteger . digitToInt . (!!)) (show n) x\n</code></pre>\n\n<p>or the <code>($)</code> operator, which has lower precedence than composition:</p>\n\n<pre><code>toInteger . digitToInt . (!!) $ (show n) x\n</code></pre>\n\n<hr>\n\n<p>Going a little crazy, you could use <code>flip</code> to partially apply <code>(!!)</code> to <code>x</code> first, letting you write</p>\n\n<pre><code>toInteger . digitToInt . (flip (!!)) x . show $ n\n</code></pre>\n\n<hr>\n\n<p>Going a little <em>more</em> crazy, use <code>Control.Arrow</code> and <code>uncurry</code> to define a completely point-free function that you can apply to the <em>pair</em> <code>(n, x)</code></p>\n\n<pre><code>toInteger . digitToInt . (first show &gt;&gt;&gt; uncurry (!!)) $ (n, x)\n</code></pre>\n\n<p>Here, <code>first show</code> is a function that takes a pair <code>(n, x)</code> and returns <code>((show n), x)</code>. This pair is then fed to <code>uncurry (!!)</code>; <code>uncurry</code> simply creates a function that takes a pair as input instead of two arguments:</p>\n\n<pre><code>&gt; :t (!!)\n[a] -&gt; Int -&gt; a\n&gt; :t uncurry (!!)\n([c], Int) -&gt; c\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1070, "user_id": 1449443, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/de8b952d9c1a4cdcd5110087dc8ed715?s=128&d=identicon&r=PG", "display_name": "ironicaldiction", "link": "https://stackoverflow.com/users/1449443/ironicaldiction"}, "edited": false, "score": 0, "creation_date": 1461620344, "post_id": 36849033, "comment_id": 61272058, "body": "elegant, but could you expand on what <code>map (read . (:[])) . show</code> is doing / how it&#39;s composing those functions?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461638494, "post_id": 36849033, "comment_id": 61277407, "body": "Why not <code>digitToInt</code>? Also, this all seems a rather indirect way to calculate."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1461640794, "last_edit_date": 1461640794, "creation_date": 1461611103, "answer_id": 36849033, "question_id": 36845785, "link": "https://stackoverflow.com/questions/36845785/cant-write-haskell-function-with-the-dot-operator/36849033#36849033", "title": "Can&#39;t write Haskell function with the dot operator", "body": "<p>It's better invest the time to have a better function, for example</p>\n\n<pre><code>toDigits :: Integer -&gt; [Integer]\ntoDigits = map (read . (:[])) . show\n\n&gt; toDigits 123\n[1,2,3]\n&gt; toDigits 0\n[0]\n</code></pre>\n\n<p><strong>Explanation</strong> </p>\n\n<blockquote>\n  <p><code>show</code> converts the Integer into a String, <code>(:[])</code> converts each\n  a char into a String, <code>read</code> converts the String back to an\n  Integer, those two functions mapped to the elements of the String\n  representation of the original Integer, so what we get back is the\n  digits of the Integer in a list form.</p>\n</blockquote>\n\n<p>As in your own solution, in the other answer and the comment below, you can simply it further using digitToInt</p>\n\n<pre><code>import Data.Char(digitToInt)\ntoDigits = map digitToInt . show\n</code></pre>\n"}], "owner": {"reputation": 1070, "user_id": 1449443, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/de8b952d9c1a4cdcd5110087dc8ed715?s=128&d=identicon&r=PG", "display_name": "ironicaldiction", "link": "https://stackoverflow.com/users/1449443/ironicaldiction"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1461640794, "creation_date": 1461600763, "question_id": 36845785, "link": "https://stackoverflow.com/questions/36845785/cant-write-haskell-function-with-the-dot-operator", "title": "Can&#39;t write Haskell function with the dot operator", "body": "<p>I'm writing a simple function to convert an <code>Integer</code> to a list of its individual digits:</p>\n\n<pre><code>toDigits :: Integer -&gt; [Integer]\ntoDigits 0 = [0]\ntoDigits n = [toInteger (digitToInt (show n !! x)) | x &lt;- [0..(length (show n) - 1)]]\n</code></pre>\n\n<p>I wanted to chain the </p>\n\n<p><code>toInteger (digitToInt (show n !! x))</code> </p>\n\n<p>with the dot operator like so:</p>\n\n<pre><code>toInteger . digitToInt . show . (!!) n x\n</code></pre>\n\n<p>but I think I'm having a misunderstanding of how to compose these functions with the dot operator as this produces illegible (to my haskell-brain) type errors</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6221346, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2f23a6abb15d5c6fae71b2df7357307?s=128&d=identicon&r=PG&f=1", "display_name": "Begovic", "link": "https://stackoverflow.com/users/6221346/begovic"}, "edited": false, "score": 0, "creation_date": 1461599066, "post_id": 36845198, "comment_id": 61259856, "body": "thank you for your answer @Carsten , when its possible, i want to print only x and not Just x too."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461599209, "post_id": 36845198, "comment_id": 61259951, "body": "Not really time for a whole answer, but maybe you want to add <code>listToMaybe . drop 1 . dropWhile (&#47;= e)</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461599358, "post_id": 36845198, "comment_id": 61260044, "body": "@Zeta I can - maybe this is a bit rough for the OP (seems he is just starting out and explaining <code>listToMaybe</code> and probably <code>(.)</code>/point-free too seems a bit much"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1461599594, "last_edit_date": 1461599594, "creation_date": 1461598936, "answer_id": 36845198, "question_id": 36845072, "link": "https://stackoverflow.com/questions/36845072/next-element-in-a-list/36845198#36845198", "title": "next element in a List", "body": "<p>first the original examples already form the definition:</p>\n\n<pre><code>next 20 = 10\nnext 10 = 5\nnext 5 = 30\nnext 30 = 25\nnext 25 = 37\nnext 37 = 2\nnext 2 = 11\nnext 11 = 31\nnext _ = -1\n</code></pre>\n\n<p>so you could just stick with this.</p>\n\n<hr>\n\n<p>now if you want to use a list then maybe you should use pattern-matching here:</p>\n\n<pre><code>next e (x:y:ys)\n  | e == x = Just y\n  | otherwise = next e (y:ys)\nnext _ _ = Nothing\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; next 10 schlange\nJust 5\n\u03bb&gt; next 37 schlange\nJust 2\n</code></pre>\n\n<p>note that this will return a <code>Maybe</code> as it can happen that the element <code>e</code> is not in the list (IMO this is better then returning <code>-1</code>)</p>\n\n<p>@zeta provided a nice point-free / one-line version:</p>\n\n<pre><code>next e = listToMaybe . drop 1 . dropWhile (/= e)\n</code></pre>\n\n<p>you probably don't know <code>Data.Maybe.listToMaybe</code> - it's basically</p>\n\n<pre><code>listToMaybe [a:_] = Just a\nlistToMaybe []    = Nothing\n</code></pre>\n\n<p>and the function does what it says:</p>\n\n<ul>\n<li>drop all element that are <strong>not</strong> <code>e</code> from the front of the list</li>\n<li>then drop one more (the <code>e</code>)</li>\n<li>finally use <code>listToMaybe</code> to warp the first remaining element into <code>Just' if there is any - if not return</code>Nothing`</li>\n</ul>\n\n<hr>\n\n<p>the reason your version is not working is that <code>[y]</code> here does not make any sense at all - <code>[y]</code> would be the singleton list of just <code>y</code> and what should a list <em>plus</em> 1 be? Why should this return a number here?</p>\n"}], "owner": {"reputation": 21, "user_id": 6221346, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2f23a6abb15d5c6fae71b2df7357307?s=128&d=identicon&r=PG&f=1", "display_name": "Begovic", "link": "https://stackoverflow.com/users/6221346/begovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461599594, "creation_date": 1461598619, "question_id": 36845072, "link": "https://stackoverflow.com/questions/36845072/next-element-in-a-list", "title": "next element in a List", "body": "<p>I want to get the next element of a list in haskell like:</p>\n\n<pre><code>beginn = 20\nnext 20 = 10\nnext 10 = 5\nnext 5 = 30\nnext 30 = 25\nnext 25 = 37\nnext 37 = 2\nnext 2 = 11\nnext 11 = 31\nnext _ = -1\n</code></pre>\n\n<p>my list is : Stack  = [20,10,5,30,25,37,2,11,31]</p>\n\n<p>my code is : </p>\n\n<pre><code>schlange  = [20,10,5,30,25,37,2,11,31]\n\nbeginn = head schlange\n\nnext y = if y `elem` schlange then [y]+1 else -1\n</code></pre>\n\n<p>but it was not correct </p>\n"}, {"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1461595949, "post_id": 36843888, "comment_id": 61257629, "body": "BTW, <code>main</code> is not a function. It&#39;s an <i>action</i>. Functions are characterised by having arguments."}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1461596568, "post_id": 36843888, "comment_id": 61258099, "body": "@leftaroundabout This sounds weird to me, is it in the language spec? The type signature of <code>main</code> suggests that it is a value. the &quot;action&quot; comes from the internal magic of the IO monad, right? Surely you wouldn&#39;t call <code>x :: Int; x = 5</code> an action?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 2, "creation_date": 1461596973, "post_id": 36843888, "comment_id": 61258362, "body": "@kai: of course it&#39;s also a value. Every\u201cthing\u201d in Haskell is a value, including functions and actions. Just, most values aren&#39;t functions, nor actions, indeed. The term <i>action</i> isn&#39;t really well-defined, it&#39;s usually understood as a value of some type <code>M A</code> where <code>M</code> is a monad. <code>IO ()</code> does certainly qualify, <code>Int</code> certainly does not! It would be less clear-cut whether e.g. <code>[True]</code> should be considered an action."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1461597920, "post_id": 36843888, "comment_id": 61259043, "body": "Just as a note, the type of main is <code>IO a</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1461609039, "post_id": 36843888, "comment_id": 61265728, "body": "@leftaroundabout, I would say these days many/most would say it&#39;s a value of some type <code>F A</code> where <code>F</code> is an applicative functor."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 1, "creation_date": 1461609260, "post_id": 36843888, "comment_id": 61265867, "body": "@DerekElkins, indeed it is, but IMO it&#39;s always best to fix it to either <code>IO ()</code>, <code>IO Void</code>, or polymorphic <code>IO a</code> (which is equivalent to <code>IO Void</code>). I choose one of the latter to indicate that the program can only terminate as the result of an exception."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461609357, "post_id": 36843888, "comment_id": 61265939, "body": "Do not use <code>head</code> to inspect the argument list! That will give a very bad error message if there are no arguments!"}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 6, "last_activity_date": 1461597072, "last_edit_date": 1461597072, "creation_date": 1461595919, "answer_id": 36844051, "question_id": 36843888, "link": "https://stackoverflow.com/questions/36843888/type-of-main-function-doesnt-mean-to-my-application/36844051#36844051", "title": "type of main function doesn&#39;t mean to my application", "body": "<p>You need to run it with <code>runErrorT</code>:</p>\n\n<pre><code>runErrorT :: ErrorT e m a -&gt; m (Either e a)\n</code></pre>\n\n<p>Since <code>myFoo</code> returns a <code>ErrorT String IO ()</code> this will evaluate to an <code>IO (Either String ())</code> which you execute in <code>main</code> and match on the result:</p>\n\n<pre><code>args &lt;- getArgs\ns &lt;- readFile $ head args\nresult &lt;- runErrorT (myFoo s)\ncase result of\n  Right _ -&gt; putStrLn \"ok!\"\n  Left(err) -&gt; putStrLn $ \"Error: \" ++ err\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29707, "user_id": 394167, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5b8b4928a69d422138ed747c70e8553e?s=128&d=identicon&r=PG", "display_name": "Richard Cook", "link": "https://stackoverflow.com/users/394167/richard-cook"}, "is_accepted": false, "score": 3, "last_activity_date": 1461596829, "creation_date": 1461596829, "answer_id": 36844408, "question_id": 36843888, "link": "https://stackoverflow.com/questions/36843888/type-of-main-function-doesnt-mean-to-my-application/36844408#36844408", "title": "type of main function doesn&#39;t mean to my application", "body": "<p>To expand on @Lee's answer, you can then use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-Exit.html#v:exitFailure\" rel=\"nofollow\"><code>exitFailure</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-Exit.html#v:exitSuccess\" rel=\"nofollow\"><code>exitSuccess</code></a> from <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-Exit.html\" rel=\"nofollow\"><code>System.Exit</code></a> to return an appropriate error code to the calling process:</p>\n\n<pre><code>module Main (main) where\n\nimport Control.Monad.Error\nimport System.Environment\nimport System.Exit\n\nmyFoo :: String -&gt; ErrorT String IO ()\nmyFoo = undefined\n\nmain :: IO ()\nmain = do\n    args &lt;- getArgs\n    s &lt;- readFile $ head args\n    result &lt;- runErrorT (myFoo s)\n    case result of\n        Right _ -&gt; do\n            putStrLn \"OK\"\n            exitSuccess\n        Left (e) -&gt; do\n            putStrLn $ \"Error: \" ++ e\n            exitFailure\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 36844051, "answer_count": 2, "score": 0, "last_activity_date": 1461597072, "creation_date": 1461595503, "last_edit_date": 1461595593, "question_id": 36843888, "link": "https://stackoverflow.com/questions/36843888/type-of-main-function-doesnt-mean-to-my-application", "title": "type of main function doesn&#39;t mean to my application", "body": "<p>As we know main function has type <code>IO ()</code>.\nHowever, it is problem for me, because my program may return error.  It means that I am executing from main function something like that:  </p>\n\n<pre><code>ErrorT String IO ()  \n</code></pre>\n\n<p>Of course, at this moment I have problem with type errors.</p>\n\n<p>What should I do ?</p>\n\n<pre><code>args &lt;- getArgs\ns &lt;- readFile $ head args\nmyFoo s\n</code></pre>\n\n<p>Where <code>myFoo :: String -&gt; ErrorT String IO ()</code>  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461589465, "post_id": 36841435, "comment_id": 61252557, "body": "what about using <code>otherwise = abs (crosssumalt i n)</code>? Also this is borderline unreadable - please use camelCase (<code>genCrossSum</code>) and <code>| bool == False</code> is <code>| not bool</code> and <code>bool</code> is not a good name IMO - what about renaming <code>bool</code> into <code>allPlus</code> (<code>notAlternating</code> would lead into <code>not notAtlernating</code>)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461589703, "post_id": 36841435, "comment_id": 61252777, "body": "BTW: I have some doubts about your <code>crosssumalt</code> ... have you tested this?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 7, "creation_date": 1461589833, "post_id": 36841435, "comment_id": 61252882, "body": "also: <i>what</i> is a cross sum exactly (never heard of it)"}, {"owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461593783, "post_id": 36841435, "comment_id": 61255893, "body": "I have to use the parameters Integer Bool Interger because its given in the task by my professor. Cross sum is another word for Digit sum which means you add every digit of the number."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461596580, "post_id": 36841435, "comment_id": 61258107, "body": "but you don&#39;t have to name them <code>bool</code> (right?)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461596872, "post_id": 36841435, "comment_id": 61258302, "body": "btw: then why isn&#39;t <code>crosssumalt 54321 = -5 + 4 -3 +2 -1 = -3</code>"}, {"owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461598881, "post_id": 36841435, "comment_id": 61259725, "body": "there are 2 parameters given to crosssumalt 1 54321 would be -5 + 4 -3 +2 -1 = -3 and  crosssumalt 2 54321 would be 21 - 43 + 5 = -17. For 2 as first parameter it adds the degits in steps of 2 for 1 it does a normal digit sum. Btw Calling abs on my genCrossSum works well. Thank you for telling me about it."}], "owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461589400, "creation_date": 1461589400, "question_id": 36841435, "link": "https://stackoverflow.com/questions/36841435/cross-sum-that-alternates-between-and", "title": "cross sum that alternates between + and -", "body": "<p>This is the code i already wrote. I am able to get the cross sum of an integer.</p>\n\n<pre><code>module Blueprint where\nimport Prelude\n\ncrosssum :: Integer -&gt; Integer -&gt; Integer\ncrosssum i n \n    |n &lt; 1*10^i = n\n    |otherwise = let(d,m)=n`divMod` (1*10^i)  in  m + crosssum i d \n\n\ncrosssumalt :: Integer -&gt; Integer -&gt; Integer\ncrosssumalt i n \n    |n &lt; 1*10^i = n\n    |n &lt; 0 = let(d,m)=n`divMod`(1*10^i) in  m + crosssumalt i d \n    |otherwise = let(d,m)=n`divMod`(1*10^i) in  m - crosssumalt i d \n\n\ngencrosssum :: Integer -&gt; Bool -&gt; Integer -&gt; Integer\ngencrosssum i bool n\n    |bool==False=crosssum i n   \n    |otherwise=crosssumalt i n\n</code></pre>\n\n<p>My problem is that if the user types the Bool \"True\" in the parameters it is supposed to do: 54321=-5 + 43 - 21 = 17 or 1234567 = 1 - 234 + 567 = 334. False is the the normal cross sum. So gencrosssum  True  54321 gives me -17 instead of 17 (its supposed to always give out a positive Integer). My idea would be to just put a guard in crossumalt that would turn a negative into a positive, but nesting guards in guards gives me parse errors. Maybe someone would be so kind to give me a better solotion or show me how i can put a guard in gencrosssum that turns negatives into positives. </p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1461588160, "post_id": 36840728, "comment_id": 61251482, "body": "an obvious problem will be that you don&#39;t get an <code>Environment</code> right? I think you have to break open <code>TaskMonad</code> again (instead of using the <code>&gt;&gt;=</code> you already got)"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461589613, "post_id": 36840728, "comment_id": 61252699, "body": "Uh oh, after many bad words spoken I got my instance of Applicative for TaskMonad to work. I&#39;m getting rusty. Trying to get your bind to work now."}, {"owner": {"reputation": 66, "user_id": 6228937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c011d81846af89f254a8147133eb998f?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/6228937/jasper"}, "edited": false, "score": 0, "creation_date": 1461590197, "post_id": 36840728, "comment_id": 61253182, "body": "Hmm, I guess I will have to fiddle with the <code>Environment</code> a bit indeed. Important to note is that the <code>(&gt;&gt;=)</code> function for <code>TaskMonad</code> is somewhat complex; simply providing an <code>Environment</code> to a <code>TaskMonad</code> is not sufficient. I need it to be expressed using <code>TaskMonad</code>&#39;s <code>(&gt;&gt;=)</code>. Thanks for trying Bartek! I&#39;m out of bad words myself by now."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1461590730, "post_id": 36840728, "comment_id": 61253602, "body": "Maybe it would make sense to define <code>TaskMonad</code> as a transformer from the very beginning? It looks similar to StateT on the outside, perhaps this is the way to go?"}], "answers": [{"comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1461612989, "post_id": 36842138, "comment_id": 61268024, "body": "It&#39;s possible to define just <code>(&lt;*&gt;) = ap</code>."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1461592823, "last_edit_date": 1592644375, "creation_date": 1461591205, "answer_id": 36842138, "question_id": 36840728, "link": "https://stackoverflow.com/questions/36840728/monad-transformer-troubles-defining-bind-due-to-different-monads/36842138#36842138", "title": "Monad Transformer: troubles defining bind due to different monads", "body": "<p>Okay, I don't know how much this helps, but if you actually start with a transformer from day 0 (in <code>TaskMonad</code>), the way you can do it is:</p>\n<pre><code>data TaskMonad m a = TaskMonad (Environment -&gt; m (TaskResult a, Environment)) deriving Functor\n        \ninstance Monad m =&gt; Monad (TaskMonad m) where\n    return = pure\n    (TaskMonad f) &gt;&gt;= b = TaskMonad $ \\e -&gt; do\n        (TaskResult r, e') &lt;- f e\n        let (TaskMonad g) = b r\n        g e'\n\ninstance (Monad m, Functor m) =&gt; Applicative (TaskMonad m) where\n    pure a = TaskMonad $ \\e -&gt; return (TaskResult a, e)\n    (TaskMonad f) &lt;*&gt; (TaskMonad g) = TaskMonad $ \\e -&gt; do\n        (TaskResult f', e') &lt;- f e \n        (TaskResult a, e'') &lt;- g e'\n        return (TaskResult (f' a), e'')\n    \n</code></pre>\n<p>Probably there's also a way to do that the way you originally intended, but I am pretty sure original <code>Task</code> would also need to be changed to take initial <code>Environment</code>.</p>\n<p>I presume you're actually doing more than <code>State</code> in your monad, so that would need to be put in respective instances, but I think the framework for that should help.</p>\n<p>And of course, shall you ever need to use a non-transformer version, just pass in <code>Identity</code> for <code>m</code>.</p>\n<hr />\n<h3>Disclaimer:</h3>\n<p>I know this implemenation of <code>Applicative</code> instance doesn't make sense, but I was building that on old GHC w/o <code>ApplicativeDo</code> and it was literally the easiest thing to put the silly constraint there.</p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 2, "last_activity_date": 1461615847, "last_edit_date": 1495540356, "creation_date": 1461615847, "answer_id": 36850366, "question_id": 36840728, "link": "https://stackoverflow.com/questions/36840728/monad-transformer-troubles-defining-bind-due-to-different-monads/36850366#36850366", "title": "Monad Transformer: troubles defining bind due to different monads", "body": "<p>As described in @BartekBanachewicz's answer, putting the monad <code>m</code> inside <code>-&gt;</code> is the way to go.</p>\n\n<p>I believe it's not possible to do it the way you want by having <code>m (TaskMonad a)</code>, at least not generically. In general <a href=\"https://stackoverflow.com/q/13034229/1333025\">monads aren't closed under composition</a> and this is an example of such a situation.</p>\n\n<p>Let me give a simplified example (some theory will be required for it): Let's work with the reader monad instead of the state monad, let's drop <code>TaskResult</code> and let's have the environment as a type parameter. So <code>TaskMonad</code> will be just <code>m (r -&gt; a)</code>. Now let's assume it's a monad, then there is</p>\n\n<pre><code>join :: m (r -&gt; (m (r -&gt; a))) -&gt; m (r -&gt; a)\n</code></pre>\n\n<p>Specializing <code>a</code> to <a href=\"https://hackage.haskell.org/package/void-0.7.1/docs/Data-Void.html\" rel=\"nofollow noreferrer\"><code>Void</code></a> (see also <a href=\"https://en.wikipedia.org/wiki/Bottom_type\" rel=\"nofollow noreferrer\">Bottom type</a>) and <code>m</code> to <code>Either r</code> we get</p>\n\n<pre><code>join :: Either r (r -&gt; (Either r (r -&gt; Void))) -&gt; Either r (r -&gt; Void)\n</code></pre>\n\n<p>But then we're able to construct</p>\n\n<pre><code>doubleNegationElimination :: Either r (r -&gt; Void)\ndoubleNegationElimination = join (Right Left)\n</code></pre>\n\n<p>as <code>Right Left :: Either r (r -&gt; Either r (r -&gt; Void))</code>. Through <a href=\"https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence\" rel=\"nofollow noreferrer\">Curry-Howard isomorphism</a> this would mean that we'd be able to prove <a href=\"https://en.wikipedia.org/wiki/Double_negation#Double_negative_elimination\" rel=\"nofollow noreferrer\">Double negation elimination</a>\n in intuitionistic logic, which is a contradiction.</p>\n\n<p>Your situation is somewhat more complex, but a similar argument could be made there too. The only hole there is that we assumed that the \"environment\" part, <code>r</code>, was generic, so won't work if your <code>join</code> or <code>&gt;&gt;=</code> is somehow specific for <code>Environment</code>. So you might be able to do it in such a case, but my guess is you'll then encounter other problems preventing you to get a proper non-trivial <code>Monad</code> instance.</p>\n"}], "owner": {"reputation": 66, "user_id": 6228937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c011d81846af89f254a8147133eb998f?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/6228937/jasper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1461615847, "creation_date": 1461587653, "question_id": 36840728, "link": "https://stackoverflow.com/questions/36840728/monad-transformer-troubles-defining-bind-due-to-different-monads", "title": "Monad Transformer: troubles defining bind due to different monads", "body": "<p>I have a Monad of named <code>TaskMonad</code>, defined as follows:</p>\n\n<pre><code>data TaskMonad a = TaskMonad (Environment -&gt; (TaskResult a, Environment))\n</code></pre>\n\n<p>where <code>Environment</code> is a record type and <code>TaskResult</code> is an ADT; but they are not important for the problem.</p>\n\n<p>I have defed <code>Functor</code>, <code>Applicative</code> and <code>Monad</code> instances for <code>TaskMonad</code>, and I now want to be able to combine this monad with other Monads (e.g. <code>IO</code>), So I defined a new type as follows:</p>\n\n<pre><code>newtype Task m a = Task { runTask :: m (TaskMonad a) }\n</code></pre>\n\n<p>I have defined <code>Functor</code> and <code>Applicative</code> as follows:</p>\n\n<pre><code>instance Monad m =&gt; Functor (Task m) where\n    fmap f ta = Task $ do tma &lt;- runTask ta\n                          return (fmap f tma)\n\ninstance Monad m =&gt; Applicative (Task m) where\n    pure = Task . return . return\n    (&lt;*&gt;) prod tx = Task $ do tmprod &lt;- runTask prod\n                              tmtx   &lt;- runTask tx\n                              return (tmprod &lt;*&gt; tmtx)\n</code></pre>\n\n<p>And I also made <code>Task</code> member of the <code>MonadTrans</code> class:</p>\n\n<pre><code>instance MonadTrans Task where\n    lift = Task . (liftM return)\n</code></pre>\n\n<p>So far so good (or atleast it compiles..), but now I want to define the instance for <code>Monad</code>, but I am running into problems here:</p>\n\n<pre><code>instance Monad m =&gt; Monad (Task m) where\n    return      = pure\n    (&gt;&gt;=) ta tb = ...\n</code></pre>\n\n<p>I attempted multiple things, most attempts starting out like this:</p>\n\n<pre><code>(&gt;&gt;=) ta tb = Task $ do tma &lt;- runTask ta \n</code></pre>\n\n<p>Now we have <code>tma :: TaskMonad a</code> inside the <code>do</code> block for the <code>m</code> monad. Now what I would like to do, is somehow calling the <code>&gt;&gt;=</code> instance for <code>TaskMonad</code> so I can get the result of <code>tma</code>, a value of type <code>a</code> so I can parameterize <code>tb</code> with it to obtain a value of <code>Task b</code>. But I am within the context of the <code>m</code> monad and I'm running into all kinds of problems.</p>\n\n<p>How could I obtain <code>tma</code>'s result to provide it to <code>tb</code>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1461586043, "post_id": 36839682, "comment_id": 61249975, "body": "This is composition of Kleisli arrows."}], "answers": [{"comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1461586406, "post_id": 36839945, "comment_id": 61250215, "body": "If I use <code>let f</code> and <code>let g</code> from your answer, then <code>let z = (.) &lt;$&gt; f &lt;*&gt; g</code>, I get <code>Couldn&#39;t match expected type \u2018Integer -&gt; t\u2019 with actual type \u2018Maybe (Integer -&gt; Integer)\u2019</code>. Am I doing something wrong here?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461586461, "post_id": 36839945, "comment_id": 61250255, "body": "you might need to add an additional type signature (or use named functions with type signatures)"}, {"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461587816, "post_id": 36839945, "comment_id": 61251213, "body": "@epsilonhalbe @Gurkenglas, <code>f,g :: Int -&gt; Maybe (Int -&gt; Int)</code>, right? What should be the type for of <code>z = (.) &lt;$&gt; f &lt;*&gt; g</code>?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461587905, "post_id": 36839945, "comment_id": 61251275, "body": "no <code>f,g :: Maybe (Int -&gt; Int)</code> =&gt; <code>z :: Maybe (Int -&gt; Int)</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461587987, "post_id": 36839945, "comment_id": 61251342, "body": "Applicative does not work on contained values but only on containers, see what happens if you use <code>h :: Maybe (Int -&gt; Int); h = Nothing</code>"}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 3, "last_activity_date": 1461585587, "creation_date": 1461585587, "answer_id": 36839945, "question_id": 36839682, "link": "https://stackoverflow.com/questions/36839682/composition-of-applicative-functions/36839945#36839945", "title": "Composition of Applicative functions", "body": "<p>Applicative functions aren't</p>\n\n<pre><code>let f x = Just $ x + 1\nlet g x = Just $ x + 2\n</code></pre>\n\n<p>, they're</p>\n\n<pre><code>let f = Just $ \\x -&gt; x + 1\nlet g = Just $ \\x -&gt; x + 2\n</code></pre>\n\n<p>. Composition then works like <code>liftA2 (.) f g</code> or <code>(.) &lt;$&gt; f &lt;*&gt; g</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1461586994, "post_id": 36840014, "comment_id": 61250598, "body": "I&#39;m struggling to read this :( - <code>Compose</code> and <code>ReaderWithMaybe</code> are confusing me. Despite this, the <code>let z = (+) &lt;$&gt; x &lt;*&gt; y</code> is interesting because you specify an operator <code>(+)</code> to use to compose these two functions together. This is not needed for <code>f . g</code> or <code>f &gt;=&gt; g</code> which I find a bit odd..."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 1, "creation_date": 1461587212, "post_id": 36840014, "comment_id": 61250771, "body": "A trick I use when I&#39;m confused by a <code>newtype</code> is simply expanding the definition by hand. You&#39;ll see that <code>ReaderWithMaybe r a</code> is isomorphic to <code>r -&gt; Maybe a</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1461587400, "post_id": 36840014, "comment_id": 61250923, "body": "And, yes, I&#39;m mapping <code>+</code> over my two applicative values. Look at the type: <code>ReaderWithMaybe Int Int</code> is a <i>value</i> of type <code>Int</code> in the <i>context</i> <code>ReaderWithMaybe Int</code>. You can&#39;t apply <code>.</code> or <code>&gt;=&gt;</code> to a pair of <code>Int</code>s. If I had, say, <code>f :: ReaderWithMaybe Int (a -&gt; b)</code> and <code>g :: ReaderWithMaybe Int (b -&gt; c)</code> then I could write <code>(.) &lt;$&gt; g &lt;*&gt; f</code>"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 6, "last_activity_date": 1461588033, "last_edit_date": 1495542798, "creation_date": 1461585742, "answer_id": 36840014, "question_id": 36839682, "link": "https://stackoverflow.com/questions/36839682/composition-of-applicative-functions/36840014#36840014", "title": "Composition of Applicative functions", "body": "<pre><code>{-# LANGUAGE TypeOperators #-}\n</code></pre>\n\n<p>The (type-level) composition of any two applicative functors,</p>\n\n<pre><code>newtype (f :. g) a = Compose { getCompose :: f (g a)) }\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/7040844/applicatives-compose-monads-dont\">is an applicative functor</a>.</p>\n\n<pre><code>instance (Functor f, Functor g) =&gt; Functor (f :. g) where\n    fmap f = Compose . fmap (fmap f) . getCompose\n\ninstance (Applicative f, Applicative g) =&gt; Applicative (f :. g) where\n    pure = Compose . pure . pure\n    Compose fgf &lt;*&gt; Compose fgx = Compose ((&lt;*&gt;) &lt;$&gt; fgf &lt;*&gt; fgx)\n</code></pre>\n\n<p>Your example is the composition of <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.Base.html#line-633\" rel=\"nofollow noreferrer\">the <code>Maybe</code> applicative</a> with <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.Base.html#line-617\" rel=\"nofollow noreferrer\">the \"function\" or \"reader\" applicative <code>(-&gt;) r</code></a>.</p>\n\n<pre><code>type ReaderWithMaybe r = ((-&gt;) r) :. Maybe\n\nx, y :: ReaderWithMaybe Int Int\nx = Compose $ \\x -&gt; Just (x + 1)\ny = Compose $ \\x -&gt; Just (x + 2)\n</code></pre>\n\n<p>Since <code>ReaderWithMaybe r</code> is an <code>Applicative</code> you can do all the usual <code>Applicative</code> stuff. Here I'm smashing my two values together with <code>+</code>.</p>\n\n<pre><code>ghci&gt; let z = (+) &lt;$&gt; x &lt;*&gt; y\nghci&gt; getCompose z 3\nJust 9  -- (3 + 1) + (3 + 2) == 9\n</code></pre>\n\n<p>Note that <code>x</code> and <code>y</code> both get the <em>same input</em> <code>3</code>. That's the behaviour of <code>(-&gt;) r</code>'s <code>Applicative</code> instance. If you want to take the <em>result</em> of <code>f x = Just (x + 1)</code> and feed it into <code>g x = Just (x + 2)</code> (to get something equivalent to <code>h x = Just (x + 3)</code>), well, that's what <code>Monad</code> is for.</p>\n\n<hr>\n\n<blockquote>\n  <p>Bonus points, can <code>z x = f x &gt;&gt;= g</code> be written as a point-free function? Something like <code>z = f &gt;&gt;= g</code>?</p>\n</blockquote>\n\n<p>You can easily define Kleisli composition by hand.</p>\n\n<pre><code>(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c\nf &gt;=&gt; g = \\x -&gt; f x &gt;&gt;= g\n</code></pre>\n\n<p>It happens that <code>&gt;=&gt;</code> already exists in the standard library, along with its sister <code>&lt;=&lt;</code>. They are lovingly known as the \"fish\" operators, and they live in <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:-62--61--62-\" rel=\"nofollow noreferrer\"><code>Control.Monad</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": false, "score": 0, "last_activity_date": 1461586473, "creation_date": 1461586473, "answer_id": 36840278, "question_id": 36839682, "link": "https://stackoverflow.com/questions/36839682/composition-of-applicative-functions/36840278#36840278", "title": "Composition of Applicative functions", "body": "<p>Maybe you will be interested by  Kleisli composition of monads: </p>\n\n<pre><code>(&lt;=&lt;) :: Monad m =&gt; (b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c\n(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c \n</code></pre>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1461588033, "creation_date": 1461584889, "last_edit_date": 1461586829, "question_id": 36839682, "link": "https://stackoverflow.com/questions/36839682/composition-of-applicative-functions", "title": "Composition of Applicative functions", "body": "<p>I can compose pure functions:</p>\n\n<pre><code>let f x = x + 1\nlet g x = x + 2\nlet z = f . g\nz 1 == 4\n</code></pre>\n\n<p>I seem to be able to compose monadic functions also:</p>\n\n<pre><code>let f x = Just (x + 1)\nlet g x = Just (x + 2)\nlet z x = f x &gt;&gt;= g\nz 1 == Just 4\n</code></pre>\n\n<p>I think I should be able to treat <code>f</code> and <code>g</code> from the last example as applicatives and compose those also, just not sure how:</p>\n\n<pre><code>let f x = Just (x + 1)\nlet g x = Just (x + 2)\nlet z x = f &lt;*&gt; g -- this doesn't work\nz 1 == Just 4\n</code></pre>\n\n<p>Is this doable?</p>\n\n<p>Bonus points, can <code>z x = f x &gt;&gt;= g</code> be written as a point-free function? Something like <code>z = f &gt;&gt;= g</code>?</p>\n"}, {"tags": ["haskell", "lambda-calculus", "church-encoding"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1461585839, "post_id": 36839368, "comment_id": 61249856, "body": "Implement <code>&lt;=</code> using subtraction, then implement <code>&lt;</code> using negation. Then you can refine division so to recurse until <code>&lt; b</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1461586104, "post_id": 36839368, "comment_id": 61250019, "body": "Please don&#39;t use the y-combinator with <code>unsafeCoerce</code>. The canonical fixpoint combinator in Haskell is <a href=\"http://hackage.haskell.org/package/base/docs/Data-Function.html#v:fix\" rel=\"nofollow noreferrer\"><code>fix</code></a>, which is simply <code>\\f -&gt; let x = f x in x</code>."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1461604389, "post_id": 36839368, "comment_id": 61262925, "body": "Thanks, I&#39;m avoiding <code>fix</code> on purpose, trying to mimic as much as possible lambda calculus"}], "answers": [{"comments": [{"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "edited": false, "score": 0, "creation_date": 1461600652, "post_id": 36841312, "comment_id": 61260852, "body": "@dimid I&#39;ve updated the answer, you might want to take a look."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1461602072, "post_id": 36841312, "comment_id": 61261634, "body": "Thanks a lot, when unrolling <code>lt</code>, <code>ch_and (le a b)</code> is computed twice, no?"}, {"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 1, "creation_date": 1461602699, "post_id": 36841312, "comment_id": 61261989, "body": "@dimid Good catch, thanks! I&#39;ve simplified the code. Isn&#39;t it amusing what we can write at the end of the day? :)"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1461604977, "post_id": 36841312, "comment_id": 61263313, "body": "One last nitpick, you&#39;ve replaced my counter <code>n</code> with an extra call to <code>suc</code>, which makes the function much cleaner. However, does it mean that <code>ch_div</code> is no longer tail-recursive? It has no practical significance (optimizing LC is kinda pointless), I&#39;m just curious"}, {"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 1, "creation_date": 1461605344, "post_id": 36841312, "comment_id": 61263533, "body": "@dimid Yes, you&#39;re right. I just didn&#39;t want to introduce a helper function. It seems better to get things right before performing any optimizations. Especially when you don&#39;t program in LC on regular basis :)"}], "tags": [], "owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "is_accepted": true, "score": 4, "last_activity_date": 1461602473, "last_edit_date": 1461602473, "creation_date": 1461589102, "answer_id": 36841312, "question_id": 36839368, "link": "https://stackoverflow.com/questions/36839368/how-to-implement-church-encoding-division-in-haskell/36841312#36841312", "title": "How to implement Church encoding division in haskell?", "body": "<p>You can implement <code>&lt;</code> directly (using recursion) and then use it to define the division function. Here is an example:</p>\n\n<pre><code>type ChBool a = a -&gt; a -&gt; a\n\n-- 'less than' function\nlt :: Chur -&gt; Chur -&gt; ChBool x\nlt = y (\\r a b -&gt; iszero a (iszero b \n                                   false           -- a = 0 &amp; b = 0\n                                   true)           -- a = 0 &amp; b &gt; 0\n                           (r (pre a) (pre b)))    -- lt (a - 1) (b - 1)\n\nch_div :: Chur -&gt; Chur -&gt; Chur\nch_div = y (\\r a b -&gt; lt a b\n                         zer\n                         (suc (r (ch_sub a b) b)))\n</code></pre>\n\n<p>Tests:</p>\n\n<pre><code>\u03bb&gt; ci $ ch_div (ic 9) (ic 1)\n9\n\u03bb&gt; ci $ ch_div (ic 9) (ic 2)\n4\n\u03bb&gt; ci $ ch_div (ic 9) (ic 3)\n3\n\u03bb&gt; ci $ ch_div (ic 9) (ic 4)\n2\n\u03bb&gt; ci $ ch_div (ic 9) (ic 5)\n1\n\u03bb&gt; ci $ ch_div (ic 9) (ic 9)\n1\n\u03bb&gt; ci $ ch_div (ic 9) (ic 10)\n0\n</code></pre>\n\n<p>And (as was already mentioned in comments) instead of <code>y</code> it's better to use a safe fixed-point combinator.</p>\n\n<p>I must add that recursion is not necessary for implementing <code>lt</code>. It can be done like so:</p>\n\n<pre><code>-- boolean negation\nch_not a = a false true\n\n-- greater or equal\nge a b = iszero $ ch_sub b a\n\n-- less than\nlt a b = ch_not (ge a b)\n</code></pre>\n"}], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1320, "favorite_count": 1, "accepted_answer_id": 36841312, "answer_count": 1, "score": 4, "last_activity_date": 1461602473, "creation_date": 1461583996, "question_id": 36839368, "link": "https://stackoverflow.com/questions/36839368/how-to-implement-church-encoding-division-in-haskell", "title": "How to implement Church encoding division in haskell?", "body": "<p>I'm a beginner in haskell, and trying to implement the Church encoding for natural numbers, as explained in <a href=\"http://archive.is/dumJ2\" rel=\"nofollow\">this guide</a>.</p>\n\n<p>I'd like to implement a division between two church numerals.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nimport Unsafe.Coerce\n\ny :: (a -&gt; a) -&gt; a\ny = \\f -&gt; (\\x -&gt; f (unsafeCoerce x x)) (\\x -&gt; f (unsafeCoerce x x))\n\ntrue = (\\x y -&gt; x)\nfalse = (\\x y -&gt; y)\n\nnewtype Chur = Chr (forall a. (a -&gt; a) -&gt; (a -&gt; a))\n\nzer :: Chur\nzer = Chr (\\x y -&gt; y)\n\nsuc :: Chur -&gt; Chur\nsuc (Chr cn) = Chr (\\h -&gt; cn h . h)\n\nci :: Chur -&gt; Integer\nci (Chr cn) = cn (+ 1) 0\n\nic :: Integer -&gt; Chur\nic 0 = zer\nic n = suc $ ic (n - 1)\n\n\n-- church pair\ntype Chp = (Chur -&gt; Chur -&gt; Chur) -&gt; Chur\n\npair :: Chur -&gt; Chur -&gt; Chp\npair (Chr x) (Chr y)  f = f (Chr x) (Chr y)\n\nch_fst :: Chp -&gt; Chur\nch_fst p = p true\n\nch_snd :: Chp -&gt; Chur\nch_snd p = p false\n\nnext_pair :: Chp -&gt; Chp\nnext_pair = (\\p x -&gt; x (suc (p true)) (p true))\n\nn_pair :: Chur -&gt; Chp -&gt; Chp\nn_pair (Chr n) p = n next_pair p\n\np0 = pair zer zer\npre :: Chur -&gt; Chur\npre (Chr cn) = ch_snd $ n_pair (Chr cn) p0\n\niszero :: Chur -&gt; (a-&gt;a-&gt;a)\niszero (Chr cn) = cn (\\h -&gt; false) true\n\nunchr :: Chur -&gt; ((a -&gt; a) -&gt; (a -&gt; a))\nunchr (Chr cn) = cn\n\nch_sub :: Chur -&gt; Chur -&gt; Chur\nch_sub (Chr cn1) (Chr cn2) = cn2 pre (Chr cn1)\n\n-- only works if b is a multiple of a\nch_div :: Chur -&gt; Chur -&gt; Chur\nch_div a b = suc $ y div_rec a b n0\ndiv_rec :: (Chur -&gt; Chur -&gt; Chur -&gt; Chur)-&gt; Chur -&gt; Chur -&gt; Chur -&gt; Chur\ndiv_rec = (\\r a b n -&gt; iszero (ch_sub a b) n $ r (ch_sub a b) b (suc n))\n\nn0 = zer\nn1 = ic 1\nn2 = ic 2\nn3 = ic 3\nn4 = ic 4\n</code></pre>\n\n<p><code>ch_div</code> works when dividing multiples (e.g. <code>9 / 3</code>), but not for fractions (e.g. <code>9 / 2</code>).</p>\n\n<pre><code>*Main&gt; ci $ ch_div (ic 9) n3\n3\n*Main&gt; ci $ ch_div (ic 9) n2\n5\n</code></pre>\n\n<p>If I omit the <code>suc</code> before <code>div_rec</code>, it works for the latter, but not for the former.</p>\n\n<pre><code>*Main&gt; ci $ ch_div (ic 9) n3\n2\n*Main&gt; ci $ ch_div (ic 9) n2\n4\n</code></pre>\n\n<p>How do I define division to work for both cases?</p>\n"}, {"tags": ["haskell", "haskell-platform"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6062117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535c35d269bb5731049d7de0abe12218?s=128&d=identicon&r=PG&f=1", "display_name": "Andro", "link": "https://stackoverflow.com/users/6062117/andro"}, "edited": false, "score": 1, "creation_date": 1461595215, "post_id": 36838508, "comment_id": 61257098, "body": "Thank you for answering so quickly. My programs looks like:       <b>Alternative 1</b>: <code>all&#39;  :: (a-&gt;Bool) -&gt; [a] -&gt;Bool all&#39; fct [] = True all&#39; fct (x:xs) = ( fct x ) &amp;&amp; ( all&#39; fct  xs )</code>  <b>Alternative 2</b>: <code>all&#39;&#39;::(a-&gt;Bool)-&gt;[a]-&gt;Bool  all&#39;&#39; f []= False all&#39;&#39; f (x:[])=if f x then True else False all&#39;&#39; f (x:xs)=if f x then all&#39;&#39; f xs else False</code>"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 13, "user_id": 6062117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535c35d269bb5731049d7de0abe12218?s=128&d=identicon&r=PG&f=1", "display_name": "Andro", "link": "https://stackoverflow.com/users/6062117/andro"}, "edited": false, "score": 0, "creation_date": 1461595453, "post_id": 36838508, "comment_id": 61257264, "body": "@kissylips if you make the empty array case be <code>True</code>, you can get rid of the 2nd condition."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 13, "user_id": 6062117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535c35d269bb5731049d7de0abe12218?s=128&d=identicon&r=PG&f=1", "display_name": "Andro", "link": "https://stackoverflow.com/users/6062117/andro"}, "edited": false, "score": 0, "creation_date": 1461602974, "post_id": 36838508, "comment_id": 61262149, "body": "@kissylips looks correct. Just some notes: <code>x:[]</code> can also be written as <code>[x]</code> (brackets can be used both for making and pattern matching lists). Also <code>if whatever then True else False</code> is always the same as <code>whatever</code>. Also, a good place to put small bits of code is <a href=\"http://lpaste.net/\" rel=\"nofollow noreferrer\">lpaste.net</a>."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 5, "last_activity_date": 1461581543, "creation_date": 1461581543, "answer_id": 36838508, "question_id": 36838370, "link": "https://stackoverflow.com/questions/36838370/how-to-reimplement-the-all-function-in-haskell/36838508#36838508", "title": "How to reimplement the &quot;all&quot; function in Haskell?", "body": "<p>Functions in Haskell are passed just like any other value. Here's an example to help you progress:</p>\n\n<pre><code>doBothSatisfy :: (a -&gt; Bool) -&gt; a -&gt; a -&gt; Bool\ndoBothSatisfy p x y = (p x) &amp;&amp; (p y)\n</code></pre>\n\n<p>And now the usage:</p>\n\n<pre><code>doBothSatisfy (&gt; 5) 6 7 == True\ndoBothSatisfy (&gt; 5) 1 8 == False\n</code></pre>\n\n<p>Now try to extend that to lists.</p>\n"}], "owner": {"reputation": 13, "user_id": 6062117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535c35d269bb5731049d7de0abe12218?s=128&d=identicon&r=PG&f=1", "display_name": "Andro", "link": "https://stackoverflow.com/users/6062117/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "accepted_answer_id": 36838508, "answer_count": 1, "score": -1, "last_activity_date": 1461581653, "creation_date": 1461581193, "last_edit_date": 1461581653, "question_id": 36838370, "link": "https://stackoverflow.com/questions/36838370/how-to-reimplement-the-all-function-in-haskell", "title": "How to reimplement the &quot;all&quot; function in Haskell?", "body": "<p>I need to define a function<code>all' :: ( a -&gt; Bool ) -&gt; [a] -&gt; Bool</code> which verifies if all the elements from a list satisfy a certain condition . </p>\n\n<p>For example : <code>all' ( &lt;5) [1,2,3] = True</code> ,  <code>all' (&gt;=2) [1,1,2,2,3,3]</code> = False.</p>\n\n<p>My main problem is that I don't know how to handle the transmission of a function.</p>\n"}, {"tags": ["haskell", "haskell-wai", "servant"], "comments": [{"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "edited": false, "score": 0, "creation_date": 1461577951, "post_id": 36836732, "comment_id": 61244569, "body": "Maybe this will help (if it does, keep in mind that pasting error messages into Google search can produce wonders): <a href=\"http://stackoverflow.com/questions/3753445/haskell-a-problem-with-the-simplest-wai-example\" title=\"haskell a problem with the simplest wai example\">stackoverflow.com/questions/3753445/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "reply_to_user": {"reputation": 3025, "user_id": 6250601, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fc7d2f54bb1971ee8fbfeaf100ed42f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sojo", "link": "https://stackoverflow.com/users/6250601/sojo"}, "edited": false, "score": 0, "creation_date": 1461582839, "post_id": 36837589, "comment_id": 61247800, "body": "@user6250601 Seems like your ByteString is strict. Use <code>Data.ByteString.Char8.unpack</code> instead of <code>Data.ByteString.Lazy.Char8.unpack</code>."}, {"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "reply_to_user": {"reputation": 3025, "user_id": 6250601, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fc7d2f54bb1971ee8fbfeaf100ed42f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sojo", "link": "https://stackoverflow.com/users/6250601/sojo"}, "edited": false, "score": 0, "creation_date": 1461588237, "post_id": 36837589, "comment_id": 61251546, "body": "@user6250601 Pay a close attention to the module names and types. The types <code>Data.ByteString.ByteString</code> and <code>Data.ByteString.Lazy.ByteString</code> are different! Your errors are caused by you using the <code>Data.ByteString.Lazy</code> API against a strict bytestring, while only <code>Data.ByteString</code> and <code>Data.ByteString.Char8</code> are applicable to it."}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 4, "last_activity_date": 1461582711, "last_edit_date": 1461582711, "creation_date": 1461578979, "answer_id": 36837589, "question_id": 36836732, "link": "https://stackoverflow.com/questions/36836732/unable-to-do-pattern-matching-on-word8/36837589#36837589", "title": "Unable to do pattern matching on Word8", "body": "<p>The pattern <code>\"www\":rest</code> implies the type <code>[[Char]]</code>, while you need <code>[Char]</code>. Here's what your pattern should be:</p>\n\n<pre><code>'w':'w':'w':rest\n</code></pre>\n\n<p>Oh. And you should use <code>Data.ByteString.Char8.unpack</code> (or <code>Data.ByteString.Lazy.Char8.unpack</code>, if it's lazy) to be able to match against characters. Otherwise you need to use the ASCII code of <code>'w'</code> instead of the character.</p>\n"}], "owner": {"reputation": 3025, "user_id": 6250601, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fc7d2f54bb1971ee8fbfeaf100ed42f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sojo", "link": "https://stackoverflow.com/users/6250601/sojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461582711, "creation_date": 1461576733, "last_edit_date": 1461581644, "question_id": 36836732, "link": "https://stackoverflow.com/questions/36836732/unable-to-do-pattern-matching-on-word8", "title": "Unable to do pattern matching on Word8", "body": "<p>In my Servant/Wai app I want to redict all the requests from \"domain.com\" to \"www.domain.com\"</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n--.......\n\napp :: Application\napp req respond = do\n  case requestHeaderHost req of\n    Just host -&gt; do\n      case BS.unpack host of\n        \"www\":rest -&gt; respond =&lt;&lt; redirect' HttpTp.status302 [] \"domain.com\"\n\n      _ -&gt; undefined\n\n    Nothing -&gt; undefined\n</code></pre>\n\n<p>The error is </p>\n\n<pre><code>No instance for (Data.String.IsString GHC.Word.Word8)\n  arising from the literal \u2018\"www\"\u2019\nIn the pattern: \"www\"\n</code></pre>\n\n<p>I know what it means and I think that the class Show should've have been implemented for Word8 and if not there must be a reason. Maybe I'm doing it the wrong way?</p>\n\n<p>How can I fix this or do it another better way?</p>\n\n<p>Update:</p>\n\n<p>I can't get it to compile:</p>\n\n<pre><code>-- 1\nJust host -&gt; do\n  case BS.isPrefixOf (BS.pack $ show \"www\") host of \n\n-- 2\nJust host -&gt; do\n  case Text.isPrefixOf (Text.pack $ show \"www\") host of \n\n-- 3\nJust host -&gt; do\n  case DL.isPrefixOf  \"www\" host of \n</code></pre>\n\n<p>There's always type mismatch.</p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461558109, "post_id": 36831820, "comment_id": 61234727, "body": "please add the error message to your question - because in this case the error message would have told you exactly wher ethe problem was - the missing <code>Maybe</code>"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1461558311, "last_edit_date": 1461558311, "creation_date": 1461558004, "answer_id": 36831957, "question_id": 36831820, "link": "https://stackoverflow.com/questions/36831820/how-to-parse-a-list-of-json-objects-in-haskell/36831957#36831957", "title": "How to parse a list of Json objects in Haskell?", "body": "<p>It should work as it is once you pass in an array (and decode as a list) so you probably just have to change your signature to <code>get2 :: IO (Maybe [MyData])</code>:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, OverloadedStrings #-}\nmodule Json where\n\nimport GHC.Generics\nimport Data.Aeson\nimport Data.Text\nimport Data.ByteString.Lazy\n\ndata MyData = MyData { a :: Int, b :: String }\n  deriving (Generic, Show)\n\ninstance FromJSON MyData\n\nexample :: ByteString\nexample = \"[{ \\\"a\\\": 1, \\\"b\\\": \\\"Hello\\\" }, { \\\"a\\\": 2, \\\"b\\\": \\\"World\\\" }]\"\n</code></pre>\n\n<h2>example</h2>\n\n<pre><code>\u03bb&gt; decode example :: Maybe [MyData]\nJust [MyData {a = 1, b = \"Hello\"},MyData {a = 2, b = \"World\"}]\n</code></pre>\n\n<hr>\n\n<h2>your problem</h2>\n\n<p>would be something like this: if you try</p>\n\n<pre><code>get :: [MyData]\nget = decode example\n</code></pre>\n\n<p>the compiler will complain with</p>\n\n<blockquote>\n  <p>Couldn't match expected type <code>[MyData]</code> with actual type <code>Maybe a0</code> \u2026</p>\n</blockquote>\n\n<p>which should give you a big hint.</p>\n\n<p>You can still get your signature with <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Maybe.html#v:maybeToList\" rel=\"nofollow\"><code>Data.Maybe.maybeToList</code></a>:</p>\n\n<pre><code>get :: [MyData]\nget = Prelude.concat . maybeToList $ decode example\n</code></pre>\n"}], "owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 0, "accepted_answer_id": 36831957, "answer_count": 1, "score": 0, "last_activity_date": 1461558311, "creation_date": 1461556816, "question_id": 36831820, "link": "https://stackoverflow.com/questions/36831820/how-to-parse-a-list-of-json-objects-in-haskell", "title": "How to parse a list of Json objects in Haskell?", "body": "<p>I have a data class:</p>\n\n<pre><code>data MyData = MyData { a :: Int, b :: String }\ninstance ToJSON MyData where\n  ....\n\ninstance FromJSON MyData where\n  ....\n</code></pre>\n\n<p>I can parse a single object from json:</p>\n\n<pre><code>get :: IO (Maybe MyData)\nget = do\n  res &lt;- getSingleItemHttp\n  return $ decode $ responseBody res\n</code></pre>\n\n<p>How can I get a list of MyData?</p>\n\n<pre><code>get2 :: IO [MyData]\nget2 = do\n      res &lt;- getManyItemsHttp\n\n      --????\n      return $ decode $ responseBody res -- doesn't compile\n</code></pre>\n\n<p>How would I go about parsing responseBody to <code>List</code>?</p>\n"}, {"tags": ["haskell", "polymorphism", "higher-rank-types"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1461548515, "creation_date": 1461548515, "answer_id": 36830894, "question_id": 36830676, "link": "https://stackoverflow.com/questions/36830676/unwrapping-the-stt-monad-in-a-transformer-stack/36830894#36830894", "title": "Unwrapping the STT monad in a transformer stack?", "body": "<p>(The below talks about <code>ST s a</code> but applies just the same as <code>STT s m a</code>; I've just avoided the unnecessary complication of talking about the transformer version below)</p>\n\n<p>The problem you are seeing is that <code>runST</code> has type <code>(forall s. ST s a) -&gt; a</code> to isolate any potential (<code>STRef</code>-changing) effects of the computation from the outside, pure world. The whole point of the <code>s</code> phantom type that all <code>ST</code> computations, <code>STRef</code>s, etc. are tagged with, is to track which \"<code>ST</code>-domain\" they belong to; and the type of <code>runST</code> ensures that nothing can pass between domains.</p>\n\n<p>You can write <code>runToKErr</code> by enforcing the same invariant:</p>\n\n<pre><code>{-# language Rank2Types #-}\n\nrunToKErr :: (forall s. RunM s a) -&gt; KErr a\nrunToKErr = runST\n</code></pre>\n\n<p>(of course, you might realize further down the road that this restriction is too strong for the program you hope to write; at that point you'll need to lose hope, sorry, I mean you'll need to redesign your program.)</p>\n\n<p>As for the error message, the reason you can't \"convince the type checker that <code>s1</code> and <code>s</code> are the same type\" is because if I pass you an <code>ST s a</code> for a given choice of <code>s</code> and <code>a</code>, that is not the same as giving you something which allows you to choose your own <code>s</code>. GHC chose <code>s1</code> (a <a href=\"https://en.wikipedia.org/wiki/Skolem_normal_form\">Skolemized</a> variable) as <code>s</code> and so tries to unify <code>ST s a</code> with <code>ST s1 a</code> </p>\n"}], "owner": {"reputation": 13337, "user_id": 441899, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/368fb99f86e2264ceec0539a3746b9d3?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/441899/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 36830894, "answer_count": 1, "score": 2, "last_activity_date": 1461548515, "creation_date": 1461546361, "last_edit_date": 1495541260, "question_id": 36830676, "link": "https://stackoverflow.com/questions/36830676/unwrapping-the-stt-monad-in-a-transformer-stack", "title": "Unwrapping the STT monad in a transformer stack?", "body": "<p>This question is apparently related to the problem discussed <a href=\"https://stackoverflow.com/questions/32654814/trouble-with-sts-type-in-a-transformer-stack\">here</a> and <a href=\"https://stackoverflow.com/questions/9468963/runst-and-function-composition\">here</a>.  Unfortunately, my requirement is slightly different to those questions, and the answers given don't apply to me.  I also don't really understand <em>why</em> <code>runST</code> fails to type check in these cases, which doesn't help.</p>\n\n<p>My problem is this, I have one section of code that uses one monad stack, or rather a single monad:</p>\n\n<pre><code>import Control.Monad.Except\ntype KErr a = Except KindError a\n</code></pre>\n\n<p>Another section of code needs to integrate with this that wraps this within the <a href=\"https://hackage.haskell.org/package/STMonadTrans-0.3.3/docs/Control-Monad-ST-Trans.html\" rel=\"nofollow noreferrer\">STT monad</a>:</p>\n\n<pre><code>type RunM s a = STT s (Except KindError) a\n</code></pre>\n\n<p>At the interface between these sections, I clearly need to wrap and unwrap the outer layer.  I've got the following function to work in the <code>KErr</code> -> <code>RunM</code> direction:</p>\n\n<pre><code>kerrToRun :: KErr a -&gt; RunM s a\nkerrToRun e = either throwError return $ runExcept e\n</code></pre>\n\n<p>but for some reason I just can't get the converse to type check:</p>\n\n<pre><code>runToKErr :: RunM s a -&gt; KErr a\nrunToKErr r = runST r\n</code></pre>\n\n<p>I'm working on the assumption that as the <code>RunM</code>'s inner monad has the same structure as <code>KErr</code>, I can just return it once I've unwrapped the <code>STT</code> layer, but I don't seem to be able to get that far, as <code>runST</code> complains about its type arguments:</p>\n\n<pre><code>src/KindLang/Runtime/Eval.hs:18:21:\n    Couldn't match type \u2018s\u2019 with \u2018s1\u2019\n      \u2018s\u2019 is a rigid type variable bound by\n          the type signature for runToKErr :: RunM s a -&gt; KErr a\n          at src/KindLang/Runtime/Eval.hs:17:14\n      \u2018s1\u2019 is a rigid type variable bound by\n           a type expected by the context:\n             STT s1 (ExceptT KindError Data.Functor.Identity.Identity) a\n           at src/KindLang/Runtime/Eval.hs:18:15\n    Expected type: STT\n                     s1 (ExceptT KindError Data.Functor.Identity.Identity) a\n      Actual type: RunM s a\n</code></pre>\n\n<p>I've also tried:</p>\n\n<pre><code>runToKErr r = either throwError return $ runExcept $ runST r\n</code></pre>\n\n<p>in order to more strongly isolate <code>runST</code> from its expected return type, in case that was the cause of the issue, but the results are the same.</p>\n\n<p>Where is this <code>s1</code> type coming from, and how do I persuade ghc that it's the same type as <code>s</code>?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "edited": false, "score": 0, "creation_date": 1461540205, "post_id": 36829563, "comment_id": 61231163, "body": "Just using <code>Sum</code> as a random example of a <code>newtype</code> wrapper that has <code>Wrapped</code> instances.  Sometimes I have wrapped up things and I want to operate on what&#39;s wrapped inside."}, {"owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "edited": false, "score": 0, "creation_date": 1461701752, "post_id": 36829563, "comment_id": 61316448, "body": "<code>coerce (++) (Sum [1,2,3]) (Sum [4,5,6]) :: Sum [Int]</code> does not work in GHCi."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "reply_to_user": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "edited": false, "score": 0, "creation_date": 1470228891, "post_id": 36829563, "comment_id": 64862255, "body": "It doesn&#39;t know that the <code>[1,2,3]</code> is also <code>[Int]</code>, or that the (++) is supposed to concatenate <code>[Int]</code>s as opposed to, say, <code>[Sum Int]</code>s. <code>coerce ((++) :: [Int] -&gt; [Int] -&gt; [Int]) (Sum [1,2,3] :: Sum [Int]) (Sum [4,5,6] :: Sum [Int]) :: Sum [Int]</code> works."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 2, "last_activity_date": 1461536507, "creation_date": 1461536507, "answer_id": 36829563, "question_id": 36829391, "link": "https://stackoverflow.com/questions/36829391/uses-of-wrapped-typeclass-in-control-lens/36829563#36829563", "title": "Uses of Wrapped typeclass in Control.Lens", "body": "<p>Doesn't use <code>Wrapped</code>, but:</p>\n\n<pre><code>import Data.Coercible\n\ncanIdoThis :: ([a] -&gt; [a] -&gt; [a]) -&gt; Sum [a] -&gt; Sum [a] -&gt; Sum [a]\ncanIdoThis = coerce\n</code></pre>\n\n<p>Are you sure these should be wrapped in <code>Sum</code>? No <code>instance Num [a]</code> by default.</p>\n"}], "owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1461536507, "creation_date": 1461535267, "question_id": 36829391, "link": "https://stackoverflow.com/questions/36829391/uses-of-wrapped-typeclass-in-control-lens", "title": "Uses of Wrapped typeclass in Control.Lens", "body": "<p>I'm having a hard time reading the types in the <a href=\"http://hackage.haskell.org/package/lens-4.13.2.1/docs/Control-Lens-Wrapped.html\" rel=\"nofollow\">Control.Lens.Wrapped</a> module and I'm not finding much else written about it or the <code>newtype</code> library it is apparently based on.  In particular I am wondering what sorts of things I can do while remaining in the <code>newtype</code> wrapper.  For instance let's say I have two lists that are in a <code>Data.Monoid.Sum</code> wrapper.  Is there some way I can easily <code>++</code> the lists and get back a new value still in a <code>Sum</code> wrapper?  I would want a function that, monomorphically, looks something like this:</p>\n\n<pre><code>canIdoThis :: ([a] -&gt; [a] -&gt; [a]) -&gt; Sum [a] -&gt; Sum [a] -&gt; Sum [a]\n</code></pre>\n\n<p>so that I could do something like</p>\n\n<pre><code>canIdoThis (++) (Sum [1,2]) (Sum [3,4])\n</code></pre>\n\n<p>and get <code>Sum [1,2,3,4]</code>.  (Of course, <code>canIdoThis</code> would also work on <code>Product [a]</code>, etc.)</p>\n\n<p>Any other tips or just a general write up of all the goodness one could do with <code>Control.Lens.Wrapped</code> is appreciated very much.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1461616210, "post_id": 36828057, "comment_id": 61269889, "body": "Can you add more detail to this question? I&#39;m not sure exactly what you&#39;re asking. A good reference is the Yesod book <a href=\"http://www.yesodweb.com/book/internationalization\" rel=\"nofollow noreferrer\">chapter on Internationalization</a>, though."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1461626546, "post_id": 36828057, "comment_id": 61274449, "body": "The parameter type would be of a message."}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461527040, "creation_date": 1461527040, "question_id": 36828057, "link": "https://stackoverflow.com/questions/36828057/yesod-appmessage-as-argument-to-message", "title": "Yesod - AppMessage as argument to message", "body": "<p>In Yesod, what if I would like to put an AppMessage as an argument to a message, as in this example:</p>\n\n<pre><code>ElemError field@AppMessage description@Text: #{field} deve conter apenas #{description}. Cuidado com espa\u00e7os.\n</code></pre>\n"}, {"tags": ["haskell", "lambda-calculus", "combinators"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1461521550, "post_id": 36826572, "comment_id": 61224953, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4273413/y-combinator-in-haskell\">Y Combinator in Haskell</a>"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1461521815, "post_id": 36826572, "comment_id": 61225063, "body": "@chepner Why is that a duplicate? This question (which I linked to), provides the definition of y combinator, but doesn&#39;t explain how to use it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461522436, "post_id": 36826572, "comment_id": 61225299, "body": "@dimid See <a href=\"http://stackoverflow.com/a/5888847/1126841\">this answer</a> to the proposed duplicate. You can&#39;t type the Y combinator."}, {"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461522707, "post_id": 36826572, "comment_id": 61225393, "body": "@chepner So, then <i>obviously</i> <a href=\"http://stackoverflow.com/a/36827099/2747511\">this</a> won&#39;t typecheck and work? :)"}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461523320, "post_id": 36826572, "comment_id": 61225619, "body": "@chepner Yeah, I know you need to use certain tricks, such as <code>unsafeCoerce</code>, but that&#39;s <b>not</b> the issue. The issue is that question provides the definition of y combinator, but doesn&#39;t explain how to use it, which is why i&quot;ve asked this question."}], "answers": [{"comments": [{"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 1, "creation_date": 1461557422, "post_id": 36827099, "comment_id": 61234557, "body": "Thanks, I think it&#39;s a bit clearer (at least for me) to define addition using the successor: <code>ch_add (Chr cn1) (Chr cn2) = cn1 suc (Chr cn2)</code>"}, {"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 2, "creation_date": 1461567715, "post_id": 36827099, "comment_id": 61238402, "body": "Yes, you&#39;re right. That would be a cleaner approach (from several points of view): once we defined <code>zer</code> and <code>suc</code> (and maybe some other &quot;primitives&quot;, like Church pairs, ...) we shouldn&#39;t use anything except those for building other arithmetic functions. By the way, <code>add (Chr cn1) arg2 = cn1 suc arg2</code> is another way to write the addition function (not in principal, it just avoids unfolding/folding of the second argument)."}, {"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1461581446, "post_id": 36827099, "comment_id": 61246929, "body": "Also, it&#39;s possible to implement Church numerals without the <code>RankNTypes</code> extension, but then you will have to use an implementation akin to the version in my answer, because otherwise it won&#39;t typecheck."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1461585220, "post_id": 36827099, "comment_id": 61249462, "body": "Interesting, do you mean an implementation like this? <a href=\"http://stackoverflow.com/a/6464164/165753\">stackoverflow.com/a/6464164/165753</a>"}, {"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1461585729, "post_id": 36827099, "comment_id": 61249782, "body": "Yes, but higher-order ranks give you much more in expressiveness."}], "tags": [], "owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "is_accepted": true, "score": 3, "last_activity_date": 1461521995, "creation_date": 1461521995, "answer_id": 36827099, "question_id": 36826572, "link": "https://stackoverflow.com/questions/36826572/using-the-y-combinator-in-haskell/36827099#36827099", "title": "Using the y combinator in haskell", "body": "<p>I've introduced the function <code>add</code> (which obviously adds two Church numerals) to simplify the <code>ch_sum</code>'s definition:</p>\n\n<pre><code>add :: Chur -&gt; Chur -&gt; Chur\nadd (Chr cn1) (Chr cn2) = Chr (\\h -&gt; cn1 h . cn2 h)\n</code></pre>\n\n<p>To create a recursive function using a fixed-point combinator, you need to write it as it was an ordinary recursive function (in a language with recursion), but as a last step add the <em>explicit</em> \"self\" argument as the first function's argument (<code>r</code> in this case) and instead of a recursive call you just call \"self\" (<code>r</code>). So <code>ch_sum</code> can be written as</p>\n\n<pre><code>ch_sum :: (Chur -&gt; Chur) -&gt; Chur -&gt; Chur\nch_sum = \\r n -&gt; iszero n zer $ add n (r $ pre n)\n</code></pre>\n\n<p>A couple tests in ghci:</p>\n\n<pre><code>\u03bb&gt; let n3 = ic 3\n\u03bb&gt; ci (y ch_sum n3)\n6\n\u03bb&gt; let n10 = ic 10\n\u03bb&gt; ci (y ch_sum n10)\n55\n</code></pre>\n"}], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 36827099, "answer_count": 1, "score": 6, "last_activity_date": 1461697506, "creation_date": 1461519044, "last_edit_date": 1495541259, "question_id": 36826572, "link": "https://stackoverflow.com/questions/36826572/using-the-y-combinator-in-haskell", "title": "Using the y combinator in haskell", "body": "<p>I'm a beginner in haskell, and trying to implement the Church encoding for natural numbers, as explained in <a href=\"http://archive.is/dumJ2\" rel=\"nofollow noreferrer\">this guide</a>.\nI used a definition of y combinator from <a href=\"https://stackoverflow.com/a/5886279/165753\">this answer</a>, but not sure how to apply it.</p>\n\n<p>I'd like to implement a simple function in lambda calculus which computues the sum of [1..n] as demonstrated <a href=\"http://www.inf.fu-berlin.de/lehre/WS03/alpi/lambda.pdf\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nimport Unsafe.Coerce\n\ny :: (a -&gt; a) -&gt; a\ny = \\f -&gt; (\\x -&gt; f (unsafeCoerce x x)) (\\x -&gt; f (unsafeCoerce x x))\n\ntrue = (\\x y -&gt; x)\nfalse = (\\x y -&gt; y)\n\nnewtype Chur = Chr (forall a. (a -&gt; a) -&gt; (a -&gt; a))\n\nzer :: Chur\nzer = Chr (\\x y -&gt; y)\n\nsuc :: Chur -&gt; Chur\nsuc (Chr cn) = Chr (\\h -&gt; cn h . h)\n\nci :: Chur -&gt; Integer\nci (Chr cn) = cn (+ 1) 0\n\nic :: Integer -&gt; Chur\nic 0 = zer\nic n = suc $ ic (n - 1)\n\n\n-- church pair\ntype Chp = (Chur -&gt; Chur -&gt; Chur) -&gt; Chur\n\npair :: Chur -&gt; Chur -&gt; Chp\npair (Chr x) (Chr y)  f = f (Chr x) (Chr y)\n\nch_fst :: Chp -&gt; Chur\nch_fst p = p true\n\nch_snd :: Chp -&gt; Chur\nch_snd p = p false\n\nnext_pair :: Chp -&gt; Chp\nnext_pair = (\\p x -&gt; x (suc (p true)) (p true))\n\nn_pair :: Chur -&gt; Chp -&gt; Chp\nn_pair (Chr n) p = n next_pair p\n\np0 = pair zer zer\npre :: Chur -&gt; Chur\npre (Chr cn) = ch_snd $ n_pair (Chr cn) p0\n\niszero :: Chur -&gt; (a-&gt;a-&gt;a)\niszero (Chr cn) = cn (\\h -&gt; false) true\n\nunchr :: Chur -&gt; ((a -&gt; a) -&gt; (a -&gt; a))\nunchr (Chr cn) = cn\n\nch_sum (Chr cn) = (\\r -&gt; iszero (Chr cn) zer (cn suc (r (pre (Chr cn)))))\n</code></pre>\n\n<p>So far so good, but how do I apply <code>y</code> to <code>sum</code>?\ne.g. </p>\n\n<pre><code>n3 = ic 3\ny ch_sum n3\n</code></pre>\n\n<p>causes a type mismatch:</p>\n\n<pre><code>&lt;interactive&gt;:168:3:\n     Couldn't match type \u2018(Chur -&gt; Chur) -&gt; Chur\u2019 with \u2018Chur\u2019\n     Expected type: ((Chur -&gt; Chur) -&gt; Chur) -&gt; (Chur -&gt; Chur) -&gt; Chur\n     Actual type: Chur -&gt; (Chur -&gt; Chur) -&gt; Chur\n     In the first argument of \u2018y\u2019, namely \u2018ch_sum\u2019\n     In the expression: y ch_sum n3\n\n&lt;interactive&gt;:168:10:\n   Couldn't match expected type \u2018Chur -&gt; Chur\u2019 with actual type \u2018Chur\u2019\n   In the second argument of \u2018y\u2019, namely \u2018n3\u2019\n   In the expression: y ch_sum n3\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/4273413/y-combinator-in-haskell\">Y Combinator in Haskell</a> provides the definition of y combinator, but doesn't explain how to use it.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 0, "creation_date": 1461503356, "post_id": 36823493, "comment_id": 61218388, "body": "Or, in other words <code>map (uncurry (\\x y -&gt; x * y)) [(9, 9), (8, 8)]</code> to get <code>[81, 64]</code>. Thanks! :)"}, {"owner": {"reputation": 1305, "user_id": 87721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96f6774b4445eda94b1aacf78c381ba?s=128&d=identicon&r=PG", "display_name": "niteria", "link": "https://stackoverflow.com/users/87721/niteria"}, "reply_to_user": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "edited": false, "score": 2, "creation_date": 1461503850, "post_id": 36823493, "comment_id": 61218565, "body": "That works, but you&#39;d normally write it as <code>map (\\(x, y) -&gt; x * y) [(9, 9), (8, 8)]</code>. Because <code>(*) :: Int -&gt; Int -&gt; Int</code> is also a binary function it&#39;s also possible to write it as <code>map (uncurry (*)) [(9, 9), (8, 8)]</code>, but I prefer the version above."}], "tags": [], "owner": {"reputation": 1305, "user_id": 87721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96f6774b4445eda94b1aacf78c381ba?s=128&d=identicon&r=PG", "display_name": "niteria", "link": "https://stackoverflow.com/users/87721/niteria"}, "is_accepted": true, "score": 15, "last_activity_date": 1461503654, "last_edit_date": 1461503654, "creation_date": 1461503157, "answer_id": 36823493, "question_id": 36823340, "link": "https://stackoverflow.com/questions/36823340/how-to-apply-a-lambda-with-2-parameters-to-a-list-in-haskell/36823493#36823493", "title": "How to apply a lambda with 2 parameters to a list in Haskell?", "body": "<pre><code>let list = [(9, 9), (8, 8)]\n-- if you want to do it inline\nmap (\\(x, y) -&gt; x * y) list\n-- or if you already have a 2 parameter version of a function\nlet f x y = x * y \nuncurry :: (a -&gt; b -&gt; c) -&gt; ((a, b) -&gt; c)\nmap (uncurry f) list\n</code></pre>\n\n<p>There's a difference between <code>\\(x, y) -&gt; x * y :: (Int, Int) -&gt; Int</code> and <code>\\x y -&gt; x * y :: Int -&gt; Int -&gt; Int</code>.</p>\n\n<p>The first is a function that takes one parameter - a tuple and returns the result of multiplication.</p>\n\n<p>The second is a function that takes two parameters and returns the result of multiplication.</p>\n"}], "owner": {"reputation": 7105, "user_id": 236007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BiYes.jpg?s=128&g=1", "display_name": "Emre Sevin&#231;", "link": "https://stackoverflow.com/users/236007/emre-sevin%c3%a7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2318, "favorite_count": 0, "accepted_answer_id": 36823493, "answer_count": 1, "score": 1, "last_activity_date": 1461503654, "creation_date": 1461502242, "last_edit_date": 1461502602, "question_id": 36823340, "link": "https://stackoverflow.com/questions/36823340/how-to-apply-a-lambda-with-2-parameters-to-a-list-in-haskell", "title": "How to apply a lambda with 2 parameters to a list in Haskell?", "body": "<p>In Haskell, I can take the following lambda expression:</p>\n\n<pre><code>\\x y -&gt; x * y\n</code></pre>\n\n<p>and apply it like:</p>\n\n<pre><code>(\\x y -&gt; x * y) 9 9\n81\n\n(\\x y -&gt; x * y) 8 8\n64\n</code></pre>\n\n<p>If I want to express something like, \"Take the above lambda, and map it over a list, each item being a pair of values, like above, and return a list, each value being the result of having applied that lambda expression\", how can I do it? </p>\n\n<p>In pseudo-code I mean something like: Take <code>(\\x y -&gt; x * y)</code> and apply it to something like <code>[(9, 9), (8, 8)]</code>.</p>\n\n<p>I know that if I had <code>\\x -&gt; x + 1</code>, I can do the following:</p>\n\n<pre><code>map (\\x -&gt; x + 1) [9, 9, 9]\n[10,10,10]\n</code></pre>\n\n<p>In other words, I'm trying to find out if it is possible (and how) to do something like</p>\n\n<pre><code>map (\\x y -&gt; x * y) [ a list of items, each being a pair of values, on which the lambda can work ]\n</code></pre>\n\n<p>Apparently, the following doesn't work:</p>\n\n<pre><code>map (\\x y -&gt; x * y) [(9, 9), (8, 8)]\n</code></pre>\n\n<p>it doesn't return <code>[81, 64]</code>. Is there a way to do that?</p>\n"}, {"tags": ["haskell", "undefined"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1461502042, "post_id": 36822883, "comment_id": 61217921, "body": "Undefined is a bit like an error value. If you evaluate it, it throws an error. It is <i>not</i> a data value."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461517940, "post_id": 36822883, "comment_id": 61223601, "body": "Haskell allows no null pointer/null value: it was designed to avoid a <a href=\"https://en.wikipedia.org/wiki/Null_pointer#History\" rel=\"nofollow noreferrer\">billion dollar mistake</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461500516, "post_id": 36822940, "comment_id": 61217468, "body": "Is there some undef value for String, Integer... ?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 6, "creation_date": 1461501582, "post_id": 36822940, "comment_id": 61217770, "body": "@HaskellFun No, if there&#39;s a chance that a given function may not to produce a result, you should use the <code>Maybe</code> type."}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": true, "score": 5, "last_activity_date": 1461499968, "creation_date": 1461499968, "answer_id": 36822940, "question_id": 36822883, "link": "https://stackoverflow.com/questions/36822883/undefined-value-in-haskell/36822940#36822940", "title": "undefined value in haskell", "body": "<p>This is Prelude's implementation of the <code>undefined</code> function:</p>\n\n<pre><code>undefined = error \"Prelude.undefined\"\n</code></pre>\n\n<p>Thus, trying to evaluate <code>undefined</code> will raise an exception every time. By comparing <code>t</code> to <code>undefined</code>, you're enforcing that evaluation.</p>\n\n<p>Note that <code>undefined</code> refers to a computation which never completes successfully, not to a not-known value (which is the meaning of <code>undefined</code> in JavaScript, for example; do not confuse these two, they are different things).</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1461501857, "creation_date": 1461501857, "answer_id": 36823262, "question_id": 36822883, "link": "https://stackoverflow.com/questions/36822883/undefined-value-in-haskell/36823262#36823262", "title": "undefined value in haskell", "body": "<p><code>undefined</code> is largely just a standard way to generate a &ldquo;bottom value&rdquo;. The bottom value (&perp;) is the only value that's in <em>every</em><sup>&dagger;</sup> type, so you can do</p>\n\n<pre><code>Prelude&gt; undefined :: Int\n*** Exception: Prelude.undefined\nPrelude&gt; undefined :: Double\n*** Exception: Prelude.undefined\nPrelude&gt; undefined :: String\n\"*** Exception: Prelude.undefined\nPrelude&gt; undefined :: IO [Bool]\n*** Exception: Prelude.undefined\n</code></pre>\n\n<p>Apart from the exception messages, these are equivalent to any &ldquo;custom&rdquo; bottom value, like</p>\n\n<pre><code>undefined' :: a\nundefined' = undefined'  -- this definition creates an infinite loop!\n</code></pre>\n\n<p>This time, I don't get an error message &ndash; I have to abort manually:</p>\n\n<pre><code>Prelude&gt; undefined' :: Int\n^CInterrupted.\n</code></pre>\n\n<p>Actually the Haskell standard guarantees none of this! Any compution that does never terminate with a &ldquo;proper value&rdquo; of its specified type is considered to have the value &perp;. Because you can <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow\">in general not prove</a> that a computation will not terminate, it is not possible to ask Haskell if a particular value is &perp; / <code>undefined</code>.</p>\n\n<p>If you want to have values that can explicitly (and testably) have not-values, just wrap the type in a <code>Maybe</code>!</p>\n\n<p><hr>\n<sup>&dagger;</sup><sub>Except in <a href=\"https://downloads.haskell.org/~ghc/6.12.3/docs/html/users_guide/primitives.html\" rel=\"nofollow\">unboxed types</a>, but those are an advanced low-level thing mostly used for optimisation.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 1305, "user_id": 87721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96f6774b4445eda94b1aacf78c381ba?s=128&d=identicon&r=PG", "display_name": "niteria", "link": "https://stackoverflow.com/users/87721/niteria"}, "is_accepted": false, "score": 0, "last_activity_date": 1461502878, "creation_date": 1461502878, "answer_id": 36823436, "question_id": 36822883, "link": "https://stackoverflow.com/questions/36822883/undefined-value-in-haskell/36823436#36823436", "title": "undefined value in haskell", "body": "<p>The pattern you're looking for is:</p>\n\n<pre><code>let t = Nothing :: Maybe String\ncase t of\n  Nothing -&gt; \"undefined\"\n  Just v -&gt; \"defined with value: \" ++ v\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 5, "last_activity_date": 1461687749, "last_edit_date": 1461687749, "creation_date": 1461503172, "answer_id": 36823499, "question_id": 36822883, "link": "https://stackoverflow.com/questions/36822883/undefined-value-in-haskell/36823499#36823499", "title": "undefined value in haskell", "body": "<p>Perhaps you are reasoning by analogy, thinking that \"undefined\" is the Haskell equivalent of a void pointer or null reference in an OO language. It isn't. In Haskell an undefined value is simply an error waiting to happen.</p>\n\n<p>If you want an optional value (the kind of thing you would use a null reference for in other languages) then you want Maybe. So for instance a Maybe Int is either \"Nothing\" or \"Just 5\". So for instance the \"lookup\" function has type</p>\n\n<pre><code>lookup :: Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b\n</code></pre>\n\n<p>This says that it looks things up in a list of pairs by matching on the key element (type \"a\") and then returns the second item in the pair (type \"b\"). Of course it might not find the key, so in that case it returns \"Nothing\".</p>\n\n<pre><code>lookup \"foo\" [(\"foo\", 1), (\"bar, 2)]     gives      Just 1\nlookup \"wib\" [(\"foo\", 1), (\"bar, 2)]     gives      Nothing\n</code></pre>\n\n<p>To get the result out of the \"Maybe\" you use pattern matching:</p>\n\n<pre><code>case lookup myKey theTable of\n   Just result -&gt; putStrLn $ \"Found \" ++ show result\n   Nothing -&gt; putStrLn \"Key not found\"\n</code></pre>\n\n<p>You can also use the \"maybe\" and \"fromMaybe\" functions in <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Maybe.html\" rel=\"nofollow\">Data.Maybe</a>. If you are absolutely sure that the value is really there then you can also use \"fromJust\", but you need to be very sure, and even then you probably ought to have an explicit case for Nothing so you can give a useful error message when you turn out to be wrong.</p>\n\n<p>Edit: explanation of why we do it this way</p>\n\n<p>The reason that Haskell doesn't have null references like other languages is that they are inherently ambiguous. When any value might be \"Null\", you can't be sure whether you ought to be checking for Null or not. So in the \"lookup\" example above, having the return type \"Maybe b\" makes it unambiguous, and furthermore if you forget to check then the compiler will tell you. In contrast if \"lookup\" returned a reference that might be null, how is the caller supposed to know? What happens if one of the arguments to \"lookup\" was also null. Would that be an error? Having null references means that the only ways to find out are to read the code or hope that it got included in the documentation.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1601, "favorite_count": 0, "accepted_answer_id": 36822940, "answer_count": 4, "score": 0, "last_activity_date": 1461687749, "creation_date": 1461499616, "question_id": 36822883, "link": "https://stackoverflow.com/questions/36822883/undefined-value-in-haskell", "title": "undefined value in haskell", "body": "<p>Why I can't use value undefined in haskell ?  I mean that in case:  </p>\n\n<pre><code>&gt;let t = undefinded\n&gt;if t == undefined then \"undefined\" else \"not undefined\"\n</code></pre>\n\n<p>It throws <code>*** Exception: Prelude.undefined</code>\nCan't I use undefined value in such way ?</p>\n"}, {"tags": ["file", "parsing", "haskell", "matrix", "hmatrix"], "answers": [{"comments": [{"owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "edited": false, "score": 0, "creation_date": 1461497286, "post_id": 36822475, "comment_id": 61216479, "body": "And what about &#39;repeats unknowingly often&#39; part?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "edited": false, "score": 0, "creation_date": 1461498975, "post_id": 36822475, "comment_id": 61216968, "body": "What \u201cwhat about\u201d about it?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "edited": false, "score": 0, "creation_date": 1461511229, "post_id": 36822475, "comment_id": 61221140, "body": "@\u0414\u041c\u0418\u0422\u0420\u0418\u0419\u041c\u0410\u041b\u0418\u041a\u041e\u0412 The code in this answer is operating on a string which represents the entire contents of the file. The function &#39;consumes&#39; (i.e. examines every character) of the string (unless it encounters an error) so logically speaking it will parse all of the occurrences of the pattern. As an aside, I&#39;m a little confused about the naming of <code>chunks&#192;</code> but I guess it <i>is</i> value identifier with <code>UnicodeSyntax</code>."}, {"owner": {"reputation": 158, "user_id": 4936725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df7571df77ea85d54176491301d9122b?s=128&d=identicon&r=PG&f=1", "display_name": "mahene", "link": "https://stackoverflow.com/users/4936725/mahene"}, "reply_to_user": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "edited": false, "score": 0, "creation_date": 1461695084, "post_id": 36822475, "comment_id": 61312410, "body": "@\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412 I meant that the file ends with multiple 16x16 matrices and that i don&#39;t know the exact number of those.  leftaroundabout got it right."}, {"owner": {"reputation": 158, "user_id": 4936725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df7571df77ea85d54176491301d9122b?s=128&d=identicon&r=PG&f=1", "display_name": "mahene", "link": "https://stackoverflow.com/users/4936725/mahene"}, "edited": false, "score": 0, "creation_date": 1461695479, "post_id": 36822475, "comment_id": 61312671, "body": "@leftaroundabout Many thanks. That gives me a good idea how to do it. Performance is not that crucial, but i had hoped that there is an existing matrix-parser (e.g. for <code>Parsec</code> that doesn&#39;t operate on <code>String</code>) that i can combine more elegantly. Like <code>parseMat rowCount colCount</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1461695629, "post_id": 36822475, "comment_id": 61312763, "body": "Well, a <code>Parsec</code> solution would definitely be preferrable, in particular <i>safer</i>. It&#39;s not very hard to code that up yourself, either, but if you mainly need this for a quick one-time data processing script then I&#39;d say the list-based approach is just fine."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1461497311, "last_edit_date": 1461497311, "creation_date": 1461497123, "answer_id": 36822475, "question_id": 36822211, "link": "https://stackoverflow.com/questions/36822211/how-to-parse-multiple-matrices-from-single-file-to-hmatrix/36822475#36822475", "title": "How to parse multiple matrices from single file to hmatrix?", "body": "<p>As long as performance isn't crucial, it's easiest to first preprocess the data as simple lists before introducing any special types like matrices. (And if performance does matter, you shouldn't be using text files!)</p>\n\n<p>So first</p>\n\n<pre><code>readAllNumbers :: String -&gt; [[Double]]\nreadAllNumbers = map (map read . words) . lines\n</code></pre>\n\n<p>Then you seperate the structure. In this case, you simply take the first two elements of the list of lines specially, then chunk up the remaining lines &agrave; 16. Well, that's about it, you can then simply cast the [nested] <code>Double</code> lists to matrices:</p>\n\n<pre><code>parseMContents :: String -&gt; (Double, (HMat.Matrix, [HMat.Matrix]))\nparseMContents s = case readAllNumbers s of\n     [singleValue] : singleRow : rest\n           -&gt; (singleValue, ( HMat.fromLists [singleRow]\n                            , HMat.fromLists &lt;$&gt; chunks\u00c0 16 rest ) )\n     _ -&gt; error \"Matrix file has wrong format!\"\n\nchunks\u00c0 :: Int -&gt; [a] -&gt; [[a]]\nchunks\u00c0 n ls = case splitAt n ls of\n            (hs:[]) -&gt; [hs]\n            (hs:ts) -&gt; hs : chunks\u00c0 n ts\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 4936725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df7571df77ea85d54176491301d9122b?s=128&d=identicon&r=PG&f=1", "display_name": "mahene", "link": "https://stackoverflow.com/users/4936725/mahene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 36822475, "answer_count": 1, "score": 0, "last_activity_date": 1461497311, "creation_date": 1461495524, "last_edit_date": 1461496363, "question_id": 36822211, "link": "https://stackoverflow.com/questions/36822211/how-to-parse-multiple-matrices-from-single-file-to-hmatrix", "title": "How to parse multiple matrices from single file to hmatrix?", "body": "<p>I have a txt file with several integer matrices with different dimensions that I want to parse into an hmatrix package representation, but I can't find any suitable functions. The text file contains the following form:</p>\n\n<pre><code>[single-value]\n[single-row 1x10 matrix]\n[16x16 square-matrix]\nrepeats unknowingly often\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>9\n1 2 3 ..\n9 8 7 6 5 ...\n.\n.\n4 3 2 1 0 ..\n...\n</code></pre>\n\n<p>The closest thing I found was <code>readMatrix</code> at:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/hmatrix-0.17.0.1/docs/Numeric-LinearAlgebra-Devel.html#v:readMatrix\" rel=\"nofollow\">https://hackage.haskell.org/package/hmatrix-0.17.0.1/docs/Numeric-LinearAlgebra-Devel.html#v:readMatrix</a></p>\n\n<p>but since there is no documentation and I'm fairly new to Haskell I have no idea how to use it.</p>\n"}, {"tags": ["haskell", "ghci", "hugs"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4569844, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-zTOXtbdj2oU/AAAAAAAAAAI/AAAAAAAAAHE/SSJ77Y4Vuuo/photo.jpg?sz=128", "display_name": "thelili018", "link": "https://stackoverflow.com/users/4569844/thelili018"}, "edited": false, "score": 0, "creation_date": 1461487374, "post_id": 36820950, "comment_id": 61213833, "body": "Thank you so much!! the curly brace thing worked perfectly! You&#39;re awesome!"}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 3, "last_activity_date": 1461487064, "creation_date": 1461487064, "answer_id": 36820950, "question_id": 36820844, "link": "https://stackoverflow.com/questions/36820844/what-is-wrong-with-my-haskell-code/36820950#36820950", "title": "What is wrong with my Haskell code?", "body": "<p>I cannot reproduce the error you claim you get. If you are writing that code into a file and compiling it with <code>ghc</code> the error is:</p>\n\n<pre><code>&lt;filename&gt;.hs:2:38: parse error on input \u2018=\u2019\n</code></pre>\n\n<p>And the problem is that the syntax for <code>where</code> is wrong. Either write:</p>\n\n<pre><code>an_expression where z = x+y\n</code></pre>\n\n<p>Or you have to use <strong>curly</strong> braces:</p>\n\n<pre><code>an_expression where {z=x+y;}\n</code></pre>\n\n<p>You cannot use parenthesis to group an assignment.</p>\n\n<p>Note that when writing in ghci you must group together the declarations and use a <code>let</code> to define functions:</p>\n\n<pre><code>Prelude&gt; let {addConcat :: [Int] -&gt; [Int]; addConcat [x,y] = [z,z+y] where z=x+y;}\nPrelude&gt; addConcat [1,2]\n[3,5]\n</code></pre>\n\n<p>Note also that even fixing this your function still has a type error because the second argument of <code>:</code> must be a list while <code>z+y</code> is a number. You want <code>z:[z+y]</code> or more simply <code>[z, z+y]</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 4569844, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-zTOXtbdj2oU/AAAAAAAAAAI/AAAAAAAAAHE/SSJ77Y4Vuuo/photo.jpg?sz=128", "display_name": "thelili018", "link": "https://stackoverflow.com/users/4569844/thelili018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 36820950, "answer_count": 1, "score": -1, "last_activity_date": 1461487064, "creation_date": 1461486177, "last_edit_date": 1461486806, "question_id": 36820844, "link": "https://stackoverflow.com/questions/36820844/what-is-wrong-with-my-haskell-code", "title": "What is wrong with my Haskell code?", "body": "<p>My code:</p>\n\n<pre><code>addConcat :: [Int] -&gt; [Int]\naddConcat [x,y] = z:(z + y) where (z = x + y)\n</code></pre>\n\n<p>I'm implementing a function not exactly the one above but it's of the same format and I always get:</p>\n\n<pre><code>Syntax error in input (unexpected symbol \"y\")\n</code></pre>\n\n<p>So what is wrong with my Haskell code? I really need to use the 'where' clause but I think I'm doing something wrong. </p>\n"}, {"tags": ["user-interface", "haskell", "wxwidgets", "wxhaskell"], "answers": [{"tags": [], "owner": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "is_accepted": true, "score": 1, "last_activity_date": 1461517684, "last_edit_date": 1461517684, "creation_date": 1461474772, "answer_id": 36819527, "question_id": 36818471, "link": "https://stackoverflow.com/questions/36818471/wxhaskell-button-state/36819527#36819527", "title": "wxHaskell Button State", "body": "<p><strong>Workaround</strong></p>\n\n<p>You can implement this yourself by detecting the low-level actions that trigger those events (eg. mouse button down, space bar down).</p>\n\n<p>In WX you can use the following function and constructor:</p>\n\n<pre><code>mouse :: Reactive w =&gt; Event w (EventMouse -&gt; IO ())\ndata EventMouse = ... | MouseLeftDown !Point !Modifiers\n</code></pre>\n\n<p>And, as you suggest, you could keep the state yourself in an <code>IORef</code>. My suspicion is that left button here means <em>main</em> button (right for left-handed users).</p>\n\n<p><strong>UI design principles</strong></p>\n\n<p>The second question, which you haven't asked by I'll answer, is whether this is good UI design.</p>\n\n<p>The behaviour of a button (assuming interaction using a mouse) is that <strong>click events</strong> are reported when the user releases the mouse button <strong>in the button area</strong> <em>after</em> pressing the mouse button down in the same area. If the user moves away and releases, or presses 'Escape', there is no click.</p>\n\n<p>Taking any action on a button being pressed (not clicked) would feel unnatural for users.</p>\n\n<p>In practice, the only acceptable way to use this would be, imho, to take an action whose effects can <strong>only</strong> be witnessed after releasing and which is immediately <strong>undone</strong> if the click is cancelled (ie. mouse button released outside button area).</p>\n\n<p><em>EDIT</em>: Please, also, take into account that users with accessibility requirements may have OS settings enabled that affect how and when button clicks are reported (but not down/up mouse events).</p>\n"}, {"tags": [], "owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "is_accepted": false, "score": 0, "last_activity_date": 1461509402, "creation_date": 1461509402, "answer_id": 36824657, "question_id": 36818471, "link": "https://stackoverflow.com/questions/36818471/wxhaskell-button-state/36824657#36824657", "title": "wxHaskell Button State", "body": "<p>There is no way to know if a <code>wxButton</code> is pressed or not because it is an abstraction of a push button which intentionally hides this implementation detail. If you need to know the button state, use a <a href=\"http://docs.wxwidgets.org/3.1.0/classwx_toggle_button.html\" rel=\"nofollow\">wxToggleButton</a> instead.</p>\n"}], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 36819527, "answer_count": 2, "score": 0, "last_activity_date": 1461517684, "creation_date": 1461463162, "question_id": 36818471, "link": "https://stackoverflow.com/questions/36818471/wxhaskell-button-state", "title": "wxHaskell Button State", "body": "<p>I'm writing an application using wxHaskell and I want to be able to detect the state of a button (whether or not it is pressed at any given time). I'm having a bit of trouble figuring out how to do this, however. First I thought that there might be a \"button is pressed\" attribute that I could use, but there didn't seem to be. Then I had the idea of maintaining an <code>IORef</code> which I update on button-up and button-down events. However, that would require that the <code>Button</code> object actually <em>have</em> button-up and button-down events, which is does not appear to. It is an instance of <code>Commanding</code>, but I assume that the <code>command</code> event is fired on button-up only, which isn't enough for that idea. Does anyone have any other suggestions?</p>\n"}, {"tags": ["performance", "haskell"], "comments": [{"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 2, "creation_date": 1461485744, "post_id": 36818270, "comment_id": 61213451, "body": "As far as I know <code>Foo n</code> is transformed to <code>\\ a b -&gt; Foo n a b</code> by the compiler, because there are no partially applied constructors in the STG-machine."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1461499455, "post_id": 36818270, "comment_id": 61217120, "body": "@augustss, <code>Foo</code> is translated to a strict <i>function</i> which calls the real constructor, as far as I can tell. Does further unboxing occur between simplification and STG?"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1461529120, "post_id": 36818270, "comment_id": 61227961, "body": "All I meant was that partially applied constructors are translated to functions.  Then there is another level of translation for strict constructors."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1484519748, "last_edit_date": 1484519748, "creation_date": 1483377266, "answer_id": 41430782, "question_id": 36818270, "link": "https://stackoverflow.com/questions/36818270/partial-application-of-strict-constructors/41430782#41430782", "title": "Partial application of strict constructors", "body": "<p>I opened <a href=\"http://ghc.haskell.org/trac/ghc/ticket/12990\" rel=\"nofollow noreferrer\">GHC Trac ticket 12990</a> for this. Reid Barton and Simon Peyton Jones suggested a fix (allowing the wrapper function to be inlined when partially applied), which I submitted as <a href=\"https://phabricator.haskell.org/D2891\" rel=\"nofollow noreferrer\">GHC Phabricator differential D2891</a>. The patch has been applied to the master branch and will be included in GHC 8.2.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "accepted_answer_id": 41430782, "answer_count": 1, "score": 16, "last_activity_date": 1484519748, "creation_date": 1461460910, "last_edit_date": 1461547586, "question_id": 36818270, "link": "https://stackoverflow.com/questions/36818270/partial-application-of-strict-constructors", "title": "Partial application of strict constructors", "body": "<p>Suppose I have</p>\n\n<pre><code>data Foo a = Foo !Int a [a] | Bar [a]\n</code></pre>\n\n<p>so the <code>Foo</code> constructor is strict in its first argument, which will be unpacked. Suppose further that I'm passing <code>Foo n</code> to a higher-order function <code>f</code> and that <code>f</code> does not get inlined (so <code>Foo n</code> is actually passed). The Core I get with <code>-O2</code> indicates that <code>n</code> gets boxed and then passed to <code>Foo</code>, and the result is passed to <code>f</code>. My question: would I be better off calling</p>\n\n<pre><code>f (\\a b -&gt; Foo n a b)\n</code></pre>\n\n<p>to avoid boxing <code>n</code>? Or would that lead to some other performance problem?</p>\n\n<hr>\n\n<p>I was actually thinking to define</p>\n\n<pre><code>foo' !n = \\a b -&gt; Foo n a b\n</code></pre>\n\n<p>and call <code>f (foo' n)</code>, which I figured should do the same thing, but I guess it's better to ask specifically.</p>\n"}, {"tags": ["haskell", "functional-programming", "ghc"], "comments": [{"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 8, "creation_date": 1461462026, "post_id": 36818211, "comment_id": 61209094, "body": "You say you have researched tutorials on Haskell <i>functions</i>, but have you tried reading a tutorial on <i>Haskell</i>? The code above suggests that you need to review many of the basic concepts and syntax of Haskell in general. I suggest taking a look at &quot;Learn You a Haskell for Great Good&quot; if you haven&#39;t already."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "reply_to_user": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461469662, "post_id": 36818211, "comment_id": 61210399, "body": "I&#39;m voting to close this because you seem to be missing some fundamentals about Haskell&#39;s syntax, and that would makes answering this question much more difficult than it should be. I second @Kwarrtz&#39;s suggestion that you have a look at <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">LYAH</a>, it&#39;s a great reference and tutorial for people just getting into the language. I&#39;d also suggest <a href=\"http://book.realworldhaskell.org/read/\" rel=\"nofollow noreferrer\">Real World Haskell</a>, which is still largely up-to-date."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1461478874, "last_edit_date": 1592644375, "creation_date": 1461478874, "answer_id": 36819959, "question_id": 36818211, "link": "https://stackoverflow.com/questions/36818211/functions-in-haskell-specifically-swap-function/36819959#36819959", "title": "Functions in Haskell (specifically swap function)", "body": "<p>as your main question is about writing .hs files please have a look at this:</p>\n<pre><code>module Main where\n\nswap :: Int -&gt; Int -&gt; [a] -&gt; [a]\nswap i j xs = map f (zip [0..] xs)\n  where f (k,x)\n          | k == i = xj\n          | k == j = xi\n          | otherwise = x\n        xi = xs !! i\n        xj = xs !! j\n\nmain :: IO ()\nmain = print (swap 1 2 [1,2,3,4])\n</code></pre>\n<p>you can copy&amp;paste this into an empty file and save it as <code>swap.hs</code> which you should be able to compile and load into GHCi just fine.</p>\n<p>As you can see the file starts with a <code>module</code>-declaration then it defines your <code>swap</code> function (but well the implementation is  bit more involved as what you had in mind - and indeed this one is not the most efficient one).</p>\n<p>It first introduces the type-signature (which is not necessary but usually a we do it at top-level functions) and starting from the next line implements the function.</p>\n<p>Finally it gives the <code>main :: IO()</code> computation which is necessary in case you want to compile it into a executable program.</p>\n<p>This computation just uses <code>swap</code> and prints out the result for your example.</p>\n<hr />\n<h3>remark</h3>\n<p>As this is homework you should re-implement at least the <code>swap</code> again by yourself.</p>\n<p>You probably don't understand the way it works and it will use thinks you  cannot know for your course or may not use anyway - that's by design: you are supposed to remove the implementation and insert your own.</p>\n"}], "owner": {"reputation": 45, "user_id": 4657378, "user_type": "registered", "profile_image": "https://graph.facebook.com/1822538733/picture?type=large", "display_name": "Matthew Harris", "link": "https://stackoverflow.com/users/4657378/matthew-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "closed_date": 1462351958, "answer_count": 1, "score": -4, "last_activity_date": 1461478874, "creation_date": 1461460277, "question_id": 36818211, "link": "https://stackoverflow.com/questions/36818211/functions-in-haskell-specifically-swap-function", "closed_reason": "Needs details or clarity", "title": "Functions in Haskell (specifically swap function)", "body": "<p>Alright I know that this question has been asked before, but no answers have compiled. I've researched Haskell function tutorials to no avail. Basically I just want to know how to declare a function in Haskell and how to call it. Most of the tutorials I've found are answering how to do this with ghci, which I understand should be basically the same thing, but I need to write this in a .hs file and compile with ghc for a school assignment. Basically I'd like something like this:</p>\n\n<pre><code>main = do\n\nlet list = [1,2,3,4]\n-- declare swap\nswap (list !! 0) (list !!2)\n-- Or\nswap 1 2 list\n</code></pre>\n\n<p>I'm using ghc version 7.4.1 which I understand isn't the latest version, but it's not a terribly old version either, so it shouldn't make a difference here, should it? Any and all help would be greatly appreciated. Thank you.</p>\n"}, {"tags": ["haskell", "dsl", "type-families", "type-level-computation", "data-kinds"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1461499127, "post_id": 36816896, "comment_id": 61217019, "body": "&quot;I don&#39;t know how to use the actual data&quot; \u2014 use in what way? Your question is cluttered with redundant details, but doesn&#39;t contain a clear explanation of what you actually want. Does <a href=\"http://ideone.com/yw0148\" rel=\"nofollow noreferrer\">this</a> work for you?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3130191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4334a91cae430fedb01461fcd93c67a0?s=128&d=identicon&r=PG&f=1", "display_name": "forflo", "link": "https://stackoverflow.com/users/3130191/forflo"}, "edited": false, "score": 0, "creation_date": 1461496318, "post_id": 36818257, "comment_id": 61216154, "body": "But that does not solve my problem. Now I&#39;d have to write something like SuccessorF (Successor F (ZeroF 32))  for [[32]] in my EDLS, which is totally unacceptable."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461509692, "post_id": 36818257, "comment_id": 61220590, "body": "&quot;all of them amount to encoding the depth of iteration at the value level&quot; - it is already encoded in the <code>Vector</code> datatype. You do not need to define any additional machinery to do so."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 0, "last_activity_date": 1461530081, "last_edit_date": 1461530081, "creation_date": 1461460776, "answer_id": 36818257, "question_id": 36816896, "link": "https://stackoverflow.com/questions/36816896/problems-with-edsl-related-implementation-of-array-subscription-in-haskell/36818257#36818257", "title": "Problems with EDSL related implementation of array subscription in Haskell", "body": "<p>You have a few options, all of them amount to encoding the depth of iteration at the value level so that you can pattern match on it.</p>\n\n<h3>GADT</h3>\n\n<p>The simplest way to do this is to make a GADT for representing iteration of the application of a type constructor:</p>\n\n<pre><code>data IterateF peanoNum f a where\n    ZeroF      :: a                   -&gt; IterateF Zero           f a\n    SuccessorF :: f (IterateF pn f a) -&gt; IterateF (Successor pn) f a\n\ninstance Functor f =&gt; Functor (IterateF peanoNum f) where\n    fmap f (ZeroF a)       = ZeroF $ f a\n    fmap f (SuccessorF xs) = SuccessorF $ fmap (fmap f) xs\n\n-- There's also an Applicative instance, see Data.Functor.Compose\n</code></pre>\n\n<h3>Singleton</h3>\n\n<p>If you're tied to your type family, you can use a singleton instead. A singleton is a type inhabited by a single value that you can pattern match on to introduce to the compiler facts known about that type. The following is a singleton for the natural numbers:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n\ndata SPeano pn where\n    SZero :: SPeano Zero\n    SSuccessor :: Singleton (SPeano pn) =&gt; SPeano pn -&gt; SPeano (Successor pn)\n\nclass Singleton a where\n    singleton :: a\n\ninstance Singleton (SPeano Zero) where\n    singleton = SZero\n\ninstance Singleton (SPeano s) =&gt; Singleton (SPeano (Successor s)) where\n    singleton = SSuccessor singleton\n</code></pre>\n\n<p>A simpler <code>SPeano</code> singleton without the <code>Singleton</code> type class is equivalent, but this version doesn't require writing as many proofs, instead it captures them in the construction of the successor.</p>\n\n<p>If we modify the <code>IterateF</code> GADT from the previous section to capture the same proofs (because I'm lazy) we can convert to the GADT whenever we have an <code>SPeano</code> singleton. No matter what, we can easily convert from the GADT.</p>\n\n<pre><code>data IterateF peanoNum f a where\n    ZeroF      ::                          a                   -&gt; IterateF Zero           f a\n    SuccessorF :: Singleton (SPeano pn) =&gt; f (IterateF pn f a) -&gt; IterateF (Successor pn) f a\n\ntoIterateF :: Functor f =&gt; SPeano pn -&gt; Iterate pn f a -&gt; IterateF pn f a\ntoIterateF SZero a = ZeroF a\ntoIterateF (SSuccessor pn) xs = SuccessorF $ fmap (toIterateF pn) xs\n\ngetIterateF :: Functor f =&gt; IterateF pn f a -&gt; Iterate pn f a\ngetIterateF (ZeroF a) = a\ngetIterateF (SuccessorF xs) = fmap getIterateF xs\n</code></pre>\n\n<p>Now we can easily make an alternative representation for <code>IterateF</code> that's a singleton and an application of the <code>Iterate</code> type family.</p>\n\n<pre><code>data Iterated pn f a = Iterated (SPeano pn) (Iterate pn f a)\n</code></pre>\n\n<p>I'm lazy, and don't like writing proofs that could be handled for me by a GADT, so I'll just keep the <code>IterateF</code> <code>GADT</code> around and write functions for <code>Iterated</code> in terms of it.</p>\n\n<pre><code>toIterated :: Functor f =&gt; IterateF pn f a -&gt; Iterated pn f a\ntoIterated xs@(ZeroF      _) = Iterated singleton (getIterateF xs)\ntoIterated xs@(SuccessorF _) = Iterated singleton (getIterateF xs)\n\nfromIterated :: Functor f =&gt; Iterated pn f a -&gt; IterateF pn f a\nfromIterated (Iterated pn xs) = toIterateF pn xs\n\ninstance Functor f =&gt; Functor (Iterated pn f) where\n    fmap f = toIterated . fmap f . fromIterated\n</code></pre>\n\n<p>The pattern matching in <code>toIterated</code> is to introduce the proofs captured in the construction of <code>SuccessorF</code>. If we had something more complicated to do, we might want to capture this in a <a href=\"http://hackage.haskell.org/package/constraints-0.6/docs/Data-Constraint.html#t:Dict\" rel=\"nofollow\"><code>Dict</code></a></p>\n\n<h3>Use any other encoding</h3>\n\n<p>In the specific case of </p>\n\n<pre><code>(:?) :: Vector n Expression -&gt; Iterate (n) [] Double -&gt; Expression\n</code></pre>\n\n<p>you have a <code>Vector n</code> that is encoding the depth of iteration of the <code>Iterate n []</code> at the value level. You can pattern match on the vector, which is either <code>Nil</code> or <code>(_ :+ xs)</code> to prove that the <code>Iterate n []</code> is either <code>Double</code> or a list. You can use this for simple cases, such as <a href=\"http://ideone.com/yw0148\" rel=\"nofollow\"><code>show</code>ing the nested values</a>, or you can convert the <code>Vector n</code> into another singleton to use one of the more powerful representations from the previous sections.</p>\n\n<pre><code>-- The only proof we need to write by hand\nssuccessor :: SPeano pn -&gt; (SPeano (Successor pn))\nssuccessor pred =\n    case pred of\n        SZero        -&gt; SSuccessor pred\n        SSuccessor _ -&gt; SSuccessor pred\n\nlengthSPeano :: Vector pn st -&gt; SPeano pn\nlengthSPeano Nil = SZero\nlengthSPeano (_ :+ xs) = ssuccessor (lengthSPeano xs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 3130191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4334a91cae430fedb01461fcd93c67a0?s=128&d=identicon&r=PG&f=1", "display_name": "forflo", "link": "https://stackoverflow.com/users/3130191/forflo"}, "edited": false, "score": 1, "creation_date": 1461604120, "post_id": 36824965, "comment_id": 61262765, "body": "That&#39;s exactly what I&#39;ve been looking for. I very much appreciate it!"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 2, "last_activity_date": 1461510819, "creation_date": 1461510819, "answer_id": 36824965, "question_id": 36816896, "link": "https://stackoverflow.com/questions/36816896/problems-with-edsl-related-implementation-of-array-subscription-in-haskell/36824965#36824965", "title": "Problems with EDSL related implementation of array subscription in Haskell", "body": "<p>In order to know what value is actually stored by <code>Iterate n [] Double</code>, you must know some information about <code>n</code>. This information is typically given by the indices of some GADT, which correspond to the inductive structure of the index itself (commonly known as a <a href=\"https://hackage.haskell.org/package/singletons\" rel=\"nofollow\">singleton</a>). </p>\n\n<p>But fortunately for you, you have already stored the <code>Nat</code> index in the structure of the <code>Vector</code>. You already have all the information you need at hand, you just need to pattern match! e.g. </p>\n\n<pre><code>instance Show Expression where\n    ...\n    show (vec :? dbl) = \"(\" ++ show vec ++ go vec dbl ++ \")\" where \n      go :: Vector n x -&gt; Iterate n [] Double -&gt; String \n      go Nil a = show a \n      go (_ :+ n) a = \"[\" ++ intercalate \",\" (map (go n) a) ++ \"]\" \n</code></pre>\n\n<p>Note that in the first pattern, the type of <code>Nil</code> gives you <code>n ~ 0</code> which in turn gives you <code>Iterate 0 [] Double ~ Double</code> (simply by definition). In the second pattern, you have <code>n ~ k + 1</code> for some <code>k</code> and <code>Iterate n [] Double ~ [ Iterate k [] Double ]</code>. Pattern matching on the <code>Nat</code> allows you to view the inductive structure of the type family, essentially. </p>\n\n<p>Every function you write on <code>Iterate</code> will look like </p>\n\n<pre><code>foo :: forall n . Vector n () -&gt; Iterate n F X -&gt; Y  -- for some X,Y\n</code></pre>\n\n<p>because you must have such a value-level proof in order to write any inductive function on <code>Iterate</code>. If you do not like carrying around these \"dummy\" values, you can make them implicit with a class:</p>\n\n<pre><code>class KnownNat n where \n  isNat :: Vector n () \n\ninstance KnownNat 'Z where isNat = Nil \ninstance KnownNat n =&gt; KnownNat ('S n) where isNat = () :+ isNat\n</code></pre>\n\n<p>but in this case, since your AST already contains a concrete <code>Vector</code>, you do not need to do any extra work to access the actual value of the index - just pattern match on the vector.</p>\n"}], "owner": {"reputation": 23, "user_id": 3130191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4334a91cae430fedb01461fcd93c67a0?s=128&d=identicon&r=PG&f=1", "display_name": "forflo", "link": "https://stackoverflow.com/users/3130191/forflo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 36824965, "answer_count": 2, "score": 1, "last_activity_date": 1461530081, "creation_date": 1461448461, "last_edit_date": 1461471620, "question_id": 36816896, "link": "https://stackoverflow.com/questions/36816896/problems-with-edsl-related-implementation-of-array-subscription-in-haskell", "title": "Problems with EDSL related implementation of array subscription in Haskell", "body": "<h1>Context</h1>\n\n<p>I'm trying to implement a EDSL that loosely resembles IBM's OLP (modelling language for linear programming).</p>\n\n<h1>Code</h1>\n\n<h3>Haskell EDSL Code</h3>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE FlexibleInstances #-}\n\n-- Numbers at the type level\ndata Peano = Zero | Successor Peano\n\n-- Counting Vector Type. Type information contains current length\ndata Vector peanoNum someType where\n    Nil :: Vector Zero someType\n    (:+) :: someType \n            -&gt; Vector num someType \n            -&gt; Vector (Successor num) someType\ninfixr 5 :+ \n\n-- Generate Num-th nested types\n-- For example: Iterate (S (S Z)) [] Double =&gt; [[Double]]\ntype family Iterate peanoNum constructor someType where\n    Iterate Zero cons typ = typ\n    Iterate (Successor pn) cons typ = \n        cons (Iterate pn cons typ)\n\n-- DSL spec\n\ndata Statement =\n      DecisionVector [Double]\n    | Minimize Statement\n    | Iteration `Sum` Expression\n    | Forall Iteration Statement\n    | Statement :| Statement\n    | Constraints Statement\ninfixl 8 `Sum`\ninfixl 3 :|\n\ndata Iteration =\n      String `In` [Double]\n    | String `Ins` [String]\n\ndata Expression where\n    EString :: String -&gt; Expression\n    EFloat :: Double -&gt; Expression\n    (:?) :: Vector n Expression -&gt; Iterate (n) [] Double -&gt; Expression\n    (:*) :: Expression -&gt; Expression -&gt; Expression\n    Lt :: Expression -&gt; Expression -&gt; Expression\n    Gt :: Expression -&gt; Expression -&gt; Expression\n    Id :: String -&gt; Expression\ninfixr 5 `Lt`\ninfixr 5 `Gt`\ninfixr 6 :*\ninfixr 7 :?\n\ntest :: Statement\ntest = \n    let rawMaterial = 205\n        products = [\"light\", \"medium\", \"heavy\"]\n        demand = [59, 12, 13]\n        processes = [1, 2] \n        production = [[12,16], [1,7], [4,2]]\n        consumption = [25, 30]\n        -- foo = (EId \"p\" :+ EId \"f\" :+ Nil) `Subscript` production\n        -- bar = (EId \"p\" :+ Nil) `Subscript` cost\n        run = []\n        cost = [300, 400]\n    in  \n        DecisionVector run :|\n        Minimize \n            (Sum (\"p\" `In` processes) \n                 ((Id \"p\" :+ Nil) :? cost :*\n                  (Id \"p\" :+ Nil) :? run)) :|\n        Constraints \n            (Sum (\"p\" `In` processes)\n                 ((Id \"p\" :+ Nil) :? consumption :*\n                  (Id \"p\" :+ Nil) :? run `Lt` EFloat rawMaterial) :|\n             Forall (\"q\" `Ins` products)\n                    (Sum (\"p\" `In` processes)\n                         ((Id \"q\" :+ Id \"p\" :+ Nil) :? production :*\n                          (Id \"p\" :+ Nil) :? run `Gt` \n                          (Id \"q\" :+ Nil) :? demand)))\n\ninstance Show Statement where\n    show (DecisionVector v) = show v\n    show (Minimize s) = \"(Minimize \" ++ show s ++ \")\"\n    show (i `Sum` e) = \"(\" ++ show i ++ \" `Sum` \" ++ show e ++ \")\"\n    show (Forall i e) = \"(Forall \" ++ show i ++ show e ++ \")\"\n    show (sa :| sb) = \"(\" ++ show sa ++ show sb ++ \")\"\n    show (Constraints s) = \"(Constraints \" ++ show s  ++ \")\"\n\ninstance Show Iteration where\n    show (str `In` d) = \"(\" ++ show str ++ \" `In` \" ++ show d ++ \")\"\n    show (str `Ins` d) = \"(\" ++ show str ++ \" `Ins` \" ++ show d ++ \")\"\n\ninstance Show Expression where\n    show (EString s) = \"(EString \" ++ show s ++ \")\"\n    show (EFloat f) = \"(EFloat \" ++ show f ++ \")\"\n    show (Lt ea eb) = \"(\" ++ show ea ++ \" `Lt` \" ++ show eb ++ \")\"\n    show (Gt ea eb) = \"(\" ++ show ea ++ \" `Gt` \" ++ show eb ++ \")\"\n    show (ea :* eb) = \"(\" ++ show ea ++ \" :* \" ++ show eb ++ \")\"\n    show (Id s) = \"(Id \" ++ show s ++ \")\"\n    show (vec :? dbl) = \"(\" ++ show vec ++ \" :? \" ++ \"dbl\" ++ \")\"\n\ninstance Show (Vector p Expression) where\n    show (Nil) = \"Nil\"\n    show (e :+ v) = \"(\" ++ show e ++ \" :+ \" ++ show v ++ \")\"\n\n-- eval_opl :: Statement -&gt; [Double]\n</code></pre>\n\n<h3>EDSL to OPL comparison</h3>\n\n<pre><code>    let rawMaterial = 205\n        products = [\"light\", \"medium\", \"heavy\"]\n        demand = [59, 12, 13]\n        processes = [1, 2] \n        production = [[12,16], [1,7], [4,2]]\n        consumption = [25, 30]\n        -- foo = (EId \"p\" :+ EId \"f\" :+ Nil) `Subscript` production\n        -- bar = (EId \"p\" :+ Nil) `Subscript` cost\n        run = []\n        cost = [300, 400]\n    in  \n        DecisionVector run :|\n        Minimize \n            (Sum (\"p\" `In` processes) \n                 ((Id \"p\" :+ Nil) :? cost :*\n                  (Id \"p\" :+ Nil) :? run)) :|\n        Constraints \n            (Sum (\"p\" `In` processes)\n                 ((Id \"p\" :+ Nil) :? consumption :*\n                  (Id \"p\" :+ Nil) :? run `Lt` EFloat rawMaterial) :|\n             Forall (\"q\" `Ins` products)\n                    (Sum (\"p\" `In` processes)\n                         ((Id \"q\" :+ Id \"p\" :+ Nil) :? production :*\n                          (Id \"p\" :+ Nil) :? run `Gt` \n                          (Id \"q\" :+ Nil) :? demand)))\n</code></pre>\n\n<p>corresponds to the opl code</p>\n\n<pre><code>float rawMaterial                     = 205;\n{string} products                     = {\"light\",\"medium\",\"heavy\"};\nfloat demand[products]                = [59,12,13];\n{string} processes                    = {\"1\",\"2\"};\nfloat production[products][processes] = [[12,16],[1,7],[4,2]];\nfloat consumption[processes]          = [25,30];\nfloat cost[processes]                 = [300,400];\n\ndvar float+ run[processes];\n\nminimize sum (p in processes) cost[p] * run[p];\n\nconstraints {\n  sum (p in processes) consumption[p] * run[p] &lt;= rawMaterial;\n  forall (q in products)\n    sum (p in processes) production[q][p] * run[p] &gt;= demand[q];\n}\n</code></pre>\n\n<h3>Relevant sections</h3>\n\n<pre><code>(:?) :: Vector n Expression -&gt; Iterate (n) [] Double -&gt; Expression\n</code></pre>\n\n<p>as well as </p>\n\n<pre><code>instance Show Expression where\n    [...]\n    show (vec :? dbl) = \"(\" ++ show vec ++ \" :? \" ++ \"dbl\" ++ \")\"\n</code></pre>\n\n<h1>Problem description</h1>\n\n<p>OPL uses brackets for array subscription and I tried to map subscriptions\nto my EDSL using the following notation</p>\n\n<pre><code>((Id \"p\" :+ Id \"f\" :+ Nil) :? consumption\n</code></pre>\n\n<p>which corresponds to OPL in the following sense:</p>\n\n<pre><code>consumption[p][f]\n</code></pre>\n\n<p>in the former, (Id \"p\" :+ Id \"f\" :+ Nil) constructs a value of type Vector that contains type level information regarding the length of said vector. \nAccording to the definition of the constructor :?, you can see that,\nIterate (n) [] Double thus will expand to [[Double]]. \nThis neatly works as expected. However, in turn to use the generated syntax tree, I need to pattern match against the actual values. </p>\n\n<pre><code>show (vec :? dbl) = \"(\" ++ show vec ++ \" :? \" ++ \"dbl\" ++ \")\"\n</code></pre>\n\n<p><em>Problem</em>: The above line works but I don't know how to <em>use</em> the actual data. How do I pattern match? Is it even possible to use the data anyway?\nReplacement of dbl through the obvious </p>\n\n<pre><code>(Iterate (Successor (Successor Zero)) [] Double)\n</code></pre>\n\n<p>doesn't work. I also tried to build up a data family but I could not figure out a way to recursively create a family of all arbitrarily nested Lists of Double:</p>\n\n<pre><code>Double\n[Double]\n[[Double]]\n[[[Double]]]\n...\n</code></pre>\n"}, {"tags": ["haskell", "garbage-collection", "ghc"], "comments": [{"owner": {"reputation": 20893, "user_id": 13767, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b043ead577679feb2f4f4c3e4bb4700f?s=128&d=identicon&r=PG", "display_name": "Rafa\u0142 Rawicki", "link": "https://stackoverflow.com/users/13767/rafa%c5%82-rawicki"}, "edited": false, "score": 0, "creation_date": 1461451886, "post_id": 36816713, "comment_id": 61207103, "body": "Playing with <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime-control.html\" rel=\"nofollow noreferrer\">GC settings</a> is probably not a good way to measure memory usage - the results can still be imprecise. Please look at <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/prof-heap.html\" rel=\"nofollow noreferrer\">GHC memory profiling page</a>."}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 20893, "user_id": 13767, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b043ead577679feb2f4f4c3e4bb4700f?s=128&d=identicon&r=PG", "display_name": "Rafa\u0142 Rawicki", "link": "https://stackoverflow.com/users/13767/rafa%c5%82-rawicki"}, "edited": false, "score": 0, "creation_date": 1461464222, "post_id": 36816713, "comment_id": 61209487, "body": "@Rafa\u0142Rawicki Profiling isn&#39;t an option for me because it interferes with optimization"}], "answers": [{"comments": [{"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "edited": false, "score": 0, "creation_date": 1461513527, "post_id": 36821197, "comment_id": 61221987, "body": "Maybe I didn&#39;t make this clear, but this is not a performance issue. My sole purpose is to obtain a more accurate measurement of the live size. The runtime system gets stats of live size from GC, so more frequent GC means more points of measure. I don&#39;t care if the overall performance gets worse as long as the measurement is better."}, {"owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "reply_to_user": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "edited": false, "score": 0, "creation_date": 1461617755, "post_id": 36821197, "comment_id": 61270764, "body": "@rem: OK, I misunderstood that. In another comment you said that profiling interferes with optimization, you I assumed that it was about performance. You might still want to check whether profiling really costs too much performance if you compile only with <code>-prof</code> but do not annotate any cost centres. Then run with e.g. <code>+RTS -hb</code>. Add <code>-i</code> to control the sampling interval."}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "edited": false, "score": 0, "creation_date": 1461632132, "post_id": 36821197, "comment_id": 61275918, "body": "&quot;You might still want to check whether profiling really costs too much performance&quot; in that regard, &quot;cost too much performance&quot; means its overhead on live size over the real live size. But then how does one tell if there&#39;s no more accurate measurement of the real live size?"}], "tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 0, "last_activity_date": 1461489010, "creation_date": 1461489010, "answer_id": 36821197, "question_id": 36816713, "link": "https://stackoverflow.com/questions/36816713/make-ghc-to-do-more-gcs/36821197#36821197", "title": "make GHC to do more GCs?", "body": "<p>I would advise against forcing a higher frequency of GCs unless you specifically know a better suited GC-tuning for your code. GC runs can be very expensive.</p>\n\n<p>Yes, your program uses \"too much\" memory, but this lenience is what makes the GC perform well. If you allow an overhead of 2-3 times of the memory that is strictly needed (<em>do not know figures for GHCs GC though</em>), GC runs can be scheduled much more infrequently.</p>\n\n<p>You say you do not want to turn on memory profiling, because it interferes with optimizations, but forcing the GC may be worse. If you increase the pressure on the heap too much, you may end up benchmarking GC runs.</p>\n"}, {"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 2, "last_activity_date": 1461681502, "creation_date": 1461681502, "answer_id": 36868151, "question_id": 36816713, "link": "https://stackoverflow.com/questions/36816713/make-ghc-to-do-more-gcs/36868151#36868151", "title": "make GHC to do more GCs?", "body": "<p>For direct increase in GCs you can set the <code>-Iseconds</code> flag to something lower than 0.3 to increase the frequency of idle GC. You can also set <code>-c</code> to use a compacting algo which should generally reduce memory usage (to give a closer approx to actual memory used rather than GC overhead). You may also want to set <code>-Asize</code> to something lower than 512k, which by giving a smaller allocation area should generally increase the no. of GCs.</p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 36868151, "answer_count": 2, "score": 2, "last_activity_date": 1461681502, "creation_date": 1461447270, "last_edit_date": 1461454483, "question_id": 36816713, "link": "https://stackoverflow.com/questions/36816713/make-ghc-to-do-more-gcs", "title": "make GHC to do more GCs?", "body": "<p>In order to obtain a more accurate measure of the maximium live size of some programs, I'd like to have the runtime system to do more frequent garbage collections. Are there flags to GHC that directly/indirectle result in more GCs? I know inserting <code>performGC</code> can achive that to some extent, but there are quite a few programs to instrument. </p>\n"}, {"tags": ["parsing", "haskell", "happy"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461450347, "post_id": 36816589, "comment_id": 61206722, "body": "Precedences only have meaning when defined relative to some other things - you have defined a &#39;precedence&#39; for one rule but not given an <i>actual</i> precedence to it with respect to some other rule."}, {"owner": {"reputation": 2641, "user_id": 1225786, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f0251000ccaade065dde90c38e9525e?s=128&d=identicon&r=PG", "display_name": "Christophe De Troyer", "link": "https://stackoverflow.com/users/1225786/christophe-de-troyer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461488552, "post_id": 36816589, "comment_id": 61214091, "body": "I have done so as well. Seems like I forgot the copy/paste the relevant part there."}], "owner": {"reputation": 2641, "user_id": 1225786, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f0251000ccaade065dde90c38e9525e?s=128&d=identicon&r=PG", "display_name": "Christophe De Troyer", "link": "https://stackoverflow.com/users/1225786/christophe-de-troyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461490984, "creation_date": 1461446500, "last_edit_date": 1461490984, "question_id": 36816589, "link": "https://stackoverflow.com/questions/36816589/happy-precedence-function-definition-and-variable", "title": "Happy precedence function definition and variable", "body": "<p>I have been struggling to remove all s/r conflicts from my parser today. I managed to remove all of them but a single one. </p>\n\n<p>The syntax of my language should be haskell-like. And instead of a <code>main</code>, I have a top level expression which is the entry.</p>\n\n<p>The parser is shown below. I have also added an excerpt from the <code>Parser.info</code> file that Happy generates in which it describes the shift/reduce conflicts.</p>\n\n<p>As far as I can tell, the problem is that once the parser has encountered a <code>varname</code> for a function definition it can take two branches. It can either assume that there are more <code>varname</code>s to come because it is currently parsing a function definition (which has one or more parameters), or it can stop parsing it as a variable expression. The possible <code>varname</code> after that is then just another expression.</p>\n\n<p>I have played around with <code>%prec</code> rules and nothing seemed to help.</p>\n\n<p>My first reasoning was that, given that the parser wants to shift for a function definition, I can give that rule precedence. I also tried adding precedence to the <code>=</code> operator (for function definition) such that I could put it under the function definition's precedence but that did not work either.  My guess is that I don't fully understand how parsers work. Any pointers are greatly appreciated.</p>\n\n<p>A small side-note, the default behaviour - what I think is thus a shift - is the desired behaviour as well. </p>\n\n<pre><code>state 25 contains 1 shift/reduce conflicts.\n\n...\n\nState 25\n\n    Definition -&gt; varname . ':' ':' Type                (rule 7)\n    Definition -&gt; varname . FunctionParameters '=' Exp bl    (rule 8)\n    Atom -&gt; varname .                                   (rule 20)\n\n    '('            reduce using rule 20\n    '&lt;'            reduce using rule 20\n    '&gt;'            reduce using rule 20\n    '/'            reduce using rule 20\n    '*'            reduce using rule 20\n    '-'            reduce using rule 20\n    '+'            reduce using rule 20\n    \"eq?\"          reduce using rule 20\n    number         reduce using rule 20\n    ':'            shift, and enter state 27\n    varname        shift, and enter state 28\n            (reduce using rule 20)\n\n    %eof           reduce using rule 20\n\n    FunctionParametersgoto state 26\n</code></pre>\n\n<h3>Parser</h3>\n\n<pre><code>%nonassoc PARS\n%nonassoc VAR\n%%\nProgram\n : Definitions Exp { Program $1 $2 }\n | Exp             { Program [] $1 }\n\n\nDefinitions\n : Definitions Definition { ($1 ++ [$2]) }\n | Definition             { [$1]         }\n\n\nDefinition\n : type upsym '=' Type                   { TypeDef $2 $4  }\n | varname ':' ':' Type                  { FTypeDef $1 $4 }\n | varname FunctionParameters '=' Exp bl { FDef $1 $2 $4  }\n\n\nFunctionParameters\n : FunctionParameters varname %prec PARS { $1 ++ [$2] }\n | varname                    { [$1]    }\n\n\n\nExp\n : let varname '=' Exp \"in\" Exp { Let $2 $4 $6  }\n | if Exp then Exp else Exp     { If $2 $4 $6   }\n | \"Lam\" varname \"-&gt;\" Exp       { Abs $2 $4     }\n | Form                         { $1            }\n\n\nForm\n : Juxt { $1 }\n\n\nJuxt\n : Juxt Atom { App $1 $2 }\n | Atom      { $1        }\n\n\nAtom\n : '(' Exp ')'         { $2                }\n | number              { Value $ Number $1 }\n | varname %prec VAR   { Var $1            }\n | Binfs               { Value $ Binf $1   }\n\n\nBinfs\n : \"eq?\"    { BinfEqual }\n | '/'      { BinfDiv   }\n | '*'      { BinfTimes }\n | '+'      { BinfPlus  }\n | '-'      { BinfMinus }\n | '&gt;'      { BinfGT    }\n | '&lt;'      { BinfLT    }\n</code></pre>\n"}, {"tags": ["haskell", "dictionary", "haskell-lens"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461521632, "post_id": 36815529, "comment_id": 61224994, "body": "Is there a reason you&#39;re using <code>data</code> instead of <code>newtype</code> for this?"}, {"owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461584099, "post_id": 36815529, "comment_id": 61248699, "body": "Yes, for better readability, it&#39;s extracted from a larger piece of code where I use more fields."}], "answers": [{"comments": [{"owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "edited": false, "score": 0, "creation_date": 1461441729, "post_id": 36815715, "comment_id": 61204028, "body": "Thank you for reply. However, I am still getting a similar compile error message when I try to compile your code. What version of ghc/lens should I use for this to work? <code>Couldn&#39;t match type \u2018IxValue (Map.Map String MyLabel)\u2019 with \u2018MyLabel\u2019</code> ... <code>Couldn&#39;t match expected type \u2018Index (Map.Map String MyLabel) with actual type \u2018[Char]\u2019 </code>"}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "edited": false, "score": 0, "creation_date": 1461443289, "post_id": 36815715, "comment_id": 61204584, "body": "GHC 7.10, latest lens"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 6, "last_activity_date": 1461441388, "creation_date": 1461441388, "answer_id": 36815715, "question_id": 36815529, "link": "https://stackoverflow.com/questions/36815529/how-to-set-value-in-a-nested-map-using-lens/36815715#36815715", "title": "How to set value in a nested Map using Lens", "body": "<p>Try this on for size:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule Main where\n\nimport qualified Data.Map.Strict as Map\nimport Control.Lens\n\ndata MyLabel =\n  MyLabel { _label :: String } deriving (Show, Eq, Ord)\n\ndata MyMap =\n  MyMap { _vals :: Map.Map String MyLabel } deriving (Show, Eq, Ord)\n\nmakeLenses ''MyLabel\nmakeLenses ''MyMap\n\nsample :: MyMap\nsample =\n  MyMap (Map.fromList [(\"foo\", MyLabel \"bar\")])\n\nmain :: IO ()\nmain =\n  print (sample &amp; (vals . at \"foo\" . _Just . label .~ \"quux\"))\n</code></pre>\n\n\n\n<p>Remember that, when setting, you're trying to build a function of type <code>MyMap -&gt; MyMap</code>. The way you do that is by chaining a bunch of optics together (<code>vals . at \"foo\" . _Just . label</code>) and then choosing a setter operation (<code>.~</code>). You can't mix and match a getter operation like <code>^.</code> with a setter operation like <code>.~</code>! So every setter more or less looks like this:</p>\n\n<pre><code>foo' = (optic1 . optic2 . optic3 . optic4) .~ value $ foo\n--     _________this has type Foo -&gt; Foo___________\n</code></pre>\n\n<p>And to improve readability we use <code>&amp;</code>, the flipped version of <code>$</code>:</p>\n\n<pre><code>foo' = foo &amp; (optic1 . optic2 . optic3 . optic4) .~ value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "is_accepted": false, "score": -1, "last_activity_date": 1461751173, "creation_date": 1461751173, "answer_id": 36886496, "question_id": 36815529, "link": "https://stackoverflow.com/questions/36815529/how-to-set-value-in-a-nested-map-using-lens/36886496#36886496", "title": "How to set value in a nested Map using Lens", "body": "<p>The problem was actually caused by cabal hell and cleaning up <code>~/.ghc</code> directory was necessary to make it work.</p>\n"}], "owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "accepted_answer_id": 36815715, "answer_count": 2, "score": 2, "last_activity_date": 1461751173, "creation_date": 1461440392, "last_edit_date": 1461441122, "question_id": 36815529, "link": "https://stackoverflow.com/questions/36815529/how-to-set-value-in-a-nested-map-using-lens", "title": "How to set value in a nested Map using Lens", "body": "<p>I have the following program:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport qualified Data.Map.Strict as Map\nimport Control.Lens\n\ndata MyLabel = MyLabel { _label :: String } deriving (Show, Eq, Ord)\ndata MyMap = MyMap { _vals :: Map.Map String MyLabel } deriving (Show, Eq, Ord)\nmakeLenses ''MyLabel\nmakeLenses ''MyMap\n\nsample :: MyMap\nsample = MyMap { _vals = Map.fromList [(\"foo\", MyLabel \"bar\")] }\n</code></pre>\n\n<p>Now I'd like to know how to do a transformation <code>f</code> using lenses such that:</p>\n\n<pre><code>f sample \"quux\" == MyMap { _vals = Map.fromList [(\"foo\", MyLabel \"quux\")] }\n</code></pre>\n\n<p>I learned that the function <code>at</code> from Lens library should be used to modify Maps, so I was trying to do things like this:</p>\n\n<pre><code>sample ^. vals &amp; at \"foo\" . label .~ Just \"quux\"\n</code></pre>\n\n<p>But that produces an error message which is not very understandable for me. What is the right way to do this?</p>\n"}, {"tags": ["date", "parsing", "datetime", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "is_accepted": false, "score": 1, "last_activity_date": 1461447802, "last_edit_date": 1461447802, "creation_date": 1461446950, "answer_id": 36816659, "question_id": 36815422, "link": "https://stackoverflow.com/questions/36815422/parse-an-iso-formatted-date-string-into-its-components/36816659#36816659", "title": "Parse an ISO formatted date string into its components", "body": "<p>Here is one answer:</p>\n\n<pre><code>data IsoDate  = IsoDate {\n    year :: Int\n    , month :: Int\n    , day :: Int\n} deriving (Show)\n\nparseIsoDate :: String -&gt; IsoDate\nparseIsoDate dateString = \n    IsoDate year month day\n    where \n        timeFromString = readTime defaultTimeLocale \"%Y %m %d\" dateString :: UTCTime\n        year = read (formatTime defaultTimeLocale \"%0Y\" timeFromString) :: Int\n        month = read (formatTime defaultTimeLocale \"%m\" timeFromString) :: Int\n        day = read (formatTime defaultTimeLocale \"%d\" timeFromString) :: Int\n</code></pre>\n\n<p>Which refactors to:</p>\n\n<pre><code>data DatePart = Year | Month | Day deriving(Enum, Show)\n\ndatePart :: DatePart -&gt;  UTCTime -&gt; Int\ndatePart Year utcTime = read (formatTime defaultTimeLocale \"%0Y\" utcTime)\ndatePart Month utcTime = read (formatTime defaultTimeLocale \"%m\" utcTime)\ndatePart Day utcTime = read (formatTime defaultTimeLocale \"%d\" utcTime)\n\nparseIsoDate :: String -&gt; IsoDate\nparseIsoDate dateString = \n    IsoDate year month day\n    where \n        timeFromString = readTime defaultTimeLocale \"%Y %m %d\" dateString :: UTCTime\n        year = datePart Year timeFromString\n        month = datePart Month timeFromString\n        day = datePart Day timeFromString\n</code></pre>\n\n<p>in usage</p>\n\n<pre><code> parseIsoDate \"2012 12 02\"\n</code></pre>\n\n<p>THat data isn't in ISO format, still working to get it to read \"2012-12-01\".  Also still looking for the preferred way of getting this to work within the language.</p>\n\n<hr>\n\n<p>update  the dashes are trivial change \"%Y %m %d\" to \"%Y-%m-%d\"  I thought I had tried that eariler, but it must have been with other code in  error.</p>\n"}, {"comments": [{"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1461448028, "post_id": 36816774, "comment_id": 61206068, "body": "Cool,  I went with UtcTime because of the example I found started there. Day makes more sense (there is no time component to our data).  %F is nice (<a href=\"https://hackage.haskell.org/package/time-1.6/docs/Data-Time-Format.html#t:FormatTime\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/time-1.6/docs/&hellip;</a>).  I haven&#39;t got to the &quot;do&quot; syntax yet, although I have seen it.  Does it just enable syntatic sugar with Monads? (I will have to skip ahead),"}, {"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1461448120, "post_id": 36816774, "comment_id": 61206094, "body": "Also - I agree on the Maybe  - Just (no pun intended) was focusing on getting the other syntax right."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1461448221, "post_id": 36816774, "comment_id": 61206122, "body": "&quot;Do-syntax&quot; is usually only used in the context of monads - but don&#39;t be afraid it&#39;s way less scary than you think it is. There is an extension in ghc called  <code>ApplicativeDo</code> which enables you to use this syntax in an <code>Applicative</code> context which is slightly more general but less powerful - and also not as scary as it sounds."}, {"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1461449154, "post_id": 36816774, "comment_id": 61206402, "body": "Thanks - I have been coding exclusively in JS over the past 4 years, so jumping back into static languages after a long layoff.  Prior I was coding in F# and have been working in a functional style in JS - but I feel like I need to learn Haskell (curiosity).  My pet project is building a DSL for my business domain, which would be a great fit for F#, and I think there are many similar constructs in Haskell.  Anyhow focusing getting the Abstract Syntax Tree up and running first, then parsing into it from a grammar will be the last bit"}, {"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1461456160, "post_id": 36816774, "comment_id": 61208006, "body": "I think I may be missing something - I pasted your code and am getting the following error: &quot;parse error on input `let&#39;&quot; - i think the spacing looks OK..."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1461456625, "post_id": 36816774, "comment_id": 61208102, "body": "I removed the name shadowing - sorry I didn&#39;t try out the code, I modified it while typing it."}, {"owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "edited": false, "score": 0, "creation_date": 1461503546, "post_id": 36816774, "comment_id": 61218459, "body": "OK - I needed to update haskell to use parseTimeM (I installed about 12 months ago and hadn&#39;t ahd the opportuntiy to start learning until today) and was able to get your solution to work in its entirety.  I dont understand the spacing -- particualrly the &quot;do&quot;...  But it is working.  Thank you"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1461457189, "last_edit_date": 1461457189, "creation_date": 1461447638, "answer_id": 36816774, "question_id": 36815422, "link": "https://stackoverflow.com/questions/36815422/parse-an-iso-formatted-date-string-into-its-components/36816774#36816774", "title": "Parse an ISO formatted date string into its components", "body": "<p>I think the stuff you need to do is</p>\n\n<pre><code>parseIsoDate :: String -&gt; Maybe IsoDate\n</code></pre>\n\n<p>because not every <code>String</code> you supply will be a valid date. Implementing it you already got most of the ingredients right, but I don't think yo uwant to parse a <code>UTCTime</code> but a <code>Day</code> which can be converted into your data-structure.</p>\n\n<pre><code>import Data.Time\n\ndata IsoDate = ...\n\nparseIsoDate :: String -&gt; Maybe IsoDate\nparseIsoDate str = do julianDay &lt;- parse str\n                      let (y, m, d) = toGregorian julianDay\n                      return $ IsoDate (fromIntegral y) m d\n\n  where parse:: String -&gt; Maybe Day\n        parse = parseTimeM True defaultTimeLocale \"%F\"\n</code></pre>\n\n<p>now a bit explaining and advice:</p>\n\n<ol>\n<li><p>I would change the datatype <code>IsoDate</code> to using <code>Integer</code> for years - as they are possibly big (at least bigger than <code>Int</code> - just look at the age of our universe). this is also the choice of the result of <code>toGregorian</code> which converts a <code>Day -&gt; (Integer, Int, Int)</code>, if not you have to convert the <code>Integer</code> produced by it to an <code>Int</code> with the help of <code>fromIntegral</code> as you see in my example.</p></li>\n<li><p>the syntax I use is called <strong>do-syntax</strong> for <code>Maybe</code>, which is a handy thing in the first line I extract a value inside the monad and <strong>bind</strong> it to a name - <code>julianDay</code>.\nThen I transform the value to a Gregorian Day.\nAnd then <code>return</code> it into the <code>Maybe</code> again. If the first step fails and produces a <code>Nothing</code>, i.e. the <code>String</code> is just gobbledygook, then none of the other operations are done and your program finishes without doing any work (that's the power of lazy evaluation).</p></li>\n</ol>\n\n<h2>update</h2>\n\n<p>If you are using the <code>RecordWildCards</code> extension, and the fact that maybe is a <code>Functor</code> you can do the following</p>\n\n<pre><code>{-# LANGUAGE Record\nmodule MyLib\nimport Data.Time\n\ndata IsoDate = IsoDate { year :: Integer\n                       , month :: Int\n                       , day :: Int}\n              deriving (Show)\n\nparseIsoDate :: String -&gt; Maybe IsoDate\nparseIsoDate str = do (year, month, day) &lt;- toGregorian &lt;$&gt; parse str\n                      return IsoDate{..}\n\n  where parse:: String -&gt; Maybe Day\n        parse = parseTimeM True defaultTimeLocale \"%F\"\n</code></pre>\n"}], "owner": {"reputation": 6181, "user_id": 301774, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c2979a6bc45369fd599215a1e4737f9e?s=128&d=identicon&r=PG", "display_name": "akaphenom", "link": "https://stackoverflow.com/users/301774/akaphenom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 36816774, "answer_count": 2, "score": 1, "last_activity_date": 1461487313, "creation_date": 1461439657, "last_edit_date": 1495541260, "question_id": 36815422, "link": "https://stackoverflow.com/questions/36815422/parse-an-iso-formatted-date-string-into-its-components", "title": "Parse an ISO formatted date string into its components", "body": "<p>I am new to haskell and wanted to approach learngin by attempting bits of a real world application.  One of the components is being able to parse dates in ISO formatted strings into it's components.  <a href=\"https://stackoverflow.com/questions/4174372/haskell-date-parsing-and-formatting\">This Stack Overflow post</a> helped me get started, but it isn't enough and I am quite confused.</p>\n\n<p>I have the following code: </p>\n\n<pre><code>import System.Locale\nimport Data.Time\nimport Data.Time.Format\n\ndata IsoDate  = IsoDate {\n    year :: Int\n    , month :: Int\n    , day :: Int\n} deriving (Show)\n\nparseIsoDate :: String -&gt; IsoDate\nparseIsoDate dateString = \n    IsoDate year month day\n    where \n        timeFromString = readTime defaultTimeLocale \"%Y %m %d\" dateString :: UTCTime\n        year = 2013\n        month = 10\n        day = 31\n</code></pre>\n\n<p>Which is fine and dandy for Halloween 2013.  I have attmepted to rewrite year as:</p>\n\n<pre><code>year = formatTime defaultTimeLocale \"%y\" timeFromString\n</code></pre>\n\n<p>which I knew would fail (can't construct my <code>IsoDate</code> type with a <code>String</code>). And then attempted to read the string into an Int.  </p>\n\n<pre><code>year = read (formatTime defaultTimeLocale \"%y\" timeFromString)\n</code></pre>\n\n<p>with the following response:</p>\n\n<pre><code> parseIsoDate \"2012-12-23\"\n IsoDate {year = *** Exception: readsTime: bad input \"2012-12-23\"\n</code></pre>\n\n<p>There were a couple other attemps at getting this converted - but what I posted was the most rational attempt, o I am not going to post the other attempts.</p>\n\n<p>I wanted to figure out how to work with my current code (as I am trying to learn the constructs), in addition (since date parsing is essential) I would like to know the better way (perhaps the most idiomatic) to handle this in Haskell.  </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 6, "last_activity_date": 1461432946, "creation_date": 1461432946, "answer_id": 36814175, "question_id": 36814124, "link": "https://stackoverflow.com/questions/36814124/newtype-can-someone-explain-me-how-this-code-works/36814175#36814175", "title": "newtype: Can someone explain me, how this code works?", "body": "<p>Since <code>PositiveInteger</code> is now an instance of <code>Num</code>, <code>10</code> (whose most general type is <code>Num a =&gt; a</code>) can have the type <code>PositiveInteger</code>, making it a valid argument for <code>fromPositiveInteger</code>.</p>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461432946, "creation_date": 1461432640, "question_id": 36814124, "link": "https://stackoverflow.com/questions/36814124/newtype-can-someone-explain-me-how-this-code-works", "title": "newtype: Can someone explain me, how this code works?", "body": "<p>I defined new type like \"PositiveInteger\" like below.</p>\n\n<pre><code>newtype PositiveInteger = PositiveInteger Integer deriving Show\n\nfromPositiveInteger :: PositiveInteger -&gt; Integer\nfromPositiveInteger (PositiveInteger i) = i\n\ntoPositiveInteger :: Integer -&gt; PositiveInteger\ntoPositiveInteger x\n    | (x &lt; 0) = error \"Not applicable to negative numbers\"\n    | otherwise = PositiveInteger x\n</code></pre>\n\n<p>When i execute the statement 'fromPositiveInteger (10)', i am getting following error. Which is absolutely fine.</p>\n\n<pre><code>*Main&gt; fromPositiveInteger (10)\n\n&lt;interactive&gt;:7:22:\n    No instance for (Num PositiveInteger) arising from the literal \u201810\u2019\n    In the first argument of \u2018fromPositiveInteger\u2019, namely \u2018(10)\u2019\n    In the expression: fromPositiveInteger (10)\n    In an equation for \u2018it\u2019: it = fromPositiveInteger (10)\n</code></pre>\n\n<p>Suppose, if i updated my code like below. the statement 'fromPositiveInteger 10' works without any error. How can this happened?</p>\n\n<pre><code>newtype PositiveInteger = PositiveInteger Integer deriving Show\n\nfromPositiveInteger :: PositiveInteger -&gt; Integer\nfromPositiveInteger (PositiveInteger i) = i\n\ntoPositiveInteger :: Integer -&gt; PositiveInteger\ntoPositiveInteger x\n    | (x &lt; 0) = error \"Not applicable to negative numbers\"\n    | otherwise = PositiveInteger x\n\ninstance Num PositiveInteger where\n    fromInteger         = toPositiveInteger\n    x + y               = toPositiveInteger (fromPositiveInteger x + fromPositiveInteger y)\n    x - y               = let r = fromPositiveInteger x - fromPositiveInteger y in\n                            if r &lt; 0 then error \"Unnatural subtraction\"\n                                     else toPositiveInteger r\n    x * y               = toPositiveInteger (fromPositiveInteger x * fromPositiveInteger y)\n\n*Main&gt; fromPositiveInteger (PositiveInteger 10)\n10\n*Main&gt; fromPositiveInteger 10\n10\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1461432069, "post_id": 36813735, "comment_id": 61200739, "body": "This seems like it could be an issue arising from a misconfigured <code>$PATH</code> environment variable."}, {"owner": {"reputation": 159, "user_id": 6058497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/971a52457529da0152bbb4f6b8dfb77f?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Lorenzen", "link": "https://stackoverflow.com/users/6058497/anton-lorenzen"}, "reply_to_user": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1461432547, "post_id": 36813735, "comment_id": 61200934, "body": "@JulesMazur: Under user <code>me</code>: /home/me/.local/bin:/home/me/.local/bin:/usr/local/bin:/usr/&zwnj;&#8203;bin:/bin:/usr/local/&zwnj;&#8203;sbin:/usr/sbin:/home&zwnj;&#8203;/me/.cabal/bin:/home&zwnj;&#8203;/me/.local/bin:/home&zwnj;&#8203;/me/bin"}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1461436489, "post_id": 36813735, "comment_id": 61202352, "body": "I can&#39;t reproduce this with your repo. What&#39;s the command you got that error for? What&#39;s your <code>stack --version</code>? BTW you added your <code>.stack-work</code> to your repo\u2026"}, {"owner": {"reputation": 159, "user_id": 6058497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/971a52457529da0152bbb4f6b8dfb77f?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Lorenzen", "link": "https://stackoverflow.com/users/6058497/anton-lorenzen"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1461438836, "post_id": 36813735, "comment_id": 61203156, "body": "@sjakobi The command is <code>stack build</code>, the version is 1.0.4.3, Git revision db1afb275ebd64016e8ef0db122f0f03da9e5906 (3242 commits) x86_64"}, {"owner": {"reputation": 159, "user_id": 6058497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/971a52457529da0152bbb4f6b8dfb77f?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Lorenzen", "link": "https://stackoverflow.com/users/6058497/anton-lorenzen"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1461439768, "post_id": 36813735, "comment_id": 61203446, "body": "@sjakobi, I wanted to publish the repo, when I was done, but now.., anyway: <a href=\"https://github.com/anfelor/ghci-all/blob/master/.stack-work/logs/alex-3.1.7.log\" rel=\"nofollow noreferrer\">Alex</a> for example compiled without errors, but is in the list above."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1461440546, "post_id": 36813735, "comment_id": 61203682, "body": "Can you retry with the HEAD version of stack: <code>stack upgrade --git</code>? If that doesn&#39;t help, please open an issue at <a href=\"https://github.com/commercialhaskell/stack/issues\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 7, "last_activity_date": 1461449688, "creation_date": 1461449688, "answer_id": 36817068, "question_id": 36813735, "link": "https://stackoverflow.com/questions/36813735/stack-build-fails-due-to-missing-dependencies/36817068#36817068", "title": "Stack build fails due to missing dependencies", "body": "<p>It's a confusing error message from Cabal. You're not able to add an executable only package to build-depends. You'll need to filter out projects that do not have a library.</p>\n"}], "owner": {"reputation": 159, "user_id": 6058497, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/971a52457529da0152bbb4f6b8dfb77f?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Lorenzen", "link": "https://stackoverflow.com/users/6058497/anton-lorenzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 36817068, "answer_count": 1, "score": 3, "last_activity_date": 1461449688, "creation_date": 1461430579, "last_edit_date": 1461430962, "question_id": 36813735, "link": "https://stackoverflow.com/questions/36813735/stack-build-fails-due-to-missing-dependencies", "title": "Stack build fails due to missing dependencies", "body": "<p>I am trying to make something like acme-everything for stackage called <a href=\"https://github.com/anfelor/ghci-all\" rel=\"nofollow\"><code>ghci-all</code></a>, e. g.  a stack project, where <code>stack ghci</code> gives you access to all of stackage. I added all the packages in the latest snashot to my .cabal file, and after working through all the foreign dependencies, I got the strange error:</p>\n\n<pre><code>setup-Simple-Cabal-1.22.5.0-ghc-7.10.3: At least the following dependencies\nare missing:\nEbnf2ps -any,\nTaxonomyTools -any,\nYampaSynth -any,\nalex -any,\nangel -any,\nbumper -any,\nc2hs -any,\ncabal-install -any,\ncabal-rpm -any,\ncabal-sort -any,\ncabal-src -any,\ncalculator -any,\nclash-ghc -any,\nclckwrks-cli -any,\ngipeda -any,\ngit-fmt -any,\ngtk2hs-buildtools -any,\nhackage-whatsnew -any,\nhaddocset -any,\nhappy -any,\nhdevtools -any,\nhledger-interest -any,\nhledger-ui -any,\nhopenpgp-tools -any,\nhspec-setup -any,\nip6addr -any,\nlentil -any,\nlhs2tex -any,\nmoesocks -any,\nmole -any,\nresolve-trivial-conflicts -any,\nsandman -any,\nservius -any,\nshelltestrunner -any,\nskeletons -any,\ntellbot -any,\ntls-debug -any,\ntttool -any,\nyackage -any,\nyesod-bin -any\n</code></pre>\n\n<p>These dependencies are listed in the file though (and should have been installed). Did I miss something important?</p>\n"}, {"tags": ["haskell", "z3", "boolean-logic", "liquid-haskell"], "comments": [{"owner": {"reputation": 7851, "user_id": 1096362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5eed9d8781d5278da6090e0aedf9e32?s=128&d=identicon&r=PG", "display_name": "Nikolaj Bjorner", "link": "https://stackoverflow.com/users/1096362/nikolaj-bjorner"}, "edited": false, "score": 1, "creation_date": 1461431161, "post_id": 36813497, "comment_id": 61200383, "body": "I wonder, perhaps this is more appropriately a liquid Haskell question. But then, these are perhaps the closest tags currently available on stackoverflow."}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "reply_to_user": {"reputation": 7851, "user_id": 1096362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5eed9d8781d5278da6090e0aedf9e32?s=128&d=identicon&r=PG", "display_name": "Nikolaj Bjorner", "link": "https://stackoverflow.com/users/1096362/nikolaj-bjorner"}, "edited": false, "score": 0, "creation_date": 1461431461, "post_id": 36813497, "comment_id": 61200490, "body": "Unfortunately there is no liquid-haskell tag, and I need more reputation to create one. I hope those convey the idea."}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "reply_to_user": {"reputation": 7851, "user_id": 1096362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5eed9d8781d5278da6090e0aedf9e32?s=128&d=identicon&r=PG", "display_name": "Nikolaj Bjorner", "link": "https://stackoverflow.com/users/1096362/nikolaj-bjorner"}, "edited": false, "score": 0, "creation_date": 1461431959, "post_id": 36813497, "comment_id": 61200700, "body": "dfeuer: thanks for the tag!"}], "answers": [{"comments": [{"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1461438598, "post_id": 36814524, "comment_id": 61203073, "body": "Indeed, there was a line missing: <code>{-@ (&lt;=&gt;) :: p:Bool -&gt; q:Bool -&gt; {v:Bool | Prop v &lt;=&gt; (Prop p &lt;=&gt; Prop q)} @-} </code>. I assumed it was a LiquidHaskell default. Now it blows my mind that such elementary function is also defined by the user, pretty much in the same way most haskell &quot;keywords&quot; aren&#39;t keywords, actually. Thanks for the answer!"}, {"owner": {"reputation": 754, "user_id": 2140910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CtvpI.jpg?s=128&g=1", "display_name": "Bjartur Thorlacius", "link": "https://stackoverflow.com/users/2140910/bjartur-thorlacius"}, "edited": false, "score": 0, "creation_date": 1489396217, "post_id": 36814524, "comment_id": 72635290, "body": "Am I the only one getting an error when I click the &quot;Check&quot; button on <a href=\"http://goto.ucsd.edu:8090/index.html#?demo=permalink%2F1461434240_7574.hs\" rel=\"nofollow noreferrer\">goto.ucsd.edu:8090/&hellip;</a> ?"}], "tags": [], "owner": {"reputation": 2381, "user_id": 586750, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/16b87da510d278999c892cdbdd55c1b6?s=128&d=identicon&r=PG", "display_name": "Eric Seidel", "link": "https://stackoverflow.com/users/586750/eric-seidel"}, "is_accepted": true, "score": 8, "last_activity_date": 1461434740, "creation_date": 1461434740, "answer_id": 36814524, "question_id": 36813497, "link": "https://stackoverflow.com/questions/36813497/liquidhaskell-failing-demorgans-law/36814524#36814524", "title": "LiquidHaskell: failing DeMorgan&#39;s law", "body": "<p>LiquidHaskell cannot prove your program safe because it does not have a strong enough type for <code>(&lt;=&gt;)</code>. We do infer types for functions, but the inference is based on the other type signatures in the program. Specifically, we need to figure out that</p>\n\n<pre><code>{-@ (&lt;=&gt;) :: p:Bool -&gt; q:Bool -&gt; {v:Bool | Prop v &lt;=&gt; (Prop p &lt;=&gt; Prop q)} @-}\n</code></pre>\n\n<p>(The <code>Prop</code> syntax is how we lift a Haskell <code>Bool</code> to an SMT boolean.)</p>\n\n<p>In order for for LiquidHaskell to infer this type, it would need to see a predicate <code>Prop v &lt;=&gt; (Prop p &lt;=&gt; Prop q)</code> somewhere in another type signature (for some <code>v</code>, <code>p</code>, and <code>q</code>). This fragment doesn't appear anywhere, so we need to provide the signature explicitly.</p>\n\n<p>It's an unfortunate limitation of LiquidHaskell, but is crucial for retaining decidability.</p>\n\n<p>PS: Here's a link to a working version of your example.\n<a href=\"http://goto.ucsd.edu:8090/index.html#?demo=permalink%2F1461434240_7574.hs\">http://goto.ucsd.edu:8090/index.html#?demo=permalink%2F1461434240_7574.hs</a></p>\n"}], "owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 36814524, "answer_count": 1, "score": 5, "last_activity_date": 1461438226, "creation_date": 1461429500, "last_edit_date": 1461438226, "question_id": 36813497, "link": "https://stackoverflow.com/questions/36813497/liquidhaskell-failing-demorgans-law", "title": "LiquidHaskell: failing DeMorgan&#39;s law", "body": "<p>I am having troubles proving the following law with LiquidHaskell:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LHqzn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LHqzn.png\" alt=\"DeMorgan&#39;s law\"></a></p>\n\n<p>It is known as (one of) DeMorgan's law, and simply states that the negation of <code>or</code>ing two values must be the same as <code>and</code>ing the negation of each. It's been proven for a long time, and is an example in LiquidHaskell's <a href=\"https://ucsd-progsys.github.io/liquidhaskell-tutorial/02-logic.html\" rel=\"nofollow noreferrer\">tutorial</a>. I am following along in the tutorial, but fail to get the following code to pass:</p>\n\n<pre><code>-- Test.hs\nmodule Main where\n\nmain :: IO ()\nmain = return ()\n\n(==&gt;) :: Bool -&gt; Bool -&gt; Bool\nFalse ==&gt; False = True\nFalse ==&gt; True  = True\nTrue  ==&gt; True  = True\nTrue  ==&gt; False = False\n\n(&lt;=&gt;)  :: Bool -&gt; Bool -&gt; Bool\nFalse &lt;=&gt; False = True\nFalse &lt;=&gt; True  = False\nTrue  &lt;=&gt; True  = True\nTrue  &lt;=&gt; False = False\n\n{-@ type TRUE  = {v:Bool | Prop v}       @-}\n{-@ type FALSE = {v:Bool | not (Prop v)} @-}\n\n{-@ deMorgan :: Bool -&gt; Bool -&gt; TRUE @-}\ndeMorgan :: Bool -&gt; Bool -&gt; Bool\ndeMorgan a b = not (a || b) &lt;=&gt; (not a &amp;&amp; not b)\n</code></pre>\n\n<p>When running <code>liquid Test.hs</code>, I get the following output:</p>\n\n<pre><code>LiquidHaskell Copyright 2009-15 Regents of the University of California. All Rights Reserved.\n\n\n**** DONE:  Parsed All Specifications ******************************************\n\n\n**** DONE:  Loaded Targets *****************************************************\n\n\n**** DONE:  Extracted Core using GHC *******************************************\n\nWorking   0%     [.................................................................]\nDone solving.\n\n**** DONE:  solve **************************************************************\n\n\n**** DONE:  annotate ***********************************************************\n\n\n**** RESULT: UNSAFE ************************************************************\n\n\n Test.hs:23:16-48: Error: Liquid Type Mismatch\n\n 23 | deMorgan a b = not (a || b) &lt;=&gt; (not a &amp;&amp; not b)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n   Inferred type\n     VV : Bool\n\n   not a subtype of Required type\n     VV : {VV : Bool | Prop VV}\n\n   In Context\n</code></pre>\n\n<p>Now I'm by no means a LiquidHaskell expert, but I'm pretty sure something must be wrong. I have convinced myself that the identity holds a few years ago, but to make sure I called the function with every possible input, and eventually ran</p>\n\n<pre><code>\u03bb: :l Test.hs \n\u03bb: import Test.QuickCheck\n\u03bb: quickCheck deMorgan \n&gt;&gt;&gt; +++ OK, passed 100 tests.\n</code></pre>\n\n<p>So I don't seem to have a typo in the Haskell code, the error must lie in the LiquidHaskell specification. It seems that LiquidHaskell cannot infer that the resulting <code>Bool</code> is strictly <code>TRUE</code>:</p>\n\n<pre><code>Inferred type\n  VV : Bool\n\nnot a subtype of Required type\n  VV : {VV : Bool | Prop VV}\n</code></pre>\n\n<p>What is my mistake here? Any help is appreciated! </p>\n\n<p>PS: I'm using the <code>z3</code> solver, and running GHC 7.10.3. LiquidHaskell version is <code>2009-15</code>.</p>\n"}, {"tags": ["haskell", "testing", "quickcheck"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461426429, "post_id": 36812882, "comment_id": 61198612, "body": "it&#39;s probably really hard (you could say it&#39;s very <i>lucky</i>) to generate a <code>validGraph</code> like this (especially when there are more edges) - it&#39;s probably better to generate nodes and then draw pairs of nodes from those to generate edges"}, {"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461428187, "post_id": 36812882, "comment_id": 61199297, "body": "The thing is those pairs need to be generated arbitrarily. How do i tell haskell to form random pairs?"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1461600625, "post_id": 36813725, "comment_id": 61260839, "body": "I see. However this brings me to the same problem.. Either it doesn&#39;t generate edges or, if i do it with something similar to what you sent me, it does but not in a way that my graph would be considered valid..."}, {"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1461601798, "post_id": 36813725, "comment_id": 61261471, "body": "btw, continuing with what i commented previously: if i do it with what you sent me it doesn&#39;t generate valid graphs because it keeps using repeated nodes as &quot;source&quot; to several Edges. A valid graph can&#39;t have a node that&#39;s source to more then one Edge."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1461607398, "post_id": 36813725, "comment_id": 61264775, "body": "@ohiohai That&#39;s not the criteria for being valid you specified in the question. If a node can&#39;t be the source to more than one edge you can generate 0 or 1 edges for each node instead of generating a bunch of arbitrary edges. It also suggests that your graph data type is wrong, since you could represent the graph as <code>Map k (Maybe k)</code> and have every graph always be valid."}, {"owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "edited": false, "score": 0, "creation_date": 1461610269, "post_id": 36813725, "comment_id": 61266401, "body": "Ah crap. Forgot to put both criteria in the question, sorry. Gonna edit it."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 3, "last_activity_date": 1461608850, "last_edit_date": 1461608850, "creation_date": 1461430549, "answer_id": 36813725, "question_id": 36812882, "link": "https://stackoverflow.com/questions/36812882/generate-edges-from-an-arbitrary-list-of-nodes/36813725#36813725", "title": "Generate edges from an Arbitrary list of nodes", "body": "<p>An <a href=\"https://hackage.haskell.org/package/QuickCheck/docs/Test-QuickCheck-Arbitrary.html#v:arbitrary\" rel=\"nofollow\"><code>arbitrary</code></a> value is a value in the <a href=\"https://hackage.haskell.org/package/QuickCheck/docs/Test-QuickCheck-Gen.html#t:Gen\" rel=\"nofollow\"><code>Gen</code></a> monad. You can do more in this monad than just combine <code>arbitrary</code> values together. You can perform any of the other <code>Gen</code> operations including <a href=\"https://hackage.haskell.org/package/QuickCheck/docs/Test-QuickCheck-Gen.html#v:choose\" rel=\"nofollow\"><code>choose</code></a>:</p>\n\n<blockquote>\n<pre><code>choose :: Random a =&gt; (a, a) -&gt; Gen a\n</code></pre>\n  \n  <p>Generates a random element in the given inclusive range.</p>\n</blockquote>\n\n<p>You can use <code>choose</code> to generate other random values than just <code>arbitrary</code> ones.</p>\n\n<pre><code>instance (Ord v, Arbitrary v) =&gt; Arbitrary (Graph v) where\n    arbitrary = do\n        nodes &lt;- arbitrary\n        let\n            lNodes = toList nodes\n            numNodes = length lNodes\n            arbitraryEdge = do\n                source &lt;- elements lNodes\n                target &lt;- elements lNodes\n                return $ Edge {\n                    source = source,\n                    target = target\n                }\n        numEdges &lt;- choose (0, numNodes * numNodes)\n        lEdges &lt;- vectorOf numEdges arbitraryEdge\n        return $ Graph {nodes = nodes, edges = fromList lEdges}\n</code></pre>\n\n<p>This naive implementation isn't very efficient when generating large graphs. It could be a factor of number of nodes in the graph faster if it didn't need to scan the list for the generated values each time it uses <a href=\"https://hackage.haskell.org/package/QuickCheck/docs/Test-QuickCheck-Gen.html#v:elements\" rel=\"nofollow\"><code>elements</code></a></p>\n"}], "owner": {"reputation": 73, "user_id": 6244822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9f8b1d37890afc977113ea14ee1efa9a?s=128&d=identicon&r=PG&f=1", "display_name": "ohiohai", "link": "https://stackoverflow.com/users/6244822/ohiohai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 36813725, "answer_count": 1, "score": 1, "last_activity_date": 1461614149, "creation_date": 1461426206, "last_edit_date": 1461610348, "question_id": 36812882, "link": "https://stackoverflow.com/questions/36812882/generate-edges-from-an-arbitrary-list-of-nodes", "title": "Generate edges from an Arbitrary list of nodes", "body": "<pre><code>data Edge v = Edge {source :: v, target :: v}\n          deriving (Show,Eq,Ord)\n\ndata Graph v = Graph {nodes :: Set v, edges :: Set (Edge v)}\n           deriving Show\n\n\ninstance Arbitrary v =&gt; Arbitrary (Edge v) where\n    arbitrary = do s &lt;- arbitrary\n                   t &lt;- arbitrary\n                   return $ Edge {source = s, target = t}\n\ninstance (Ord v, Arbitrary v) =&gt; Arbitrary (Graph v) where\n    arbitrary = aux `suchThat` validGraph\n        where aux = do lNodes &lt;- arbitrary\n                       lEdges &lt;- arbitrary\n                       return $ Graph {nodes = fromList lNodes, edges = fromList lEdges}\n</code></pre>\n\n<p>I currently have this to generate my Graphs.\nHowever by using sample on ghci I noticed that it either doesn't generate edges or it generates a single one.\nIs it possible to control the number of edges generated?\nHow would I do it?</p>\n\n<p>EDIT: A Graph is considered valid when: \n1-The source and target nodes of an edge exist.\n2-A node can't be the source to more than one Edge.</p>\n"}, {"tags": ["haskell", "types", "ghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1461423013, "post_id": 36812242, "comment_id": 61197376, "body": "Well your signature already says it: calling <code>sortList</code> requires a <code>comparator</code> you did not provide..."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6244753"}, "is_accepted": false, "score": 1, "last_activity_date": 1461423111, "creation_date": 1461423111, "answer_id": 36812304, "question_id": 36812242, "link": "https://stackoverflow.com/questions/36812242/haskell-couldnt-match-expected-type-with-actual-type/36812304#36812304", "title": "Haskell &#39;Couldn&#39;t match expected type with actual type&#39;", "body": "<p>You are calling the function wrong, you need to pass it a comparator function. You just pass a list to the function.</p>\n"}, {"comments": [{"owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "reply_to_user": {"reputation": 315, "user_id": 4840044, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7906f7258ec035ac362ccbeb86bf2a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4840044/justin"}, "edited": false, "score": 0, "creation_date": 1461425556, "post_id": 36812405, "comment_id": 61198299, "body": "Have you read my comment? you need to pass a comparator method to your function. &#39;compare&#39; is that comparator you need.  For more read: <a href=\"http://zvon.org/other/haskell/Outputprelude/compare_f.html\" rel=\"nofollow noreferrer\">zvon.org/other/haskell/Outputprelude/compare_f.html</a>  and here: <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Ord.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.2.0/docs/Data-Ord.html</a>"}], "tags": [], "owner": {"reputation": 2710, "user_id": 4532326, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aeb4dabdec3bf43bba4a71124b0d67f7?s=128&d=identicon&r=PG&f=1", "display_name": "granmirupa", "link": "https://stackoverflow.com/users/4532326/granmirupa"}, "is_accepted": true, "score": 2, "last_activity_date": 1461425633, "last_edit_date": 1461425633, "creation_date": 1461423606, "answer_id": 36812405, "question_id": 36812242, "link": "https://stackoverflow.com/questions/36812242/haskell-couldnt-match-expected-type-with-actual-type/36812405#36812405", "title": "Haskell &#39;Couldn&#39;t match expected type with actual type&#39;", "body": "<p>Your function signature says:</p>\n\n<blockquote>\n  <p>\"sortList is a function that takes:\"</p>\n  \n  <ul>\n  <li>function (a -> a -> Ordering) that take two elements of type 'a' and returns an 'Ordering' [this is your comparator]</li>\n  <li>List of items 'a' ([a]) that you are passing it</li>\n  <li>Returns a list of items 'a' ([a])</li>\n  </ul>\n</blockquote>\n\n<p>Try call them in this way:</p>\n\n<pre><code>sortList compare [3,2,1]\n</code></pre>\n\n<p>For more read here:\n<a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Ord.html\" rel=\"nofollow\">https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Ord.html</a></p>\n\n<p>and here:\n<a href=\"http://zvon.org/other/haskell/Outputprelude/compare_f.html\" rel=\"nofollow\">http://zvon.org/other/haskell/Outputprelude/compare_f.html</a></p>\n"}], "owner": {"reputation": 315, "user_id": 4840044, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7906f7258ec035ac362ccbeb86bf2a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/4840044/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "accepted_answer_id": 36812405, "answer_count": 2, "score": 0, "last_activity_date": 1461425633, "creation_date": 1461422646, "question_id": 36812242, "link": "https://stackoverflow.com/questions/36812242/haskell-couldnt-match-expected-type-with-actual-type", "title": "Haskell &#39;Couldn&#39;t match expected type with actual type&#39;", "body": "<p>I have been going through the Seven Languages in Seven Weeks book and I'm working with Haskell. </p>\n\n<p><strong>I am struggling with the problem:</strong> </p>\n\n<p><em>Write a sort that takes a list and a function that compares its two arguments and then returns a sorted list.</em></p>\n\n<p>I searched online for help and found a solution but I can't even get the solution to run because of an expected to actual type error.</p>\n\n<p><strong>Here is the code I've been trying:</strong></p>\n\n<pre><code>module Main where\nimport Data.List\nsortList :: (Ord a) =&gt; (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]\nsortList comparator list = sortBy comparator list\n</code></pre>\n\n<p><strong>Here is the error:</strong></p>\n\n<pre><code>*Main&gt; sortList [5,4,2,7,8,1]\n\n&lt;interactive&gt;:1:10:\n    Couldn't match expected type `a -&gt; a -&gt; Ordering'\n                with actual type `[t]'\n    In the first argument of `sortList', namely `[5, 4, 2, 7, ....]'\n    In the expression: sortList [5, 4, 2, 7, ....]\n    In an equation for `it': it = sortList [5, 4, 2, ....]\n</code></pre>\n\n<p><strong>My Thoughts and Attempts:</strong></p>\n\n<p>Maybe I am calling the function wrong? I am fairly new to Haskell. II tried doing many searches as well. All I could conclude is that somewhere the types aren't matching up. I suppose explanation and guidance for the script would be very helpful to me.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1461422546, "post_id": 36812138, "comment_id": 61197192, "body": "Newtype gives you a way to distinguish from the prior type when there is semantic difference.  For example, <code>newtype Latittute = Lat Double ; newtype Longitude = Lon Double</code>.  You also get to define your classes all over again, fun!"}, {"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1461422689, "post_id": 36812138, "comment_id": 61197244, "body": "Thanks, I can use type keyword for that right. Is there any additional advantage?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1461423030, "post_id": 36812138, "comment_id": 61197378, "body": "No, <code>type Latitude = Double</code> would not give you any type safety.  If you swap values of type <code>Double</code> or other type aliases for <code>Double</code> there is no compile time error.  <code>type _ = _ </code>  only creates an alias."}, {"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1461423573, "post_id": 36812138, "comment_id": 61197572, "body": "Ya got it. Is this the only advantage? I can go for data keyword by limiting to one value constructor and one filed, like &quot;data Latitude = Lat Double&quot;"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1461423673, "post_id": 36812138, "comment_id": 61197612, "body": "Newtype is also strict, so your semantics regarding bottom are different and performance can differ too."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461424236, "post_id": 36812138, "comment_id": 61197822, "body": "if you want to read a bit more about this you can check out <a href=\"https://wiki.haskell.org/Newtype\" rel=\"nofollow noreferrer\">newtype</a> on the Haskell-wiki"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1461437705, "post_id": 36812138, "comment_id": 61202788, "body": "@HariKrishna However <code>data</code> will actually <i>consume memory</i>. A <code>newtype</code> will be completely erased when compiling (which also yield strictness as Thomas mentions) so you have absolutely 0 overhead for using a <code>newtype</code> in both space and time. It is just a tool to distinguish types for the compiler."}], "answers": [{"tags": [], "owner": {"reputation": 1305, "user_id": 87721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96f6774b4445eda94b1aacf78c381ba?s=128&d=identicon&r=PG", "display_name": "niteria", "link": "https://stackoverflow.com/users/87721/niteria"}, "is_accepted": false, "score": 1, "last_activity_date": 1461505684, "creation_date": 1461505684, "answer_id": 36823969, "question_id": 36812138, "link": "https://stackoverflow.com/questions/36812138/why-is-the-restriction-on-newtype/36823969#36823969", "title": "Why is the restriction on newtype?", "body": "<p><code>newtype</code> is a tool for creating data abstraction that has no runtime cost.</p>\n\n<h1>What do I mean by abstraction?</h1>\n\n<p>Suppose you have:</p>\n\n<pre><code>greetPerson :: String -&gt; String -&gt; String\ngreetPerson greeting name = greeting ++ \" \" ++ name\n\ngreetPerson \"Hello\" \"Mike\" =&gt; \"Hello Mike\"\n</code></pre>\n\n<p>This works fine, but it opens opportunities for misuse:</p>\n\n<pre><code>greetPerson \"Mike\" \"Hello\" =&gt; \"Mike Hello\"\n</code></pre>\n\n<p>The problem is that you're using the same type everywhere (<code>String</code>), carrying no semantic meaning. Let's use a newtype:</p>\n\n<pre><code>newtype Name = Name String\n\ngreetPerson :: String -&gt; Name -&gt; String\ngreetPerson greeting (Name name) = greeting ++ \" \" ++ name\n\ngreetPerson \"Hello\" (Name \"Mike\") =&gt; \"Hello Mike\"\n</code></pre>\n\n<p>We end up with the same functionality, but now the type signature carries more meaning and the compiler can tell us when we misuse it.</p>\n\n<h1>What do I mean by no runtime cost?</h1>\n\n<p>The <code>newtype</code> from my example exists only at the type level and the compiler generates exactly the same code as if I used <code>String</code> throughout.</p>\n\n<p>This hints at why <code>newtype</code> is only allowed for one constructor with one field.</p>\n\n<p>Imagine you tried to make <code>newtype</code> work for more than one constructor. How would you distinguish which one you have at runtime? You'd have to store some additional information.</p>\n\n<p>Same with more than one field. You'd need some way to bundle two fields together.</p>\n\n<p>All of them add some runtime cost which <code>newtype</code> promises not to do.</p>\n\n<p>If you want more than one field or more than one constructor simply use <code>data</code>:</p>\n\n<pre><code>data Foo = Bar String | Baz Int Bool\n</code></pre>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461505684, "creation_date": 1461422090, "question_id": 36812138, "link": "https://stackoverflow.com/questions/36812138/why-is-the-restriction-on-newtype", "title": "Why is the restriction on newtype?", "body": "<p>I read that \"newtype has exactly one constructor with exactly one field inside it.\" Is this restriction adds any advantage? If the value constructor is limited with only one field, why can't i use the field directly in my code, instead of wrapping it with newtype?</p>\n"}, {"tags": ["haskell", "random", "set"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461406987, "post_id": 36809516, "comment_id": 61191971, "body": "short answer you cannot (without <i>cheating</i> using <code>unsafePerformIO</code>) - so just be honest and return a <code>IO Int</code> (obviously <code>function</code> is not pure so it makes a lot of sense that Haskell don&#39;t want you to write this function)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461407133, "post_id": 36809516, "comment_id": 61192008, "body": "also the syntax is of <code>&lt;-</code> - it&#39;s just <code>function i = randomRIO (0,i-1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1461408299, "post_id": 36809593, "comment_id": 61192374, "body": "But this way i only can use the element in a monadic function. Is there other way i can use to remove a random element?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1461408525, "post_id": 36809593, "comment_id": 61192443, "body": "not exactly - you don&#39;t need the <code>IO</code> when you pass the random-generator along and there are special monads just for this but in the end you have to take this information/type along with you"}, {"owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1461409179, "post_id": 36809593, "comment_id": 61192676, "body": "I am using this in the second argument of forAll which is a function ::a-&gt;prop. Any monad can fit this?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1461409381, "post_id": 36809593, "comment_id": 61192750, "body": "why would you do that? quickcheck will give you random values anyway - but yes there is <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.2/docs/Test-QuickCheck-Property.html#v:ioProperty\" rel=\"nofollow noreferrer\"><code>ioProperty</code></a> for cases involving <code>IO</code>"}, {"owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1461409561, "post_id": 36809593, "comment_id": 61192813, "body": "Because i am making a property for a function which gets a set and an element. The set is randomly generated and then i want to take one of the elements already generated."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "edited": false, "score": 0, "creation_date": 1461409757, "post_id": 36809593, "comment_id": 61192877, "body": "you probably should open another question for this - IMO this one is answered and this discussion is drifting away"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461421067, "post_id": 36809593, "comment_id": 61196691, "body": "There is really no reason to mentioned <code>unsafePerformIO</code> here, other than to say &quot;don&#39;t&quot; - this is certainly not a valid use in any sense."}, {"owner": {"reputation": 1305, "user_id": 87721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96f6774b4445eda94b1aacf78c381ba?s=128&d=identicon&r=PG", "display_name": "niteria", "link": "https://stackoverflow.com/users/87721/niteria"}, "edited": false, "score": 0, "creation_date": 1461506017, "post_id": 36809593, "comment_id": 61219272, "body": "Depending on what you&#39;re testing, it might be easier to generate two things: a set and an element and put the element in the set to ensure it&#39;s there. This way you end up with a randomly generated set and a random element from it."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1461424141, "last_edit_date": 1461424141, "creation_date": 1461407330, "answer_id": 36809593, "question_id": 36809516, "link": "https://stackoverflow.com/questions/36809516/random-number-set-haskell/36809593#36809593", "title": "Random Number Set Haskell", "body": "<p>In Haskell we want to know if our functions are pure - in your case you want to implement a function which is obviously not pure at all - it's random.</p>\n\n<p>So you should be honest about this function and indicate this in the type. Now of course you can use <code>randomRIO</code> and in this case you indicate this by returning <code>IO</code>-computations.</p>\n\n<p>Assuming you want to take random elements form <code>Data.Set</code>s it could look like this:</p>\n\n<pre><code>randomElement :: Set a -&gt; IO a\nrandomElement set = do\n   i &lt;- randomRIO (0, size set - 1)\n   return $ set `elemAt` i\n</code></pre>\n\n<p>for <code>Map</code>s, etc. it's similar</p>\n"}], "owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461424141, "creation_date": 1461406895, "question_id": 36809516, "link": "https://stackoverflow.com/questions/36809516/random-number-set-haskell", "title": "Random Number Set Haskell", "body": "<p>i need to take one random element from a set of int. I am trying to use the function <code>elemAt :: Int-&gt;Set a-&gt;a</code> but i need to randomly generate the Int which will be used in the first argument of <code>elemAt</code>, but i am having a problem because randomRIO is a monadic function. How can i use randomRIO in a funcion that returns an int?E.g:</p>\n\n<pre><code>function :: Int-&gt;Int\nfunction i = x &lt;- randomRIO(0,i-1)\n</code></pre>\n\n<p>What i am trying to do is something like this:</p>\n\n<pre><code>element set = elemAt (function (size set)) set\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461390922, "post_id": 36807160, "comment_id": 61187858, "body": "Maybe <code>DeriveFunctor</code> or make an explicit instance of it? Then the above might end up as <code>replace x y = fmap (\\z -&gt; if x == z then y else x)</code>. Of course, that means that <code>Formula</code> will have kind <code>* -&gt; *</code>, but that sounds reasonable. <code>Formula Bool</code> would be a boolean formula."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1461413110, "post_id": 36807160, "comment_id": 61194010, "body": "You could make <code>Formula</code> an instance of <a href=\"https://hackage.haskell.org/package/uniplate-1.6.12/docs/Data-Generics-Compos.html\" rel=\"nofollow noreferrer\"><code>Compos</code></a>, would that help?"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461395261, "post_id": 36807250, "comment_id": 61188871, "body": "I don&#39;t think that last one is going to work. <code>fmap</code> is going to expect something of type <code>a -&gt; a</code>, but you&#39;re handing it something of type <code>Formula a -&gt; Formula a</code>. (But the rest of the advice here is solid.)"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1461392469, "last_edit_date": 1461392469, "creation_date": 1461391266, "answer_id": 36807250, "question_id": 36807160, "link": "https://stackoverflow.com/questions/36807160/pattern-matching-in-a-haskell-function/36807250#36807250", "title": "Pattern Matching in a Haskell Function", "body": "<p>I'm not entirely sure this is what you are looking for but you could do the following. The idea is that you can consider a formula to be abstracted over another type (usually a <code>Term</code> in your case). Then, you can define what it means to map over a formula. I tried to replicate your data definitions, although I have some problems with <code>Formula</code> - namely that all the constructors seem to require another <code>Formula</code>...</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\ndata Formula a\n  = Not (Formula a)\n  | And (Formula a) (Formula a)\n  | Or (Formula a) (Formula a)\n  | Biimp (Formula a) (Formula a)\n  | Imp (Formula a) (Formula a)\n  | Forall a (Formula a)\n  | Exists a (Formula a)\n  | Pred a (Formula a)\n  deriving (Functor)\n\ndata Term = Term String {- However you define it, doesn't matter -} deriving (Eq)\n\nreplace :: (Functor f, Eq a) =&gt; a -&gt; a -&gt; f a -&gt; f a\nreplace x y = fmap (\\z -&gt; if x == z then y else z)\n</code></pre>\n\n<p>The interesting thing to note is that now the <code>replace</code> function can be applied to anything that is a functor - it even serves as <code>replace</code> for a list!</p>\n\n<pre><code>replace 3 9 [1..6] = [1,2,9,4,5,6]\n</code></pre>\n\n<p><strong>EDIT</strong> As an afterthought, if you are implementing a substitution style replace where terms in formulas can be shadowed (the usual scoping rules), you will probably end up doing something like this:</p>\n\n<pre><code>replace' :: (Eq a) =&gt; a -&gt; a -&gt; Formula a -&gt; Formula a\nreplace' x y f@(Forall z _) | x == z = f\nreplace' x y f@(Exists z _) | x == z = f\nreplace' x y f@(Pred z _)   | x == z = f\nreplace' x y formula = fmap (replace' x y) formula\n</code></pre>\n\n<p>Which isn't as cute, but also isn't as straightforward pf a problem.</p>\n"}, {"comments": [{"owner": {"reputation": 1713, "user_id": 1121552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/tX32x.png?s=128&g=1", "display_name": "jonaprieto", "link": "https://stackoverflow.com/users/1121552/jonaprieto"}, "edited": false, "score": 1, "creation_date": 1461395712, "post_id": 36807824, "comment_id": 61188995, "body": "I like that but the bad news are with this I must rewrote every single method."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1713, "user_id": 1121552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/tX32x.png?s=128&g=1", "display_name": "jonaprieto", "link": "https://stackoverflow.com/users/1121552/jonaprieto"}, "edited": false, "score": 0, "creation_date": 1461438665, "post_id": 36807824, "comment_id": 61203099, "body": "@jonaprieto I have added a sentence to address this concern."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1461438645, "last_edit_date": 1461438645, "creation_date": 1461395448, "answer_id": 36807824, "question_id": 36807160, "link": "https://stackoverflow.com/questions/36807160/pattern-matching-in-a-haskell-function/36807824#36807824", "title": "Pattern Matching in a Haskell Function", "body": "<p>If you have many constructors that should be treated in a uniform way, you should make your data type reflect that.</p>\n\n<pre><code>data BinOp      = BinAnd | BinOr | BinBiimp | BinImp\ndata Quantifier = QForall | QExists\ndata Formula    = Not Formula\n                | Binary BinOp Formula Formula -- key change here\n                | Quantified Quantifier Formula\n                | Pred Index [Formula]\n</code></pre>\n\n<p>Now the pattern match for all binary operators is much easier:</p>\n\n<pre><code>replace x y (Binary op f g) = Binary op (replace x y f) (replace x y g)\n</code></pre>\n\n<p>To preserve existing code, you can turn on <code>PatternSynonyms</code> and define the old versions of <code>And</code>, <code>Or</code>, and so on back into existence:</p>\n\n<pre><code>pattern And x y = Binary BinAnd x y\npattern Forall f = Quantified QForall f\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1461413312, "post_id": 36809462, "comment_id": 61194076, "body": "I wonder why was this downvoted? Is there any issue with this approach? (Beyond variable capturing and substituting non free occurrences, which are common with other answers so far)"}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 1, "last_activity_date": 1461406885, "last_edit_date": 1461406885, "creation_date": 1461406556, "answer_id": 36809462, "question_id": 36807160, "link": "https://stackoverflow.com/questions/36807160/pattern-matching-in-a-haskell-function/36809462#36809462", "title": "Pattern Matching in a Haskell Function", "body": "<p><a href=\"https://hackage.haskell.org/package/recursion-schemes-4.1.2/docs/Data-Functor-Foldable.html\" rel=\"nofollow\">Data.Functor.Foldable</a> abstracts the pattern of recursive data structures:</p>\n\n<pre><code>import Data.Functor.Foldable\n\ndata FormulaF t\n  = Not t\n  | And t t\n  | Or t t\n  | Biimp t t\n  | Imp t t\n  | Forall A t\n  | Exists A t\n  | Pred B C\n  deriving (Functor, Foldable, Traversable)\n\ntype Formula = Fix FormulaF\n\nreplace :: Term -&gt; Term -&gt; Formula -&gt; Formula\nreplace x y = cata $ \\case -&gt;\n  Pred idx ts -&gt; Pred idx (replace_ x y ts)\n  f -&gt; f\n</code></pre>\n\n<p>By the way, beware of <code>replace x y (Forall x (f x)) = Forall x (f y)</code>: <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus#Substitution\" rel=\"nofollow\">Substitution is the process of replacing all <strong>free</strong> occurences of a variable in an expression with an expression.</a></p>\n"}], "owner": {"reputation": 1713, "user_id": 1121552, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/tX32x.png?s=128&g=1", "display_name": "jonaprieto", "link": "https://stackoverflow.com/users/1121552/jonaprieto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 36807824, "answer_count": 3, "score": 2, "last_activity_date": 1461438645, "creation_date": 1461390590, "question_id": 36807160, "link": "https://stackoverflow.com/questions/36807160/pattern-matching-in-a-haskell-function", "title": "Pattern Matching in a Haskell Function", "body": "<p>I have many methods that have boilerplate code in their definition, look at the example above. </p>\n\n<pre><code>replace:: Term -&gt; Term -&gt; Formula -&gt; Formula\nreplace x y (Not f)            = Not $ replace x y f\nreplace x y (And f g)          = And (replace x y f) (replace x y g)\nreplace x y (Or f g)           = Or (replace x y f) (replace x y g)\nreplace x y (Biimp f g)        = Biimp (replace x y f) (replace x y g)\nreplace x y (Imp f g)          = Imp (replace x y f) (replace x y g)\nreplace x y (Forall z f)       = Forall z (replace x y f)\nreplace x y (Exists z f)       = Exists z (replace x y f)\nreplace x y (Pred idx ts)      = Pred idx (replace_ x y ts)\n</code></pre>\n\n<p>As you can see, the definitions for <code>replace</code> function follows a pattern. I want to have the same behavior of the function, simplifying his definition, probably using some pattern matching, maybe with a wildcard <code>_</code> or <code>X</code> over the arguments, something like: </p>\n\n<pre><code>replace x y (X f g)          = X (replace x y f) (replace x y g)\n</code></pre>\n\n<p>For avoiding the following definitions:</p>\n\n<pre><code>replace x y (And f g)          = And (replace x y f) (replace x y g)\nreplace x y (Or f g)           = Or (replace x y f) (replace x y g)\nreplace x y (Biimp f g)        = Biimp (replace x y f) (replace x y g)\nreplace x y (Imp f g)          = Imp (replace x y f) (replace x y g)\n</code></pre>\n\n<p>Is there some way? Forget about the purpose of the function, it could be whatever. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461374887, "post_id": 36805039, "comment_id": 61184848, "body": "Please include your code. It&#39;s very difficult to tell what is going on here."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461374922, "post_id": 36805039, "comment_id": 61184854, "body": "It sounds like you are probably getting types and type constructors mixed up. However, I can&#39;t tell from what you have posted."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "reply_to_user": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461375455, "post_id": 36805039, "comment_id": 61184950, "body": "@Kwarrtz added code."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1461376161, "post_id": 36805039, "comment_id": 61185092, "body": "If you could add the definitions of your <code>Domain</code> type and <code>domain</code> smart constructor, that would be helpful as well."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1461389654, "post_id": 36805760, "comment_id": 61187577, "body": "If I understood correctly, and I certainly might not have given the question, I think the type itself is not exported.  If that&#39;s the case he certainly has a problem and should export the type or file an issue with the library author.  It wouldn&#39;t be the first time."}], "tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": true, "score": 6, "last_activity_date": 1461439241, "last_edit_date": 1461439241, "creation_date": 1461376611, "answer_id": 36805760, "question_id": 36805039, "link": "https://stackoverflow.com/questions/36805039/record-syntax-field-type-annotation-having-only-smart-constructor/36805760#36805760", "title": "Record syntax field type annotation having only smart constructor", "body": "<p>The issue here is confusion between the concept of a <strong>type constructor</strong> and a <strong>data constructor</strong>. For brevity, I will illustrate the difference with an example.</p>\n\n<pre><code>data Foo a = Bar [a]\n</code></pre>\n\n<p>In the expression above, <code>Foo</code> is the type constructor and <code>Bar</code> is the data constructor. The key difference is that <code>Foo</code> is a value in Haskell's type space and <code>Bar</code> is a value in its data space. A value in type space cannot be used in data space, and vice versa. For example, the compiler would error at the following expressions.</p>\n\n<pre><code>someVariable :: Bar Int\nsomeVariable = Foo [15]\n</code></pre>\n\n<p>The next expression, however, is completely valid.</p>\n\n<pre><code>someVariable :: Foo Int\nsomeVariable = Bar [15]\n</code></pre>\n\n<p>Additionally, all type constructors <strong>must start with an upper case letter</strong>. Any types starting with a lower case letter will be considered type variables, not type constructors (the <code>a</code> in our definition above is an example of this).</p>\n\n<p>The introduction of smart constructors add another layer to this problem, but the key thing to understand is that <strong>smart constructors are data constructors, not type constructors</strong>. In your definition of <code>Rec</code>, you tried to use your smart constructor, <code>domain</code>, in the type declaration for <code>dint</code> field. However, because <code>domain</code> is a data constructor not a type constructor, and it is lower case, the Haskell compiler tried to interpret <code>domain</code> as the name of a type variable. Because you never specified a variable named <code>domain</code> in your definiton of the <code>Rec</code> type, the compiler raised an error.</p>\n\n<p>You don't actually need to export the data constructor for <code>Domain</code> to solve the issue, just the type itself. This can be accomplished with the following. </p>\n\n<pre><code>module Domain (\n    Domain(), domain,\n    ...\n    ) where\n</code></pre>\n\n<p>Including <code>Domain()</code> in the export definition tells Haskell to export the <code>Domain</code> type constructor, but not any of its data constructors. This preserves the safety you wanted with the safe constructor, and allows you to define types correctly. You can now use your newly exported type in your definition of <code>Rec</code>.</p>\n\n<pre><code>import Domain (Domain(), domain)\n\ndata Rec = Rec\n    { dint :: Domain Int\n    ...\n    }\n</code></pre>\n\n<p>For more information, I strongly recommend you read the HaskellWiki articles on <a href=\"https://wiki.haskell.org/Constructor\" rel=\"nofollow\">constructors</a> and <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow\">smart constructors</a>.</p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 36805760, "answer_count": 1, "score": 0, "last_activity_date": 1461439241, "creation_date": 1461369855, "last_edit_date": 1461375439, "question_id": 36805039, "link": "https://stackoverflow.com/questions/36805039/record-syntax-field-type-annotation-having-only-smart-constructor", "title": "Record syntax field type annotation having only smart constructor", "body": "<p>I'm trying to create a record where one of the fields has a type that is not exported, since it's using a smart constructor. Using the smart constructor as the type does not work.</p>\n\n<pre><code> Not in scope: type variable `domain'\n</code></pre>\n\n<p>Maybe there is a language extension that allows me to do this, or something similar? </p>\n\n<p>Exporting the constructor along with the smart constructor would allow me to solve this problem, but that in turn creates the possibility of creating values that the smart constructor wouldn't allow. </p>\n\n<p>The (non-working) code I have right now:</p>\n\n<pre><code>import Domain (domain) -- Domain is not exported, and domain is a smart constructor for Domain\n\ndata Rec = Rec\n    { dint :: domain Int -- what do I do here? I want it to be `Domain Int` but `Domain` isn't exported.\n    ...\n    }\n</code></pre>\n"}, {"tags": ["haskell", "syntax"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1461366355, "post_id": 36804470, "comment_id": 61183045, "body": "<code>Int `Either` String</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1590183114, "post_id": 36804703, "comment_id": 109594993, "body": "Whey is the struck-out text struk-out? Is it wrong, inaccurate, irrelevant, or what?"}, {"owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "edited": false, "score": 0, "creation_date": 1590185841, "post_id": 36804703, "comment_id": 109595818, "body": "I should have read it first, sorry. I&#39;ll delete the comment in a while."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1590185813, "last_edit_date": 1590185813, "creation_date": 1461367027, "answer_id": 36804703, "question_id": 36804470, "link": "https://stackoverflow.com/questions/36804470/how-to-use-type-constructor-in-infix-form/36804703#36804703", "title": "How to use type constructor in infix form", "body": "<pre><code>&gt; :set -XTypeOperators\n&gt; data a :-&gt; b = C (a -&gt; b)\n&gt; :t C id\nC id :: b :-&gt; b\n</code></pre>\n\n<p><strike>Remember that its name must start with <code>:</code> (roughly, <code>:</code> is considered \"uppercase\").</strike> (No longer needed -- see the answer by Cactus for more information)</p>\n\n<p>Otherwise, use backticks, as in <code>a `T` b</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 5, "last_activity_date": 1461387239, "creation_date": 1461387239, "answer_id": 36806792, "question_id": 36804470, "link": "https://stackoverflow.com/questions/36804470/how-to-use-type-constructor-in-infix-form/36806792#36806792", "title": "How to use type constructor in infix form", "body": "<p>To expand on @chi's answer, with recent GHC versions, the syntax of <code>TypeOperators</code> has changed somewhat: type constructor names that would otherwise be infix <strong>type variable</strong> names (i.e. symbols without a leading <code>:</code>) are still classified as <strong>type constructor</strong> names, meaning the following code works and defines an infix type constructor <code>+</code>:</p>\n\n<pre><code>{-# language TypeOperators #-}\n\ndata a + b = L a | R b\n</code></pre>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 36804703, "answer_count": 2, "score": 7, "last_activity_date": 1590185813, "creation_date": 1461365367, "last_edit_date": 1461387253, "question_id": 36804470, "link": "https://stackoverflow.com/questions/36804470/how-to-use-type-constructor-in-infix-form", "title": "How to use type constructor in infix form", "body": "<p>I am going through <a href=\"https://wiki.haskell.org/Constructor\" rel=\"noreferrer\">some Haskell documentation</a>, and found the statement </p>\n\n<blockquote>\n  <p>You can declare a constructor (<strong>for both type and data</strong>) to be an infix operator, and this can make your code a lot more readable.</p>\n</blockquote>\n\n<p>I am able to use data constructor in infix form like below:</p>\n\n<pre><code>Prelude&gt; data List a = Empty | a :-&gt; (List a) deriving Show\nPrelude&gt; \nPrelude&gt; let var1 = 10 :-&gt; Empty\nPrelude&gt; let var2 = 20 :-&gt; var1\nPrelude&gt; let var3 = 30 :-&gt; var2\nPrelude&gt; \nPrelude&gt; var1\n10 :-&gt; Empty\nPrelude&gt; \nPrelude&gt; var2\n20 :-&gt; (10 :-&gt; Empty)\nPrelude&gt; \nPrelude&gt; var3\n30 :-&gt; (20 :-&gt; (10 :-&gt; Empty))\n</code></pre>\n\n<p>My question is how to use type constructor in infix form, Can somebody give me an example to understand this ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1461446852, "post_id": 36804300, "comment_id": 61205704, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33722381/pattern-matching-on-a-private-data-constructor\">Pattern matching on a private data constructor</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6648, "user_id": 464306, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8KCe.png?s=128&g=1", "display_name": "gdejohn", "link": "https://stackoverflow.com/users/464306/gdejohn"}, "is_accepted": true, "score": 7, "last_activity_date": 1461366426, "last_edit_date": 1461366426, "creation_date": 1461365287, "answer_id": 36804453, "question_id": 36804300, "link": "https://stackoverflow.com/questions/36804300/pattern-match-using-smart-constructor/36804453#36804453", "title": "Pattern match using smart constructor", "body": "<p>Define this in <code>MyModule</code> and export it:</p>\n\n<pre><code>extract :: Thing -&gt; Int\nextract (Thing x) = x\n</code></pre>\n\n<p>Use the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/ViewPatterns\">view patterns</a> extension:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\nfn :: Thing -&gt; Bool\nfn (extract -&gt; 3) = True\n</code></pre>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 1, "accepted_answer_id": 36804453, "answer_count": 1, "score": 2, "last_activity_date": 1461366426, "creation_date": 1461364368, "question_id": 36804300, "link": "https://stackoverflow.com/questions/36804300/pattern-match-using-smart-constructor", "title": "Pattern match using smart constructor", "body": "<p>Is there a way to pattern match smart constructors, outside of its module?</p>\n\n<p>Something like this:</p>\n\n<pre><code>import MyModule (thing)\n\nfn (thing 3) = True\n</code></pre>\n\n<p>without being able to write this:</p>\n\n<pre><code>fn (Thing 3) = True\n</code></pre>\n\n<p>where <code>thing</code> is a smart constructor for <code>Thing</code>.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 0, "creation_date": 1461360912, "post_id": 36803656, "comment_id": 61181273, "body": "By querying like &quot;:t Engineer&quot;, i can get the singature of data constructor. But  i am looking for, how to get this by querying variable &#39;engineer1&#39; itslef."}, {"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "reply_to_user": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 2, "creation_date": 1461361087, "post_id": 36803656, "comment_id": 61181336, "body": "You&#39;d have to write a <code>case</code> statement to figure out which data constructor it used, but there&#39;s no easy way to get the type of something from inside the body of the case statement. <code>:t</code> is a ghci command rather than something you can run inside a Haskell expression."}], "tags": [], "owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1461360866, "creation_date": 1461360866, "answer_id": 36803656, "question_id": 36803592, "link": "https://stackoverflow.com/questions/36803592/how-to-get-signature-of-data-constructor-in-haskell/36803656#36803656", "title": "How to get signature of Data constructor in Haskell", "body": "<pre><code>*Main&gt; :t Engineer \nEngineer :: String -&gt; String -&gt; Employee\n</code></pre>\n\n<p>Note that <code>Employee</code> is a type, not a data constructor.</p>\n"}, {"comments": [{"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 0, "creation_date": 1461362316, "post_id": 36803696, "comment_id": 61181763, "body": "Thanks for the answer. It solves the problem, Is there any inbuilt function to do this ? because, incase of custom types with type variables, it is difficult to manage."}, {"owner": {"reputation": 682, "user_id": 4088416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719bb302e6c3d5a78148083e73b7fc1?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Antonio Riaza Valverde", "link": "https://stackoverflow.com/users/4088416/jos%c3%a9-antonio-riaza-valverde"}, "reply_to_user": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 0, "creation_date": 1461524729, "post_id": 36803696, "comment_id": 61226158, "body": "Check my answer again. @HariKrishna"}], "tags": [], "owner": {"reputation": 682, "user_id": 4088416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1719bb302e6c3d5a78148083e73b7fc1?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Antonio Riaza Valverde", "link": "https://stackoverflow.com/users/4088416/jos%c3%a9-antonio-riaza-valverde"}, "is_accepted": true, "score": 1, "last_activity_date": 1461524640, "last_edit_date": 1461524640, "creation_date": 1461361090, "answer_id": 36803696, "question_id": 36803592, "link": "https://stackoverflow.com/questions/36803592/how-to-get-signature-of-data-constructor-in-haskell/36803696#36803696", "title": "How to get signature of Data constructor in Haskell", "body": "<p>You could create a function like:</p>\n\n<pre><code>typeEmployee :: Employee -&gt; String\ntypeEmployee (Engineer _ _) = \"...\"\ntypeEmployee (Manager _ _) = \"...\"\ntypeEmployee (Director _ _) = \"...\"\n</code></pre>\n\n<p>Other option, create a new class <code>ShowType</code>:</p>\n\n<pre><code>-- TYPE\ndata Employee a b = Engineer {name :: a, engineerId :: b}\n                | Manager {name :: a, managerId :: b}\n                | Director {name :: a, directorId :: b}\n                deriving Show\n\n-- CLASS\nclass ShowType a where\n    showType :: a -&gt; String\n\n-- INSTANCES\ninstance ShowType Int where\n    showType _ = \"Int\"\n\ninstance ShowType Integer where\n    showType _ = \"Integer\"\n\ninstance ShowType Float where\n    showType _ = \"Float\"\n\ninstance ShowType Char where\n    showType _ = \"Char\"\n\ninstance (ShowType a) =&gt; ShowType [a] where\n    showType x = \"[\" ++ showType (head x) ++ \"]\"\n\ninstance (ShowType a, ShowType b) =&gt; ShowType (Employee a b) where\n    showType (Engineer x y) = \"Engineer \" ++ showType x ++ ' ' : showType y\n    showType (Manager x y) = \"Manager \" ++ showType x ++ ' ' : showType y\n    showType (Director x y) = \"Director \" ++ showType x ++ ' ' : showType y\n</code></pre>\n\n<p>Now, You can do:</p>\n\n<pre><code>*Main&gt; showType (Manager 12 \"a\")\n\"Manager Integer [Char]\"\n\n*Main&gt; showType (Manager [56] 12)\n\"Manager [Integer] Integer\"\n\n*Main&gt; let x = Engineer 12 5 :: (Employee Int Int)\n*Main&gt; showType x\n\"Engineer Int Int\"\n</code></pre>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 36803696, "answer_count": 2, "score": 0, "last_activity_date": 1461524640, "creation_date": 1461360531, "last_edit_date": 1461361089, "question_id": 36803592, "link": "https://stackoverflow.com/questions/36803592/how-to-get-signature-of-data-constructor-in-haskell", "title": "How to get signature of Data constructor in Haskell", "body": "<pre><code>{- Define an employee type -}\ndata Employee = Engineer {name :: String, engineerId :: String}\n                | Manager {name :: String, managerId :: Integer}\n                | Director {name :: String, directorId :: Integer}\n                deriving Show\n</code></pre>\n\n<p>I defined a variable engineer1 like below.</p>\n\n<pre><code>*Main&gt; let engineer1 = Engineer \"Hari\" \"123\"\n</code></pre>\n\n<p>When I query for type of engineer1, it gives me like \"engineer1 :: Employee\". I understood that, Engineer is data constructor, where as Employee is corresponding type constructor. My question is, is there any way that I can get signature of data constructor like \"Engineeer String String\" :: Employee.</p>\n"}, {"tags": ["haskell", "normalization", "typeclass", "agda"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 4, "creation_date": 1461378777, "post_id": 36803125, "comment_id": 61185667, "body": "Could you give an example of how you use <code>UniqueYo</code>? Right now you can instead of postulating <code>UniqueYo</code> define it as <code>UniqueYo _ _ = trustMe</code> where <code>trustMe</code> comes from <code>Relation.Binary.PropositionalEquality.TrustMe</code> and computes to <code>refl</code> whenever its type rewrites to <code>x \u2261 x</code> for some <code>x</code>."}, {"owner": {"reputation": 792, "user_id": 3550444, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a06f855d0b44ead04edffa576cd943e?s=128&d=identicon&r=PG", "display_name": "Musa Al-hassy", "link": "https://stackoverflow.com/users/3550444/musa-al-hassy"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1461700117, "post_id": 36803125, "comment_id": 61315506, "body": "Using <code>trustMe</code> makes things compute and fixes everything for me...I&#39;m just not at all comfortable using it..I honestly feel a bit scared/worried; until I find a better solution, I suppose I&#39;ll use it though. It&#39;s usage brings me to another problem: <a href=\"http://stackoverflow.com/questions/36874369/separation-of-concerns-when-is-it-best-to-disassociate-semantics-from-syntax\" title=\"separation of concerns when is it best to disassociate semantics from syntax\">stackoverflow.com/questions/36874369/&hellip;</a>.  Anyhow, thank-you!"}], "owner": {"reputation": 792, "user_id": 3550444, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a06f855d0b44ead04edffa576cd943e?s=128&d=identicon&r=PG", "display_name": "Musa Al-hassy", "link": "https://stackoverflow.com/users/3550444/musa-al-hassy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 1, "answer_count": 0, "score": 7, "last_activity_date": 1461481243, "creation_date": 1461358330, "last_edit_date": 1461481243, "question_id": 36803125, "link": "https://stackoverflow.com/questions/36803125/mimicking-haskell-canonicity-one-instance-only-of-typeclasses-in-agda", "title": "Mimicking Haskell canonicity (one-instance only) of typeclasses in Agda", "body": "<p>Agda's mixiture of records and the <code>instance</code> keyword give us behaviour similar to that of Haskell's typeclasses. Moreover, ignoring the <code>instance</code> keyword, we can have more than one instance for the same type --- something we cannot do in Haskell.</p>\n\n<p>I am at a point where I need Haskell's one-instance only requirement, but in Agda. \nIs there an compiler option or some trick/heuristic to enforce this?</p>\n\n<p>Right now the approach I am taking is,</p>\n\n<pre><code>record Yo (n : \u2115) : Set where\n  field\n    sem : (some interesting property involving n)\n\nopen Yo {{...}}\n\npostulate UniqueYo: \u2200 {n} (p q : Yo n) \u2192 p \u2261 q\n</code></pre>\n\n<p>However, whenever I actually use <code>UniqueYo</code> the lack of computation leaves my goals littered with things like <code>...| UniqueYo p p</code> where I'd prefer <code>...| refl</code> or a full rewrite into normal form instead.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461356337, "post_id": 36802590, "comment_id": 61179275, "body": "One way would be to use &quot;blueprints&quot;. Make the blueprint&#39;s constructor open and unvalidated, and actual data constructor hidden behind a <code>Blueprint -&gt; ActualData</code> function."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461356354, "post_id": 36802590, "comment_id": 61179281, "body": "well you can choose <b>not</b> to publish the constructor from your module and use a <i>smart-constructor</i> (a function) that checks your conditions and publish it"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461356407, "post_id": 36802590, "comment_id": 61179310, "body": "@Carsten but that function won&#39;t use the record syntax, which I suppose was the main point here."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461356421, "post_id": 36802590, "comment_id": 61179317, "body": "depending on the circumstances there might be ways to do this using the strictly in the type-system but it&#39;s probably rather complicated and of course you would have to make this more concrete"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461356456, "post_id": 36802590, "comment_id": 61179338, "body": "@BartekBanachewicz in this case I think I don&#39;t understand the question at all..."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461356526, "post_id": 36802590, "comment_id": 61179373, "body": "@Carsten you can only use record syntax when a) you have the c-tor, or b) when you have a value of the type. If you have neither and just want to create the value, then you need to use regular function call syntax."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1461356575, "post_id": 36802590, "comment_id": 61179399, "body": "I basically want to use a smart constructor, while using record syntax. Using functions with 13 <code>-&gt;</code> in them isn&#39;t fun at all."}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1461356764, "post_id": 36802590, "comment_id": 61179494, "body": "One of the invariants is basically <code>&lt;</code> on <code>Int</code> so enumerating the combinations as types is not feasible."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461356930, "post_id": 36802590, "comment_id": 61179584, "body": "not sure if I get the question still but what about providing a empty/default value with valid entries and then provide functions that change certain values in a fashion that keeps the data valid? Or splitting the data into smaller subsets?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1461409265, "post_id": 36802590, "comment_id": 61192717, "body": "I don&#39;t understand the question either. What do you mean by using record syntax ? could you add an example of how you would the final code to look like."}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461357231, "post_id": 36802764, "comment_id": 61179701, "body": "On top of that, if you have more than one such data type, it could perhaps be a nice place for <code>DataFamilies</code>. Create a generic <code>newtype Valid a = Valid a</code> and a <code>class Validable</code> with <code>origType :: a</code>, <code>validType :: Valid a</code>, and <code>validate :: a -&gt; Valid a</code>. Not sure if that would work or what it would buy, but perhaps work exploring."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1461400236, "post_id": 36802764, "comment_id": 61190113, "body": "How can you make your module <i>extensible</i>, i.e. allow users of your module to use  the constructor <code>ValidData</code> in a pattern (like in the definition of <code>libFun</code>) if you don&#39;t export it? Now, <code>ghc</code> complains: <code>Not in scope: data constructor \u2018ValidData\u2019</code>"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1461400788, "post_id": 36802764, "comment_id": 61190235, "body": "@HansLub The definition of <code>libFun</code> specifically meant this is a library function that operates on valid data. However, in that case you could also export an extraction function, like the other answer does, because <code>ValidData -&gt; MyBigData</code> is always safe."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1461401088, "post_id": 36802764, "comment_id": 61190313, "body": "@Bartek_Banachewicz: ... but you wouldn&#39;t be able to use your extraction function directly  in patterns; as you can using <code>viewPatterns</code>, .e.g. when writing a function that operates on <code>[ValidData]</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1461408510, "post_id": 36802764, "comment_id": 61192439, "body": "If you are already going to write a validation function it might be a good idea to go for <code>Either String MyBigData</code> or <code>Either [String] MyBigData</code> to include the first or all error messages. See maybe digestive-functors for some inspiration."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 5, "last_activity_date": 1461356790, "creation_date": 1461356790, "answer_id": 36802764, "question_id": 36802590, "link": "https://stackoverflow.com/questions/36802590/record-syntax-validate-contents-in-constructor/36802764#36802764", "title": "Record syntax: validate contents in constructor", "body": "<p>I'm going to post my first comment in a bit more elaborated way, and maybe you'll find this good enough.</p>\n\n<p>First, let's assume your data looks more or less like this:</p>\n\n<pre><code>data MyBigData = MyBigData {\n   a :: ...\n   b :: ...\n   ...\n   z :: ...\n}\n</code></pre>\n\n<p>Indeed, when replaced with smart constructor, you can't do much about that problem.</p>\n\n<p>However, assuming your library functions look more or less like this:</p>\n\n<pre><code>libFun :: MyBigData -&gt; Result\n</code></pre>\n\n<p>I propose the following solution. Create a wrapping type:</p>\n\n<pre><code>newtype ValidData = ValidData MyBigData\n</code></pre>\n\n<p>Don't export its constructor. Change your functions to:</p>\n\n<pre><code>libFun :: ValidData -&gt; Result\nlibFun (ValidData d) = ...\n</code></pre>\n\n<p>And put the validation logic in a function:</p>\n\n<pre><code>validate :: MyBigData -&gt; Maybe ValidData\n</code></pre>\n\n<p>Now when calling <code>validate</code> you can use record syntax, but you won't be able to use this data in any function that actually expects it in coherent state if you don't validate it first.</p>\n\n<pre><code>input = validate $ MyBigData { ... }\ncase input of:\n    Just d -&gt; libFun d\n    Nothing -&gt; ...\n</code></pre>\n\n<p>Of course in this case <code>validate</code> could also return <code>Either</code> or perhaps act monadically if you need that.</p>\n"}, {"comments": [{"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "edited": false, "score": 0, "creation_date": 1461402984, "post_id": 36804043, "comment_id": 61190801, "body": "See also: <a href=\"http://stackoverflow.com/questions/23893351/can-constraints-be-enforced-on-public-data-types/23893832#23893832\">Can constraints be enforced on public data types?</a>"}], "tags": [], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "is_accepted": false, "score": 2, "last_activity_date": 1461403298, "last_edit_date": 1461403298, "creation_date": 1461362851, "answer_id": 36804043, "question_id": 36802590, "link": "https://stackoverflow.com/questions/36802590/record-syntax-validate-contents-in-constructor/36804043#36804043", "title": "Record syntax: validate contents in constructor", "body": "<p>I would use  Bartek Banachewicz suggestion to use an auxiliary data type <code>Blueprint</code> with an open and unvalidated constructor, and <code>ActualData</code> smart constructor <code>fromBluePrint :: Blueprint -&gt; ActualData</code>, in combination with a trivial function </p>\n\n<pre><code> section :: ActualData -&gt; Blueprint\n</code></pre>\n\n<p>that just 'throws away'  the validation (meaning that <code>fromBlueprint . section</code> is the identity on <code>ActualData</code> - <em>section</em> is <a href=\"https://en.wikipedia.org/wiki/Section_(category_theory)\" rel=\"nofollow\">another name</a> for <em>right inverse</em>)</p>\n\n<p>Now, you can use <a href=\"https://ghc.haskell.org/trac/ghc/wiki/ViewPatterns\" rel=\"nofollow\">viewPatterns</a> and write code like</p>\n\n<pre><code> x :: ActualData\n x = fromBlueprint $ Blueprint {a=1, b=\"baz\",...}\n\n f :: ActualData -&gt; Int\n f (section -&gt; Blueprint{a=x}) = 2*x\n</code></pre>\n\n<p>using record syntax in constructing values of type <code>ActualData</code> and in patterns when defining functions on <code>ActualData</code> (or on more complicated types like <code>[ActualData]</code>, as views can be nested)</p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 1, "accepted_answer_id": 36802764, "answer_count": 2, "score": 3, "last_activity_date": 1461403298, "creation_date": 1461356092, "question_id": 36802590, "link": "https://stackoverflow.com/questions/36802590/record-syntax-validate-contents-in-constructor", "title": "Record syntax: validate contents in constructor", "body": "<p>I have a record with 12 values. There are a few combinations of values that are not valid, so I would like the constructor to check this. I only know how to make constructors that take a list of arguments, but that's not very pretty with 12 values. Thus, I would like to use record syntax when using the value after having constructed it.</p>\n\n<p>How do I enforce constraints in the constructor(s) and still use record syntax?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1461353868, "post_id": 36801909, "comment_id": 61178082, "body": "The complier checks for type equality, not isomorphism. Otherwise <code>newtype</code>s would be completely useless. Also, I would not want <code>case True of Left () -&gt; 1 ; Right () -&gt; 2</code> to type check."}, {"owner": {"reputation": 1981, "user_id": 1309045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c64b6bf711fe569da004b4db24aff21?s=128&d=identicon&r=PG", "display_name": "Spade", "link": "https://stackoverflow.com/users/1309045/spade"}, "edited": false, "score": 2, "creation_date": 1461354070, "post_id": 36801909, "comment_id": 61178188, "body": "compiler and his wife were driving to work today when a cop pulled them over. &quot;Do you know why I pulled you over&quot; the cop asks. &quot;No officer&quot; compiler replies. &quot;You were driving without a seatbelt.&quot; &quot;You must be mistaken officer, I had it on, see!&quot; They go back and forth about whether the seat belt was on for a few minutes. The cop then leans down and says to the woman &quot;Was compiler driving without his seat belt?&quot; The woman replies &quot;Officer, after forty years of marriage to compiler, I have learned one thing. Never argue with him when he&#39;s drunk!&quot; Compiler got a ticket. This is why he is angry."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461358522, "post_id": 36802014, "comment_id": 61180297, "body": "Yes, I asked about it, but I still don&#39;t understand. Nevertheless I make a small step of progress.  Is it possible to convert from <code>IO (Either String Bool)</code> to <code>ErrorT String IO Bool</code> ? It seems to me that it is sufficien to add (on the  begin) ErrorT"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461358673, "post_id": 36802014, "comment_id": 61180357, "body": "yes exactly! - that&#39;s what your last question was all about if I remember correctly - you indeed only need to wrap it with <code>ErrorT</code>"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1461387574, "last_edit_date": 1461387574, "creation_date": 1461353871, "answer_id": 36802014, "question_id": 36801909, "link": "https://stackoverflow.com/questions/36801909/why-compiler-is-getting-angry-with-isomorphic-types/36802014#36802014", "title": "Why compiler is getting angry with isomorphic types?", "body": "<p>it's a bit tricky to answer because there is no real question but the Compiler is not happy because the types might be <em>isomorphic</em> but they are not synonymous - there is a <code>ErrorT</code> in the way:</p>\n\n<pre><code>newtype ErrorT e m a = ErrorT m (Either e a)\n                       ^^^^^^\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html#v:ErrorT\" rel=\"nofollow\">see here</a></p>\n\n<p>you already had this in another one of your questions - it was the difference between something like</p>\n\n<pre><code>return (Left \"Hello\") :: IO (Either String Integer)\n</code></pre>\n\n<p>and </p>\n\n<pre><code>ErrorT (return (Left \"Hello\")) :: ErrorT String IO Integer\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 36802014, "answer_count": 1, "score": 1, "last_activity_date": 1461387574, "creation_date": 1461353439, "last_edit_date": 1461354073, "question_id": 36801909, "link": "https://stackoverflow.com/questions/36801909/why-compiler-is-getting-angry-with-isomorphic-types", "title": "Why compiler is getting angry with isomorphic types?", "body": "<pre><code>Expected type: ErrorT String IO Integer\nActual type: IO (Either String Integer)\n</code></pre>\n\n<p>I have no idea, where I am wrong. After all, these types are isomorphic.<br>\nOf course, when I replace my signature of function from  </p>\n\n<pre><code>ErrorT String IO Integer  \n</code></pre>\n\n<p>to  </p>\n\n<pre><code>IO (Either String Integer)\n</code></pre>\n\n<p>compiler is happy, but I am not happy because I am confused.</p>\n"}, {"tags": ["haskell", "dictionary", "io", "functional-programming", "ghc"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1461332622, "post_id": 36795438, "comment_id": 61165403, "body": "Servus Mauritius. Your indentation is\u2026 mixed. Can you please make sure that the code actually matches the one on your system? Also, <code>writeFile</code> <i>always</i> truncates files. Also, <code>bayerisch&#47;n</code> shouldn&#39;t work."}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461332815, "post_id": 36795438, "comment_id": 61165535, "body": "changed the indentation. so obviously i misunderstood the writeFile function. How can i change my program to save a pair of 2 words to a .txt File and after that newline?"}, {"owner": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "edited": false, "score": 2, "creation_date": 1461333894, "post_id": 36795438, "comment_id": 61166261, "body": "You <code>isNotEmpty</code> function could be simplified. You are basically doing <code>if condition then True else False</code>."}, {"owner": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "edited": false, "score": 4, "creation_date": 1461335356, "post_id": 36795438, "comment_id": 61167281, "body": "Did you try <code>&quot;\\n&quot;</code> instead of <code>&quot;&#47;n&quot;</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 0, "creation_date": 1461336722, "post_id": 36796856, "comment_id": 61168257, "body": "thanks for that version! do you also know how i can give the file that it should be saved in as an argument when you run it in shell? I tried with args&lt;- getArgs but it is not working"}, {"owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "reply_to_user": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 1, "creation_date": 1461337202, "post_id": 36796856, "comment_id": 61168594, "body": "Edited to accept a filename.  But beware, this will crash if no argument is passed, but will ignore any arguments past the first."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1461337376, "post_id": 36796856, "comment_id": 61168730, "body": "I would check if <code>deutsch</code> is null before writing it to the file."}], "tags": [], "owner": {"reputation": 587, "user_id": 1015602, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ea1629e2c2d1d82ab8c3645d82ecc60d?s=128&d=identicon&r=PG", "display_name": "Free_D", "link": "https://stackoverflow.com/users/1015602/free-d"}, "is_accepted": true, "score": 3, "last_activity_date": 1461337995, "last_edit_date": 1461337995, "creation_date": 1461336246, "answer_id": 36796856, "question_id": 36795438, "link": "https://stackoverflow.com/questions/36795438/haskell-newline-how/36796856#36796856", "title": "Haskell newline, how?", "body": "<p>Here's how I would do it.</p>\n\n<pre><code>import System.IO\nimport System.Environment\nimport Control.Monad\n\nmain :: IO ()\nmain = do\n  (fileName:_) &lt;- getArgs\n  unless (null fileName) $ \n    withFile fileName WriteMode makeDictionary\n  where    \n    makeDictionary :: Handle -&gt; IO()\n    makeDictionary h = do\n      putStrLn \"Deutsches Wort: \"\n      deutsch &lt;-getLine\n      if not . null $ deutsch\n        then do\n          hPutStr h $ deutsch++\" \"\n          putStrLn \"Bayerisches Wort: \"\n          bayerisch &lt;- getLine\n          hPutStrLn h bayerisch\n          putStrLn (deutsch ++ \" ist auf bayerisch \" ++ bayerisch)\n          makeDictionary h\n        else return()\n</code></pre>\n\n<p>Your revised version looks like it should work, but the advantages here is that the file is not being repeatedly opened and closed.  Although I'm not sure if GHC is smart enough to keep it open in your case.  Also, its generally better to check for empty strings with null instead of comparing to an empty list.</p>\n\n<p>Edited per chepner's comment.</p>\n"}], "owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 36796856, "answer_count": 1, "score": 0, "last_activity_date": 1461337995, "creation_date": 1461332348, "last_edit_date": 1461335196, "question_id": 36795438, "link": "https://stackoverflow.com/questions/36795438/haskell-newline-how", "title": "Haskell newline, how?", "body": "<p>i have got a problem with the following code. It is supposed to be a kind of dictionary asking first for a german word, than for a bavarian word and saving both in a .txt file. Then newLine for the next pair. Program terminates when you stop entering new words. UPDATE:\nThe newLine \"/n\" does not work. How can i solve that?</p>\n\n<pre><code> main :: IO ()\n main = do\n  putStrLn \"Deutsches Wort: \"\n  deutsch &lt;-getLine\n   if  deutsch  /= []\n    then do\n    putStrLn \"Bayerisches Wort: \"\n    bayerisch &lt;- getLine\n    appendFile \"woerterbuch.txt\" (deutsch++ \" \"++ bayerisch++ \" /n\")\n    putStrLn (deutsch ++ \" ist auf bayerisch \" ++ bayerisch)\n    main\n  else return()\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 3, "last_activity_date": 1461329896, "creation_date": 1461329896, "answer_id": 36794520, "question_id": 36794427, "link": "https://stackoverflow.com/questions/36794427/how-to-create-functor-definition-for-either-type/36794520#36794520", "title": "How to create Functor definition for Either type", "body": "<p>When you implement Functor, you need a type that accepts a single type argument. <code>Either1</code> accepts two type arguments, <code>a</code> and <code>b</code>, so your definition should look like this:</p>\n\n\n\n<pre class=\"lang-haskell prettyprint-override\"><code>instance Functor (Either1 a) where\n    fmap f (Left1 x) = Left1 x\n    fmap f (Right1 y) = Right1 (f y)\n</code></pre>\n\n<p>(I also fixed a compilation error in the <code>Left1</code> case; you were missing the <code>f</code> parameter)</p>\n\n<p>The online book, <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#the-functor-typeclass\" rel=\"nofollow\">Learn You a Haskell</a> has a great introduction on Functors which talks in depth about the partial application of <code>Either</code> described here.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1461329959, "last_edit_date": 1495541785, "creation_date": 1461329959, "answer_id": 36794542, "question_id": 36794427, "link": "https://stackoverflow.com/questions/36794427/how-to-create-functor-definition-for-either-type/36794542#36794542", "title": "How to create Functor definition for Either type", "body": "<p>As noted in the answer to your <a href=\"https://stackoverflow.com/q/36790797/1126841\">previous question</a>, functors require a type of kind <code>* -&gt; *</code>. <code>Either1</code> has kind <code>* -&gt; * -&gt; *</code>; you need to partially apply <code>Either1</code> to get a type of the proper kind.</p>\n\n<pre><code>&gt; :k Either1\nEither1 :: * -&gt; * -&gt; *\n&gt; :k Either1 Int\nEither1 Int :: * -&gt; *\n</code></pre>\n\n<p>When defining the <code>Functor</code> instance, it doesn't really matter to the functor what the first type is, so you can just specify an unconstrained type variable instead of a concrete type like <code>Int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461330647, "post_id": 36794751, "comment_id": 61163876, "body": "Aaaaaand just to clarify, the actual syntax for the last example is <code>instance forall a. Functor (Either a) where</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461330907, "post_id": 36794751, "comment_id": 61164068, "body": "Interesting, since when is <code>\u2200</code> actually legal in instance declarations? I&#39;m pretty sure it used not to be."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461331721, "post_id": 36794751, "comment_id": 61164721, "body": "Since I remember, but I&#39;m relatively new to Haskell :). Anyway, <a href=\"http://coliru.stacked-crooked.com/a/46a9b4be4fd21cab\" rel=\"nofollow noreferrer\">live example</a> (the undecidable bit isn&#39;t really the part of it)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461340380, "post_id": 36794751, "comment_id": 61170794, "body": "Typo (I think): you omitted the first argument to the <code>Left x</code> cases."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1461343589, "post_id": 36794751, "comment_id": 61172643, "body": "I think the thing that isn&#39;t allowed is something like <code>instance Functor (forall a. Either a) where ...</code> (which might be useful in some situations, if it were allowed)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1461343765, "last_edit_date": 1461343765, "creation_date": 1461330511, "answer_id": 36794751, "question_id": 36794427, "link": "https://stackoverflow.com/questions/36794427/how-to-create-functor-definition-for-either-type/36794751#36794751", "title": "How to create Functor definition for Either type", "body": "<p>You're completely right &ndash; it's a bit strange to have the functor instance work only on the right argument of <code>Either</code>.</p>\n\n<p>Indeed <code>Either</code> is not just a functor, it's a <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Bifunctor.html#t:Bifunctor\" rel=\"nofollow\">bifunctor</a>:</p>\n\n<pre><code>instance Bifunctor Either where\n    bimap f _ (Left a) = Left (f a)\n    bimap _ g (Right b) = Right (g b)\n</code></pre>\n\n<p>However, you may always consider a bifunctor to be also a &ldquo;monofunctor&rdquo; on one of the two functor-arguments. Because of how type-argument currying works, you have to choose the second one in Haskell. Essentially, you're working with &ldquo;half of the bifunctor&rdquo;! For instance,</p>\n\n<pre><code>type EitherStr = Either String  -- the `Right` argument is left open as the functor argument!\n\ninstance Functor EitherStr where\n  fmap _ (Left x) = Left x\n  fmap f (Right y) = Right (f y)\n</code></pre>\n\n<p>But of course this works for <em>any</em> given type, not just <code>String</code>. So you can just make the instance generic over the first argument:</p>\n\n<pre><code>\u2200 a . instance Functor (Either a) where\n  fmap _ (Left x) = Left x\n  fmap f (Right y) = Right (f y)\n</code></pre>\n\n<p>Well now, the <code>\u2200 a .</code> before an instance is just implicit in Haskell. If you want to make it explicit this is the correct syntax:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, UnicodeSyntax #-}\ninstance \u2200 a . Functor (Either a) where\n  fmap _ (Left x) = Left x\n  fmap f (Right y) = Right (f y)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 169, "user_id": 4386129, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000394595220/picture?type=large", "display_name": "BarbedWire", "link": "https://stackoverflow.com/users/4386129/barbedwire"}, "is_accepted": false, "score": 1, "last_activity_date": 1461331925, "last_edit_date": 1461331925, "creation_date": 1461331751, "answer_id": 36795222, "question_id": 36794427, "link": "https://stackoverflow.com/questions/36794427/how-to-create-functor-definition-for-either-type/36795222#36795222", "title": "How to create Functor definition for Either type", "body": "<p>In <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow\">Learn You A Haskell</a>, when you first meet term 'kind' you can find that you don't need to have thorough undestanding of this concept to move on, but seems to me that you should spend some extra time to pick the idea, because further material will become more and more tricky without a good comprehension of this issue.</p>\n\n<p>As mentioned above, Either has kind <code>* -&gt; * -&gt; *</code>, but Functor expects something with kind <code>* -&gt; *</code> - you may think of this as a type, parametrized with another (concrete) type - actually - type constructor. For example Int has kind <code>*</code>, <code>Maybe Int</code> has kind <code>*</code>, but <code>Maybe</code> has kind <code>* -&gt; *</code> - so the type constructor <code>Maybe</code> is a good candidate to be used in Functor. How can we achive the same kind with <code>Either a b</code> - again, use partial application to fix the first parameter and you'll get <code>Either a</code> - construction which is parametrized by one concrete type <code>b</code>. Here you should see, why first parameter is not changed in <code>fmap</code> function - couse it`s fixed. </p>\n\n<p>I apologize for some possible duplication of the first answer, but I remeber myself spending too much time and trying to undestand <code>kinds</code> - so I urgently needed somebody to give me simple explanation. </p>\n\n<p>Good luck learning! </p>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 36794542, "answer_count": 4, "score": 3, "last_activity_date": 1461343765, "creation_date": 1461329652, "last_edit_date": 1461330978, "question_id": 36794427, "link": "https://stackoverflow.com/questions/36794427/how-to-create-functor-definition-for-either-type", "title": "How to create Functor definition for Either type", "body": "<p>I am new to Haskell, trying to understand Functor. I took following code from Data.Either module (Replaced data Either with Either1). I just updated by removing 'Either1 a' and replaced it with 'Either1' (instance Functor <strong>Either1</strong> where).</p>\n\n<pre><code>data Either1 a b = Left1 a | Right1 b\n\ninstance Functor Either1 where\n    fmap f (Left1 x) = Left1 x\n    fmap f (Right1 y) = Right1 (f y)\n</code></pre>\n\n<p>When i try to load above snippet, I am getting following error.</p>\n\n<pre><code>Prelude&gt; :load Sample.hs\n[1 of 1] Compiling Main             ( Sample.hs, interpreted )\n\nSample.hs:3:18:\n    Expecting one more argument to \u2018Either1\u2019\n    The first argument of \u2018Functor\u2019 should have kind \u2018* -&gt; *\u2019,\n      but \u2018Either1\u2019 has kind \u2018* -&gt; * -&gt; *\u2019\n    In the instance declaration for \u2018Functor Either1\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>My question is, Why should I put \"Either1 a\" while defining fmap function, why can't 'Either1\" ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1461324938, "post_id": 36790987, "comment_id": 61159786, "body": "It&#39;s probably also worth noting that while there are kinds other than <code>*</code> (and combinations of <code>-&gt;</code> and <code>*</code>), you generally don&#39;t have to worry about them for general programming."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461344310, "post_id": 36790987, "comment_id": 61173038, "body": "And the usual terminology complaint: &quot;type constructor&quot; has a specific meaning which is not appropriate here. <code>Int</code>, <code>Bool</code>, <code>Maybe</code>, <code>Either</code>, and <code>StateT</code> are all type constructors of various kinds, some of which are not even higher kinds; <code>Either e</code> is <i>not</i> a type constructor but has the appropriate kind to be a <code>Functor</code>. Think by analogy to the term level: <code>True</code> and <code>False</code> are term constructors, even though their types have no arrows in them, whereas <code>(,) 3</code> is not a term constructor even though it has an arrow in its type."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461348581, "post_id": 36790987, "comment_id": 61175264, "body": "@DanielWagner what is the correct name? And where can I find a good reference - is type-operator better?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461348884, "post_id": 36790987, "comment_id": 61175419, "body": "@Carsten The Report is the canonical resource; the section on <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-650004.1.2\" rel=\"nofollow noreferrer\">the syntax of types</a> gives a good rundown of terminology. You can say that types whose kind have an arrow in them are <i>higher-kinded</i>. In the other direction, I have heard people use the term <i>concrete type</i> to refer to types of kind <code>*</code>."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1461350014, "last_edit_date": 1461350014, "creation_date": 1461320020, "answer_id": 36790987, "question_id": 36790797, "link": "https://stackoverflow.com/questions/36790797/haskell-need-to-understand-signature-of-functor/36790987#36790987", "title": "Haskell: need to understand signature of Functor", "body": "<p><code>*</code> is the syntax used by Haskell for <a href=\"https://wiki.haskell.org/Kind\" rel=\"nofollow\"><strong>kinds</strong></a> </p>\n\n<p>In this case it means that <code>f</code> is higher-kinded (think functions on the type level)</p>\n\n<p>Here <code>f</code> is taking one type (the first <code>*</code>) and is producing another type (the second <code>*</code>)</p>\n\n<p>you can basically forget all this here and just read it as:</p>\n\n<pre><code>class Functor f where\n  fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n  (&lt;$) :: a -&gt; f b -&gt; f a\n</code></pre>\n\n<p>but it's a nice documentation IMO and there are quite a few classes that are more complicated and the <em>kind-signature</em> is really helpful - for example:</p>\n\n<pre><code>class MonadTrans (t :: (* -&gt; *) -&gt; * -&gt; *) where\n  lift :: Monad m =&gt; m a -&gt; t m a\n        -- Defined in `Control.Monad.Trans.Class'\n</code></pre>\n\n<p>Here <code>t</code> takes a type-constructor itself (the Monad) together with another type and produces a type again.</p>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 36790987, "answer_count": 1, "score": 2, "last_activity_date": 1461350014, "creation_date": 1461319446, "last_edit_date": 1461320528, "question_id": 36790797, "link": "https://stackoverflow.com/questions/36790797/haskell-need-to-understand-signature-of-functor", "title": "Haskell: need to understand signature of Functor", "body": "<p>Can some body explain me the signature of Functor. </p>\n\n<pre><code>Prelude&gt; :info Functor\nclass Functor (f :: * -&gt; *) where\n  fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n  (&lt;$) :: a -&gt; f b -&gt; f a\n</code></pre>\n\n<p>I don't understand what <code>*</code> means.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1461305512, "post_id": 36785881, "comment_id": 61147559, "body": "It is time to read a chapter about monads, then."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1461325594, "post_id": 36785881, "comment_id": 61160240, "body": "\u201cself-teaching yourself Haskell can be hard sometimes\u201d \u2013 not that hard, if you consult some proper tutorials! Have you checked out <a href=\"http://stackoverflow.com/tags/haskell/info\">the recommended books</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 0, "creation_date": 1461306259, "post_id": 36786161, "comment_id": 61147931, "body": "More likely <code>iterate (\\ c -&gt; 2 * c + 1) 0</code>"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 0, "creation_date": 1461308285, "post_id": 36786161, "comment_id": 61149120, "body": "@wowofbob If you want <code>[0,1,3,7,15,31,63,...]</code> then yours is right."}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 0, "creation_date": 1461308799, "post_id": 36786161, "comment_id": 61149430, "body": "It is just closer to what OP described"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 1, "creation_date": 1461308887, "post_id": 36786161, "comment_id": 61149480, "body": "It is actually the solution. I usually avoid posting copy+paste ready solutions. Your mileage may vary, @wowofbob"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 1, "last_activity_date": 1461305393, "creation_date": 1461305393, "answer_id": 36786161, "question_id": 36785881, "link": "https://stackoverflow.com/questions/36785881/haskell-function-which-returns-a-different-value-each-time-it-iterates/36786161#36786161", "title": "Haskell - Function which returns a different value each time it iterates", "body": "<p>What you want is impossible in Haskell, for good reason, see below.</p>\n\n<p>There is a way to iterate over a function, however, by feeding it its own output in the next iteration.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>iterate (\\c -&gt; c + 2) 0\n</code></pre>\n\n<p>This creates the infinite list</p>\n\n<pre><code>[0,2,4,6,....]\n</code></pre>\n\n<p>Haskell is a pure language, and this means that a function can only access its arguments, constants, other functions and nothing else. Esqecially, there is no hidden state a function can access. Therefore, with the same input, a Haskell function will compute the same output all times. </p>\n"}, {"tags": [], "owner": {"reputation": 1679, "user_id": 1722752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef35ad86b627ba3176b6aea8a184f51c?s=128&d=identicon&r=PG", "display_name": "MigMit", "link": "https://stackoverflow.com/users/1722752/migmit"}, "is_accepted": false, "score": 2, "last_activity_date": 1461322549, "creation_date": 1461322549, "answer_id": 36791904, "question_id": 36785881, "link": "https://stackoverflow.com/questions/36785881/haskell-function-which-returns-a-different-value-each-time-it-iterates/36791904#36791904", "title": "Haskell - Function which returns a different value each time it iterates", "body": "<p>If you want to change something, that means you need mutable state. There are two options. First, you can make current state one of the arguments of your function, and the new state \u2014 part of a result. Like <code>addNum :: [Int] -&gt; ([Int], Int)</code>. There is a <code>State</code> monad that helps with that, giving an illusion that there actually is some mutable state.</p>\n\n<p>Secondly, you can store your state in an <code>IORef</code> and make your function use <code>IO</code> monad, like <code>addNum :: IORef [Int] -&gt; IO Int</code>. That way you can actually modify the state kept in the <code>IORef</code>. There are other monads that allow the same thing, like <code>ST</code>, which is great if your mutable state is used only locally, or <code>STM</code>, which helps if your application is highly concurrent.</p>\n\n<p>I would strongly recommend the first option though. Don't use <code>IO</code> (or other imperative things) until you absolutely need it.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1461351610, "creation_date": 1461351610, "answer_id": 36801451, "question_id": 36785881, "link": "https://stackoverflow.com/questions/36785881/haskell-function-which-returns-a-different-value-each-time-it-iterates/36801451#36801451", "title": "Haskell - Function which returns a different value each time it iterates", "body": "<p>You have encountered a situations where a programmer who is comfortable with Haskell would likely turn to monads.  In particular the <strong>state monad</strong>, for which there are a few reasonable tutorials online:</p>\n\n<ul>\n<li><a href=\"https://acm.wustl.edu/functional/state-monad.php\" rel=\"nofollow\">https://acm.wustl.edu/functional/state-monad.php</a></li>\n<li><a href=\"http://brandon.si/code/the-state-monad-a-tutorial-for-the-confused/\" rel=\"nofollow\">http://brandon.si/code/the-state-monad-a-tutorial-for-the-confused/</a></li>\n<li><a href=\"https://www.schoolofhaskell.com/school/starting-with-haskell/basics-of-haskell/12-State-Monad\" rel=\"nofollow\">https://www.schoolofhaskell.com/school/starting-with-haskell/basics-of-haskell/12-State-Monad</a></li>\n</ul>\n\n<p>I didn't quite understand the \"addNum\" operation you are trying to describe, and I think there's some flaws with your attempts to define it. For example, the fact that your code always expects a list of exactly one element suggests that there shouldn't be a list or a <code>foldl</code> at all\u2014just take <code>n</code> as an argument and add.  </p>\n\n<p>But from your description, I think the following approximates it as best as I can.  (This won't be understandable without studying monads and the state monad a little bit, but hopefully it gives you an example to work with in conjunction with other materials.)</p>\n\n<pre><code>import Control.Monad.State\n\n-- Add the previous `addNum` result to the argument.\naddNum :: Int -&gt; State Int Int\naddNum n = do\n  -- Precondition: the previous call to `addNum` used `put`\n  -- (a few lines below here) to record its result as the \n  -- implicit state for the `State` monad.\n  previous &lt;- get   \n  let newResult = previous + n\n\n  -- Here we fulfill the precondition above.\n  put newResult\n  return newResult\n</code></pre>\n\n<p>The idea of the <code>State</code> monad is that you have <code>get</code> and <code>put</code> actions such that executing <code>get</code> retrieves the value that was most recently given as argument to <code>put</code>.  To actually use <code>addNum</code> you need to do it within the context of a call to a function like <code>evalState :: State s a -&gt; s -&gt; a</code>, which forces you to specify the initial state that will be seen by the very first <code>get</code> in the very first use of <code>addNum</code>.  </p>\n\n<p>So, for example, here we use the <code>traverse</code> function to chain calls to <code>addNum</code> on consecutive elements of the list <code>[1..10]</code>.  Each call to <code>addNum</code> for each list element will <code>get</code> the <code>newResult</code> value that was <code>put</code> by the call for the previous element.  And the <code>0</code> argument to <code>evalState</code> means that the very first <code>addNum</code> call <code>get</code>s a 0:</p>\n\n<pre><code>&gt;&gt;&gt; evalState (traverse addNum [1..10]) 0\n[1,3,6,10,15,21,28,36,45,55]\n</code></pre>\n\n<p>If this feels overwhelming, well, for better or worse that's how Haskell feels at first.  Keep at it and build up slowly to examples like this one.</p>\n"}], "owner": {"reputation": 183, "user_id": 6133691, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d12022bcc552642e8dc3a545df1c42e?s=128&d=identicon&r=PG&f=1", "display_name": "R. Rengold", "link": "https://stackoverflow.com/users/6133691/r-rengold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1461351610, "creation_date": 1461304240, "question_id": 36785881, "link": "https://stackoverflow.com/questions/36785881/haskell-function-which-returns-a-different-value-each-time-it-iterates", "title": "Haskell - Function which returns a different value each time it iterates", "body": "<p>Say that I have a function:</p>\n\n<pre><code>doesAThing :: Int -&gt; ChangeState\n</code></pre>\n\n<p>For the purpose of this question it's not especially important what ChangeState is, only that doesAThing needs to take an Int as a parameter and that doesAThing iterates infinitely.</p>\n\n<p>What I want to do is take such a function:</p>\n\n<pre><code>addNum :: [Int] -&gt; Int\naddNum [n] = foldl (+) 0 ([n] ++ [n + 1])\n</code></pre>\n\n<p>and use it for doesAThing. Currently, the function works fine, however it doesn't do what I want it to do - it always returns the same number. The idea is that each time doesAThing iterates, addNum takes whatever its previous output was and uses that as addNum's parameter. I.e. :</p>\n\n<p>First iteration: say that n was set at 0. addNum returns 1 (0 + 0 + 1) and doesAThing uses that to modify ChangeState.</p>\n\n<p>Second iteration: now addNum takes 1 as its parameter, so that it returns 3 (0 + 1 + 2) and doesAThing uses that to modify ChangeState.</p>\n\n<p>Third iteration: now addNum takes 3 as its parameter, returns 7 (0 + 3 + 4) and doesAThing uses 7 to modify ChangeState.</p>\n\n<p>Etc.</p>\n\n<p>Apologies if this is a really noobish question, self-teaching yourself Haskell can be hard sometimes.</p>\n"}, {"tags": ["haskell", "threepenny-gui"], "answers": [{"tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 2, "last_activity_date": 1461442719, "creation_date": 1461442719, "answer_id": 36815934, "question_id": 36784182, "link": "https://stackoverflow.com/questions/36784182/monad-ui-element-vs-element/36815934#36815934", "title": "Monad: [UI Element] vs [Element]", "body": "<p>They key point is that the type <code>UI Element</code> denotes a (monadic) action that creates/manipulates/returns a thing, whereas the type <code>Element</code> denotes the thing itself. Sometimes, the former creates a new thing, sometimes it returns an old thing.</p>\n\n<p>In your case, <code>selectionList :: [UI Element]</code> is a list of actions that <em>create a thing</em> (each).</p>\n\n<p>In the wrong version, you first use <code>sequence</code> to execute all the actions in sequence, but then you also pass it the list to the  <code>#+</code> combinator, which internally executes all the actions in sequence as well. Hence, the actions are executed twice, so each element is created twice.</p>\n\n<p>In the correct version, you use <code>sequence</code> to execute all the actions in sequence and retain the corresponding new things (<code>Element</code>) in the list <code>selectionList'</code>. All elements have been created once, and then you simply pass them to whatever comes next. The combinator <code>pure</code> builds an action that simply returns an existing thing, that's it works.</p>\n\n<hr>\n\n<p>In the end, the type of <code>#+</code> may be a bit confusing, it would be more transparent if it accepted a list <code>[Element]</code> instead of a list <code>[UI Element]</code>. The latter reduces syntactic noise, though, as it reduces the need to name individual elements.</p>\n"}], "owner": {"reputation": 47, "user_id": 4862811, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47cb07a6d89a3248d45917da0fa71b0f?s=128&d=identicon&r=PG&f=1", "display_name": "CryptoCamel", "link": "https://stackoverflow.com/users/4862811/cryptocamel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 36815934, "answer_count": 1, "score": 1, "last_activity_date": 1461442772, "creation_date": 1461294915, "last_edit_date": 1461442772, "question_id": 36784182, "link": "https://stackoverflow.com/questions/36784182/monad-ui-element-vs-element", "title": "Monad: [UI Element] vs [Element]", "body": "<p>In the following code sample i tried to create a box with a number of select elements and combine their selection into a list of values using behaviors. (code compiles/runs in ghci with just threepenny-gui)</p>\n\n<pre><code>{-# LANGUAGE RecursiveDo #-}\nmodule Threepenny.Gui where\n\nimport Prelude hiding (lookup)\nimport Control.Monad\nimport Data.List\nimport Data.Traversable\nimport Data.Maybe\nimport Data.Monoid\nimport qualified Data.Map as Map\nimport qualified Data.Set as Set\n\nimport qualified Graphics.UI.Threepenny as UI\nimport Graphics.UI.Threepenny.Core hiding (delete)\n\n{-----------------------------------------------------------------------------\n    (#) Reverse function application: flip $\n    (#+) Append DOM elements as children to given element: parent #+ children\n    (#.) Returns UI Element with CSS class changed to second parameter\n------------------------------------------------------------------------------}\ngui :: IO ()\ngui = startGUI defaultConfig setup\n\nfixedTextarea = UI.textarea # set style [(\"resize\", \"none\"), (\"height\", \"14px\"), (\"width\", \"500px\")]\n\ncombinedBeh :: MonadIO m =&gt; [Element] -&gt; m (Behavior ([Maybe Int]))\ncombinedBeh sl = sequenceA &lt;$&gt; sequence blist\n  where blist  = fmap (stepper Nothing . UI.selectionChange ) sl\n\nselectDivWrong :: UI (Element, Behavior [Maybe Int])\nselectDivWrong = do \n  let select options = UI.select \n        # set style [(\"display\",\"inline-block\"), (\"width\", \"150px\"), (\"margin\", \"0px 0px 4px 0px\")]\n        #+ fmap (\\x -&gt; UI.option # set UI.text (show x)) options\n      selectionList :: [UI Element]\n      selectionList = replicate 6 $ select [0, 1, 2, 3, 4, 5]\n\n  selectionList' &lt;- (sequence selectionList :: UI [Element])\n  bSelectionList &lt;- combinedBeh selectionList'\n  mainBox        &lt;- UI.mkElement \"selectDiv\"\n    # set style [(\"display\",\"inline-block\"), (\"background-color\", \"#333344\"),\n     (\"height\", \"200px\"), (\"width\", \"150px\"), (\"padding\", \"1px\")] --\n    #+ (selectionList) -- unsequenced list of UI elements. The behavior (bSelectionList) should have all the info it needs though(?).\n-- why does (#+) not have the same UI info as bSelectionList ?\n\n  return (mainBox, bSelectionList)\n\nselectDivCorrect :: UI (Element, Behavior [Maybe Int])\nselectDivCorrect = do \n  let select options = UI.select \n        # set style [(\"display\",\"inline-block\"), (\"width\", \"150px\"), (\"margin\", \"0px 0px 4px 0px\")]\n        #+ fmap (\\x -&gt; UI.option # set UI.text (show x)) options\n      selectionList :: [UI Element]\n      selectionList = replicate 6 $ select [0, 1, 2, 3, 4, 5]\n\n  selectionList' &lt;- (sequence selectionList :: UI [Element])\n  bSelectionList &lt;- combinedBeh selectionList'\n  mainBox        &lt;- UI.mkElement \"selectDiv\"\n    # set style [(\"display\",\"inline-block\"), (\"background-color\", \"#333344\"),\n     (\"height\", \"200px\"), (\"width\", \"150px\"), (\"padding\", \"1px\")] --\n    #+ (fmap pure selectionList')\n\n  return (mainBox, bSelectionList)\n\nsetup :: Window -&gt; UI ()\nsetup window = void $ mdo\n  (sDiv1, bSDiv) &lt;- selectDivWrong\n  text1   &lt;- fixedTextarea # sink UI.text (show &lt;$&gt; bSDiv) \n\n  (sDiv2, bSDiv2) &lt;- selectDivCorrect\n  text2   &lt;- fixedTextarea # sink UI.text (show &lt;$&gt; bSDiv2) \n\n\n  getBody window \n    #+ [grid\n        [ [element sDiv1]\n        , [element text1]\n        , [element sDiv2]\n        , [element text2]\n        ]]  \n    # set style [(\"background-color\", \"#eeeeee\")]\n</code></pre>\n\n<p>Initially i wanted to use <code>selectDivWrong</code> but figured out that i need to modify it to <code>selectDivCorrect</code>. My problem is that i don't understand why there is a functional difference. in both cases <code>selectionList</code> contains all elements that need to be added and <code>bSelectionList</code> combines all behaviors. I'm not sure how <code>UI</code> handles all the state and events (and i haven't used monads/applicatives a whole lot yet), but i suspect that in the correct version the combined <code>UI</code> context is added to the 'top level' and thus passed to <code>(#+)</code> (or <code>UI.mkElement</code> ?), but remains unused in the list of <code>UI Element</code>s in the wrong version.</p>\n\n<p>I'm still not sure if i'm missing anything, though. I'd really like to be sure and find an explanation that helps identify this sort of issue in the future, since i basically found the solution via trial and error. (also feel free to rename the question...)</p>\n"}, {"tags": ["haskell", "continuous-integration", "travis-ci", "dependency-management", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1467840511, "post_id": 36783786, "comment_id": 63889784, "body": "Travis&#39; <a href=\"https://docs.travis-ci.com/user/ci-environment/#Haskell-VM-images\" rel=\"nofollow noreferrer\">Haskell VM images</a> don&#39;t have much that would be useful for a modern Haskell project. You should go with Michael Snoyman&#39;s advice or simply copy from other projects."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "edited": false, "score": 0, "creation_date": 1461318322, "post_id": 36786954, "comment_id": 61155472, "body": "it&#39;s too much complicated, it&#39;s unclear what to remove from it and what keep. why is the language &quot;c&quot;, not haskell?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "edited": false, "score": 1, "creation_date": 1461331896, "post_id": 36786954, "comment_id": 61164839, "body": "The reason is documented in the file: it&#39;s lighter weight, and we&#39;re providing our own build tools"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1461352736, "post_id": 36786954, "comment_id": 61177466, "body": "&quot;It used to be much smaller, but but we added support to that to build with both Stack and cabal, which complicated things a lot.&quot;  I have a project that copied one of those older, smaller <code>.travis.yml</code> files, so I&#39;ll just <a href=\"https://github.com/sacundim/tau-sigma/blob/master/.travis.yml\" rel=\"nofollow noreferrer\">link to it</a> for reference."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 3, "last_activity_date": 1461308092, "creation_date": 1461308092, "answer_id": 36786954, "question_id": 36783786, "link": "https://stackoverflow.com/questions/36783786/how-can-i-create-a-travis-script-for-haskel-stack/36786954#36786954", "title": "How can I create a travis script for Haskel/stack?", "body": "<p>There's a very thorough example at</p>\n\n<p><a href=\"http://docs.haskellstack.org/en/stable/GUIDE/#travis-with-caching\" rel=\"nofollow\">http://docs.haskellstack.org/en/stable/GUIDE/#travis-with-caching</a></p>\n\n<p>It used to be much smaller, but we added support to that to build with both Stack and cabal, which complicated things a lot. You can always trim it down to remove support for some of the more complicated features.</p>\n"}], "owner": {"reputation": 117, "user_id": 6128623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e1407a7a8512763aa48a722c864f66c?s=128&d=identicon&r=PG&f=1", "display_name": "Judi", "link": "https://stackoverflow.com/users/6128623/judi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1461308092, "creation_date": 1461292436, "last_edit_date": 1461294112, "question_id": 36783786, "link": "https://stackoverflow.com/questions/36783786/how-can-i-create-a-travis-script-for-haskel-stack", "title": "How can I create a travis script for Haskel/stack?", "body": "<p>I've seen quite a few travis stack scripts, they seemed pretty complicated, I don't think they have to be so complicated. </p>\n\n<p>Here's mine:</p>\n\n<pre><code>language: haskell\nsudo: false\n\nghc:\n- '7.10.3'\n</code></pre>\n\n<p>Locally I compile my app by \"stack build\". </p>\n\n<p>How can I add \"stack\" to the travis file properly? At the moment I need only stack, no tests.</p>\n"}, {"tags": ["haskell", "yesod", "query-parameters"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1461305934, "post_id": 36783412, "comment_id": 61147773, "body": "Relevant question: <a href=\"http://stackoverflow.com/questions/19046988/yesod-using-typesafe-urls-in-ajax-calls\" title=\"yesod using typesafe urls in ajax calls\">stackoverflow.com/questions/19046988/&hellip;</a>"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1461361316, "post_id": 36783412, "comment_id": 61181420, "body": "I think you might be best off using <a href=\"https://hackage.haskell.org/package/http-types-0.9/docs/Network-HTTP-Types-URI.html\" rel=\"nofollow noreferrer\">Network.HTTP.Types.URI</a> to generate the query string, then append that to the generated URL."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1461361484, "post_id": 36783412, "comment_id": 61181477, "body": "You could potentially use the <code>URI</code> data type in <a href=\"https://hackage.haskell.org/package/network-uri-2.6.1.0/docs/Network-URI.html\" rel=\"nofollow noreferrer\"><code>Network.URI</code></a> to avoid manipulating <code>Text</code>s."}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461289881, "creation_date": 1461289881, "question_id": 36783412, "link": "https://stackoverflow.com/questions/36783412/yesod-converting-resources-to-text-urls-to-be-put-in-a-json-api-including-quer", "title": "Yesod - converting resources to Text urls to be put in a JSON API including query parameters", "body": "<p>The function <code>getUrlRender</code> is used for converting <code>Route (HandlerSite m)</code> to <code>Text</code>, through the use of <code>Monads</code>. For instance:</p>\n\n<pre><code>routeToText :: MonadHandler m =&gt; Route (HandlerSite m) -&gt; m Text\nrouteToText url = do\n  r &lt;- getUrlRender\n  return $ r url\n\ngetTestR :: Text -&gt; Handler Text\ngetTestR something = routeToText (TestR something)\n</code></pre>\n\n<p>But what if I want to pass in a query parameter? Could I do it without dealing directly with <code>Text</code>s? Another question, could I simplify the type declaration of the function <code>routeToText</code>?</p>\n\n<p>I will use these urls to accomplish with a <a href=\"http://jsonapi.org/\" rel=\"nofollow\">JSON API specification</a> regarding pagination, I've created all the abstraction to work with it but I don't know how to implement a way to put a link like <code>http://example.com/articles?page=2</code> in a concise way. If there is a even better way to put the link with the query parameter integrating it beautifully with the <code>Aeson</code> library without converting it to <code>Text</code> first, please, let me know.</p>\n"}, {"tags": ["haskell", "heroku", "yesod"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1461286151, "post_id": 36781913, "comment_id": 61141793, "body": "Are you suggesting there might already be a <code>SIGTERM</code> handler installed, and you&#39;re worried about overwriting existing behavior? I wasn&#39;t sure what you meant by &quot;an ad-hoc addition of sigTERM handler and could prevent my app from gracefully shutting down other things&quot;"}, {"owner": {"reputation": 2097, "user_id": 1646823, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8471ef6adbd84694d3c37e445768a75f?s=128&d=identicon&r=PG", "display_name": "jvans", "link": "https://stackoverflow.com/users/1646823/jvans"}, "reply_to_user": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1461329534, "post_id": 36781913, "comment_id": 61163056, "body": "@MaxGabriel Yes I&#39;m worried I would be short circuiting existing handlers if I don&#39;t do this in the right place"}], "owner": {"reputation": 2097, "user_id": 1646823, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8471ef6adbd84694d3c37e445768a75f?s=128&d=identicon&r=PG", "display_name": "jvans", "link": "https://stackoverflow.com/users/1646823/jvans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1461330033, "creation_date": 1461279770, "last_edit_date": 1461330033, "question_id": 36781913, "link": "https://stackoverflow.com/questions/36781913/react-to-sigterm-with-yesod-application", "title": "react to SIGTERM with yesod application", "body": "<p>When I start up my yesod application, I create a connection to a rabbitmq server that I store in the <code>App</code> datatype to access during requests. When I deploy a new version of the app or restart my server, I want to gracefully close this connection. Something along the lines of:</p>\n\n<pre><code>import System.Posix.Signals(sigTERM, installHandler, Handler(..))\nappMain :: IO ()\nappMain = do\n    settings &lt;- loadAppSettingsArgs [configSettingsYmlValue] useEnv\n    foundation &lt;- makeFoundation settings\n    app &lt;- makeApplication foundation\n\n    --install shutdown handler here\n    installHandler sigTERM (Catch (closeConnection (rabbitmqConn app))) Nothing\n    runSettings (warpSettings foundation) app\n</code></pre>\n\n<p>however if i do this the process won't exit at all(and heroku will send a SIGKILL eventually. so I could do </p>\n\n<pre><code>import System.Posix.Signals(sigTERM, installHandler, Handler(..))\nimport System.Exit(exitSuccess)\nappMain :: IO ()\nappMain = do\n    settings &lt;- loadAppSettingsArgs [configSettingsYmlValue] useEnv\n    foundation &lt;- makeFoundation settings\n    app &lt;- makeApplication foundation\n\n    --install shutdown handler here, this time exit the process after we close the connection\n\n    installHandler sigTERM (Catch ((closeConnection $ rabbitmqConn conn) &gt;&gt; exitSuccess)) Nothing\n    runSettings (warpSettings foundation) app\n</code></pre>\n\n<p>However I'm worried that I might exit the application and prevent other handlers from running if I do this in the wrong place(and prevent gracefull shutdown of something else). I'm wondering if there is a place in my yesod app that I should be adding this type of code that will fit in with the rest of the framework.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 3, "creation_date": 1461275974, "post_id": 36781050, "comment_id": 61138802, "body": "What makes you think there is one?  They&#39;re essentially the same up to some newtyping."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1461276489, "post_id": 36781246, "comment_id": 61139004, "body": "<code>fail</code> is also implemented differently between them."}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461276647, "post_id": 36781246, "comment_id": 61139086, "body": "Thanks, haven&#39;t noticed that. However I prefer not to use <code>fail</code> because it restraints the error to be a <code>String</code>. It works for OP&#39;s case but I do not recommend it."}], "tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 1, "last_activity_date": 1461277021, "last_edit_date": 1461277021, "creation_date": 1461276130, "answer_id": 36781246, "question_id": 36781050, "link": "https://stackoverflow.com/questions/36781050/difference-between-two-monads-errort-e-identity-v-and-either-e-v/36781246#36781246", "title": "difference between two monads: ErrorT e Identity v and Either e v", "body": "<p>By convention, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Either.html#t:Either\" rel=\"nofollow\"><code>Either</code></a> is used to emulate an exception system, but it is not designed for that.</p>\n\n<p>That's why we use <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html#t:ErrorT\" rel=\"nofollow\"><code>ErrorT</code></a> for bigger implementations, since it comes with the <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html#t:Error\" rel=\"nofollow\"><code>Error</code></a> type, which allows the user to define more general exceptions.</p>\n\n<p>However, once you run with <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html#v:runErrorT\" rel=\"nofollow\"><code>runErrorT</code></a> the monadic action of type <code>ErrorT e Identity a</code>, you get a value of type <code>Either e a</code>. So, those types are somewhat equivalent, just that <code>ErrorT</code> allows you to use functions like <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html#v:throwError\" rel=\"nofollow\"><code>throwError</code></a> and <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html#v:catchError\" rel=\"nofollow\"><code>catchError</code></a> instead of <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Either.html#v:either\" rel=\"nofollow\"><code>either</code></a>, which is less clear (especially when repeatedly used).</p>\n\n<p>PS: As the documentation states, <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html\" rel=\"nofollow\"><code>Control.Monad.Error</code></a> is deprecated, <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html\" rel=\"nofollow\"><code>Control.Monad.Except</code></a> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 3, "last_activity_date": 1461285489, "last_edit_date": 1461285489, "creation_date": 1461279058, "answer_id": 36781783, "question_id": 36781050, "link": "https://stackoverflow.com/questions/36781050/difference-between-two-monads-errort-e-identity-v-and-either-e-v/36781783#36781783", "title": "difference between two monads: ErrorT e Identity v and Either e v", "body": "<p>(To simplify this, I'm going to answer in terms of the <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html\" rel=\"nofollow\"><code>ExceptT</code></a> type instead of <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error.html\" rel=\"nofollow\">the deprecated <code>ErrorT</code></a>.  My answer is not strictly true for <code>ErrorT</code>, but it's true modulo some annoying facts that led to the deprecation of <code>ErrorT</code>.)</p>\n\n<p>The key concept to understand here is <a href=\"https://en.wikipedia.org/wiki/Isomorphism\" rel=\"nofollow\"><strong>isomorphism</strong></a>.  To put it <em>very</em> informally, two types are isomorphic when, in spite of being superficially different, they are \"essentially the same.\"</p>\n\n<p>We can put a bit more meat on that notion by adding this concept: two Haskell types are isomorphic if both can be converted to the other in a \"lossless\" fashion by a pair of <strong>inverse functions</strong>.  In this case, <code>Either e a</code> and <code>EitherT e Identity a</code> are isomorphic because the following two functions are inverses:</p>\n\n<pre><code>toEither :: ExceptT e Identity a -&gt; Either e a\ntoEither ma = runIdentity (runExceptT ma)\n\ntoExceptT :: Either e a -&gt; ExceptT e Identity a\ntoExceptT (Left e) = throwError e\ntoExceptT (Right a) = return a\n</code></pre>\n\n<p>So going by the informal remarks above, what this tells you is that the two types are \"essentially the same.\"  And the meat that the inverse functions add to this is that they prove that:</p>\n\n<ol>\n<li>If you have any piece of code that uses either type, you can refactor it to use the other and the code will produce exactly the same results and behavior;</li>\n<li>If you have two separate libraries, one of them uses the first type and the other uses the second, you can bridge between them by using the isomorphism functions and everything will be fine.</li>\n</ol>\n\n<p>So what it comes down to is that in programming there are often many different ways of doing <em>exactly</em> the same thing.  In this case, <code>ExceptT</code> is a more general version of <code>Either</code>, but when you plug in <code>Identity</code> as the base monad you get something that works exactly the same as <code>Either</code> does.  We generally prefer to use <code>Either</code> in that case because then we don't have as much boilerplate, but still sometimes we find ourselves in a situation where we get <code>ExceptT e Identity a</code> and then knowing about the isomorphism helps you understand that it's not essentially different from <code>Either e a</code>.</p>\n\n<hr>\n\n<p>Here's another way to analyze this.  The <code>ExceptT</code> type is defined like this:</p>\n\n<pre><code>newtype ExceptT e m a = ExceptT { runExceptT :: m (Either e a) }\n</code></pre>\n\n<p>In Haskell, a <code>newtype</code> definition is an isomorphism (the <code>ExceptT</code> constructor and the <code>runExceptT</code> function are inverses), which in this case means the following two types are isomorphic:</p>\n\n<pre><code>ExceptT e m a ~ m (Either e a)\n</code></pre>\n\n<p>Which means that these two are isomorphic as well:</p>\n\n<pre><code>ExceptT e Identity a ~ Identity (Either e a)\n</code></pre>\n\n<p>But <code>Identity</code> is also defined as a <code>newtype</code>:</p>\n\n<pre><code>newtype Identity a = Identity { runIdentity :: a }\n</code></pre>\n\n<p>Which means that this isomorphism holds as well:</p>\n\n<pre><code>Identity a ~ a\n</code></pre>\n\n<p>And therefore so do these ones:</p>\n\n<pre><code>Identity (Either e a) ~ Either e a\nExceptT e Identity a ~ Either e a\n</code></pre>\n\n<p>So when a library transparently defines some type as a <code>newtype</code>, it pays to notice that fact.  (And that's why library documentation in Haskell tells you whether a data types with exported constructors is a <code>data</code> or a <code>newtype</code> definition\u2014knowing that it's a <code>newtype</code> is a big deal.) </p>\n\n<hr>\n\n<p>Another benefit of looking at this in terms of isomorphisms is that it often helps you understand a lot of standard Haskell libraries better.  As I said above, by the <code>newtype</code> definition of <code>ExceptT</code>, the following isomorphism holds</p>\n\n<pre><code>ExceptT e m a ~ m (Either e a)\n</code></pre>\n\n<p>When working with a monadic type of the form <code>m a</code>, we usually call <code>m</code> the \"monad\" and <code>a</code> the \"result type\".  Looking at it through this lens, then:</p>\n\n<ol>\n<li>In <code>m (Either e a)</code>, <code>m</code> is the monad and <code>Either e a</code> is the result type;</li>\n<li>In <code>ExceptT e m a</code>, <code>ExceptT e m</code> is the monad and <code>a</code> is the result type.</li>\n</ol>\n\n<p>So the <code>ExceptT</code> monad transformer is an isomorphism that allows us to \"flip the perspective\" on computations of type <code>m (Either e a)</code> so that we treat <code>a</code> as the result type instead of <code>Either e a</code>.  It does this by \"changing the meaning\" of the monad operations from what they mean in <code>m</code> to something that accounts for the \"perspective flip\" in question.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461285489, "creation_date": 1461275168, "question_id": 36781050, "link": "https://stackoverflow.com/questions/36781050/difference-between-two-monads-errort-e-identity-v-and-either-e-v", "title": "difference between two monads: ErrorT e Identity v and Either e v", "body": "<p>Can someone explain difference between </p>\n\n<pre><code>ErrorT String Identity Integer\n</code></pre>\n\n<p>and <code>Either String Integer</code> ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1461273388, "post_id": 36780534, "comment_id": 61137598, "body": "It works for the example you have given. What is an example of it not working?"}, {"owner": {"reputation": 1, "user_id": 6020363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98f271d9257f681d193f873099e03e4?s=128&d=identicon&r=PG&f=1", "display_name": "B.John", "link": "https://stackoverflow.com/users/6020363/b-john"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1461273515, "post_id": 36780534, "comment_id": 61137668, "body": "No the last line of code does not work. The compiler says group is not in scope."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1461274703, "post_id": 36780534, "comment_id": 61138205, "body": "Ahh, as baxbaxwalanuksiwe says that is because you are missing an <code>import</code>. In future questions, you should include any error messages you are getting."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461312824, "post_id": 36780534, "comment_id": 61151892, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/16108714/1523776\">stackoverflow.com/q/16108714/1523776</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 1, "creation_date": 1461274240, "post_id": 36780815, "comment_id": 61138005, "body": "You also need <code>Data.List</code> for <code>sort</code>, for some baffling reason."}, {"owner": {"reputation": 1, "user_id": 6020363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98f271d9257f681d193f873099e03e4?s=128&d=identicon&r=PG&f=1", "display_name": "B.John", "link": "https://stackoverflow.com/users/6020363/b-john"}, "edited": false, "score": 0, "creation_date": 1461274941, "post_id": 36780815, "comment_id": 61138319, "body": "Thank you for your answer, but like you said I am not allowed to do that. Is there any other way of solving the question, with the use of high order functions."}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1461275250, "post_id": 36780815, "comment_id": 61138487, "body": "Why are you not allowed to do that ? My solution (which is actually yours) uses the higher order function <code>map</code>."}, {"owner": {"reputation": 1, "user_id": 6020363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98f271d9257f681d193f873099e03e4?s=128&d=identicon&r=PG&f=1", "display_name": "B.John", "link": "https://stackoverflow.com/users/6020363/b-john"}, "edited": false, "score": 0, "creation_date": 1461275423, "post_id": 36780815, "comment_id": 61138568, "body": "The tasks says that I only have to declare import Data.List (sort) and nothing else."}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 2, "creation_date": 1461275585, "post_id": 36780815, "comment_id": 61138631, "body": "Try writing your own version of <code>group</code> then. Or try writing the function another way."}], "tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 2, "last_activity_date": 1461274744, "last_edit_date": 1495540778, "creation_date": 1461274134, "answer_id": 36780815, "question_id": 36780534, "link": "https://stackoverflow.com/questions/36780534/how-do-you-change-the-following-haskell-code-into-a-high-order-function/36780815#36780815", "title": "how do you change the following haskell code into a high order function?", "body": "<p>You could do this:</p>\n\n<pre><code>import Data.List (nub)\nrmdups = nub\n</code></pre>\n\n<p>But I assume that you're not allowed.</p>\n\n<p>Otherwise, your solution (<code>rmdups = map head . group . sort</code>) works for me.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36780534/how-do-you-change-the-following-haskell-code-into-a-high-order-function#comment61137668_36780534\">If the compiler says <code>group</code> or <code>sort</code> not in scope</a>, just import it from <code>Data.List</code>.</p>\n\n<p>PS: I believe you meant \"point free style\", not \"higher order function\"</p>\n\n<p>Edit: Thanks <a href=\"https://stackoverflow.com/users/3217013\">user3217013</a> for pointing <a href=\"https://stackoverflow.com/questions/36780534/how-do-you-change-the-following-haskell-code-into-a-high-order-function/36780815#comment61138005_36780815\">that</a> out.</p>\n"}], "owner": {"reputation": 1, "user_id": 6020363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98f271d9257f681d193f873099e03e4?s=128&d=identicon&r=PG&f=1", "display_name": "B.John", "link": "https://stackoverflow.com/users/6020363/b-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1461292419, "creation_date": 1461272954, "last_edit_date": 1461292419, "question_id": 36780534, "link": "https://stackoverflow.com/questions/36780534/how-do-you-change-the-following-haskell-code-into-a-high-order-function", "title": "how do you change the following haskell code into a high order function?", "body": "<p>Define a function</p>\n\n<pre><code>rmdups :: Eq a =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>that removes duplicates from a list. For example, <code>rmdups \"ababca\"</code> should return\n<code>\"abc\"</code>. The order of the elements in the output list is not important</p>\n\n<p>Here is what I have done so far: \nThis works: </p>\n\n<pre><code> rmdups :: Eq a =&gt; [a] -&gt; [a]\n rmdups [] = []\n rmdups (x:xs) = x : rmdups (filter(/= x) xs)\n</code></pre>\n\n<p>This does not work, what am I doing wrong:</p>\n\n<pre><code> rmdups = map head . group . sort\n</code></pre>\n"}, {"tags": ["algorithm", "sorting", "haskell", "time-complexity"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 7, "creation_date": 1461269593, "post_id": 36779451, "comment_id": 61135392, "body": "The first element is an awful choice of pivot. Also, your duplicate handling is outright wrong; any duplicates of the pivot go into both <code>smaller</code> and <code>larger</code>!"}, {"owner": {"reputation": 18924, "user_id": 3970411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f2479dbd50036c3d580be156c176fb?s=128&d=identicon&r=PG", "display_name": "Hamid Pourjam", "link": "https://stackoverflow.com/users/3970411/hamid-pourjam"}, "edited": false, "score": 3, "creation_date": 1461269945, "post_id": 36779451, "comment_id": 61135608, "body": "Quick sort is in-place! This is not quick sort."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461270211, "post_id": 36779451, "comment_id": 61135765, "body": "You also need to ensure that <i>all</i> occurrences of <code>x</code> appear in the output if it is not a unique value."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 18924, "user_id": 3970411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f2479dbd50036c3d580be156c176fb?s=128&d=identicon&r=PG", "display_name": "Hamid Pourjam", "link": "https://stackoverflow.com/users/3970411/hamid-pourjam"}, "edited": false, "score": 1, "creation_date": 1461270268, "post_id": 36779451, "comment_id": 61135792, "body": "@dotctor I can&#39;t find anything that says quicksort must be in-place (in fact, I can only find things that suggest that it is <i>usually</i>, but not always, in-place). The pivot choice isn&#39;t very effective here, but I would still say it&#39;s quicksort."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1461270308, "post_id": 36779451, "comment_id": 61135812, "body": "it should not get in infinite recursion , i have tried it on the list [10..1] and it works even the first element is the bigger one"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461270334, "post_id": 36779451, "comment_id": 61135826, "body": "@chepner This shouldn&#39;t cause an infinite loop because, at most, <code>smaller</code> and <code>larger</code> can only contain the tail of the list given to <code>qsort</code>."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1461270403, "post_id": 36779451, "comment_id": 61135871, "body": "Worry about correctness before efficiency. Try running a test on a small data set first."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1461270520, "post_id": 36779451, "comment_id": 61135921, "body": "@chris ,It is correct, i have  tried it on [1000..1] and it works fine in a short amount of time."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461270590, "post_id": 36779451, "comment_id": 61135971, "body": "Sorry, didn&#39;t look closely enough to see that <code>a</code> is pulled from <code>xs</code>, not <code>(x:xs)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1461270682, "post_id": 36779451, "comment_id": 61136020, "body": "@DavidYoung, I would say that QuickSort does not have to be in place, but that it absolutely requires a way to choose a pivot such that for some <code>p &gt; 0</code> and <code>r &lt; 1&#47;2</code>, the probability that the pivot is no more than <code>ceil (r * n)</code> places from the median is at least <code>p</code>. This generally means randomized pivoting, but you could make a case for median-of-medians or similar."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461270704, "post_id": 36779451, "comment_id": 61136031, "body": "@chepner, so the smallest will return the whole list and the largest will return and empty list, nothing to do with empty list and the function will continue recursivley with quick sort smaller"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461270748, "post_id": 36779451, "comment_id": 61136057, "body": "@khaledomar If the pivot is ever a non-unique value, it will be duplicated in the two results: <code>sort [1,2,3,2] =&gt; [1,2,2,2,3]</code>."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1461270780, "post_id": 36779451, "comment_id": 61136073, "body": "@khaledomar <code>qsort [(),()]</code> evaluates to <code>[(),(),()]</code>. I&#39;d recommend property testing with <a href=\"https://hackage.haskell.org/package/QuickCheck\" rel=\"nofollow noreferrer\">quickcheck</a>."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 18924, "user_id": 3970411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f2479dbd50036c3d580be156c176fb?s=128&d=identicon&r=PG", "display_name": "Hamid Pourjam", "link": "https://stackoverflow.com/users/3970411/hamid-pourjam"}, "edited": false, "score": 0, "creation_date": 1461345253, "post_id": 36779451, "comment_id": 61173538, "body": "@dotctor Since you are nitpicking: Quicksort is <b>usually not</b> strictly speaking in-place. It uses O(log n) space (for the recursive calls stack). In-place means O(1) memory usage (which means the only recursive calls you can do must be tail-recursive). Heapsort is usually implemented in-place."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1461271680, "post_id": 36779999, "comment_id": 61136585, "body": "To sort use sort shuffle then sort the sort shuffled sorts?"}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 7, "last_activity_date": 1461282426, "last_edit_date": 1461282426, "creation_date": 1461271133, "answer_id": 36779999, "question_id": 36779451, "link": "https://stackoverflow.com/questions/36779451/haskell-quick-sort-complexity/36779999#36779999", "title": "haskell quick sort complexity?", "body": "<p>The worst case time of quicksort is <em>n<sup>2</sup></em>. Your implementation uses the first element as the pivot, which results in worst-case performance when the input is sorted (or sorted in reverse).</p>\n\n<p>To get quicksort to perform at its expected complexity of <em>n</em> log <em>n</em>, you need either randomized pivot selection, or to randomly shuffle the input before sorting.</p>\n"}], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 2, "accepted_answer_id": 36779999, "answer_count": 1, "score": 4, "last_activity_date": 1484686763, "creation_date": 1461269313, "last_edit_date": 1484686763, "question_id": 36779451, "link": "https://stackoverflow.com/questions/36779451/haskell-quick-sort-complexity", "title": "haskell quick sort complexity?", "body": "<p>I run the below quick sort Haskell function (using merge and sort algorithm):</p>\n\n<pre><code>qsort []=[]\nqsort (x:xs) =\n  qsort smaller ++ [x] ++ qsort larger\n    where\n      smaller = [a | a &lt;- xs , a&lt;x ] -- edit\n      larger  = [b | b &lt;- xs , b&gt;=x ]\n</code></pre>\n\n<p>In order to test the runtime for this for a bit big amount of data, I run the below code:</p>\n\n<pre><code>qsort [100000,99999..0]\n</code></pre>\n\n<p>It takes till now 40 min and it is still running! Even a list of 100,000 is not that big, so:</p>\n\n<ol>\n<li>how could I handle data a billion of data?</li>\n<li>is this sort algorithm(merge and sort) takes less time in other language like C#, python...is this  a problem in haskell language</li>\n<li>how could I predict the runtime of an algorithm using its complexity?</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1461265088, "post_id": 36778193, "comment_id": 61132821, "body": "Your question could use a bit of work, it looks like your formatting is off and your wording isn&#39;t very clear.  Do you already have a function <code>eval</code>, or are you tasked to write one?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461265110, "post_id": 36778193, "comment_id": 61132840, "body": "well I guess it&#39;s your homework/exercise so you should start by telling us what you tried - do you even have the representation set up? Show us some code :D"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461265302, "post_id": 36778193, "comment_id": 61132953, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/36438057/i-o-loop-in-haskell/36441613#36441613\" title=\"i o loop in haskell\">stackoverflow.com/questions/36438057/i-o-loop-in-haskell/&hellip;</a> (<b>caution</b> the link will spoil the complete homework)"}, {"owner": {"reputation": 25, "user_id": 6020629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f03140fb86444a283d72730342714eb?s=128&d=identicon&r=PG&f=1", "display_name": "kim", "link": "https://stackoverflow.com/users/6020629/kim"}, "edited": false, "score": 0, "creation_date": 1461265688, "post_id": 36778193, "comment_id": 61133151, "body": "how can i make eval function with list of coefficient and value?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1461269723, "post_id": 36778193, "comment_id": 61135482, "body": "What is the definition of <code>polyEvaluate</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1461266764, "creation_date": 1461266764, "answer_id": 36778742, "question_id": 36778193, "link": "https://stackoverflow.com/questions/36778193/to-evaluate-polynomial-in-haskell/36778742#36778742", "title": "to evaluate polynomial in Haskell", "body": "<p>some hints...</p>\n\n<p>you can write a series of powers easily</p>\n\n<pre><code>powers n = iterate (*n) 1\n\n&gt; take 10 $ powers 2\n[1,2,4,8,16,32,64,128,256,512]\n</code></pre>\n\n<p>and combine this with your coefficients</p>\n\n<pre><code>&gt; zip [1,2,3] $ powers 20 \n[(1,1),(2,20),(3,400)]\n</code></pre>\n\n<p>you have to think what to do to change this to a sum of product of the pairs (use zipWith)</p>\n"}], "owner": {"reputation": 25, "user_id": 6020629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f03140fb86444a283d72730342714eb?s=128&d=identicon&r=PG&f=1", "display_name": "kim", "link": "https://stackoverflow.com/users/6020629/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1086, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1461266764, "creation_date": 1461264949, "last_edit_date": 1461266293, "question_id": 36778193, "link": "https://stackoverflow.com/questions/36778193/to-evaluate-polynomial-in-haskell", "title": "to evaluate polynomial in Haskell", "body": "<p>I have a function(<code>eval</code>) to evaluate polynomial.</p>\n\n<pre><code>eval coeffs value = .......\n</code></pre>\n\n<p><code>coeffs</code> is list of coefficents.</p>\n\n<p><code>value</code> is for <em>x</em> in math</p>\n\n<blockquote>\n  <p>Ex) to calculate\n  3x^2 + 2x + 1 with x=20</p>\n</blockquote>\n\n<p><code>coeffs</code> is stored reverse order. </p>\n\n<p>when I type coefficient like above, it is stored like this <code>[1,2,3]</code></p>\n\n<p>program working like this and last part is wrong (the value of the polynomial):\nhere is my code</p>\n\n<pre><code>getCoeff 0 ls = do  return ls\n\ngetCoeff n ls = do  putStr \"What is the x^\"\n            putStr (show(n-1))\n            putStr \" coefficient: \"\n            v &lt;- getLine\n            w &lt;- getCoeff (n-1) ((read v :: Float):ls)\n            return w\n\n\nevalpoly = do   putStr \"What is the degree of polynomial: \"\n        v &lt;- getLine    \n        l &lt;- (getCoeff ((read v :: Int)+1) [])\n        putStr \"What value do you want to evaluate at: \"\n        x &lt;- getLine    \n        putStr \"The value of the polynomial is: \"\n        putStr (show (polyEvaluate (l) (read x :: Float)))\n        putStr \"\\n\"\n\neval [] x = 0.0\neval (l) x = \n</code></pre>\n\n<hr>\n\n<pre><code>What is the degree of polynomial: 2\nWhat is the x^2 coefficient: 3\nWhat is the x^1 coefficient: 2\nWhat is the x^0 coefficient: 1\nWhat value do you want to evaluate at: 20\nThe value of the polynomial is 1241.0\n</code></pre>\n\n<p>how can I evaluate the polynomial with coefficient and x value?</p>\n"}, {"tags": ["haskell", "parallel-processing"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1461263236, "post_id": 36777606, "comment_id": 61131730, "body": "Square is almost a no op. You don&#39;t really gain anything from attempting to do it in parallel."}, {"owner": {"reputation": 2108, "user_id": 2200817, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4c13d246cf5226bf581cbfd451d9a50d?s=128&d=identicon&r=PG", "display_name": "allidoiswin", "link": "https://stackoverflow.com/users/2200817/allidoiswin"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1461263359, "post_id": 36777606, "comment_id": 61131809, "body": "@Cubic I was under the impression it should allocate parts of the list to different threads so there would be effectively less ops per thread."}], "answers": [{"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1461265325, "post_id": 36778258, "comment_id": 61132966, "body": "Squaring is so cheap that I would guess the list splitting in <code>parListChunk</code> also overwhelms the parallel gains."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1461265740, "post_id": 36778258, "comment_id": 61133180, "body": "Plus paralellization kills fusion, which would otherwise yield orders of magnitude speedup."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1461265934, "post_id": 36778258, "comment_id": 61133270, "body": "@Andr&#225;sKov&#225;cs: Indeed.  When <a href=\"https://github.com/sacundim/tau-sigma/pull/18\" rel=\"nofollow noreferrer\">I parallelized a program of mine</a> (using <code>parBuffer</code>, however) I observed precisely that sort of thing. The program computes a family of statistical functions over input data, and some much more expensive than others. So it made the fast ones a bit slower at the cost of making the slow ones much faster. With minimal effort."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 7, "last_activity_date": 1461265135, "creation_date": 1461265135, "answer_id": 36778258, "question_id": 36777606, "link": "https://stackoverflow.com/questions/36777606/haskell-parmap-performance/36778258#36778258", "title": "Haskell parMap performance?", "body": "<p>The problem is that <code>parMap</code> sparks a parallel computation for each individual list element.  It doesn't chunk the list at all as you seem to think from your comments\u2014that would require the use of the <a href=\"https://hackage.haskell.org/package/parallel-3.2.1.0/docs/Control-Parallel-Strategies.html#v:parListChunk\"><code>parListChunk</code></a> strategy.</p>\n\n<p>So <code>parMap</code> has high overheads, so the fact that each spark simply squares one number means that its cost is overwhelmed by that overhead.  </p>\n"}], "owner": {"reputation": 2108, "user_id": 2200817, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4c13d246cf5226bf581cbfd451d9a50d?s=128&d=identicon&r=PG", "display_name": "allidoiswin", "link": "https://stackoverflow.com/users/2200817/allidoiswin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 36778258, "answer_count": 1, "score": 5, "last_activity_date": 1461265135, "creation_date": 1461263082, "question_id": 36777606, "link": "https://stackoverflow.com/questions/36777606/haskell-parmap-performance", "title": "Haskell parMap performance?", "body": "<p>I was trying to bench parMap vs map with a very simple example: </p>\n\n<pre><code>import Control.Parallel.Strategies\nimport Criterion.Main\n\nsq x = x^2\n\na = whnf sum $ map sq [1..1000000]\nb = whnf sum $ parMap rseq sq [1..1000000]\n\nmain = defaultMain [\n    bench \"1\" a,\n    bench \"2\" b\n  ]\n</code></pre>\n\n<p>My results seem to indicate zero speedup from parMap and I was wondering why this might be?</p>\n\n<pre><code>benchmarking 1\nWarning: Couldn't open /dev/urandom\nWarning: using system clock for seed instead (quality will be lower)\ntime                 177.7 ms   (165.5 ms .. 186.1 ms)\n                     0.997 R\u00b2   (0.992 R\u00b2 .. 1.000 R\u00b2)\nmean                 185.1 ms   (179.9 ms .. 194.1 ms)\nstd dev              8.265 ms   (602.3 us .. 10.57 ms)\nvariance introduced by outliers: 14% (moderately inflated)\n\nbenchmarking 2\ntime                 182.7 ms   (165.4 ms .. 199.5 ms)\n                     0.993 R\u00b2   (0.976 R\u00b2 .. 1.000 R\u00b2)\nmean                 189.4 ms   (181.1 ms .. 195.3 ms)\nstd dev              8.242 ms   (5.896 ms .. 10.16 ms)\nvariance introduced by outliers: 14% (moderately inflated)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461260136, "post_id": 36776719, "comment_id": 61130105, "body": "well <code>True OR anything</code> <b>is</b> <code>True</code> ;) ... (it does <i>not</i> return the first member but the result of the or-operation - try <code>read &quot;True&quot; &amp;&amp; False</code> if you like)"}, {"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461260242, "post_id": 36776719, "comment_id": 61130149, "body": "Thank you! I had the same thought, just needed someone to clarify this for me. Thank you again."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461260264, "post_id": 36776719, "comment_id": 61130158, "body": "np - I guess it&#39;s as good as an answer as there could be(?)"}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "edited": false, "score": 0, "creation_date": 1461260334, "post_id": 36776773, "comment_id": 61130194, "body": "Oh, ok, I had it all wrong about the read function. Thank you, again."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 4, "last_activity_date": 1461260428, "last_edit_date": 1461260428, "creation_date": 1461260243, "answer_id": 36776773, "question_id": 36776719, "link": "https://stackoverflow.com/questions/36776719/the-read-function-in-haskell/36776773#36776773", "title": "The read function in Haskell", "body": "<p>well <code>True OR anything</code> <strong>is</strong> <code>True</code></p>\n\n<p>it does <em>not</em> return the first member but the result of the or-operation</p>\n\n<p>you should try </p>\n\n<pre><code>read \"True\" &amp;&amp; False\n</code></pre>\n\n<p>to see the difference</p>\n\n<hr>\n\n<p>maybe a slight remark/addition:</p>\n\n<p>In a sense you where right that it returns the first <em>component</em> - but only because <code>True || _ = True</code> so even <code>True || undefined</code> is ok:</p>\n\n<pre><code>Prelude&gt; read \"True\" || undefined\nTrue\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "edited": false, "score": 1, "creation_date": 1461260618, "post_id": 36776820, "comment_id": 61130348, "body": "Thank you very much, I appreciate your help a lot!"}], "tags": [], "owner": {"reputation": 21248, "user_id": 223274, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2a6aad3c8269beb376b3e2b0bd29bec4?s=128&d=identicon&r=PG", "display_name": "Ian Henry", "link": "https://stackoverflow.com/users/223274/ian-henry"}, "is_accepted": true, "score": 10, "last_activity_date": 1461260466, "creation_date": 1461260466, "answer_id": 36776820, "question_id": 36776719, "link": "https://stackoverflow.com/questions/36776719/the-read-function-in-haskell/36776820#36776820", "title": "The read function in Haskell", "body": "<p>Follow along in ghci!</p>\n\n<pre><code>Prelude&gt; let x = read \"True\"\nPrelude&gt; :t x\nx :: Read a =&gt; a\n</code></pre>\n\n<p>So <code>x</code> doesn't have a concrete type. <code>x</code> is sort of an expression that can <em>provide</em> a value of a concrete type, when we ask for it. We could ask <code>x</code> to be an <code>Int</code> or a <code>Bool</code> or anything we want. In particular:</p>\n\n<pre><code>Prelude&gt; x :: Bool\nTrue\n</code></pre>\n\n<p>We could also ask it to be an <code>Int</code>:</p>\n\n<pre><code>Prelude&gt; x :: Int\n*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>But it fails to become one.</p>\n\n<p>So in your code snippet, when did we ask it to become something?</p>\n\n<pre><code>Prelude&gt; :t (||)\n(||) :: Bool -&gt; Bool -&gt; Bool\n</code></pre>\n\n<p>The function <code>(||)</code> expects a <code>Bool</code>, so it asks its arguments to become <code>Bool</code>s. And as we already saw, when we ask <code>x</code> to become a <code>Bool</code>, it becomes the <code>Bool</code> value <code>True</code>. So saying:</p>\n\n<pre><code>Prelude&gt; x || False\nTrue\n</code></pre>\n\n<p>Is just like saying:</p>\n\n<pre><code>Prelude&gt; True || False\nTrue\n</code></pre>\n\n<p>And <code>(||)</code> represents <a href=\"https://en.wikipedia.org/wiki/Logical_disjunction\">the logical OR operation</a>, so the result is <code>True</code>.</p>\n"}], "owner": {"reputation": 140, "user_id": 4464901, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/dzvo2.jpg?s=128&g=1", "display_name": "Vaduva Mihaita Bogdan", "link": "https://stackoverflow.com/users/4464901/vaduva-mihaita-bogdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 0, "accepted_answer_id": 36776820, "answer_count": 2, "score": 2, "last_activity_date": 1461260466, "creation_date": 1461260017, "question_id": 36776719, "link": "https://stackoverflow.com/questions/36776719/the-read-function-in-haskell", "title": "The read function in Haskell", "body": "<p>I am new to the Haskell language and I having some issues with the read function.\nPrecisely, I understand that:</p>\n\n<pre><code>read \"8.2\" + 3.8\n</code></pre>\n\n<p>Should return 12.0 because we want to return the same type as the second member.\nThe thing that I don't really get is why does:</p>\n\n<pre><code>read \"True\" || False\n</code></pre>\n\n<p>Return True ? Ok, it returned the same type as False, which is Boolean, but what I don't understand is why the first member. I think I have a vague idea, like, the return function in this case will return the first member because the condition is || ?\nPlease help me out. Also, I am sorry if this is just basic for most of you guys, but I really want to undersand it. </p>\n"}, {"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1461258089, "post_id": 36776112, "comment_id": 61129001, "body": "You haven&#39;t shown enough code for us to see what you did wrong."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461258153, "post_id": 36776112, "comment_id": 61129033, "body": "Please at least give type signatures for the things you use that compile successfully, and full code of the bit you&#39;re stuck on."}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 0, "creation_date": 1461258666, "post_id": 36776112, "comment_id": 61129317, "body": "Your question isn&#39;t that clear. You want to create a directory and return something particular after that?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461258912, "post_id": 36776112, "comment_id": 61129428, "body": "why are people trying to obfuscate their code - you are learning and probably not producing the most beautiful code out there - that&#39;s fine - give us your worst we can handle - at least please give a full example showing your problem (including the errors you get) - as soon as I see a <code>...</code> I can already tell that the question is probably unanswerable"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461258996, "post_id": 36776112, "comment_id": 61129467, "body": "this is a great example as the snippet you&#39;ve shown should actually work and so the problem <b>is</b> most likely somewhere in the <code>...</code> black boxes"}, {"owner": {"reputation": 1, "user_id": 6236823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61a4ede1d517ed9b58991a5c6f9abcdc?s=128&d=identicon&r=PG", "display_name": "Severian", "link": "https://stackoverflow.com/users/6236823/severian"}, "edited": false, "score": 0, "creation_date": 1461262196, "post_id": 36776112, "comment_id": 61131131, "body": "Sorry guys, now it has actual code."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461263865, "post_id": 36776112, "comment_id": 61132081, "body": "We need type signatures for that other stuff you use!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1461264863, "post_id": 36776112, "comment_id": 61132676, "body": "The indentation looks a bit suspect. In fact, the lack of indentation in the type signature should prevent it from compiling right away with a syntax error, but I imagine that is a mistake in copying it over. What error message are you getting?"}, {"owner": {"reputation": 1, "user_id": 6236823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61a4ede1d517ed9b58991a5c6f9abcdc?s=128&d=identicon&r=PG", "display_name": "Severian", "link": "https://stackoverflow.com/users/6236823/severian"}, "edited": false, "score": 0, "creation_date": 1461277907, "post_id": 36776112, "comment_id": 61139536, "body": "Well, I was going to write what error message I was getting, but I wrote the code again and now it works. I think it was an indentation problem. I&#39;m sorry for any trouble I caused. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1461259225, "last_edit_date": 1461259225, "creation_date": 1461258763, "answer_id": 36776345, "question_id": 36776112, "link": "https://stackoverflow.com/questions/36776112/using-io-operations-but-returning-io-x/36776345#36776345", "title": "Using IO () operations, but returning IO X", "body": "<p>Example:</p>\n\n<pre><code>foo :: Int -&gt; IO Int\nfoo n = do\n   putStrLn \"Hello\"   -- :: IO ()\n   return (n+1)       -- :: IO Int\n</code></pre>\n\n<p>The last statement in the <code>do</code> block has to match with the function signature.</p>\n\n<p>Alternatively, use <code>&gt;&gt;</code> or <code>&gt;&gt;=</code>:</p>\n\n<pre><code>foo n = putStrLn \"Hello\" &gt;&gt; return (n+1)\nbar n = getChar &gt;&gt;= \\c -&gt; return (fromEnum c)\n</code></pre>\n\n<p>both have type <code>Int -&gt; IO Int</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6236823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61a4ede1d517ed9b58991a5c6f9abcdc?s=128&d=identicon&r=PG", "display_name": "Severian", "link": "https://stackoverflow.com/users/6236823/severian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1461261330, "answer_count": 1, "score": 0, "last_activity_date": 1461277224, "creation_date": 1461257983, "last_edit_date": 1461277224, "question_id": 36776112, "link": "https://stackoverflow.com/questions/36776112/using-io-operations-but-returning-io-x", "closed_reason": "Not suitable for this site", "title": "Using IO () operations, but returning IO X", "body": "<p>I have a function which returns IO X (assume X is a specific type). One of its arguments is a path to an output directory. If this doesn't exists, it has to be created.</p>\n\n<p>I wanted to use createDirectoryIfMissing which returns IO (), but I don't know how to keep the types consistent. What I did (and failed) was something like this:</p>\n\n<pre><code>process :: (Mutation a, Show a, Arbitrary a)\n=&gt; ((a -&gt; BSL.ByteString),(BS.ByteString -&gt; a))\n-&gt; Bool -&gt; FilePath -&gt; String -&gt; String -&gt;\nInt -&gt; Int -&gt; FilePath -&gt; FilePath -&gt; IO Result \nprocess (mencode,mdecode) par filename cmd prop maxSuccess maxSize outdir seeds =  \nlet (prog, args) = (Prelude.head spl, Prelude.tail spl)\nin (case prop of\n    \"exec\" -&gt;\n        quickCheckWithResult stdArgs { maxSuccess = maxSuccess , maxSize = maxSize, chatty = not par }\n        (noShrinking $ execprop filename prog args mencode outdir)\n    \"honggfuzz\" -&gt;\n        --do\n        --createDirectoryIfMissing True outdir (This fails)\n        quickCheckWithResult stdArgs { maxSuccess = maxSuccess , maxSize = maxSize, chatty = not par }\n        (noShrinking $ honggprop filename prog args mencode outdir)\n\n    _     -&gt; process_custom arbitrary (mencode,mdecode) par filename cmd prop maxSuccess maxSize outdir seeds\n\n) where spl = splitOn \" \" cmd\n</code></pre>\n\n<p>quickCheckWithResult :: Testable prop => Args -> prop -> IO Result\nprocess_custom is basically the same as process, but with another parameter</p>\n\n<p>EDIT: actual code now, sorry</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1461250748, "post_id": 36773370, "comment_id": 61123844, "body": "I think I might have found a config file for GHCi I could create, from <a href=\"https://downloads.haskell.org/~ghc/7.0-latest/docs/html/users_guide/ghci-dot-files.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/7.0-latest/docs/html/users_guide/&zwnj;&#8203;&hellip;</a> .. Checking it out now. It doesn&#39;t seem to change the defaults of GHC however."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1461250851, "post_id": 36773370, "comment_id": 61123912, "body": "You should rather want to <code>sed</code> all those tab characters out of your documents, methinks."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1461250899, "post_id": 36773370, "comment_id": 61123951, "body": "Replacing the tabs with spaces is an option, but that&#39;s not what I&#39;m after right now."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1461260973, "post_id": 36773370, "comment_id": 61130513, "body": "leftroundabout: what is the recommended way to <code>sed</code> this out?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1461324548, "post_id": 36773370, "comment_id": 61159509, "body": "@d8d0d65b3f7cf42 I&#39;d simply go with <code>sed &#39;s&#47;\\t&#47; \u2078&#47;g&#39; -i</code>, unless this doesn&#39;t work. (That&#39;s supposed to be <i>eight space characters</i>; StackOverflow doesn&#39;t let me use them in a code snippet. Of course, if your code is trimmed for 4-space tab width, use four spaces!) As this can go wrong in a number of ways; first try <code>sed &#39;s&#47;\\t&#47; \u2078&#47;g&#39; | view +&#39;setf haskell&#39; -</code> to see what happens."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1461346498, "post_id": 36773370, "comment_id": 61174159, "body": "@leftaroundabout it&#39;s not what my editor thinks about tabs, but what Haskell standard thinks, no? I know how to replace one char (tab) by a string (spaces) - I was hoping to learn about an sed trick that gets tab sematics right. Perhaps it&#39;s not needed (if lines start with all tabs)."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 1, "creation_date": 1461348636, "post_id": 36773370, "comment_id": 61175291, "body": "@d8d0d65b3f7cf42 Haskell standard is one tab means align to the next 8-spaces column. So you are right that simply replacing all tabs with 8 spaces will <b>not</b> work in general; you&#39;d need to add as much spaces until the column is a multiple of 8 for each tab."}], "answers": [{"tags": [], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "is_accepted": true, "score": 4, "last_activity_date": 1461264717, "last_edit_date": 1461264717, "creation_date": 1461251354, "answer_id": 36773684, "question_id": 36773370, "link": "https://stackoverflow.com/questions/36773370/globally-disable-a-default-warning/36773684#36773684", "title": "Globally disable a default warning", "body": "<p>For GHCi, a config file can be added to your AppData or home directory, as per <a href=\"https://downloads.haskell.org/~ghc/7.0-latest/docs/html/users_guide/ghci-dot-files.html\" rel=\"nofollow\">GHC documentation: The .ghci file</a>. For Windows this file is %APPDATA%\\ghc\\ghci.conf.</p>\n\n<p>You can add the following line, as described by <a href=\"https://downloads.haskell.org/~ghc/7.0-latest/docs/html/users_guide/options-sanity.html\" rel=\"nofollow\">the warnings page</a>, to disable the Tab warning in GHCi:</p>\n\n<pre><code>:set -fno-warn-tabs\n</code></pre>\n"}], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 1, "accepted_answer_id": 36773684, "answer_count": 1, "score": 1, "last_activity_date": 1461264717, "creation_date": 1461250615, "last_edit_date": 1461251072, "question_id": 36773370, "link": "https://stackoverflow.com/questions/36773370/globally-disable-a-default-warning", "title": "Globally disable a default warning", "body": "<p>Since the last update, GHCi is showing lots of <code>Warning: Tab character</code> messages and I want to set this warning message to be disabled by default.</p>\n\n<p>Is there a config file I can create/edit to set the <code>-fnowarn-tabs</code> flag globally?</p>\n"}, {"tags": ["haskell", "dependent-type", "type-families"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461253511, "post_id": 36773098, "comment_id": 61125912, "body": "May I ask why your <code>||</code> does not short-circuit? I&#39;d expect better reduction with <code>&#39;False || x = x; &#39;True || x = &#39;True</code>, for example."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461253634, "post_id": 36773098, "comment_id": 61125991, "body": "You should just use <a href=\"https://hackage.haskell.org/package/singletons-2.0.1/docs/Data-Singletons.html\" rel=\"nofollow noreferrer\"><code>singletons</code></a>, but if you aren&#39;t going to use it, you should see how they do it and copy it (because they do precisely what you want). In particular, you need a <i>non</i> associated data family <code>data family Sing (t :: k); class Singleton (t :: k) where sing :: Sing t</code> and <code>data instance Sing (b :: Bool) where ...</code>"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1461253660, "post_id": 36773098, "comment_id": 61126004, "body": "dfeuer: it could. That&#39;s besides the question, though."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461253928, "post_id": 36773098, "comment_id": 61126201, "body": "Also, I&#39;m having trouble seeing what your <code>OrProof</code> and <code>orProof</code> are supposed to express. They seem a bit ... roundabout. I know that doesn&#39;t relate directly to your question."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1461254276, "post_id": 36773098, "comment_id": 61126450, "body": "dfeuer: this is a simplified example for the question, but it allows you to do type-level logic without worrying about the inability of GHC (pre8) to reason about injectivity by carting around the arguments.  For example, <code>or :: (Boolean a, Boolean b) =&gt; SBool (a || b); or = case orProof of OrProof c -&gt; c</code> gives the old <code>NB: \u2018||\u2019 is a type function, and may not be injective</code> ambiguity error."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1461256043, "post_id": 36773098, "comment_id": 61127719, "body": "dfeuer: but I also need access to the structure of the final type, which I can&#39;t get from proxies."}], "answers": [{"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 4, "creation_date": 1461256471, "post_id": 36775528, "comment_id": 61127990, "body": "<code>singletons</code> pretty much has everything that&#39;s humanly possible with current GHC. It&#39;s not simple, so feel free to ask further questions if you have problems. I also have a number of singletons-related answers on this site which you may want to <a href=\"http://stackoverflow.com/search?q=user%3A1068232+singletons\">check out</a>."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1461256832, "last_edit_date": 1461256832, "creation_date": 1461256102, "answer_id": 36775528, "question_id": 36773098, "link": "https://stackoverflow.com/questions/36773098/replacing-singleton-data-types-with-a-data-family/36775528#36775528", "title": "Replacing singleton data types with a data family", "body": "<p>Your requested feature and much more can be found in <a href=\"https://hackage.haskell.org/package/singletons\" rel=\"nofollow\"><code>singletons</code></a>. It has been the  definitive template for type-level programming for quite a long time. You should either use it or copy the implementation. Anyway, I'll do here a brief showcase for a simplified <code>singletons</code> solution. </p>\n\n<p>Your pattern match doesn't work because <code>STrue</code> and <code>SFalse</code> are in different data definitions, and those aren't GADT to begin with. Pattern matching only refines types when done on proper GADT-s. We need to dispatch on <em>kinds</em>, in order to be able to group together all the singleton constructors of a kind.</p>\n\n<p>We can do this either with a proper kind class or a top-level data family. The latter is simpler for our purposes now, so let's do that:</p>\n\n<pre><code>data family Sing (x :: k)\n\ndata instance Sing (b :: Bool) where\n  STrue :: Sing True\n  SFalse :: Sing False\n</code></pre>\n\n<p>With <code>sing</code> we don't need kind dispatch because we only use it for getting specific lifted values, so the following works:</p>\n\n<pre><code>class SingI (x :: k) where\n   sing :: Sing x\n\ninstance SingI True  where sing = STrue\ninstance SingI False where sing = SFalse\n</code></pre>\n\n<p>As to <code>orProof</code>, what we'd like to have is a singleton for the type-level <code>(||)</code>, which is most straightforwardly accomplished with the following type : <code>Sing b1-&gt; Sing b2 -&gt; Sing (b1 || b2)</code>. We shall name it <code>(%:||)</code>, in accordance with the hieroglyphic <code>singletons</code> naming practice. </p>\n\n<pre><code>type family (:||) (b1 :: Bool) (b2 :: Bool) :: Bool where\n  True  :|| b = True\n  False :|| b = b\n\n(%:||) :: Sing b1 -&gt; Sing b2 -&gt; Sing (b1 :|| b2)\n(%:||) STrue  b2 = STrue\n(%:||) SFalse b2 = b2\n</code></pre>\n\n<p><code>OrProof</code> isn't very useful, since it's just a specialized equality type along with a <code>SingI</code> constraint or a plain <code>Sing c</code>:</p>\n\n<pre><code>type OrProof a b c = SingI c =&gt; c :~: (a :|| b)\ntype OrProof' a b c = (Sing c, c :~: (a :|| b))\n</code></pre>\n"}], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 36775528, "answer_count": 1, "score": 1, "last_activity_date": 1461256832, "creation_date": 1461250036, "question_id": 36773098, "link": "https://stackoverflow.com/questions/36773098/replacing-singleton-data-types-with-a-data-family", "title": "Replacing singleton data types with a data family", "body": "<p>So in my current project, I find myself doing a bunch of type-level logic with singleton types.</p>\n\n<p>For example:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE GADTs #-}\nmodule TypeBools where\n\ntype family (||) (a :: Bool) (b :: Bool) :: Bool where\n  'False  || 'False = 'False\n  'False  || 'True  = 'True\n  'True   || 'False = 'True\n  'True   || 'True  = 'True\n\ndata OrProof (a :: Bool) (b :: Bool) (c :: Bool) where\n  OrProof :: SBool (a || b) -&gt; OrProof a b (a || b)\n\ndata SBool (b :: Bool) where\n  SFalse  :: SBool 'False\n  STrue   :: SBool 'True\n\nclass Boolean b where\n  sBool :: SBool b\ninstance Boolean 'False where\n  sBool = SFalse\ninstance Boolean 'True where\n  sBool = STrue\n\norProof :: (Boolean a, Boolean b) =&gt; OrProof a b (a || b)\norProof = go sBool sBool where\n\n  go :: SBool a -&gt; SBool b -&gt; OrProof a b (a || b)\n  go SFalse SFalse = OrProof SFalse\n  go SFalse STrue = OrProof STrue\n  go STrue SFalse = OrProof STrue\n  go STrue STrue = OrProof STrue\n</code></pre>\n\n<p>And this is working pretty well for me. I like not having to cart around the the \nsingleton types manually, being able to summon them when necessary via typeclass \n(e.g. the <code>Boolean</code> class above), but this has led to a bunch of fairly similar \ntypeclasses that exist only to reify the type as singleton data.</p>\n\n<p>I thought maybe I could abstract those multiple typeclasses into a single type family,\nfor example replacing <code>SBool</code> and <code>Boolean</code> above with:</p>\n\n<pre><code>{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE ConstraintKinds #-}\n-- ...\nclass Singleton (t :: k) where\n  data Sing t\n  sing :: Sing t\n\ninstance Singleton 'False where\n  data Sing 'False = SFalse\n  sing = SFalse\n\ninstance Singleton 'True where\n  data Sing 'True = STrue\n  sing = STrue\n\ntype SBool b = Sing (b :: Bool)\n\ntype Boolean b = Singleton (b :: Bool)\nsBool :: Boolean b =&gt; SBool b\nsBool = sing\n</code></pre>\n\n<p>But then I get pattern match errors:</p>\n\n<pre><code>TypeBools2.hs:42:13:\n    Couldn't match type \u2018b1\u2019 with \u2018'True\u2019\n      \u2018b1\u2019 is a rigid type variable bound by\n           the type signature for\n             go :: SBool a1 -&gt; SBool b1 -&gt; OrProof a1 b1 (a1 || b1)\n           at TypeBools2.hs:40:9\n    Expected type: SBool b1\n      Actual type: Sing 'True\n    Relevant bindings include\n      go :: SBool a1 -&gt; SBool b1 -&gt; OrProof a1 b1 (a1 || b1)\n        (bound at TypeBools2.hs:41:3)\n    In the pattern: STrue\n    In an equation for \u2018go\u2019: go SFalse STrue = OrProof STrue\n    In an equation for \u2018orProof\u2019:\n        orProof\n          = go sBool sBool\n          where\n              go :: SBool a -&gt; SBool b -&gt; OrProof a b (a || b)\n              go SFalse SFalse = OrProof SFalse\n              go SFalse STrue = OrProof STrue\n              go STrue SFalse = OrProof STrue\n              go STrue STrue = OrProof STrue\n</code></pre>\n\n<p>I'm not sure whether there's something more I can convince the compiler\nthat <code>b1</code> should have kind <code>Bool</code>, or if I'm just barking up the wrong tree here.</p>\n"}]