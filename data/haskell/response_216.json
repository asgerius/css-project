[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 5, "creation_date": 1551308190, "post_id": 54915639, "comment_id": 96597855, "body": "This is a <i>very</i> complex definition - I&#39;m struggling to understand it! Here&#39;s some links to look through which may help, especially the first two: <a href=\"https://diogocastro.com/blog/2018/10/17/haskells-kind-system-a-primer/\" rel=\"nofollow noreferrer\">diogocastro.com/blog/2018/10/17/haskells-kind-system-a-prime&zwnj;&#8203;r</a>, <a href=\"https://blog.jle.im/entry/introduction-to-singletons-1.html\" rel=\"nofollow noreferrer\">blog.jle.im/entry/introduction-to-singletons-1.html</a>, <a href=\"https://wiki.haskell.org/Multi-parameter_type_class\" rel=\"nofollow noreferrer\">wiki.haskell.org/Multi-parameter_type_class</a>, <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"nofollow noreferrer\">wiki.haskell.org/Functional_dependencies</a>"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 6, "creation_date": 1551312603, "post_id": 54915639, "comment_id": 96599010, "body": "Just to make it very clear since you&#39;re new to Haskell, the code you&#39;re looking at is <i>very</i> expert Haskell code and is not the sort of thing you run into everyday, so not understanding it is totally normal. If I (a Haskell programmer going on five years) saw this in the wild without any comments, I wouldn&#39;t know what to do with it either."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1551352513, "post_id": 54915639, "comment_id": 96613494, "body": "I fear it will be impossible to provide a fully satisfactory answer here on SO for this question, since it involves a lot of advanced Haskell concepts (type classes with multiple args, fundeps, <code>Constraint</code> kind, type families, higher kinds, kind polymorphism, GADTs and singletons, proxies). Explaining this in detail so that a beginner could have a chance to understand would amount to writing a book. At best, be prepared for answers containing a lot of pointers to advanced stuff."}], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 3, "creation_date": 1551312586, "post_id": 54916438, "comment_id": 96599006, "body": "I&#39;m guessing that <code>Sing</code> is from the <a href=\"https://hackage.haskell.org/package/singletons\" rel=\"nofollow noreferrer\"><code>singletons</code></a> package."}, {"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551313210, "post_id": 54916438, "comment_id": 96599162, "body": "NOTE: I know that the bit on type families is not functionally very useful. It is really just  \u03b1 reduction of the Type Family manual entry.  Anyone who can explain what this type family accomplishes please chime in."}, {"owner": {"reputation": 807, "user_id": 5622918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ad13a5d38b48e837ffd6954a0cd2b9?s=128&d=identicon&r=PG&f=1", "display_name": "ddtraveller", "link": "https://stackoverflow.com/users/5622918/ddtraveller"}, "edited": false, "score": 1, "creation_date": 1551369121, "post_id": 54916438, "comment_id": 96623581, "body": "Thank you so much John. I really appreciate your time and knowledge in answering my question."}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": true, "score": 3, "last_activity_date": 1551312365, "creation_date": 1551312365, "answer_id": 54916438, "question_id": 54915639, "link": "https://stackoverflow.com/questions/54915639/haskell-class-definition-question-about-restrictions/54916438#54916438", "title": "Haskell class definition question about restrictions", "body": "<p>There is a lot going on here.  I am going to start by referring you to Sections <a href=\"https://downloads.haskell.org/~ghc/7.0.1/docs/html/users_guide/type-class-extensions.html\" rel=\"nofollow noreferrer\">7.6 Class and Instance Declarations</a>, <a href=\"https://downloads.haskell.org/~ghc/7.0.1/docs/html/users_guide/type-families.html\" rel=\"nofollow noreferrer\">7.7 Type Families</a>, and <a href=\"https://downloads.haskell.org/~ghc/7.0.1/docs/html/users_guide/other-type-extensions.html#kinding\" rel=\"nofollow noreferrer\">7.8.4 Explicitly-kinded qualifications</a> of the GHC language extension documentation.  (I am by no means an expert on any of these and clicked on your question hoping someone had supplied further enlightenment.)</p>\n\n<p>We are defining a multi-parameter type class called <code>IndexSelect</code> with parameters <code>k</code> and <code>m</code>. (Multi-parameter type classes 7.6.1.1)</p>\n\n<p>The second parameter of the class, <code>m</code>, is given an explicit kind qualification: <code>k -&gt; (* -&gt; *) -&gt; *</code> in English <code>m</code> must be a function which takes a <code>k</code> and a function and returns a value. (7.8.4 Explicitly-kinded quantification)</p>\n\n<p>The class has a functional dependency <code>| m -&gt; k</code>. Where the choice of <code>m</code> must uniquely determine <code>k</code> Given the name of this function that implies that a collection <code>m</code> must have only one kind of key <code>k</code> which is reasonable. (7.6.2 Functional Dependencies)</p>\n\n<p>The class forms a indexed type family <code>type Restriction m (p :: k) :: Constraint</code>. It appears inside a class definition so it is an associated type synonym. (7.7.2.1.1 Associated type family declarations). It takes some <code>m</code> and a <code>p</code> which must be of type <code>k</code> and results in a Constraint.</p>\n\n<p>The class has one listed method <code>indexSelect</code> which one might guess manages to extract information from a collection.  Without knowing what <code>Sing</code>, <code>LocalDb</code> and <code>TableEntity</code> do I cannot say more.</p>\n"}], "owner": {"reputation": 807, "user_id": 5622918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19ad13a5d38b48e837ffd6954a0cd2b9?s=128&d=identicon&r=PG&f=1", "display_name": "ddtraveller", "link": "https://stackoverflow.com/users/5622918/ddtraveller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 54916438, "answer_count": 1, "score": 7, "last_activity_date": 1551312365, "creation_date": 1551307105, "question_id": 54915639, "link": "https://stackoverflow.com/questions/54915639/haskell-class-definition-question-about-restrictions", "title": "Haskell class definition question about restrictions", "body": "<pre><code>class IndexSelect k (m :: k -&gt; (* -&gt; *) -&gt; *) | m -&gt; k where\n    type Restriction m (p :: k) :: Constraint\n    indexSelect :: Restriction m p =&gt; Sing (p :: k) -&gt; Proxy m -&gt; LocalDb f -&gt; f (TableEntity (m p))\n</code></pre>\n\n<p>I'm new to the Haskell language. I'm having trouble deciphering the class definition in some code in the code repo at the company I just started at.\nWhat is this doing?</p>\n"}, {"tags": ["haskell", "lambda", "functional-programming", "custom-data-type", "haskell-prelude"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1551299488, "post_id": 54913947, "comment_id": 96594311, "body": "You&#39;ll probably think this slightly pedantic, but you&#39;re not filtering based on type - all lists in Haskell consist of elements of only one type. You want to filter based on the <i>constructor</i> of the element."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1551300968, "post_id": 54913947, "comment_id": 96594969, "body": "That list comprehension basically works like <code>temp &lt;- dbes, x &lt;- case temp of { DbDate val -&gt; [val]; _ -&gt; [] }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1551307948, "post_id": 54914248, "comment_id": 96597766, "body": "You could also use <code>foldr</code> instead of the recursion"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 3, "last_activity_date": 1551300589, "creation_date": 1551300589, "answer_id": 54914248, "question_id": 54913947, "link": "https://stackoverflow.com/questions/54913947/how-to-define-a-lambda-function-that-filters-list-based-on-subtype-of-a-sum-type/54914248#54914248", "title": "How to define a lambda function that filters list based on subtype of a sum type?", "body": "<p>You were indeed on the right track, as pattern matching is an easy way of solving this, however you will get error as your pattern-matching is not comprehensive. Also, note that if you use filter, you will still get a list of <code>[DatabaseItem]</code> as filter never changes the type. You can however use <code>map</code> to do it. So:</p>\n\n<h1>Case Of</h1>\n\n<p>You can have a <code>case .. of</code> inside your lambda function:</p>\n\n<pre><code>filterDbDate' :: [DatabaseItem] -&gt; [UTCTime]\nfilterDbDate' = map (\\(DbDate x) -&gt; x) .filter (\\x -&gt;\n  case x of\n    DbDate x -&gt; True\n    _        -&gt; False)\n</code></pre>\n\n<h1>Recursion + Pattern Matching</h1>\n\n<p>However I think it's more clear using a recursion:</p>\n\n<pre><code>filterDbDate'' :: [DatabaseItem] -&gt; [UTCTime]\nfilterDbDate'' [] = []\nfilterDbDate'' ((DbDate d):ds) = d : filterDbDate ds\nfilterDbDate'' (_:ds)          =     filterDbDate ds\n</code></pre>\n\n<h1>Best Way</h1>\n\n<p>To be honest, when you have to mix up filter and map, and your lambdas are easy like this one, list comprehensions like yours are the cleanest way:</p>\n\n<pre><code>filterDbDate ds = [d | (DbDate d) &lt;- ds]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 5922388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d51926ef05c2bfb8599e4e5cef6315?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/5922388/niko"}, "is_accepted": false, "score": 6, "last_activity_date": 1551303342, "creation_date": 1551303342, "answer_id": 54914851, "question_id": 54913947, "link": "https://stackoverflow.com/questions/54913947/how-to-define-a-lambda-function-that-filters-list-based-on-subtype-of-a-sum-type/54914851#54914851", "title": "How to define a lambda function that filters list based on subtype of a sum type?", "body": "<p><code>filter</code> has the type <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code> so it is not able to change the type of your list.</p>\n\n<p>According to <a href=\"https://www.haskell.org/onlinereport/exps.html\" rel=\"noreferrer\">The Haskell 98 Report (section 3.11)</a> the list comprehension used in the code you found on github desugars to:</p>\n\n<pre><code>filterDbDate2 :: [DatabaseItem] -&gt; [UTCTime]\nfilterDbDate2 dbes = let extractTime (DbDate time) = [time]\n                         extractTime _             = []\n                     in concatMap extractTime theDatabase\n</code></pre>\n\n<p>You can rewrite <code>extractTime</code> to use <code>case ... of</code>:</p>\n\n<pre><code>filterDbDate3 :: [DatabaseItem] -&gt; [UTCTime]\nfilterDbDate3 dbes = let extractTime item = case item of (DbDate time) -&gt; [time]\n                                                         _             -&gt; []\n                     in concatMap extractTime theDatabase\n</code></pre>\n\n<p>And replace it by a lambda:</p>\n\n<pre><code>filterDbDate4 :: [DatabaseItem] -&gt; [UTCTime]\nfilterDbDate4 dbes = concatMap (\\item -&gt; \n    case item of \n        (DbDate time) -&gt; [time]\n        _             -&gt; []) \n    theDatabase\n</code></pre>\n\n<p>But imho your original solution using list comprehension looks the best:</p>\n\n<pre><code>filterDbDate dbes = [x | (DbDate x) &lt;- dbes]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 4, "last_activity_date": 1551308361, "last_edit_date": 1551308361, "creation_date": 1551305654, "answer_id": 54915338, "question_id": 54913947, "link": "https://stackoverflow.com/questions/54913947/how-to-define-a-lambda-function-that-filters-list-based-on-subtype-of-a-sum-type/54915338#54915338", "title": "How to define a lambda function that filters list based on subtype of a sum type?", "body": "<p>As @Niko has already said in his answer, <code>filter</code> cannot change the type. However, there is a variant of <code>filter</code> which can: <a href=\"https://www.stackage.org/haddock/lts-13.9/base-4.12.0.0/Data-Maybe.html#v:mapMaybe\" rel=\"nofollow noreferrer\"><code>Data.Maybe.mapMaybe :: (a -&gt; Maybe b) -&gt; [a] -&gt; [b]</code></a>. The idea is that if you want to keep an element, then you return <code>Just newvalue</code> from the lambda; otherwise you return <code>Nothing</code>. In that case, you could rewrite <code>filterDbDate</code> as:</p>\n\n<pre><code>import Data.Maybe\n\nfilterDbDate dbes = mapMaybe (\\x -&gt; case x of { DBDate d -&gt; Just d; _ -&gt; Nothing }) dbes\n</code></pre>\n\n<p>Personally, I would say that this is the second-clearest way to write this function (after the list comprehension method).</p>\n"}], "owner": {"reputation": 51, "user_id": 8016757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bedc85e3ce118741f1d62714a6cc1d6?s=128&d=identicon&r=PG&f=1", "display_name": "Adaskos07", "link": "https://stackoverflow.com/users/8016757/adaskos07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1551308361, "creation_date": 1551299260, "question_id": 54913947, "link": "https://stackoverflow.com/questions/54913947/how-to-define-a-lambda-function-that-filters-list-based-on-subtype-of-a-sum-type", "title": "How to define a lambda function that filters list based on subtype of a sum type?", "body": "<p>The example is taken from a \"Haskell programming from first principles\"\nThe goal of filter function is get rid of all the objects except those of 'DbDate' type.</p>\n\n<p>On somone's github I found a way to filter sum types with list comprehension and pattern matching(1). Now I am trying to find a way to redefine this filter with a lambda function(2) or normal \"case of\" of \"if then\" function. I do not know how to properly check the type of arguments of a function when I deal with custom data type.</p>\n\n<p>Book doesn't introduce the reader to any super specific library functions, just standard maps, folds, filters and other stuff you'd find in prelude. </p>\n\n<pre><code>import Data.Time\n\ndata DatabaseItem = DbString String\n                  | DbNumber Integer\n                  | DbDate   UTCTime\n                  deriving (Eq, Ord, Show)\n\n--List that needs to be filtered\ntheDatabase :: [DatabaseItem]\ntheDatabase =\n  [ DbDate (UTCTime (fromGregorian 1911 5 1)\n                    (secondsToDiffTime 34123))\n  , DbNumber 9001\n  , DbString \"Hello, world!\"\n  , DbDate (UTCTime (fromGregorian 1921 5 1)\n                    (secondsToDiffTime 34123))\n  ]\n\n\n\n--1 works fine, found on someone's git hub\nfilterDbDate :: [DatabaseItem] -&gt; [UTCTime]\nfilterDbDate dbes = [x | (DbDate x) &lt;- dbes]\n\n--2 Looking for the eqivalents with lambda or \"case\" or \"if then\"\n--pattern is not satisfactory\n\nfilterDbDate :: [DatabaseItem] -&gt; [UTCTime]\nfilterDbDate dbes = filter (\\(DbDate x) -&gt; True) theDatabase\n</code></pre>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1551297432, "creation_date": 1551297432, "answer_id": 54913523, "question_id": 54912689, "link": "https://stackoverflow.com/questions/54912689/how-constraints-in-the-context-change-instance-resolution-in-haskell/54913523#54913523", "title": "How constraints in the context change instance resolution in Haskell", "body": "<p>Essentially, instance selection is performed at compile-time, only. At runtime, there is no type information around, and there is no list of instances stored anywhere to drive the instance selection.</p>\n\n<p>So, what is happening in your instances? Consider the first case:</p>\n\n<pre><code>instance {-# OVERLAPPING #-} C [a] where\n  f [] = \"empty list\"\n  f (x : xs) = \"list of \" ++ f x\n</code></pre>\n\n<p>Assume that <code>f</code> is passed a list of type <code>[a0]</code> (let's use a fresh variable name for clarity). We then need to type check <code>f x</code> in the last line. Variable <code>x</code> above has type <code>a0</code>, so GHC needs to solve <code>C a0</code>. For that, GHC has to pick some instance. Normally it would refuse to choose <code>instance C a</code> since <code>instance C Int</code> also exists, and GHC does not know whether <code>a0 = Int</code>, so no single instance can be picked as the \"definitive\" one with only the information at hand.</p>\n\n<p>However, the \"overlapping\" pragma instructs GHC to pick the single best instance among those that are general enough to solve the constraint. Indeed, that's the best we can do with the information at hand: the only other reasonable option is to raise an error.</p>\n\n<p>In this case, to solve <code>C a0</code> we need to pick one of the three instances, and only <code>instance C a</code> is general eonugh to match <code>C a0</code> (after all, <code>a0</code> could be a non-<code>Int</code>, non-list type). So we pick that.</p>\n\n<p>Instead, using</p>\n\n<pre><code>instance {-# OVERLAPPING #-} (C a) =&gt; C [a] where\n  f [] = \"empty list\"\n  f (x : xs) = \"list of \" ++ f x\n</code></pre>\n\n<p>opens a fourth option to solve <code>C a0</code>, namely using the context <code>C a0</code> which is available. When <code>f</code> is called, it is being passed an implicit argument carrying a dictionary for <code>C a0</code> (i.e. the <code>f</code> for the type <code>a0</code>).</p>\n\n<p>So, now GHC has two viable options: solving <code>C a0</code> using the <code>C a0</code> context (i.e. using the implicit argument), or resorting to the global <code>instance C a</code>. The first one is more specific, since it applies only to <code>a0</code> rather than to any type <code>a</code>, so it is considered to be the \"best\", and chosen.</p>\n"}], "owner": {"reputation": 85, "user_id": 8930059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210486235700399/picture?type=large", "display_name": "Pond Premtoon", "link": "https://stackoverflow.com/users/8930059/pond-premtoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 54913523, "answer_count": 1, "score": 3, "last_activity_date": 1551297432, "creation_date": 1551294047, "last_edit_date": 1551294881, "question_id": 54912689, "link": "https://stackoverflow.com/questions/54912689/how-constraints-in-the-context-change-instance-resolution-in-haskell", "title": "How constraints in the context change instance resolution in Haskell", "body": "<p>I am trying to understand how adding a constraint to an instance context changes instance resolution in Haskell. In this example:</p>\n\n<pre><code>class C a where\n  f :: a -&gt; [Char]\n\ninstance {-# OVERLAPPABLE #-} C a where\n  f = const \"thing\"\n\ninstance C Int where\n  f = const \"int\"\n\ninstance {-# OVERLAPPING #-} C [a] where\n  f [] = \"empty list\"\n  f (x : xs) = \"list of \" ++ f x\n\nmain = do\n  putStrLn $ f (1 :: Int)\n  putStrLn $ f [(True :: Bool)]\n  putStrLn $ f [(1 :: Int)]\n  putStrLn $ f [[(1 :: Int)]]\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>int\nlist of thing\nlist of thing\nlist of thing\n</code></pre>\n\n<p>The last two lines are not what I want. For the 3rd line, it seems that the compiler (or runtime?), when running <code>f</code> for the list instance, doesn't know that <code>a</code> is <code>Int</code> and just uses the default <code>C a</code> instance. Similarly for the last line, it can't figure out that <code>a</code> is another list. However, if I add a context to the list instance:</p>\n\n<pre><code>instance {-# OVERLAPPING #-} (C a) =&gt; C [a] where\n  f [] = \"empty list\"\n  f (x : xs) = \"list of \" ++ f x\n</code></pre>\n\n<p>The output becomes:</p>\n\n<pre><code>int\nlist of thing\nlist of int\nlist of list of int\n</code></pre>\n\n<p>...which is what I want. Can someone help explain how that constraint changes the instance resolution in this example? Are there any general rules I can look at? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 3, "creation_date": 1551294679, "post_id": 54912654, "comment_id": 96592153, "body": "Your <code>findLetter&#39;</code> function is equivalent to the <code>lookup</code> function in the <code>Prelude</code>. Don&#39;t reinvent the wheel."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551294801, "post_id": 54912654, "comment_id": 96592216, "body": "You might find it easier to split <code>&quot;B1 C5&quot;</code> into a list of strings <code>[&quot;B1&quot;, &quot;C5&quot;]</code> first (keeping in mind that a <code>String</code> is really a <code>[Char]</code>, and <code>&quot;B1&quot;</code> is just <code>[&#39;B&#39;, &#39;1&#39;]</code>). The built-in <code>words</code> function will do that for you"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551294859, "post_id": 54912654, "comment_id": 96592245, "body": "The main problem I see is that you&#39;re trying to <code>read</code> a <code>Char</code> in the case of <code>b</code> and <code>d</code>, while <code>read</code> only accepts a <code>String</code> argument. (Likewise you&#39;re feeding the wrong type to <code>findLetter</code>)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551295047, "post_id": 54912654, "comment_id": 96592330, "body": "And regarding <code>findLettet</code>, besides using <code>lookup</code>, you don&#39;t need your <code>accoList</code> at all if you use the <code>ord</code> function from <code>Data.Char</code> (you&#39;ll have to subtract a constant from its output, but that&#39;s all, apart from using <code>show</code> if you insist on the output being a <code>String</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 2, "last_activity_date": 1551294909, "creation_date": 1551294909, "answer_id": 54912891, "question_id": 54912654, "link": "https://stackoverflow.com/questions/54912654/haskell-translate-string-to-int/54912891#54912891", "title": "haskell translate string to Int", "body": "<p>The problem is that you confuse <code>Char</code>s with <code>String</code>s. </p>\n\n<p>When you pattern-match a <code>String</code> to <code>(a:b:c:d:e:xs)</code>, all the elements except for <code>xs</code> are actually <code>Char</code>s and not <code>String</code> -- that's why <code>xs</code> has an 's' at the end, remember Strings are lists.</p>\n\n<p>So the findLetter should have signature <code>findLetter :: Char -&gt; String</code> as it takes a <code>Char</code> from <code>userToMove1</code> and returns a String from <code>accoList</code></p>\n\n<p>Also it doesn't really make sense for findLetter to return a String, you can either read the string in <code>findLetter</code> itself or even better have an Int in the tuple. This is how I would write this:</p>\n\n<pre><code>accoList = [('A', 1),('B', 2),('C', 3),('D', 4),('E', 5),('F', 6),('G', 7),('H', 8)]\n\nfindLetter :: Char -&gt; Int\nfindLetter c = findLetter' c accoList\n  where findLetter' c ((x,y):xs)\n    | x == c    = y\n    | otherwise = findLetter' c xs\n\n\nuserToMove1 :: String -&gt; ((Int, Int),(Int, Int))\nuserToMove1 s = userToMove' $ take 5 s\n  where userToMove' (a:b:c:d:e:[]) =  ((read b , findLetter a),(read e, findLetter d))\n</code></pre>\n\n<p>Finally, I'd like to say that this code looks weird, and there's probably a better way of achieving whatever you want to achieve</p>\n"}, {"tags": [], "owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "is_accepted": false, "score": 1, "last_activity_date": 1551294941, "creation_date": 1551294941, "answer_id": 54912900, "question_id": 54912654, "link": "https://stackoverflow.com/questions/54912654/haskell-translate-string-to-int/54912900#54912900", "title": "haskell translate string to Int", "body": "<p>Your pattern match <code>(a:b:c:d:e:xs)</code> takes the first 5 characters of the string; each is of type <code>Char</code> and not of type <code>String</code>, which is a synonym for <code>[Char]</code>. Because the type doesn't match, it can't find appropriate functions for <code>read</code> or <code>findLetter</code>.</p>\n\n<p>You can fix the immediate problem by converting the characters back to strings, thus:</p>\n\n<pre><code>where userToMove' (a:b:c:d:e:xs) =  ((read [b] , (read (findLetter [a]))),((read [e]), (read (findLetter [d]))))\n</code></pre>\n\n<p>Also, you could redefine <code>findLetter</code> as:</p>\n\n<pre><code>findLetter c = fromJust $ lookup c accoList\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 5922388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d51926ef05c2bfb8599e4e5cef6315?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/5922388/niko"}, "is_accepted": false, "score": 0, "last_activity_date": 1551296096, "last_edit_date": 1551296096, "creation_date": 1551295747, "answer_id": 54913109, "question_id": 54912654, "link": "https://stackoverflow.com/questions/54912654/haskell-translate-string-to-int/54913109#54913109", "title": "haskell translate string to Int", "body": "<p>In ghci you can use <code>:t userToMove1</code> to inspect the inferred type of your function. In your case this returns:</p>\n\n<pre><code>*Main&gt; :t userToMove1\nuserToMove1\n  :: (Read t, Read t1, Read t2, Read t3) =&gt;\n     [String] -&gt; ((t3, t2), (t1, t))\n</code></pre>\n\n<p>ghci inferred that your input parameter is a List of Strings instead of just a String, like you want it to be. </p>\n\n<p>Why does this happen?</p>\n\n<p>In <code>userToMove1</code> you pattern match on a List and feed the elements of the List to your <code>findLetter</code> function. Those expect Strings, therefore the matched elements (a,b,c,d,e) must be Strings, therefore <code>s</code> must be a List of Strings. \nIf you rewrite <code>accoList</code> and <code>findLetter</code> to accept Chars instead, ghci would infer <code>s</code> to be a List of Chars which is a String. Then your original typsignature would work.</p>\n\n<p>Assuming this is for a chess game, using Chars instead of Strings would be preferrable anyway, as positions can only be single letters.</p>\n"}], "owner": {"reputation": 1, "user_id": 11126928, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VUi82DPGl7k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reKFq_VZqHBdjA1nEpt5fOxZi7I5w/mo/photo.jpg?sz=128", "display_name": "kakann", "link": "https://stackoverflow.com/users/11126928/kakann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1551296096, "creation_date": 1551293900, "last_edit_date": 1551294593, "question_id": 54912654, "link": "https://stackoverflow.com/questions/54912654/haskell-translate-string-to-int", "title": "haskell translate string to Int", "body": "<p>I'm trying to make a function that translate for example the string B1 C2 into two int tuples using the findLetter function defined below. B = 2 and C = 3. It will also reverse the tuple order. Hence B1 C5 == ((1,2),(5,3)).</p>\n\n<pre><code>accoList = [(\"A\", \"1\"),(\"B\", \"2\"),(\"C\", \"3\"),(\"D\", \"4\"),(\"E\", \"5\"),\n(\"F\", \"6\"),(\"G\", \"7\"),(\"H\", \"8\")]\n\nfindLetter :: String -&gt; String\nfindLetter c = findLetter' c accoList\nwhere findLetter' c ((x,y):xs) = if x == c then y else findLetter' c xs\n    findLetter' c [] = undefined\n\n--userToMove1 :: String -&gt; ((Int, Int),(Int, Int))\nuserToMove1 s = userToMove' $ take 5 s\n   where userToMove' (a:b:c:d:e:xs) =  ((read b , (read (findLetter a))),((read e), (read (findLetter d))))\n</code></pre>\n\n<p>When I run this code I get exceptions like non-exhaustive pattern and when I don't comment out <code>--userToMove1 :: String -&gt; ((Int, Int),(Int, Int))</code>, the program gets full of errors. I don't know how to fix it :(</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551292905, "post_id": 54912366, "comment_id": 96591343, "body": "<code>[1..10]</code> wouldn&#39;t produce the Fibonacci sequence; it would produce a sequence of triangular numbers."}, {"owner": {"reputation": 161, "user_id": 10975456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d798ef4fd773cffbea0fdf0d17ec780?s=128&d=identicon&r=PG&f=1", "display_name": "distro.obs", "link": "https://stackoverflow.com/users/10975456/distro-obs"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551293838, "post_id": 54912366, "comment_id": 96591759, "body": "You&#39;re right, fixed the post."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1551292840, "creation_date": 1551292840, "answer_id": 54912415, "question_id": 54912366, "link": "https://stackoverflow.com/questions/54912366/haskell-a-better-way-of-generating-a-new-list-like-folding-without-folding/54912415#54912415", "title": "Haskell - A better way of generating a new list (like folding) without folding", "body": "<p>You are looking for the <code>scanl1</code> function:</p>\n\n<pre><code>&gt; scanl1 (+) [3,5,1,4,7,8,10]\n[3,8,9,13,20,28,38]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 5, "last_activity_date": 1551292912, "creation_date": 1551292912, "answer_id": 54912433, "question_id": 54912366, "link": "https://stackoverflow.com/questions/54912366/haskell-a-better-way-of-generating-a-new-list-like-folding-without-folding/54912433#54912433", "title": "Haskell - A better way of generating a new list (like folding) without folding", "body": "<p>If you look at <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch9.html#x16-1720009.1\" rel=\"noreferrer\">PreludeList</a>, you'll notice function <code>scanl</code> right next to <code>foldl</code> (and <code>scanl1</code> to counter <code>foldl1</code>). Is that what you need perhaps?</p>\n\n<pre><code>Prelude&gt; scanl1 (+) [3, 5, 1, 4, 7, 8, 10]\n[3,8,9,13,20,28,38]\n</code></pre>\n\n<p>Though it would not generate Fibonacci out of positive integers.</p>\n"}], "owner": {"reputation": 161, "user_id": 10975456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d798ef4fd773cffbea0fdf0d17ec780?s=128&d=identicon&r=PG&f=1", "display_name": "distro.obs", "link": "https://stackoverflow.com/users/10975456/distro-obs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54912433, "answer_count": 2, "score": 1, "last_activity_date": 1551293825, "creation_date": 1551292628, "last_edit_date": 1551293825, "question_id": 54912366, "link": "https://stackoverflow.com/questions/54912366/haskell-a-better-way-of-generating-a-new-list-like-folding-without-folding", "title": "Haskell - A better way of generating a new list (like folding) without folding", "body": "<p>If <code>foldl</code> is given a function <code>(+)</code> and a list <code>[1..10]</code> it'll generate a final number.</p>\n\n<hr>\n\n<p>What I want is given </p>\n\n<pre><code>[1,2,3,4,5,6,7,8,9,10]\n</code></pre>\n\n<p>output would be the Triangular Number series.</p>\n\n<p>but given a list like</p>\n\n<pre><code>[3, 5, 1, 4, 7, 8, 10]\n</code></pre>\n\n<p>output would be </p>\n\n<pre><code>[3, 8, 9, 13, 20, 28, 38]\n</code></pre>\n\n<hr>\n\n<p>The way I'm doing that is generating a new list by using</p>\n\n<p><code>sum (take x) list</code></p>\n\n<p>where <code>x</code> is the current index</p>\n\n<p>and appending it to the new list.</p>\n\n<hr>\n\n<p>Is there a better way of doing this?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1551292493, "post_id": 54912257, "comment_id": 96591145, "body": "Can you elaborate? I can&#39;t understand what&#39;s your goal."}, {"owner": {"reputation": 179, "user_id": 5212963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed528b30d0e62b0420358528e7d03f11?s=128&d=identicon&r=PG&f=1", "display_name": "Never Mind", "link": "https://stackoverflow.com/users/5212963/never-mind"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1551292599, "post_id": 54912257, "comment_id": 96591201, "body": "I want to create the data type Exp which contains Let (Var String) Exp Exp. However, I can&#39;t use (Var String) like that to restrict it, but I can&#39;t write Let Exp Exp Exp either as I don&#39;t want an integer in the first Exp."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 4, "creation_date": 1551292816, "post_id": 54912257, "comment_id": 96591298, "body": "Can you use just <code>String</code> instead of <code>(Var String)</code>? <code>Let String Exp Exp</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1551293112, "post_id": 54912257, "comment_id": 96591447, "body": "Ah, I see now. Just use <code>Let String Exp Exp</code>. Alternatively, if you want more wrapping, use <code>...| Var Var | Let Var Exp Exp | ...</code> and then define <code>newtype Var = V String</code> or something similar."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 5, "last_activity_date": 1551318581, "last_edit_date": 1551318581, "creation_date": 1551301697, "answer_id": 54914518, "question_id": 54912257, "link": "https://stackoverflow.com/questions/54912257/haskell-expression-data-type/54914518#54914518", "title": "Haskell expression data type", "body": "<p>You could define a newtype wrapper <code>Var</code> or just use <code>String</code>.  First the newtype wrapper example:</p>\n\n<pre><code>newtype Var = V String\n-- ^ \"Var\" here is a type declaration. \"V\" is declaring a data constructor.\n\ndata Exp = Add Exp Exp\n     | Var Var          -- The first \"Var\" here is declaring a data constructor. The second is referring to the type.\n     | Let Var Exp Exp  -- \"Var\" here is referring to the type\n     | Int Int\n</code></pre>\n\n<p>Or just with strings:</p>\n\n<pre><code>data Exp = Add Exp Exp\n     | Var String \n     | Let String Exp Exp\n     | Int Int \n</code></pre>\n\n<p>EDIT:  The point my comments were trying to make is probably unclear.  In your use of Var, such as <code>Let (Var String) Exp Exp</code>, you tried to use a constructor named <code>Var</code> (and it's field, <code>String</code>) in a location that requires a <em>type</em>.  Each data constructor can be used to build a <em>value</em> of the type (<em>Exp</em> in this case) and can not be further distinguished by the type system.  In lieu of an additional data declaration you can't distinguish between a value of type Exp that is a <code>Var</code> from one that is an <code>Add</code>, <code>Let</code>, or <code>Int</code>.</p>\n"}], "owner": {"reputation": 179, "user_id": 5212963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed528b30d0e62b0420358528e7d03f11?s=128&d=identicon&r=PG&f=1", "display_name": "Never Mind", "link": "https://stackoverflow.com/users/5212963/never-mind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 54914518, "answer_count": 1, "score": -1, "last_activity_date": 1551318581, "creation_date": 1551292260, "question_id": 54912257, "link": "https://stackoverflow.com/questions/54912257/haskell-expression-data-type", "title": "Haskell expression data type", "body": "<p>I want to have the following data type in Haskell :</p>\n\n<pre><code>data Exp = Add Exp Exp\n     | Var String \n     | Let (Var String) Exp Exp\n     | Int Int \n</code></pre>\n\n<p>However, using (Var String) like that is not allowed. I could use Exp instead of (Var String), but I don't want an Int to be allowed there, so how can I solve this?</p>\n"}, {"tags": ["list", "haskell", "recursion", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9227001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b8c6a7a237f5cd46296e765aa2d2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicekor", "link": "https://stackoverflow.com/users/9227001/nicekor"}, "edited": false, "score": 0, "creation_date": 1551289231, "post_id": 54911349, "comment_id": 96589574, "body": "I could I not see that error? So obvious ahah thank you very much!"}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1551290428, "post_id": 54911349, "comment_id": 96590162, "body": "I think the lambda for <code>filter</code> can also be made pointfree: <code>((== str) . fst)</code>. Whether or not this is more readable is somewhat debatable. (warning: I did not actually try to compile that)"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 7, "last_activity_date": 1551304636, "last_edit_date": 1551304636, "creation_date": 1551288932, "answer_id": 54911349, "question_id": 54911178, "link": "https://stackoverflow.com/questions/54911178/recursion-over-lists-haskell/54911349#54911349", "title": "Recursion over Lists - Haskell", "body": "<h1>Easy Fix</h1>\n\n<p>Just change the guard <code>| otherwise = listMarks std xs</code>. I would also change it in the guard above, as <code>| std == fst x = snd x : listMarks std xs</code> as yes, they are equal, but it makes it more clear what you want to achieve. so your code would be:</p>\n\n<pre><code>type StudentMark = (String, Int)\nlistMarks :: String -&gt; [StudentMark] -&gt; [Int]\nlistMarks _ [] = []\nlistMarks std (x:xs)\n  | std == fst x = snd x : listMarks std xs\n  | otherwise = listMarks std xs\n</code></pre>\n\n<h1>Better Versions</h1>\n\n<p>As you can see, you ae calling the function with always the same first argument, so it's highly likely you can write a neater version. Here are two quick ideas:</p>\n\n<h2>List Comprehension</h2>\n\n<p>Personally my favourite, list comprehensions are very versitile and clear:</p>\n\n<pre><code>listMarks' :: String -&gt; [StudentMark] -&gt; [Int]\nlistMarks' str marks = [m |(n,m) &lt;- marks, n==str]\n</code></pre>\n\n<p>Basically you filter the list based on the first element, and then you return the second one.</p>\n\n<h2>Higher Order Functions</h2>\n\n<p>With higher order functions <code>map</code>, <code>filter</code> and <code>fold</code>, you can do as much as recursion and lcs, but often looks tidier. You want to, again, filter the list based on the first element, and then you return the second one.</p>\n\n<pre><code>listMarks'' :: String -&gt; [StudentMark] -&gt; [Int]\nlistMarks'' str =  map snd . filter (\\(n,_) -&gt; n == str)\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9227001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b8c6a7a237f5cd46296e765aa2d2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicekor", "link": "https://stackoverflow.com/users/9227001/nicekor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 54911349, "answer_count": 1, "score": 2, "last_activity_date": 1551304636, "creation_date": 1551288267, "question_id": 54911178, "link": "https://stackoverflow.com/questions/54911178/recursion-over-lists-haskell", "title": "Recursion over Lists - Haskell", "body": "<p>Basically I have this exercise: Recall the StudentMark type synonym from last week. Write a recursive function:</p>\n\n<pre><code>listMarks :: String -&gt; [StudentMark] -&gt; [Int]\n</code></pre>\n\n<p>which gives a list of the marks for a particular student; for example:</p>\n\n<pre><code>listMarks \"Joe\" [(\"Joe\", 45), (\"Sam\", 70), (\"Joe\", 52)] = [45,52]\n</code></pre>\n\n<p>This was the way I wrote the function:</p>\n\n<pre><code>type StudentMark = (String, Int)\nlistMarks :: String -&gt; [StudentMark] -&gt; [Int]\nlistMarks _ [] = []\nlistMarks std (x:xs)\n  | std == fst x = snd x : listMarks (fst x) xs\n  | otherwise = listMarks (fst x) xs\n</code></pre>\n\n<p>This does not work if a string from the list is different from the \"std\" string. I would like to understand why and how could I make this work? Thank you!</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "infinite", "seq", "strictness"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1551271684, "post_id": 54905382, "comment_id": 96578730, "body": "<code>seq (undefined, undefined) True</code> won&#39;t evaluate the <code>undefined</code>s. Ditto for <code>seq (undefined : undefined) True</code>. This is because <code>seq</code> only evaluates enough to expose the first constructor, and does not go deep (also see <code>deepseq</code>)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1551272132, "post_id": 54905382, "comment_id": 96579000, "body": "Lists aren&#39;t really infinite. Skipping a lot of details, <code>seq</code> sees <code>[1..]</code> and evaluates it to <code>1 : [2..]</code>, then stops. The tail stays unevaluated until someone actually needs it."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 3560270, "user_type": "registered", "profile_image": "https://graph.facebook.com/707633001/picture?type=large", "display_name": "user3560270", "link": "https://stackoverflow.com/users/3560270/user3560270"}, "edited": false, "score": 0, "creation_date": 1551332394, "post_id": 54905733, "comment_id": 96603534, "body": "Makes sense. I guess if you really want an infinite list to be evaluated (I mean get stuck into infinite recursion) you must give it a name and then ask for its length or something."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 303, "user_id": 3560270, "user_type": "registered", "profile_image": "https://graph.facebook.com/707633001/picture?type=large", "display_name": "user3560270", "link": "https://stackoverflow.com/users/3560270/user3560270"}, "edited": false, "score": 0, "creation_date": 1551344545, "post_id": 54905733, "comment_id": 96608635, "body": "Or you can use something from the deepseq package"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 11, "last_activity_date": 1551271198, "creation_date": 1551271198, "answer_id": 54905733, "question_id": 54905382, "link": "https://stackoverflow.com/questions/54905382/how-can-seq-evaluate-an-inifinite-list-in-haskell/54905733#54905733", "title": "How can seq evaluate an inifinite list in Haskell?", "body": "<p><code>seq</code> evaluates to <em>weak head normal form</em> (WHNF), which essentially means it evaluates one layer of data constructors. In this case, it means that it forces evaluation of the first cons cell (the <code>:</code> data constructor).</p>\n\n<p>I have a pretty long post explaining details around this at <a href=\"https://haskell.fpcomplete.com/tutorial/all-about-strictness\" rel=\"noreferrer\">https://haskell.fpcomplete.com/tutorial/all-about-strictness</a></p>\n"}], "owner": {"reputation": 303, "user_id": 3560270, "user_type": "registered", "profile_image": "https://graph.facebook.com/707633001/picture?type=large", "display_name": "user3560270", "link": "https://stackoverflow.com/users/3560270/user3560270"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 54905733, "answer_count": 1, "score": 3, "last_activity_date": 1551291671, "creation_date": 1551270059, "last_edit_date": 1551291671, "question_id": 54905382, "link": "https://stackoverflow.com/questions/54905382/how-can-seq-evaluate-an-inifinite-list-in-haskell", "title": "How can seq evaluate an inifinite list in Haskell?", "body": "<p>It is said that the Haskell <strong>seq</strong> function forces the evaluation of its first argument and returns the second. It is used to add strictness to evaluation of expressions. So how can the following simply return 5:</p>\n\n<pre><code>seq [1..] 5\n</code></pre>\n\n<p>Shouldn't it get stuck in trying to construct an infinite list?</p>\n"}, {"tags": ["java", "haskell"], "comments": [{"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 1, "creation_date": 1551281183, "post_id": 54904549, "comment_id": 96584657, "body": "You could compile the haskell script with eta into a jar and call directly from java <a href=\"https://eta-lang.org\" rel=\"nofollow noreferrer\">eta-lang.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "reply_to_user": {"reputation": 41, "user_id": 11124614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h9ejLxaJP5Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe8RznzKIVxmYyC2EkUqSt76zrA/mo/photo.jpg?sz=128", "display_name": "MarwinStockholm", "link": "https://stackoverflow.com/users/11124614/marwinstockholm"}, "edited": false, "score": 0, "creation_date": 1551269135, "post_id": 54904758, "comment_id": 96577223, "body": "Did you also try @chi&#39;s changes on the Haskell side?"}, {"owner": {"reputation": 41, "user_id": 11124614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h9ejLxaJP5Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe8RznzKIVxmYyC2EkUqSt76zrA/mo/photo.jpg?sz=128", "display_name": "MarwinStockholm", "link": "https://stackoverflow.com/users/11124614/marwinstockholm"}, "edited": false, "score": 0, "creation_date": 1551269140, "post_id": 54904758, "comment_id": 96577229, "body": "Thank you. I still cannot get it to work, adding flush at the end. Printwriter didn&#39;t do any difference, with flush. Without flush it does not even get a result, when closing."}, {"owner": {"reputation": 41, "user_id": 11124614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h9ejLxaJP5Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe8RznzKIVxmYyC2EkUqSt76zrA/mo/photo.jpg?sz=128", "display_name": "MarwinStockholm", "link": "https://stackoverflow.com/users/11124614/marwinstockholm"}, "edited": false, "score": 0, "creation_date": 1551269334, "post_id": 54904758, "comment_id": 96577327, "body": "I&#39;ll try his solution and come back. Thanks :)"}], "tags": [], "owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "is_accepted": false, "score": 2, "last_activity_date": 1551268321, "last_edit_date": 1551268321, "creation_date": 1551267938, "answer_id": 54904758, "question_id": 54904549, "link": "https://stackoverflow.com/questions/54904549/simple-haskell-script-with-java/54904758#54904758", "title": "Simple haskell script with java", "body": "<p><code>BufferedWriter</code> does not automatically flush its output when you do <code>newLine()</code>. So your Haskell program will not receive the newline and wait forever.</p>\n\n<p>When you call <code>close()</code> all the remaining buffered output is flushed (but of course, you don't want to do that).</p>\n\n<p>So the solution should be</p>\n\n<pre><code>writer.write(bt);\nwriter.newLine();\nwriter.flush();\n</code></pre>\n\n<p>You could also use a <code>PrintWriter</code>, which has an automatic flush-on-newline option and understands Strings (via the <code>print</code> method), so no need to mess with <code>char[]</code>.</p>\n\n<p>Finally, if you are planning to send large amounts of text in or out at the same time, you may have to adjust the buffer sizes or use multiple threads to avoid deadlocks when your program cannot send output anymore because the receiving Java-side buffer is full and you are not currently reading it out. See this <a href=\"https://stackoverflow.com/q/14165517/14955\">thread</a> for solutions.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1551268193, "creation_date": 1551268193, "answer_id": 54904835, "question_id": 54904549, "link": "https://stackoverflow.com/questions/54904549/simple-haskell-script-with-java/54904835#54904835", "title": "Simple haskell script with java", "body": "<p>I experimented a bit, and I needed to require line buffering on the Haskell side, otherwise the output is not flushed in a timely fashion.</p>\n\n<pre><code>import Data.Char(toUpper)\nimport System.IO\n\nmain = do\n  hSetBuffering stdout LineBuffering\n  interact (map toUpper)\n</code></pre>\n\n<p>Indeed, I discovered that <code>stdout</code> is initially set to <code>BlockBuffering</code> when called from java, and that will buffer too much.</p>\n\n<p>Note that, as Thilo pointed out, in order to use <code>LineBuffering</code> on the Haskell side, you have to <code>writer.newLine()</code> on the java side <em>before</em> you flush (in java), otherwise the uppercase output won't get flushed (in Haskell).</p>\n"}], "owner": {"reputation": 41, "user_id": 11124614, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h9ejLxaJP5Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWe8RznzKIVxmYyC2EkUqSt76zrA/mo/photo.jpg?sz=128", "display_name": "MarwinStockholm", "link": "https://stackoverflow.com/users/11124614/marwinstockholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1551268321, "creation_date": 1551267250, "question_id": 54904549, "link": "https://stackoverflow.com/questions/54904549/simple-haskell-script-with-java", "title": "Simple haskell script with java", "body": "<p>Trying to run a simple script in Haskell by using java code. (Windows 10)</p>\n\n<p>The haskell script looks like this:</p>\n\n<pre><code>import Data.Char(toUpper)\nmain = interact (map toUpper)\n</code></pre>\n\n<p>I have made an simple.exe file with ghc, and it works as expected from cmd module. I write a simple string and it replies with the same string in uppercase, and I can repeat this until I chose to stop the program.</p>\n\n<p>But when I try to run this program through java it will not work that way. I can feed the input, but in order to get output I need to close the input feed.</p>\n\n<pre><code>public class Main {\n    public static void main(String[] args) {\n        try {\n            Process process = new ProcessBuilder(\"simple\").start();\n\n            InputStream processInputStream = process.getInputStream();\n            BufferedReader reader = new BufferedReader(new InputStreamReader(processInputStream));\n            OutputStream processOutputStream = process.getOutputStream();\n            BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(processOutputStream));\n            char[] bt = (\"Hello\").toCharArray();\n            writer.write(bt);\n            writer.flush();\n            writer.newLine();\n            processOutputStream.close(); -- Only works if I close output stream,.\n            System.out.println(reader.readLine());\n\n\n        }catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n\n<p>How can I get output w/o closing my output-feed in java program.</p>\n\n<p>Restarting the process works, but the execution time is horrible.</p>\n\n<p>I have tried threading the program, with same result.</p>\n"}, {"tags": ["linux", "haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1551268556, "post_id": 54904507, "comment_id": 96576904, "body": "This may help you: <a href=\"https://stackoverflow.com/questions/12619600/libiconv-and-macos\">stackoverflow.com/questions/12619600/libiconv-and-macos</a>"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 3, "creation_date": 1551280621, "post_id": 54904507, "comment_id": 96584294, "body": "Have you tried adding <code>extra-lib-dirs: [&#47;usr&#47;lib]</code> to <code>stack.yaml</code> ?"}, {"owner": {"reputation": 55, "user_id": 10460270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-42mB5EGraNc/AAAAAAAAAAI/AAAAAAAAAGc/NSwqtyHZKvs/photo.jpg?sz=128", "display_name": "Masanari Makino", "link": "https://stackoverflow.com/users/10460270/masanari-makino"}, "edited": false, "score": 0, "creation_date": 1551416154, "post_id": 54904507, "comment_id": 96639974, "body": "ty! I&#39;ll try it."}], "owner": {"reputation": 55, "user_id": 10460270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-42mB5EGraNc/AAAAAAAAAAI/AAAAAAAAAGc/NSwqtyHZKvs/photo.jpg?sz=128", "display_name": "Masanari Makino", "link": "https://stackoverflow.com/users/10460270/masanari-makino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1551267129, "creation_date": 1551267129, "question_id": 54904507, "link": "https://stackoverflow.com/questions/54904507/i-cannot-execute-stack-setup-because-of-iconv-error", "title": "I cannot execute stack setup because of iconv error", "body": "<p>When I installed stack by brew and setup for haskell learning, error was occurred</p>\n\n<pre><code>[1 of 1] Compiling Main             ( /private/var/folders/j6/g61rgqwj27z30t9xsxpyqj_00000gn/T/stack-sanity-check-51e69d22a73355e8/Main.hs, /private/var/folders/j6/g61rgqwj27z30t9xsxpyqj_00000gn/T/stack-sanity-check-51e69d22a73355e8/Main.o )\nLinking /private/var/folders/j6/g61rgqwj27z30t9xsxpyqj_00000gn/T/stack-sanity-check-51e69d22a73355e8/Main ...\nStandard error:\n\nUndefined symbols for architecture x86_64:\n  \"_iconv\", referenced from:\n      _hs_iconv in libHSbase-4.12.0.0.a(iconv.o)\n     (maybe you meant: _base_GHCziIOziEncodingziIconv_iconvEncoding1_closure, _base_GHCziIOziEncodingziIconv_iconvEncoding1_info , _base_GHCziIOziEncodingziIconv_iconvEncoding4_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding15_info , _base_GHCziIOziEncodingziIconv_iconvEncoding4_info , _base_GHCziIOziEncodingziIconv_iconvEncoding7_info , _base_GHCziIOziEncodingziIconv_iconvEncoding6_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding6_info , _base_GHCziIOziEncodingziIconv_iconvEncoding8_info , _hs_iconv_open , _base_GHCziIOziEncodingziIconv_iconvEncoding9_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding12_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding9_info , _base_GHCziIOziEncodingziIconv_iconvEncoding12_info , _base_GHCziIOziEncodingziIconv_iconvEncoding13_info , _base_GHCziIOziEncodingziIconv_iconvEncoding11_info , _base_GHCziIOziEncodingziIconv_iconvEncoding_info , _base_GHCziIOziEncodingziIconv_iconvEncoding7_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding13_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding2_info , _base_GHCziIOziEncodingziIconv_iconvEncoding11_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding14_bytes , _base_GHCziIOziEncodingziIconv_iconvEncoding15_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding3_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding8_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding2_closure , _hs_iconv , _base_GHCziIOziEncodingziIconv_iconvEncoding10_bytes , _hs_iconv_close , _base_GHCziIOziEncodingziIconv_iconvEncoding5_closure )\n  \"_iconv_open\", referenced from:\n      _hs_iconv_open in libHSbase-4.12.0.0.a(iconv.o)\n     (maybe you meant: _hs_iconv_open)\n  \"_iconv_close\", referenced from:\n      _hs_iconv_close in libHSbase-4.12.0.0.a(iconv.o)\n     (maybe you meant: _hs_iconv_close)\n  \"_locale_charset\", referenced from:\n      _localeEncoding in libHSbase-4.12.0.0.a(PrelIOUtils.o)\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n`gcc' failed in phase `Linker'. (Exit code: 1)\n</code></pre>\n\n<p><code>libiconv.2.4.0.dylib</code> , <code>libiconv.2.dylib</code> and <code>libiconv.dylib</code> are in \n <code>/usr/lib</code> directory</p>\n\n<p>my Mac os version is <code>mac OS Mojave 10.14</code> </p>\n\n<pre><code>$ iconv --version\niconv (GNU libiconv 1.15)\nCopyright (C) 2000-2017 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nWritten by Bruno Haible.\n\n$ which iconv\n/Users/{myAccountName}/.pyenv/shims/iconv\n</code></pre>\n\n<p>Maybe I think <code>which iconv</code> 's output must be <code>/usr/lib</code>, but it is not. That's why I wrote the <code>which iconv</code> callback and ask someone who knows how to change <code>iconv</code> 's callee.</p>\n\n<p>But it is my guess. It was probably not the reason of the error. So, I also ask the other reason of the error and how to fix.</p>\n\n<p>Sorry for not fluent english.</p>\n"}, {"tags": ["haskell", "types", "type-families"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 1, "creation_date": 1551271788, "post_id": 54904535, "comment_id": 96578792, "body": "I thought, that type families is defined with <code>type</code> instead of <code>data</code> like show in <a href=\"https://ocharles.org.uk/posts/2014-12-12-type-families.html\" rel=\"nofollow noreferrer\">ocharles.org.uk/posts/2014-12-12-type-families.html</a>"}, {"owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1551273745, "post_id": 54904535, "comment_id": 96579976, "body": "it depends what you want: using existing type (type) or creating a new one (data)"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1551276815, "post_id": 54904535, "comment_id": 96581882, "body": "Look at the <a href=\"https://www.yesodweb.com/book/haskell\" rel=\"nofollow noreferrer\">yesodweb.com/book/haskell</a> in the type families, there is a definition of <code>type Content a</code> and what is it?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 1, "creation_date": 1551278479, "post_id": 54904535, "comment_id": 96582948, "body": "@zero_coding The TypeFamilies extension includes both type families and data families.  They are very similar conceptually, with the difference between them being the same as the difference between (non-family) type aliases and (non-family) data types."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 1, "creation_date": 1551284084, "post_id": 54904535, "comment_id": 96586625, "body": "what are the differences between <code>type families</code> and <code>data families</code>?"}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 6, "last_activity_date": 1551292370, "last_edit_date": 1551292370, "creation_date": 1551267231, "answer_id": 54904535, "question_id": 54904321, "link": "https://stackoverflow.com/questions/54904321/what-is-associated-data-type-in-haskell/54904535#54904535", "title": "What is associated data type in haskell?", "body": "<p>Quoting code from the article:</p>\n\n<pre><code>instance RenderRoute HelloWorld where\n    data Route HelloWorld = HomeR\n        deriving (Show, Eq, Read)\n    renderRoute HomeR = ([], [])\n</code></pre>\n\n<p>As you can see <code>Route</code> is an associated data type and yes, it means data families. Take a look at <a href=\"https://wiki.haskell.org/GHC/Type_families\" rel=\"nofollow noreferrer\">wiki</a> example:</p>\n\n<blockquote>\n  <p>We define a type class whose instances are the types that we can use as keys in our generic maps:</p>\n\n<pre><code>class GMapKey k where  \n    data GMap k :: * -&gt; *  \n    empty       :: GMap k v  \n    lookup      :: k -&gt; GMap k v -&gt; Maybe v  \n    insert      :: k -&gt; v -&gt; GMap k v -&gt; GMap k v\n</code></pre>\n  \n  <p>The interesting part is the associated data family declaration of the class. It gives a kind signature (here <code>* -&gt; *</code>) for the associated data type <code>GMap k</code> - analogous to how methods receive a type signature in a class declaration. </p>\n</blockquote>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 54904535, "answer_count": 1, "score": 3, "last_activity_date": 1551292370, "creation_date": 1551266510, "last_edit_date": 1551292130, "question_id": 54904321, "link": "https://stackoverflow.com/questions/54904321/what-is-associated-data-type-in-haskell", "title": "What is associated data type in haskell?", "body": "<p>In the routing section, the <a href=\"https://www.yesodweb.com/book/basics\" rel=\"nofollow noreferrer\">article</a> says: </p>\n\n<blockquote>\n  <p>We can see that the RenderRoute class defines an <em>associated data type</em>\n  providing the routes for our application.</p>\n</blockquote>\n\n<p>What does <em>associated data type</em> mean? It means type families?</p>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 0, "last_activity_date": 1551304704, "creation_date": 1551304704, "answer_id": 54915150, "question_id": 54903703, "link": "https://stackoverflow.com/questions/54903703/but-by-using-the-ddump-splices-ghc-option/54915150#54915150", "title": "But by using the -ddump-splices GHC option", "body": "<p>I don't see a way to pass options through to GHC when using <code>stack runghc</code>.  You can compile your project with <code>stack build</code>, which accepts more options.  The full command is <code>stack build --ghc-options '-ddump-splices'</code>.</p>\n\n<p>After compiling, you may also want to run your project.  If you followed the <a href=\"https://www.yesodweb.com/page/quickstart\" rel=\"nofollow noreferrer\">Yesod quickstart</a>, I think <code>stack exec -- yesod devel</code> will work.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11127895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88756df6a95e62cfffce5117c1f03b6e?s=128&d=identicon&r=PG&f=1", "display_name": "ngyj", "link": "https://stackoverflow.com/users/11127895/ngyj"}, "is_accepted": false, "score": 2, "last_activity_date": 1551310685, "creation_date": 1551310685, "answer_id": 54916180, "question_id": 54903703, "link": "https://stackoverflow.com/questions/54903703/but-by-using-the-ddump-splices-ghc-option/54916180#54916180", "title": "But by using the -ddump-splices GHC option", "body": "<p>I think you can use the <a href=\"https://downloads.haskell.org/~ghc/7.2.1/docs/html/users_guide/pragmas.html#options-pragma\" rel=\"nofollow noreferrer\">OPTIONS_GHC pragma</a>:\nsimply add</p>\n\n<pre><code>{-# OPTIONS_GHC -ddump-splices #-}\n</code></pre>\n\n<p>at the top of your file.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1551310685, "creation_date": 1551264497, "question_id": 54903703, "link": "https://stackoverflow.com/questions/54903703/but-by-using-the-ddump-splices-ghc-option", "title": "But by using the -ddump-splices GHC option", "body": "<p>I am learning yesod and would like to know, which code is generated behind, when I am using </p>\n\n<pre><code>mkYesod \"HelloWorld\" [parseRoutes|\n/ HomeR GET\n|]\n</code></pre>\n\n<p>function. </p>\n\n<p>In the <a href=\"https://www.yesodweb.com/book/basics\" rel=\"nofollow noreferrer\">doc</a>, it says: </p>\n\n<blockquote>\n  <p>We\u2019ll look at this in more detail in the routing chapter. But by using\n  the <code>-ddump-splices</code> GHC option, we can get an immediate look at the\n  generated code. </p>\n</blockquote>\n\n<p>How can I pass <code>-ddump-splices</code>  to GHC option? </p>\n\n<p>I start the application with: </p>\n\n<pre><code>stack runghc -ddump-splices helloworld.hs\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1551257996, "post_id": 54900821, "comment_id": 96570350, "body": "<a href=\"http://seanhess.github.io/2015/08/04/practical-haskell-getting-started.html\" rel=\"nofollow noreferrer\">seanhess.github.io/2015/08/04/&hellip;</a>"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1551258130, "post_id": 54900821, "comment_id": 96570436, "body": "Have you tried it, as I described it above?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551258948, "post_id": 54900821, "comment_id": 96570905, "body": "<code>runhaskell</code> isn&#39;t the same as <code>stack</code>. Try running <code>stack build</code> (could take a while) and then do <code>stack exec -- runhaskell helloworld.hs</code>."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1551260428, "post_id": 54900821, "comment_id": 96571796, "body": "Wow...it works very good. Thanks a lot"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551261473, "post_id": 54900821, "comment_id": 96572490, "body": "@zero_coding Do you want me to post it as an answer?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551261520, "post_id": 54900821, "comment_id": 96572511, "body": "@bradrn  Could explain me, what is the meaning of the <code>runhaskell</code> the parameter?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551261541, "post_id": 54900821, "comment_id": 96572525, "body": "(Also @zero_coding, you can mention someone using @ followed by their username, otherwise they don&#39;t get notified of the message)"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551261730, "post_id": 54900821, "comment_id": 96572657, "body": "@zero_coding <code>stack exec -- command</code> runs <code>command</code> in <code>stack</code>&#39;s context, which includes Haskell libraries, commands etc. So we&#39;re just running <code>runhaskell helloworld.hs</code>, but using <code>stack</code>. For this sort of thing, I wouldn&#39;t use <code>runhaskell</code> though; I would use <code>stack exec yeplay</code> (the <code>--</code> isn&#39;t required when the <code>command</code> doesn&#39;t have any parameters), or <code>stack exec -- yesod devel</code> (requires running <code>stack build yesod-bin</code> first). Refer to the <a href=\"https://www.yesodweb.com/page/quickstart\" rel=\"nofollow noreferrer\">Yesod Getting Started page</a> for more details."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1551262015, "post_id": 54900821, "comment_id": 96572825, "body": "I am following the instruction on page <a href=\"https://www.yesodweb.com/book/basics\" rel=\"nofollow noreferrer\">yesodweb.com/book/basics</a> and it says to start with <code>runhaskell</code>."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1551262030, "post_id": 54900821, "comment_id": 96572831, "body": "Where are the commands list?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1551262392, "post_id": 54900821, "comment_id": 96573095, "body": "@zero_coding looks like you didn&#39;t read far enough, since the next sentence on that link is: &quot;Note, if you followed the quick start guide and installed yesod with stack then you will not have <code>runhaskell</code> and will need to run <code>stack runghc helloworld.hs</code> instead. &quot;"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551262510, "post_id": 54900821, "comment_id": 96573167, "body": "@RobinZigmond Au sorry my mistake. Thanks a lot for the hint."}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551258036, "creation_date": 1551255186, "last_edit_date": 1551258036, "question_id": 54900821, "link": "https://stackoverflow.com/questions/54900821/how-to-run-yesod-hello-world-app-with-stack", "title": "How to run yesod hello world app with stack?", "body": "<p>I've created a yesod project with following command: </p>\n\n<pre><code>stack new yeplay yesodweb/simple  \n</code></pre>\n\n<p>and I've added a <code>helloworld.hs</code> file to app directory. The app directory contains the following files:</p>\n\n<pre><code>~/haskell/yeplay/app$ ls\ndevel.hs  DevelMain.hs  helloworld.hs  main.hs\n</code></pre>\n\n<p>The <code>helloworld.hs</code> file  has the following content: </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings     #-}\n{-# LANGUAGE QuasiQuotes           #-}\n{-# LANGUAGE TemplateHaskell       #-}\n{-# LANGUAGE TypeFamilies          #-}\nimport           Yesod\n\ndata HelloWorld = HelloWorld\n\nmkYesod \"HelloWorld\" [parseRoutes|\n/ HomeR GET\n|]\n\ninstance Yesod HelloWorld\n\ngetHomeR :: Handler Html\ngetHomeR = defaultLayout [whamlet|Hello World!|]\n\nmain :: IO ()\nmain = warp 3000 HelloWorld  \n</code></pre>\n\n<p>Then I tried to run the file with the command:</p>\n\n<pre><code>runhaskell helloworld.hs\n\nCommand 'runhaskell' not found, but can be installed with:\n\nsudo apt install ghc \n</code></pre>\n\n<p>as described in the documentation.</p>\n\n<p>How can I start the app?</p>\n"}, {"tags": ["haskell", "types", "type-systems"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1551253512, "post_id": 54897406, "comment_id": 96568293, "body": "Great accessible explanation of parametric polymorphism!"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 13, "last_activity_date": 1551237990, "last_edit_date": 1551237990, "creation_date": 1551236889, "answer_id": 54897406, "question_id": 54897034, "link": "https://stackoverflow.com/questions/54897034/types-and-type-variable-in-haskell/54897406#54897406", "title": "types and type variable in Haskell", "body": "<p>When we say that <code>e :: [a]</code>, it means that <code>e</code> is a list of elements of any type. Which type? Any type! Whichever type you happen to need at the moment.</p>\n\n<p>If you're coming from a non-ML language, this might be a bit easier to understand by looking at a function (rather than a value) first. Consider this:</p>\n\n<pre><code>f x = [x]\n</code></pre>\n\n<p>The type of this function is <code>f :: a -&gt; [a]</code>. This means, roughly, that this function works for any type <code>a</code>. You give it a value of this type, and it will give you back a list with elements of that type. Which type? Any type! Whichever you happen to need.</p>\n\n<p>When I call this function, I effectively <em>choose</em> which type I want at the moment. If I call it like <code>f 'x'</code>, I choose <code>a = Char</code>, and if I call it like <code>f True</code>, I choose <code>a = Bool</code>. So the important point here is that <em>whoever calls a function chooses the type parameter</em>.</p>\n\n<p>But I don't have to choose it just once and for all eternity. Instead, I choose the type parameter <em>every time I call the function</em>. Consider this:</p>\n\n<pre><code>pair = (f 'x', f True)\n</code></pre>\n\n<p>Here I'm calling <code>f</code> twice, and I choose different type parameters every time - first time I choose <code>a = Char</code>, and second time I choose <code>a = Bool</code>. </p>\n\n<p>Ok, now for the next step: when I choose the type parameter, I can do it in several ways. In the example above, I choose it by passing a value parameter of the type I want. But another way is to specify the <em>type of result I want</em>. Consider this:</p>\n\n<pre><code>g x = []\n\na :: [Int]\na = g 0\n\nb :: [Char]\nb = g 42\n</code></pre>\n\n<p>Here, the function <code>g</code> ignores its parameter, so there is no relation between its type and the result of <code>g</code>. But I am still able to choose the type of that result by having it constrained by the surrounding context.</p>\n\n<p>And now, the mental leap: <em>a function without any parameters (aka a \"value\") is not that different from a function with parameters</em>. It just has zero parameters, that's all. </p>\n\n<p>If a value has type parameters (like your value <code>e</code> for example), I can choose that type parameter every time I \"call\" that value, just as easily as if it was a function. So in the expression <code>e == ec &amp;&amp; e == en</code> you're simply \"calling\" the value <code>e</code> twice, choosing different type parameters on every call - much like I've done in the <code>pair</code> example above.</p>\n\n<hr>\n\n<p>The confusion about <code>Num</code> is an altogether different matter.</p>\n\n<p>You see, <code>Num</code> is not a type. It's a <em>type class</em>. Type classes are sort of like interfaces in Java or C#, except you can declare them <em>later</em>, not necessarily together with the type that implements them.</p>\n\n<p>So the signature <code>en :: Num a =&gt; [a]</code> means that <code>en</code> is a list with elements of <em>any</em> type, as long as that type implements (\"has an instance of\") the type class <code>Num</code>.</p>\n\n<p>And the way type inference in Haskell works is, the compiler will first determine the most concrete types it can, and then try to find implementations (\"instances\") of the required type classes for those types.</p>\n\n<p>In your case, the compiler sees that <code>en :: [a]</code> is being compared to <code>ec :: [Char]</code>, and it figures: \"oh, I know: <code>a</code> must be <code>Char</code>!\" And then it goes to find the class instances and notices that <code>a</code> must have an instance of <code>Num</code>, and since <code>a</code> is <code>Char</code>, it follows that <code>Char</code> must have an instance of <code>Num</code>. But it doesn't, and so the compiler complains: \"can't find (Num Char)\"</p>\n\n<p>As for \"arising from the use of <code>en</code>\" - well, that's because <code>en</code> is the reason that a <code>Num</code> instance is required. <code>en</code> is the one that has <code>Num</code> in its type signature, so its presence is what causes the requirement of <code>Num</code></p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1551257916, "creation_date": 1551257916, "answer_id": 54901522, "question_id": 54897034, "link": "https://stackoverflow.com/questions/54897034/types-and-type-variable-in-haskell/54901522#54901522", "title": "types and type variable in Haskell", "body": "<p>Sometimes, it is convenient to think about polymorphic functions as functions taking explicit <em>type arguments</em>. Let's consider the polymorphic identity function as an example.</p>\n\n<pre><code>id :: forall a . a -&gt; a\nid x = x\n</code></pre>\n\n<p>We can think of this function as follows:</p>\n\n<ul>\n<li>first, the function takes as input a type argument named <code>a</code></li>\n<li>second, the function takes as input a value <code>x</code> of the previously chosen type <code>a</code></li>\n<li>last, the function returns <code>x</code> (of type <code>a</code>)</li>\n</ul>\n\n<p>Here's a possible call:</p>\n\n<pre><code>id @Bool True\n</code></pre>\n\n<p>Above, the <code>@Bool</code> syntax passes <code>Bool</code> for the first argument (type argument <code>a</code>), while <code>True</code> is passed as the second argument (<code>x</code> of type <code>a = Bool</code>).</p>\n\n<p>A few other ones:</p>\n\n<pre><code>id @Int 42\nid @String \"hello\"\nid @(Int, Bool) (3, True)\n</code></pre>\n\n<p>We can even partially apply <code>id</code> passing only the type argument:</p>\n\n<pre><code>id @Int       :: Int -&gt; Int\nid @String    :: String -&gt; String\n...\n</code></pre>\n\n<p>Now, note that in most cases Haskell allows us to omit the type argument. I.e. we can write <code>id \"hello\"</code> and GHC will try to infer the missing type argument. Roughly it works as follows: <code>id \"hello\"</code> is transformed into <code>id @t \"hello\"</code> for some unknown type <code>t</code>, then according to the type of <code>id</code> this call can only type check if <code>\"hello\" :: t</code>, and since <code>\"hello\" :: String</code>, we can infer <code>t = String</code>.</p>\n\n<p>Type inference is extremely common in Haskell. Programmers rarely specify their type arguments, and let GHC do its job.</p>\n\n<p>In your case:</p>\n\n<pre><code>e :: forall a . [a]\ne = []\nec :: [Char]\nec = tail \"1\"\nen :: [Int]\nen = tail [1]\n</code></pre>\n\n<p>Variable <code>e</code> is bound to a polymorphic value. That is, it actually is a sort-of function which takes a type argument <code>a</code> (which can also be omitted), and returns a list of type <code>[a]</code>.</p>\n\n<p>Instead, <code>ec</code> does not take any type argument. It's a plain list of type <code>[Char]</code>. Similarly for <code>en</code>.</p>\n\n<p>We can then use</p>\n\n<pre><code>ec == (e @Char)    -- both of type [Char]\nen == (e @Int)     -- both of type [Int]\n</code></pre>\n\n<p>Or we can let the type inference engine to determine the implicit type arguments</p>\n\n<pre><code>ec == e     -- @Char inferred\nen == e     -- @Int inferred\n</code></pre>\n\n<p>The latter can be misleading, since it seems that <code>ec,e,en</code> must have the same type. In fact, they have not, since different implicit type arguments are being inferred.</p>\n"}], "owner": {"reputation": 1543, "user_id": 809584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d577a1b45100bc0d0492b6f87d96a04?s=128&d=identicon&r=PG", "display_name": "alexakarpov", "link": "https://stackoverflow.com/users/809584/alexakarpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 0, "accepted_answer_id": 54897406, "answer_count": 2, "score": 13, "last_activity_date": 1551257916, "creation_date": 1551233755, "last_edit_date": 1551253011, "question_id": 54897034, "link": "https://stackoverflow.com/questions/54897034/types-and-type-variable-in-haskell", "title": "types and type variable in Haskell", "body": "<p>Scratching at the surface of Haskell's type system, ran this:</p>\n\n<pre><code>Prelude&gt; e = []\nPrelude&gt; ec = tail \"a\"\nPrelude&gt; en = tail [1]\nPrelude&gt; :t e\ne :: [a]\nPrelude&gt; :t ec\nec :: [Char]\nPrelude&gt; :t en\nen :: Num a =&gt; [a]\nPrelude&gt; en == e\nTrue\nPrelude&gt; ec == e\nTrue\n</code></pre>\n\n<p>Somehow, despite <strong>en</strong> and <strong>ec</strong> have different types, they both test True on <strong>== e</strong>. I say \"somehow\" not because I am surprised (I am not), but because I don't know what is the name of rule/mechanism that allows this. It is as if the <em>type variable</em> \"a\" in the expression \"[] == en\" is allowed to take on value of \"Num\" for the evaluation. And likewise when tested with \"[] == ec\", it is allowed to become \"Char\".</p>\n\n<p>The reason I'm not sure my interpretation is correct is this:</p>\n\n<pre><code>Prelude&gt; (en == e) &amp;&amp; (ec == e)\nTrue\n</code></pre>\n\n<p>, because intuitively this implies that in the same expression e assumes both values of Num and Char \"at the same time\" (at least that's how I'm used to interpret the semantics of &amp;&amp;). Unless the \"assumption\" of Char only acts during the evaluation of (ec == e), and (en == e) is evaluated independently, in a separate... reduction? (I'm guessing on a terminology here).</p>\n\n<p>And then comes this:</p>\n\n<pre><code>Prelude&gt; en == es\n\n&lt;interactive&gt;:80:1: error:\n    \u2022 No instance for (Num Char) arising from a use of \u2018en\u2019\n    \u2022 In the first argument of \u2018(==)\u2019, namely \u2018en\u2019\n      In the expression: en == es\n      In an equation for \u2018it\u2019: it = en == es\nPrelude&gt; es == en\n\n&lt;interactive&gt;:81:7: error:\n    \u2022 No instance for (Num Char) arising from a use of \u2018en\u2019\n    \u2022 In the second argument of \u2018(==)\u2019, namely \u2018en\u2019\n      In the expression: es == en\n      In an equation for \u2018it\u2019: it = es == en\n</code></pre>\n\n<p>Not surprise by the exception, but surprised that in both tests, the error message complains about \"the use of 'en'\" - and doesn't matter if it's the first or second operand.</p>\n\n<p>Perhaps an important lesson needs to be learned about Haskell type system. Thank you for your time!</p>\n"}, {"tags": ["function", "haskell", "types", "currying", "partial-application"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1551255098, "post_id": 54896826, "comment_id": 96568972, "body": "Not sure if you are aware but the example shows you about 3 or 4 concepts at once: partial application, point free style, lambdas, currying/uncurrying. These are not difficult concepts but might be a bit too much for beginners when presented all together."}], "answers": [{"comments": [{"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1551232845, "post_id": 54896871, "comment_id": 96562529, "body": "Got it. But then since <code>x</code> is omitted, the only way a user can tell that <code>increment</code> takes only 1 input is by reading it&#39;s description (which isn&#39;t mandatory to be there), and if the description is not there, then to fully understand how <code>plus</code> works? That&#39;s a downfall in not specifying how many arguments there can be, right?"}, {"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1551233117, "post_id": 54896871, "comment_id": 96562598, "body": "And btw, should the definition of increment be <code>Int -&gt; (Int -&gt; Int)</code> since it takes an <code>int</code> and passes it to a function that takes an <code>int</code> and returns and <code>int</code>?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 2, "creation_date": 1551233148, "post_id": 54896871, "comment_id": 96562603, "body": "@user2719875 You can look at its type (which GHCi or possibly your code editor will be able to tell you even if there&#39;s no type signature) to see how many arguments it takes."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 2, "creation_date": 1551233251, "post_id": 54896871, "comment_id": 96562636, "body": "&quot;should the definition of increment be Int -&gt; (Int -&gt; Int) since it takes an int and passes it to a function that takes an int and returns and int&quot; No. It takes an int and returns an int, so <code>Int -&gt; Int</code> is the correct type signature. The fact that it calls another function to return the int, doesn&#39;t change the type. The type doesn&#39;t tell you how a function is implemented, only what it does (type-wise). So &quot;takes an int, returns an int&quot; means &quot;Int -&gt; Int&quot; regardless of how the function is implemented."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1551291868, "post_id": 54896871, "comment_id": 96590834, "body": "&quot;But then since <code>x</code> is omitted, the only way a user can tell that <code>increment</code> takes only 1 input is by reading it&#39;s description&quot; After getting more used to the language and this kind of notation in particular, you get the hang of looking at how many arguments are provided in the definition, and inferring from that whether the function takes any implicit ones. But in general, Haskell functions are written with explicit type signatures, and it&#39;s easy to tell just from that."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 2, "creation_date": 1551292001, "post_id": 54896871, "comment_id": 96590895, "body": "&quot;should the definition of increment be <code>Int -&gt; (Int -&gt; Int)</code>?&quot; The definition of <code>increment</code> is <code>plus 1</code>, and the type of <code>plus</code> is <code>Int -&gt; (Int -&gt; Int)</code>. That first <code>Int</code> is the <code>1</code>, so the remaining type of <code>increment</code> is <code>Int -&gt; Int</code>."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 4, "last_activity_date": 1551232623, "creation_date": 1551232623, "answer_id": 54896871, "question_id": 54896826, "link": "https://stackoverflow.com/questions/54896826/how-does-an-a-function-that-increments-a-value-work/54896871#54896871", "title": "How does an a function that increments a value work?", "body": "<p>It would be <code>increment x = plus 1 x</code>, but generally <code>foo x = bar x</code> is the same thing as <code>foo = bar</code> because if <code>f</code> is a function that returns <code>g(x)</code> whenever called with any argument <code>x</code>, then <code>f</code> is the same function as <code>g</code>. So <code>increment = plus 1</code> works just as well.</p>\n"}, {"comments": [{"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1551233229, "post_id": 54896947, "comment_id": 96562629, "body": "Ok thank you. One more thing: shouldn&#39;t the definition of increment be <code>Int -&gt; (Int -&gt; Int)</code> since it takes an <code>int</code> and passes it to a function that takes an <code>int</code> and returns and <code>int</code>?"}, {"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 1, "creation_date": 1551233396, "post_id": 54896947, "comment_id": 96562678, "body": "To answer my question in the comments: The defintion of <code>increment</code> is <code>Int -&gt; Int</code> because <code>plus 1</code> takes a argument already (1), so <code>increment</code> technically is just a function returned by <code>plus</code>, that is waiting for 1 argument (i.e. this: <code>\\y -&gt; 1 + y</code>). Is my understanding correct?"}, {"owner": {"reputation": 89146, "user_id": 211563, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32a10a2f047dec1e5582e74cba6b3ec?s=128&d=identicon&r=PG", "display_name": "Andrew Marshall", "link": "https://stackoverflow.com/users/211563/andrew-marshall"}, "reply_to_user": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1551233558, "post_id": 54896947, "comment_id": 96562716, "body": "Yes. Any function which takes N arguments and is called with M arguments (where M &lt; N) returns a new function which takes N-M arguments. It\u2019s similar to partial function application (e.g. <a href=\"https://docs.python.org/3.7/library/functools.html#functools.partial\" rel=\"nofollow noreferrer\"><code>functools.partial</code> in Python</a>)."}], "tags": [], "owner": {"reputation": 89146, "user_id": 211563, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d32a10a2f047dec1e5582e74cba6b3ec?s=128&d=identicon&r=PG", "display_name": "Andrew Marshall", "link": "https://stackoverflow.com/users/211563/andrew-marshall"}, "is_accepted": false, "score": 2, "last_activity_date": 1551233346, "last_edit_date": 1551233346, "creation_date": 1551233109, "answer_id": 54896947, "question_id": 54896826, "link": "https://stackoverflow.com/questions/54896826/how-does-an-a-function-that-increments-a-value-work/54896947#54896947", "title": "How does an a function that increments a value work?", "body": "<p>This is because all functions in Haskell are implicitly <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow noreferrer\">curried</a>. As such, there is no distinction between a function which returns a function taking an argument and a function which takes two arguments returning a value (both have the type <code>a -&gt; a -&gt; a</code><sup>\u2020</sup>). So calling <code>plus</code> (or any other function) with too few arguments simply returns a new function with the already-given arguments applied. In most languages, this would be an argument error. See also <a href=\"https://wiki.haskell.org/Pointfree\" rel=\"nofollow noreferrer\">point-free style</a>.</p>\n\n<p><sup>\u2020</sup> Haskell type signatures are right-associative, so <code>a -&gt; a -&gt; a -&gt; a</code> is equivalent to <code>a -&gt; (a -&gt; (a -&gt; a))</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "edited": false, "score": 0, "creation_date": 1551233872, "post_id": 54896987, "comment_id": 96562796, "body": "Thank you. You mentioned that we can follow the equal sign <code>increment = plus 1 = plus 1 y = 1 + y</code> and you mentioned infix functions like <code>(+)</code>. How would we write <code>increment</code> so that it is <code>y + 1</code> after following equal sign, instead of <code>1 + y</code>? Asking because <code>increment = 1 plus</code> does not seem to work since we are supposed to apply the <code>plus</code> function to <code>1</code>, not the other way."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551277575, "post_id": 54896987, "comment_id": 96582393, "body": "Strictly speaking, there is no partial application of functions in Haskell, because <i>every</i> function takes exactly one argument when called. There is just application.  <code>plus 3 4</code> is evaluated as <code>(plus 3) 4</code>: apply the function returned by <code>plus 3</code> to the argument <code>4</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551277684, "post_id": 54896987, "comment_id": 96582449, "body": "It just <i>looks</i> like what languages providing multi-parameter functions would call partial application."}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 5, "last_activity_date": 1551304699, "last_edit_date": 1551304699, "creation_date": 1551233452, "answer_id": 54896987, "question_id": 54896826, "link": "https://stackoverflow.com/questions/54896826/how-does-an-a-function-that-increments-a-value-work/54896987#54896987", "title": "How does an a function that increments a value work?", "body": "<h1>Partial Application</h1>\n\n<p>In Haskell, you can have currying and partial application of functions. Have a look a the <a href=\"https://wiki.haskell.org/Partial_application\" rel=\"nofollow noreferrer\">Haskell Wiki: Partial Application</a></p>\n\n<p>In particular, if you look at the type signature of any function, there's no real distinction between its inputs (arguments) and its outputs, and this is because really your function <code>plus :: Int -&gt; Int -&gt; Int</code> is a function that, when given an Int, will return another function which itself takes the remaining arguments and returns the int: <code>Int -&gt; Int</code>. This is called <strong>partial application</strong></p>\n\n<p>This means that when you call <code>increment = plus 1</code> you are saying that increment is equal to -- remember the partial application -- a function (returned by <code>plus 1</code>) which itself take an integer and returns an integer.</p>\n\n<p>As Haskell is a functional programming language, everything with an equal is not an assignment, but more like a definition, so an easy way to understand partial application is really to follow the equal signs:</p>\n\n<pre><code>increment = plus 1 = \n            plus 1 y = 1 + y\n</code></pre>\n\n<h1>Main uses</h1>\n\n<p>As you can see, partial application can be used to defined more specific functions, like add 1 to a number which is more specific than just add two numbers. It also allows more use of point-free style, where you concatenate more than one function.</p>\n\n<p>Also note that with infix functions lke <code>(+)</code>, you can partially apply to either the left or the right, which can be useful for non-commutative functions, for example</p>\n\n<pre><code>divBy2 :: Float -&gt; Float\ndivBy2 = (/2)\n\ndiv2by :: Float -&gt; Float\ndiv2by = (2/)\n\nPrelude&gt; divBy2 3\n1.5\nPrelude&gt; div2by 2\n1.0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8904109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b0fce5831dbabb0f47d1aed9767304?s=128&d=identicon&r=PG&f=1", "display_name": "ezrakilty", "link": "https://stackoverflow.com/users/8904109/ezrakilty"}, "is_accepted": false, "score": 2, "last_activity_date": 1551247039, "creation_date": 1551247039, "answer_id": 54898941, "question_id": 54896826, "link": "https://stackoverflow.com/questions/54896826/how-does-an-a-function-that-increments-a-value-work/54898941#54898941", "title": "How does an a function that increments a value work?", "body": "<p>The examples of <code>plus</code> and <code>plus'</code> are instructive. You see how the latter seems to have no arguments, at least on the left of the equals sign:</p>\n\n<pre><code>plus' :: Int -&gt; Int -&gt; Int\nplus' = \\x -&gt; \\y -&gt; x + y\n</code></pre>\n\n<p>Let's make another pair of versions of increment (I'll name them after \"bumping\" a number\u2014by 1) that go halfway to the final versions you gave:</p>\n\n<pre><code>bump :: Int -&gt; Int\nbump y = 1 + y\n\nbump' :: Int -&gt; Int\nbump' = \\y -&gt; 1 + y\n</code></pre>\n\n<p>The analogy between these two definitions is just like the one between <code>plus</code> and <code>plus'</code>, so these should make sense, including the latter even though it has no formal arguments on the left-hand side of the equal sign.</p>\n\n<p>Now, your understanding of <code>bump'</code>, is exactly the same understanding you need to understand <code>increment'</code> as you gave it in your question! In fact, we're defining <code>bump'</code> to be equal to something which is exactly what <code>increment'</code> is equal to.</p>\n\n<p>That is (as we'll see shortly), the right-hand side of <code>bump'</code>'s definition,</p>\n\n<pre><code>\\y -&gt; 1 + y\n</code></pre>\n\n<p>is something that is equal to</p>\n\n<pre><code>plus 1\n</code></pre>\n\n<p>The two notations, or expressions, are two syntactic ways of defining \"the function that takes a number and returns one more than it.\"</p>\n\n<p><strong>But what makes them equal?!</strong> Well, (as other answerers have explained) the expression <code>plus 1</code> is <em>partially applied</em>. The compiler, in a way, knows that <code>plus</code> requires two arguments (it was declared that way after all) and so when it appears here applied to just one argument, the compiler knows that it's still waiting for one more. It represents that \"waiting\" by giving you a function, saying, if you give one more argument, whether now or later, doing so will make this thing fully applied and the program will actually jump to the function body of <code>plus</code> (thus computing <code>x + y</code> for the two arguments that were given, the literal <code>1</code> from the expression <code>plus 1</code> and the \"one more\" argument given later)</p>\n\n<p>A key part of the joy and the value of Haskell is thinking about functions as <em>things</em> in themselves, which can be passed around and very flexibly transformed from one into another. Partial application is just such a way of transforming one thing (a function with \"too many arguments\", when you want to fix the value of the extras) into a function of \"just the right many.\" You might pass the partially-applied function to an interface which expects a specific number of arguments. Or you might simply want to define multiple, specialized, functions based on one general definition (as we can define the general <code>plus</code> and more specific functions like <code>plus 1</code> and <code>plus 7</code>). </p>\n"}], "owner": {"reputation": 14927, "user_id": 2719875, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ae764a4524119ce0d93e7d8f0ee2356c?s=128&d=identicon&r=PG&f=1", "display_name": "user2719875", "link": "https://stackoverflow.com/users/2719875/user2719875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 54896987, "answer_count": 4, "score": 2, "last_activity_date": 1551304699, "creation_date": 1551232227, "last_edit_date": 1551298308, "question_id": 54896826, "link": "https://stackoverflow.com/questions/54896826/how-does-an-a-function-that-increments-a-value-work", "title": "How does an a function that increments a value work?", "body": "<p>I'm trying to learn haskell after years of OOP. I'm reading Happy Haskell. It provides this code:</p>\n\n<pre><code>plus :: Int -&gt; Int -&gt; Int\nplus x y = x + y\n\nplus' :: Int -&gt; Int -&gt; Int\nplus' = \\x -&gt; \\y -&gt; x + y\n\nincrement :: Int -&gt; Int\nincrement = plus 1\n\nincrement' :: Int -&gt; Int\nincrement' = (\\x -&gt; \\y -&gt; x + y) 1\n</code></pre>\n\n<p>I understand how plus and plus' work (they're the same, different syntax).\nBut increment, I don't get. </p>\n\n<pre><code>increment :: Int -&gt; Int\n</code></pre>\n\n<p>means it takes an int, and returns an int, right? But right after that, the actual function is:</p>\n\n<pre><code>increment = plus 1\n</code></pre>\n\n<p>Question:</p>\n\n<p>Where is the integer value increment takes? Shouldn't there be an <code>x</code> or something on the right of the <code>=</code> sign, to signify the integer value the function takes as input? Something like:</p>\n\n<pre><code>increment _ = plus 1 x\n</code></pre>\n\n<p>Edit: Also, shouldn't the definition of increment be <code>Int -&gt; (Int -&gt; Int)</code> since it takes an <code>int</code> and passes it to a function that takes an <code>int</code> and returns and <code>int</code>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551232207, "post_id": 54896794, "comment_id": 96562389, "body": "Have a look at list comprehensions and try to write a haskell function to do this"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1551233621, "post_id": 54896794, "comment_id": 96562732, "body": "Also have a look at the Prelude <code>concat</code> function, or just use recursion"}], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551255767, "post_id": 54900770, "comment_id": 96569243, "body": "Clever solution! I would never have thought of using <code>(&lt;*)</code>. But I can&#39;t help but think that this is a bit of overkill for such a simple problem - as mentioned in my answer, I would go with <code>concatMap (\\x -&gt; [x,x])</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1551255959, "post_id": 54900770, "comment_id": 96569331, "body": "@bradrn, I think that would be an entirely reasonable choice!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1551255660, "last_edit_date": 1551255660, "creation_date": 1551254982, "answer_id": 54900770, "question_id": 54896794, "link": "https://stackoverflow.com/questions/54896794/how-to-iterate-over-a-list-of-characters-and-manipluate-the-characters-in-haskel/54900770#54900770", "title": "How to iterate over a list of characters and manipluate the characters in Haskell?", "body": "<p>As others have suggested, it's probably wise to start with a list comprehension:</p>\n\n<pre><code>-- | Repeat each element of a list twice.\ndouble :: [x] -&gt; [x]\ndouble xs = [d | x &lt;- xs, d &lt;- [x, x]]\n</code></pre>\n\n<p>But the fact that the second list in the comprehension always has the same number of elements, regardless of the value of <code>x</code>, means that we don't need quite that much power: the <code>Applicative</code> interface is sufficient. Let's start by writing the comprehension a bit differently:</p>\n\n<pre><code>double xs = xs &gt;&gt;= \\x -&gt; [x, x] &gt;&gt;= \\d -&gt; pure d\n</code></pre>\n\n<p>We can simplify immediately using a monad identity law:</p>\n\n<pre><code>double xs = xs &gt;&gt;= \\x -&gt; [x, x]\n</code></pre>\n\n<p>Now we switch over to <code>Applicative</code>, but let's leave a hole for the hard part:</p>\n\n<pre><code>double :: [x] -&gt; [x]\ndouble xs = liftA2 _1 xs [False, True]\n</code></pre>\n\n<p>The compiler lets us know that</p>\n\n<pre><code>_1 :: x -&gt; Bool -&gt; x\n</code></pre>\n\n<p>Since the elements of the inner/second list are always the same, and always come from the current outer/first list element, we don't have to care about the <code>Bool</code>:</p>\n\n<pre><code>double xs = liftA2 const xs [False, True]\n</code></pre>\n\n<p>Indeed, we don't even need to be <em>able</em> to distinguish the list positions:</p>\n\n<pre><code>double xs = liftA2 const xs [(),()]\n</code></pre>\n\n<p>Of course, we have a special <code>Applicative</code> method, <code>(&lt;*)</code>, that corresponds to <code>liftA2 const</code>, so let's use it:</p>\n\n<pre><code>double xs = xs &lt;* [(),()]\n</code></pre>\n\n<p>And then, if we like, we can avoid mentioning <code>xs</code> by switching to a \"point-free\" form:</p>\n\n<pre><code>-- | Repeat each element of a list twice.\ndouble :: [x] -&gt; [x]\ndouble = (&lt;* [(),()])\n</code></pre>\n\n<p>Now for the test:</p>\n\n<pre><code>main :: IO ()\nmain = print $ double [1..3]\n</code></pre>\n\n<p>This will print <code>[1,1,2,2,3,3]</code>.</p>\n\n<hr>\n\n<p><code>double</code> admits a slight generalization of dubious value:</p>\n\n<pre><code>double :: Alternative f =&gt; f x -&gt; f x\ndouble = (&lt;* join (&lt;|&gt;) (pure ()))\n</code></pre>\n\n<p>This will work for sequences as well as lists:</p>\n\n<pre><code>double (Data.Sequence.fromList [1..3]) = Data.Sequence.fromList [1,1,2,2,3,3]\n</code></pre>\n\n<p>but it could be a bit confusing for some other <code>Alternative</code> instances:</p>\n\n<pre><code>double (Just 3) = Just 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 3, "last_activity_date": 1551255661, "creation_date": 1551255661, "answer_id": 54900926, "question_id": 54896794, "link": "https://stackoverflow.com/questions/54896794/how-to-iterate-over-a-list-of-characters-and-manipluate-the-characters-in-haskel/54900926#54900926", "title": "How to iterate over a list of characters and manipluate the characters in Haskell?", "body": "<p>One of the nicest thing about functional programming is that patterns like yours can be encapsulated in one higher-order function; if nothing fits, you can still use recursion. </p>\n\n<h1>Recursion</h1>\n\n<p>First up, a simple recursive solution. The idea behind this is that it's like a for-loop:</p>\n\n<pre><code>recursiveFunction [] = baseCase\nrecursiveFunction (char1:rest) = (doSomethingWith char1) : (recursiveFunction rest)\n</code></pre>\n\n<p>So let's write your <code>repeat</code> function in this form. What is the base case? Well, if you <code>repeat</code> an empty string, you'll get an empty string back. What is the recursion? In this case, we're doubling the first character, then recursing along the rest of the string. So here's a recursive solution:</p>\n\n<pre><code>repeat1 [] = []\nrepeat1 (c:cs) = c : c : (repeat1 cs)\n</code></pre>\n\n<h1>Higher-order Functions</h1>\n\n<p>As you start writing more Haskell, you'll discover that these sort of recursive solutions often fit into a few repetitive patterns. Luckily, the standard library contains several predefined recursive functions for these sort of patterns:</p>\n\n<ul>\n<li><code>fmap</code> is used to map each element of a list to a different value using a function given as a parameter. For example, <code>fmap (\\x -&gt; x + 1)</code> adds <code>1</code> to each element of a list. Unfortunately, it can't change the length of a list, so we can't use <code>fmap</code> by itself.</li>\n<li><code>concat</code> is used to 'flatten' a nested list. For example, <code>concat [[1,2],[3,4,5]]</code> is <code>[1,2,3,4,5]</code>.</li>\n<li><code>foldr</code>/<code>foldl</code> are two more complex and generic functions. For more details, consult <a href=\"http://learnyouahaskell.com/higher-order-functions#folds\" rel=\"nofollow noreferrer\">Learn You a Haskell</a>.</li>\n</ul>\n\n<p>None of these seem to directly fit your needs. However, we can use <code>concat</code> and <code>fmap</code> together:</p>\n\n<pre><code>repeat2 list = concat $ fmap (\\x -&gt; [x,x]) list\n</code></pre>\n\n<p>The idea is that <code>fmap</code> changes e.g. <code>[1,2,3]</code> to a nested list <code>[[1,1],[2,2],[3,3]]</code>, which concat then flattens. This pattern of generating multiple elements from a single one is so common that the combination even has a special name: <code>concatMap</code>. You use it like so:</p>\n\n<pre><code>repeat3 list = concatMap (\\x -&gt; [x,x]) list\n</code></pre>\n\n<p>Personally, this is how I'd write <code>repeat</code> in Haskell. (Well, <em>almost</em>: I'd use <em>eta-reduction</em> to simplify it slightly more. But at your level that's irrelevant.) This is why Haskell in my opinion is so much more powerful than many other languages: this 7-line Java method is one line of highly readable, idiomatic Haskell!</p>\n"}], "owner": {"reputation": 19, "user_id": 8692871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb1e004103a621b1f4bab3137bbfec8?s=128&d=identicon&r=PG&f=1", "display_name": "EatRocks", "link": "https://stackoverflow.com/users/8692871/eatrocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1551255661, "creation_date": 1551232023, "question_id": 54896794, "link": "https://stackoverflow.com/questions/54896794/how-to-iterate-over-a-list-of-characters-and-manipluate-the-characters-in-haskel", "title": "How to iterate over a list of characters and manipluate the characters in Haskell?", "body": "<p>I am trying to go through a list of characters in a list and do something to the current character. My java equivalent of what I am trying to accomplish is: </p>\n\n<pre><code>public class MyClass {\n    void repeat(String s) {\n        String newString = \"\";\n\n        for(int i = 0; i &lt; s.length(); i++) {\n          newString += s.charAt(i);\n          newString += s.charAt(i);\n        }\n\n public static void main(String args[]) {\n    MyClass test = new MyClass();\n    test.repeat(\"abc\");\n  }\n}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 4, "creation_date": 1551224445, "post_id": 54895657, "comment_id": 96560740, "body": "The <code>xss</code>, <code>xs</code>, and <code>x</code> values could have any name. It&#39;s just a naming convention. <code>xss :: [[a]]; xs :: [a]; x :: a</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551224456, "post_id": 54895657, "comment_id": 96560744, "body": "I actually am confused by this, although not by the list comprehension. My questions are: 1) why define it explicitly like this when <code>concat</code> is already in the Prelude and does the same thing 2) what happened to <code>mappend</code>? I always thought <code>mappend</code> was needed for a <code>Monoid</code> instance along with <code>mempty</code>, with <code>mconcat</code> having a default definition in terms of <code>mappend</code>?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551224708, "post_id": 54895657, "comment_id": 96560810, "body": "@RobinZigmond - <code>mappend</code> has a default implementation of <code>(&lt;&gt;)</code> from the <code>Semigroup</code> superclass of <code>Monoid</code>. The <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-290\" rel=\"nofollow noreferrer\">implementation</a> for list is <code>(++)</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551225209, "post_id": 54895657, "comment_id": 96560936, "body": "@RobinZigmond As for why to define <code>mconcat</code> by hand: you say <code>concat</code> is in the prelude and does the same thing, but it does not: the <code>concat</code> in Prelude is polymorphic, working on any Foldable. Perhaps GHC inlines and fuses well enough that the polymorphic version is as fast as possible, I don&#39;t know, but the explicit list comprehension is at least very clear in what it will do."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1551225235, "post_id": 54895657, "comment_id": 96560939, "body": "@Lee - thanks, I always forget that <code>Monoid</code> instances need to already be <code>Semigroup</code>s (until I try to write an instance and the compiler complains :) )"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1551226626, "post_id": 54895657, "comment_id": 96561293, "body": "@amalloy - thanks, I know the version in Prelude is polymorphic but I assumed GHC was able to specialise this to lists in a context where lists are clearly being used. But perhaps it is performance-related, as you suggest, since I imagine finding the right version of the polymorphic <code>concat</code> to use would have a little bit of performance overhead."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9664064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516bf4b1ec065433000a7f041c557607?s=128&d=identicon&r=PG&f=1", "display_name": "Software Wisdom", "link": "https://stackoverflow.com/users/9664064/software-wisdom"}, "edited": false, "score": 0, "creation_date": 1551223943, "post_id": 54895740, "comment_id": 96560581, "body": ",still confusing about that xss, xs, x part, are those 3 symbol has a particular  meaning? what if i do ss from xss , what is that mean?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 83, "user_id": 9664064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516bf4b1ec065433000a7f041c557607?s=128&d=identicon&r=PG&f=1", "display_name": "Software Wisdom", "link": "https://stackoverflow.com/users/9664064/software-wisdom"}, "edited": false, "score": 2, "creation_date": 1551224690, "post_id": 54895740, "comment_id": 96560807, "body": "@SoftwareWisdom - as @4castle said above, it&#39;s just a naming convention, they could have been anything. But <code>x</code> is an element of type <code>a</code>, <code>xs</code> is a list of <code>a</code>s, and <code>xss</code> is a list of lists of <code>a</code>s, so the convention reminds you of the structure."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 83, "user_id": 9664064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516bf4b1ec065433000a7f041c557607?s=128&d=identicon&r=PG&f=1", "display_name": "Software Wisdom", "link": "https://stackoverflow.com/users/9664064/software-wisdom"}, "edited": false, "score": 1, "creation_date": 1551224751, "post_id": 54895740, "comment_id": 96560831, "body": "@SoftwareWisdom these are just variable names, they could be named <code>a,b,c</code> instead. It is however somewhat conventional to use <code>x</code> for a list element and <code>xs</code> for the list itself (being the &quot;plural&quot; of <code>x</code>). By extension, <code>xss</code> is a name appropriate for a list-of-lists."}], "tags": [], "owner": {"reputation": 353, "user_id": 6471510, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/bac79f1fe5544d00e5d2f94bf0b383d9?s=128&d=identicon&r=PG&f=1", "display_name": "trpnd", "link": "https://stackoverflow.com/users/6471510/trpnd"}, "is_accepted": true, "score": 6, "last_activity_date": 1551223378, "creation_date": 1551223378, "answer_id": 54895740, "question_id": 54895657, "link": "https://stackoverflow.com/questions/54895657/regarding-haskell-list-monoid-implementation/54895740#54895740", "title": "Regarding Haskell list monoid implementation", "body": "<p>Like any Haskell issue we should start by looking at the types. We have <code>mconcat :: Monoid m =&gt; [m] -&gt; m</code>, which means that to define a Monoid instance for <code>[a]</code> we need a function that takes a list of lists and returns a list, that is, <code>mconcat :: [[a]] -&gt; [a]</code>. Therefore, <code>xss</code> is a list of lists. The expression <code>[x | xs &lt;- xss, x &lt;- xs]</code> is a list comprehension. This constructs a list by selecting every possible list <code>xs</code> from the list-of-lists <code>xxs</code>, and then in turn selecting every element <code>x</code> from the list <code>xs</code>. The output list consists of all possible values <code>x</code>. This essentially means that <code>mconcat</code> takes a list-of-lists and returns a list containing every value in every list in the original list-of-lists.</p>\n"}], "owner": {"reputation": 83, "user_id": 9664064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516bf4b1ec065433000a7f041c557607?s=128&d=identicon&r=PG&f=1", "display_name": "Software Wisdom", "link": "https://stackoverflow.com/users/9664064/software-wisdom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 54895740, "answer_count": 1, "score": -2, "last_activity_date": 1551223561, "creation_date": 1551222765, "last_edit_date": 1551223561, "question_id": 54895657, "link": "https://stackoverflow.com/questions/54895657/regarding-haskell-list-monoid-implementation", "title": "Regarding Haskell list monoid implementation", "body": "<p>Reading Haskell Monoid source code, i see this,</p>\n\n<pre><code>instance Monoid [a] where\n        {-# INLINE mempty #-}\n        mempty  = []\n        {-# INLINE mconcat #-}\n        mconcat xss = **[x | xs &lt;- xss, x &lt;- xs]**\n</code></pre>\n\n<p>i do not understand that <strong>xss</strong>, what is xss? and list generator part is confusing too, xs &lt;- xss, how comes?</p>\n\n<p>update:</p>\n\n<p>list comprehension is easy to understand, but look at code, xss, xs, x, what are relationship among 3 symbols, and why xs &lt;- xss? can i write xss &lt;- xsss?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1551205582, "creation_date": 1551205582, "answer_id": 54891889, "question_id": 54890525, "link": "https://stackoverflow.com/questions/54890525/handle-one-connection-for-all-the-server-request/54891889#54891889", "title": "handle one connection for all the server request", "body": "<p>If losing the database connection is rare, letting the server crash, and some supervisory process restart it, works quite well.</p>\n\n<p>If losing the DB connection is common enough that you can't tolerate client timeouts from restarting the server, you can add reconnect logic to whatever code uses the DB connection.  I usually use <a href=\"https://hackage.haskell.org/package/resource-pool-0.2.3.2/docs/Data-Pool.html\" rel=\"nofollow noreferrer\">resource-pool</a> for this.  I believe you can create the \"pool\" with only one resource, if that fits your database.</p>\n\n<p>Usually getting a DB connection is fast, so I'm guessing it's not worth extra effort to route incoming requests elsewhere.  <code>withResource</code> in <code>resource-pool</code> blocks until a resource is ready, so active requests can easily wait while you reconnect.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54891889, "answer_count": 1, "score": 1, "last_activity_date": 1551205582, "creation_date": 1551200176, "last_edit_date": 1551203637, "question_id": 54890525, "link": "https://stackoverflow.com/questions/54890525/handle-one-connection-for-all-the-server-request", "title": "handle one connection for all the server request", "body": "<p>Here is the following code : </p>\n\n<pre><code>start :: Settings -&gt; IO ()\nstart settings @ Settings {healthCheckLoggerId}  = do\n  waitTillHealthy\n    healthCheckLoggerId\n    settings\n    Server.getDependencies\n    Server.healthCheck\n  Server.getDependencies\n   settings\n   (runServerOnWarp)\n\n  where\n\n    runServerOnWarp :: Server.Dependencies -&gt; IO()\n    runServerOnWarp dependencies @ Server.Dependencies {logger,port} = do\n       run port $ application\n                    (proxy :: Proxy GSDMonitoringStreamingApi)\n                    monitoringServer\n                    dependencies\n\n    monitoringServer :: ServantServer GSDMonitoringStreamingApi Server.Dependencies\n    monitoringServer dependencies = streamCommand dependencies\n      where\n\n        streamCommandResponse :: Server.Dependencies -&gt;\n                                 WorkspaceId -&gt;\n                                 Handler (PipeStream (Either StreamIssue (Persisted CommandResponse)))\n        streamCommandResponse Server.Dependencies {eventStoreClientDependencies} =\n          return . toPipes . GsdMonitoring.streamCommandResponse eventStoreClientDependencies\n</code></pre>\n\n<hr>\n\n<p>Explanation of the issue :</p>\n\n<p>the function <code>Server.getDependencies</code> is wrapping a bracket pattern that get a connection to a database (the client of that database recommend using one connection for all not one for each request). \nFirst I'm running a healthCheck which is blocking till everything is fine. Each time I'm testing the health check of a dependency each time I'm acquiring a new connection. Once the environnement is healthy, I'm getting again the <code>Server.Dependencies</code> (db connection), and I'm running the server. Everything running into <code>runServerOnWarp</code> is executed in the <code>-- ^ computation to run in-between</code> section from </p>\n\n<pre><code>bracket\n        :: IO a         -- ^ computation to run first (\\\"acquire resource\\\")\n        -&gt; (a -&gt; IO b)  -- ^ computation to run last (\\\"release resource\\\")\n        -&gt; (a -&gt; IO c)  -- ^ computation to run in-between\n        -&gt; IO c         -- returns the value from the in-between computation\n</code></pre>\n\n<p>so all the requests are executed into that section and get the same connection, so far so good... Because that section :</p>\n\n<pre><code>run port $ application\n              (proxy :: Proxy GSDMonitoringStreamingApi)\n              monitoringServer dependencies\n</code></pre>\n\n<p>is never ending, we are always staying in the <code>computation to run in-between</code> (except when I kill the app...)</p>\n\n<p>Now the issue I have is when the connection get closed.... all my request will return Left StreamIssue which is fine but I have to get a new connection from Server.getDependencies. I don't know how to do it properly :-( Hacks that I have in mind but I don't like are : </p>\n\n<p>1) Having one connection for one request</p>\n\n<p>2) Raising an exception when the request stream a Left streamIssue, that somehow restart the server to get new dependencies... The issue is that the client of the server never get a Left value and the communication between the 2 is violently closed because the server is restarted... </p>\n\n<p>Do you have a cleaner way in mind ?</p>\n\n<p>P.S : I hope the details are enough to understand the issue, don't hesitate for more information if necessary...     </p>\n"}, {"tags": ["function", "haskell", "io", "monads", "do-notation"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551189908, "post_id": 54887173, "comment_id": 96543562, "body": "shouldn&#39;t it be <code>(readLn :: IO Int) &gt;&gt;= \\age -&gt; ...</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1551189990, "creation_date": 1551189990, "answer_id": 54887344, "question_id": 54887173, "link": "https://stackoverflow.com/questions/54887173/how-to-rewrite-do-block-using-bind-with-an-io-read-int/54887344#54887344", "title": "How to rewrite `do` block using bind with an IO read Int?", "body": "<p>You are changing the code too much, e.g. removing <code>Int</code> from <code>IO Int</code>, and inserting lambdas in the wrong points.</p>\n\n<p>Something like this should work:</p>\n\n<pre><code>prog =\n   putStrLn \"Hello there! How old are you?\" &gt;&gt;\n   (readLn :: IO Int) &gt;&gt;= \\age -&gt;\n   let agedays = show $ age * 365\n   in putStrLn $ \"So you are at least than \" ++ agedays ++ \" days old.\" &gt;&gt;\n   return (read agedays)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 5, "last_activity_date": 1555833161, "last_edit_date": 1555833161, "creation_date": 1551190414, "answer_id": 54887465, "question_id": 54887173, "link": "https://stackoverflow.com/questions/54887173/how-to-rewrite-do-block-using-bind-with-an-io-read-int/54887465#54887465", "title": "How to rewrite `do` block using bind with an IO read Int?", "body": "<p>You can let the type inference do the work for you,</p>\n\n<pre><code>prog :: IO Int\nprog =\n     putStrLn \"Hello there! How old are you?\" &gt;&gt;\n     readLn &gt;&gt;= (\\ age -&gt;\n     let agedays = age * 365 in\n       putStrLn (\"So you are at least \" ++ show agedays ++ \" days old.\") &gt;&gt;\n       return agedays )\n</code></pre>\n\n<p>Since you already specify <code>prog :: IO Int</code>, it means <code>return agedays :: IO Int</code>, and <code>agedays :: Int</code>. </p>\n\n<p>Then, both operands to <code>*</code> in <code>age * 365</code> must be of the same type, specifically, that of <code>agedays</code>, since we have <code>agedays = age * 365</code> there. Thus it follows that <code>age :: Int</code> already.</p>\n"}], "owner": {"reputation": 65, "user_id": 8176414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YJUiJ.jpg?s=128&g=1", "display_name": "ArdianH101", "link": "https://stackoverflow.com/users/8176414/ardianh101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 54887465, "answer_count": 2, "score": 0, "last_activity_date": 1555833161, "creation_date": 1551189484, "last_edit_date": 1551191715, "question_id": 54887173, "link": "https://stackoverflow.com/questions/54887173/how-to-rewrite-do-block-using-bind-with-an-io-read-int", "title": "How to rewrite `do` block using bind with an IO read Int?", "body": "<p>So, I want to rewrite the given <code>prog</code> function with using <code>&gt;&gt;</code>/<code>&gt;&gt;=</code> bindings instead of <code>do</code> and <code>&lt;-</code> :</p>\n\n<pre><code>prog :: IO Int\n     prog =\n       do putStrLn \"Hello there! How old are you?\"\n       age &lt;- (readLn :: IO Int)\n       let agedays = show $ age * 365\n       putStrLn $ \"So you are at least than \" ++ agedays ++ \" days old.\"\n       return (read agedays)\n</code></pre>\n\n<p>Rewriting more simple functions is not a problem for me, but the <code>readLn :: IO Int</code> is giving me a headache...</p>\n\n<p>My suggestion was:</p>\n\n<pre><code>prog :: IO Int\nprog =\n     putStrLn \"Hello there!How old are you?\" &gt;&gt;\n     readLn::IO &gt;&gt;=\n     let agedays = \\age -&gt; show $ age * 365 &gt;&gt;\n     putStrLn $ \"So you are at least than \" ++ agedays ++ \" days old.\"\n</code></pre>\n\n<p>However this just does not work, as there is a problem with binding the <code>readLn :: IO</code> to the next anonymous function <code>\\age</code>. Any help?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551219289, "post_id": 54886974, "comment_id": 96559030, "body": "By the way: do not look to the <code>Exception</code> class for a good example of how to design a class or use an existential type. It&#39;s a terrible example of both. It also fails horribly at (reliably) distinguishing the three very different concepts of imprecise exception, precise/<code>IO</code> exception, and asynchronous exception."}], "answers": [{"tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 4, "last_activity_date": 1551190753, "creation_date": 1551190753, "answer_id": 54887583, "question_id": 54886974, "link": "https://stackoverflow.com/questions/54886974/someexception-datatype-in-haskell/54887583#54887583", "title": "SomeException datatype in haskell", "body": "<p>The first is called <a href=\"https://wiki.haskell.org/Existential_type\" rel=\"nofollow noreferrer\">Existential type</a>. The second one won't even compile. </p>\n\n<p>Basically, you have to add <code>forall</code> it if you want some variable to only appear in the right-hand side (the right side of =)</p>\n\n<p>It allows you e.g. to create heterogeneous list, e.g. <code>[SomeException]</code> could contain list of <code>SomeException e</code> where <code>e</code> is different for each element. </p>\n"}, {"tags": [], "owner": {"reputation": 3637, "user_id": 797637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1577f43a7c6eb01836e1758a2ba4df5?s=128&d=identicon&r=PG&f=1", "display_name": "firefrorefiddle", "link": "https://stackoverflow.com/users/797637/firefrorefiddle"}, "is_accepted": false, "score": 3, "last_activity_date": 1551190942, "creation_date": 1551190942, "answer_id": 54887644, "question_id": 54886974, "link": "https://stackoverflow.com/questions/54886974/someexception-datatype-in-haskell/54887644#54887644", "title": "SomeException datatype in haskell", "body": "<p>The second variant doesn't even compile. You get:</p>\n\n<pre><code>error: Not in scope: type variable e\n</code></pre>\n\n<p>The reason is that it isn't clear which <code>e</code> you are referring to. You can add <code>e</code> as a type parameter on the left hand side:</p>\n\n<pre><code>data SomeException e = Exception e =&gt; SomeException e\n</code></pre>\n\n<p>However, this loses the point of having a <code>SomeException</code> in the first place, which is to hide the details about which concrete exception is involved. Now any function taking <code>SomeException e</code> as input would have to know about the type of <code>e</code>, again.</p>\n\n<p><code>forall e.</code> allows us to specify that we really don't care what data object is inside <code>SomeException</code> as long as it is an instance of <code>Exception</code>. That also means that we can't do anything with any <code>SomeException</code> item except for what's contained in the type class <code>Exception</code>. </p>\n\n<p>You can read more about it in the <a href=\"https://en.wikibooks.org/wiki/Haskell/Existentially_quantified_types\" rel=\"nofollow noreferrer\">Wikibook</a>.</p>\n"}], "owner": {"reputation": 45, "user_id": 10984616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4014894137a142c00e589037d466cd?s=128&d=identicon&r=PG&f=1", "display_name": "Walid Juhu", "link": "https://stackoverflow.com/users/10984616/walid-juhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 2, "accepted_answer_id": 54887583, "answer_count": 2, "score": 3, "last_activity_date": 1551190942, "creation_date": 1551188859, "question_id": 54886974, "link": "https://stackoverflow.com/questions/54886974/someexception-datatype-in-haskell", "title": "SomeException datatype in haskell", "body": "<p>What is the difference between ?</p>\n\n<pre><code>data SomeException = forall e . Exception e =&gt; SomeException e\n\ndata SomeException = Exception e =&gt; SomeException e\n</code></pre>\n\n<p>Why do we need forall ?\n<a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html\" rel=\"nofollow noreferrer\">link to source</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551188733, "post_id": 54886646, "comment_id": 96542801, "body": "The definition of ambiguous type is practically staring you in the nose there. It&#39;s a type with a variable that appears on the left of an <code>=&gt;</code> but not on the right. Just spell the sentence in this order instead: &quot;By \u2018ambiguous\u2019 we mean that there is a type variable that appears on the left of the \u21d2 symbol, but not on the right (and in the example above that variable is named e).&quot;"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551188919, "post_id": 54886646, "comment_id": 96542929, "body": "What does the sentence <code>The problem with this is that, according to the theoretical foundations of Haskell overloading, we cannot guarantee a well- defined semantics for any term with an ambiguous type [2, 4].</code> mean?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551190614, "post_id": 54886646, "comment_id": 96544024, "body": "&quot;Ambiguous&quot; just means we don&#39;t know what <code>e</code> represents. If we don&#39;t know what <code>e</code> means, we can&#39;t know what <code>empty</code> means."}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 1, "creation_date": 1551230863, "post_id": 54887789, "comment_id": 96562101, "body": "The quote says &quot;we cannot guarantee&quot; because maybe everywhere <code>empty</code> appears, it gets an explicit signature with the element type <code>:: Collects Int SomeType =&gt; SomeType</code> or <code>empty</code> is an argument to an <code>insert</code> with an element of known type. But the compiler won&#39;t take that risk, unless you set <code>AllowAmbiguousTypes</code>."}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 3, "last_activity_date": 1551191390, "creation_date": 1551191390, "answer_id": 54887789, "question_id": 54886646, "link": "https://stackoverflow.com/questions/54886646/what-is-an-ambigous-type-in-the-context-with-the-function/54887789#54887789", "title": "what is an ambigous type in the context with the function?", "body": "<p>So as other pointed out we don't know the <code>e</code> variable because it only appears on the left:</p>\n\n<pre><code>empty :: Collects e ce \u21d2 ce\n</code></pre>\n\n<p>Let's suppose there exist two instances of <code>Collects</code>:</p>\n\n<pre><code>instance Collects Int SomeType\ninstance Collects Char SomeType\n</code></pre>\n\n<p>so what instance should <code>empty</code> use here:</p>\n\n<pre><code>let result = empty :: SomeType\n</code></pre>\n\n<p>It can be either the first or the second one. But since we don't know which one to use it's ambiguous.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54887789, "answer_count": 1, "score": 1, "last_activity_date": 1551191390, "creation_date": 1551187800, "question_id": 54886646, "link": "https://stackoverflow.com/questions/54886646/what-is-an-ambigous-type-in-the-context-with-the-function", "title": "what is an ambigous type in the context with the function?", "body": "<p>I am reading the following <a href=\"https://www.cs.tufts.edu/~nr/cs257/archive/mark-jones/fundeps.ps\" rel=\"nofollow noreferrer\">doc</a> about functional dependencies. On the page 5, it describes the ambiguous type: </p>\n\n<blockquote>\n  <p>First, the empty function has an ambiguous type:  </p>\n\n<pre><code>empty :: Collects e ce \u21d2 ce.\n</code></pre>\n  \n  <p>By \u2018ambiguous\u2019 we mean that there is a type variable e that appears on\n  the left of the \u21d2 symbol, but not on the right. The problem with this\n  is that, according to the theoretical foundations of Haskell\n  overloading, we cannot guarantee a well- defined semantics for any\n  term with an ambiguous type [2, 4]. For this reason, a Haskell system\n  will reject any attempt to define or use such terms.</p>\n</blockquote>\n\n<p>I have a few questions:</p>\n\n<ol>\n<li>What is exactly an ambiguous type? </li>\n<li>What does the author mean with <code>we cannot guarantee a well- defined \nsemantics for any term with an ambiguous type</code>, that is influence by an ambiguous type.</li>\n</ol>\n"}, {"tags": ["haskell", "gif", "io-monad", "gloss"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551182150, "post_id": 54883961, "comment_id": 96538847, "body": "<a href=\"https://hoogle.haskell.org/?hoogle=loadBMP\" rel=\"nofollow noreferrer\">Hoogle says</a>: <code>loadBMP :: FilePath -&gt; IO Picture</code>."}, {"owner": {"reputation": 452, "user_id": 3531310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c879bfa7b230a3b1a3f96fd3cb830e?s=128&d=identicon&r=PG&f=1", "display_name": "jaroslawj", "link": "https://stackoverflow.com/users/3531310/jaroslawj"}, "edited": false, "score": 0, "creation_date": 1551187289, "post_id": 54883961, "comment_id": 96541933, "body": "Why are you assigning &quot;image.gif&quot; to loadGifFile instead of passing it as an argument?"}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 2, "last_activity_date": 1551197891, "creation_date": 1551197891, "answer_id": 54889852, "question_id": 54883961, "link": "https://stackoverflow.com/questions/54883961/how-do-i-load-a-gif-image-from-computer-in-haskell/54889852#54889852", "title": "How do I load a GIF-image from computer in Haskell?", "body": "<p>You are going to have to do some more work. <code>loadBMP</code> just loads a BMP file into a bitmap, which is a single image. However an animated GIF is a more complex file format which has several frames in it. GLOSS simply doesn't support that out of the box.</p>\n\n<p>You could use <a href=\"http://hackage.haskell.org/package/JuicyPixels-3.3.3/docs/Codec-Picture-Gif.html\" rel=\"nofollow noreferrer\">JuicyPixels</a> to decode a GIF file and then write some code to convert that into a list of GLOSS Bitmaps. Then use <code>animate</code> to draw those images in sequence.</p>\n"}], "owner": {"reputation": 19, "user_id": 11056883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8a2532c925bf113e39ce30c6b8fe46?s=128&d=identicon&r=PG&f=1", "display_name": "blobfish", "link": "https://stackoverflow.com/users/11056883/blobfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551197891, "creation_date": 1551178749, "last_edit_date": 1551179756, "question_id": 54883961, "link": "https://stackoverflow.com/questions/54883961/how-do-i-load-a-gif-image-from-computer-in-haskell", "title": "How do I load a GIF-image from computer in Haskell?", "body": "<p>I want to have a GIF-image looping in the background of a game (For example with Gloss Juicy or module Codec.Picture.Gif)</p>\n\n<p>Managed to work with a BMP image like this: </p>\n\n<pre><code>image :: IO Picture \nimage = loadBMP \"image.bmp\"\n</code></pre>\n\n<p>But now I want to do the same with a GIF image: </p>\n\n<pre><code>loadGifFile :: FilePath -&gt; IO Image \nloadGifFile = \"image.gif\"\n</code></pre>\n\n<p>Can't get it to work.</p>\n\n<p>Thankful for any tip how to do it.</p>\n"}, {"tags": ["haskell", "types", "polymorphism", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1551177127, "post_id": 54883365, "comment_id": 96535935, "body": "<code>example1</code> there isn&#39;t a function. It&#39;s just the empty list. The point being made is that this is really a &quot;polymorphic constant&quot; (much like number literals are), it can have type <code>[a]</code> for <i>any</i> type <code>a</code>. You don&#39;t actually need the <code>forall a.</code> there (or in any of the examples on the page you linked to), because it&#39;s understood implicitly by Haskell. But you do need explicit <code>forall</code>s once you get into Rank 2 types (and higher)."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551182457, "post_id": 54883365, "comment_id": 96539030, "body": "Note the warning just before that section. Beware that keyword <code>forall</code> appears in two utterly different contexts of a type signature (and this confuses the heck out of me): either it&#39;s universal quantification, and in that case it&#39;s usually optional; or it&#39;s existential quantification/<code>Rank 2</code> (or higher) types, and in that case it&#39;s required."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551182532, "post_id": 54883365, "comment_id": 96539079, "body": "@RobinZigmond personally, I prefer &quot;polymorphic constant <i>definition</i>&quot;. I.e. it is a definition capable of defining an empty list <code>[] :: [a]</code> constant for any specific choice of <code>a</code>. (or should it then be <code>A</code>?..)."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551189288, "post_id": 54886851, "comment_id": 96543158, "body": "this leaves the door open to a question like, &#39;So why shouldn&#39;t I be able to have a list of Ints, Floats and Strings all mixed together if all I&#39;m going to do is measure its length?&#39;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551195577, "post_id": 54886851, "comment_id": 96547344, "body": "@WillNess Certainly! And that&#39;s the purpose of existential quantification, a thing that also exists in Haskell. But zero_coding asked about universal quantification, not existential..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551195709, "post_id": 54886851, "comment_id": 96547430, "body": "I was aiming more at the essence of polymorphic typing, why the lists must be  homogeneous, etc. Was hoping you cold shed some light on that. I don&#39;t need existential types to measure the length. or to zip. it probably goes to the heart of static vs dynamic typing...?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551198961, "post_id": 54886851, "comment_id": 96549336, "body": "@WillNess A koan that may focus your thinking on this topic: you don&#39;t need types at all, for any algorithm. What good are they, then?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551209605, "post_id": 54886851, "comment_id": 96554781, "body": "I understand the HM attitude on this, but surely there are more than two edge points on that spectrum. imagine <code>let xs=[(1,True),(&quot;2&quot;,False)] in (map fst $ filter snd xs, map fst $ filter (not.snd) xs)</code>. the end result is well typed, makes sense. if list manipulation functions should only perform structural manipulations, why should they concern themselves with lists&#39; homogeneity? HM says, OK, but such lists won&#39;t make sense <i>afterwards</i> anyway. My example shows, they <i>could be</i>. Traits of involved values could be gradually discoverable, as the program progresses... etc."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551212716, "post_id": 54886851, "comment_id": 96556144, "body": "I&#39;ll give you another example. <code>sieve (x:xs) = x:sieve (remove (multsof x) xs)</code> admits <i>two pairs</i> of implementations of <code>remove</code> and <code>multsof</code> going together, each pair making sense in its own unique way (thus, with radically different types). HM wants the types known upfront, so forces us to choose too early. but <code>sieve</code> could conceivably have a &quot;type&quot; <i>before</i> the <i>implementation</i> choice was made. (motivation: write executable specification, let a compiler choose specific implementation (say, optimizing for space, or speed, or clarity of error traces, etc.).)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551214062, "post_id": 54886851, "comment_id": 96556820, "body": "(...contd) it could even choose arrays instead of lists, if all I had in the end was <code>main = readLn &gt;&gt;= \\n -&gt; print $ sieve [2..100] !! n</code>. a feat unimaginable with HM. /empty musings, huh... well, that&#39;s what I was expecting of Haskell when I first learned about it... all that hype!.. i.e. why should I the app programmer ever need to know about lists or arrays or B-trees or finger trees etc. Let the compiler analyze my code and choose the appropriate implementation according to whatever option is chosen... or recompile constantly in actual run-time according to the app&#39;s use patterns."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551216387, "post_id": 54886851, "comment_id": 96557821, "body": "@WillNess That&#39;s quite a rant! I&#39;m not sure where it leaves us, though. I&#39;m tempted to suggest you open an SO question yourself and use the expanded space to give your perspective more fully, but... honestly it would probably get closed as &quot;too broad&quot; faster than an answer could get written, hah! I do have some thoughts, but I also wonder: is this still a grudge you harbor against Haskell, or are these mostly musings on the thoughts a beginner <i>could</i> be having coming into this question, or what? How are you hoping people will engage with this?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551216771, "post_id": 54886851, "comment_id": 96557971, "body": "No, not a grudge. I&#39;ve long since come to grips with Haskell being yet another programming language. I was just hoping for some light from you on these kinds of subtleties with type systems and the reasons for this or that decision taken in Haskell&#39;s. if there&#39;s anything that wold fit in an SO answer, that is. :) Coming initially from a dynamic world (i.e. Lisp) to Haskell, the lists homogeneity requirement was not at all clear to me, for a long time. so maybe this needs some expounding on, for like minded beginners&#39;s sake. :)"}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551242988, "post_id": 54886851, "comment_id": 96564698, "body": "@WIll Ness, you could try asking on cs.stackexchange -- that&#39;s for more &#39;theoretical&#39;/less code-oriented questions. My short answer is: Haskell is a compiled language, not interpreted like LISP; therefore it&#39;s statically-typed. With all the types known at compile time, that makes for strong abilities to optimise to a performance comparable with low-level languages like C. Contrast that early 1990&#39;s when Haskell started, the main thing Functional Programming was famous for was: nice theory but terrible performance/might use that in the classroom but not in real life."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1551188522, "creation_date": 1551188522, "answer_id": 54886851, "question_id": 54883365, "link": "https://stackoverflow.com/questions/54883365/the-meaning-of-the-universal-quantification/54886851#54886851", "title": "The meaning of the universal quantification", "body": "<p>I need a collection of numbers, and I need to be able to easily insert into the middle of the list, so I decide on making a linked list. Being a savvy Hask-- programmer (Hask-- being the variant of Haskell that does not have universal quantification!), I quickly whip up a type and a length function without trouble:</p>\n\n<pre><code>data IntLinkedList = IntNil | IntCons Int IntLinkedList\n\nlength_IntLinkedList :: IntLinkedList -&gt; Int\nlength_IntLinkedList IntNil = 0\nlength_IntLinkedList (IntCons _ tail) = 1 + length_IntLinkedList tail\n</code></pre>\n\n<p>Later I realize it would be handy to have a variant type that can store numbers not quite as big as 1 and not quite as small as 0. No problem...</p>\n\n<pre><code>data FloatLinkedList = FloatNil | FloatCons Float FloatLinkedList\n\nlength_FloatLinkedList :: FloatLinkedList -&gt; Int\nlength_FloatLinkedList FloatNil = 0\nlength_FloatLinkedList (FloatCons _ tail) = 1 + length_FloatLinkedList tail\n</code></pre>\n\n<p><em>Boy</em> that code looks awfully familiar! And if, later, I discover it would be nice to have a variant that can store <code>String</code>s I am once again left copying and pasting the exact same code, and tweaking the exact same places that are specific to the contained type. Wouldn't it be nice if there were a way to just cook up a linked list once and for all that could contain elements of any single type, and a length function that worked uniformly no matter what elements it had? After all, our length functions above didn't even care what values the elements had. In Haskell, this is exactly what universal quantification gives you: a way to write a single function which works with an entire collection of types.</p>\n\n<p>Here's how it looks:</p>\n\n<pre><code>data LinkedList a = Nil | Cons a (LinkedList a)\n\nlength_LinkedList :: forall a. LinkedList a -&gt; Int\nlength_LinkedList Nil = 0\nlength_LinkedList (Cons _ tail) = 1 + length_LinkedList tail\n</code></pre>\n\n<p>The <code>forall</code> says that this function for all variants of linked lists -- linked lists of <code>Int</code>s, linked lists of <code>Float</code>s, linked lists of <code>String</code>s, linked lists of functions that take FibbledyGibbets and return linked lists of tuples of Grazbars and WonkyNobbers, ...</p>\n\n<p>How nice! Now instead of separate <code>IntLinkedList</code> and <code>FloatLinkedList</code> types, we can just use <code>LinkedList Int</code> and <code>LinkedList Float</code> for that, and <code>length_LinkedList</code>, implemented once, works for both.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1551188522, "creation_date": 1551176893, "last_edit_date": 1551182836, "question_id": 54883365, "link": "https://stackoverflow.com/questions/54883365/the-meaning-of-the-universal-quantification", "title": "The meaning of the universal quantification", "body": "<p>I am trying to understand the meaning of the universal quantification from the following page <a href=\"http://dev.stephendiehl.com/hask/#universal-quantification\" rel=\"nofollow noreferrer\">http://dev.stephendiehl.com/hask/#universal-quantification</a>. </p>\n\n<p>I am not sure, if I understand this sentence correctly</p>\n\n<blockquote>\n  <p>The essence of universal quantification is that we can express\n  functions which operate the same way for a set of types and whose\n  function behavior is entirely determined only by the behavior of all\n  types in this span.  </p>\n</blockquote>\n\n<p>Let`s take the function from the example:</p>\n\n<pre><code>-- \u2200a. [a]\nexample1 :: forall a. [a]\nexample1 = [] \n</code></pre>\n\n<p>What I can do with the function <code>example1</code> is, to use every functions, that is defined for List type.  </p>\n\n<p>But I did not get the exactly purpose of the universal quantification in Haskell. </p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551169151, "post_id": 54880954, "comment_id": 96531286, "body": "You need parentheses to use an infix operator in prefix form: <code>($ 3) (4+)</code> should work and give you <code>7</code>. So would <code>($) (4+) 3</code> (note that the function comes first). In this case it&#39;s just a rather clumsy way of writing <code>4 + 3</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1551169267, "post_id": 54880954, "comment_id": 96531332, "body": "As for the LYAH example, <code>($ 3)</code>  is a &quot;section&quot; of the <code>$</code> operator - it&#39;s a function which, given a function, applies it to the number <code>3</code>. That is then <code>map</code>ped over a list of functions."}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1551169334, "post_id": 54880954, "comment_id": 96531369, "body": "if you want to use <code>$</code> as <a href=\"https://wiki.haskell.org/Infix_operator\" rel=\"nofollow noreferrer\">prefix</a> operator, you have to use <code>($)</code>, also see <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">section</a>"}], "answers": [{"comments": [{"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 1, "creation_date": 1551194868, "post_id": 54881187, "comment_id": 96546912, "body": "Haskell users are really supportive of <a href=\"https://stackoverflow.com/q/54849064/633183\">basic questions</a>! I find this refreshing, tbh."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 12, "last_activity_date": 1551169634, "creation_date": 1551169634, "answer_id": 54881187, "question_id": 54880954, "link": "https://stackoverflow.com/questions/54880954/treating-as-function-application/54881187#54881187", "title": "Treating &quot;$&quot; as function application", "body": "<p><code>$</code> is indeed an operator, defined as:</p>\n\n<pre><code>f $ x = f x\n-- or equivalently:\n($) f x = f x\n</code></pre>\n\n<p>Your expression above is equivalent (by the definition of <code>map</code>) to:</p>\n\n<pre><code>[($ 3) (4 +), ($ 3) (10 *), ($ 3) sqrt]\n</code></pre>\n\n<p>The parentheses in <code>($ 3)</code> and <code>(4 +)</code> are not optional. They're part of what's called an <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"noreferrer\">operator section</a>. Basically, there are four ways you can use an infix operator (such as <code>+</code>):</p>\n\n<ol>\n<li><p>Between two arguments:</p>\n\n<pre><code>x + y\n</code></pre></li>\n<li><p>Only giving the first argument:</p>\n\n<pre><code>(x +)\n-- like \\y -&gt; x + y\n</code></pre></li>\n<li><p>Only giving the second argument:</p>\n\n<pre><code>(+ y)\n-- like \\x -&gt; x + y\n</code></pre></li>\n<li><p>No arguments:</p>\n\n<pre><code>(+)\n-- like \\x y -&gt; x + y\n</code></pre></li>\n</ol>\n\n<p><code>($ 3) f</code> evaluates to <code>f $ 3</code> evaluates to <code>f 3</code>.</p>\n\n<p><code>($ 3) (4 +)</code> evaluates to <code>(4 +) $ 3</code> evaluates to <code>(4 +) 3</code> evaluates to <code>4 + 3</code> evaluates to <code>7</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10661584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 54881187, "answer_count": 1, "score": 0, "last_activity_date": 1551169634, "creation_date": 1551168669, "question_id": 54880954, "link": "https://stackoverflow.com/questions/54880954/treating-as-function-application", "title": "Treating &quot;$&quot; as function application", "body": "<p>I encountered this example while reading <a href=\"http://learnyouahaskell.com/higher-order-functions\" rel=\"nofollow noreferrer\">Learn You a Haskell for Great Good</a>.</p>\n\n<pre><code>ghci&gt; map ($ 3) [(4+), (10*), (^2), sqrt]  \n[7.0,30.0,9.0,1.7320508075688772]  \n</code></pre>\n\n<p>I don't quite see how to treat <code>$</code> as function application. Does that mean <code>$</code> is an operator? But if so, how it will be nested with <code>+</code> or <code>*</code> in the example? I tried <code>$ 3 4+</code>, <code>$ 4 + 3</code>, but both raised <code>parse error on input \u2018$\u2019</code>. How to think of an expression like this in functional programming context?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1551219442, "post_id": 54884780, "comment_id": 96559087, "body": "Welcome to StackOverflow! That&#39;s an excellent answer, and an exceptional first contribution."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1551220041, "post_id": 54884780, "comment_id": 96559294, "body": "By the way: <code>Data.Sequence</code> intentionally avoids a <code>Generic</code> instance for two closely related reasons: 1. Sequences are supposed to be abstract so that users can easily switch between different sequence implementations to optimize their code. <code>Generic</code> reveals internal structure. 2. The functions and instances offered by <code>Data.Sequence</code> all respect <code>==</code> as long as they&#39;re only used with lawful instances of base classes. <code>Generic</code> does not, since trees are compared modulo balance."}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1551307798, "post_id": 54884780, "comment_id": 96597722, "body": "Currently testing the code. Couple of notes so far: Control.Monad is redundant. Need to use ticked versions of True and False."}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551331159, "post_id": 54884780, "comment_id": 96603191, "body": "@dfeuer: It&#39;s clearly a feasible solution, but for more complex problems (Z80instruction has ~40 constructors, the Z80 type list has 10 elements), there&#39;s something that does not scale with GHC 8.6.3. Good test of I/O bandwidth and Mac OS&#39;s swapping algorithm. It works for this cut-down test case, but not for the actual code."}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551332928, "post_id": 54884780, "comment_id": 96603731, "body": "@dfeuer: I&#39;ve never seen ghc use 40GB before."}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1551368675, "post_id": 54884780, "comment_id": 96623271, "body": "The actual code is on Github, <a href=\"https://github.com/bscottm/emuwork\" rel=\"nofollow noreferrer\">github.com/bscottm/emuwork</a>. The disassembler&#39;s output is in src-emubase/Z80/DisasmOutput.hs."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "reply_to_user": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1551979536, "post_id": 54884780, "comment_id": 96849171, "body": "@scootermefecit this ticket might be relevant <a href=\"https://ghc.haskell.org/trac/ghc/ticket/5642\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/5642</a>"}], "tags": [], "owner": {"reputation": 76, "user_id": 11116185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pU9UL.jpg?s=128&g=1", "display_name": "Maryann", "link": "https://stackoverflow.com/users/11116185/maryann"}, "is_accepted": true, "score": 6, "last_activity_date": 1551981545, "last_edit_date": 1551981545, "creation_date": 1551181400, "answer_id": 54884780, "question_id": 54877095, "link": "https://stackoverflow.com/questions/54877095/generics-sop-equivalent-of-everywhere-mkt-replacing-products/54884780#54884780", "title": "Generics.SOP equivalent of everywhere/mkT (replacing products)", "body": "<p><code>generics-sop</code> provides no equivalents for recursive traversal schemes, such as these functions. If you need to deal with recursion in this library, the possible solution is to implement them. Although, defining such functions in SOP is related to some difficulties because it has a core generic view on data that doesn't distinguish recursive nodes from leaves. Recursion in this setting can be managed using closed type families (CTF) and some type class machinery. Closed type families allow you:</p>\n\n<ol>\n<li>to implement the type-safe cast, which is needed for defining <code>mkT</code>,</li>\n<li>to resolve the cases of recursive and non-recursive nodes\u2014different\ninstances of a type class\u2014which otherwise overlap. (Another option\nis using pragmas for overlapping instances, a recent GHC feature;\nthere is, however, some bias about overlapping instances in the\nHaskell community, so this solution is often considered as\nundesired.)</li>\n</ol>\n\n<p>Using CTF for treating recursion has been described in an unpublished paper \u201cHandling Recursion in Generic Programming Using Closed Type Families\u201d, which uses the <code>generics-sop</code> library as a case study; it provides examples of defining recursive schemes in SOP.</p>\n\n<p>SYB's <code>everywhere</code> supports families of mutually recursive datatypes. The following implementation allows to specify them as type-level lists.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, TypeFamilies, DataKinds,\n             TypeApplications, ScopedTypeVariables, MultiParamTypeClasses,\n             ConstraintKinds, FlexibleContexts, AllowAmbiguousTypes,\n             FlexibleInstances, UndecidableInstances,\n             UndecidableSuperClasses, TypeOperators, RankNTypes #-}\n\nimport Generics.SOP\nimport Generics.SOP.NS\n\nimport GHC.Exts (Constraint)\nimport Data.Type.Equality\n\ntype family Equal a x :: Bool where\n  Equal a a = 'True\n  Equal _ _ = 'False\n\nclass DecideEq (eq :: Bool) (a :: *) (b :: *) where\n  decideEq :: Maybe (b :~: a)\ninstance a ~ b =&gt; DecideEq True a b where\n  decideEq = Just Refl\ninstance DecideEq False a b where\n  decideEq = Nothing\n\ntype ProofCast a b = DecideEq (Equal a b) a b\n\ncastEq :: forall a b. ProofCast a b =&gt; b -&gt; Maybe a\ncastEq t = (\\d -&gt; castWith d t) &lt;$&gt; decideEq @(Equal a b)\n\ntype Transform a b = (Generic a, Generic b, ProofCast a b, ProofCast b a)\n\nmkT :: Transform a b =&gt; (a -&gt; a) -&gt; b -&gt; b\nmkT f x = maybe x id $ castEq =&lt;&lt; f &lt;$&gt; castEq x\n\ntype family In (a :: *) (fam :: [*]) :: Bool where\n    In a   ([a] ': fam) = 'True\n    In [a] (a   ': fam) = 'True\n    In a   (a   ': fam) = 'True\n    In a   (_   ': fam) = In a fam\n    In _   '[]          = 'False\n\nclass CaseEverywhere' (inFam :: Bool) (c :: * -&gt; Constraint)\n                      (fam :: [*]) (x :: *) (y :: *) where\n  caseEverywhere' :: (forall b . c b =&gt; b -&gt; b) -&gt; I x -&gt; I y\n\ninstance c x =&gt; CaseEverywhere' 'False c fam x x where\n  caseEverywhere' f = I . f . unI\ninstance (c x, Everywhere x c fam) =&gt; CaseEverywhere' 'True c fam x x where\n  caseEverywhere' f = I . f . everywhere @fam @c f . unI\n\nclass    CaseEverywhere' (In x fam) c fam x y =&gt; CaseEverywhere c fam x y\ninstance CaseEverywhere' (In x fam) c fam x y =&gt; CaseEverywhere c fam x y\n\ncaseEverywhere :: forall c fam x y . CaseEverywhere c fam x y\n               =&gt; (forall b . c b =&gt; b -&gt; b) -&gt; I x -&gt; I y\ncaseEverywhere = caseEverywhere' @(In x fam) @c @fam\n\ntype Everywhere a c fam =\n  (Generic a, AllZip2 (CaseEverywhere c fam) (Code a) (Code a))\n\neverywhere :: forall fam c a . Everywhere a c fam\n           =&gt; (forall b . c b =&gt; b -&gt; b) -&gt; a -&gt; a\neverywhere f = to . everywhere_SOP . from\n  where\n    everywhere_SOP = trans_SOP (Proxy @(CaseEverywhere c fam)) $\n                               caseEverywhere @c @fam f\n</code></pre>\n\n<p><em>Usage</em>&ensp;\nFirst, this can be examined with a small-scale example taken from the SYB paper. The implemented SOP-based <code>everywhere</code>, as compared to SYB's one, additionally takes two type arguments, passed through the explicit type application. The first one specifies a family of mutually recursive datatypes as a type list. The traversal will treat as recursive only those nodes whose types are specified in that list. The second argument is needed to provide a compiler with a \u2018proof\u2019 object for type-cast. The <code>T</code> synonym for the <code>Transform</code> constraint serves to allow its partial application.</p>\n\n<pre><code>data Company = C [Dept]\ndata Dept = D Name Manager [SubUnit]\ndata SubUnit = PU Employee | DU Dept\ndata Employee = E Person Salary\ndata Person = P Name Address\ndata Salary = S Float\ntype Manager = Employee\ntype Name = String\ntype Address = String\n\nclass    Transform a b =&gt; T a b\ninstance Transform a b =&gt; T a b\n\ntype CompanyF = '[Company, Dept, SubUnit, Employee]\n\nincrease :: Float -&gt; Company -&gt; Company\nincrease k = everywhere @CompanyF @(T Salary) (mkT (incS k))\n\nincS :: Float -&gt; Salary -&gt; Salary\nincS k (Sal s) = Sal (s * (1 + k))\n</code></pre>\n\n<p>The defined <code>everywhere</code> / <code>mkT</code> functions are ready for using in your code, but it misses some <code>Generic</code> instances. To apply <code>everywhere</code> to <code>insnSeq</code>, you need a <code>Generic (Seq Z80instruction)</code> instance. Yet you can't obtain it, because the <code>Data.Sequence</code> module doesn't export the internal representation of it. A possible fix is applying <code>fmap</code> to the sequence. So now you can write:</p>\n\n<pre><code>{-# LANGUAGE TypeApplications #-}\n\n...\n\ntype Z80 = '[SymAbsAddr, Z80reg8, Z80instruction, OperLD]\n\nmain :: IO()\nmain = mapM_ T.putStrLn (foldl printIns Seq.empty $\n  fmap (everywhere @Z80 @(T SymAbsAddr) (mkT fixupSymbol)) insnSeq)\n</code></pre>\n\n<p>You should provide the <code>Generic</code> instances for all types of nodes that this traverses, recursive and non-recursive. So next, this demands the <code>Generic</code> instances for <code>Word8</code>, <code>Word16</code>, and <code>Text</code>. While the <code>Generic Text</code> instance can be generated via <code>deriveGeneric</code>, the others can't, because of their special GHC representation. So you'll have to do it manually; this definition is straightforward:</p>\n\n<pre><code>$(deriveGeneric ''Text)\n\ninstance Generic Word8 where\n  type Code Word8 = '[ '[Word8]]\n  from x                        = SOP (Z (I x :* Nil))\n  to   (SOP ((Z (I x :* Nil)))) = x\n\ninstance Generic Word16 where\n  type Code Word16 = '[ '[Word16]]\n  from x                        = SOP (Z (I x :* Nil))\n  to   (SOP ((Z (I x :* Nil)))) = x\n</code></pre>\n\n<p>This code is boilerplate, but the newest GHC extension <code>DerivingVia</code> could nicely simplify this, reducing the second definition. Hopefully, this useful feature will be improved with possibilities for standalone deriving, so it will be possible to say instead:</p>\n\n<pre><code>deriving via Word8 instance Generic Word16\n</code></pre>\n\n<p>The whole code now works well, and <code>main</code> yields the expected result.</p>\n"}], "owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 2, "accepted_answer_id": 54884780, "answer_count": 1, "score": 5, "last_activity_date": 1551981545, "creation_date": 1551143780, "question_id": 54877095, "link": "https://stackoverflow.com/questions/54877095/generics-sop-equivalent-of-everywhere-mkt-replacing-products", "title": "Generics.SOP equivalent of everywhere/mkT (replacing products)", "body": "<p>Are there examples of <code>generics-sop</code> that mimic SYB's <code>everywhere</code>/<code>mkT</code> behavior?</p>\n\n<p>What I'm attempting to do, but not seeing how to do it successfully, is replace the <code>everywhere (mkT fixupSymbol)</code> in <code>main</code> with an equivalent <code>Generics.SOP</code> construction, i.e., use <code>Generics.SOP</code> to recurse into the product <code>(I (AbsAddr value))</code> and replace it with <code>(I (SymAddr label))</code>.</p>\n\n<p>I could pass the symbol table to <code>gformatOperands</code>, polluting the <code>formatOperands</code> signature. That seems suboptimal.</p>\n\n<p>Without <code>fixupSymbol</code>, the output would look like:</p>\n\n<pre><code>LD   B, 0x0000\nLD   C, 0x1234\nCALL 0x4567\n</code></pre>\n\n<p>Resolving addresses to symbolic labels:</p>\n\n<pre><code>gensop % stack ghci\nUsing main module: 1. Package `gensop' component exe:gensop with main-is file: &lt;...&gt;/Main.hs\ngensop-0.1: configure (exe)\nConfiguring gensop-0.1...\ngensop-0.1: initial-build-steps (exe)\nConfiguring GHCi with the following packages: gensop\nGHCi, version 8.6.3: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( &lt;...&gt;/Main.hs, interpreted )\n*Main&gt; main\nLD   B, 0x0000\nLD   C, label1\nCALL label2\n*Main&gt;\n</code></pre>\n\n<p>Cut down version of code:</p>\n\n<pre><code>{-# LANGUAGE DataKinds            #-}\n{-# LANGUAGE TypeFamilies         #-}\n{-# LANGUAGE TemplateHaskell      #-}\n{-# LANGUAGE DeriveDataTypeable #-}\n\nmodule Main where\n\nimport Data.Data\nimport Data.Foldable (foldl)\nimport Data.Word (Word8, Word16)\nimport Data.Text (Text)\nimport qualified Data.Text as T\nimport qualified Data.Text.IO as T\nimport Text.Printf\nimport Generics.SOP\nimport Generics.SOP.TH (deriveGeneric)\nimport Data.Generics.Aliases (mkT)\nimport Data.Generics.Schemes (everywhere)\nimport Data.HashMap.Strict (HashMap)\nimport qualified Data.HashMap.Strict as H\nimport Data.Sequence (Seq, (|&gt;))\nimport qualified Data.Sequence as Seq\n\n\ntype Z80addr = Word16\ntype Z80word = Word8\n\nclass Z80operand x where\n  formatOperand :: x -&gt; Text\n\nmain :: IO()\nmain = mapM_ T.putStrLn (foldl printIns Seq.empty $ everywhere (mkT fixupSymbol) insnSeq)\n-- -------------------------------------------------^ Does this have a Generics.SOP equivalent?\n  where\n    printIns accum ins = accum |&gt; T.concat ([mnemonic, gFormatOperands] &lt;*&gt; [ins])\n\n    mnemonic (LD _)   = \"LD   \"\n    mnemonic (CALL _) = \"CALL \"\n\n    -- Generics.SOP: Fairly straightforward\n    gFormatOperands {-elt-} =\n      T.intercalate \", \" . hcollapse . hcmap disOperandProxy (mapIK formatOperand) . from {-elt-}\n      where\n        disOperandProxy = Proxy :: Proxy Z80operand\n\n    -- Translate an absolute address, generally hidden inside an instruction operand, into a symbolic address\n    -- if present in the symbol table.\n    fixupSymbol addr@(AbsAddr absAddr) = maybe addr SymAddr (absAddr `H.lookup` symtab)\n    fixupSymbol other                  = other\n\n    insnSeq :: Seq Z80instruction\n    insnSeq = Seq.singleton (LD (Reg8Imm B 0x0))\n              |&gt; (LD (Reg8Indirect C (AbsAddr 0x1234)))\n              |&gt; (CALL (AbsAddr 0x4567))\n\n    symtab :: HashMap Z80addr Text\n    symtab = H.fromList [ (0x1234, \"label1\"), (0x4567, \"label2\")]\n\n-- | Symbolic and absolute addresses. Absolute addresses can be translated into symbolic\n-- labels.\ndata SymAbsAddr  = AbsAddr Z80addr | SymAddr Text\n  deriving (Eq, Ord, Typeable, Data)\n\ndata Z80reg8 = A | B | C\n  deriving (Eq, Ord, Typeable, Data)\n\n-- | Cut down version of the Z80 instruction set\ndata Z80instruction = LD OperLD | CALL SymAbsAddr\n  deriving (Eq, Ord, Typeable, Data)\n\n-- | Load operands\ndata OperLD = Reg8Imm Z80reg8 Z80word | Reg8Indirect Z80reg8 SymAbsAddr\n  deriving (Eq, Ord, Typeable, Data)\n\n$(deriveGeneric ''SymAbsAddr)\n$(deriveGeneric ''Z80reg8)\n$(deriveGeneric ''Z80instruction)\n$(deriveGeneric ''OperLD)\n\ninstance Z80operand Z80word where\n  formatOperand word = T.pack $ printf \"0x%04x\" word\n\ninstance Z80operand SymAbsAddr where\n  formatOperand (AbsAddr addr)  = T.pack $ printf \"0x04x\" addr\n  formatOperand (SymAddr label) = label\n\ninstance Z80operand Z80reg8 where\n  formatOperand A = \"A\"\n  formatOperand B = \"B\"\n  formatOperand C = \"C\"\n\ninstance Z80operand OperLD where\n  formatOperand (Reg8Imm reg imm) = T.concat [formatOperand reg, \", \", formatOperand imm]\n  formatOperand (Reg8Indirect reg addr) = T.concat [formatOperand reg, \", \", formatOperand addr]\n</code></pre>\n\n<p>The <code>gensop.cabal</code> file:</p>\n\n<pre><code>cabal-version:  &gt;= 1.12\nname:           gensop\nversion:        0.1\nbuild-type:     Simple\nauthor:         scooter-me-fecit\ndescription:    No description.\nlicense:        GPL-3\n\nexecutable gensop\n  default-language:     Haskell2010\n  main-is: Main.hs\n  build-depends:\n    base,\n    containers,\n    bytestring,\n    generics-sop,\n    syb,\n    text,\n    unordered-containers\n\n  default-extensions:\n    OverloadedStrings,\n    FlexibleInstances\n\n  ghc-options: -Wall\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 1825, "user_id": 5156709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08c6c567409fda82303b32a475c255cf?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Acosta", "link": "https://stackoverflow.com/users/5156709/nick-acosta"}, "edited": false, "score": 0, "creation_date": 1551129610, "post_id": 54874137, "comment_id": 96519752, "body": "Do you have a yeplay.cabal file?  It looks like package.yaml is an hpack thing which I admittedly haven&#39;t tried yet.  If you add <code>, yesod</code> to your build-depends section in yeplay.cabal it should build."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1551149319, "post_id": 54874137, "comment_id": 96525193, "body": "How did you create the project ? You can use create using prebaked templates like this: <code>stack new yeplay yesodweb&#47;simple</code>. List of yesod based templates are here: <a href=\"https://github.com/commercialhaskell/stack-templates/wiki#yesod\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack-templates/wiki#yesod</a>"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 1, "creation_date": 1551200044, "post_id": 54874137, "comment_id": 96549950, "body": "It may help to include the entire error message.  Additional verbose output also might help..."}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551126424, "creation_date": 1551126424, "question_id": 54874137, "link": "https://stackoverflow.com/questions/54874137/cannot-satisfy-package-yesod-1-6-0", "title": "cannot satisfy -package yesod-1.6.0", "body": "<p>I am trying to create a hello world yesod web application and encounter the error message </p>\n\n<pre><code>cannot satisfy -package yesod-1.6.0 \n</code></pre>\n\n<p>What I've done is, create a project with <code>stack new yeplay</code> and then in the package.yaml file I put, <code>yesod</code> in the dependencies section, that looks as following: </p>\n\n<pre><code>executables:\n  yeplay-exe:\n    main:                Main.hs\n    source-dirs:         app\n    ghc-options:\n    - -threaded\n    - -rtsopts\n    - -with-rtsopts=-N\n    dependencies:\n    - yeplay\n    - yesod \n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell", "f#"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1551117494, "post_id": 54871937, "comment_id": 96514391, "body": "I miss that feature from F# too. To some extent this is sort of works in Haskell as well by the virtue of banned module import cycles. Also, you could break the code into multiple libraries."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 7, "creation_date": 1551121124, "post_id": 54871937, "comment_id": 96515983, "body": "Wouldn&#39;t this feature prevent mutually recursive definitions from being possible? Or are you just referring to what order different files are processed in, and not the contents of the files?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1551121257, "post_id": 54871937, "comment_id": 96516034, "body": "You can&#39;t call a function you haven&#39;t defined yet in <i>any</i> language; it sounds more like F# doesn&#39;t allow you to <i>define</i> a function that uses as-yet-undefined functions."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1551121313, "post_id": 54871937, "comment_id": 96516060, "body": "I can&#39;t think of any way to enforce that using standard tools. Also note that in the presence of mutual recursion (not so uncommon in Haskell), we need to break the order. Maybe one could write a GHC plugin for enforcing non-recursive definitions to be ordered."}, {"owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "edited": false, "score": 2, "creation_date": 1551122734, "post_id": 54871937, "comment_id": 96516624, "body": "Mutually recursive functions are handled in f# via syntax features. They need to be declared together. Anyways looks like this question has been answered, thanks all."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1551137230, "post_id": 54871937, "comment_id": 96522533, "body": "If your modules are small enough then it works this way, since you can&#39;t have mutually recursive modules (at least not without a lot of <code>.hs-boot</code> headache). It&#39;s good design, too -- lower-level things should be encapsulated into neat little abstractions."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 4, "creation_date": 1551175478, "post_id": 54871937, "comment_id": 96534969, "body": "&quot; the order of your code matters. You can&#39;t call a function that you haven&#39;t defined yet.&quot; Horrible, horrible, horrible. Sounds like ALGOL vintage 1960 with its <code>forward</code> declarations. (I think early Pascal also did something like that.) I always design my program structure top-down. Been doing that for 40 years since programming school. You can always put a stub for a function you&#39;re mentioning but haven&#39;t yet nutted out: <code>f = undefined</code> (but you do need a signature). OTOH, thanks to the C-H correspondence, once you have the signature, the code pretty much writes itself."}, {"owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 1, "creation_date": 1551184364, "post_id": 54871937, "comment_id": 96540159, "body": "@AntC just want to point out your response to this idea is similar to the revulsion that an OOP programmer would express towards the idea of immutability. Seems like an unnecessary limitation to the uninitiated, but actually is a useful idea."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 2, "creation_date": 1551188935, "post_id": 54871937, "comment_id": 96542940, "body": "&quot;actually is a useful idea&quot;. You can&#39;t know that until you&#39;re equally experienced in both styles. (My &quot;horrible&quot; is from trying to read code.) All you can say is &#39;actually is the only way I can write the code&#39;. Top-down style dates back to the 1968 &#39;Structured Programming&#39; collection of papers Dahl, Dijkstra, Hoare, and the experimental language CPL, which was the inspiration for C (via a few others). I guess Kernighan &amp; Ritchie were convinced enough they didn&#39;t force definition before use."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551214846, "post_id": 54871937, "comment_id": 96557160, "body": "@chepner while I can&#39;t think of any right now, I&#39;d bet that there <i>are</i> languages in which you can call a function you haven&#39;t defined yet (giving some bogus result). In fact this sounds like the kind of thing JavaScript would do... \u2014 Thinking about it, this <i>could</i> actually make sense in a language like Agda, when you&#39;ve just narrowed down the type so much that the compiler can figure out the correct implementation by itself!"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551599684, "post_id": 54871937, "comment_id": 96693641, "body": "@AntC I&#39;ve experienced both styles, and I can attest with all certainty that this feature turns out to be very handy in F#"}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 9, "last_activity_date": 1551120338, "creation_date": 1551120338, "answer_id": 54872798, "question_id": 54871937, "link": "https://stackoverflow.com/questions/54871937/is-there-any-way-to-force-haskell-code-ordering-to-work-like-f/54872798#54872798", "title": "Is there any way to force Haskell code ordering to work like F#?", "body": "<p>As far as I know, the only circumstance in which Haskell enforces the order of declarations within a module is when there are Template Haskell splices.  In this case, declarations above a given splice may not reference declarations below.  I think this is an unfortunate limitation of template haskell, not a feature per se.</p>\n\n<p>So I think technically you can have GHC enforce the ordering by turning on Template Haskell and adding empty splices to your code. <code>$(return [])</code>.  This is a qualified \"no\" - it can be done, but I've never seen anyone do it, and it's probably annoying to read &amp; write.</p>\n"}], "owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 1, "accepted_answer_id": 54872798, "answer_count": 1, "score": 5, "last_activity_date": 1551206359, "creation_date": 1551116871, "last_edit_date": 1551206359, "question_id": 54871937, "link": "https://stackoverflow.com/questions/54871937/is-there-any-way-to-force-haskell-code-ordering-to-work-like-f", "title": "Is there any way to force Haskell code ordering to work like F#?", "body": "<p>I am currently <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learning me a Haskell</a>, so for so good.</p>\n\n<p>I am pretty fluent when it comes to F# and I want to try my hand at pure functional programming.</p>\n\n<p>One of the features I have always liked about F# is that the order of your code matters. You can't call a function that you haven't defined yet. This is useful because it guarantees that earlier code files contain low level functions, and later code contains the bigger picture stuff. It forces a structure that I now consider to be a good thing.</p>\n\n<p>Haskell doesn't seem to care much about code order in the same way. Whilst I can choose to structure my code as such, I am not forced to. So at this early stage of learning Haskell, I would like to know if there is some compiler option that forces this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551100987, "post_id": 54867169, "comment_id": 96504642, "body": "While this <i>could</i> be done with typeclass hackery like printf uses, it seems like a terrible idea to have such a function. Why do you need it?"}, {"owner": {"reputation": 49, "user_id": 1836966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2fbfab6fa4bd3b6f5444dd4dd00071c8?s=128&d=identicon&r=PG", "display_name": "user1836966", "link": "https://stackoverflow.com/users/1836966/user1836966"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551101086, "post_id": 54867169, "comment_id": 96504698, "body": "It is part of a &quot;Tutorial&quot; trying to test our understanding. Its not meant to be practical!"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1551101215, "post_id": 54867169, "comment_id": 96504779, "body": "There&#39;s an interesting challenge on Codewars about this, which I did recently, which comes with a few hints (I would never have been able to complete it without them, and even with them it was hard work): <a href=\"https://www.codewars.com/kata/599aed42b9712e1afe000014\" rel=\"nofollow noreferrer\">codewars.com/kata/599aed42b9712e1afe000014</a> As others have said, I&#39;m not sure what the practical use is, since it&#39;s easy to sum a list."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 1836966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2fbfab6fa4bd3b6f5444dd4dd00071c8?s=128&d=identicon&r=PG", "display_name": "user1836966", "link": "https://stackoverflow.com/users/1836966/user1836966"}, "edited": false, "score": 0, "creation_date": 1551108276, "post_id": 54868586, "comment_id": 96509371, "body": "Thank you, nice solution. Is it possible to do that in a simpler, less advanced way too? Maybe considering that the signature is fixed? Its the second week of my Functional Programming course so Im asking myself if could really be that advanced (but nothing can shock me anymore)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 49, "user_id": 1836966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2fbfab6fa4bd3b6f5444dd4dd00071c8?s=128&d=identicon&r=PG", "display_name": "user1836966", "link": "https://stackoverflow.com/users/1836966/user1836966"}, "edited": false, "score": 1, "creation_date": 1551109837, "post_id": 54868586, "comment_id": 96510352, "body": "@user1836966 It doesn&#39;t get much simpler than a single typeclass with two instances. You could either sit and type for a long time or cook up an editor macro to finish off the <code>...</code>s in <code>f a1 a2 a3 ... a1024 = a1 + a2 + ... + a1024</code>, I guess."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 49, "user_id": 1836966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2fbfab6fa4bd3b6f5444dd4dd00071c8?s=128&d=identicon&r=PG", "display_name": "user1836966", "link": "https://stackoverflow.com/users/1836966/user1836966"}, "edited": false, "score": 0, "creation_date": 1551153037, "post_id": 54868586, "comment_id": 96525949, "body": "@user1836966 Are you sure you don&#39;t want to just add up a list that contains an arbitrary number of <code>Int</code>s (including a list of 1024 <code>Int</code>s)? That is <i>significantly</i> easier/less painful to do than making a function of 1024 arguments."}, {"owner": {"reputation": 49, "user_id": 1836966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2fbfab6fa4bd3b6f5444dd4dd00071c8?s=128&d=identicon&r=PG", "display_name": "user1836966", "link": "https://stackoverflow.com/users/1836966/user1836966"}, "edited": false, "score": 0, "creation_date": 1551354007, "post_id": 54868586, "comment_id": 96614371, "body": "Im getting an Error when Executing your code in ghci: &#39;error:     * Illegal instance declaration for <code>SumArgs a&#39;         (All instance types must be of the form (T a1 ... an)          where a1 ... an are *distinct type variables*,          and each type variable appears at most once in the instance head.          Use FlexibleInstances if you want to disable this.)     * In the instance declaration for </code>SumArgs a&#39;    | 21 | instance SumArgs a  where sumArgs m n = sumArgs (m+n)    |  &#39; Do you know why? I Dont get it, Im a Haskell beginner and not familiar with classes yet... Thanks!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 49, "user_id": 1836966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2fbfab6fa4bd3b6f5444dd4dd00071c8?s=128&d=identicon&r=PG", "display_name": "user1836966", "link": "https://stackoverflow.com/users/1836966/user1836966"}, "edited": false, "score": 0, "creation_date": 1551370302, "post_id": 54868586, "comment_id": 96624303, "body": "@user1836966 To enable <code>FlexibleInstances</code> in ghci, you must use <code>:set -XFlexibleInstances</code> instead of the <code>{-# LANGUAGE FlexibleInstances #-}</code> pragma used in this answer."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1551105582, "creation_date": 1551105582, "answer_id": 54868586, "question_id": 54867169, "link": "https://stackoverflow.com/questions/54867169/how-can-i-sum-the-arguments-of-a-function-function-signature-given-1024-int-ar/54868586#54868586", "title": "How can I sum the arguments of a function [function signature given, 1024 Int arguments...]", "body": "<pre><code>{-# LANGUAGE FlexibleInstances #-}\nclass SumArgs a where sumArgs :: Int -&gt; a\ninstance SumArgs Int where sumArgs = id\ninstance SumArgs a =&gt; SumArgs (Int -&gt; a) where sumArgs m n = sumArgs (m+n)\n\nsumFourExample :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int\nsumFourExample = sumArgs\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; sumFourExample 2 3 4 5\n14\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1551114450, "post_id": 54870695, "comment_id": 96512993, "body": "<code>doubleArgs f = f . f . add2 -- if f has type (Int-&gt; a) -&gt; (Int -&gt;)^n a, the three parts respectively add n, (n-1), 1 args</code> then do <code>sq f = f . f</code> and <code>twoToNineArgs = (sq . sq . sq . sq . sq . sq . sq . sq) doubleArgs</code> to get <code>f = twoToNineArgs add2 id</code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1551116616, "post_id": 54870695, "comment_id": 96513990, "body": "@DanRobertson Perhaps this would be less inscrutable if you expanded it into an answer of more than one sentence. In this very small margin it is hard to understand what you&#39;re suggesting."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551134727, "post_id": 54870695, "comment_id": 96521745, "body": "so, <code>addJ . addK . ... . addN</code> will handle <code>J + (K-1) + ... + (N-1)</code> arguments."}], "tags": [], "owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "is_accepted": false, "score": 8, "last_activity_date": 1551112227, "creation_date": 1551112227, "answer_id": 54870695, "question_id": 54867169, "link": "https://stackoverflow.com/questions/54867169/how-can-i-sum-the-arguments-of-a-function-function-signature-given-1024-int-ar/54870695#54870695", "title": "How can I sum the arguments of a function [function signature given, 1024 Int arguments...]", "body": "<p>The fact that it's 1024 is probably meant to be a clue that you should\nbuild up to it in powers of two.  Here's a solution as far as 16 which\nyou can extend.</p>\n\n<p>It's using a continuation passing style as a way to let you have one\nfunction consume some arguments and then another consume some more.\nTo see what's going on, try calculating out a small example by hand,\nsay <code>add4 id 1 2 3 4</code>.</p>\n\n<pre><code>add2 :: (Int -&gt; a) -&gt; Int -&gt; Int -&gt; a\nadd2 k x y = k (x + y)\n\nadd4 :: (Int -&gt; a) -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; a\nadd4 k = add2 (add2 (add2 k))\n\n-- type signatures omitted from now on...\nadd8 k = add4 (add4 (add2 k))\n\nadd16 k = add8 (add8 (add2 k))\n\nf = add16 id\n</code></pre>\n\n<p>And now you can do:</p>\n\n<pre><code>&gt;f 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16\n136\n</code></pre>\n\n<p>I could also have written the functions more pointfree, for example:</p>\n\n<pre><code>add8 = add4 . add4 . add2\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 1836966, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2fbfab6fa4bd3b6f5444dd4dd00071c8?s=128&d=identicon&r=PG", "display_name": "user1836966", "link": "https://stackoverflow.com/users/1836966/user1836966"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1551115795, "creation_date": 1551100818, "last_edit_date": 1551115795, "question_id": 54867169, "link": "https://stackoverflow.com/questions/54867169/how-can-i-sum-the-arguments-of-a-function-function-signature-given-1024-int-ar", "title": "How can I sum the arguments of a function [function signature given, 1024 Int arguments...]", "body": "<p>I'm Trying to figure out how I can Sum up the Arguments of a Function which has a given signature <code>sum :: Int -&gt; ... -&gt; Int</code> with 1024 Int arguments...</p>\n\n<p>Clever Currying / Recursion is surely the deal I just can't grasp how to even start.</p>\n"}, {"tags": ["function", "haskell", "types", "compiler-errors", "type-signature"], "comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1551134010, "post_id": 54865352, "comment_id": 96521494, "body": "<code>cd str = [ (fromEnum d) - 48 | d &lt;- str, elem d &#39;0&#39;..&#39;9&#39;]]</code> will take any string of single digits in any form, <code>cd &quot;13579&quot;</code> or <code>cd &quot;[2,3,5,7]&quot;</code> or <code>cd &quot; 2 3 5&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 10, "last_activity_date": 1551094880, "creation_date": 1551094880, "answer_id": 54865390, "question_id": 54865352, "link": "https://stackoverflow.com/questions/54865352/whats-wrong-with-func-string-int-func-read-3-5-7/54865390#54865390", "title": "What&#39;s wrong with &quot;func :: String -&gt; [Int]; func = read &quot;[3,5,7]&quot;&quot;", "body": "<p>You are trying to read your string as a function of type <code>String -&gt; [Int]</code>, rather than a list <code>[Int]</code>. However, <code>read</code> can not convert strings into  functions.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>myList :: [Int]\nmyList = read \"[3,5,7]\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 6, "last_activity_date": 1551096432, "creation_date": 1551096432, "answer_id": 54865883, "question_id": 54865352, "link": "https://stackoverflow.com/questions/54865352/whats-wrong-with-func-string-int-func-read-3-5-7/54865883#54865883", "title": "What&#39;s wrong with &quot;func :: String -&gt; [Int]; func = read &quot;[3,5,7]&quot;&quot;", "body": "<p>Your function type is <code>String -&gt; [Int]</code> but you didn't specify its argument so the compiler \"thinks\" that you want to return a function <code>String -&gt; [Int]</code> instead of <code>[Int]</code>.</p>\n\n<p>You probably want:</p>\n\n<pre><code>func :: String -&gt; [Int]\nfunc s = read s\n</code></pre>\n\n<p>and then use it as:</p>\n\n<pre><code>func \"[3,5,7]\"\n</code></pre>\n\n<p>or just: </p>\n\n<pre><code>func :: String -&gt; [Int]\nfunc _ = read \"[3,5,7]\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10661584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 54865883, "answer_count": 2, "score": 6, "last_activity_date": 1551100004, "creation_date": 1551094704, "last_edit_date": 1551100004, "question_id": 54865352, "link": "https://stackoverflow.com/questions/54865352/whats-wrong-with-func-string-int-func-read-3-5-7", "title": "What&#39;s wrong with &quot;func :: String -&gt; [Int]; func = read &quot;[3,5,7]&quot;&quot;", "body": "<p>In a very simple module <code>test</code> where I have the following function</p>\n\n<pre><code>func :: String -&gt; [Int]\nfunc = read \"[3,5,7]\"\n</code></pre>\n\n<p>Since I have explicit type annotations, I expect to get <code>[3,5,7]</code> when I load the module <code>test</code> and call <code>func</code> in ghci. However, I got</p>\n\n<pre><code>    \u2022 No instance for (Read (String -&gt; [Int]))\n        arising from a use of \u2018read\u2019\n        (maybe you haven't applied a function to enough arguments?)\n    \u2022 In the expression: read \"[3,5,7]\"\n      In an equation for \u2018func\u2019: func = read \"[3,5,7]\"\n   |\n11 | func = read \"[3,5,7]\"\n   |        ^^^^^^^^^^^^^^\n</code></pre>\n\n<p>But when I do <code>read \"[3,5,7]\" :: [Int]</code>, <code>[3,5,7]</code> is returned as expected. Why an error was raised when I loaded the module instead?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1551094638, "post_id": 54865167, "comment_id": 96501081, "body": "<code>b1</code> is simply the type variable GHC has chosen to assign to <code>6</code>. It seems that GHC can&#39;t infer that <code>SumTy Integer b1</code> ought to be <code>SumTy Integer Double</code> even if it&#39;s the only instance (EDIT: for reasons <i>chi</i> addresses).  <code>print $ plus (5::Integer) (6::Double)</code> does seem to work, but I can&#39;t quite tell if this is an answer because I don&#39;t know what you&#39;re trying to do."}], "answers": [{"tags": [], "owner": {"reputation": 214, "user_id": 5533076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8S36G.jpg?s=128&g=1", "display_name": "kon.simeonov", "link": "https://stackoverflow.com/users/5533076/kon-simeonov"}, "is_accepted": false, "score": 3, "last_activity_date": 1551094612, "creation_date": 1551094612, "answer_id": 54865324, "question_id": 54865167, "link": "https://stackoverflow.com/questions/54865167/ambiguous-type-variable-b1-arising-from-a-use-of-print/54865324#54865324", "title": "Ambiguous type variable \u2018b1\u2019 arising from a use of \u2018print\u2019", "body": "<pre><code>plus (5 :: Integer) 6\n</code></pre>\n\n<p>The compiler tries to infer the type of <code>6</code>, but fails. You have to specify the type of the number literal explicity, like that:</p>\n\n<pre><code>plus (5 :: Integer) (6 :: Double)\n</code></pre>\n\n<p>In order for the second <code>plus</code> statement to compile, you cannot pass <code>6.0</code>, because this value is either a <code>Float</code> or a <code>Double</code>, and you do not have an instance of <code>Add</code> defined for <code>Double Double</code>. You can specify it's type as an <code>Integer</code>, if that's what you want:</p>\n\n<pre><code>plus (5.0 :: Double) (6 :: Integer)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1551094650, "creation_date": 1551094650, "answer_id": 54865335, "question_id": 54865167, "link": "https://stackoverflow.com/questions/54865167/ambiguous-type-variable-b1-arising-from-a-use-of-print/54865335#54865335", "title": "Ambiguous type variable \u2018b1\u2019 arising from a use of \u2018print\u2019", "body": "<pre><code>plus (5::Integer) 6\n</code></pre>\n\n<p>The type of the first argument is <code>Integer</code>. The type of the second one can be any numeric type, let's call that <code>b1</code>, assuming <code>Num b1</code>. So, we are calling the function</p>\n\n<pre><code>plus :: Integer -&gt; b1 -&gt; SumTy Integer b1\n</code></pre>\n\n<p>but there is no matching instance around. There's only an instance for <code>Add Integer Double</code>, but we can't call that one, since after all the programmer later on might also add another instance for, say, <code>Add Integer Integer</code> and we need to be ready for that one. (Note that the additional instance might even be in another module, so GHC can not simply assume it does not exist without checking <em>all</em> the modules, which would be inefficient.)</p>\n\n<p>You need to specify the type for the <code>6</code> argument, otherwise the call is ambiguous.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "accepted_answer_id": 54865335, "answer_count": 2, "score": 2, "last_activity_date": 1551094650, "creation_date": 1551093967, "question_id": 54865167, "link": "https://stackoverflow.com/questions/54865167/ambiguous-type-variable-b1-arising-from-a-use-of-print", "title": "Ambiguous type variable \u2018b1\u2019 arising from a use of \u2018print\u2019", "body": "<p>I have the following code snippet, that does not compile:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, TypeFamilies, MultiParamTypeClasses #-}\n\nmodule Main where\n\n\nclass Add a b where \n    type SumTy a b\n    plus :: a -&gt; b -&gt; SumTy a b\n\ninstance Add Integer Double where\n    type SumTy Integer Double = Double\n    plus x y = fromIntegral x + y\n\ninstance Add Double Integer where\n    type SumTy Double Integer = Double\n    plus x y = x + fromIntegral y\n\nmain :: IO ()\nmain = do\n\n  print $ plus (5::Integer) 6\n  print $ plus (5.0::Double) 6.0\n</code></pre>\n\n<p>the error message is:  </p>\n\n<pre><code>app/Main.hs:25:3: error:\n    \u2022 Ambiguous type variable \u2018b1\u2019 arising from a use of \u2018print\u2019\n      prevents the constraint \u2018(Show\n                                  (SumTy Integer b1))\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018b1\u2019 should be.\n      These potential instances exist:\n        instance Show BS.ByteString\n          -- Defined in \u2018Data.ByteString.Internal\u2019\n        instance Show Ordering -- Defined in \u2018GHC.Show\u2019\n        instance Show Integer -- Defined in \u2018GHC.Show\u2019\n        ...plus 24 others\n        ...plus 22 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In a stmt of a 'do' block: print $ plus (5 :: Integer) 6\n      In the expression:\n        do print $ plus (5 :: Integer) 6\n           print $ plus (5.0 :: Double) 6.0\n      In an equation for \u2018main\u2019:\n          main\n            = do print $ plus (5 :: Integer) 6\n                 print $ plus (5.0 :: Double) 6.0\n   |\n25 |   print $ plus (5::Integer) 6\n   |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>what does <strong>Ambiguous type variable \u2018b1\u2019 arising from a use of \u2018print\u2019</strong> mean? I can not see anywhere <code>b1</code>.</p>\n"}, {"tags": ["haskell", "euterpea"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1551117055, "creation_date": 1551117055, "answer_id": 54871986, "question_id": 54865136, "link": "https://stackoverflow.com/questions/54865136/start-euterpea-music-in-main-function-together-with-gameworld-in-haskell/54871986#54871986", "title": "Start Euterpea Music in main function together with gameworld? (in Haskell)", "body": "<p>I don't have gloss and euterpea installed, so I can't test, but I'm willing to bet that forking one or the other into its own thread will be sufficient. I'd recommend forking euterpea off; graphics libraries sometimes use thread-local state which complicates the matters in sort of boring ways. So:</p>\n\n<pre><code>import Control.Concurrent\nmain = do\n    backgroundImage &lt;- background\n    forkIO $ Euterpea.play (Euterpea.line [af 4 dqn :=: cf 4 dqn :=: ef 4 dqn])\n    Gloss.play (InWindow \"game\" (windowwidth, windowheight) (0,0)) cyan 300 (drawGame [background]) inputHandler step\n</code></pre>\n\n<p>It's possible that one or the other uses FFI calls in an interesting way, so if the above code snippet isn't enough to get things off the ground, consider compiling with <code>-threaded</code> to ensure that FFI calls don't block each other. (N.B. <code>-threaded</code> is not required for using Haskell threads; a full discussion of its effects is longer than would be reasonable to go into here, but <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2004/09/conc-ffi.pdf\" rel=\"nofollow noreferrer\">there is an excellent paper</a> with more details.)</p>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 5922388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d51926ef05c2bfb8599e4e5cef6315?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/5922388/niko"}, "is_accepted": false, "score": 0, "last_activity_date": 1551119880, "last_edit_date": 1551119880, "creation_date": 1551118345, "answer_id": 54872310, "question_id": 54865136, "link": "https://stackoverflow.com/questions/54865136/start-euterpea-music-in-main-function-together-with-gameworld-in-haskell/54872310#54872310", "title": "Start Euterpea Music in main function together with gameworld? (in Haskell)", "body": "<p>I have neither installed gloss nor euterpea but I guess the <code>IO</code> actions described by both of the <code>play</code> functions run infinitely, so whichever is called first will execute and the other one will wait forever without beeing executed.</p>\n\n<p>In order to fix this, you can start the music in a seperate thread using <code>forkIO</code> from <code>Control.Concurrent</code>:</p>\n\n<pre><code>musicThreadId &lt;- forkIO $ Euterpea.play $ Euterpea.line [af 4 dqn :=: cf 4 dqn :=: ef 4 dqn]\n</code></pre>\n\n<p>and kill the thread after your game is closed:</p>\n\n<pre><code>killThread musicThreadId\n</code></pre>\n\n<p>This works as long as your music is independet of the game. If you want to include sound that is dependent on whats happening in the game (for example a sound effects), you will need to have your game communicate thread-safe with a thread which plays the sounds. Communication between threads is a side effect which has to be handled using <code>IO</code>. In this case you should take a look at <code>playIO</code> from <code>Graphics.Gloss.Interface.IO.Game</code>, as <code>play</code> only supports game logic without side effects.</p>\n\n<p>You can read more about concurrent programming in Haskell on hackage:\n<a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Concurrent.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Concurrent.html</a></p>\n\n<p>or in the book <em>Parallel and Concurrent Programming in Haskell</em> by Simon Marlow which is available online:\n<a href=\"https://www.oreilly.com/library/view/parallel-and-concurrent/9781449335939/\" rel=\"nofollow noreferrer\">https://www.oreilly.com/library/view/parallel-and-concurrent/9781449335939/</a></p>\n"}], "owner": {"reputation": 19, "user_id": 11056883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8a2532c925bf113e39ce30c6b8fe46?s=128&d=identicon&r=PG&f=1", "display_name": "blobfish", "link": "https://stackoverflow.com/users/11056883/blobfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1551119880, "creation_date": 1551093847, "question_id": 54865136, "link": "https://stackoverflow.com/questions/54865136/start-euterpea-music-in-main-function-together-with-gameworld-in-haskell", "title": "Start Euterpea Music in main function together with gameworld? (in Haskell)", "body": "<p>Making a game and looking for a way to start the music (made in haskell with Euterpea) when calling the main function to start the game. </p>\n\n<p>The problem with this code is that it will play the music but then it won't start the game. If I put the music after Pure.Game.play the game starts but no music will be played.</p>\n\n<pre><code>main :: IO ()\nmain = do\nbackgroundImage &lt;- background\n let backgrounds = [backgroundImage]\n**Euterpea.play $ Euterpea.line [af 4 dqn :=: cf 4 dqn :=: ef 4 dqn]**\nGraphics.Gloss.Interface.Pure.Game.play (InWindow \"game\" (windowwidth, \nwindowheight) (0,0)) cyan 300 (drawGame background) inputHandler step\n</code></pre>\n\n<p>Also tried to have the music in its own function\n    melody :: Music Pitch\n    melody = Euterpea.line [af 4 dqn :=: cf 4 dqn]</p>\n\n<p>and bind it (like with the background):\n    music &lt;- melody\nand call it in main, but can't get that to work either.</p>\n\n<p>Any tip how to do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551081596, "post_id": 54861689, "comment_id": 96494065, "body": "To put that type signature you need <code>ScopedTypeVariables</code>. <code>Proxy Int</code> in the instance decl is more specific than expected from the instance head. try <code>applyIf (p :: proxy Int) f b = ...</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1551082287, "post_id": 54861689, "comment_id": 96494368, "body": "Are you trying to pattern match on the type? It&#39;s pretty hard to see from this code fragment what your ultimate goal is."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1551083045, "post_id": 54861689, "comment_id": 96494733, "body": "<code>applyIf (Proxy:: Proxy Int) (*2) &quot;ok&quot;</code> shouldn&#39;t typecheck because <code>b</code> is <code>String</code> and <code>(*2)</code> doesn&#39;t return a <code>String</code>."}, {"owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "edited": false, "score": 0, "creation_date": 1551083613, "post_id": 54861689, "comment_id": 96495000, "body": "I need to replace (a -&gt; b) by (a -&gt;a) in the class definition."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551082922, "post_id": 54862014, "comment_id": 96494667, "body": "Just like in the OP, the <code>otherwise</code> case is unreachable, which is why I&#39;m wondering what was really intended."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1551083120, "post_id": 54862014, "comment_id": 96494769, "body": "Yes, I didn&#39;t notice that at first. My guess is <code>instance ApplyIf a</code>, but that wouldn&#39;t make the last line make sense."}, {"owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "edited": false, "score": 0, "creation_date": 1551083917, "post_id": 54862014, "comment_id": 96495130, "body": "I&#39;ve now replace (a-&gt;b) by (a-&gt;a).  Still, your code does not compile because TypeRep has kind &#39;*&#39;, not &#39;* -&gt; *&#39;."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "edited": false, "score": 0, "creation_date": 1551083982, "post_id": 54862014, "comment_id": 96495170, "body": "@user474491 What is your GHC version? (and <code>f b</code> now tries to apply <code>a -&gt; a</code> to <code>b</code>)."}, {"owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "edited": false, "score": 0, "creation_date": 1551084110, "post_id": 54862014, "comment_id": 96495223, "body": "Ah, I need to import Type.Reflection, not Data.Typeable."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1551084478, "post_id": 54862014, "comment_id": 96495400, "body": "You can use <code>Data.Typeable</code> as well, but the code would be slightly different."}, {"owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "edited": false, "score": 0, "creation_date": 1551086690, "post_id": 54862014, "comment_id": 96496571, "body": "I now get the error: Couldn&#39;t match expected type \u2018Int\u2019 with actual type \u2018b\u2019 on line 8, in the first argument of f..."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1551086810, "post_id": 54862014, "comment_id": 96496637, "body": "That&#39;s probably the &quot;(and <code>f b</code> now tries to apply <code>a -&gt; a</code> to <code>b</code>)&quot; I mentioned above (after <code>a ~ Int</code> is taken into account)."}, {"owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "edited": false, "score": 0, "creation_date": 1551087047, "post_id": 54862014, "comment_id": 96496772, "body": "So, what&#39;s the solution ? how can I make &quot;main&quot; in the original question work ?"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1551089348, "post_id": 54862014, "comment_id": 96498051, "body": "I&#39;ve tried to show something that should makes it work, but with no <code>ApplyIf</code> class (can&#39;t test on this machine)."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1551089513, "post_id": 54862014, "comment_id": 96498153, "body": "Though now I see melpomene&#39;s answer, and it&#39;s a simpler implementation."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 3, "last_activity_date": 1551089293, "last_edit_date": 1551089293, "creation_date": 1551082622, "answer_id": 54862014, "question_id": 54861689, "link": "https://stackoverflow.com/questions/54861689/how-to-pattern-match-on-proxy/54862014#54862014", "title": "How to pattern match on Proxy?", "body": "<blockquote>\n  <p>Proxy is a type that <strong>holds no data</strong>, but has a phantom parameter of arbitrary type (or even kind). </p>\n</blockquote>\n\n<p>I.e. at runtime you can't tell if you have a <code>Proxy Int</code> and so can't pattern match on this. Instead of <code>Proxy</code> you need <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Type-Reflection.html\" rel=\"nofollow noreferrer\"><code>TypeRep</code></a>:</p>\n\n<pre><code>{-# LANGUAGE TypeApplications #-}\nimport Type.Reflection\n\nclass ApplyIf a where\n  applyIf :: Show b =&gt; TypeRep a -&gt; (a -&gt; a) -&gt; b -&gt; String\n\ninstance ApplyIf Int where\n  applyIf tr f b | tr == typeRep @Int = show (f b)\n                 | otherwise = show b\n</code></pre>\n\n<p>(you need <code>TypeApplications</code> for <code>@Int</code>). You could use <code>typeOf (0 :: Int)</code> as well.</p>\n\n<p>EDIT: would this do what you want? See <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Type-Equality.html\" rel=\"nofollow noreferrer\"><code>Data.Type.Equality</code></a>.</p>\n\n<pre><code>{-# LANGUAGE TypeApplications #-}\nimport Type.Reflection\nimport Data.Type.Equality\n\n-- could have Typeable a constraint instead of a TypeRep a param\napplyIf :: (Show b, Show c, Typeable b) =&gt; TypeRep a -&gt; (a -&gt; c) -&gt; b -&gt; String\napplyIf tr f b = \n  case testEquality tr (typeOf b) of\n    Just Refl -&gt; show (f b)\n    Nothing -&gt; show b  \n\nmain = do\n  putStrLn $ applyIf (typeRep @Int) (*2) 1    -- 2\n  putStrLn $ applyIf (typeRep @Int) (*2) \"ok\" -- ok\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1551088505, "creation_date": 1551088505, "answer_id": 54863519, "question_id": 54861689, "link": "https://stackoverflow.com/questions/54861689/how-to-pattern-match-on-proxy/54863519#54863519", "title": "How to pattern match on Proxy?", "body": "<p>Do you mean something like this?</p>\n\n<pre><code>import Data.Typeable\n\napplyIf :: (Show a, Typeable a, Show b, Typeable b) =&gt; (b -&gt; b) -&gt; a -&gt; String\napplyIf f x = case cast x of\n    Nothing -&gt; show x\n    Just y  -&gt; show (f y)\n\nmain = do\n  putStrLn $ applyIf ((*2) :: Int -&gt; Int) (1 :: Int)\n  putStrLn $ applyIf ((*2) :: Int -&gt; Int) \"ok\"\n</code></pre>\n\n<p>Here we use <code>Typeable</code> to check at runtime whether <code>a</code> and <code>b</code> are the same type, which either lets us apply <code>f</code> or not.</p>\n"}], "owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 54863519, "answer_count": 2, "score": 1, "last_activity_date": 1551089293, "creation_date": 1551081164, "last_edit_date": 1551087600, "question_id": 54861689, "link": "https://stackoverflow.com/questions/54861689/how-to-pattern-match-on-proxy", "title": "How to pattern match on Proxy?", "body": "<p>I need a method to conditionally apply a function depending on the specific instance of a class.</p>\n\n<p>I tried using Proxy to annotate the function with the type of its input:</p>\n\n<pre><code>class ApplyIf b where\n  applyIf :: Show b =&gt; proxy a -&gt; (a -&gt; a) -&gt; b -&gt; String\n\ninstance ApplyIf Int where\n  applyIf (p :: Proxy Int) f b = show (f b)\n  applyIf _                _ b = show b\n\ninstance ApplyIf String where\n  applyIf _ _ b = show b\n\nmain = do\n  putStrLn $ applyIf (Proxy:: Proxy Int) (*2) 1    -- 2\n  putStrLn $ applyIf (Proxy:: Proxy Int) (*2) \"ok\" -- ok\n</code></pre>\n\n<p>But I get an 'Illegal type signature: 'Proxy Int' error on line 5.</p>\n\n<p>Should I use some other mechanisms, like Tagged, Typeable, ... ?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1551117897, "post_id": 54859182, "comment_id": 96514556, "body": "As an aside, expect to get wrong answers when doing a floating-point square root with numbers too big to fit in Int in a 64-bit build of ghc. It just doesn&#39;t have enough precision. Use a proper Integer square root instead."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1551141932, "post_id": 54859182, "comment_id": 96523753, "body": "Something like <code>wP = floor . (&#47; 2) . subtract 1 . sqrt . fromIntegral . succ . (* 8)</code> would be more traditional if you\u2019re going to use a \u201cpipeline\u201d style."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551162946, "post_id": 54859182, "comment_id": 96528564, "body": "Hmm. I&#39;m thinking Unix &quot;pipeline&quot;, flowing left to right, each arithmetic operation modifying the value. Prefix style piling up 7 operations gives my head stack overflow. Flowing left-to-right, or rather top-to-bottom, is why I like monad style. I think prefix style for combinators or flow-of-control logic is OK, but I would avoid so many as 7."}], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1551070269, "post_id": 54859221, "comment_id": 96490158, "body": "For these sort of things I almost always use <code>(&gt;&gt;&gt;)</code> - it makes the code look much nicer."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551076410, "post_id": 54859221, "comment_id": 96491917, "body": "Strange <code>(&amp;)</code> doesn&#39;t come up on Hoogle. It&#39;s <code>infixl 1</code>. Compare <code>infixr 1 (&gt;&gt;&gt;)</code>, but that&#39;s reverse compose rather than reverse func apply. <code>(&lt;&amp;&gt;)</code> is in <code>Functor</code> not <code>Monad</code>, so I can&#39;t use <code>do</code> block."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551079770, "post_id": 54859221, "comment_id": 96493268, "body": "@AntC I&#39;m not really sure what a <code>do</code> block would gain you here. This is not a problem that really maps well to <code>Monad</code>s. It is essentially just function composition/application. I guess you could name intermediate results but, personally, I think this would make this particular example <i>less</i> readable (coming up with names is often hard, especially for things like the intermediate results here). Something to consider: sometimes people try to &quot;force&quot; monads to do something they aren&#39;t good at (I have seen people do this on multiple occasions). It is best to try to avoid this."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1551080250, "post_id": 54859221, "comment_id": 96493454, "body": "Also, for <code>(&gt;&gt;&gt;)</code>, it doesn&#39;t really matter if that operator associates to the left or to the right since function composition is associative. Association direction does change things for <code>(&amp;)</code>, but it is sort of a preference thing in that case. There is the occasional debate about which way is better and each has its conveniences."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551100221, "post_id": 54859221, "comment_id": 96504198, "body": "@AntC &quot;<code>(&lt;&amp;&gt;)</code> is in <code>Functor</code> not <code>Monad</code>, so I can&#39;t use <code>do</code> block.&quot; Everything that&#39;s a <code>Monad</code> is also a <code>Functor</code>, so anything that works on <code>Functor</code>s also works on <code>Monad</code>s, so use of <code>&lt;&amp;&gt;</code> does not preclude use of <code>do</code>."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1551066327, "creation_date": 1551066327, "answer_id": 54859221, "question_id": 54859182, "link": "https://stackoverflow.com/questions/54859182/is-there-a-pipelining-monad/54859221#54859221", "title": "Is there a Pipelining Monad?", "body": "<p>Your operator <code>.|</code> already exists in <code>Data.Function</code> as <code>&amp;</code>. To make it pointfree, you can either use <code>&gt;&gt;&gt;</code> from <code>Control.Arrow</code>, or invert the order of everything and just use <code>.</code>. For <code>Monad m =&gt; m a -&gt; (a -&gt; b) -&gt; m b</code>, you want <code>&lt;&amp;&gt;</code>, from <code>Data.Functor</code>.</p>\n"}], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551066327, "creation_date": 1551065912, "question_id": 54859182, "link": "https://stackoverflow.com/questions/54859182/is-there-a-pipelining-monad", "title": "Is there a Pipelining Monad?", "body": "<p>So I'm playing with the <a href=\"https://en.wikipedia.org/w/index.php?title=Pairing_function&amp;oldid=853876462#Cantor_pairing_function\" rel=\"nofollow noreferrer\">Cantor pairing function</a>, and trying to follow the wikipedia formulas as close as possible.</p>\n\n<pre><code>type N = Int\n\ntoCantor   :: (N, N) -&gt; N\nfromCantor :: N      -&gt; (N, N)\n\ntoCantor (x, y) = (x + y) * (x + y + 1) `div` 2 + y\n</code></pre>\n\n<ul>\n<li><code>type N</code> so I can easily change to <code>Integer</code> later (some of the intermediate calcs will get big).</li>\n<li>uncurried form, partly to follow wp, partly so <code>(fromCantor . toCantor) === id</code> and <code>(toCantor . fromCantor) === id</code>.</li>\n</ul>\n\n<p>Again following wp:</p>\n\n<pre><code>fromCantor z = (x, y)  where\n     x = w - y\n     y = z - t\n     t = (w * w + w) `div` 2\n     w = floor $ (sqrt (fromIntegral (z * 8 + 1)) - 1.0) / 2.0\n</code></pre>\n\n<p>This works and everything but gee that formula for <code>w</code> is ugly!</p>\n\n<ul>\n<li>It needs all those parens because I've got a formula nested inside a function call and a loose-binding <code>(-)</code> nested inside a tight-binding <code>(/)</code>.</li>\n<li>(And both those operators are non-commutative, so I must be careful.)</li>\n</ul>\n\n<p><strong>Q 1.</strong> Is there a way to make that formula prettier/pointfree?</p>\n\n<p>I see the formula starts from <code>z</code> and builds outwards. So I can pipeline the calculation:</p>\n\n<pre><code>(.|) :: a -&gt; (a -&gt; b) -&gt; b   -- pipelining\ninfixl 0 .|\nx .| f = f x                 -- aka flip ($)\n\nwP :: N -&gt; N                 -- w with Pipelining\nwP z =  z\n     .| (* 8)\n     .| (+ 1)\n     .| fromIntegral\n     .| sqrt\n     .| subtract 1.0\n     .| (/ 2.0)\n     .| floor\n</code></pre>\n\n<p>Is this style prior art? Is <code>(.|)</code> a good way to spell that operation -- I think I've seen it as a Lens operator(?)</p>\n\n<p><strong>Q 2.</strong> I've (deliberately) laid that out in pseudo-monad style. Could it actually be a <code>do</code> block?</p>\n\n<ul>\n<li>First I need a monad. I could use <code>Maybe</code> or <code>(Either e)</code>  -- which would be a Good Thing because several of those functions are partial, and I ought to be using a safe version.</li>\n<li>Then instead of <code>z</code> I'd put <code>return z</code>.</li>\n<li>But the binding goes the wrong way round. Instead of <code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>, I want <code>Monad m =&gt; m a -&gt; (a -&gt; b) -&gt; m b</code>. That looks like an <code>fmap</code>, but flipped.</li>\n<li>I could apply some sort of lifting to the functions/operators, but that then obscures the arithmetic with monad plumbing.</li>\n<li>Rebindable syntax?</li>\n</ul>\n"}, {"tags": ["haskell", "lexer"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1551062745, "post_id": 54858569, "comment_id": 96488802, "body": "Matching on prefixes won&#39;t get you very far, because some tokens won&#39;t be predefined strings - for example numbers or identifiers."}, {"owner": {"reputation": 156, "user_id": 1133447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2128ac3e42ca45101c7c17a07de4bba7?s=128&d=identicon&r=PG&f=1", "display_name": "avery_laird", "link": "https://stackoverflow.com/users/1133447/avery-laird"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1551063467, "post_id": 54858569, "comment_id": 96488935, "body": "Right, of course prefix matching would not cover everything. I was talking specifically about reserved keywords"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551063536, "post_id": 54858569, "comment_id": 96488954, "body": "Perhaps <a href=\"http://hackage.haskell.org/package/regex-applicative\" rel=\"nofollow noreferrer\">regex-applicative</a> will suit your needs."}, {"owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "edited": false, "score": 1, "creation_date": 1551079539, "post_id": 54858569, "comment_id": 96493176, "body": "You should probably learn how to use some parsec library."}, {"owner": {"reputation": 156, "user_id": 1133447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2128ac3e42ca45101c7c17a07de4bba7?s=128&d=identicon&r=PG&f=1", "display_name": "avery_laird", "link": "https://stackoverflow.com/users/1133447/avery-laird"}, "edited": false, "score": 0, "creation_date": 1551133614, "post_id": 54858569, "comment_id": 96521354, "body": "Thanks everyone for their input. To clarify my question further, I would like to limit how much I use parsing/regex libraries."}], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "is_accepted": true, "score": 1, "last_activity_date": 1551122602, "creation_date": 1551122602, "answer_id": 54873297, "question_id": 54858569, "link": "https://stackoverflow.com/questions/54858569/haskell-matching-string-prefixes-against-list/54873297#54873297", "title": "Haskell: Matching String Prefixes against List", "body": "<p>If you want to match based on a string prefix, you could use the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/ViewPatterns\" rel=\"nofollow noreferrer\">ViewPatterns extension</a>. This extension can be enabled by passing -XViewPatterns to the compiler, by running <code>:set -XViewPatterns</code> in ghci, or by putting <code>{-# LANGUAGE ViewPatterns #-}</code> at the top of the file.</p>\n\n<p>Then, you can write a function <code>matchPrefix</code> (not 100% optimal, as it does iterate over <code>prefix</code> twice):</p>\n\n<pre><code>matchPrefix :: String -&gt; String -&gt; Maybe String\nmatchPrefix prefix result\n  | and (zipWith (==) prefix result) = Just (drop (length prefix) result)\n  | otherwise = Nothing\n</code></pre>\n\n<p>And then use it in a pattern like the following:</p>\n\n<pre><code>startsWithInt :: String -&gt; Bool\nstartsWithInt (matchPrefix \"int \" -&gt; Just rest) = True\nstartsWithInt _ = False\n</code></pre>\n\n<p>If you wanted to match based on a list of tokens, and get out the rest of the string and which token matched, you could do that by modifying <code>matchPrefix</code> to do that instead.</p>\n"}], "owner": {"reputation": 156, "user_id": 1133447, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2128ac3e42ca45101c7c17a07de4bba7?s=128&d=identicon&r=PG&f=1", "display_name": "avery_laird", "link": "https://stackoverflow.com/users/1133447/avery-laird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 54873297, "answer_count": 1, "score": 1, "last_activity_date": 1551122602, "creation_date": 1551060551, "question_id": 54858569, "link": "https://stackoverflow.com/questions/54858569/haskell-matching-string-prefixes-against-list", "title": "Haskell: Matching String Prefixes against List", "body": "<p>I've been learning some Haskell lately, and I thought a lexer might be a fun project. I'm using <a href=\"http://www.lysator.liu.se/c/ANSI-C-grammar-y.html\" rel=\"nofollow noreferrer\">this ANSI C Yacc grammar</a> as a guide.</p>\n\n<p>The general program structure is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>lex :: [Char] -&gt; Maybe [Token]\nlex s =\n  case tokenize([], s) of\n    Just (tokens, []) -&gt; Just tokens\n    _ -&gt; Nothing\n\ntokenize :: ([Token], [Char]) -&gt; Maybe ([Token], [Char])\n</code></pre>\n\n<p>Where <code>tokenize</code> builds a list of tokens. <strong>I'm having trouble thinking of a suitable structure for <code>tokenize</code>.</strong> For example, to match keywords like <code>int</code>, I could write:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>tokenize (toks, 'i':'n':'t':' ':rest) = tokenize (toks++[TokenKeyword IntK], rest)\n</code></pre>\n\n<p>But this seems like a terrible way to do things. Is there a way to pattern match against elements in a list? Could I create a list of all keywords, and attempt to match them as prefixes of the input string? </p>\n"}, {"tags": ["haskell", "clojure", "stack-overflow", "reduce", "fold"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1551058157, "post_id": 54858191, "comment_id": 96487991, "body": "Use <code>Data.List.foldl&#39;</code>, the strict form of <code>foldl</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551101209, "post_id": 54858191, "comment_id": 96504777, "body": "Haskell equivalent to Clojure&#39;s <code>(reduce +&#39; (range 1 99999999))</code> is <code>foldl&#39; (+) 0 [1..99999998]</code> (sic) (apparently; to get the same result as you show). Haskell ranges are inclusive."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1551134196, "post_id": 54858191, "comment_id": 96521565, "body": "see also <a href=\"https://stackoverflow.com/q/13042353/849891\">Does Haskell have tail-recursive optimization?</a>. the question is worded differently, but it is actually near-duplicate for this one -- <code>foldl</code> is tail-recursive, etc."}], "answers": [{"comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 6, "creation_date": 1551059372, "post_id": 54858287, "comment_id": 96488204, "body": "While I agree with your eventual solution\u2014namely, use <code>foldl&#39;</code>\u2014I think a lot of things in your surrounding explanation aren\u2019t quite right. The problem is not just that <code>+</code> is strict in both its arguments, but that <code>foldr</code> is <i>lazy</i>; the fact that you say <code>+&#39;</code> in Clojure must not be strict in both its arguments doesn\u2019t make any sense because Clojure is not a lazy programming language. The reason it is a problem in Haskell is because of the creation of thunks, but this does not happen in Clojure because its <code>reduce</code> is essentially Haskell\u2019s <code>foldl&#39;</code>; that is, it is strict in its accumulator."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 6, "creation_date": 1551059571, "post_id": 54858287, "comment_id": 96488246, "body": "Furthermore, you write that \u201c<code>foldl</code> has to travel the whole list twice before returning a result\u201d, which is not true. <code>foldl</code> does have to travel the whole list before returning a result, but it only has to do it once. This is in contrast with <code>foldr</code>, which doesn\u2019t have to travel the whole list even once before returning a result if the accumulation function is lazy in its second argument. However, both of these things are immaterial in a case where the accumulation function is strict, since the whole list will have to be traversed, anyway."}, {"owner": {"reputation": 1543, "user_id": 809584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d577a1b45100bc0d0492b6f87d96a04?s=128&d=identicon&r=PG", "display_name": "alexakarpov", "link": "https://stackoverflow.com/users/809584/alexakarpov"}, "edited": false, "score": 0, "creation_date": 1551060669, "post_id": 54858287, "comment_id": 96488450, "body": "thank you (both). Looks like my mistake was jumping to conclusions, before finishing the whole page, eh. Specifically, implenebting our own versions of foldl and foldr sounded like a good exercise - but, I thought, surely Prelude&#39;s versions will be already perfect and not run into overflows... which, I see, is due to (+), and not fold&#39;s implementation."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1551060918, "post_id": 54858287, "comment_id": 96488489, "body": "@AlexisKing That was my understanding, which is probably wrong if you say so. I am happy to make it a wiki answer if you wanna contribute or you can just write your own answer if thats easier"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 1543, "user_id": 809584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d577a1b45100bc0d0492b6f87d96a04?s=128&d=identicon&r=PG", "display_name": "alexakarpov", "link": "https://stackoverflow.com/users/809584/alexakarpov"}, "edited": false, "score": 0, "creation_date": 1551065869, "post_id": 54858287, "comment_id": 96489372, "body": "@alexakarpov It&#39;s a decent assumption (that the prelude versions would be good).  I am a bit bewlidered by <code>foldl</code> \u2013\u2013 I&#39;ve been using Haskell for over ten years and have never encountered a situation where <code>foldl</code> was useful.  It&#39;s either <code>foldr</code> or <code>foldl&#39;</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1551082763, "post_id": 54858287, "comment_id": 96494586, "body": "@luqui, <code>foldl</code> is essentially never useful for lists. OTOH, it&#39;s just right for folding a <code>Set</code>, <code>Seq</code>, etc., &quot;backwards&quot;. For example, <code>foldl (flip (:)) []</code> will produce a descending list of <code>Set</code> elements or convert a sequence to a reversed list. The same applies to <code>foldr&#39;</code>: it&#39;s worthless for lists but sometimes useful for other structures."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1551084061, "post_id": 54858287, "comment_id": 96495205, "body": "@dfeuer, oh the <code>Foldable</code> one.  I still haven&#39;t updated my map of those functions to <code>Foldable</code> -- I guess it&#39;s been a while now.  But yeah, it seems the problem is that the fold associativity is incompatible with list&#39;s associativity; <code>foldl</code> would be perfect for <code>data Tsil a = Lin | Snoc [a] a</code>.  Cool, I hadn&#39;t realized that!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1551104935, "post_id": 54858287, "comment_id": 96507184, "body": "@AlexisKing <code>foldl</code> traverses the list &quot;twice&quot; in the sense that it traverses it once to build the thunk result, and then <i>that thunk</i> is &quot;traversed&quot; too, to be evaluated, unfolding the stack, which is then folded back (which could be seen as the <i>third</i> &quot;traversal&quot;). that&#39;s my theory anyway."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1551125372, "post_id": 54858287, "comment_id": 96517813, "body": "@WillNess Good point. That does seem like the most reasonable interpretation, though I still wouldn\u2019t personally consider it quite the same as traversing the list twice!"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": -2, "last_activity_date": 1551058078, "last_edit_date": 1551058078, "creation_date": 1551057583, "answer_id": 54858287, "question_id": 54858191, "link": "https://stackoverflow.com/questions/54858191/haskells-foldr-l-and-clojures-reduce/54858287#54858287", "title": "Haskell&#39;s foldr/l and Clojure&#39;s reduce", "body": "<h1>Problem</h1>\n\n<p>As <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl&#39;.\" rel=\"nofollow noreferrer\">the Wiki</a> explains, the function <code>(+)</code> is strict in both its arguments, which means that when you try to do <code>1 + (2 + 3)</code>, you first need to calculate <code>(2 + 3)</code>. While this may not seem like a big problem at first, it becomes when you have a long list. Quoting the wiki,</p>\n\n<blockquote>\n  <p>to evaluate:\n         <code>1 + (2 + (3 + (4 + (...))))</code>, 1 is pushed on the stack.</p>\n  \n  <p>Then: <code>2 + (3 + (4 + (...)))</code> is evaluated. So 2 is pushed on the stack.</p>\n  \n  <p>Then: <code>3 + (4 + (...))</code> is evaluated. So 3 is pushed on the stack.</p>\n  \n  <p>Then: <code>4 + (...)</code> is evaluated. So 4 is pushed on the stack.</p>\n  \n  <p>Then: your limited stack will eventually run full when you evaluate a large enough chain of (+)s. This then triggers the stack overflow exception.</p>\n</blockquote>\n\n<p>I don't much about Clojure, but if <code>(+')</code> works, then it definitely does not need both its arguments to be evaluated before being reduced, and that is also the solution in Haskell.</p>\n\n<h1>Solution</h1>\n\n<p>Foldl would not solve the problem, as it is known that foldl has to travel the whole list twice before returning a result --which is not efficient--, and even then <code>(+)</code> is still strict, so the reducible expressions are not reduced.</p>\n\n<p>To solve this, you must use a non-strict function. In the standard Prelude, <code>seq :: a -&gt; b -&gt; b</code> can be used exactly for that, and that's how <code>foldl'</code> works.</p>\n\n<p>Again quoting the wiki,</p>\n\n<blockquote>\n  <p>foldr is not only the right fold, it is also <strong>most commonly the right\n  fold to use</strong>, in particular when transforming lists (or other\n  foldables) into lists with related elements in the same order.\n  Notably, foldr will be effective for transforming even infinite lists\n  into other infinite lists. For such purposes, it should be your first\n  and most natural choice. For example, note that foldr (:) []==id.</p>\n</blockquote>\n\n<p>The problem with foldl' is that it reverses the list. If you have a commutative function that is not a problem, so if your list is finite (remember foldl has to travel it all), <code>foldl'</code> is usually better. On the other hand, if your function for some reasons does not necessarily need the whole list, or the list might be infinite, go for <code>foldr</code> </p>\n"}], "owner": {"reputation": 1543, "user_id": 809584, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5d577a1b45100bc0d0492b6f87d96a04?s=128&d=identicon&r=PG", "display_name": "alexakarpov", "link": "https://stackoverflow.com/users/809584/alexakarpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 54858287, "answer_count": 1, "score": 2, "last_activity_date": 1551134285, "creation_date": 1551056528, "last_edit_date": 1551134285, "question_id": 54858191, "link": "https://stackoverflow.com/questions/54858191/haskells-foldr-l-and-clojures-reduce", "title": "Haskell&#39;s foldr/l and Clojure&#39;s reduce", "body": "<p>I decided to get serious with Haskell, and am wrapping my head around the use of <strong>foldl</strong> and <strong>foldr</strong>. They really feel a lot like Clojure's <strong>reduce</strong> - but I might be wrong, and ran into a problem soon enough, which I hope someone will easily explain.</p>\n\n<p>Working with this doc:\n<a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Foldr_Foldl_Foldl</a>'</p>\n\n<p>Before getting too deep into implementing my own versions of foldr/foldl, I decided to first test the existing ones from Prelude:</p>\n\n<pre><code>\u00b1 |master U:2 \u2717| \u2192 ghci\nGHCi, version 8.6.3: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /Users/akarpov/.ghc/ghci.conf\nPrelude&gt; foldr (+) 0 [1..9999999]\n49999995000000\nPrelude&gt; foldr (+) 0 [1..99999999]\n*** Exception: stack overflow\n</code></pre>\n\n<p>Didn't see that coming (same result when using foldl); I rather expected something along the lines of Clojure:</p>\n\n<pre><code>&gt; (time (reduce +' (range 1 99999999)))\n\"Elapsed time: 3435.638258 msecs\"\n4999999850000001\n</code></pre>\n\n<p>The only obvious (and irrelevant) difference is using +' rather than +, but it's only to accommodate the JVM's type system - the number produced doesn't fit into a [default] Long, and +' will automatically use a BigInteger when needed. Most importantly, no stack overflow.\nIt seems to indicate, therefore, that folding/reduction in Haskell/Clojure is either implemented very differently, or my use of haskell's implementation is wrong.</p>\n\n<p>in case it is relevant, these are global-project settings:\n- packages: []\n- resolver: lts-13.8</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 6, "creation_date": 1551051819, "post_id": 54857650, "comment_id": 96486816, "body": "For your case, just turn on <code>OverlappingInstances</code> and the right overlap flag (see the GHC users guide on overlapping instances). The more general problem of &quot;functions which will be invoked as appropriate for specific constraints on the data&quot; doesn&#39;t have a good solution. The issue is that Haskell resolves instances based on the instance head and <i>not</i> based on the constraints for that head (this is by design, not a bug). See <a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap\" rel=\"nofollow noreferrer\">this wiki page</a> for more on working around that."}, {"owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1551052629, "post_id": 54857650, "comment_id": 96486942, "body": "Thanks! That page will take some digesting, but I&#39;ll attack it. Also thanks to your pointer I discovered that in the above I can just add the <code>OVERLAPPABLE</code> pragma to the (Eq, Show) instance instead of a file-wide <code>OverlappingInstances</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1551053044, "post_id": 54857650, "comment_id": 96487035, "body": "Ah yes! I keep forgetting that you can use <code>OVERLAPPABLE</code> without enabling <code>OverlappingInstances</code>. Given that you&#39;ve now figured this out, you could also add an answer to your own question. :)"}, {"owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1551053804, "post_id": 54857650, "comment_id": 96487183, "body": "I could but you deserve the points far more than I do, so please feel free!"}], "answers": [{"tags": [], "owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "is_accepted": true, "score": 1, "last_activity_date": 1551900373, "creation_date": 1551900373, "answer_id": 55030775, "question_id": 54857650, "link": "https://stackoverflow.com/questions/54857650/haskell-instance-dispatch-based-on-constraints/55030775#55030775", "title": "Haskell instance dispatch based on constraints", "body": "<p>The problem with overlapping instances in the example can be solved with the addition of the OVERLAPPABLE directive for the final instance therein:</p>\n\n<pre><code>instance {-# OVERLAPPABLE #-} (Eq a, Show a) =&gt; AssertEqual a where\nassertEqual a b\n  |    a == b = True\n  | otherwise = error $ \"The two items are not equal. One is \" ++ (show a) ++ \" and the other is \" ++ (show b)\n</code></pre>\n\n<p>However, as Alec kindly mentioned, the more general question of allowing constraints to dictate function dispatch does not have a good solution at present.</p>\n"}], "owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 55030775, "answer_count": 1, "score": 2, "last_activity_date": 1551900373, "creation_date": 1551051397, "last_edit_date": 1551051698, "question_id": 54857650, "link": "https://stackoverflow.com/questions/54857650/haskell-instance-dispatch-based-on-constraints", "title": "Haskell instance dispatch based on constraints", "body": "<p>I am trying to figure out how to define, within a <code>class</code>, functions which will be invoked as appropriate for specific constraints on the data. Because I'm a Haskell newbie I'm not sure if the preceding is expressed in the proper terms, but perhaps it will be more clear with the following example, which is as close as I've gotten this far:</p>\n\n<pre><code>{-# LANGUAGE ConstrainedClassMethods #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nmodule Test where\n\nclass (Eq a) =&gt; AssertEqual a where\n   assertEqual :: AssertEqual a =&gt; a -&gt; a -&gt; Bool\n\n\ninstance AssertEqual String where\n    assertEqual a b\n        |    a == b = True\n        | otherwise = error $ \"Oops. \" ++ show a ++ \" is not equal to \" ++ show b\n\n\ndata Foo = Foo Int deriving Eq\n\ninstance AssertEqual Foo where\n    assertEqual a b\n      |    a == b = True\n      | otherwise = error \"The two Foos are not equal, but I can't show them to you.\"\n\ninstance (Eq a, Show a) =&gt; AssertEqual a where\n    assertEqual a b\n      |    a == b = True\n      | otherwise = error $ \"The two items are not equal. One is \" ++ (show a) ++ \" and the other is \" ++ (show b)\n</code></pre>\n\n<p>The above compiles (GHC 8.0.2) but when I invoke <code>assertEqual \"hi\" \"hi\"</code> I get an error complaining about overlapping instances. I understand why the instances are overlapping in this case, and I think I also understand why this is a bad thing, but what I don't know if there is a solution. Or, of course, if what I want is itself a bad idea (and if that is the case, why it is a bad idea.)</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1551055159, "post_id": 54857442, "comment_id": 96487427, "body": "You&#39;re probably looking for <a href=\"https://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-TH.html#v:makeClassy\" rel=\"nofollow noreferrer\"><code>makeClassy</code></a> and friends in the <code>Control.Lens.TH</code> docs."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1551059093, "post_id": 54857442, "comment_id": 96488142, "body": "Interesting, that seems to be the right doc, but am confused on the example above still; <code>makeLensesWith camelCaseFields</code> == <code>makeFieldOptics defaultFieldRules</code>, which has <code>_classyLenses    = const Nothing</code>. On the other hand, <code>makeClassy</code> == <code>makeFieldOptics classyRules</code>, and <code>classyRules</code> has <code>_classyLenses</code> set to something more that obviously has an effect on generating <code>Has</code> classes."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1551110483, "creation_date": 1551110483, "answer_id": 54870191, "question_id": 54857442, "link": "https://stackoverflow.com/questions/54857442/where-is-the-documentation-for-autogeneration-of-has-typeclasses-in-lens/54870191#54870191", "title": "Where is the documentation for autogeneration of Has typeclasses in lens?", "body": "<p><code>Field</code> is the word <code>lens</code> uses to describe the pattern of one class per named field, allowing multiple records with the same field name but (optionally) different types.  So <code>camelCaseFields</code>, <code>makeFieldOptics</code>, <code>defaultFieldRules</code> all say in their name that they will generate these <code>HasFoo</code> classes, in the usual terse style of <code>lens</code>.</p>\n\n<p><code>makeClassy</code> <em>also</em> generates classes named <code>Has*</code>, but named after the data type, not the record field, and not following a different pattern.</p>\n\n<p>Your code above generates the following code (shown with <code>-ddump-splices</code>):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    makeLensesWith camelCaseFields ''Env\n  ======&gt;\n    class HasBalance s a | s -&gt; a where\n      balance :: Lens' s a\n    instance HasBalance Env (TVar Int) where\n      {-# INLINE balance #-}\n      balance f_a4eTr (Env x1_a4eTs x2_a4eTt)\n        = (fmap (\\ y1_a4eTu -&gt; (Env x1_a4eTs) y1_a4eTu)) (f_a4eTr x2_a4eTt)\n    class HasLog s a | s -&gt; a where\n      log :: Lens' s a\n    instance HasLog Env (String -&gt; IO ()) where\n      {-# INLINE log #-}\n      log f_a4eTx (Env x1_a4eTy x2_a4eTz)\n        = (fmap (\\ y1_a4eTA -&gt; (Env y1_a4eTA) x2_a4eTz)) (f_a4eTx x1_a4eTy)\n</code></pre>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 54870191, "answer_count": 1, "score": 4, "last_activity_date": 1551110483, "creation_date": 1551049401, "question_id": 54857442, "link": "https://stackoverflow.com/questions/54857442/where-is-the-documentation-for-autogeneration-of-has-typeclasses-in-lens", "title": "Where is the documentation for autogeneration of Has typeclasses in lens?", "body": "<p>I was looking at the penultimate example in this <a href=\"https://www.fpcomplete.com/blog/2017/06/readert-design-pattern\" rel=\"nofollow noreferrer\">blog post</a> (also <a href=\"https://github.com/bbarker/ProjectGists/blob/master/Haskell/ReaderLensHas/app/Main.hs\" rel=\"nofollow noreferrer\">here</a>), and after verifying it ran, it seemed to confirm that lens can generate Has typeclasses, which I take was the implication from the author of the blog. However, I miss where this is described, either in the <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lens contents</a> or the <a href=\"https://hackage.haskell.org/package/lens-tutorial-1.0.3/docs/Control-Lens-Tutorial.html\" rel=\"nofollow noreferrer\">lens tutorial</a>. Any explanations external to official docs for how this is done would also be welcome. But it seems like this may just be standard when using the most basic feature (<code>makeLenses</code>, or in this case, <code>makeLensesWith</code>).</p>\n\n<p>Here is the reproduced code:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-8.12 script\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FunctionalDependencies #-}\nimport Control.Concurrent.Async.Lifted.Safe\nimport Control.Monad.Reader\nimport Control.Concurrent.STM\nimport Say\nimport Control.Lens\nimport Prelude hiding (log)\n\ndata Env = Env\n  { envLog :: !(String -&gt; IO ())\n  , envBalance :: !(TVar Int)\n  }\n\nmakeLensesWith camelCaseFields ''Env\n\nmodify :: (MonadReader env m, HasBalance env (TVar Int), MonadIO m)\n       =&gt; (Int -&gt; Int)\n       -&gt; m ()\nmodify f = do\n  env &lt;- ask\n  liftIO $ atomically $ modifyTVar' (env^.balance) f\n\nlogSomething :: (MonadReader env m, HasLog env (String -&gt; IO ()), MonadIO m)\n             =&gt; String\n             -&gt; m ()\nlogSomething msg = do\n  env &lt;- ask\n  liftIO $ (env^.log) msg\n\nmain :: IO ()\nmain = do\n  ref &lt;- newTVarIO 4\n  let env = Env\n        { envLog = sayString\n        , envBalance = ref\n        }\n  runReaderT\n    (concurrently\n      (modify (+ 1))\n      (logSomething \"Increasing account balance\"))\n    env\n  balance &lt;- readTVarIO ref\n  sayString $ \"Final balance: \" ++ show balance\n</code></pre>\n"}, {"tags": ["haskell", "io-monad"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551040081, "post_id": 54856183, "comment_id": 96483933, "body": "Also, <code>&gt;&gt;=</code> is simpler if you put <code>unPGm</code> in the definition of <code>PGm</code> using record syntax: <code>newtype PGm a = PGm { unPGm :: IO a }</code>"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551040144, "post_id": 54856183, "comment_id": 96483949, "body": "@chepner Yes it definitely is, but I decided to keep EdBehn&#39;s definition for now. I would definitely define this sort of type using record syntax."}, {"owner": {"reputation": 328, "user_id": 2765718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5609d9b3cd77f4949670d8cd4ecf074?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Behn", "link": "https://stackoverflow.com/users/2765718/ed-behn"}, "edited": false, "score": 0, "creation_date": 1551063357, "post_id": 54856183, "comment_id": 96488914, "body": "Thanks. I had figured out some of that after I posted, but your way of implementing &gt;&gt;= is much cleaner than mine. Of course using deriving is cleaner still."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 328, "user_id": 2765718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5609d9b3cd77f4949670d8cd4ecf074?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Behn", "link": "https://stackoverflow.com/users/2765718/ed-behn"}, "edited": false, "score": 0, "creation_date": 1551063912, "post_id": 54856183, "comment_id": 96489040, "body": "@EdBehn You&#39;re welcome! For this sort of thing I almost always use <code>GeneralizedNewtypeDeriving</code> unless I need something special. There&#39;s <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extensions-to-the-deriving-mechanism\" rel=\"nofollow noreferrer\">plenty other useful extensions</a> as well - I would highly recommend having a look through them!"}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 8, "last_activity_date": 1551039887, "creation_date": 1551039887, "answer_id": 54856183, "question_id": 54856052, "link": "https://stackoverflow.com/questions/54856052/create-haskell-io-wrapper/54856183#54856183", "title": "Create haskell IO wrapper", "body": "<p>You just unwrap and rewrap each operation. The hard part is figuring out where the unwrapping and rewrapping goes:</p>\n\n<pre><code>newtype PGm a = PGm (IO a)\ninstance Monad PGm where\n   (&gt;&gt;=) (PGm a) b = PGm (a &gt;&gt;= (unPGm . b))\n     where\n       unPGm (PGm x) = x\n   (&gt;&gt;)  (PGm a) (PGm b) = a &gt;&gt; b\n   return a  = PGm (return a)\n   fail a    = PGm (fail a)\n</code></pre>\n\n<p>However, this won't quite be enough, as Haskell requires instances for <code>Functor</code> and <code>Applicative</code> before a <code>Monad</code> instance may be defined. An easier solution would be to put the <code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</code> at the top of your file (or enable <code>:set -XGeneralizedNewtypeDeriving</code> in GHCi), which lets you do this;</p>\n\n<pre><code>newtype PGm a = PGm (IO a) deriving (Functor, Applicative, Monad)\n</code></pre>\n\n<p>The idea is that if you enable this extension, GHC will be smart enough to automatically derive newtype instances from their 'base' ones.</p>\n"}], "owner": {"reputation": 328, "user_id": 2765718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5609d9b3cd77f4949670d8cd4ecf074?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Behn", "link": "https://stackoverflow.com/users/2765718/ed-behn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1551039887, "creation_date": 1551039101, "question_id": 54856052, "link": "https://stackoverflow.com/questions/54856052/create-haskell-io-wrapper", "title": "Create haskell IO wrapper", "body": "<p>In the GHC manual section on FFI, it is stated that the programmer can use <code>newtype</code> to create a wrapper monad around the IO monad and use it in place of the IO monad when calling foreign code. (<a href=\"http://downloads.haskell.org/~ghc/8.2.2/docs/html/users_guide/ffi-chap.html#newtype-wrapping-of-the-io-monad\" rel=\"nofollow noreferrer\">GHC manual</a>)</p>\n\n<p>So far, I have:</p>\n\n<pre><code>newtype PGm a = PGm (IO a)\ninstance Monad PGm where\n   (&gt;&gt;=) a b = ...\n   (&gt;&gt;)  a b = ...\n   return a  = PGm (return a) --I think\n   fail a    = PGm (fail a)   --I think\n</code></pre>\n\n<p>I'm at a loss regarding how to implement <code>(>>=)</code> and <code>(>>)</code>.</p>\n"}, {"tags": ["haskell", "optimization", "compiler-construction", "ghc"], "comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1551062925, "post_id": 54855375, "comment_id": 96488831, "body": "If you have some formula which is repeated in your code, best is to give it a name then use the name. Declare with a <code>let</code> or <code>where</code>. Do you have some code that seems a memory hog or is running slowly and you think there&#39;s an opportunity for CSE that GHC is not taking? Then please show the code. (Because often people think their code has opportunities, but they&#39;re not considering that it might be polymorphic.) Otherwise your q is just too broad."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551117335, "post_id": 54855375, "comment_id": 96514323, "body": "Well, it&#39;s certainly published in the source code of GHC at the very least..."}], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551034642, "creation_date": 1551034642, "question_id": 54855375, "link": "https://stackoverflow.com/questions/54855375/what-are-the-exact-circumstances-for-common-subexpression-elimination-cse-to-o", "title": "What are the exact circumstances for Common Subexpression Elimination (CSE) to occur in GHC?", "body": "<p>I have found that Haskell is able to perform CSE if some circumstances are met. I was reading this article: <a href=\"https://wiki.haskell.org/GHC_optimisations\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/GHC_optimisations</a>, but I didn't find any specific information and was redirected to GHC's manual, which told me only how to enable it and dump log of this optimizer.</p>\n\n<p>I would like to determine whether my code will be able to perform it or not. Where can I find this kind of documentation? Is it published anywhere?</p>\n"}, {"tags": ["haskell", "infix-notation"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551023996, "post_id": 54851949, "comment_id": 96478979, "body": "Here&#39;s the problem: with something like <code>x y `foo` z</code>, the parser wouldn&#39;t be able to tell if <code>x</code> and <code>y</code> are separate arguments, or if  the result of <code>x y</code> is a single argument, for <code>foo</code>. (Remember, the parser operates before any types are known, which is why you need special syntax to identify something as an infix operator rather than an argument to the preceding function.)"}], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 0, "creation_date": 1551077823, "post_id": 54852263, "comment_id": 96492461, "body": "divide is just an arbitrary function to illustrate the question, I&#39;m only interested in whether it&#39;s possible to have custom infix notations."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 5, "last_activity_date": 1551014177, "creation_date": 1551014177, "answer_id": 54852263, "question_id": 54851949, "link": "https://stackoverflow.com/questions/54851949/haskell-infix-notation-taking-2-arguments-on-the-left/54852263#54852263", "title": "Haskell infix notation taking 2 arguments on the left", "body": "<p>The short answer is that, no, you can't do that as you ask.</p>\n\n<p>As far as I understand it, if you have a function <code>f :: x -&gt; y -&gt; z</code>. then you can write applications of it in either the form</p>\n\n<pre><code>f x0 y0\n</code></pre>\n\n<p>or</p>\n\n<pre><code>x0 `f` y0\n</code></pre>\n\n<p>and they mean exactly the same thing.</p>\n\n<p>In the case of your function <code>sumAndDivideBy :: Double -&gt; Double -&gt; Double -&gt; Double</code>, because of currying that is equivalent to <code>Double -&gt; (Double -&gt; (Double -&gt; Double))</code> if we are being completely explicit. Let me write that in a form intermediate between the two:</p>\n\n<pre><code>sumAndDivideBy :: Double -&gt; Double -&gt; (Double -&gt; Double)\n</code></pre>\n\n<p>This fits exactly the schematic form I gave above, with <code>x</code> and <code>y</code> equal to <code>Double</code> and <code>z</code> to the function type <code>Double -&gt; Double</code>. Which means that you can indeed use <code>sumAndDivideBy</code> in infix form, exactly as you did in the penultimate line of your example. In general you can do this with any function of more than 2 arguments, but the \"infix\" form only works if it goes between the first and second arguments.</p>\n\n<p>Of course, due to currying again, you can realise that <code>sumAndDivideBy 3.0</code> is itself a function <code>Double -&gt; Double -&gt; Double</code>, which you can use in infix form, in exactly the same \"position\" you want it to be in. So you can do this:</p>\n\n<pre><code>sumWithThreeAndDivide = sumAndDivideBy 3.0\nfoo = 5.0 `sumWithThreeAndDivide` 2.0\n</code></pre>\n\n<p>but it does necessitate defining a name for the partially-applied function, which I guess limits the use for the kind of things you're thinking about.</p>\n\n<p>I'm not sure what exactly you're aiming for though, given that your example can be very naturally rendered, with the <code>divide</code> function as you've shown it, as </p>\n\n<pre><code>(3.0 + 5.0) `divide` 2.0\n</code></pre>\n\n<p>Or, of course, since <code>divide</code> is identical to <code>(/)</code>, just doing <code>3.0 + 5.0 / 2.0</code> as I assume you naturally would.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1551024400, "post_id": 54853759, "comment_id": 96479100, "body": "I have a cunning plan: <code>instance Num a =&gt; Num (b -&gt; (a,b))</code> and now <code>3 5</code> is <code>(3,5)</code>... ;-)"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1551037702, "post_id": 54853759, "comment_id": 96483185, "body": "Exactly my plan!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1551024245, "creation_date": 1551024245, "answer_id": 54853759, "question_id": 54851949, "link": "https://stackoverflow.com/questions/54851949/haskell-infix-notation-taking-2-arguments-on-the-left/54853759#54853759", "title": "Haskell infix notation taking 2 arguments on the left", "body": "<p>Why not cheat?</p>\n\n<pre><code>sumAndDivideBy :: (Double, Double) -&gt; Double -&gt; Double\nsumAndDivideBy (x, y) z = (x + y) / z\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; (3,5) `sumAndDivideBy` 2\n4.0\n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 54852263, "answer_count": 2, "score": 1, "last_activity_date": 1551024245, "creation_date": 1551011912, "question_id": 54851949, "link": "https://stackoverflow.com/questions/54851949/haskell-infix-notation-taking-2-arguments-on-the-left", "title": "Haskell infix notation taking 2 arguments on the left", "body": "<p>In Haskell, infix notation allows us to do the following:</p>\n\n<pre><code>divide :: Double -&gt; Double -&gt; Double\ndivide x y = x / y\n\nfoo = divide 10.0 3.0\nbar = 10.0 `divide` 3.0 -- infix\n-- foo and bar are equivalent\n</code></pre>\n\n<p>Is it possible to use/define infix notation that would take 2 arguments on the left?</p>\n\n<pre><code>sumAndDivideBy :: Double -&gt; Double -&gt; Double -&gt; Double\nsumAndDivideBy x y z = (x + y) / z\n\nfoo2 = sumAndDivideBy 3.0 5.0 2.0\nbar2 = 3.0 `sumAndDivideBy` 5.0 $ 2.0 -- works but not what I wan't\nbar3 = 3.0 5.0 `sumAndDivideBy` 2.0   -- does not work - impossible?\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "nix", "nixos"], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": true, "score": 3, "last_activity_date": 1551011414, "creation_date": 1551011414, "answer_id": 54851885, "question_id": 54851748, "link": "https://stackoverflow.com/questions/54851748/linker-errors-when-trying-to-compile-static-executable-with-stack-on-nixos/54851885#54851885", "title": "Linker errors when trying to compile static executable with stack on Nixos", "body": "<p>In this particular case I was able to solve it by adding:</p>\n\n<pre><code>nix:\n  packages:\n      - glibc.static\n      - gmp5.static\n</code></pre>\n\n<p>However, I'm still not sure how I can determine the relationship between these <code>flags</code> (lm, lrt etc) to the actual packages.</p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 54851885, "answer_count": 1, "score": 0, "last_activity_date": 1586377271, "creation_date": 1551010230, "last_edit_date": 1586377271, "question_id": 54851748, "link": "https://stackoverflow.com/questions/54851748/linker-errors-when-trying-to-compile-static-executable-with-stack-on-nixos", "title": "Linker errors when trying to compile static executable with stack on Nixos", "body": "<p>It seems I might need to add some 'packages' to the nix dependencies, though I'm not sure how to determine which packages (besides a tedious web search for each <code>lm</code>,<code>lrt</code>...)?</p>\n\n<pre><code>stack install     \nBuilding all executables for `sodiumSierraStrawberry' once. After a successful build of all of them, only specified executables will be rebuilt.\nsodiumSierraStrawberry-0.1.0.0: configure (exe)\nConfiguring sodiumSierraStrawberry-0.1.0.0...\nsodiumSierraStrawberry-0.1.0.0: build (exe)\nPreprocessing executable 'sodiumSierraStrawberry' for sodiumSierraStrawberry-0.1.0.0..\nBuilding executable 'sodiumSierraStrawberry' for sodiumSierraStrawberry-0.1.0.0..\n[1 of 2] Compiling Paths_sodiumSierraStrawberry ( .stack-work/dist/x86_64-linux-nix/Cabal-2.4.0.1/build/sodiumSierraStrawberry/autogen/Paths_sodiumSierraStrawberry.hs, .stack-work/dist/x86_64-linux-nix/Cabal-2.4.0.1/build/sodiumSierraStrawberry/sodiumSierraStrawberry-tmp/Paths_sodiumSierraStrawberry.o )\n[2 of 2] Compiling Prompt           ( src/Prompt.hs, .stack-work/dist/x86_64-linux-nix/Cabal-2.4.0.1/build/sodiumSierraStrawberry/sodiumSierraStrawberry-tmp/Prompt.o )\nLinking .stack-work/dist/x86_64-linux-nix/Cabal-2.4.0.1/build/sodiumSierraStrawberry/sodiumSierraStrawberry ...\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lm\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lrt\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lutil\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -ldl\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lgmp\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lm\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lrt\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -ldl\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lpthread\n/nix/store/5vyv136pqs75pj0b8vcpdyc03dmn9p0n-binutils-2.30/bin/ld: cannot find -lc\ncollect2: error: ld returned 1 exit status\n`cc' failed in phase `Linker'. (Exit code: 1)\n\n--  While building package sodiumSierraStrawberry-0.1.0.0 using:\n      /home/chris/.stack/setup-exe-cache/x86_64-linux-nix/Cabal-simple_mPHDZzAJ_2.4.0.1_ghc-8.6.3 --builddir=.stack-work/dist/x86_64-linux-nix/Cabal-2.4.0.1 build exe:sodiumSierraStrawberry --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>cabal file:</p>\n\n<pre><code>-- This file has been generated from package.static.yaml by hpack version 0.28.2.\n--\n-- see: https://github.com/sol/hpack\n--\n-- hash: dc5d80120403b39adcd93487e3eb7b084fcc8abb48bc9c23eaaa9dbc7c48cb06\n\ncabal-version:  &gt;= 1.10\nname:           sodiumSierraStrawberry\nversion:        0.1.0.0\nauthor:         Chris Stryczynski\nmaintainer:     Chris Stryczynski\nlicense:        BSD3\nlicense-file:   LICENSE\nbuild-type:     Simple\nextra-source-files:\n    ChangeLog.md\n\nexecutable sodiumSierraStrawberry\n  main-is: Prompt.hs\n  other-modules:\n      Paths_sodiumSierraStrawberry\n  hs-source-dirs:\n      src\n  default-extensions: LambdaCase\n  ghc-options: -Wall -O2 -static -threaded -main-is Prompt\n  cc-options: -static\n  ld-options: -static -pthread\n  build-depends:\n      MissingH\n    , aeson\n    , base\n    , bytestring\n    , directory\n    , filepath\n    , optparse-applicative\n    , pretty-simple\n    , safe\n    , split\n    , stm\n    , string-conversions\n    , text\n    , thyme\n    , time\n  default-language: Haskell2010\n</code></pre>\n"}, {"tags": ["haskell", "optimization", "compiler-optimization"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 4, "creation_date": 1551005835, "post_id": 54851144, "comment_id": 96474344, "body": "Yes, the second one computes the sum twice"}], "answers": [{"comments": [{"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 3, "creation_date": 1551032314, "post_id": 54851526, "comment_id": 96481530, "body": "I\u2019m not sure it\u2019s computed twice.  Doing CSE would compute it just once, or even just using cheap strictness (which ghc does)."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1551033230, "post_id": 54851526, "comment_id": 96481803, "body": "I could not find any information when exactly is CSE performed"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1551035430, "post_id": 54851526, "comment_id": 96482506, "body": "Ghc does very little CSE, but it does use cheap strictness.  Comparing the core for the two functions is the way to find out."}], "tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": true, "score": 7, "last_activity_date": 1551040454, "last_edit_date": 1551040454, "creation_date": 1551008569, "answer_id": 54851526, "question_id": 54851144, "link": "https://stackoverflow.com/questions/54851144/will-let-construction-optimize-something-in-list-comprehension/54851526#54851526", "title": "Will let construction optimize something in list comprehension?", "body": "<p>The second function will compute the sum twice \u2013 there is no explicit sharing to be performed here, nor the Haskell performs memoization (source: <a href=\"https://stackoverflow.com/questions/3951012/when-is-memoization-automatic-in-ghc-haskell\">When is memoization automatic in GHC Haskell?</a>)</p>\n\n<p><code>let</code> lets the sum be computed once and used in several places, so the first function will be <em>slightly</em> faster.</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Someone in the comments mentioned CSE (common subexpression elimination) as possible optimization that may occur here. I have tried compiling your function with <code>-ddump-cse</code> to discover whether it will happen, but although I didn't find any mentions of <code>normalSum</code>, the output was too mysterious to me. However, my answer should be true if you build your function without <code>-O*</code> flag. I will update my answer if I find more information about it.</p>\n"}], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54851526, "answer_count": 1, "score": 1, "last_activity_date": 1551040454, "creation_date": 1551005671, "last_edit_date": 1551014326, "question_id": 54851144, "link": "https://stackoverflow.com/questions/54851144/will-let-construction-optimize-something-in-list-comprehension", "title": "Will let construction optimize something in list comprehension?", "body": "<p>I should write a function that sums elements in a list comprehension block. </p>\n\n<p>Let's take these two functions just for example:</p>\n\n<pre><code>letSum :: [Int] -&gt; [Int]\nletSum xs = [result | x &lt;- xs, y &lt;- xs, let result = x + y, result &gt; 10]\n\nnormalSum  :: [Int] -&gt; [Int]\nnormalSum xs = [x + y | x &lt;- xs, y &lt;- xs, x + y &gt; 10]\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<ul>\n<li>Is the second function summing x and y twice in opposite to the first one?</li>\n<li>If not, how does it work?</li>\n</ul>\n"}, {"tags": ["haskell", "monads", "type-mismatch", "continuations", "do-notation"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1550986994, "post_id": 54849064, "comment_id": 96470556, "body": "<code>return a + b</code> is parsed as <code>(return a) + b</code>. Try <code>return (a + b)</code> or <code>return $ a + b</code> instead."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1550987198, "post_id": 54849064, "comment_id": 96470592, "body": "i knew it had to be something simple :D"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1550998261, "post_id": 54849064, "comment_id": 96472608, "body": "I <i>highly</i> recommend putting type signatures for (at least) all top-level functions and bindings. It often makes the type error messages <i>significantly</i> easier to understand. Here I would recommend a type signature for the function in the <code>where</code> block as well. It also makes the code easier (and faster) to read."}], "answers": [{"comments": [{"owner": {"reputation": 6430, "user_id": 812053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/005db5b7c457d0cdea627e5b48e7f59f?s=128&d=identicon&r=PG", "display_name": "Ben Millwood", "link": "https://stackoverflow.com/users/812053/ben-millwood"}, "edited": false, "score": 1, "creation_date": 1550997413, "post_id": 54849104, "comment_id": 96472453, "body": "why are people upvoting my answer it is boring"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1551018821, "post_id": 54849104, "comment_id": 96477548, "body": "Why did you post the answer in the first place?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1551018906, "post_id": 54849104, "comment_id": 96477584, "body": "If a question has a trivial solution that can be answered fully in a comment, I just vote to close as &quot;can no longer be reproduced&quot;."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1551037432, "post_id": 54849104, "comment_id": 96483107, "body": "I originally deleted the question, but then saw people already started up-voting this answer. If this answer was useful to others, I didn&#39;t want to take away the potential of future readers benefiting as well, so I undeleted it. My apologies if the question was too basic."}], "tags": [], "owner": {"reputation": 6430, "user_id": 812053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/005db5b7c457d0cdea627e5b48e7f59f?s=128&d=identicon&r=PG", "display_name": "Ben Millwood", "link": "https://stackoverflow.com/users/812053/ben-millwood"}, "is_accepted": true, "score": 6, "last_activity_date": 1550986960, "creation_date": 1550986960, "answer_id": 54849104, "question_id": 54849064, "link": "https://stackoverflow.com/questions/54849064/how-to-use-control-monad-cont-in-a-recursive-function/54849104#54849104", "title": "How to use Control.Monad.Cont in a recursive function?", "body": "<p><code>return a + b</code> parses as <code>(return a) + b</code>, whereas you wanted <code>return (a + b)</code>. Remember that function application binds tighter than any infix operator.</p>\n\n<p>(It's also common to write <code>return $ a + b</code>, which amounts to the same thing)</p>\n"}], "owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 54849104, "answer_count": 1, "score": 2, "last_activity_date": 1551028545, "creation_date": 1550986469, "last_edit_date": 1551028545, "question_id": 54849064, "link": "https://stackoverflow.com/questions/54849064/how-to-use-control-monad-cont-in-a-recursive-function", "title": "How to use Control.Monad.Cont in a recursive function?", "body": "<p>I was providing an answer to <a href=\"https://stackoverflow.com/q/54843670/633183\">this question</a> and an idea came to me to use <code>Cont</code> monad. I don't know Haskell enough to explain why this program doesn't work</p>\n\n<pre><code>import Control.Monad.Cont\n\nfib1 n = runCont (slow n) id\n  where\n    slow 0 = return 0\n    slow 1 = return 1\n    slow n = do\n      a &lt;- slow (n - 1)\n      b &lt;- slow (n - 2)\n      return a + b\n\nmain = do\n  putStrLn $ show $ fib1 10\n</code></pre>\n\n<p>Error -</p>\n\n<pre><code>main.hs:10:18: error:\n    \u2022 Occurs check: cannot construct the infinite type: a2 ~ m a2\n    \u2022 In the second argument of \u2018(+)\u2019, namely \u2018b\u2019\n      In a stmt of a 'do' block: return a + b\n      In the expression:\n        do a &lt;- slow (n - 1)\n           b &lt;- slow (n - 2)\n           return a + b\n    \u2022 Relevant bindings include\n        b :: a2 (bound at main.hs:9:7)\n        a :: a2 (bound at main.hs:8:7)\n        slow :: a1 -&gt; m a2 (bound at main.hs:5:5)\n   |\n10 |       return a + b\n   |   \n</code></pre>\n\n<p>But this doesn't make sense to me. Why do I have <code>a2</code> and <code>m a2</code>? I'm expecting <code>a</code> and <code>b</code> to be of the same type.</p>\n\n<p>It's bugging me because the same program works just fine in JavaScript. Maybe the Haskell one needs a type hint?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const runCont = m =&gt; k =&gt;\r\n  m (k)\r\n\r\nconst _return = x =&gt;\r\n  k =&gt; k (x)\r\n  \r\nconst slow = n =&gt;\r\n  n &lt; 2\r\n    ? _return (n)\r\n    : slow (n - 1) (a =&gt;\r\n      slow (n - 2) (b =&gt;\r\n      _return (a + b)))\r\n      \r\nconst fib = n =&gt;\r\n  runCont (slow(n)) (console.log)\r\n  \r\nfib (10) // 55</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8370684"}, "edited": false, "score": 0, "creation_date": 1550981678, "post_id": 54848595, "comment_id": 96469733, "body": "Thanks. But, to be sure, that isn&#39;t in the Aeson documentation. It is in a separate Aeson tutorial. I did not find this before posting the question."}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1550982757, "post_id": 54848595, "comment_id": 96469890, "body": "Sorry, I thought it was - found it by searching for &quot;aeson&quot;."}], "tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": true, "score": 2, "last_activity_date": 1550983152, "last_edit_date": 1550983152, "creation_date": 1550980683, "answer_id": 54848595, "question_id": 54848560, "link": "https://stackoverflow.com/questions/54848560/how-to-use-aeson-to-get-a-vector-of-strings-inside-a-deep-json-object/54848595#54848595", "title": "How to use Aeson to get a vector of strings inside a deep JSON object?", "body": "<p>It appears that there is an Aeson tutorial documenting exactly this problem: <a href=\"https://artyom.me/aeson#parsing-without-creating-extra-types\" rel=\"nofollow noreferrer\">Parsing without creating extra types</a></p>\n\n<p>In your case, <code>data</code> has arrays of arrays, so I'm not sure if you want a <code>Vector (Vector Text)</code> or flatten all of it into one array, but adapting from the documentation:</p>\n\n<pre><code>justData :: Value -&gt; Parser (Vector (Vector Text))\njustData = withObject \"structure with data\" $ \\o -&gt; o .: \"data\"\n\njustDataFlat :: Value -&gt; Parser (Vector Text)\njustDataFlat value = fmap join (justData value)\n</code></pre>\n\n<p>Also note that if your structure is deeper, like this:</p>\n\n<pre><code>{\n    \"data\": {\n        \"deep\": [\n            \"data\",\n            \"more data\"\n        ]\n    }\n}\n</code></pre>\n\n<p>you can use <code>.:</code> more than once:</p>\n\n<pre><code>deeperData :: Value -&gt; Parser (Vector Text)\ndeeperData = withObject \"structure with deeper data\" $ \\o -&gt;\n    step1 &lt;- o .: \"data\"\n    step1 .: \"deep\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8370684"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 54848595, "answer_count": 1, "score": 1, "last_activity_date": 1550983152, "creation_date": 1550980200, "question_id": 54848560, "link": "https://stackoverflow.com/questions/54848560/how-to-use-aeson-to-get-a-vector-of-strings-inside-a-deep-json-object", "title": "How to use Aeson to get a vector of strings inside a deep JSON object?", "body": "<p>Let's say I want to use <a href=\"http://hackage.haskell.org/package/aeson\" rel=\"nofollow noreferrer\">Aeson</a> to parse the following JSON object:</p>\n\n<pre><code>{\n    \"data\": [\n        [ \n            \"data\",\n            \"more data\"\n        ],\n        [ \n            \"data\",\n            \"more data\"\n        ]\n    ],\n    \"error\": {\n        \"code\": \"\"\n    }\n}\n</code></pre>\n\n<p>I can create the records for the JSON objects, then create the instances to parse the pieces out like the documentation describes. But, I'm really only interested in the <code>Vector Text</code> that's inside <code>data</code>. Is there a more direct way to get at this than creating the records? It's not obvious how to create the <code>Parser</code> that gets me this directly.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 10, "creation_date": 1550953137, "post_id": 54845781, "comment_id": 96464519, "body": "<code>((((((sum . take 2) .) . sort) .) .) .) . (. ((. ((. return) . (:))) . (.) . (:))) . (.) . (.) . (:)</code> but why would you ever want that?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 5, "creation_date": 1550953462, "post_id": 54845781, "comment_id": 96464599, "body": "<code>sum . take 2 . sort $ [a, b, c, d]</code> is easier on the eyes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10661584"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1550953470, "post_id": 54845781, "comment_id": 96464602, "body": "@n.m going through <a href=\"http://www21.in.tum.de/teaching/info2/WS1314/wettbewerb.html\" rel=\"nofollow noreferrer\">the course materials from TUM</a> and see that people need to minimize the tokens to win the in-lecture competition. So I am thinking about tricks to drop the arguments and found point-free style."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 5, "creation_date": 1550954676, "post_id": 54845781, "comment_id": 96464904, "body": "Note that <code>[a, b, c, d]</code> is just syntactic sugar for <code>(:) a ((:) b ((:) c ((:) d [])))</code>. Pointfree notation doesn&#39;t get the benefit of sugar, so you&#39;re already off to a really bad start."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 2, "last_activity_date": 1551000329, "last_edit_date": 1551000329, "creation_date": 1550970939, "answer_id": 54847858, "question_id": 54845781, "link": "https://stackoverflow.com/questions/54845781/pointfree-functions-in-haskell-turning-arguments-into-a-list/54847858#54847858", "title": "Pointfree functions in Haskell - turning arguments into a list", "body": "<p>Someone in the comments mentioned awesome </p>\n\n<pre><code>((((((sum . take 2) .) . sort) .) .) .) . (. ((. ((. return) . (:))) . (.) . (:))) . (.) . (.) . (:)\n</code></pre>\n\n<p>function. </p>\n\n<p>According to <a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">http://pointfree.io</a> </p>\n\n<pre><code>((((sum . take 2 . sort) .) .) .) . (. ((. ((. return) . (:))) . (.) . (:))) . (.) . (.) . (:)\n</code></pre>\n\n<p>will be correct as well.</p>\n\n<p>Don't you believe me?</p>\n\n<p><strong>OKAY</strong></p>\n\n<p>Let's beta-reduct the second option (it looks nicer imo)</p>\n\n<pre><code>(((((sum . take 2 . sort) .) .) .) . (. ((. ((. return) . (:))) . (.) . (:))) . (.) . (.) . (:) ) a b c d\n</code></pre>\n\n<p>Apply it to <code>a</code>:</p>\n\n<pre><code>((((((sum . take 2 . sort) .) .) .) ((. ((. ((. return) . (:))) . (.) . (:))) ((.) ((.) ((:) a))))) ) b c d\n</code></pre>\n\n<p>Ensugar operators:</p>\n\n<pre><code>((((((sum . take 2 . sort) .) .) .) ((. ((. ((. return) . (:))) . (.) . (:))) (((a:).).))) ) b c d\n</code></pre>\n\n<p>Apply partially applied composition:</p>\n\n<pre><code>((((sum . take 2 . sort) .) .) . ((. ((. ((. return) . (:))) . (.) . (:))) (((a:).).))) b c d\n</code></pre>\n\n<p>Apply it to <code>b</code>:</p>\n\n<pre><code>((((sum . take 2 . sort) .) .) (((. ((. ((. return) . (:))) . (.) . (:))) (((a:).).)) b)) c d\n</code></pre>\n\n<p>Compute function that will be applied to <code>b</code> by applying partially applied <code>.</code>:</p>\n\n<pre><code>((((sum . take 2 . sort) .) .) ( (((a:).).) . ((. ((. return) . (:))) . (.) . (:)) $ b)) c d)\n</code></pre>\n\n<p>Resolve composition:</p>\n\n<pre><code>((((sum . take 2 . sort) .) .) ( (((a:).).) (((. ((. return) . (:))) . (.) . (:)) b))) c d\n</code></pre>\n\n<p>Apply to <code>b</code>:</p>\n\n<pre><code>((((sum . take 2 . sort) .) .) ( (((a:).).) ((. ((. return) . (:))) ((b:) .)))) c d\n</code></pre>\n\n<p>Apply composition (2x):</p>\n\n<pre><code>(((sum . take 2 . sort) .) . ((((a:).).) (( ((b:) .) . ((. return) . (:)))))) c d\n</code></pre>\n\n<p>Apply to <code>c</code> and resolve composition:</p>\n\n<pre><code>((sum . take 2 . sort) .) (((((a:).).) (( ((b:) .) . ((. return) . (:))))) c) d\n</code></pre>\n\n<p>Apply partially applied composition:</p>\n\n<pre><code>((sum . take 2 . sort) .) (((((a:).) . (( ((b:) .) . ((. return) . (:)))))) c) d\n</code></pre>\n\n<p>Apply to <code>c</code> and resolve composition:</p>\n\n<pre><code>((sum . take 2 . sort) .) (((a:).) ((( ((b:) .) . ((. return) . (:)))) c)) d\n</code></pre>\n\n<p>Apply to <code>c</code> and resolve composition:</p>\n\n<pre><code>((sum . take 2 . sort) .) (((a:).) (((b:) .) (((. return) . (:)) c))) d\n</code></pre>\n\n<p>Resolve composition:</p>\n\n<pre><code>((sum . take 2 . sort) .) ((a:) . (((b:) .) (((. return) . (:)) c))) d\n</code></pre>\n\n<p>Apply partially applied composition:</p>\n\n<pre><code>((sum . take 2 . sort) . ((a:) . (((b:) .) (((. return) . (:)) c)))) d\n</code></pre>\n\n<p>Resolve composition:</p>\n\n<pre><code>(sum . take 2 . sort) (((a:) . (((b:) .) (((. return) . (:)) c))) d)\n</code></pre>\n\n<p>Apply to <code>d</code> and resolve composition:</p>\n\n<pre><code>(sum . take 2 . sort) ((a:) ((((b:) .) (((. return) . (:)) c)) d))\n</code></pre>\n\n<p>Apply partially applied composition:</p>\n\n<pre><code>(sum . take 2 . sort) ((a:) (((b:) . (((. return) . (:)) c)) d))\n</code></pre>\n\n<p>Apply to <code>d</code> and resolve composition:</p>\n\n<pre><code>(sum . take 2 . sort) ((a:) (((b:) ((((. return) . (:)) c) d))))\n</code></pre>\n\n<p>Apply to <code>c</code> and resolve composition:</p>\n\n<pre><code>(sum . take 2 . sort) ((a:) (((b:) (((((c:). return))) d))))\n</code></pre>\n\n<p>Apply to <code>d</code> and resolve composition:</p>\n\n<pre><code>(sum . take 2 . sort) ((a:) ((b:) ((c:) (return d))))\n</code></pre>\n\n<p>Transform to infix operators and resolve <code>return</code></p>\n\n<pre><code>(sum . take 2 . sort) (a : (b : (c : (d : []))))\n</code></pre>\n\n<p>Ensugar</p>\n\n<pre><code>(sum . take 2 . sort) [a, b, c, d]\n</code></pre>\n\n<p>Resolve compositions and use <code>$</code> operator</p>\n\n<pre><code>sum $ take 2 $ sort $ [a, b, c, d]\n</code></pre>\n\n<p>And hell we are!\nIt will be easier to read if you paste it to editor with rainbow brackets.</p>\n\n<hr>\n\n<p>As you see not everything will look more elegant in pointfree form. Sometimes it is very non trivial and it may be very confusing to understand not only <em>why</em> does the function work, but <em>what</em> does it even do. Note that this function is length-specific \u2013 it will grow much larger if you try to create bigger lists this way.</p>\n\n<p>On the other hand I often use <a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">http://pointfree.io</a> to check if my chain of functions can be expressed in a simpler way. They key is to find the golden mean \u2013 in some cases this form can help, but sometimes it turns to be not only \"point-free\", but also \"point-less\" notation.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1551154358, "last_edit_date": 1551154358, "creation_date": 1551154003, "answer_id": 54878303, "question_id": 54845781, "link": "https://stackoverflow.com/questions/54845781/pointfree-functions-in-haskell-turning-arguments-into-a-list/54878303#54878303", "title": "Pointfree functions in Haskell - turning arguments into a list", "body": "<p>If I wanted to write this pointfree in real code, I\u2019d just factor out the construction of the list:</p>\n\n<pre><code>list4 a b c d = [a, b, c, d]\nunder3 = fmap . fmap . fmap\nfunc = under3 (sum . take 2 . sort) . list4\n\nfunc 30 4 1000 200 == 34\n</code></pre>\n\n<p><code>under3</code> \u201cskips\u201d 3 arguments using <code>fmap</code> in the <code>(-&gt;) a</code> functor so we can compose a 1-argument function (<code>sum . take2 . sort</code>) with a 4-argument one (<code>list4</code>)\u2014this use of <code>fmap</code> is exactly equivalent to composition <code>(.)</code>, just a bit more readable than inlining it, since mnemonically it\u2019s \u201cmapping over\u201d arguments:</p>\n\n<pre><code>func = ((((sum . take 2 . sort) .) .) .) . list4\n  where\n    \u2026\n</code></pre>\n\n<p><code>list4</code> itself doesn\u2019t really need to be pointfree, since there\u2019s no straightforward way to make it more readable &amp; succinct than the pointful version. You can write it pointfree a little more readably if you\u2019re willing to build the list in reverse and <code>reverse</code> it afterward, but it\u2019s still a bit long and not very clear:</p>\n\n<pre><code>list4 = under3 reverse . fmap (fmap cons . cons) . cons . pure\n  where cons = flip (:)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10661584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1551154358, "creation_date": 1550952917, "last_edit_date": 1550953205, "question_id": 54845781, "link": "https://stackoverflow.com/questions/54845781/pointfree-functions-in-haskell-turning-arguments-into-a-list", "title": "Pointfree functions in Haskell - turning arguments into a list", "body": "<p>I am looking at some functions in Haskell in point-free style. While trying to rewrite some easy examples, I got stuck at this one</p>\n\n<p><code>func a b c d = sum $ take 2 $ sort [a, b, c, d]</code></p>\n\n<p>How to turn the arguments into a list form so that I don't need to write <code>a b c</code> on the left handside?</p>\n"}, {"tags": ["haskell", "ghcjs", "reflex-dom", "ghcjs-dom", "ui5-webcomponents"], "comments": [{"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1551107479, "post_id": 54844778, "comment_id": 96508834, "body": "What&#39;s &#39;liveChange&#39;? For Reflex.Dom.Widget.Input.TextInput areas, the textInput_input field is an event which fires on changes to the text area input. Is this what like you are looking for?"}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1551107717, "post_id": 54844778, "comment_id": 96508999, "body": "Also, as you probably know, Widget.Dom.Builder.Class.Events lists many types of events covered by reflex. If the events you are looking for are not handled there, im not sure I could help you. But if you add a little more detail to this question you might have better chances."}, {"owner": {"reputation": 31, "user_id": 10847118, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_6aWpbT75nQ/AAAAAAAAAAI/AAAAAAAABYw/0j0lDW43kDY/photo.jpg?sz=128", "display_name": "Markus Kupke", "link": "https://stackoverflow.com/users/10847118/markus-kupke"}, "reply_to_user": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1551120501, "post_id": 54844778, "comment_id": 96515738, "body": "I refer to the Web Components to be found here: <a href=\"https://github.com/SAP/ui5-webcomponents\" rel=\"nofollow noreferrer\">https://github.com/SAP/ui5-webcomponents</a> There are several of examples for events of these components that cannot be found in Widget.Dom.Builder.Class.Events. I try to find a way to transform these into Reflex events."}, {"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1551126061, "post_id": 54844778, "comment_id": 96518090, "body": "Markus, thats still a bit general. After a few clicks from that page I can find the API documentation, with a lot of components that have reflex corollaries. For instance TextArea has a &quot;change&quot; event listener and reflex has a change event--which is why i mentioned the reflex TextArea event. I couldn&#39;t find any &quot;liveChange&quot;. Also, in that API, button only has the &quot;Press&quot; event, which may be why &quot;Click&quot; works but other events don&#39;t. Have you tried &quot;Change&quot; with ui5-textarea? But again, without a specific example of something which doesn&#39;t work its hard for anybody to supply a solution."}, {"owner": {"reputation": 31, "user_id": 10847118, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_6aWpbT75nQ/AAAAAAAAAAI/AAAAAAAABYw/0j0lDW43kDY/photo.jpg?sz=128", "display_name": "Markus Kupke", "link": "https://stackoverflow.com/users/10847118/markus-kupke"}, "reply_to_user": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 0, "creation_date": 1551173037, "post_id": 54844778, "comment_id": 96533387, "body": "Trevor, maybe I&#39;m too ambitious. You are right. The events that map are completely sufficient for the PoC I&#39;m doing. I was just wondering if I was interested in some specific event in the WebComponents lib like liveChange in (<a href=\"https://sap.github.io/ui5-webcomponents/playground.html#/components/Input\" rel=\"nofollow noreferrer\">sap.github.io/ui5-webcomponents/playground.html#/components&zwnj;&#8203;/&hellip;</a>) how I can include them as well."}], "owner": {"reputation": 31, "user_id": 10847118, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_6aWpbT75nQ/AAAAAAAAAAI/AAAAAAAABYw/0j0lDW43kDY/photo.jpg?sz=128", "display_name": "Markus Kupke", "link": "https://stackoverflow.com/users/10847118/markus-kupke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1612309826, "creation_date": 1550946719, "last_edit_date": 1612309826, "question_id": 54844778, "link": "https://stackoverflow.com/questions/54844778/using-web-component-html-tags-with-reflex", "title": "Using Web Component HTML tags with reflex", "body": "<p>I try to use Web Components in Reflex. Code is as such:</p>\n\n<pre><code>buttonUI5 :: DomBuilder t m =&gt; T.Text -&gt; m (Event t ())\nbuttonUI5 t = do\n  (e, _) &lt;- element \"ui5-button\" def $ text t\n  return $ domEvent Click e\n</code></pre>\n\n<p>For ui5-button it worked as expected. Other Web Components fire events not defined in Reflex.Dom.Widget.Basic like \"liveChange\".</p>\n\n<p>How can I translate these into Reflex Events?</p>\n"}, {"tags": ["haskell", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 1, "creation_date": 1550939767, "post_id": 54843670, "comment_id": 96460536, "body": "It&#39;s tail-recursive, which the first is not. You don&#39;t have to keep all the stack frames."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 13, "creation_date": 1550939833, "post_id": 54843670, "comment_id": 96460556, "body": "The first one uses recursion, and branches exponentially (since nearly every call results in two extra calls). The latter is linear, since each call results in at most one call (well the base case of course stops recursion). So this is <i>O(n)</i> versus <i>O(2^n)</i>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 10, "creation_date": 1550939876, "post_id": 54843670, "comment_id": 96460571, "body": "@JaredSmith: although tail recursion indeed can contribute something, there is a difference in time complexity between the two, which is the major reason why the performance differs."}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1550939977, "post_id": 54843670, "comment_id": 96460594, "body": "@WillemVanOnsem of course, you are correct. I guess you could cut a lot of the difference with memoization, since you don&#39;t have to pay nearly as much for every double call on the recursion."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6435535"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1550940037, "post_id": 54843670, "comment_id": 96460610, "body": "@WillemVanOnsem: What is the reasoning path to reach this kind of implementations? Why Haskell does not optimize the first one to the second? (links are appreciated)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 7, "creation_date": 1550940358, "post_id": 54843670, "comment_id": 96460700, "body": "Haskell is a language. It lets you expeess algoritms. It doesn&#39;t imorove them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6435535"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1550940825, "post_id": 54843670, "comment_id": 96460829, "body": "@n.m. I thought FP is about declarative programming and not to worry about language internals. The fast implementation of Fibonacci is against this. It seems theoretically an FP language should be able to handle such optimizations. Am I wrong on my assumptions?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1550943718, "post_id": 54843670, "comment_id": 96461709, "body": "@RemisaYousefvand I think, you&#39;ll want to read about superoptimization."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1550943885, "post_id": 54843670, "comment_id": 96461758, "body": "@RemisaYousefvand An implementation <i>could</i> cache the return value of every function call (it&#39;s theoretically valid), but the overhead of doing so in practice is prohibitive. Now you&#39;re asking the compiler to decide <i>which</i> functions should be memoized, and that&#39;s not something that&#39;s easier to specify or determine."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 6, "creation_date": 1550943939, "post_id": 54843670, "comment_id": 96461778, "body": "The second one <i>isn&#39;t</i> optimized; it simply doesn&#39;t need optimization in the first place. Its complexity is linear, not exponential."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1550944969, "post_id": 54843670, "comment_id": 96462147, "body": "Yes you are wrong on your assumptions."}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1550945513, "post_id": 54843670, "comment_id": 96462319, "body": "What is the source for the second version? Is it even correct? <code>fib 2 = fastFib 1 1 2 = fastFib (1+1) 1 (2-1) = fastFib _ _ 1 = 1</code>, but shouldn&#39;t it be 2?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550945691, "post_id": 54843670, "comment_id": 96462371, "body": "The second one also has more base cases than it really needs. <code>fastFib a b c | c == 0 | c == 1 = c; | otherwise = fastFib (a + b) a (c - 1)</code>."}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 1, "creation_date": 1550946012, "post_id": 54843670, "comment_id": 96462456, "body": "Oh, I see, only according to the first version <code>fib 2 = 2</code>, but actually this is wrong. In the first version, <code>fib 0 = 1</code> should be <code>fib 0 = 0</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550950481, "post_id": 54843670, "comment_id": 96463771, "body": "re: magic, I invite you to peruse <a href=\"https://stackoverflow.com/search?q=user%3A849891+magician\">my two answers</a> on the matter (mostly, the <a href=\"https://stackoverflow.com/a/19951540/849891\">second one</a>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6435535"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550952619, "post_id": 54843670, "comment_id": 96464374, "body": "@WillNess: <a href=\"https://stackoverflow.com/questions/46612470/could-i-ask-for-physical-analogies-or-metaphors-for-recursion/46613542#46613542\">Great analogy</a>. So tail optimization is to not report back to your copy (via an accumulator)?"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1550952749, "post_id": 54843670, "comment_id": 96464410, "body": "Simpler <code>ffb n a = a:ffb (n + a) (n + 1)</code> -- then <code>take 50 $ 1:ffb 1 1</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1550952843, "post_id": 54843670, "comment_id": 96464438, "body": "forget about TR for a moment. :) ---- but yes, TR is: A creates B; then all that&#39;s left for A to do is to wait for B&#39;s report and return that verbatim, exactly as is; if so, there&#39;s no need for A&#39;s existence anymore: B can directly report its findings to whomever waited for A to report! but leave it be for a moment; it&#39;s orthogonal to what you&#39;re asking about, here."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1550953028, "post_id": 54843670, "comment_id": 96464489, "body": "@fp_mora please don&#39;t confuse the asker with the different POV; let them work out what they started here. (and your code is wrong)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550953221, "post_id": 54843670, "comment_id": 96464543, "body": "@RemisaYousefvand (replace TR in my comment with TCO, i.e. &quot;tail call optimization&quot;)."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1551067000, "post_id": 54843670, "comment_id": 96489580, "body": "The two additions in my function work but don&#39;t produce the first two ones. Reduce it to one addition and both ones are produced. <code>fbf l f = l:fbf f (l + f)</code> and ` take 20 $ fbf 1 1`"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6435535"}, "edited": false, "score": 0, "creation_date": 1550953741, "post_id": 54845709, "comment_id": 96464666, "body": "I&#39;m trying to understand your answer so I need some time. Thanks."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1550954446, "last_edit_date": 1550954446, "creation_date": 1550952465, "answer_id": 54845709, "question_id": 54843670, "link": "https://stackoverflow.com/questions/54843670/why-this-implementation-of-fibonacci-is-extremely-fast/54845709#54845709", "title": "Why this implementation of Fibonacci is extremely fast?", "body": "<p>The magic is reflection, reification, explication of computational process described by the recursive formula:</p>\n\n<pre><code>fib 0 = 0    -- NB!\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n      --  n1          n2\n      = let {n1 = fib (n-1) ; n2 = fib (n-2)} \n        in n1 + n2\n      = let {n1 = fib (n-2) + fib (n-3) ; n2 = fib (n-2)} \n      --            n2          n3\n        in n1 + n2\n      = let {n1 = n2+n3 ; n2 = fib (n-2) ; n3 = fib (n-3)} \n        in n1 + n2\n      = let {n1 = n2+n3 ; n2 = fib (n-3) + fib (n-4) ; n3 = fib (n-3)} \n      --                         n3          n4\n        in n1 + n2\n      = let {n1 = n2+n3 ; n2 = n3+n4 ; n3 = fib (n-3) ; n4 = fib (n-4)} \n        in n1 + n2\n      = let {n1 = n2+n3 ; n2 = n3+n4 ; n3 = n4+n5 ; n4 = fib (n-4) ; n5 = fib (n-5)} \n        in n1 + n2\n      = .......\n</code></pre>\n\n<p>, seeing it through to the end case(s), then <em>flipping the time arrow</em> (or just reading it from right to left), and coding <em>explicitly</em> what's been implicitly going on inside the <code>let</code> as part of the recursion's simulated <em>\"call stack\"</em> operations.</p>\n\n<p>Most importantly, replacing equals by equals, aka referential transparency -- using <code>n2</code> in place of <em>each</em> appearance of <code>fib (n-2)</code>, etc.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1550966800, "post_id": 54847122, "comment_id": 96467473, "body": "re Fastest Fibonacci, cf. <a href=\"https://stackoverflow.com/a/48171368/849891\">this answer</a>"}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 4, "last_activity_date": 1550965456, "last_edit_date": 1550965456, "creation_date": 1550962908, "answer_id": 54847122, "question_id": 54843670, "link": "https://stackoverflow.com/questions/54843670/why-this-implementation-of-fibonacci-is-extremely-fast/54847122#54847122", "title": "Why this implementation of Fibonacci is extremely fast?", "body": "<h2>Why is the first implementation slow?</h2>\n\n<p>Well it\u2019s slow because each call to <code>fib</code> may result in up to two (the average is more like 1.6) calls to <code>fib</code>, so to compute <code>fib 5</code> you call <code>fib 4</code> and <code>fib 3</code> which respectively call <code>fib 3</code> and <code>fib 2</code>, and <code>fib 2</code> and <code>fib 1</code>, so we can see that each call to <code>fib (n+1)</code> results in something like twice as much work as calling <code>fib n</code>.</p>\n\n<p>One thing we might observe is that we work out the same thing lots of times, e.g. above we work out <code>fib 3</code> twice. That could take a long time if you had to work out e.g. <code>fib 100</code> twice.</p>\n\n<h2>How to do fib faster?</h2>\n\n<p>I think it\u2019s better to start with this than trying to jump straight into <code>fastFib</code>. If I asked you to compute the tenth Fibonacci number by hand, I expect you wouldn\u2019t be computing the third one dozens of times by applying the algorithm. You would probably remember what you had so far. Indeed one could do that for this in Haskell. Just write a program to generate the list of Fibonacci numbers (lazily) and index into it:</p>\n\n<pre><code>mediumFib = (\\n -&gt; seq !! n) where\n  seq = 0:1:[mediumFib (i-1) + mediumFib (i-2)| i &lt;- [2..]]\n</code></pre>\n\n<p>This is much faster but it is bad because it is using a lot of memory to store the list of Fibonacci numbers, and it is slow to find the nth element of a list because you have to follow a lot of pointers.</p>\n\n<p>To compute a single Fibonacci number from scratch (ie not having any computed already) takes quadratic time.</p>\n\n<p>Another way you might compute the tenth Fibonacci number by hand is by writing down the Fibonacci sequence until you get to the tenth element. You then never need to look far in the past or remember all the things you previously computed, you just need to look at the two previous elements. One can imagine an imperative algorithm to do this</p>\n\n<pre><code>fib(n):\n  if (n&lt;2) return n\n  preprevious = 0\n  previous = 1\n  i = 2\n  while true:\n    current = preprevious + previous\n    if (i = n) return current\n    preprevious, previous = previous, current\n</code></pre>\n\n<p>This is just stepping through the recurrence relation:</p>\n\n<pre><code>f_n = f_(n-2) + f_(n-1)\n</code></pre>\n\n<p>Indeed we can write it in Haskell too:</p>\n\n<pre><code>fastFib n | n &lt; 2     = n\n          | otherwise = go 0 1 2 where\n  go pp p i | i = n     = pp + p\n            | otherwise = go p (pp + p) (i + 1)\n</code></pre>\n\n<p>This is pretty fast now and we can transform this into the function you have too. Here are the steps:</p>\n\n<ol>\n<li>Swap the argument order of <code>pp</code> (preprevious) and <code>p</code> (previous)</li>\n<li>Instead of counting <code>i</code> up, start at <code>n</code> and count down.</li>\n<li>Extract <code>go</code> into a top level function because it no longer depends on <code>n</code>.</li>\n</ol>\n\n<p>This algorithm only needs to do one sum in each step so it is linear time and that\u2019s pretty fast. To compute <code>fib (n+1)</code> is only a small constant more work than computing <code>fib n</code>. Compare this to above where it was about 1.6 times as much work.</p>\n\n<h2>Is there a faster <code>fib</code>?</h2>\n\n<p>Sure there is. It turns out there\u2019s a clever way to express the Fibonacci sequence. We consider the transformation <code>a,b -&gt; a+b,a</code> to be a special case of a family of transformations <code>T_pq</code>:</p>\n\n<pre><code>T_pq : a -&gt; bq + aq + ap\n       b -&gt; bp + aq\n</code></pre>\n\n<p>Specifically it is the special case where <code>p = 0</code> and <code>q = 1</code>. We now can do some algebra to work out if there is a simple way to express applying <code>T_pq</code> twice:</p>\n\n<pre><code>T_pq T_pq :\n  a -&gt; (bp + aq)q + (bq + aq + ap)(q + p)\n  b -&gt; (bp + aq)p + (bq + aq + ap)q\n=\n  a -&gt; (b + a)(q^2 + 2pq) + a(q^2 + p^2)\n  b -&gt; b(q^2 + p^2) + a(q^2 + 2pq)\n= T_(q^2 + p^2),(q^2 + 2pq)\n</code></pre>\n\n<p>So now let\u2019s write a simple function to compute <code>T_pq^n (a,b)</code> and <code>fib n</code></p>\n\n<pre><code>tPow p q a b n | n = 1 = (b*q + a*q + a*p, b*p + a*q)\n               | otherwise = let (a', b') = tPow p q a b 1 in tPow p q a' b' (n-1)\n\nfib 0 = 0\nfib 1 = 1\nfib n = fst $ tPow 0 1 1 0 (n-1)\n</code></pre>\n\n<p>And now we can use our relation to make <code>tPow</code> faster:</p>\n\n<pre><code>tPow p q a b n | n = 1 = (b*q + a*q + a*p, b*p + a*q)\n               | odd n = let (a', b') = tPow p q a b 1 in tPow p q a' b' (n-1)\n               | even n = tPow (q*q + p*p) (q*q + 2*p*q) a b (n `div` 2)\n</code></pre>\n\n<p>Why is this faster? Well it\u2019s faster because then computing <code>fib (2*n)</code> is only a small constant more work than computing <code>fib n</code>, whereas before it was twice as much work and before that it was four times as much work and before that it was the square of the amount of work. Indeed the number of steps is something like the number of bits of <code>n</code> in binary plus the number of <code>1</code>s in the binary representation of <code>n</code>. To compute <code>fib 1024</code> only takes about 10 steps whereas the previous algorithm took about 1000. Computing the billionth Fibonacci number only takes 30 steps, which is a lot less than a billion.</p>\n"}, {"tags": [], "owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "is_accepted": false, "score": 2, "last_activity_date": 1550989045, "last_edit_date": 1550989045, "creation_date": 1550984174, "answer_id": 54848880, "question_id": 54843670, "link": "https://stackoverflow.com/questions/54843670/why-this-implementation-of-fibonacci-is-extremely-fast/54848880#54848880", "title": "Why this implementation of Fibonacci is extremely fast?", "body": "<p>Just want to make it clear that tail recursion has nothing to do with what makes second program fast. Below, I rewrite your first program to use a proper tail call and we compare the execution time to the second program. I also rewrote that one because it can be simplified quite a bit -</p>\n\n<pre><code>fib1 n = slow n id\n  where\n    slow 0 k = k 0\n    slow 1 k = k 1\n    slow n k = slow (n - 1) (\\a -&gt;\n               slow (n - 2) (\\b -&gt;\n               k (a + b)))\n\nfib2 n = fast n 0 1\n  where\n    fast 0 a _ = a\n    fast n a b = fast (n - 1) b (a + b)\n</code></pre>\n\n<p>The impact on tiny numbers like <code>n = 10</code> is negligible -</p>\n\n<pre><code>fib1 10\n-- 55\n-- (0.01 secs, 138,264 bytes)\n\nfib2 10\n-- 55\n-- (0.01 secs, 71,440 bytes)\n</code></pre>\n\n<p>But even around <code>n = 20</code> we notice a huge fall-off in <code>fib1</code> performance -</p>\n\n<pre><code>fib1 20\n-- 6765\n-- (0.70 secs, 8,787,320 bytes)\n\nfib2 20\n-- 6765\n-- (0.01 secs, 76,192 bytes)\n</code></pre>\n\n<p>At <code>n = 30</code>, the impact is laughable. Both programs still arrive at the same result, so that's good, but <code>fib1</code> takes over 30 seconds. <code>fib2</code> still only takes a fraction of a second -</p>\n\n<pre><code>fib1 30\n-- 832040\n-- (32.91 secs, 1,072,371,488 bytes) LOL so bad\n\nfib2 30\n-- 832040 (0.09 secs, 80,944 bytes)\n</code></pre>\n\n<p>The reason for this is because the first program, <code>fib1</code>, makes <em>two</em> recursive calls. The process for this function uses exponential time and space as <code>n</code> grows. At <code>n = 30</code>, the slow program will make 1,073,741,824 (2<sup>30</sup>) recursive calls. The fast program will only recur 30 times.</p>\n\n<p>At <code>n = 1000</code>, we run into a serious problem with <code>fib1</code>. Based on the performance of <code>fib1 30</code>, we estimate it would take <code>1.041082353242204e286</code> <em>years</em> to complete 2<sup>1000</sup> recursive calls. Meanwhile, <code>fib2 1000</code> handles 1000 recursions effortlessly -</p>\n\n<pre><code>fib2 1000\n-- 43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875\n-- (0.13 secs, 661,016 bytes)\n</code></pre>\n\n<hr>\n\n<p>The original rewrite of your first program might be hard to follow with the added <code>k</code> parameter. Use of <code>Cont</code> allows us to see the a clear sequence of steps in Haskell's familiar <code>do</code> notation -</p>\n\n<pre><code>import Control.Monad.Cont\n\nfib1 n = runCont (slow n) id\n  where\n    slow 0 = return 0\n    slow 1 = return 1\n    slow n = do\n      a &lt;- slow (n - 1)\n      b &lt;- slow (n - 2)\n      return (a + b)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": false, "score": 1, "last_activity_date": 1551003838, "last_edit_date": 1551003838, "creation_date": 1551002209, "answer_id": 54850702, "question_id": 54843670, "link": "https://stackoverflow.com/questions/54843670/why-this-implementation-of-fibonacci-is-extremely-fast/54850702#54850702", "title": "Why this implementation of Fibonacci is extremely fast?", "body": "<p>It's just obfuscation to hide the fact that the input number is being used as a counter. I would hope that if you saw something like this instead, you'd understand why:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fib2 n = fastFib2 0 1 0 n\n\nfastFib2 current previous count 0 = 0\nfastFib2 current previous count 1 = 1\nfastFib2 current previous count n\n  | count == n = current\n  | otherwise  =\n     fastFib2 (current + previous) current (count + 1) n\n</code></pre>\n\n<p>In the code above, we've made the counter explicit: when it equals our input, <code>n</code>, we return our accumulator, <code>current</code>; otherwise, we keep track in this \"forward\" recursion of the current and previous numbers (the \"<a href=\"https://en.wikipedia.org/wiki/Fibonacci_number\" rel=\"nofollow noreferrer\">two preceding ones</a>\"), all that is needed to construct the Fibonacci sequence.</p>\n\n<p>The code you shared does the same thing. The <code>(c - 1)</code> makes it look like a more traditional \"backwards\" recurrence, when it's actually starting off the accumulator in the first call, then adding to it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6435535"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 54847122, "answer_count": 4, "score": 5, "last_activity_date": 1551003838, "creation_date": 1550939684, "last_edit_date": 1550952212, "question_id": 54843670, "link": "https://stackoverflow.com/questions/54843670/why-this-implementation-of-fibonacci-is-extremely-fast", "title": "Why this implementation of Fibonacci is extremely fast?", "body": "<p>This implementation of Fibonacci is easy to understand but very slow:</p>\n\n<pre><code>fib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>Following implementation of Fibonacci is hard to understand but super fast. It calculates 100,000th Fibonacci number instantly on my laptop.</p>\n\n<pre><code>fib = fastFib 1 1\n\nfastFib _ _ 0 = 0\nfastFib _ _ 1 = 1\nfastFib _ _ 2 = 1\nfastFib a b 3 = a + b\nfastFib a b c = fastFib (a + b) a (c - 1)\n</code></pre>\n\n<p>What the magic is happening here about the latter implementation and how does it work?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1550938709, "post_id": 54843477, "comment_id": 96460235, "body": "I&#39;m not sure I can satisfactorily answer your specific questions - but the way I think of it is making string literals polymorphic, just as number literals are. The literal value <code>2</code> doesn&#39;t have type <code>Integer</code>, it has type <code>Num a =&gt; a</code> - so can serve duty as an <code>Int</code>, <code>Integer</code>, <code>Double</code> or whatever. Similarly, with <code>OverloadedStrings</code>, the literal <code>&quot;hello&quot;</code> is no longer simply a <code>String</code> (which remember means <code>[Char]</code>), it&#39;s <code>IsString a =&gt; a</code>, so can also be <code>Text</code> or <code>ByteString</code> or whatever other type you want it to be."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1550941826, "post_id": 54843477, "comment_id": 96461133, "body": "OverloadedStrings does not affect or change <code>String</code>."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550945239, "post_id": 54844149, "comment_id": 96462232, "body": "<i>&quot;Haskell implicitly writes <code>fromString &quot;foo&quot;</code>&quot;</i> that&#39;s circular."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1550945370, "post_id": 54844149, "comment_id": 96462277, "body": "@WillNess: no, since the condition is that &quot;if <i>you</i> write <code>&quot;foo&quot;</code>&quot;, so if Haskell writes <code>fromString &quot;foo&quot;</code>, then that does not trigger a new rule :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550945497, "post_id": 54844149, "comment_id": 96462316, "body": "A code is a code, no matter who wrote it. I read that as <i>&quot;the code <code>&quot;foo&quot;</code> stands for <code>fromString &quot;foo&quot;</code>&quot;</i> and it is still circular. <code>fromString (&quot;foo&quot; :: String)</code> is OTOH clear (for me, at least). :)"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1550955621, "post_id": 54844149, "comment_id": 96465126, "body": "1) <code>fromString :: IsString a =&gt; String -&gt; String</code>, so <code>fromString &quot;foo&quot;</code> is already &quot;not circular&quot; by your standards 2) <code>fromString (&quot;foo&quot; :: String)</code> is actually still &quot;circular&quot;, because that would mean <code>fromString (fromString &quot;foo&quot; :: String)</code>, ad infinitum. I think the correct answer is that \u201cHaskell&quot; and &quot;Haskell + <code>OverloadedStrings</code>&quot; are different languages, and the rule transates from the latter to the former. It\u2019s not circular because the target langauge is different. In GHC, the most basic functional language is Core, which is even lower than standard Haskell."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1550942933, "creation_date": 1550942933, "answer_id": 54844149, "question_id": 54843477, "link": "https://stackoverflow.com/questions/54843477/how-does-overloadedstrings-language-extension-work/54844149#54844149", "title": "How does OverloadedStrings language extension work?", "body": "<blockquote>\n  <p>When the OverloadedStrings is enabled, then <code>String</code> becomes a type <code>Data.String.IsString a =&gt; a</code></p>\n</blockquote>\n\n<p>No that is incorrect. A <code>String</code> remains a <code>String</code>. It has only effect on string <em>literals</em>, not variables that have as type a <code>String</code>, and these still <em>can</em> be <code>String</code>s.</p>\n\n<blockquote>\n  <p>What does <em>string literals are now a call to the <code>fromString</code> function</em>? </p>\n</blockquote>\n\n<p>It means that if you write a <em>string literal</em>, like <code>\"foo\"</code>, Haskell implicitly writes <code>fromString \"foo\"</code>, and thus you can use this like any <code>IsString</code> object.</p>\n\n<blockquote>\n  <p>what does <em>without having to introduce new constructs for otherwise normal values</em> mean?</p>\n</blockquote>\n\n<p>It means that we can make our own types for which we can write some sort of \"mini-parser\", and thus write these objects as string literals in our code. For example if we make a datatype like:</p>\n\n<pre><code>newtype BoolList = BoolList [Bool] deriving Show\n</code></pre>\n\n<p>then we can write our own parser</p>\n\n<pre><code>instance IsString BoolList where\n    fromString = BoolList . map toBool\n        where toBool '1' = True\n              toBool _ = False</code></pre>\n\n<p>Now we can for example define a list of <code>Bool</code>s as:</p>\n\n<pre><code>myboollist :: BoolList\nmyboollist = \"10110010001\"\n</code></pre>\n\n<p>So then we get:</p>\n\n<pre><code>Prelude Data.String&gt; myboollist \nBoolList [True,False,True,True,False,False,True,False,False,False,True]\n</code></pre>\n\n<p>We here thus wrote a string literal <code>\"10110010001\"</code>, and that means that implictly, we wrote <code>fromString \"10110010001\"</code>. Since the type of <code>myboollist</code> is <code>BoolList</code>, it is here clear to what the string literal is parsed.</p>\n\n<p>This thus can be useful if some data types are complex, our would take a lot of code to construct an object.</p>\n\n<p>Since the <code>fromString</code> call is however postponed, and frequently not <em>all</em> possible strings map to a value of the type (here it is the case, although it is debatable if it is good to just fill in <code>False</code> for everything else than <code>'1'</code>), it thus can raise errors at runtime when the string turns out to be \"unparsable\".</p>\n"}, {"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1550953970, "creation_date": 1550953970, "answer_id": 54845931, "question_id": 54843477, "link": "https://stackoverflow.com/questions/54843477/how-does-overloadedstrings-language-extension-work/54845931#54845931", "title": "How does OverloadedStrings language extension work?", "body": "<blockquote>\n  <p>what does without having to introduce new constructs for otherwise normal values mean?</p>\n</blockquote>\n\n<p>The next sentence says </p>\n\n<blockquote>\n  <blockquote>\n    <p>So why should string literals be any different?</p>\n  </blockquote>\n</blockquote>\n\n<p>so this one refers primarily to number literals. Consider e.g. <a href=\"http://hackage.haskell.org/package/polynomial-0.7.3/docs/Math-Polynomial.html\" rel=\"nofollow noreferrer\">a type defining polynomials</a>. Because <code>+</code> and <code>*</code> can only be applied to arguments of the same type, if we want </p>\n\n<pre><code>2*x^3 + 3*x :: Poly Int\n</code></pre>\n\n<p>to be legal, <code>2</code> and <code>3</code> have to be of type <code>Poly Int</code>; otherwise you'd need either</p>\n\n<ol>\n<li><p>a separate operator to multiply a polynomial by a number: <code>2.*x^3 + 3.^x</code>.</p></li>\n<li><p>a constructor for a constant polynomial: <code>(C 2)*x^3 + (C 3)*x</code></p></li>\n</ol>\n\n<p>An example for string literals is given at the end:</p>\n\n<blockquote>\n  <blockquote>\n    <p>However, SQL queries are notorious for injection attacks when we concatenate strings. Interestingly, postgresql-simple provides a <code>Query</code> type that only has a <code>IsString</code> instance. This means that it\u2019s very lightweight to write a literal query, but the moment we want to start concatenating strings for our query, we have to be very explicit.</p>\n  </blockquote>\n</blockquote>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 54844149, "answer_count": 2, "score": 1, "last_activity_date": 1550953970, "creation_date": 1550938452, "question_id": 54843477, "link": "https://stackoverflow.com/questions/54843477/how-does-overloadedstrings-language-extension-work", "title": "How does OverloadedStrings language extension work?", "body": "<p>I am trying to understand the language extension OverloadedStrings from the page  <a href=\"https://ocharles.org.uk/posts/2014-12-17-overloaded-strings.html\" rel=\"nofollow noreferrer\">https://ocharles.org.uk/posts/2014-12-17-overloaded-strings.html</a>. </p>\n\n<p>When the OverloadedStrings is enabled, then <code>String</code> becomes a type <code>Data.String.IsString a =&gt; a</code>: </p>\n\n<pre><code>Prelude Data.String&gt; :t fromString \"Foo\"\nfromString \"Foo\" :: IsString a =&gt; a \n</code></pre>\n\n<p>In the description, the author has mentioned the following: </p>\n\n<blockquote>\n  <p>By enabling this extension, string literals are now a call to the\n  fromString function, which belongs to the IsString type class.</p>\n</blockquote>\n\n<p>What does <code>string literals are now a call to the fromString function</code> ? </p>\n\n<p>and also the author has mentioned: </p>\n\n<blockquote>\n  <p>This polymorphism is extremely powerful, and it allows us to write\n  embedded domain specific languages in Haskell source code, without\n  having to introduce new constructs for otherwise normal values.</p>\n</blockquote>\n\n<p>what does <code>without having to introduce new constructs for otherwise normal values</code> mean?</p>\n"}, {"tags": ["haskell", "typeclass", "monoids", "semigroup"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1550870714, "post_id": 54835367, "comment_id": 96445490, "body": "You can&#39;t hide <code>instance</code> declarations. What you can do though is use a <code>newtype</code> to &quot;wrap&quot; the underlying types. This is done quite a lot even in the standard libraries - for example the <code>Sum</code> and <code>Product</code> types are both wrappers for <code>Int</code> (actually any instance of <code>Num</code>), with different <code>Monoid</code> instances."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550870861, "post_id": 54835367, "comment_id": 96445556, "body": "oh, and your <code>Monoid</code> instance for <code>Maybe Cell</code> already exists as a <code>newtype</code> wrapper: <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Monoid.html#t:First\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 55, "user_id": 8554861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f7cbc1a5bdf4af74ac1ba4c534e77f?s=128&d=identicon&r=PG&f=1", "display_name": "Jad Issa", "link": "https://stackoverflow.com/users/8554861/jad-issa"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550871644, "post_id": 54835367, "comment_id": 96445885, "body": "@RobinZigmond Wow! That was fast! It is correct; <code>First</code> solved the problem altogether. Thanks a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550920389, "post_id": 54835942, "comment_id": 96455398, "body": "TIL <code>First</code> is deprecated"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550924467, "post_id": 54835942, "comment_id": 96456450, "body": "@luqui ah good point, <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Semigroup.html#t:First\" rel=\"nofollow noreferrer\"><code>Semigroup.First</code></a> should be used instead of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Monoid.html#t:First\" rel=\"nofollow noreferrer\"><code>Monoid.First</code></a>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1550924483, "last_edit_date": 1550924483, "creation_date": 1550873745, "answer_id": 54835942, "question_id": 54835367, "link": "https://stackoverflow.com/questions/54835367/hiding-typeclass-instance-declarations-while-importing-in-haskell/54835942#54835942", "title": "Hiding typeclass instance declarations while importing in Haskell", "body": "<p>I standard Haskell, class instances are always \u201ccompletely global\u201d<sup>\u2020</sup> \u2013 if a type has an instance for a given class <em>somewhere</em>, then this instance is used everywhere.</p>\n\n<p>So, if you want to define a separate instance, you need to either have a different class \u2013 usually not practical, including in your example \u2013 or a different type, which is usually not a problem. In fact Haskell has a dedicated keyword for this kind of thing, <code>newtype</code>. You simply change <code>type Board = [[Maybe Cell]]</code> to</p>\n\n<pre><code>newtype Board = Board [[Maybe Cell]]\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>instance Semigroup Board where\n  Board l &lt;&gt; Board r = Board $ zipWith (zipWith mappend) l r\ninstance Monoid Board where\n  mempty = Board [[Nothing, Nothing, Nothing]\n                 ,[Nothing, Nothing, Nothing]\n                 ,[Nothing, Nothing, Nothing]]\n  mappend = (&lt;&gt;)\n</code></pre>\n\n<p>Likewise, instead of <code>Maybe Cell</code> you should use another type that has the suitable <code>Monoid</code> instance. That one actually <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Semigroup.html#t:First\" rel=\"nofollow noreferrer\">exists already in the base library</a>, but it's not really necessary: you can just make a semigroup (not monoid!) instance for <code>Cell</code> itself which represents the left-bias, then <code>Maybe</code> will (since GHC-8.4) automatically have the desired behaviour.</p>\n\n<pre><code>instance Semigroup Cell where\n  a &lt;&gt; _ = a\n</code></pre>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>It has actually been proposed to relax this, allowing locally-selected instances, in <a href=\"https://doi.org/10.1145/3242744.3242752\" rel=\"nofollow noreferrer\">a paper presented at the 2018 Haskell Symposium</a>.</sub></p>\n"}], "owner": {"reputation": 55, "user_id": 8554861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f7cbc1a5bdf4af74ac1ba4c534e77f?s=128&d=identicon&r=PG&f=1", "display_name": "Jad Issa", "link": "https://stackoverflow.com/users/8554861/jad-issa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 1, "accepted_answer_id": 54835942, "answer_count": 1, "score": 4, "last_activity_date": 1550924483, "creation_date": 1550870525, "question_id": 54835367, "link": "https://stackoverflow.com/questions/54835367/hiding-typeclass-instance-declarations-while-importing-in-haskell", "title": "Hiding typeclass instance declarations while importing in Haskell", "body": "<p>I am trying to make a tic-tac-toe game, and I decided to construct types for cells (elements of the board) and the board as follows:</p>\n\n<pre><code>data Cell  = X | O deriving (Show, Eq)\ntype Board = [[Maybe Cell]]\n</code></pre>\n\n<p>Here, Nothing represents an empty cell, (Just X) and (Just O) represent cells filled with X and O respectively.</p>\n\n<p>I would like to define (Maybe Cell) as a monoid as follows:</p>\n\n<pre><code>instance Monoid (Maybe Cell) where\n  mempty             = Nothing\n  mappend Nothing x  = x\n  mappend (Just x) _ = (Just x)\n</code></pre>\n\n<p>And Board as another monoid with </p>\n\n<pre><code>instance Monoid Board where\n  mempty = [[Nothing, Nothing, Nothing]\n           ,[Nothing, Nothing, Nothing]\n           ,[Nothing, Nothing, Nothing]]\n  mappend = zipWith (zipWith mappend) \n  -- where the right-hand-side mappend is the addition on (Maybe Cell)\n</code></pre>\n\n<p>I know I could implement this absolutely without monoids, but I'm trying to explore the field, and it's just a really neat way to write it.</p>\n\n<p>The problem that I get is that a <code>Maybe</code> monoid instance is already defined in <code>GHC.Base</code> as follows:</p>\n\n<pre><code>instance Semigroup a =&gt; Monoid (Maybe a)\n</code></pre>\n\n<p>This has a very different definition than what I want, but it causes duplicate instance declarations, so I can't just ignore it.</p>\n\n<p>What I'm trying to do is to hide the <code>Monoid</code> instance of <code>(Maybe a)</code> from <code>GHC.Base</code> to avoid duplicate instances. I tried searching a lot for that, but couldn't really find a way to hide that. I can't hide all of <code>Monoid</code> or all of <code>Semigroup</code>, because I need their functions, but I need to hide this specific instance declaration. Could anyone help me with that?</p>\n\n<p>NOTE: I'm using FlexibleInstances.</p>\n"}, {"tags": ["haskell", "nix", "hakyll"], "answers": [{"comments": [{"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1551043386, "post_id": 54835996, "comment_id": 96484877, "body": "I think the issue is, I don&#39;t understand how to modify my .nix files so that they can do a jailbreak, (or anything else, really). I&#39;ve updated my answer to reflect what I&#39;ve been trying, but the examples you give don&#39;t really show how I could use those functions in practice."}, {"owner": {"reputation": 4630, "user_id": 160386, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b6044f355342bb055fbb03804d9673e3?s=128&d=identicon&r=PG", "display_name": "Jan Tojnar", "link": "https://stackoverflow.com/users/160386/jan-tojnar"}, "reply_to_user": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1551078849, "post_id": 54835996, "comment_id": 96492874, "body": "I primarily meant fixing the issues in nixpkgs but your way is fine too. The issue is that you are not passing haskellLib to the expression. Try pkgs.haskell.lib. Or see <a href=\"https://discourse.nixos.org/t/when-haskell-dependencies-fail/2244/2\" rel=\"nofollow noreferrer\">discourse.nixos.org/t/when-haskell-dependencies-fail/2244/2</a>"}], "tags": [], "owner": {"reputation": 4630, "user_id": 160386, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b6044f355342bb055fbb03804d9673e3?s=128&d=identicon&r=PG", "display_name": "Jan Tojnar", "link": "https://stackoverflow.com/users/160386/jan-tojnar"}, "is_accepted": false, "score": 2, "last_activity_date": 1550874048, "creation_date": 1550874048, "answer_id": 54835996, "question_id": 54834246, "link": "https://stackoverflow.com/questions/54834246/how-can-i-make-this-haskell-development-environment-in-nix/54835996#54835996", "title": "How can I make this Haskell development environment in Nix?", "body": "<p>This is typically caused by a package pinning an old version of dependency, not available in nixpkgs. Peter is <a href=\"https://github.com/NixOS/nixpkgs/issues/54958#issuecomment-465963600\" rel=\"nofollow noreferrer\">correct</a> that clay needs to bump the <a href=\"https://github.com/sebastiaanvisser/clay/blob/54dc9eaf0abd180ef9e35d97313062d99a02ee75/clay.cabal#L91-L92\" rel=\"nofollow noreferrer\">hspec version</a>.</p>\n\n<p>However, you can try to temporarily fix it by jailbreaking the package (removing the version bounds) in nixpkgs, see:</p>\n\n<p><a href=\"https://github.com/NixOS/nixpkgs/blob/cc98350d55522ebb2b7d35db32bc7c2fc5b8b273/pkgs/development/haskell-modules/configuration-common.nix#L1088-L1089\" rel=\"nofollow noreferrer\">https://github.com/NixOS/nixpkgs/blob/cc98350d55522ebb2b7d35db32bc7c2fc5b8b273/pkgs/development/haskell-modules/configuration-common.nix#L1088-L1089</a></p>\n\n<p>In case the package does not build with newer version of hspec, you could try to add the old version to the package set and override the package to use it:</p>\n\n<p><a href=\"https://github.com/NixOS/nixpkgs/blob/cc98350d55522ebb2b7d35db32bc7c2fc5b8b273/pkgs/development/haskell-modules/configuration-common.nix#L1170\" rel=\"nofollow noreferrer\">https://github.com/NixOS/nixpkgs/blob/cc98350d55522ebb2b7d35db32bc7c2fc5b8b273/pkgs/development/haskell-modules/configuration-common.nix#L1170</a></p>\n\n<p>But that would require require re-generating <code>hackage-packages.nix</code> so I do not recommend it.</p>\n\n<p>It is better idea to patch the package to support newer version of the dependency and add the patch to overrides:</p>\n\n<p><a href=\"https://github.com/NixOS/nixpkgs/blob/cc98350d55522ebb2b7d35db32bc7c2fc5b8b273/pkgs/development/haskell-modules/configuration-common.nix#L1187-L1190\" rel=\"nofollow noreferrer\">https://github.com/NixOS/nixpkgs/blob/cc98350d55522ebb2b7d35db32bc7c2fc5b8b273/pkgs/development/haskell-modules/configuration-common.nix#L1187-L1190</a></p>\n\n<p>Also do not forget to open an issue upstream \u2013 I see you <a href=\"https://github.com/sebastiaanvisser/clay/issues/184\" rel=\"nofollow noreferrer\">already did</a> \u2013 or a pull request.</p>\n"}, {"tags": [], "owner": {"reputation": 1519, "user_id": 1726428, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cd4979ebad11e7266a4348e2ecfb47de?s=128&d=identicon&r=PG", "display_name": "InvisiblePanda", "link": "https://stackoverflow.com/users/1726428/invisiblepanda"}, "is_accepted": false, "score": 1, "last_activity_date": 1573813526, "creation_date": 1573813526, "answer_id": 58875003, "question_id": 54834246, "link": "https://stackoverflow.com/questions/54834246/how-can-i-make-this-haskell-development-environment-in-nix/58875003#58875003", "title": "How can I make this Haskell development environment in Nix?", "body": "<p>It's probably not really relevant anymore, but I encountered the same problem with <code>clay</code>.</p>\n\n<p>I use an overlay to modify the (Haskell) package set. It looks like this (called <code>overlays.nix</code>):</p>\n\n<pre><code>let\n  customHaskellPackages = self: super: {\n    haskellPackages = super.haskellPackages.override {\n      overrides = hself: hsuper: {\n        # Since clay is not really maintained any longer, the upper\n        # version bounds have gone stale.\n        # Everything works fine; we just need to free it from its\n        # too-tight chains.\n        clay =\n          super.haskell.lib.doJailbreak\n            hsuper.clay;\n\n        # Other packages would go here, too\n        some-foo-package =\n          super.haskell.lib.dontCheck\n            (hself.callPackage ./some-foo-package.nix {});\n      };\n    };\n  };\nin\n[ customHaskellPackages ]\n</code></pre>\n\n<p>My <code>default.nix</code> is created by <code>cabal2nix . &gt; default.nix</code> from my cabal file, which in turn just specifies <code>clay</code> as a dependency.</p>\n\n<p>In a (very simplified) <code>release.nix</code> file you can use the overlay as follows:</p>\n\n<pre><code>let\n  overlays = import ./nix/overlays.nix;\n  # I might have needed this for clay, but it might have been sth else\n  config = { allowBroken = true; };\n  pkgs = import &lt;nixpkgs&gt; { inherit config; inherit overlays; };\nin\npkgs.haskellPackage.myApplication\n# Or use haskellPackages.callPackage ./something.nix {} here if you didn't\n# add your project to haskellPackages in the overlay\n</code></pre>\n\n<p>After that, <code>nix-build release.nix</code> works just fine.\nI don't use the <code>--shell</code> option to create a <code>shell.nix</code> file, but create it myself and import the <code>release.nix</code> file. Then I enrich my shell environment by adding in a couple of build tools. This works as expected as well.</p>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1573813526, "creation_date": 1550865312, "last_edit_date": 1551043316, "question_id": 54834246, "link": "https://stackoverflow.com/questions/54834246/how-can-i-make-this-haskell-development-environment-in-nix", "title": "How can I make this Haskell development environment in Nix?", "body": "<p>I'm trying to make a Haskell development environment for a web project that just has the dependencies <code>hakyll</code>, <code>blaze</code>, and <code>clay</code>. Only, clay appears to fail to build, complaining that <code>Setup: Encountered missing dependencies:\nhspec &gt;=2.2.0 &amp;&amp; &lt;2.6, hspec-discover &gt;=2.2.0 &amp;&amp; &lt;2.6</code>, and I can't seem to get past this.</p>\n\n<p>I tried running <code>cabal2nix . --shell &gt; shell.nix</code> on this cabal file: </p>\n\n<pre><code>name:               open-editions\nversion:            0.1.0.0\nbuild-type:         Simple\ncabal-version:      &gt;= 1.10\n\nexecutable site\n  main-is:          site.hs\n  build-depends:    base == 4.*\n                  , blaze-html\n                  , clay\n                  , hakyll == 4.12.*\n  ghc-options:      -threaded\n  default-language: Haskell2010\n</code></pre>\n\n<p>But I'm running into the missing dependencies problem. Any ideas? </p>\n\n<p>Edit: here's the shell.nix that I'm generating from the above, using cabal2nix: </p>\n\n<pre><code>{ nixpkgs ? import &lt;nixpkgs&gt; {}, compiler ? \"default\", doBenchmark ? false }:\n\nlet\n\n  inherit (nixpkgs) pkgs;\n\n  f = { mkDerivation, base, blaze-html, clay, hakyll, stdenv }:\n      mkDerivation {\n        pname = \"open-editions\";\n        version = \"0.1.0.0\";\n        src = ./.;\n        isLibrary = false;\n        isExecutable = true;\n        executableHaskellDepends = [ base blaze-html clay hakyll ];\n        license = \"unknown\";\n        hydraPlatforms = stdenv.lib.platforms.none;\n      };\n\n  haskellPackages = if compiler == \"default\"\n                       then pkgs.haskellPackages\n                       else pkgs.haskell.packages.${compiler};\n\n  variant = if doBenchmark then pkgs.haskell.lib.doBenchmark else pkgs.lib.id;\n\n  drv = variant (haskellPackages.callPackage f {});\n\nin\n\n  if pkgs.lib.inNixShell then drv.env else drv\n</code></pre>\n\n<p>And here's how I've been trying to modify it, so that it overrides Clay: </p>\n\n<pre><code>{ haskellLib, super, nixpkgs ? import &lt;nixpkgs&gt; {}, compiler ? \"default\", doBenchmark ? false }:\n\nlet\n\n  inherit (nixpkgs) pkgs;\n\n  clay = haskellLib.doJailbreak super.clay;\n\n  f = { mkDerivation, base, blaze-html, clay, hakyll, stdenv }:\n      mkDerivation {\n        pname = \"open-editions\";\n        version = \"0.1.0.0\";\n        src = ./.;\n        isLibrary = false;\n        isExecutable = true;\n        executableHaskellDepends = [ base blaze-html clay hakyll ];\n        license = \"unknown\";\n        hydraPlatforms = stdenv.lib.platforms.none;\n      };\n\n  haskellPackages = if compiler == \"default\"\n                       then pkgs.haskellPackages\n                       else pkgs.haskell.packages.${compiler};\n\n  variant = if doBenchmark then pkgs.haskell.lib.doBenchmark else pkgs.lib.id;\n\n  drv = variant (haskellPackages.callPackage f {});\n\nin\n\n  if pkgs.lib.inNixShell then drv.env else drv\n</code></pre>\n\n<p>But I'm obviously doing something wrong, since I'm getting: <code>error: cannot auto-call a function that has an argument without a default value ('haskellLib')</code>. </p>\n"}, {"tags": ["haskell", "ghci", "working-directory"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1550859053, "post_id": 54832719, "comment_id": 96440585, "body": "Try with no quotes at all."}], "answers": [{"comments": [{"owner": {"reputation": 5372, "user_id": 1700890, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae3069bce34ea67aa6ed85035fac697?s=128&d=identicon&r=PG", "display_name": "user1700890", "link": "https://stackoverflow.com/users/1700890/user1700890"}, "edited": false, "score": 0, "creation_date": 1550859441, "post_id": 54832857, "comment_id": 96440748, "body": "Thank you so much! Just in case how can I load file with spaces in its name? <code>Prelude&gt; :l simple file.hs</code>"}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 1, "creation_date": 1550922169, "post_id": 54832857, "comment_id": 96455845, "body": "You should also be able to use tab completion for file loads (i.e. <code>:l simp&lt;tab&gt;</code>)."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 3, "last_activity_date": 1550859194, "creation_date": 1550859194, "answer_id": 54832857, "question_id": 54832719, "link": "https://stackoverflow.com/questions/54832719/change-working-directory-in-haskells-ghci-to-a-path-with-spaces/54832857#54832857", "title": "Change working directory in Haskell&#39;s GHCi to a path with spaces", "body": "<p>On my system, it appears that using quotes always fails, but using no quotes at all seems to work. (Even for paths with spaces.)</p>\n\n<p>Also seems to work both with forward slashes and backslashes. (Which isn't too surprising... Windows actually accepts either just fine.)</p>\n"}], "owner": {"reputation": 5372, "user_id": 1700890, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae3069bce34ea67aa6ed85035fac697?s=128&d=identicon&r=PG", "display_name": "user1700890", "link": "https://stackoverflow.com/users/1700890/user1700890"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 54832857, "answer_count": 1, "score": 4, "last_activity_date": 1551524760, "creation_date": 1550858520, "last_edit_date": 1551524760, "question_id": 54832719, "link": "https://stackoverflow.com/questions/54832719/change-working-directory-in-haskells-ghci-to-a-path-with-spaces", "title": "Change working directory in Haskell&#39;s GHCi to a path with spaces", "body": "<p>I am running WinGHCi 1.0.6</p>\n\n<p>I need to change working directory. Here is what I tried:</p>\n\n<pre><code>Prelude&gt; :cd \"C:/Temp Temp/Temp\"\n</code></pre>\n\n<p>Returned error:</p>\n\n<pre><code>Exception: SetCurrentDirectory \"\\\"C:/Temp Temp/Temp\\\"\": invalid argument (The filename, directory name, or volume label syntax is incorrect.)\n</code></pre>\n\n<p>I also tried with single quote, but got the following error:</p>\n\n<pre><code>*** Exception: SetCurrentDirectory \"'C:/Temp Temp/Temp'\": invalid argument (The filename, directory name, or volume label syntax is incorrect.)\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1550856674, "post_id": 54832276, "comment_id": 96439424, "body": "What have you tried so far?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1550856825, "post_id": 54832276, "comment_id": 96439477, "body": "The &quot;Haskell equivalent&quot; is to look at the goal and try to write the solution not as a translation but as idiomatic code.  There often isn&#39;t a great equivalent when you translate between pure functional code and typical imperative languages (in either direction)."}, {"owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "edited": false, "score": 0, "creation_date": 1550864043, "post_id": 54832276, "comment_id": 96442793, "body": "Can you show some example data you try to process with that, please?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1550858350, "creation_date": 1550858350, "answer_id": 54832688, "question_id": 54832276, "link": "https://stackoverflow.com/questions/54832276/haskell-equivalence-of-looping-through-a-2d-array-and-recording-position/54832688#54832688", "title": "Haskell equivalence of looping through a 2D array and recording position", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:findIndex\" rel=\"nofollow noreferrer\"><code>findIndex</code></a> to find the index of the first element of a list that matches a predicate, if one exists.</p>\n"}], "owner": {"reputation": 1, "user_id": 11102647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58baafedb5ce791fd76655587d5ea035?s=128&d=identicon&r=PG&f=1", "display_name": "Vanni Segu", "link": "https://stackoverflow.com/users/11102647/vanni-segu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1550860816, "answer_count": 1, "score": -1, "last_activity_date": 1550859422, "creation_date": 1550856537, "last_edit_date": 1550859422, "question_id": 54832276, "link": "https://stackoverflow.com/questions/54832276/haskell-equivalence-of-looping-through-a-2d-array-and-recording-position", "closed_reason": "Needs more focus", "title": "Haskell equivalence of looping through a 2D array and recording position", "body": "<p>How do I write this java code in haskell. I want to loop through a 2D array to check for a person(machine) and job  pairs and record position of machine.</p>\n\n<pre><code>int  col = 0;   \nint row = 0;\nint count = 0;  // accumulator\n\n// a loop to check 2D array for m and t pairs\nfor(int i = 0; i &lt; input.length; i++) {\n   for(int j = 0; j &lt; m.length; j++) {\n      if(input[i].charAt(0) == m[j]) {\n      col = j;    // recording position of m for 2D array\n      break;\n      }\n}\nfor(int j = 0; j &lt; t.length; j++) {\n   if(input[i].charAt(1) == t[j]) {\n     row = j;\n     break;\n     }\n}\n</code></pre>\n"}, {"tags": ["haskell", "monads", "frp", "reader", "writer"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1550853532, "post_id": 54827925, "comment_id": 96437822, "body": "Could you provide your attempted implementation and the error?"}, {"owner": {"reputation": 699, "user_id": 590803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/697b2e93839bdf17b22cbe15edaeadda?s=128&d=identicon&r=PG", "display_name": "frosch03", "link": "https://stackoverflow.com/users/590803/frosch03"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1550861877, "post_id": 54827925, "comment_id": 96441899, "body": "Sure, my implementation is just the one in the where clause an the error message I added to the post."}, {"owner": {"reputation": 699, "user_id": 590803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/697b2e93839bdf17b22cbe15edaeadda?s=128&d=identicon&r=PG", "display_name": "frosch03", "link": "https://stackoverflow.com/users/590803/frosch03"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1550861945, "post_id": 54827925, "comment_id": 96441930, "body": "also I added the relevant parts into <a href=\"https://gist.github.com/frosch03/bc0e3f50aa4919d65bf4d410d0d9f152/474f139a98e42a8bc3e689407642b2d52e546905\" rel=\"nofollow noreferrer\">this GitHub gist</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1550863655, "post_id": 54827925, "comment_id": 96442632, "body": "Have you tried to <code>lift (asks leftPlayerPos)</code>?  I haven&#39;t tested, but that is the normal way you use a monad underneath a transformer."}, {"owner": {"reputation": 699, "user_id": 590803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/697b2e93839bdf17b22cbe15edaeadda?s=128&d=identicon&r=PG", "display_name": "frosch03", "link": "https://stackoverflow.com/users/590803/frosch03"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1550868459, "post_id": 54827925, "comment_id": 96444574, "body": "Sure, but that doesn&#39;t help alot:       <code>\u2022 Couldn&#39;t match type \u2018ReaderT GameSettings m2\u2019 </code> with <code>\u2018WriterT [String] (ReaderT GameSettings m)\u2019</code> ... that is: <code>Expected type: MSF (GameEnv m) () Ball</code> instead of <code>Actual type: MSF (ReaderT GameSettings m2) () ()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1551121208, "last_edit_date": 1551121208, "creation_date": 1550869159, "answer_id": 54835091, "question_id": 54827925, "link": "https://stackoverflow.com/questions/54827925/what-is-the-correct-implementation-of-addtoleftplayerpos/54835091#54835091", "title": "What is the correct implementation of addToLeftPlayerPos", "body": "<h1>Some phrasing</h1>\n\n<p>When you have a transformer stack you must \"lift\" your operations to run the inner-monad functions.  for example:</p>\n\n<pre><code>type MyMonad a = Transformer1 (Transformer2 IO) a\n</code></pre>\n\n<p>The stack here is Transformer1 of Transformer2 of IO.  The \"outer\" monad is Transformer1 which wraps Transformer2 with an inner-most (or base, bottom) monad of IO.  In your case the stack is actuall a Writer of a Reader of some unknown monad <code>m</code>, all good.</p>\n\n<p>Now if we want to run <code>f :: Transformer2 IO a</code> from within a function <code>g :: MyMonad</code> we must <code>lift f</code>.  Similarly, if we have <code>getLine :: IO String</code> and we wish to run that from within <code>g :: Transformer1 (Transformer2 IO) a</code> then we can <code>lift (lift getLine)</code>.</p>\n\n<h1>Lifting</h1>\n\n<p>If you import <code>Control.Monad.Trans.Class</code> you can lift your ReaderT operations.  For example <code>lift (asks ...)</code> instead of just <code>asks ...</code>.</p>\n\n<p>This <em>does</em> help a lot.  The error you commented probably is due to the use of <code>asks</code> in <code>checkHitR</code>.</p>\n\n<h1>One More Type Error</h1>\n\n<p>After doing our lifting we have the error:</p>\n\n<pre><code>frosch.hs:23:5: error:\n    \u2022 Couldn't match type \u2018()\u2019 with \u2018Int\u2019\n      Expected type: MSF (GameEnv m) () Ball\n        Actual type: MSF\n                       (WriterT [[Char]] (ReaderT GameSettings m)) () ()\n</code></pre>\n\n<p>This is because your <code>checkHitR</code> doesn't return the value <code>rp</code> (which I assume it should).  Fixing that issue gives us our final code of:</p>\n\n<pre><code>module Main where\n\nimport FRP.BearRiver\nimport Control.Monad.Trans.Class\nimport Control.Monad\nimport Control.Monad.Trans.MSF.Reader\nimport Control.Monad.Trans.MSF.Writer\n\ntype Game = Ball\ntype Ball = Int\n\ntype GameEnv m =\n    WriterT [String] (ReaderT GameSettings m)\n\ndata GameSettings\n    = GameSettings\n      { leftPlayerPos  :: Int\n      , rightPlayerPos :: Int\n      }\n\nballToRight :: Monad m =&gt; MSF (GameEnv m) () Ball\nballToRight =\n    count &gt;&gt;&gt; arrM addLeftPlayerPos &gt;&gt;&gt; arrM checkHitR\n    where\n      addLeftPlayerPos =\n          (\\n -&gt; (n +) &lt;$&gt; lift (asks leftPlayerPos))\n      checkHitR n = do\n          rp &lt;- lift (asks rightPlayerPos)\n          when (rp &gt; n) $ tell [\"Ball is at \" ++ (show n)]\n          pure rp\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 590803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/697b2e93839bdf17b22cbe15edaeadda?s=128&d=identicon&r=PG", "display_name": "frosch03", "link": "https://stackoverflow.com/users/590803/frosch03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 54835091, "answer_count": 1, "score": 1, "last_activity_date": 1551121208, "creation_date": 1550841074, "last_edit_date": 1550861766, "question_id": 54827925, "link": "https://stackoverflow.com/questions/54827925/what-is-the-correct-implementation-of-addtoleftplayerpos", "title": "What is the correct implementation of addToLeftPlayerPos", "body": "<p>I'm trying to follow <a href=\"https://eprints.nottingham.ac.uk/36159/1/paper.pdf\" rel=\"nofollow noreferrer\">this paper</a> on functional reactive programming but I'm stuck on the second example in section 4.2. </p>\n\n<p>I got the first example with the reader transformer up and running:</p>\n\n<pre><code>module Main where\n\nimport FRP.BearRiver    \nimport Control.Monad.Trans.MSF.Reader\n\ntype Game = Ball\ntype Ball = Int\n\ntype GameEnv = ReaderT GameSettings\n\ndata GameSettings\n    = GameSettings\n      { leftPlayerPos  :: Int\n      , rightPlayerPos :: Int\n      }\n\nballToRight :: Monad m =&gt; MSF (GameEnv m) () Ball\nballToRight =\n    count &gt;&gt;&gt; arrM addToLeftPlayerPos\n    where\n      addToLeftPlayerPos =\n          (\\n -&gt; (n +) &lt;$&gt; asks leftPlayerPos)\n\nhitRight :: Monad m =&gt; MSF (GameEnv m) Ball Bool\nhitRight = arrM (\\i -&gt; (i &gt;=) &lt;$&gt; asks rightPlayerPos)\n</code></pre>\n\n<p>But with the next step I'm struggling. I can't figure out how to introduce a writer transformer correctly, as I don't get it even to compile:</p>\n\n<pre><code>module Main where\n\nimport FRP.BearRiver\nimport Control.Monad\nimport Control.Monad.Trans.MSF.Reader\nimport Control.Monad.Trans.MSF.Writer\n\ntype Game = Ball\ntype Ball = Int\n\ntype GameEnv m =\n    WriterT [String] (ReaderT GameSettings m)\n\ndata GameSettings\n    = GameSettings\n      { leftPlayerPos  :: Int\n      , rightPlayerPos :: Int\n      }\n\nballToRight :: Monad m =&gt; MSF (GameEnv m) () Ball\nballToRight =\n    count &gt;&gt;&gt; arrM addLeftPlayerPos &gt;&gt;&gt; arrM checkHitR\n    where\n      addLeftPlayerPos =\n          (\\n -&gt; (n +) &lt;$&gt; asks leftPlayerPos)\n      checkHitR n = do\n          rp &lt;- asks rightPlayerPos\nwhen (rp &gt; n) $ tell [\"Ball is at \" ++ (show n)]\n</code></pre>\n\n<p>Actually the line with the function call <code>addLeftPlayerPos</code> is the problematic one, as the function <code>arrM addLeftPlayerPos</code> isn't given in the paper and my version seems to lack the <code>WriterT</code> type signature as the type alias <code>type GameEnv m ...</code> suggests</p>\n\n<p>What could be the correct implementation of the <code>addLeftPlayerPos</code> function? </p>\n\n<p>Edit:\nThe compiler error is:</p>\n\n<pre><code> Expected type: MSF (GameEnv m) () Ball\n    Actual type: MSF (ReaderT GameSettings m1) () () \n\u2022 In the expression: \n    count &gt;&gt;&gt; arrM addToLeftPlayerPos &gt;&gt;&gt; arrM checkHitR \n</code></pre>\n"}, {"tags": ["unit-testing", "haskell", "testing", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1550855270, "post_id": 54827529, "comment_id": 96438752, "body": "Sounds like you should file this as a <a href=\"https://github.com/commercialhaskell/stack/issues\" rel=\"nofollow noreferrer\">stack bug</a>."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1551002239, "post_id": 54827529, "comment_id": 96473532, "body": "You can move &quot;Update&quot; as an answer to make this thread marked as solved"}], "answers": [{"tags": [], "owner": {"reputation": 3352, "user_id": 98600, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5738c02070833b70609a7fe8f0b75eef?s=128&d=identicon&r=PG", "display_name": "John J. Camilleri", "link": "https://stackoverflow.com/users/98600/john-j-camilleri"}, "is_accepted": true, "score": 0, "last_activity_date": 1551079593, "creation_date": 1551079593, "answer_id": 54861336, "question_id": 54827529, "link": "https://stackoverflow.com/questions/54827529/module-cannot-be-found-locally-when-running-detailed-0-9-test-suite-with-haske/54861336#54861336", "title": "&quot;module cannot be found locally&quot; when running detailed-0.9 test suite with Haskell Stack", "body": "<h2>Update</h2>\n\n<p>Seems this is actually a bug with Stack, which has already been reported <a href=\"https://github.com/commercialhaskell/stack/issues/4453\" rel=\"nofollow noreferrer\">here</a>\nand fixed\n<a href=\"https://github.com/commercialhaskell/stack/commit/75e1091a22e97280b716340468082e26d40e3f88\" rel=\"nofollow noreferrer\">here</a> (although the fix is not available in the latest release yet).</p>\n"}], "owner": {"reputation": 3352, "user_id": 98600, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5738c02070833b70609a7fe8f0b75eef?s=128&d=identicon&r=PG", "display_name": "John J. Camilleri", "link": "https://stackoverflow.com/users/98600/john-j-camilleri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 54861336, "answer_count": 1, "score": 1, "last_activity_date": 1551079593, "creation_date": 1550839719, "last_edit_date": 1551079561, "question_id": 54827529, "link": "https://stackoverflow.com/questions/54827529/module-cannot-be-found-locally-when-running-detailed-0-9-test-suite-with-haske", "title": "&quot;module cannot be found locally&quot; when running detailed-0.9 test suite with Haskell Stack", "body": "<p>I have a Haskell project with a test suite using <code>detailed-0.9</code>. I can run the test correctly with <code>cabal</code>, but with <code>stack</code> I get errors. The <code>exitcode-stdio-1.0</code> test suites seem to work fine.</p>\n\n<h1>MWE</h1>\n\n<p>Below is a minimum working example, containing both test-suite types. A full repository is available <a href=\"https://github.com/johnjcamilleri/stack-test-detailed\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><strong>stack-test-detailed.cabal</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>name: stack-test-detailed\nversion: 0.1.0.0\nbuild-type: Simple\ncabal-version: &gt;=1.20\n\ntest-suite exitcode\n  type: exitcode-stdio-1.0\n  main-is: Exitcode.hs\n  other-modules: MyModule\n  build-depends: base &gt;=4.10\n  hs-source-dirs: src testsuite\n  default-language: Haskell2010\n\ntest-suite detailed\n  type: detailed-0.9\n  test-module: Detailed\n  other-modules: MyModule\n  build-depends: base &gt;=4.10, Cabal &gt;=1.20\n  hs-source-dirs: src testsuite\n  default-language: Haskell2010\n</code></pre>\n\n<p><strong>src/MyModule.hs</strong></p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>module MyModule where\n\nmyFunction :: Int\nmyFunction = 1\n</code></pre>\n\n<p><strong>testsuite/Exitcode.hs</strong></p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>import MyModule (myFunction)\nimport System.Exit (exitSuccess, exitFailure)\n\nmain :: IO ()\nmain =\n  if myFunction == 1\n  then exitSuccess\n  else exitFailure\n</code></pre>\n\n<p><strong>testsuite/Detailed.hs</strong></p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>module Detailed where\n\nimport MyModule (myFunction)\nimport Distribution.TestSuite\n\ntests :: IO [Test]\ntests = return\n  [ Test $ TestInstance\n    { run = return $ Finished $ if myFunction == 1 then Pass else Fail \"not equal 1\"\n    , name = \"my test\"\n    , Distribution.TestSuite.tags = []\n    , options = []\n    , setOption = \\opt val -&gt; Left \"options not supported\"\n    }\n  ]\n</code></pre>\n\n<p><strong>stack.yaml</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>resolver: lts-11.22\n</code></pre>\n\n<hr>\n\n<h1>Output</h1>\n\n<h2>cabal</h2>\n\n<p>Everything works normally:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ cabal test exitcode\nPreprocessing test suite 'exitcode' for stack-test-detailed-0.1.0.0..\nBuilding test suite 'exitcode' for stack-test-detailed-0.1.0.0..\nRunning 1 test suites...\nTest suite exitcode: RUNNING...\nTest suite exitcode: PASS\nTest suite logged to: dist/test/stack-test-detailed-0.1.0.0-exitcode.log\n1 of 1 test suites (1 of 1 test cases) passed.\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ cabal test detailed\nPreprocessing test suite 'detailed' for stack-test-detailed-0.1.0.0..\nBuilding test suite 'detailed' for stack-test-detailed-0.1.0.0..\n[1 of 1] Compiling Main             ( dist/build/detailedStub/detailedStub-tmp/detailedStub.hs, dist/build/detailedStub/detailedStub-tmp/Main.o )\nLinking dist/build/detailedStub/detailedStub ...\nRunning 1 test suites...\nTest suite detailed: RUNNING...\nTest suite detailed: PASS\nTest suite logged to: dist/test/stack-test-detailed-0.1.0.0-detailed.log\n1 of 1 test suites (1 of 1 test cases) passed.\n</code></pre>\n\n<h3>stack</h3>\n\n<p>Exitcode test works:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ stack test :exitcode\nstack-test-detailed-0.1.0.0: build (test)\nPreprocessing test suite 'exitcode' for stack-test-detailed-0.1.0.0..\nBuilding test suite 'exitcode' for stack-test-detailed-0.1.0.0..\nstack-test-detailed-0.1.0.0: test (suite: exitcode)\n\n\nstack-test-detailed-0.1.0.0: Test suite exitcode passed\nCompleted 2 action(s).\n</code></pre>\n\n<p>Detailed test fails to compile:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ stack test :detailed\nstack-test-detailed-0.1.0.0: build (test)\nPreprocessing test suite 'detailed' for stack-test-detailed-0.1.0.0..\nBuilding test suite 'detailed' for stack-test-detailed-0.1.0.0..\n\n&lt;no location info&gt;: error:\n    module \u2018MyModule\u2019 cannot be found locally\n\nProgress 1/2\n\n--  While building custom Setup.hs for package stack-test-detailed-0.1.0.0 using:\n      /Users/john/.stack/setup-exe-cache/x86_64-osx/Cabal-simple_mPHDZzAJ_2.0.1.0_ghc-8.2.2 --builddir=.stack-work/dist/x86_64-osx/Cabal-2.0.1.0 build test:detailed --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<hr>\n\n<p>From looking around I gather that <code>detailed-0.9</code> is somehow uncool and people just seem to give up on it immediately. But it is <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html?highlight=test%20suite#example-package-using-detailed-0-9-interface\" rel=\"nofollow noreferrer\">properly documented</a> and indeed works with <code>cabal</code>, so I don't see why <code>stack</code> should fail with it.</p>\n"}, {"tags": ["haskell", "emacs", "spacemacs", "intero"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1550832135, "post_id": 54825278, "comment_id": 96425322, "body": "Did you try <code>:reload</code> ?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1550832280, "post_id": 54825278, "comment_id": 96425414, "body": "I updated my post"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1550833593, "post_id": 54825278, "comment_id": 96426167, "body": "I&#39;m not sure you can do that, then. For fast prototyping, I usually do something like this: <code>stack build --fast --filewatch</code>."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1550836826, "post_id": 54825278, "comment_id": 96427913, "body": "I am using spacemacs and do not know, how to restart REPL"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1550842691, "post_id": 54825278, "comment_id": 96431305, "body": "Are you using intero?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550843367, "post_id": 54825278, "comment_id": 96431678, "body": "Yes, I am using intero. I followed this instruction <a href=\"http://spacemacs.org/layers/+lang/haskell/README.html\" rel=\"nofollow noreferrer\">spacemacs.org/layers/+lang/haskell/README.html</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1550849293, "creation_date": 1550849293, "answer_id": 54830306, "question_id": 54825278, "link": "https://stackoverflow.com/questions/54825278/how-to-reload-the-project-after-dependencies-is-added/54830306#54830306", "title": "How to reload the project after dependencies is added?", "body": "<p>I see you are using Spacemacs along with <code>intero</code>. In this case you may restart whole intero process by typing <code>M-x intero-restart RET</code>, or <code>M-RET i r</code> which will reload all stack dependencies.</p>\n\n<p>Another way to do this is to put your cursor on the error import and type <code>C-c C-r</code> to let the <code>intero</code> automatically fix the issue.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550851094, "creation_date": 1550832078, "last_edit_date": 1550851094, "question_id": 54825278, "link": "https://stackoverflow.com/questions/54825278/how-to-reload-the-project-after-dependencies-is-added", "title": "How to reload the project after dependencies is added?", "body": "<p>During the development, I've added a library to <code>package.yaml</code> and the <code>GHCi</code> is already started.</p>\n\n<p>For example, I've added the <code>bytestring</code> library: </p>\n\n<pre><code>executables:\n  playground-exe:\n    main:                Main.hs\n    source-dirs:         app\n    ghc-options:\n    - -threaded\n    - -rtsopts\n    - -with-rtsopts=-N\n    dependencies:\n    - playground\n    - text\n    - bytestring\n</code></pre>\n\n<p>Because I use it in a file that is called <code>Families.hs</code> and it contains the following code: </p>\n\n<pre><code>{-# LANGUAGE  TypeFamilies, OverloadedStrings #-}\n\nmodule Families where\n\nimport Data.Word (Word8)\nimport qualified Data.ByteString as BS \n</code></pre>\n\n<p>When I try to load the file, it complains: </p>\n\n<pre><code>:l ./src/Families.hs\n[1 of 1] Compiling Families         ( src/Families.hs, interpreted )\n\nsrc/Families.hs:6:1: error:\n    Could not load module \u2018Data.ByteString\u2019\n    It is a member of the hidden package \u2018bytestring-0.10.8.2\u2019.\n    You can run \u2018:set -package bytestring\u2019 to expose it.\n    (Note: this unloads all the modules in the current scope.)\n    Use -v to see a list of the files searched for.\n  |\n6 | import qualified Data.ByteString as BS\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>The question is, how to reload the whole project into the GHCi and allow usage of <code>bytestring</code> library. </p>\n\n<p><strong>UPDATE</strong><br>\nI also tried with <code>:reload</code> and got </p>\n\n<pre><code>:reload\n[1 of 1] Compiling Families         ( src/Families.hs, interpreted )\n\nsrc/Families.hs:6:1: error:\n    Could not load module \u2018Data.ByteString\u2019\n    It is a member of the hidden package \u2018bytestring-0.10.8.2\u2019.\n    You can run \u2018:set -package bytestring\u2019 to expose it.\n    (Note: this unloads all the modules in the current scope.)\n    Use -v to see a list of the files searched for.\n  |\n6 | import qualified Data.ByteString as BS\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1550830806, "post_id": 54824350, "comment_id": 96424515, "body": "You can also enable it within GHCi by typing <code>:set -XOverloadedStrings</code>"}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": false, "score": 3, "last_activity_date": 1550829720, "last_edit_date": 1550829720, "creation_date": 1550829066, "answer_id": 54824350, "question_id": 54824085, "link": "https://stackoverflow.com/questions/54824085/how-to-get-the-text-type/54824350#54824350", "title": "How to get the text type?", "body": "<p>You also need to enable <code>OverloadedStrings</code> in ghci itself. Run it like this:</p>\n\n<p><code>ghci -XOverloadedStrings file.hs</code></p>\n\n<p>and then it should work:</p>\n\n<pre><code>&gt; :t something (\"hello\" :: Text) \nsomething (\"hello\" :: Text) :: IO ()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1550861320, "post_id": 54824657, "comment_id": 96441642, "body": "Generally, instead of <code>:set -XWhatever</code>, it&#39;s nicer to use <code>:seti -XWhatever</code> \u2013 that only sets <code>-XWhatever</code> for the interactive mode.  With <code>:set</code>, GHCi will interpret all future <code>:load</code>ed files with <code>-XWhatever</code>, leading to strange errors when you try to compile those files and discover that <code>-XWhatever</code> isn&#39;t enabled for them."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 6, "last_activity_date": 1550831143, "last_edit_date": 1550831143, "creation_date": 1550830039, "answer_id": 54824657, "question_id": 54824085, "link": "https://stackoverflow.com/questions/54824085/how-to-get-the-text-type/54824657#54824657", "title": "How to get the text type?", "body": "<p>There is nothing problematic with your code. Doing something like this itself would result in such an error:</p>\n\n<pre><code>\u03bb&gt; import Data.Text\n\u03bb&gt; let t = \"hello world\" :: Text\n\n&lt;interactive&gt;:11:9: error:\n    \u2022 Couldn't match expected type \u2018Text\u2019 with actual type \u2018[Char]\u2019\n    \u2022 In the expression: \"hello world\" :: Text\n      In an equation for \u2018t\u2019: t = \"hello world\" :: Text\n</code></pre>\n\n<p>But you can do that fine with <code>String</code>:</p>\n\n<pre><code>\u03bb&gt; let t = \"hello world\" :: String\n</code></pre>\n\n<p>Note that even though your file has <code>OverloadedString</code> extension in it, it won't be loaded when you load that file in the repl. You can see the currently loaded extensions like this:</p>\n\n<pre><code>\u03bb&gt; :show language\nbase language is: Haskell2010\nwith the following modifiers:\n  -XNoDatatypeContexts\n  -XNondecreasingIndentation\n</code></pre>\n\n<p>You can use the <code>OverloadedStrings</code> extension to annotate it to <code>Text</code> or even <code>ByteString</code>.</p>\n\n<pre><code>\u03bb&gt; :set -XOverloadedStrings\n\u03bb&gt; :show language\nbase language is: Haskell2010\nwith the following modifiers:\n  -XNoDatatypeContexts\n  -XNondecreasingIndentation\n  -XOverloadedStrings\n\u03bb&gt; let t = \"hello\" :: Text\n\u03bb&gt; import Data.ByteString\n\u03bb&gt; let t = \"hello\" :: ByteString\n</code></pre>\n\n<p>With the above extension set in repl, your code will work:</p>\n\n<pre><code>\u03bb&gt; :t something (\"hello\" :: Text) \nsomething (\"hello\" :: Text) :: IO ()\n\u03bb&gt; something (\"hello\" :: Text) \nText\n</code></pre>\n\n<p>The OverloadedStrings extension adds support for overloaded strings. You can find more detabils about it <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-OverloadedStrings\" rel=\"nofollow noreferrer\">here</a>. Short explanation of it: By definining your type to be an instance of <code>IsString</code> typeclass, you can denote it via String literal:</p>\n\n<pre><code>import GHC.Exts (IsString(..))\n\ndata MyFancyText =\n  MyFancyText String\n  deriving (Show, Eq, Ord)\n\ninstance IsString MyFancyText where\n  fromString str = MyFancyText str\n</code></pre>\n\n<p>And then in REPL:</p>\n\n<pre><code>\u03bb&gt; let xs = \"hello\" :: MyFancyText\n\u03bb&gt; :t xs\nxs :: MyFancyText\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 54824657, "answer_count": 2, "score": 5, "last_activity_date": 1550831143, "creation_date": 1550828211, "question_id": 54824085, "link": "https://stackoverflow.com/questions/54824085/how-to-get-the-text-type", "title": "How to get the text type?", "body": "<p>I've the following code </p>\n\n<pre><code> {-# LANGUAGE OverloadedStrings, TypeSynonymInstances, FlexibleInstances #-}\n\nmodule Lib where\n\nimport Data.Text (Text)\n\nclass DoSomething a where\n  something :: a -&gt; IO ()\n\ninstance DoSomething String where\n  something _ = putStrLn \"String\"\n\n\ninstance DoSomething Text where\n  something _ = putStrLn \"Text\" \n</code></pre>\n\n<p>And in REPL, I tried to get an instance of <code>Text</code> type as the following: </p>\n\n<pre><code>:t something (\"hello\" :: Text) \n</code></pre>\n\n<p>and the compiler complains:</p>\n\n<pre><code>&lt;interactive&gt;:1:12: error:\n    \u2022 Couldn't match expected type \u2018Text\u2019 with actual type \u2018[Char]\u2019\n    \u2022 In the first argument of \u2018something\u2019, namely \u2018(\"hello\" :: Text)\u2019\n      In the expression: something (\"hello\" :: Text)\n</code></pre>\n\n<p>By default, it will take the <code>String</code> type : </p>\n\n<pre><code>:t something \"hello\"\nsomething \"hello\" :: IO ()\n</code></pre>\n\n<p>How to get <code>Text</code> type instead of <code>String</code> type?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550823765, "post_id": 54822736, "comment_id": 96420436, "body": "Not entirely sure I understand the question - but can&#39;t you just use a <code>newtype</code>? Or even a type synonym if your instances are actually identical (as they appear to be)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550823841, "post_id": 54822736, "comment_id": 96420475, "body": "Regarding <code>isWithinBound</code>, it&#39;s trivial to rewrite so it takes a <code>Maybe a</code> instead of your custom version."}, {"owner": {"reputation": 11495, "user_id": 465056, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/75b35db6dc6eb2514b4d584e54443d30?s=128&d=identicon&r=PG", "display_name": "rexcfnghk", "link": "https://stackoverflow.com/users/465056/rexcfnghk"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550824329, "post_id": 54822736, "comment_id": 96420700, "body": "@RobinZigmond I mean I want to still expose the cases as <code>UpperBound&#47;DoNotCare</code> but internally forward to instance declarations to a <code>Maybe</code> implementation. Is that possible?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1550824453, "post_id": 54822736, "comment_id": 96420762, "body": "&quot;The typeclass instances look almost the same as the ones for Maybe&quot; where does the &quot;almost&quot; part come from?"}, {"owner": {"reputation": 11495, "user_id": 465056, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/75b35db6dc6eb2514b4d584e54443d30?s=128&d=identicon&r=PG", "display_name": "rexcfnghk", "link": "https://stackoverflow.com/users/465056/rexcfnghk"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1550825782, "post_id": 54822736, "comment_id": 96421435, "body": "@n.m. you can <i>almost</i> do a global regex replace of <code>UpperBound</code> to <code>Just</code> and <code>DoNotCare</code> to <code>None</code> in all the implementation of typeclass instances and the code will still compile for the <code>Maybe</code> type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1550864558, "post_id": 54822736, "comment_id": 96442998, "body": "That <code>Alternative</code> instance looks sketchy to me. It&#39;s supposed to be a monoid for each contained type (with <code>empty</code> as the unit and <code>&lt;|&gt;</code> as the operation) -- and in particular it&#39;s supposed to have <code>empty &lt;|&gt; x = x &lt;|&gt; empty = x</code>, which yours does not."}, {"owner": {"reputation": 11495, "user_id": 465056, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/75b35db6dc6eb2514b4d584e54443d30?s=128&d=identicon&r=PG", "display_name": "rexcfnghk", "link": "https://stackoverflow.com/users/465056/rexcfnghk"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1551624209, "post_id": 54822736, "comment_id": 96699536, "body": "@DanielWagner you are right. I have changed my code to fix that confusion."}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550827751, "post_id": 54822902, "comment_id": 96422534, "body": "I never realised <code>GeneralizedNewtypeDeriving</code> didn&#39;t work for <code>Traversable</code> (I&#39;ve never used it other than for <code>Functor</code>, <code>Applicative</code> and <code>Monad</code>). I&#39;m curious as to why this might be."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1550870549, "post_id": 54822902, "comment_id": 96445427, "body": "@RobinZogmond If newtype U x = U (T x) and Traversable T, then traverse returns a f (T x) where you need a f (U x). GHC wants a zero-cost coercion between the two, but there isn\u2019t one. You\u2019d need to fmap U, and GHC won\u2019t do that by itself. Now, since Functor f, morally f should always be type role f representational, and there <i>should</i> be a coercion available, but 1) Traversable doesn\u2019t have that constraint on it 2) There are some \u201cbroken\u201d but useful functors breaking this rule 3) GND probably can\u2019t use the information even if it\u2019s given and 4) such constraints are a very new GHC extension."}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 3, "last_activity_date": 1550824094, "creation_date": 1550824094, "answer_id": 54822902, "question_id": 54822736, "link": "https://stackoverflow.com/questions/54822736/how-can-i-rewrap-typeclass-instances/54822902#54822902", "title": "How can I rewrap typeclass instances", "body": "<p>The easiest way is to use <code>newtype</code> and <code>GeneralizedNewtypeDeriving</code> extension, like this:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving, DeriveTraversable #-}\nmodule UpperBound (UpperBound, isWithinBound) where\n\nimport Control.Monad\nimport Control.Applicative\n\nnewtype UpperBound a = UpperBound { unUpperBound :: Maybe a }\n  deriving (Functor, Applicative, Foldable, Traversable, Alternative, Monad, MonadPlus)\n\nisWithinBound :: Ord a =&gt; a -&gt; UpperBound a -&gt; Bool\nisWithinBound x = maybe True ((&lt;=) x) . unUpperBound\n</code></pre>\n\n<p>So all the instances you need are automatically redirected to those of <code>Maybe</code> (besides <code>Traversable</code> which is derived automatically using the <code>DeriveTraversable</code> extension).</p>\n"}], "owner": {"reputation": 11495, "user_id": 465056, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/75b35db6dc6eb2514b4d584e54443d30?s=128&d=identicon&r=PG", "display_name": "rexcfnghk", "link": "https://stackoverflow.com/users/465056/rexcfnghk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 54822902, "answer_count": 1, "score": 2, "last_activity_date": 1613794920, "creation_date": 1550823380, "last_edit_date": 1613794920, "question_id": 54822736, "link": "https://stackoverflow.com/questions/54822736/how-can-i-rewrap-typeclass-instances", "title": "How can I rewrap typeclass instances", "body": "<p>I want to represent a concept of an upper bound in my code so I created a discriminated union:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data UpperBound a = UpperBound a | DoNotCare deriving (Eq, Read, Show)\n</code></pre>\n\n<p>I then manually derived several useful typeclass instances (for learning purposes):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Functor UpperBound where\n    fmap _ DoNotCare = DoNotCare\n    fmap f (UpperBound x) = UpperBound $ f x\n\ninstance Applicative UpperBound where\n    pure = UpperBound\n    DoNotCare &lt;*&gt; _ = DoNotCare\n    _ &lt;*&gt; DoNotCare = DoNotCare\n    (UpperBound f) &lt;*&gt; (UpperBound x) = UpperBound $ f x\n\ninstance Foldable UpperBound where\n    foldr _ s DoNotCare = s\n    foldr f s (UpperBound x) = f x s\n\ninstance Traversable UpperBound where\n    traverse _ DoNotCare = pure DoNotCare\n    traverse f (UpperBound x) = fmap UpperBound $ f x\n\ninstance Alternative UpperBound where\n    empty = DoNotCare\n    DoNotCare &lt;|&gt; x = x\n    x &lt;|&gt; DoNotCare = x\n    x &lt;|&gt; _ = x\n\ninstance Monad UpperBound where\n    return = pure\n    DoNotCare &gt;&gt;= _ = DoNotCare\n    (UpperBound x) &gt;&gt;= f = f x\n\ninstance MonadPlus UpperBound where\n    mzero = empty\n    mplus = (&lt;|&gt;)\n</code></pre>\n\n<p>and a single utility function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isWithinBound :: Ord a =&gt; a -&gt; UpperBound a -&gt; Bool\nisWithinBound _ DoNotCare = True\nisWithinBound x (UpperBound b) = x &lt;= b\n</code></pre>\n\n<p>The typeclass instances look almost the same as the ones for <code>Maybe</code> (<code>Just x</code> -> <code>UpperBound x</code>, <code>Nothing</code> -> <code>DoNotCare</code>) so it seems I am clearly having unnecessary duplication here.</p>\n\n<p>How can I somehow \u2018wrap\u2019 a <code>Maybe</code> and redirect the typeclass instances implementations to that and still expose the <code>isWithinBound</code> function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 426, "user_id": 5750098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0c257213453ee989b1d4f1565bdd7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Layne Bernardo", "link": "https://stackoverflow.com/users/5750098/layne-bernardo"}, "edited": false, "score": 0, "creation_date": 1550822304, "post_id": 54822437, "comment_id": 96419764, "body": "Same issue here: <a href=\"https://stackoverflow.com/questions/5941701/why-can-i-not-make-string-an-instance-of-a-typeclass\" title=\"why can i not make string an instance of a typeclass\">stackoverflow.com/questions/5941701/&hellip;</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1550859134, "post_id": 54822437, "comment_id": 96440617, "body": "Y&#39;all need to read more carefully.  @Cubic"}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1550823978, "post_id": 54822541, "comment_id": 96420548, "body": "The OP has already done this (or tried to) - it appears the real problem is that the pragmas are in the wrong place. You do mention this in your final paragraph, but I think it&#39;s better to be explicit."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550829124, "post_id": 54822541, "comment_id": 96423452, "body": "IIRC, <code>FlexibleInstances</code> implies <code>TypeSynonymInstances</code>."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 3, "last_activity_date": 1550822517, "creation_date": 1550822517, "answer_id": 54822541, "question_id": 54822437, "link": "https://stackoverflow.com/questions/54822437/illegal-instance-declaration-for-dosomething-string/54822541#54822541", "title": "Illegal instance declaration for \u2018DoSomething String\u2019", "body": "<p><code>String</code> is defined as <code>type String = [Char]</code>, I.e. it is a type synonym. The base language forbids writing class instances for type synonyms. You can either write this as <code>instance DoSomething [Char]</code> or otherwise turn on the <code>TypeSynonymInstances</code> language extension with a <code>{\u2014# LANGUAGE TypeSynonymInstances #-}</code> at the top of your file to make your existing code compile, as the error message suggests. </p>\n\n<p>Note that language extensions go on top of the file, not below the module declaration.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1550954477, "accepted_answer_id": 54822541, "answer_count": 1, "score": 1, "last_activity_date": 1550822517, "creation_date": 1550822030, "question_id": 54822437, "link": "https://stackoverflow.com/questions/54822437/illegal-instance-declaration-for-dosomething-string", "closed_reason": "Duplicate", "title": "Illegal instance declaration for \u2018DoSomething String\u2019", "body": "<p>I have following code, that does not compile: </p>\n\n<pre><code>module Lib where\n\n{-# LANGUAGE OverloadedStrings, TypeSynonymInstances, FlexibleInstances #-}\n\nimport Data.Text (Text)\n\nclass DoSomething a where\n  something :: a -&gt; IO ()\n\ninstance DoSomething String where\n  something _ = putStrLn \"String\"\n\n\ninstance DoSomething Text where\n  something _ = putStrLn \"Text\"\n</code></pre>\n\n<p>and compiler shows following error message: </p>\n\n<pre><code> :l ./src/Lib.hs\n[1 of 1] Compiling Lib              ( src/Lib.hs, interpreted )\n\nsrc/Lib.hs:10:10: error:\n    \u2022 Illegal instance declaration for \u2018DoSomething String\u2019\n        (All instance types must be of the form (T t1 ... tn)\n         where T is not a synonym.\n         Use TypeSynonymInstances if you want to disable this.)\n    \u2022 In the instance declaration for \u2018DoSomething String\u2019\n   |\n10 | instance DoSomething String where\n   |          ^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded.  \n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1550819578, "post_id": 54821606, "comment_id": 96418504, "body": "Why does it matter?  99.9% of the time, it&#39;s an implementation detail.  0.1% of the time, it&#39;s a minor detail in optimization."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1550822162, "post_id": 54821606, "comment_id": 96419707, "body": "The distinction only matters to compiler writers, not to language users."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550857023, "post_id": 54821606, "comment_id": 96439579, "body": "Without certain optimizations, <code>\\x -&gt; (+) (fib 23)</code> will recompute <code>fib 23</code> every application because it&#39;s under a lambda, whereas <code>(+ fib 23)</code> won&#39;t. But with &quot;full laziness&quot; (which I think is on by default with -O) they become equivalent.  You can test this difference in ghci though."}], "answers": [{"tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": false, "score": 3, "last_activity_date": 1550820453, "creation_date": 1550820453, "answer_id": 54822080, "question_id": 54821606, "link": "https://stackoverflow.com/questions/54821606/what-is-the-difference-between-4-and-x-4-x/54822080#54822080", "title": "What is the difference between ((+) 4) and \\x -&gt; (+) 4 x?", "body": "<p>One way to read this is that:</p>\n\n<ul>\n<li><p><code>((+) 4)</code> is an expression that produces the function: <code>\\x -&gt; (+) 4 x</code></p></li>\n<li><p><code>\\x -&gt; (+) 4 x</code> is that function already.</p></li>\n</ul>\n\n<p>And functions are not CAFs (we don't apply anything there).</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1550820453, "creation_date": 1550818380, "question_id": 54821606, "link": "https://stackoverflow.com/questions/54821606/what-is-the-difference-between-4-and-x-4-x", "title": "What is the difference between ((+) 4) and \\x -&gt; (+) 4 x?", "body": "<p>I am trying to understand CAF from the page <a href=\"https://wiki.haskell.org/Constant_applicative_form\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Constant_applicative_form</a> and confuse about the difference between <code>((+) 4)</code> and <code>\\x -&gt; (+) 4 x</code>?    </p>\n\n<p>Why is the first a CAF and the later not? As a beginner, I can not see the difference.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 696, "user_id": 3700414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280cc7f614a4aba6211500b20f87064a?s=128&d=identicon&r=PG&f=1", "display_name": "Rusi", "link": "https://stackoverflow.com/users/3700414/rusi"}, "edited": false, "score": 1, "creation_date": 1550817304, "post_id": 54821294, "comment_id": 96417621, "body": "a b are types eg Int Char etc.  They are passed to Tree not sizetree Think c&#177;+ template classes"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1550823551, "post_id": 54821294, "comment_id": 96420318, "body": "If you are new to Haskell then I would start with an easier tree, like <code>data Tree a = Empty | Node a (Tree a) (Tree a)</code> and forget about deriving. Now implement the function <code>size :: Tree a -&gt; Int</code>. It is not necessary to name it <code>sizeTree</code> as it follows from the rest of your signature that it is meant for trees."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1550825084, "post_id": 54821294, "comment_id": 96421086, "body": "<code>sizeTree</code> does not take three arguments <code>Tree</code>, <code>a</code>, and <code>b</code> but only a single one <code>(Tree a b)</code>. The latter is similar to C++ templates <code>Tree&lt;a,b&gt;</code>. That would be a tree having leaves carrying a value of type <code>a</code> while internal nodes carry a value of type <code>b</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 2, "creation_date": 1550822380, "post_id": 54821457, "comment_id": 96419799, "body": "Instead of writing <code>???</code> you can write <code>undefined</code>, which is even legal Haskell and will compile."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550824097, "post_id": 54821457, "comment_id": 96420607, "body": "Likewise you can use <code>error &quot;haven&#39;t done this yet&quot;</code> (or any other string of your choice) to make the error message (at runtime, this still compiles fine) more explicit."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550828129, "post_id": 54821457, "comment_id": 96422765, "body": "Or use <i>typed holes</i>, which will give you error messages explaining what types you need to fill them with and what types are on hand. <code>sizetree (Leaf x)  = _base; sizetree (Node y left right) = _recursive</code>. That said, question marks are great fillers in SO answers and I use them all the time."}], "tags": [], "owner": {"reputation": 696, "user_id": 3700414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280cc7f614a4aba6211500b20f87064a?s=128&d=identicon&r=PG&f=1", "display_name": "Rusi", "link": "https://stackoverflow.com/users/3700414/rusi"}, "is_accepted": false, "score": 1, "last_activity_date": 1550817733, "creation_date": 1550817733, "answer_id": 54821457, "question_id": 54821294, "link": "https://stackoverflow.com/questions/54821294/counting-number-of-nodes-in-tree-haskell/54821457#54821457", "title": "Counting number of Nodes in tree Haskell", "body": "<p>Start like this</p>\n\n<pre><code>sizetree (Leaf x)  = ???\nsizetree (Node y left right) = ???\n</code></pre>\n\n<p>Fill in the ???</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11034844"}, "edited": false, "score": 0, "creation_date": 1550857942, "post_id": 54824404, "comment_id": 96440037, "body": "Thank you so much this really explained everything!"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550858197, "post_id": 54824404, "comment_id": 96440163, "body": "Happy to help, please consider upvoting the answer and/or &quot;accepting&quot; it by clicking the tick icon."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 3, "last_activity_date": 1550867030, "last_edit_date": 1550867030, "creation_date": 1550829204, "answer_id": 54824404, "question_id": 54821294, "link": "https://stackoverflow.com/questions/54821294/counting-number-of-nodes-in-tree-haskell/54824404#54824404", "title": "Counting number of Nodes in tree Haskell", "body": "<p>Several of the comments have already addressed your confusion over the type signature, but I'll try another way to look at, in a bit more detail than a comment allows.</p>\n\n<p>We can compare this type signature:</p>\n\n<pre><code>sizeTree :: Tree a b -&gt; Int\n</code></pre>\n\n<p>with that of a function on lists, say the <code>length</code> function:</p>\n\n<pre><code>length :: [a] -&gt; Int \n</code></pre>\n\n<p>This function doesn't \"take an <code>a</code>\" as an argument, it takes a <code>[a]</code>, which stands for a list whose elements are of type <code>a</code>. The crucial thing is that <code>a</code>  can stand for <em>any</em> type - indeed it is legal to write it explicitly as <code>forall a. [a] -&gt; Int</code>, which makes clear that the function works on <code>any</code> list type. That is, the one <code>length</code> function can be applied to a list of Ints, or a list of Chars (that is, a String), or a list of lists of pairs of a <code>Double</code> and a list of <code>Integer</code>s - hopefully you get the idea. You probably take this for granted, that you can call <code>length [1,2,3]</code> and <code>length \"hello\"</code> and have them both work - but, given Haskell's strong type system, this only works because of polymorphic types.</p>\n\n<p>Exactly the same is going on with <code>Tree</code>. This is actually a \"type family\", like lists - it's not a type in itself, there are no values of type <code>Tree</code>. But there are values of types <code>Tree Int Char</code> or <code>Tree String (Int, Double)</code>, and anything else you can think of which uses two \"concrete types\" to stand for the <code>a</code> and <code>b</code>. And by declaring a function <code>sizeTree :: Tree a b -&gt; Int</code> - explicitly <code>sizeTree :: forall a. forall b. Tree a b -&gt; Int</code> - you ensure that it works for any of these infinitely many different concrete types.</p>\n\n<p>As for writing the function itself, again it's similar to lists. The list type, although inbuilt to Haskell, has essentially two constructors, one for the empty list, and one which takes an element and an existing list (you can define the equivalent type yourself as <code>data List a = Null | Cons a (List a)</code> - which means you can pattern match on these two constructors, to do:</p>\n\n<pre><code>length Null = 0\nlength (Cons _ l) = 1 + length l\n</code></pre>\n\n<p>or, using the built-in \"syntactic sugar\" for Haskell's native list type:</p>\n\n<pre><code>length [] = 0\nlength (_:l) = 1 + length l\n</code></pre>\n\n<p>(if you're confused by the <code>_</code>, it stands for any value of the appropriate type, and means that in this case we don't care about it's value, I could have given it any name if you'd preferred, say <code>x</code>, and it would have meant exactly the same thing.)</p>\n\n<p>Hopefully this is enough background to help you understand what is happening, and fill out the start given to you by @Rusi - because those are the two constructors of your <code>Tree a b</code> type so you need to define the function on both of these. Further hint: the one for the <code>Node</code> constructor will involve recursive calls to <code>sizeTree</code>, just as the second line of the <code>length</code> definition also uses a recursive call.</p>\n\n<p>Any further questions, please feel free to ask.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11034844"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 54824404, "answer_count": 2, "score": 0, "last_activity_date": 1550907378, "creation_date": 1550817052, "last_edit_date": 1550907378, "question_id": 54821294, "link": "https://stackoverflow.com/questions/54821294/counting-number-of-nodes-in-tree-haskell", "title": "Counting number of Nodes in tree Haskell", "body": "<p>I am new to Haskell and still bit confused on some syntax pieces (coming from C/C++).</p>\n\n<p>I have this Tree data type (below) and constructor for t2 </p>\n\n<pre><code>data Tree a b = Leaf a                                                          \n              | Node b (Tree a b) (Tree a b)                                    \n     deriving (Eq, Show)\n\n t2 :: Tree Bool Int                                                             \n t2 = Node 17 (Node 2 (Leaf True)                                                \n                      (Node 7 (Leaf False)                                       \n                              (Leaf False)))                                     \n              (Leaf True)\n</code></pre>\n\n<p>I need to write a function that will go through and count the nodes of the tree </p>\n\n<pre><code> sizeTree :: Tree a b -&gt; Int\n</code></pre>\n\n<p>I am confused about why does sizeTree pass in an 'a' and 'b' for the function. Is it because there is a Leaf for 'a' and a Node for 'b'? I understand that this will need to be a recursively called but where should I start?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1550795990, "post_id": 54818349, "comment_id": 96412651, "body": "You mean <code>take 5 [1,2..]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 3, "last_activity_date": 1551305156, "last_edit_date": 1551305156, "creation_date": 1550801841, "answer_id": 54819118, "question_id": 54818349, "link": "https://stackoverflow.com/questions/54818349/testing-every-number-against-a-haskell-program/54819118#54819118", "title": "Testing every number against a haskell program", "body": "<h1>First off</h1>\n\n<p>Let's start by saying that you should have a read on <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>. What have you tried already? Why is it now working? Do you have any code of yours that is anywhere close to be working? As you seem a complete beginner, have a look at <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">Learn You a Haskell</a></p>\n\n<p>However this is a very easy question, so I will just give you the answer</p>\n\n<h1>Analyse the problem</h1>\n\n<p>This is fairly straight forward, you need a function <code>evens :: Int -&gt; [Int]</code></p>\n\n<h1>Most basic solution</h1>\n\n<p>Haskell has a list constructor that, in its most basic form, gives you a list of consecutive numbers: <code>[1..10]</code> will give you all the numbers from 1 to 10. Because Haskell is a lazy language, you do not need to give it an upper bound. I.e. <code>[1..]</code> will just return a list with all the numbers.</p>\n\n<p>You can also run it with an interval, say 2 for even numbers: <code>[2,4..10]</code> will give you the evens from 2 to 10. So the function you need is indeed:</p>\n\n<pre><code>firstEvens :: Int -&gt; [Int]\nfirstEvens n = [2,4..2*n]\n</code></pre>\n\n<p>This is also equivalent to</p>\n\n<pre><code>firstEvens' :: Int -&gt; [Int]\nfirstEvens' n = take n [2,4..]\n</code></pre>\n\n<h1>Recursion</h1>\n\n<p>Recursively, you can run your function. Each step you just multiply by two.</p>\n\n<pre><code>firstEvens'' :: Int -&gt; [Int]\nfirstEvens'' 0 = []\nfirstEvens'' n = 2*n : firstEvens' (n-1)\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 6054529, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b8000b90a650b4ec5fa36b9b270fb64?s=128&d=identicon&r=PG&f=1", "display_name": "Darkhail", "link": "https://stackoverflow.com/users/6054529/darkhail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "closed_date": 1550824976, "accepted_answer_id": 54819118, "answer_count": 1, "score": -5, "last_activity_date": 1551305156, "creation_date": 1550795859, "last_edit_date": 1550796617, "question_id": 54818349, "link": "https://stackoverflow.com/questions/54818349/testing-every-number-against-a-haskell-program", "closed_reason": "Needs details or clarity", "title": "Testing every number against a haskell program", "body": "<p>So I'm trying to write a program that tests technically 1 - infinity. Basically i want to use take to tell the program to give me a list of the amount that take asks for. So just to clarify if I input take 5 I want to get back [1,2,3,4,5].  </p>\n\n<p>-For further clarification I am trying to understand how to recursively call a program over and over for the amt of times take says. I am trying to write a program that will give me a list of the next x even numbers starting at 1 where x = the number that take says.</p>\n"}, {"tags": ["database", "haskell", "sqlite"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1550788653, "post_id": 54817112, "comment_id": 96410875, "body": "You should have the same asymptotic performance: log n + log m for query and for updating existing entries. I don&#39;t know btrees well enough to say for sure, but I imagine the same answer applies for adding new entries. Of course the constant factor will be different, and probably larger, than an in-memory map, but the advantage is you don&#39;t need to keep everything in memory."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1550828665, "post_id": 54817112, "comment_id": 96423145, "body": "Side note: <code>IntMap</code> is <i>almost always</i> better than <code>Map Int</code>."}], "owner": {"reputation": 195, "user_id": 3589776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f56049843011af085cd299d0f5d22eb6?s=128&d=identicon&r=PG&f=1", "display_name": "aclow", "link": "https://stackoverflow.com/users/3589776/aclow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1550787563, "creation_date": 1550787563, "question_id": 54817112, "link": "https://stackoverflow.com/questions/54817112/performance-implications-of-saving-an-iterated-map-in-a-single-database-table", "title": "Performance implications of saving an iterated map in a single database table", "body": "<p>I have a Haskell type that look essentially like this:</p>\n\n<pre><code>data Thing = Map Int (Map Int (DataInside Int Int Int))\n</code></pre>\n\n<p>(It is not a <code>Map (Int, Int) (DataInside Int Int Int)</code> because data of type <code>Map Int (DataInside Int Int Int)</code> which is associated to a first key of type <code>Int</code> is used quite often.)</p>\n\n<p>An inhabitant of this type needs to be persistently stored. So far it was being written to files using <code>Serialize</code> instances and <a href=\"https://hackage.haskell.org/package/cereal\" rel=\"nofollow noreferrer\">cereal</a>. (However, the data is kept in memory while the program is running, so the overhead of reading or writing a file occurs only when the program starts or exits.)</p>\n\n<p>I am considering storing this data in a SQLite database instead (and not in memory anymore). I was thinking of having a table with five columns (two for keys, so with a uniqueness constraint, and three for values) and accessing the values with pairs of keys.</p>\n\n<p>I am wondering what the performance implication of this would be. For example, how would looking up an entry with keys <code>i</code> and <code>j</code> compare to computing <code>(M.! j) . (M ! i)</code> (which should take around <code>O(log n + log m)</code> where n is the number of first keys and m is the maximum number of second keys for a first key)? How would it perform while updating an entry with given keys?</p>\n\n<p>As for the size of the data set, there are currently tens of different first keys, and tens of different second keys for each first key, but the data set is expected to grow (but there will always be roughly as many second key values for each first key value as there are first key values).</p>\n"}, {"tags": ["haskell", "type-inference", "type-signature"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1550765378, "post_id": 54811163, "comment_id": 96399701, "body": "In Haskell, it is strongly recommended to write a type signature before writing the actual definition for a function. This helps the compiler to spot some errors early, usually providing meaningful error messages. Without type signatures, the errors can be must less clear, or -even worse- the code might type check without errors, but with an unexpected type. The compiler will likely raise type errors much later in the code using the function, puzzling the programmer who does not understand what&#39;s wrong at that point. Indeed, there&#39;s nothing wrong there, the problem is above."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1550765518, "post_id": 54811163, "comment_id": 96399802, "body": "Your name implies you don&#39;t <i>want</i> to support arbitrary functors anyway, only the list functor. Use <code>map</code> instead of <code>fmap</code> to eliminate the polymorphism responsible for the monomorphism restriction rearing its ugly had."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1550765592, "post_id": 54811163, "comment_id": 96399854, "body": "Further, certain advanced Haskell features (rank N types, type families, GADTs, ...) can not work unless the programmer provides types explicitly. Haskell is a programming languages where types are a central notion. Programming in Haskell with certain libraries sometimes requires thinking about types more than thinking about code."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550773779, "post_id": 54811163, "comment_id": 96404313, "body": "@chepner: sorry. Unlucky naming. It is a genuine question, considering the usual typesigs are relatively easy to understand, but wandering into the realm of abstracts it get a lot harder. Next to that, type inference does not save me in the example."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1550773851, "post_id": 54811163, "comment_id": 96404345, "body": "@chi, thanks for the second comments. I will put some more effort in understanding the typesigs and designing them prior to the code."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1550780538, "post_id": 54811163, "comment_id": 96407570, "body": "I don&#39;t know what you mean by &quot;memorizing&quot;. You don&#39;t memorize type signatures, you just decide what arguments your function accepts and what it returns, and you write that down. It&#39;s always good to do this before you write the function, as the typesig is less complicated, so you&#39;re less likely to get bogged down in the implementation details. It seems like what you&#39;re having trouble with is possibly what specific types or typeclasses mean (like <code>Functor</code>) and when to use them in a typesig? That just comes with practice, and usually you needn&#39;t be so general unless you have a reason."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1550802887, "post_id": 54811163, "comment_id": 96413968, "body": "@DarthFennec, when dealing with polymorphic recursion, it&#39;s pretty common for the (mandatory) type signature to be the hardest part."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1550815960, "post_id": 54811163, "comment_id": 96417127, "body": "@DarthFennec, dfeuer, thanks! Helpful comments. &#39;Memorizing&#39; is the wrong choice of words. However: usually <code>:type</code> helps me out (in learning) in <code>GHCi</code>, but that won&#39;t work in the  example code, since it won&#39;t compile. That led me to draw the conclusion that I first have to design the typesig, which I find very hard in some cases."}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1550765066, "answer_count": 0, "score": 0, "last_activity_date": 1550774268, "creation_date": 1550764457, "last_edit_date": 1550774268, "question_id": 54811163, "link": "https://stackoverflow.com/questions/54811163/haskell-memorizing-type-signature-in-detail", "closed_reason": "Duplicate", "title": "Haskell memorizing type signature in detail", "body": "<p>Have this example: </p>\n\n<pre><code>type Min = Int \ndata Prio = Low | Medium | High deriving Show\ndata Task = Task {\n    taskDesc    :: String \n  , taskPrio    :: Prio\n  , taskDur     :: Min\n} deriving Show \ntaskFromTuple :: (String, Prio, Min) -&gt; Task \ntaskFromTuple (tDesc, tPrio, tDur) = Task tDesc tPrio tDur\n-- tasksFromList :: Functor f =&gt; f (String, Prio, Min) -&gt; f Task\ntasksFromList = fmap taskFromTuple\n</code></pre>\n\n<p>If I omit <code>tasksFromList</code> typesig I get an error 'Ambiguous type var...'. Now this typesig seems relatively simple, but still one of many to memorize. Do I need to learn typesigs that well, that I can come up with exactly the right one, prior to writing the function? \nI basically understand what the typesigs mean, but they can get quite complex easily. </p>\n\n<p>Although related to the question on monomorphism restriction, the question is different, owing to the fact that I wanted to know if to put a lot of effort in learning to write typesigs prior to functions or to concentrate on functions and hope type inference would help me out. @Chi provided a clear answer.</p>\n"}, {"tags": ["haskell", "nix"], "answers": [{"comments": [{"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1550859612, "post_id": 54830744, "comment_id": 96440825, "body": "I can&#39;t quite get that to work. I get <code>Setup: Encountered missing dependencies: hspec &gt;=2.2.0 &amp;&amp; &lt;2.6, hspec-discover &gt;=2.2.0 &amp;&amp; &lt;2.6</code>."}, {"owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "reply_to_user": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1550871178, "post_id": 54830744, "comment_id": 96445692, "body": "Sometimes version bounds are too strict, or you may need to override multiple packages. In this case, you can also choose to ignore the tests. Some packages are easier to get right on a recent package set. See <a href=\"https://github.com/NixOS/nixpkgs/blob/master/pkgs/development/haskell-modules/lib.nix\" rel=\"nofollow noreferrer\">haskell.lib</a>, in particular <code>doJailbreak</code>, <code>dontCheck</code>."}], "tags": [], "owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "is_accepted": false, "score": 1, "last_activity_date": 1550850790, "creation_date": 1550850790, "answer_id": 54830744, "question_id": 54810851, "link": "https://stackoverflow.com/questions/54810851/how-can-i-build-a-haskell-dependency-from-a-github-source-nix-file-using-nix/54830744#54830744", "title": "How can I build a haskell dependency from a GitHub source .nix file, using nix?", "body": "<p>You can extend your haskell package set, similar to <a href=\"https://github.com/nix-community/todomvc-nix/blob/master/nix/backend/default.nix#L3\" rel=\"nofollow noreferrer\">this example</a>.</p>\n\n<p>The nix file for <code>clay</code> can be created with <code>cabal2nix</code></p>\n\n<pre><code>cabal2nix git://github.com/sebastiaanvisser/clay.git &gt; clay.nix\n</code></pre>\n\n<p>Assuming your .nix file is called <code>open-editions.nix</code>, your <code>default.nix</code> may look somewhat like:</p>\n\n<pre><code>let\n  pkgs = import &lt;nixpkgs&gt; {}; # or similar, I like to pin it with niv\n\n  hs = pkgs.haskellPackages.extend(self: super: { # (1) extend the package set\n    open-editions = self.callPackage ./open-editions.nix {};\n    clay = self.callPackage ./clay.nix {}; # (2) update clay\n  });\nin {\n  inherit (hs) open-editions; # (3) make nix-build pick up my-project;\n}\n</code></pre>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1550850790, "creation_date": 1550763494, "question_id": 54810851, "link": "https://stackoverflow.com/questions/54810851/how-can-i-build-a-haskell-dependency-from-a-github-source-nix-file-using-nix", "title": "How can I build a haskell dependency from a GitHub source .nix file, using nix?", "body": "<p>Ok, so I have a .nix file for my project that looks like this: </p>\n\n<pre><code>{ mkDerivation, base, blaze-html, clay, hakyll, hspec, stdenv }:\nmkDerivation {\n  pname = \"open-editions\";\n  version = \"0.1.0.0\";\n  src = ./.;\n  isLibrary = false;\n  isExecutable = true;\n  executableHaskellDepends = [ base blaze-html clay hakyll ];\n  testHaskellDepends = [ hspec ];\n  license = \"unknown\";\n  hydraPlatforms = stdenv.lib.platforms.none;\n}\n</code></pre>\n\n<p>(It's just a web project using hakyll.) The problem is, <code>clay</code> is broken in nixpkgs. But I'm assuming <code>clay</code> works on its master branch on GitHub. So how can I replace this haskell dependency <code>clay</code> with something that downloads and calls the GitHub package? The GitHub package has a bunch of .nix files there, so I'm guess it'd be relatively straightforward, but I don't really know where to start on this.</p>\n"}, {"tags": ["haskell", "compiler-errors", "functor", "type-mismatch", "algebraic-data-types"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1550752735, "post_id": 54807108, "comment_id": 96390908, "body": "<code>ShoppingList</code> already looks too complicated. If you just want a list of items, use <code>newtype ShoppingList a = SL [a]</code>. No need to represent empty lists and singleton lists as separate items, and your <code>Listofitems</code> lets you build <i>trees</i> of items, not just lists."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1550752791, "post_id": 54807108, "comment_id": 96390940, "body": "With this, the <code>Functor</code> instance becomes simply <code>fmap f (SL list) = SL (fmap f list)</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1550753460, "post_id": 54807108, "comment_id": 96391380, "body": "\u201cBut it&#39;s not compiling\u201d \u2013 so how about you post the error you&#39;re getting?"}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1550754564, "post_id": 54807108, "comment_id": 96392104, "body": "@chepner ,I just want to practice with some difficult problems ,using a single fmap"}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 2, "last_activity_date": 1551305224, "last_edit_date": 1592644375, "creation_date": 1550754390, "answer_id": 54807847, "question_id": 54807108, "link": "https://stackoverflow.com/questions/54807108/fmap-over-a-list-containing-single-elements-and-lists/54807847#54807847", "title": "Fmap over a list containing single elements and lists", "body": "<h1>Note on the data type</h1>\n<p>First of all, your data type is overly complicates. A list of items should indeed be a list, so you can should define <code>data ShoppingList' a = ShoppingList' [a]</code> as you are using lists in yours anyways. There is no need a Shopping List should be nested.</p>\n<h1>Solution to your question</h1>\n<p>If, however, you need it that way, this is a solution. Note I assumed you did not need a list of ShoppingLists, as your data definition already has a list in it. So you can call</p>\n<pre><code>--fmap :: (a -&gt; b) -&gt; ShoppingList a -&gt; ShoppingList b\nfmap _ Empty = Empty\nfmap f (Item i) = Item (f i)\nfmap f (Listofitems ls) = Listofitems $ map (fmap f) ls\n\n\n&gt;&gt;fmap (++ &quot;M&quot;) $ Listofitems [Item &quot;Apple&quot;, Empty, Listofitems [Item &quot;Banana&quot;, Empty]]\nListofitems [Item &quot;AppleM&quot;,Empty,Listofitems [Item &quot;BananaM&quot;,Empty]]\n</code></pre>\n<p>Note:</p>\n<ul>\n<li>You need quotes around your strings,</li>\n<li>You need to call it on a Listofitems</li>\n</ul>\n<p>Also remember the String append operations is not efficient with long strings in case you need performance</p>\n"}], "owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 54807847, "answer_count": 1, "score": 1, "last_activity_date": 1551305224, "creation_date": 1550752141, "last_edit_date": 1550755920, "question_id": 54807108, "link": "https://stackoverflow.com/questions/54807108/fmap-over-a-list-containing-single-elements-and-lists", "title": "Fmap over a list containing single elements and lists", "body": "<p>I have a data structure like so</p>\n\n<pre><code>data ShoppingList a\n  = Empty\n  | Item a \n  | Listofitems [ShoppingList a]\n  deriving (Show)\n</code></pre>\n\n<p>I am trying to write the fmap for this </p>\n\n<pre><code>instance Functor ShoppingList where\n  fmap f Empty    = Empty\n  fmap f (Item i) = Item (f i)\n  fmap f (Listofitems [Empty]) = Empty\n  fmap f (Listofitems ((Item a):Listofitems [as])) = Listofitems $ (fmap f (Item a)) (fmap f Listofitems [as])\n</code></pre>\n\n<p>This is what I wrote so far ,but its not compiling ,can you please help me understand what the problem here is , an explanation would be awesome . \nThe two errors that I am getting </p>\n\n<pre><code>src\\Ml.hs:19:33: error:\n    * Couldn't match expected type `[ShoppingList a]'\n                  with actual type `ShoppingList a0'\n    * In the pattern: Listofitems [as]\n      In the pattern: (Item a) : Listofitems [as]\n      In the pattern: Listofitems ((Item a) : Listofitems [as])\n    * Relevant bindings include\n        a :: a (bound at src\\Ml.hs:19:30)\n        f :: a -&gt; b (bound at src\\Ml.hs:19:8)\n        fmap :: (a -&gt; b) -&gt; ShoppingList a -&gt; ShoppingList b\n          (bound at src\\Ml.hs:16:3)\n   |\n19 |   fmap f (Listofitems ((Item a):Listofitems [as])) = Listofitems $ (fmap f (Item a)) (fmap f Listofitems [as])\n   |                                 ^^^^^^^^^^^^^^^^\n\nsrc\\Ml.hs:19:68: error:\n    * Couldn't match expected type `b -&gt; [ShoppingList b]'\n                  with actual type `ShoppingList b'\n    * The function `fmap' is applied to three arguments,\n      but its type `(a -&gt; b) -&gt; ShoppingList a -&gt; ShoppingList b'\n      has only two\n      In the second argument of `($)', namely\n        `(fmap f (Item a)) (fmap f Listofitems [as])'\n      In the expression:\n        Listofitems $ (fmap f (Item a)) (fmap f Listofitems [as])\n    * Relevant bindings include\n        f :: a -&gt; b (bound at src\\Ml.hs:19:8)\n        fmap :: (a -&gt; b) -&gt; ShoppingList a -&gt; ShoppingList b\n          (bound at src\\Ml.hs:16:3)\n   |\n19 |   fmap f (Listofitems ((Item a):Listofitems [as])) = Listofitems $ (fmap f (Item a)) (fmap f Listofitems [as])\n   |                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Basically if I have a list = [ Item Apple ,Empty , [Item Banana ,Empty ] ] \nI want fmap (++ M )list  to return [Item AppleM .Empty .[Item BananaM ,Empty]]</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550745181, "post_id": 54804840, "comment_id": 96386195, "body": "so <code>f</code> and <code>g</code> have to be on the same scope? <i>Here f and g form a minimal set of mutually depending bindings</i> what is the meaning of minimal?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550745594, "post_id": 54804840, "comment_id": 96386448, "body": "yes, to be able to refer to each other they must be in the same scope!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550745760, "post_id": 54804840, "comment_id": 96386550, "body": "the canonical answer (the duplicate) says : &quot;The monomorphism restriction affects restricted declaration groups.&quot; so the names in a restricted group are subject to the restriction."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550745923, "post_id": 54804840, "comment_id": 96386636, "body": "What does <i>subject to the restriction</i> mean? It is relevant for the restriction?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550745981, "post_id": 54804840, "comment_id": 96386672, "body": "that is defined further down in that answer."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550746347, "post_id": 54804840, "comment_id": 96386880, "body": "It means <i>f an g would become subject to the monomorphism restriction.</i>, that <code>f</code> and <code>g</code> are getting restricted right? Both become a particular type and the same type."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550755396, "post_id": 54804840, "comment_id": 96392656, "body": "not necessarily the same, but monomorphic. some type variable shared between the two, which gets monomorphic type, of course refers to the same type every time it is referenced, whether in <code>f</code>&#39;s or <code>g</code>&#39;s type."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1550745492, "last_edit_date": 1550745492, "creation_date": 1550744899, "answer_id": 54804840, "question_id": 54803349, "link": "https://stackoverflow.com/questions/54803349/what-does-declaration-group-mean-in-context-monomorphism-restriction/54804840#54804840", "title": "What does declaration group mean in context monomorphism restriction?", "body": "<p>Imagine a program</p>\n\n<pre><code>foo x =\n   let f n = g (n-1)\n       g n = f (n-2)\n       h n = 42*n\n   in\n      f (h x)\n</code></pre>\n\n<p>Here <code>f</code> and <code>g</code> form a minimal set of mutually depending bindings.</p>\n\n<p>They do not depend on <code>h</code>, nor does <code>h</code> depend on any of them. So we could re-write it as</p>\n\n<pre><code>foo x =\n  let  h n = 42*n    in\n    let f n = g (n-1)\n        g n = f (n-2)\n    in\n       f (h x)\n</code></pre>\n\n<p>but we couldn't break up the group of <code>f</code> and <code>g</code> -- they must go together, as each one of them refers to the other.</p>\n\n<p>Here, both <code>f</code> and <code>g</code> binding are function bindings, so they are <em>unrestricted</em>, but if we had <code>g = \\n -&gt; f (n-2)</code> there, it would mean that <code>g</code>'s binding is a simple pattern binding, and <em>both</em> <code>f</code> an <code>g</code> would become subject to the monomorphism restriction.</p>\n\n<p>We could say <code>h, f, g</code> are a set of bindings, but it is not minimal, because we can take <code>h</code> out of that group. Only when we can't take out any names anymore, we've got the minimal (i.e. the smallest in size) group. So if we re-write <code>g = \\n -&gt; f (n-2)</code>, <code>g</code> becomes simple pattern binding, becomes subject to the restriction, and <code>f</code> becomes subject to the restriction together with it, even though <code>f</code>'s bindind is a function binding. But <code>h</code> remains unaffected.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54804840, "answer_count": 1, "score": 2, "last_activity_date": 1550745492, "creation_date": 1550740712, "last_edit_date": 1550742841, "question_id": 54803349, "link": "https://stackoverflow.com/questions/54803349/what-does-declaration-group-mean-in-context-monomorphism-restriction", "title": "What does declaration group mean in context monomorphism restriction?", "body": "<p>I am trying to understand the monomorphism restriction with the help of <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">What is the monomorphism restriction?</a> but do not understand, what Section 4.5.1 of the report is trying to explain.</p>\n\n<blockquote>\n  <p>A declaration group is a minimal set of mutually dependent bindings.</p>\n</blockquote>\n\n<p>what exactly is a declaration group? Could someone provide an example?</p>\n"}, {"tags": ["haskell", "type-inference", "type-resolution"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1550746674, "post_id": 54806910, "comment_id": 96390134, "body": "I don&#39;t think these conditions are <i>necessary</i>, but rather that they are <i>sufficient</i>, i.e. they imply termination. You could write a set of instances which violate the Paterson conditions, yet they lead to termination. Further, consider migration to StackOverflow for more visibility: the Haskell community there (which includes myself) often deals with such questions."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1550757798, "post_id": 54806910, "comment_id": 96394248, "body": "Indeed there is even a proposal to replace them with a better condition <a href=\"https://github.com/ghc-proposals/ghc-proposals/pull/114\" rel=\"nofollow noreferrer\">github.com/ghc-proposals/ghc-proposals/pull/114</a>"}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1550788641, "post_id": 54806910, "comment_id": 96410872, "body": "The &#39;lecture about it&#39; is the paper linked from the Users Guide: &#39;Understanding ... via Constraint Handling Rules&#39;. There is no simpler detailed explanation.The wording you quote is quite clear, isn&#39;t it? You can switch off the conditions with <code>UndecidableInstances</code>. Then as @chi says, type inference might terminate. (GHC uses a simple stack depth limit to avoid infinite loop.) The conditions are there to make sure that each constraint in the context (and the constraint&#39;s context, etc) makes the problem smaller."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1550788909, "post_id": 54806910, "comment_id": 96410982, "body": "@Li-yau Xia, yes excellent catch. There&#39;s lots of examples and discussions in the comments. o.p. &quot;I only can find stuff about type inference&quot;: instance resolution is type inference; type inference needs instance resolution; because resolving to an instance then gives improved types using the Functional Dependencies."}], "migrated_from": {"other_site": {"aliases": ["http://computerscience.stackexchange.com"], "markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1439905020, "open_beta_date": 1332272936, "closed_beta_date": 1331060400, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/cs/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon.png", "audience": "students, researchers and practitioners of computer science", "site_url": "https://cs.stackexchange.com", "api_site_parameter": "cs", "logo_url": "https://cdn.sstatic.net/Sites/cs/Img/logo.png", "name": "Computer Science", "site_type": "main_site"}, "on_date": 1550751516, "question_id": 104652}, "owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1550754137, "creation_date": 1550740643, "last_edit_date": 1550754137, "question_id": 54806910, "link": "https://stackoverflow.com/questions/54806910/the-paterson-conditions-for-type-checking-in-haskell", "title": "The Paterson Conditions for Type Checking in Haskell", "body": "<p>Could someone please explain (or give me some examples or the process) on why are these conditions necessary for the termination of the instance resolution process in Haskell? Or at least a link where this algorithm is described.</p>\n\n<p>For example, I tried to find some lecture about it, but I only can find stuff about type inference and not this instance resolution process.</p>\n\n<p>I quote from <a href=\"https://downloads.haskell.org/~ghc/master/users-guide/glasgow_exts.html#instance-termination-rules\" rel=\"nofollow noreferrer\">Haskell User Guide</a></p>\n\n<blockquote>\n  <p>The rules are these:</p>\n  \n  <ol>\n  <li>The Paterson Conditions: for each class constraint <code>(C t1 ... tn)</code> in the context          \n  \n  <ol>\n  <li>No type variable has more occurrences in the constraint than in the head</li>\n  <li>The constraint has fewer constructors and variables (taken together and counting repetitions) than the head</li>\n  <li>The constraint mentions no type functions. A type function application can in principle expand to a type of arbitrary size, and\n  so are rejected out of hand</li>\n  </ol></li>\n  <li>The Coverage Condition. For each functional dependency, <code>\u27e8tvs\u27e9left -&gt; \u27e8tvs\u27e9</code> right, of the class, every type variable in <code>S(\u27e8tvs\u27e9right)</code> must appear in <code>S(\u27e8tvs\u27e9left)</code>, where <code>S</code> is the substitution mapping\n  each type variable in the class declaration to the corresponding type\n  in the instance head.</li>\n  </ol>\n</blockquote>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550740856, "post_id": 54803175, "comment_id": 96383385, "body": "Could you please give a simpler explanation about <code>Related concept is scope. Another is closure</code>. What do you exactly mean?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550743120, "post_id": 54803175, "comment_id": 96384854, "body": "scope is a related, but separate concept.  maybe it is better to ask a separate question."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550744513, "post_id": 54803175, "comment_id": 96385777, "body": "But how should I ask the question. Because I am not confidence with the topic"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550744585, "post_id": 54803175, "comment_id": 96385817, "body": "well, a scope (of a name / variable) is a region of code where that name&#39;s binding is visible; is a short answer."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550744635, "post_id": 54803175, "comment_id": 96385850, "body": "Thanks a lot again for your help."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550744651, "post_id": 54803175, "comment_id": 96385859, "body": "So all regions in code where you could legally use that name to refer to its value (its binding) is that name&#39;s scope. You&#39;re welcome. :)"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 2, "last_activity_date": 1550740223, "creation_date": 1550740223, "answer_id": 54803175, "question_id": 54802836, "link": "https://stackoverflow.com/questions/54802836/what-does-binding-mean-in-haskell/54803175#54803175", "title": "What does binding mean in Haskell?", "body": "<p><em>Binding</em> in Haskell means the same thing as it does in other functional languages: Lisp, Scheme, ML, ... . It binds a value to a name (or, a name to a value). </p>\n\n<p>So, yes, in <code>let { n = 10 } in n + n</code>, <code>n = 10</code> is a binding. </p>\n\n<p>Related concept is <em>scope</em>. Another is <em>closure</em>. Absent mutation as it is, both are simpler, in Haskell, than in non-pure languages (like Lisp, ML, etc.).</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 54803175, "answer_count": 1, "score": 1, "last_activity_date": 1550740223, "creation_date": 1550739156, "question_id": 54802836, "link": "https://stackoverflow.com/questions/54802836/what-does-binding-mean-in-haskell", "title": "What does binding mean in Haskell?", "body": "<p>I am reading about monomorphism restriction und it exists to binding.</p>\n\n<ol>\n<li>function binding</li>\n<li>pattern binding</li>\n</ol>\n\n<p>But I would like to know, what does binding mean in Haskell?  </p>\n\n<p>For example, is this a value binding? </p>\n\n<pre><code>n = 10\n</code></pre>\n"}, {"tags": ["haskell", "types", "polymorphism", "type-inference", "monomorphism-restriction"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550743646, "post_id": 54802567, "comment_id": 96385216, "body": "you can find the answer in the canonical duplicate, under <b>&quot;When does it happen?&quot;</b>. Specifically, it says &quot;When a pattern binding consists of only a variable name it&#39;s called a simple pattern binding.. <b>The monomorphism restriction applies to simple pattern bindings!</b>&quot;. As defined by the Haskell Report, referenced in that answer as well."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550743779, "post_id": 54802567, "comment_id": 96385314, "body": "@WillNess Let&#39;s continue in the chat. How to provide a it?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550743855, "post_id": 54802567, "comment_id": 96385365, "body": "@WillNess anyway, thanks a lot for your help."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1550744065, "post_id": 54802567, "comment_id": 96385499, "body": "@WillNess This sentence <i>The monomorphism restriction applies to simple pattern bindings!</i> makes it clear."}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1550743549, "answer_count": 0, "score": 4, "last_activity_date": 1550739102, "creation_date": 1550738174, "last_edit_date": 1550739102, "question_id": 54802567, "link": "https://stackoverflow.com/questions/54802567/what-makes-a-definition-subject-to-monomorphism-restriction", "closed_reason": "Duplicate", "title": "What makes a definition subject to monomorphism restriction?", "body": "<p>Why is this definition affected by the monomorphism restriction? </p>\n\n<pre><code>z = \\n -&gt; n  + 1 \n</code></pre>\n\n<p>and this isn't: </p>\n\n<pre><code>z n = n + 1\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell", "quasiquotes"], "answers": [{"tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 1, "last_activity_date": 1550722431, "last_edit_date": 1550722431, "creation_date": 1550719919, "answer_id": 54798813, "question_id": 54798284, "link": "https://stackoverflow.com/questions/54798284/how-can-i-write-a-pattern-quasi-quoter-in-haskell/54798813#54798813", "title": "How can I write a pattern quasi quoter in Haskell?", "body": "<p>Alright I think I've got it. Starting from the base string <code>s</code>, I can wrap that in <code>StringL</code> and <code>LitP</code> to get a literal string, which because of <code>Text</code>'s <code>IsString</code> instance will become a <code>Text</code>. From there I need to apply the <code>NonEmptyText</code> constructor using <code>ConP</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>compileNonEmptyTextPattern' :: String -&gt; Q TH.Pat\ncompileNonEmptyTextPattern' s = case mkNonEmptyText (pack s) of\n  Nothing -&gt; fail $ \"Invalid NonEmptyText: \" ++ s\n  Just (NonEmptyText txt) -&gt; pure $ ConP 'NonEmptyText [(LitP (StringL (T.unpack txt)))]\n</code></pre>\n\n<p>It's unfortunate that this is so much more verbose than the expression version, though! I wonder if there could be a typeclass for <code>Q Pat</code> like <code>Lift</code> is for <code>Q Exp</code>?</p>\n"}], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 54798813, "answer_count": 1, "score": 4, "last_activity_date": 1550722431, "creation_date": 1550716064, "question_id": 54798284, "link": "https://stackoverflow.com/questions/54798284/how-can-i-write-a-pattern-quasi-quoter-in-haskell", "title": "How can I write a pattern quasi quoter in Haskell?", "body": "<p>I use quasi quoters to create my smart-constructed data types at compile time. This looks something like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import qualified Data.Text as T\nimport Language.Haskell.TH.Quote (QuasiQuoter(..))\nimport Language.Haskell.TH (Q, Exp, Pat(..), Lit(..))\nimport Language.Haskell.TH.Syntax (Lift(..))\nimport qualified Language.Haskell.TH.Syntax as TH\nimport Instances.TH.Lift () -- th-lift-instances package\n\nnewtype NonEmptyText = NonEmptyText Text\n\ntextIsWhitespace :: Text -&gt; Bool\ntextIsWhitespace = T.all (== ' ')\n\nmkNonEmptyText :: Text -&gt; Maybe NonEmptyText\nmkNonEmptyText t = if textIsWhitespace t then Nothing else (Just (NonEmptyText t))\n\ncompileNonEmptyText :: QuasiQuoter\ncompileNonEmptyText = QuasiQuoter\n  { quoteExp = compileNonEmptyText'\n  , quotePat = error \"NonEmptyText is not supported as a pattern\"\n  , quoteDec = error \"NonEmptyText is not supported at top-level\"\n  , quoteType = error \"NonEmptyText is not supported as a type\"\n  }\n  where\n    compileNonEmptyText' :: String -&gt; Q Exp\n    compileNonEmptyText' s = case mkNonEmptyText (pack s) of\n      Nothing -&gt; fail $ \"Invalid NonEmptyText: \" ++ s\n      Just txt -&gt; [| txt |]\n</code></pre>\n\n<p>(I can provide a standalone working example if necessary\u2014I just pulled this example out of a larger codebase)</p>\n\n<p>Essentially, by just deriving <code>Lift</code> for my newtypes, I can place the data type in an expression quasi quoter <code>[| txt |]</code> to implement <code>quoteExp</code>.</p>\n\n<p>But I'm having trouble with <code>quotePat</code>. If I do e.g.:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Just txt -&gt; [p| txt |]\n</code></pre>\n\n<p>Then I get a warning that the first txt is unused, and the second shadows the first. I'm pretty sure that that pattern is just creating a new name <code>txt</code> rather than splicing in the in-scope <code>txt</code> like the expression quasi quoter did, since when I do:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: NonEmptyText -&gt; Bool\nf [compileNonEmptyText|test|] = True\nf _ = False\n</code></pre>\n\n<p>everything matches the first statement.</p>\n"}]