[{"tags": ["list", "function", "haskell", "recursion", "optimization"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1547668923, "post_id": 54224457, "comment_id": 95274821, "body": "What about <code>scanl f a (repeat b)</code>?"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 4, "creation_date": 1547669063, "post_id": 54224457, "comment_id": 95274877, "body": "Hint: <code>doit f (x:xs) = x : do_the_full_recursive_step f xs</code>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1547669862, "post_id": 54224457, "comment_id": 95275236, "body": "<i>&quot;Do you guys know how to optimise my code?&quot;</i> What do you mean by &quot;optimise&quot;? Have you timed its performance? What are you asking?"}, {"owner": {"reputation": 71, "user_id": 10903940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L1adn.jpg?s=128&g=1", "display_name": "codingbudgie", "link": "https://stackoverflow.com/users/10903940/codingbudgie"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1547669920, "post_id": 54224457, "comment_id": 95275271, "body": "Thank you. @AJFarmar no, I meant a way of shortening it."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1547669983, "post_id": 54224457, "comment_id": 95275316, "body": "@codingbudgie Use better names and lose some parentheses. Plus, <code>help = map</code>. That&#39;s everything."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1547670025, "post_id": 54224457, "comment_id": 95275337, "body": "@AJFarmar: <code>help</code> is not <code>map</code>, since it uses an accumulator <code>a</code> that is each time updated."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547670077, "post_id": 54224457, "comment_id": 95275360, "body": "@WillemVanOnsem ah you&#39;re right, <code>help f a b = iterate (flip f b) a</code>, rather."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1547690057, "post_id": 54224457, "comment_id": 95281636, "body": "Are you sure this code does what you want it to do?"}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1547724384, "post_id": 54224457, "comment_id": 95294460, "body": "isn&#39;t your desired function just <code>scanl</code>??"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10903940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L1adn.jpg?s=128&g=1", "display_name": "codingbudgie", "link": "https://stackoverflow.com/users/10903940/codingbudgie"}, "edited": false, "score": 0, "creation_date": 1547706500, "post_id": 54225012, "comment_id": 95285280, "body": "This works perfectly fine if i use it as <code>calculate f a b = tail . concatMap (replicate 1) . scanl f a $ b</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 71, "user_id": 10903940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L1adn.jpg?s=128&g=1", "display_name": "codingbudgie", "link": "https://stackoverflow.com/users/10903940/codingbudgie"}, "edited": false, "score": 0, "creation_date": 1547711993, "post_id": 54225012, "comment_id": 95287522, "body": "OK, but <code>concatMap (replicate 1)</code> is the same as <code>id</code> and <code>id . f</code> is the same as simply <code>f</code> itself. And with <code>replicate 1</code> you don&#39;t need the <code>tail</code> either."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1547704628, "last_edit_date": 1547704628, "creation_date": 1547671174, "answer_id": 54225012, "question_id": 54224457, "link": "https://stackoverflow.com/questions/54224457/haskell-recursively-applying-function-to-every-element-but-first/54225012#54225012", "title": "Haskell recursively applying function to every element but first?", "body": "<p><code>calculate f a b = tail . concatMap (replicate 2) . scanl f a $ b</code>. </p>\n\n<p>The replicate bit is probably in error. If so, then simply <code>calculate = scanl</code>. </p>\n\n<p>This translates the code, as the \"<code>[a, f(a,b), f(f(a,b),b, ..]</code>\" from the text contradicts it (and it contradicts the text itself, which talks of \"iterating <em>through</em> the list <code>b</code>\").</p>\n"}], "owner": {"reputation": 71, "user_id": 10903940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L1adn.jpg?s=128&g=1", "display_name": "codingbudgie", "link": "https://stackoverflow.com/users/10903940/codingbudgie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547725163, "creation_date": 1547668777, "last_edit_date": 1547725163, "question_id": 54224457, "link": "https://stackoverflow.com/questions/54224457/haskell-recursively-applying-function-to-every-element-but-first", "title": "Haskell recursively applying function to every element but first?", "body": "<p>So I've been doing this program which receives a function <code>f</code>, a number <code>a</code> and a list <code>b</code> and it should return a list <code>[a, f(a,b), f(f(a,b),b, ..]</code> iterating through the list <code>b</code> and using recursion. Do you guys know how I can optimize my code?</p>\n\n<pre><code>calculate :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; [a]\nhelp :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; [a]\n\nhelp f a (x:xs) = (f a x) : (calculate f (f a x) xs)\nhelp f a [] = []\n\ncalculate f a b = a : (help f a b)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 5, "creation_date": 1547666539, "post_id": 54223861, "comment_id": 95273720, "body": "You have many formatting errors, and on line 10-12, you have <code>data Streckenzug</code> with a member also named <code>Streckenzug</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1547666617, "post_id": 54223861, "comment_id": 95273756, "body": "A record member name can not start with an uppercase, or at least not without some extensions."}, {"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 1, "creation_date": 1547669248, "post_id": 54223861, "comment_id": 95274959, "body": "I would recommend copying your code into a file, and then in the same directory start <code>ghci</code> and then <code>:load FILENAME.hs</code>.  GHCI will parse and attempt to load your code.  You&#39;ll see a number of type mismatches and invocation errors."}], "answers": [{"comments": [{"owner": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 0, "creation_date": 1547670198, "post_id": 54224575, "comment_id": 95275410, "body": "<code>laenge</code> was supposed to compute the total length of a polygonal chain, I think..."}, {"owner": {"reputation": 49, "user_id": 10693224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N_a1QX2Y-sk/AAAAAAAAAAI/AAAAAAAAADY/UN58W7nkt4I/photo.jpg?sz=128", "display_name": "disccco", "link": "https://stackoverflow.com/users/10693224/disccco"}, "edited": false, "score": 0, "creation_date": 1547671995, "post_id": 54224575, "comment_id": 95276226, "body": "Thank you for helping me. if you have any reliable sources except learnyouahaskell i would be grateful if you let me know. By means of your help that the errors are of very simple nature. And andrey is absolutely right."}, {"owner": {"reputation": 49, "user_id": 10693224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N_a1QX2Y-sk/AAAAAAAAAAI/AAAAAAAAADY/UN58W7nkt4I/photo.jpg?sz=128", "display_name": "disccco", "link": "https://stackoverflow.com/users/10693224/disccco"}, "edited": false, "score": 0, "creation_date": 1548008291, "post_id": 54224575, "comment_id": 95380792, "body": "After trying to get a Solution for the example distanz pkt1 1.0 1.0 pkt2 2.0 2.0  I just got the error message variable not in scope pkt1 :: Punkt , Variable not in scope : pkt2 . Can anybody tell me the reason?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 49, "user_id": 10693224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N_a1QX2Y-sk/AAAAAAAAAAI/AAAAAAAAADY/UN58W7nkt4I/photo.jpg?sz=128", "display_name": "disccco", "link": "https://stackoverflow.com/users/10693224/disccco"}, "edited": false, "score": 0, "creation_date": 1548010168, "post_id": 54224575, "comment_id": 95381366, "body": "@disccco If you have another question, ask another question; do <i>not</i> post a comment."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1547669689, "last_edit_date": 1547669689, "creation_date": 1547669309, "answer_id": 54224575, "question_id": 54223861, "link": "https://stackoverflow.com/questions/54223861/haskell-2d-points-distance-and-length/54224575#54224575", "title": "Haskell 2D points distance and length", "body": "<p>The errors that GHC produces are most certainly helpful. Let's go through them one by one.</p>\n\n<p>Firstly, I get no parse error whatsoever, as long as I remove the spurious indentation at the start. Instead, I get this error:</p>\n\n<blockquote>\n<pre><code>main.hs:11:17: error:\n    Not in scope: type constructor or class \u2018Punkt..\u2019\n    No module named \u2018Punkt\u2019 is imported.</code></pre>\n</blockquote>\n\n<p>Looking at the relevant line, I see you've written <code>Punkt..</code> for no reason. This means nothing. This should just be <code>Punkt</code>. here is the correction, with better indentation.</p>\n\n<pre><code>data Streckenzug = Streckenzug {\n    streckenzug :: [Punkt] -- Correction here\n}  \n</code></pre>\n\n<p>When I fix this, the errors change. Let's go to the next:</p>\n\n<blockquote>\n<pre><code>main.hs:15:9: error:\n    \u2022 Couldn't match expected type \u2018Punkt\u2019\n                  with actual type \u2018(Float, Float)\u2019</code></pre>\n</blockquote>\n\n<p>Looking at the relevant line, I see that you're not matching on <code>Punkt</code>, but actually on <code>(Float, Float)</code>s. This is trivial to fix. Here is the solution, with better indentation:</p>\n\n<pre><code>distanz :: Punkt -&gt; Punkt -&gt; Float\ndistanz pkt1 pkt2 = sqrt (x' * x' + y' * y') -- Correction here\n where\n   x'= x pkt1 - x pkt2\n   y'= y pkt1 - y pkt2 -- Note the adjustment here.\n</code></pre>\n\n<p>Please understand that a <code>Punkt</code> is not simply a tuple of floats; it's treated seperately by the compiler.</p>\n\n<p>Unfortunately, I would try to correct your function <code>laenge</code>, but I cannot at all work out what you mean by it \u2013 the types are completely broken, and your intention is unclear. I would recommend learning from the above mistakes and trying again.</p>\n\n<p>All in all, however, the following file works:</p>\n\n<pre><code>data Punkt = Punkt \n  { x :: Float\n  , y :: Float \n  }\n\ndata Streckenzug = Streckenzug {\n    streckenzug :: [Punkt]\n}  \n\ndistanz :: Punkt -&gt; Punkt -&gt; Float\ndistanz pkt1 pkt2 = sqrt (x' * x' + y' * y')\n  where\n    x'= x pkt1 - x pkt2\n    y'= y pkt1 - y pkt2\n</code></pre>\n\n<p>The functions <code>p1</code> and <code>p2</code> are completely useless and so I've removed them; not only are they identical, but also are both of type <code>p1, p2 :: (a,b) -&gt; (a,b)</code>, in other words <code>p1 = p2 = id</code>.</p>\n"}], "owner": {"reputation": 49, "user_id": 10693224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N_a1QX2Y-sk/AAAAAAAAAAI/AAAAAAAAADY/UN58W7nkt4I/photo.jpg?sz=128", "display_name": "disccco", "link": "https://stackoverflow.com/users/10693224/disccco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1547669895, "creation_date": 1547666211, "last_edit_date": 1547669895, "question_id": 54223861, "link": "https://stackoverflow.com/questions/54223861/haskell-2d-points-distance-and-length", "title": "Haskell 2D points distance and length", "body": "<pre><code>-- (edit)\n-- Punkt = Point\n-- Streckenzug = Polygonal chain\n-- distanz = distance\n-- laenge = length\n-- (/edit)\n\ndata Punkt = Punkt \n  { x :: Float\n  , y :: Float \n  }\n\np1 (x1, x2) =(x1,x2)\np2 (y1, y2) =(y1,y2)\n\n\ndata Streckenzug = Streckenzug\u00a0{\nstreckenzug :: [Punkt..]\n}  \n\ndistanz :: Punkt -&gt; Punkt -&gt; Float\ndistanz (x1,y1) (x2,y2) = sqrt (x' * x' + y' * y')\n where\n x'= x1-x2\n y'= y1-y2\n\n\nlaenge :: Streckenzug -&gt; Float\nlaenge (x:xs) = if length Streckenzug &lt; 2\n                    then Streckenzug\n                    else sum([distanz p1 p2 | (p1,p2) &lt;- xs ]  )\n</code></pre>\n\n<p>Could somebody tell me why I am getting the parse error on Streckenzug?\nThe errors that Haskell puts out aren't really helpful.</p>\n\n<p>We have the data Punkt which shall be a point in a two dimensional coordinateesystem\nand the data Streckenzug which is a list of points\nlater on the functions distanz and laenge (length) shall give us the as the sum between adjacent points . </p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "is_accepted": true, "score": 2, "last_activity_date": 1547673112, "creation_date": 1547673112, "answer_id": 54225433, "question_id": 54223773, "link": "https://stackoverflow.com/questions/54223773/c-directory-in-haskell-cabal-file/54225433#54225433", "title": "C directory in Haskell .cabal file", "body": "<p>Try: <code>c-sources: src/c/*.c</code></p>\n\n<p><code>**</code> wildcards were added in Cabal 2.4</p>\n\n<p>Wildcard examples from here: <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html?highlight=c%20source#pkg-field-data-files\" rel=\"nofollow noreferrer\">https://www.haskell.org/cabal/users-guide/developing-packages.html?highlight=c%20source#pkg-field-data-files</a></p>\n"}], "owner": {"reputation": 630, "user_id": 6707737, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bc7b6d3815e8d4e653eea177739b3558?s=128&d=identicon&r=PG&f=1", "display_name": "Yan.F", "link": "https://stackoverflow.com/users/6707737/yan-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 54225433, "answer_count": 1, "score": 1, "last_activity_date": 1547673112, "creation_date": 1547665839, "question_id": 54223773, "link": "https://stackoverflow.com/questions/54223773/c-directory-in-haskell-cabal-file", "title": "C directory in Haskell .cabal file", "body": "<p>I have this .cabal file: </p>\n\n<pre><code>  ...\n  main-is:             Main.hs\n  other-extensions:    ForeignFunctionInterface\n  build-depends:       base &gt;=4.9 &amp;&amp; &lt;4.10\n  hs-source-dirs:      src/haskell\n  c-sources:           src/c/main.c ... \n  default-language:    Haskell2010\n</code></pre>\n\n<p>I have a lots of c source files, all in one directory(src/c), is there a way to add them all without specifying each one? something like a regex:</p>\n\n<pre><code>-- I know this won't work\nc-sources:           src/c/** \n</code></pre>\n\n<p>Or just including the whole directory:</p>\n\n<pre><code>-- I know this won't work\nc-source-dirs:      src/c\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["loops", "haskell", "recursion", "counting"], "comments": [{"owner": {"reputation": 3127, "user_id": 7096763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1843972ea822c36c0c024d2ddcc8d7?s=128&d=identicon&r=PG&f=1", "display_name": "MikaelF", "link": "https://stackoverflow.com/users/7096763/mikaelf"}, "edited": false, "score": 5, "creation_date": 1547656376, "post_id": 54221367, "comment_id": 95268652, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41791904/how-to-count-the-recursion-times-in-haskell\">How to count the recursion times in Haskell?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1547664165, "post_id": 54221935, "comment_id": 95272627, "body": "&quot;There&#39;s no other way to do this&quot; - not quite: you can do this with a new output and no new input. In the base case, return 0 for your counter, and in recursive cases add 1 to the result produced by the recursive call."}, {"owner": {"reputation": 302, "user_id": 7618662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FRMsr.jpg?s=128&g=1", "display_name": "ThatOneDeveloper", "link": "https://stackoverflow.com/users/7618662/thatonedeveloper"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1547664639, "post_id": 54221935, "comment_id": 95272840, "body": "You&#39;re right, that&#39;s another approach to this problem. I&#39;ll edit my answer and add that in."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1549501723, "post_id": 54221935, "comment_id": 95928543, "body": "I wouldn&#39;t go so far as to say my suggestion is better. It is different, and will perform better for some functions but worse for others. It&#39;s just good to know about both."}], "tags": [], "owner": {"reputation": 302, "user_id": 7618662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FRMsr.jpg?s=128&g=1", "display_name": "ThatOneDeveloper", "link": "https://stackoverflow.com/users/7618662/thatonedeveloper"}, "is_accepted": false, "score": 2, "last_activity_date": 1547664890, "last_edit_date": 1547664890, "creation_date": 1547658185, "answer_id": 54221935, "question_id": 54221367, "link": "https://stackoverflow.com/questions/54221367/counting-the-times-of-recursion-in-haskell/54221935#54221935", "title": "Counting the times of recursion in Haskell", "body": "<p>If you want to track how many times the function is called, you need to provide that as an input. There's no other way to do this, because Haskell only lets you work with arguments that are passed into the function.</p>\n\n<p>For example, let's say I wanted to compute a factorial, but I wanted to track how many steps it took. My function signature could look like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>factorial :: Int -&gt; (Int, Int) -- Takes a number, returns the number and recursion count\nfactorialInternal :: (Int, Int) -&gt; (Int, Int) -- This actually does the recursion\n</code></pre>\n\n<p>and then the definitions could look like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>factorial n = factorialInternal (n, 0)\nfactorialInternal (1, n) = (1, n + 1)\nfactorialInternal (x, n) = let (y, z) = factorialInternal (x-1, n) in (x * y, z + 1)\n</code></pre>\n\n<p>Essentially, the parameter tracking the amount of recursion is incremented at each level, and then becomes part of the output of <code>factorial</code>.</p>\n\n<p>It definitely helps to create an interface function so that you don't have to manually input the starting recursion level when using the function (which is always zero, anyway). An example of what your function signatures could look like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- The function you call\ncalculateDifference :: (Int, Int, Int) -&gt; (Int, Int, Int) -&gt; Int\n-- What the calculateDifference function calls (the third parameter is the recursion counter)\ncalculateDifferenceInternal :: (Int, Int, Int) -&gt; (Int, Int, Int) -&gt; Int -&gt; Int\n</code></pre>\n\n<p>From here, you should be able to figure out how to implement <code>calculateDifference</code> and <code>calculateDifferenceInternal</code>.</p>\n\n<hr>\n\n<p>EDIT: As amalloy pointed out, a better solution is to just output the counter, not take one in: so instead of <code>factorialInternal :: (Int, Int) -&gt; (Int, Int)</code>, <code>factorialInternal Int -&gt; (Int, Int)</code> would work. The definition would then look like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>factorialInternal 1 = (1, 0)\nfactorialInternal n = let (x, y) = factorialInternal (n - 1) in (n * x, y + 1)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8395921, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/3f8841f5efaac6437fce90a1f2516de7?s=128&d=identicon&r=PG&f=1", "display_name": "Eckersley", "link": "https://stackoverflow.com/users/8395921/eckersley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1547671746, "creation_date": 1547656155, "last_edit_date": 1547671746, "question_id": 54221367, "link": "https://stackoverflow.com/questions/54221367/counting-the-times-of-recursion-in-haskell", "title": "Counting the times of recursion in Haskell", "body": "<p>I am writing a small school assignment in Haskell to determine the distance between two given dates. I wrote a crude function to cycle through dates but I can't wrap my head around how to write loops in a Functional Programming way. I have only done  procedural- and OOP-programming before. I somehow need to store the information of how many times I've called the nextDate-function but Haskell doesn't allow me to introduce a variable inside a function. Here is the code I've come up so far. It is not very Haskelly at all...</p>\n\n<pre><code>nextDate year month day = \n    if day + 1 &lt; 31\n        then (year,month, day+1)\n    else if month + 1 &lt; 12\n        then (year, month + 1, 1)\n    else (year +1,1,1)\n\ncalculateDifference year month day year2 month2 day2 = \n    let x = 0\n    if year == year2 &amp;&amp; month == month2 &amp;&amp; day == day2 then x\n    else \n     nextDate(year, month, day)\n     x = x + 1\n\n    -- How I would do it in Python\n    -- x = 0\n    -- while((tuple1) != (year2, month2, day2)):\n    --  x += 1\n    --  tuple1 = nextDate(tuple1)\n    -- print(x)\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547655152, "post_id": 54220840, "comment_id": 95267910, "body": "Are you sure that works the way you want? Looks essentially equivalent to <code>f x y = getEnv x</code> (up to some nonsense with yours throwing extra exceptions, perhaps) to me."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547655267, "post_id": 54220840, "comment_id": 95267973, "body": "no it doesn&#39;t. fixed."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1547655287, "post_id": 54220840, "comment_id": 95267984, "body": "even uglier now!"}], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 1, "creation_date": 1547655394, "post_id": 54220979, "comment_id": 95268046, "body": "change signature to match <code>String -&gt; String -&gt; IO String</code> please"}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 4, "last_activity_date": 1547655670, "last_edit_date": 1547655670, "creation_date": 1547654719, "answer_id": 54220979, "question_id": 54220840, "link": "https://stackoverflow.com/questions/54220840/join-two-ios-with-in-haskell/54220979#54220979", "title": "Join two IOs with - in haskell", "body": "<p>One way of joining two <code>IO String</code>s would be:</p>\n\n<pre><code>dash :: IO String -&gt; IO String -&gt; IO String\ndash x y = do\n    s1 &lt;- x\n    s2 &lt;- y\n    return $ s1 &lt;&gt; \"-\" &lt;&gt; s2\n</code></pre>\n\n<p>We \"unbox\" each of <code>x</code> and <code>y</code> to get the contained <code>String</code>s, then \"rebox` them with a hyphen (using the analogy for Functors).</p>\n\n<p>It can be shortened to:</p>\n\n<pre><code>dash = liftA2 (\\s1 s2 -&gt; s1 &lt;&gt; \"-\" &lt;&gt; s2)\n</code></pre>\n\n<p>Where <code>liftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</code> takes a binary function and \"lifts\" it into a binary function on <code>Applicative</code>s, which are a superset of <code>Monad</code>s.</p>\n\n<p>Your <code>f</code> can then be implemented as <code>f x y = dash (getEnv x) (getEnv y)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1547655702, "last_edit_date": 1547655702, "creation_date": 1547654866, "answer_id": 54221017, "question_id": 54220840, "link": "https://stackoverflow.com/questions/54220840/join-two-ios-with-in-haskell/54221017#54221017", "title": "Join two IOs with - in haskell", "body": "<p>You could here use an applicative style function:</p>\n\n<pre><code>f :: String -&gt; String -&gt; IO String\nf x y = withHyp &lt;$&gt; getEnv x &lt;*&gt; getEnv y\n    where withHyp ex ey = ex ++ '-' : ey</code></pre>\n\n<p>So here we join the two <code>String</code>s that are then joined with a hypen in the middle through the <code>withHyp</code> function.</p>\n\n<p>Or for a list of environment variables that we need to fetch, we can use <code>mapM</code> and perform an <code>intercalate</code>:</p>\n\n<pre><code>import Data.List(intercalate)\n\nf :: [String] -&gt; IO String\nf xs = intercalate \"-\" &lt;$&gt; mapM getEnv xs</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1547758275, "post_id": 54221909, "comment_id": 95312698, "body": "Just a note for OP about <code>concat</code>: <code>foldl1 (++)</code> for a 3 item list is evaluated as <code>(a ++ b) ++ c</code>, which is slightly slower than <code>a ++ (b ++ c)</code> due to traversing <code>a</code> twice. So <code>concat</code> is actually implemented as something more like <code>foldr (++) []</code> (give or take some differences in syntax)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1547658055, "creation_date": 1547658055, "answer_id": 54221909, "question_id": 54220840, "link": "https://stackoverflow.com/questions/54220840/join-two-ios-with-in-haskell/54221909#54221909", "title": "Join two IOs with - in haskell", "body": "<p>I'll be honest, the idea behind your approach actually looks pretty sane to me. To start with, I'd probably use <code>concat</code> intsead of <code>foldl1 (++)</code>, and drop some parens, getting us to:</p>\n\n<pre><code>f x y = concat &lt;$&gt; sequence [getEnv x, return \"-\", getEnv y]\n</code></pre>\n\n<p>This really doesn't seem that bad to me. But if I really wanted to push farther, here's some thoughts I would have. First, I'd recall the <code>intercalate</code> function.</p>\n\n<pre><code>f x y = intercalate \"-\" &lt;$&gt; sequence [getEnv x, getEnv y]\n</code></pre>\n\n<p>There's a handy shorthand for applying a function to each element of a list, too; <code>mapM f = sequence . map f</code>. So:</p>\n\n<pre><code>f x y = intercalate \"-\" &lt;$&gt; mapM getEnv [x,y]\n</code></pre>\n\n<p>I would stop there; it looks quite clean and maintainable to me.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 54221017, "answer_count": 3, "score": 4, "last_activity_date": 1547658055, "creation_date": 1547654204, "last_edit_date": 1547655278, "question_id": 54220840, "link": "https://stackoverflow.com/questions/54220840/join-two-ios-with-in-haskell", "title": "Join two IOs with - in haskell", "body": "<p>I need to join two <code>IO String</code>s with a <code>-</code> in between. Here's what I came up with, which works - what's the right way? </p>\n\n<pre><code>import System.Environment\nf :: String -&gt; String -&gt; IO String\nf x y = (foldl1 (++)) &lt;$&gt; sequence [(getEnv x),(return \"-\"),(getEnv y)]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1547650737, "post_id": 54219612, "comment_id": 95265259, "body": "You don&#39;t understand correctly.  <code>x . y</code> is not the same as <code>x(y)</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1547651324, "post_id": 54219612, "comment_id": 95265635, "body": "<code>t = \\x y  -&gt; x.y </code> is exactly the same as saying <code>t = .</code>. Have you tried looking up the definition of <code>.</code>. It has exactly the type signature GHCI is showing you here. It takes two functions: <code>x</code> of type <code>b -&gt; c</code> and <code>y</code> of type <code>a -&gt; b</code>, the names of the type variables are arbitrary but it is required that the two <code>b</code> are indeed equal, because the source of the first function needs to be the same type as the target of the second. And then <code>x . y</code> simply applies <code>x</code> to its input, then <code>y</code> to the result, which gives the overall type <code>a -&gt; c</code>."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1547660392, "post_id": 54219612, "comment_id": 95270820, "body": "@RobinZigmond well, <code>t = (.)</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1547661614, "post_id": 54219612, "comment_id": 95271420, "body": "@AlexeyRomanov - oh I see, thanks, I forgot that the parentheses are required. Unfortunately SO doesn&#39;t let you edit comments after the first few minutes."}], "answers": [{"tags": [], "owner": {"reputation": 1422, "user_id": 3179747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf7fbd47419df571480f649e0b9c4b0?s=128&d=identicon&r=PG&f=1", "display_name": "ankh-morpork", "link": "https://stackoverflow.com/users/3179747/ankh-morpork"}, "is_accepted": true, "score": 3, "last_activity_date": 1547656881, "last_edit_date": 1547656881, "creation_date": 1547655734, "answer_id": 54221250, "question_id": 54219612, "link": "https://stackoverflow.com/questions/54219612/reading-haskell-type/54221250#54221250", "title": "Reading Haskell Type", "body": "<p>A better way to write the function type <code>(b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> would be <code>(b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)</code> where there are explicit parentheses around <code>(a -&gt; c)</code>. This rewriting attempts to make it clear that the function does not take three arguments and return something of type <code>c</code>. It takes two arguments and returns a function of type <code>(a -&gt; c)</code>. This is the concept of currying, and it is integral to Haskell programming<sup>1</sup>.</p>\n\n<p>In your first example, <code>(b -&gt; c)</code> is <code>x</code> and <code>(a -&gt; b)</code> is <code>y</code>. The return type <code>(a -&gt; c)</code> is the new function obtained by composing the parameter functions.</p>\n\n<p>Your second example can be interpreted in the same way. <code>(b1 -&gt; c)</code> corresponds to <code>x</code>, <code>(b2 -&gt; b1)</code> to <code>y</code> and, <code>(a -&gt; b2)</code> to <code>z</code>. The return type is obtained by first composing <code>z</code> and <code>y</code> to get a function of type <code>(a -&gt; b1)</code> then composing this function with <code>a</code> to get a function of type <code>(a -&gt; c)</code>. This function is what is ultimately returned. </p>\n\n<hr>\n\n<p><sub>1: In fact it is most correct to say that the function takes one argument of type <code>(b -&gt; c)</code> and returns a function of type <code>(a -&gt; b) -&gt; (a -&gt; c)</code> but, that's not particularly important.</sub></p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 54221250, "answer_count": 1, "score": 1, "last_activity_date": 1547656881, "creation_date": 1547650195, "question_id": 54219612, "link": "https://stackoverflow.com/questions/54219612/reading-haskell-type", "title": "Reading Haskell Type", "body": "<p>lets say I have: </p>\n\n<pre><code>t = \\x y  -&gt; x.y \n</code></pre>\n\n<p>its type is then: </p>\n\n<pre><code>*Main&gt; :t t\nt :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>If I understood correctly, <code>x.y</code> could be written as <code>x(y)</code>, which means we first solve <code>y</code> which is <code>(b -&gt; c)</code> and then x which is <code>(b -&gt; a)</code> and <code>a -&gt; c</code> is just are parameters in function; We give <code>a</code> (x) and <code>c</code> (y). <strong>Is this correct?</strong> If not how do I read this? what does <code>(b -&gt; c) -&gt; (a-&gt; b)</code> mean and which one is <code>x</code> which one <code>y</code>.</p>\n\n<p>And how do I read this: </p>\n\n<pre><code>t1 = \\x y z -&gt; x.y.z \n\n*Main&gt; :t t1\nt1 :: (b1 -&gt; c) -&gt; (b2 -&gt; b1) -&gt; (a -&gt; b2) -&gt; a -&gt; c\n</code></pre>\n\n<p>What is here <code>b1</code> what <code>b2</code> and how does this exactly work? Why is at the and just a ->  c when I have 3 parameters as input? Please help me understand this</p>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1547650010, "post_id": 54219518, "comment_id": 95264786, "body": "This looks like <code>scanl</code>: <code>scanl (-) 0 [1..5]</code> will return <code>[0,-1,-3,-6,-10,-15]</code>. But there is no reason to restrict yourself to mathematical functions. The signature is just <code>scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]</code>. One can use any type of function and elements they want. I don&#39;t see why you want to restrict something useful? For example one can write <code>scanl (flip (:)) [] [1,4,2,5]</code> to get all reversed prefixes: <code>[[],[1],[4,1],[2,4,1],[5,2,4,1]]</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547663615, "post_id": 54219518, "comment_id": 95272385, "body": "You just need more parens. <code>prefix :: (Fractional a, Num a) =&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; [a]</code>. A similar modification applies for <code>prefix&#39;</code>. But see answers below for the (<i>much</i>) more general type you can give to <code>prefix</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1547651791, "creation_date": 1547651791, "answer_id": 54220124, "question_id": 54219518, "link": "https://stackoverflow.com/questions/54219518/is-there-a-specific-type-for-mathematical-functions-in-haskell/54220124#54220124", "title": "Is there a specific type for mathematical functions in Haskell?", "body": "<blockquote>\n  <p>Is there a specific type to distinguish these functions (<code>/</code>,<code>*</code>,<code>+</code>,<code>-</code>)?</p>\n</blockquote>\n\n<p>I don't see a reason to do this. Why is <code>\\x y -&gt; x+y</code> considered \"better\" than <code>\\x y -&gt; x + y + 1</code>. Sure adding two numbers is something that most will consider more \"pure\". But it is strange to restrict yourself to a specific subset of functions. It is also possible that for some function <code>\\x y -&gt; f x y - 1</code> \"happens\" to be equal to <code>(+)</code>, except that the compiler can not determine that.</p>\n\n<p>The type checking will make sure that one can not pass functions that operate on numbers, given the list contains strings, etc. But deliberately restricting this further is not very useful. Why would you prevent programmers to use your function for different purposes?</p>\n\n<blockquote>\n  <p>Or is there another way to write this function succesfully? </p>\n</blockquote>\n\n<p>What you here describe is the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\"><strong><code>scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]</code></strong></a> function. If we call <code>scanl</code> with <code>scanl f z [x1, x2, ..., xn]</code>, then we obtain a list <code>[z, f z x1, f (f z x1) x2, ...]</code>. <code>scanl</code> can be defined as:</p>\n\n<pre><code>scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]\nscanl f = go\n    where go z [] = [z]\n          go z (x:xs) = z : go (f z x) xs\n</code></pre>\n\n<p>We thus first emit the <em>accumulator</em> (that starts with the initial value), and then \"update\" the accumulator to <code>f z x</code> with <code>z</code> the old accumulator, and <code>x</code> the head of the list, and recurse on the tail of the list.</p>\n"}, {"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 2, "last_activity_date": 1547660247, "creation_date": 1547660247, "answer_id": 54222494, "question_id": 54219518, "link": "https://stackoverflow.com/questions/54219518/is-there-a-specific-type-for-mathematical-functions-in-haskell/54222494#54222494", "title": "Is there a specific type for mathematical functions in Haskell?", "body": "<p>If you want to restrict to these four operations, just define the type yourself: </p>\n\n<pre><code>data ArithOp = Plus | Minus | Times | Div\n\nas_fun Plus = (+)\nas_fun Minus = (-)\nas_fun Times = (*)\nas_fun Div = (/)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10885326, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OT-klsmRbYE/AAAAAAAAAAI/AAAAAAAAABE/TcwAts--d9Q/photo.jpg?sz=128", "display_name": "Ole Nedderhoff", "link": "https://stackoverflow.com/users/10885326/ole-nedderhoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 54220124, "answer_count": 2, "score": 1, "last_activity_date": 1547660247, "creation_date": 1547649842, "last_edit_date": 1547650036, "question_id": 54219518, "link": "https://stackoverflow.com/questions/54219518/is-there-a-specific-type-for-mathematical-functions-in-haskell", "title": "Is there a specific type for mathematical functions in Haskell?", "body": "<p>I want to write a function that takes a mathematical function (/,x,+,-), a number to start with and a list of numbers. Then, it's supposed to give back a list. </p>\n\n<p>The first element is the starting number, the second element the value of the starting number plus/minus/times/divided by the first number of the given list. The third element is the result of the previous result plus/minus/times/divided by the second result of the given list, and so on.</p>\n\n<p>I've gotten everything to work if I tell the code which function to use but if I want to let the user input the mathematical function he wants, there are problems with the types. Trying :t (/) for example gives out <code>Fractional a =&gt; a -&gt; a -&gt; a</code>, but if you put that at the start of your types, it fails. </p>\n\n<p>Is there a specific type to distinguish these functions (/,x,+,-)? Or is there another way to write this function succesfully? </p>\n\n<pre><code>prefix :: (Fractional a, Num a) =&gt; a -&gt; a -&gt; a -&gt; a -&gt; [a] -&gt; [a]\n\nprefix (f) a b = [a] ++ prefix' (f) a b\n\n\nprefix' :: (Fractional a, Num a) =&gt; a -&gt; a -&gt; a -&gt; a -&gt; [a] -&gt; [a]\n\nprefix' (z) x [] = []\n\nprefix' (z) x y = [x z (head y)] ++ prefix' (z) (head (prefix' (z) x y)) (tail y)\n</code></pre>\n\n<p>A right solution would be something like this:</p>\n\n<pre><code>prefix (-) 0 [1..5]\n\n[0,-1,-3,-6,-10,-15]\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1547649363, "post_id": 54219318, "comment_id": 95264369, "body": "Here is the task... Where is the attempt?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547672781, "post_id": 54219318, "comment_id": 95276553, "body": "@WillemVanOnsem <a href=\"https://stackoverflow.com/posts/54219318/revisions\">here&#39;s</a> the attempt."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 0, "creation_date": 1547672810, "post_id": 54219318, "comment_id": 95276567, "body": "@tylerweir <a href=\"https://stackoverflow.com/posts/54219318/revisions\">attempt</a>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1547664039, "creation_date": 1547664039, "answer_id": 54223353, "question_id": 54219318, "link": "https://stackoverflow.com/questions/54219318/get-a-specific-triple-from-a-list/54223353#54223353", "title": "Get a specific triple from a list", "body": "<p>I would suggest you start from writing code to generate all the possible triples. Your <code>createGroups</code> attempts to do that, but it's incorrect since when applied to <code>[1,2,3,...]</code> will never generate <code>(1,3,something)</code> since <code>1</code> and <code>2</code> are either taken together or discarded.</p>\n\n<p>I would recommend to use a list comprehension instead, exploiting <code>tails</code>:</p>\n\n<pre><code>createGroups list = \n   [ (x,y,z)\n   | (x:xs) &lt;- tails list\n   , (y:ys) &lt;- tails xs\n   , z      &lt;- ys ]\n</code></pre>\n\n<p>(If you don't want to use <code>tails</code>, you need a more clever recursive function, instead of the list comprehension above.)</p>\n\n<p>You can then filter out the triples that do not sum to the wanted target number.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 10478493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-krhmB90ePM0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU7aCBybc7HvsJuUfN6TbbyTdTOvg/mo/photo.jpg?sz=128", "display_name": "j12", "link": "https://stackoverflow.com/users/10478493/j12"}, "is_accepted": false, "score": 0, "last_activity_date": 1547764326, "creation_date": 1547764326, "answer_id": 54245230, "question_id": 54219318, "link": "https://stackoverflow.com/questions/54219318/get-a-specific-triple-from-a-list/54245230#54245230", "title": "Get a specific triple from a list", "body": "<p>I got sequences like this<br>\n    subsWithSum :: Int -> [Int] -> [[Int]]\n    subsWithSum n list = filter (\\x -> sum x == n) (filter (\\x -> length x == 3)     (subsequences list))</p>\n"}], "owner": {"reputation": 43, "user_id": 10478493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-krhmB90ePM0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU7aCBybc7HvsJuUfN6TbbyTdTOvg/mo/photo.jpg?sz=128", "display_name": "j12", "link": "https://stackoverflow.com/users/10478493/j12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 54223353, "answer_count": 2, "score": -2, "last_activity_date": 1547764326, "creation_date": 1547649156, "last_edit_date": 1547672963, "question_id": 54219318, "link": "https://stackoverflow.com/questions/54219318/get-a-specific-triple-from-a-list", "title": "Get a specific triple from a list", "body": "<p>Here is the Haskell task: \nYou have a list of elements and a number.\nYou have to find the triple Just (a,b,c) from the list that the sum of the elements a, b and c equals to the given number.\nExample</p>\n\n<pre><code>fun [] 3 -&gt; Nothing\nfun [1,2,3,4,5,6] 7 -&gt; Just (1,2,4) \n</code></pre>\n\n<p>I've tried to do smth like this (without Maybe for the beginning). But there is a mistake while creatingGroups</p>\n\n<pre><code>createGroups :: [Int] -&gt; [(Int, Int, Int)]\ncreateGroups [] = []\ncreateGroups (x:y:xs) = map ((,,) x y) xs ++ createGroups xs\n\nsum' :: (Int, Int, Int) -&gt; Int\nsum' (a,b,c) = a + b + c\n\nfiltGr :: [(Int, Int, Int)] -&gt; Int -&gt; (Int, Int, Int)\nfiltGr [] _ = (0,0,0)\nfiltGr (x:xs) a = if sum' x == a then x else filtGr xs a \n</code></pre>\n"}, {"tags": ["sql", "haskell", "yesod", "persistent", "rawsql"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547645673, "post_id": 54218209, "comment_id": 95261979, "body": "What is <code>??</code> doing here?"}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547645754, "post_id": 54218209, "comment_id": 95262020, "body": "It allows to convert resulting data into Entity value on the fly"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547645843, "post_id": 54218209, "comment_id": 95262082, "body": "What if you use <code>... IN (?)</code> (so with parenthesis)?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547646004, "post_id": 54218209, "comment_id": 95262181, "body": "Typically however you can use more advanced functions for such requests, like <code>selectList [RequestId &lt;-. []] []</code>. This will construct the query for you, and make sure it is converted to the proper entities."}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547647350, "post_id": 54218209, "comment_id": 95263041, "body": "Dear Willem, I have to use <code>rawSql</code> because I have to join 3 tables in real code.  In past I&#39;d use <code>esqueleto</code>, but since I use latest LTS Stackage it is not possible"}], "answers": [{"tags": [], "owner": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "is_accepted": true, "score": 1, "last_activity_date": 1547713270, "creation_date": 1547713270, "answer_id": 54231648, "question_id": 54218209, "link": "https://stackoverflow.com/questions/54218209/placeholder-for-sql-in-condition-with-persistents-rawsql/54231648#54231648", "title": "`?` placeholder for SQL `IN` condition with persistent&#39;s `rawSql`", "body": "<p>I don't think there is a way to do it with <code>persistent</code>.\n<code>postrgresql-simple</code> (assuming that we are talking about Postgres here) which is used by <code>persistent</code> does have special <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.6/docs/Database-PostgreSQL-Simple-Types.html#t:In\" rel=\"nofollow noreferrer\">In</a> construct which is correctly translated into <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.6/docs/src/Database.PostgreSQL.Simple.ToField.html#line-108\" rel=\"nofollow noreferrer\">In (..)</a> in SQL, but <code>persistent</code> doesn't seem to use it.\nOne may hope that a workaround is to use <a href=\"https://hackage.haskell.org/package/persistent-2.8.2/docs/Database-Persist-Types.html#v:PersistDbSpecific\" rel=\"nofollow noreferrer\">PersistDbSpecific</a> constructor which takes <code>ByteString</code> as an argument (so we could manually render and pass something like <code>(123,456,789)</code>) but unfortunately it is converted into SQL via <a href=\"https://github.com/yesodweb/persistent/blob/b26c43318047ed94b707404a7e1f219f79c67d70/persistent-postgresql/Database/Persist/Postgresql.hs#L436\" rel=\"nofollow noreferrer\">Unknown</a> which is then rendered via <a href=\"https://github.com/yesodweb/persistent/blob/b26c43318047ed94b707404a7e1f219f79c67d70/persistent-postgresql/Database/Persist/Postgresql.hs#L450\" rel=\"nofollow noreferrer\">Escape</a> which not only escapes the string but also <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.6/docs/Database-PostgreSQL-Simple-ToField.html#v:Escape\" rel=\"nofollow noreferrer\">encloses it into quotes</a> which makes our SQL invalid. If <code>persistent</code> were using <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.6/docs/Database-PostgreSQL-Simple-ToField.html#v:Plain\" rel=\"nofollow noreferrer\">Plain</a> (which in my view would make much more sence) this approach would work, but unfortunately it is not the case.</p>\n"}], "owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 54231648, "answer_count": 1, "score": 2, "last_activity_date": 1547713270, "creation_date": 1547645591, "last_edit_date": 1547647825, "question_id": 54218209, "link": "https://stackoverflow.com/questions/54218209/placeholder-for-sql-in-condition-with-persistents-rawsql", "title": "`?` placeholder for SQL `IN` condition with persistent&#39;s `rawSql`", "body": "<p>I would be happy to use <code>?</code> placeholder to populate ids for SQL <code>IN</code> clause.  Unfortunately it following does not work</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let idList :: [ RequestId ]\n    idList = []\nlet sql :: String\n    sql =  \"SELECT ?? FROM request WHERE request.id IN ?\"\nrs &lt;- runDB $ rawSql sql [ toPersistValue idList ]\n\n</code></pre>\n\n<p>Such code results in database error similar to:</p>\n\n<pre><code>syntax error at or near \"'[283,282,281]'\"\n</code></pre>\n\n<p>Wrapping <code>?</code> placeholder with brackets (e.g. <code>IN (?)</code>) gives another type of error:</p>\n\n<pre><code>invalid input syntax for integer: \"[283,282,281]\"\n</code></pre>\n\n<p>Is there a way to accomplish this?</p>\n\n<p><em>P.S. Looks like it's a horrible title, have no idea how to improve that</em></p>\n"}, {"tags": ["dictionary", "haskell", "map-function"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 6, "creation_date": 1547587525, "post_id": 54206991, "comment_id": 95240697, "body": "I don\u2019t understand your question\u2026 <code>Data.Map</code> defines a <code>Map</code> <i>datatype</i>, which provides an efficient implementation of an immutable key/value dictionary. A list, on the other hand, is an ordinary singly linked list. They\u2019re different data structures for different use cases. If you want to doing things like mapping or filtering on the list, use the usual <code>map</code> and <code>filter</code> functions from the <code>Prelude</code>, not the versions from <code>Data.Map</code>\u2014those ones work on maps! (And the <code>map</code> function has little to do with the <code>Map</code> datastructure, they just use the same name for various reasons.)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1547587566, "post_id": 54206991, "comment_id": 95240714, "body": "A <code>Map</code> is an <i>associative array</i> (sometimes called a <i>dictionary</i>). It is <i>not</i> the <code>map</code> function on lists, etc."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1547588509, "post_id": 54206991, "comment_id": 95241104, "body": "Well, that <i>is</i> actually a pretty unfortunate, confusing name clash. I can well understand how this would trip up beginners!"}, {"owner": {"reputation": 3054, "user_id": 115030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c74c0974c6cc25c194a2737e2d6747?s=128&d=identicon&r=PG", "display_name": "Anders Kaseorg", "link": "https://stackoverflow.com/users/115030/anders-kaseorg"}, "edited": false, "score": 1, "creation_date": 1547588817, "post_id": 54206991, "comment_id": 95241212, "body": "It may be helpful to note that Haskell is case sensitive: <code>foo</code> and <code>Foo</code> are different identifiers whose relationship, if any, is only by convention."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1547591281, "post_id": 54207272, "comment_id": 95242162, "body": "Hi That really clear things up! Many thanks. Question about the last function. I notice that you use &quot;age&quot; as parameter to give a Bool value but in the &quot;ages&quot; function you defined the key as datatype (String and Int but not by names). Tho when I ran the code, it works. Can you explain this to me? Much appreciated"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1547592559, "post_id": 54207272, "comment_id": 95242612, "body": "@Jung, hmm I can&#39;t quite understand what you are asking.  Here&#39;s a guess though: do you know the difference between <code>::</code> and <code>=</code> when defining a function?"}, {"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1547594687, "post_id": 54207272, "comment_id": 95243182, "body": "Yes I do think so :: is to specify the type of a value whereas = is to set a value to sth. In <code>canDrink = Map.map (\\age -&gt; age &gt;= 21) ages</code> you compare age of a person with 21. But you havent specified age in <code>ages</code>. In <code>ages</code> function you only specify the data type of the key and the value which are <code>String</code> and <code>Int</code>. So how does Haskell know that <code>age</code> is 32 or 71 or 13? also you didnt specify the datatype of <code>age</code> is Int"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1547595846, "post_id": 54207272, "comment_id": 95243458, "body": "@Jung &quot;In ages function you only specify the data type of the key and the value which are String and Int.&quot; No, that&#39;s what&#39;s specified in the type signature, but the actual definition tells us more than that. It tells us that the values in the map are <code>32</code>, <code>71</code> and <code>13</code> (and also what their corresponding keys are). Also note that <code>ages</code> is not a function. &quot;So how does Haskell know that age is 32 or 71 or 13?&quot; What do you mean by &quot;the age&quot;? All of those are the age of someone (32 is the age of Bill, 71 that of Carol etc.)."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1547595854, "post_id": 54207272, "comment_id": 95243460, "body": "&quot;also you didnt specify the datatype of age is Int&quot; Haskell has type inference which makes the vast majority of type annotations optional. It is customary to give type signatures to global definitions (even though that&#39;s usually not necessary), but not usually to local ones. Haskell knows that the type of <code>age</code> is <code>Int</code> because the signature of <code>map</code> tells us that the function passed to <code>map</code> takes the map&#39;s value-type as an argument and we know that <code>ages</code>&#39; value-type is <code>Int</code>."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 1, "creation_date": 1547596151, "post_id": 54207272, "comment_id": 95243520, "body": "@Jung <code>(\\age -&gt; age &gt;= 21)</code> is a lambda: an inline anonymous function definition. It takes one argument (which we decided to call <code>age</code>, but it could be anything), and it returns whether that argument is greater or equal to 21. In other words, there is no significance to <code>age</code>, the definition could just as easily have been <code>canDrink = Map.map (\\x -&gt; x &gt;= 21) ages</code>."}, {"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1547637098, "post_id": 54207272, "comment_id": 95257144, "body": "@DarthFennec thanks for the reference to lambda function! @sepp2k ahh so <code>a</code> in <code>Map.map (\\age -&gt; age &gt;= 21) ages</code> is <code>Int</code> and <code>b</code> is <code>Bool</code>. So basically <code>canDrink</code> is the result of <code>Map.map :: (Int -&gt; Bool) -&gt; Map.Map String Int -&gt; Map.Map String Bool</code> which is &#39;dictionary&#39; with data type of key is <code>String</code> and that of value is <code>Bool</code>. is that correct?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1547751065, "post_id": 54207272, "comment_id": 95309271, "body": "@Jung yep, you got it!"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 13, "last_activity_date": 1547588877, "last_edit_date": 1547588877, "creation_date": 1547588511, "answer_id": 54207272, "question_id": 54206991, "link": "https://stackoverflow.com/questions/54206991/connection-between-map-function-in-data-map-and-fromlist-function/54207272#54207272", "title": "Connection between map function in Data.Map and fromList function", "body": "<p>Wow, looks like you are pretty confused.  It's understandable, since the word \"map\" means at least four different things!</p>\n\n<ol>\n<li>The module <code>Data.Map</code> (you seem to be clear about this)</li>\n<li>The <em>data type</em> <code>Map.Map k v</code> (in the <code>Data.Map</code> module), which is a finite map, aka \"dictionary\", aka \"hash table\" (but it doesn't use hashing)</li>\n<li>The <em>function</em> <code>Map.map</code> (in the <code>Data.Map</code> module) which applies a function to every value in the <code>Map</code> (dictionary)</li>\n<li>There is also the standard <code>map</code> function (in the <code>Prelude</code>) that works on lists, and has nothing to do with <code>Map</code>s (dictionaries).</li>\n</ol>\n\n<p>Whew, what a mouthful!</p>\n\n<hr>\n\n<p>Here's some explanation of the signatures:</p>\n\n<pre><code>Map.fromList :: (Ord k) =&gt; [(k, a)] -&gt; Map.Map k a\n</code></pre>\n\n<p><code>Map.Map k a</code> is a parameterized data type with two parameters, <code>k</code> and <code>a</code>.  If you are familiar with generics in the C++ family, this might be written <code>Map&lt;K, A&gt;</code>.</p>\n\n<p>The <code>fromList</code> function takes a list of (key, value) pairs, <code>[(k, a)]</code>, and returns a dictionary.  The dictionary's keys have type <code>k</code>, and the values have type <code>a</code>.  <code>(Ord k)</code> means that the keys have to be orderable with respect to each other, because it stores the data structure as a sorted, balanced tree. </p>\n\n<pre><code>-- A dictionary from people's names to their age\nages :: Map.Map String Int\nages = Map.fromList [(\"Bill\", 32), (\"Carol\", 71), (\"Diddy\", 13)]\n</code></pre>\n\n<hr>\n\n<pre><code>Map.map :: (a -&gt; b) -&gt; Map.Map k a -&gt; Map.Map k b\n</code></pre>\n\n<p>This takes a function from things of type <code>a</code> to things of type <code>b</code> as its first parameter.  As its second parameter it takes a dictionary from any key type <code>k</code> to things of type <code>a</code>, and it applies the function to every value in the dictionary, giving back a dictionary from the same key type to things of type <code>b</code>. </p>\n\n<pre><code>-- A dictionary from people's names to whether they are allowed to drink alcohol\ncanDrink :: Map.Map String Bool\ncanDrink = Map.map (\\age -&gt; age &gt;= 21) ages\n</code></pre>\n\n<hr>\n\n<p><code>fromList'</code> is just a custom implementation of <code>fromList</code>, implemented by repeated insertion.  It has the same signature as <code>fromList</code>, unsurprisingly (but the type variables are named differently -- this makes no difference).</p>\n"}], "owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547591154, "creation_date": 1547587302, "last_edit_date": 1547591154, "question_id": 54206991, "link": "https://stackoverflow.com/questions/54206991/connection-between-map-function-in-data-map-and-fromlist-function", "title": "Connection between map function in Data.Map and fromList function", "body": "<p>I dont understand the signature of Map.map (map function in Data.Map) and that of Map.fromList. The function itself is in the signature. I am also not sure why Map.fromList is always called when i want to implement other functions such as Map.member or Map.filter or Map.size. Like why cant i just apply the function directly on the list but instead have to indirectly apply it through Map.fromList.</p>\n\n<p>Last but not least... signature of fromList'. I notice that the called Map.Map function has a capital M instead of small m which is off (in reference to Map.map on second line) Why is this the case?</p>\n\n<p>Thanks a lot </p>\n\n<pre><code>Map.fromList :: Ord k =&gt; [(k, a)] -&gt; Map.Map k a\nMap.map :: (a -&gt; b) -&gt; Map.Map k a -&gt; Map.Map k b\n\nfromList' :: (Ord a) =&gt; [(a,b)] -&gt; Map.Map a b\nfromList' = foldl (\\acc (a,b) -&gt; Map.insert a b acc) Map.empty\n</code></pre>\n"}, {"tags": ["haskell", "fold", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547571382, "post_id": 54203380, "comment_id": 95233766, "body": "I agree that it looks like you&#39;ve covered all the possible cases - but isn&#39;t this exactly what <code>foldr1</code> does anyway? (PS isn&#39;t the &quot;non-exhaustive patterns&quot; error a runtime error rather than a compile-time one? If so, what input are you giving it when you get the error?)"}, {"owner": {"reputation": 109, "user_id": 10609356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3gJijTJ3Go/AAAAAAAAAAI/AAAAAAAAAl4/CPnaPuLSFmU/photo.jpg?sz=128", "display_name": "Jaime Fern&#225;ndez", "link": "https://stackoverflow.com/users/10609356/jaime-fern%c3%a1ndez"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547571492, "post_id": 54203380, "comment_id": 95233828, "body": "Yeah, just checked and learned that foldr1 is actually an existing function. This was part of an old exam question I&#39;m doing for practice. The input I was trying is foldr1 (+) [1,2,3,4]"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 5, "creation_date": 1547571702, "post_id": 54203380, "comment_id": 95233941, "body": "How are you running this? Are you using GHCi? Are you loading this in a file or typing it in directly? I cannot reproduce this problem."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1547571856, "post_id": 54203380, "comment_id": 95234005, "body": "@AJFarmar I bet that is it! good catch. you should make it an answer. (or maybe find a duplicate...?) closed it. :)"}, {"owner": {"reputation": 109, "user_id": 10609356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3gJijTJ3Go/AAAAAAAAAAI/AAAAAAAAAl4/CPnaPuLSFmU/photo.jpg?sz=128", "display_name": "Jaime Fern&#225;ndez", "link": "https://stackoverflow.com/users/10609356/jaime-fern%c3%a1ndez"}, "edited": false, "score": 0, "creation_date": 1547572462, "post_id": 54203380, "comment_id": 95234305, "body": "Running this on WinGHCi"}], "owner": {"reputation": 109, "user_id": 10609356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3gJijTJ3Go/AAAAAAAAAAI/AAAAAAAAAl4/CPnaPuLSFmU/photo.jpg?sz=128", "display_name": "Jaime Fern&#225;ndez", "link": "https://stackoverflow.com/users/10609356/jaime-fern%c3%a1ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1547572123, "answer_count": 0, "score": 0, "last_activity_date": 1547572251, "creation_date": 1547571004, "last_edit_date": 1547571778, "question_id": 54203380, "link": "https://stackoverflow.com/questions/54203380/non-exhaustive-patterns-error-when-defining-foldr-variant", "closed_reason": "Duplicate", "title": "Non-exhaustive patterns error when defining foldr variant", "body": "<p>I was asked to make a function that works like <code>foldr</code> but with <em>non empty</em> lists, that works like this: <code>foldr1 f [x1,x2...xn] = f x1 (f x2...(f xn-1 xn)...)</code>.</p>\n\n<p>So I defined it like this:</p>\n\n<pre><code>foldr1 f [x] = x\nfoldr1 f (x:xs) = f x (foldr1 f xs)\nfoldr1 f _ = undefined\n</code></pre>\n\n<p>And I'm still getting \"Non-exhaustive patterns in function foldr1\" error, despite covering all possibilities. What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 9, "creation_date": 1547560936, "post_id": 54200329, "comment_id": 95227406, "body": "This is not a class; it is a datatype. Furthermore, you cannot change the contents of that, since all data in Haskell is immutable. It&#39;s not entirely clear what you&#39;re asking here."}], "answers": [{"comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 4, "creation_date": 1547566072, "post_id": 54200472, "comment_id": 95230734, "body": "this is known as <i>record syntax</i>"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 6, "last_activity_date": 1547561046, "creation_date": 1547561046, "answer_id": 54200472, "question_id": 54200329, "link": "https://stackoverflow.com/questions/54200329/how-can-i-access-the-members-of-a-custom-made-class-if-they-are-not-named/54200472#54200472", "title": "How can I access the members of a custom made class if they are not named?", "body": "<p>You can name parameters of your datatype very easily. For example</p>\n\n<pre><code>data Wave = Wave { waveContents :: [Double] } deriving (Show, Eq)\n</code></pre>\n\n<p>This produces a function <code>waveContents :: Wave -&gt; [Double]</code>. You may also construct data in the same way: <code>Wave [1.2, 2.3] :: Wave</code>.</p>\n\n<p>Here is an example of how to use this:</p>\n\n<pre><code>\u03bb myWave = Wave [1.2, 2.3, 3.4]\n\u03bb waveContents myWave\n[1.2, 2.3, 3.4]\n\u03bb Wave $ map (+1) $ waveContents myWave\nWave [2.2, 3.3, 4.4]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 12, "last_activity_date": 1547561540, "creation_date": 1547561540, "answer_id": 54200612, "question_id": 54200329, "link": "https://stackoverflow.com/questions/54200329/how-can-i-access-the-members-of-a-custom-made-class-if-they-are-not-named/54200612#54200612", "title": "How can I access the members of a custom made class if they are not named?", "body": "<p>You forgot to include the <em>function name</em>:</p>\n\n<pre><code>waveToDoubleList :: Wave -&gt; [Double]\nwaveToDoubleList (Wave wave) = wave\n----------------\n</code></pre>\n\n<p>Now it should work. </p>\n\n<p><code>(Wave wave)</code> is known as a <em>pattern</em>. This function works by <em>pattern matching</em>.</p>\n\n<p><code>Wave</code> is used in two roles: as a data constructor, or pattern name; and as the type's name. </p>\n\n<p>When starting learning Haskell, you might want to use separate names for these roles:</p>\n\n<pre><code>data Wave = MkWave [Double] deriving (Show, Eq)\n\nwaveToDoubleList :: Wave -&gt; [Double]\nwaveToDoubleList (MkWave wave) = wave\n</code></pre>\n\n<p>Here <code>Wave</code> is a type; we create values of this type with <code>MkWave</code> data constructor.</p>\n"}], "owner": {"reputation": 57, "user_id": 10878011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6976e7cfff865b848709946f3c24b494?s=128&d=identicon&r=PG&f=1", "display_name": "Happy", "link": "https://stackoverflow.com/users/10878011/happy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 54200612, "answer_count": 2, "score": 0, "last_activity_date": 1547561540, "creation_date": 1547560601, "question_id": 54200329, "link": "https://stackoverflow.com/questions/54200329/how-can-i-access-the-members-of-a-custom-made-class-if-they-are-not-named", "title": "How can I access the members of a custom made class if they are not named?", "body": "<p>I've got a predefined class:</p>\n\n<pre><code>data Wave = Wave [Double] deriving (Show, Eq)\n</code></pre>\n\n<p>I want to use the function 'map' with the class, and so I have to access the [Double]-value. But I do not know how.</p>\n\n<p>I looked here: <a href=\"https://stackoverflow.com/questions/10115623/accessing-members-of-a-custom-data-type-in-haskell\">Accessing members of a custom data type in Haskell</a>, but that didn't answer my question, as I can't change (or name parameters of) the class.</p>\n\n<p>I tried to write:</p>\n\n<pre><code>waveToDoubleList :: Wave -&gt; [Double]\n    (Wave wave) = wave\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1547549668, "post_id": 54197417, "comment_id": 95221517, "body": "You shoud not add a new line here, or at least not without proper indentation <code>createEmail rec bookT auth = toPart rec ++ bodyPart bookT ++ fromPart auth</code> should solve the issue."}, {"owner": {"reputation": 45, "user_id": 7805635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7791678b293f12e2a0bf696b163e19f7?s=128&d=identicon&r=PG&f=1", "display_name": "ahmedES", "link": "https://stackoverflow.com/users/7805635/ahmedes"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547550017, "post_id": 54197417, "comment_id": 95221684, "body": "i think i read an amazon review of the book complains about this error and how the author should have talked about indentation more"}], "answers": [{"tags": [], "owner": {"reputation": 1104, "user_id": 9769772, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Koralp Catalsakal", "link": "https://stackoverflow.com/users/9769772/koralp-catalsakal"}, "is_accepted": true, "score": 6, "last_activity_date": 1547550030, "creation_date": 1547550030, "answer_id": 54197547, "question_id": 54197417, "link": "https://stackoverflow.com/questions/54197417/get-programming-with-haskell-error-in-the-first-code-example/54197547#54197547", "title": "&quot;Get Programming With Haskell&quot; error in the first code example", "body": "<p>Wrong usage of <em>spaces</em> and <em>indentation</em> can cause problems in Haskell. In the code,you can try writing it in one line so that you do not get confused by the indentation. Example :</p>\n\n<p><code>createEmail rec bookT auth = toPart rec ++ bodyPart bookT ++ fromPart auth</code></p>\n\n<p>If you wanna use the style of the tutorial, what you need to do is :</p>\n\n<pre><code>createEmail rec bookT auth\n = toPart rec ++\n\n bodyPart bookT ++\n\n fromPart auth\n</code></pre>\n\n<p>Basically, put a space in front of each line and it should solve the issue.</p>\n"}, {"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1547551688, "post_id": 54197548, "comment_id": 95222545, "body": "Small nitpick: strictly speaking Haskell doesn&#39;t &quot;rely&quot; on indentation. You can write everything with <code>{</code> and <code>}</code> around blocks of code and <code>;</code> after each &quot;statement&quot;, and then GHC (or any Haskell compiler) will be able to parse it fine, no matter where you put your whitespace. Strictly speaking the rules for the use of whitespace are just a kind of syntactic sugar to tell the compiler where to insert the curly braces and semicolons. (This is part of the formal language specification.) But yes, almost everyone uses indentation, and for good reason - readability is important."}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": false, "score": 2, "last_activity_date": 1547550033, "creation_date": 1547550033, "answer_id": 54197548, "question_id": 54197417, "link": "https://stackoverflow.com/questions/54197417/get-programming-with-haskell-error-in-the-first-code-example/54197548#54197548", "title": "&quot;Get Programming With Haskell&quot; error in the first code example", "body": "<p>Haskell relies on indentation so we should fix it a little:</p>\n\n<pre><code>toPart rec = \"Dear \" ++ rec ++ \" \\n\"\nbodyPart bookT = \"Thanks for buying \" ++ bookT ++\" \\n\"\nfromPart auth = \"thanks \\n \" ++ auth   \n\ncreateEmail rec bookT auth\n  = toPart rec ++\n    bodyPart bookT ++\n    fromPart auth\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 15607780, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4cd88c73d4f87f3c5e219873a04b3abf?s=128&d=identicon&r=PG", "display_name": "Mohamed", "link": "https://stackoverflow.com/users/15607780/mohamed"}, "edited": false, "score": 0, "creation_date": 1618192017, "post_id": 67051719, "comment_id": 118519489, "body": "This is a 100% working code from the same damn book"}, {"owner": {"reputation": 915, "user_id": 2605758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DIjwG.png?s=128&g=1", "display_name": "Hoppeduppeanut", "link": "https://stackoverflow.com/users/2605758/hoppeduppeanut"}, "edited": false, "score": 2, "creation_date": 1618209071, "post_id": 67051719, "comment_id": 118522724, "body": "While this might answer the question, if possible you should <a href=\"https://stackoverflow.com/posts/67051719/edit\">edit</a> your answer to include a short explanation of <i>how</i> this code block answers the question. This helps to provide context and makes your answer much more useful to future readers."}], "tags": [], "owner": {"reputation": 1, "user_id": 15607780, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4cd88c73d4f87f3c5e219873a04b3abf?s=128&d=identicon&r=PG", "display_name": "Mohamed", "link": "https://stackoverflow.com/users/15607780/mohamed"}, "is_accepted": false, "score": 0, "last_activity_date": 1618191972, "creation_date": 1618191972, "answer_id": 67051719, "question_id": 54197417, "link": "https://stackoverflow.com/questions/54197417/get-programming-with-haskell-error-in-the-first-code-example/67051719#67051719", "title": "&quot;Get Programming With Haskell&quot; error in the first code example", "body": "<pre><code>toPart recepient = &quot;Dear &quot; ++ recepient ++ &quot; \\n&quot;\nbodyPart title = &quot;Thanks for buying &quot; ++ title ++&quot; \\n&quot;\nfromPart author = &quot;thanks \\n &quot; ++ author   \n\ncreateEmail recepient title author\n  = toPart recepient ++\n    bodyPart title ++\n    fromPart author\n\nmain = do\nprint &quot;who is the email for?&quot;\nrecepient &lt;- getLine\nprint &quot;what is the title?&quot;\ntitle &lt;- getLine\nprint &quot;Who is the author?&quot;\nauthor &lt;- getLine\nprint (createEmail recepient title author)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7805635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7791678b293f12e2a0bf696b163e19f7?s=128&d=identicon&r=PG&f=1", "display_name": "ahmedES", "link": "https://stackoverflow.com/users/7805635/ahmedes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 54197547, "answer_count": 3, "score": -1, "last_activity_date": 1618191972, "creation_date": 1547549546, "question_id": 54197417, "link": "https://stackoverflow.com/questions/54197417/get-programming-with-haskell-error-in-the-first-code-example", "title": "&quot;Get Programming With Haskell&quot; error in the first code example", "body": "<p>i'm reading \"Get Programming With Haskell\" and the second lesson is to write and compile this simple code</p>\n\n<pre><code>toPart rec = \"Dear \" ++ rec ++ \" \\n\"\nbodyPart bookT = \"Thanks for buying \" ++ bookT ++\" \\n\"\nfromPart auth = \"thanks \\n \" ++ auth\n\n\ncreateEmail rec bookT auth\n= toPart rec ++\n\nbodyPart bookT ++\n\nfromPart auth\n</code></pre>\n\n<p>but i'm get this error from GHCI</p>\n\n<pre><code>Prelude&gt; :l first_prog.hs \n[1 of 1] Compiling Main             ( first_prog.hs, interpreted )\n\nfirst_prog.hs:7:5: error:\n    parse error on input \u2018=\u2019\n    Perhaps you need a 'let' in a 'do' block?\n    e.g. 'let x = 5' instead of 'x = 5'\n  |\n7 | let = toPart rec ++\n  |     ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>the author did not explain any thing about the syntax yet so i don't know where is the error here</p>\n"}, {"tags": ["haskell", "types", "functional-programming", "functor", "type-constructor"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1547542522, "post_id": 54194572, "comment_id": 95217763, "body": "I think the closest we can get is <code>Arg f a = (a, f a)</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547544531, "post_id": 54194572, "comment_id": 95218756, "body": "I&#39;m not quite sure I follow what you&#39;re after, or even what your <code>NoArg</code> does. In particular, it appears that it must be a type, I guess of kind <code>(* -&gt; *) -&gt; *</code> (certainly this is what your <code>Either e</code> example does - but in all the other examples it seems to result in a <i>value</i> rather than a <i>type</i>. (In which case <code>NoArg</code> would not be a type at all, but a polymorphic constant, of type <code>(SomeClass a) =&gt; a</code> where <code>SomeClass</code> is whatever class you define which include this <code>NoArg</code> method. Please correct me if I&#39;m wrong though, my Haskell knowledge is almost certainly less than yours!"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1547548716, "post_id": 54194572, "comment_id": 95221019, "body": "I don&#39;t think you can force a functor to use its argument."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547584032, "post_id": 54194572, "comment_id": 95239346, "body": "@RobinZigmond I was a little sloppy with how I wrote it. <code>NoArg</code> is in fact <code>(* -&gt; *) -&gt; *</code>. When I said <code>NoArg []</code> is the empty list, I meant that is a type whose only value if the empty list. When I said <code>NoArg (Either e)</code> is <code>e</code>, I meant it is a type isomorphic to <code>e</code>. Sorry for the confusion."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547563467, "post_id": 54196994, "comment_id": 95229081, "body": "I think a big question is whether the OP is satisfied with <code>Arg f Void -&gt; Void</code> or if they want the much stronger <code>forall a. Arg f a -&gt; a</code>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547581096, "post_id": 54196994, "comment_id": 95238135, "body": "@dfeuer I thought they were the same. I guess they&#39;re not. I would prefer the second."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547583869, "post_id": 54196994, "comment_id": 95239284, "body": "@dfeuer I realized that if you only require the first, then the Haskell type <code>exists g. (g Void -&gt; Void, forall a. g a -&gt; f a, g a)</code> would work. Unfortunately changing <code>g Void -&gt; Void</code> to <code>forall a. g a -&gt; a</code> results in extraneous information. (For example, for a list, it would not only prove that <code>Arg f a</code> uses its element, but also pick one.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 2, "creation_date": 1547585069, "post_id": 54196994, "comment_id": 95239730, "body": "@PyRulez, the question is whether you want to be able to pick one, yes. It&#39;s a typical constructive logic matter: the first statement basically says that it doesn&#39;t fail to contain its argument; the second says that it contains it. For practical programming, a proof of a double negative isn&#39;t usually all that useful; you just can&#39;t do much with it."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547590943, "post_id": 54196994, "comment_id": 95242037, "body": "@dfeuer I added an edit to the question that might clarify my question."}, {"owner": {"reputation": 3054, "user_id": 115030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c74c0974c6cc25c194a2737e2d6747?s=128&d=identicon&r=PG", "display_name": "Anders Kaseorg", "link": "https://stackoverflow.com/users/115030/anders-kaseorg"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1547621469, "post_id": 54196994, "comment_id": 95249386, "body": "@PyRulez I don\u2019t see what you think is good about either <code>exists g. (g Void -&gt; Void, forall a. g a -&gt; f a, g a)</code> or <code>exists g. (forall a. g a -&gt; a, forall a. g a -&gt; f a, g a)</code>. Given <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Proxy.html#t:Proxy\" rel=\"nofollow noreferrer\"><code>data Proxy t = Proxy</code></a>, surely you\u2019d like <code>Arg Proxy ()</code> to be uninhabited, but under both these implementations of <code>Arg</code>, it would be inhabited by <code>(runIdentity, const Proxy, Identity ())</code>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 3054, "user_id": 115030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c74c0974c6cc25c194a2737e2d6747?s=128&d=identicon&r=PG", "display_name": "Anders Kaseorg", "link": "https://stackoverflow.com/users/115030/anders-kaseorg"}, "edited": false, "score": 0, "creation_date": 1547625004, "post_id": 54196994, "comment_id": 95250790, "body": "@AndersKaseorg oh whoops, NVM."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1548083976, "post_id": 54196994, "comment_id": 95406358, "body": "@PyRulez My solution passes the test mentioned in your edited question."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1548095319, "post_id": 54196994, "comment_id": 95412082, "body": "@Andr&#225;sKov&#225;cs Yeah, but it technically isn&#39;t haskell. Still interesting though!"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 6, "last_activity_date": 1547551389, "last_edit_date": 1547551389, "creation_date": 1547548083, "answer_id": 54196994, "question_id": 54194572, "link": "https://stackoverflow.com/questions/54194572/is-there-a-way-to-remove-the-parts-of-a-functor-that-do-not-store-its-argument/54196994#54196994", "title": "Is there a way to &quot;remove&quot; the parts of a functor that do not store its argument?", "body": "<p>I doubt there's a solution in Haskell, but there's a fairly simple definition in languages with dependent pairs and equality types. I work in Idris below. </p>\n\n<p>First, we say that two elements in an <code>f</code> functor have the same shape if they become equal after being filled with <code>()</code>:</p>\n\n<pre><code>SameShape : Functor f =&gt; f a -&gt; f b -&gt; Type\nSameShape fa fb = (map (const ()) fa = map (const ()) fb)\n</code></pre>\n\n<p>The elements of <code>Arg f a</code> are elements of <code>f a</code> such that there are no elements of <code>f Void</code> with the same shape.</p>\n\n<pre><code>Arg : (f : Type -&gt; Type) -&gt; Functor f =&gt; Type -&gt; Type\nArg f a = (fa : f a ** ((fv : f Void) -&gt; SameShape fa fv -&gt; Void)) \n</code></pre>\n\n<p><code>**</code> denotes a dependent pair where the component on the right may refer to the first component. This definition excludes exactly those values which don't contain <code>a</code>. So, we have the desired property:</p>\n\n<pre><code>lem : Functor f =&gt; Arg f Void -&gt; Void\nlem (fv ** p) = p fv Refl\n</code></pre>\n\n<p>where <code>Refl</code> proves <code>map (const ()) fv = map (const ()) fv</code>. </p>\n\n<p>This doesn't work for <code>IO</code>, but I don't expect there's any sensible definition for that.</p>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 3, "answer_count": 1, "score": 17, "last_activity_date": 1547584526, "creation_date": 1547538392, "last_edit_date": 1547584526, "question_id": 54194572, "link": "https://stackoverflow.com/questions/54194572/is-there-a-way-to-remove-the-parts-of-a-functor-that-do-not-store-its-argument", "title": "Is there a way to &quot;remove&quot; the parts of a functor that do not store its argument?", "body": "<p>Given a functor (or any type constructor) <code>f</code>, we can get a \"version\" of that functor that does not contain a value of its argument. We just define <code>newtype NoArg f = NoArg (f Void)</code>. For example:</p>\n\n<ul>\n<li><code>NoArg []</code> is just the empty list.</li>\n<li><code>NoArg Maybe</code> is just Nothing.</li>\n<li><code>NoArg (Either e)</code> is just <code>e</code>.</li>\n<li><code>NoArg (Identity)</code> is <code>Void</code>.</li>\n<li><code>NoArg IO</code> is an IO action that produces effects forever (like a server).</li>\n<li><code>Functor f =&gt; NoArg (Free f)</code> is <code>Fix f</code>.</li>\n<li>etc...</li>\n</ul>\n\n<p>My question is if we can do the opposite, and create a type of the constructors of a Functor that <em>does</em> use its argument. Formally, <code>Arg :: (* -&gt; *) -&gt; (* -&gt; *)</code> should be such that there is a term <code>forall a. Arg f a -&gt; a</code> or equivalently <code>Arg f Void -&gt; Void</code>. For example:</p>\n\n<ul>\n<li><code>Arg [] a</code> is the type of non empty lists of type <code>a</code>.</li>\n<li><code>Arg Maybe a</code> is just <code>a</code>.</li>\n<li><code>Arg (Either e) a</code> is just <code>a</code>.</li>\n<li><code>Arg Identity a</code> is just <code>a</code>.</li>\n<li><code>Arg IO a</code> <em>you would think</em> is IO actions that produce a result. This probably will not be the case though since you there is no function from <code>IO a</code> to <code>a</code>, or even <code>Maybe a</code> that isn't <code>const Nothing</code>.</li>\n<li><code>Functor f =&gt; Arg (Free f) a</code> is <code>Free (Arg f) a</code>.</li>\n<li>etc...</li>\n</ul>\n\n<p>I'm thinking <code>Arg f</code> would be some sort of \"supremum\" of the functors <code>g</code> that embed in <code>f</code> such that there exists a term <code>Argful g :: g Void -&gt; Void</code>.</p>\n\n<p>EDIT: I guess the true test would be for <code>Arg [] a</code> to be isomorphic to <code>NomEmpty a</code>, where</p>\n\n<pre><code>data NonEmpty a = One a | Cons a (NonEmpty a)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 11, "creation_date": 1547524260, "post_id": 54192243, "comment_id": 95212466, "body": "Presence of type annotation doesn&#39;t mean that the compiler will skip type checking. It will still typecheck, and the check that your annotation doesn&#39;t contradict its results."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1547528011, "post_id": 54192243, "comment_id": 95213274, "body": "You can construct horrible cases but I&#39;ve not heard of a real world experience where there was an observable difference.  That might be because most of what you do will have signatures &quot;very close&quot; such as for prelude functions or require signatures to remove ambiguities."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1547529082, "post_id": 54192243, "comment_id": 95213516, "body": "The only situations in which I&#39;ve seen significant difference is in the presence of large amounts of type variables, in particular when working with lenses which liberally use higher rank types. For typical programs this isn&#39;t a concern at all. If type checking performance is a concern, I suggest you ask about programs for which you&#39;ve experienced it to be a concern."}, {"owner": {"reputation": 720, "user_id": 10696884, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TZLhm3qAv5U/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gTJ8AUH3mkzlYyEQgF0K4AqDVXLw/mo/photo.jpg?sz=128", "display_name": "Thomas Lang", "link": "https://stackoverflow.com/users/10696884/thomas-lang"}, "edited": false, "score": 1, "creation_date": 1547535221, "post_id": 54192243, "comment_id": 95215002, "body": "Also be aware that sometimes you need the signature to be present, e.g. when working with Rank-2-types."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547545843, "post_id": 54192243, "comment_id": 95219479, "body": "Note that your two <code>f</code>s here are <i>not</i> the same. The former has signature <code>Num a =&gt; a -&gt; a -&gt; a</code>, so it can work with any <code>Num</code> type."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1547547739, "post_id": 54192243, "comment_id": 95220510, "body": "This is way to broad to answer, beyond saying &quot;it can affect it a lot, or not at all&quot;. I&#39;ve seen cases where partial type signatures are <i>much</i> worse than no type signature. I&#39;ve also seen cases where no type signature was much worse than partial or full type signature. It really depends on the types."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1547796665, "post_id": 54192243, "comment_id": 95322990, "body": "I <i>believe</i> that the major source of possible difference in speed is that if you write a type signature different than what GHC would infer (either more or less general), then it may take a different amount of time to check <i>other</i> uses the thing with that type (because it&#39;s different). For the binding where you wrote the signature it still has to figure out whether your type is consistent with the code, which usually involves the same analysis it would do anyway if it could compile either with or without the signature. It&#39;s not that omitting the signature leaves the compiler with &quot;more work&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547672478, "post_id": 54210909, "comment_id": 95276419, "body": "In other cases, it may take longer if it has to check the type signature. Type inference is <i>usually</i> pretty snappy in practice."}], "tags": [], "owner": {"reputation": 1, "user_id": 10920528, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6b3d5ae1276a278ccb5204ff2bef6e81?s=128&d=identicon&r=PG", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10920528/anonymous"}, "is_accepted": false, "score": -3, "last_activity_date": 1547616411, "creation_date": 1547616411, "answer_id": 54210909, "question_id": 54192243, "link": "https://stackoverflow.com/questions/54192243/haskell-type-inference-compilation-speed/54210909#54210909", "title": "Haskell Type Inference Compilation Speed", "body": "<p>Does the compiler take longer if it has to infer the types? <strong>Yes.</strong></p>\n\n<p>Can you easily tell what is the magnitude of that delay? <strong>No</strong> , but it certainly is not small.</p>\n\n<p>The inference engine is very complex, and not many people touch it. The best person in the world you can ask this question is Dr. Simon Peyton Jones.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1547743865, "creation_date": 1547743865, "answer_id": 54240682, "question_id": 54192243, "link": "https://stackoverflow.com/questions/54192243/haskell-type-inference-compilation-speed/54240682#54240682", "title": "Haskell Type Inference Compilation Speed", "body": "<p>As stated in the comments, adding a type signature doesn't allow the compiler to skip type checking; it will still check that your type signature matches the code.</p>\n\n<p>And removing a type signature doesn't turn off type checking either; the compiler will <em>still</em> check your code for type errors.</p>\n\n<p>So, really, whether you write a type signature will <em>usually</em> have almost no effect on compilation time at all. (It <em>may</em> have a significant effect on runtime performance, but it generally won't affect compilation time at all.)</p>\n\n<p><em>Usually</em> type checking is a fairly negligible portion of compilation time anyway; typically parsing, loading module interfaces, and linking take way longer.</p>\n\n<p>(Of course, there are people who do truly crazy things with the type system, which may make compilation vastly slower. But for beginner Haskell stuff, it's unlikely to matter.)</p>\n"}], "owner": {"reputation": 950, "user_id": 1254034, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6134973ba87381d21fe7ba6ab1e8a45e?s=128&d=identicon&r=PG", "display_name": "Eduardo Bautista", "link": "https://stackoverflow.com/users/1254034/eduardo-bautista"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547794432, "creation_date": 1547522189, "last_edit_date": 1547794432, "question_id": 54192243, "link": "https://stackoverflow.com/questions/54192243/haskell-type-inference-compilation-speed", "title": "Haskell Type Inference Compilation Speed", "body": "<p>How much does not explicitly declaring types in Haskell affect the compilation speed?</p>\n\n<p>For example:</p>\n\n<pre><code>f x y = x + y\n\n-- versus\n\nf :: Int -&gt; Int -&gt; Int\nf x y = x + y\n</code></pre>\n\n<p>Edit: It looks like the wording if of my question appears to sound as if I am asking whether removing the types would make it faster.  What I meant is if it makes it <em>slower</em>.  This is because the compiler has to now figure out what type it will use without the developer's help.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1547535417, "post_id": 54186992, "comment_id": 95215058, "body": "Thanks! That solves my immediate problem, but it seems it might get me into new ones. Mainly: with this flag enabled, how do I <i>know</i> that a newer version has been selected? Since it might be an error source, it would be nice if I could be explicit about it on specific packages. I take it that is not possible?"}, {"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "reply_to_user": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 2, "creation_date": 1547557830, "post_id": 54186992, "comment_id": 95225675, "body": "<code>stack ls dependencies</code> will tell you what you have got.  If you add a specific version in your cabal file, that should be used.  To be honest you\u2019re asking for headaches."}, {"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1547564122, "post_id": 54186992, "comment_id": 95229522, "body": "&quot;To be honest you&#39;re asking for headaches.&quot; Quite possibly. But since I&#39;m new to the entire ecosystem, I&#39;m not sure what to expect. For my specific use case, PSQueue just released 1.1.0.1 with support for base-4.11.1, so now I don&#39;t need it anymore for this specific project, but that doesn&#39;t answer the more general question: if this is a bad solution, what is a good one?"}, {"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "reply_to_user": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 2, "creation_date": 1547568266, "post_id": 54186992, "comment_id": 95232127, "body": "You can do a number of things: 1) wait for the library to be updated, 2) pin the library to a specific git commit hash, 3) grab the library code as a local dependency (this lets you keep everything stable and just verify the library.). You&#39;re generally going to be ok unless their are GHC version requirements."}], "tags": [], "owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "is_accepted": true, "score": 5, "last_activity_date": 1547489569, "creation_date": 1547489569, "answer_id": 54186992, "question_id": 54186938, "link": "https://stackoverflow.com/questions/54186938/can-i-somehow-use-a-package-with-a-later-version-of-base-than-what-the-package-s/54186992#54186992", "title": "Can I somehow use a package with a later version of base than what the package specifies?", "body": "<p>I think you are looking for <code>allow-newer</code> - <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#allow-newer\" rel=\"noreferrer\">https://docs.haskellstack.org/en/stable/yaml_configuration/#allow-newer</a></p>\n\n<blockquote>\n  <p>Ignore version bounds in .cabal files. Default is false.</p>\n</blockquote>\n"}], "owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 54186992, "answer_count": 1, "score": 5, "last_activity_date": 1547489569, "creation_date": 1547489333, "question_id": 54186938, "link": "https://stackoverflow.com/questions/54186938/can-i-somehow-use-a-package-with-a-later-version-of-base-than-what-the-package-s", "title": "Can I somehow use a package with a later version of base than what the package specifies?", "body": "<p>I'm quite new to the Haskell stack, so I might be misunderstanding how things are intended to work here, but I have a problem that I've seen a few times and am wondering if I'm going about the wrong way.</p>\n\n<p>In short, I sometimes want to use a package with a version spec that is capped at a lower version of <code>base</code> than what my Stack resolver includes.</p>\n\n<p>For example, I can't use the <code>lts-12.14</code>  resolver with <code>PSQueue-1.1</code>, because  the former includes <code>base-4.11.1</code> and the latter requires <code>base &gt;=4 &amp;&amp; &lt;4.11</code>.</p>\n\n<p>The two ways I have found to resolve that has been to either</p>\n\n<ul>\n<li>add a specific version of <code>base</code> to my <code>extra-deps</code>, making sure that the pinned version is within the range my package allows; or</li>\n<li>choose a different resolver (using e.g. <a href=\"https://www.stackage.org/diff/\" rel=\"noreferrer\">https://www.stackage.org/diff/</a> to figure out which one is the latest resolver with an early enough version of <code>base</code>)</li>\n</ul>\n\n<p>Both of these feel suboptimal, especially since I might want to use packages which have non-overlapping ranges (e.g. one <code>&gt;=3 &amp;&amp; &lt;4.11</code> and one <code>&gt;=4.11</code>). I realize that using such a combination toghether <em>might</em> fail, especially if they are locked on different major-versions of <code>base</code> (assuming <code>base</code> uses semver), but so far I'm only writing pretty small programs, so if they seem to work I'm quite happy even if there are other, non-exercised code paths that will fail on the specific combination of packages and versions. In other words: I know the risk - but I can't chance it, because I don't know how to.</p>\n\n<p>Is there a way to force Stack to allow a newer version of <code>base</code> than the one specified in the requirements of a dependency?</p>\n"}, {"tags": ["haskell", "tuples", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 9, "last_activity_date": 1547505469, "last_edit_date": 1547505469, "creation_date": 1547477657, "answer_id": 54183817, "question_id": 54183789, "link": "https://stackoverflow.com/questions/54183789/how-to-only-get-the-tuples-i-want-from-a-list-of-tuples-haskell/54183817#54183817", "title": "How to only get the tuples I want from a list of tuples? [Haskell]", "body": "<p>That\u2019s <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zip\" rel=\"nofollow noreferrer\"><code>zip</code></a>:</p>\n\n<pre><code>okTup xs = zip [1..] xs\n</code></pre>\n\n<p>If you prefer to do this with a list comprehension, or you want to extend an existing comprehension, you can use the <code>ParallelListComp</code> extension, which allows you to write:</p>\n\n<pre><code>okTup xs = [(i, j) | i &lt;- [1..] | j &lt;- xs]\n</code></pre>\n\n<p>(Note the vertical bar <code>|</code> instead of a comma <code>,</code>.)</p>\n\n<p>Of course, this essentially just uses <code>zip</code> under the hood.</p>\n"}], "owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 54183817, "answer_count": 1, "score": -2, "last_activity_date": 1547505469, "creation_date": 1547477554, "question_id": 54183789, "link": "https://stackoverflow.com/questions/54183789/how-to-only-get-the-tuples-i-want-from-a-list-of-tuples-haskell", "title": "How to only get the tuples I want from a list of tuples? [Haskell]", "body": "<p>I'm trying to set up a list of tuples from a list of Integers in this form:\n(a,b) a &lt;- [1..4] and b &lt;- xs. But I keep getting all the different combinations of the statement.</p>\n\n<pre><code>okTup :: [Int] -&gt; [(Int,Int)]\nokTup xs = [(i,j) | i &lt;- [1..4], j &lt;- xs]\n</code></pre>\n\n<p>Input: okTup <strong>[3,1,4,2]</strong></p>\n\n<p>What I get is this:\n[(1,3),(1,1),(1,4),(1,2),(2,3),(2,1),(2,4),(2,2),(3,3),(3,1),(3,4),(3,2),(4,3),(4,1),(4,4),(4,2)]</p>\n\n<p>But I only want this:\n[(1,<strong>3</strong>),(2,<strong>1</strong>),(3,<strong>4</strong>),(4,<strong>2</strong>)]</p>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 0, "creation_date": 1547469151, "post_id": 54178405, "comment_id": 95191425, "body": "A string is valid JSON, have you tried returning just the string (not an object) in <code>ToJSON</code> of <code>GoalStatus</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1547487823, "post_id": 54182610, "comment_id": 95201484, "body": "Doing some code golf here. I find the <code>with*</code> functions from <code>Data.Aeson</code> handy.  For example, <code>parseJSON = withString &quot;GoalStatus&quot; $ \\case &quot;created&quot; -&gt; ...</code> would emit a useful error when the Value constructor isn&#39;t <code>String</code>.  The same goes for <code>withObject</code> and Henin&#39;s FromJSON instance for Goal."}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 4, "last_activity_date": 1547481253, "last_edit_date": 1547481253, "creation_date": 1547473057, "answer_id": 54182610, "question_id": 54178405, "link": "https://stackoverflow.com/questions/54178405/serialization-of-a-basic-sum-type-in-json-with-aeson/54182610#54182610", "title": "Serialization of a basic sum type in Json with Aeson", "body": "<p><code>String !Text</code> is a constructor of <code>Value</code> and <code>object</code> has the type signature <code>[Pair] -&gt; Value</code> where <code>Pair</code> is <code>(Text, Value)</code>. You can use <code>String</code> to make the <code>Value</code> in <code>ToJSON</code> and then match on the particular shapes of the <code>String</code> when parsing in <code>FromJSON</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance ToJSON GoalStatus where\n  toJSON (Created) = String \"created\"\n  toJSON (InProgress) = String \"inProgress\"\n  toJSON (Accomplished) = String \"accomplished\"\n  toJSON (GivenUp) = String \"givenUp\"\n\ninstance FromJSON GoalStatus  where\n  parseJSON (String s) = case unpack s of\n    \"created\" -&gt; return Created\n    \"inProgress\" -&gt; return InProgress\n    \"accomplished\" -&gt; return Accomplished\n    \"givenUp\" -&gt; return GivenUp\n    _ -&gt; error $ \"Json format not expected\"\n  parseJSON _ =  error $ \"Json format not expected\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 0, "last_activity_date": 1547473429, "creation_date": 1547473429, "answer_id": 54182708, "question_id": 54178405, "link": "https://stackoverflow.com/questions/54178405/serialization-of-a-basic-sum-type-in-json-with-aeson/54182708#54182708", "title": "Serialization of a basic sum type in Json with Aeson", "body": "<p>I'm not sure that I understand the question. Here's a full file with generic-derived implementations:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\nmodule Q54178405 where\n\nimport Data.Text\nimport Data.Aeson\nimport GHC.Generics\n\ntype WorkspaceId = Int\ntype GoalId = Int\ntype GoalDescription = Text\n\ndata GoalStatus =\n  Created | Accomplished | InProgress | GivenUp deriving (Show, Eq, Generic)\n\ninstance ToJSON GoalStatus\ninstance FromJSON GoalStatus\n\ndata Goal = Goal {\n    workspaceId ::WorkspaceId\n  , goalId :: GoalId\n  , description :: GoalDescription\n  , status :: GoalStatus}\n  deriving (Show, Eq, Generic)\n\ninstance ToJSON Goal\ninstance FromJSON Goal\n</code></pre>\n\n<p>Here's how it behaves in GHCi:</p>\n\n<pre><code>*Q54178405 Q54178405&gt; encode $ Goal 42 1337 \"foo\" Accomplished\n\"{\\\"status\\\":\\\"Accomplished\\\",\\\"goalId\\\":1337,\\\"workspaceId\\\":42,\\\"description\\\":\\\"foo\\\"}\"\n*Q54178405 Q54178405&gt; encode $ Goal 42 1337 \"foo\" GivenUp\n\"{\\\"status\\\":\\\"GivenUp\\\",\\\"goalId\\\":1337,\\\"workspaceId\\\":42,\\\"description\\\":\\\"foo\\\"}\"\n</code></pre>\n\n<p>Isn't that what you want?</p>\n\n<p>The instances round-trip as well:</p>\n\n<pre><code>*Q54178405 Q54178405&gt; decode $ encode $ Goal 42 1337 \"foo\" GivenUp :: Maybe Goal\nJust (Goal {workspaceId = 42, goalId = 1337, description = \"foo\", status = GivenUp})\n</code></pre>\n\n<p>If this isn't what you want, it'd be useful with some explicit examples of input with desired output.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 54182610, "answer_count": 2, "score": 2, "last_activity_date": 1547481253, "creation_date": 1547456778, "last_edit_date": 1547473550, "question_id": 54178405, "link": "https://stackoverflow.com/questions/54178405/serialization-of-a-basic-sum-type-in-json-with-aeson", "title": "Serialization of a basic sum type in Json with Aeson", "body": "<pre><code>type GoalDescription = Text\n\ndata GoalStatus = Created | Accomplished | InProgress | GivenUp deriving (Show , Eq , Generic )\n\ndata Goal = Goal {workspaceId ::WorkspaceId , goalId :: GoalId , description :: GoalDescription , status :: GoalStatus} deriving (Show , Eq , Generic )\n\ninstance ToJSON Goal where\n  toJSON (Goal {workspaceId, goalId ,description,status } ) = object [\n            \"workspaceId\" .= workspaceId,\n            \"goalId\" .= goalId,\n            \"description\" .= description,\n            \"status\" .= status]\n\ninstance FromJSON Goal  where\n\n    parseJSON (Object jsonObject) = Goal &lt;$&gt; jsonObject .: \"workspaceId\" &lt;*&gt;  jsonObject .: \"goalId\" &lt;*&gt;  jsonObject .: \"description\" &lt;*&gt;  jsonObject .: \"status\"\n    parseJSON _ =  error $ \"Json format not expected\"\n</code></pre>\n\n<p>I want to implement the FromJSON and ToJSON of GoalStatus that way: <code>Goal {.. status:\"accomplished\"}</code> or <code>Goal {.. status:\"inProgress\"}</code> etc... somehow I don't know how to implement these type classes without having a key -> value structure... <code>GoalStatus</code> should be only converted into a <code>String Text</code> without Keys attached to the value.. </p>\n\n<p>I have this temporary solution where I had to add an unnecessary key named \"value\" :</p>\n\n<pre><code>instance ToJSON GoalStatus where\n    toJSON (Created) = object [\"value\" .= String \"created\"]\n    toJSON (InProgress) = object [\"value\" .= String \"inProgress\"]\n    toJSON (Accomplished) = object [\"value\" .= String \"accomplished\"]\n    toJSON (GivenUp) = object [\"value\" .= String \"GivenUp\"]\n\n\ninstance FromJSON GoalStatus  where\n\n  parseJSON (Object o) = do\n     value &lt;- o .: \"value\"\n     case value of\n          String status | (unpack status) == \"created\" -&gt; return Created\n          String status | (unpack status) == \"inProgress\" -&gt; return InProgress\n          String status | (unpack status) == \"accomplished\" -&gt; return Accomplished\n          String status | (unpack status) == \"accomplished\" -&gt; return GivenUp\n          _ -&gt; error $ \"Json format not expected\"\n  parseJSON _ =  error $ \"Json format not expected\"\n</code></pre>\n"}, {"tags": ["haskell", "functor", "bifunctor"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1547443132, "post_id": 54176021, "comment_id": 95180823, "body": "FYI: in reasonably recent versions of GHC, <code>DeriveTraversable</code> implies both <code>DeriveFunctor</code> and <code>DeriveFoldable</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547443833, "post_id": 54176021, "comment_id": 95180996, "body": "Csongor Kiss has done some very clever work on doing the sort of thing you want with generics. I believe others have done related things as well. None of those fit into the current GHC generics system quite right; I imagine that system will be replaced within the next few years. You can probably find other solutions using Template Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1547503834, "post_id": 54184493, "comment_id": 95208020, "body": "To factor out the redundancy of the same data accompanying each case.  But now that you mention it, I guess <code>App FunName [(ExprF r, a)]</code> or equivalent would suffice.  Interesting point about performance, I usually don&#39;t worry about non-asymptotic performance things."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547503971, "post_id": 54184493, "comment_id": 95208071, "body": "Yes, I saw the redundancy you were trying to get at, eventually. Another option: instead of <code>(a1, a2)</code>, use <code>(,,) a1 a2</code>, taking a functor as an argument. Not so good for deriving though."}, {"owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 1, "creation_date": 1547517409, "post_id": 54184493, "comment_id": 95211221, "body": "This is just a sample case used to explain my question, the real situation is more complicated than this and can not be simplified via using tuple, thanks for your suggestion but it isn&#39;t my point."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1547480002, "creation_date": 1547480002, "answer_id": 54184493, "question_id": 54176021, "link": "https://stackoverflow.com/questions/54176021/how-to-derive-multiple-functor-instances-in-haskell/54184493#54184493", "title": "How to derive multiple Functor instances in Haskell?", "body": "<p>Not a direct answer to your question, but an observation. If this is the real type you are working with, it could use some factorization.  <code>a1</code> and <code>a2</code> are used identically, and they are used once per node.  You can factor this.</p>\n\n<pre><code>data ExprNode r a = ExprNode (ExprF r a) a\n    -- it's a bifunctor\n\ndata ExprF r a\n    = Ref r\n    | App FunName [ExprNode r a]\n    | Lit Value\n    -- it's a bifunctor\n\ntype Expr r a1 a2 = ExprNode r (a1, a2)\n</code></pre>\n\n<p>Now all you need is bifunctor.  Whether you want to do this depends on what your intended meanings of <code>a1</code> and <code>a2</code> are, but I suspect you do want to do this.  Factoring out uniformity in your data types can clean up the rest of your code significantly: it can tease out hidden opportunities for generalization, reveal standard structures you are relying on, and reduce the amount of boilerplate functions by leaning more on the standard library.</p>\n"}], "owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1547480002, "creation_date": 1547442268, "question_id": 54176021, "link": "https://stackoverflow.com/questions/54176021/how-to-derive-multiple-functor-instances-in-haskell", "title": "How to derive multiple Functor instances in Haskell?", "body": "<p>I'm defining an AST for expression, and it has three type arguments, like following:</p>\n\n<pre><code>{-# language DeriveFunctor, DeriveFoldable, DeriveTraversable #-}\n\n-- | a general represetation of an expression\n-- , with ref info contained in r and two attributes contained in a1, a2\ndata Expr r a1 a2\n    = Ref r a1 a2\n    | App FunName [Expr r a1 a2] a1 a2\n    | Lit Value a1 a2\n    deriving (Functor, Foldable, Traversable)\n</code></pre>\n\n<p>Now using <code>DeriveFunctor</code> can only help me to define <code>instance Functor (Expr r a1)</code>, so I can <code>fmap</code> over <code>a2</code>, but if I want to <code>fmap</code> over <code>a1</code> or <code>r</code>, I find that it is impossible to use <code>DeriveFunctor</code> with a <code>newtype</code> , since the following code doesn't work:</p>\n\n<pre><code>newtype ExprR a1 a2 r = MkExprR { getExpr :: Expr r a1 a2 }\n\nderiving instance Functor (ExprR a1 a2)\n</code></pre>\n\n<p>If I need only two type arguments, then <code>Bifunctor</code> may be a good idea, and there indeed is some package which provide <code>DeriveBifunctor</code>, but what if we need three? do we need <code>DeriveTrifunctor</code> or <code>DeriveQuadfunctor</code> etc. ?</p>\n\n<p>And, what if we need more than <code>Functor</code>? considering <code>Foldable</code>, <code>Traversable</code> etc.</p>\n\n<p>Is there any solution about this problem? how does people solve this problem in haskell practice?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 6, "creation_date": 1547444846, "post_id": 54175948, "comment_id": 95181233, "body": "What type do you think <code>rows</code> is?  Is that type in agreement with <code>size</code>?  If so, add that signature to your <code>sourceFile ... :: IO _type_</code> line.  Then you should see that, even without the  <code>putStrLn</code>, GHC complains about a type error.  Consider the implications."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1547458690, "post_id": 54175948, "comment_id": 95186114, "body": "Likely, without the <code>putStrLn</code>, GHC is inferring the type of <code>rows</code> from its other uses, in particular from the fact that the returned type depends on the type of <code>rows</code>. Adding the <code>putStrLn</code> provides another option for type inference, e.g. &quot;<code>rows</code>&#39;s type must be such that <code>size rows</code> makes sense&quot;. This makes <code>rows</code> be assigned the <code>Map</code> type, only to trigger a type error later on. Adding an explicit type signature to <code>rows</code> (as suggested in the comment above) should make the type error more clear."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1547471622, "post_id": 54175948, "comment_id": 95192664, "body": "Thanks - funny how the thought process resulted in my not realizing the issue. I thought, well if <code>size</code> isn&#39;t right, I&#39;ll get an immediate type error. Forgetting that type errors in Haskell can be a bit lazy and not show up immediately at the place of origin."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1547480579, "post_id": 54175948, "comment_id": 95197690, "body": "Type errors can always be blamed on at least two locations.  Here we have the possibility size is wrong on the type of the argument or the possibility source file... Is wrong on the type of its result."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 2, "creation_date": 1547487439, "post_id": 54175948, "comment_id": 95201322, "body": "FYI, I think you can just say <code>print</code> instead of <code>putStrLn . show</code>. I don&#39;t think it has any bearing on your problem."}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547471699, "creation_date": 1547441603, "last_edit_date": 1547471699, "question_id": 54175948, "link": "https://stackoverflow.com/questions/54175948/why-can-putstrln-seemingly-change-the-expected-type-in-the-io-monad", "title": "Why can putStrLn seemingly change the expected type in the IO monad?", "body": "<p>I have the following simple function based on csv-conduit, and it is calling a custom <code>catMaybes</code> implementation for <code>Vector</code>s.</p>\n\n<pre><code>retrieveSmaXtec :: IO (Vector SxRecord)\nretrieveSmaXtec = do\n  rows &lt;- sourceFile \"unordered.csv\"\n    .| intoCSV defCSVSettings\n    .| sinkVector\n    &amp; runConduitRes\n  putStrLn $ show $ size rows  -- DEBUG\n  putStrLn $ show $ size $ (fmap fromRow rows) -- DEBUG\n  rows &amp; fmap fromRow &amp; catMaybes &amp; return\n</code></pre>\n\n<p>If I remove the two lines with <code>putStrLn</code>, everything typechecks, though there does seem to be some problem with the code - though unit tests indicate <code>fromRow</code> is working correctly, I still seem to get an empty Vector back when I know I should not. I mention that only because it may be related. My actual question is why, when I add the <code>putStrLn</code> calls, I get the error:</p>\n\n<pre><code>src/FDS/Data/SmaXtec.hs:64:25: error:                                                                                                       \n    * Couldn't match type `Map k0 (Maybe SxRecord)'                                                                                         \n                     with `Vector (Maybe SxRecord)'                                                                                         \n      Expected type: Map k0 (Maybe SxRecord) -&gt; Vector SxRecord                                                                             \n        Actual type: Vector (Maybe SxRecord) -&gt; Vector SxRecord                                                                             \n    * In the second argument of `(&amp;)', namely `catMaybes'                                                                                   \n      In the first argument of `(&amp;)', namely                                                                                                \n        `rows &amp; fmap fromRow &amp; catMaybes'                                                                                                   \n      In a stmt of a 'do' block: rows &amp; fmap fromRow &amp; catMaybes &amp; return                                                                   \n    * Relevant bindings include                                                                                                             \n        rows :: Map k0 (MapRow Text)                                                                                                        \n          (bound at src/FDS/Data/SmaXtec.hs:58:3)                                                                                           \n   |                                                                                                                                        \n64 |   rows &amp; fmap fromRow &amp; catMaybes &amp; return                                                                                             \n   |                         ^^^^^^^^^           \n</code></pre>\n\n<p><strong>Update:</strong> As hinted in the comments, <code>size</code> was not the function I was looking for. I needed <code>Data.Vector.length</code>.</p>\n"}, {"tags": ["haskell", "gloss"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 3, "last_activity_date": 1547441571, "creation_date": 1547441571, "answer_id": 54175942, "question_id": 54175031, "link": "https://stackoverflow.com/questions/54175031/posting-a-message-while-running-gloss-code-in-haskell/54175942#54175942", "title": "Posting a message while running Gloss code in Haskell", "body": "<p>If you want to, say, emit a message based on the event then put that operation inside the event handler.  For example:</p>\n\n<pre><code>main :: IO ()\nmain = playIO black 100 world0 renderWorld handleEvent updateWorld\n\nhandleEvent evt w =\n    do print event -- Right here, you are emitting a message!\n       updateWorldWithEvent evt w\n       putStrLn \"I have updated the world, now time for breakfast.\"\n</code></pre>\n\n<p>Just keep in mind the <code>handleEvent</code> operation will potentially happen quite frequently so select your output accordingly.</p>\n"}], "owner": {"reputation": 763, "user_id": 6419581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tmJu.png?s=128&g=1", "display_name": "Gakuo", "link": "https://stackoverflow.com/users/6419581/gakuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 54175942, "answer_count": 1, "score": 0, "last_activity_date": 1547441571, "creation_date": 1547431979, "question_id": 54175031, "link": "https://stackoverflow.com/questions/54175031/posting-a-message-while-running-gloss-code-in-haskell", "title": "Posting a message while running Gloss code in Haskell", "body": "<p>The Haskell playIO has the below type:</p>\n\n<pre><code> playIO:: Display   \n-&gt; Color    background color\n-&gt; Int  \n-&gt; world    --initial world \n-&gt; (world -&gt; IO Picture)  -- function to change world into a picture    \n-&gt; (Event -&gt; world -&gt; IO world) --event handler function\n-&gt; (Float -&gt; world -&gt; IO world) -- The function to update the world after the given time \n-&gt; IO ()\n</code></pre>\n\n<p>Once you call <code>playIO</code>inside <code>main</code>, it runs continuously updating the GUI which is modelled by the <code>world</code>. In case something happened inside the code  that handles events(see comments on code) or the function that updates the world and you wanted to output a message (Not necessarily an error), what approach would one use that does not violate the types? Would one have to break out of the function <code>playIO</code>to display my message  and if so how would one do that? </p>\n"}, {"tags": ["haskell", "type-families", "polykinds"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1547469440, "post_id": 54173073, "comment_id": 95191549, "body": "This is a nicely presented question. However, when posting such issues, it is always better to post the <i>full</i> error message :-) . Here, GHCi also adds <code>To defer the ambiguity check to use sites, enable AllowAmbiguousTypes</code> which is a tale-teller. I couldn&#39;t see what was wrong at first above, but after reading the ambiguity error everything was much clearer. (BTW, that&#39;s another extension that I wish would be turned on by default in a future Haskell revision.)"}], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "edited": false, "score": 0, "creation_date": 1547419366, "post_id": 54173444, "comment_id": 95176749, "body": "I think I got it. I was thinking that defining <code>type family F (a :: k1) :: k2</code> will introduce dependency between k1 and k2, but it doest not, kinds are arguments itself and we can have multiple instances mapping Char to different kinds. It can be seen from istance signatures, e.g. for <code>type instance F Char = Bool</code> <code>:i F</code> will give <code>type instance F * * Char = Bool</code> where both kind variables located on the left side."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "edited": false, "score": 0, "creation_date": 1547478345, "post_id": 54173444, "comment_id": 95196375, "body": "You may declare <code>type family FTy (k :: Type) :: Type; type family F (a :: k) :: FTy k</code> to enforce each that each input kind has one output kind, or <code>type family FTy (a :: k) :: Type; type family F (a :: k) :: FTy a</code> to enforce one output of any kind for each input. I didn&#39;t realize this was your original issue when writing the answer, sorry."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 6, "last_activity_date": 1547415865, "last_edit_date": 1547415865, "creation_date": 1547415399, "answer_id": 54173444, "question_id": 54173073, "link": "https://stackoverflow.com/questions/54173073/kind-ambiguity-when-using-polykinds-and-type-families/54173444#54173444", "title": "Kind ambiguity when using PolyKinds and type families", "body": "<pre><code>f :: forall k1 k2 (a :: k1) (p :: k1 -&gt; *). p a -&gt; G (F a :: k2)\n</code></pre>\n\n<p>Let me try to say:</p>\n\n<pre><code>x :: [String]\nx = f (Just 'a')\n</code></pre>\n\n<p>This goes and instantiates <code>f</code> with <code>k1 ~ Type</code>, <code>a ~ Char</code>, and <code>p ~ Maybe</code></p>\n\n<pre><code>f :: forall k2. Maybe Char -&gt; G (F Char :: k2)\n</code></pre>\n\n<p>Now what? Well, I further need <code>G (F Char :: k2) ~ [String]</code>, but <code>G</code> is a non-injective type family, so there's no telling what either of its arguments\u2014<code>k2</code> and <code>F Char :: k2</code>\u2014should be. Therefore, the definition of <code>x</code> is in error; <code>k2</code> is ambiguous and it's impossible to infer an instantiation for it.</p>\n\n<p>However, you can pretty clearly see that <em>no</em> usage of <code>f</code> will <em>ever</em> be able to infer <code>k2</code>. The reasoning is that <code>k2</code> only appears in the type of <code>f</code> underneath a non-injective type family application (the other \"bad position\" is the LHS of a <code>=&gt;</code>). It never appears in a position where it can be inferred. Therefore, without an extension like <code>TypeApplications</code>, <code>f</code> is <em>useless</em>, and can never be mentioned without raising this error. GHC gives detects this and raises an error at the definition rather than the usages. The error message you see is about the same error you get if you try:</p>\n\n<pre><code>f0 :: forall k10 k20 (a :: k10) (p0 :: k10 -&gt; *). p0 a0 -&gt; G (F a0 :: k20)\nf0 = f\n</code></pre>\n\n<p>This produces the same type mismatch, as there is no reason the <code>k20</code> of <code>f0</code> must match the <code>k2</code> of <code>f1</code>.</p>\n\n<p>You can silence the error in the definition of <code>f</code> by enabling <code>AllowAmbiguousTypes</code>, which disables this uselessness check on all definitions. However, alone, this just pushes the error to every usage of <code>f</code>. In order to actually call <code>f</code>, you should enable <code>TypeApplications</code>:</p>\n\n<pre><code>f0 :: forall k10 k20 (a :: k10) (p0 :: k10 -&gt; *). p0 a0 -&gt; G (F a0 :: k20)\nf0 = f @k10 @k20 @a0 @p0\n</code></pre>\n\n<p>The alternative to <code>TypeApplications</code> is something like <code>Data.Proxy.Proxy</code>, but that's pretty much obsolete, except in higher-rank contexts. (And even then, it'll really be out of its job once we have something like <a href=\"https://github.com/ghc-proposals/ghc-proposals/pull/155\" rel=\"nofollow noreferrer\">type-lambdas</a>.)</p>\n"}, {"comments": [{"owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "edited": false, "score": 0, "creation_date": 1547421679, "post_id": 54173487, "comment_id": 95177212, "body": "Actually I do not need <code>PolyKinds</code> for my task at all. Multiple kinds came from promoted datatypes, by I can define instances for proxied types of kind <code>*</code>. The first argument of <code>f</code> namelly <code>p (a :: k1)</code> is a singleton proxy. I personally don&#39;t like the idea of disabling ambiguity checks, event of enabling <code>PolyKinds</code> without sufficient reasons, because kind-monomorphic code allows simplier signatures."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 2, "last_activity_date": 1547415797, "creation_date": 1547415797, "answer_id": 54173487, "question_id": 54173073, "link": "https://stackoverflow.com/questions/54173073/kind-ambiguity-when-using-polykinds-and-type-families/54173487#54173487", "title": "Kind ambiguity when using PolyKinds and type families", "body": "<p>The ambiguity check was originally intended to reject functions which can't ever be called, because of type parameters and constraints which are not inferable from explicit function arguments. </p>\n\n<p>However, as of GHC 8.6.x, there are no such functions, because everything can be made explicit by <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#visible-type-application\" rel=\"nofollow noreferrer\"><code>TypeApplications</code></a>. I recommend to just enable <code>AllowAmbiguousTypes</code> and <code>TypeApplications</code>. GHC's warning about ambiguous types is not very informative by itself, since it rejects many of the valid use cases of type applications.</p>\n"}], "owner": {"reputation": 653, "user_id": 2236092, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8e95a9d73105658172c8932d5a920751?s=128&d=identicon&r=PG", "display_name": "schernichkin", "link": "https://stackoverflow.com/users/2236092/schernichkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 2, "accepted_answer_id": 54173444, "answer_count": 2, "score": 5, "last_activity_date": 1547415865, "creation_date": 1547412470, "question_id": 54173073, "link": "https://stackoverflow.com/questions/54173073/kind-ambiguity-when-using-polykinds-and-type-families", "title": "Kind ambiguity when using PolyKinds and type families", "body": "<p>I have two type-families, one of which maps one type to another type of different kind and  polymorphic function:</p>\n\n<pre><code>{-# LANGUAGE PolyKinds, TypeFamilies, FlexibleContexts, ScopedTypeVariables #-} \n\ntype family F (a :: k1) :: k2\ntype family G (a :: k2) :: *\n\nf :: forall k1 k2 (a :: k1) (p :: k1 -&gt; *) . p (a :: k1) -&gt; G (F (a :: k1) :: k2)\nf = undefined\n</code></pre>\n\n<p>This code does not typecheck with following error message:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018G k20 (F k20 k1 a)\u2019 with \u2018G k2 (F k2 k1 a)\u2019\n  Expected type: p a -&gt; G k2 (F k2 k1 a)\n    Actual type: p a -&gt; G k20 (F k20 k1 a)\n  NB: \u2018G\u2019 is a non-injective type family\n</code></pre>\n\n<p>but I can't understand where ambiguity came from and how can I specify missing kinds?</p>\n\n<p>When I use only one type family, it works:</p>\n\n<pre><code>g :: forall k1 k2 (a :: k1) (p :: k1 -&gt; *) (q :: k2 -&gt; *). p (a :: k1) -&gt; q (F (a :: k1) :: k2)\ng = undefined\n</code></pre>\n"}, {"tags": ["sockets", "haskell", "networking", "timeout"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1547408914, "post_id": 54171007, "comment_id": 95174129, "body": "Personally, I don&#39;t like the idea underlying <code>timeout</code>, or its use in the code above. What if <code>recvFrom</code> succeeds, and just after that the timeout expires, say before <code>close</code> (or even before <code>writeIORef</code>)? We consume the message from the OS buffer, but <code>tmp</code> will report <code>Nothing</code>, losing the message (and <code>ack</code> might still be zero)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1547409130, "post_id": 54171007, "comment_id": 95174179, "body": "It works fine for me.  How are you compiling it? What platform? What version of GHC?  EDIT: I used GHC 8.4.4 on OS-X.   EDIT2:  GHC 8.2.0 on Linux also worked fine."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1547410235, "post_id": 54171007, "comment_id": 95174495, "body": "It might make a difference whether the threaded runtime is used or not, but I gave up trying to trace recvFrom&#39;s implementation at a certain point"}, {"owner": {"reputation": 69, "user_id": 8165301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7043d1924d2096af17ed26917c5aebb?s=128&d=identicon&r=PG&f=1", "display_name": "benny b", "link": "https://stackoverflow.com/users/8165301/benny-b"}, "edited": false, "score": 0, "creation_date": 1547450511, "post_id": 54171007, "comment_id": 95182747, "body": "I&#39;m using GHCi, version 8.4.4 with stack as building tool under Windows 10."}, {"owner": {"reputation": 69, "user_id": 8165301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7043d1924d2096af17ed26917c5aebb?s=128&d=identicon&r=PG&f=1", "display_name": "benny b", "link": "https://stackoverflow.com/users/8165301/benny-b"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1547450640, "post_id": 54171007, "comment_id": 95182793, "body": "@chi I initially had the close statement under the timeout, but I changed the code 1000 times because I thought I wasn&#39;t closing the socket at the right time"}, {"owner": {"reputation": 69, "user_id": 8165301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7043d1924d2096af17ed26917c5aebb?s=128&d=identicon&r=PG&f=1", "display_name": "benny b", "link": "https://stackoverflow.com/users/8165301/benny-b"}, "edited": false, "score": 0, "creation_date": 1547451031, "post_id": 54171007, "comment_id": 95182914, "body": "And the stack version: Version 1.7.1, Git revision 681c800873816c022739ca7ed14755e85a579565 (5807 commits) x86_64 hpack-0.28.2"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1547486871, "post_id": 54171007, "comment_id": 95201091, "body": "I&#39;m guessing this is a Windows + GHCi problem, which I can&#39;t test.  Try compiling it instead of interpreting it (so, <code>ghc file.hs -o file</code> instead of <code>ghci file.hs</code>).  If that works then you have a way to continue development. Either way I suggest you file an issue on ghchq."}], "owner": {"reputation": 69, "user_id": 8165301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7043d1924d2096af17ed26917c5aebb?s=128&d=identicon&r=PG&f=1", "display_name": "benny b", "link": "https://stackoverflow.com/users/8165301/benny-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1547398920, "creation_date": 1547397980, "last_edit_date": 1547398920, "question_id": 54171007, "link": "https://stackoverflow.com/questions/54171007/why-does-system-timeout-in-haskell-not-work-for-sockets", "title": "Why does System.Timeout in Haskell not work for sockets?", "body": "<p>I'm trying to listen for UDP Datagrams for just 3 seconds in Haskell. I wrote some code but I'm not sure why it's not working. I set the timeout to 3 seconds, but it just waits forever and doesn't block</p>\n\n<pre><code>import Control.Concurrent  as CC  (forkIO, threadDelay, killThread)\nimport qualified Data.ByteString.Char8 as C\nimport Network.Socket \nimport Network.Socket.ByteString as B\nimport Data.IORef\nimport Control.Monad            (forever)\nimport System.Timeout\n\nreceiveDatagram = do \n  ack &lt;- newIORef (0 :: Int) \n  addrinfos &lt;- getAddrInfo Nothing (Just \"127.0.0.1\") (Just \"7001\")\n  let serveraddr = head addrinfos\n  sock &lt;- socket (addrFamily serveraddr) Datagram defaultProtocol\n  bind sock (addrAddress serveraddr)\n  print \"starting\"\n  tmp &lt;- timeout 3000000 (do\n    (msg, addr) &lt;- B.recvFrom sock 1024\n    close sock\n    writeIORef ack 1\n    print msg\n    )\n  case tmp of \n    Nothing -&gt; close sock\n    _       -&gt; print \"something else\"\n  print \"timeout done\"\n</code></pre>\n\n<p>The documentation for <code>timeout</code> states:</p>\n\n<blockquote>\n  <p>Standard I/O functions like hGetBuf, hPutBuf, Network.Socket.accept, or hWaitForInput appear to be blocking, but they really don't because the runtime system uses scheduling mechanisms like select(2) to perform asynchronous I/O, so it is possible to interrupt standard socket I/O or file I/O using this combinator.</p>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1547388866, "post_id": 54169699, "comment_id": 95168231, "body": "<code>[list]</code> is a single-element list (the one element being <code>list</code>). Did you mean <code>el &lt;- list</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1547388959, "post_id": 54169699, "comment_id": 95168272, "body": "Your logic looks suspect to me. What&#39;s the expected result of <code>take 10 (myFunction [2, 3])</code>?"}, {"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1547389212, "post_id": 54169699, "comment_id": 95168345, "body": "@melpomene (take 10 (myFunction [2, 3]) output will be [2, 3, 4, 6, 8, 9, 10, 12, 14, 15] all first 10 numbers from infinity numbers which we can divide without remainder. yes it is multiplies"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1547389329, "post_id": 54169699, "comment_id": 95168387, "body": "Well, your function actually returns <code>[2,3,4,6,6,8,9,10,12,12]</code>. <a href=\"https://tio.run/##TYxLCoAgAAX3neItCyyytrntEiIoJSR@ijIo6O6Wu5Yzw3uLOqx2LiV/j2eYolkDnDkiGPiFBxeGGpw2jSDQLkOu5PPSr7PMjjG0oii8MuFbbbsJEWVUVoO2KH@/vCPoRVWl9AI\" rel=\"nofollow noreferrer\">Live demo</a>."}, {"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1547389651, "post_id": 54169699, "comment_id": 95168495, "body": "You are correct. this output is not correct. I want output without duplicate. How can filter this list from duplicate?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1547392029, "post_id": 54169699, "comment_id": 95169170, "body": "Instead of binding <code>list</code> you could try <code>any (\\el -&gt; x `mod` el == 0) list</code>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1547392100, "post_id": 54169699, "comment_id": 95169193, "body": "Alternatively you could use <code>nub</code> from <code>Data.List</code> to remove duplicates but it&#39;s unnecessarily inefficient to do it that way"}, {"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1547392761, "post_id": 54169699, "comment_id": 95169399, "body": "@luqui It works perfectly thanks. But I don&#39;t understand, how any function in this case works?"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 2, "creation_date": 1547393750, "post_id": 54169699, "comment_id": 95169708, "body": "may be duplicate: <a href=\"https://stackoverflow.com/questions/54107722/how-to-make-a-sorted-list-of-multiples-for-several-numbers\" title=\"how to make a sorted list of multiples for several numbers\">stackoverflow.com/questions/54107722/&hellip;</a>"}, {"owner": {"reputation": 321, "user_id": 10205083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1889fbfa86aa1d996e51f465b5f6ca4d?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/10205083/steve"}, "edited": false, "score": 2, "creation_date": 1547395157, "post_id": 54169699, "comment_id": 95170118, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/54107722/how-to-make-a-sorted-list-of-multiples-for-several-numbers\">How to make a sorted list of multiples for several numbers?</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547482183, "post_id": 54169699, "comment_id": 95198665, "body": "See also <a href=\"https://stackoverflow.com/q/12480291/791604\">New state of the art in unlimited generation of Hamming sequence</a>, which <i>starts</i> from the solution listed as an answer here and improves from there."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1547404952, "post_id": 54171372, "comment_id": 95172959, "body": "or use <code>foldr1</code>."}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 4, "last_activity_date": 1547400457, "creation_date": 1547400457, "answer_id": 54171372, "question_id": 54169699, "link": "https://stackoverflow.com/questions/54169699/haskell-how-to-calculate-divider-from-an-infinite-list/54171372#54171372", "title": "Haskell, how to calculate divider from an infinite list?", "body": "<p>First let\u2019s solve the case for a single item instead of a list:</p>\n\n<pre><code>multiples n | n &gt; 0 = [n * i | i &lt;- [1..]]\n</code></pre>\n\n<p>That was easy enough. Now suppose we have <code>multiples 2</code> and <code>multiples 3</code>, how can we compute <code>multiples [2,3]</code>, i.e. the increasing sequence of numbers made of the multiples of 2 or 3, or in other words, the increasing list of numbers made that are either in the increasing list of numbers <code>multiples 2</code> or <code>multiples 3</code>? Try this:</p>\n\n<pre><code>merge (x:xs) (y:ys) = case compare x y of\n  GT -&gt; y : merge (x:xs) ys\n  LT -&gt; x : merge xs (y:ys)\n  EQ -&gt; x : merge xs ys\n</code></pre>\n\n<p>So now we can implement the desired function:</p>\n\n<pre><code>f (x:xs) = foldr merge (multiples x) (multiples &lt;$&gt; xs)\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 54171372, "answer_count": 1, "score": 0, "last_activity_date": 1547400457, "creation_date": 1547388734, "last_edit_date": 1547398940, "question_id": 54169699, "link": "https://stackoverflow.com/questions/54169699/haskell-how-to-calculate-divider-from-an-infinite-list", "title": "Haskell, how to calculate divider from an infinite list?", "body": "<p>How can I write a function which receives a list, for example <code>[7, 8, 9]</code>.</p>\n\n<p>The function has inside an infinite list. It will calculate all divisors from an infinite list. </p>\n\n<p>For example <code>take 5 (f [7, 8, 9])</code> output will be <code>[7, 8, 9, 14, 16]</code></p>\n\n<p>Second example <code>take 7 (f [7, 8, 9])</code>  output will be <code>[7, 8, 9, 14, 16, 18, 21]</code></p>\n\n<p>I hope you can understand what I mean.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>myFunction list = [x | x &lt;- [1..], el &lt;-[list], x `mod` el == 0]\n</code></pre>\n\n<p>My code works only with constant list. If I write  </p>\n\n<pre><code>myFunction list = [x | x &lt;- [1..], el &lt;-[7, 8], x `mod` el == 0]\n</code></pre>\n\n<p>It works only for 7 and 8</p>\n\n<p>How can I pass an arbitrary list?</p>\n"}, {"tags": ["haskell", "functor", "applicative"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1547372826, "post_id": 54167529, "comment_id": 95164583, "body": "<code>fmap2 :: (a -&gt; a&#39;, b -&gt; b&#39;) -&gt; (f a, f b) -&gt; (f a&#39;, f b&#39;)</code> can be a nice operation, but this is directly derivable from the standard functor class as <code>fmap2 (f,g) (x,y) = (fmap f x, fmap g y)</code>, so there would be no need to have another typeclass. Instead, the original <code>fmap2 :: (a \u2192 b \u2192 c) \u2192 f a \u2192 f b \u2192 f c</code> can not be derived, so it is a real extension (an additional requirement on <code>f</code>)."}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1547373474, "post_id": 54167529, "comment_id": 95164706, "body": "@chi, that&#39;s the point of my question: is <code>(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</code> really a generalization of <code>Functor</code> to be a theoretic <code>Bifunctor</code>, or just a useful extension from programming point of view, which has nothing to do with true bifunctor? Just wanted to confirm."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1547376751, "post_id": 54167529, "comment_id": 95165309, "body": "I&#39;d say it has nothing to do with bifunctors. That extension, I guess, can be formalized nicely in category theory, and not only in programming, but it&#39;s not a bifunctor. To me, &quot;applicative&quot; is an additional requirement on a (unary, covariant) functor between cartesian closed categories, where there&#39;s a morphism from <code>F(b^a)</code> to <code>(F b)^(F a)</code> satisfying a bunch of laws."}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1547378287, "post_id": 54167529, "comment_id": 95165653, "body": "@chi, exactly, see the answer beneath."}], "answers": [{"comments": [{"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1547373706, "post_id": 54167616, "comment_id": 95164745, "body": "<code>(a -&gt; b, c -&gt; d) -&gt; f (a, b) -&gt; f (c, d)</code> is not very different from what I&#39;ve mentioned. It is actually the same, as long as you keep in mind that <code>f a b</code> is just a pair of objects <code>f (a, b)</code> and <code>(a -&gt; b, c -&gt; d)</code> is an <b>uncurried</b> version, which is isomorphic to the curried one, given by your example."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 2, "last_activity_date": 1547372224, "creation_date": 1547372224, "answer_id": 54167616, "question_id": 54167529, "link": "https://stackoverflow.com/questions/54167529/generalization-of-the-functor-class-to-become-a-multifunctor/54167616#54167616", "title": "Generalization of the `Functor` class to become a `MultiFunctor`?", "body": "<p>Let's start with the obvious: <code>fmap0</code> is pure.</p>\n\n<p>Here's one you made a mistake on: <code>fmap2</code> is <code>liftA2</code>.</p>\n\n<p>(<code>bimap</code> is very different - <code>(a -&gt; b) -&gt; (c -&gt; d) -&gt; f a b -&gt; f c d</code>)</p>\n\n<p>And if you go back to the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow noreferrer\">definition of <code>Applicative</code></a>, you see that it has a default implementation of <code>(&lt;*&gt;)</code>, which is <code>liftA2 id</code>, which allows you to define it in terms of pure and either <code>liftA2</code> or <code>(&lt;*&gt;)</code>.</p>\n\n<p>So yes, that class is equivalent to <code>Applicative</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1547374597, "post_id": 54167849, "comment_id": 95164905, "body": "Sure, if you take a moment to go throught page 6, paper states that <code>fmap2</code> is generalization of <code>Functor</code> to <code>Multifunctor</code>. That&#39;s why I anchored to the bifunctor. Thank&#39;s for reply!"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1547375392, "post_id": 54167849, "comment_id": 95165037, "body": "Note however that the mere addition of <code>fmap2</code> is not sufficient to make a (Haskell) applicative as one also needs a way to construct elements of type <code>f a</code>, e.g. <code>fmap0</code> or something of type <code>f ()</code> that behaves in a sensible way."}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 7, "last_activity_date": 1547501415, "last_edit_date": 1547501415, "creation_date": 1547374282, "answer_id": 54167849, "question_id": 54167529, "link": "https://stackoverflow.com/questions/54167529/generalization-of-the-functor-class-to-become-a-multifunctor/54167849#54167849", "title": "Generalization of the `Functor` class to become a `MultiFunctor`?", "body": "<p>I think the category theory angle you are taking is wrong. There is a Bifunctor class (with a map of type <code>(a -&gt; b) -&gt; (c -&gt; d) -&gt; f a c -&gt; f b d</code>) but that is not what this generalisation is. If one uncurries some functions then the signature of <code>fmap2</code> looks like:</p>\n\n<pre><code>fmap2 :: ((a,b) -&gt; c) -&gt; (f a, f b) -&gt; f c\n</code></pre>\n\n<p>And by considering <code>fmap2 id</code>, we see that what we are implementing is not a bifunctor but a cartesian functor (i.e. a monoidal functor between cartesian categories), with <code>fmap2 id :: (f a, f b) -&gt; f (a,b)</code> being the natural transformation:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1HrBH.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1HrBH.gif\" alt=\"\\mu_{x,y} : F(x) \\otimes F(y) \\to F(x \\otimes y)\"></a></p>\n\n<p>One can then get an applicative from this <code>Multifunctor</code> generalisation. Just change <code>pure</code> for <code>fmap0</code> and <code>(&lt;*&gt;)</code> for <code>fmap2 ($)</code>.</p>\n"}], "owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 54167849, "answer_count": 2, "score": 2, "last_activity_date": 1547501415, "creation_date": 1547371425, "question_id": 54167529, "link": "https://stackoverflow.com/questions/54167529/generalization-of-the-functor-class-to-become-a-multifunctor", "title": "Generalization of the `Functor` class to become a `MultiFunctor`?", "body": "<p>I am learning from the \"<a href=\"https://arxiv.org/pdf/1403.0749.pdf\" rel=\"nofollow noreferrer\">Free Applicative Functors</a>\". Surely, the question I am going to ask is kind of aside with respect to main idea of the paper, but still...</p>\n\n<p>...on the page 6 there is an attempt to generalize <code>Functor</code> to <code>MultiFunctor</code>:</p>\n\n<pre><code>class Functor f \u21d2 MultiFunctor f where\n    fmap0 :: a \u2192 f a\n    fmap1 :: (a \u2192 b) \u2192 f a \u2192 f b\n    fmap1 = fmap\n    fmap2 :: (a \u2192 b \u2192 c) \u2192 f a \u2192 f b \u2192 f c\n    ...\n</code></pre>\n\n<p>I can not see how this definition is justified from the category theory's viewpoint: <code>fmap2</code> seems to be just a bifunctor, i.e. a functor defined on a <a href=\"https://en.wikipedia.org/wiki/Product_category\" rel=\"nofollow noreferrer\">product category</a>. By definition, product category is given by all possible ordered pairs of objects and morphisms are pairs as well, hence: <code>fmap2 :: (a -&gt; a', b -&gt; b') -&gt; (f a, f b) -&gt; (f a', f b')</code> looks and feels like more appropriate signature.</p>\n\n<p>I can understand the way of thinking standing behing the <code>(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</code> choice: it is just the most obvious way to take known <code>(a -&gt; b) -&gt; f a -&gt; f b</code> signature and force it to work with binary functions, rather then unary. But is<code>MultiFunctor</code> (given by the definition above) actually a bi-/multifunctor in the sense that category theory expects it to be? </p>\n\n<p>P.S. The reason why I am curious is that it seems like one <strong>can't</strong> get to the <code>Applicative</code> by generalizing <code>Functor</code>, though paper states that one can. </p>\n"}, {"tags": ["haskell", "functional-programming", "category-theory", "monoids"], "comments": [{"owner": {"reputation": 2550, "user_id": 3787777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb9764582914276c8f48944d7c3f8ef7?s=128&d=identicon&r=PG&f=1", "display_name": "Coderino Javarino", "link": "https://stackoverflow.com/users/3787777/coderino-javarino"}, "edited": false, "score": 2, "creation_date": 1547331414, "post_id": 54164346, "comment_id": 95158472, "body": "is this a math question? Maybe it&#39;s more suitable for <a href=\"https://math.stackexchange.com/\">math.stackexchange.com</a>"}, {"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "reply_to_user": {"reputation": 2550, "user_id": 3787777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb9764582914276c8f48944d7c3f8ef7?s=128&d=identicon&r=PG&f=1", "display_name": "Coderino Javarino", "link": "https://stackoverflow.com/users/3787777/coderino-javarino"}, "edited": false, "score": 4, "creation_date": 1547331724, "post_id": 54164346, "comment_id": 95158531, "body": "@Coderino Javarino I prefer to have an answer with a programming point of view. I think I don&#39;t have enough competence to understand math guys response. In case I won&#39;t find a response, I&#39;ll definitely try there. Thanks!"}, {"owner": {"reputation": 628808, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "edited": false, "score": 0, "creation_date": 1547342526, "post_id": 54164346, "comment_id": 95160291, "body": "<a href=\"https://en.wikipedia.org/wiki/Free_monoid\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Free_monoid</a>"}, {"owner": {"reputation": 628808, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "edited": false, "score": 0, "creation_date": 1547342702, "post_id": 54164346, "comment_id": 95160317, "body": "I&#39;m voting to close this question as off-topic because it belongs on a Math site.  (If the &quot;maths guys&quot; answers are too hard to understand, use <a href=\"https://math.stackexchange.com/\">math.stackexchange.com</a> rather than <a href=\"https://mathoverflow.net/.\">mathoverflow.net/.</a>)"}, {"owner": {"reputation": 628808, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "edited": false, "score": 1, "creation_date": 1547342740, "post_id": 54164346, "comment_id": 95160326, "body": "The programming point of view is that this is not a programming question :-)  (Category theory is for theoretical computer scientists.)"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 11, "creation_date": 1547369554, "post_id": 54164346, "comment_id": 95163999, "body": "The fact that monoids originated in mathematics does not take away from their relevance as a very common interface in certain functional programming languages. Many functional programmers don&#39;t have a background in mathematics, so that framing their questions as programming questions on SO will lead to answers much more suitable to them than a math-centered forum, whether professional or casual."}], "answers": [{"tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 4, "last_activity_date": 1547337277, "creation_date": 1547337277, "answer_id": 54164954, "question_id": 54164346, "link": "https://stackoverflow.com/questions/54164346/what-is-the-main-difference-between-free-monoid-and-monoid/54164954#54164954", "title": "What is the main difference between Free Monoid and Monoid?", "body": "<p>A free monoid is a specific type of monoid. Specifically, it\u2019s the monoid you get by taking some fixed set of elements as characters and then forming all possible strings from those elements. Those strings, with the underlying operation being string concatenation, form a monoid, and that monoid is called the free monoid.</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1547395649, "post_id": 54168130, "comment_id": 95170233, "body": "In Haskell, a language that embraces infinity, I don&#39;t think <code>[]</code> is free enough.  For example, <code>mconcat (repeat (Last Nothing)) &lt;&gt; Last (Just 42)</code> gives an observable value, but <code>mconcat (Last &lt;$&gt; (repeat Nothing &lt;&gt; [Just 42]))</code> does not."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 5, "creation_date": 1547413932, "post_id": 54168130, "comment_id": 95175410, "body": "@luqui You are correct. It&#39;s better to go with something like <code>data FreeMonoid a = FreeMonoid { runFreeMonoid :: forall b. Monoid b =&gt; (a -&gt; b) -&gt; b }</code>. <a href=\"http://comonad.com/reader/2015/free-monoids-in-haskell/\" rel=\"nofollow noreferrer\">Details in this post</a>."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 13, "last_activity_date": 1549901316, "last_edit_date": 1549901316, "creation_date": 1547376644, "answer_id": 54168130, "question_id": 54164346, "link": "https://stackoverflow.com/questions/54164346/what-is-the-main-difference-between-free-monoid-and-monoid/54168130#54168130", "title": "What is the main difference between Free Monoid and Monoid?", "body": "<p>In a programming context, I usually translate <em>free monoid</em> to <code>[a]</code>. In his excellent series of articles about <a href=\"https://bartoszmilewski.com/2014/10/28/category-theory-for-programmers-the-preface/\" rel=\"noreferrer\">category theory for programmers</a>, Bartosz Milewski describes <a href=\"https://bartoszmilewski.com/2015/07/21/free-monoids/\" rel=\"noreferrer\">free monoids</a> in Haskell as the list monoid (assuming one ignores some problems with infinite lists).</p>\n\n<p>The identity element is the empty list, and the binary operation is list concatenation:</p>\n\n<pre><code>Prelude Data.Monoid&gt; mempty :: [Int]\n[]\nPrelude Data.Monoid&gt; [1..3] &lt;&gt; [7..10]\n[1,2,3,7,8,9,10]\n</code></pre>\n\n<p>Intuitively, I think of this monoid to be 'free' because it a monoid that you can <em>always</em> apply, regardless of the type of value you want to work with (just like the free monad is a monad you can <em>always</em> create from any functor).</p>\n\n<p>Additionally, when more than one monoid exists for a type, the free monoid defers the decision on which specific monoid to use. For example, for integers, infinitely many monoids exist, but the most common are addition and multiplication.</p>\n\n<p>If you have two (or more integers), and you know that you may want to aggregate them, but you haven't yet decided which type of aggregation you want to apply, you can instead 'aggregate' them using the free monoid - practically, this means putting them in a list:</p>\n\n<pre><code>Prelude Data.Monoid&gt; [3,7]\n[3,7]\n</code></pre>\n\n<p>If you later decide that you want to add them together, then that's possible:</p>\n\n<pre><code>Prelude Data.Monoid&gt; getSum $ mconcat $ Sum &lt;$&gt; [3,7]\n10\n</code></pre>\n\n<p>If, instead, you wish to multiply them, you can do that as well:</p>\n\n<pre><code>Prelude Data.Monoid&gt; getProduct $ mconcat $ Product &lt;$&gt; [3,7]\n21\n</code></pre>\n\n<p>In these two examples, I've deliberately chosen to elevate each number to a type (<code>Sum</code>, <code>Product</code>) that embodies a more specific monoid, and then use <code>mconcat</code> to perform the aggregation.</p>\n\n<p>For addition and multiplication, there are more succinct ways to do this, but I did it that way to illustrate how you can use a more specific monoid to interpret the free monoid.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 4, "last_activity_date": 1618242148, "last_edit_date": 1618242148, "creation_date": 1547377805, "answer_id": 54168259, "question_id": 54164346, "link": "https://stackoverflow.com/questions/54164346/what-is-the-main-difference-between-free-monoid-and-monoid/54168259#54168259", "title": "What is the main difference between Free Monoid and Monoid?", "body": "<p>A monoid <code>(M,\u2022,1)</code> is a mathematical structure such that:</p>\n<ol>\n<li><code>M</code> is a set</li>\n<li><code>1</code> is a member of <code>M</code></li>\n<li><code>\u2022 : M * M -&gt; M</code></li>\n<li><code>a\u20221 = a = 1\u2022a</code></li>\n<li>Given elements <code>a</code>, <code>b</code> and <code>c</code> in <code>M</code>, we have <code>a\u2022(b\u2022c) = (a\u2022b)\u2022c</code>.</li>\n</ol>\n<p>A free monoid on a set <code>M</code> is a monoid <code>(M',\u2022,0)</code> and function <code>e : M -&gt; M'</code> such that, for any monoid <code>(N,*,1)</code>, given a (set) map <code>f : M -&gt; N</code> we can extend this to a monoid morphism <code>f' : (M',\u2022,0) -&gt; (N,*,1)</code>, i.e</p>\n<pre><code>f a = f' (e a)\nf' 0 = 1\nf' (a\u2022b) = (f' a) \u2022 (f' b)\n</code></pre>\n<p>In other words, it is a monoid that does nothing special.</p>\n<p>An example monoid is the integers with the operation being addition and the identity being 0. Another monoid is sequences of integers with the operation being concatenation and the identity being the empty sequence. Now the integers under addition is not a free monoid on the integers. Consider the map into sequences of integers taking <code>n</code> to <code>(n)</code>. Then for this to be free we would need to extend this to a map taking <code>n + m</code> to <code>(n,m)</code>, i.e. it must take <code>0</code> to <code>(0)</code> and to <code>(0,0)</code> and to <code>(0,0,0)</code> and so on.</p>\n<p>On the other hand if we try to look at sequences of integers as a free monoid on the integers, we see that it seems to work in this case. The extension of the map into the integers with addition is one that takes the sum of a sequence (with the sum of () being 0).</p>\n<p>So what is the free monoid on a set <code>S</code>? Well one thing we could try is just arbitrary binary trees of <code>S</code>. In a Haskell type this would look like:</p>\n<pre><code>data T a = Unit | Single a | Conc (T a) (T a)\n</code></pre>\n<p>And it would have an identity of <code>Unit</code>, <code>e = Single</code> and <code>(\u2022) = Conc</code>.</p>\n<p>And we can write a function to show how it is free:</p>\n<pre><code>-- here the second argument represents a monoid structure on b\nfree :: (a -&gt; b) -&gt; (b -&gt; b -&gt; b, b) -&gt; T a -&gt; b\nfree f ((*),zero) = f' where\n  f' (Single a) = f a\n  f' Unit = zero\n  f' (Conc a b) = f' a * f' b\n</code></pre>\n<p>It should be quite obvious that this satisfies the required laws for a free monoid on <code>a</code>. Except for one: <code>T a</code> is not a monoid because it does not quite satisfy laws 4 or 5.</p>\n<p>So now we should ask if we can make this into a simpler free monoid, ie one that is an actual monoid. The answer is yes. One way is to observe that <code>Conc Unit a</code> and <code>Conc a Unit</code> and <code>Single a</code> should be the same. So let\u2019s make the first two types unrepresentable:</p>\n<pre><code>data TInner a = Single a | Conc (TInner a) (TInner a)\ndata T a = Unit | Inner (TInner a)\n</code></pre>\n<p>A second observation we can make is that there should be no difference between <code>Conc (Conc a b) c</code> and <code>Conc a (Conc b c)</code>. This is due to law 5 above. We can then flatten our tree:</p>\n<pre><code>data TInner a = Single a | Conc (a,TInner a)\ndata T a = Unit | Inner (TInner a)\n</code></pre>\n<p>The strange construction with <code>Conc</code> forces us to only have a single way to represent <code>Single a</code> and <code>Unit</code>. But we see we can merge these all together: change the definition of <code>Conc</code> to <code>Conc [a]</code> and then we can change <code>Single x</code> to <code>Conc [x]</code>, and <code>Unit</code> to <code>Conc []</code> so we have:</p>\n<pre><code>data T a = Conc [a]\n</code></pre>\n<p>Or we can just write:</p>\n<pre><code>type T a = [a]\n</code></pre>\n<p>And the operations are:</p>\n<pre><code>unit = []\ne a = [a]\n(\u2022) = append\n\nfree f ((*),zero) = f' where\n  f' [] = zero\n  f' (x:xs) = f x * f' xs\n</code></pre>\n<p>So in Haskell, the list type is called the free monoid.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 13, "last_activity_date": 1547480888, "last_edit_date": 1547480888, "creation_date": 1547377877, "answer_id": 54168267, "question_id": 54164346, "link": "https://stackoverflow.com/questions/54164346/what-is-the-main-difference-between-free-monoid-and-monoid/54168267#54168267", "title": "What is the main difference between Free Monoid and Monoid?", "body": "<p>As you already know, a monoid is a set with an element <code>e</code> and an operation <code>&lt;&gt;</code> satisfying</p>\n\n<pre><code>e &lt;&gt; x = x &lt;&gt; e = x  (identity)\n(x&lt;&gt;y)&lt;&gt;z = x&lt;&gt;(y&lt;&gt;z)  (associativity)\n</code></pre>\n\n<p>Now, a <em>free</em> monoid, intuitively, is a monoid which satisfies only those equations above, and, obviously, all their consequences.</p>\n\n<p>For instance, the Haskell list monoid <code>([a], [], (++))</code> is free.</p>\n\n<p>By contrast, the Haskell sum monoid <code>(Sum Int, Sum 0, \\(Sum x) (Sum y) -&gt; Sum (x+y))</code> is not free, since it also satisfies additional equations. For instance, it's commutative</p>\n\n<pre><code>x&lt;&gt;y = y&lt;&gt;x\n</code></pre>\n\n<p>and this does not follow from the first two equations.</p>\n\n<p>Note that it can be proved, in maths, that all the free monoids are isomorphic to the list monoid <code>[a]</code>. So, \"free monoid\" in programming is only a fancy term for any data structure which 1) can be converted to a list, and back, with no loss of information, and 2) vice versa, a list can be converted to it, and back, with no loss of information.</p>\n\n<p>In Haskell, you can mentally substitute \"free monoid\" with \"list-like type\".</p>\n"}], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 2, "accepted_answer_id": 54168130, "answer_count": 4, "score": 11, "last_activity_date": 1618242148, "creation_date": 1547331212, "last_edit_date": 1547493150, "question_id": 54164346, "link": "https://stackoverflow.com/questions/54164346/what-is-the-main-difference-between-free-monoid-and-monoid", "title": "What is the main difference between Free Monoid and Monoid?", "body": "<p>Looks like I have a pretty clear understanding what a <code>Monoid</code> is in Haskell, but last time I heard about something called a free monoid.</p>\n\n<p>What is a free monoid and how does it relate to a monoid?</p>\n\n<p>Can you provide an example in Haskell?</p>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 1, "creation_date": 1547329890, "post_id": 54164158, "comment_id": 95158161, "body": "after <code>where</code> comes the code of the module.  ie the functions and datatypes of the module.  If you need to import anything that comes after the &quot;where&quot; but before the rest of the code.  Is this a question of syntax or what functions you should write?"}, {"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "reply_to_user": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "edited": false, "score": 0, "creation_date": 1547330294, "post_id": 54164158, "comment_id": 95158254, "body": "@puhlen Ich have only this function und I need module for this function.  Is it this part corect?  <code>module Merge(Merge (empty, list)merge)</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547330461, "post_id": 54164158, "comment_id": 95158295, "body": "@Haskell: but here you only have the <code>merge</code> function, so <code>module Merge(merge) where</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1547330435, "creation_date": 1547330435, "answer_id": 54164255, "question_id": 54164158, "link": "https://stackoverflow.com/questions/54164158/haskell-how-to-define-module/54164255#54164255", "title": "Haskell, How to define Module?", "body": "<p>The <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html\" rel=\"noreferrer\"><em>Haskell '10 report</em></a> shows a sample program:</p>\n\n<blockquote>\n<pre><code>module Main where  \n  import A  \n  import B  \n  main = A.f &gt;&gt; B.f  \n\nmodule A where  \n  f = ...  \n\nmodule B where  \n  f = ...\n</code></pre>\n  \n  <p>It is equivalent to the following single-module program:</p>\n\n<pre><code>module Main where  \n  main = af &gt;&gt; bf  \n\n  af = ...  \n\n  bf = ...\n</code></pre>\n</blockquote>\n\n<p>After the <code>where</code> one writes import statements, class declarations, function declarations, etc.</p>\n\n<p>One can also write a list of exports between parenthesis. These exports are functions, classes, types, constructors, etc.</p>\n\n<p>Using <code>where</code> to enter a scope is not specific to modules. The same happens when we define the functions of a <code>class</code>, or function definitions in an <code>instance</code>.</p>\n\n<p>In your code, you only define a <code>merge</code> function, and do not import anything, so it is likely that the code file should look like:</p>\n\n<pre><code>module Merge(<b>merge</b>) where\n\nmerge::[a] -&gt; [a] -&gt; [a]\nmerge xs [] = xs\nmerge [] ys = ys\nmerge (x:xs) (y:ys) = x:y:(merge xs ys)</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "accepted_answer_id": 54164255, "answer_count": 1, "score": 0, "last_activity_date": 1547330435, "creation_date": 1547329596, "question_id": 54164158, "link": "https://stackoverflow.com/questions/54164158/haskell-how-to-define-module", "title": "Haskell, How to define Module?", "body": "<p>I wrote a very simple program in Haskell, which takes two list and it merges.\nBut I don't understand how to define Module in Haskell.</p>\n\n<p>Hier is my Code</p>\n\n<pre><code>module Merge(Merge (empty, list)merge) where ....\nmerge::[a] -&gt; [a] -&gt; [a]\nmerge xs [] = xs\nmerge [] ys = ys\nmerge (x:xs) (y:ys) = x:y:(merge xs ys)\n</code></pre>\n\n<p>I do not know, what I should after \"where\" write.\nOnly listoperations for example head tail etc. or?</p>\n\n<p>Can anyone help me? </p>\n"}, {"tags": ["haskell", "criterion"], "answers": [{"comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1547371783, "post_id": 54167311, "comment_id": 95164394, "body": "Even if I set the timeLimit to <code>0.01</code> - it still takes a &#39;while&#39; to run through all the benchmarks (which at the moment is just 3 benchmarks in total)."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 0, "last_activity_date": 1547369225, "creation_date": 1547369225, "answer_id": 54167311, "question_id": 54164078, "link": "https://stackoverflow.com/questions/54164078/how-can-i-reduce-the-criterion-benchmark-time/54167311#54167311", "title": "How can I reduce the criterion benchmark time?", "body": "<p>Set the <a href=\"http://hackage.haskell.org/package/criterion-1.5.3.0/docs/Criterion-Types.html#t:Config\" rel=\"nofollow noreferrer\"><code>timeLimit</code></a> field of <code>Config</code>. For example:</p>\n\n<pre><code>myConfig :: Config\nmyConfig = defaultConfig {\n              resamples = 1, timeLimit = 1\n           }\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547369225, "creation_date": 1547328908, "question_id": 54164078, "link": "https://stackoverflow.com/questions/54164078/how-can-i-reduce-the-criterion-benchmark-time", "title": "How can I reduce the criterion benchmark time?", "body": "<p>I'm trying to use the criterion library to do some benchmarking.</p>\n\n<p>I've tried a simple example:</p>\n\n<pre><code>module Main where\n\nimport Criterion.Types\nimport Criterion.Main\n\nmyConfig :: Config\nmyConfig = defaultConfig {\n              resamples = 1\n           }\n\nmain :: IO ()\nmain = do\n  let f = (\\x -&gt; bench (show x)  $ whnf xyz x)\n  defaultMainWith myConfig [\n    bgroup \"fib\" [ \n                  env (pure 5) f\n                ]\n    ]\n\nxyz :: Int -&gt; [Double]\nxyz 0 = []\nxyz x = case x of\n  100 -&gt; [sin $ fromIntegral x] ++ (xyz (x - 1))\n  _ -&gt; [sin $ fromIntegral (2 * x)] ++ (xyz (x - 1))\n</code></pre>\n\n<p>However this seems to take a few seconds to complete, I'd assume it'd complete significantly quicker?</p>\n\n<p>Why is it taking so long? How can I reduce the duration (even at the cost of inaccuracy)?</p>\n"}, {"tags": ["haskell", "expression", "list-comprehension"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 7, "creation_date": 1547316465, "post_id": 54162435, "comment_id": 95154692, "body": "That&#39;s a list comprehension. Do you understand them in general? <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">Here</a> would be a good place to start."}], "answers": [{"tags": [], "owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "is_accepted": true, "score": 2, "last_activity_date": 1547316606, "creation_date": 1547316606, "answer_id": 54162483, "question_id": 54162435, "link": "https://stackoverflow.com/questions/54162435/answer-to-this-haskell-expression/54162483#54162483", "title": "Answer to this Haskell expression", "body": "<p>It works like a foreach loop, so</p>\n\n<pre><code>foreach (x in [1..3]) {\n  foreach (y in [x .. x * 2]) {\n    yield y;\n  }\n}\n</code></pre>\n\n<p>First x is 1, so y in [1 .. 2]</p>\n\n<p>Then  x is 2, so y in [2 .. 4]</p>\n\n<p>Then  x is 3, so y in [3 .. 6]</p>\n\n<p>Concatenate these results together and you get the final result.</p>\n"}], "owner": {"reputation": 19, "user_id": 6155792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f91213a96c5d9a54e9b88106994d88?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Phoenix", "link": "https://stackoverflow.com/users/6155792/darren-phoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1547444522, "accepted_answer_id": 54162483, "answer_count": 1, "score": -6, "last_activity_date": 1547320907, "creation_date": 1547316281, "last_edit_date": 1547320907, "question_id": 54162435, "link": "https://stackoverflow.com/questions/54162435/answer-to-this-haskell-expression", "closed_reason": "Needs more focus", "title": "Answer to this Haskell expression", "body": "<p>The following expression <code>[y | x &lt;- [1..3], y &lt;- [x..x*2]]</code> produces the answer <code>[1, 2, 2, 3, 4, 3, 4, 5, 6]</code>. </p>\n\n<p>Can someone please explain the steps involved in reaching this answer?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1547316202, "post_id": 54160528, "comment_id": 95154608, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48654955/haskell-confused-about-uses-of-num-typeclass\">Haskell: confused about uses of Num typeclass</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 4, "creation_date": 1547303935, "post_id": 54160593, "comment_id": 95151042, "body": "<code>Fractional</code> <a href=\"http://hackage.haskell.org/package/base/docs/Prelude.html#t:Fractional\" rel=\"nofollow noreferrer\">is a subset</a> of <code>Num</code>, so I think you can omit the constraint on <code>Num</code>."}], "tags": [], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "is_accepted": true, "score": 4, "last_activity_date": 1547304852, "last_edit_date": 1547304852, "creation_date": 1547303866, "answer_id": 54160593, "question_id": 54160528, "link": "https://stackoverflow.com/questions/54160528/haskell-type-explanation/54160593#54160593", "title": "Haskell type explanation", "body": "<p>You have to add <code>Fractional a</code> to the context of <code>a</code>.</p>\n\n<pre><code>addCustom :: (Fractional a) =&gt; a -&gt; a\naddCustom a = a + 1.2\n</code></pre>\n\n<p>should work.</p>\n\n<hr>\n\n<p>If you fire up <code>ghci</code> and look at the type of <code>1.2</code> you'll see</p>\n\n<pre><code>(1.2) :: Fractional p =&gt; p\n</code></pre>\n\n<p>while the type of <code>(+)</code> is</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Which says that the function can be applied to which belongs to type class <code>Num</code>.</p>\n\n<p>So while <code>a -&gt; a</code> is the type of your function, it doesn't have the context of <code>Fractional</code>. Only of <code>Num</code></p>\n\n<p>That's why adding that context solves it.</p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 7, "last_activity_date": 1547305109, "creation_date": 1547305109, "answer_id": 54160764, "question_id": 54160528, "link": "https://stackoverflow.com/questions/54160528/haskell-type-explanation/54160764#54160764", "title": "Haskell type explanation", "body": "<p>Your type signature</p>\n\n<pre><code>addCustom :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>claims <code>addCustom</code> works for all numeric types <code>a</code>, including e.g. integers.</p>\n\n<p>But <code>addCustom (0 :: Integer)</code> would be an error: <code>a + 1.2</code> cannot be done with integer arithmetic because <code>1.2</code> is not an integer value (it's a fractional number).</p>\n\n<p>So what you need to do is either change the body of your function:</p>\n\n<pre><code>addCustom a = a + 1\n</code></pre>\n\n<p>(which works because <code>1</code> exists in all numeric types) or change the type signature:</p>\n\n<pre><code>addCustom :: Fractional a =&gt; a -&gt; a\n</code></pre>\n\n<p>(which restricts <code>addCustom</code> so it can only be used with fractional types, where <code>1.2</code> is a valid value).</p>\n"}], "owner": {"reputation": 179, "user_id": 5212963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed528b30d0e62b0420358528e7d03f11?s=128&d=identicon&r=PG&f=1", "display_name": "Never Mind", "link": "https://stackoverflow.com/users/5212963/never-mind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 54160593, "answer_count": 2, "score": 0, "last_activity_date": 1547318518, "creation_date": 1547303389, "last_edit_date": 1547318518, "question_id": 54160528, "link": "https://stackoverflow.com/questions/54160528/haskell-type-explanation", "title": "Haskell type explanation", "body": "<p>I don't understand a simple type error for the following code</p>\n\n<pre><code>addCustom :: Num a =&gt; a -&gt; a\naddCustom a = a + 1.2\n</code></pre>\n\n<p>It throws</p>\n\n<blockquote>\n  <p>Could not deduce (Fractional a) arising from the literal `1.2' </p>\n</blockquote>\n\n<p>and I can't figure out why.  </p>\n"}, {"tags": ["haskell", "io", "guard-statement"], "comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1548279847, "post_id": 54160306, "comment_id": 95489554, "body": "Note also that the extra indentation can be a single space \u2013 as long as the <code>|</code>s are at least one character to the right of the <code>a</code>, this should work."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1547304711, "last_edit_date": 1547304711, "creation_date": 1547303517, "answer_id": 54160543, "question_id": 54160306, "link": "https://stackoverflow.com/questions/54160306/haskell-io-indentation/54160543#54160543", "title": "Haskell IO indentation", "body": "<p><code>let</code> allows multiple definitions, as in</p>\n\n<pre><code>main = do\n   doSomething\n   let x = 1\n       y = 2\n       z = 3\n   print (x+y+z)\n</code></pre>\n\n<p>Note the indentation. <code>y = 2</code> is not parsed to continue the definition <code>x = 1</code> since it starts on the same column.</p>\n\n<p>If you want a new line to be parsed as if it continued the previous line, you have to indent it more. E.g.</p>\n\n<pre><code>main = do\n   doSomething\n   let x | someCondition = 1\n         | otherwise     = 0   -- more indented\n       y = 2\n       z = 3\n   print (x+y+z)\n</code></pre>\n\n<p>or, using another line</p>\n\n<pre><code>main = do\n   doSomething\n   let x\n          | someCondition = 1   -- more indented\n          | otherwise     = 0   -- more indented\n       y = 2\n       z = 3\n   print (x+y+z)\n</code></pre>\n\n<p>Indentation rules might seem puzzling at first, but they are actually\n<a href=\"https://stackoverflow.com/a/33010779/3234959\">quite simple</a>.</p>\n\n<p>I think your current code is as elegant as it might be -- it looks fine to me.</p>\n\n<p>If you want more alternatives, you could use <code>if then else</code>, even if most Haskellers would prefer guards. (Personally, I don't have a real preference)</p>\n\n<pre><code>main = do\n   doSomething\n   let x = if condition               then 1\n           else if someOtherCondition then 0\n           else                            -1\n       y = 2\n       z = 3\n   print (x+y+z)\n</code></pre>\n\n<p>You could also use another line, e.g. (I'd tend to prefer that)</p>\n\n<pre><code>main = do\n   doSomething\n   let x =\n          if condition               then 1\n          else if someOtherCondition then 0\n          else                            -1\n       y = 2\n       z = 3\n   print (x+y+z)\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>main = do\n   doSomething\n   let x =\n          if condition\n          then 1\n          else if someOtherCondition\n          then 0\n          else -1\n       y = 2\n       z = 3\n   print (x+y+z)\n</code></pre>\n\n<p>I'm not claiming a style is overwhelmingly better than another one.</p>\n"}, {"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1547442025, "creation_date": 1547442025, "answer_id": 54175993, "question_id": 54160306, "link": "https://stackoverflow.com/questions/54160306/haskell-io-indentation/54175993#54175993", "title": "Haskell IO indentation", "body": "<p>Another option is in-line pattern matching for sum types. This is nice if you have a short bit of code and you do not want to use multiple lines.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>z &lt;- maybeDoSomething :: IO (Maybe Int)\nlet x = case z of { Nothing -&gt; 0; Just v -&gt; v }\n</code></pre>\n\n<p>It can also short the space required for pattern matching in anonymous functions. This:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(\\x -&gt; case t of\n         Nothing -&gt; 0\n         Just v  -&gt; v\n)\n</code></pre>\n\n<p>Can be changed to this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(\\x -&gt; case t of { Nothing -&gt; 0; Just v  -&gt; v })\n</code></pre>\n\n<p>You can also avoid <code>if-then-else</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>t &lt;- didSomethingSucceed :: IO Bool\nlet x = case t of { True -&gt; 1; False -&gt; 0 }\n</code></pre>\n\n<p>I would only use this if the lines can be kept short and you have a small number of patterns to match, otherwise it might be hard to read.</p>\n"}], "owner": {"reputation": 67, "user_id": 10110373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85fdd93b852552364bec53f08c8e24c5?s=128&d=identicon&r=PG&f=1", "display_name": "Kitsune", "link": "https://stackoverflow.com/users/10110373/kitsune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 54160543, "answer_count": 2, "score": 1, "last_activity_date": 1547442025, "creation_date": 1547301848, "question_id": 54160306, "link": "https://stackoverflow.com/questions/54160306/haskell-io-indentation", "title": "Haskell IO indentation", "body": "<p>I tried to rewrite that program, which is working:</p>\n\n<pre><code>nameIOite :: IO ()\nnameIOite = do\n    putStrLn \"What's your name ?\"\n    name &lt;- getLine\n    if name `elem` [\"Simon\",\"John\",\"Phil\"]\n  --if name == \"Simon\" || name == \"John\" || name == \"Phil\" also works but is ugly.   \n        then putStrLn \"I think Haskell is a great programming language.\"\n        else if name == \"Koen\"\n            then putStrLn \"I think debugging Haskell is fun.\"\n            else putStrLn \"I don't know your name.\"\n</code></pre>\n\n<p>This is done using if/then/else (therefore the suffix ite in <code>nameIOite</code>)</p>\n\n<p>Then I'vs tried using guards:</p>\n\n<pre><code>nameIOg :: IO ()\nnameIOg = do\n    putStrLn \"What's your name ?\"\n    name &lt;- getLine\n    let answer\n        | name `elem` [\"Simon\",\"John\",\"Phil\"]   = \"I think Haskell is a great programming language.\"\n        | name == \"Koen\"                        = \"I think debugging Haskell is fun.\"\n        | otherwise                             = \"I don't know your name.\"\n    putStrLn answer\n</code></pre>\n\n<p>This didn't work:</p>\n\n<pre><code>test.hs:6:9: error:\nparse error (possibly incorrect indentation or mismatched brackets)\n  |\n6 |    | name `elem` [\"Simon\",\"John\",\"Phil\"]   = \"I think Haskell is   a great programming language.\"\n  |    ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>After some experimenting, the solution turned out to indent the guards once more (which isn't clear to me at all):</p>\n\n<pre><code>nameIOg :: IO ()\nnameIOg = do\n    putStrLn \"What's your name ?\"\n    name &lt;- getLine\n    let answer\n            | name `elem` [\"Simon\",\"John\",\"Phil\"]   = \"I think Haskell is a great programming language.\"\n            | name == \"Koen\"                        = \"I think debugging Haskell is fun.\"\n            | otherwise                             = \"I don't know your name.\"\n    putStrLn answer\n\nOk, one module loaded.\n</code></pre>\n\n<p><strong>Where does that double indentation come from and is there a way to write this more elegently ?</strong></p>\n\n<p>(By the way, I stumbled across this when reviewing my wikibook.hs files.)</p>\n\n<p>Source of example: <a href=\"https://en.wikibooks.org/wiki/Haskell/Simple_input_and_output\" rel=\"nofollow noreferrer\">there</a></p>\n\n<p>Solutions:         <a href=\"https://en.wikibooks.org/wiki/Haskell/Solutions/Simple_input_and_output\" rel=\"nofollow noreferrer\">there</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1547301318, "post_id": 54160195, "comment_id": 95150462, "body": "I don&#39;t understand the question. <code>a -&gt; a -&gt; Bool</code> is a bool-returning function with two arguments. Examples include equality (<code>==</code>) and inequality (<code>&#47;=</code>)."}, {"owner": {"reputation": 140, "user_id": 7611726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1262306767155895/picture?type=large", "display_name": "Reggie Snow", "link": "https://stackoverflow.com/users/7611726/reggie-snow"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1547301488, "post_id": 54160195, "comment_id": 95150510, "body": "Those examples are for when the typeclass is (Eq a) but I am talking about when the typeclass is (Ord a)."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1547301538, "post_id": 54160195, "comment_id": 95150520, "body": "It&#39;s still a bool-returning function of two arguments."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547301821, "post_id": 54160195, "comment_id": 95150579, "body": "Most of the functions which define the <code>Ord</code> type class have type <code>a -&gt; a -&gt; Bool</code>. <code>(&gt;)</code>, <code>(&lt;)</code>, <code>(&gt;=)</code> etc. All take 2 arguments of the same type and return a <code>Bool</code>, which is exactly what this signature means."}, {"owner": {"reputation": 140, "user_id": 7611726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1262306767155895/picture?type=large", "display_name": "Reggie Snow", "link": "https://stackoverflow.com/users/7611726/reggie-snow"}, "edited": false, "score": 0, "creation_date": 1547301854, "post_id": 54160195, "comment_id": 95150581, "body": "The question I am asking is, with this type signature am I able to declare an inequality with a predicate? eg)    &#39;&gt; 5 x ==True&#39;"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1547302427, "post_id": 54160195, "comment_id": 95150708, "body": "I don&#39;t understand the question. The predicate <code>x &lt; 5</code> (which is what it appears you are trying to write, in an overcomplicated way) has type <code>a -&gt; Bool</code> (with constraints that <code>a</code> has to be a member of <code>Ord</code> and <code>Num</code>), because it only takes 1 argument. (The term &quot;predicate&quot; returns to a function that takes one argument and returns a Bool. <code>a -&gt; a -&gt; Bool</code> isn&#39;t technically a predicate, but it could I suppose be considered a &quot;predicate of 2 arguments&quot;.)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547302501, "post_id": 54160195, "comment_id": 95150724, "body": "by the way, if you&#39;ve written a function and are unsure what type signature it should have, you can let type inference work for you - leave out the type signature, load your script into GHCI and see what comes up with the command <code>:type f</code> (if <code>f</code> is your function)"}, {"owner": {"reputation": 140, "user_id": 7611726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1262306767155895/picture?type=large", "display_name": "Reggie Snow", "link": "https://stackoverflow.com/users/7611726/reggie-snow"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547303568, "post_id": 54160195, "comment_id": 95150955, "body": "@RobinZigmond The question that I am relating this two actually is asking for a predicate with two arguments. I was just unsure of how to implement this. You have cleared this up for me. Thank you for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 7611726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1262306767155895/picture?type=large", "display_name": "Reggie Snow", "link": "https://stackoverflow.com/users/7611726/reggie-snow"}, "edited": false, "score": 0, "creation_date": 1547367890, "post_id": 54160854, "comment_id": 95163723, "body": "I was looking at the type signature of &#39; ( a -&gt; Bool) &#39; as just being related to predicates, without realising that it is just taking a value that returns T/F. I understand now thanks to your answer!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 140, "user_id": 7611726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1262306767155895/picture?type=large", "display_name": "Reggie Snow", "link": "https://stackoverflow.com/users/7611726/reggie-snow"}, "edited": false, "score": 0, "creation_date": 1547404247, "post_id": 54160854, "comment_id": 95172754, "body": "@ReggieSnow <code>f :: a -&gt; Bool</code> is a function, which takes a value <code>x :: a</code> and returns a value <code>y :: Bool</code>. so the value that <code>f</code> takes` (<code>x</code>) doesn&#39;t return anything -- it is <code>f</code> that returns a Boolean value <code>y :: Bool</code>."}], "tags": [], "owner": {"reputation": 321, "user_id": 10205083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1889fbfa86aa1d996e51f465b5f6ca4d?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/10205083/steve"}, "is_accepted": true, "score": 4, "last_activity_date": 1547403542, "last_edit_date": 1547403542, "creation_date": 1547305795, "answer_id": 54160854, "question_id": 54160195, "link": "https://stackoverflow.com/questions/54160195/the-difference-between-a-bool-and-a-a-bool-in-haskell/54160854#54160854", "title": "The difference between (a -&gt; Bool) and (a -&gt; a -&gt; Bool) in Haskell?", "body": "<p>When some function has a typesignature <code>(a -&gt; Bool)</code> it just means it takes a value of some unconstrained type <code>a</code> and returns a <code>Bool</code>, i.e. <code>True</code> or <code>False</code>. You can however restrict the type variable <code>a</code> and get something like this <code>Ord a =&gt; a -&gt; Bool</code>, it restricts the polymorphic type <code>a</code> in that sense that <code>a</code> has to have an instance of type class <code>Ord</code>.</p>\n\n<p>You can also partially apply functions. e.g <code>(&gt;) :: Ord a =&gt; a -&gt; a -&gt; Bool</code> and when you partially apply <code>&gt;</code> with <code>5</code> you get <code>(&gt;5) :: (Ord a, Num a) =&gt; a -&gt; Bool</code>. That is a new function that takes something that has to have the type class <code>Ord</code> as well as the type class <code>Num</code>, and returns <code>True</code> or <code>False</code>.</p>\n\n<p>To answer your question, you can of course create a new function by applying a constant to another function. You also don't really need the <code>==</code> if all you want to do is, check if a number is strictly bigger than a constant.</p>\n\n<pre><code>f = (&gt;) 5\nf 4 -- True\nf 5 -- False \n</code></pre>\n\n<p>I hope this helps you to get started with haskell. You should probably read some tutorial to get a good overview though. I can recommend <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learn you a haskell</a>.</p>\n"}], "owner": {"reputation": 140, "user_id": 7611726, "user_type": "registered", "profile_image": "https://graph.facebook.com/1262306767155895/picture?type=large", "display_name": "Reggie Snow", "link": "https://stackoverflow.com/users/7611726/reggie-snow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "closed_date": 1547493376, "accepted_answer_id": 54160854, "answer_count": 1, "score": -2, "last_activity_date": 1547403542, "creation_date": 1547301029, "question_id": 54160195, "link": "https://stackoverflow.com/questions/54160195/the-difference-between-a-bool-and-a-a-bool-in-haskell", "closed_reason": "Needs details or clarity", "title": "The difference between (a -&gt; Bool) and (a -&gt; a -&gt; Bool) in Haskell?", "body": "<p>I am currently learning Haskell and came across a type signature that confused me. </p>\n\n<p>I know that:</p>\n\n<pre><code>(a -&gt; Bool)\n</code></pre>\n\n<p>Is how a predicate is assigned in the type signature when using (Ord a) but I came across a type signature that is declared as:</p>\n\n<pre><code>(a -&gt; a -&gt; Bool)\n</code></pre>\n\n<p>Which according to what I found online is a type signature for inequalities but I am confused as to if they are for adding an inequality to a predicate, ie:</p>\n\n<pre><code>(&gt; p x == True)\n</code></pre>\n\n<p>Or if they are just to declare inequalities by themselves.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 10216, "user_id": 854207, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/R6DhK.jpg?s=128&g=1", "display_name": "paul", "link": "https://stackoverflow.com/users/854207/paul"}, "edited": false, "score": 1, "creation_date": 1547297046, "post_id": 54159621, "comment_id": 95149455, "body": "Nice, simple and elegant solution. Thanks"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 2, "last_activity_date": 1547296458, "creation_date": 1547296458, "answer_id": 54159621, "question_id": 54159274, "link": "https://stackoverflow.com/questions/54159274/share-data-type-for-json-aeson/54159621#54159621", "title": "Share Data type for Json Aeson", "body": "<p>A practical way to address such an issue is to put each JSON type in a separate library.</p>\n\n<p>So, the definition of the <em>album</em> JSON format would go into one module:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\nmodule AlbumJson where\n\nimport GHC.Generics (Generic)\nimport Data.Aeson (FromJSON, ToJSON)\n\ndata JAlbum = JAlbum {\n     artistName:: [Char],\n     trackName:: [Char],\n     collectionName:: [Char],\n     primaryGenreName:: [Char],\n     trackPrice:: Double,\n     trackViewUrl:: [Char],\n     releaseDate:: [Char],\n     previewUrl:: [Char],\n     artworkUrl100:: [Char]\n} deriving (Show, Generic)\n</code></pre>\n\n<p>The definition of the <em>movie</em> JSON format would go into another module:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\nmodule MovieJson where\n\nimport GHC.Generics (Generic)\nimport Data.Aeson (FromJSON, ToJSON)\n\ndata JMovie = JMovie {\n     artistName:: [Char],\n     trackName:: [Char],\n     previewUrl:: [Char],\n     trackViewUrl:: [Char],\n     trackRentalPrice:: Double,\n     trackPrice:: Double,\n     primaryGenreName:: [Char],\n     artworkUrl:: [Char]\n} deriving (Show, Generic)\n</code></pre>\n\n<p>These types are essentially static type representations of a wire format of which you have no control (the service owner controls the API), so it's good practice to have what in <a href=\"http://amzn.to/WBCwx7\" rel=\"nofollow noreferrer\">DDD</a> is known as an <em>anti-corruption layer</em>.</p>\n\n<p>Notice that I also prefixed the type names with <code>J</code>, which leaves the names <code>Album</code> and <code>Movie</code> free for use in a proper domain model.</p>\n\n<p>You can then use qualified imports to write some code that uses both types at once, if you need to.</p>\n\n<p><a href=\"https://github.com/ploeh/PureInteractionsInHaskell\" rel=\"nofollow noreferrer\">Here's a GitHub repository</a> with an example of that design approach, where you can see how I've used it, and how I've composed it. The two corresponding examples are the <code>OpeningJson</code> and <code>ReservationJson</code> modules. An example of code that uses both those modules is <code>ReservationsHttpClient</code>.</p>\n"}], "owner": {"reputation": 10216, "user_id": 854207, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/R6DhK.jpg?s=128&g=1", "display_name": "paul", "link": "https://stackoverflow.com/users/854207/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 54159621, "answer_count": 1, "score": 1, "last_activity_date": 1547296535, "creation_date": 1547293619, "last_edit_date": 1547296535, "question_id": 54159274, "link": "https://stackoverflow.com/questions/54159274/share-data-type-for-json-aeson", "title": "Share Data type for Json Aeson", "body": "<p>I\u00b4m consuming an API of apple where depending if I look for an album or for a movie the JSON format is different. Some attributes are shared between search but all of them are not the same.</p>\n\n<p>So what I did was just to create a data type for the <code>Movie</code> search and another for the <code>Album</code></p>\n\n<pre><code>data Album = Album {\n     artistName:: [Char],\n     trackName:: [Char],\n     collectionName:: [Char],\n     primaryGenreName:: [Char],\n     trackPrice:: Double,\n     trackViewUrl:: [Char],\n     releaseDate:: [Char],\n     previewUrl:: [Char],\n     artworkUrl100:: [Char]\n} deriving (Show, Generic)\n\ndata Movie = Movies {\n     artistName:: [Char],\n     trackName:: [Char],\n     previewUrl:: [Char],\n     trackViewUrl:: [Char],\n     trackRentalPrice:: Double,\n     trackPrice:: Double,\n     primaryGenreName:: [Char],\n     artworkUrl:: [Char]\n} deriving (Show, Generic)\n</code></pre>\n\n<p>Using <code>Aeson</code> I serialize/deserialize the data types, but then I realize that Haskell does not allow define arguments with the same name with multiple data types.</p>\n\n<p>But here to deserialize with <code>Aeson</code> the name of the attributes must match with the JSON. So I dont know what to do</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell", "applicative", "lenses"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1547403174, "post_id": 54159219, "comment_id": 95172412, "body": "I struggle with this because it looks completely overcomplicated, very hard to read and not worth the effort. Perhaps your actual case is more complicated but what is wrong with: <code>emFunctions (Custom a1 b1) (Custom a2 b2) = Custom (a1 + a2) (b1 + b2) where (+) = liftA2 (+)</code>?"}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1547404487, "post_id": 54159219, "comment_id": 95172822, "body": "Nothing really. Yours is a version of helper function without the use of lenses. My actual case has very deeply nested structures, so the reason I&#39;m using lenses is to make dealing with that a bit easier. The reason behind my question was to streamline adding structures with a function that doesn&#39;t rely on unfolding multiple structures to deal with the actual target. My idea was to mainly define a general function and use lenses to just point it at different parts/different depths of the those structures."}], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547298171, "creation_date": 1547293121, "last_edit_date": 1547298171, "question_id": 54159219, "link": "https://stackoverflow.com/questions/54159219/is-there-a-better-way-to-add-values-of-two-custom-data-types-where-both-are-inst", "title": "Is there a better way to add values of two custom data types where both are instances of MonoFunctor?", "body": "<p>I have some data defined as</p>\n\n<pre><code>{-# LANGUAGE RankNTypes      #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE TypeFamilies    #-}\n\nmodule Test where\n\nimport           Control.Lens\nimport           Data.MonoTraversable\n\ndata Custom = Custom { _a :: Maybe Float\n                     , _b :: Maybe Float\n                     }\nmakeLenses ''Custom\n\n\ntype instance Element Custom = Maybe Float\n\ninstance MonoFunctor Custom where\n    omap f (Custom ja jb) = Custom (f ja) (f jb)\n\ndata MainI = MainI { _name   :: Maybe String\n                   , _dTypes :: Maybe Custom\n                   }\nmakeLenses ''MainI\n</code></pre>\n\n<p>I have a function defined like this</p>\n\n<pre><code>addEm :: MainI -&gt; MainI -&gt; MainI\naddEm toGet toSet = toSet &amp; dTypes %~ (\\x -&gt; emFunctions &lt;$&gt; x &lt;*&gt; baseTypes)\n    where baseTypes =\n             (toGet &amp; (dTypes . _Just)  %~ (omap (\\x -&gt; pure (* 1.5) &lt;*&gt; x))) ^. dTypes \n</code></pre>\n\n<p>which just takes each value inside <code>Custom</code>, adds <code>1.5</code> times the values in <code>toGet</code> into the values in <code>toSet</code>.</p>\n\n<p>It does that with this helper function</p>\n\n<pre><code>emFunctions :: Custom -&gt; Custom -&gt; Custom\nemFunctions toGetC toSetC = toSetC\n     &amp; a %~ (\\x -&gt; (+) &lt;$&gt; x &lt;*&gt; toGetC ^. a)\n     &amp; b %~ (\\x -&gt; (+) &lt;$&gt; x &lt;*&gt; toGetC ^. b)\n</code></pre>\n\n<p>So I was wondering if there's a better way of doing this?</p>\n\n<p>Particularly doing it without the helper function.</p>\n\n<hr>\n\n<p>Also a related question: Would it be possible to sum up the <code>Custom</code> data? As in if <code>_a == 5.5</code> and <code>_b == 5.0</code> the <code>sumCustom</code> function would return <code>10.5</code></p>\n"}, {"tags": ["haskell", "dependent-type", "type-level-computation", "singleton-type"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1547339343, "post_id": 54158987, "comment_id": 95159857, "body": "I don&#39;t think this is possible without a <code>Maybe</code> or something like that in the result type. This function claims to make a list of a fixed size, known at a type level, out of a list of an unknown size. There is no type level information about the size of the <code>[a]</code> list. What should happen if you call like this <code>fromList (sing :: Sing 3) [1]</code>?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1547419353, "post_id": 54158987, "comment_id": 95176747, "body": "Your function is sound in principle (as @DavidYoung notes, it is a partial function, but this is easy enough to fix). The problem is you can&#39;t perform induction on type level nats in this way - you have to use inductive naturals (i.e. promoted version of <code>data Nat = Z | S Nat</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1547310566, "post_id": 54161483, "comment_id": 95152826, "body": "That equation is using <code>0</code> as a value. Singletons requires it to be a type."}], "tags": [], "owner": {"reputation": 1, "user_id": 2041995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581f35d471f3750216057b58cda1e3af?s=128&d=identicon&r=PG", "display_name": "Jean-Alexandre Barszcz", "link": "https://stackoverflow.com/users/2041995/jean-alexandre-barszcz"}, "is_accepted": false, "score": 0, "last_activity_date": 1547310094, "creation_date": 1547310094, "answer_id": 54161483, "question_id": 54158987, "link": "https://stackoverflow.com/questions/54158987/can-one-make-a-sized-list-using-singleton-nats-like-0-1-from-lists-in-ha/54161483#54161483", "title": "Can one make a sized list using singleton Nats (like 0, 1, ...) from Lists in Haskell?", "body": "<p>I don't know that library but from what I understand, the problem seem to be in the first clause of <code>fromList</code>, which should only match when n=0.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>--...\nfromList 0 []     = Nah\n--...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9164127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d2f19b2a507c4e39a768ca1d3c29bb?s=128&d=identicon&r=PG&f=1", "display_name": "BBMBR", "link": "https://stackoverflow.com/users/9164127/bbmbr"}, "edited": false, "score": 0, "creation_date": 1547368034, "post_id": 54161532, "comment_id": 95163744, "body": "So I assume need to somehow pattern match on the Singleton being (SNat :: SNat 0), is that correct? Is there any way to use type families to achieve this?"}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 31, "user_id": 9164127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d2f19b2a507c4e39a768ca1d3c29bb?s=128&d=identicon&r=PG&f=1", "display_name": "BBMBR", "link": "https://stackoverflow.com/users/9164127/bbmbr"}, "edited": false, "score": 0, "creation_date": 1547449429, "post_id": 54161532, "comment_id": 95182416, "body": "&quot;pattern match&quot; means at the term/value level. And no that won&#39;t work. You need &quot;instance match&quot;. Yes type families (instances) do that. I think you need to work through some official examples of Singletons."}, {"owner": {"reputation": 31, "user_id": 9164127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d2f19b2a507c4e39a768ca1d3c29bb?s=128&d=identicon&r=PG&f=1", "display_name": "BBMBR", "link": "https://stackoverflow.com/users/9164127/bbmbr"}, "edited": false, "score": 0, "creation_date": 1547473791, "post_id": 54161532, "comment_id": 95193849, "body": "Yea I kinda got that type families do that, though I&#39;m still unsure how I can use type families in this example."}], "tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 0, "last_activity_date": 1547310372, "creation_date": 1547310372, "answer_id": 54161532, "question_id": 54158987, "link": "https://stackoverflow.com/questions/54158987/can-one-make-a-sized-list-using-singleton-nats-like-0-1-from-lists-in-ha/54161532#54161532", "title": "Can one make a sized list using singleton Nats (like 0, 1, ...) from Lists in Haskell?", "body": "<p>Your signature for <code>fromList</code> says it works for any type <code>n :: Nat</code>. But the first equation returns <code>Nah</code>, which requires <code>n</code> to be type <code>0</code>.</p>\n\n<p>So <code>fromList</code> needs to be a method of a class that can despatch on the type of <code>n</code>.</p>\n\n<p>But you're trying to despatch on the <em>value</em> of the second argument to <code>fromList</code> -- that is, on the list being empty or not -- a dependent type. The Singletons library/technique is to fake dependent types in Haskell. And that's about where my knowledge runs out. So I use Peano Nats <code>S Z</code> with instances, and not with GADTs.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9164127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d2f19b2a507c4e39a768ca1d3c29bb?s=128&d=identicon&r=PG&f=1", "display_name": "BBMBR", "link": "https://stackoverflow.com/users/9164127/bbmbr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562250449, "creation_date": 1562250449, "answer_id": 56890010, "question_id": 54158987, "link": "https://stackoverflow.com/questions/54158987/can-one-make-a-sized-list-using-singleton-nats-like-0-1-from-lists-in-ha/56890010#56890010", "title": "Can one make a sized list using singleton Nats (like 0, 1, ...) from Lists in Haskell?", "body": "<p>After some time away from the problem I came back and found a solution that works for me: use an existential wrapper for the sized list type and convert the runtime list\nto that.</p>\n\n<pre><code>data SizedList (a :: *) (n :: Nat) where\n    Nil  :: SizedList a 0\n    Cons :: a -&gt; SizedList a n -&gt; SizedList a (n+1)\n\ndata SomeSL (a :: *) where\n    MkSomeSL :: KnownNat n =&gt; SNat n -&gt; SizedList a n -&gt; SomeSL a  \n\ntoList :: SizedList a n -&gt; [a]\ntoList Nil         = []\ntoList (Cons x xs) = x : toList xs\n\nfromList :: [a] -&gt; SomeSL a\nfromList []     = MkSomeSL (SNat @0) Nil \nfromList (x:xs) = case (fromList xs) of \n    MkSomeSL n ys -&gt; MkSomeSL (n %+ SNat @1) (Cons x ys)\n\ntoList_ :: SomeSL a -&gt; [a]\ntoList_ (MkSomeSL _ xs) = toList xs\n</code></pre>\n\n<p>Here, SomeSL wraps the SizedList type from my question along with a singleton nat, allowing functions to access the length through the SNat n.</p>\n\n<p>Justin Le's series of blog posts about singletons was very helpful: <a href=\"https://blog.jle.im/entry/introduction-to-singletons-1.html\" rel=\"nofollow noreferrer\">https://blog.jle.im/entry/introduction-to-singletons-1.html</a></p>\n"}], "owner": {"reputation": 31, "user_id": 9164127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d2f19b2a507c4e39a768ca1d3c29bb?s=128&d=identicon&r=PG&f=1", "display_name": "BBMBR", "link": "https://stackoverflow.com/users/9164127/bbmbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 56890010, "answer_count": 3, "score": 2, "last_activity_date": 1562250449, "creation_date": 1547291232, "question_id": 54158987, "link": "https://stackoverflow.com/questions/54158987/can-one-make-a-sized-list-using-singleton-nats-like-0-1-from-lists-in-ha", "title": "Can one make a sized list using singleton Nats (like 0, 1, ...) from Lists in Haskell?", "body": "<p>While learning about singletons and (semi) dependent typing, I started trying to make a sized list from a normal Haskell list with sizes given by Nats such as 0, 1, 2, 3,... instead of Z, S Z, S (S Z), etc.. I'm using the Data.Singletons.TypeLits library btw. (singletons-2.5.1).</p>\n\n<p>This is the way I've been trying to do it:</p>\n\n<pre><code>data NatList (a :: *) (n :: Nat) where\n    Nah :: NatList a 0\n    Yea :: a -&gt; NatList a n -&gt; NatList a (n + 1)\n\nfromList :: SNat n -&gt; [a] -&gt; NatList a n\nfromList s []     = Nah\nfromList s (x:xs) = Yea x (fromList (s %- (SNat :: SNat 1)) xs)\n</code></pre>\n\n<p>This code doesn't compile and gives me an error </p>\n\n<p>\"Couldn't match type \u2018n\u2019 with \u20180\u2019\n      \u2018n\u2019 is a rigid type variable bound by\n        the type signature for:\n          fromList :: forall (n :: Nat) a. SNat n -> [a] -> NatList a n</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1547284249, "post_id": 54158123, "comment_id": 95146481, "body": "It\u2019s an example program showing off a function <code>greet</code> that takes a name and returns a new string greeting the name. Sure you could make it a simple string value instead of a function with <code>greet = &quot;Hello, World&quot;</code> and <code>main = putStrLn greet</code>, just like you could rewrite the example expression <code>1 + 1</code> as <code>2</code>."}], "answers": [{"tags": [], "owner": {"reputation": 6194, "user_id": 2047987, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/WY0Zw.png?s=128&g=1", "display_name": "Cilenco", "link": "https://stackoverflow.com/users/2047987/cilenco"}, "is_accepted": true, "score": 2, "last_activity_date": 1547284631, "last_edit_date": 1547284631, "creation_date": 1547284296, "answer_id": 54158156, "question_id": 54158123, "link": "https://stackoverflow.com/questions/54158123/hello-world-in-haskell/54158156#54158156", "title": "Hello world in haskell", "body": "<p>It may help you if you look at the signature of this function. This is read as the function <code>greet</code> takes a <code>String</code> and outputs a <code>String</code>. The <code>String</code> type is just a shorthand for <code>[Char]</code></p>\n\n<pre><code>greet :: String -&gt; String\ngreet who = \"Hello, \" ++ who\n</code></pre>\n\n<p>is a function which takes one argument <code>who</code>. The <code>++</code> operator can append two lists and since Strings are Lists of characters in Haskell it will append the lists like this:</p>\n\n<pre><code>['H', 'e', 'l', 'l', 'o', ',', ' '] ++ ['W', 'o', 'r', 'l', 'd']\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 3, "last_activity_date": 1547286545, "creation_date": 1547286545, "answer_id": 54158424, "question_id": 54158123, "link": "https://stackoverflow.com/questions/54158123/hello-world-in-haskell/54158424#54158424", "title": "Hello world in haskell", "body": "<p>Reading between the lines of your question it sounds like you are reading </p>\n\n<pre><code>(greet \"World\")\n</code></pre>\n\n<p>as concatenating the string <code>greet</code> with the <code>\"World\"</code>. However in Haskell this is how you write function call and its arguments. A language like C or Java would write this as</p>\n\n<pre><code>greet (\"World\")\n</code></pre>\n\n<p>In Haskell brackets are not used for function arguments; instead they are only used for operator priority. \"Function application\" (meaning calling a function on some arguments) acts like an invisible operator with the highest priority.</p>\n"}], "owner": {"reputation": 13, "user_id": 10599011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daebf46f0baf8c0bb061e85dc7ab665a?s=128&d=identicon&r=PG&f=1", "display_name": "Milos", "link": "https://stackoverflow.com/users/10599011/milos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 54158156, "answer_count": 2, "score": -3, "last_activity_date": 1547286545, "creation_date": 1547283920, "last_edit_date": 1547284443, "question_id": 54158123, "link": "https://stackoverflow.com/questions/54158123/hello-world-in-haskell", "title": "Hello world in haskell", "body": "<p>This code is from a tutorial online that didn't really explain the logic behind this haskell code that prints \"Hello, World\". Could you explain what exactly is going on here. I'm particularly confused about what is going on in the last line and how it makes greet = Hello. Why is \"who\" needed? What is it's significance? And why is greet not just set as \"hello\". What am I supposed to learn out of this code snippet? Please forgive me as I am just getting into the world of functional programming and I think something obvious just flew over my head. </p>\n\n<pre><code>main :: IO () \n\nmain = putStrLn (greet \"World\") \n\ngreet who = \"Hello, \" ++ who\n</code></pre>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 1, "creation_date": 1547260171, "post_id": 54156236, "comment_id": 95143321, "body": "So, a workaround: I deleted by ~/.cabal directory and tried again. Not a great solution but I gather it is a possible hallmark of using cabal (though I thought <code>new-build</code> might improve things). Possibly the issue was because I pressed <code>ctrl-c</code> in a previous cabal step (can&#39;t recall which one)."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1547348076, "post_id": 54156236, "comment_id": 95161085, "body": "It sounds very likely that the problem was caused by building not being idempotent in the face of cancelation. You could have deleted only the broken package, instead of everything. Too bad you didn&#39;t keep it around to provide as additional information in a bug report."}, {"owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "edited": false, "score": 0, "creation_date": 1549306335, "post_id": 54156236, "comment_id": 95847599, "body": "It&#39;s possible that this is due to GHC writing files in a non-atomic fashion, see <a href=\"https://github.com/commercialhaskell/stack/issues/4559\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/4559</a>."}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547260237, "creation_date": 1547259152, "last_edit_date": 1547260237, "question_id": 54156236, "link": "https://stackoverflow.com/questions/54156236/how-to-resolve-however-the-given-installed-package-instance-does-not-exist-in", "title": "How to resolve &quot;however the given installed package instance does not exist&quot; in Cabal?", "body": "<p>I started a project a couple of days ago using cabal 2.4.0.x; earlier today, on my work system, all was going well. On my home system, also Linux with nixpkgs installed, which is nearly identical in configuration to my work system (I can think of no obvious differences), things were not going as well.</p>\n\n<p>When running <code>cabal new-build</code>, I get the following:</p>\n\n<pre><code> - http-client-tls-0.3.5.3 (lib) (requires build)\n - dhall-1.20.1 (lib) (requires build)\n - FarmDataServer-0.1.0.0 (lib) (first run)\n - FarmDataServer-0.1.0.0 (exe:FarmDataServer.exe) (first run)\nStarting     data-default-instances-old-locale-0.0.1 (all, legacy fallback)\nStarting     old-time-1.1.0.3 (all, legacy fallback)\nStarting     asn1-types-0.3.2 (all, legacy fallback)\nStarting     psqueues-0.2.7.1 (lib)\nStarting     regex-base-0.93.2 (all, legacy fallback)\nBuilding     psqueues-0.2.7.1 (lib)\nBuilding     regex-base-0.93.2 (all, legacy fallback)\nInstalling   regex-base-0.93.2 (all, legacy fallback)\nCompleted    regex-base-0.93.2 (all, legacy fallback)\nInstalling   psqueues-0.2.7.1 (lib)\nCompleted    psqueues-0.2.7.1 (lib)\n\nFailed to build asn1-types-0.3.2. The failure occurred during the configure\nstep.\nBuild log (\n/home/brandon/.cabal/logs/ghc-8.4.4/asn1-types-0.3.2-5476450b014d99552ab51937538e1a902b669ddfc2906ba67fe8a4099016b98e.log\n):\nConfiguring asn1-types-0.3.2...\ncabal: The following package dependencies were requested\n--dependency='hourglass=hourglass-0.2.12-b4e44e80db4dcca3718451012cc7a7ae0dbecf4c2012a6e72d47ff05ce4a80c4'\nhowever the given installed package instance does not exist.\n\n\nFailed to build data-default-instances-old-locale-0.0.1. The failure occurred\nduring the configure step.\nBuild log (\n/home/brandon/.cabal/logs/ghc-8.4.4/data-default-instances-old-locale-0.0.1-68d07651afec351ca1382acf43ff1403a204de89c766785ea29b5eb125d7ba75\n.log                                                                                                                                       \n):\nConfiguring data-default-instances-old-locale-0.0.1...\ncabal: The following package dependencies were requested\n--dependency='old-locale=old-locale-1.0.0.7-876e14e8597a236e2a6f9fc9ced1be9ed8de77ad3379ae7cf45fd794315103c0'\nhowever the given installed package instance does not exist.\n\n\nFailed to build old-time-1.1.0.3. The failure occurred during the configure\nstep.\nBuild log (\n/home/brandon/.cabal/logs/ghc-8.4.4/old-time-1.1.0.3-36078cb87fde3664624e1a9afd2a38b5750f797212f979be752effe1c5ef19c5.log\n):\nConfiguring old-time-1.1.0.3...\ncabal: The following package dependencies were requested\n--dependency='old-locale=old-locale-1.0.0.7-876e14e8597a236e2a6f9fc9ced1be9ed8de77ad3379ae7cf45fd794315103c0'\nhowever the given installed package instance does not exist.\n\ncabal: Failed to build asn1-types-0.3.2 (which is required by\nexe:FarmDataServer.exe from FarmDataServer-0.1.0.0). See the build log above\nfor details.\nFailed to build data-default-instances-old-locale-0.0.1 (which is required by\nexe:FarmDataServer.exe from FarmDataServer-0.1.0.0). See the build log above\nfor details.\nFailed to build old-time-1.1.0.3 (which is required by exe:FarmDataServer.exe\nfrom FarmDataServer-0.1.0.0). See the build log above for details.\n</code></pre>\n\n<p>I'm unsure of both what is causing the error, and what a workaround might be.</p>\n\n<p><strong>Update</strong> See comment, but one workaround was to delete <code>~/.cabal</code>.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1547258632, "post_id": 54156124, "comment_id": 95143147, "body": "I believe you&#39;ve run across the monomorphism restriction. <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">This</a> is a good StackOverflow explanation of the phenomenon, and <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-930004.5.5\" rel=\"nofollow noreferrer\">here</a> is the Haskell language specification section on it. In GHC, you can disable the restriction with <code>-XNoMonomorphismRestriction</code>, but it would make more sense to just add a type annotation explicitly."}], "owner": {"reputation": 1702, "user_id": 3143065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qyVhK.jpg?s=128&g=1", "display_name": "Cjen1", "link": "https://stackoverflow.com/users/3143065/cjen1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1547291556, "answer_count": 0, "score": 1, "last_activity_date": 1547257850, "creation_date": 1547257850, "question_id": 54156124, "link": "https://stackoverflow.com/questions/54156124/ambiguous-type-variable-when-using-tagless-final-approach", "closed_reason": "Duplicate", "title": "Ambiguous type variable when using Tagless Final approach", "body": "<p>I'm using template haskell to construct an integer which is tagged with its value at the type level:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell TypeOperators, DataKinds, KindSignatures #-}\n\nmodule TNat where\n\nimport GHC.TypeLits\nimport Language.Haskell.TH\n\ndata TNat (a::Nat) = TN Int deriving Show\n\nzero = (TN 0 :: TNat 0)\n\ninc :: TNat n -&gt; TNat (n + 1)\ninc (TN n) = TN (n + 1)\n\n-- usage: fromNat @5\nmkNat :: Int -&gt; Q Exp\nmkNat 0 = [| zero |]\nmkNat n = [| inc ($(mkNat (n - 1))) |] \n</code></pre>\n\n<p>I am using this in a tagless final style dsl of which I have made an examplar version:</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes, DataKinds, FlexibleContexts, TypeApplications, TypeFamilies, TypeOperators, UndecidableInstances, ExistentialQuantification, FlexibleInstances, GADTs #-}\n\n{-# LANGUAGE TemplateHaskell #-}\n\nmodule Test where\n\nimport TNat\nimport Text.Printf\nimport Language.Haskell.TH\nimport GHC.TypeLits\n\ndata IntList (ls :: [*])\n\nclass SYM repr where\n    nat :: TNat a -&gt; repr (TNat a)\n    ret :: repr b -&gt; repr (IntList '[b])\n    comp :: repr a -&gt; repr (IntList ls) -&gt; repr (IntList (a ': ls))\n\nnewtype S a = S{unS :: String}\ninstance SYM S where\n    nat (TN i) = S $ show i\n    ret e1 = S $ unS e1\n    comp e1 e2 = S $ (unS e1) ++ \" \" ++ (unS e2)\n</code></pre>\n\n<p>The issue is that the following statement is failing with an ambiguous type <code>repr0</code> rather than the more general <code>repr</code>:</p>\n\n<pre><code>t1 = ret $ nat $(mkNat 2) \n</code></pre>\n\n<p>The specific error message is:</p>\n\n<blockquote>\n<pre><code>* Ambiguous type variable `repr0' arising from a use of `r et'\n  prevents the constraint `(SYM repr0)' from being solved.\n  Relevant bindings include\n    t1 :: repr0 (IntList '[TNat 2]) (bound at test.hs:35:1 )\n  Probable fix: use a type annotation to specify what `rep r0' should be.\n  These potential instance exist:\n    instance SYM S -- Defined at test.hs:29:10\n* In the expression: ret $ nat (inc (inc zero))\n  In an equation for `t1': t1 = ret $ nat (inc (inc zero))    | 35 | t1 = ret $ nat $(mkNat 2)    |      ^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n</blockquote>\n\n<p>I feel that I am missing some key part of the declaration of the DSL, or that it is a odd interaction between Template Haskell and this style of writing DSLs (since I didn't have this issue with previous versions without TH).</p>\n"}, {"tags": ["haskell", "hint"], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 3137180, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vWlsj.jpg?s=128&g=1", "display_name": "jundl77", "link": "https://stackoverflow.com/users/3137180/jundl77"}, "edited": false, "score": 0, "creation_date": 1547258866, "post_id": 54156089, "comment_id": 95143167, "body": "You&#39;re right! And that was also the issue, using the let statement works, also with multi-lines. Amazing! Is there no way to attach definitions to expressions in Haskell?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 436, "user_id": 3137180, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vWlsj.jpg?s=128&g=1", "display_name": "jundl77", "link": "https://stackoverflow.com/users/3137180/jundl77"}, "edited": false, "score": 0, "creation_date": 1547261495, "post_id": 54156089, "comment_id": 95143469, "body": "There is, and it&#39;s <code>let</code>.   <code>let</code> : expression :: <code>where</code> : definition.  You can even put a <code>where</code> clause after a definition you make in <code>let</code> (I think)"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 3, "last_activity_date": 1547257349, "creation_date": 1547257349, "answer_id": 54156089, "question_id": 54155931, "link": "https://stackoverflow.com/questions/54155931/using-haskell-to-interpret-multi-line-strings-of-code-at-runtime/54156089#54156089", "title": "Using Haskell to interpret multi-line strings of code at runtime", "body": "<p>I haven't used hint, but I can tell you that your example is not a valid Haskell expression. <code>where</code> clauses are not attached to expressions, they are attached to <em>definitions</em>.  That is, you have to have an <code>=</code> sign to be able to have a <code>where</code> clause.</p>\n\n<pre><code>-- Correct\nfoo = bar\n    where\n    bar = baz\n        where \n        baz = 42\n\n-- Incorrect\nfoo = (bar + 1 where bar = 41)\n</code></pre>\n\n<p>If you want to define something in expression context you must use <code>let</code></p>\n\n<pre><code>let concatString :: String -&gt; String -&gt; String\n    concatString str1 str2 = str1 ++ str2\nin concatString \"Hello\" \"World\"\n</code></pre>\n"}], "owner": {"reputation": 436, "user_id": 3137180, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vWlsj.jpg?s=128&g=1", "display_name": "jundl77", "link": "https://stackoverflow.com/users/3137180/jundl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 54156089, "answer_count": 1, "score": 2, "last_activity_date": 1547259875, "creation_date": 1547255352, "last_edit_date": 1547259875, "question_id": 54155931, "link": "https://stackoverflow.com/questions/54155931/using-haskell-to-interpret-multi-line-strings-of-code-at-runtime", "title": "Using Haskell to interpret multi-line strings of code at runtime", "body": "<h3>Problem:</h3>\n\n<p>I would like to be able to interpret any sort of Haskell code at runtime - also code that is not bound by a single line.</p>\n\n<p>Right now I am using <a href=\"https://github.com/haskell-hint/hint\" rel=\"nofollow noreferrer\">hint</a> to do this below, which works with single lines:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>html :: String -&gt; IO String\nhtml code = do    \n    r &lt;- runInterpreter $ do\n        setImports [\"Prelude\"]\n        interpret code (as :: () -&gt; String)\n\n    case r of\n        Left err -&gt; return $ show err\n        Right func -&gt; return $ func()\n</code></pre>\n\n<h3>Example:</h3>\n\n<p>If <code>code</code> from above is <code>\\() -&gt; \"Hello World\"</code> that works.</p>\n\n<p>But if <code>code</code> is something like this below, <strike>my code from above does not work</strike>: (<strong>Update</strong>: it does).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\\() -&gt; let concatString :: String -&gt; String -&gt; String\n           concatString str1 str2 = str1 ++ str2\n       in concatString \"Hello\" \"World\"\n</code></pre>\n\n<h3>Question:</h3>\n\n<p>How do I interpret multi-line Haskell strings at runtime using hint or any other library?</p>\n\n<hr>\n\n<h1>Update</h1>\n\n<p>This does work - I made a mistake in the original expression (which I have now corrected).</p>\n"}, {"tags": ["haskell", "optimization", "allocation"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1547259173, "post_id": 54153689, "comment_id": 95143206, "body": "<a href=\"https://stackoverflow.com/tags/haskell/info\">stackoverflow.com/tags/haskell/info</a>"}, {"owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "edited": false, "score": 0, "creation_date": 1547270020, "post_id": 54153689, "comment_id": 95144404, "body": "Your third generator should be starting from x+1, I think? In a Pythagorean triple, x and y should always be different numbers."}], "answers": [{"comments": [{"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1547295484, "post_id": 54154281, "comment_id": 95149086, "body": "Of course I&#39;m compiling with <code>O3</code> It&#39;s in my post in the end. Okay, with <code>fllvm</code> and <code>Int</code> runtime is now <code>0.27s</code> against <code>0.14</code> in rust. I have two question. Why using <code>Int64</code> isn&#39;t as fast as using <code>Int</code> on my <code>amd64</code> machine? Another question is why it&#39;s still twice as slow? I&#39;ve read posts that compared rust to haskell and most of the time haskell had the same runtime. Do you have any other suggestions?"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 5, "last_activity_date": 1547242055, "creation_date": 1547242055, "answer_id": 54154281, "question_id": 54153689, "link": "https://stackoverflow.com/questions/54153689/how-to-optimize-this-pythagoras-triples-implementation/54154281#54154281", "title": "How to optimize this pythagoras triples implementation", "body": "<p>There are two issues with your code:</p>\n\n<ol>\n<li><p>For performance, you should compile <em>without</em> profiling, and with optimization. Profiling adds significant overhead. On my system <code>ghc -prof</code> results in a runtime of over <strong>40</strong> seconds, similarly to your time. <code>ghc -O2</code> without <code>-prof</code> yields just <strong>4.2</strong> seconds.</p></li>\n<li><p>Using <code>Int32</code> on a 64 bit system. You shouldn't do this, because non-native sized <code>Int</code> operations are compiled to slow out-of-line primops. When I change <code>Int32</code> to <code>Int</code>, runtime becomes <strong>0.44</strong> seconds. If I additionally use <code>-fllvm</code> for the LLVM code backend, I get <strong>0.2</strong> seconds. </p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1547264773, "post_id": 54154838, "comment_id": 95143824, "body": "It is not clear to me that this generates the same list (up to ordering).  It seems to empirically but would like a reference at least (it&#39;s cool though!)"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1547266446, "post_id": 54154838, "comment_id": 95144000, "body": "Here is one reference: <a href=\"http://mathworld.wolfram.com/PythagoreanTriple.html\" rel=\"nofollow noreferrer\">mathworld.wolfram.com/PythagoreanTriple.html</a> formula is perhaps older than two millennia.  With relative prime and different parity (odd, even) constraints on <code>n,m</code> you can get the primitive triples. The OP does generate the multiples of primitives as well, so I didn&#39;t bother."}, {"owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "edited": false, "score": 0, "creation_date": 1547295066, "post_id": 54154838, "comment_id": 95148981, "body": "The point is to use the same implementation for all languages and compare performance of it."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1547264417, "last_edit_date": 1547264417, "creation_date": 1547245369, "answer_id": 54154838, "question_id": 54153689, "link": "https://stackoverflow.com/questions/54153689/how-to-optimize-this-pythagoras-triples-implementation/54154838#54154838", "title": "How to optimize this pythagoras triples implementation", "body": "<p>Perhaps change your implementation?</p>\n\n<pre><code>triples = [(m^2-n^2,2*m*n,m^2+n^2) | m&lt;-[2..], n&lt;-[1..(m-1)]]\n</code></pre>\n"}], "owner": {"reputation": 4989, "user_id": 1685095, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/5f06068bb9b4c00f12582ccc0ba64c4a?s=128&d=identicon&r=PG", "display_name": "user1685095", "link": "https://stackoverflow.com/users/1685095/user1685095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 54154281, "answer_count": 2, "score": 3, "last_activity_date": 1547295793, "creation_date": 1547238903, "last_edit_date": 1547295793, "question_id": 54153689, "link": "https://stackoverflow.com/questions/54153689/how-to-optimize-this-pythagoras-triples-implementation", "title": "How to optimize this pythagoras triples implementation", "body": "<p>Here's haskell code</p>\n\n<pre><code>import GHC.Int\n\ntriples = [(x, y, z) | z &lt;- [(1::Int32)..],\n                       x &lt;- [(1::Int32) .. z + 1],\n                       y &lt;- [x.. z + 1],\n                       x * x + y * y == z * z]\n\nmain = mapM_ print (Prelude.take 1000 triples)\n</code></pre>\n\n<p>Which has following profile</p>\n\n<pre><code>       triples +RTS -p -RTS\n\n    total time  =       47.10 secs   (47103 ticks @ 1000 us, 1 processor)\n    total alloc = 62,117,115,176 bytes  (excludes profiling overheads)\n\nCOST CENTRE MODULE    SRC                      %time %alloc\n\ntriples     Main      triples.hs:(5,1)-(8,46)  100.0  100.0\n\n                                                                              individual      inherited\nCOST CENTRE  MODULE                SRC                     no.     entries  %time %alloc   %time %alloc\n\nMAIN         MAIN                  &lt;built-in&gt;              118          0    0.0    0.0   100.0  100.0\n CAF         Main                  &lt;entire-module&gt;         235          0    0.0    0.0   100.0  100.0\n  main       Main                  triples.hs:10:1-46      236          1    0.0    0.0     0.0    0.0\n  triples    Main                  triples.hs:(5,1)-(8,46) 237          1  100.0  100.0   100.0  100.0\n CAF         GHC.Conc.Signal       &lt;entire-module&gt;         227          0    0.0    0.0     0.0    0.0\n CAF         GHC.IO.Encoding       &lt;entire-module&gt;         216          0    0.0    0.0     0.0    0.0\n CAF         GHC.IO.Encoding.Iconv &lt;entire-module&gt;         214          0    0.0    0.0     0.0    0.0\n CAF         GHC.IO.Handle.FD      &lt;entire-module&gt;         206          0    0.0    0.0     0.0    0.0\n CAF         GHC.IO.Handle.Text    &lt;entire-module&gt;         144          0    0.0    0.0     0.0    0.0\n main        Main                  triples.hs:10:1-46      238          0    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>While equivalent <code>rust</code> code runs an order of magnitude faster. Which seems very strange to me.</p>\n\n<pre><code>fn triples() -&gt; impl Iterator&lt;Item=(i32, i32, i32)&gt; {\n    (1..).flat_map(|z| {\n        (1..z + 1).flat_map(move |x| {\n            (x..z + 1).filter_map(move |y| {\n                if x * x + y * y == z * z {\n                    Some((x, y, z))\n                } else {\n                    None\n                }\n            })\n        })\n    })\n}\n\nfn main() {\n    for triple in triples().take(1000) {\n        println!(\"{:?}\", triple);\n        // unsafe {printf(\"(%i, %i, %i)\\n\".as_ptr() as *const i8, x, y, z)};\n    }\n}\n</code></pre>\n\n<p>Results are</p>\n\n<pre><code>[I] ~/c/pythagoras (master|\u271a1\u2026) $ time ./range &gt; /dev/null\n0.16user 0.00system 0:00.16elapsed 100%CPU (0avgtext+0avgdata 2248maxresident)k\n0inputs+0outputs (0major+124minor)pagefaults 0swaps\n[I] ~/c/pythagoras (master|\u271a1\u2026) $ time ./triples &gt; /dev/null\n2.39user 0.00system 0:02.39elapsed 99%CPU (0avgtext+0avgdata 4736maxresident)k\n0inputs+0outputs (0major+473minor)pagefaults 0swaps\n</code></pre>\n\n<p>Both results are with <code>-O3</code> flag.</p>\n\n<p>Is it possible to optimize allocations out while saving idiomatic haskell code? Maybe some fusion library or something can do this?</p>\n\n<p>EDIT1. Okay using <code>Int</code> instead of <code>Int32</code> or <code>Int64</code> makes the code faster which is nice. Still with <code>fflvm</code> it's twice slower than rust and judging by profile it's still spends most of the time in allocations. What's preventing haskell from reusing the triple for example and not allocating it only once?</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1547236068, "post_id": 54153080, "comment_id": 95137197, "body": "Doesn&#39;t <code>lift ask</code> work?"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1547238720, "post_id": 54153080, "comment_id": 95138287, "body": "@arrowd the type signature is itself illegal. The MonadReader type class has a functional dependency that says that the monad <code>m</code> must uniquely determine the type that is being read. It does work if you use an explicit monad transformer stack instead of the type class though"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1547249956, "post_id": 54153080, "comment_id": 95141845, "body": "Keep in mind <code>MonadReader</code> is not a transformer.  If you use a transformer, a la the <code>transformers</code> package, and avoid thinking in the terms provided by <code>mtl</code> then you&#39;ll do fine."}], "answers": [{"tags": [], "owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "is_accepted": false, "score": 2, "last_activity_date": 1547238160, "creation_date": 1547238160, "answer_id": 54153551, "question_id": 54153080, "link": "https://stackoverflow.com/questions/54153080/monad-stack-with-multiple-of-the-same-transformer/54153551#54153551", "title": "monad stack with multiple of the same transformer", "body": "<p>One way to deal with it in a relatively straightforward way is to create a type that represents the state you wanna keep track of. Say you want to keep track of both a Bool and a Char as in your example</p>\n\n<pre><code>data MyState = MyState { getBool :: Bool, getChar :: Char }\n\nf :: MonadReader MyState m =&gt; m Bool\nf = asks getBool\n</code></pre>\n\n<p>Others may have more advanced solutions! </p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 4, "last_activity_date": 1547250201, "creation_date": 1547250201, "answer_id": 54155467, "question_id": 54153080, "link": "https://stackoverflow.com/questions/54153080/monad-stack-with-multiple-of-the-same-transformer/54155467#54155467", "title": "monad stack with multiple of the same transformer", "body": "<p>Use a transformer and lift to get to your inner monad:</p>\n\n<pre><code>import Control.Monad.Trans.Reader\nimport Control.Monad.Trans.Class (lift)\n\ntype MyMonad a = ReaderT Bool (Reader Char) a\n\naskBool :: MyMonad Bool\naskBool = ask\naskChar :: MyMonad Char\naskChar = lift ask\n</code></pre>\n\n<p>The code you presented didn't use any monad transformer (directly). It used the reader monad (which happens to be a transformer applied to the identity monad) and the <code>MonadReader</code> type class.  As you noticed, the type function implied by MonadReader can't result in two different outputs (the environment types) for the same input (the monad <code>m</code>).</p>\n"}], "owner": {"reputation": 2584, "user_id": 833970, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d9ae7aef22bea38dbf6a3f98789b4cc4?s=128&d=identicon&r=PG", "display_name": "user833970", "link": "https://stackoverflow.com/users/833970/user833970"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1614695287, "creation_date": 1547235755, "last_edit_date": 1614695287, "question_id": 54153080, "link": "https://stackoverflow.com/questions/54153080/monad-stack-with-multiple-of-the-same-transformer", "title": "monad stack with multiple of the same transformer", "body": "<p>I was trying to write my own monad transformers where it would make sense to have multiple of the same monad transformer on the stack with different types. The issue can be illustrated with the reader monad.</p>\n<p>The reader monad is offered as a way to hold a read only context of a given type</p>\n<pre><code>ex1 :: Reader Bool Bool\nex1 = ask\n</code></pre>\n<p>or</p>\n<pre><code>ex2 :: Reader Char Bool\nex2 = pure True\n</code></pre>\n<p>monad transformers allow less restrictive assumptions about the underlining monad</p>\n<pre><code>ex3 :: (MonadReader Bool m) =&gt; m Bool\nex3 = ask\n</code></pre>\n<p>However, what if I want to have more than 1 read only environment? I can write a function like</p>\n<pre><code>ex4 :: (MonadReader Bool m, MonadReader Char m) =&gt; m Bool\nex4 = ask\n</code></pre>\n<p>However, as far as I can tell, there is no way to run ex4 since</p>\n<pre><code>class Monad m =&gt; MonadReader r m | m -&gt; r \n</code></pre>\n<p>means that each MonadReader has a unique reading type.  Is there a standard work around for multiple transformers on the same stack? Should I try to avoid this entirely?</p>\n"}, {"tags": ["haskell", "mqtt"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1547228432, "post_id": 54151387, "comment_id": 95134158, "body": "I voted to close as too broad.  There isn&#39;t any one question here.  Perhaps this is like a quest for thoughts from people with similar experiences?"}, {"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1547231221, "post_id": 54151387, "comment_id": 95135232, "body": "You need to read the spec <a href=\"http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html\" rel=\"nofollow noreferrer\">docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html</a> but be aware the HTTP model will not match at all."}, {"owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1547233243, "post_id": 54151387, "comment_id": 95136018, "body": "@ThomasM.DuBuisson I tried to add more specific questions. There is not much material with MQTT in Haskell, sorry for the broad question."}, {"owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1547233308, "post_id": 54151387, "comment_id": 95136046, "body": "@hardillb what do you mean not match at all? Could you elaborate?"}, {"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1547235777, "post_id": 54151387, "comment_id": 95137076, "body": "Pub/Sub != Request/Response the whole paradigm is different (1 to many clients exchange messages, rather than 1 client request resource from server) , topics != URI resource requests."}], "answers": [{"comments": [{"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1549657677, "post_id": 54592030, "comment_id": 95995822, "body": "Mosquitto has a authentication plugin interface that allows you to implement your own authentication mechanism."}, {"owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1549825735, "post_id": 54592030, "comment_id": 96032784, "body": "@hardillb any links?"}], "tags": [], "owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "is_accepted": true, "score": 0, "last_activity_date": 1549627303, "creation_date": 1549627303, "answer_id": 54592030, "question_id": 54151387, "link": "https://stackoverflow.com/questions/54151387/mqtt-server-in-haskell/54592030#54592030", "title": "MQTT server in Haskell", "body": "<p>After some investigation, here are my findings on MQTT in Haskell:</p>\n\n<p>First library I found is <a href=\"http://hackage.haskell.org/package/mqtt-hs\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/mqtt-hs</a>. However it is buggy and not maintained anymore.\nI'm now using <a href=\"http://hackage.haskell.org/package/net-mqtt\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/net-mqtt</a>, which works well.</p>\n\n<p>I also understood that I didn't need to make a MQTT server: I just need to develop a client! My MQTT client will subscribe on a standard MQTT server (Mosquitto), and sink the data received in my database.</p>\n\n<p>Another pain point of MQTT is the authentication/authorization. My server uses Keycloak for access control, while Mosquitto uses a static ACL file. I solved this problem by developing an authorization proxy for MQTT: the proxy sits in front of Mosquitto and filter the requests, based on Keycloak decisions.</p>\n"}], "owner": {"reputation": 754, "user_id": 533919, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/622782b08cf5ee216199bdd5a7d68783?s=128&d=identicon&r=PG", "display_name": "cdupont", "link": "https://stackoverflow.com/users/533919/cdupont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 54592030, "answer_count": 1, "score": -3, "last_activity_date": 1549627303, "creation_date": 1547227825, "last_edit_date": 1547233160, "question_id": 54151387, "link": "https://stackoverflow.com/questions/54151387/mqtt-server-in-haskell", "title": "MQTT server in Haskell", "body": "<p>I would like to implement an MQTT server in Haskell.</p>\n\n<p>I already have a HTTP REST server made in Haskell and would like to add some MQTT endpoints to that server.\nFor instance, there is an endpoint <code>POST /foo</code>, allowing users to send some information that will be stored in a Mongo DB. I would like to add an MQTT endpoint: if someone performs a <code>PUBLISH</code> with topic <code>\"/foo\"</code>, the data will be stored to the same Mongo database, using the same internal functions than the <code>POST</code>.\nSimilarly for the <code>SUBSCRIBE</code>, the data should come from the backend database.</p>\n\n<p>I saw <a href=\"http://hackage.haskell.org/package/mqtt-0.1.1.0\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/mqtt-0.1.1.0</a>\nand\n<a href=\"https://github.com/lpeterse/haskell-hummingbird\" rel=\"nofollow noreferrer\">https://github.com/lpeterse/haskell-hummingbird</a>\nBut I'm not sure if they are useable as a library to create the endpoints with specific callbacks.</p>\n\n<p>So this is a two-fold question:</p>\n\n<ol>\n<li>Any feedback on implementing MQTT endpoints in Haskell?</li>\n<li>Is merging an HTTP and MQTT servers a good idea?</li>\n</ol>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 1, "creation_date": 1547231762, "post_id": 54150751, "comment_id": 95135428, "body": "In the discussion of Haskell modules, they mention that a module file Foo.hs must have a module named &quot;Foo&quot; in it. Haskell files that do not have an initial capital letter do not have that restriction."}], "answers": [{"comments": [{"owner": {"reputation": 689, "user_id": 1662829, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/94d0ee316f945415c5966773384c3dda?s=128&d=identicon&r=PG", "display_name": "decapo", "link": "https://stackoverflow.com/users/1662829/decapo"}, "edited": false, "score": 0, "creation_date": 1611545916, "post_id": 54347892, "comment_id": 116477733, "body": "How does one build this after making these changes?  Running <code>stack build</code> results in a <code>&lt;no location info&gt;:</code> error"}, {"owner": {"reputation": 689, "user_id": 1662829, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/94d0ee316f945415c5966773384c3dda?s=128&d=identicon&r=PG", "display_name": "decapo", "link": "https://stackoverflow.com/users/1662829/decapo"}, "edited": false, "score": 0, "creation_date": 1611546458, "post_id": 54347892, "comment_id": 116477823, "body": "I was getting this error because the name of my main module was not <code>Main.hs</code>"}], "tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": true, "score": 6, "last_activity_date": 1581775867, "last_edit_date": 1581775867, "creation_date": 1548336901, "answer_id": 54347892, "question_id": 54150751, "link": "https://stackoverflow.com/questions/54150751/how-to-define-multible-executables-main-modules-with-stack-hpack/54347892#54347892", "title": "How to define multible executables / Main modules with stack/hpack", "body": "<p>I think <code>app</code> should not be considered as a convention to be a folder of all final applications. In my projects I always split these to <code>foo/Main.hs</code> and <code>bar/Main.hs</code> for <code>foo</code> and <code>bar</code> targets. Hence the <code>package.yaml</code> should contain</p>\n\n<pre><code>executables:\n  foo:\n    main:                Main.hs\n    source-dirs:         foo\n    dependencies:\n    - myproject\n  bar:\n    main:                Main.hs\n    source-dirs:         bar\n    dependencies:\n    - myproject\n</code></pre>\n\n<p>And treat <code>myproject</code> just as a library for them</p>\n"}], "owner": {"reputation": 560, "user_id": 4102092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/632336d7ad3f306e8e44d6886717e9b6?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/4102092/lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 54347892, "answer_count": 1, "score": 4, "last_activity_date": 1581775867, "creation_date": 1547225100, "question_id": 54150751, "link": "https://stackoverflow.com/questions/54150751/how-to-define-multible-executables-main-modules-with-stack-hpack", "title": "How to define multible executables / Main modules with stack/hpack", "body": "<p>I use <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">stack</a> and a <code>package.yaml</code> file for <a href=\"https://github.com/sol/hpack\" rel=\"nofollow noreferrer\">hpack</a> to compile my haskell project. It has three executables backed by one library.  As one would expect the executables are all defining a <code>Main</code> module:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ head -n1 app/*\n==&gt; app/Foo.hs &lt;==\nmodule Main where\n\n==&gt; app/Bar.hs &lt;==\nmodule Main where\n\n==&gt; app/Baz.hs &lt;==\nmodule Main where\n</code></pre>\n\n<p>And I use this <code>package.yaml</code> which looks very similar (to me) to <a href=\"https://github.com/hspec/sensei/blob/master/package.yaml\" rel=\"nofollow noreferrer\">the one</a> linked from the <a href=\"https://github.com/sol/hpack\" rel=\"nofollow noreferrer\">official docs for hpack</a> (the third one).</p>\n\n<pre><code>name: myproject\ndependencies:\n  - base\nlibrary:\n  source-dirs: src\nexecutables:\n  foo:\n    main: Foo.hs\n    source-dirs: app\n    dependencies: myproject\n  bar:\n    main: Bar.hs\n    source-dirs: app\n    dependencies: myproject\n  baz:\n    main: Baz.hs\n    source-dirs: app\n    dependencies: myproject\n</code></pre>\n\n<p>But when I <code>stack build</code> I get the error, that the module name does not match\nthe file name:</p>\n\n<pre><code>Building all executables for `myproject' once. After a successful build of all of them, only specified executables will be rebuilt.\nmyproject-0.0.0: build (lib + exe)\nPreprocessing library for myproject-0.0.0..\nBuilding library for myproject-0.0.0..\n[1 of 2] Compiling Lib              ( src/Lib.hs, .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.2.0.1/build/Lib.o )\n[2 of 2] Compiling Paths_myproject  ( .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.2.0.1/build/autogen/Paths_myproject.hs, .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.2.0.1/build/Paths_myproject.o )\nPreprocessing executable 'bar' for myproject-0.0.0..\nBuilding executable 'bar' for myproject-0.0.0..\n\n/home/luc/test/app/Baz.hs:1:8: error:\n    File name does not match module name:\n    Saw: \u2018Main\u2019\n    Expected: \u2018Baz\u2019\n  |\n1 | module Main where\n  |        ^^^^\n\n\n--  While building package myproject-0.0.0 using:\n      /home/luc/.stack/setup-exe-cache/x86_64-linux-tinfo6/Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.4 --builddir=.stack-work/dist/x86_64-linux-tinfo6/Cabal-2.2.0.1 build lib:myproject exe:bar exe:baz exe:foo --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>The only difference between my setup and the example that I found was the capital letters of the files in <code>app/</code>. And indeed, if I change them to lower case (in the filesystem and the <code>package.yaml</code>) it all builds correctly.</p>\n\n<p>But why is that and where is that documented?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1547225480, "post_id": 54150637, "comment_id": 95132692, "body": "why would it not? <code>words</code> only splits the string on whitespace, a comma is not whitespace."}, {"owner": {"reputation": 11, "user_id": 9224267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de42627bb5ec37c2415fd7a2c60a8537?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Boylan", "link": "https://stackoverflow.com/users/9224267/jack-boylan"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547226686, "post_id": 54150637, "comment_id": 95133332, "body": "how would i go about changing this? I thought adding  <code>dropNonLetters wordList = filter (\\x -&gt; x `elem` (&#39; &#39;:[&#39;a&#39;..&#39;z&#39;])) wordList</code> would make a difference but it doesnt"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9224267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de42627bb5ec37c2415fd7a2c60a8537?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Boylan", "link": "https://stackoverflow.com/users/9224267/jack-boylan"}, "edited": false, "score": 0, "creation_date": 1547235418, "post_id": 54151204, "comment_id": 95136946, "body": "problem is I have to get the exact result of: <code>Report: 185 words 73 common words Histogram of the most frequent words (excluding common words): ************ -&gt; was ***** -&gt; were **** -&gt; we ** -&gt; us ** -&gt; times ** -&gt; throne ** -&gt; there ** -&gt; season ** -&gt; queen ** -&gt; period ** -&gt; large ** -&gt; king ** -&gt; jaw ** -&gt; its ** -&gt; had ** -&gt; going ** -&gt; face ** -&gt; epoch ** -&gt; direct ** -&gt; before</code>  Without altering any of the code below <code>main= do</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 11, "user_id": 9224267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de42627bb5ec37c2415fd7a2c60a8537?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Boylan", "link": "https://stackoverflow.com/users/9224267/jack-boylan"}, "edited": false, "score": 0, "creation_date": 1547237133, "post_id": 54151204, "comment_id": 95137693, "body": "Why is that a problem?"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1547246236, "last_edit_date": 1547246236, "creation_date": 1547226953, "answer_id": 54151204, "question_id": 54150637, "link": "https://stackoverflow.com/questions/54150637/histogram-counting-apostrophes-as-a-word/54151204#54151204", "title": "Histogram counting apostrophes as a word", "body": "<p><strong>In Brief</strong></p>\n\n<pre><code>toWordList = words\n</code></pre>\n\n<p>This is the function I'd modify to sanitize your words.  For example, <code>toWordList = map (filter isAlpha) . words</code> so you get only those characters in words that are alphabetical instead of all blocks of characters that are divided by spaces (which is what <code>words</code> does).  EDIT: <code>isAlpha</code> is from the <code>Data.Char</code> module which you'd need to import. Edited the above snippet to add <code>map</code> too.</p>\n\n<p><strong>Epilog</strong></p>\n\n<p>Moving forward, I'm just going to make some code comments because why not.</p>\n\n<pre><code>import Data.List(sort, group, sortBy)\n</code></pre>\n\n<p>Yay, using pre-existing code.  You will probably also want <code>comparing</code> from <code>Data.Ord</code>.</p>\n\n<pre><code>countCommonWords wordList = length (filter isCommon wordList)\n  where isCommon word = elem word commonWords\n\ndropCommonWords wordList = filter isUncommon wordList\n  where isUncommon w = notElem w commonWords\n</code></pre>\n\n<p>These operations are <code>O(n * m) where</code>n<code>is the length of wordList and</code>m<code>is the length of</code>commonWords`.  You could make this faster by using a Set if you desire.</p>\n\n<pre><code>commonWords = [\"the\",\"and\",\"have\",\"not\",\"as\",\"be\",\"a\",\"I\"\n              ,\"on\",\"you\",\"to\",\"in\",\"it\",\"with\",\"do\",\"of\",\"that\"\n              ,\"for\",\"he\",\"at\"]\n\ncountWords wordList = map (\\w -&gt; (head w, length w)) $ group $ sort wordList\n</code></pre>\n\n<p>A similar performance comment here.  A common method is to use <code>Data.Map.insertWith</code> to keep a counter for each word.</p>\n\n<pre><code>compareTuples (w1, n1) (w2, n2) = if n1 &lt; n2 then LT else if n1&gt; n2 then GT else EQ\n</code></pre>\n\n<p>This is more easily spelled <code>compareTuples = comparing fst</code></p>\n"}], "owner": {"reputation": 11, "user_id": 9224267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de42627bb5ec37c2415fd7a2c60a8537?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Boylan", "link": "https://stackoverflow.com/users/9224267/jack-boylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 54151204, "answer_count": 1, "score": 0, "last_activity_date": 1547246236, "creation_date": 1547224669, "question_id": 54150637, "link": "https://stackoverflow.com/questions/54150637/histogram-counting-apostrophes-as-a-word", "title": "Histogram counting apostrophes as a word", "body": "<p>I am to create a histogram which counts the top 20 most common words, excluding the top 20 in the world. This is the result i get below:</p>\n\n<pre><code>import Data.List(sort, group, sortBy)\ntoWordList = words\ncountCommonWords wordList = length (filter isCommon wordList)\n  where isCommon word = elem word commonWords\n\ndropCommonWords wordList = filter isUncommon wordList\n  where isUncommon w = notElem w commonWords\n\n\ncommonWords = [\"the\",\"and\",\"have\",\"not\",\"as\",\"be\",\"a\",\"I\",\"on\", \"you\",\"to\",\"in\",\"it\",\"with\",\"do\",\"of\",\"that\",\"for\",\"he\",\"at\"]\ncountWords wordList = map (\\w -&gt; (head w, length w)) $group $ sort wordList\ncompareTuples (w1, n1) (w2, n2) = if n1 &lt; n2 then LT else if n1&gt; n2 then GT else EQ\n\nsortWords wordList = reverse $ sortBy compareTuples wordList\n\ntoAsteriskBar x = (replicate (snd x) '*') ++ \" -&gt; \" ++ (fst x) ++ \"\\n\"\nmakeHistogram wordList = concat $ map toAsteriskBar (take 20 wordList)\n\n\n--Do word list\n\ntext = \"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way--in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only. there were a king with a large jaw and a queen with a plain face, on the throne of England; there were a king with a large jaw and a queen with a fair face, on the throne of France. In both countries it was clearer than crystal to the lords of the State preserves of loaves and fishes, that things in general were settled for ever of.\"\n\nmain = do\n  let wordlist = toWordList text\n  putStrLn \"Report:\"\n  putStrLn (\"\\t\" ++ (show $ length wordlist) ++ \" words\")\n  putStrLn (\"\\t\" ++ (show $ countCommonWords wordlist) ++ \" common words\")\n  putStrLn \"\\nHistogram of the most frequent words (excluding common words):\\n\"\n  putStr $ makeHistogram $ sortWords $ countWords $ dropCommonWords  $ wordlist\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>\nReport:\n    186 words\n    71 common words\nHistogram of the most frequent words (excluding common words):\n************ -&gt; was\n***** -&gt; were\n**** -&gt; we\n** -&gt; us,\n** -&gt; times,\n** -&gt; throne\n** -&gt; there\n** -&gt; season\n** -&gt; queen\n** -&gt; large\n** -&gt; king\n** -&gt; jaw\n** -&gt; its\n** -&gt; had\n** -&gt; going\n** -&gt; face,\n** -&gt; epoch\n** -&gt; direct\n** -&gt; before\n** -&gt; all\n</code></pre>\n\n<p>Does anybody know why the counter is counting any word with an apostrophe attached eg. <code>us,</code> as a whole word?</p>\n"}, {"tags": ["haskell", "generics", "record", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1547240296, "last_edit_date": 1547240296, "creation_date": 1547239363, "answer_id": 54153770, "question_id": 54150266, "link": "https://stackoverflow.com/questions/54150266/generics-create-a-product-of-records-that-combine-all-the-fields/54153770#54153770", "title": "Generics - create a product of records that combine all the fields", "body": "<p>With generics, the <em>user</em> defines a data type which will inherit some operation (e.g. <code>toJSON</code>) based on the operation defined over its generically derivered structure. It doesn't create new types based on old. If you are looking for Genrics to create new types based on old, you will be frustrated.</p>\n\n<p>More pointedly, the statement \"I'd like to write a Generic instance for Aggregate\" doesn't make sense. We make Generic representations instances of classes (<code>class ToJSON</code>), not data structures. And the generic JSON instances are already written...</p>\n\n<p>Luckily, a good solution may be easy. You just need instead a way work with collections of JSON objects. Below I demonstrate how to combine two data types that have <code>JSON.Object</code> representations. Since a <code>JSON.Object</code> is just a hashmap, which can be combined via <code>union</code>, I just convert my haskell values to objects and perform a union. There is room for improvement, but this is the idea.</p>\n\n<pre><code>import qualified Data.Aeson as JSON\nimport qualified Data.Aeson.Types as JSON\nimport GHC.Generics\nimport qualified Data.HashMap.Lazy as HashMap\n\ndata A = A { fieldA :: String } deriving (Show,Eq,Generic)\ndata B = B { fieldB :: String } deriving (Show,Eq,Generic)\n\ninstance ToJSON A\ninstance ToJSON B\ninstance FromJSON A\ninstance FromJSON B\n\ntoObj :: ToJSON a =&gt; a -&gt; Maybe JSON.Object\ntoObj = JSON.parseMaybe parseJSON . toJSON\n\ntoJSONAB :: A -&gt; B -&gt; Maybe JSON.Value\ntoJSONAB a b = do\n   aObj &lt;- toObj a\n   bObj &lt;- toObj b\n   return . JSON.Value $ HashMap.union aObj bObj \n</code></pre>\n\n<p>At this point, you would call <code>toJSONAB</code> instead of <code>toJSON</code> when you need to output JSON. Retrieving either an A or B from the output is included. That is, </p>\n\n<pre><code>(toJSONAB a b &gt;&gt;= JSON.parseMaybe parseJSON) :: Maybe &lt;Desired Type&gt;\n</code></pre>\n\n<p>will parse either an A or a B, depending on the type signature supplied (deduced).</p>\n\n<p>The above is the core of what you want. You can make functions like this for whatever data combinations you like. What's missing is the creation of new types like below:</p>\n\n<pre><code>data AB = AB A B\n</code></pre>\n\n<p>which lend type safety to your code. Afterall, you are interested in specific types, not an ad-hoc collection of JSON representations of types. To do this via Generics, I suggest a new class such as below (untested and incomplete),</p>\n\n<pre><code>class ToFlatJSON a where\n  toFlatJSON :: a -&gt; JSON.Value\n  default toFlatJSON :: (Generic a, GToFlatJSON (Rep a)) =&gt; a -&gt; JSON.Value\n  toFlatJSON = gToFlatJSON . from\n\nclass GToFlatJSON a where\n  gToFlatJSON :: a p -&gt; JSON.Value\n</code></pre>\n\n<p>and provide <code>GToFlatJSON</code> instances for any necessary Generic representations found in <code>GHC.Generics</code>.</p>\n\n<pre><code>instance (ToJSON a) =&gt; GToFlatJSON (K1 i a) where\n  gToFlatJSON (K1 a) = toJSON a\n\ninstance (GToFlatJSON a) =&gt; GToFlatJSON (a :*: a') where\n  gToFlatJSON (a :*: a') = cmb (gToFlatJSON a) (toFlatJSON a')\n    where\n      cmb = someFunctionLike_toJSONAB\n\ninstance (GToFlatJSON a) =&gt; GToFlatJSON (M1 t i a) where\n  gToFlatJSON (M1 _ _ a) = gToFlatJSON a\n    where\n      cmb = someFunctionLike_toJSONAB\n</code></pre>\n\n<p>Then, you will be able to define blank <code>ToFlatJSON</code> instances like you do with <code>ToJSON</code></p>\n\n<pre><code>instance ToFlatJSON a\n</code></pre>\n\n<p>and use <code>toFlatJSON</code> instead of <code>toJSON</code>. You could define <code>toJSON</code> in terms <code>toFlatJSON</code>. For each data type, then, you would need:</p>\n\n<pre><code>instance ToFlatJSON AB \ninstance ToFlatJSON AB =&gt; ToJSON AB where\n  toJSON = toFlatJSON \n</code></pre>\n\n<p>So, in summary, you can easily make your combination type by working with the JSON representations themselves, i.e. a union of their object representations. You can recover your original types directly using their <code>fromJSON</code>. There's no way to overload the <code>To/FromJSON</code> generic instances, but you could make a new similar class and its generic instances. I personally recommend for this application to stay away from the generics. I think custom To/FromJSON for your data types would be the most direct method. </p>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1547240296, "creation_date": 1547223358, "last_edit_date": 1547223862, "question_id": 54150266, "link": "https://stackoverflow.com/questions/54150266/generics-create-a-product-of-records-that-combine-all-the-fields", "title": "Generics - create a product of records that combine all the fields", "body": "<p>At work, I use generics to easily derive instances for Data.Aeson.ToJSON and Database.Selda.SqlRow for my API and database types. It's very useful, but I often wish I could compose types. </p>\n\n<p>As a simple example, perhaps a user wants to create a new account. They provide the basic information, which doesn't include a database id. But I need to send it back to them with an id. </p>\n\n<pre><code>data AccountInfo = AccountInfo\n    { firstName :: Text\n    , lastName :: Text\n    } deriving (Show, Eq, Generic)\n\ndata Account = Account\n    { accountId :: Id Account\n    , firstName :: Text\n    , lastName :: Text\n    } deriving (Show, Eq, Generic)\n</code></pre>\n\n<p>I can't simply nest AccountInfo inside of Account, because I want the Aeson instance to be flat (all fields at the top level), and Selda requires it to be flat to store it in the database. </p>\n\n<pre><code>-- This won't work because the Aeson and Selda outputs aren't flat\ndata Account = Account\n    { accountId :: Id Account\n    , info :: AccountInfo\n    } deriving (Show, Eq, Generic)\n</code></pre>\n\n<p>I'd like to create a product type that lets me combine two types, but flattens the fields. </p>\n\n<pre><code>data Aggregate a b = Aggregate a b\n\ndata AccountId = AccountId\n    { accountId :: Id Account\n    } deriving (Show, Eq, Generic)\n\ntype Account = Aggregate AccountId AccountInfo\n</code></pre>\n\n<p>I know how to manually write a ToJSON and FromJSON instance for such a type, but I have no idea how to write a SQLRow instance. </p>\n\n<p>Instead, as an exercise to learn generics, I'd like to write a Generic instance for <code>Aggregate</code> where <code>Aggregate AccountId AccountInfo</code> has the exact same representation as the first definition of <code>Account</code>, above (with all three fields flattened)</p>\n\n<p>How can I do this? I've been reading about generics for a day, and I'm fairly stuck.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10901230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9324ab8a8fee3a8a0fa7e45406669da2?s=128&d=identicon&r=PG&f=1", "display_name": "Nietzsche", "link": "https://stackoverflow.com/users/10901230/nietzsche"}, "is_accepted": false, "score": 0, "last_activity_date": 1547412547, "creation_date": 1547412547, "answer_id": 54173082, "question_id": 54149543, "link": "https://stackoverflow.com/questions/54149543/installation-of-haskell-package-hs-gchart-fails-non-type-variable-argument-in/54173082#54173082", "title": "Installation of Haskell package hs_gchart fails (&quot;Non type-variable argument in the constraint&quot;)", "body": "<p>The problem is solved for me because I could install the package using a different package name:</p>\n\n<p>stack install GoogleChart</p>\n"}], "owner": {"reputation": 11, "user_id": 10901230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9324ab8a8fee3a8a0fa7e45406669da2?s=128&d=identicon&r=PG&f=1", "display_name": "Nietzsche", "link": "https://stackoverflow.com/users/10901230/nietzsche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547412547, "creation_date": 1547220788, "last_edit_date": 1547229612, "question_id": 54149543, "link": "https://stackoverflow.com/questions/54149543/installation-of-haskell-package-hs-gchart-fails-non-type-variable-argument-in", "title": "Installation of Haskell package hs_gchart fails (&quot;Non type-variable argument in the constraint&quot;)", "body": "<p>Trying to install the Haskell package hs_gchart, I got the error </p>\n\n<pre><code>\"Non type-variable argument in the constraint: MonadState Chart m (Use FlexibleContexts to permit this)\"\n</code></pre>\n\n<p>in spite of allowing XFlexibleContexts in my call </p>\n\n<pre><code>stack install --ghc-options=-XFlexibleContexts hs-gchart\n</code></pre>\n\n<p>How can I solve the problem?</p>\n\n<p>Output:</p>\n\n<pre><code>[...]\n    [ 7 of 10] Compiling Graphics.GChart.ChartItems.Colors ( Graphics\\GChart\\ChartItems\\Colors.hs, .stack-work\\dist\\7d103d30\\build\\Graphics\\GChart\\ChartItems\\Colors.o )\n    [ 8 of 10] Compiling Graphics.GChart.ChartItems.Basics ( Graphics\\GChart\\ChartItems\\Basics.hs, .stack-work\\dist\\7d103d30\\build\\Graphics\\GChart\\ChartItems\\Basics.o )\n    [ 9 of 10] Compiling Graphics.GChart.ChartItems ( Graphics\\GChart\\ChartItems.hs, .stack-work\\dist\\7d103d30\\build\\Graphics\\GChart\\ChartItems.o )\n\n[;1mGraphics\\GChart\\ChartItems.hs:62:1: [;1m[31merror:[0m[0m[;1m[0m[0m[;1m\n    * Non type-variable argument in the constraint: MonadState Chart m\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        getDataSetIdx :: forall (m :: * -&gt; *). MonadState Chart m =&gt; m Int[0m[0m\n[;1m[34m   |[0m[0m\n[;1m[34m62 |[0m[0m [;1m[31mgetDataSetIdx = do chart &lt;- get[0m[0m\n[;1m[34m   |[0m[0m[;1m[31m ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^...[0m[0m\n[0m[0m[0m\n</code></pre>\n"}, {"tags": ["haskell", "testing"], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 5, "last_activity_date": 1547218859, "creation_date": 1547218859, "answer_id": 54149029, "question_id": 54148654, "link": "https://stackoverflow.com/questions/54148654/is-there-a-utility-for-easily-writing-parametrized-tests-in-haskell/54149029#54149029", "title": "Is there a utility for easily writing parametrized tests in Haskell?", "body": "<p>Here's <a href=\"http://blog.ploeh.dk/2018/04/30/parametrised-unit-tests-in-haskell\" rel=\"noreferrer\">how I do it with HUnit</a>:</p>\n\n<pre><code>adjustToBusinessHoursReturnsCorrectResult :: [Test]\nadjustToBusinessHoursReturnsCorrectResult = do\n  (dt, expected) &lt;-\n    [\n      (zt (2017, 10, 2) (6, 59,  4) 0, zt (2017, 10, 2) (9,  0,  0) 0),\n      (zt (2017, 10, 2) (9, 42, 41) 0, zt (2017, 10, 2) (9, 42, 41) 0),\n      (zt (2017, 10, 2) (19, 1, 32) 0, zt (2017, 10, 3) (9,  0,  0) 0)\n    ]\n  let actual = adjustToBusinessHours dt\n  return $ ZT expected ~=? ZT actual\n</code></pre>\n\n<p>I simply use <code>do</code> notation with the list monad to create a list of tests (<code>[Test]</code>) that HUnit can execute.</p>\n\n<p>Typically, I <a href=\"http://blog.ploeh.dk/2018/05/07/inlined-hunit-test-lists\" rel=\"noreferrer\">inline them</a>, so that they look like this:</p>\n\n<pre><code>main :: IO ()\nmain = defaultMain $ hUnitTestToTests $ TestList [\n  \"adjustToBusinessHours returns correct result\" ~: do\n    (dt, expected) &lt;-\n      [\n        (zt (2017, 10, 2) (6, 59,  4) 0, zt (2017, 10, 2) (9,  0,  0) 0),\n        (zt (2017, 10, 2) (9, 42, 41) 0, zt (2017, 10, 2) (9, 42, 41) 0),\n        (zt (2017, 10, 2) (19, 1, 32) 0, zt (2017, 10, 3) (9,  0,  0) 0)\n      ]\n    let actual = adjustToBusinessHours dt\n    return $ ZT expected ~=? ZT actual\n\n  ,\n  \"Composed adjust returns correct result\" ~: do\n    (dt, expected) &lt;-\n      [\n        (zt (2017, 1, 31) ( 7, 45, 55)   2 , zt (2017, 2, 28) ( 7,  0,  0) 0),\n        (zt (2017, 2,  6) (10,  3,  2)   1 , zt (2017, 3,  6) ( 9,  3,  2) 0),\n        (zt (2017, 2,  9) ( 4, 20,  0)   0 , zt (2017, 3,  9) ( 9,  0,  0) 0),\n        (zt (2017, 2, 12) (16,  2, 11)   0 , zt (2017, 3, 10) (16,  2, 11) 0),\n        (zt (2017, 3, 14) (13, 48, 29) (-1), zt (2017, 4, 13) (14, 48, 29) 0)\n      ]\n    let adjustments =\n          reverse [adjustToNextMonth, adjustToBusinessHours, adjustToDutchBankDay, adjustToUtc]\n    let adjust = appEndo $ mconcat $ Endo &lt;$&gt; adjustments\n\n    let actual = adjust dt\n\n    return $ ZT expected ~=? ZT actual\n  ]\n</code></pre>\n\n<p>I'm sure there's other ways to achieve that goal, but I like this one because it doesn't require any extra dependencies; it just leverages the capabilities of the language.</p>\n"}, {"comments": [{"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 1, "creation_date": 1547455607, "post_id": 54158407, "comment_id": 95184705, "body": "Yes, I am aware of SmallCheck, but that doesn&#39;t help in this case because the point is that in some situations (such as the parsers that you mention) it really is much easier and much clearer to have some explicit examples. I believe that clearly-written tests are an important part of the documentation, and very often a good set of examples documents something much more clearly than properties. Which is not to disparage property-based testing: these are two complementary tools."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1547286445, "creation_date": 1547286445, "answer_id": 54158407, "question_id": 54148654, "link": "https://stackoverflow.com/questions/54148654/is-there-a-utility-for-easily-writing-parametrized-tests-in-haskell/54158407#54158407", "title": "Is there a utility for easily writing parametrized tests in Haskell?", "body": "<p>Remember that a QuickCheck property is (usually) simply a <em>function</em>. We can use QuickCheck to supply it with arguments, but we can just as easily supply them ourselves too.</p>\n\n<pre><code>prop_foo :: Foo -&gt; Bar -&gt; Bool\n\nprop1 = prop_foo (Foo 6) (Bar 9)\nprop2 = prop_foo (Foo 9) (Bar 2)\n...\n</code></pre>\n\n<p>Also, QuickCheck allows to supply a custom generator, so you can control the random distribution of test data, but I'm pretty sure you can also use it to generate data in an entirely <em>non</em>-random way.</p>\n\n<p>Then there's HUnit, where I'm pretty sure you could <code>fmap</code> a test subroutine over test data to generate a set of test cases. Indeed, I sometimes use this for testing parsers [which isn't terribly amenable to random testing]. I write a function that takes an input string and an expected parse tree, and then constructs a HUnit test case named for the input string, which runs the parser on that string and asserts the output matches the given expectation.</p>\n\n<p>Really, I imagine there's a couple of ways of doing this.</p>\n\n<p>(Are you aware of SmallCheck? It does essentially the same thing as QuickCheck, but generating inputs <em>systematically</em> rather than randomly. So it will try <em>all</em> possible inputs of a given size, and then move onto the next size up. Might not be appropriate for your use case, but worth knowing.)</p>\n"}], "owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 54149029, "answer_count": 2, "score": 3, "last_activity_date": 1547286445, "creation_date": 1547217492, "last_edit_date": 1547218953, "question_id": 54148654, "link": "https://stackoverflow.com/questions/54148654/is-there-a-utility-for-easily-writing-parametrized-tests-in-haskell", "title": "Is there a utility for easily writing parametrized tests in Haskell?", "body": "<p>On the one hand we have automated tests which check one specific example. On the other, we have property-based tests \u00e0 la QuickCheck where we provide the property while the framework provides the examples, but we might have to explain how examples should be generated.</p>\n\n<p>Somewhere between these two extremes lies the possibility of writing a single test or property and running it on multiple user-provided examples. What utilities exist in the Haskell testing landscape that help with writing such parametrized tests?</p>\n\n<p>As a concrete example, here is how it might be done in Python's <code>pytest</code>. I want to check that the <code>len</code> function gives the correct output for a variety of inputs. This can be done by writing a single test that checks that the length of some input is what the tester expects it to be, and parametrizing the test with numerous examples of inputs and corresponding expected results.</p>\n\n<pre><code>from pytest import mark\n\nparam = mark.parametrize\n\n@param('input, expected',\n       ((''  ,    0),\n        ('a' ,    1),\n        ('b' ,    1),\n        ('ab',    2),\n        ('xx',    3), # deliberate mistake\n        ('xyz',   3),\n        ('aaabc', 5)\n       ))\ndef test_len(input, expected):\n    assert len(input) == expected\n</code></pre>\n\n<p>Which produces ouptut like this:</p>\n\n<pre><code>len_test.py::test_len[-0] PASSED                      [ 14%]\nlen_test.py::test_len[a-1] PASSED                     [ 28%]\nlen_test.py::test_len[b-1] PASSED                     [ 42%]\nlen_test.py::test_len[ab-2] PASSED                    [ 57%]\nlen_test.py::test_len[xx-3] FAILED                    [ 71%]  (appears red)\nlen_test.py::test_len[xyz-3] PASSED                   [ 85%]\nlen_test.py::test_len[aaabc-5] PASSED                 [100%]\n\n========================= FAILURES ==========================\n______________________ test_len[xx-3] _______________________\nlen_test.py:15: in test_len\n    assert len(input) == expected\nE   AssertionError: assert 2 == 3\nE    +  where 2 = len('xx')\n============ 1 failed, 6 passed in 0.04 seconds =============\n</code></pre>\n\n<p>Is there something similar in Haskell?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1547220010, "post_id": 54148612, "comment_id": 95129673, "body": "Does your file have <code>{-# OPTIONS_GHC -fplugin GHC.TypeLits.Extra.Solver #-}</code> at the top"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1547235253, "post_id": 54148612, "comment_id": 95136878, "body": "<code>Norm n d ~ &#39;(np dp)</code> should be <code>Norm n d ~ &#39;(np, dp)</code> I think."}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1547220526, "creation_date": 1547220526, "answer_id": 54149466, "question_id": 54148612, "link": "https://stackoverflow.com/questions/54148612/type-family-not-reducing-with-ghc/54149466#54149466", "title": "Type family not reducing with GHC", "body": "<p>You may have forgotten enabling the plugin. The following compiles:</p>\n\n<pre><code>{-# OPTIONS_GHC -fplugin GHC.TypeLits.Extra.Solver #-}\n{-# LANGUAGE DataKinds, KindSignatures, TypeFamilies, UndecidableInstances #-}\n\nimport GHC.TypeLits\nimport GHC.TypeLits.Extra\n\ndata TC (n::Nat) (d::Nat) = TC Int Int deriving (Eq, Show)\n\ntype family Norm (n::Nat) (d::Nat) ::(Nat, Nat) where\n    Norm n d = '(Div n (GCD n d), Div d (GCD n d))\n\nnorm  :: Norm n d ~ '(np, dp) =&gt; TC n d -&gt; TC np dp\nnorm (TC a b) = TC (div a (gcd a b)) (div b (gcd a b))\n\na = TC 1 2 :: TC 1 2\nb = TC 2 3 :: TC 2 3\n\nb' = norm (TC 2 3 :: TC 2 3) :: TC 2 3\n</code></pre>\n"}], "owner": {"reputation": 1702, "user_id": 3143065, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qyVhK.jpg?s=128&g=1", "display_name": "Cjen1", "link": "https://stackoverflow.com/users/3143065/cjen1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 54149466, "answer_count": 1, "score": 1, "last_activity_date": 1547220526, "creation_date": 1547217330, "question_id": 54148612, "link": "https://stackoverflow.com/questions/54148612/type-family-not-reducing-with-ghc", "title": "Type family not reducing with GHC", "body": "<p>I'm working with type level Nats and I want to reduce a ratio to its simplest terms:</p>\n\n<pre><code>import GHC.TypeLits\nimport GHC.TypeLits.Extra\n\ndata TC (n::Nat) (d::Nat) = TC Int Int deriving Show\n\ntype family Norm (n::Nat) (d::Nat) ::(Nat, Nat) where\n    Norm n d = '(Div n (GCD n d), Div d (GCD n d))\n\nnorm  :: Norm n d ~ '(np dp) =&gt; TC n d -&gt; TC np dp\nnorm (a,b) = TC (div a (gcd a b)) (div b (gcd a b))\n</code></pre>\n\n<p>If I have two different terms:</p>\n\n<pre><code>a = TC 1 2 :: TC 1 2\nb = TC 2 3 :: TC 2 3\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>norm a :: TC 1 2\n\nnorm b :: TC \n    (GHC.TypeNats.Div 2 (GHC.TypeLits.Extra.GCD 2 3)) \n    (GHC.TypeNats.Div 3 (GHC.TypeLits.Extra.GCD 2 3))\n</code></pre>\n\n<p>This is similar to this <a href=\"https://stackoverflow.com/questions/31463874/why-wont-ghc-reduce-my-type-family\">question</a>, however in my case type checking doesn't force it to reduce:</p>\n\n<pre><code>norm (TC 2 3 :: TC 2 3) :: TC 2 3\n</code></pre>\n\n<p>fails with:</p>\n\n<pre><code>* Couldn't match type `GHC.TypeNats.Div\n                         3 (GHC.TypeLits.Extra.GCD 2 3)'\n                 with `3'\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1547215974, "post_id": 54148002, "comment_id": 95127394, "body": "You could certainly do it faster than with permutations, you&#39;ll get a lot of duplicates when you only take the first 8 elements.  Basically, you want 33 choose 8, instead of 33 choose 33.  Look around for a combinatorics library or algorithm and see if that helps."}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1547219329, "post_id": 54148002, "comment_id": 95129289, "body": "@bheklilr Would it be something like this                                                            <code>choose 0 xs = [[]]</code> <code>choose n [] = []</code> <code>choose n (x:xs) = map (x:) (choose (n-1) xs) ++ choose n xs</code>.                                                           Will it have the same effect as the function I used in my question?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547222024, "post_id": 54148002, "comment_id": 95130808, "body": "If you want them sorted at the end, don&#39;t permute them in the first place..."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1547222252, "post_id": 54148002, "comment_id": 95130943, "body": "@atis I&#39;d honestly just use a library like <a href=\"https://hackage.haskell.org/package/combinat\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/combinat</a>, but that&#39;s just me."}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "edited": false, "score": 0, "creation_date": 1547224912, "post_id": 54148002, "comment_id": 95132395, "body": "Am I looking at the right function? Because I was looking around the library you suggested, it seems like it implements choose function just like the one I wrote above. <a href=\"https://hackage.haskell.org/package/combinat-0.2.9.0/docs/src/Math.Combinat.Sets.html#choose\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/combinat-0.2.9.0/docs/src/&hellip;</a>"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1547226020, "post_id": 54148002, "comment_id": 95132967, "body": "Then you should be all set, I just meant that I&#39;m lazy and for stuff like this I&#39;m less worried about figuring it out myself and more interested in correctness. If you came to the same solution on your own, then awesome :)"}], "answers": [{"tags": [], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "is_accepted": true, "score": 0, "last_activity_date": 1548099817, "creation_date": 1548099817, "answer_id": 54296812, "question_id": 54148002, "link": "https://stackoverflow.com/questions/54148002/a-better-way-of-optimizing-for-permutation-of-function-compositions-over-an-inpu/54296812#54296812", "title": "A better way of optimizing for permutation of function compositions over an input?", "body": "<p>I was generating unnecessary permutations.</p>\n\n<p>This <code>choose</code> function is basically a non-deterministic <code>take</code> function</p>\n\n<pre><code> choose 0 xs = [[]] \n choose n [] = [] \n choose n (x:xs) = map (x:) (choose (n-1) xs) ++ choose n xs\n</code></pre>\n\n<p>which improved performance by a lot.</p>\n"}], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 54296812, "answer_count": 1, "score": 1, "last_activity_date": 1548099817, "creation_date": 1547215235, "question_id": 54148002, "link": "https://stackoverflow.com/questions/54148002/a-better-way-of-optimizing-for-permutation-of-function-compositions-over-an-inpu", "title": "A better way of optimizing for permutation of function compositions over an input?", "body": "<p>I have a list of functions and their 'apply priority'.</p>\n\n<p>It looks like this. Length of it is <code>33</code></p>\n\n<pre><code>listOfAllFunctions = [ (f1, 1)\n                     , (f2, 2)\n                     , ...\n                     , ...\n                     , (f33, 33)\n                     ]\n</code></pre>\n\n<p>What I want to do is generate a list of permutations of the above list with no duplicates and I only want 8 unique elements in the inner list.</p>\n\n<p>Which I'm implementing like this</p>\n\n<pre><code>prioratizedFunctions :: [[(MyDataType -&gt; MyDataType, Int)]]\nprioratizedFunctions = nubBy removeDuplicates\n                     $ sortBy (comparing snd)\n                    &lt;$&gt; take 8\n                    &lt;$&gt; permutations listOfAllFunctions\n</code></pre>\n\n<p>where <code>removeDuplicates</code> is defined like</p>\n\n<pre><code>removeDuplicates a b = map snd a == map snd b\n</code></pre>\n\n<p>Lastly I'm turning the sublists which'd be <code>[(MyDataType -&gt; MyDataType, Int)]</code> to a composition of functions and a <code>[Int]</code></p>\n\n<p>with this function</p>\n\n<pre><code>compFunc :: [(MyDataType -&gt; MyDataType, Int)] -&gt; MyDataType -&gt; (MyDataType, [Int])\ncompFunc listOfDataAndInts target = (foldr ((.) . fst) id listOfDataAndInts target\n                                  , map snd listOfDataAndInts)\n</code></pre>\n\n<p>Applying the above function like this <code>(flip compFunc) target &lt;$&gt; prioratizedFunctions</code></p>\n\n<hr>\n\n<p>All of the above is a simplified version of the actual code but it should provide the gist it.</p>\n\n<hr>\n\n<p>The problem is that this code takes practically forever to execute. From some prototyping I think the blame of it falls on my implementation of <code>permutations</code> function inside <code>prioratizedFunctions</code>.</p>\n\n<hr>\n\n<p>So I was wondering, is there a better way of doing what I want (basically generating permutation of <code>listOfAllFunctions</code> where each list only contains 8 elements, every list of elements sorted by their priority with <code>snd</code> and containing no duplicate list)</p>\n\n<p>or is the problem inherently a long process?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1547209207, "post_id": 54145065, "comment_id": 95123923, "body": "The <code>f</code> function indeed apply to <code>x</code> of <code>const (f x)</code>, e.g. <code>const ((+1) 1) 0 = 2</code>, why <code>f</code> did not apply in the <code>const</code>?"}, {"owner": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1547209684, "post_id": 54145065, "comment_id": 95124174, "body": "@assembly.jc i don&#39;t know either! check the answer below maybe you can understant"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1547210993, "post_id": 54145065, "comment_id": 95124853, "body": "do u means <code>Const</code> not <code>const</code> function in <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:const\" rel=\"nofollow noreferrer\"><code>Prelude</code></a>?"}, {"owner": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1547212945, "post_id": 54145065, "comment_id": 95125779, "body": "@assembly.jc Yes"}], "answers": [{"tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": false, "score": 0, "last_activity_date": 1547206464, "creation_date": 1547206464, "answer_id": 54145724, "question_id": 54145065, "link": "https://stackoverflow.com/questions/54145065/functor-instance-of-generic-functors/54145724#54145724", "title": "Functor instance of generic functors", "body": "<p><code>Const</code> instance just ignores the <code>f</code> function and doesn't change its value. <code>Id</code> instance applies <code>f</code> function to its value and returns new <code>Id</code> with new value.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "edited": false, "score": 0, "creation_date": 1547207198, "post_id": 54145729, "comment_id": 95122900, "body": "yes that make sense, but i search on hoogle of id and it is id:: a-&gt;a, eg: id x = x.    const in hoogle is const::a-&gt;b-&gt;a and eg:: const 42&quot;hello = 42. so these two are both not affect the value. what i confuse is if id doesn&#39;t change it but f apply, so as const."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "edited": false, "score": 0, "creation_date": 1547209673, "post_id": 54145729, "comment_id": 95124155, "body": "@littlefish Your code does not use <code>const</code>. It defines a type named <code>Const</code>, but that&#39;s an independent thing to function <code>const</code>. There is a loose similarity, in that <code>const x y</code> returns <code>x</code> and discards <code>y</code>, while <code>Const a b</code> is a type having a value of type <code>a</code> inside, ignoring type parameter <code>b</code>. Apart from this, there is no connection between function <code>const</code> and type constructor <code>Const</code>."}, {"owner": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "edited": false, "score": 0, "creation_date": 1547209849, "post_id": 54145729, "comment_id": 95124272, "body": "oh, sorry about my mistake, why f won&#39;t apply to a type a then"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "edited": false, "score": 0, "creation_date": 1547211996, "post_id": 54145729, "comment_id": 95125339, "body": "@littlefish Because <code>f :: b-&gt;b&#39;</code> so it can&#39;t be applied to type <code>a</code>. In my example above, <code>a=String</code>, <code>b=Bool</code>, <code>b&#39;=Int</code>. So, we can&#39;t really apply <code>f :: Bool-&gt;Int</code> to <code>&quot;some string here&quot;</code> (of type <code>String</code>)  in a meaningful way -- how would you do that?"}, {"owner": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "edited": false, "score": 0, "creation_date": 1547213442, "post_id": 54145729, "comment_id": 95126028, "body": "I understand NOW! thank you so much. forgot to look at the signature of f"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1547206479, "creation_date": 1547206479, "answer_id": 54145729, "question_id": 54145065, "link": "https://stackoverflow.com/questions/54145065/functor-instance-of-generic-functors/54145729#54145729", "title": "Functor instance of generic functors", "body": "<p>Suppose we have <code>f :: Bool -&gt; Int</code> and</p>\n\n<pre><code>x :: Const String Bool\nx = Const \"some string here\"\n</code></pre>\n\n<p>Now, <code>fmap f x</code> must have type <code>Const String Int</code>, and the only reasonable choice for its result <code>y</code> is</p>\n\n<pre><code>y :: Const String Int\ny = Const \"some string here\"\n</code></pre>\n\n<p>Note how <code>x</code> and <code>y</code> are roughly the same value, but they belong to distinct types. Further, in order to compute <code>y</code> we do not have to use <code>f</code> in any way, since <code>x</code> does not have any <code>Bool</code> inside, and <code>y</code> does not have any <code>Int</code> inside. <code>f</code> is then irrelevant.</p>\n\n<p>Note that type <code>Const a b</code> is isomorphic to <code>a</code>, whatever type <code>b</code> is. That's why it is named <code>Const</code>: it does not really use its second argument. Its second argument still matters since it causes <code>Const a b</code> and <code>Const a b'</code> to be distinct types, even if both are isomorphic to <code>a</code>.</p>\n"}], "owner": {"reputation": 39, "user_id": 10873065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9bbac2bdca432feca99f6496f18e79?s=128&d=identicon&r=PG&f=1", "display_name": "littlefish", "link": "https://stackoverflow.com/users/10873065/littlefish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547206620, "creation_date": 1547204025, "last_edit_date": 1547206620, "question_id": 54145065, "link": "https://stackoverflow.com/questions/54145065/functor-instance-of-generic-functors", "title": "Functor instance of generic functors", "body": "<pre><code>data Id a = Id a\ndata Const a b = Const a\n</code></pre>\n\n<p>the functor instance of above is</p>\n\n<pre><code>instance Functor Id where\n  fmap f (Id x ) = Id (f x )\ninstance Functor (Const a) where\n  fmap f (Const x ) = Const x\n</code></pre>\n\n<p><code>f</code> somehow did not apply in the <code>const</code>, <code>const (f x)</code> I am confusing about how it work because at least it involves one variable.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1547199697, "post_id": 54143530, "comment_id": 95118818, "body": "That&#39;s like 4 questions in one."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5293973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f1eaae0559197cfe5639f6a3879d6d27?s=128&d=identicon&r=PG&f=1", "display_name": "Atir", "link": "https://stackoverflow.com/users/5293973/atir"}, "edited": false, "score": 0, "creation_date": 1547279866, "post_id": 54143835, "comment_id": 95145774, "body": "Great, Thank you."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 2, "last_activity_date": 1547199577, "creation_date": 1547199577, "answer_id": 54143835, "question_id": 54143530, "link": "https://stackoverflow.com/questions/54143530/the-library-vector-0-12-0-2-efficient-arrays/54143835#54143835", "title": "The Library :&quot;vector-0.12.0.2: Efficient Arrays&quot;", "body": "<p>In that code, <code>V</code> is probably a <a href=\"https://wiki.haskell.org/Qualified_names\" rel=\"nofollow noreferrer\">qualified import</a>, like this:</p>\n\n<pre><code>import qualified Data.Vector as V\n</code></pre>\n\n<p>This means that whenever you need to refer to types or functions from <code>Data.Vector</code>, you'll have to supply the <code>V</code> prefix.</p>\n\n<p>So <code>V.Vector</code> just means <em>the <code>Vector</code> type in the <code>Data.Vector</code> library</em>.</p>\n\n<p><code>V.Vector Char</code> then means <em><code>Vector</code> of <code>Char</code></em>, since <code>Vector</code> is parametrically polymorphic.</p>\n\n<p>Finally, <code>data Board = Board (V.Vector Char) Int</code> declares a type called <code>Board</code> that has a data constructor, also called <code>Board</code>, that takes two arguments:</p>\n\n<ul>\n<li>A <code>V.Vector Char</code></li>\n<li>An <code>Int</code></li>\n</ul>\n\n<p>So you should be able to create <code>Board</code> values by supplying a <code>V.Vector Char</code> and an <code>Int</code>.</p>\n"}], "owner": {"reputation": 151, "user_id": 5293973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f1eaae0559197cfe5639f6a3879d6d27?s=128&d=identicon&r=PG&f=1", "display_name": "Atir", "link": "https://stackoverflow.com/users/5293973/atir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1547199648, "creation_date": 1547198502, "last_edit_date": 1547199648, "question_id": 54143530, "link": "https://stackoverflow.com/questions/54143530/the-library-vector-0-12-0-2-efficient-arrays", "title": "The Library :&quot;vector-0.12.0.2: Efficient Arrays&quot;", "body": "<p>I encountered the Following statement while studying a solution to create a Minesweeper program:</p>\n\n<pre><code>data Board = Board (V.Vector Char) Int deriving Show\n</code></pre>\n\n<p>My question is: What does it mean to put the <code>V.Vector Char</code> inside parenthesis next to the Data Constructor? Do we create an array? Of what type? What is the recommended way to create a board for a board game written in Haskell?</p>\n"}, {"tags": ["haskell", "stm", "gloss"], "comments": [{"owner": {"reputation": 1359, "user_id": 3346496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1230f0444613f0e8d74e5a71439d1e?s=128&d=identicon&r=PG&f=1", "display_name": "monocell", "link": "https://stackoverflow.com/users/3346496/monocell"}, "edited": false, "score": 1, "creation_date": 1547194143, "post_id": 54141611, "comment_id": 95116138, "body": "Can&#39;t write an answer but you should use <code>playIO</code> from <code>Graphics.Gloss.Interface.IO.Game</code>"}, {"owner": {"reputation": 763, "user_id": 6419581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tmJu.png?s=128&g=1", "display_name": "Gakuo", "link": "https://stackoverflow.com/users/6419581/gakuo"}, "reply_to_user": {"reputation": 1359, "user_id": 3346496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1230f0444613f0e8d74e5a71439d1e?s=128&d=identicon&r=PG&f=1", "display_name": "monocell", "link": "https://stackoverflow.com/users/3346496/monocell"}, "edited": false, "score": 0, "creation_date": 1547196081, "post_id": 54141611, "comment_id": 95116991, "body": "@monocell Valuable information, thumbs up."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1567892957, "post_id": 54141611, "comment_id": 102103583, "body": "This does not answer your question, but an alternate solution to updating gloss with multiple threads is to use the parallel library (which does not require IO) instead of the STM library."}], "answers": [{"tags": [], "owner": {"reputation": 763, "user_id": 6419581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tmJu.png?s=128&g=1", "display_name": "Gakuo", "link": "https://stackoverflow.com/users/6419581/gakuo"}, "is_accepted": true, "score": 1, "last_activity_date": 1547343465, "creation_date": 1547343465, "answer_id": 54165416, "question_id": 54141611, "link": "https://stackoverflow.com/questions/54141611/haskell-gloss-and-stm-concurrency-integration/54165416#54165416", "title": "Haskell Gloss and STM concurrency integration", "body": "<p>you should use playIO from Graphics.Gloss.Interface.IO.Game</p>\n"}], "owner": {"reputation": 763, "user_id": 6419581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tmJu.png?s=128&g=1", "display_name": "Gakuo", "link": "https://stackoverflow.com/users/6419581/gakuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 54165416, "answer_count": 1, "score": 1, "last_activity_date": 1547343465, "creation_date": 1547189235, "last_edit_date": 1547190308, "question_id": 54141611, "link": "https://stackoverflow.com/questions/54141611/haskell-gloss-and-stm-concurrency-integration", "title": "Haskell Gloss and STM concurrency integration", "body": "<p>I want to update a Haskell Gloss GUI from multiple threads (4 threads).\nI am looking at an application where an event on the Haskell <code>Gloss</code> GUI triggers a series of steps that end up creating threads each of which can and should change the GUI if need be. I am using the Gloss <code>play</code> function.</p>\n\n<p>The Gloss GUI function <code>play</code> of type:</p>\n\n<pre><code>play\n  :: Display\n     -&gt; Color\n     -&gt; Int\n     -&gt; world\n     -&gt; (world -&gt; Picture)\n     -&gt; (Event -&gt; world -&gt; world)\n     -&gt; (Float -&gt; world -&gt; world)\n     -&gt; IO ()\n</code></pre>\n\n<p>Notice the parameter <code>(Event -&gt; world -&gt; world)</code> which is the function that handles the keyboard events.</p>\n\n<p>If I click say <strong>x</strong> on the keyboard, then <code>handleKeys::Event -&gt; world -&gt; world</code> captures this <code>event</code>, takes a <code>world</code>(a model of my application which is a data structure for display by Gloss) and returns a <code>world</code> with or without changes.</p>\n\n<p>Based on the event processed by <code>handleKeys::Event -&gt; world -&gt; world</code> other threads may be spawned using <code>forkIO :: IO () -&gt; IO ThreadId</code>. These spawned threads should also manipulate the <code>world</code> and return a <code>world</code> for display. That is each thread runs a function of type <code>world-&gt;world</code>. I would then use STM primitives for concurrency. These primitives are:</p>\n\n<pre><code>    putTMVar :: TMVar a -&gt; a -&gt; STM ()\n    takeMVar :: MVar a -&gt; IO a\n    atomically :: STM a -&gt; IO a\n    retry :: STM a\n    orElse :: STM a -&gt; STM a -&gt; STM a\n</code></pre>\n\n<p>As you can already guess, the Haskell type-checker is giving me a migraine. Is there  possibility of running a Gloss application relying on STM concurrency to update the GUI without violating types?</p>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1547167167, "post_id": 54138860, "comment_id": 95109295, "body": "So... should I copy and paste from <a href=\"https://stackoverflow.com/questions/54138148/how-to-fix-non-exhaustive-patterns-in-function-error-in-haskell\" title=\"how to fix non exhaustive patterns in function error in haskell\">stackoverflow.com/questions/54138148/&hellip;</a>"}, {"owner": {"reputation": 119, "user_id": 8334537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8744184b883d32db033dfc80d3c8b0?s=128&d=identicon&r=PG&f=1", "display_name": "s_diaconu", "link": "https://stackoverflow.com/users/8334537/s-diaconu"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1547167825, "post_id": 54138860, "comment_id": 95109444, "body": "I am not sure how is working, but yes if this is the way. Thanks again @ThomasM.DuBuisson"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1922, "user_id": 831031, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3fd739b62c1895d1db98eab81ffecbef?s=128&d=identicon&r=PG&f=1", "display_name": "SanSolo", "link": "https://stackoverflow.com/users/831031/sansolo"}, "edited": false, "score": 1, "creation_date": 1547199416, "post_id": 54138860, "comment_id": 95118655, "body": "@SanSolo True, but in OP&#39;s defense, on that page they were asked to create another question. (BTW, we probably should have a reference question for &quot;why is <code>f [x] = ...</code> failing?` and close all similar questions as a duplicate. This specific question is frequently re-posted on SO, in different forms.)"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 8334537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8744184b883d32db033dfc80d3c8b0?s=128&d=identicon&r=PG&f=1", "display_name": "s_diaconu", "link": "https://stackoverflow.com/users/8334537/s-diaconu"}, "edited": false, "score": 0, "creation_date": 1547167691, "post_id": 54138886, "comment_id": 95109413, "body": "Both solutions tested and work good. Thanks."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1547167226, "creation_date": 1547167226, "answer_id": 54138886, "question_id": 54138860, "link": "https://stackoverflow.com/questions/54138860/how-to-create-a-pattern-to-match-all-the-elements-from-a-list-of-tuples/54138886#54138886", "title": "How to create a pattern to match all the elements from a list of tuples?", "body": "<p>There's no need to pattern match anything here. Just give the entire list parameter a name.</p>\n\n<pre><code>sortWords pairs = sortBy (\\x y -&gt; compare (snd x) (snd y)) pairs\n</code></pre>\n\n<p>This can further be \u03b7-reduced:</p>\n\n<pre><code>sortWords = sortBy (\\x y -&gt; compare (snd x) (snd y))\n</code></pre>\n\n<p>Pattern matching <em>would</em> make sense in the inner lambda though:</p>\n\n<pre><code>sortWords = sortBy (\\(_,x) (_,y) -&gt; compare x y)\n</code></pre>\n\n<p>There are standard helper functions that make it even simpler:</p>\n\n<pre><code>import Data.Ord (comparing)\n\nsortWords = sortBy $ comparing snd\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8334537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8744184b883d32db033dfc80d3c8b0?s=128&d=identicon&r=PG&f=1", "display_name": "s_diaconu", "link": "https://stackoverflow.com/users/8334537/s-diaconu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1547218636, "accepted_answer_id": 54138886, "answer_count": 1, "score": 0, "last_activity_date": 1547185553, "creation_date": 1547166990, "last_edit_date": 1547185553, "question_id": 54138860, "link": "https://stackoverflow.com/questions/54138860/how-to-create-a-pattern-to-match-all-the-elements-from-a-list-of-tuples", "closed_reason": "Duplicate", "title": "How to create a pattern to match all the elements from a list of tuples?", "body": "<p>I am trying to create a function which takes a list of tuples as argument. The function is sorting the list of tuples by the second element from each tuple. The code I have is creating a pattern which is matching a list of tuples with only one element. To test, I am calling the function with a list of tuples with two element and I have 'Non-exhaustive patterns in function' error.</p>\n\n<p>How do I create a pattern to match all the elements from the list of tuples.</p>\n\n<p>Here is the code to create the function.</p>\n\n<p><code>sortWords :: [(String, Int)] -&gt; [(String, Int)]</code></p>\n\n<p><code>sortWords [(str,num)] = sortBy (\\x y -&gt; compare (snd x) (snd y)) [(str,num)]</code></p>\n\n<p>And here is how I call the function.</p>\n\n<p><code>main = do\n    putStrLn $ show $ sortWords [(\"friend\",1),(\"she\",2)]</code></p>\n\n<p>I run my program on <a href=\"http://repl.it\" rel=\"nofollow noreferrer\">http://repl.it</a>.</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 5, "last_activity_date": 1547166850, "last_edit_date": 1547166850, "creation_date": 1547165512, "answer_id": 54138713, "question_id": 54138688, "link": "https://stackoverflow.com/questions/54138688/how-to-fix-a-could-not-find-module-error-in-cabal-when-it-seems-correctly-spe/54138713#54138713", "title": "How to fix a &quot;could not find module&quot; error in Cabal, when it seems correctly specified?", "body": "<p>For the missing modules, sink your program executable into a directory such that the module hierarchy for yoru library isn't visible:</p>\n\n<pre><code>mkdir program ; mv src/Main.hs program/\n</code></pre>\n\n<p>and in cabal for the executable</p>\n\n<pre><code>hs-source-dirs: program\n</code></pre>\n\n<p>For your missing module <code>Dhall</code>, add the <code>dhall</code> build dependency to your <code>executable</code> stanza in the cabal file.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 54138713, "answer_count": 1, "score": 1, "last_activity_date": 1547166850, "creation_date": 1547165199, "question_id": 54138688, "link": "https://stackoverflow.com/questions/54138688/how-to-fix-a-could-not-find-module-error-in-cabal-when-it-seems-correctly-spe", "title": "How to fix a &quot;could not find module&quot; error in Cabal, when it seems correctly specified?", "body": "<p>I'm currently not using stack at all on this project (just Cabal), and all was going well when everything was in Main.hs. I decided to split up code, moving my dhall dep and related code from my executable deps to my library deps, and now seem to have this strange error when running <code>cabal new-build</code>:</p>\n\n<pre><code>Building executable 'FarmDataServer.exe' for FarmDataServer-0.1.0.0..                                                                                                                                      \n&lt;no location info&gt;: warning: [-Wmissing-home-modules]                                                                                 \n    These modules are needed for compilation but not listed in your .cabal file's other-modules: FDS                                  \n                                                                                                 FDS.Config.Core                      \n                                                                                                 FDS.Config.DhallConf                 \n[2 of 4] Compiling FDS.Config.DhallConf ( src/FDS/Config/DhallConf.hs, /home/brandon/workspace/CIDA/FarmDataServer/dist-newstyle/buil\nd/x86_64-linux/ghc-8.4.4/FarmDataServer-0.1.0.0/x/FarmDataServer.exe/build/FarmDataServer.exe/FarmDataServer.exe-tmp/FDS/Config/Dhall\nConf.o )                                                                                                                              \n\nsrc/FDS/Config/DhallConf.hs:7:1: error:                                                                                               \n    Could not find module `Dhall'                                                                                                     \n    Use -v to see a list of the files searched for.                                                                                   \n  |                                                                                                                                   \n7 | import           Dhall                                                                                                            \n  | ^^^^^^^^^^^^^^^^^^^^^^     \n</code></pre>\n\n<p>Certainly I'm also a bit confused by the <code>Wmissing-home-modules</code> message since I seem to have added those in my cabal file.</p>\n\n<p>Relevant bits of my .cabal file:</p>\n\n<pre><code>cabal-version:       2.4\nname:                FarmDataServer\nversion:             0.1.0.0\n\nlibrary\n  exposed-modules:\n    FDS\n\n  other-modules:\n    FDS.Config.Core\n    , FDS.Config.DhallConf\n\n  build-depends:       base             ^&gt;=4.11.1.0\n                       , conduit        ^&gt;=1.3.1\n                       , csv-conduit    ^&gt;=0.7.0.0\n                       , dhall          ^&gt;=1.20.0\n                       , text           ^&gt;=1.2.3.1\n\n  hs-source-dirs:      src\n\n\n\nexecutable FarmDataServer.exe\n  main-is:             Main.hs\n\n  build-depends:       base             ^&gt;=4.11.1.0\n                       , conduit        ^&gt;=1.3.1\n                       , csv-conduit    ^&gt;=0.7.0.0\n                       , scotty         ^&gt;=0.11.3\n                       , text           ^&gt;=1.2.3.1\n                       , FarmDataServer ^&gt;=0.1.0.0\n</code></pre>\n\n<p>My <code>src</code> folder:</p>\n\n<pre><code>$ pwd                                                                                                                                 \n/home/brandon/workspace/CIDA/FarmDataServer/src\n$ du -a                                                                                                                               \n4       ./FDS/Config/DhallConf.hs                                                                                                     \n4       ./FDS/Config/Core.hs                                                                                                          \n12      ./FDS/Config                                                                                                                  \n16      ./FDS                                                                                                                         \n4       ./FDS.hs                                                                                                                      \n4       ./Main.hs                                                                                                                     \n28      .      \n</code></pre>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 1, "creation_date": 1547161311, "post_id": 54138148, "comment_id": 95107814, "body": "That pattern only matches to lists with only one element."}, {"owner": {"reputation": 119, "user_id": 8334537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8744184b883d32db033dfc80d3c8b0?s=128&d=identicon&r=PG&f=1", "display_name": "s_diaconu", "link": "https://stackoverflow.com/users/8334537/s-diaconu"}, "reply_to_user": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 0, "creation_date": 1547161787, "post_id": 54138148, "comment_id": 95107948, "body": "So how do I create a pattern to match multiple elements from a list? @DannyuNDos"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1547163775, "post_id": 54138148, "comment_id": 95108466, "body": "@s_diaconu Please create another question, for your new question."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1547199071, "post_id": 54138148, "comment_id": 95118457, "body": "Enable warnings with <code>-Wall</code> and GHC will point out the missing cases."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 8334537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8744184b883d32db033dfc80d3c8b0?s=128&d=identicon&r=PG&f=1", "display_name": "s_diaconu", "link": "https://stackoverflow.com/users/8334537/s-diaconu"}, "edited": false, "score": 0, "creation_date": 1547167358, "post_id": 54138732, "comment_id": 95109335, "body": "Many thanks for the answer. Never crossed my mind not to put argument."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 6, "last_activity_date": 1547165677, "creation_date": 1547165677, "answer_id": 54138732, "question_id": 54138148, "link": "https://stackoverflow.com/questions/54138148/how-to-fix-non-exhaustive-patterns-in-function-error-in-haskell/54138732#54138732", "title": "How to fix &#39;Non-exhaustive patterns in function&#39; error in haskell?", "body": "<pre><code>sortWords [(str,num)] = \n</code></pre>\n\n<p>Your function definition (above) pattern matches for a list containing a single element which is a tuple with variables for each of the two values.</p>\n\n<p>You seem to want just a variable and not a pattern match at all:</p>\n\n<pre><code>sortWords xs  = sortBy (\\x y -&gt; compare (snd x) (snd y)) xs\n</code></pre>\n\n<p>or eta reduced:</p>\n\n<pre><code>sortWords = sortBy (\\x y -&gt; compare (snd x) (snd y))\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8334537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8744184b883d32db033dfc80d3c8b0?s=128&d=identicon&r=PG&f=1", "display_name": "s_diaconu", "link": "https://stackoverflow.com/users/8334537/s-diaconu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 54138732, "answer_count": 1, "score": 0, "last_activity_date": 1547165677, "creation_date": 1547161248, "last_edit_date": 1547161346, "question_id": 54138148, "link": "https://stackoverflow.com/questions/54138148/how-to-fix-non-exhaustive-patterns-in-function-error-in-haskell", "title": "How to fix &#39;Non-exhaustive patterns in function&#39; error in haskell?", "body": "<p>I am trying to create a function which takes a list of tuples as argument and sort the by the second element. It doesn't print anytning else, just the error '*** Exception: main.hs:20:1-76: Non-exhaustive patterns in function sortWords'\nHere is the code:</p>\n\n<pre><code>sortWords :: [(String, Int)] -&gt; [(String, Int)]\n\nsortWords [(str,num)] = sortBy (\\x y -&gt; compare (snd x) (snd y)) [(str,num)]`\n</code></pre>\n\n<p>And here is how I call the function</p>\n\n<pre><code>main = do\n    putStrLn $ show $ sortWords [(\"friend\",1),(\"she\",2)]\n</code></pre>\n\n<p>I have to say that I run my program on <a href=\"http://Repl.it\" rel=\"nofollow noreferrer\">http://Repl.it</a> website</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "types", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1547328790, "post_id": 54137973, "comment_id": 95157898, "body": "^ You can let me know if that doesn&#39;t fully answer your question. It should be a somewhat smallish modification to get something that fulfills your specific question here, but I could give more details on that modification if you&#39;d like."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1547437856, "post_id": 54137973, "comment_id": 95179846, "body": "@DavidYoung Your answer there looks almost perfect. It was fairly straightforward to convert it to use visible type applications instead of proxies and to add a new class/instance to support the <code>head</code> function (I can edit either or both of those into your answer there if you want). The only wart about it is that it doesn&#39;t really work on the <code>length</code> function, but rather on the function <code>length . toList</code>. I tried for a little while to fix that with the various new GHC extensions since you wrote that back in 2015, but with no luck."}], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547161921, "post_id": 54138095, "comment_id": 95107986, "body": "With the solution you describe, it seems like for every different type of <code>f</code>, I&#39;d need a different version of <code>doToBoth</code> for it, which isn&#39;t very convenient. What I really want is what you say is impossible or at least impractical in your last paragraph. I&#39;ll leave this open for a few days in case anyone else can think of a way to do it, or for an answer that explains what&#39;s missing from Haskell&#39;s type system that makes it impossible."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1547200001, "post_id": 54138095, "comment_id": 95118981, "body": "@JosephSible I can&#39;t find a general way to do that, unless I exploit intersection types, which are <i>not</i> available in Haskell (IIRC, inference is undecidable with intersection types, and type checking is too expensive). I think you need something like <code>doBoth :: ((a-&gt;a&#39;) &amp;&amp; (b-&gt;b&#39;)) -&gt; a -&gt; b -&gt; (a&#39;, b&#39;)</code>, which Haskell does not have."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1547411106, "post_id": 54138095, "comment_id": 95174709, "body": "I wanted to write <code>forall c. (c a, c b) =&gt; (forall x. c x =&gt; x -&gt; x) -&gt; a -&gt; b -&gt; (a, b)</code>, but that didn\u2019t work. I found sort of a way to do it with <code>ConstraintKinds</code> if you pass the dictionaries explicitly, but it\u2019s not worth the trouble: given <code>both :: forall a b c. Dict (c a) -&gt; Dict (c b) -&gt; (forall x. Dict (c x) -&gt; x -&gt; x) -&gt; a -&gt; b -&gt; (a, b)</code> you invoke it as <code>both (Dict :: Dict (Enum Int)) (Dict :: Dict (Enum Char)) (\\ Dict -&gt; pred) 2 &#39;b&#39;</code>. Might be a starting point for something more clever though."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1547438083, "post_id": 54138095, "comment_id": 95179880, "body": "@JonPurdy That looks like it would only work when <code>f</code> is an endomorphism, which <code>head</code> isn&#39;t."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1547447755, "post_id": 54138095, "comment_id": 95181910, "body": "@JosephSible: Right, was just going off the second example in this answer (<code>doToBoth_enum</code>)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1547161339, "last_edit_date": 1547161339, "creation_date": 1547161002, "answer_id": 54138095, "question_id": 54137973, "link": "https://stackoverflow.com/questions/54137973/apply-a-polymorphic-function-to-two-different-types-of-inputs/54138095#54138095", "title": "Apply a polymorphic function to two different types of inputs", "body": "<p>Accepting a polymorphic argument makes your function rank-2 polymorphic. GHC has <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-RankNTypes\" rel=\"noreferrer\">an extension for that</a>, but you can only use it if you can somehow quantify over what kinds of types the argument must support \u2013 with type constructors or -classes. For instance, for the case of lists you could write</p>\n\n<pre><code>{-# LANGUAGE Rank2Types, UnicodeSyntax #-}\ndoToBoth_listelem :: (\u2200 x . [x] -&gt; x) -&gt; [a] -&gt; [b] -&gt; (a,b)\ndoToBoth_listelem f x y = (f x, f y)\n</code></pre>\n\n<pre><code>&gt; doToBoth_listelem head [1,10,100] \"apple\"<br>(1,'a')</code></pre>\n\n<p>This would also work for the <code>pred</code> example, and is somewhat more useful. In this case you need to quantify over an argument that's constrained by the <code>Enum</code> class:</p>\n\n<pre><code>doToBoth_enum :: (Enum a, Enum b)\n      =&gt; (\u2200 x . Enum x =&gt; x -&gt; x) -&gt; a -&gt; b -&gt; (a,b)\ndoToBoth_enum f x y = (f x, f y)\n</code></pre>\n\n<pre><code>&gt; doToBoth_enum pred 2 'b'<br>(1,'a')</code></pre>\n\n<p>Writing it so it automatically works for any such constraint that the argument might require is, I think, not possible. It might be possible to approximate that with some clever type families and constraint kinds, but I doubt it would end up being practically usable.</p>\n"}], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "closed_date": 1547437700, "answer_count": 1, "score": 5, "last_activity_date": 1547161339, "creation_date": 1547160234, "question_id": 54137973, "link": "https://stackoverflow.com/questions/54137973/apply-a-polymorphic-function-to-two-different-types-of-inputs", "closed_reason": "Duplicate", "title": "Apply a polymorphic function to two different types of inputs", "body": "<p>Consider this function:</p>\n\n<pre><code>doToBoth f x y = (f x, f y)\n</code></pre>\n\n<p>It works as expected in simple cases:</p>\n\n<pre><code>doToBoth (2 *) 10 15 == (20, 30)\ndoToBoth head [1,2] [3,4,5] == (1, 3)\n</code></pre>\n\n<p>Then I tried these ones:</p>\n\n<pre><code>doToBoth head [1,10,100] \"apple\"\ndoToBoth pred 2 'b'\n</code></pre>\n\n<p>I want those to both result in <code>(1, 'a')</code>, but instead they just result in a type error. The problem is that the inferred type of <code>doToBoth</code> isn't polymorphic enough:</p>\n\n<pre><code>doToBoth :: (a1 -&gt; a2) -&gt; a1 -&gt; a1 -&gt; (a2, a2)\n</code></pre>\n\n<p>Seeing this, I tried adding an explicit type signature to fix it:</p>\n\n<pre><code>doToBoth :: (t ~ (i1 -&gt; o1), t ~ (i2 -&gt; o2)) =&gt; t -&gt; i1 -&gt; i2 -&gt; (o1, o2)\n</code></pre>\n\n<p>This type signature was accepted, but it didn't fix the problem, and checking what happened with <code>:t doToBoth</code> revealed that it ended up with a type equivalent to the original inferred one:</p>\n\n<pre><code>doToBoth :: (i2 -&gt; o2) -&gt; i2 -&gt; i2 -&gt; (o2, o2)\n</code></pre>\n\n<p>What is the correct way to write a type signature to make this function work the way I want?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547152873, "post_id": 54135294, "comment_id": 95104669, "body": "Replacing your protolude dependency with text (and your Protolude import with Data.Text) preserves the amount of boilerplate and achieves the stated goal... ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 0, "creation_date": 1547147767, "post_id": 54135357, "comment_id": 95102471, "body": "Yes, I&#39;ve been barking up that tree, but getting my hands on the appropriate variants in <code>Protolude</code> is proving to be more difficult than I would like."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 1, "creation_date": 1547148000, "post_id": 54135357, "comment_id": 95102569, "body": "@jacg Why is it difficult? <code>import qualified Data.Text as T</code> and you&#39;re on your way."}, {"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 0, "creation_date": 1547148354, "post_id": 54135357, "comment_id": 95102740, "body": "Because I&#39;m using the <code>protolude</code> package to pull in dependencies (such as <code>text</code>), and when I did exactly what you suggested, the compiler replied with <code>Could not load module \u2018Data.Text\u2019 It is a member of the hidden package \u2018text-1.2.3.1\u2019.</code>"}, {"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1547151970, "post_id": 54135357, "comment_id": 95104323, "body": "@duplode That&#39;s the point: I don&#39;t <i>want</i> to import <code>Data.Text</code> or specify <code>text</code> as a dependency explicitly! If that&#39;s the <i>only</i> way to get it to work, then so be it, but I was hoping that I would be able to write this trivial function on <code>Text</code> without going outside what <code>Protolude</code> provides. Is that really an unrealistic expectation?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 3, "creation_date": 1547152627, "post_id": 54135357, "comment_id": 95104574, "body": "@jacg Yes, it is unrealistic to expect any prelude replacement to provide every library function you will need. We have non-prelude libraries on Hackage for a very good reason."}, {"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 0, "creation_date": 1547153379, "post_id": 54135357, "comment_id": 95104900, "body": "The standard Prelude provides a type for storing text (<code>String</code>) and <code>head</code>, <code>any</code>, <code>take</code>, etc. that work with it, making the required function easy to write within that Prelude. <code>Protolude</code> provides a type for storing text (<code>Text</code>) and <code>head</code>, <code>any</code>, <code>take</code>, etc. which, in spite of being more polymorphic than those in the standard Prelude, do <b>not</b> work with this Prelude&#39;s basic text type, making the required function (apparently?) impossible to write with this Prelude. Whatever other merits <code>Protolude</code> has, in this respect it&#39;s a step backwards. Something valuable seems to have been lost."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1547160347, "post_id": 54135357, "comment_id": 95107525, "body": "To import Data.Text (or otherwise directly use the text package alongside protolude, as opposed to using just the parts of text exposed by protolude modules) it is necessary to add it to the build dependencies of your project. (This is the comment I had written above and that jacg replied to, stripped of a wrong sentence I had accidentally left in it.)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1547147102, "creation_date": 1547147102, "answer_id": 54135357, "question_id": 54135294, "link": "https://stackoverflow.com/questions/54135294/how-to-access-text-decomposition-functions-in-protolude/54135357#54135357", "title": "How to access Text decomposition functions in Protolude", "body": "<p>How about <code>any isUpper . take 1</code> (with the appropriate <code>Data.Text</code> variants of <code>any</code> and <code>take</code>)?</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547166620, "post_id": 54137291, "comment_id": 95109161, "body": "...but in my own developments (and I suspect you feel similarly) I would greatly prefer using the <code>Text</code> API directly. Converting to <code>String</code> sort of defeats the benefits of using the better data type in the first place."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547167023, "post_id": 54137291, "comment_id": 95109260, "body": "Yes, certainly I&#39;d rather incur the dependency on text and actually operate on the value as Text."}, {"owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "edited": false, "score": 0, "creation_date": 1547199915, "post_id": 54137291, "comment_id": 95118934, "body": "Agreed, the extra boilerplate is preferable to dropping down to <code>String</code>."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 0, "last_activity_date": 1547156356, "creation_date": 1547156356, "answer_id": 54137291, "question_id": 54135294, "link": "https://stackoverflow.com/questions/54135294/how-to-access-text-decomposition-functions-in-protolude/54137291#54137291", "title": "How to access Text decomposition functions in Protolude", "body": "<p>Protolude exports an unpack function which allows you to once again work with Strings:</p>\n\n<pre><code>% ghci -XNoImplicitPrelude -XOverloadedStrings\nGHCi, version 8.4.4: http://www.haskell.org/ghc/  :? for help\n&gt; import Data.Char\nData.Char&gt; import Protolude\nData.Char Protolude&gt; any isUpper . take 1 . strConv Strict $ (\"Yes\" :: Text)\nTrue\n</code></pre>\n"}], "owner": {"reputation": 1708, "user_id": 4122880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/EkZGq.png?s=128&g=1", "display_name": "jacg", "link": "https://stackoverflow.com/users/4122880/jacg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1547230355, "creation_date": 1547146848, "last_edit_date": 1547230355, "question_id": 54135294, "link": "https://stackoverflow.com/questions/54135294/how-to-access-text-decomposition-functions-in-protolude", "title": "How to access Text decomposition functions in Protolude", "body": "<h1>TL;DR:</h1>\n\n<p>In the standard prelude it is possible to operate on text (<code>String</code>s) with functions such as <code>head</code>, <code>take</code> etc. <code>Protolude</code> replaces these components with better ones, but this seems to come at a cost of losing the ability to apply many of the Prelude's functions to its standard text type.</p>\n\n<h1>A simple problem</h1>\n\n<p>I need to find out whether some word starts with an uppercase character.</p>\n\n<h1>Warming up</h1>\n\n<pre><code>import Data.Char\n\nstartsWithUppercase :: String -&gt; Bool\nstartsWithUppercase = isUpper . head\n</code></pre>\n\n<p>this works ...</p>\n\n<pre><code>\u03bb startsWithUppercase \"Yes\"\nTrue\n\u03bb startsWithUppercase \"no\"\nFalse\n</code></pre>\n\n<p>except that <code>head</code> is a partial function</p>\n\n<pre><code>\u03bb startsWithUppercase \"\"\n*** Exception: Prelude.head: empty list\n</code></pre>\n\n<h1>A safer version</h1>\n\n<pre><code>import Data.Char\nimport Data.Maybe\n\nsafeHead :: [a] -&gt; Maybe a\nsafeHead []    = Nothing\nsafeHead (x:_) = Just x\n\nstartsWithUppercase :: String -&gt; Bool\nstartsWithUppercase = (maybe False isUpper) . safeHead\n</code></pre>\n\n<p>This seems to fix the problem:</p>\n\n<pre><code>\u03bb map startsWithUppercase $ words \"Yes no\"\n[True,False]\n\u03bb startsWithUppercase \"\"\nFalse\n</code></pre>\n\n<p>except that I want to use <code>Text</code> rather than <code>String</code></p>\n\n<h1>Moving from <code>String</code> to <code>Text</code></h1>\n\n<p>Let's try a direct translation:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Prelude hiding (head)\nimport Data.Text\nimport Data.Char\nimport Data.Maybe\n\nsafeHead :: Text -&gt; Maybe Char\nsafeHead \"\" = Nothing\nsafeHead t  = Just . head $ t\n\nstartsWithUppercase :: Text -&gt; Bool\nstartsWithUppercase = (maybe False isUpper) . safeHead\n</code></pre>\n\n<p>It seems to work ...</p>\n\n<pre><code>yes, no, crash :: Text\nyes   = \"Yes\"\nno    = \"no\"\ncrash = \"\"\n\n\u03bb Prelude.map startsWithUppercase [yes, no, crash]\n[True,False,False]\n</code></pre>\n\n<p>... but I can't help wondering why Hoogle didn't come up with anything\ninteresting in response to <code>Text -&gt; Maybe Char</code>.</p>\n\n<p>Anyway, I'm sick and tired of these partial functions all over the\nplace: I don't want these gaping holes in my static guarantees. I\nknow, let's use one of these modern Prelude replacemens. <code>Protolude</code>\nlooks good, and seems to have many proponents.</p>\n\n<h1>Moving to Protolude</h1>\n\n<p>Protolude, among its many virtues, is supposed to address the two main\nissues I have addressed above:</p>\n\n<ul>\n<li>Eradicate <code>String</code>, make <code>Text</code> available by default.</li>\n<li>Eradicate partial functions, make safe ones available by default.</li>\n</ul>\n\n<p>It even imports <code>Data.Maybe</code> for me.</p>\n\n<p>Sounds great. Let's do it!</p>\n\n<p>There will be no need to write <code>safeHead</code>, because in <code>Protolude</code>\n<code>head</code> already is safe, and generic to boot:</p>\n\n<pre><code>\u03bb :t head\nhead :: Foldable f =&gt; f a -&gt; Maybe a\n</code></pre>\n\n<p>Excellent!</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE NoImplicitPrelude #-}\n\nimport Protolude\nimport Data.Char\n\nstartsWithUppercase :: Text -&gt; Bool\nstartsWithUppercase = (maybe False isUpper) . head\n</code></pre>\n\n<p>Oh dear:</p>\n\n<pre><code> Lib.hs     8  23 error           [-Wdeferred-type-errors]\n     \u2022 Couldn't match type \u2018Text\u2019 with \u2018f0 Char\u2019\n       Expected type: Text -&gt; Bool\n         Actual type: f0 Char -&gt; Bool\n     \u2022 In the expression: (maybe False isUpper) . head\n       In an equation for \u2018startsWithUppercase\u2019:\n           startsWithUppercase = (maybe False isUpper) . head (intero)\n</code></pre>\n\n<p><code>Protolude.head</code> is defined on <code>Foldable</code>s, which <code>Text</code> isn't.</p>\n\n<p>I guess I'll have to write my own <code>safeHead</code> for <code>Text</code> after all.</p>\n\n<p>Hmm, but for that I used <code>Text.head</code> and <code>Protolude</code> hides that away.</p>\n\n<p>After numerous further failed attempts to get this to work, I have to stand back and think: I'm trying to find whether the\nfirst character of a piece of <code>Text</code> is uppercase, in a modern\nPrelude. </p>\n\n<p>What am I missing? What is the sane solution to this simple problem? More generally, how does one break up <code>Text</code> into sub-text <em>within</em> <code>Protolude</code>?</p>\n\n<h1>Edit: Clarification</h1>\n\n<p>The benefits I would like to reap from <code>Protolude</code> include</p>\n\n<ul>\n<li>reduction of boilerplate imports</li>\n<li>reduction of boilerplate depencency specification</li>\n</ul>\n\n<p><code>Protolude</code> has <code>text</code> as a depnedency and it imports <code>Text</code> components.</p>\n\n<p>I am looking for a way of achieving whis <em>without</em> having to explicitly specify imports and dependencies beyond the ones perfomed implicitly by <code>Protolude</code>.</p>\n\n<p>Specifically, the <code>head</code>, <code>take</code>, <code>any</code> etc. that are exported by <code>Protolude</code> are defined on <code>[]</code> and <code>Foldable</code>, and do not work with <code>Text</code>. Any attempt to import anything from <code>Data.Text</code> explicitly (undesirable boilerplate number 1) fails because it's a \"member of a hidden package <code>text</code>\". To get around this one would have to explicitly specify <code>text</code> as a dependency (undersirable boilerplate number 2).</p>\n\n<p>Is there a way to get this to work without explicit imports and/or dependencies?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1547152644, "post_id": 54133433, "comment_id": 95104581, "body": "You might be better off using <b>stack</b> or <b>cabal</b> to ensure that all dependencies are resolved when the generated code is built"}, {"owner": {"reputation": 642, "user_id": 2089343, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/63681b191138560e5d3b203e43927d55?s=128&d=identicon&r=PG", "display_name": "savior", "link": "https://stackoverflow.com/users/2089343/savior"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1547169353, "post_id": 54133433, "comment_id": 95109745, "body": "The EchoRequest type do not be showed in the code . But I think this will make no different. I have add <code>aeson</code> package dependent in cabal and stack file already."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1547179252, "post_id": 54133433, "comment_id": 95111798, "body": "I raised a similar question <a href=\"https://stackoverflow.com/questions/51064855/use-dependencies-in-hint-when-installing\">here</a> and <a href=\"https://www.reddit.com/r/haskell/comments/ac3ajk/is_it_possible_for_a_haskell_application_to_have/ed6m7j2/\" rel=\"nofollow noreferrer\">here</a>. (Also see gelisam&#39;s response to the latter.)"}, {"owner": {"reputation": 642, "user_id": 2089343, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/63681b191138560e5d3b203e43927d55?s=128&d=identicon&r=PG", "display_name": "savior", "link": "https://stackoverflow.com/users/2089343/savior"}, "edited": false, "score": 0, "creation_date": 1547187935, "post_id": 54133433, "comment_id": 95113852, "body": "I glance over the hint source code , it also use the ghc api. I think it will call a new ghc instance. The two instance have independent env. Hint can not know how to load the third part deps from disk."}], "owner": {"reputation": 642, "user_id": 2089343, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/63681b191138560e5d3b203e43927d55?s=128&d=identicon&r=PG", "display_name": "savior", "link": "https://stackoverflow.com/users/2089343/savior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547139182, "creation_date": 1547139182, "question_id": 54133433, "link": "https://stackoverflow.com/questions/54133433/how-to-use-haskell-ghc-api-to-load-the-haskell-source-code-dynamically-when-imp", "title": "How to use Haskell Ghc API to load the Haskell source code dynamically? When import some third part dependence", "body": "<p>I have a small project that generate some source code dependent on command line arguments, and then execute the generated haskell code. </p>\n\n<p>I try to use GHC API <code>runGhc</code> to load the source file and execute it. I found some examples , all of source code file do not import third part packages. </p>\n\n<p>But My source code import some packages and it raise <code>Could not find module</code> exception.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE CPP               #-}\n{-# LANGUAGE FlexibleContexts  #-}\n{-# LANGUAGE LambdaCase        #-}\n{-# LANGUAGE MultiWayIf        #-}\n{-# LANGUAGE NamedFieldPuns    #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE QuasiQuotes       #-}\n{-# LANGUAGE RecordWildCards   #-}\n{-# LANGUAGE TupleSections     #-}\n{-# LANGUAGE ViewPatterns      #-}\n\n\n\nimport GHC\nimport GHC.Paths ( libdir )\nimport DynFlags\n\nmain =\n    defaultErrorHandler defaultFatalMessager defaultFlushOut $ do\n      runGhc (Just libdir) $ do\n        dflags &lt;- getSessionDynFlags\n        setSessionDynFlags $ dflags{\n          hscTarget = HscInterpreted\n          , ghcLink = LinkInMemory\n\n                                   }\n        target &lt;- guessTarget \"Demo.hs\" Nothing\n        setTargets [target]\n        load LoadAllTargets\n</code></pre>\n\n<p>And my <code>Demo.hs</code> is like </p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE DataKinds         #-}\n{-# LANGUAGE GADTs             #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# OPTIONS_GHC -fno-warn-unused-imports #-}\n{-# OPTIONS_GHC -fno-warn-name-shadowing #-}\n{-# OPTIONS_GHC -fno-warn-unused-matches #-}\n\n\nmodule Demo where\nimport qualified Data.ByteString.Lazy.Internal as BSL\nimport qualified Data.Aeson as DA\n\nbuildRequestFromJson ::\n                       BSL.ByteString -&gt; BSL.ByteString -&gt; Maybe EchoRequest\nbuildRequestFromJson payload = (DA.decode payload)\n</code></pre>\n\n<p>The error is </p>\n\n<pre><code>    Could not find module \u2018Data.Aeson\u2019\n    Perhaps you meant Data.Version (from base-4.12.0.0)\n    Use -v to see a list of the files searched for.\n    |\n 13 | import qualified Data.Aeson as DA\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I am looking for how to execute the source code. I failed to use <code>hint</code>, <code>plugins</code> package. And I want to know how to handle it.</p>\n"}, {"tags": ["haskell", "functional-programming", "combinations"], "comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1547139310, "post_id": 54132874, "comment_id": 95098317, "body": "If you had a list of results [[(&quot;P&quot;,False),(&quot;Q&quot;,True)],...] from a recursive call, what would you need to do to have a new list of result for a new variable &quot;Q&quot;? You need to double each existing list in the result list, once for R being false and one for R being True"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5178190, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/892074084162613/picture?type=large", "display_name": "Eduard Valentin", "link": "https://stackoverflow.com/users/5178190/eduard-valentin"}, "edited": false, "score": 0, "creation_date": 1547151461, "post_id": 54134205, "comment_id": 95104108, "body": "Worked like charm ! Thank you :)"}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": true, "score": 2, "last_activity_date": 1547143982, "last_edit_date": 1547143982, "creation_date": 1547142199, "answer_id": 54134205, "question_id": 54132874, "link": "https://stackoverflow.com/questions/54132874/haskell-how-to-generate-all-possible-combinations-of-elements-each-element-fro/54134205#54134205", "title": "Haskell: How to generate all possible combinations of elements, each element from a list, with arbitrary number of lists", "body": "<p>Introduce this function</p>\n\n<pre><code>cartProdn :: [a] -&gt; Int -&gt; [[a]]\ncartProdn ls 2 = [[x, y] | x &lt;- ls, y &lt;- ls]\ncartProdn ls n = [x : t | x &lt;- ls, t &lt;- cartProdn ls (n - 1)]\n</code></pre>\n\n<p>This gives all possible combinations of length <code>n</code> of a finite list (<code>n &gt; 1</code>). </p>\n\n<p>Then do </p>\n\n<pre><code>*Main&gt; ls = [\"P\", \"Q\", \"R\"]\n*Main&gt; rs = [zip ls c | c &lt;- cartProdn [True, False] (length ls)]\n*Main&gt; putStrLn $ unlines $ map show rs\n[(\"P\",True),(\"Q\",True),(\"R\",True)]\n[(\"P\",True),(\"Q\",True),(\"R\",False)]\n[(\"P\",True),(\"Q\",False),(\"R\",True)]\n[(\"P\",True),(\"Q\",False),(\"R\",False)]\n[(\"P\",False),(\"Q\",True),(\"R\",True)]\n[(\"P\",False),(\"Q\",True),(\"R\",False)]\n[(\"P\",False),(\"Q\",False),(\"R\",True)]\n[(\"P\",False),(\"Q\",False),(\"R\",False)]\n</code></pre>\n\n<p><em>note</em>: you might want to write <code>ls = \"PQR\"</code>. </p>\n"}], "owner": {"reputation": 167, "user_id": 5178190, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/892074084162613/picture?type=large", "display_name": "Eduard Valentin", "link": "https://stackoverflow.com/users/5178190/eduard-valentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "closed_date": 1547146664, "accepted_answer_id": 54134205, "answer_count": 1, "score": -1, "last_activity_date": 1547189105, "creation_date": 1547137254, "last_edit_date": 1547189105, "question_id": 54132874, "link": "https://stackoverflow.com/questions/54132874/haskell-how-to-generate-all-possible-combinations-of-elements-each-element-fro", "closed_reason": "Duplicate", "title": "Haskell: How to generate all possible combinations of elements, each element from a list, with arbitrary number of lists", "body": "<p>Having a list of <code>[\"P\", \"Q\", \"R\" ...]</code> I want to generate all possible list of <code>[(String, Bool)]</code> where on the left is a letter from the first array, and on the right is <code>True</code> or <code>False</code>. For example having <code>[\"P\", \"Q\"]</code> I want to obtain \n: <code>[[(\"P\",True),(\"Q\",True)],[(\"P\",True),(\"Q\",False)],[(\"P\",False),(\"Q\",True)],[(\"P\",False),(\"Q\",False)]]</code></p>\n\n<p>I made it for the case where I only have <code>[\"P\", \"Q\"]</code> but I need to suport arbitrary number of letters. I tought I can generate for every letter L two pairs in an array like <code>[(L,True),(L,False)]</code> and do that for every letter and make all possible combinations of those arrays with one element from each array, but I don't know how to do it properly.</p>\n\n<p>That's what I did for the list of length 2 of letters</p>\n\n<pre><code>envs :: [String] -&gt; [[(String, Bool)]]\nenvs predicate = let \n  env = [(p,b) | p &lt;- predicate, b &lt;- [True, False]]\n  ps = filter (\\(pred,val) -&gt; pred == \"P\") env \n  qs = filter (\\(pred,val) -&gt; pred == \"Q\") env \n  in [[a,b] | a &lt;- ps, b &lt;- qs]\n</code></pre>\n"}, {"tags": ["list", "haskell", "fold"], "comments": [{"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 4, "creation_date": 1547132064, "post_id": 54131280, "comment_id": 95093809, "body": "Is this a homework question?"}, {"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "reply_to_user": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 4, "creation_date": 1547133393, "post_id": 54131280, "comment_id": 95094658, "body": "@PeterHall Does it really matter? I posted my effort in trying to solve the question, it&#39;s not like I just wanted the implementation without trying to solve it first"}, {"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "reply_to_user": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1547133537, "post_id": 54131280, "comment_id": 95094745, "body": "@PeterHall And to answer your question, no, it is not homework."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547133692, "post_id": 54131280, "comment_id": 95094828, "body": "<a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\">Official-ish guidelines on asking and answering (potential) homework questions.</a>. Indeed it doesn&#39;t really matter; if it&#39;s a good question, it&#39;s a good question regardless of its homework status."}, {"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1547133714, "post_id": 54131280, "comment_id": 95094837, "body": "@GeorgeCernat It might not matter too much. But someone might answer your question differently if they knew it was homework. For example, explain the error and point you to the problem, rather than giving a complete code solution."}, {"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "reply_to_user": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1547133851, "post_id": 54131280, "comment_id": 95094915, "body": "@PeterHall Imho, explaining the error and pointing you to the problem AS WELL AS giving a complete code solution is the best type of answer, anyway"}, {"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1547135753, "post_id": 54131280, "comment_id": 95096131, "body": "@MichaelLitchard I think you are missing the fact that the image I posted is not the code, the code is already posted into the question&#39;s description, the image contains in fact the error given, which, in this particular, for someone knowing haskell, it&#39;s a lot easier to figure what the problem is by looking at the exact error. I think that coping and pasting that error into the question descrption would have definitely been much less readable. You should consider your down-vote"}, {"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1547135834, "post_id": 54131280, "comment_id": 95096181, "body": "@MichaelLitchard Nevertheless, thank you for sharing the reason of your downvote, instead of just down-voting."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1547137713, "post_id": 54131280, "comment_id": 95097362, "body": "@GeorgeCernat Or, you could just conform to standard practice and cut and paste your error, which does include code, like every one else. It&#39;s not about this question in particular but the quality of the site as a whole. Why is your question special?"}, {"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1547139687, "post_id": 54131280, "comment_id": 95098521, "body": "@MichaelLitchard I stand by what I side, there&#39;s always exceptions and in this case, this was the better thing to do, imo. Of course, you can disagree :)"}, {"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1547139852, "post_id": 54131280, "comment_id": 95098612, "body": "@MichaelLitchard but, for the sake of argument, I have two questions. 1) Would you have removed the down-vote had I deleted the image and put instead the text version of the error and 2) would it have been clearer to you if the error was in text rather than like this?"}], "answers": [{"comments": [{"owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "edited": false, "score": 0, "creation_date": 1547140456, "post_id": 54131933, "comment_id": 95098935, "body": "Thanks, for the answer, I have up-voted it, but will not accept it as an answer, as it is a partial answer."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1547134120, "creation_date": 1547134120, "answer_id": 54131933, "question_id": 54131280, "link": "https://stackoverflow.com/questions/54131280/haskell-spliting-a-list-into-several-lists/54131933#54131933", "title": "Haskell - spliting a list into several lists", "body": "<p>In</p>\n\n<pre><code>[(a,b)] : last acc\n</code></pre>\n\n<p>we have:</p>\n\n<pre><code>     acc :: [[(Integer, Integer)]] -- presumed\nlast acc ::  [(Integer, Integer)]\n[(a,b)]  ::  [(Integer, Integer)]\n</code></pre>\n\n<p>So <code>[(a,b)]</code> has the right type to be the first element of an <code>[[(Integer, Integer)]]</code>, but <code>last acc</code> does not have the right type to be the tail of an <code>[[(Integer, Integer)]]</code>.</p>\n\n<p>In</p>\n\n<pre><code>(a,b) : last (last acc)\n</code></pre>\n\n<p>we have:</p>\n\n<pre><code>           acc  :: [[(Integer, Integer)]] -- presumed\n      last acc  ::  [(Integer, Integer)]\nlast (last acc) ::   (Integer, Integer)\n(a,b)           ::   (Integer, Integer)\n</code></pre>\n\n<p>So <code>(a,b)</code> does not have the right type to be the first element of an <code>[[(Integer, Integer)]]</code>, and <code>last (last acc)</code> does not have the right type to be the tail of an <code>[[(Integer, Integer)]]</code>.</p>\n\n<p>I leave the fixes up to you; hopefully this elucidates the meaning of the error enough that you can make progress.</p>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 3, "last_activity_date": 1547149819, "creation_date": 1547149819, "answer_id": 54135982, "question_id": 54131280, "link": "https://stackoverflow.com/questions/54131280/haskell-spliting-a-list-into-several-lists/54135982#54135982", "title": "Haskell - spliting a list into several lists", "body": "<p>Note that when use <code>foldr</code>, the right-hand side elements of given list will be processed first. For example, the list:</p>\n\n<pre><code>[(0,2),(1,0),(1,2),(1,3),(1,4),(2,4)]\n</code></pre>\n\n<p>when processes 3rd element <code>(1,2)</code>, the processed elements, i.e. <code>acc</code></p>\n\n<pre><code>acc = [[(1,3),(1,4)],[(2,4)]]\n</code></pre>\n\n<p>so, the element need to be compared with <code>(1,2)</code> is <code>(1,3)</code>. that is <code>head (head acc)</code> not <code>last (last acc)</code>. Moreover, instead of using <code>head</code>, it can be accessed through pattern matching as:</p>\n\n<pre><code>(pairs@((x, y):xs):xss)\n</code></pre>\n\n<p>and compare to <code>(a, b)</code>:</p>\n\n<pre><code>a == x &amp;&amp; b == (y - 1)\n</code></pre>\n\n<p>and group them together if the condition is met:</p>\n\n<pre><code>((a, b):pairs):xss\n</code></pre>\n\n<p>Moreover, it is more readable to define a step function instead of using anonymous function, since it need to handle the right-most element with the empty list as:</p>\n\n<pre><code>step p [] = [[p]]\n</code></pre>\n\n<p>Once the first element has been processed, <code>acc = [[p]]</code> and never to be empty list in subsequent steps and hence match the pattern defined above. Here is how the step function be defined:</p>\n\n<pre><code>groupTogether = foldr step []\n    where step p [] = [[p]]\n          step p@(a, b) acc@(pairs@((x, y):xs):xss) \n                | a == x &amp;&amp; b == (y - 1) = (p:pairs):xss\n                | otherwise              = [p]:acc\n</code></pre>\n\n<p>The step function is straight forward when understand how <code>foldr</code> operate. Finally, as a side note, the declare:</p>\n\n<pre><code>groupTogether [] = []\n</code></pre>\n\n<p>is not necessary. Since <code>foldr</code> will return its second argument when pass an empty list to <code>groupTogether</code>, in this example, return <code>[]</code>.</p>\n"}], "owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 54135982, "answer_count": 2, "score": 1, "last_activity_date": 1547149819, "creation_date": 1547132014, "question_id": 54131280, "link": "https://stackoverflow.com/questions/54131280/haskell-spliting-a-list-into-several-lists", "title": "Haskell - spliting a list into several lists", "body": "<p>Given a sorted list of tuples, return a list containing list of tuples where each list of tuples adheres to the conditions:</p>\n\n<p>1) for each (a,b) and (c,d) in the list of tuples, a == c</p>\n\n<p>2) the second element of each tuple must be the previous+1, so for [(a, y1), (b, y2), (c, y3)] => y2 = y1+1; y3 = y2 + 1</p>\n\n<p>Example:</p>\n\n<p>Input </p>\n\n<blockquote>\n  <p>ex = [(0,2),(1,0),(1,2),(1,3),(1,4),(2,4)]</p>\n</blockquote>\n\n<p>Output</p>\n\n<blockquote>\n  <p>groupTogether ex = [[(0,2)], [(1,0)], [(1,2),(1,3),(1,4)],[(2,4)]]</p>\n</blockquote>\n\n<p>This must be implemented using fold.</p>\n\n<p>My Implementation:</p>\n\n<pre><code>groupTogether :: [(Integer,Integer)]-&gt; [[(Integer,Integer)]]\ngroupTogether [] = []\ngroupTogether pairs@(x:xs) = foldr (\\(a,b) acc -&gt; if ( (a == fst(last(last(acc)))) &amp;&amp; (b == fst(last(last(acc)))) ) \n                                                  then (a,b) : (last(last(acc))) \n                                                  else [(a,b)] : ((last(acc)))\n                                   ) [[]] pairs\n</code></pre>\n\n<p>The error I am getting:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UGs4q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UGs4q.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell", "type-systems"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1547130904, "post_id": 54130923, "comment_id": 95093021, "body": "Note that the function here is actually <code>(.) ((.) sequence) fmap</code>, so the <code>.</code> applies first on the <code>sequence</code>, not on the <code>fmap</code>."}, {"owner": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547131147, "post_id": 54130923, "comment_id": 95093197, "body": "@WillemVanOnsem, thanks! Seems I did substitution wrong :-("}, {"owner": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547131329, "post_id": 54130923, "comment_id": 95093303, "body": "@WillemVanOnsem Can I substitute <code>t (m a2) ~ ((a -&gt; b) -&gt; c)</code>?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1547139062, "post_id": 54130923, "comment_id": 95098171, "body": "You can get a second equation on <code>b</code> from the type of <code>fmap</code> . Then the two equations beginning <code>b ~</code> will let you eliminate some of the other variables."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547151825, "post_id": 54130923, "comment_id": 95104255, "body": "Side note: with rare exceptions, <code>sequenceA</code> has supplanted <code>sequence</code>. The exceptions tend to involve <code>Traversable</code> containers represented as effectful streams."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1547152039, "post_id": 54130923, "comment_id": 95104349, "body": "By the way, you can take a bit of a short cut to figuring this one out. <code>(sequence .) . fmap = \\f -&gt; (sequence .) (fmap f) = \\f -&gt; sequence . fmap f = mapM f</code>, and we know that <code>mapM :: (Monad m, Traversable t) =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)</code>. If you used <code>sequenceA</code> instead, you&#39;d end up with <code>traverse</code> instead, weakening the <code>Monad</code> constraint to an <code>Applicative</code> one. Even if you don&#39;t want to take that shortcut, transforming to the lambda form I showed will very likely help you work out the type more directly."}], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "is_accepted": false, "score": 0, "last_activity_date": 1547767321, "creation_date": 1547767321, "answer_id": 54245707, "question_id": 54130923, "link": "https://stackoverflow.com/questions/54130923/how-do-i-get-the-type-of-sequence-fmap/54245707#54245707", "title": "How do I get the type of (sequence .) . fmap?", "body": "<p>Let's keep our type variables all distinct.</p>\n\n<pre><code>(.)      ::                             (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nfmap     :: Functor f                =&gt; (u -&gt; v) -&gt; f u -&gt; f v\nsequence :: (Traversable t, Monad m) =&gt; t (m x)  -&gt; m (t x)\n</code></pre>\n\n<p>We have two uses of the function <code>.</code>. I will use <code>a1</code> and the like for the first one, and <code>a2</code> and the like for the second one.</p>\n\n<p>In <code>(sequence .)</code>, we have <code>(b1 -&gt; c1) = (t (m x)  -&gt; m (t x))</code>, so <code>b1 = t (m x)</code> and <code>c1 = m (t x)</code>. Using substitution, <code>.</code> is specialized to <code>(t (m x) -&gt; m (t x)) -&gt; (a1 -&gt; t (m x)) -&gt; a1 -&gt; m (t x)</code>, and after being applied to <code>sequence</code>, we have a term of type <code>(a1 -&gt; t (m x)) -&gt; a1 -&gt; m (t x)</code>.</p>\n\n<p>Now we can look at the second <code>.</code>, <code>(sequence .) . fmap</code>. Here, we have <code>(b2 -&gt; c2) = (a1 -&gt; t (m x)) -&gt; a1 -&gt; m (t x)</code>, and <code>(a2 -&gt; b2) = (u -&gt; v) -&gt; f u -&gt; f v</code>.</p>\n\n<p>This means that:</p>\n\n<pre><code>b2 = a1 -&gt; t (m x)\nc2 = a1 -&gt; m (t x)\na2 = (u -&gt; v)\nb2 = f u -&gt; f v\n</code></pre>\n\n<p>Notice that we have <code>b2</code> up there twice, which means that <code>a1 = f u</code> and <code>t (m x) = f v</code>, so we can also derive that <code>f = t</code>, <code>v = m x</code>.</p>\n\n<p>Now that we know all of those types, we know that the second <code>.</code> is specialized to</p>\n\n<pre><code>((t u -&gt; t (m x)) -&gt; (t u -&gt; m (t x)) \n  -&gt; ((u -&gt; m x) -&gt; (t u -&gt; t (m x))) \n  -&gt; (u -&gt; m x) \n  -&gt; (t u -&gt; m (t x))\n</code></pre>\n\n<p>But we've already applied both of <code>.</code>'s arguments, so the whole expression's type is <code>(u -&gt; m x) -&gt; (t u -&gt; m (t x))</code>.</p>\n\n<p>And from there, it's just variable renaming, constraints, and parenthesis away from what ghci gives me.</p>\n\n<pre><code>&gt; :t (sequence .) . fmap\n(sequence .) . fmap\n  :: (Monad m, Traversable t) =&gt; (a1 -&gt; m a) -&gt; t a1 -&gt; m (t a)\n</code></pre>\n"}], "owner": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547767321, "creation_date": 1547130822, "last_edit_date": 1547136725, "question_id": 54130923, "link": "https://stackoverflow.com/questions/54130923/how-do-i-get-the-type-of-sequence-fmap", "title": "How do I get the type of (sequence .) . fmap?", "body": "<p>I try to understand how Haskell type inference and type system works. Now I'm studying the case of <code>(sequence .) . fmap</code>. I get types of <code>(sequence .)</code> and <code>(. fmap)</code> as haskell does:</p>\n\n<pre><code>(.)      ::                             (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nfmap     :: Functor f                =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nsequence :: (Traversable t, Monad m) =&gt; t (m a)  -&gt; m (t a)\n\n-- Type for . fmap:\na ~ (a -&gt; b)\nb ~ (f a -&gt; f b)\n. fmap              :: ((f a -&gt; f b) -&gt; c) -&gt; ((a -&gt; b) -&gt; c)\n\n-- Type for sequence:\nb ~ t (m a1)\nc ~ m (t a2)\nsequence .          :: (a1 -&gt; t (m a2)) -&gt; (a1 -&gt; m (t a2))\n</code></pre>\n\n<p>But then I can't get the type of <code>(sequence .) . fmap</code>. I tryed following steps and then stucked:</p>\n\n<pre><code>(sequence .) . fmap - ?\n\nf a ~ a1\nf b ~ t (m a2)\nb ~ m a2\nc ~ (a1 -&gt; m (t a2))\n(sequence .) . fmap :: (a -&gt; m a2) -&gt; (a1 -&gt; m (t a2))\n</code></pre>\n\n<p>The type I've got differs from the one haskell give.</p>\n\n<p><strong>UPD</strong> Thanks to @WillemVanOnsem, I've got some progress, but then stucked again...</p>\n\n<pre><code>(.)    ::              (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n(fmap) :: Functor f =&gt; (z -&gt; u) -&gt; f z -&gt; f u\nsequence .          :: (a1 -&gt; t (m a2)) -&gt; (a1 -&gt; m (t a2))\n\nb ~ (a1 -&gt; t (m a2))\nc ~ (a1 -&gt; m (t a2))\na ~ (z -&gt; u)\n(sequence .) . fmap :: ((a1 -&gt; t (m a2)) -&gt; (a1 -&gt; m (t a2))) -&gt;\n                       ((z -&gt; u) -&gt; (a1 -&gt; t (m a2))) -&gt;\n                       ((z -&gt; u) -&gt; (a1 -&gt; m (t a2))\n</code></pre>\n"}, {"tags": ["list", "haskell", "optimization", "combinations"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1547127504, "post_id": 54129886, "comment_id": 95090916, "body": "I&#39;m a little confused by the description. Do you just want to take a list (of functions, although nowhere do you seem to use the fact that these are functions, so it should apply to a list of arbitrary type) and generate all sublists of length exactly 4, but have each sublist in the same order as the elements appear in the original list?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1547127673, "post_id": 54129886, "comment_id": 95091006, "body": "This sounds like <code>take 4 [f1, ..., fn]</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1547127789, "post_id": 54129886, "comment_id": 95091075, "body": "<code>subsequences</code> should definitely preserve order in the way it sounds like you want. Can you show an example where it does something wrong? (It doesn\u2019t even have to involve functions, right? Could be lists of numbers?)"}, {"owner": {"reputation": 87, "user_id": 10895439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142374a25f49bbe040cdaa2244edb29f?s=128&d=identicon&r=PG&f=1", "display_name": "iovo", "link": "https://stackoverflow.com/users/10895439/iovo"}, "edited": false, "score": 0, "creation_date": 1547128565, "post_id": 54129886, "comment_id": 95091544, "body": "I have updated the question. Sorry if it was confusing."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547154252, "post_id": 54130302, "comment_id": 95105278, "body": "Oh, you can surely do better than those! I would consider <code>ndetake</code> a dead end, but let&#39;s go back to <code>ndtake</code>. First off, you can almost certainly use a DList-style optimization to get rid of the <code>++</code>. Second off, there&#39;s a critical piece of information you fail to use: in the first recursive call, <code>ndtake (n-1) xs</code> is never empty (unless the list is too short), so you should be able to produce a cons somewhat more lazily. Basically, there are two cases: <code>n &lt; length xs</code> or not. Once you know which one, you either produce the empty list or do something efficient."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547154567, "post_id": 54130302, "comment_id": 95105419, "body": "Another option that should be even lazier (I think) is to produce a single too-short list when the list is short. <code>ndtake 4 [1,2,3] = [[1,2,3]]</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547157454, "post_id": 54130302, "comment_id": 95106490, "body": "@dfeuer the OP didn&#39;t want shorter subsequences, so your last suggestion doesn&#39;t fit the requirements. as for <code>n &lt; length xs</code>, how am I to know that, if not by measuring the length at the start? and that&#39;s what <i><code>ndetake</code></i> is doing. If we don&#39;t know the length, we keep skipping the elements even when the suffix is already too short, that&#39;s why <code>ndtake</code> was so slow on the last example. If it goes on blind, it will always do that. I don&#39;t see why you dismiss <code>ndetake</code>, really. I think <i><code>ndtake</code></i> is hopeless. We <i>should</i> measure length, &amp; try to stop on short suffixes as <code>ndetake</code> does, I think."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547157562, "post_id": 54130302, "comment_id": 95106530, "body": "but indeed there <i>is</i> another way to do this: instead of <code>map (x:)</code>, have another argument to <code>go</code> which is all the lists built so far; popping off it all the lists of required length as soon as they are built (this  needs to be combined with the too-short-suffixes detection, too). but I&#39;m not sure whether <code>ndetake</code> isn&#39;t already doing that, effectively. will need to think it over (or experiment :) )."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547157847, "post_id": 54130302, "comment_id": 95106642, "body": "you really don&#39;t need the length of the list; you just need to know if it&#39;s long enough. That&#39;s a much cheaper problem to solve."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1547158247, "post_id": 54130302, "comment_id": 95106778, "body": "ah, wait, you meant to look ahead <i>just as much as needed</i>. aha."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547158644, "post_id": 54130302, "comment_id": 95106939, "body": "Right. I haven&#39;t worked out the <i>precise</i> details, but pass down two pointers (&quot;tortoise&quot; and &quot;hare&quot;). You know you&#39;re done when the hare runs out. Also pass down a function representing the current prefix. And take the result to append to (DList style). Roughly speaking, at least, <code>go :: ([t] -&gt; [t]) -&gt; Int -&gt; [t] -&gt; [t] -&gt; [[t]] -&gt; [[t]]</code>. To get the process started, use some sort of <code>dropMay</code> or <code>splitAtMay</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547158716, "post_id": 54130302, "comment_id": 95106965, "body": "I think for n-long required segments, we just need to always look ahead n notches on the list ahead of the current element, that&#39;s it. either that, or it is good enough :) I&#39;m not worried about DL related stuff; I can always build them in reverse (again, &#39;good enough&quot;, complexity-wise :) ) but I still fear the explosion in numbers of these semi-built segments..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547158789, "post_id": 54130302, "comment_id": 95106992, "body": "Yes, we need to look ahead n notches. The base cases seem a little fussy, which is why I haven&#39;t produced a solution yet. And ... life calls. I bet you&#39;ll find a good one!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547158820, "post_id": 54130302, "comment_id": 95106999, "body": "No no! Building in reverse means it will fall over for infinite lists! Don&#39;t do that! And that part is <i>really</i> easy anyway (just the final argument I showed above). The fussy bit is base cases."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547158890, "post_id": 54130302, "comment_id": 95107027, "body": "no, I&#39;ll pop off the built ones as they are produced. the segments-being-built will have to be maintained ordered by their length, for that. n is finite! and yes, life calls for me, too. :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1547159043, "post_id": 54130302, "comment_id": 95107096, "body": "I&#39;ll have to look at it when you&#39;re done. There are certainly a number of ways to do it, which will lead to different orderings of the results. Not sure how they&#39;ll affect, e.g., space complexity. Once you work out the base cases, there are lots of ways to experiment with the easy bits."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 5, "last_activity_date": 1547293929, "last_edit_date": 1547293929, "creation_date": 1547128745, "answer_id": 54130302, "question_id": 54129886, "link": "https://stackoverflow.com/questions/54129886/a-faster-way-of-generating-combinations-with-a-given-length-preserving-the-orde/54130302#54130302", "title": "A faster way of generating combinations with a given length, preserving the order", "body": "<p>You describe a nondeterministic <em><code>take</code></em>:</p>\n\n<pre><code>ndtake :: Int -&gt; [a] -&gt; [[a]]\nndtake 0 _      = [[]]\nndtake n []     = []\nndtake n (x:xs) = map (x:) (ndtake (n-1) xs) ++ ndtake n xs\n</code></pre>\n\n<p>Either we take an <code>x</code>, and have <code>n-1</code> more to take from <code>xs</code>; or we don't take the <code>x</code> and have <code>n</code> more elements to take from <code>xs</code>.</p>\n\n<p>Running:</p>\n\n<pre><code>&gt; ndtake 3 [1..4]\n[[1,2,3],[1,2,4],[1,3,4],[2,3,4]]\n</code></pre>\n\n<hr>\n\n<p>Update: you wanted efficiency. If we're sure the input list is finite, we can aim at stopping as soon as possible:</p>\n\n<pre><code>ndetake n xs = go (length xs) n xs\n    where\n    go spare n _  | n &gt;  spare = []\n    go spare n xs | n == spare = [xs]\n    go spare 0 _      =  [[]]\n    go spare n []     =  []\n    go spare n (x:xs) =  map (x:) (go (spare-1) (n-1) xs) \n                            ++     go (spare-1)  n   xs\n</code></pre>\n\n<p>Trying it:</p>\n\n<pre><code>&gt; length $ ndetake 443 [1..444]\n444\n</code></pre>\n\n<p>The former version seems to be stuck on this input, but the latter one returns immediately.</p>\n\n<hr>\n\n<p>But, it measures the length of the whole list, and needlessly so, as pointed out by <a href=\"https://stackoverflow.com/users/1477667/dfeuer\">@dfeuer</a> in the comments. We <em>can</em> achieve the same improvement in efficiency while retaining a bit more <em>laziness</em>:</p>\n\n<pre><code>ndzetake :: Int -&gt; [a] -&gt; [[a]]\nndzetake n xs | n &gt; 0 = \n    go n (length (take n xs) == n) (drop n xs) xs\n    where\n    go n b p ~(x:xs)\n         | n == 0 = [[]]\n         | not b  = []\n         | null p = [(x:xs)]\n         | otherwise = map (x:) (go (n-1) b p xs)\n                          ++ go n b (tail p) xs\n</code></pre>\n\n<p>Now the last test also works instantly with this code as well.</p>\n\n<p>There's still room for improvement here. Just as with the library function <code>subsequences</code>, the search space could be explored even more lazily. Right now we have</p>\n\n<pre><code>&gt; take 9 $ ndzetake 3 [1..]\n[[1,2,3],[1,2,4],[1,2,5],[1,2,6],[1,2,7],[1,2,8],[1,2,9],[1,2,10],[1,2,11]]\n</code></pre>\n\n<p>but it could be finding <code>[2,3,4]</code> before forcing the <code>5</code> out of the input list. Shall we leave it as an exercise?</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1547375532, "post_id": 54166678, "comment_id": 95165067, "body": "Will work through this later, after I&#39;ve mended my last code some more... (like you said initially, trying the DL route, for then the sharing of prefix structure is possible -- the <code>map (x:)</code> bit prevents that, and that&#39;s what makes it quadratic, as per old <code>inits</code> discussion... )"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1547387322, "post_id": 54166678, "comment_id": 95167746, "body": "@WillNess, note that in this solution (to meet your challenge) the prefix structure has become a suffix structure."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1547424267, "last_edit_date": 1547424267, "creation_date": 1547361985, "answer_id": 54166678, "question_id": 54129886, "link": "https://stackoverflow.com/questions/54129886/a-faster-way-of-generating-combinations-with-a-given-length-preserving-the-orde/54166678#54166678", "title": "A faster way of generating combinations with a given length, preserving the order", "body": "<p>Here's the best I've been able to come up with. It answers the challenge Will Ness laid down to be as lazy as possible in the input. In particular, <code>ndtake m ([1..n]++undefined)</code> will produce as many entries as possible before throwing an exception. Furthermore, it strives to maximize sharing among the result lists (note the treatment of <code>end</code> in <code>ndtakeEnding'</code>). It avoids problems with badly balanced list appends using a difference list. This sequence-based version is considerably faster than any pure-list version I've come up with, but I haven't teased apart just why that is. I have the feeling it may be possible to do even better with a better understanding of just what's going on, but this seems to work pretty well.</p>\n\n<p>Here's the general idea. Suppose we ask for <code>ndtake 3 [1..5]</code>. We first produce all the results ending in <code>3</code> (of which there is one). Then we produce all the results ending in <code>4</code>. We do this by (essentially) calling <code>ndtake 2 [1..3]</code> and adding the <code>4</code> onto each result. We continue in this manner until we have no more elements.</p>\n\n<pre><code>import qualified Data.Sequence as S\nimport Data.Sequence (Seq, (|&gt;))\nimport Data.Foldable (toList)\n</code></pre>\n\n<p>We will use the following simple utility function. It's almost the same as <code>splitAtExactMay</code> from the 'safe' package, but hopefully a bit easier to understand. For reasons I haven't investigated, letting this produce a result when its argument is negative leads to <code>ndtake</code> with a negative argument being equivalent to <code>subsequences</code>. If you want, you can easily change <code>ndtake</code> to do something else for negative arguments.</p>\n\n<pre><code>-- to return an empty list in the negative case.\nsplitAtMay :: Int -&gt; [a] -&gt; Maybe ([a], [a])\nsplitAtMay n xs\n  | n &lt;= 0 = Just ([], xs)\nsplitAtMay _ [] = Nothing\nsplitAtMay n (x : xs) = flip fmap (splitAtMay (n - 1) xs) $\n  \\(front, rear) -&gt; (x : front, rear)\n</code></pre>\n\n<p>Now we really get started. <code>ndtake</code> is implemented using <code>ndtakeEnding</code>, which produces a sort of \"difference list\", allowing all the partial results to be concatenated cheaply.</p>\n\n<pre><code>ndtake :: Int -&gt; [t] -&gt; [[t]]\nndtake n xs = ndtakeEnding n xs []\n\nndtakeEnding :: Int -&gt; [t] -&gt; ([[t]] -&gt; [[t]])\nndtakeEnding 0 _xs = ([]:)\nndtakeEnding n xs = case splitAtMay n xs of\n    Nothing -&gt; id -- Not enough elements\n    Just (front, rear) -&gt;\n        (front :) . go rear (S.fromList front)\n  where\n    -- For each element, produce a list of all combinations\n    -- *ending* with that element.\n    go [] _front = id\n    go (r : rs) front =\n      ndtakeEnding' [r] (n - 1) front\n        . go rs (front |&gt; r)\n</code></pre>\n\n<p><code>ndtakeEnding</code> <em>doesn't</em> call itself recursively. Rather, it calls <code>ndtakeEnding'</code> to calculate the combinations of the front part. <code>ndtakeEnding'</code> is very much like <code>ndtakeEnding</code>, but with a few differences:</p>\n\n<ol>\n<li>We use a <code>Seq</code> rather than a list to represent the input sequence. This lets us split and snoc cheaply, but I'm not yet sure why that seems to give amortized performance that is so much better in this case.</li>\n<li>We already know that the input sequence is long enough, so we don't need to check.</li>\n<li>We're passed a tail (<code>end</code>) to add to each result. This lets us share tails when possible. There are lots of opportunities for sharing tails, so this can be expected to be a substantial optimization.</li>\n<li>We use <code>foldr</code> rather than pattern matching. Doing this manually with pattern matching gives clearer code, but worse constant factors. That's because the <code>:&lt;|</code>, and <code>:|&gt;</code> patterns exported from <code>Data.Sequence</code> are non-trivial pattern synonyms that perform a bit of calculation, including amortized O(1) allocation, to build the tail or initial segment, whereas folds don't need to build those.</li>\n</ol>\n\n<p>NB: this implementation of <code>ndtakeEnding'</code> works well for recent GHC and containers; it seems less efficient for earlier versions. That might be the work of Donnacha Kidney on <code>foldr</code> for <code>Data.Sequence</code>. In earlier versions, it might be more efficient to pattern match by hand, using <code>viewl</code> for versions that don't offer the pattern synonyms.</p>\n\n<pre><code>ndtakeEnding' :: [t] -&gt; Int -&gt; Seq t -&gt; ([[t]] -&gt; [[t]])\nndtakeEnding' end 0 _xs = (end:)\nndtakeEnding' end n xs = case S.splitAt n xs of\n     (front, rear) -&gt;\n        ((toList front ++ end) :) . go rear front\n  where\n    go = foldr go' (const id) where\n      go' r k !front = ndtakeEnding' (r : end) (n - 1) front . k (front |&gt; r)\n    -- With patterns, a bit less efficiently:\n    -- go Empty _front = id\n    -- go (r :&lt;| rs) !front =\n    --  ndtakeEnding' (r : end) (n - 1) front\n    --    . go rs (front :|&gt; r)\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10895439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142374a25f49bbe040cdaa2244edb29f?s=128&d=identicon&r=PG&f=1", "display_name": "iovo", "link": "https://stackoverflow.com/users/10895439/iovo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 1, "accepted_answer_id": 54130302, "answer_count": 2, "score": 3, "last_activity_date": 1547424267, "creation_date": 1547127288, "last_edit_date": 1547139568, "question_id": 54129886, "link": "https://stackoverflow.com/questions/54129886/a-faster-way-of-generating-combinations-with-a-given-length-preserving-the-orde", "title": "A faster way of generating combinations with a given length, preserving the order", "body": "<p><em>TL;DR</em>: I want the exact behavior as <code>filter ((== 4) . length) . subsequences</code>. Just using <code>subsequences</code> also creates variable length of lists, which takes a lot of time to process. Since in the end only lists of length 4 are needed, I was thinking there must be a faster way.</p>\n\n<hr>\n\n<p>I have a list of functions. The list has the type <code>[Wor -&gt; Wor]</code></p>\n\n<p>The list looks something like this</p>\n\n<p><code>[f1, f2, f3 .. fn]</code></p>\n\n<p>What I want is a list of lists of <code>n</code> functions while preserving order like this</p>\n\n<p>input : <code>[f1, f2, f3 .. fn]</code></p>\n\n<p>argument : 4 functions</p>\n\n<p>output : A list of lists of 4 functions.</p>\n\n<p>Expected output would be where if there's an <code>f1</code> in the sublist, it'll always be at the <code>head</code> of the list.</p>\n\n<p>If there's a <code>f2</code> in the sublist and if the sublist doens't have <code>f1</code>, <code>f2</code> would be at <code>head</code>. If <code>fn</code> is in the sublist, it'll be at <code>last</code>.</p>\n\n<p>In general if there's a <code>fx</code> in the list, it never will be infront of <code>f(x - 1)</code> . </p>\n\n<p>Basically preserving the main list's order when generating sublists.</p>\n\n<p>It can be assumed that length of list will always be greater then given argument.</p>\n\n<p>I'm just starting to learn Haskell so I haven't tried all that much but so far this is what I have tried is this:</p>\n\n<p>Generation permutations with <code>subsequences</code> function and applying <code>(filter (== 4) . length)</code> on it seems to generate correct permutations -but it doesn't preserve order- (It preserves order, I was confusing it with my own function).</p>\n\n<p>So what should I do?</p>\n\n<p>Also if possible, is there a function or a combination of functions present in <code>Hackage</code> or <code>Stackage</code> which can do this? Because I would like to understand the source.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547125619, "post_id": 54129363, "comment_id": 95089826, "body": "Number divisible by both <code>3</code> and <code>5</code> are always divisable by <code>15</code> and vice versa, since <code>3</code> and <code>5</code> are relatively prime. So this is correct."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1547125860, "creation_date": 1547125860, "answer_id": 54129463, "question_id": 54129363, "link": "https://stackoverflow.com/questions/54129363/list-comprehension-and-filtering-elements/54129463#54129463", "title": "List comprehension and filtering elements", "body": "<blockquote>\n  <p>But, what if I wanted that instead of excluding the number 15, that position of the list would be filled with a <code>0</code>?</p>\n</blockquote>\n\n<p>In that case, this is not filtering, but a mapping where you add a condition in the map such that elements that are dividably by 3 and 5 (for this specific case, we can just say dividably by 15), should map to 0:</p>\n\n<pre><code>[ <b>if mod x 3 == 0 && mod x 5 == 0 then 0 else x</b> | x &lt;- [1..20]]</code></pre>\n\n<p>or more compact:</p>\n\n<pre><code>[ if <b>mod x 15 == 0</b> then 0 else x | x &lt;- [1..20]]</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10895361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5edd15d2f59f7ade71068de08f635105?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe Rabelo", "link": "https://stackoverflow.com/users/10895361/felipe-rabelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 54129463, "answer_count": 1, "score": 2, "last_activity_date": 1547125860, "creation_date": 1547125506, "question_id": 54129363, "link": "https://stackoverflow.com/questions/54129363/list-comprehension-and-filtering-elements", "title": "List comprehension and filtering elements", "body": "<p>I've been trying to create a comprehension for a, technically, simple case of list, but I'm not sure if Haskell can achieve the result I want the way I expected.</p>\n\n<p>If I wanted to make a list of numbers from 1 to 20, filtering the numbers whom aren't both divisible by 3 and 5 at the same time, this would be as simple as</p>\n\n<pre><code>[x | x &lt;- [1..20], not $ x `mod` 3 == 0 &amp;&amp; x `mod` 5 == 0]\n</code></pre>\n\n<p>Which would result in a list with every number from 1 to 20 without the 15.</p>\n\n<p>But, what if I wanted that instead of excluding the number 15, that position of the list would be filled with a 0? The same applying if the range was bigger and I wanted that every case which my filter is false, instead of not taking the number, it would attribute to x a predetermined value (in my example, 0), can this be achieved with a list comprehension or should I use another solution?</p>\n"}, {"tags": ["unit-testing", "haskell", "testing"], "answers": [{"comments": [{"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 0, "creation_date": 1547136436, "post_id": 54132480, "comment_id": 95096579, "body": "but no way to do it in cleanup function which is passing to withResource as 2nd argument due to no way to get Result (status) there?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 0, "creation_date": 1547137298, "post_id": 54132480, "comment_id": 95097125, "body": "Not that I know of."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 1, "last_activity_date": 1547135959, "creation_date": 1547135959, "answer_id": 54132480, "question_id": 54129190, "link": "https://stackoverflow.com/questions/54129190/how-to-tear-down-testbed-resources-in-tasty-conditionally/54132480#54132480", "title": "How to tear down testbed resources in Tasty conditionally?", "body": "<p>Test failures (at least in <code>tasty-hunit</code>) are <a href=\"https://hackage.haskell.org/package/tasty-hunit-0.10.0.1/docs/Test-Tasty-HUnit.html#t:Assertion\" rel=\"nofollow noreferrer\">implemented as exceptions</a>.  The purpose of <code>withResource</code> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:bracket\" rel=\"nofollow noreferrer\"><code>bracket</code></a> is to free resources even when there is an exception.  If you write straight-line code like this, the resource will be freed if and only if the assertions pass:</p>\n\n<pre><code>testCase \"resource management\" $ do\n    a &lt;- allocate\n    assertBool =&lt;&lt; runTest\n    cleanUp a        \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "is_accepted": false, "score": 1, "last_activity_date": 1603571283, "creation_date": 1603571283, "answer_id": 64517715, "question_id": 54129190, "link": "https://stackoverflow.com/questions/54129190/how-to-tear-down-testbed-resources-in-tasty-conditionally/64517715#64517715", "title": "How to tear down testbed resources in Tasty conditionally?", "body": "<p>It's a bit hacky, but you could use an <a href=\"https://hackage.haskell.org/package/tasty-1.3.1/docs/Test-Tasty.html#g:6\" rel=\"nofollow noreferrer\">AllSucceed</a> dependency and define a dummy test that would clean up your resource but would run only in the case when certain other tests succeed.</p>\n<p>A caveat is that such a cleanup test could be filtered out by a pattern.</p>\n<p>Alternatively, I think I'd accept a pull request that adds a version of withResource with an additional <code>Outcome</code> argument.</p>\n"}], "owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 54132480, "answer_count": 2, "score": 0, "last_activity_date": 1603571283, "creation_date": 1547124903, "question_id": 54129190, "link": "https://stackoverflow.com/questions/54129190/how-to-tear-down-testbed-resources-in-tasty-conditionally", "title": "How to tear down testbed resources in Tasty conditionally?", "body": "<p>I use Haskell's Tasty framework for testing. When I acquire and clear resources, I do it with <code>withResource</code> Tasty's function:</p>\n\n<pre><code>withResource :: IO a -&gt; (a -&gt; IO ()) -&gt; (IO a -&gt; TestTree) -&gt; TestTree\n</code></pre>\n\n<p>where <code>a</code> is type of resource. But I want to keep resources if tests fail and to clear them only if tests passed. How is it possible?</p>\n"}, {"tags": ["list", "haskell", "fold"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547123263, "post_id": 54128694, "comment_id": 95088556, "body": "Given the output is a 2-tuple, the result of <code>breakList []</code> should be <code>([], [])</code>. But this should be handled by the <code>foldr</code> as well."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1547123281, "post_id": 54128694, "comment_id": 95088565, "body": "Hint: each time &quot;swap&quot; the lists in the 2-tuple, and append the current element to one of the two."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1547129289, "post_id": 54130173, "comment_id": 95091970, "body": "this isn&#39;t very good. repeated use of <code>length</code> (to measure lists you yourself are creating) makes it quadratic. and of course needlessly strict - it won&#39;t work on infinite lists."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1547132154, "post_id": 54130173, "comment_id": 95093882, "body": "@WillNess Yes, you are right. But I just correct the error of the question and don&#39;t want to modify too much of original coding in question."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 2, "last_activity_date": 1547128244, "creation_date": 1547128244, "answer_id": 54130173, "question_id": 54128694, "link": "https://stackoverflow.com/questions/54128694/haskell-separate-a-list-of-pairs-in-two-lists-using-fold/54130173#54130173", "title": "Haskell - separate a list of pairs in two lists using fold", "body": "<p>Note that you want to split a list into two lists of a pair, so the return type should be</p>\n\n<pre><code>([(Integer, Integer)], [(Integer, Integer)])\n</code></pre>\n\n<p>not</p>\n\n<pre><code>[[(Integer, Integer)]]\n</code></pre>\n\n<p>and access the element of pair, you can use <code>fst</code> and <code>snd</code> instead of through index, and finally, use <code>foldl</code> will return the resulted list in reversed order, it can be fixed use <code>foldr</code> instead. The correction look like:</p>\n\n<pre><code>breakList :: [(Integer, Integer)]-&gt;([(Integer, Integer)], [(Integer, Integer)])\nbreakList xxs = foldr (\\y acc-&gt; if length (fst acc) &lt; length (snd acc)\n                                then (y:(fst acc), snd acc)\n                                else (fst acc, y:(snd acc)) ) ([], []) xxs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1547129630, "creation_date": 1547129630, "answer_id": 54130568, "question_id": 54128694, "link": "https://stackoverflow.com/questions/54128694/haskell-separate-a-list-of-pairs-in-two-lists-using-fold/54130568#54130568", "title": "Haskell - separate a list of pairs in two lists using fold", "body": "<p>The standard trick here, as hinted at by Willem in the comments, which I first saw few years back on SO in an (F# or Ocaml) answer by [user:Ed'ka], is</p>\n\n<pre><code>evenodds :: [a] -&gt; ([a], [a])\nevenodds xs = foldr g ([],[]) xs\n  where\n  g x ~(as,bs) = (bs,x:as)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>oddevens :: [a] -&gt; ([a], [a])\noddevens xs = foldr g ([],[]) xs\n  where\n  g x ~(bs,as) = (x:as,bs)\n</code></pre>\n\n<p>What are odd positions from here, are even positions from the position one  notch further on the list.</p>\n\n<p>The tilde <code>~</code> introduces a lazy pattern so that the function is properly lazy in its operations.</p>\n"}], "owner": {"reputation": 1259, "user_id": 7862080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0GJT4.png?s=128&g=1", "display_name": "George Cernat", "link": "https://stackoverflow.com/users/7862080/george-cernat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "accepted_answer_id": 54130173, "answer_count": 2, "score": 1, "last_activity_date": 1547129630, "creation_date": 1547123155, "last_edit_date": 1547126756, "question_id": 54128694, "link": "https://stackoverflow.com/questions/54128694/haskell-separate-a-list-of-pairs-in-two-lists-using-fold", "title": "Haskell - separate a list of pairs in two lists using fold", "body": "<p>So, I am given a list containing tuples and I need to break it down into two lists, the first list containing the elements with odd index and the second list containing the elements with even index, must be done using fold, here is my attempt:</p>\n\n<pre><code>breakList :: [(Integer, Integer)] -&gt; [[(Integer, Integer)]]\nbreakList [] = [[], []]\nbreakList xxs@(x:xs) = foldl (\\ acc y -&gt; if length (acc !! 0) &lt; length (acc !! 1) then y : (acc !! 0) else y : (acc !! 1)  )  [[], []] xxs\n</code></pre>\n\n<p>Error I am getting:</p>\n\n<p><strong>Couldn't match type '(Integer, Integer)'\n with '[(Integer, Integer)]'\n      Expected type: [[(Integer, Integer)]]</strong></p>\n\n<p>when hovering over <code>y : (acc !! 1) and y : (acc !! 0)</code></p>\n\n<p>Example:</p>\n\n<p>Input:</p>\n\n<blockquote>\n  <p>ex1 = [ (2, 2), (1, 3), (2, 3), (2, 4), (3, 5), (0, 2), (2, 1), (1, 4)\n  , (2, 0), (1, 2), (3, 1), (1, 0)]</p>\n</blockquote>\n\n<p>Output</p>\n\n<blockquote>\n  <p>breakList ex1 \n  ==  ( [(2,2),(2,3),(3,5),(2,1),(2,0),(3,1)] , [(1,3),(2,4),(0,2),(1,4),(1,2),(1,0)])</p>\n</blockquote>\n"}, {"tags": ["haskell", "matrix", "linear-algebra"], "owner": {"reputation": 205, "user_id": 9725978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e07d302414b4f9bcd4aa5face22e07e1?s=128&d=identicon&r=PG", "display_name": "Mark Wildon", "link": "https://stackoverflow.com/users/9725978/mark-wildon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1563316058, "creation_date": 1547119940, "last_edit_date": 1563316058, "question_id": 54127797, "link": "https://stackoverflow.com/questions/54127797/finite-field-and-rational-linear-algebra-in-haskell", "title": "Finite field and rational linear algebra in Haskell", "body": "<p>Is there a Haskell package that can compute the reduced row-echelon form of a matrix, with entries from either the rationals, or a finite field of prime size? I am looking for something that will be comparable in speed to computer algebra packages such as Sage.</p>\n\n<p>I have looked at <a href=\"http://hackage.haskell.org/package/hmatrix\" rel=\"nofollow noreferrer\">hmatrix</a> and <a href=\"http://hackage.haskell.org/package/hmatrix-0.19.0.0/docs/Numeric-LinearAlgebra.html\" rel=\"nofollow noreferrer\">other modules</a> but they appear to be focused on numerical analysis rather than linear algebra. The <a href=\"https://stackoverflow.com/questions/10665850/finite-field-linear-algebra-library-for-haskell\">answer to this question</a> suggests that the answer was a qualified 'no' six years ago.</p>\n"}, {"tags": ["haskell", "type-level-computation"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1547120012, "creation_date": 1547120012, "answer_id": 54127813, "question_id": 54127203, "link": "https://stackoverflow.com/questions/54127203/binding-types-in-signatures/54127813#54127813", "title": "Binding types in signatures", "body": "<p>The only way I see is to add a <code>Proxy</code> to bind the type variable with <code>ScopedTypeVariables</code>.</p>\n\n<pre><code>data Gadt a where\n  Lit :: KnownNat s =&gt; Proxy s -&gt; Gadt ('Index s)\n\nformat :: Gadt a -&gt; String\nformat (Lit (Proxy :: Proxy s)) = undefined\n</code></pre>\n\n<p>If you are worried about the extra allocation, the field can be unpacked. (EDIT: removed previous mention of <code>Proxy#</code> because that doesn't seem necessary).</p>\n\n<pre><code>import Data.Proxy\n\n-- This should be as efficient as the original Gadt with a nullary Lit\ndata Gadt a where\n  Lit :: {-# UNPACK #-} !(Proxy r) -&gt; Gadt ('Index r)\n\nformat :: Gadt a -&gt; String\nformat (Lit (_ :: Proxy r)) = undefined\n</code></pre>\n\n<hr>\n\n<p>On the longer term, the following GHC proposal will address this issue: <a href=\"https://github.com/ghc-proposals/ghc-proposals/blob/type-applications-in-patterns/proposals/type-applications-in-patterns.rst\" rel=\"nofollow noreferrer\">Type Applications in Patterns</a>.</p>\n\n<pre><code>-- The original type\ndata Gadt a where\n  Lit :: forall s. Gadt ('Index s)\n\nformat :: Gadt a -&gt; String\nformat (Lit @s) = ...\n</code></pre>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54127813, "answer_count": 1, "score": 2, "last_activity_date": 1547120012, "creation_date": 1547117953, "question_id": 54127203, "link": "https://stackoverflow.com/questions/54127203/binding-types-in-signatures", "title": "Binding types in signatures", "body": "<p>What is the most direct way to bind a type variable when pattern matching in a Gadt ?</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack script --resolver lts-13.1\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE GADTs, ScopedTypeVariables             #-}\n{-# LANGUAGE DataKinds   #-}\nmodule Main where\nimport Data.Proxy\nimport GHC.TypeLits    \nmain :: IO ()\nmain = undefined\n\ndata Kind where\n  Index :: Symbol -&gt; Kind\n\ndata Gadt (f::Kind) where\n  Lit :: KnownSymbol s =&gt; Gadt ('Index s)\n</code></pre>\n\n<p>Binding <code>s</code> directly would fail</p>\n\n<pre><code>format :: Gadt f -&gt; String\nformat (Lit :: Gadt ('Index s)) = undefined   -- KO\n</code></pre>\n\n<p>with error </p>\n\n<pre><code>\u2022 Couldn't match type \u2018f\u2019 with \u2018'Index s\u2019\n  \u2018f\u2019 is a rigid type variable bound by\n    the type signature for:\n      format :: forall (f :: Kind). Gadt f -&gt; String\n  Expected type: Gadt f\n  Actual type: Gadt ('Index s)\n</code></pre>\n\n<p>A type function can extract the type, but aren't there more direct way to do this ?</p>\n\n<pre><code>format (Lit :: Gadt i)  =  symbolVal (Proxy :: TLabel i)\n\ntype family TLabel (a::Kind)\ntype instance TLabel ('Index s  ) = Proxy s\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1547118304, "post_id": 54127267, "comment_id": 95085846, "body": "I was looking to an older version of ghc ! that&#39;s why I had issues ...."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1547118309, "post_id": 54127267, "comment_id": 95085847, "body": "Actually this doesn&#39;t work because of the constraint on the types of constructors with the same fields."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1547118437, "last_edit_date": 1547118437, "creation_date": 1547118144, "answer_id": 54127267, "question_id": 54127013, "link": "https://stackoverflow.com/questions/54127013/record-syntax-on-a-gadt-style-data-type-declaration-issue/54127267#54127267", "title": "record syntax on a GADT-style data type declaration issue", "body": "<p>The correct syntax is (crazy):</p>\n\n<pre><code>data Foo a where\n  Bar :: { fd1 :: T1, fd2 :: T2 } -&gt; Foo b\n  --- etc.\n</code></pre>\n\n<p>So in this case you might want:</p>\n\n<pre><code>data Step a  where\n  WorkOnWorkspacesStep ::\n    { workOnWorkspaces:: WorkOnWorkspacesStepHandle\n    , clients::Clients } -&gt;\n    Step WorkOnWorkspaces\n  WorkOnAWorkspaceStep ::\n    { workOnWorkspace::  WorkOnAWorkspaceStepHandle\n    , clients::Clients\n    , workspace::Workspace\n    , workOnWorkspaces:: WorkOnWorkspacesStepHandle } -&gt;\n    Step WorkOnAWorkspace\n  WorkOnAGoalStep ::\n    { workOnAGoal ::     WorkOnAGoalStepHandle\n    , clients::Clients\n    , workspace::Workspace\n    , goal::Goal\n    , workOnWorkspace:: WorkOnAWorkspaceStepHandle\n    , workOnWorkspaces:: WorkOnWorkspacesStepHandle } -&gt;\n    Step WorkOnAGoal\n</code></pre>\n\n<p>For reference, see the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#generalised-algebraic-data-types-gadts\" rel=\"nofollow noreferrer\">GHC user guide</a> (near the bottom of the linked section).</p>\n\n<p>EDIT: Unfortunately, this appears to not be actually legal</p>\n\n<blockquote>\n  <p>However, for GADTs there is the following additional constraint: every constructor that has a field f must have the same result type (modulo alpha conversion)</p>\n</blockquote>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 54127267, "answer_count": 1, "score": 1, "last_activity_date": 1547118437, "creation_date": 1547117289, "last_edit_date": 1547117590, "question_id": 54127013, "link": "https://stackoverflow.com/questions/54127013/record-syntax-on-a-gadt-style-data-type-declaration-issue", "title": "record syntax on a GADT-style data type declaration issue", "body": "<p>I'm trying to make the following compile (<a href=\"https://downloads.haskell.org/~ghc/6.6/docs/html/users_guide/gadt.html\" rel=\"nofollow noreferrer\">record syntax on a GADT-style</a>) :</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings     #-}\n{-# LANGUAGE NamedFieldPuns #-}\n{-# LANGUAGE DuplicateRecordFields #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\nmodule Gsd.CLI.Steps where\n\nimport System.Console.Byline\nimport Data.Text\n\nimport Gsd.Clients\nimport Gsd.Read.Workspace\nimport Gsd.Read.Goal\n\ntype ErrorDescription = String\ntype WorkOnWorkspacesStepHandle = Clients -&gt; Byline IO ()\ntype WorkOnAWorkspaceStepHandle = Clients -&gt; Workspace -&gt;  WorkOnWorkspacesStepHandle -&gt; Byline IO ()\ntype WorkOnAGoalStepHandle      = Clients -&gt; Workspace -&gt; Goal -&gt;  WorkOnAWorkspaceStepHandle -&gt; WorkOnWorkspacesStepHandle -&gt; Byline IO ()\n\n\n\ndata StepName = WorkOnWorkspaces | WorkOnAWorkspace | WorkOnAGoal\n\ndata Step a  where\n  WorkOnWorkspacesStep  { workOnWorkspaces:: WorkOnWorkspacesStepHandle, clients::Clients } :: Step WorkOnWorkspaces\n  WorkOnAWorkspaceStep  { workOnWorkspace::  WorkOnAWorkspaceStepHandle, clients::Clients, workspace::Workspace , workOnWorkspaces:: WorkOnWorkspacesStepHandle} ::  Step WorkOnAWorkspace\n  WorkOnAGoalStep       { workOnAGoal ::     WorkOnAGoalStepHandle,      clients::Clients, workspace::Workspace,  goal::Goal , workOnWorkspace::  WorkOnAWorkspaceStepHandle, workOnWorkspaces:: WorkOnWorkspacesStepHandle} :: Step WorkOnAGoal\n</code></pre>\n\n<p>the compiler doesn't like the <code>data Step a</code> syntax I have used </p>\n\n<pre><code>/Users/nhenin/dev/gsdFlow/src/Gsd/CLI/Steps.hs:25:25: error: parse error on input \u2018{\u2019\n   |\n25 |   WorkOnWorkspacesStep  { workOnWorkspaces:: WorkOnWorkspacesStepHandle, clients::Clients } :: Step WorkOnWorkspaces\n   |                         ^\n\n                    ^\n</code></pre>\n\n<p>I'm following this example :</p>\n\n<pre><code>  data Term a where\n      Lit    { val  :: Int }      :: Term Int\n      Succ   { num  :: Term Int } :: Term Int\n      Pred   { num  :: Term Int } :: Term Int\n      IsZero { arg  :: Term Int } :: Term Bool  \n      Pair   { arg1 :: Term a\n             , arg2 :: Term b\n             }                    :: Term (a,b)\n      If     { cnd  :: Term Bool\n             , tru  :: Term a\n             , fls  :: Term a\n             }                    :: Term a\n</code></pre>\n\n<p>Which does not compile as well surprisingly... </p>\n"}, {"tags": ["haskell", "either"], "answers": [{"tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 10, "last_activity_date": 1547104347, "creation_date": 1547104347, "answer_id": 54123545, "question_id": 54123455, "link": "https://stackoverflow.com/questions/54123455/haskell-function-with-either-input/54123545#54123545", "title": "Haskell function with Either input", "body": "<p>If you define a function that takes <code>Either String Int</code> then you cannot just pass an <code>Int</code> to it. In your case you probably want to pass <code>Right 8</code> or <code>Left \"8\"</code>:</p>\n\n<pre><code>module Main( main ) where\n\nmyAtoi :: Either String Int -&gt; Int\nmyAtoi _ = 700\n\nmain :: IO ()\nmain = do\n  print(myAtoi(Right 8))\n  print(myAtoi(Left \"8\"))\n</code></pre>\n"}], "owner": {"reputation": 3212, "user_id": 3357352, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/nfb7n.jpg?s=128&g=1", "display_name": "OrenIshShalom", "link": "https://stackoverflow.com/users/3357352/orenishshalom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 54123545, "answer_count": 1, "score": -2, "last_activity_date": 1547104347, "creation_date": 1547104000, "question_id": 54123455, "link": "https://stackoverflow.com/questions/54123455/haskell-function-with-either-input", "title": "Haskell function with Either input", "body": "<p>I can't seem to write a simple haskell function that gets an <code>Either</code> input and use it. Here is what I wrote:</p>\n\n<pre><code>$ cat main.hs\nmodule Main( main ) where\n\n-- myAtoi :: Either String Int -&gt; Int\nmyAtoi :: Int -&gt; Int\nmyAtoi _ = 700\n\nmain :: IO ()\nmain = do\nprint(myAtoi(8))\n</code></pre>\n\n<p>And this obviously works fine:</p>\n\n<pre><code>$ ghc main.hs -o main\n$ ./main\n700\n</code></pre>\n\n<p>But when I remove the comment and use the first signature I get the following error:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( main.hs, main.o )\n\nmain.hs:9:14: error:\n    \u2022 No instance for (Num (Either String Int))\n        arising from the literal \u20188\u2019\n    \u2022 In the first argument of \u2018myAtoi\u2019, namely \u2018(8)\u2019\n      In the first argument of \u2018print\u2019, namely \u2018(myAtoi (8))\u2019\n      In a stmt of a 'do' block: print (myAtoi (8))\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck", "property-based-testing"], "answers": [{"comments": [{"owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1547116277, "post_id": 54123808, "comment_id": 95084635, "body": "Thanks, is there more information about &quot;hedgehog&#39;s approach&quot; ?   I find a package   <a href=\"https://hackage.haskell.org/package/hedgehog-quickcheck\" rel=\"nofollow noreferrer\">here</a>, but it&#39;s document tells nothing about shrink."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1547116695, "post_id": 54123808, "comment_id": 95084875, "body": "<a href=\"https://hackage.haskell.org/package/hedgehog\" rel=\"nofollow noreferrer\">Hedgehog</a> is a property-based testing library, it is an alternative to QuickCheck. The readme gives a simple example."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "edited": false, "score": 0, "creation_date": 1547116797, "post_id": 54123808, "comment_id": 95084953, "body": "You&#39;ll find some relevant discussions on this announcement <a href=\"https://www.reddit.com/r/haskell/comments/646k3d/ann_hedgehog_property_testing/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/646k3d/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1547116708, "last_edit_date": 1547116708, "creation_date": 1547105506, "answer_id": 54123808, "question_id": 54122466, "link": "https://stackoverflow.com/questions/54122466/what-is-the-best-practice-to-generate-data-which-satisfy-specific-property-in-qu/54123808#54123808", "title": "What is the best practice to generate data which satisfy specific property in QuickCheck?", "body": "<p>For well-typed terms, a simple approach in many cases is to have one generator for each type, or, equivalently, a function <code>TyRep -&gt; Gen Expr</code>. Adding variables on top of that, this usually turns into a function <code>Context -&gt; TyRep -&gt; Gen Expr</code>.</p>\n\n<p>In the case of generating terms with variables (and with no or very simple types), indexing the type of terms by the context (e.g., like you would do using the <code>bound</code> library) should make it quite easy to derive a generator generically.</p>\n\n<p>For shrinking, <a href=\"https://hackage.haskell.org/package/hedgehog\" rel=\"nofollow noreferrer\">hedgehog</a>'s approach can work quite well, where <code>Gen</code> generates a value together with shrunk versions, sparing you from defining a separate shrinking function.</p>\n\n<p>Note that as the well-formedness/typing relation becomes more complex, you start hitting the theoretical wall where generating terms is at least as hard as arbitrary proof search.</p>\n\n<hr>\n\n<p>For more advanced techniques/related literature, with my own comments about possibly using it in Haskell:</p>\n\n<ul>\n<li><p><em>Generating Constrained Data with Uniform Distribution</em>, by Claessen et al., FLOPS'14 (<a href=\"http://publications.lib.chalmers.se/records/fulltext/195847/local_195847.pdf\" rel=\"nofollow noreferrer\">PDF</a>). I believe the Haskell package <a href=\"https://hackage.haskell.org/package/lazy-search\" rel=\"nofollow noreferrer\">lazy-search</a> has most of the machinery described by the paper, but it seems aimed at enumeration rather than random generation.</p></li>\n<li><p><em>Making Random Judgments: Automatically Generating Well-Typed Terms from the Definition of a Type-System</em>, by Fetscher et al., ESOP'15 (<a href=\"http://users.eecs.northwestern.edu/~baf111/random-judgments/random-judgments-esop15.pdf\" rel=\"nofollow noreferrer\">PDF</a>), the title says it all. I don't know about a Haskell implementation though; you might want to ask the authors.</p></li>\n<li><p><em>Beginner's Luck: A Language for Property-Based Generators</em>, by Lampropoulos et al., POPL'17 (<a href=\"https://lemonidas.github.io/pdf/Luck.pdf\" rel=\"nofollow noreferrer\">PDF</a>)  (disclaimer: I'm a coauthor). A language of properties (more concretely, functions <code>T -&gt; Bool</code>, e.g., a typechecker) that can be interpreted as random generators (<code>Gen T</code>). The language's syntax is strongly inspired by Haskell, but there are still a few differences. The implementation has an interface to extract the generated values in Haskell (<a href=\"https://github.com/QuickChick/Luck\" rel=\"nofollow noreferrer\">github repo</a>).</p></li>\n<li><p><em>Generating Good Generators for Inductive Relations</em>, by Lampropoulos et al. POPL'18 (<a href=\"https://lemonidas.github.io/pdf/GeneratingGoodGenerators.pdf\" rel=\"nofollow noreferrer\">PDF</a>). It's in Coq QuickChick, but tying it to Haskell QuickCheck by extraction seems reasonably feasible.</p></li>\n</ul>\n"}], "owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 54123808, "answer_count": 1, "score": 2, "last_activity_date": 1547116708, "creation_date": 1547098487, "question_id": 54122466, "link": "https://stackoverflow.com/questions/54122466/what-is-the-best-practice-to-generate-data-which-satisfy-specific-property-in-qu", "title": "What is the best practice to generate data which satisfy specific property in QuickCheck?", "body": "<p>When we are using QuickCheck to check our programs, we need to define generators for our data, there is some generic way to define them, but the generic way usually  become useless when we need the generated data to satisfy some constraints to work.</p>\n\n<p>e.g.</p>\n\n<pre><code>data Expr\n    = LitI Int\n    | LitB Bool\n    | Add Expr Expr\n    | And Expr Expr\n\ndata TyRep = Number | Boolean\n\ntypeInfer :: Expr -&gt; Maybe TyRep\ntypeInfer e = case e of\n    LitI _ -&gt; Number\n    LitB _ -&gt; Boolean\n    Add e1 e2 -&gt; case (typeInfer e1, typeInfer e2) of\n        (Just Number, Just Number) -&gt; Just Number\n        _ -&gt; Nothing\n    And e1 e2 -&gt; case (typeInfer e1, typeInfer e2) of\n        (Just Boolean, Just Boolean) -&gt; Just Boolean\n        _ -&gt; Nothing\n</code></pre>\n\n<p>now I need to define generator of Expr (i.e. <code>Gen Expr</code> or <code>instance Arbitrary Expr</code>), but also want it generates the type correct ones (i.e. <code>isJust (typeInfer generatedExpr)</code>)</p>\n\n<p>a naive way to do that is use <code>suchThat</code> to filter out the invalid ones, but that is obviously inefficient when <code>Expr</code> and <code>TyRep</code> becomes complicated with more cases.</p>\n\n<p>Another similar situation is about reference integrity, e.g.</p>\n\n<pre><code>data Expr\n    = LitI Int\n    | LitB Bool\n    | Add Expr Expr\n    | And Expr Expr\n    | Ref String -- ^ reference another Expr via it's name\n\ntype Context = Map String Expr\n</code></pre>\n\n<p>In this case, we want all the referenced names in the generated <code>Expr</code> are contained in some specific <code>Context</code>, now I have to generate <code>Expr</code> for specific <code>Context</code>:</p>\n\n<pre><code>arbExpr :: Context -&gt; Gen Expr\n</code></pre>\n\n<p>but now shrink will be a problem, and to solve this problem, I have to define a specific version of shrink, and use <code>forAllShrink</code> everytime I use <code>arbExpr</code>, that means a lot of work.</p>\n\n<p>So I want to know, is there a best practice to do such things?</p>\n"}, {"tags": ["multithreading", "haskell", "ghc"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1547080215, "post_id": 54120390, "comment_id": 95073086, "body": "What version of GHC? In old ones, <code>readMVar</code> is a <code>takeMVar</code> followed by a <code>putMVar</code> (not performed atomically). If the <code>tryTakeMVar</code> and second <code>putMVar</code> happened between those, it would explain the behavior you&#39;re seeing."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547081308, "post_id": 54120390, "comment_id": 95073293, "body": "I believe GHC 8.6.3, though it&#39;s a bit hard to tell when using Stack. Given your clean explanation, however, I&#39;ll try to dig a bit more into which version is being used."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1547081591, "post_id": 54120390, "comment_id": 95073345, "body": "Confirmed that it&#39;s GHC 8.6.3."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1547082775, "post_id": 54120390, "comment_id": 95073542, "body": "Here&#39;s the problem: I&#39;m using strict-concurrency, which doesn&#39;t provide <code>tryReadMVar</code>. As a result, I implemented it myself using <code>tryTakeMVar</code> and <code>putMVar</code> (non-atomically). Thus what Daniel says is spot on."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1547089324, "post_id": 54120390, "comment_id": 95074877, "body": "You should write that up as an answer. That&#39;s good work tracking it down."}], "answers": [{"comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1547573873, "post_id": 54122637, "comment_id": 95235013, "body": "I created an issue <a href=\"https://github.com/ygale/strict-concurrency/issues/2\" rel=\"nofollow noreferrer\">github.com/ygale/strict-concurrency/issues/2</a> with <code>strict-concurrency</code> requesting the addition of <code>tryReadMVar</code> so that other people don&#39;t make the same mistake."}], "tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": false, "score": 5, "last_activity_date": 1547573790, "last_edit_date": 1547573790, "creation_date": 1547099585, "answer_id": 54122637, "question_id": 54120390, "link": "https://stackoverflow.com/questions/54120390/readmvar-doesnt-wake-up-on-putmvar/54122637#54122637", "title": "readMVar doesn&#39;t wake up on putMVar", "body": "<p>I switched my MVar implementation from <code>base</code> to <code>strict-concurrency</code> while trying to debug a space leak. But as the question indicates, my code uses <code>tryReadMVar</code>, which is for some reason not provided by <code>strict-concurrency</code>. Thus, a while back, I implemented <code>tryReadMVar</code> myself like this:</p>\n\n<pre><code>tryReadMVar :: (NFData a) =&gt; MVar a -&gt; IO (Maybe a)\ntryReadMVar m = do\n  mm &lt;- tryTakeMVar m\n  case mm of\n    Nothing -&gt; return ()\n    Just a -&gt; putMVar m a\n  return mm\n</code></pre>\n\n<p>without really considering the implications. I had since forgotton all about doing this. As Daniel pointed out, old versions of <code>base</code> used to do something similar, but newer versions have an atomic <code>tryReadMVar</code> implementation. So even though I was using a new version of GHC, the problem was reintroduced as a result of using <code>strict-concurrency</code>.</p>\n\n<p>Concurrently, the deadlock occurred in the following situation (which Daniel describes):</p>\n\n<ul>\n<li>thread 1 prints \"tick\"</li>\n<li>thread 2 puts the mvar using <code>putMVar</code></li>\n<li>thread 2 prints \"put m0\"</li>\n<li>thread 1 takes the mvar using <code>tryTakeMVar</code> within <code>tryReadMVar</code></li>\n<li>thread 2 takes the mvar using <code>tryTakeMVar</code></li>\n<li>thread2 prints \"take m\"</li>\n<li>thread2 puts the mvar using <code>putMVar</code></li>\n<li>thread2 prints \"put m1\"</li>\n<li>thread 1 deadlocks while trying to <code>putMVar</code> within <code>tryReadMVar</code></li>\n</ul>\n\n<p>Turns out that having an atomic <code>tryReadMVar</code> is useful!</p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1547573790, "creation_date": 1547079848, "question_id": 54120390, "link": "https://stackoverflow.com/questions/54120390/readmvar-doesnt-wake-up-on-putmvar", "title": "readMVar doesn&#39;t wake up on putMVar", "body": "<p>My code seems to be hanging on a <code>readMVar</code> after another thread calls <code>putMVar</code>. I wouldn't expect this to happen, but that's what I'm observing. My main thread creates two new threads, each with access to a shared <code>MVar</code> m.</p>\n\n<p>Thread 1:</p>\n\n<pre><code>do\n  putStrLn \"tick\"\n  x &lt;- readMVar m\n  putStrLn \"tock\"\n</code></pre>\n\n<p>Thread 2:</p>\n\n<pre><code>do\n  putMVar m 0\n  putStrLn \"put m0\"\n  void $ tryTakeMVar m\n  putStrLn \"take m\"\n  putMVar m 1\n  putStrLn \"put m1\"\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>do\n  m &lt;- newEmptyMVar\n  &lt;start thread 1&gt;\n  &lt;start thread 2&gt;\n</code></pre>\n\n<p>In the following scenario, my program hangs:</p>\n\n<p>Two threads have access to a shared MVar <code>m</code>, which is initially empty. Thread 1 blocks on <code>readMVar m</code>. Meanwhile, thread 2 calls <code>putMVar m ...</code>. At this point, thread 1 <em>could</em> proceed, but let's suppose it does not. Thread 2 then calls <code>tryTakeMVar m</code>, which presumably empties a full <code>MVar</code>. Then thread 2 again calls <code>putMVar m ...</code>. This scenario corresponds to the following output:</p>\n\n<pre><code>tick\nput m0\ntake m\nput m1\n&lt;hang&gt;\n</code></pre>\n\n<p>What's going on here? I expect that \"tock\" should print, since thread 2 filled the MVar, but my program just hangs.</p>\n"}]