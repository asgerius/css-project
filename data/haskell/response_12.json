[{"tags": ["haskell", "lint"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427926536, "post_id": 29401753, "comment_id": 46979118, "body": "<a href=\"https://github.com/ndmitchell/hlint#customizing-the-hints\" rel=\"nofollow noreferrer\">This</a> indicates that you can do so with an annotation at the top of your source, or in a hint file that you can pass with the <code>--hint</code> flag."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427926820, "post_id": 29401753, "comment_id": 46979238, "body": "@bheklilr Yes I read that, but it doesn&#39;t indicate how I can specify which hints I want to ignore. I&#39;d specifically like to ignore all the arrow related hints."}], "answers": [{"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1427928771, "post_id": 29402091, "comment_id": 46979931, "body": "Thanks. This is  what I was looking for. But how do you know to use the string &quot;Use &amp;&amp;&amp;&quot; ? I don&#39;t see that string in <a href=\"https://github.com/ndmitchell/hlint/blob/master/data/Default.hs\" rel=\"nofollow noreferrer\">Default.hs</a> anywhere."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1427928813, "post_id": 29402091, "comment_id": 46979948, "body": "@Ana: That confused me too. I think it&#39;s just based on the error message which is produced based on the righthand side of the hint&#39;s definition."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427928814, "post_id": 29402091, "comment_id": 46979949, "body": "I&#39;m not sure where it&#39;s defined, but I figured it out because it says &quot;Warning: Use &amp;&amp;&amp;&quot;."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 6, "last_activity_date": 1513006610, "last_edit_date": 1513006610, "creation_date": 1427928029, "answer_id": 29402091, "question_id": 29401753, "link": "https://stackoverflow.com/questions/29401753/how-to-ignore-hlints-arrow-hints/29402091#29402091", "title": "How to ignore HLint&#39;s arrow hints?", "body": "<p>For example, if you had the code:</p>\n\n<pre><code>map (\\a -&gt; (head a, length a)) someList\n</code></pre>\n\n<p>HLint would print out:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Warning: Use &amp;&amp;&amp;\nFound:\n    \\a -&gt; (head a, length a)\nWhy not:\n    head Control.Arrow.&amp;&amp;&amp; length\n</code></pre>\n\n<p>Then you could ignore this by adding:</p>\n\n<pre><code>{-# ANN module \"HLint: ignore Use &amp;&amp;&amp;\" #-}\n</code></pre>\n\n<p>At the top of your file.  Alternative, you could create a file <code>ana.hlint</code> containing:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ignore \"Use &amp;&amp;&amp;\"\n</code></pre>\n\n<p>Then use <code>hlint</code> as:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&gt; hlint --hint=ana.hlint source_code.hs\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 2, "accepted_answer_id": 29402091, "answer_count": 1, "score": 6, "last_activity_date": 1513006610, "creation_date": 1427926248, "question_id": 29401753, "link": "https://stackoverflow.com/questions/29401753/how-to-ignore-hlints-arrow-hints", "title": "How to ignore HLint&#39;s arrow hints?", "body": "<p>I use <a href=\"http://community.haskell.org/~ndm/hlint/\" rel=\"noreferrer\">HLint</a> on my Haskell code, but not all the warnings/errors are very useful. In particular, the arrow hints because I never use arrows.</p>\n\n<p>How do I get HLint to ignore all the arrow hints?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 6, "creation_date": 1427919930, "post_id": 29400063, "comment_id": 46976096, "body": "It&#39;s time to start using <a href=\"https://wiki.haskell.org/Maybe\" rel=\"nofollow noreferrer\"><code>Maybe</code></a> and pattern matching: <code>(length lst) == 0</code> -&gt; <code>[]</code>"}, {"owner": {"reputation": 838, "user_id": 4739861, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/f306b041723e2ff211ea3a34d69f67b4?s=128&d=identicon&r=PG&f=1", "display_name": "Gilad Baruchian", "link": "https://stackoverflow.com/users/4739861/gilad-baruchian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1427920188, "post_id": 29400063, "comment_id": 46976235, "body": "Thanks for the fast response zerkms but your solution didn&#39;t work for me."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 2, "creation_date": 1427920235, "post_id": 29400063, "comment_id": 46976265, "body": "What&#39;s the point of <code>lookupH1</code>? Why not just define <code>lookup1</code> directly?"}, {"owner": {"reputation": 838, "user_id": 4739861, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/f306b041723e2ff211ea3a34d69f67b4?s=128&d=identicon&r=PG&f=1", "display_name": "Gilad Baruchian", "link": "https://stackoverflow.com/users/4739861/gilad-baruchian"}, "edited": false, "score": 0, "creation_date": 1427920324, "post_id": 29400063, "comment_id": 46976295, "body": "Historical reasons :) i tried sometime different on that start"}, {"owner": {"reputation": 1655, "user_id": 604955, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dee8e0c8c4b36334c2379c62b3e12054?s=128&d=identicon&r=PG", "display_name": "Charles Durham", "link": "https://stackoverflow.com/users/604955/charles-durham"}, "edited": false, "score": 0, "creation_date": 1427935545, "post_id": 29400063, "comment_id": 46981837, "body": "@GiladBaruchian That&#39;s actually good practice, it scopes k at the top level, no reason to recurse and continuously pass k around as it stays static."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 2, "last_activity_date": 1427920443, "creation_date": 1427920443, "answer_id": 29400240, "question_id": 29400063, "link": "https://stackoverflow.com/questions/29400063/how-can-i-return-null-in-haskell/29400240#29400240", "title": "How can i return null in haskell?", "body": "<p><code>null</code> is a function that takes a list and tells you whether or not the list is empty. Since your result is not supposed to be a function, using <code>null</code> as your result is a type error.</p>\n\n<p>There is no such thing as a null pointer or null reference in Haskell. If a function has, say, the result type <code>Char</code> and the function terminates successfully (i.e. it does not loop forever or throw an exception), the result of calling that function will always be a <code>Char</code> value and there is no magical <code>null</code> entity that's somehow a value of every type.</p>\n\n<p>So you have two options: Either you throw an exception when the key is not found or (and this is the better option) you change the result type of your function to <code>Maybe v</code> rather than <code>v</code>.</p>\n\n<p>The type <code>Maybe t</code> in Haskell has two possible values: <code>Just x</code> where <code>x</code> is of type <code>t</code> or <code>Nothing</code>. So for your (Int, Char) list, your lookup function can return <code>Just v</code> when it finds a value for the given key or <code>Nothing</code> when it does not, and the user of your function can then pattern match on the result to find out whether a value was found or not and to get at the value if it was found.</p>\n"}, {"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": false, "score": 2, "last_activity_date": 1427920503, "creation_date": 1427920503, "answer_id": 29400271, "question_id": 29400063, "link": "https://stackoverflow.com/questions/29400063/how-can-i-return-null-in-haskell/29400271#29400271", "title": "How can i return null in haskell?", "body": "<p>Look at the Prelude <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:lookup\" rel=\"nofollow\"><code>lookup</code></a> function: it returns the type <code>Maybe b</code>. Specifically, it returns <code>Just x</code> if <code>x</code> is the value associated with the key, and <code>Nothing</code> if the key isn't found.</p>\n"}, {"tags": [], "owner": {"reputation": 1655, "user_id": 604955, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dee8e0c8c4b36334c2379c62b3e12054?s=128&d=identicon&r=PG", "display_name": "Charles Durham", "link": "https://stackoverflow.com/users/604955/charles-durham"}, "is_accepted": true, "score": 8, "last_activity_date": 1427920835, "creation_date": 1427920835, "answer_id": 29400376, "question_id": 29400063, "link": "https://stackoverflow.com/questions/29400063/how-can-i-return-null-in-haskell/29400376#29400376", "title": "How can i return null in haskell?", "body": "<p>It's usually best to first stub out your types and then let the compiler guide you.</p>\n\n<p>In this case, it looks like the signature you are looking at right now is:</p>\n\n<pre><code>lookup1 :: Int -&gt; [(Int,Char)] -&gt; Char\n</code></pre>\n\n<p>However, Haskell doesn't have a null that can replace the Char as the return type. Therefore, it's common practice to use Maybe instead. The new type signature would then be.</p>\n\n<pre><code>lookup1 :: Int -&gt; [(Int,Char)] -&gt; Maybe Char\n</code></pre>\n\n<p>This would mean that upon finding the value v, you would yield \"Just v\" and in the case where you don't, it would yield \"Nothing\".</p>\n\n<p>I hope I'm not giving away too much, but this is a slightly simpler version of your function using pattern matching.</p>\n\n<pre><code>lookup1 :: Int -&gt; [(Int,Char)] -&gt; Maybe Char                                    \nlookup1 k lst = lookupH1 lst                                                    \n    where                                                                       \n      lookupH1 [] = Nothing                                                     \n      lookupH1 ((k',v):lst')                                                    \n        | k == k' = Just v                                                      \n        | otherwise = lookupH1 lst' \n</code></pre>\n"}], "owner": {"reputation": 838, "user_id": 4739861, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/f306b041723e2ff211ea3a34d69f67b4?s=128&d=identicon&r=PG&f=1", "display_name": "Gilad Baruchian", "link": "https://stackoverflow.com/users/4739861/gilad-baruchian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16358, "favorite_count": 0, "accepted_answer_id": 29400376, "answer_count": 3, "score": 2, "last_activity_date": 1427938367, "creation_date": 1427919870, "last_edit_date": 1427938367, "question_id": 29400063, "link": "https://stackoverflow.com/questions/29400063/how-can-i-return-null-in-haskell", "title": "How can i return null in haskell?", "body": "<p>I want to make a function that recieves a list of pairs (e.g. <code>[(3,'a'),(7,'d'),(1,'c')]</code>) and a key (e.g. <code>3</code>) and returns the value for that key (in this example <code>'a'</code>).</p>\n\n<p>The function I've written works fine if the key exists but if i try to return <code>null</code> when i did not find a key that matches - I get an error.</p>\n\n<p>the function is :</p>\n\n<pre><code>lookup1 k lst = lookupH1 k lst\n    where\n        lookupH1 k lst \n            | ((length lst) == 0) = null   -- this is the problematic line\n            | ((fst (head lst)) == k )= snd (head lst)\n            | otherwise = lookupH1 k (tail (lst))\n</code></pre>\n\n<p>what can I do to solve this?</p>\n"}, {"tags": ["c", "perl", "haskell", "literate-programming", "idris"], "comments": [{"owner": {"reputation": 418, "user_id": 2005842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b441e6cc8e98d4d576d7f269a52273?s=128&d=identicon&r=PG", "display_name": "qunying", "link": "https://stackoverflow.com/users/2005842/qunying"}, "edited": false, "score": 0, "creation_date": 1430847816, "post_id": 29399948, "comment_id": 48234386, "body": "I would not create an answer, as my option is biased. Personally, I&#39;m against any form of literate programming, it makes program maintenance and debugging pretty hard. I would suggest you to look at the other way around, using document tools inside the program. like doxygen for C and <a href=\"http://en.wikipedia.org/wiki/Haddock_(software)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Haddock_(software)</a> for Haskell, etc."}, {"owner": {"reputation": 12629, "user_id": 546871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/p1diY.jpg?s=128&g=1", "display_name": "AdrianHHH", "link": "https://stackoverflow.com/users/546871/adrianhhh"}, "reply_to_user": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1491207298, "post_id": 29399948, "comment_id": 73432206, "body": "@C\u0153ur  This question seems off-topic as it is asking for software recommendations. Your edit was just correcting one spelling mistake. Would you have served Stack Overflow better by voting to close this question?"}, {"owner": {"reputation": 15917, "user_id": 5211833, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Pyme2.jpg?s=128&g=1", "display_name": "Adriaan", "link": "https://stackoverflow.com/users/5211833/adriaan"}, "reply_to_user": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1491207779, "post_id": 29399948, "comment_id": 73432453, "body": "@C\u0153ur to add to what AdrianHHH said: the problem is mainly that this question was bumped to the front page, without significant improvement (I don&#39;t count one spelling correction as significant) and that now this OT question gets renewed attention due to it being on the front page again. I&#39;ve seen you edit questions with insignificant edits like this only to be closed not much later; please take the bumping of a question into account when editing and consider whether close voting wouldn&#39;t be the better option."}, {"owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "reply_to_user": {"reputation": 12629, "user_id": 546871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/p1diY.jpg?s=128&g=1", "display_name": "AdrianHHH", "link": "https://stackoverflow.com/users/546871/adrianhhh"}, "edited": false, "score": 0, "creation_date": 1491214478, "post_id": 29399948, "comment_id": 73436596, "body": "@AdrianHHH I count spelling corrections as significant. It&#39;s good that people vote to close if they figure out it&#39;s off topic: I don&#39;t always notice, but when I do I downvote and vote to close too."}], "answers": [{"tags": [], "owner": {"reputation": 33595, "user_id": 350890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186bebdcf5f3045b53362efe34e56e8a?s=128&d=identicon&r=PG", "display_name": "Peter Tillemans", "link": "https://stackoverflow.com/users/350890/peter-tillemans"}, "is_accepted": false, "score": 1, "last_activity_date": 1430933205, "last_edit_date": 1430933205, "creation_date": 1430846674, "answer_id": 30059459, "question_id": 29399948, "link": "https://stackoverflow.com/questions/29399948/literate-programming-in-multiple-languages/30059459#30059459", "title": "Literate programming in multiple languages", "body": "<p>If documentation is paramount, and you have some emacs affinity, then you might do worse than look at the literate programming support in org-mode. <a href=\"http://orgmode.org/worg/org-contrib/babel/intro.html\" rel=\"nofollow\">Babel</a> is an org-mode extension allowing to integrate with many programming environments, including tangle-weaving compiled languages, executing code blocks, ...</p>\n\n<p>It is thoroughly language agnostic, and since it has the DNA of an outliner, it allows to manage the documentation in a structured way. Of course it generates syntax highlighted HTML/LateX/PDF/... from your sources.</p>\n\n<p>Check out <a href=\"http://orgmode.org/worg/org-contrib/babel/intro.html\" rel=\"nofollow\">http://orgmode.org/worg/org-contrib/babel/intro.html</a> for more info.</p>\n\n<p>a sample:</p>\n\n<pre><code>** Compiles libpq library for iOS\n\ncopy this script as *build-ios.sh* in the root of the postgresql\nsource tree.\n\n#+BEGIN_SRC sh tangle:build-ios.sh\nmkdir -p build\nrm -rf build/* #*/\n\nfunction build_libpq()   \n{\n    make distclean\n\n    ./configure \\\n...snip...\nlipo -create -output libpq.a build/*\n\n#+END_SRC\n\nRun it and it will create a universal library and  separate arm  \nlibrary in the root folder.\n</code></pre>\n\n<p>I hope this gives an idea what to do to create docs/code using org-mode/Bable combination. Of course a stackexchange answer cannot begin to scratch the surface of this system.</p>\n"}], "owner": {"reputation": 4036, "user_id": 667457, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/33f9a9233b25c8230f5b5edb38493842?s=128&d=identicon&r=PG", "display_name": "Jeff Burdges", "link": "https://stackoverflow.com/users/667457/jeff-burdges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 1, "closed_date": 1491308723, "answer_count": 1, "score": 3, "last_activity_date": 1491202669, "creation_date": 1427919400, "last_edit_date": 1491202669, "question_id": 29399948, "link": "https://stackoverflow.com/questions/29399948/literate-programming-in-multiple-languages", "closed_reason": "Not suitable for this site", "title": "Literate programming in multiple languages", "body": "<p>I've a library project which requires C's interoperability with other languages, and reasonable performance, but must be documented very clearly, \u00e0 la literate programming, and whose documentation might benefit from a functional approach, like Haskell, or even <a href=\"http://www.idris-lang.org/\" rel=\"nofollow\">Idris</a>' proof features.  </p>\n\n<p>I'm therefore interested in building this library as a literate program, first writing the documentation and working Idris prototype code, and next writing C code that closely parallels the Idris code to address any performance issues and be easily linkable from other languages.</p>\n\n<p>What literate programming tool do I want?  </p>\n\n<p><a href=\"http://nuweb.sourceforge.net/nuwebdoc.pdf\" rel=\"nofollow\">NuWeb</a> is designed for multi-language literate programming, but their usage of the @ sign, or indeed any escape character, is problematic for functional languages like Idris, Haskell, etc.  </p>\n\n<p>Idris <a href=\"https://github.com/idris-lang/Idris-dev/issues/1736\" rel=\"nofollow\">wants</a> a <a href=\"https://github.com/idris-lang/Idris-dev/wiki/Egg-%236:-Improved-Support-For-Literate-Programming\" rel=\"nofollow\">literate programming tool</a> to which I could contribute.  I love their preferred approach of just using <code>.tex</code> files delimited by <code>\\begin{code} .. \\end{code}</code> blocks.</p>\n\n<p>Idris, Haskell, etc. do not need tangle like C does, so doing that adds complexity and I'd prefer that any tool I'm using here sticks around.</p>\n\n<p>An approach that minimizes tooling for library consumers might be to extract the C and Idris code using a simple Perl script like <code>cat_latex_env</code>:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nsub usage { die \"Usage: cat_latex_env enviroment_name [filename]\\n\"; }\nusage if ($#ARGV &lt; 0);\n\nmy $env = shift;\nmy $begin = quotemeta \"\\\\begin{$env}\";\nmy $end = quotemeta \"\\\\end{$env}\";\nwhile (&lt;&gt;) {\n        if (/$begin/../$end/) {\n                next if /$begin/ || /$end/;\n                print;\n        }\n}\n</code></pre>\n\n<p>At which point the Idris should compile fine.  And I could embed the tangle instructions needed by a literate programming tool for C like CWEB or NuWeb.</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1427912791, "post_id": 29397711, "comment_id": 46972156, "body": "You can use <code>mapAccumWithKey</code> and <code>mapAccumRWithKey</code>. Just ignore the accumulator."}, {"owner": {"reputation": 6725, "user_id": 251630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c354f01e76454d03fffd7a3cebe24d9a?s=128&d=identicon&r=PG", "display_name": "Luke Hoersten", "link": "https://stackoverflow.com/users/251630/luke-hoersten"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427912822, "post_id": 29397711, "comment_id": 46972177, "body": "@Andr&#225;sKov&#225;cs and just have an unused accumulator?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1427912954, "post_id": 29397711, "comment_id": 46972251, "body": "As I understand you want to use <code>traverseWithKey</code> at the type <code>Applicative t =&gt; (Key -&gt; a -&gt; Backwards t b) -&gt; IntMap a -&gt; Backwards t (IntMap b)</code>. The <code>Applicative (Backwards f)</code> instance should be as strict as the <code>Applicative f</code> instance because Backwards is a newtype. And traverseWithKey is the same for lazy and strict maps anyways, so you should have no issues. Note that this won&#39;t traverse the IntMap structure in the opposite order, only the effects of the applicative instance will be composed in the opposite order. You may be looking for <code>mapAccumRWithKey</code>."}, {"owner": {"reputation": 6725, "user_id": 251630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c354f01e76454d03fffd7a3cebe24d9a?s=128&d=identicon&r=PG", "display_name": "Luke Hoersten", "link": "https://stackoverflow.com/users/251630/luke-hoersten"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1427913415, "post_id": 29397711, "comment_id": 46972486, "body": "@user2407038 yeah you&#39;re right. Visiting in the reverse order is a performance optimization that I&#39;m not getting with Backwards. Either way I need to do what you and Andr&#225;s Kov&#225;cs are suggesting. Thanks!"}, {"owner": {"reputation": 6725, "user_id": 251630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c354f01e76454d03fffd7a3cebe24d9a?s=128&d=identicon&r=PG", "display_name": "Luke Hoersten", "link": "https://stackoverflow.com/users/251630/luke-hoersten"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427913469, "post_id": 29397711, "comment_id": 46972526, "body": "@Andr&#225;sKov&#225;cs put your comment as an answer and I&#39;ll mark it answered."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427913970, "post_id": 29397711, "comment_id": 46972817, "body": "BTW, why would you need <code>maprWithKey</code>? Without effects or accumulators the order of mapping is completely irrelevant."}, {"owner": {"reputation": 6725, "user_id": 251630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c354f01e76454d03fffd7a3cebe24d9a?s=128&d=identicon&r=PG", "display_name": "Luke Hoersten", "link": "https://stackoverflow.com/users/251630/luke-hoersten"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427927904, "post_id": 29397711, "comment_id": 46979652, "body": "@Andr&#225;sKov&#225;cs after looking at my code again I forgot to mention a key piece of information: I&#39;m mapping a monadic function which is why I was using traverse in the first place. I&#39;m looking now to see if I can decompose the monads into an accum but it looks messy."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427959798, "post_id": 29397711, "comment_id": 46988907, "body": "@LukeHoersten see my edit in the answer"}], "answers": [{"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1427963967, "last_edit_date": 1427963967, "creation_date": 1427913906, "answer_id": 29398433, "question_id": 29397711, "link": "https://stackoverflow.com/questions/29397711/how-can-data-intmap-strict-be-kept-strict-after-a-traversal/29398433#29398433", "title": "How can Data.IntMap.Strict be kept strict after a traversal?", "body": "<p>You can use <code>mapAccumWithKey</code> and <code>mapAccumRWithKey</code>, without using the accumulator argument. After optimization it's most likely exactly as fast as a <code>mapWithKey</code> function would be.</p>\n\n<p>EDIT: if you're doing monadic traversals, and would like to make the possibly resulting <code>IntMap</code>-s strict, then you can achieve that by returning strict values inside the monadic action.</p>\n\n<pre><code>import Data.IntMap.Strict\nimport Control.Applicative\n\nm :: IntMap Int\nm = fromList $ zip [0..] (replicate 10 0)\n</code></pre>\n\n<p><code>traverse (\\n -&gt; Just (n + 100)) m</code> returns a <code>Just m</code> map that contains <code>n + 100</code> thunks. <code>traverse (\\n -&gt; Just $! n + 100) m</code> returns a map containing evaluated <code>Int</code>-s. Likewise, use <code>return $! x</code> in other monads to get strict results. </p>\n"}], "owner": {"reputation": 6725, "user_id": 251630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c354f01e76454d03fffd7a3cebe24d9a?s=128&d=identicon&r=PG", "display_name": "Luke Hoersten", "link": "https://stackoverflow.com/users/251630/luke-hoersten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 2, "accepted_answer_id": 29398433, "answer_count": 1, "score": 3, "last_activity_date": 1427963967, "creation_date": 1427911468, "last_edit_date": 1427912364, "question_id": 29397711, "link": "https://stackoverflow.com/questions/29397711/how-can-data-intmap-strict-be-kept-strict-after-a-traversal", "title": "How can Data.IntMap.Strict be kept strict after a traversal?", "body": "<p><a href=\"https://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-IntMap-Strict.html\" rel=\"nofollow\">Data.IntMap.Strict docs say</a>:</p>\n\n<blockquote>\n  <p>Be aware that the Functor, Traversable and Data instances are the same\n  as for the Data.IntMap.Lazy module, so if they are used on strict\n  maps, the resulting maps will be lazy.</p>\n</blockquote>\n\n<p>I use <code>IntMap.traverseWithKey</code> (<code>Functor f =&gt; Applicative f</code>) because I want a <code>mapWithKey</code> and a <code>maprWithKey</code> which doesn't exist. Instead I use the <code>Backwards</code> functor on a strict map. How can I keep the map strict after an Applicative use?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 842, "user_id": 4737779, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/009c3f05f9273268e5d530785ef14327?s=128&d=identicon&r=PG&f=1", "display_name": "Beerend Lauwers", "link": "https://stackoverflow.com/users/4737779/beerend-lauwers"}, "edited": false, "score": 0, "creation_date": 1428595177, "post_id": 29399744, "comment_id": 47238508, "body": "I can&#39;t seem to find where this is defined or used in yesod-static or yesod-auth. Here&#39;s the gist of what I&#39;m trying to do:      <code>saveToYesodRoot :: (YesodDataSource a) =&gt; FilePath -&gt; IO ()             saveToYesodRoot file = do      let root = (getAppRoot :: Approot a)      return ()</code>   In short: I&#39;d like to get the application&#39;s root, append a FilePath to it, and write a file to it. Approot is a data type that I&#39;m also not sure how I could convert to an actual file path."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 2, "last_activity_date": 1427918579, "creation_date": 1427918579, "answer_id": 29399744, "question_id": 29395754, "link": "https://stackoverflow.com/questions/29395754/how-do-i-gain-access-to-environment-variables-in-a-subsite-that-is-in-a-separate/29399744#29399744", "title": "How do I gain access to environment variables in a subsite that is in a separate package?", "body": "<p>You can't access the master site's fields without knowing the type of the master site itself, which generally defeats the purpose of having a subsite. Your typical options are:</p>\n\n<ol>\n<li>Make the data you're looking for an explicit argument to the subsite</li>\n<li>Require an extra typeclass constraint that the master site must be an instance of, that gets the data from the master site</li>\n</ol>\n\n<p>yesod-static is a good example of the former approach; yesod-auth an example of the latter.</p>\n"}], "owner": {"reputation": 842, "user_id": 4737779, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/009c3f05f9273268e5d530785ef14327?s=128&d=identicon&r=PG&f=1", "display_name": "Beerend Lauwers", "link": "https://stackoverflow.com/users/4737779/beerend-lauwers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427918579, "creation_date": 1427904835, "last_edit_date": 1427905203, "question_id": 29395754, "link": "https://stackoverflow.com/questions/29395754/how-do-i-gain-access-to-environment-variables-in-a-subsite-that-is-in-a-separate", "title": "How do I gain access to environment variables in a subsite that is in a separate package?", "body": "<p>My Yesod subsite needs to write some files relative to the application's root directory. </p>\n\n<p><a href=\"http://www.yesodweb.com/book/environment-variables\" rel=\"nofollow\">Looking at this</a>, it appears a scaffolded Yesod site already does most of the plumbing, but how can I access this in a subsite that doesn't know about the <code>App</code> record?</p>\n\n<p><code>approot</code> itself is defined in the scaffolded Yesod project using a reference to <code>appSettings</code>, which is <em>also</em> an element of <code>App</code>:</p>\n\n<pre><code>approot = ApprootMaster $ appRoot . appSettings\n</code></pre>\n\n<p>Is there a function that gives me the application root (or at least a valid file path to the root directory) without having to know about the implementation details? Being able to reuse the existing Yesod functionality would be nicest, of course.</p>\n"}, {"tags": ["haskell", "types", "type-variables"], "answers": [{"comments": [{"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427903967, "post_id": 29395476, "comment_id": 46967218, "body": "Why do pattern variable signatures need ScopedTypeVariables though? Was it just not possible until the extension came along? They seem orthogonal in this case because there&#39;s no unification of any type variables, since there is no type variables in the expression."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427904358, "post_id": 29395476, "comment_id": 46967486, "body": "@CMCDragonkai, see my edit. I doubt there&#39;s a very deep reason, but I don&#39;t really know."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427904577, "post_id": 29395476, "comment_id": 46967619, "body": "I see. In your example, is <code>a</code> inferred to be universally quantified? Or is <code>a</code> brought from somewhere else?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427904780, "post_id": 29395476, "comment_id": 46967742, "body": "@CMCDragonkai With the extension, the pattern <code>(x :: a)</code> literally defines <code>a</code> in its scope to be whatever the type of <code>x</code> is."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1427905826, "post_id": 29395476, "comment_id": 46968429, "body": "Actually GHC 6.8.1, which was the first release to have the <code>LANGUAGE</code> pragma system, had both <code>ScopedTypeVariables</code> and <code>PatternSignatures</code>. The latter was removed from the docs in 7.0.1, although you can still supply it and get a deprecation warning telling you to use <code>ScopedTypeVariables</code> instead."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1427953492, "post_id": 29395476, "comment_id": 46986214, "body": "@&#216;rjanJohansen Ah that makes sense. Your comment should be elevated."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1427905052, "last_edit_date": 1592644375, "creation_date": 1427903921, "answer_id": 29395476, "question_id": 29395265, "link": "https://stackoverflow.com/questions/29395265/haskell-scopedtypevariables-needed-in-pattern-matching-type-annotations/29395476#29395476", "title": "Haskell: ScopedTypeVariables needed in pattern matching type annotations", "body": "<p><code>ScopedTypeVariables</code> enables <code>ExplicitForAll</code> automatically For the sake of your sanity I would suggest always using <code>ScopedTypeVariables</code> when using any other type system extensions (except possibly the ones dealing only with classes/instances/contexts) and never using <code>ExplicitForAll</code> directly.</p>\n<p>The reason <code>ScopedTypeVariables</code> is required for pattern variable signatures is just that such signatures are part of the extension. Among other uses, they give you a way to bring a type variable into scope. For example:</p>\n<pre><code>f (Just (x::a)) = bob\n  where\n    bob::[a]\n    bob = [x]\n</code></pre>\n<p>I do not know why the pattern signatures are part of <code>ScopedTypeVariables</code>, per se; most likely they were created for this purpose, and all the code was written in one go. Teasing them apart to make orthogonal extensions was almost certainly considered more trouble than it was worth.</p>\n<h3>Edit</h3>\n<p>Actually, there's a pretty good reason. With the exception of pattern bindings, a type variable in a pattern signature is generalized, bringing that variable into scope. So in the above example, you don't need to know if there is an <code>a</code> in the outer type environment. If you could enable pattern signatures without scoped type variables, then the variable could be generalized or not depending on whether scoped type variables were turned on or not. The same sort of confusion happens for <code>ExplicitForAll</code> without <code>ScopedTypeVariables</code>, which is why I'd like to kill that extension and make <code>ScopedTypeVariables</code> the default, or at least turn it on automatically with the extensions that currently enable <code>ExplicitForAll</code>.</p>\n"}], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 29395476, "answer_count": 1, "score": 3, "last_activity_date": 1427938461, "creation_date": 1427903310, "last_edit_date": 1427938461, "question_id": 29395265, "link": "https://stackoverflow.com/questions/29395265/haskell-scopedtypevariables-needed-in-pattern-matching-type-annotations", "title": "Haskell: ScopedTypeVariables needed in pattern matching type annotations", "body": "<p>Why does this code require the <code>ScopedTypeVariables</code> extension?</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nchar = case Just '3' of \n    Just (x :: Char) -&gt; x\n    Nothing          -&gt; '?'\n</code></pre>\n\n<p>When I read the documentation on <code>ScopedTypeVariables</code>, it seems to mean unifying type variables in the function body with the parent function signature. This code snippet isn't unifying any type variables though!</p>\n\n<p>Also what is the effect of loading <code>ScopedTypeVariables</code> without also loading <code>ExplicitForAll</code>? All the other usecases of <code>ScopedTypeVariables</code> seem to require <code>ExplicitForAll</code> to actually work. But in the above snippet, there's no <code>ExplicitForAll</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "edited": false, "score": 2, "creation_date": 1427904894, "post_id": 29393893, "comment_id": 46967819, "body": "Can you add an example where you would like to use such a thing? I think that <code>Num a =&gt; a</code> as return type might be a lot less useful than you expect."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1427908889, "post_id": 29393893, "comment_id": 46970046, "body": "Type synonyms and associated type families (and non-associated type families as well) behave the same in many instances but are actually different beasts. A type synonym essentially just performs syntactic substitution. The type checker is not aware of your type synonyms. A type family application may require information about surrounding types to resolve, so the type checker must deal with them. As for fixing this error, define <code>newtype X = X (forall a.Num a =&gt; a)</code> and <code>type Ed D = X</code>."}], "owner": {"reputation": 183, "user_id": 4359207, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/076f53042189861ffbc8d7efa00c3825?s=128&d=identicon&r=PG&f=1", "display_name": "Mossid", "link": "https://stackoverflow.com/users/4359207/mossid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 2, "answer_count": 0, "score": 7, "last_activity_date": 1427929526, "creation_date": 1427899612, "last_edit_date": 1427929526, "question_id": 29393893, "link": "https://stackoverflow.com/questions/29393893/using-polymorphic-type-in-type-family-in-haskell", "title": "Using polymorphic type in type family in haskell", "body": "<p>I'm learning about type family, but it's so confusing. When I define a polymorphic type outside of class definition, it works well.</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\ntype T = Num a =&gt; a\n</code></pre>\n\n<p>But when polymorphic type defined inside of class definition, </p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE Rank2Types #-}\n\ndata D = D\n\nclass A a where\n    type T a :: *\ninstance A D where\n    type T D = Num a =&gt; a \n</code></pre>\n\n<p>then complier shows error :</p>\n\n<pre><code>Illegal polymorphic or qualified type: forall a. Num a =&gt; a\nIn the type instance declaration for 'T'\nIn the instance declaration for 'A D'\n</code></pre>\n\n<p>Is there a way to make a function in class whose return type is polymorphic, like as 3(Num a => a)?</p>\n"}, {"tags": ["haskell", "profiling", "singly-linked-list", "space-complexity"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user395760"}, "edited": false, "score": 2, "creation_date": 1427898674, "post_id": 29393412, "comment_id": 46963640, "body": "My only guess would be: The intermediate <code>Int</code>s aren&#39;t optimized away, so <code>fTails</code> also makes O(n^2) allocations for those. One would have to look at the core to check that (I don&#39;t have a ghc at hand)."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427899013, "post_id": 29393412, "comment_id": 46963882, "body": "You should probably force the list (<code>print $ sum intRange</code>) before running either <code>fInits</code> or <code>fTails</code>."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1427899153, "post_id": 29393412, "comment_id": 46963994, "body": "@delnan Thanks. I&#39;m not use to inspecting core, yet, but I&#39;ll look into it."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427899205, "post_id": 29393412, "comment_id": 46964034, "body": "@Cirdec Done. No changes."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427899399, "post_id": 29393412, "comment_id": 46964199, "body": "For me inits allocates 2500 times as much memory as tails."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427899503, "post_id": 29393412, "comment_id": 46964282, "body": "@Andr&#225;sKov&#225;cs <code>(\u0ca0_\u0cb0) ?</code> Are you using the same benchmark as me? Which version of GHC are you using? I&#39;ve got GHC 7.10.1."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427899597, "post_id": 29393412, "comment_id": 46964362, "body": "@Jubobs GHC 7.10.1 here, but I used <code>+RTS -s</code> instead of the profiler."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427899597, "post_id": 29393412, "comment_id": 46964363, "body": "With windows GHC 7.8.3 I have <code>100.0%</code> allocation in <code>fInits</code> and <code>91.7%</code> of time spent in <code>fInits</code> (<code>+RTS -p</code>, same compiler options)."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 3, "creation_date": 1427899808, "post_id": 29393412, "comment_id": 46964491, "body": "Ignore my GHC 7.8.3 results (and anyone elses). GHC <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9345\" rel=\"nofollow noreferrer\">7.8.3 has a bug where inits is very slow</a>. It was fixed in 7.8.4."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427900608, "post_id": 29393412, "comment_id": 46965078, "body": "@Andr&#225;sKov&#225;cs Where do you see a per-function breakdown in the output of <code>.&#47;Main +RTS -s</code>? What do you get if you use <code>+RTS -p</code>?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427900902, "post_id": 29393412, "comment_id": 46965300, "body": "@Jubobs I just comment one or the other out when using <code>+RTS -s</code>. With <code>RTS -p</code> I got results similar to yours."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427901145, "post_id": 29393412, "comment_id": 46965454, "body": "@Andr&#225;sKov&#225;cs Thanks for clarifying. Do you have an explanation?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427901517, "post_id": 29393412, "comment_id": 46965697, "body": "Nothing besides &quot;the profiler is acting up&quot;. I looked at the Core and it&#39;s got nothing funny going on; it just calls <code>inits</code> and <code>tails</code> and sums."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427901631, "post_id": 29393412, "comment_id": 46965787, "body": "@Andr&#225;sKov&#225;cs Thanks. I just wanted confirmation that &quot;something is afoot&quot; and that I&#39;m not completely crazy."}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1429106594, "post_id": 29642956, "comment_id": 47444550, "body": "Very comprehensive answer. Thanks."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1539007833, "last_edit_date": 1539007833, "creation_date": 1429079055, "answer_id": 29642956, "question_id": 29393412, "link": "https://stackoverflow.com/questions/29393412/what-are-the-space-complexities-of-inits-and-tails/29642956#29642956", "title": "What are the space complexities of inits and tails?", "body": "<p>The implementation of <code>inits</code> in the Haskell Report, which is identical to or nearly identical to implementations used up to base 4.7.0.1 (GHC 7.8.3) is horribly slow. In particular, the <code>fmap</code> applications stack up recursively, so forcing successive elements of the result gets slower and slower.</p>\n\n<pre><code>inits [1,2,3,4] = [] : fmap (1:) (inits [2,3,4])\n = [] : fmap (1:) ([] : fmap (2:) (inits [3,4]))\n = [] : [1] : fmap (1:) (fmap (2:) ([] : fmap (3:) (inits [4])))\n....\n</code></pre>\n\n<p>The simplest asymptotically optimal implementation, explored by Bertram Felgenhauer, is based on applying <code>take</code> with successively larger arguments:</p>\n\n<pre><code>inits xs = [] : go (1 :: Int) xs where\n  go !l (_:ls) = take l xs : go (l+1) ls\n  go _  []     = []\n</code></pre>\n\n<p>Felgenhauer was able to eke some extra performance out of this using a private, non-fusing version of <code>take</code>, but it was still not as fast as it could be.</p>\n\n<p>The following very simple implementation is significantly faster in most cases:</p>\n\n<pre><code>inits = map reverse . scanl (flip (:)) []\n</code></pre>\n\n<p>In some weird corner cases (like <code>map head . inits</code>), this simple implementation is asymptotically non-optimal. I therefore wrote a version using the same technique, but based on Chris Okasaki's Banker's queues, that is both asymptotically optimal and nearly as fast. Joachim Breitner optimized it further, primarily by using a strict <code>scanl'</code> rather than the usual <code>scanl</code>, and this implementation got into GHC 7.8.4. <code>inits</code> can now produce the spine of the result in O(n) time; forcing the entire result requires O(n^2) time because none of the conses can be shared among the different initial segments. If you want really absurdly fast <code>inits</code> and <code>tails</code>, your best bet is to use <code>Data.Sequence</code>; Louis Wasserman's implementation <a href=\"https://stackoverflow.com/questions/28906742/how-do-inits-and-tails-work-in-data-sequence\">is magical</a>. Another possibility would be to use <code>Data.Vector</code>&mdash;it presumably uses slicing for such things.</p>\n"}], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 29642956, "answer_count": 1, "score": 4, "last_activity_date": 1539007833, "creation_date": 1427898358, "last_edit_date": 1429035210, "question_id": 29393412, "link": "https://stackoverflow.com/questions/29393412/what-are-the-space-complexities-of-inits-and-tails", "title": "What are the space complexities of inits and tails?", "body": "<h2>TL; DR</h2>\n\n<p>After reading the passage about <em>persistence</em> in Okasaki's <em>Purely Functional Data Structures</em> and going over his illustrative examples about singly linked lists (which is how Haskell's lists are implemented), I was left wondering about the space complexities of <code>Data.List</code>'s <code>inits</code> and <code>tails</code>...</p>\n\n<p>It seems to me that</p>\n\n<ul>\n<li>the space complexity of <code>tails</code> is <strong>linear</strong> in the length of its argument, and</li>\n<li>the space complexity of <code>inits</code> is <strong>quadratic</strong> in the length of its argument,</li>\n</ul>\n\n<p>but a simple benchmark indicates otherwise.</p>\n\n<h2>Rationale</h2>\n\n<p>With <code>tails</code>, the original list can be shared. Computing <code>tails xs</code> simply consists in walking along list <code>xs</code> and creating a new pointer to each element of that list; no need to recreate part of <code>xs</code> in memory.</p>\n\n<p>In contrast, because each element of <code>inits xs</code> \"ends in a different way\", there can be no such sharing, and all the possible prefixes of <code>xs</code> must be recreated from scratch in memory.</p>\n\n<h2>Benchmark</h2>\n\n<p>The simple benchmark below shows there isn't much of a difference in memory allocation between the two functions:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- Main.hs\n\nimport Data.List (inits, tails)\n\nmain = do\n    let intRange = [1 .. 10 ^ 4] :: [Int]\n    print $ sum intRange\n    print $ fInits intRange\n    print $ fTails intRange\n\nfInits :: [Int] -&gt; Int\nfInits = sum . map sum . inits\n\nfTails :: [Int] -&gt; Int\nfTails = sum . map sum . tails\n</code></pre>\n\n<p>After compiling my <code>Main.hs</code> file with</p>\n\n<pre><code>ghc -prof -fprof-auto -O2 -rtsopts Main.hs\n</code></pre>\n\n<p>and running</p>\n\n<pre><code>./Main +RTS -p\n</code></pre>\n\n<p>the <code>Main.prof</code> file reports the following:</p>\n\n<pre><code>COST CENTRE MODULE  %time %alloc\n\nfInits      Main     60.1   64.9\nfTails      Main     39.9   35.0\n</code></pre>\n\n<p>The memory allocated for <code>fInits</code> and that allocated for <code>fTails</code> have the same order of magnitude... Hum...</p>\n\n<h2>What is going on?</h2>\n\n<ul>\n<li>Are my conclusions about the space complexities of <code>tails</code> (linear) and <code>inits</code> (quadratic) correct?</li>\n<li>If so, why does GHC allocate roughly as much memory for <code>fInits</code> and <code>fTails</code>? Does <em>list fusion</em> have something to do with this?</li>\n<li>Or is my benchmark flawed? </li>\n</ul>\n"}, {"tags": ["haskell", "cabal", "yesod"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1427892817, "post_id": 29391155, "comment_id": 46959728, "body": "it&#39;s been a while but if you just init a sandbox where you scaffolded your site (<code>cabal sandbox init --sandbox=[path to yesod-sandbox]</code>) it should work (although it will install additional packages back to it) - alternatively I think it will also work if you just init a new sandbox (<code>cabal sandbox init</code> with <code>cabal install --dependencies-only</code>) but then you will get all the packages yet again"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1427893024, "post_id": 29391155, "comment_id": 46959866, "body": "I just found that someone even made a script (using stackage): <a href=\"https://gist.github.com/krdlab/712defa9304069af583d\" rel=\"nofollow noreferrer\">gist.github.com/krdlab/712defa9304069af583d</a> :D"}, {"owner": {"reputation": 842, "user_id": 4737779, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/009c3f05f9273268e5d530785ef14327?s=128&d=identicon&r=PG&f=1", "display_name": "Beerend Lauwers", "link": "https://stackoverflow.com/users/4737779/beerend-lauwers"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427898188, "post_id": 29391155, "comment_id": 46963288, "body": "Thanks @CarstenK&#246;nig, that works! I&#39;ll be limited to a single Yesod instance to test, but I don&#39;t think that will be an issue."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428342226, "post_id": 29391155, "comment_id": 47113804, "body": "@CarstenK&#246;nig since your comment resolved the question, do you mind posting it as an answer to remove this question from the unanswered queue?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1428348197, "post_id": 29391155, "comment_id": 47116902, "body": "@sclv ok - thanks for the reminder - sometimes it&#39;s hard to tell"}], "answers": [{"comments": [{"owner": {"reputation": 842, "user_id": 4737779, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/009c3f05f9273268e5d530785ef14327?s=128&d=identicon&r=PG&f=1", "display_name": "Beerend Lauwers", "link": "https://stackoverflow.com/users/4737779/beerend-lauwers"}, "edited": false, "score": 0, "creation_date": 1428488507, "post_id": 29478184, "comment_id": 47179679, "body": "It&#39;s the <code>--bare</code> flag that made Yesod use the local sandbox (at least for me)."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1428348464, "creation_date": 1428348464, "answer_id": 29478184, "question_id": 29391155, "link": "https://stackoverflow.com/questions/29391155/how-can-i-run-a-scaffolded-yesod-website-in-a-cabal-sandbox/29478184#29478184", "title": "How can I run a scaffolded Yesod website in a cabal sandbox?", "body": "<p>This should work:</p>\n\n<h3>just init a sandbox where you scaffolded your site</h3>\n\n<pre><code>cabal sandbox init --sandbox=[path to yesod-sandbox]\n</code></pre>\n\n<h3>or alternatively just init a new sandbox</h3>\n\n<pre><code>cabal sandbox init \ncabal install --dependencies-only\n</code></pre>\n\n<h3>script</h3>\n\n<p>there is even a script <a href=\"https://gist.github.com/krdlab/712defa9304069af583d\" rel=\"nofollow\">written by KrdLab</a> that automates this using <strong>stackage</strong>:</p>\n\n<pre><code>wget http://www.stackage.org/lts/cabal.config\ncabal update\ncabal sandbox init\ncabal install alex happy yesod-bin\nexport PATH=./.cabal-sandbox/bin:$PATH\nyesod init --bare\ncabal install -j --enable-tests --max-backjumps=-1 --reorder-goals\nyesod devel\n</code></pre>\n"}], "owner": {"reputation": 842, "user_id": 4737779, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/009c3f05f9273268e5d530785ef14327?s=128&d=identicon&r=PG&f=1", "display_name": "Beerend Lauwers", "link": "https://stackoverflow.com/users/4737779/beerend-lauwers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 29478184, "answer_count": 1, "score": 3, "last_activity_date": 1428348464, "creation_date": 1427892173, "question_id": 29391155, "link": "https://stackoverflow.com/questions/29391155/how-can-i-run-a-scaffolded-yesod-website-in-a-cabal-sandbox", "title": "How can I run a scaffolded Yesod website in a cabal sandbox?", "body": "<p>Let's say I have a cabal sandbox at folder <code>root</code> and I've installed the yesod packages in it. Then, I do:</p>\n\n<pre><code>root&gt; yesod init\n</code></pre>\n\n<p>I go through the prompts and end up with a folder <code>project</code> inside <code>root</code>.</p>\n\n<p><code>yesod devel</code> doesn't appear to support passing sandbox arguments to it, so any packages I install in the sandbox are not visible to the scaffolded Yesod site (and I don't want to install everything in the global space, because that's impossible to manage and replicate).</p>\n\n<p>I've tried <a href=\"http://blog.pangyanhan.com/haskell/2013-11-31-using-cabal-sandbox-libraries.html\" rel=\"nofollow\">the suggestion here</a>, but that gives me these errors:</p>\n\n<pre><code>root&gt; runhaskell -no-user-package-db -package-db=.cabal-sandbox\\x86_64-windows-ghc-7.8.4-packages.conf.d project/app/main.hs\n\nproject\\app\\main.hs:2:8:\n  Could not find module `Application'\n  Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>Running it inside <code>root/project</code>:</p>\n\n<pre><code>root/project&gt; runhaskell -no-user-package-db -package-db=../.cabal-sandbox\\x86_64-windows-ghc-7.8.4-packages.conf.d app/main.hs\n\nFoundation.hs:6:8:\n  Could not find module `Text.Jasmine'\n  Use -v to see a list of the files searched for.\n\nSettings.hs:8:8:\n  Could not find module `ClassyPrelude.Yesod'\n  Use -v to see a list of the files searched for.\n\nSettings.hs:14:8:\n  Could not find module `Database.Persist.Sqlite'\n  Perhaps you meant\n    Database.Persist.Sql (from persistent-2.1.2)\n    Database.Persist.Sql.Util (from persistent-2.1.2)\n    Database.Persist.Class (from persistent-2.1.2)\n  Use -v to see a list of the files searched for.\n\nSettings\\StaticFiles.hs:4:8:\n  Could not find module `Yesod.Static'\n  Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>Does anyone know of a flag I can set or something?</p>\n"}, {"tags": ["haskell", "automatic-differentiation"], "comments": [{"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1427892122, "post_id": 29391114, "comment_id": 46959283, "body": "I am not sure if I have actually asked this question yesterday already. I thought I did ... but it doesn&#39;t appear in my newest questions ..."}], "answers": [{"comments": [{"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 1, "creation_date": 1427906447, "post_id": 29393417, "comment_id": 46968815, "body": "Great writeup. I just wanted to complain that this should be obvious from the <code>ad</code> documentation ... just to find it right there on github. Now I feel stupid :)"}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1438880771, "post_id": 29393417, "comment_id": 51642951, "body": "what does the <code>~</code> do in the signature of <code>go</code> ?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1438883260, "post_id": 29393417, "comment_id": 51644152, "body": "<code>~</code> is type equality. It says the <code>Scalar</code> of <code>t</code> must be the same type as the <code>a</code>s held in the original <code>Mat a</code>s."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 7, "last_activity_date": 1427898376, "creation_date": 1427898376, "answer_id": 29393417, "question_id": 29391114, "link": "https://stackoverflow.com/questions/29391114/how-to-do-automatic-differentiation-on-complex-datatypes/29393417#29393417", "title": "How to do automatic differentiation on complex datatypes?", "body": "<p>The <a href=\"http://haddocks.fpcomplete.com/fp/7.8/20140916-162/ad/Numeric-AD-Newton.html#v:gradientDescent\"><code>gradientDescent</code></a> function from <a href=\"https://hackage.haskell.org/package/ad\"><code>ad</code></a> has the type</p>\n\n<pre><code>gradientDescent :: (Traversable f, Fractional a, Ord a) =&gt;\n                   (forall s. Reifies s Tape =&gt; f (Reverse s a) -&gt; Reverse s a) -&gt;\n                   f a -&gt; [f a]\n</code></pre>\n\n<p>Its first argument requires a function of the type <code>f r -&gt; r</code> where <code>r</code> is <code>forall s. (Reverse s a)</code>. <code>go</code> has the type <code>[a] -&gt; a</code> where <code>a</code> is the type bound in the signature of <code>diffTest</code>. These <code>a</code>s are the same, but <code>Reverse s a</code> isn't the same as <code>a</code>.</p>\n\n<p>The <a href=\"https://hackage.haskell.org/package/ad-4.2.1.1/docs/Numeric-AD-Mode-Reverse.html#t:Reverse\"><code>Reverse</code></a> type has instances for a number of type classes that could allow us to convert an <code>a</code> into a <code>Reverse s a</code> or back. The most obvious is <code>Fractional a =&gt; Fractional (Reverse s a)</code> which would allow us to convert <code>a</code>s into <code>Reverse s a</code>s with <code>realToFrac</code>.</p>\n\n<p>To do so, we'll need to be able to map a function <code>a -&gt; b</code> over a <code>Mat a</code> to obtain a <code>Mat b</code>. The easiest way to do this will be to derive a <code>Functor</code> instance for <code>Mat</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\nnewtype Mat a = Mat { unMat :: V.Vector a }\n    deriving Functor\n</code></pre>\n\n<p>We can convert the <code>m</code> and <code>fs</code> into any <code>Fractional a' =&gt; Mat a'</code> with <code>fmap realToFrac</code>.</p>\n\n<pre><code>diffTest m fs as0 = gradientDescent go as0\n  where go xs = eq3' (fmap realToFrac m) xs (fmap (fmap realToFrac) fs)\n</code></pre>\n\n<p>But there's a better way hiding in the ad package. The <code>Reverse s a</code> is universally qualified over all <code>s</code> but the <code>a</code> is the same <code>a</code> as the one bound in the type signature for <code>diffTest</code>. We really only need a function <code>a -&gt; (forall s. Reverse s a)</code>. This function is <a href=\"https://hackage.haskell.org/package/ad-4.2.1.1/docs/Numeric-AD-Mode.html#v:auto\"><code>auto</code></a> from the <code>Mode</code> class, for which <code>Reverse s a</code> has an instance. <code>auto</code> has the slightly wierd type <code>Mode t =&gt; Scalar t -&gt; t</code> but <code>type Scalar (Reverse s a) = a</code>. Specialized for <code>Reverse</code> <code>auto</code> has the type</p>\n\n<pre><code>auto :: (Reifies s Tape, Num a) =&gt; a -&gt; Reverse s a\n</code></pre>\n\n<p>This allows us to convert our <code>Mat a</code>s into <code>Mat (Reverse s a)</code>s without messing around with conversions to and from <code>Rational</code>.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeFamilies #-}\n\ndiffTest :: forall a . (Fractional a, Ord a) =&gt; Mat a -&gt; [Mat a] -&gt; [a] -&gt; [[a]]\ndiffTest m fs as0 = gradientDescent go as0\n  where\n    go :: forall t. (Scalar t ~ a, Mode t) =&gt; [t] -&gt; t\n    go xs = eq3' (fmap auto m) xs (fmap (fmap auto) fs)\n</code></pre>\n"}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 3, "accepted_answer_id": 29393417, "answer_count": 1, "score": 4, "last_activity_date": 1427898376, "creation_date": 1427892063, "last_edit_date": 1427897143, "question_id": 29391114, "link": "https://stackoverflow.com/questions/29391114/how-to-do-automatic-differentiation-on-complex-datatypes", "title": "How to do automatic differentiation on complex datatypes?", "body": "<p>Given a very simple Matrix definition based on Vector:</p>\n\n<pre><code>import Numeric.AD\nimport qualified Data.Vector as V\n\nnewtype Mat a = Mat { unMat :: V.Vector a }\n\nscale' f = Mat . V.map (*f) . unMat\nadd' a b = Mat $ V.zipWith (+) (unMat a) (unMat b)\nsub' a b = Mat $ V.zipWith (-) (unMat a) (unMat b)\nmul' a b = Mat $ V.zipWith (*) (unMat a) (unMat b)\npow' a e = Mat $ V.map (^e) (unMat a)\n\nsumElems' :: Num a =&gt; Mat a -&gt; a\nsumElems' = V.sum . unMat\n</code></pre>\n\n<p>(for demonstration purposes ... I am using hmatrix but thought the problem was there somehow)</p>\n\n<p>And an error function (<code>eq3</code>):</p>\n\n<pre><code>eq1' :: Num a =&gt; [a] -&gt; [Mat a] -&gt; Mat a\neq1' as \u03c6s = foldl1 add' $ zipWith scale' as \u03c6s\n\neq3' :: Num a =&gt; Mat a -&gt; [a] -&gt; [Mat a] -&gt; a\neq3' img as \u03c6s = negate $ sumElems' (errImg `pow'` (2::Int))\n  where errImg = img `sub'` (eq1' as \u03c6s)\n</code></pre>\n\n<p>Why the compiler not able to deduce the right types in this?</p>\n\n<pre><code>diffTest :: forall a . (Fractional a, Ord a) =&gt; Mat a -&gt; [Mat a] -&gt; [a] -&gt; [[a]]\ndiffTest m \u03c6s as0 = gradientDescent go as0\n  where go xs = eq3' m xs \u03c6s\n</code></pre>\n\n<p>The exact error message is this:</p>\n\n<pre><code>src/Stuff.hs:59:37:\n    Could not deduce (a ~ Numeric.AD.Internal.Reverse.Reverse s a)\n    from the context (Fractional a, Ord a)\n      bound by the type signature for\n                 diffTest :: (Fractional a, Ord a) =&gt;\n                             Mat a -&gt; [Mat a] -&gt; [a] -&gt; [[a]]\n      at src/Stuff.hs:58:13-69\n    or from (reflection-1.5.1.2:Data.Reflection.Reifies\n               s Numeric.AD.Internal.Reverse.Tape)\n      bound by a type expected by the context:\n                 reflection-1.5.1.2:Data.Reflection.Reifies\n                   s Numeric.AD.Internal.Reverse.Tape =&gt;\n                 [Numeric.AD.Internal.Reverse.Reverse s a]\n                 -&gt; Numeric.AD.Internal.Reverse.Reverse s a\n      at src/Stuff.hs:59:21-42\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for\n            diffTest :: (Fractional a, Ord a) =&gt;\n                        Mat a -&gt; [Mat a] -&gt; [a] -&gt; [[a]]\n          at src//Stuff.hs:58:13\n    Expected type: [Numeric.AD.Internal.Reverse.Reverse s a]\n                   -&gt; Numeric.AD.Internal.Reverse.Reverse s a\n      Actual type: [a] -&gt; a\n    Relevant bindings include\n      go :: [a] -&gt; a (bound at src/Stuff.hs:60:9)\n      as0 :: [a] (bound at src/Stuff.hs:59:15)\n      \u03c6s :: [Mat a] (bound at src/Stuff.hs:59:12)\n      m :: Mat a (bound at src/Stuff.hs:59:10)\n      diffTest :: Mat a -&gt; [Mat a] -&gt; [a] -&gt; [[a]]\n        (bound at src/Stuff.hs:59:1)\n    In the first argument of \u2018gradientDescent\u2019, namely \u2018go\u2019\n    In the expression: gradientDescent go as0\n</code></pre>\n"}, {"tags": ["haskell", "haskeline"], "comments": [{"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 0, "creation_date": 1427894084, "post_id": 29390884, "comment_id": 46960587, "body": "It is indeed weird. I think that it has something to do with the fact that the record updates needs to disambiguate the type before being able to check if the updates are correct or not. Here you can find a <a href=\"http://coliru.stacked-crooked.com/a/b1ea39172157a686\" rel=\"nofollow noreferrer\">SSCCE</a> for a more general example."}], "answers": [{"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 6, "last_activity_date": 1427895805, "creation_date": 1427895805, "answer_id": 29392412, "question_id": 29390884, "link": "https://stackoverflow.com/questions/29390884/ambiguous-type-variable-with-haskeline-auto-completion/29392412#29392412", "title": "Ambiguous type variable with Haskeline auto-completion", "body": "<p>A quick fix:</p>\n\n<pre><code>mySettings :: Settings IO\nmySettings = (defaultSettings :: Settings IO)\n  {  historyFile = Just \"myhist\"\n   , complete    = completeWord Nothing \" \\t\" $ return . search } \n</code></pre>\n\n<p>The problem is a really rare corner case, so it's no wonder that the above solution may seem arbitrary or inscrutable. I try to explain it nevertheless.</p>\n\n<p><code>defaultSettings</code> has type <code>MonadIO m =&gt; Settings m</code>. It's a <em>polymorphic value</em>, and such values often cause hiccups in the type inference. Generally, we can only do computation (pattern matching, field projections, etc.) on polymorphic values if GHC can infer the polymorphic parameter from the context. <code>Settings m</code> might have completely different content depending on the exact <code>m</code> and the exact type class methods that belong to <code>m</code>. </p>\n\n<p>Now, the issue with <code>Settings</code> is that the <code>m</code> parameter is only present in the <code>complete</code> field, which has type <code>CompletionFunc m</code>. But in our example we <em>ignore</em> the old <code>complete</code> field, and just replace it with a new field. Therefore, as far as GHC knows, the old <code>complete</code> field could have been of <em>any</em> type whatsoever. And since the old <code>complete</code> field is the only source from which we could possibly gain information about the <code>m</code> parameter of <code>defaultSettings</code>, and we left it fully unconstrained, GHC can't infer that that <code>m</code> is a <code>MonadIO</code>. </p>\n\n<p>If we add <code>(defaultSettings :: Settings IO)</code>, then the old <code>m</code> parameter is instantiated to <code>IO</code> and there's no issue anymore. Note that the <em>new</em> <code>m</code> parameter is completely unrelated to the old <code>m</code> parameter, because we just ignored the old <code>complete</code> field and replaced it with the new function. The new <code>m</code> parameter is determined to be <code>IO</code> by the top-level <code>mySettings :: Settings IO</code> annotation. </p>\n\n<p>In fact, we could instantiate <code>defaultSettings</code> with any <code>MonadIO</code> type, and the result would be the same. Again, this is because we ignore the old value of <code>complete</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 1576064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47c868b652ffdc287498a8c604a30013?s=128&d=identicon&r=PG", "display_name": "Lubom&#237;r Sedl&#225;\u0159", "link": "https://stackoverflow.com/users/1576064/lubom%c3%adr-sedl%c3%a1%c5%99"}, "is_accepted": false, "score": 3, "last_activity_date": 1427901380, "creation_date": 1427901380, "answer_id": 29394596, "question_id": 29390884, "link": "https://stackoverflow.com/questions/29390884/ambiguous-type-variable-with-haskeline-auto-completion/29394596#29394596", "title": "Ambiguous type variable with Haskeline auto-completion", "body": "<p>The type of <code>Settings</code> is a bit too much polymorphic. Note that <em>haskeline</em> authors were aware of this possible problem and provided a <a href=\"http://hackage.haskell.org/package/haskeline-0.7.2.1/docs/System-Console-Haskeline.html#v:setComplete\" rel=\"nofollow\">a <code>setComplete</code> function</a> to avoid this particular problem. Specifying the type manually is also an option as other answers show.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 29392412, "answer_count": 2, "score": 5, "last_activity_date": 1427901380, "creation_date": 1427891314, "question_id": 29390884, "link": "https://stackoverflow.com/questions/29390884/ambiguous-type-variable-with-haskeline-auto-completion", "title": "Ambiguous type variable with Haskeline auto-completion", "body": "<p>I'm trying to implement an autocompletion function with <strong>Haskeline</strong> :</p>\n\n<pre><code>import System.Console.Haskeline\nimport System.Console.Haskeline.IO\nimport Data.List\n\nmySettings :: Settings IO\nmySettings = defaultSettings {\n                                historyFile = Just \"myhist\"\n                              , complete = completeWord Nothing \" \\t\" $ return . search\n                              }\n\nkeywords :: [String]\nkeywords = [\"Point\",\"Line\",\"Circle\",\"Sphere\"]\n\nsearch :: String -&gt; [Completion]\nsearch str = map simpleCompletion $ filter (str `isPrefixOf`) keywords\n\nmain :: IO ()\nmain = do\n        inputLine &lt;- initializeInput mySettings\n        putStrLn \"done\"\n</code></pre>\n\n<p>but I am a bit disappointed by this GHC error : </p>\n\n<pre><code>Ambiguous type variable `t0' in the constraint:\n  (Control.Monad.IO.Class.MonadIO t0)\n    arising from a use of `defaultSettings'\nProbable fix: add a type signature that fixes these type variable(s)\n</code></pre>\n\n<p>I set the type for each function but it didn't solve the problem. </p>\n\n<p>Do you have an idea where does this type ambiguity come from and how to remove it?</p>\n"}, {"tags": ["haskell", "yesod", "template-haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1427886377, "post_id": 29389064, "comment_id": 46955668, "body": "If you&#39;re sure that it&#39;s a bug in Yesod, try to create a minimal example and post an issue on <a href=\"https://github.com/yesodweb/yesod/issues\" rel=\"nofollow noreferrer\">github</a>."}], "answers": [{"tags": [], "owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "is_accepted": true, "score": 6, "last_activity_date": 1427886468, "creation_date": 1427886468, "answer_id": 29389188, "question_id": 29389064, "link": "https://stackoverflow.com/questions/29389064/yesods-th-generates-incorrect-code/29389188#29389188", "title": "Yesod&#39;s TH generates incorrect code?", "body": "<p>I think that the generated code expects that you have the <code>OverloadedStrings</code> extension enabled in your source file. Try adding</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n</code></pre>\n\n<p>to the top of the source file where you splice in the Template Haskell code (i.e. <code>Data.hs</code>). </p>\n"}], "owner": {"reputation": 842, "user_id": 4737779, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/009c3f05f9273268e5d530785ef14327?s=128&d=identicon&r=PG&f=1", "display_name": "Beerend Lauwers", "link": "https://stackoverflow.com/users/4737779/beerend-lauwers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 29389188, "answer_count": 1, "score": 3, "last_activity_date": 1427886468, "creation_date": 1427886015, "question_id": 29389064, "link": "https://stackoverflow.com/questions/29389064/yesods-th-generates-incorrect-code", "title": "Yesod&#39;s TH generates incorrect code?", "body": "<p>I'm making a Yesod subsite and am getting a type error in some Template Haskell-generated code:</p>\n\n<pre><code>Yesod\\DataSource\\Data.hs:19:1:\nCouldn't match type `[Char]' with `Text'\nExpected type: () -&gt; ([Text], [(Text, Text)]) -&gt; Maybe (Route DataSource)\n  Actual type: () -&gt; ([[Char]], [(Text, Text)]) -&gt; Maybe (Route DataSource)\nIn the first argument of `\\ f_amMs x_amMt -&gt; f_amMs () x_amMt ::\n                            forall a_amMu.\n                            (() -&gt; ([Text], [(Text, Text)]) -&gt; Maybe (Route a_amMu))\n                            -&gt; ([Text], [(Text, Text)]) -&gt; Maybe (Route a_amMu)', namely\n  `helper_amMr'\nIn the expression:\n    \\ f_amMs x_amMt -&gt; f_amMs () x_amMt ::\n      forall a_amMu.\n      (() -&gt; ([Text], [(Text, Text)]) -&gt; Maybe (Route a_amMu))\n      -&gt; ([Text], [(Text, Text)]) -&gt; Maybe (Route a_amMu)\n    helper_amMr\n</code></pre>\n\n<p>The problem is clear, but I don't understand why it's generating incorrect code.</p>\n\n<p>The issue occurs in this TH call:</p>\n\n<pre><code>mkYesodSubData \"DataSource\" [parseRoutes|\n/ SubHomeR GET\n/datasource DataSourceInputR POST GET\n|]\n</code></pre>\n\n<p>Specifically, it is caused by the line:</p>\n\n<pre><code>/datasource DataSourceInputR POST GET\n</code></pre>\n\n<p>Removing this line fixes the issue.</p>\n\n<p>I'm using Stackage LTS 1.15:</p>\n\n<pre><code>remote-repo: stackage-lts-1.15:http://www.stackage.org/snapshot/lts-1.15\n</code></pre>\n\n<p>And I'm inside a cabal sandbox.</p>\n\n<p>Here are the relevant files: <a href=\"https://gist.github.com/BeerendLauwers/774cc432c3ada5b597e1\" rel=\"nofollow\">https://gist.github.com/BeerendLauwers/774cc432c3ada5b597e1</a></p>\n\n<p>Any idea?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427883415, "post_id": 29387532, "comment_id": 46954054, "body": "<a href=\"http://coliru.stacked-crooked.com/a/97a4e24a70de478d\" rel=\"nofollow noreferrer\">Cannot reproduce</a>. You probably broke your indentation."}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 4728743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf9507cd18350348b44f7aa3eb24f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Karroffel", "link": "https://stackoverflow.com/users/4728743/karroffel"}, "is_accepted": false, "score": 5, "last_activity_date": 1427883331, "creation_date": 1427883331, "answer_id": 29388175, "question_id": 29387532, "link": "https://stackoverflow.com/questions/29387532/error-syntax-error-in-input-unexpected-symbol-large/29388175#29388175", "title": "ERROR - Syntax error in input (unexpected symbol &quot;large&quot;)", "body": "<p>If i load it into ghci it runs perfectly.</p>\n\n<p>Maybe your indentation is incorrect in the where clause.</p>\n\n<p>in <code>anagram</code> the where keyword must be indented and in haskell the \"not equal\" is <code>/=</code> and <strong>not</strong> <code>!=</code></p>\n\n<p>Please use spaces <strong>everywhere</strong>.</p>\n\n<p>It has to be <code>YourModule.break</code> in <code>anagram</code> so it does not conflict with the <code>Prelude.break</code>.</p>\n\n<p>Just read the error messages, the computer is trying to speak to you, so listen ;)</p>\n\n<p>Test lots of code in GHCi and you'll get more comfortable with Haskell</p>\n"}], "owner": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "closed_date": 1427962986, "answer_count": 1, "score": 0, "last_activity_date": 1427883331, "creation_date": 1427881517, "question_id": 29387532, "link": "https://stackoverflow.com/questions/29387532/error-syntax-error-in-input-unexpected-symbol-large", "closed_reason": "Not suitable for this site", "title": "ERROR - Syntax error in input (unexpected symbol &quot;large&quot;)", "body": "<p>I wrote this code , it is about if two strings are each anagram of another : </p>\n\n<pre><code>anagram :: String-&gt;String-&gt;Bool            \nanagram w1 w2 = anagram1 x1 x2\nwhere \n    y1 = break w1\n    y2 = break w2\n    x1 = quicksort y1\n    x2 = quicksort y2\n\n\nanagram1 :: [String]-&gt;[String]-&gt;Bool\nanagram1 (h1:t1)(h2:t2)\n    | h1!=h2 = False\n    | h1==h2 = anagram1 t1 t2\n    | otherwise = True  \n</code></pre>\n\n<p>i found the code for quicksort there <a href=\"http://c2.com/cgi/wiki?QuickSortInHaskell\" rel=\"nofollow\">http://c2.com/cgi/wiki?QuickSortInHaskell</a></p>\n\n<pre><code>quicksort :: [String]-&gt;[String]\nquicksort [] = []\nquicksort (h:t) = quicksort small ++ (h : quicksort(large))\n   where\n      small = [y | y &lt;- t, y &lt;= h]\n      large = [y | y &lt;- t, y &gt; h]\n\n\nbreak :: String-&gt;[String]\nbreak s = map (\\c -&gt; [c]) s\n</code></pre>\n\n<p>When i run it , i take error <em>Syntax error in input (unexpected symbol \"large\")</em> . </p>\n\n<p>Why am i wrong ? </p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 1, "creation_date": 1427858065, "post_id": 29382195, "comment_id": 46943751, "body": "Do you want the current length or the total length?"}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1427858758, "post_id": 29382195, "comment_id": 46943901, "body": "just out of curiosity, what&#39;s the &quot;some condition?&quot;"}, {"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1427858899, "post_id": 29382195, "comment_id": 46943933, "body": "@thefourtheye i want the total length"}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1427858560, "post_id": 29382254, "comment_id": 46943865, "body": "yea i want fn ys xs (original length)"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 1, "creation_date": 1427858582, "post_id": 29382254, "comment_id": 46943871, "body": "@thefourtheye Since the OP code doesn&#39;t make much sense just to calculate the length of a list, I assume it&#39;s a simplification of what&#39;s actually needed, so I&#39;m trying to show the general method."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 1, "creation_date": 1427858825, "post_id": 29382254, "comment_id": 46943915, "body": "@thefourtheye I assumed the condition might refer to the recursive <code>(x:xs)</code>, so I cannot just leave it out. And passing the length of <code>xs&#39;</code> into <code>go</code> isn&#39;t necessary when it is already in scope."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1427859188, "post_id": 29382254, "comment_id": 46943981, "body": "I just realized while writing my answer I&#39;d factored away the saving into a variable which the question title asked for. Adding it back in."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 8, "last_activity_date": 1427859076, "last_edit_date": 1427859076, "creation_date": 1427858045, "answer_id": 29382254, "question_id": 29382195, "link": "https://stackoverflow.com/questions/29382195/is-there-a-way-to-save-the-length-of-a-list-in-a-variable-while-doing-recursion/29382254#29382254", "title": "Is there a way to save the length of a list in a variable while doing recursion?", "body": "<p>You can do the recursion with a \"worker\" function (traditionally named <code>go</code>), which allows you to refer to the original parameters and also to define extra variables:</p>\n\n<pre><code>fn ys xs' = go xs'\n  where\n    l = length xs'\n    go (x:xs) \n           | --some condition = l\n           | otherwise = go xs\n</code></pre>\n\n<p>You probably want a case for <code>go []</code> as well.</p>\n"}], "owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 29382254, "answer_count": 1, "score": 3, "last_activity_date": 1427859076, "creation_date": 1427857546, "last_edit_date": 1427858234, "question_id": 29382195, "link": "https://stackoverflow.com/questions/29382195/is-there-a-way-to-save-the-length-of-a-list-in-a-variable-while-doing-recursion", "title": "Is there a way to save the length of a list in a variable while doing recursion?", "body": "<p>let's say I have a recursive function that takes two lists and returns an int like so</p>\n\n<pre><code>fn ys (x:xs) \n       | --some condition = original length of (x:xs) \n       | otherwise = fn ys xs\n</code></pre>\n\n<p>I need to return the original length of the my input list (before recursion has messed with it) if condition one is true.\nIs there a way to save the original length?  </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1427882939, "post_id": 29382098, "comment_id": 46953784, "body": "and how can I print my records? I thought that: let records = parserFile &quot;uniprot_sprot.fasta&quot;, let fstrecord = head records, would give me a list of records ([Record]) and that fstrecord would now be the first record of that list."}, {"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "reply_to_user": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1427899538, "post_id": 29382098, "comment_id": 46964312, "body": "ParserFile is a monadic computation (IO [Records]), therefore if you want to operate with the content of your records, you should do it inside the monadic context, for instance in the case statement, like: &quot;Right xs -&gt; print $ head xs&quot;. But Now the type is IO () and also you must change the Left statement to: Left msg -&gt; print msg"}], "tags": [], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "is_accepted": true, "score": 3, "last_activity_date": 1427856941, "creation_date": 1427856941, "answer_id": 29382098, "question_id": 29381484, "link": "https://stackoverflow.com/questions/29381484/how-to-parse-into-records/29382098#29382098", "title": "How to parse into records?", "body": "<p>As far as I understand your problem you only need to parse records separated by '>'. Then you records is a string containing all characters but '>' and you are looking for something like this:</p>\n\n<pre><code>import Control.Applicative ((*&gt;))\nimport Text.Parsec \nimport Text.Parsec.ByteString  (Parser,parseFromFile)\n\ntype Record = String \n\nparserFile :: FilePath -&gt; IO [Record]\nparserFile fileName = do \n     r &lt;- parseFromFile parseRecords fileName \n     case r of\n        Left  msg  -&gt; error . show $ msg\n        Right xs -&gt; return xs\n\n\nparseRecords :: Parser [Record]\nparseRecords = many1 $ (char '&gt;')  *&gt; (many1 $ noneOf ['&gt;'])\n</code></pre>\n\n<p>The \"parseFromFile\" function read the data using the efficient binary representation and takes as another argument a parser to analyze the stream of bytestrings resulting from reading the file.</p>\n\n<p>Now, all you records begin with the '>' symbol, therefore you only need a parser that match the '>' symbol at the beggining and store the rest of the symbols in a list until the next '>' symbol. </p>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 29382098, "answer_count": 1, "score": 0, "last_activity_date": 1439504806, "creation_date": 1427852511, "last_edit_date": 1495541172, "question_id": 29381484, "link": "https://stackoverflow.com/questions/29381484/how-to-parse-into-records", "title": "How to parse into records?", "body": "<p>I have a asked a question before, which I learned from. I discovered that the implementation resulted in a list of strings rather than a list of records. The file I am parsing has records that looks like;</p>\n\n<blockquote>\n  <p>sp|P30375|1A01_GORGO Class I histocompatibility antigen Gogo-A*0101 alpha chain OS=Gorilla gorilla gorilla PE=2 SV=1\n  MAVMAPRTLVLLLSGALALTQTWAGSHSMRYFSTSVSRPGRGEPRFIAVGYVDDTQFVRF\n  DSDAASQRMEPRAPWIEQEGPEYWDRNTRNVKAHSQTDRVDLGTLRGYYNQSEDGSHTIQ\n  RMYGCDVGSDGRFLRGYQQDAYDGKDYIALNEDLRSWTAADMAAEITKRKWEAAHFAEQL\n  RAYLEGTCVEWLRRHLENGKETLQRTDAPKTHMTHHAVSDHEAILRCWALSFYPAEITLT\n  WQRDGEDQTQDTELVETRPAGDGTFQKWAAVVVPSGQEQRYTCHVQHEGLPEPLTLRWEP\n  SSQPTIPIVGIIAGLVLFGAVIAGAVVAAVRWRRKSSDRKGGSYSQAASSDSAQGSDVSL\n  TACKV\n  sp|P30443|1A01_HUMAN HLA class I histocompatibility antigen A-1 alpha chain OS=Homo sapiens GN=HLA-A PE=1 SV=1\n  MAVMAPRTLLLLLSGALALTQTWAGSHSMRYFFTSVSRPGRGEPRFIAVGYVDDTQFVRF\n  DSDAASQKMEPRAPWIEQEGPEYWDQETRNMKAHSQTDRANLGTLRGYYNQSEDGSHTIQ\n  IMYGCDVGPDGRFLRGYRQDAYDGKDYIALNEDLRSWTAADMAAQITKRKWEAVHAAEQR\n  RVYLEGRCVDGLRRYLENGKETLQRTDPPKTHMTHHPISDHEATLRCWALGFYPAEITLT\n  WQRDGEDQTQDTELVETRPAGDGTFQKWAAVVVPSGEEQRYTCHVQHEGLPKPLTLRWEL\n  SSQPTIPIVGIIAGLVLLGAVITGAVVAAVMWRRKSSDRKGGSYTQAASSDSAQGSDVSL\n  TACKV </p>\n</blockquote>\n\n<p>just before the sp there is a \">\", which I planned to use as a records divide point. So, how can I end up with:</p>\n\n<pre><code>[[&gt;sp|P30375|1A01_GORGO Class I histocompatibility antigen Gogo-A*0101 alpha chain OS=Gorilla gorilla gorilla PE=2 SV=1\nMAVMAPRTLVLLLSGALALTQTWAGSHSMRYFSTSVSRPGRGEPRFIAVGYVDDTQFVRF\nDSDAASQRMEPRAPWIEQEGPEYWDRNTRNVKAHSQTDRVDLGTLRGYYNQSEDGSHTIQ\nRMYGCDVGSDGRFLRGYQQDAYDGKDYIALNEDLRSWTAADMAAEITKRKWEAAHFAEQL\nRAYLEGTCVEWLRRHLENGKETLQRTDAPKTHMTHHAVSDHEAILRCWALSFYPAEITLT\nWQRDGEDQTQDTELVETRPAGDGTFQKWAAVVVPSGQEQRYTCHVQHEGLPEPLTLRWEP\nSSQPTIPIVGIIAGLVLFGAVIAGAVVAAVRWRRKSSDRKGGSYSQAASSDSAQGSDVSL\nTACKV]\n[&gt;sp|P30443|1A01_HUMAN HLA class I histocompatibility antigen A-1 alpha chain OS=Homo sapiens GN=HLA-A PE=1 SV=1\nMAVMAPRTLLLLLSGALALTQTWAGSHSMRYFFTSVSRPGRGEPRFIAVGYVDDTQFVRF\nDSDAASQKMEPRAPWIEQEGPEYWDQETRNMKAHSQTDRANLGTLRGYYNQSEDGSHTIQ\nIMYGCDVGPDGRFLRGYRQDAYDGKDYIALNEDLRSWTAADMAAQITKRKWEAVHAAEQR\nRVYLEGRCVDGLRRYLENGKETLQRTDPPKTHMTHHPISDHEATLRCWALGFYPAEITLT\nWQRDGEDQTQDTELVETRPAGDGTFQKWAAVVVPSGEEQRYTCHVQHEGLPKPLTLRWEL\nSSQPTIPIVGIIAGLVLLGAVITGAVVAAVMWRRKSSDRKGGSYTQAASSDSAQGSDVSL\nTACKV]]\n</code></pre>\n\n<p>using parsec? This is the code I started out with; <a href=\"https://stackoverflow.com/questions/29380363/how-to-parse-a-uniprot-file-with-parsec\">how to parse a uniprot-file with parsec?</a></p>\n"}, {"tags": ["opengl", "haskell", "glut", "ghci", "gloss"], "comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1427879343, "post_id": 29381466, "comment_id": 46951797, "body": "confirmed for ghc-7.8.4, gloss-1.9.2.1, with xmonad, for running the example given on the API docs web page."}], "answers": [{"tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": false, "score": 0, "last_activity_date": 1427881203, "creation_date": 1427881203, "answer_id": 29387422, "question_id": 29381466, "link": "https://stackoverflow.com/questions/29381466/how-to-get-gloss-to-not-close-ghci/29387422#29387422", "title": "How to get gloss to not close ghci?", "body": "<p>As the web site suggests (<a href=\"http://gloss.ouroborus.net/\" rel=\"nofollow\">http://gloss.ouroborus.net/</a>)</p>\n\n<pre><code>A2: Try installing gloss to use the GLFW window manager \ninterface instead of GLUT: cabal install gloss --flags=\"GLFW -GLUT\"\n</code></pre>\n\n<p>I could get this to work with ghc-7.6.3 (after pressing ESC in the window, I'm back to ghci)</p>\n\n<p>but I cannot compile this for ghc-7.8.4 (because cabal complains)</p>\n\n<pre><code>next goal: GLFW-b (dependency of gloss-1.9.2.1:+glfw)\nrejecting: GLFW-b-1.4.7.2, 1.4.7.1, 1.4.7, 1.4.6, 1.4.5, 1.4.4, 1.4.3, 1.4.2,\n1.4.1, 1.4, 1.3, 1.2.1, 1.2.0, 1.1.0, 1.0.2, 1.0.1, 1.0.0, 0.1.0.5, 0.1.0.4,\n0.1.0.3, 0.1.0.2, 0.1.0.1, 0.1.0.0, 0.0.2.10, 0.0.2.9, 0.0.2.8, 0.0.2.7,\n0.0.2.6, 0.0.2.5, 0.0.2.4, 0.0.2.3, 0.0.2.2, 0.0.2.1, 0.0.2, 0.0.1 (conflict:\ngloss-1.9.2.1:glfw =&gt; GLFW-b&gt;=0.1.4.1 &amp;&amp; &lt;0.2)\n</code></pre>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1427881203, "creation_date": 1427852372, "question_id": 29381466, "link": "https://stackoverflow.com/questions/29381466/how-to-get-gloss-to-not-close-ghci", "title": "How to get gloss to not close ghci?", "body": "<p><a href=\"http://hackage.haskell.org/package/gloss\" rel=\"nofollow\"><code>gloss</code></a> is a nice library for graphics. The problem, is, when I run it in <code>ghci</code>, it closes <code>ghci</code> as soon as I exit. I tried using <code>forkIO</code>, but it still closes ghci after closing the window. How do I get <code>gloss</code> to not close ghci (or at least keep the history) or is it better to just use a file?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1427854056, "post_id": 29381455, "comment_id": 46942839, "body": "Perhaps this would be better suited to the code review stack exchange."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 1, "creation_date": 1427878828, "post_id": 29381455, "comment_id": 46951490, "body": "cf. <a href=\"http://hackage.haskell.org/package/fgl-5.5.1.0/docs/src/Data-Graph-Inductive-Query-SP.html#dijkstra\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/fgl-5.5.1.0/docs/src/&hellip;</a>"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1427890460, "creation_date": 1427852283, "last_edit_date": 1427890460, "question_id": 29381455, "link": "https://stackoverflow.com/questions/29381455/how-to-improve-calculation-on-shortest-distance-more-idiomatically-in-haskell", "title": "How to improve calculation on shortest distance more idiomatically in Haskell?", "body": "<p>I've tried to write the calculation on the shortest distance between two graph nodes according to <a href=\"http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm\" rel=\"nofollow\">Dijkstra's algorithm</a> below, but two things in my code look rather imperative and tedious:</p>\n\n<ul>\n<li>explicitly passing parameters with the mutated states in order to reuse them later;</li>\n<li>heavily using conditional branch.</li>\n</ul>\n\n<p>So I'd like to learn how to improve it in more idiomatic way of <code>Haskell</code> from you. Thanks a lot in advance.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import qualified Data.Set as Set (size, insert)\nimport Data.Set (Set, empty, notMember)\nimport qualified Data.Map as Map (size, insert, lookup)\nimport Data.Map (Map, fromList)\nimport Data.Maybe (fromJust)\n\n{-\n  g: Graph map, every edge weighs 1 for simplicity.\n  s: Source vertex\n  t: Target vertex\n  c: Current vertex\n  a: Adjacent vertex\n  as: Adjacent vertex list\n  v: Visited vertex set\n  d: Shortest distance map\n-}\n\n-- purposely skipped explicit type signature to make it short below,\n\ncalToTarget g t c v d \n  | Set.size v &lt; Map.size g - 1 \n      &amp;&amp; c /= t \n      &amp;&amp; notMember c v \n      = calFromAdj (lookup' c g) g t c v d \n  | otherwise = d \n\ncalFromAdj []       _ _ _ _ d = d \ncalFromAdj (a : as) g t c v d = calFromAdj as g t c v $ \n  calToTarget g t a (Set.insert c v) (calFromCurrent (a : as) c v d)\n\ncalFromCurrent []       _ _ d = d \ncalFromCurrent (a : as) c v d \n  | notMember a v = calFromCurrent as c v $\n      Map.insert a (min (lookup' a d) (lookup' c d + 1)) d\n  | otherwise = calFromCurrent as c v d\n\nlookup' k m = fromJust $ Map.lookup k m\n\n-- test below,\n\n{-\n  a-S---b-c\n     \\  |\\\n      \\ | \\\n       \\|  \\\n        d-e-T-f\n-}\n\ng = fromList\n  [\n    (\"a\", [\"S\"]),\n    (\"S\", [\"a\", \"b\", \"d\"]),\n    (\"b\", [\"S\", \"c\", \"d\", \"T\"]),\n    (\"c\", [\"b\"]),\n    (\"d\", [\"S\", \"b\", \"e\"]),\n    (\"e\", [\"d\", \"T\"]),\n    (\"T\", [\"b\", \"e\", \"f\"]),\n    (\"f\", [\"T\"])\n  ]\n\ninfinity = 99\n\nd = fromList\n  [\n    (\"a\", infinity),\n    (\"S\", infinity),\n    (\"b\", infinity),\n    (\"c\", infinity),\n    (\"d\", infinity),\n    (\"e\", infinity),\n    (\"T\", infinity),\n    (\"f\", infinity)\n  ]\n\nv = empty\n\ns = \"S\"\nt = \"T\"\n\n-- The shortest distance will equal 2 from \"S\" to \"T\" below,\n\nmain = do\n  print . lookup' t . calToTarget g t s v $ Map.insert s 0 d\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1427851138, "post_id": 29380689, "comment_id": 46942149, "body": "this was really great help, sorry to bother you again, but I thought this would result in a list of records (a larger string chunk starting with &#180;&gt;&#180; and ending before the next &#180;&gt;&#180;. How would I keep the records intact instead of defining them as a list of lines?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 1, "creation_date": 1427851870, "post_id": 29380689, "comment_id": 46942351, "body": "@hotGopher Perhaps you should post another question for that? If you do, you should include an example input and what the desired result of parsing that input is."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 2, "last_activity_date": 1427846968, "creation_date": 1427846968, "answer_id": 29380689, "question_id": 29380363, "link": "https://stackoverflow.com/questions/29380363/how-to-parse-a-uniprot-file-with-parsec/29380689#29380689", "title": "how to parse a uniprot-file with parsec?", "body": "<p><code>parseSprot</code> doesn't need an <code>IO</code> in its signature.</p>\n\n<pre><code>parseSprot :: String -&gt; Either ParseError [[String]]\n...\n</code></pre>\n\n<p>The result of <code>readFile</code> is an <code>IO String</code>. You can do something with this <code>String</code> by binding the result of the <code>readFile</code> action into a new <code>IO</code> action. In <code>do</code> notation you can bind the result to a variable with <code>&lt;-</code></p>\n\n<pre><code>main = do \n    fileContents &lt;- readFile \"uniprot_sprot.fasta\"\n</code></pre>\n\n<p>The <code>parseSprot</code> function doesn't return a result in <code>IO</code>, you can use it anywhere. In <code>do</code> notation we tell the difference between a result bound to a variable and a declaration by using different syntax. <code>x &lt;- ...</code> binds a result to a variable. <code>let x = ...</code> declares <code>x</code> to be whatever is on the right hand side.</p>\n\n<pre><code>main = do \n    fileContents &lt;- readFile \"uniprot_sprot.fasta\" \n    let parsedContents = parseSprot fileContents\n</code></pre>\n\n<p>To test what your parser is doing, you might want to <code>print</code> the value returned from <code>parse</code>.</p>\n\n<pre><code>main = do \n    fileContents &lt;- readFile \"uniprot_sprot.fasta\" \n    let parsedContents = parseSprot fileContents\n    print parsedContents\n</code></pre>\n\n<p>Without <code>do</code> notation you can write this as </p>\n\n<pre><code>main = readFile \"uniprot_sprot.fasta\" &gt;&gt;= print . parseSprot\n</code></pre>\n\n<p><code>&gt;&gt;=</code> takes the result of the first computation and feeds it into a function to decide what to do next.</p>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 29380689, "answer_count": 1, "score": 1, "last_activity_date": 1439504813, "creation_date": 1427844999, "last_edit_date": 1439504813, "question_id": 29380363, "link": "https://stackoverflow.com/questions/29380363/how-to-parse-a-uniprot-file-with-parsec", "title": "how to parse a uniprot-file with parsec?", "body": "<p>I am a newbie to Haskell, but it seems like a powerful language that I want to learn. I was adopting some code from the chapter in real world Haskell on parsec. I tried to make my own version of it parsing the content of a uniprot-file. This is a file that consists of records (that starts with \">\"), and where each record consists of lines. My code seems very close to what is done in the example, but I am getting a lot of errors - mostly on types. My exception is among other that I am taking the output of readFile (IO string) instead of a string. I would appreciate it if someone could help me understand what is wrong in my approach...    </p>\n\n<pre><code>import Text.ParserCombinators.Parsec\n\nmain:: IO()\n\nparseSprot :: IO String -&gt; Either ParseError [[String]]\n\nparseSprot input = parse uniprotFile \"(unknown)\" input\n    where   \n        uniprotFile = endBy record eol\n        record = sepBy lines (char '&gt;')\n        lines = many (noneOf \",\\n\")\n        eol = char '\\n'\n\nmain = do \n    parseSprot $ readFile \"uniprot_sprot.fasta\" \n    putStrLn \"hey\"\n</code></pre>\n"}, {"tags": ["haskell", "raspberry-pi2"], "answers": [{"comments": [{"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1427850673, "post_id": 29380559, "comment_id": 46942027, "body": "That&#39;s great news! Would you consider making the compiled binaries available?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 1, "creation_date": 1427879795, "post_id": 29380559, "comment_id": 46952078, "body": "I suppose I should, shouldn&#39;t I? I&#39;ve never packaged any binaries, but I reckon it can&#39;t be so difficult. I&#39;ll think about it..."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1427883850, "post_id": 29380559, "comment_id": 46954285, "body": "You people are crazy!... I approve."}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1427920394, "post_id": 29380559, "comment_id": 46976329, "body": "I&#39;m trying 7.8.4 right now! @leftaroundabout did you build on a pi or pi2? I&#39;m hoping the extra cores will speed things up. I ran make with 5 jobs. Also I chose the quick build option which leaves out profiling."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1427923084, "post_id": 29380559, "comment_id": 46977730, "body": "rpi 1 model B. \u2013 As I said, the biggest hurdle was memory, so it&#39;ll probably compile <i>much</i> faster on the \u03c0 2. (In my case, the time spent swapping was probably by far the biggest contribution.)"}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1427927740, "post_id": 29380559, "comment_id": 46979582, "body": "I got all the way to the final stage on 7.8.4 in 3 hours with <code>make -j 5</code>, but then compilation failed on a &quot;strange closure&quot; error. Giving 7.8.2 a try now."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1427928244, "post_id": 29380559, "comment_id": 46979779, "body": "I certainly can&#39;t recall \u201cstrange closure\u201d or something like that happening. Might be a 7.8.4 issue. But if there are errors with the 7.8.2 install, don&#39;t hesitate to post them... perhaps I did experience them too, just forgot."}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1427996437, "post_id": 29380559, "comment_id": 47010131, "body": "7.8.2 failed with a similar error: <code>dll-split: internal error: evacuate(static): strange closure type 6744 (GHC version 7.8.2 for arm_unknown_linux)</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1427996601, "post_id": 29380559, "comment_id": 47010223, "body": "Hm... now it somehow rings a bell. Sure this is not actually an out-of-memory error? I seem to recall that gave a cryptic error message in my case as well. If it is memory, first try to compile <i>singlethreaded</i>; if that doesn&#39;t help, you&#39;ll need to attach extra memory, like I did with a swap HDD."}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1427996995, "post_id": 29380559, "comment_id": 47010445, "body": "Google searching for the error I see some discussion about the linker used during compilation. Do you remember having to switch to the &quot;gold&quot; linker? I&#39;ll try with more swap just in case right now."}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1427997329, "post_id": 29380559, "comment_id": 47010646, "body": "I added a 4gb swap file, but watching with top, no swap was actually being used when the error hit. The pi 2 has 1gb ram."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428007339, "post_id": 29380559, "comment_id": 47015737, "body": "I <i>had</i> to switch to the gold linker for something I did in the past. Let&#39;s see... <i>bingo</i>, there&#39;s an <a href=\"https://gist.github.com/bgamari/9399430\" rel=\"nofollow noreferrer\"><code>mk-fixed-gold-ld.sh</code></a> script in the ghc folder on the pi. Gee, it&#39;s not even a year ago and I&#39;d quite forgotten this..."}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1428341305, "post_id": 29380559, "comment_id": 47113313, "body": "Still no luck. No matter what I do, I get strange closure errors during the final phase, even using that script to switch linkers. I&#39;ve tried with and without <code>--enable-unregisterised</code> and with and without using <code>integer-simple</code> instead of gmp. There must be another piece to the puzzle."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428357087, "post_id": 29380559, "comment_id": 47121220, "body": "Hum. I really don&#39;t think I had that problem, no... but wish that I had properly logged what I did in a blog! \u2014 Afraid I won&#39;t have the time to go through the installation anew right now, and anyway I don&#39;t think I&#39;d be able to reproduce your error... but at any rate, <a href=\"http://dime-chime.com/misc-unrelated-junk/ghc-7.8.2_install.tar.xz\" rel=\"nofollow noreferrer\">here&#39;s</a> the compiled binary install dir if that helps you for the moment (unpack and link <code>&#47;usr&#47;local&#47;lib&#47;ghc-7.8.2</code> to the <code>install</code> folder)."}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1428441123, "post_id": 29380559, "comment_id": 47161120, "body": "Thanks for the binaries! Unfortunately the architecture changed from Arm6 to Arm7 in the new pi, so I can&#39;t get them to run. But the good news is I finally got a successful compile. I&#39;d been doing quick or quick-llvm builds for speed, and I finally just tried a regular perf build and everything worked. I wish I&#39;d done that earlier!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428445261, "post_id": 29380559, "comment_id": 47162830, "body": "Great to hear you&#39;ve got it to compile! Perhaps you&#39;d like to sum up how you did it in an extra answer, for future reference? Really, my post doesn&#39;t answer the question very well..."}, {"owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "edited": false, "score": 0, "creation_date": 1428531477, "post_id": 29380559, "comment_id": 47207081, "body": "I will, I&#39;ll also post binary distributions for 7.8.4 and Cabal"}, {"owner": {"reputation": 929, "user_id": 427785, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/651918248d103d4459c5ecafe6e40864?s=128&d=identicon&r=PG", "display_name": "dbeacham", "link": "https://stackoverflow.com/users/427785/dbeacham"}, "edited": false, "score": 0, "creation_date": 1431198835, "post_id": 29380559, "comment_id": 48396516, "body": "The debian unstable repository now has ghc-7.8.4 with ghci and TH! <a href=\"http://www.reddit.com/r/haskell/comments/35bw0b/at_last_debian_unstable_has_working_arm_ghci_and/\" rel=\"nofollow noreferrer\">Reddit announcement here</a> and works on my RPi 2 - can&#39;t comment on RPi 1."}, {"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "reply_to_user": {"reputation": 929, "user_id": 427785, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/651918248d103d4459c5ecafe6e40864?s=128&d=identicon&r=PG", "display_name": "dbeacham", "link": "https://stackoverflow.com/users/427785/dbeacham"}, "edited": false, "score": 0, "creation_date": 1431618683, "post_id": 29380559, "comment_id": 48584679, "body": "@dbeacham, can you share your steps? I tried installing ghc and cabal-install from debian sid, and my GHCi works, with TH, but I can&#39;t get GHC itself to work, and so I can&#39;t cabal install any packages."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1427846215, "creation_date": 1427846215, "answer_id": 29380559, "question_id": 29379706, "link": "https://stackoverflow.com/questions/29379706/ghci-on-raspberry-pi-2/29380559#29380559", "title": "GHCi on raspberry pi 2?", "body": "<p>I have had some luck with this!</p>\n\n<blockquote>\n  <p><code>sagemuej@sagemuej-Aspire-5742G:~$ ssh pi-loc</code> <br>\n  Linux raspberrypi 3.12.28+ #709 PREEMPT Mon Sep 8 15:28:00 BST 2014 armv6l<br>\n  <br>\n  The programs included with the Debian GNU/Linux system are free software;<br>\n  the exact distribution terms for each program are described in the<br>\n  individual files in /usr/share/doc/*/copyright.<br>\n  <br>\n  Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br>\n  permitted by applicable law.<br>\n  Last login: Wed Apr\u00a0 1 00:24:44 2015 from sagemuej-aspire-5742g.localdomain<br>\n  <code>pi@raspberrypi:~$ ghci</code><br>\n  GHCi, version 7.8.2: <a href=\"http://www.haskell.org/ghc/\">http://www.haskell.org/ghc/</a>\u00a0 :? for help<br>\n  Loading package ghc-prim ... linking ... done.<br>\n  Loading package integer-gmp ... linking ... done.<br>\n  Loading package base ... linking ... done.<br>\n  <code>Prelude&gt; :m +Data.Vector</code><br>\n  <code>Prelude Data.Vector&gt; fromList [1,2,3]</code><br>\n  Loading package array-0.5.0.0 ... linking ... done.<br>\n  Loading package deepseq-1.3.0.2 ... linking ... done.<br>\n  Loading package primitive-0.5.2.1 ... linking ... done.<br>\n  Loading package vector-0.10.9.1 ... linking ... done.<br>\n  fromList [1,2,3]<br></p>\n</blockquote>\n\n<p>Ain't it nice?</p>\n\n<p>It is a full GHC 7.8. I had to bootstrap it from source, though. Worked pretty fine by the normal setup instructions if I recall correctly &ndash; though it took ages to build (like, half a <em>week</em>).</p>\n\n<p>The main issue is memory: for some of the larger modules, the compiler needs more than the \u03c0 can offer even when running without X. What I did was simply, I connected a USB hard drive and set up a swap partition on it. Of course, swapping makes everything even slower, but eventually it'll succeed. Did for me, at least.</p>\n"}], "owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2881, "favorite_count": 2, "accepted_answer_id": 29380559, "answer_count": 1, "score": 8, "last_activity_date": 1427846215, "creation_date": 1427841042, "question_id": 29379706, "link": "https://stackoverflow.com/questions/29379706/ghci-on-raspberry-pi-2", "title": "GHCi on raspberry pi 2?", "body": "<p>I'm working on a few haskell projects that run on a raspberry pi 2 and the version of ghc that you can install with apt-get from raspbian (7.4.1). It has no GHCi though, which prevents some vital packages (like Vector) from compiling. I've seen a few rumors about being able to get later versions of ghc (with ghci) onto the pi, but nothing recent. The entry on the haskell wiki looks a couple years out of date. Has anyone had any luck with this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 0, "last_activity_date": 1427838558, "creation_date": 1427838558, "answer_id": 29379197, "question_id": 29379149, "link": "https://stackoverflow.com/questions/29379149/getting-parse-error-on-input-error-haskell/29379197#29379197", "title": "getting parse error on input &#39;=&#39; error (haskell)", "body": "<p>You still need to use <code>let</code> to define local variables inside a list comprehension regardless of whether or not the code is in a file. The code being in a file only makes a difference for top-level definitions. Local definitions stay the same.</p>\n\n<p>So the syntactically correct version of your code would be:</p>\n\n<pre><code>append :: [[a]] -&gt; [a]\nappend [[a]] = [ a | let len = length a, let n = 1, head a ++ (a !! n) , n &lt; len]\n--                   ^^^                 ^^^\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1427839041, "last_edit_date": 1427839041, "creation_date": 1427838587, "answer_id": 29379202, "question_id": 29379149, "link": "https://stackoverflow.com/questions/29379149/getting-parse-error-on-input-error-haskell/29379202#29379202", "title": "getting parse error on input &#39;=&#39; error (haskell)", "body": "<p>You need <code>let</code> for <code>len</code> and <code>n</code>:</p>\n\n<pre><code>append [[a]] = [a | let len = length a, let n = 1, head a ++ (a !! n), n &lt; len]\n</code></pre>\n\n<p>But this won't solve all of your problems, once the <code>let</code>s are added it doesn't typecheck, and <code>[[a]]</code> is probably not the pattern you want to use here.  The pattern <code>[[a]]</code> will only match a list like <code>[[1]]</code>, it won't match <code>[]</code>, or <code>[[1, 2]]</code>, or <code>[[1], [2]]</code>.</p>\n\n<p>You also have another problem that <code>head a ++ (a !! n)</code> should be an expression that returns a <code>Bool</code>, but in this case it's returning a list.  Any \"naked\" expressions on the right side of the <code>|</code> in a list comprehension must evaluate to a <code>Bool</code> value.</p>\n\n<p>If you're wanting to flatten a list of lists, I would suggest looking at the built-in <a href=\"http://hackage.haskell.org/package/base-4.7.0.1/docs/src/GHC-List.html#concat\" rel=\"nofollow\"><code>concat</code></a> function, which is actually defined using <code>foldr</code>.  Folds can be tricky to learn, though, so I'll show an alternate definition using explicit recursion:</p>\n\n<pre><code>myconcat :: [[a]] -&gt; [a]\nmyconcat [] = []\nmyconcat (x:xs) = x ++ myconcat xs\n</code></pre>\n\n<p>This is equivalent to the <code>foldr</code> definition, but hopefully it can be more instructive to how to solve this sort of problem.</p>\n"}], "owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 29379202, "answer_count": 2, "score": 0, "last_activity_date": 1427839041, "creation_date": 1427838367, "question_id": 29379149, "link": "https://stackoverflow.com/questions/29379149/getting-parse-error-on-input-error-haskell", "title": "getting parse error on input &#39;=&#39; error (haskell)", "body": "<p>my function append takes a list of lists [[a], [b,c], [d,e]] and returns a single list [a,b,c,d,e].\nI wrote this in a file so i didn't have to use \"let\" but i still get parse error on input '='. can anyone help? \nthanks</p>\n\n<pre><code>append :: [[a]] -&gt; [a]\nappend [[a]] = [ a | len = length a, n = 1, head a ++ (a !! n) , n &lt; len]\n</code></pre>\n"}, {"tags": ["haskell", "terminal", "cursor-position", "ansi-escape"], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1427838114, "post_id": 29379065, "comment_id": 46938227, "body": "Even better than I expected! The library is simply incomplete! (I was afraid that you couldn&#39;t find out where it was, and that things like <code>ncurses</code> could know because it kept track.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1427838164, "post_id": 29379065, "comment_id": 46938253, "body": "@PyRulez, I just filed a <a href=\"https://github.com/feuerbach/ansi-terminal/issues/7\" rel=\"nofollow noreferrer\">ticket</a>."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427884082, "post_id": 29379065, "comment_id": 46954397, "body": "My guess would be that Windows probably doesn&#39;t support this. (The single most important characteristic of <code>ansi-terminal</code> is portability; after all, if you only wanted ANSI escapes, you could trivially do that yourself...)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427895501, "post_id": 29379065, "comment_id": 46961440, "body": "@MathematicalOrchid, I believe &quot;portable&quot; is usually understood to mean &quot;works on everything except perhaps Windows&quot;."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427897121, "post_id": 29379065, "comment_id": 46962535, "body": "@dfeuer Funny, I would have said &quot;only works on Unix&quot; would be <i>non</i>-portable, but hey..."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 4, "last_activity_date": 1505245575, "last_edit_date": 1505245575, "creation_date": 1427837962, "answer_id": 29379065, "question_id": 29378936, "link": "https://stackoverflow.com/questions/29378936/ansi-terminal-how-to-get-cursor-position-in-haskell/29379065#29379065", "title": "`ansi-terminal` how to get cursor position in Haskell", "body": "<p>According to <a href=\"http://en.wikipedia.org/wiki/ANSI_escape_code\" rel=\"nofollow noreferrer\">Wikipedia</a>, the DSR terminal command should get you the position, and there are also commands to save and restore the position. I don't know why <code>ansi-terminal</code> does not support these; perhaps you should file a bug report.</p>\n\n<p>UPDATE: Support for saving and restoring cursor position <a href=\"https://github.com/feuerbach/ansi-terminal/commit/375616fcb8653bf9731f3f8960757c4bd6e12d91\" rel=\"nofollow noreferrer\">has now been added</a> to <code>ansi-terminal</code>!</p>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 29379065, "answer_count": 1, "score": 3, "last_activity_date": 1505245575, "creation_date": 1427837388, "last_edit_date": 1428682683, "question_id": 29378936, "link": "https://stackoverflow.com/questions/29378936/ansi-terminal-how-to-get-cursor-position-in-haskell", "title": "`ansi-terminal` how to get cursor position in Haskell", "body": "<p>The <a href=\"http://hackage.haskell.org/package/ansi-terminal\" rel=\"nofollow\"><code>ansi-terminal</code></a> library is a wonderful little library that allows you to move the cursor around and stuff (without all the extra stuff <code>ncurses</code> based stuff imposes.) The only problem is it doesn't provide a way to get the position of the cursor. Anyway, that uses or is compatible with the rest of the library, that I could do that. I know one way would be to track the cursor everywhere it goes, but I want to allow outside <code>putStr</code>s and such.</p>\n"}, {"tags": ["multithreading", "haskell", "stdin", "handle", "atomicity"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427884206, "post_id": 29378729, "comment_id": 46954459, "body": "I have a vague recollection of somebody claiming that <code>stdout</code> <i>already</i> prevents interleaving of text within a single line. I cannot find an authoritative reference for that though..."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427895015, "post_id": 29378729, "comment_id": 46961163, "body": "@MathematicalOrchid If you change <code>putStLn</code> to <code>putStr</code> in either of my examples, you will see interleaving of text within a single line."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427905007, "post_id": 29378729, "comment_id": 46967894, "body": "Then apparently I was mistaken..."}], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1427838659, "post_id": 29379101, "comment_id": 46938459, "body": "I was hoping I would be able to have this work with existing code. Locks require everything to support them."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1427839127, "post_id": 29379101, "comment_id": 46938628, "body": "@PyRulez If you don&#39;t somehow mark the edges of where threads are and are not allowed to interleave there are two possibilities: threads are allowed to interleave everywhere (no locks) or threads are not allowed to interleave anywhere (serial execution). If you remove the <code>Lock.with stdinLock $</code> from the last example none of the underlying existing calls to write to <code>stdout</code> interleave with each other, but the output data is still nonsense (all the labels first followed by all of the values)."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 3, "last_activity_date": 1427838661, "last_edit_date": 1427838661, "creation_date": 1427838193, "answer_id": 29379101, "question_id": 29378729, "link": "https://stackoverflow.com/questions/29378729/how-does-one-atomically-use-a-set-of-handles/29379101#29379101", "title": "How does one atomically use a set of handles?", "body": "<p>You can easily simulate a lock for controlling access to a resource with an <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Concurrent-MVar.html\" rel=\"nofollow\"><code>MVar</code></a>. You aquire the lock by taking the value with <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Concurrent-MVar.html#v:takeMVar\" rel=\"nofollow\"><code>takeMVar</code></a> and release the lock by replacing the value with <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Concurrent-MVar.html#v:takeMVar\" rel=\"nofollow\"><code>putMVar</code></a>. For example, we can define something like the following</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Concurrent.MVar\n\nmain = do\n    stdinLock &lt;- newMVar ()              -- create a new lock for stdin (unaquired)\n    let    \n        printWithLabel a b = do\n            takeMVar stdinLock           -- aquire the lock for stdin\n            putStrLn (show a ++ \":\")\n            print b\n            putMVar stdinLock ()         -- release the lock for stdin\n        actions = map fork $ zipWith printWithLabel [1..26] ['A'..]\n    doneSignals &lt;- sequence actions\n    sequence doneSignals\n    return ()\n\nfork :: IO a -&gt; IO (IO ())\nfork a = do\n    done &lt;- newEmptyMVar \n    forkIO (a &gt;&gt; putMVar done ())\n    return (takeMVar done)\n</code></pre>\n\n<p>We could extract the locking functionality into another function</p>\n\n<pre><code>withLock :: MVar () -&gt; IO a -&gt; IO a\nwithLock lock action = do\n    takeMVar lock\n    x &lt;- action\n    putMVar lock ()\n    return x\n</code></pre>\n\n<p><code>withLock</code> performs an <code>IO</code> action after acquiring a lock and releases it when were done. This doesn't properly handle what to do if the code throws exceptions and notably will not release the lock if an exception is thrown. The <a href=\"http://hackage.haskell.org/package/concurrent-extra-0.7.0.9/docs/Control-Concurrent-Lock.html\" rel=\"nofollow\"><code>Lock</code></a> in <a href=\"http://hackage.haskell.org/package/concurrent-extra\" rel=\"nofollow\">concurrent-extra</a> provides a similar helper function which <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Exception-Base.html#v:bracket_\" rel=\"nofollow\">brackets</a> an operation (handling exceptions) with acquiring and releasing a lock.</p>\n\n<p>In terms of <code>Lock</code> and <a href=\"http://hackage.haskell.org/package/async\" rel=\"nofollow\"><code>async</code></a> the above example can be simplified to</p>\n\n<pre><code>import qualified Control.Concurrent.Lock as Lock\nimport Control.Concurrent.Async\n\nmain = do\n    stdinLock &lt;- Lock.new\n    let    \n        printWithLabel a b = Lock.with stdinLock $ do\n            putStrLn (show a ++ \":\")\n            print b\n        actions = zipWith printWithLabel [1..26] ['A'..]\n    doneSignals &lt;- mapM async actions\n    mapM_ wait doneSignals\n</code></pre>\n\n<p>If you want a thread reading input on stdin to block output from other threads to stdout you can use a single lock to control both stdin and stdout.</p>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1427838661, "creation_date": 1427836506, "question_id": 29378729, "link": "https://stackoverflow.com/questions/29378729/how-does-one-atomically-use-a-set-of-handles", "title": "How does one atomically use a set of handles?", "body": "<p>Let's say you have a program with a bunch of threads. The one thread would like to freeze access to stdin, stdout, and stderr (causing any other threads or keyboards to block until its done) so that its output doesn't get interweaved with them. Is there a way to do this directly, or would there have to be a manager thread, you know, managin' the handle. Relatedly, could you cause any input on stdin to block any output on stdout until it received and handled (atomically)?</p>\n"}, {"tags": ["haskell", "scalaz"], "comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1427894233, "post_id": 29378195, "comment_id": 46960697, "body": "In ghci I also have to press <code>enter</code> (I&#39;m on Windows)"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1427899333, "post_id": 29378195, "comment_id": 46964151, "body": "That looks like a buffering issue; Not really related to haskell or scala. In haskell you can use <code>hSetBuffering</code> to adjust the buffering of a handle; I have no idea how to do it in java/scala though."}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1427834555, "creation_date": 1427834555, "question_id": 29378195, "link": "https://stackoverflow.com/questions/29378195/printing-each-character-typed-w-scalaz", "title": "Printing Each Character Typed w/ Scalaz", "body": "<p>I'm trying to write the following Haskell function, but in Scala (using scalaz):</p>\n\n<pre><code>ghci&gt;let f = do { x &lt;- getChar; _ &lt;- putChar(x); return () }\nghci&gt;f -- then type '4'\n44ghci&gt;\n</code></pre>\n\n<p>Here's what I tried:</p>\n\n<pre><code>def showInput: IO[Unit] = for {\n    c      &lt;- getChar\n    _      &lt;- putChar(c)\n} yield ()\n</code></pre>\n\n<p>Then I ran it:</p>\n\n<pre><code>scala&gt; net.repl.Foo.showInput\nres2: scalaz.effect.IO[Unit] = scalaz.effect.IOFunctions$$anon$6@73e3ae3a\n</code></pre>\n\n<p>After running the method, I typed <code>1234</code>. But, I had to press <code>enter</code> before the output (of <code>1</code>) showed up:</p>\n\n<pre><code>scala&gt; res2.unsafePerformIO\n1 \n</code></pre>\n\n<p>How can I write the above scalaz function to behave identically to the Haskell function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 4, "creation_date": 1427826824, "post_id": 29375818, "comment_id": 46932307, "body": "What is the type of <code>currmax</code> supposed to be? According to the type signature of <code>foldr</code> ( <code>(a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code>), it should be numeric (the same as <code>0</code>), but you also call <code>area</code> on it, which suggests that it should be <code>Shape</code>. There lies your mistake. Using <code>foldr</code> for this is awkward. Why not use <code>maximumBy</code>?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 6, "creation_date": 1427826903, "post_id": 29375818, "comment_id": 46932364, "body": "You&#39;re returning a <code>Shape</code> in one branch of the if and a <code>[Shape]</code> in the other branch, which doesn&#39;t type-check.  Is there a particular reason you&#39;re using <code>foldr</code> here instead of <code>Data.List.maximumBy</code>?  You aren&#39;t even using <code>areaMax</code>, so instead it could just be <code>maximumBy (comparing area)</code>, with <code>Data.Ord.comparing</code>."}, {"owner": {"reputation": 31, "user_id": 4689872, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-zVwayj_UwuQ/AAAAAAAAAAI/AAAAAAAAIRk/21USL0Zz0mk/photo.jpg?sz=128", "display_name": "Massimiliano Martella", "link": "https://stackoverflow.com/users/4689872/massimiliano-martella"}, "edited": false, "score": 0, "creation_date": 1427828299, "post_id": 29375818, "comment_id": 46933179, "body": "I can not use the function <code>maximumBy </code> because I have to use only high-order functions; thanks a lot, I will try to fix it now."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 7, "creation_date": 1427829415, "post_id": 29375818, "comment_id": 46933803, "body": "@MassimilianoMartella <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:maximumBy\" rel=\"nofollow noreferrer\"><code>maximumBy</code></a> is a <a href=\"http://en.wikipedia.org/wiki/Higher-order_function\" rel=\"nofollow noreferrer\">higher-order function</a> because it takes a function (how to compare the items) as an input."}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 4728743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf9507cd18350348b44f7aa3eb24f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Karroffel", "link": "https://stackoverflow.com/users/4728743/karroffel"}, "is_accepted": false, "score": 1, "last_activity_date": 1427903706, "creation_date": 1427903706, "answer_id": 29395398, "question_id": 29375818, "link": "https://stackoverflow.com/questions/29375818/haskell-recursion-in-lambda-function/29395398#29395398", "title": "Haskell: recursion in lambda function", "body": "<p>The problem is the <code>... then shape else (shape:list)</code>.</p>\n\n<p>Every function has a return type. So does the lambda function. </p>\n\n<p>The lambda needs to be of type <code>a -&gt; b</code>.\nWhen you create an if expression it must yield a value from exactly <strong>one</strong> type. ( in this example <code>b</code> )</p>\n\n<pre><code>\\shape currmax -&gt; if ((area shape) &gt; (area currmax))\n                   then shape         -- this has type Shape\n                   else (shape:list)  -- this has type [Shape]\n</code></pre>\n\n<p>You always need to make sure that the types are correct (fortunately GHC will complain)</p>\n\n<p>Also i dont really know what you are trying to do</p>\n\n<ol>\n<li>You pass in <code>0</code> as the starting value for the accumulator function but with <code>(area currmax)</code> you are trying to use it as a Shape (<code>area :: Shape -&gt; Int</code>)</li>\n<li>The problem with <code>then (shape:list)</code> is, that you want to prepend shape to list, but list will never change as it is an immutable parameter and the function does not call itself recursively.</li>\n</ol>\n\n<p>Don't lose hope and don't stop trying, you'll not regret to learn this style of programming and to use this beautiful language.</p>\n\n<p>Maybe just try to use a different example, there are dozens available for folds (<a href=\"http://book.realworldhaskell.org/read/functional-programming.html#fp.foldl\" rel=\"nofollow\">http://book.realworldhaskell.org/read/functional-programming.html#fp.foldl</a>)</p>\n\n<p>By the way, this is a great book and you should take a look at it <a href=\"http://book.realworldhaskell.org/read/\" rel=\"nofollow\">http://book.realworldhaskell.org/read/</a></p>\n\n<p>Happy learning!</p>\n"}], "owner": {"reputation": 31, "user_id": 4689872, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-zVwayj_UwuQ/AAAAAAAAAAI/AAAAAAAAIRk/21USL0Zz0mk/photo.jpg?sz=128", "display_name": "Massimiliano Martella", "link": "https://stackoverflow.com/users/4689872/massimiliano-martella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427903706, "creation_date": 1427826448, "question_id": 29375818, "link": "https://stackoverflow.com/questions/29375818/haskell-recursion-in-lambda-function", "title": "Haskell: recursion in lambda function", "body": "<p><br>\nI'm trying to understand recursion with the functions of Haskell, but I have some problems with this function, in particular with <code>foldr</code> function:</p>\n\n<p>I have declared a <code>data</code> Shape in this manner:</p>\n\n<pre><code>type P = (Int, Int)   -- point\ntype V = (Int, Int)   -- vector\n\ndata Shape = \n    Line P P                  -- line characterized by two vertices\n    | Triangle P P P          -- characterized by three triangle vertices\n    deriving (Eq, Show)\n</code></pre>\n\n<p>Now, given a list of forms, I have to extract the shape that has greater area</p>\n\n<pre><code>maxArea :: [Shape] -&gt; Shape\nmaxArea list = maxArea_hlp list 0\n\nmaxArea_hlp :: [Shape] -&gt; Int -&gt; Shape\nmaxArea_hlp list areaMax = foldr (\\shape currmax -&gt; if ((area shape) &gt; (area currmax)) then shape else (shape:list)) 0 list\n\narea :: Shape -&gt; Int\narea (Line _ _) = 0\narea (Triangle p1 p2 p3) = 0\n--TODO\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>Couldn't match expected type Shape with actual type [Shape]\nIn the expression: (shape : list)\n</code></pre>\n\n<p>The error lies in the \"else\" branch of the lambda function, but I do not understand how to solve it.</p>\n\n<p>Can you help me please?<br>\nThanks to all</p>\n"}, {"tags": ["list", "haskell", "optimization", "time-complexity"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 5, "creation_date": 1427820693, "post_id": 29374053, "comment_id": 46928717, "body": "Notice that 1.12GB is about twice as large as 568MB, when you do <code>++[&#39;x&#39;]</code>, GHC will traverse the list <code>replicate 9999999 &#39;a&#39;</code> to do the concat, and then it will traverse again to do <code>last</code>.  Keep in mind that enabling optimizations when compiling could likely make this go away.  Profiling code in GHCi is not terribly accurate."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1427822763, "post_id": 29374598, "comment_id": 46929953, "body": "You <i>can</i> tell that from the given numbers! If it were doing two traverals, garbage collection (and probably cache misses) would make the appending version much worse than twice as slow as the simple one."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1427824077, "post_id": 29374598, "comment_id": 46930670, "body": "(It&#39;s slightly off-topic, but I found out that GHC 7.10 somehow leaks space on -O0 with the example program, while GHC 7.8.4 does fine. The issue remains when I use the old definition of <code>replicate</code> from base-4.7.0.2 instead of the new one in base-4.8)"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1427838156, "post_id": 29374598, "comment_id": 46938250, "body": "@dfeuer: heh, true enough in practice I suppose. But at any rate one can&#39;t conclude that there are two separate traversals happening like the OP suggested."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427838360, "post_id": 29374598, "comment_id": 46938338, "body": "@Andr&#225;sKov&#225;cs, that&#39;s troubling. Have you filed a bug report yet? I don&#39;t know if I&#39;ll have time to investigate this week."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427838953, "post_id": 29374598, "comment_id": 46938566, "body": "@Andr&#225;sKov&#225;cs, actually, I&#39;m pretty sure I know why: the new definition of <code>last</code> uses <code>foldl</code>, which is now defined as <code>foldr (\\(v::a) (fn::b-&gt;b) -&gt; oneShot (\\(z::b) -&gt; fn (k z v))) (id :: b -&gt; b) xs z0</code>, which probably stinks without optimization."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 6, "last_activity_date": 1427822308, "creation_date": 1427822308, "answer_id": 29374598, "question_id": 29374053, "link": "https://stackoverflow.com/questions/29374053/does-using-haskells-operator-to-append-to-list-cause-multiple-list-travers/29374598#29374598", "title": "Does using Haskell&#39;s (++) operator to append to list cause multiple list traversals?", "body": "<p>You can't conclude from these numbers whether the first run does two traversals, or one traversal in which each step takes more time and allocates more memory than the single traversal in the second run.</p>\n\n<p>In fact, it's the latter that is happening here. You can think of the two evaluations like this:</p>\n\n<ul>\n<li><p>in the second expression <code>let t = replicate 9999999 'a' in last t</code>, in each step but the last one, <code>last</code> evaluates its argument, which causes <code>replicate</code> to allocate a cons cell and decrement a counter, and then the cons cell is consumed by <code>last</code>.</p></li>\n<li><p>in the first expression <code>let t = replicate 9999999 'a' ++ ['x'] in last t</code>, in each step but the last one, <code>last</code> evaluates its argument, which causes <code>(++)</code> to evaluate its first argument, which causes <code>replicate</code> to allocate a cons cell and decrement a counter, and then that cons cell is consumed by <code>(++)</code> and <code>(++)</code> allocates a new cons cell, and then that new cons cell is consumed by <code>last</code>.</p></li>\n</ul>\n\n<p>So the first expression is still a single traversal, it's just one that does more work per step.</p>\n\n<p>Now if you wanted to you could divide up all this work into \"the work done by <code>last</code>\" and \"the work done by <code>(++)</code>\" and call those two \"traversals\"; and that can be a useful approach for understanding the total amount of work done by your program. But due to Haskell's laziness, the two \"traversals\" are really interleaved as described above, so most people would say that the list is traversed just once.</p>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1427830020, "post_id": 29376488, "comment_id": 46934133, "body": "With <code>-fllvm</code> the LLVM optimizer will remove that loop and the program will run in constant time. Useless, but neat."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1427830392, "post_id": 29376488, "comment_id": 46934323, "body": "We don&#39;t have LLVM support for GHC 7.10 as of now, though (or do we have?)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1427838113, "post_id": 29376488, "comment_id": 46938226, "body": "GHC 7.10 does support LLVM but only version 3.5. Unfortunately there&#39;s no warning telling you to use 3.5 if you try to use an older version (oops). GHC HEAD requires version 3.6 and in the future we plan to bundle a version of LLVM with GHC because it has historically been difficult to support (and test) multiple LLVM versions in the LLVM backend."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1427838453, "post_id": 29376488, "comment_id": 46938377, "body": "I always add <code>-dno-suppress-type-signatures</code> to my <code>-dsuppress-all</code>\u2014it tends to make it much easier to see what&#39;s what, especially when the names get munged."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1427850164, "post_id": 29376488, "comment_id": 46941885, "body": "&quot;With GHC 7.10.1, we get fancy new optimizations for list processing.&quot;  Is there somewhere I can go and read about these? I can&#39;s sport any item in the <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/release-7-10-1.html\" rel=\"nofollow noreferrer\">7.10.1 release notes</a> that sounds like that, but maybe it&#39;s an optimization in <code>base</code> and not the compiler proper?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 2, "creation_date": 1427871071, "post_id": 29376488, "comment_id": 46947422, "body": "@LuisCasillas see <a href=\"http://www.joachim-breitner.de/publications/CallArity-TFP.pdf\" rel=\"nofollow noreferrer\">this paper</a>."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1427922896, "post_id": 29376488, "comment_id": 46977650, "body": "@Andr&#225;sKov&#225;cs Thanks. I tried to do what you did, but I can&#39;t seem to see <code>genlist</code>? Which part of the output <a href=\"https://gist.github.com/anonymous/6097416eecdfc62d696f\" rel=\"nofollow noreferrer\">here</a> is the <code>genlist</code> function?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1427923011, "post_id": 29376488, "comment_id": 46977702, "body": "@Ana it&#39;s not called &quot;genlist&quot; in the Core, it&#39;s &quot;main_xs&quot; here as I see. I translated to more illustrative names in the answer. Usually we get random mangled names (&quot;main_xs&quot; is relatively readable by comparison)."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1427924313, "post_id": 29376488, "comment_id": 46978264, "body": "@Andr&#225;sKov&#225;cs I see it now! Thanks very much. Core is not easy to read."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1427835896, "last_edit_date": 1427835896, "creation_date": 1427828727, "answer_id": 29376488, "question_id": 29374053, "link": "https://stackoverflow.com/questions/29374053/does-using-haskells-operator-to-append-to-list-cause-multiple-list-travers/29376488#29376488", "title": "Does using Haskell&#39;s (++) operator to append to list cause multiple list traversals?", "body": "<p>I'd like to talk a bit about what happens when we enable optimizations, because it can transform the performance characteristics of the program pretty radically. I'll be looking at the <a href=\"http://www.haskellforall.com/2012/10/hello-core.html\" rel=\"nofollow\">Core</a> output produced by <code>ghc -O2 Main.hs -ddump-simpl -dsuppress-all</code>. Also, I run the compiled programs with <code>+RTS -s</code> to get info about memory usage and running time. </p>\n\n<p>With <strong>GHC 7.8.4</strong> the two versions of the code run in the same amount of time and with the same amount of heap allocation. That's because <code>replicate 9999999 'a'</code> and <code>++ ['x']</code> is replaced with a <code>genlist 9999999</code>, where <code>genlist</code> looks like the following (not exactly the same, as I employ liberal translation from the original Core):</p>\n\n<pre><code>genlist :: Int -&gt; [Char]\ngenlist n | n &lt;= 1 = \"ax\"\n          | otherwise = 'a' : genList (n - 1)\n</code></pre>\n\n<p>Since we do generation and concatenation in a single step, we allocate each list cell just once.</p>\n\n<p>With <strong>GHC 7.10.1</strong>, we get fancy new optimizations for list processing. Now both of our programs allocate about as much memory as a <code>print $ \"Hello World\"</code> program (about 52 Kb on my machine). This is because we skip the list creation entirely. Now <code>last</code> is fused away too; we instead get a call <code>getlast 9999999</code>, with <code>getlast</code> being:</p>\n\n<pre><code>getlast :: Int -&gt; Char\ngetlast 1 = 'x'\ngetlast n = getlast (n - 1)\n</code></pre>\n\n<p>In the executable we'll have a small machine code loop that counts down from <code>9999999</code> to <code>1</code>. GHC is not quite smart enough to skip all computation and go straight to returning <code>'x'</code>, but it does a good job nevertheless, and in the end it gives us something rather different to the original code.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 29376488, "answer_count": 2, "score": 2, "last_activity_date": 1427835896, "creation_date": 1427820470, "question_id": 29374053, "link": "https://stackoverflow.com/questions/29374053/does-using-haskells-operator-to-append-to-list-cause-multiple-list-travers", "title": "Does using Haskell&#39;s (++) operator to append to list cause multiple list traversals?", "body": "<p>Does appending to a Haskell list with <code>(++)</code> cause lists to be traversed multiple times? </p>\n\n<p>I tried a simple experiment in GHCI. </p>\n\n<p>The first run:</p>\n\n<pre><code>$ ghci\nGHCi, version 7.8.4: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let t = replicate 9999999 'a' ++ ['x'] in last t\n'x'\n(0.33 secs, 1129265584 bytes)\n</code></pre>\n\n<p>The second run:</p>\n\n<pre><code>$ ghci\nGHCi, version 7.8.4: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let t = replicate 9999999 'a' in last t\n'a'\n(0.18 secs, 568843816 bytes)\n</code></pre>\n\n<p>The only difference is the <code>++ ['x']</code> to append a last element to a list. It causes the runtime to increase from .18s to .33s, and the memory to increase from 568MB to 1.12GB. </p>\n\n<p>So it seems that indeed it does cause multiple traversals. Can someone confirm on more theoretical grounds?</p>\n"}, {"tags": ["algorithm", "haskell", "compression", "range"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1427815572, "post_id": 29372261, "comment_id": 46925426, "body": "This is a problem that is <a href=\"http://en.wikipedia.org/wiki/Kolmogorov_complexity\" rel=\"nofollow noreferrer\">known to not have an optimal solution</a> in general."}, {"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427816001, "post_id": 29372261, "comment_id": 46925734, "body": "I rephrased my question, to avoid the impression that the pre-compressor has to be optimal in a strict sense."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427832740, "post_id": 29372261, "comment_id": 46935651, "body": "You have about 7 megabytes of data; about <code>2^26</code> bits. Your presented encoding requires approximately <code>(8+23+23)*2^23 = 2^29</code> bits. The first naive encoding in my answer is seven times smaller. It requires only <code>2^26</code> bits and less if there are runs (which you already suspect). The second encoding from my answer requires about <code>2^27</code> bits and doesn&#39;t require recording anything about products (it records a function from codes to codes). Unless you know something specific about the <i>distribution</i> of your data you will not be able to do better than <code>2^26</code> bits."}], "answers": [{"comments": [{"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1427820412, "post_id": 29373675, "comment_id": 46928509, "body": "This algorithm seems to have the same difficulties as the range-compression, I already have. It works best when codes of a product are consecutive. While it allows reconstructing the original data (which I am not primarily interested in) it doesn&#39;t allow the lookup I described. Note, that you made a small error with P6 in the string of products, but I believe I still got the message."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1427822305, "post_id": 29373675, "comment_id": 46929696, "body": "@MartinDrautzburg Pre-processing to build a code-to-code mapping is essentially the same as storing all the codes with each product. I&#39;ve added another section to my answer to demonstrate that."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 1, "last_activity_date": 1427822267, "last_edit_date": 1427822267, "creation_date": 1427819325, "answer_id": 29373675, "question_id": 29372261, "link": "https://stackoverflow.com/questions/29372261/pre-processing-data-for-existing-compressor/29373675#29373675", "title": "Pre-processing data for existing compressor", "body": "<p>Assuming that for each code there is only one product, you can encode the data as a list (string) of products. Let's pretend we have the following list of products and codes randomly generated from 9 products (or no product) and 10 codes.</p>\n\n<pre><code>[(P6,C2),\n (P1,C4),\n (P2,C10),\n (P3,C9),\n (P3,C1),\n (P4,C7),\n (P6,C8),\n (P5,C3),\n (P1,C5)]\n</code></pre>\n\n<p>If we sort them by code we have</p>\n\n<pre><code>[(P3,C1),\n (P6,C2),\n (P5,C3),\n (P1,C4),\n (P1,C5),\n -- C6 didn't have a product\n (P4,C7),\n (P6,C8),\n (P3,C9),\n (P2,C10)]\n</code></pre>\n\n<p>We can convert this into a string of products + nothing (<code>N</code>). The position in the string determines the code.</p>\n\n<pre><code>{- C1  C2  C3  C4  C5  C6  C7  C8  C9  C10 -}\n[  P3, P6, P5, P1, P1, N , P4, P6, P3, P2   ]\n</code></pre>\n\n<p>A string of symbols in some alphabet (in this case products+nothing) puts us squarely in the realm of well-studied string compression problems.</p>\n\n<p>If we <a href=\"http://en.wikipedia.org/wiki/Run-length_encoding\" rel=\"nofollow\">run-length encode</a> this list, we have an encoding similar to the encoding you originally presented. For each range of associations we store a single product+nothing and the run length. We only need a single small integer for the run length instead of two (possibly large) codes for the interval. </p>\n\n<pre><code>{-  P3    ,  P6,      P5,      P1, P1,  N    ,  P4,      P6,      P3,      P2    -}\n[  (P3, 1), (P6, 1), (P5, 1), (P1, 2), (N, 1), (P4, 1), (P6, 1), (P3, 1), (P2, 1) ]\n</code></pre>\n\n<p>We can serialize this to a string of bytes and use any of the existing <a href=\"https://hackage.haskell.org/packages/#cat:Compression\" rel=\"nofollow\">compression libraries</a> on bytes to perform the actual compression. Some compression libraries, such as the frequently used <a href=\"https://hackage.haskell.org/package/zlib\" rel=\"nofollow\">zlib</a>, are found in the <a href=\"https://hackage.haskell.org/packages/#cat:Codec\" rel=\"nofollow\">codec category</a>.</p>\n\n<h3>Sorted the other way</h3>\n\n<p>We'll take the same data from before and sort it by product instead of by code</p>\n\n<pre><code>[(P1,C4),\n (P1,C5),\n (P2,C10),\n (P3,C1),\n (P3,C9),\n (P4,C7),\n (P5,C3),\n (P6,C2),\n (P6,C8)]\n</code></pre>\n\n<p>We'd like to allocate new codes to each product so that the codes for a product are always consecutive. We'll just allocate these codes in order.</p>\n\n<pre><code>--    v-- New code --v   v -- Old code\n[(P1,C1),          [(C1,C4)\n (P1,C2),           (C2,C5),\n (P2,C3),           (C3,C10),\n (P3,C4),           (C4,C1),\n (P3,C5),           (C5,C9),\n (P4,C6),           (C6,C7),\n (P5,C7),           (C7,C3),\n (P6,C8),           (C8,C2),\n (P6,C9),           (C9,C8)]\n</code></pre>\n\n<p>We now have two pieces of data to save. We have a (now) one-to-one mapping between products and code ranges and a new one-to-one mapping between new codes and old codes. If we follow the steps from the previous section, we can convert the mapping between new codes and old codes into a list of old codes. The position in the list determines the new code.</p>\n\n<pre><code>{- C1  C2  C3   C4  C5  C6  C7  C8  C9 -} -- new codes\n[  C4, C5, C10, C1, C9, C7, C3, C2, C8  ] -- old codes\n</code></pre>\n\n<p>We can throw any of our existing compression algorithms at this string. Each symbol only occurs at most once in this list so traditional compression mechanisms will not compress this list any more. This isn't significantly different from grouping by the product and storing the list of codes as an array with the product; the new intermediate codes are just (larger) pointers to the start of the array and the length of the array.</p>\n\n<pre><code>[(P1,[C4,C5]),\n (P2,[C10]),\n (P3,[C1,C9]),\n (P4,[C7]),\n (P5,[C3]),\n (P6,[C2,C8])]\n</code></pre>\n\n<p>A better representation for the list of old codes is probably the difference between old codes. If the codes already tend to be in consecutive ranges these consecutive ranges can be run-length encoded away.</p>\n\n<pre><code>{- C4, C5, C10, C1, C9, C7, C3, C2, C8 -} -- old codes\n[  +4, +1,  +5, -9, +8, -2, -4, -1, +6  ] -- old code difference\n</code></pre>\n\n<p>I might be tempted to store the difference in product and the difference in codes with the products. This should increase the opportunity for common sub-strings for the final compression algorithm to compress away.</p>\n\n<pre><code>[(+1,[+4,+1]),\n (+1,[+5]),\n (+1,[-9,+8]),\n (+1,[-2]),\n (+1,[-4]),\n (+1,[-1,+6])]\n</code></pre>\n"}], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427826630, "creation_date": 1427815243, "last_edit_date": 1427826630, "question_id": 29372261, "link": "https://stackoverflow.com/questions/29372261/pre-processing-data-for-existing-compressor", "title": "Pre-processing data for existing compressor", "body": "<p>I have an existing \"compression\" algorithm, which compresses an association into ranges. Something like</p>\n\n<pre><code>type Assoc = [(P,C)]\ntype RangeCompress :: Assoc -&gt; [(P, [(C,C)]]\n</code></pre>\n\n<p>Read P as \"product\" and C as \"code\". The result is a list of products each associated with a list of code-ranges. To find the product associated with a given code, one traverses the compressed data until one finds a range, the given code falls into. </p>\n\n<p>This mechanism works well if consecutive codes are likely to belong to the same product. However, if the codes of different product interleave, they no longer form compact ranges and I end up with lots of ranges, where the upper bound is equal to the lower bound and nil compression.</p>\n\n<p>What I am looking for is a pre-compressor, which looks at the original association and determines a \"good enough\" transformation of codes, such that the association expressed in terms of transformed codes <strong>can be range-compressed into compact ranges</strong>. Something like</p>\n\n<pre><code>preCompress :: Assoc -&gt; (C-&gt;C)\n</code></pre>\n\n<p>or more fine-grained (by Product)</p>\n\n<pre><code>preCompress ::Assoc -&gt; P -&gt; (C-&gt;C)\n</code></pre>\n\n<p>In that case a <strong>product lookup</strong> would have to first transform the code in question and then do the lookup as before. Therefore the transformation must be expressible by a handful of parameters, which would have to be attached to the compressed data, either once for the entire association or by product.</p>\n\n<p>I checked some compression algorithms, but they all seem to focus on reconstructing the original data (which is not strictly needed here), while being totally free about the way they store the compressed data. In my case however, the compressed data must be ranges, only enriched by the parameters of the pre-compression.</p>\n\n<ul>\n<li>Is this a known problem?</li>\n<li>Does it have a solution?</li>\n<li>Where to look next?</li>\n</ul>\n\n<p>Please note:</p>\n\n<ul>\n<li>I am not primarily interested in restoring the original data</li>\n<li>I am primarily interested in the product lookup</li>\n<li>The number of codes is apx 7,000,000</li>\n<li>The number of products is apx 200</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "edited": false, "score": 1, "creation_date": 1427814121, "post_id": 29371803, "comment_id": 46924397, "body": "Please, add a detailed error message."}, {"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "reply_to_user": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "edited": false, "score": 0, "creation_date": 1427814370, "post_id": 29371803, "comment_id": 46924617, "body": "This is the error that I am getting but I figured out my first problem, I cannot match n with [a]                                                                         Couldn&#39;t match expected type \u2018Int\u2019 with actual type \u2018[a]\u2019     Relevant bindings include       n :: [a] (bound at HaskStuff3.hs:48:9)       tupList :: [a] -&gt; [a] (bound at HaskStuff3.hs:48:1)     In the expression: n     In the second argument of \u2018map\u2019, namely \u2018[n .. ]\u2019                                                                                                                             @kraskevich"}, {"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1427814635, "post_id": 29371803, "comment_id": 46924780, "body": "and it should be something like: gather [( )] = ( ) instead.."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1427823161, "post_id": 29371803, "comment_id": 46930160, "body": "Unit (<code>()</code>) is <i>not</i> a tuple! Tuples are <i>not</i> lists! They have a _fixed number of items, and have types like <code>(1,True,&quot;3&quot;,LT) :: (Int, Bool, String, Ordering)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1427815117, "post_id": 29372033, "comment_id": 46925088, "body": "No we are not on Haskell yet, I am looking up exercises and trying to extend my knowledge on tuples and recursion to get a head start. My reasoning behind gather was to take every element through the list and to put it in the second position of the tuple returned. My tuplist I wanted to count how many tuples were in the list and add them to the first element of the tuple returned. Hope this clears up what my thought process was?"}, {"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1427815289, "post_id": 29372033, "comment_id": 46925211, "body": "And I just attempted your code and it gave me a not in scope error for every true and false in each tuple."}, {"owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "reply_to_user": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1427815350, "post_id": 29372033, "comment_id": 46925258, "body": "@kbelt721 true and false should be True and False."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1427815483, "post_id": 29372033, "comment_id": 46925357, "body": "@kbelt721 no offense: but it&#39;s not my fault if you mistype your own example ;)"}, {"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1427815814, "post_id": 29372033, "comment_id": 46925599, "body": "@CarstenK&#246;nig ahh I apologize, that is how the website had the example listed with lowercase! It does work perfectly actually."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1427815430, "last_edit_date": 1427815430, "creation_date": 1427814652, "answer_id": 29372033, "question_id": 29371803, "link": "https://stackoverflow.com/questions/29371803/taking-a-list-of-tuples-and-returning-a-tuple/29372033#29372033", "title": "Taking a list of tuples and returning a tuple", "body": "<p>First let me get you a working version (I hope this is not homework):</p>\n\n<pre><code>gather :: [(a,[b])] -&gt; (Int, [b])\ngather xs = (length xs, concatMap snd xs)\n</code></pre>\n\n<p>now to your version:</p>\n\n<p>first you gave no signature but the two cases for <code>gather</code> already differ in the number of arguments (the first one would have type <code>[()] -&gt; [()]</code>, the second something like <code>Int -&gt; [a] -&gt; [a]</code> (what you really want is what I gave - or so I guess based on your example).</p>\n\n<p>The next think is that I don't know what you are trying to do with <code>gather</code> - if you explain your thinking I will try to get you on track.</p>\n\n<p>For what you need <code>tupList</code> I have no clue.</p>\n\n<h2>remark</h2>\n\n<p>I <em>know</em> that you wanted a <em>recursive</em> function - but this is only preferable IMO if this <strong>is</strong> homework ... so I am feeling not guilty of not giving you a recursive version ... if you want you can just rewrite the <code>concatMap</code> part (or <code>length</code>) using recursion.</p>\n\n<h2>based on your comment</h2>\n\n<p>I think you wanted to do the right think: split the problem into two parts: concatenating the lists and counting the items.</p>\n\n<p>Counting the items is rather simple: either you use <code>length</code> or you redefine it:</p>\n\n<pre><code>length :: [a] -&gt; Int\nlength [] = 0\nlength (_:tl) = 1 + length tl\n</code></pre>\n\n<p>The first problem should look something like this:</p>\n\n<pre><code>concat :: [[a]] -&gt; [a]\nconcat [] = []\nconcat (xs:xss) = undefined\n</code></pre>\n\n<p>maybe you can try and fill this out yourself (it's most likely ok for you to use <code>(++)</code>)</p>\n\n<p>Having both you can just do as I did if you rewrite it into:</p>\n\n<pre><code>gather ts = (length ts, concat (map snd ts))\n</code></pre>\n\n<h2>straight from GHCi : your example</h2>\n\n<pre><code>\u03bb&gt; gather [(0, [True, True] ), (1, [True, False] ), (2, [False, True])]\n(3,[True,True,True,False,False,True])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 0, "last_activity_date": 1427835172, "last_edit_date": 1427835172, "creation_date": 1427820450, "answer_id": 29374049, "question_id": 29371803, "link": "https://stackoverflow.com/questions/29371803/taking-a-list-of-tuples-and-returning-a-tuple/29374049#29374049", "title": "Taking a list of tuples and returning a tuple", "body": "<p>here's a recursive version. it performs only one pass along the input list. doing two independent passes often causes space leaks.</p>\n\n<pre><code>gather xs = g 0 xs \n  where\n  g c []         = (c, [])\n  g c ((_,ys):r) = (a, ys ++ b) \n                     where \n                     (a,b) = c `seq` g (c+1) r\n</code></pre>\n\n<p><code>seq</code> causes the immediate calculation of a counter as we advance along the list. Without it the calculation of <code>c+1</code> might be delayed unnecessarily.</p>\n\n<p>This is <em>guarded</em> recursion, actually.</p>\n"}], "owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 29374049, "answer_count": 2, "score": 1, "last_activity_date": 1427835172, "creation_date": 1427813995, "last_edit_date": 1427814991, "question_id": 29371803, "link": "https://stackoverflow.com/questions/29371803/taking-a-list-of-tuples-and-returning-a-tuple", "title": "Taking a list of tuples and returning a tuple", "body": "<p>I am writing a recursive function in Haskell that takes a list of tuples as input and returns one tuple. The first part of the tuple that is being returned should be the number of tuples that were in the list, and the second part of the tuple returned should be all of the elements from every tuple in the list. To clear it up here is what an example run should look like:</p>\n\n<pre><code>gather [ (0, [true, true] ), (1, [true, false] ), (2, [false, true]) ]\n  returns (3, [true, true, true, false, false, true] )\n</code></pre>\n\n<p>I am fairly new to Haskell but here is my attempt of the recursive code:</p>\n\n<pre><code>gather  [()] = [()]\ngather n as = head as : gather n (take n as)\ntupList :: [(a)] -&gt; [(a)]\ntupList n xs = map (\\x -&gt; gather n (take x xs)) [n..]\n</code></pre>\n\n<p>The compiler does not like this at all, any suggestions on what I can do to fix this? Thanks for your time!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1427822426, "post_id": 29370955, "comment_id": 46929753, "body": "I don&#39;t understand the downvotes. The question is a bit short, but unlike many other requests for help at least this shows some effort, having reduced the problem to string sorting."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1427812085, "creation_date": 1427812085, "answer_id": 29371062, "question_id": 29370955, "link": "https://stackoverflow.com/questions/29370955/are-two-strings-anagrams-or-not/29371062#29371062", "title": "Are two strings anagrams or not?", "body": "<p>Strings are lists of characters in Haskell, so the standard <code>sort</code> simply works.</p>\n\n<pre><code>&gt; import Data.List\n&gt; sort \"hello\"\n\"ehllo\"\n</code></pre>\n\n<p>Your idea of sorting and then comparing sounds fine for checking anagrams.</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1427812197, "creation_date": 1427812197, "answer_id": 29371098, "question_id": 29370955, "link": "https://stackoverflow.com/questions/29370955/are-two-strings-anagrams-or-not/29371098#29371098", "title": "Are two strings anagrams or not?", "body": "<p>I can give you and idea-(as I am not that much acquainted with haskell).\nTake an array having 26 spaces.</p>\n\n<p>Now for each character in the first string you increase certaing position in array.</p>\n\n<p>If array <code>A[26]={0,0,...0}</code>\nNow if you find 'a' then put <code>A[1]=A[1]+1</code>;\n    if 'b' then <code>A[2]=A[2]+1</code>;</p>\n\n<p>Now in case of 2nd string for each character you decrease the values for each character found in the same array.(if you find 'a' decrease A[1] like <code>A[1]=A[1]-1</code>)</p>\n\n<p>At last check if all the array elements are 0 or not. If 0 then definitely they are anagram else not an anagram.</p>\n\n<p>Note: You may extend this for Capital letters similarly.</p>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "is_accepted": false, "score": 1, "last_activity_date": 1427892618, "creation_date": 1427892618, "answer_id": 29391303, "question_id": 29370955, "link": "https://stackoverflow.com/questions/29370955/are-two-strings-anagrams-or-not/29391303#29391303", "title": "Are two strings anagrams or not?", "body": "<p>It is not necessary to count the crowd each letter.</p>\n\n<p>Simply, you can sort your string and then check each element of two lists.</p>\n\n<p>For example, you have this </p>\n\n<pre><code>\"cinema\" and \"maneci\"\n</code></pre>\n\n<p>It would be helpful to make your string into a list of characters.</p>\n\n<pre><code>['c','i','n','e','m','a'] and ['m','a','n','e','c','i']\n</code></pre>\n\n<p>Then , you can sort these list and you will check each character. \nNote that you will have these cases : </p>\n\n<pre><code>example [] [] = True\nexample [] a = False\nexample a [] = False \nexample (h1:t1)(h2:t2) = if h1==h2 then _retroactively_ else False\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4690820, "user_type": "registered", "profile_image": "https://graph.facebook.com/659026050893297/picture?type=large", "display_name": "Laura A. Agalioti", "link": "https://stackoverflow.com/users/4690820/laura-a-agalioti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 1, "accepted_answer_id": 29371062, "answer_count": 3, "score": 3, "last_activity_date": 1427892618, "creation_date": 1427811787, "question_id": 29370955, "link": "https://stackoverflow.com/questions/29370955/are-two-strings-anagrams-or-not", "title": "Are two strings anagrams or not?", "body": "<p>I want to find if two strings are anagrams or not.. \nI thought to sort them,and then check one by one but is there any algorithms for sorting stings? or another idea to make it? (simple ideas or code because i am a beginner )thanks</p>\n"}, {"tags": ["haskell", "stream", "agda"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1427820115, "post_id": 29369643, "comment_id": 46928320, "body": "Are you looking for <a href=\"http://agda.github.io/agda-stdlib/Data.Stream.html#2055\" rel=\"nofollow noreferrer\">lookup</a>? If not, could you start by writing the type of the function you are looking for?"}, {"owner": {"reputation": 589, "user_id": 2487229, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/53d7511ec6e92c5ca295639a7b1c287a?s=128&d=identicon&r=PG", "display_name": "ajayv", "link": "https://stackoverflow.com/users/2487229/ajayv"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1427822251, "post_id": 29369643, "comment_id": 46929676, "body": "No,  the stream has element of the form (x , y). I want to access x and y seperately. In the code the second line is not working."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1427822624, "post_id": 29369643, "comment_id": 46929872, "body": "You can use Data.Product&#39;s <a href=\"http://agda.github.io/agda-stdlib/Data.Product.html#525\" rel=\"nofollow noreferrer\">projections</a> for that."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1427848853, "post_id": 29369643, "comment_id": 46941564, "body": "&quot;`It says there is no constuctor , in stream&quot; Import the constructor?"}], "answers": [{"comments": [{"owner": {"reputation": 589, "user_id": 2487229, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/53d7511ec6e92c5ca295639a7b1c287a?s=128&d=identicon&r=PG", "display_name": "ajayv", "link": "https://stackoverflow.com/users/2487229/ajayv"}, "edited": false, "score": 0, "creation_date": 1427955217, "post_id": 29384143, "comment_id": 46986878, "body": "No the problem was with &quot;,&quot; . That was typo i.e (::). How to convince the termination checker?? This is the reason i have placed NO_TERMINATION_CHECK."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 589, "user_id": 2487229, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/53d7511ec6e92c5ca295639a7b1c287a?s=128&d=identicon&r=PG", "display_name": "ajayv", "link": "https://stackoverflow.com/users/2487229/ajayv"}, "edited": false, "score": 0, "creation_date": 1427963522, "post_id": 29384143, "comment_id": 46990638, "body": "@ajayv, it&#39;s not clear what you&#39;re trying to achieve. There was a <a href=\"http://adam.chlipala.net/cpdt/html/Coinductive.html\" rel=\"nofollow noreferrer\">chapter</a> about coinduction in the CPDT book."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 1, "last_activity_date": 1427869485, "creation_date": 1427869485, "answer_id": 29384143, "question_id": 29369643, "link": "https://stackoverflow.com/questions/29369643/accessing-element-from-stream-in-agda/29384143#29384143", "title": "Accessing element from Stream in agda", "body": "<p>The constructor is <code>_\u2237_</code> (type <code>\\::</code> to get <code>\u2237</code>), not <code>_::_</code>.</p>\n\n<p>Anyway your definition is not productive and doesn't convince the termination checker.</p>\n"}], "owner": {"reputation": 589, "user_id": 2487229, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/53d7511ec6e92c5ca295639a7b1c287a?s=128&d=identicon&r=PG", "display_name": "ajayv", "link": "https://stackoverflow.com/users/2487229/ajayv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1427869485, "creation_date": 1427807827, "question_id": 29369643, "link": "https://stackoverflow.com/questions/29369643/accessing-element-from-stream-in-agda", "title": "Accessing element from Stream in agda", "body": "<p>I have made a stream of (N x N) type. How can i access the individual element of the pair ??</p>\n\n<pre><code>genL : \u2115 \u2192  Stream (\u2115 \u00d7 \u2115) \u2192  Stream (\u2115 \u00d7 \u2115)\ngenL k ((x , y) :: xs)  = if ((y * k) lt x) then (x , y) :: (\u266f genL k (\u266d xs))\n                          else genL k (\u266d xs)\n</code></pre>\n\n<p>It says there is no constuctor <em>,</em> in stream. I have one solution in mind that i will create records of pair then it will works. Apart from that is there any other way to acccess the element.</p>\n"}, {"tags": ["javascript", "haskell", "canvas", "threepenny-gui"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1427804713, "post_id": 29368433, "comment_id": 46918942, "body": "Threepenny really isn&#39;t designed with much focus on performance. Do you really need 1000 circles? If not \u2013 well, I suppose you can live with a bit of latency for 100-ish objects. If you do need performance, you&#39;ll have to switch to GTK/Cairo or something."}, {"owner": {"reputation": 191, "user_id": 4690599, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/w0DCU.jpg?s=128&g=1", "display_name": "some idiot", "link": "https://stackoverflow.com/users/4690599/some-idiot"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1427807651, "post_id": 29368433, "comment_id": 46920399, "body": "it\u2019s not only about the not-so-little lag, but more about the fact, that i can\u2019t see the last circles"}, {"owner": {"reputation": 191, "user_id": 4690599, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/w0DCU.jpg?s=128&g=1", "display_name": "some idiot", "link": "https://stackoverflow.com/users/4690599/some-idiot"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1427986966, "post_id": 29368433, "comment_id": 47004540, "body": "not sure what i changed, but it stopped flickering so badly (for around 100)"}], "owner": {"reputation": 191, "user_id": 4690599, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/w0DCU.jpg?s=128&g=1", "display_name": "some idiot", "link": "https://stackoverflow.com/users/4690599/some-idiot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1427807553, "creation_date": 1427804090, "last_edit_date": 1427807553, "question_id": 29368433, "link": "https://stackoverflow.com/questions/29368433/bad-performance-of-threepenny-gui-canvas", "title": "Bad performance of Threepenny-gui canvas", "body": "<p>I tried to draw 100 animated circles with threepennt-gui. It felt kind of strange, so I made it 1000 and the problems were obvious:</p>\n\n<ul>\n<li>I could see the drawing (ie the canvas was black and then the circles appeared, then it went black again, etc</li>\n<li>It took several seconds to draw just once (and it\u2019s supposed to draw 50 times per second (because the timer won\u2019t let me do 60))</li>\n<li>every frame took incrementally longer. after a few frames it wouldn\u2019t finish at all. </li>\n</ul>\n\n<p>this was my code:</p>\n\n<pre><code>let draw (Circle c r (x:+y)) = do\n        canv # set' UI.fillStyle (UI.htmlColor c)\n        canv # UI.beginPath\n        canv # UI.arc (x, y) r (-pi) pi\n        canv # UI.closePath\n        canv # UI.fill\n\nlet drawAll circles = do\n        UI.clearCanvas canv\n        ppos &lt;- liftIO $ readIORef player\n        draw (Circle \"green\" playerRadius ppos)\n        mapM draw circles\n</code></pre>\n\n<p>so, I thought, maybe this generates inefficient js code ie unrolls the loop (ok, a few thousand lines should still generate and execute fairly fast)\nso I converted the circles to Json and used theepenny\u2019s ffi function like so:</p>\n\n<pre><code>circleToJson (Circle color radius (x:+y)) = \"{c:\\\"\" ++ color ++ \"\\\",r:\" ++ show radius ++ \",x:\" ++ show x ++ \",y:\" ++ show y ++ \"},\"\n\ncirclesToJson xs = \"[\" ++ (foldr (++) \"\" $ map circleToJson xs) ++ \"]\"\n\njsDrawFunc = \"(function(canvas, circles){var ctx = canvas.getContext(\\\"2d\\\"); for (c of circles) {ctx.fillStyle=c.c; ctx.beginPath(); ctx.arc(c.x,c.y,c.r,0,2*Math.PI,true); ctx.fill();}})\"\n\njsCanvasArg = \"$(\\\"canvas\\\")[0],\"\n\njsDrawAll circles = jsDrawFunc ++ \"(\" ++ jsCanvasArg ++ circlesToJson circles ++ \");\"\n</code></pre>\n\n<p>and in the timer event:</p>\n\n<pre><code>runFunction $ ffi $ jsDrawAll circles\n</code></pre>\n\n<p>-now I could no longer see the drawing (ie all appears at once). instead firefox stopped responding to user input until drawing was finished (also, as far as I can tell, the frame-time was more consistent)-\nedit: i lacked empty parentheses after beginPath, so all the circles were connected. now it\u2019s flickering again (with 100; with 1000 it takes ~1 second to draw and doesn\u2019t respond to user inputs). </p>\n\n<p>which suggests that the canvas is the problem. (which seems confirmed after some search)</p>\n\n<p>Is there a solution to that problem? (ideally one that doesn\u2019t involve using a different gui-lib)</p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1427796388, "post_id": 29365840, "comment_id": 46914648, "body": "It will evaluate the tuple <code>x = anotherFunction arg</code>, but not all <i>elements</i> of the tuple."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 2, "creation_date": 1427796646, "post_id": 29365840, "comment_id": 46914806, "body": "When you say &quot;call <code>myFunction 1</code>&quot; I assume you mean when that expression is evaluated.  As Zeta says, it will evaluate the tuple (but not the elements) and then evaluate <code>a</code> from that tuple."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1427796906, "post_id": 29365840, "comment_id": 46914961, "body": "@Zeta Is it right to say that the other values of the tuples <code>b</code>,<code>c</code> and <code>d</code> will be in thunk form. Or is there a more proper word for that?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1427797184, "post_id": 29365840, "comment_id": 46915122, "body": "@Sibi: I guess it&#39;s even more proper to say that the tuple will be in <i>weak head normal form</i>, but thunks are ok."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1427799698, "post_id": 29365840, "comment_id": 46916457, "body": "@Zeta Thanks, updated it appropriately."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 14, "last_activity_date": 1427796657, "creation_date": 1427796657, "answer_id": 29366041, "question_id": 29365840, "link": "https://stackoverflow.com/questions/29365840/to-what-extent-is-haskell-lazy/29366041#29366041", "title": "To what extent is Haskell lazy?", "body": "<p>Well it is only interested in <code>a</code>, so that means that there is an <strong>implicit function</strong>:</p>\n\n<pre><code>thea :: (a,b,c,d) -&gt; a\nthea (a,_,_,_) = a\n</code></pre>\n\n<p>In other words Haskell is <strong>not interested in the other elements</strong> of the tuple. Sometimes however the elements of the tuple share some structure. Say another function is defined as:</p>\n\n<pre><code>anotherFunction :: Int -&gt; (Int,Int,Int,Int)\nanotherFunction x = (z,t,f,g)\n    where f = x*x\n          g = f+x\n          z = g-2\n          t = 3\n</code></pre>\n\n<p>In that case - in order to evaluate the first element - the third and fourth element will also be evaluated. But since you don't do anything with them, Haskell won't be interested in their result specifically.</p>\n"}, {"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 7, "creation_date": 1427837801, "post_id": 29366042, "comment_id": 46938095, "body": "@JeanJouX undefineds are a very effective of testing non-strictness in a language."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 3, "creation_date": 1428079581, "post_id": 29366042, "comment_id": 47041439, "body": "@thefourtheye Iff something works when one of the inputs is undefined, it means the program never tried evaluating it."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 30, "last_activity_date": 1427799632, "last_edit_date": 1495541751, "creation_date": 1427796662, "answer_id": 29366042, "question_id": 29365840, "link": "https://stackoverflow.com/questions/29365840/to-what-extent-is-haskell-lazy/29366042#29366042", "title": "To what extent is Haskell lazy?", "body": "<p>In both cases, it won't evaluate anything unless the value is demanded. One way of demanding the value is calling the function in ghci (which prints the value in <code>ghci</code> and hence demanding it). Assuming that you are executing the function, then in your second case it will evaluate the tuple to <a href=\"https://stackoverflow.com/questions/6872898/haskell-what-is-weak-head-normal-form\">weak head normal form (WHNF)</a> and then evaluate the first element in <code>(a,b,c,d)</code> because only that value is demanded. The other elements <code>b</code>, <code>c</code> and <code>d</code> will be in the thunk form. In fact you can verify that yourself:</p>\n\n<pre><code>myFunction arg\n  | arg == 1 = a\n  | arg == 2 = a*b\n  | arg == 3 = b+c\n  | otherwise = (a+b)*c\n  where\n    (a,b,c,d) = anotherFunction arg\n\nanotherFunction x = (x, undefined, undefined, undefined)\n</code></pre>\n\n<p>Demo in ghci:</p>\n\n<pre><code>\u03bb&gt; myFunction 1\n1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "is_accepted": false, "score": 7, "last_activity_date": 1427799583, "last_edit_date": 1427799583, "creation_date": 1427797422, "answer_id": 29366345, "question_id": 29365840, "link": "https://stackoverflow.com/questions/29365840/to-what-extent-is-haskell-lazy/29366345#29366345", "title": "To what extent is Haskell lazy?", "body": "<p>Unless there is a need to get the value of that variable, it will not evaluated. Basically Haskell is so lazy unless it is told not to be so.</p>\n\n<p>You can confirm this, like this</p>\n\n<pre><code>Prelude&gt; :set +m\nPrelude&gt; let anotherFunction = (100, 1 `div` 0)\nPrelude| \nPrelude&gt; let myFunction arg\nPrelude|                | arg == 1  = a\nPrelude|                | otherwise = b\nPrelude|                where\nPrelude|                     (a, b) = anotherFunction\nPrelude| \n</code></pre>\n\n<p>Here, <code>1 `div` 0</code> will raise <code>divide by zero</code> error. If it evaluates all the elements, then even when you invoke <code>myFunction</code> with <code>1</code>, you would have gotten that error, but</p>\n\n<pre><code>Prelude&gt; myFunction 1\n100\n</code></pre>\n\n<p>only when you invoke it with any other value, there is a need to evaluate the second value of the tuple, and it will fail with <code>divide by zero</code> error.</p>\n\n<pre><code>Prelude&gt; myFunction 2\n*** Exception: divide by zero\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 12, "last_activity_date": 1427872532, "last_edit_date": 1427872532, "creation_date": 1427799682, "answer_id": 29367099, "question_id": 29365840, "link": "https://stackoverflow.com/questions/29365840/to-what-extent-is-haskell-lazy/29367099#29367099", "title": "To what extent is Haskell lazy?", "body": "<p>As others have already pointed out, only <code>a</code> will be evaluated.</p>\n\n<p>Keep however in mind that to exploit laziness it is crucial that <code>anotherFunction</code> returns a tuple before evaluating its components. For example, consider</p>\n\n<pre><code>anotherFunction n = if p &gt; 1000 then (n, p) else (n, 0)\n  where p = product [1..n]\n</code></pre>\n\n<p>The above will always evaluate <code>product [1..n]</code>, even if the caller only demands the first pair component (which is <code>n</code>). This is because the <code>if</code> needs to be evaluated before the pair can be returned, and that forces <code>p</code>. By contrast,</p>\n\n<pre><code>anotherFunction n = (n, if p &gt; 1000 then p else 0)\n  where p = product [1..n]\n</code></pre>\n\n<p>will immediately return the pair. If only its first component is evaluated, then <code>p</code> will not be computed at all.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2847, "favorite_count": 2, "accepted_answer_id": 29366042, "answer_count": 4, "score": 28, "last_activity_date": 1427872532, "creation_date": 1427796112, "last_edit_date": 1427856009, "question_id": 29365840, "link": "https://stackoverflow.com/questions/29365840/to-what-extent-is-haskell-lazy", "title": "To what extent is Haskell lazy?", "body": "<p>I need some clarification about laziness with Haskell.</p>\n\n<p>If I have this function:</p>\n\n<pre><code>myFunction arg\n  | arg == 1 = a\n  | arg == 2 = a*b\n  | arg == 3 = b+c\n  | otherwise = (a+b)*c\n     where\n            a = ...\n            b = ...\n            c = ...\n            d = ...\n</code></pre>\n\n<p>When I call <code>myFunction 1</code>, Haskell will evaluate only the <strong><code>a = ...</code></strong> function, neither <strong>b</strong> nor <strong>c</strong>, nor <strong>d</strong>.</p>\n\n<p>But if I write</p>\n\n<pre><code>myFunction arg\n  | arg == 1 = a\n  | arg == 2 = a*b\n  | arg == 3 = b+c\n  | otherwise = (a+b)*c\n     where\n            (a,b,c,d) = anotherFunction arg\n</code></pre>\n\n<p>What will Haskell's behaviour be?</p>\n\n<ul>\n<li>Will it evaluate only <strong>a</strong> and 'propagate' the lazyness to <code>anotherFunction</code>?</li>\n<li>Or, will it evaluate the whole tuple <strong>(a,b,c,d)</strong> as result of <code>anotherFunction</code>?</li>\n</ul>\n"}, {"tags": ["haskell", "dependencies", "cabal", "hackage"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1427814943, "post_id": 29364056, "comment_id": 46924968, "body": "Most of the time, you can blame <a href=\"https://wiki.haskell.org/Package_versioning_policy\" rel=\"nofollow noreferrer\">wiki.haskell.org/Package_versioning_policy</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 5, "last_activity_date": 1427845503, "last_edit_date": 1427845503, "creation_date": 1427791177, "answer_id": 29364203, "question_id": 29364056, "link": "https://stackoverflow.com/questions/29364056/how-do-i-know-who-to-blame-for-hackage-inconsistencies/29364203#29364203", "title": "How do I know who to blame for hackage inconsistencies", "body": "<p>Neither. That's just how it works; a package built with a library version as a dependency might get incompatible very quickly. The number of possible combinations is just too great.</p>\n\n<p>You have two options, basically:</p>\n\n<ul>\n<li>Use a <a href=\"https://www.haskell.org/cabal/users-guide/installing-packages.html#developing-with-sandboxes\" rel=\"nofollow\">sandbox</a></li>\n<li>Use <a href=\"http://www.stackage.org/\" rel=\"nofollow\">Stackage</a></li>\n</ul>\n"}], "owner": {"reputation": 729, "user_id": 2181977, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b84fe9137990458c9a91dcadd10579c?s=128&d=identicon&r=PG", "display_name": "Fredrik Karlsson", "link": "https://stackoverflow.com/users/2181977/fredrik-karlsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 29364203, "answer_count": 1, "score": 2, "last_activity_date": 1427845503, "creation_date": 1427790614, "last_edit_date": 1427792431, "question_id": 29364056, "link": "https://stackoverflow.com/questions/29364056/how-do-i-know-who-to-blame-for-hackage-inconsistencies", "title": "How do I know who to blame for hackage inconsistencies", "body": "<p>Trying to install <code>criterion</code>, I run into troubles with other packages that I rely on wanting to be reinstalled. Reinstalling them breaks everything (I've tried).</p>\n\n<pre><code>$ cabal install criterion\nResolving dependencies...\nIn order, the following would be installed:\nGlob-0.7.5 (new package)\nabstract-deque-0.3 (new package)\nabstract-par-0.3.3 (new package)\nblaze-builder-0.4.0.1 (new package)\ncereal-0.4.1.1 (new package)\nerf-2.0.0.0 (new package)\nieee754-0.7.6 (new package)\nhastache-0.6.1 (new package)\nmonad-par-extras-0.3.3 (new package)\nparallel-3.2.0.6 (new package)\nprimitive-0.5.4.0 (latest: 0.6) (new version)\nvector-0.10.12.3 (reinstall) changes: primitive-0.6 -&gt; 0.5.4.0\naeson-0.8.0.2 +old-locale (reinstall) changes: mtl-2.1.3.1 -&gt; 2.2.1\ncassava-0.4.2.2 (new package)\nmwc-random-0.13.3.2 (new package)\nmonad-par-0.3.4.7 (new package)\nvector-algorithms-0.6.0.3 (new package)\nvector-binary-instances-0.2.1.0 (new package)\nvector-th-unbox-0.2.1.2 (new package)\nmath-functions-0.1.5.2 (new package)\nstatistics-0.13.2.3 (new package)\ncriterion-1.1.0.0 (new package)\ncabal: The following packages are likely to be broken by the reinstalls:\nyaml-0.8.10.1\nstylish-haskell-0.5.11.2\nhashtables-1.2.0.2\nhaskell-docs-4.2.5\nUse --force-reinstalls if you want to install anyway.\n</code></pre>\n\n<p>Now, how do I find out whether to blame <code>criterion</code> for this (for using too old dependencies) or the other packages (for not being updated enough)?</p>\n"}, {"tags": ["function", "haskell", "cellular-automata"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427789831, "post_id": 29363638, "comment_id": 46910961, "body": "I think you probably just got the <code>case ... of</code> and function syntax messed up, and we do not see all your definitions (for example I think <code>Conductor, ..</code> will be a <code>Element_w_Coord Cell</code> but you are trying to use it (?) in place of a <code>List_2D Cell</code> which will fail) - anyway try <code>help (x:xs) (Conductor ...) = ...</code> instead of the <code>help1 a = case a of x:xs ...</code> to get started"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427789928, "post_id": 29363638, "comment_id": 46911010, "body": "In any case please give us the errors that are reported to you and point to the line where it is showing the error(s)"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1427866556, "post_id": 29383190, "comment_id": 46945768, "body": "please stay friendly and maybe you should expand your answer a bit - right now it&#39;s not really more than a comment"}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1427869481, "post_id": 29383190, "comment_id": 46946736, "body": "My response was perhaps not the most civil, but to be honest I just want this to stop before the student risks getting failed (or worse) for plagiarism. It&#39;s not a question that can reasonably be answered with what&#39;s given, and either the student is asking why their &quot;help1&quot; function doesn&#39;t work (in which case I&#39;ve answered their question) or they&#39;re asking for a solution to their assignment, which is problematic."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427872548, "post_id": 29383190, "comment_id": 46948119, "body": "I understand and my comment was not meant as a offense - and yes the OP most likely has lost all interest because he could not get his problem solved in a few seconds. But the &quot;homework&quot; problems come up very often (see <a href=\"http://meta.stackoverflow.com/questions/253792/stack-overflow-and-homework-questions\" title=\"stack overflow and homework questions\">meta.stackoverflow.com/questions/253792/&hellip;</a>) and what I understand is that homework-questions are ok, we only should take care and give more hints than complete answers (first) - we are not teachers or parents here, it&#39;s not our responsibility if they gonna cheat - we are here to help"}, {"owner": {"reputation": 1, "user_id": 4732895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd79d5b9aa6dc3a23c70f6b4de245b26?s=128&d=identicon&r=PG&f=1", "display_name": "Johno flores", "link": "https://stackoverflow.com/users/4732895/johno-flores"}, "edited": false, "score": 0, "creation_date": 1427885312, "post_id": 29383190, "comment_id": 46955042, "body": "uh i was only trying to get a little help with functions in function(help 1) and i put my name so my code is known to be mine and could not be taken also if helpful i planned to cite who ever helped coz i wanna avoid plagerism sorry if i caused any inconvience, p.s i didn&#39;t respond coz i&#39;ve had a busy test week"}], "tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 0, "last_activity_date": 1427869588, "last_edit_date": 1427869588, "creation_date": 1427864630, "answer_id": 29383190, "question_id": 29363638, "link": "https://stackoverflow.com/questions/29363638/wireworld-haskell-help-needed/29383190#29383190", "title": "wireworld haskell help needed", "body": "<p>Your <code>help1</code> function expects two arguments, but you only give it one.</p>\n\n<p>try something like</p>\n\n<pre><code>help1 coord world = case world of\n</code></pre>\n\n<p>Try doing your lab on recursion over lists, and stop posting assignment questions on stack overflow, especially with your real name.</p>\n"}], "owner": {"reputation": 1, "user_id": 4732895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd79d5b9aa6dc3a23c70f6b4de245b26?s=128&d=identicon&r=PG&f=1", "display_name": "Johno flores", "link": "https://stackoverflow.com/users/4732895/johno-flores"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427869588, "creation_date": 1427789228, "last_edit_date": 1427791854, "question_id": 29363638, "link": "https://stackoverflow.com/questions/29363638/wireworld-haskell-help-needed", "title": "wireworld haskell help needed", "body": "<p>i am required to make a wireworld move and i want to put a function inside another function(\"help1\") but i can't get it to work, there are multiple files \nhere is what i have </p>\n\n<pre><code>module Transitions.For_List_2D (\n   transition_world -- :: List_2D Cell -&gt; List_2D Cell\n) where\n\nimport Data.Cell (Cell)\nimport Data.Cell (Cell (Head, Tail, Conductor, Empty))\nimport Data.Coordinates\nimport Data.Coordinates (Distance,X_Coord,Y_Coord,Coord,Element_w_Coord,)\nimport Data.List_2D\n-- Replace this function with something more meaningful:\n\ntransition_world :: List_2D Cell -&gt; List_2D Cell\ntransition_world w = case w of \n                       [] -&gt; []\n                       x:xs -&gt; transition_cell x : transition_world xs\n\n\ntransition_cell :: Element_w_Coord Cell -&gt; Element_w_Coord Cell\ntransition_cell a  = case a of \n                        (Head,(x_coord,y_coord)) -&gt; (Tail, (x_coord,y_coord))\n                        (Tail,(x_coord,y_coord)) -&gt; (Conductor, (x_coord,y_coord))\n                        (Empty,(x_coord,y_coord))-&gt; (Empty, (x_coord, y_coord))\n                        (Conductor,(x_coord,y_coord)) -&gt; (i want to put working function here) \n\n\nhelp1 :: Coord -&gt; List_2D Cell -&gt; List_2D Cell\nhelp1 a = case a of \n         x:xs\n        (Conductor, (x_e, y_e))-&gt; List_2D.local_elements(element, (x_e, y_e)): help1 xs \n</code></pre>\n\n<p>the local_element is a function on another file which i want to use \nalso if you require to view the any of he other files, just ask \nthanks any help is greatly appreciated </p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 1, "creation_date": 1448625681, "post_id": 33955353, "comment_id": 55671610, "body": "Doesn&#39;t that imply the test suite binary has to guess where the source code lives?"}, {"owner": {"reputation": 1484, "user_id": 2541778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930c28082137d9918a90608c665c5af2?s=128&d=identicon&r=PG", "display_name": "Peter Simons", "link": "https://stackoverflow.com/users/2541778/peter-simons"}, "reply_to_user": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 0, "creation_date": 1448814558, "post_id": 33955353, "comment_id": 55725593, "body": "Ganesh, I edited my response to address test data file locations."}], "tags": [], "owner": {"reputation": 1484, "user_id": 2541778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930c28082137d9918a90608c665c5af2?s=128&d=identicon&r=PG", "display_name": "Peter Simons", "link": "https://stackoverflow.com/users/2541778/peter-simons"}, "is_accepted": true, "score": 7, "last_activity_date": 1448728427, "last_edit_date": 1448728427, "creation_date": 1448620078, "answer_id": 33955353, "question_id": 29361413, "link": "https://stackoverflow.com/questions/29361413/including-data-files-only-in-cabal-test-suites/33955353#33955353", "title": "Including data files only in cabal test suites", "body": "<p>There is no Cabal attribute that allows you to associate data files with a test suite (or any non-global stanza of your build). </p>\n\n<p>The common solution to this problem is to declare those files in the <code>extra-source-files</code> attribute. That attribute is global, too, and it ensures that the files listed are included in the release tarball so that the test suite can find them when run. Unlike <code>data-files</code>, however, <code>extra-source-files</code> are not installed &mdash; which is probably what you want since your test suite is not installed either. So the files are available during the build (and test suite run), but they won't take up space in the installation.</p>\n\n<p>Build drivers like <code>cabal-install</code> and <code>stack</code> will execute the test suite with the current working directory pointing into the top-level directory of your project, i.e. in the directory that contains your project's Cabal file. Thus, if you have a data file at <code>test/my-data-file.txt</code>, then your test suite can access the file using exactly that path.</p>\n"}], "owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 2, "accepted_answer_id": 33955353, "answer_count": 1, "score": 20, "last_activity_date": 1448728427, "creation_date": 1427780830, "question_id": 29361413, "link": "https://stackoverflow.com/questions/29361413/including-data-files-only-in-cabal-test-suites", "title": "Including data files only in cabal test suites", "body": "<p>I have some data files that only belong with my test program and would be confusing to distribute with the main library.</p>\n\n<p>Unfortunately, the <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#accessing-data-files-from-package-code\">.cabal <code>data-files</code> field</a> only applies to an entire cabal file, not a single section like the <code>test-suite</code>. If I try to use it in a test-suite stanza I just get:</p>\n\n<pre><code>Warning: ssh.cabal: Unknown fields: data-files (line 71)\n</code></pre>\n\n<p>Is there a natural way to associate these files with my test program so that they get copied around only if <code>--enable-tests</code> is specified?</p>\n\n<p>If there's no better way I'll probably use Template Haskell to embed them into the executable and then write them out again at runtime or something like that, but it feels pretty ugly.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427786138, "post_id": 29361326, "comment_id": 46909093, "body": "in case you wonder how you can find out yourself: first seach it: <a href=\"https://www.haskell.org/hoogle/?hoogle=ap\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=ap</a> you see that you most likely use the monad instance so look at <code>Monad</code>: <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#t:Monad\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.0.0/docs/&hellip;</a> and see if you can find the right instance below (it is <code>Monad ((-&gt;) r)</code> here) - there is hopefully a link to the source (<a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-Base.html#line-621\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.0.0/docs/src/&hellip;</a>) and voila (also look at the source for <code>ap</code>: <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-Base.html#ap\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.0.0/docs/src/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 7, "last_activity_date": 1427821073, "last_edit_date": 1427821073, "creation_date": 1427784257, "answer_id": 29362248, "question_id": 29361326, "link": "https://stackoverflow.com/questions/29361326/how-does-one-read-haskells-ap-zip-tail-to-mean-x-zip-x-tail-x/29362248#29362248", "title": "How does one read Haskell&#39;s `ap zip tail` to mean `\\x -&gt; zip x (tail x)`?", "body": "<p>First, look at the <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-Base.html#ap\" rel=\"nofollow noreferrer\">source</a> as well:</p>\n\n<pre><code>ap m1 m2          = do { x1 &lt;- m1; x2 &lt;- m2; return (x1 x2) }\n-- Since many Applicative instances define (&lt;*&gt;) = ap, we\n-- cannot define ap = (&lt;*&gt;)\n</code></pre>\n\n<p>You know (from the previous question) that the monad we are interested in is <code>(-&gt;) [a]</code>. Since we know from that comment that <code>ap</code> is the same as <code>(&lt;*&gt;)</code>, next we look at </p>\n\n<pre><code>instance Applicative ((-&gt;) a) where\n    pure = const\n    (&lt;*&gt;) f g x = f x (g x)\n</code></pre>\n\n<p><code>(&lt;*&gt;) zip tail x = zip x (tail x)</code> and we can move <code>x</code> to the right and get <code>zip &lt;*&gt; tail = \\x -&gt; zip x (tail x)</code>. </p>\n\n<p>You could also use the definition of <code>ap</code> and <code>instance Monad (-&gt;) a</code> directly without looking at <code>&lt;*&gt;</code>, but this would take a bit more effort.</p>\n\n<blockquote>\n  <p>For all I know it could've meant \\x -> zip x (tail (tail x)) instead.</p>\n</blockquote>\n\n<p><em>This</em> is actually impossible just from the type: <code>m (a -&gt; b) -&gt; m a -&gt; m b</code> is <code>(c -&gt; (a -&gt; b)) -&gt; (c -&gt; a) -&gt; (c -&gt; b)</code> in this monad, so <code>ap f1 f2</code> can't apply <code>f2</code> twice: it has type <code>c -&gt; a</code> and <code>f2 (f2 &lt;anything&gt;)</code> wouldn't typecheck.</p>\n"}, {"tags": [], "owner": {"reputation": 213, "user_id": 4161344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ccd329999b243f2cd7f1e19de60940d?s=128&d=identicon&r=PG&f=1", "display_name": "algotrific", "link": "https://stackoverflow.com/users/4161344/algotrific"}, "is_accepted": false, "score": 1, "last_activity_date": 1442457413, "last_edit_date": 1495535342, "creation_date": 1442457413, "answer_id": 32621759, "question_id": 29361326, "link": "https://stackoverflow.com/questions/29361326/how-does-one-read-haskells-ap-zip-tail-to-mean-x-zip-x-tail-x/32621759#32621759", "title": "How does one read Haskell&#39;s `ap zip tail` to mean `\\x -&gt; zip x (tail x)`?", "body": "<p>The second part of <a href=\"https://stackoverflow.com/a/32598709/4161344\">this answer</a> explains it.  Remember that <code>&lt;*&gt;</code> is the same as <code>ap</code>, but just as an infix operator, and as part of <code>Applicative</code> rather than it's subclass, <code>Monad</code>, since only <code>Applicative</code> is needed for it to work.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1442457413, "creation_date": 1427780405, "last_edit_date": 1427780772, "question_id": 29361326, "link": "https://stackoverflow.com/questions/29361326/how-does-one-read-haskells-ap-zip-tail-to-mean-x-zip-x-tail-x", "title": "How does one read Haskell&#39;s `ap zip tail` to mean `\\x -&gt; zip x (tail x)`?", "body": "<p><a href=\"https://stackoverflow.com/questions/19181917/how-does-the-expression-ap-zip-tail-work\">A previous question</a> discussed how the type of Haskell expression <code>ap zip tail</code> can be translated into the type of <code>\\x -&gt; zip x (tail x)</code>. It was enlightening, but neither the question nor answer there dealt with <em>why</em> the former expression gives the same results as the latter expression, only that their types are equivalent. For all I know it could've meant <code>\\x -&gt; zip x (tail (tail x))</code> instead.</p>\n\n<p>I tried reading the documentation for <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#v:ap\" rel=\"nofollow\">ap</a> but got nowhere. How does one <em>read</em> <code>ap</code> to get the understanding that <code>ap zip tail</code> gives the same results as <code>\\x -&gt; zip x (tail x)</code> ?</p>\n"}, {"tags": ["scala", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 8444, "user_id": 1837203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4db7eb958bf0c84072c8e9658700167?s=128&d=identicon&r=PG", "display_name": "jaket", "link": "https://stackoverflow.com/users/1837203/jaket"}, "is_accepted": false, "score": 6, "last_activity_date": 1427776031, "creation_date": 1427776031, "answer_id": 29360617, "question_id": 29360384, "link": "https://stackoverflow.com/questions/29360384/sequence-like-function-in-scala/29360617#29360617", "title": "Sequence-like Function in Scala", "body": "<p>The error message is saying that the type of <code>left</code> is <code>Either[A, B]</code> but the expected type of <code>f</code> is <code>Either[A, List[B]]</code>.</p>\n\n<p>You'll need to deconstruct Left in the case and then reconstruct it in the expression. It seems silly but you have the remember that the <code>Left(x)</code> in the branch is tagged with a different type from the one you want.</p>\n\n<pre><code>| case Left(x) :: _ =&gt; Left(x)\n</code></pre>\n\n<p>Haskell would give you a similar error:</p>\n\n<pre><code>f :: Either a b -&gt; Either a [b]\nf l@(Left x) = l\n\nCouldn't match type \u2018b\u2019 with \u2018[b]\u2019\n  \u2018b\u2019 is a rigid type variable bound by\n      the type signature for f :: Either a b -&gt; Either a [b]\n      at /Users/Jake/Code/Haskell/L.hs:3:6\nExpected type: Either a [b]\n  Actual type: Either a b\nRelevant bindings include\n  l :: Either a b (bound at /Users/Jake/Code/Haskell/L.hs:4:3)\n  f :: Either a b -&gt; Either a [b]\n    (bound at /Users/Jake/Code/Haskell/L.hs:4:1)\nIn the expression: l\nIn an equation for \u2018f\u2019: f l@(Left x) = l\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427776031, "creation_date": 1427774483, "question_id": 29360384, "link": "https://stackoverflow.com/questions/29360384/sequence-like-function-in-scala", "title": "Sequence-like Function in Scala", "body": "<p>Given a <code>List[Either[A,B]]</code>, I could use <code>sequence</code> in Haskell to extract either the entire <code>List</code> of <code>Right[B]</code>s, or <code>Left[A]</code>.</p>\n\n<pre><code>Prelude&gt; sequence [Left \"bad\", Right 555]\nLeft \"bad\"\nPrelude&gt; sequence [Right 4534, Right 555]\nRight [4534,555]\n</code></pre>\n\n<p>I'm not sure if this method fits the definition of <code>sequence</code>, but it's a narrow function for dealing with <code>List[Either[A,B]] =&gt; Either[A, List[B]]</code>.</p>\n\n<pre><code>scala&gt; def f[A, B](es: List[Either[A, B]]): Either[A, List[B]] = es match {\n     |   case Right(x) :: xs      =&gt; f(xs).right.map(y =&gt; x :: y)\n     |   case Nil                 =&gt; Right(Nil)\n     |   case left @ Left(_) :: _ =&gt; left\n     | }\n</code></pre>\n\n<p>But I'm getting this error that I don't understand.</p>\n\n<pre><code>&lt;console&gt;:10: error: type mismatch;\n found   : scala.collection.immutable.::[Either[?A3,?B3]] where type ?B3 &lt;: B (this is a GADT skolem), type ?A3 &lt;: A (this is a GADT skolem)\n required: Either[A,List[B]]\n         case left @ Left(_) :: _ =&gt; left\n                                     ^\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["haskell", "yesod", "keter"], "comments": [{"owner": {"reputation": 29707, "user_id": 394167, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5b8b4928a69d422138ed747c70e8553e?s=128&d=identicon&r=PG", "display_name": "Richard Cook", "link": "https://stackoverflow.com/users/394167/richard-cook"}, "edited": false, "score": 0, "creation_date": 1455639387, "post_id": 29359038, "comment_id": 58573151, "body": "Sounds like it&#39;s an invalid archive. Could you provide more information? If you use the <code>yesod keter</code> command it should create a valid archive for you."}, {"owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "reply_to_user": {"reputation": 29707, "user_id": 394167, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5b8b4928a69d422138ed747c70e8553e?s=128&d=identicon&r=PG", "display_name": "Richard Cook", "link": "https://stackoverflow.com/users/394167/richard-cook"}, "edited": false, "score": 0, "creation_date": 1455731577, "post_id": 29359038, "comment_id": 58624025, "body": "i already solve it there is some error on my keter.yaml file. so it was giving me error like this. thank you"}], "owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427764775, "creation_date": 1427764775, "question_id": 29359038, "link": "https://stackoverflow.com/questions/29359038/error-occured-when-launching-bundle-main-keter", "title": "Error occured when launching bundle Main keter", "body": "<p>I've done everything on my yesod project but the keter gives me an error log message like this:</p>\n\n<pre><code>  Unpacking bundle '/opt/keter/incoming/Main.keter'\n  Error occured when launching bundle Main: Codec.Compression.Zlib: incorrect header check\n</code></pre>\n\n<p>i also post an issue on <a href=\"https://github.com/snoyberg/keter/issues/85\" rel=\"nofollow\">keter github</a> maybe some also help me.</p>\n\n<p>thank you in advance.</p>\n"}, {"tags": ["haskell", "tuples"], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 6, "last_activity_date": 1431394197, "last_edit_date": 1431394197, "creation_date": 1427763286, "answer_id": 29358811, "question_id": 29358670, "link": "https://stackoverflow.com/questions/29358670/deleting-element-from-a-tuples-list/29358811#29358811", "title": "Deleting element from a tuple&#39;s list", "body": "<p>Simply pattern-match the tuple to extract the two pieces, operate on one of them, and then put it back together into a new tuple:</p>\n\n<pre><code>deleteCandidate :: Int -&gt; Cell -&gt; Cell\ndeleteCandidate cand (x, xs) = (x, delete cand xs)\n</code></pre>\n\n<p>Alternatively, since <code>(a,)</code> has a <code>Functor</code> instance, you could write </p>\n\n<pre><code>deleteCandidate :: Int -&gt; Cell -&gt; Cell\ndeleteCandidate cand = fmap (delete cand)\n</code></pre>\n\n<p>Or, shorter still, you could elide the explicit <code>cand</code> argument as well, and express deleteCandidate as a simple function composition:</p>\n\n<pre><code>deleteCandidate :: Int -&gt; Cell -&gt; Cell\ndeleteCandidate = fmap . delete\n</code></pre>\n\n<p>Personally I like the second version best, because I find it hard to think about how this composition works, and how it's different from <code>(fmap delete)</code>.</p>\n"}], "owner": {"reputation": 3339, "user_id": 2759719, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/5KMeF.png?s=128&g=1", "display_name": "mrQWERTY", "link": "https://stackoverflow.com/users/2759719/mrqwerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 29358811, "answer_count": 1, "score": 1, "last_activity_date": 1431394197, "creation_date": 1427762225, "question_id": 29358670, "link": "https://stackoverflow.com/questions/29358670/deleting-element-from-a-tuples-list", "title": "Deleting element from a tuple&#39;s list", "body": "<p>I am having trouble writing a function which deletes an element from a list within a tuple. </p>\n\n<p>The problem is, I would like the function to return the tuple. However, using the <code>delete</code> function from <code>Data.List</code> gives me a list. </p>\n\n<p>Code:</p>\n\n<pre><code>-- type Value = Int\ntype Cell = (Int, [Int])\ntype Board = [Cell]\n\n----------- your solution goes here --------------\n\n\n-- solvem :: Board -&gt; Board\n-- solvem bd = ???\ndeleteCandidate :: Int -&gt; Cell -&gt; Cell\ndeleteCandidate cand c1 = delete cand (snd c1) -- This gives me trouble\n\nupdateNeighbors :: Cell -&gt; Cell -&gt; Cell\nupdateNeighbors c1 c2 | isNeighbor c1 c2 = deleteCandidate (head (snd c1)) c2\n                      | otherwise = c2\n</code></pre>\n\n<p>Since data in Haskell is immutable, how would I return a tuple in <code>deleteCandidate</code> function? Would I have to reconstruct a Cell? </p>\n"}, {"tags": ["string", "parsing", "haskell"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1427758579, "post_id": 29357910, "comment_id": 46900749, "body": "Try writing a pure function <code>f :: String -&gt; Int</code>, that takes a line of your input and calculates the gcd first. In a second step apply that function to the input inside <code>main</code>. Also take a look at <code>uncurry :: (a -&gt; b -&gt; c) -&gt; ((a, b) -&gt; c)</code> from the Prelude."}], "answers": [{"comments": [{"owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "edited": false, "score": 0, "creation_date": 1427798419, "post_id": 29358632, "comment_id": 46915840, "body": "You need to skip the first line which only consists of a single number of consequent entries."}, {"owner": {"reputation": 93, "user_id": 4731766, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-F4XGo6ATSXI/AAAAAAAAAAI/AAAAAAAAAAA/1YhSZmpAU_k/photo.jpg?sz=128", "display_name": "midnightconman", "link": "https://stackoverflow.com/users/4731766/midnightconman"}, "edited": false, "score": 0, "creation_date": 1427827366, "post_id": 29358632, "comment_id": 46932626, "body": "Thank you everyone for the quick responses. I see exactly what this is doing now and I will also have to look at uncurry in the prelude."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1427761929, "creation_date": 1427761929, "answer_id": 29358632, "question_id": 29357910, "link": "https://stackoverflow.com/questions/29357910/haskell-trying-to-apply-a-function-to-lines-of-multiple-numbers/29358632#29358632", "title": "Haskell - Trying to apply a function to lines of multiple numbers", "body": "<p>You are pretty close. There is no reason to convert to a tuple or list of tuples before calling <code>gcd</code>. </p>\n\n<pre><code>main = do \n  contents &lt;- getContents \n  print $ map ((\\[x,y] -&gt; gcd (read x) (read y)) . words) . lines $ contents \n</code></pre>\n\n<p>All the interesting stuff is between <code>print</code> and <code>contents</code>. <code>lines</code> will split the contents into lines. <code>map (...)</code> applies the function to each line. <code>words</code> splits the line into words. <code>\\[x,y] -&gt; gcd (read x) (read y)</code> will match on a list of two strings (and throw an error otherwise - not good practice in general but fine for a simple program like this), read those strings as <code>Integer</code>s and compute their GCD.</p>\n\n<p>If you want to make use of lazy IO, in order to print each result after you enter each line, you can change it as follows.</p>\n\n<pre><code>main = do \n  contents &lt;- getContents \n  mapM_ (print . (\\[x,y] -&gt; gcd (read x) (read y)) . words) . lines $ contents \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1427798348, "creation_date": 1427798348, "answer_id": 29366665, "question_id": 29357910, "link": "https://stackoverflow.com/questions/29357910/haskell-trying-to-apply-a-function-to-lines-of-multiple-numbers/29366665#29366665", "title": "Haskell - Trying to apply a function to lines of multiple numbers", "body": "<p>Or, you can do it in a more imperative style:</p>\n\n<pre><code>import Control.Monad\n\nmain = do\n    n &lt;- readLn\n    replicateM_ n $ do\n        [x, y] &lt;- (map read . words) `liftM` getLine\n        print $ gcd x y\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4731766, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-F4XGo6ATSXI/AAAAAAAAAAI/AAAAAAAAAAA/1YhSZmpAU_k/photo.jpg?sz=128", "display_name": "midnightconman", "link": "https://stackoverflow.com/users/4731766/midnightconman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 29358632, "answer_count": 2, "score": 9, "last_activity_date": 1427798348, "creation_date": 1427756961, "question_id": 29357910, "link": "https://stackoverflow.com/questions/29357910/haskell-trying-to-apply-a-function-to-lines-of-multiple-numbers", "title": "Haskell - Trying to apply a function to lines of multiple numbers", "body": "<p>I am new to Haskell and I am trying to apply a function (gcd) to input on standard in, which is line separated and each line contains no less or more than two numbers. Here is an example of my input:</p>\n\n<pre>\n3\n10 4\n1 100\n288 240\n</pre>\n\n<p>I am currently breaking up each line into a tuple of both numbers, but I am having trouble figuring out how to separate these tuples and apply a function to them. Here is what I have so far:</p>\n\n<pre><code>import Data.List\n\nmain :: IO ()\nmain = do\n  n &lt;- readLn :: IO Int\n  content &lt;- getContents\n  let  \n    points = map (\\[x, y] -&gt; (x, y)). map (map (read::String-&gt;Int)). map words. lines $ content\n    ans = gcd (fst points :: Int) (snd points :: Int)\n  print ans\n</code></pre>\n\n<p>Any information as two a good place to start looking for this answer would be much appreciated. I have read through the Learning Haskell tutorial and have not found any information of this particular problem.</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427756055, "post_id": 29357656, "comment_id": 46900083, "body": "A side note, you can un-indent those cases by quite a bit, and it&#39;d be considered better style to put the <code>where</code> at the end of <code>parse&#39;</code> instead of in the middle of the case.  If the values aren&#39;t used they won&#39;t be computed anyway, but it would keep that line from marching off the edge of the screen."}], "answers": [{"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 2, "last_activity_date": 1427794863, "last_edit_date": 1427794863, "creation_date": 1427759333, "answer_id": 29358286, "question_id": 29357656, "link": "https://stackoverflow.com/questions/29357656/how-could-this-parsing-code-be-made-lazy-depending-on-how-much-data-is-consumed/29358286#29358286", "title": "How could this parsing code be made lazy depending on how much data is consumed on the output?", "body": "<p>If you want it lazy, then your function needs to return values that look like this:</p>\n\n<pre><code>instr1 : instr2 : ... : &lt;thunk&gt;\n</code></pre>\n\n<p>Where <code>&lt;thunk&gt;</code> is the rest of the computation. To me, this suggests your function should look like:</p>\n\n<pre><code>parse [] = []\nparse (x:xs) = instr : parse xs\n  where instr = ...\n</code></pre>\n\n<p>I don't know whether you did it deliberately or not, but that auxiliary <code>parse'</code> function with the extra argument in which you accumulate your results is exactly the pattern you'd use to get performance out of a <em>strict</em> language (if it supports tail call elimination). Tail recursion is actually the enemy here!</p>\n\n<p>A tail recursive function with an accumulator is almost necessarily non-lazy, because it's not until you hit the base case and decide what to do with the final accumulator value that the first \"piece\" of the output can be known. So a consumer demanding your output must wait while you process the entire input, and your entire output must be buffered in memory.</p>\n\n<p>The most obvious recipe for lazy recursive code is to for your function to return a data constructor (in this case <code>:</code>) applied to some fields, where your recursive call(s) are stored in one (or more) of the fields. This allows the consumer to inspect the constructor and any other fields you produced before demanding the output of your recursive call.</p>\n\n<p>This also means that if you're writing a recursive function producing a recursive data type and you want it to be lazy, you often end up structuring your function after the structure of your return type - exactly the way recursive consumers usually mirror the structure of their <em>input</em> type. E.g. The prototypical list producer needs a case which returns <code>[]</code> and a case which returns <code>something : recursiveCall</code>.</p>\n"}], "owner": {"reputation": 1998, "user_id": 79475, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7d29c825581e5a220b2ae0c27e4cdce?s=128&d=identicon&r=PG", "display_name": "The_Ghost", "link": "https://stackoverflow.com/users/79475/the-ghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1427794863, "creation_date": 1427755583, "last_edit_date": 1427763868, "question_id": 29357656, "link": "https://stackoverflow.com/questions/29357656/how-could-this-parsing-code-be-made-lazy-depending-on-how-much-data-is-consumed", "title": "How could this parsing code be made lazy depending on how much data is consumed on the output?", "body": "<p>Do anyone have an idea how to make that code lazy and non-strict so it generates AST tree on parsing input data? Currently using lists input is read left to right, but constructed on reverse. Because of that I had to use \"reverse\" on two places.</p>\n\n<pre><code>type Program = [Instruction]\ndata Instruction = Next | Prev | Plus | Minus | Print | Loop [Instruction] deriving Show\n\nparse :: String -&gt; Program\nparse ys = reverse exps where\n        (exps, _) = parse' ys []\n        parse' [] is     = (is, [])\n        parse' (x:xs) is = case x of\n                            '&gt;' -&gt; parse' xs (Next:is)\n                            '&lt;' -&gt; parse' xs (Prev:is)\n                            '+' -&gt; parse' xs (Plus:is)\n                            '-' -&gt; parse' xs (Minus:is)\n                            '.' -&gt; parse' xs (Print:is)\n                            '[' -&gt; parse' after $ Loop (reverse inside):is where (inside, after) = parse' xs []\n                            ']' -&gt; (is, xs)\n                            _   -&gt; parse' xs is\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1427749838, "post_id": 29356209, "comment_id": 46897589, "body": "A sidenote, <code>[x | x &lt;- ys]</code> is equivalent to just <code>ys</code>, so <code>count n = [0..n-1]</code> would suffice."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 4, "creation_date": 1427749974, "post_id": 29356209, "comment_id": 46897656, "body": "I think what you&#39;re wanting to do is <code>\\n xs -&gt; zip (listOfNths n xs) (count n)</code>.  This would typecheck, but is a function in itself.  You&#39;re running into issues here because <code>zip</code> wants both of its inputs to be lists, but both <code>listOfNths</code> and <code>count</code> are functions that return lists.  You need to supply these with input before you&#39;ll be able to zip them together."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1427759101, "post_id": 29356209, "comment_id": 46900857, "body": "<code>fn n xs = (`zip` [0..n-1])  . transpose . chunksOf n $ xs</code>. <code>chunksOf</code> is in <a href=\"https://hackage.haskell.org/package/split-0.2.2/docs/Data-List-Split.html\" rel=\"nofollow noreferrer\"><code>Data.List.Split</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "is_accepted": true, "score": 3, "last_activity_date": 1427750247, "creation_date": 1427750247, "answer_id": 29356474, "question_id": 29356209, "link": "https://stackoverflow.com/questions/29356209/zip-two-lists-produced-by-two-functions-haskell/29356474#29356474", "title": "zip two lists produced by two functions (Haskell)", "body": "<p>If I understand you correctly, you can do this using a simple <code>map</code>:</p>\n\n<pre><code>fn n xs = map (\\x -&gt; (everyf n $ drop x xs, x)) [0..n-1]\n</code></pre>\n\n<p>If you insist on using a zip, then you have to evaluate the functions prior to zipping:</p>\n\n<pre><code>fn n xs = zip (listOfNths n xs) (count n)\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 29356474, "answer_count": 1, "score": 0, "last_activity_date": 1427871916, "creation_date": 1427749281, "question_id": 29356209, "link": "https://stackoverflow.com/questions/29356209/zip-two-lists-produced-by-two-functions-haskell", "title": "zip two lists produced by two functions (Haskell)", "body": "<p>I have two functions (count and listOfNths) that both take parameters and produce a list. I would like to zip the the lists produced by these two functions. How would I go about doing that?\nI tried writing <code>zip listOfNths count</code> but that didn't work.</p>\n\n<pre><code>count n = [ x | x &lt;- [0..n-1]]\n\neveryf n [] = []\neveryf n as  = head as : everyf n (drop n as)\nlistOfNths :: Int -&gt; [a] -&gt; [[a]]\nlistOfNths n xs = map (\\x -&gt; everyf n (drop x xs)) [0..n-1] \n</code></pre>\n\n<p>just a sidenote: the function listOfNths makes use of another function (everyf) but that's not important.</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 1, "last_activity_date": 1458367566, "last_edit_date": 1495539911, "creation_date": 1458367566, "answer_id": 36098495, "question_id": 29355862, "link": "https://stackoverflow.com/questions/29355862/cabal-os-flag-with-operating-system-version/36098495#36098495", "title": "Cabal &quot;os&quot; flag with operating system version", "body": "<p>You're correct. Cabal does not offer this feature. Here's the <a href=\"https://github.com/haskell/cabal/issues/2517\" rel=\"nofollow noreferrer\">relevant ticket</a>. However, for OS X you don't need to necessarily move from <code>build-type: Simple</code>. Rather you can use <code>CPP</code> and the macros provided by apple, as discussed at <a href=\"https://stackoverflow.com/questions/8024961/c-macro-for-os-x-version-lion-or-not-detection\">another SO question</a>.</p>\n"}], "owner": {"reputation": 1835, "user_id": 1337806, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ff032a1a9ace832d80ad4cf65ccf8567?s=128&d=identicon&r=PG", "display_name": "sam boosalis", "link": "https://stackoverflow.com/users/1337806/sam-boosalis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 2, "accepted_answer_id": 36098495, "answer_count": 1, "score": 5, "last_activity_date": 1458367566, "creation_date": 1427748013, "last_edit_date": 1427749274, "question_id": 29355862, "link": "https://stackoverflow.com/questions/29355862/cabal-os-flag-with-operating-system-version", "title": "Cabal &quot;os&quot; flag with operating system version", "body": "<p>I'd like a flag that is conditioned on the version of the OS, and not just the OS:</p>\n\n<pre><code>if os(darwin) &amp;&amp; os-version() &gt;= 10.7\n</code></pre>\n\n<p>or </p>\n\n<pre><code>if os-version(&gt;=10.7)\n</code></pre>\n\n<p>or something with that behavior.</p>\n\n<p>I could do it with <code>make</code> and <code>sw_vers -productVersion</code>, but I want to keep the Cabal file with <code>build-type: Simple</code> (I mean it even has a <code>frameworks</code> field).</p>\n\n<p>Context: I have some bindings to some Cocoa functions that were introduced in OSX 10.7 or so. I'd like Cabal to not try to build on older Macs, rather than spamming the person installing the package with unhelpful \"symbol not found\" errors or whatnot.</p>\n\n<p><a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#configurations\" rel=\"noreferrer\">https://www.haskell.org/cabal/users-guide/developing-packages.html#configurations</a> (Under \"conditions\") seems to say no.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1427746317, "post_id": 29355346, "comment_id": 46895701, "body": "&quot;How can you implement this in general for any valid foo and bar (of the same length)?&quot; --- you cannot make it generic for tuples."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1427746374, "post_id": 29355346, "comment_id": 46895744, "body": "You can&#39;t write a single <code>toImplement</code> that would work with tuples of arbitrary size.  Sure, there are probably some really hackish ways to get it to work using advanced language features and a bunch of extensions, but it&#39;s probably more trouble than it&#39;s worth to copy/paste essentially the same definition several times to get <code>toImplement</code>, <code>toImplement3</code> .. <code>toImplementN</code>."}, {"owner": {"reputation": 2288, "user_id": 515288, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9bb96df13b644d099178e0e2eb43f9b2?s=128&d=identicon&r=PG", "display_name": "GeneralBecos", "link": "https://stackoverflow.com/users/515288/generalbecos"}, "edited": false, "score": 0, "creation_date": 1427747526, "post_id": 29355346, "comment_id": 46896445, "body": "Is there any zen behind why Haskell does not allow working with arbitrary tuples?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 2, "creation_date": 1427748558, "post_id": 29355346, "comment_id": 46896980, "body": "It wouldn&#39;t work not because Haskell lists require that all elements of the list be the same and the list can be of any length (infinity is not frowned upon), but Haskell tuples allow for any type to be in them but they have to be fixed size. So your problem is basically looking for a sweet spot between those two restrictions but it would be practically impossible to find one. Python would let you do this, but not Haskell"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1427749156, "post_id": 29355346, "comment_id": 46897264, "body": "For your fold use case, you can make it a bit nicer by deconstructing the tuple with pattern matching in the lambda: <code>(\\x (a, b) -&gt; ...)</code>. For an even shorter solution, you could use <code>(***)</code> from <code>Control.Arrow</code>: <code>foldr (\\x -&gt; acc1 x *** acc2 x) ([],0) [1..10]</code>. You could even eliminate all the lambdas with <code>Applicative</code> (although I&#39;d suggest the other, simpler <code>(***)</code>-based solution): <code>foldr ((***) &lt;$&gt; acc1 &lt;*&gt; acc2) ([],0) [1..10]</code>."}, {"owner": {"reputation": 2288, "user_id": 515288, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9bb96df13b644d099178e0e2eb43f9b2?s=128&d=identicon&r=PG", "display_name": "GeneralBecos", "link": "https://stackoverflow.com/users/515288/generalbecos"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1427749823, "post_id": 29355346, "comment_id": 46897582, "body": "@DavidYoung: I&#39;m going to take a couple of days to wrap my head around that. Sweet! :)"}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 6, "last_activity_date": 1427746924, "last_edit_date": 1427746924, "creation_date": 1427746621, "answer_id": 29355470, "question_id": 29355346, "link": "https://stackoverflow.com/questions/29355346/applying-tuple-of-functions-to-a-tuple/29355470#29355470", "title": "Applying tuple of functions to a tuple", "body": "<p>As mentioned in the comments, haskell does not allow one to implement generic functions for tuples of arbitrary size. Hence you need to implement a particular function for every size separately.</p>\n\n<p>Eg:</p>\n\n<pre><code>toImplement3 :: (b0 -&gt; c0, b1 -&gt; c1, b2 -&gt; c2) -&gt; (b0, b1, b2) -&gt; (c0, c1, c2)\ntoImplement3 (f1, f2, f3) (a1, a2, a3) = (f1 a1, f2 a2, f3 a3)\n</code></pre>\n"}], "owner": {"reputation": 2288, "user_id": 515288, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9bb96df13b644d099178e0e2eb43f9b2?s=128&d=identicon&r=PG", "display_name": "GeneralBecos", "link": "https://stackoverflow.com/users/515288/generalbecos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 1, "accepted_answer_id": 29355470, "answer_count": 1, "score": 2, "last_activity_date": 1427748748, "creation_date": 1427746120, "last_edit_date": 1495540229, "question_id": 29355346, "link": "https://stackoverflow.com/questions/29355346/applying-tuple-of-functions-to-a-tuple", "title": "Applying tuple of functions to a tuple", "body": "<p>I'm trying to apply a tuple of functions to a tuple of values</p>\n\n<pre><code>\u03bb&gt; let foo = ((+1), (*3), ((:)5))  #Each function has type: a -&gt; a\n\n\u03bb&gt; let bar  = (1, 5, [0])          #Each value of the corresponding tuple has type a\n</code></pre>\n\n<p>How do I implement: </p>\n\n<pre><code>toImplement foo bar = ?\n</code></pre>\n\n<p>such that:</p>\n\n<pre><code>\u03bb&gt; toImplement foo bar\n-&gt; (2, 15, [0,5]) # using foo and bar above\n</code></pre>\n\n<p>How can you implement this in general for any valid foo and bar (of the same length)?</p>\n\n<p>[I looked at <a href=\"https://stackoverflow.com/questions/26092198/haskell-apply-tuple-of-functions-to-tuple-of-values\">this problem</a>, but it is implemented for a fixed type. I require a general implementation]</p>\n\n<p>Motivation:</p>\n\n<p>I'm trying to write folds efficiently. </p>\n\n<pre><code>let acc1 = \\x acc -&gt; x*x:acc\nlet acc2 = (+)\nfoldr (\\x acc -&gt; (acc1 x (fst acc), acc2 x ( snd acc))) ([],0) [1..10]\n&gt; ([1,4,9,16,25,36,49,64,81,100],55)\n</code></pre>\n\n<p>I have 2 different accumulators acc1 &amp; acc2 that loop over the list exactly once. I'd like to do this for arbitrary number of accumulators all of whom have type a -> b [where a is the type of the elements in the list and b is of the type of the output of the accumulator]\nIt looks clumsy, having to access the tuples using fst and snd :/</p>\n"}, {"tags": ["opengl", "haskell", "glut", "glfw"], "comments": [{"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 1, "creation_date": 1427748170, "post_id": 29355109, "comment_id": 46896804, "body": "Please make sure that OpenGL is not in an error state before you do your stuff. Some extension loader wrapper (which are required to obtain the 3.3 functions) are known to leave OpenGL in a error state which must be cleared, so that one doesn&#39;t fool himself."}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 1, "last_activity_date": 1427810997, "creation_date": 1427810997, "answer_id": 29370634, "question_id": 29355109, "link": "https://stackoverflow.com/questions/29355109/invalid-operation-on-shader-loading-and-compiling/29370634#29370634", "title": "&quot;invalid operation&quot; on shader loading and compiling", "body": "<p>I ran your code under gDebugger, and it made it plain:</p>\n\n<pre><code>GL.matrixMode $= GL.Projection\nGL.loadIdentity\nGL.ortho2D 0 (realToFrac w) (realToFrac h) 0\n</code></pre>\n\n<p>This leftover piece of code was triggering an error state:</p>\n\n<blockquote>\n  <p>Error-Code: <code>GL_INVALID_OPERATION</code></p>\n  \n  <p>Error-Description: \n  The specified operation is not allowed in the current state. The offending function is ignored, having no side effect other than to set the error flag.</p>\n</blockquote>\n\n<p>As a side note, shader compilation can never trigger an <code>INVALID_OPERATION</code> (except when you try to render with a broken pipeline); the compilation errors can be obtained by checking the compilation status directly.</p>\n"}], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 29370634, "answer_count": 1, "score": 1, "last_activity_date": 1427810997, "creation_date": 1427745367, "last_edit_date": 1592644375, "question_id": 29355109, "link": "https://stackoverflow.com/questions/29355109/invalid-operation-on-shader-loading-and-compiling", "title": "&quot;invalid operation&quot; on shader loading and compiling", "body": "<h2>Problem</h2>\n<p>Having a shader program in <code>a.vs</code> as:</p>\n<pre><code>#version 330\nin vec2 vPosition;\nvoid main() {\n    gl_Position = vec4(vPosition, 0.0, 1.0);\n}\n</code></pre>\n<p>and given:</p>\n<pre><code>import qualified Graphics.GLUtil as GLU\nimport qualified Graphics.Rendering.OpenGL as GL\n</code></pre>\n<p>this line:</p>\n<pre><code>vs &lt;- GLU.loadShader GL.VertexShader $ shaderPath &lt;/&gt; &quot;a.vs&quot;\n</code></pre>\n<p>causes:</p>\n<blockquote>\n<p>GL: Error InvalidOperation &quot;invalid operation&quot;</p>\n</blockquote>\n<p>at runtime.</p>\n<h2>Details</h2>\n<p>I'm running on Mac OS X 10.10.2. The OpenGL context is set via GLFW with:</p>\n<pre><code>GLFW.windowHint $ GLFW.WindowHint'OpenGLDebugContext True\nGLFW.windowHint $ GLFW.WindowHint'ContextVersionMajor 3\nGLFW.windowHint $ GLFW.WindowHint'ContextVersionMinor 3\nGLFW.windowHint $ GLFW.WindowHint'OpenGLForwardCompat True\nGLFW.windowHint $ GLFW.WindowHint'OpenGLProfile GLFW.OpenGLProfile'Core\n</code></pre>\n<p>giving an OpenGL 3.3 context.</p>\n<p>The context of the code can be found at this <a href=\"https://github.com/Jefffrey/Snok/tree/d04afcd5548ea3ea270a34fdab6f6f70359cb920\" rel=\"nofollow noreferrer\">repository</a> (link to the specific commit), and specifically in <code>Main.hs</code>.</p>\n<h2>Question</h2>\n<p>What can I do to fix this issue or get more debugging informations?</p>\n"}, {"tags": ["haskell", "optimization", "enums"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1427740050, "post_id": 29353104, "comment_id": 46892147, "body": "Not with the standard <code>filter</code>, I don&#39;t think.  You would need some way to inspect the predicate to determine if the search space can be reduced.  The best way would be to make a data type that represents predicates, then you could have something like <code>someFilter :: (Enum a, Bounded a) =&gt; Pred a -&gt; [a]</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1427740122, "post_id": 29353104, "comment_id": 46892194, "body": "Without any assumption on <code>f</code>, no general optimization seems possible. Checking whether there is an element in <code>[0..n]</code> satisfying a given (polytime) predicate <code>f</code> is NP-hard, so ..."}, {"owner": {"reputation": 355, "user_id": 846957, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d105bb56905d5d994839efe39968d3f?s=128&d=identicon&r=PG&f=1", "display_name": "mariusz", "link": "https://stackoverflow.com/users/846957/mariusz"}, "edited": false, "score": 0, "creation_date": 1427743049, "post_id": 29353104, "comment_id": 46893806, "body": "Yeah, I know that in general it&#39;s not possible, but I was hoping I could achieve that implementing both someFilter and a predicate in some specific way and without guarantee for any other cases. Thanks!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1427743570, "post_id": 29353104, "comment_id": 46894131, "body": "In the specific case of checking for equality (and some other cases), if you know that you are operating on an ascending list (such as a list of the form <code>[a..]</code>, as in this case) and you add an <code>Ord</code> requirement (which I imagine would still fit most cases, since we already have <code>Bounded</code> and <code>Enum</code>) you could stop filtering after we reach a value greater than the value being compared against (here, <code>&#39;A&#39;</code>). Without more information about the specific problem being solved though, I don&#39;t think you can do much better."}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 846957, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d105bb56905d5d994839efe39968d3f?s=128&d=identicon&r=PG&f=1", "display_name": "mariusz", "link": "https://stackoverflow.com/users/846957/mariusz"}, "edited": false, "score": 0, "creation_date": 1427744956, "post_id": 29354585, "comment_id": 46894951, "body": "Wow! That&#39;s really elaborate. Thanks a lot."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 3, "last_activity_date": 1427743660, "creation_date": 1427743660, "answer_id": 29354585, "question_id": 29353104, "link": "https://stackoverflow.com/questions/29353104/fast-filtering-over-bounded-enum-type/29354585#29354585", "title": "Fast filtering over Bounded Enum type", "body": "<p>You can't really do this in general, since all you've given the function is that <code>a</code> is <code>Enum</code> and <code>Bounded</code>, which means you'd never be able to tell if the predicate even used <code>==</code> (not that you can do this anyway).  Instead, you can write a custom data type that can be inspected before performing the filter:</p>\n\n<pre><code>import Control.Applicative\n\ninfixr 2 `Or`\ninfixr 3 `And`\ndata Pred a\n    = LessThan a\n    | GreaterThan a\n    | EqualTo a\n    | Generic (a -&gt; Bool)\n    | And (Pred a) (Pred a)\n    | Or  (Pred a) (Pred a)\n\nsomeFilter :: (Enum a, Bounded a, Ord a) =&gt; Pred a -&gt; [a]\nsomeFilter p = go p [minBound ..]\n    where\n        go :: (Enum a, Bounded a, Ord a) =&gt; Pred a -&gt; [a] -&gt; [a]\n        go (LessThan x)    = takeWhile (&lt; x)\n        go (GreaterThan x) = dropWhile (&lt;= x)\n        go (EqualTo x)     = const [x]\n        go (Generic f)     = filter f\n        go (And p q)       = go q . go p\n        go (Or  p q)       = (++) &lt;$&gt; go p &lt;*&gt; go q\n\nnaiveFilter :: (Enum a, Bounded a) =&gt; (a -&gt; Bool) -&gt; [a]\nnaiveFilter f = filter f [minBound ..]\n</code></pre>\n\n<p>This gives you most of the tools you need (not all of them, this is just a rough outline) to recreate basic boolean combinations of ordering predicates with support for generic predicates.  For certain cases <code>someFilter</code> will perform much, much better than <code>naiveFilter</code>, such as for <code>someFilter (LessThan 128) :: [Word32]</code> versus <code>naiveFilter (&lt; 128) :: [Word32]</code>.  On my computer the former finishes in essentially 0s, while the latter I didn't even let run to completion.  You can also run queries like <code>someFilter (And (LessThan 128) (GreaterThan 256)) :: [Word32]</code> that finish immediately, but would take forever with <code>naiveFilter</code>.  I've used <code>Word32</code> instead of <code>Int</code> here to avoid the problem of negative numbers.</p>\n\n<p>If you want to combine a bunch of predicates together you can do</p>\n\n<pre><code>allPs, anyPs :: [Pred a] -&gt; Pred a\nallPs = foldr1 And\nanyPs = foldr1 Or\n</code></pre>\n\n<p>Or you could try building a balanced tree out of it, but this will suffice for simplicity.  It does let you express rather complicated queries fairly easy:</p>\n\n<pre><code>&gt; :set +s\n&gt; someFilter $ EqualTo 1 `Or` EqualTo 100 `Or` LessThan 1000 `And` GreaterThan 975 :: [Word32]\n[1,100,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999]\n(0.00 secs, 0 bytes)\n</code></pre>\n\n<p>Be warned that order of operations matters here because of <code>takeWhile</code> and <code>dropWhile</code>, and you can also end up with duplicates (try making a greater-than-or-equals and less-than-or-equals, you'll see what I mean).  These fixes will start to eat at the performance of this algorithm, but in general you should see no worse performance than <code>naiveFilter</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 1, "last_activity_date": 1427744972, "creation_date": 1427744972, "answer_id": 29354977, "question_id": 29353104, "link": "https://stackoverflow.com/questions/29353104/fast-filtering-over-bounded-enum-type/29354977#29354977", "title": "Fast filtering over Bounded Enum type", "body": "<p>Consider <code>a</code> being <a href=\"https://hackage.haskell.org/package/largeword-1.2.3/docs/Data-LargeWord.html#t:Word160\" rel=\"nofollow\"><code>Word160</code></a> and <code>f</code> being <code>(== w) . sha1</code> for a fixed word <code>w :: Word160</code>, where <code>sha1 :: Word160 -&gt; Word160</code> is some implementation of <a href=\"http://en.wikipedia.org/wiki/SHA-1\" rel=\"nofollow\">SHA-1</a>. Then the predicate is true only for a very small number of inputs (most likely 1). If you had a fast way how to find matching values, you'd be constructing an inverse function to SHA-1, which would allow you to crack digital signatures and all sorts of similar stuff. So no, there is no efficient way how to do this, unless you restrict the predicate somehow.</p>\n"}], "owner": {"reputation": 355, "user_id": 846957, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d105bb56905d5d994839efe39968d3f?s=128&d=identicon&r=PG&f=1", "display_name": "mariusz", "link": "https://stackoverflow.com/users/846957/mariusz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1427744972, "creation_date": 1427738651, "question_id": 29353104, "link": "https://stackoverflow.com/questions/29353104/fast-filtering-over-bounded-enum-type", "title": "Fast filtering over Bounded Enum type", "body": "<p>Let's say I have a function that takes some predicate f and applies it to the whole domain:</p>\n\n<pre><code>someFilter :: (Enum a, Bounded a) =&gt; (a -&gt; Bool) -&gt; [a]\nsomeFilter f = filter f [minBound ..]\n</code></pre>\n\n<p>I also know that this predicate f returns True only for a relatively small number of arguments, e.g.</p>\n\n<pre><code>isA c = (c == 'A')\n</code></pre>\n\n<p>Is it possible to somehow make someFilter fast, i.e. not dependent on the number of possible values of type a, without changing its signature?</p>\n"}, {"tags": ["list", "haskell", "algebraic-data-types", "pattern-synonyms"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1427737265, "post_id": 29352574, "comment_id": 46890663, "body": "I&#39;ve not seen it. Perhaps it would be easier (wrt working with predefined functions) to define <code>newtype ListWithEnd e a = LWE ([a], e)</code>?"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1427737622, "post_id": 29352574, "comment_id": 46890859, "body": "@ThomasM.DuBuisson I need <code>e</code> to be really in the constructor at the end, as I&#39;m experimenting with functions that compute <code>e</code> while constructing the list."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 12, "creation_date": 1427737863, "post_id": 29352574, "comment_id": 46890968, "body": "Trying to express it in terms of standard stuff, <code>type LWE e a = Free ((,) a) e</code> comes  to mind."}, {"owner": {"reputation": 1063, "user_id": 816646, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/f6Tw0.jpg?s=128&g=1", "display_name": "Omar Antol&#237;n-Camarena", "link": "https://stackoverflow.com/users/816646/omar-antol%c3%adn-camarena"}, "edited": false, "score": 1, "creation_date": 1427743611, "post_id": 29352574, "comment_id": 46894155, "body": "Can&#39;t you just use <code>([a],e)</code>?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1427744374, "post_id": 29352574, "comment_id": 46894618, "body": "Very similar to a <code>Producer a Identity e</code> from <code>pipes</code> as well. Following the analogy, a function that decoded bytes into chars and returned any undecoded leftovers would have type <code>forall e . ListWithEnd e Word8 -&gt; ListWithEnd (ListWithEnd e Word8) Char</code>."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 1063, "user_id": 816646, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/f6Tw0.jpg?s=128&g=1", "display_name": "Omar Antol&#237;n-Camarena", "link": "https://stackoverflow.com/users/816646/omar-antol%c3%adn-camarena"}, "edited": false, "score": 5, "creation_date": 1427750492, "post_id": 29352574, "comment_id": 46897921, "body": "@OmarAntol&#237;n-Camarena: That wouldn&#39;t quite be the same because a list does <i>not</i> have to have an end. Particularly, <code>([a], Void)</code> would be isomorphic to <code>Void</code> and not to infinite streams."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1427785663, "post_id": 29352574, "comment_id": 46908832, "body": "@Andr&#225;sKov&#225;cs Could you convert your comment to an answer so that I can accept it?"}], "answers": [{"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 5, "last_activity_date": 1427871715, "last_edit_date": 1427871715, "creation_date": 1427835793, "answer_id": 29378522, "question_id": 29352574, "link": "https://stackoverflow.com/questions/29352574/a-list-whose-nil-carries-a-value/29378522#29378522", "title": "A list whose &quot;Nil&quot; carries a value?", "body": "<p>We can define <code>ListWithEnd</code> as follows:</p>\n\n<pre><code>import Control.Monad.Free\n\ntype LWE a e = Free ((,) a) e\n</code></pre>\n\n<p>We generally have an expectation that abstract or generic representations should reward us with an overall reduction of boilerplate. Let's see what this representation provides us.</p>\n\n<p>In any case, we shall define a pattern synonym for the cons case:</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms #-}\n\npattern x :&gt; xs = Free (x, xs)\ninfixr 5 :&gt;\n</code></pre>\n\n<p>We can map, fold and traverse over the end element:</p>\n\n<pre><code>fmap (+1) (0 :&gt; Pure 0) == (0 :&gt; Pure 1)\ntraverse print (0 :&gt; Pure 1) -- prints 1\n</code></pre>\n\n<p>The <code>Applicative</code> instance gives us very neat concatenation:</p>\n\n<pre><code>xs = 1 :&gt; 2 :&gt; Pure 10\nys = 3 :&gt; 4 :&gt; Pure 20\n\nxs *&gt; ys          == 1 :&gt; 2 :&gt; 3 :&gt; 4 :&gt; Pure 20 -- use right end\nxs &lt;* ys          == 1 :&gt; 2 :&gt; 3 :&gt; 4 :&gt; Pure 10 -- use left end\n(+) &lt;$&gt; xs &lt;*&gt; ys == 1 :&gt; 2 :&gt; 3 :&gt; 4 :&gt; Pure 30 -- combine ends\n</code></pre>\n\n<p>We can map over the list elements, if a bit tortuously:</p>\n\n<pre><code>import Data.Bifunctor -- included in base-4.8!\n\nhoistFree (first (+10)) xs == 11 :&gt; 12 :&gt; Pure 10\n</code></pre>\n\n<p>And we can make use of <code>iter</code>, of course.</p>\n\n<pre><code>iter (uncurry (+)) (0 &lt;$ xs) == 3 -- sum list elements\n</code></pre>\n\n<p>It would be nice if <code>LWE</code> could be a <code>Bitraversable</code> (and <code>Bifunctor</code> and <code>Bifoldable</code>), because then we could access the list elements in a more generic and principled way. For this we definitely need a newtype:</p>\n\n<pre><code>newtype LWE a e = LWE (Free ((,) a) e) deriving (lots of things)\n\ninstance Bifunctor LWE where bimap = bimapDefault\ninstance Bifoldable LWE where bifoldMap = bifoldMapDefault\ninstance Bitraversable LWE where bitraverse = ...\n</code></pre>\n\n<p>But at this point we might think about just writing the plain ADT out and writing the <code>Applicative</code>, <code>Monad</code> and <code>Bitraversable</code> instances in a couple of lines of code. Alternatively, we could use <code>lens</code> and  write a <code>Traversal</code> for the list elements:</p>\n\n<pre><code>import Control.Lens\n\nelems :: Traversal (LWE a e) (LWE b e) a b\nelems f (Pure e)  = pure (Pure e)\nelems f (x :&gt; xs) = (:&gt;) &lt;$&gt; f x &lt;*&gt; elems f xs\n</code></pre>\n\n<p>Thinking further along this line, we should make a <code>Lens</code> for the end element. This is a bit of a bonus over the generic <code>Free</code> interface, since we know that every finite <code>LWE</code> must contain exactly one end element, and we can make this explicit by having a <code>Lens</code> for it (rather than a <code>Traversal</code> or <code>Prism</code>). </p>\n\n<pre><code>end :: Lens (LWE a e) (LWE a e') e e'\nend f (Pure e)  = Pure &lt;$&gt; f e\nend f (x :&gt; xs) = (x :&gt;) &lt;$&gt; end f xs\n</code></pre>\n"}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 2, "accepted_answer_id": 29378522, "answer_count": 1, "score": 12, "last_activity_date": 1452955260, "creation_date": 1427736766, "last_edit_date": 1452955260, "question_id": 29352574, "link": "https://stackoverflow.com/questions/29352574/a-list-whose-nil-carries-a-value", "title": "A list whose &quot;Nil&quot; carries a value?", "body": "<p>Does some standard Haskell library define a data type like this</p>\n\n<pre><code>data ListWithEnd e a = Cons a (ListWithEnd e a)\n                     | End e\n</code></pre>\n\n<p>That is a list whose terminating element carries a value of a designated type? </p>\n\n<p>So <code>ListWithEnd ()</code> is isomorphic to <code>[]</code> and <code>ListWithEnd Void</code> is isomorphic to infinite streams. Or, viewed differently, <code>ListWithEnd e a</code> is very close to <a href=\"http://hackage.haskell.org/package/conduit-1.2.4/docs/Data-Conduit.html#t:ConduitM\" rel=\"nofollow noreferrer\"><code>ConduitM () a Identity e</code></a>..</p>\n"}, {"tags": ["haskell", "types", "algebraic-data-types"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1427734986, "post_id": 29351873, "comment_id": 46889331, "body": "Possible duplicate: <a href=\"http://stackoverflow.com/q/19413438/1333025\">Is there a canonical haskell type for \u201cOne or Both\u201d?</a>"}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 6, "creation_date": 1427736599, "post_id": 29351873, "comment_id": 46890273, "body": "To cut to the punchline: <a href=\"http://hackage.haskell.org/package/these-0.3/docs/Data-These.html\" rel=\"nofollow noreferrer\"><code>Data.These</code></a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1427743146, "post_id": 29351873, "comment_id": 46893875, "body": "BTW, \u201cbundling a <code>Date</code> and a <code>Time</code> value together\u201d is actually the <i>product</i> of both types, not the sum. As an ADT, what you want is written <code>DateTime = Date + Time + Date &#215; Time</code>, or, in Haskell, <code>Either (Either Date Time) (Date, Time)</code>. However, it is better to define the type with <code>data</code> like AJFarmar did, or to use <code>These</code>."}, {"owner": {"reputation": 93814, "user_id": 1659, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6cc331c477243ced5ff968a32a7dd14f?s=128&d=identicon&r=PG", "display_name": "Mark Cidade", "link": "https://stackoverflow.com/users/1659/mark-cidade"}, "edited": false, "score": 0, "creation_date": 1427747902, "post_id": 29351873, "comment_id": 46896655, "body": "I was thinking of a <code>Time</code> as an imaginary <code>Date</code> (<code>Time = Date &#215; sqrt(-1)</code>) : P"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1427735804, "post_id": 29352194, "comment_id": 46889799, "body": "The problem with recursive representation of datetime thing, that it can potentially have more than one recursion level, which doesn&#39;t make sense."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1427737856, "post_id": 29352194, "comment_id": 46890964, "body": "@EugeneSh. What do you mean by recursive?"}, {"owner": {"reputation": 93814, "user_id": 1659, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6cc331c477243ced5ff968a32a7dd14f?s=128&d=identicon&r=PG", "display_name": "Mark Cidade", "link": "https://stackoverflow.com/users/1659/mark-cidade"}, "edited": false, "score": 0, "creation_date": 1427738578, "post_id": 29352194, "comment_id": 46891348, "body": "Can a <code>Both a b</code> include a <code>Both (Both a b) (Both a b)</code>? looks like <code>data Tree a b = Leaf a | Leaf b | Tree a b</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 93814, "user_id": 1659, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6cc331c477243ced5ff968a32a7dd14f?s=128&d=identicon&r=PG", "display_name": "Mark Cidade", "link": "https://stackoverflow.com/users/1659/mark-cidade"}, "edited": false, "score": 2, "creation_date": 1427739894, "post_id": 29352194, "comment_id": 46892056, "body": "@Mark Cidade <code>a</code> and <code>b</code> can stand for any type - why not? But that Tree type is a little off, have another go!"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 5, "last_activity_date": 1427740135, "last_edit_date": 1495535055, "creation_date": 1427735517, "answer_id": 29352194, "question_id": 29351873, "link": "https://stackoverflow.com/questions/29351873/combined-type-one-the-other-or-both/29352194#29352194", "title": "Combined type = one, the other, or both?", "body": "<p>You just made it - of course it's possible!</p>\n\n<p>Here's what I would make it:</p>\n\n<pre><code>data Both a b\n    = First a\n    | Second b\n    | Both a b\n</code></pre>\n\n<p>Interestingly, this is a bifunctor:</p>\n\n<pre><code>import Data.Bifunctor\n\ninstance Bifunctor Both where\n    bimap f _ (First a)  = First (f a)\n    bimap _ g (Second b) = Second (g b)\n    bimap f g (Both a b) = Both (f a) (g b)\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/users/476408/j-abrahamson\">J. Abrahamson</a> said, there is a type called <code>These</code> in the package <a href=\"http://hackage.haskell.org/package/these-0.3/docs/Data-These.html\" rel=\"nofollow noreferrer\"><code>Data.These</code></a>, which includes <code>Monad</code> and <code>Bifunctor</code> instances, as well as some awesome typeclass instances like <code>Bifoldable</code> and <code>Bitraversable</code> that are totally worth having a peek at.</p>\n"}], "owner": {"reputation": 93814, "user_id": 1659, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6cc331c477243ced5ff968a32a7dd14f?s=128&d=identicon&r=PG", "display_name": "Mark Cidade", "link": "https://stackoverflow.com/users/1659/mark-cidade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 29352194, "answer_count": 1, "score": 0, "last_activity_date": 1427747971, "creation_date": 1427734369, "last_edit_date": 1427747971, "question_id": 29351873, "link": "https://stackoverflow.com/questions/29351873/combined-type-one-the-other-or-both", "title": "Combined type = one, the other, or both?", "body": "<p>I'm wondering if this is possible in Haskell:</p>\n\n<pre><code>type DateTime = Date | Time | Date :+ Time\n</code></pre>\n\n<p>...so that it can be either a specific date, a specific time or a complex value made up of both.</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "endianness"], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1427729360, "post_id": 29350065, "comment_id": 46885882, "body": "Thanks! I&#39;d sort of ruled that out for performance reasons, but I should look more closely. I think I could at least do that trick in some template haskell to get a compile-time constant."}], "tags": [], "owner": {"reputation": 174, "user_id": 4730348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26d5b50d69fdcca16760126251d3947?s=128&d=identicon&r=PG&f=1", "display_name": "Guru Evi", "link": "https://stackoverflow.com/users/4730348/guru-evi"}, "is_accepted": true, "score": 7, "last_activity_date": 1427729415, "last_edit_date": 1427729415, "creation_date": 1427728992, "answer_id": 29350065, "question_id": 29349835, "link": "https://stackoverflow.com/questions/29349835/conditionally-compiling-based-on-endianness/29350065#29350065", "title": "Conditionally-compiling based on endianness", "body": "<p>Are you looking for something like this:\n<a href=\"https://hackage.haskell.org/package/cpu-0.1.0/docs/System-Endian.html\">https://hackage.haskell.org/package/cpu-0.1.0/docs/System-Endian.html</a></p>\n\n<p>If you don't want/cannot use these packages, looking at the source code for the above, you can see how to check endianness on any platform with (almost) any lower-level programming language like C or similar. Fill a part of your stack (for a machine with 4 bits: e.g. 1000) and then read back the LSB or MSB of said stack. The Endianness will determine how it is stored (you'll read back 1000 or 0001).</p>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 29350065, "answer_count": 1, "score": 5, "last_activity_date": 1427729415, "creation_date": 1427728363, "question_id": 29349835, "link": "https://stackoverflow.com/questions/29349835/conditionally-compiling-based-on-endianness", "title": "Conditionally-compiling based on endianness", "body": "<p>I'm reading <code>Word</code>s from byte arrays and need to make parts of my code endian-aware. Does GHC expose anything (like <code>MachDeps.h</code>) which I can use to make code conditional on processor endianness? If not can I deduce endianness reliably from <code>HOST_ARCH</code> (from <code>ghcplatform.h</code> accessible in .cabal file with the <code>arch()</code> conditional)? Or other ideas? </p>\n"}, {"tags": ["list", "haskell", "applicative"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1427732359, "post_id": 29348522, "comment_id": 46887813, "body": "Not if you define <code>Monad []</code> or <code>foldMap</code> first!"}], "answers": [{"comments": [{"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 2, "creation_date": 1427786836, "post_id": 29348716, "comment_id": 46909456, "body": "I see what you mean, but my point is about building applicatives &#39;from the ground up&#39;. Every time I see do-notation, my first thought is: &quot;was it REALLY necessary?&quot;"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 10, "last_activity_date": 1427725298, "creation_date": 1427725298, "answer_id": 29348716, "question_id": 29348522, "link": "https://stackoverflow.com/questions/29348522/for-lists-implemented-as-do-notation-isnt-this-cheating/29348716#29348716", "title": "&lt;*&gt; for lists implemented as do notation - isn&#39;t this &quot;cheating&quot;?", "body": "<p>There are lots of cases where the <code>Applicative</code> instance is satisfied by monadic functions, I've seen</p>\n\n<pre><code>instance Applicative MyMonadThatIsAlreadyDefined where\n    pure = return\n    (&lt;*&gt;) = ap\n</code></pre>\n\n<p>Also, <code>&lt;*&gt;</code> can't be written using only <code>fmap</code>, at least not in general.  That's the point of <code>&lt;*&gt;</code>.  Try writing <code>&lt;*&gt;</code> in terms of just <code>fmap</code>, I'll be very surprised if you manage it (in such a way that is well behaved and follows the applicative laws).  Remember that the chain is</p>\n\n<pre><code>Functor &gt; Applicative &gt; Monad\n</code></pre>\n\n<p>Where <code>&gt;</code> can be thought of as superset.  This is saying that the set of all functors contains the set of all applicatives, which contains the set of all monads.  If you have a monad, then you have all the tools needed to use it as an applicative and as a functor.  There are types that are functorial but not applicative, and types that are applicative by not monadic.  I see no problem in defining the applicative instance in this manner.</p>\n"}, {"comments": [{"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 1, "creation_date": 1427728551, "post_id": 29349734, "comment_id": 46885351, "body": "Quite interesting! Do you know how this &lt;- operator is implemented?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 1, "creation_date": 1427729147, "post_id": 29349734, "comment_id": 46885742, "body": "@Muzietto I think this is specialcased as list comprehension. I.e. compiler magic"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 1, "creation_date": 1427729828, "post_id": 29349734, "comment_id": 46886212, "body": "@Muzietto List comprehensions are syntactic sugar for <code>let</code>, <code>if</code>, and <code>concatMap</code>. <code>concatMap</code> doesn&#39;t exist where the <code>Monad</code> and <code>Applicative</code> instances are defined in <code>GHC.Base</code>; I added an explanation of both of these to my answer."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427730369, "post_id": 29349734, "comment_id": 46886595, "body": "@BartekBanachewicz Monad comprehensions are only used when the <a href=\"https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/syntax-extns.html\" rel=\"nofollow noreferrer\"><code>MonadComprehensions</code> extension</a> (7.3.11) is enabled and it isn&#39;t enabled in <code>GHC.Base</code>. No compiler magic is necessary,"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1427758689, "post_id": 29349734, "comment_id": 46900764, "body": "@dfeuer I added a note about how list comprehensions are actually implemented."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 16, "last_activity_date": 1427758126, "last_edit_date": 1427758126, "creation_date": 1427728071, "answer_id": 29349734, "question_id": 29348522, "link": "https://stackoverflow.com/questions/29348522/for-lists-implemented-as-do-notation-isnt-this-cheating/29349734#29349734", "title": "&lt;*&gt; for lists implemented as do notation - isn&#39;t this &quot;cheating&quot;?", "body": "<p>No, this is not sugared monadic code based on <code>&gt;&gt;=</code>. If it were, the <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-Base.html#instance%20Monad%20%5b%5d\">definition of <code>&gt;&gt;=</code></a> in the <code>Monad []</code> instance would be circular.</p>\n\n<pre><code>instance Monad []  where\n    {-# INLINE (&gt;&gt;=) #-}\n    xs &gt;&gt;= f             = [y | x &lt;- xs, y &lt;- f x]\n    ...\n</code></pre>\n\n<p>The list comprehensions are syntactic sugar for <code>let</code>, <code>if</code>, and <code>concatMap</code>. From the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\">Haskell Report</a>:</p>\n\n<blockquote>\n<pre><code>[  e | b,          Q ] = if  b     then [ e | Q ] else []\n[  e | let decls,  Q ] = let decls in   [ e | Q ]\n[  e | p &lt;- l,     Q ] = let ok p  =    [ e | Q ]\n                             ok _  =    []\n                         in concatMap ok l\n</code></pre>\n</blockquote>\n\n<p>The <code>Monad []</code> instance is easy to define in terms of <code>concatMap</code>, but <code>concatMap</code> was defined in <a href=\"http://hackage.haskell.org/package/base-4.7.0.2/docs/src/GHC-List.html#concatMap\"><code>GHC.List</code></a> (and is now possibly defined in <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/src/Data-Foldable.html#concatMap\"><code>Data.Foldable</code></a>). Neither <code>GHC.List</code> nor <code>Data.Foldable</code> is imported into <code>GHC.Base</code>, so defining the <code>Monad</code> instance for lists in <code>GHC.Base</code> in terms of <code>concatMap</code> is impossible:</p>\n\n<pre><code>instance Monad [] where\n    (&gt;&gt;=) = flip concatMap -- concatMap isn't imported\n</code></pre>\n\n<p>Defining these instances in terms of list comprehension gets around needing to import the module containing <code>concatMap</code> to reuse it defining <code>&gt;&gt;=</code>.</p>\n\n<p>In GHC there are two <a href=\"http://downloads.haskell.org/~ghc/latest/docs/html/libraries/ghc/src/DsListComp.html\">implementations of list comprehensions</a>. One rewrites them in terms of the <code>GHC.Base</code> <code>build</code> and <code>foldr</code> similar to the <code>Data.Foldable</code> <code>concatMap</code>. The other implementation generates recursive functions in place of <code>concatMap</code> <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/slpj-book-1987/PAGES/133.HTM\">as described by Wadler</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1427731498, "post_id": 29350265, "comment_id": 46887300, "body": "I was fooled by the Maybe case, but I clearly have still to understand well these concepts. Your answer is good food for thought. BTW, why do you mention &#39;Apply&#39;? I know about &#39;idioms&#39;, but didn&#39;t know about yet another name for applicative functors."}, {"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "reply_to_user": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1427738928, "post_id": 29350265, "comment_id": 46891532, "body": "@Muzietto: I can&#39;t find it now, but I saw somewhere a definition of an <code>Apply</code> class with a <code>&lt;*&gt;</code> method but no <code>unit</code>, which I believe is useful for certain cases involving lenses.  Anyway, the point is that <code>Applicative</code> is <code>unit</code> + <code>&lt;*&gt;</code>, so defining just <code>&lt;*&gt;</code> isn&#39;t good enough to make your type an <code>Applicative</code>."}, {"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 0, "creation_date": 1427819221, "post_id": 29350265, "comment_id": 46927787, "body": "@user3577858: I do mean <code>pure</code>.  Too much Global Script on the brain :)"}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 8, "last_activity_date": 1427819202, "last_edit_date": 1427819202, "creation_date": 1427729596, "answer_id": 29350265, "question_id": 29348522, "link": "https://stackoverflow.com/questions/29348522/for-lists-implemented-as-do-notation-isnt-this-cheating/29350265#29350265", "title": "&lt;*&gt; for lists implemented as do notation - isn&#39;t this &quot;cheating&quot;?", "body": "<blockquote>\n  <p>Am I mistaken, or is this sugared monadic code based on >>= ?</p>\n</blockquote>\n\n<p>I don't know if <code>&gt;&gt;=</code> is actually used to de-sugar list comprehensions (but see Cirdec's answer for evidence that it's not), but it's actually completely legal to define <code>&lt;*&gt;</code> in terms of <code>&gt;&gt;=</code>.  In mathematical terms, every <code>Monad</code> instance <em>induces</em> a unique corresponding <code>Applicative</code> instance, in the sense that</p>\n\n<pre><code>instance Applicative F where\n    pure = return\n    af &lt;*&gt; ax = af &gt;&gt;= \\ f -&gt; ax &gt;&gt;= \\ x -&gt; return (f x)\n</code></pre>\n\n<p>is a law-abiding <code>Applicative</code> instance whenever <code>F</code> has a law-abiding <code>Monad</code> instance.</p>\n\n<p>There's an analogy here from mathematics, if you're familiar with it:</p>\n\n<ul>\n<li>Every <a href=\"http://en.wikipedia.org/wiki/Inner_product_space\" rel=\"nofollow noreferrer\">inner product</a> induces a <a href=\"http://en.wikipedia.org/wiki/Norm_(mathematics)\" rel=\"nofollow noreferrer\">norm</a>;</li>\n<li>Every norm induces a <a href=\"http://en.wikipedia.org/wiki/Metric_(mathematics)\" rel=\"nofollow noreferrer\">metric</a>;</li>\n<li>Every metric induces a <a href=\"http://en.wikipedia.org/wiki/Topology\" rel=\"nofollow noreferrer\">topology</a>.</li>\n</ul>\n\n<p>Similarly, for every monad structure there is a compatible applicative structure, and for every applicative structure there is a compatible <code>fmap</code> (<code>fmap f ax = pure f &lt;*&gt; ax</code>), but the reverse implications do not hold.</p>\n\n<blockquote>\n  <p>As far as I understand, it should be possible to implement &lt;*> only using fmap, as it is the case with applicative Maybe.</p>\n</blockquote>\n\n<p>I don't understand what you mean here.  <code>fmap</code> is certainly not enough to define <code>&lt;*&gt;</code>, or every <code>Functor</code> would be an <code>Applicative</code> (well, an <code>Apply</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "edited": false, "score": 0, "creation_date": 1427786548, "post_id": 29356573, "comment_id": 46909291, "body": "You hit the nail on its head. I appreciated A LOT all the info about Haskell implementation, but this is exactly what I was looking for."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 3, "last_activity_date": 1427819927, "last_edit_date": 1427819927, "creation_date": 1427750634, "answer_id": 29356573, "question_id": 29348522, "link": "https://stackoverflow.com/questions/29348522/for-lists-implemented-as-do-notation-isnt-this-cheating/29356573#29356573", "title": "&lt;*&gt; for lists implemented as do notation - isn&#39;t this &quot;cheating&quot;?", "body": "<p><sub>This answer is complementary to the ones already given, and focusses only on a part of the question:</sub></p>\n\n<blockquote>\n  <p>As far as I understand, it should be possible to implement <code>&lt;*&gt;</code> for lists only using <code>fmap</code>, as it is the case with applicative Maybe. How?</p>\n</blockquote>\n\n<p>You seem to refer to <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids#applicative-functors\" rel=\"nofollow\">this implementation</a>:</p>\n\n<blockquote>\n<pre><code>instance Applicative Maybe where\n    pure = Just\n    Nothing  &lt;*&gt; _         = Nothing\n    (Just f) &lt;*&gt; something = fmap f something\n</code></pre>\n</blockquote>\n\n<p>Well, yes, we can do that for lists as well - using nothing but <code>fmap</code>, pattern matching and constructors:</p>\n\n<pre><code>instance Applicative [] where\n    pure = []\n    []     &lt;*&gt; _         = []\n    (f:fs) &lt;*&gt; something = fmap f something ++ (fs &lt;*&gt; something)\n      where\n        []     ++ yy = ys\n        (x:xs) ++ ys = x : (xs++ys)\n</code></pre>\n\n<p>Admittedly, this does require some kind of concatenation, as lists are a more complex type than Maybes. There are other possible applicative instances for lists that would require less code than this \"everything-with-everything\" behaviour, but those are not compatible to the default monad instance (which is the common expectation).</p>\n\n<p>Of course, monad notation does simplify this dramatically:</p>\n\n<pre><code>instance Monad m =&gt; Applicative m where\n    pure = return\n    mf &lt;*&gt; something = mf &gt;&gt;= (\\f -&gt; fmap f something) -- shorter: (`fmap` something)\n</code></pre>\n\n<p>\u2026which works for both <code>Maybe</code> and <code>[]</code> as <code>m</code>.</p>\n"}], "owner": {"reputation": 2695, "user_id": 1924798, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1ba7bffbe41ca39353b6f8bbfd4624a8?s=128&d=identicon&r=PG", "display_name": "Marco Faustinelli", "link": "https://stackoverflow.com/users/1924798/marco-faustinelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1226, "favorite_count": 2, "accepted_answer_id": 29356573, "answer_count": 4, "score": 9, "last_activity_date": 1427819927, "creation_date": 1427724805, "question_id": 29348522, "link": "https://stackoverflow.com/questions/29348522/for-lists-implemented-as-do-notation-isnt-this-cheating", "title": "&lt;*&gt; for lists implemented as do notation - isn&#39;t this &quot;cheating&quot;?", "body": "<p>According to 'Learn you a Haskell', the implementation of <code>&lt;*&gt;</code> for lists is:</p>\n\n<pre><code>fs &lt;*&gt; xs = [f x | f &lt;- fs, x &lt;- xs]\n</code></pre>\n\n<p>Am I mistaken, or is this sugared monadic code based on <code>&gt;&gt;=</code> ?</p>\n\n<p>As far as I understand, it should be possible to implement &lt;*> only using <code>fmap</code>, as it is the case with applicative Maybe.</p>\n\n<p>How could <code>&lt;*&gt;</code> for lists be implemented only using <code>fmap</code>? (and possibly without concat-ing things?)</p>\n\n<p>BTW, a few pages later I see the same issue with regards to the implementation of <code>&lt;*&gt;</code> for applicative <code>IO</code>.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1427725050, "post_id": 29348370, "comment_id": 46882846, "body": "Not a solution, but a comment.  Perhaps you should define your <code>STable</code> as a list of tuples rather than a list of lists, since, as far as  I see, the inner list is always two elements long. It will move some error checking from run time to compile time.  Also I would consider using two different types for the <code>M</code> part and for the <code>E</code> part, since their meaning seem to me totally different."}, {"owner": {"reputation": 13, "user_id": 4729271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314062f8e22326c2fd2806cb9b603ee2?s=128&d=identicon&r=PG&f=1", "display_name": "spicker", "link": "https://stackoverflow.com/users/4729271/spicker"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1427726568, "post_id": 29348370, "comment_id": 46883908, "body": "The list can be longer than two. I just used two elements in the example to make it more readable. The M value is supposed to be a list of possible E values."}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 3, "last_activity_date": 1427727602, "last_edit_date": 1427727602, "creation_date": 1427727196, "answer_id": 29349430, "question_id": 29348370, "link": "https://stackoverflow.com/questions/29348370/expanding-a-list-of-lists-in-haskell/29349430#29349430", "title": "&quot;Expanding&quot; a List of Lists in Haskell", "body": "<p>Putting together all the possible combinations from items in a list is the bind operator <code>&gt;&gt;=</code> for the <code>Monad []</code> instance. Specialized for lists it has the type</p>\n\n<pre><code>(&gt;&gt;=) :: [a] -&gt; (a -&gt; [b]) -&gt; [b]\n</code></pre>\n\n<p>For every item <code>a</code> in the list, it runs the function <code>a -&gt; [b]</code> to figure out all the possibilities and collects those possibilities in the resulting list <code>[b]</code>. The basic function we want to work with matches this signature; it computes all the possible <code>SFeld</code>s from an initial <code>SFeld</code>.</p>\n\n<pre><code>expandSFeld :: SFeld -&gt; [SFeld]\nexpandSFeld (E x)  = [E x]\nexpandSFeld (M xs) = map E xs\n</code></pre>\n\n<p>The <code>SFeld</code>s are being held in an existing structure, an <code>STable</code> which is a list of lists of <code>SFeld</code>s. We'd like to use the <code>Monad []</code> instance's bind on an <code>STable</code> without changing the structure of the table. In general, the <code>Traverable</code> class describes those structures that can be preserved so that a <code>Monad</code><sup>\u2020</sup> operating inside the structure can be moved to the outside of the structure.</p>\n\n<pre><code>                                     -- v-------------v    flips Traverable from outside to inside      \nsequence :: (Traversable t, Monad m) =&gt; t (m a) -&gt; m (t a)\n     -- flips Monad from inside to outside ^-------^\n</code></pre>\n\n<p><code>Traversable</code> also includes a function, <code>mapM</code>, that maps a function <code>a -&gt; m b</code> over a <code>t a</code> resulting in a <code>m (t b)</code>. The resulting <code>t b</code>s have the same structure as the initial <code>t a</code>.</p>\n\n<pre><code>mapM :: (Traversable t, Monad m) =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\nmapM k = sequence . fmap k\n</code></pre>\n\n<p>Lists have a <code>Traversable</code> instance. This means we can preserve the structure of a list while performing operations in some <code>Monad</code> on each item in the list. We can use this to perform the <code>expandSFeld</code> operation on each item in a row while preserving the structure of the row.</p>\n\n<pre><code>import Data.Traversable\nimport Prelude hiding (mapM)\n\nexpandSRow :: [SFeld] -&gt; [[SFeld]]\nexpandSRow = mapM expandSFeld\n</code></pre>\n\n<p>And we can perform the <code>expandSRow</code> operation on each row in an <code>STable</code> while preserving the structure of the <code>STable</code>.</p>\n\n<pre><code>expandM :: STable -&gt; [STable]\nexpandM = mapM expandSRow\n</code></pre>\n\n<p>The resulting <code>expandM</code> function returns every possible <code>STable</code> obtained by expanding all the <code>M</code>s.</p>\n\n<pre><code>expandM [[E 1,M [1,2]],[M [2,3],E 2]] \n[\n  [[E 1,E 1],[E 2,E 2]],\n  [[E 1,E 1],[E 3,E 2]],\n  [[E 1,E 2],[E 2,E 2]],\n  [[E 1,E 2],[E 3,E 2]]\n]\n</code></pre>\n\n<p><sup>\u2020</sup> The functions from the <code>Traverable</code> class can be used more generally with any <code>Applicative</code> instead of any <code>Monad</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 4729271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314062f8e22326c2fd2806cb9b603ee2?s=128&d=identicon&r=PG&f=1", "display_name": "spicker", "link": "https://stackoverflow.com/users/4729271/spicker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 29349430, "answer_count": 1, "score": 1, "last_activity_date": 1427727602, "creation_date": 1427724458, "last_edit_date": 1427726802, "question_id": 29348370, "link": "https://stackoverflow.com/questions/29348370/expanding-a-list-of-lists-in-haskell", "title": "&quot;Expanding&quot; a List of Lists in Haskell", "body": "<p>I have a table (a list of lists) of a datatype SFeld. SFeld is either a Int or a List of Ints</p>\n\n<pre><code>data SFeld = E Int | M [Int]\n\ntype STable = [[SFeld]]\n</code></pre>\n\n<p>I want to define a function <code>expandM :: STable -&gt; [STable]</code> that takes a STable and \"expands\" every M in it, so that a List of new STables is created for every value in the M List. Sounds very confusing so here is an example:</p>\n\n<pre><code>&gt;&gt; expandM [[E 1,M [1,2]],[M [2,3],E 2,E 4],[E 5]] = \n\n                 [ [[E 1,E 1],[E 2,E 2,E 4],[E 5]]\n                 , [[E 1,E 2],[E 2,E 2,E 4],[E 5]]\n                 , [[E 1,E 1],[E 3,E 2,E 4],[E 5]]\n                 , [[E 1,E 2],[E 3,E 2,E 4],[E 5]]\n                 ]\n</code></pre>\n\n<p>How would I implement a function like this?</p>\n"}, {"tags": ["opengl", "haskell", "shader", "dsl"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1427724800, "post_id": 29346971, "comment_id": 46882654, "body": "Your <code>p &lt;-</code> expression can be more concisely expressed with the <code>Applicative</code> and <code>Alternative</code> instances of <code>Maybe</code>. As to the dsl; My first idea would be to build up a low level dsl for writing shaders and then just combine the higher level effects with premade parts; But I&#39;m not sure what your goal here is."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1427725538, "post_id": 29346971, "comment_id": 46883188, "body": "Oh, really? Do you mind expanding a bit more on that. I didn&#39;t think I could make it more compact!   Well, as for the DSL, the library I&#39;ve mentioned seems to have a decent API for it, so I&#39;d like to know what&#39;s the best way of combining each part. The goal is to be able to have flags determine the output shader in as concise manner as possible. This goes for vertex attributes and uniform variables as well."}, {"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 1, "creation_date": 1427739307, "post_id": 29346971, "comment_id": 46891735, "body": "It&#39;s not quite clear what your question is. Are you trying to build a shader eDSL? Are you trying to integrate the existing one into your engine? Also, the code you posted can be made cleaner by pattern matching on <code>(lighting state, texture state)</code>"}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1427746587, "post_id": 29346971, "comment_id": 46895863, "body": "I&#39;d like to integrate the one mentioned in my original post in to my engine. You mean, assign them variables prior to the case statement?"}], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1427720621, "creation_date": 1427720621, "question_id": 29346971, "link": "https://stackoverflow.com/questions/29346971/shader-building-in-haskell", "title": "Shader building in Haskell", "body": "<p>I'm making a rendering engine in Haskell, and am tackling the way I use shaders based off simple case statements and Maybe data types. </p>\n\n<p>I've got 4 different types of shaders at the moment:</p>\n\n<ul>\n<li><p>Simple Shader,</p></li>\n<li><p>Light Shader (Phong),</p></li>\n<li><p>Texture Shader,</p></li>\n<li><p>Light + Texture Shader</p></li>\n</ul>\n\n<p>At the moment, I've got separate shader files for each of them, but I'd like to introduce the other shading models. There are at least 3 different shading models, and I've not even done colour.</p>\n\n<p>So in total there are 4(Flat, Gourad, Phong, no lighting)*2(Texture on/off)*2(Colour on/off) = 16 possibilities and I don't want to have to have separate shader files for each of them. It just doesn't seem like a good model to have. </p>\n\n<p>So I'd like to build it up using a DSL. This one seems pretty good: <a href=\"https://github.com/fiendfan1/Haskell-GLSL-eDSL\" rel=\"noreferrer\">https://github.com/fiendfan1/Haskell-GLSL-eDSL</a></p>\n\n<p>Does anyone have any tips on how I might do that? I'd like to make it easy to add more possibilities as well, since I'll effectively have to at least double it each time I add something. It gets incredibly cumbersome. </p>\n\n<p>So here's how I do it at the moment:</p>\n\n<pre><code>p &lt;- case (sProgram state) of\n        (Just sp) -&gt; return sp\n        Nothing -&gt; case (lighting state) of \n            (Just _) -&gt; case (texture state) of\n                (Just _) -&gt; ltShader state\n                Nothing -&gt; lShader state\n            Nothing -&gt; case (texture state) of\n                (Just _) -&gt; tShader state\n                Nothing -&gt; sShader state\n</code></pre>\n\n<p>Each shader function sets up the uniform/attribute variables and stuff. Thank you in advance for helping me! </p>\n"}, {"tags": ["haskell", "types", "fold", "unfold"], "comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1427720303, "post_id": 29346581, "comment_id": 46879503, "body": "It looks as if you&#39;ve included <code>snd t</code>, which is the second argument of <code>unfoldr</code> in the original version, in <code>fun</code>, which is supposed to be only the lambda expression?"}], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "edited": false, "score": 0, "creation_date": 1427723642, "post_id": 29346780, "comment_id": 46881852, "body": "I have one more question. Is it possible to move <code>(snd t)</code> to <code>fun</code>? I want to see first line as <code>revRange = unfoldr</code>."}], "tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 7, "last_activity_date": 1427725310, "last_edit_date": 1427725310, "creation_date": 1427720023, "answer_id": 29346780, "question_id": 29346581, "link": "https://stackoverflow.com/questions/29346581/weird-couldnt-match-type-error/29346780#29346780", "title": "Weird couldn&#39;t match type error", "body": "<p>First, format your code:</p>\n\n<pre><code>revRange :: (Char,Char) -&gt; [Char]\nrevRange t = unfoldr fun t\nfun t = (\\b -&gt; if b == (pred (fst t)) \n               then Nothing \n               else Just (b, pred b)) (snd t)\n</code></pre>\n\n<p>Next, double check the type of <code>unfoldr</code> using <a href=\"https://www.haskell.org/hoogle/?hoogle=foldr\" rel=\"nofollow\">Hoogle</a>:</p>\n\n<pre><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\n</code></pre>\n\n<p>Next, add a type signature to <code>fun</code> so that GHC will tell you what the problem is. According to the type of <code>unfoldr</code>, <code>fun</code> should have the type:</p>\n\n<pre><code>b ~ Char\na ~ Char\n\nfun :: Char -&gt; Maybe (Char, Char)\n</code></pre>\n\n<p>since you are <code>unfoldr</code> in the original example with <code>snd t</code>.</p>\n\n<p>I usually like to verify small pieces, so we can remove the definition of <code>foo</code> and just use the type signature:</p>\n\n<pre><code>revRange :: (Char,Char) -&gt; [Char]\nrevRange t = unfoldr fun t\n\nfun:: Char -&gt; Maybe (Char, Char)\nfun b = error \"\"\n</code></pre>\n\n<p>GHC complains that <code>t</code> has type <code>(Char, Char)</code> but <code>fun</code> expects type <code>Char</code>. You've called <code>unfoldr fun t</code> instead of <code>unfoldr fun (snd t)</code> as in the original example. Move that bit from <code>fun</code> into <code>revRange</code>:</p>\n\n<pre><code>revRange :: (Char,Char) -&gt; [Char]\nrevRange t = unfoldr fun (snd t)\n\nfun:: Char -&gt; Maybe (Char, Char)\nfun b = error \"\"\n</code></pre>\n\n<p>Next, add in the definition of <code>fun</code> again. We can remove the lambda and put <code>b</code> as a normal argument to <code>fun</code>:</p>\n\n<pre><code>fun:: Char -&gt; Maybe (Char, Char)\nfun t b = if b == (pred (fst t)) \n          then Nothing \n          else Just (b, pred b)\n</code></pre>\n\n<p>Immediately we see another glaring problems: <code>fun</code> takes <em>two</em> arguments but the signature says it should only take one! </p>\n\n<p>Since <code>t</code> is a constant in the original lambda, we can solve this problem by partially applying <code>fun</code> in <code>revRange</code>, so the final answer is:</p>\n\n<pre><code>revRange :: (Char,Char) -&gt; [Char]\nrevRange t = unfoldr (fun t) (snd t)\n\nfun:: (Char, Char) -&gt; Char -&gt; Maybe (Char, Char)\nfun t b = if b == (pred (fst t)) \n          then Nothing \n          else Just (b, pred b)\n</code></pre>\n\n<hr>\n\n<p>To address your comment, you'd like to write</p>\n\n<pre><code>revRange :: (Char,Char) -&gt; [Char]\nrevRange = unfoldr fun2\n</code></pre>\n\n<p>Using the same approach as above, in the signature of <code>unfoldr</code> we need <code>b ~ (Char,Char)</code> and <code>a ~ Char</code>. So we'd like <code>fun2</code> to have the type</p>\n\n<pre><code>fun2 :: ((Char,Char) -&gt; Maybe (Char, (Char, Char)))\n</code></pre>\n\n<p>I'll leave the definition of <code>fun2</code> as an exercise. As a hint, I suggest adopting the convention that the first part of the pair is constant and holds <code>fst t</code>.</p>\n"}], "owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 29346780, "answer_count": 1, "score": 1, "last_activity_date": 1427725310, "creation_date": 1427719433, "question_id": 29346581, "link": "https://stackoverflow.com/questions/29346581/weird-couldnt-match-type-error", "title": "Weird couldn&#39;t match type error", "body": "<p>I have simple one line function: </p>\n\n<pre><code>revRange :: (Char,Char) -&gt; [Char]\nrevRange t = unfoldr (\\b -&gt; if b == (pred (fst t)) then Nothing else Just (b, pred b)) (snd t)\n</code></pre>\n\n<p>It works well:</p>\n\n<pre><code>*Main Data.List&gt; revRange ('a', 'f')\n\"fedcba\"\n</code></pre>\n\n<p>Then I want to extract unfoldr lambda as unique function:</p>\n\n<pre><code>revRange :: (Char,Char) -&gt; [Char]\nrevRange t = unfoldr fun t\nfun t = (\\b -&gt; if b == (pred (fst t)) then Nothing else Just (b, pred b)) (snd t)\n</code></pre>\n\n<p>Now, I have a weird error:</p>\n\n<pre><code>Couldn't match type `Char' with `(Char, Char)'\nExpected type: (Char, Char) -&gt; Maybe (Char, (Char, Char))\n  Actual type: (Char, Char) -&gt; Maybe (Char, Char)\nIn the first argument of `unfoldr', namely `fun'\nIn the expression: unfoldr fun t\n</code></pre>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1427718814, "post_id": 29346087, "comment_id": 46878499, "body": "Thanks! I probably should have used Text in more places and ByteString in less.... But your solution is great!"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1427724408, "post_id": 29346087, "comment_id": 46882380, "body": "@dsign You should use whichever is more appropriate for your application.  If you&#39;re manipulating actual bytes, then use ByteString, that&#39;s its job.  It&#39;s essentially a <code>Vector Word8</code> under the hood.  If you&#39;re working with ASCII-only data, then it&#39;s appropriate.  If you&#39;re working with actual human readable/writable text, then use Text.  It handles all the hard parts of encoding for you.  If you want to put ByteStrings in a JSON file, maybe you should be looking at <a href=\"http://bsonspec.org/\" rel=\"nofollow noreferrer\">BSON</a> instead."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427726977, "post_id": 29346087, "comment_id": 46884196, "body": "@bheklilr That&#39;s a very good point and the reason I wrote my comment... I used ByteStrings ala Python 2.x str: for both unicode and bytes.... Some of those uses should rather be Texts."}], "tags": [], "owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "is_accepted": true, "score": 4, "last_activity_date": 1427717993, "creation_date": 1427717993, "answer_id": 29346087, "question_id": 29345782, "link": "https://stackoverflow.com/questions/29345782/avoiding-string-round-trip-in-aeson/29346087#29346087", "title": "Avoiding String round-trip in Aeson", "body": "<p><code>aeson</code> uses <code>Text</code> internally for string values, so if you use <code>Data.Text.Encoding.encodeUtf8</code> you won't have the <code>Text -&gt; String -&gt; ByteString</code> conversion, it'll just go straight from <code>Text -&gt; ByteString</code> (which iirc is fairly cheap)</p>\n"}], "owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 29346087, "answer_count": 1, "score": 1, "last_activity_date": 1427717993, "creation_date": 1427717039, "question_id": 29345782, "link": "https://stackoverflow.com/questions/29345782/avoiding-string-round-trip-in-aeson", "title": "Avoiding String round-trip in Aeson", "body": "<p>I have the following code (which is supposed to parse a very trivial <code>{ \"url\": \"http://some.url.here/\" }</code> hash):</p>\n\n<pre><code>import           Control.Applicative\nimport qualified Data.ByteString       as B\nimport           Data.ByteString.Char8 (pack)\n\n\nimport           Data.Aeson            ()\nimport           Data.Aeson.Types\n\n\n\nnewtype SetNextUrl = SetNextUrl B.ByteString\n\ninstance FromJSON SetNextUrl where \n    parseJSON (Object v) = SetNextUrl &lt;$&gt;\n        (pack &lt;$&gt; v .: \"url\" )\n</code></pre>\n\n<p>Now notice that I'm hinting that \"url\" is of type String by using <code>pack</code>... This of course will cause some conversion overhead: from the input ByteString to a [Char] and back....</p>\n\n<p>Question: How can I ask Aeson to interpret the \"url\" field as a ByteString?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 8, "creation_date": 1427710797, "post_id": 29343668, "comment_id": 46873708, "body": "<code>example = id</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 6, "creation_date": 1427710804, "post_id": 29343668, "comment_id": 46873712, "body": "<code>type String = [Char]</code>. A <code>String</code> is just a list of <code>Char</code>\u2026"}, {"owner": {"reputation": 20829, "user_id": 1030110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bsgx2.png?s=128&g=1", "display_name": "m0nhawk", "link": "https://stackoverflow.com/users/1030110/m0nhawk"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1427711398, "post_id": 29343668, "comment_id": 46874065, "body": "@user3237465 That should be an answer!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 7, "creation_date": 1427713883, "post_id": 29343668, "comment_id": 46875477, "body": "yes guys this is a basic question and yes the answer is trivial but why downvote? There is nothing wrong with the question (indeed many beginners might find the question and it&#39;s answers interesting) so please don&#39;t <i>punish</i> beginners like this. The Haskell community is still one of the friendlier online places and we should try to keep it that way. Let&#39;s not get to the point where C#/Java/etc. is on this site."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 5, "creation_date": 1427714308, "post_id": 29343668, "comment_id": 46875752, "body": "Agree with @CarstenK&#246;nig. There is no need to downvote. What may be trivial to an experienced Haskeller may not be easy for the new people learning the language."}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "edited": false, "score": 0, "creation_date": 1427712874, "post_id": 29344118, "comment_id": 46874857, "body": "Could i store the list          [&quot;j&quot;,&quot;t&quot;,&quot;5&quot;,&quot;x&quot;,&quot;=&quot;,&quot;!&quot;]  somewhere ? Because , i want to work with it :("}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "reply_to_user": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "edited": false, "score": 1, "creation_date": 1427713505, "post_id": 29344118, "comment_id": 46875264, "body": "@Chryssa, better state completely what you want to do. Yes, people will spot homework questions, but try to pin down where you are stuck (and include that in your question)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "edited": false, "score": 2, "creation_date": 1427714082, "post_id": 29344118, "comment_id": 46875602, "body": "@Chryssa once you see that <code>[Char] = String</code> and as soon as you understand <code>map</code> you can see that what you are looking for is <code>example :: String -&gt; [String]</code> with <code>example s = map (\\c -&gt; [c]) s</code> - go on and try it in GHCi! (PS: I saw to late that Franky already has that in there too - I let this stand in case you don&#39;t get the <code>(:[])</code> yet ;) ) - PPS: another <code>example s = map return s</code> would work too - as soon as you understand why you will have made your first step up Mountain-M :D"}], "tags": [], "owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "is_accepted": true, "score": 8, "last_activity_date": 1427712184, "creation_date": 1427712184, "answer_id": 29344118, "question_id": 29343668, "link": "https://stackoverflow.com/questions/29343668/string-to-list-of-characters/29344118#29344118", "title": "String to list of characters", "body": "<p>(Collecting comments into an answer)</p>\n\n<p>Because in haskell, a <code>String</code> <strong>is</strong> a list of characters, i.e. <code>[Char]</code>, just returning the input as given will do.</p>\n\n<pre><code>example = id\n</code></pre>\n\n<p>does what you want. Note that <code>id</code> is defined as</p>\n\n<pre><code>id x = x\n</code></pre>\n\n<p>Your example <code>\"jt5x=!\" -&gt; [\"j\",\"t\",\"5\",\"x\",\"=\",\"!\"]</code> does not match the description: Double quotes <code>\"\"</code> enclose <code>String</code>s not single <code>Char</code>acters. For characters use single quotes <code>'</code>. You can type</p>\n\n<pre><code>\"jt5x=!\" == ['j','t','5','x','=','!']\n</code></pre>\n\n<p>into GHCi and see it returns <code>True</code>. Type <code>map (:[]) \"jt5x=!\"</code> to actually see <code>[\"j\",\"t\",\"5\",\"x\",\"=\",\"!\"]</code>.</p>\n"}], "owner": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11166, "favorite_count": 0, "accepted_answer_id": 29344118, "answer_count": 1, "score": 8, "last_activity_date": 1427722393, "creation_date": 1427710683, "last_edit_date": 1427711375, "question_id": 29343668, "link": "https://stackoverflow.com/questions/29343668/string-to-list-of-characters", "title": "String to list of characters", "body": "<p>I was wondering if I can convert a string to a list of characters?</p>\n\n<pre><code>\"jt5x=!\" -&gt; [\"j\",\"t\",\"5\",\"x\",\"=\",\"!\"]\n</code></pre>\n\n<p>Essentially, it would be?</p>\n\n<pre><code>example :: String -&gt; [Char]\n</code></pre>\n"}, {"tags": ["list", "scala", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4728943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164833af4f1f46b85a02d88547793a6?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Buckner", "link": "https://stackoverflow.com/users/4728943/nick-buckner"}, "edited": false, "score": 0, "creation_date": 1427812901, "post_id": 29343275, "comment_id": 46923490, "body": "Ok that makes a lot of sense, I forgot about pattern matching in Scala  thanks a lot"}], "tags": [], "owner": {"reputation": 28428, "user_id": 754787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08882f84df51f9b100d5ed532ee1ca0a?s=128&d=identicon&r=PG", "display_name": "Didier Dupont", "link": "https://stackoverflow.com/users/754787/didier-dupont"}, "is_accepted": true, "score": 5, "last_activity_date": 1427711776, "last_edit_date": 1427711776, "creation_date": 1427709534, "answer_id": 29343275, "question_id": 29342974, "link": "https://stackoverflow.com/questions/29342974/implementing-a-list-of-ints-in-scalas-case-classes-not-working/29343275#29343275", "title": "Implementing a list of Ints in Scala&#39;s case classes not working", "body": "<p>You could do that very much like in Haskell</p>\n\n<pre><code>def printList(x: List1) = {\n   x match {\n     case Cons(hd, tl) =&gt; println(hd); printList(tl)\n     case Nil =&gt; \n  }\n}  \n</code></pre>\n\n<p>Your problem is that <code>acc != Nil</code> is not enough for the compiler to understand that <code>acc</code> is a <code>Cons</code>. <code>head</code> and <code>tail</code> are available on <code>Cons</code> only. Pattern matching is the normal way to go. Otherwise (more object-like), make <code>head</code> and <code>tail</code> available in <code>List1</code> : </p>\n\n<pre><code>sealed trait List1 {\n   def head: Int\n   def tail: List1\n   def isEmpty: Boolean\n}\n\ncase class Cons(head: Int, tail: List1) extends List1 {\n  def isEmpty = false\n}\n\ncase object Nil extends List1 {\n   def head = sys.error(\"Head on Nil\")\n   def tail = sys.error(\"Tail on Nil\")\n   def isEmpty = true\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4728943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e164833af4f1f46b85a02d88547793a6?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Buckner", "link": "https://stackoverflow.com/users/4728943/nick-buckner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 29343275, "answer_count": 1, "score": 1, "last_activity_date": 1427711776, "creation_date": 1427708711, "last_edit_date": 1427709594, "question_id": 29342974, "link": "https://stackoverflow.com/questions/29342974/implementing-a-list-of-ints-in-scalas-case-classes-not-working", "title": "Implementing a list of Ints in Scala&#39;s case classes not working", "body": "<p>Why do I get an error when trying to implement a linked list in Scala using case classes? </p>\n\n<p>As I am quite familiar with Haskell I am essentially trying to convert this Haskell code into Scala:</p>\n\n<pre><code>Data List = Cons Int List | Nil\n\ninstance Show List where\n    show x = helper x \"\"\n        where\n            helper Nil acc = acc\n            helper (Cons n xs) acc = let y = acc ++ \" \" ++ show n in helper xs y\n</code></pre>\n\n<p>Here is my Scala code: </p>\n\n<pre><code>abstract class List1\ncase class Cons(head : Int, tail : List1) extends List1\ncase object Nil extends List1\n\nobject thing {\n    def printList (x : List1) {\n        var acc = x\n        while (acc != Nil) {\n            println (acc.head)\n            acc = acc.tail\n            }\n        }\n    val a : List1 = Cons(1,Cons(2,Cons(3,Cons(4,Nil))))\n    printList(a)\n}\n</code></pre>\n\n<p>However, I get a strange error saying that when I call acc.tail, this is not part of List1, nor is Nil, even though they both extend List1. I don't really understand OOP (just procedural and functional programming) so I assume something funky is happening with the type system and the object system.</p>\n"}, {"tags": ["haskell", "functor"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1427708997, "creation_date": 1427708997, "answer_id": 29343080, "question_id": 29342792, "link": "https://stackoverflow.com/questions/29342792/precedence-confusion-about-and-in-haskell/29343080#29343080", "title": "Precedence Confusion about &lt;$&gt; and &lt;*&gt; in Haskell", "body": "<p><code>&lt;$&gt;</code> and <code>&lt;*&gt;</code> has same precedence and left associativity. <code>$</code> has the lowest precedence of zero. You can use <code>ghci</code> to explore information about them:</p>\n\n<pre><code>\u03bb&gt; :i (&lt;$&gt;)\n(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n        -- Defined in \u2018Data.Functor\u2019\ninfixl 4 &lt;$&gt;\n\n\u03bb&gt; :i (&lt;*&gt;)\nclass Functor f =&gt; Applicative (f :: * -&gt; *) where\n  ...\n  (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n  ...\n        -- Defined in \u2018Control.Applicative\u2019\ninfixl 4 &lt;*&gt;\n</code></pre>\n\n<p>Now you can work out the types to see how they typecheck.</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 5, "last_activity_date": 1427709012, "creation_date": 1427709012, "answer_id": 29343088, "question_id": 29342792, "link": "https://stackoverflow.com/questions/29342792/precedence-confusion-about-and-in-haskell/29343088#29343088", "title": "Precedence Confusion about &lt;$&gt; and &lt;*&gt; in Haskell", "body": "<p>indeed they both have the same precedence (<code>infixl 4</code>: <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Applicative.html#v:-60--42--62-\" rel=\"noreferrer\"><code>(&lt;*&gt;)</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Applicative.html#v:-60--36--62-\" rel=\"noreferrer\"><code>(&lt;$&gt;)</code></a>) and you can just read it from left to right - </p>\n\n<pre><code>(+) &lt;$&gt; (+3) &lt;*&gt; (*100) $ 5\n= ((+) &lt;$&gt; (+3)) &lt;*&gt; (*100) $ 5\n= (\\ a b -&gt; (a+3) + b) &lt;*&gt; (\\ a -&gt; a*100) $ 5\n= (\\ a -&gt; (a+3) + (a*100)) $ 5\n= 8 + 500 = 508\n</code></pre>\n\n<p><strong>remember</strong> in this case we have <code>f &lt;*&gt; g = \\x -&gt; f x (g x)</code></p>\n"}], "owner": {"reputation": 3369, "user_id": 645703, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/53dff9cde38dd11e5e3f2368a3da1193?s=128&d=identicon&r=PG", "display_name": "Matt Elson", "link": "https://stackoverflow.com/users/645703/matt-elson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 29343080, "answer_count": 2, "score": 1, "last_activity_date": 1427734797, "creation_date": 1427708121, "last_edit_date": 1427734797, "question_id": 29342792, "link": "https://stackoverflow.com/questions/29342792/precedence-confusion-about-and-in-haskell", "title": "Precedence Confusion about &lt;$&gt; and &lt;*&gt; in Haskell", "body": "<p>Two examples both from <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids#applicative-functors\" rel=\"nofollow\">http://learnyouahaskell.com/functors-applicative-functors-and-monoids#applicative-functors</a>,</p>\n\n<p>1). <code>(+) &lt;$&gt; (+3) &lt;*&gt; (*100) $ 5</code></p>\n\n<pre><code> (+) &lt;$&gt; (+3) &lt;*&gt; (*100) $ 5, the 5 first got applied to (+3) and\n (*100), resulting in 8 and 500. Then, + gets called with 8 and 500,\n resulting in 508.\n</code></pre>\n\n<p>From the first example, it seems like <code>&lt;*&gt;</code> has higher precedence than <code>&lt;$&gt;</code>.</p>\n\n<p>2).  <code>(++) &lt;$&gt; Just \"johntra\" &lt;*&gt; Just \"volta\"</code></p>\n\n<pre><code> (++) &lt;$&gt; Just \"johntra\" &lt;*&gt; Just \"volta\",   resulting in a value\n that's the same as Just (\"johntra\"++),and now Just (\"johntra\"++) &lt;*&gt;\n Just \"volta\" happens, resulting in Just \"johntravolta\".\n</code></pre>\n\n<p>From the second example, it seems like <code>&lt;$&gt;</code> has higher precedence than <code>&lt;*&gt;</code>.</p>\n\n<p>So do they have the same precedence? can someone give me some explanations/references?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1427703498, "post_id": 29341268, "comment_id": 46869744, "body": "<code>n:</code> is not a valid expression. <code>(n:)</code> is, but it won&#39;t type-check..."}, {"owner": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427706471, "post_id": 29341268, "comment_id": 46871267, "body": "I fixed it, but now I have another error. How exactly should I check <i>If the head is empty</i> ?"}, {"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 0, "creation_date": 1428354166, "post_id": 29341268, "comment_id": 47119783, "body": "If you have a new problem ask a new question."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 4, "last_activity_date": 1427707017, "creation_date": 1427707017, "answer_id": 29342414, "question_id": 29341268, "link": "https://stackoverflow.com/questions/29341268/error-syntax-error-in-expression-unexpected/29342414#29342414", "title": "ERROR : Syntax error in expression (unexpected `|&#39;)", "body": "<p>Note that <code>n:</code> is not correct. What you want to do is instead return <code>[n]</code> or <code>n:[]</code>. Also you can use pattern matching to check for the empty case:</p>\n\n<pre><code>update1 :: Int-&gt;[Int]-&gt;[Int] \nupdate1 n [] = [n]\nupdate1 n (h:t)\n    | n == h = update1 n t \n    | otherwise = h : update1 n t\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 4682412, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc45df0e68bd9901cda357f4b6aeb1c8?s=128&d=identicon&r=PG&f=1", "display_name": "heiLou", "link": "https://stackoverflow.com/users/4682412/heilou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 29342414, "answer_count": 1, "score": 2, "last_activity_date": 1427707017, "creation_date": 1427703030, "question_id": 29341268, "link": "https://stackoverflow.com/questions/29341268/error-syntax-error-in-expression-unexpected", "title": "ERROR : Syntax error in expression (unexpected `|&#39;)", "body": "<p>\u0399 want to achieve this structure in lists </p>\n\n<pre><code>Main&gt; update 1 []\n[1]\nMain&gt; update 2 [2]\n[2]\nMain&gt; update 6 [1,2,5,8]\n[1,2,5,8,6]\nMain&gt; 7 [7,7,7,3,4,5,8]\n[3,4,5,8,7]\n-}\n</code></pre>\n\n<p>and my code is , </p>\n\n<pre><code>update :: Int-&gt;[Int]-&gt;[Int]\n\nupdate n s  \n    = update1 n s\n\n\nupdate1 :: Int-&gt;[Int]-&gt;[Int] \nupdate1 n (h:t)\n    | h==[] =  n: \n    | n==h = update1 n t \n    | otherwise = h : update1 n t\n</code></pre>\n\n<p><strong><em>Where</em></strong> and <strong><em>why</em></strong> am i wrong ? </p>\n"}, {"tags": ["haskell", "recursion", "operators", "call", "tail-call"], "comments": [{"owner": {"reputation": 108835, "user_id": 15541, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/515ca9736a9a8ce65e58af764ccddf46?s=128&d=identicon&r=PG", "display_name": "leppie", "link": "https://stackoverflow.com/users/15541/leppie"}, "edited": false, "score": 0, "creation_date": 1427702901, "post_id": 29341185, "comment_id": 46869497, "body": "It can only a be a tail call if the function call is in the tail position."}, {"owner": {"reputation": 115, "user_id": 4728743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf9507cd18350348b44f7aa3eb24f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Karroffel", "link": "https://stackoverflow.com/users/4728743/karroffel"}, "reply_to_user": {"reputation": 108835, "user_id": 15541, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/515ca9736a9a8ce65e58af764ccddf46?s=128&d=identicon&r=PG", "display_name": "leppie", "link": "https://stackoverflow.com/users/15541/leppie"}, "edited": false, "score": 0, "creation_date": 1427703508, "post_id": 29341185, "comment_id": 46869749, "body": "Oh. You&#39;re right. GHC rewrites the pattern matching to case expressions. But even there it could be possible to do a tail call because the call is in the last place in the function"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1427703593, "post_id": 29341185, "comment_id": 46869784, "body": "Tail call /= tail recursive."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1427713843, "post_id": 29341185, "comment_id": 46875450, "body": "There is indeed a tail call.  The <code>fact</code> function will tail call the <code>(*)</code> function."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1517454561, "post_id": 29341185, "comment_id": 84105751, "body": "<a href=\"https://stackoverflow.com/questions/13042353/does-haskell-have-tail-recursive-optimization\">Related</a>"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4728743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf9507cd18350348b44f7aa3eb24f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Karroffel", "link": "https://stackoverflow.com/users/4728743/karroffel"}, "edited": false, "score": 0, "creation_date": 1427704160, "post_id": 29341358, "comment_id": 46870051, "body": "So it&#39;s the nature of the <code>(+)</code> operator. Maybe the <code>(+)</code> implementation keeps the value on the stack and that&#39;s why i get a stack overflow and not a heap overflow"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 115, "user_id": 4728743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf9507cd18350348b44f7aa3eb24f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Karroffel", "link": "https://stackoverflow.com/users/4728743/karroffel"}, "edited": false, "score": 1, "creation_date": 1427936949, "post_id": 29341358, "comment_id": 46982177, "body": "@dosenfrucht, thinking about tail calls in Haskell may lead you astray, because Haskell&#39;s evaluation model is very different from Scheme&#39;s or ML&#39;s. However, the fact that <code>*</code> is strict in its second argument means that you will face the same problem as a result of <code>fact (n-1)</code> not being in tail position as you would in a strict language."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1427703787, "last_edit_date": 1427703787, "creation_date": 1427703384, "answer_id": 29341358, "question_id": 29341185, "link": "https://stackoverflow.com/questions/29341185/does-every-haskell-function-do-tail-calls/29341358#29341358", "title": "Does every Haskell function do tail calls?", "body": "<p>In the code</p>\n\n<pre><code>fact 0 = 1\nfact n = (*) n (fact (n - 1))\n</code></pre>\n\n<p>the last <code>(*) ...</code> is a tail call, as you observed. The last argument <code>fact (n-1)</code> however will build a thunk which is immediately demanded by <code>(*)</code>. This leads to a non-tail call to <code>fact</code>. Recursively, this will consume the stack.</p>\n\n<p>TL;DR: the posted code performs a tail call, but <code>(*)</code> does not.</p>\n\n<p>(Also \"the stack\" in Haskell is a not so clear notion as in strict languages. Some implementations of Haskell use something more complex than that. You can search for \"push/enter vs eval/apply\" strategies if you want some gory details.)</p>\n"}], "owner": {"reputation": 115, "user_id": 4728743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf9507cd18350348b44f7aa3eb24f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Karroffel", "link": "https://stackoverflow.com/users/4728743/karroffel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 29341358, "answer_count": 1, "score": 1, "last_activity_date": 1427935948, "creation_date": 1427702696, "last_edit_date": 1427935948, "question_id": 29341185, "link": "https://stackoverflow.com/questions/29341185/does-every-haskell-function-do-tail-calls", "title": "Does every Haskell function do tail calls?", "body": "<p>I wondered that every function in Haskell should be tail recursive.</p>\n\n<p>The factorial function implemented as a non tail recursive function:</p>\n\n<pre><code>fact 0 = 1\nfact n = n * fact (n - 1)\n</code></pre>\n\n<p>Every operator is a function too, so this is equivalent to</p>\n\n<pre><code>fact 0 = 1\nfact n = (*) n (fact (n - 1))\n</code></pre>\n\n<p>But this is clearly a tail call to me. I wonder why this code causes stack overflows if every call just creates a new thunk on the heap. Shouldn't i get a heap overflow?</p>\n"}, {"tags": ["algorithm", "haskell", "data-structures", "tree"], "comments": [{"owner": {"reputation": 811, "user_id": 1253717, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/67542021e3e030ebe641f3eaabff7fa9?s=128&d=identicon&r=PG&f=1", "display_name": "working", "link": "https://stackoverflow.com/users/1253717/working"}, "edited": false, "score": 0, "creation_date": 1587311434, "post_id": 29340070, "comment_id": 108455918, "body": "<code>data Tree a = Leaf a | Branch (Tree a) a (Tree a)</code> should work as well right?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1427708716, "post_id": 29340477, "comment_id": 46872544, "body": "I can understand that a type can be seen to be &quot;definitely better&quot; because it allows to represent more cases, but more flexible does not always equate with &quot;better&quot;. I mean -- by the same argument one could say that rose trees are better than binary trees since they can represent more trees."}, {"owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1427714049, "post_id": 29340477, "comment_id": 46875580, "body": "@chi Binary trees are explicitly mentioned in the question(if they were not mentioned explicitly, it would be another question). A binary tree is a well-defined notion and the latter version does not allow to represent them."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1427740162, "post_id": 29340477, "comment_id": 46892219, "body": "It is not better in all cases. Some data structures are implemented as trees that only have data in the leaves. A Huffman code tree would be better represented by the second version, for example. Also, both cases that you mentioned can be represented with the second tree using <code>Tree (Maybe a)</code> (that would end up being isomorphic to the first one)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1427742648, "post_id": 29340477, "comment_id": 46893562, "body": "Oops, actually that wouldn&#39;t be isomorphic. I stand by my other point, though."}], "tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": false, "score": 2, "last_activity_date": 1427700242, "creation_date": 1427700242, "answer_id": 29340477, "question_id": 29340070, "link": "https://stackoverflow.com/questions/29340070/how-should-i-define-a-binary-tree-in-haskell/29340477#29340477", "title": "How should I define a binary tree in Haskell?", "body": "<p>The former is definitely better because it can represent an arbitrary binary tree, which is not the case for the latter. For instance, the second version cannot represent:</p>\n\n<ol>\n<li><p>An empty tree.</p></li>\n<li><p>A tree which has a node that has a left child but not the right one(and vice versa).</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 7, "last_activity_date": 1427702505, "creation_date": 1427702505, "answer_id": 29341125, "question_id": 29340070, "link": "https://stackoverflow.com/questions/29340070/how-should-i-define-a-binary-tree-in-haskell/29341125#29341125", "title": "How should I define a binary tree in Haskell?", "body": "<p>It largely depends on your application. The former definition is better if the shape of the tree is determined by the elements, for example if you have a balanced binary tree:</p>\n\n<p><img src=\"https://i.stack.imgur.com/0OtG8.png\" alt=\"enter image description here\"></p>\n\n<p>On the other hand, if your tree acts as a container for unconstrained elements where the shape of the tree doesn't depend on them, it makes more sense to put the values to the leaves.</p>\n\n<p><a href=\"http://apfelmus.nfshost.com/articles/monoid-fingertree.html\" rel=\"noreferrer\">This post</a> by Heinrich Apfelmus shows very nicely such an approach. He defines</p>\n\n<pre><code>data Tree v a = Leaf   v a\n              | Branch v (Tree v a) (Tree v a)\n</code></pre>\n\n<p>So values of type <code>a</code> are just at leaves, but all nodes (both internal and leaves) are annotated by type <code>v</code>, and just by choosing various <a href=\"http://en.wikipedia.org/wiki/Monoid\" rel=\"noreferrer\">monoids</a> for <code>v</code>, we get different interesting data structures.</p>\n"}, {"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 5, "last_activity_date": 1427708327, "last_edit_date": 1427708327, "creation_date": 1427708019, "answer_id": 29342763, "question_id": 29340070, "link": "https://stackoverflow.com/questions/29340070/how-should-i-define-a-binary-tree-in-haskell/29342763#29342763", "title": "How should I define a binary tree in Haskell?", "body": "<p>As @PetrPudl\u00e1k says, it depends.  The former is better for search trees.  However, the latter version is a (free) <em>monad</em>, which can also be useful:</p>\n\n<pre><code>instance Monad Tree where\n    return = Leaf\n    Leaf x &gt;&gt;= f = f x\n    Branch t1 t2 &gt;&gt;= f = Branch (t1 &gt;&gt;= f) (t2 &gt;&gt;= f)\n</code></pre>\n\n<p>The <code>(&gt;&gt;=)</code> operator corresponds to \"substitution at the leaves\".</p>\n\n<p>The <code>Functor</code> and <code>Applicative</code> instances are useful as well.\nWith GHC 7.10 out they have become mandatory when you define <code>Monad</code>.  We can use monad functions to define them:</p>\n\n<pre><code>instance Functor Tree where fmap = Control.Monad.liftM\ninstance Applicative Tree where pure = return; (&lt;*&gt;) = Control.Monad.ap\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1790, "user_id": 3350784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTuvN.png?s=128&g=1", "display_name": "Yuuri", "link": "https://stackoverflow.com/users/3350784/yuuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1427800342, "creation_date": 1427800342, "answer_id": 29367312, "question_id": 29340070, "link": "https://stackoverflow.com/questions/29340070/how-should-i-define-a-binary-tree-in-haskell/29367312#29367312", "title": "How should I define a binary tree in Haskell?", "body": "<p>I consider the latter one to be hardly useful, because it can be flattened to (non-empty) lists, and the only difference is the branch structure. Which is still, however, hard to analyze at the runtime because no additional information is carried by internal nodes; and when you see a branch, you can't say anything about any of its two subtrees. To differ them, you'll have to traverse all over them and essentially kill the O(<em>log n)</em> complexity for which we do prefer trees.</p>\n\n<p>If anyone finds a use case for such data structure, please let me know.</p>\n"}], "owner": {"reputation": 4045, "user_id": 1797689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d5fa04a0cd9861cf042ce8eadbc1804b?s=128&d=identicon&r=PG", "display_name": "khateeb", "link": "https://stackoverflow.com/users/1797689/khateeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2119, "favorite_count": 0, "accepted_answer_id": 29341125, "answer_count": 4, "score": 6, "last_activity_date": 1427800342, "creation_date": 1427698560, "last_edit_date": 1427701060, "question_id": 29340070, "link": "https://stackoverflow.com/questions/29340070/how-should-i-define-a-binary-tree-in-haskell", "title": "How should I define a binary tree in Haskell?", "body": "<p>In Haskell, a binary tree can be defined in either of the two ways:</p>\n\n<pre><code>data Tree a = Empty | Branch a (Tree a) (Tree a)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>data Tree a = Leaf a | Branch (Tree a) (Tree a)\n</code></pre>\n\n<p>What are the advantages of choosing one over the other? In which situations is one tree structure a better suit over the other?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427703558, "post_id": 29340053, "comment_id": 46869770, "body": "You could try <code>-fno-full-laziness</code> in <code>OPTIONS</code>."}, {"owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427705808, "post_id": 29340053, "comment_id": 46870924, "body": "@Andr&#225;sKov&#225;cs Hey thanks that seemed to do the trick! Do you know where in the core the result is being cached?"}], "answers": [{"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 5, "last_activity_date": 1427729433, "last_edit_date": 1427729433, "creation_date": 1427709536, "answer_id": 29343278, "question_id": 29340053, "link": "https://stackoverflow.com/questions/29340053/preventing-caching-of-computation-in-criterion-benchmark/29343278#29343278", "title": "Preventing caching of computation in Criterion benchmark", "body": "<p>The result is being cached in your <code>lvl_r6yu</code>. You can see that <code>lst1</code> is <code>[0..num]</code> lifted out to the top level, and from <code>$wlgo 0 lst1</code> it can be seen that the result of the summation is lifted out too. </p>\n\n<p>It's easier to see what's happening if we add the top level definition <code>foo = mysum . lst</code>, and then look at the core for <code>foo</code>. You can see there that <code>foo</code> is a constant function returning the result of the summation. </p>\n\n<p>If we add <code>{-# OPTIONS -fno-full-laziness #-}</code>, then subexpressions will not be lifted, and therefore the benchmark will work as intended. </p>\n\n<p>It is a good idea in general when using <code>criterion</code> to control evaluation through the arguments supplied to <code>whnf</code>. In our case:</p>\n\n<pre><code>bench \"mysum\" $ whnf (\\size -&gt; mysum [1..size]) num\n</code></pre>\n\n<p>This works fine regardless of optimization or lifting. </p>\n"}], "owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 29343278, "answer_count": 1, "score": 4, "last_activity_date": 1427729433, "creation_date": 1427698505, "last_edit_date": 1495542494, "question_id": 29340053, "link": "https://stackoverflow.com/questions/29340053/preventing-caching-of-computation-in-criterion-benchmark", "title": "Preventing caching of computation in Criterion benchmark", "body": "<p>The following code (suggested by Reid Barton at <a href=\"https://stackoverflow.com/a/29336593/917635\">Criterion causing memory consumption to explode, no CAFs in sight</a>)\nhas a benchmark time which scales <strong><em>proportionally</em></strong> with <code>num</code> \nwhen compiled with <code>O0</code> optimization. However using <code>O3</code> optimization seems to result in a benchmark time which is <strong><em>independent</em></strong> of <code>num</code>. Where in the core is the result being cached, and what can I do to prevent it from being cached?</p>\n\n<p>The code is : </p>\n\n<pre><code>{-# OPTIONS_GHC -fno-cse #-}\n{-# LANGUAGE BangPatterns #-}\nmodule Main where\nimport Criterion.Main\nimport Data.List\n\nnum :: Int\nnum = 100000000\n\nlst :: a -&gt; [Int]\nlst _ = [1,2..num]\n\nmyadd :: Int -&gt; Int -&gt; Int\nmyadd !x !y = let !result = x + y in\n  result\n\nmysum = foldl' myadd 0\n\nmain :: IO ()\nmain = defaultMain [\n  bgroup \"summation\" \n    [bench \"mysum\" $ whnf (mysum . lst) ()]\n  ]\n</code></pre>\n\n<p>and the core is : </p>\n\n<pre><code>main7\nmain7 = unpackCString# \"mysum\"#\n\nmain8\nmain8 = unpackCString# \"summation\"#\n\nRec {\n$wlgo\n$wlgo =\n  \\ ww_s6vW w_s6vT -&gt;\n    case w_s6vT of _ {\n      [] -&gt; ww_s6vW;\n      : x_a4dz xs_a4dA -&gt;\n    case x_a4dz of _ { I# ipv_s4d4 -&gt;\n    $wlgo (+# ww_s6vW ipv_s4d4) xs_a4dA\n    }\n    }\nend Rec }\n\nlst1\nlst1 = efdtInt 1 2 100000000\n\nlvl_r6yu\nlvl_r6yu = case $wlgo 0 lst1 of ww_s6w5 { __DEFAULT -&gt; I# ww_s6w5 }\n\nRec {\nmain_$s$wa\nmain_$s$wa =\n  \\ sc_s6xB sc1_s6xC sc2_s6xD -&gt;\n    case tagToEnum# (&lt;=# sc1_s6xC 0) of _ {\n      False -&gt;\n    case seq# lvl_r6yu sc2_s6xD of _ { (# ipv_a4BO, ipv1_a4BP #) -&gt;\n    main_$s$wa sc_s6xB (-# sc1_s6xC 1) ipv_a4BO\n    };\n      True -&gt; (# sc2_s6xD, () #)\n    }\nend Rec }\n\nmain6\nmain6 =\n  \\ w_s6w9 w1_s6wa -&gt;\n    case w_s6w9 of _ { I64# ww1_s6wd -&gt;\n    main_$s$wa () ww1_s6wd w1_s6wa\n    }\n\nmain5\nmain5 = Benchmark main7 (main6 `cast` ...)\n\nmain4\nmain4 = : main5 ([])\n\nmain3\nmain3 = BenchGroup main8 main4\n\nmain2\nmain2 = : main3 ([])\n\nmain1\nmain1 = \\ eta_B1 -&gt; defaultMain2 defaultConfig main2 eta_B1\n\nmain9\nmain9 = \\ eta_B1 -&gt; runMainIO1 (main1 `cast` ...) eta_B1\n\nlst\nlst = \\ @ a_a40V _ -&gt; lst1\n\nmain\nmain = main1 `cast` ...\n\nmyadd\nmyadd =\n  \\ x_a3Io y_a3Ip -&gt;\n    case x_a3Io of _ { I# ipv_s4d1 -&gt;\n    case y_a3Ip of _ { I# ipv1_s4d4 -&gt; I# (+# ipv_s4d1 ipv1_s4d4) }\n    }\n\nmysum\nmysum =\n  \\ w_s6w2 -&gt;\n    case $wlgo 0 w_s6w2 of ww_s6w5 { __DEFAULT -&gt; I# ww_s6w5 }\n\nnum\nnum = I# 100000000\n\nmain\nmain = main9 `cast` ...\n</code></pre>\n\n<p>where I tagged <code>-ddump-simpl -fforce-recomp -O3 -dsuppress-all</code>\nto the end of the <code>ghc --make -no-link ...</code> command invoked\nby <code>cabal build</code>. I am using criterion 1.1.0.0 and GHC version 7.8.3.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1427698133, "post_id": 29339643, "comment_id": 46867268, "body": "<code>runghc +RTS -M10m a.hs</code> or <code>runghc -rtsopts a.hs +RTS -M10m</code>? (Just guessing)"}, {"owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "reply_to_user": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1427698489, "post_id": 29339643, "comment_id": 46867414, "body": "@Dogbert Tried both, and neither worked. Thanks anyway :("}, {"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1427704756, "post_id": 29339643, "comment_id": 46870372, "body": "How are you checking whether the flag is set or not from the program?"}, {"owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "reply_to_user": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1427706116, "post_id": 29339643, "comment_id": 46871074, "body": "@Dogbert I edited the question. Thanks."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1427708258, "post_id": 29339643, "comment_id": 46872319, "body": "If everything fails, bash allows to set variables &quot;one time only&#39; by using <code>GHCRTS=&quot;-M10m&quot; runghc a.hs</code> on a single line. This will not set the variable for the next bash commands."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1427708402, "post_id": 29339643, "comment_id": 46872379, "body": "Have you tried <code>runghc +RTS -M10m -RTS a.hs</code> ?"}, {"owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "edited": false, "score": 0, "creation_date": 1427714069, "post_id": 29339643, "comment_id": 46875594, "body": "<code>runghc +RTS -M10m -RTS a.hs</code> didn&#39;t work either. &quot;one time only&quot; option is nice, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 12530, "user_id": 381619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f67f35200cf319e30329dddd412b6d?s=128&d=identicon&r=PG", "display_name": "Neil Mayhew", "link": "https://stackoverflow.com/users/381619/neil-mayhew"}, "is_accepted": true, "score": 6, "last_activity_date": 1431639776, "last_edit_date": 1495542753, "creation_date": 1431633027, "answer_id": 30246102, "question_id": 29339643, "link": "https://stackoverflow.com/questions/29339643/how-can-i-pass-rts-options-to-runghc/30246102#30246102", "title": "How can I pass RTS options to runghc?", "body": "<p>Using <code>GHCRTS=... runghc ...</code> as <a href=\"https://stackoverflow.com/users/3234959/chi\">chi</a> says is the only way. Because of the way <code>runghc</code> interprets its command line, <code>+RTS</code> is interpreted as RTS options to <code>runghc</code> itself (if it's at the end) or as a program name (if it's at the beginning). It never reaches the runtime. You can force it to be passed to the program using <code>--RTS +RTS ...</code> but then it's treated as a program argument and it's still not seen by the runtime.</p>\n\n<p>To investigate this, I wrote a wrapper shell script for <code>ghc</code> that traces its arguments, and passed this to <code>runghc</code> with the <code>-f</code> option.</p>\n\n<p>Create a file <code>ghc-wrapper</code> containing:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/bin/sh -x\nexec ghc \"$@\"\n</code></pre>\n\n<p>The <code>-x</code> option tells <code>/bin/sh</code> to trace every line. Use this with <code>runghc</code>:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ runghc -f ./ghc-wrapper Hello.hs\n+ exec ghc -ignore-dot-ghci -x hs -e :set prog \"Hello.hs\" -e :main [] Hello.hs\nHello, World!\n\n$ runghc -f ./ghc-wrapper Hello.hs +RTS -s\n+ exec ghc -ignore-dot-ghci -x hs -e :set prog \"Hello.hs\" -e :main [] Hello.hs\nHello, World!\n    114,016 bytes allocated in the heap # runghc's heap, not Hello's\n    ...\n\n$ runghc -f ./ghc-wrapper Hello.hs --RTS +RTS -s\n+ exec ghc -ignore-dot-ghci -x hs -e :set prog \"Hello.hs\" -e :main [\"+RTS\",\"-s\"] Hello.hs\nHello, World!\n\n$ runghc -f ./ghc-wrapper -- +RTS -s -RTS Hello.hs\n+ exec ghc -ignore-dot-ghci -e :set prog \"+RTS\" -e :main [\"-s\",\"-RTS\",\"Hello.hs\"] +RTS\n+RTS:1:55:\n    Not in scope: `main'\n    Perhaps you meant `min' (imported from Prelude)\n</code></pre>\n\n<p>What we really want <code>runghc</code> to execute is:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ ghc -ignore-dot-ghci -x hs +RTS -s -RTS -e ':set prog \"Hello.hs\"' -e ':main []' Hello.hs\nHello, World!\n      80,654,256 bytes allocated in the heap\n      ...\n</code></pre>\n\n<p>But there's no way to specify that because <code>runghc</code> doesn't treat <code>+RTS</code> specially.</p>\n"}], "owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 3, "accepted_answer_id": 30246102, "answer_count": 1, "score": 11, "last_activity_date": 1431639776, "creation_date": 1427696842, "last_edit_date": 1427706097, "question_id": 29339643, "link": "https://stackoverflow.com/questions/29339643/how-can-i-pass-rts-options-to-runghc", "title": "How can I pass RTS options to runghc?", "body": "<p>For <code>ghci</code>, I can limit the memory ghci can use by</p>\n\n<pre><code>$ ghci +RTS -M10m -RTS\n</code></pre>\n\n<p>When I compile the whole program, I can</p>\n\n<pre><code>$ ghc -rtsopts a.hs \n</code></pre>\n\n<p>then</p>\n\n<pre><code>$ ./a +RTS -M10m\n</code></pre>\n\n<p>How can I do this for <code>runghc a.hs</code>? I've tried several ways, like <code>runghc a.hs +RTS -M10m</code> , but none of them seem to work. The only option I could limit the memory was by</p>\n\n<pre><code>$ export GHCRTS='-M10m'\n$ runghc a.hs\n</code></pre>\n\n<p>, but I want this to be one time only, so I prefer doing this by passing arguments to <code>runghc</code>.</p>\n\n<hr>\n\n<p>Edit : I'm checking whether the option is working or not using the following strategy (just because I don't know better ways):</p>\n\n<pre><code>-- a.hs\nf x = f (f x)\nmain = print $ seq (f 0) 0\n</code></pre>\n\n<p>Open two terminals, one for <code>top</code> command and another for executing the code. If the execution stops saying \"Heap exhausted\", I conclude that <code>-M[number]m</code> is working. If the execution continues and uses huge amount of memory, I kill the process and conclude that it didn't succeed.</p>\n"}, {"tags": ["haskell", "stackage", "fpcomplete"], "comments": [{"owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1441018809, "post_id": 29338949, "comment_id": 52494284, "body": "Did you ever solve this? I&#39;m running into the exact same type of issue, although with another package (hakyll)."}, {"owner": {"reputation": 28145, "user_id": 501187, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2bf8dee0b3c004589b62a9b0db09b04a?s=128&d=identicon&r=PG", "display_name": "Fresheyeball", "link": "https://stackoverflow.com/users/501187/fresheyeball"}, "reply_to_user": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1441049058, "post_id": 29338949, "comment_id": 52511902, "body": "I didn&#39;t. Sorry. But it&#39;s been a while, and I&#39;ve moved to using stack directly"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1521244952, "post_id": 29338949, "comment_id": 85664131, "body": "(voted to close this as the fpcomplete dev environment is decommissioned, so this can&#39;t be of future use.)"}], "owner": {"reputation": 28145, "user_id": 501187, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2bf8dee0b3c004589b62a9b0db09b04a?s=128&d=identicon&r=PG", "display_name": "Fresheyeball", "link": "https://stackoverflow.com/users/501187/fresheyeball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1521244908, "creation_date": 1427693159, "last_edit_date": 1521244908, "question_id": 29338949, "link": "https://stackoverflow.com/questions/29338949/wreq-on-fpcomplete-wont-compile", "title": "wreq on fpcomplete wont compile", "body": "<p>I am trying to <code>import Network.Wreq</code> on FPComplete. FPComplete does not have Wreq as in its preinstalled binaries, so I think the only way is in the extra packages section of the settings. Here is what I have so far:</p>\n\n<pre><code>Hackage: PSQueue 1.1\nHackage: wreq 0.3.0.1\n</code></pre>\n\n<p>but I still get the following error</p>\n\n<pre><code>Error while building extra package: wreq: setup: At least the following dependencies are missing: http-client &gt;=0.4.6, lens &gt;=4.5\n</code></pre>\n\n<p>even though <code>http-client</code> and <code>lens</code> are already installed on FPComplete. Trying to reinstall either of these seems to be a rabbit hole. </p>\n\n<p>I'd really appreciate any help with this, I'm blocked.</p>\n"}, {"tags": ["list", "haskell", "recursion", "subroutine"], "comments": [{"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1427697699, "post_id": 29338855, "comment_id": 46867081, "body": "How have you defined <code>kaprekar</code> and what&#39;s the output you are actually getting with the current implementation?"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 1748977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2b5ffcfd4e2f5294728bfef99fd1a2?s=128&d=identicon&r=PG", "display_name": "camrymps", "link": "https://stackoverflow.com/users/1748977/camrymps"}, "edited": false, "score": 0, "creation_date": 1427719589, "post_id": 29340135, "comment_id": 46879028, "body": "Thank you @Carsten K&#246;nig! It looks like I did everything write but the [x, p] part. Thank you for the help!"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1427699564, "last_edit_date": 1427699564, "creation_date": 1427698856, "answer_id": 29340135, "question_id": 29338855, "link": "https://stackoverflow.com/questions/29338855/kaprekars-routine-haskell-implementation/29340135#29340135", "title": "Kaprekar&#39;s Routine - Haskell Implementation", "body": "<p>While not the most beautiful routine (and having a small problem see below) yours seems to work (if the <code>kaprekar</code> function does), so I guess your problem is really there.</p>\n\n<p>Here is a simple implementation together with your function:</p>\n\n<pre><code>kaprekar :: Integer -&gt; Integer\nkaprekar n = big - small\n  where big = read digits\n        small = read (reverse digits)\n        digits = take 4 $ (reverse . sort . show $ n) ++ \"0000\"\n\nkaprekarList :: Integer -&gt; [Integer]\nkaprekarList x = n\n  where p = kaprekar x\n        n =\n          if p == 6174\n              then [x, p]\n              else\n                -- add to list of kaprekar numbers\n                x : kaprekarList p\n</code></pre>\n\n<p>Please mind the small changes so that you can see the complete <em>derivation</em> instead of just the last element (that is always fixed).</p>\n\n<h3>alternative versions</h3>\n\n<pre><code>kaprekarList :: Integer -&gt; [Integer]\nkaprekarList x = x : if x == 6174 then [] else kaprekarList (kaprekar x)\n</code></pre>\n\n<p>this one seems to be a bit more idiomatic but will not include the last 6174</p>\n\n<pre><code>kaprekarList :: Integer -&gt; [Integer]\nkaprekarList x = takeWhile (/= 6174) $ iterate kaprekar x\n</code></pre>\n\n<p>this one will (but is ugly - maybe someone knows something like <code>takeUntil</code> in the prelude?):</p>\n\n<pre><code>kaprekarList :: Integer -&gt; [Integer]\nkaprekarList x = (takeWhile (/= 6174) $ iterate kaprekar x) ++ [6174]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2464, "user_id": 1076715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf07aa4cdf24f3a770c21cb26e61bc7f?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1076715/eric"}, "is_accepted": false, "score": 1, "last_activity_date": 1427700337, "creation_date": 1427700337, "answer_id": 29340508, "question_id": 29338855, "link": "https://stackoverflow.com/questions/29338855/kaprekars-routine-haskell-implementation/29340508#29340508", "title": "Kaprekar&#39;s Routine - Haskell Implementation", "body": "<p>Here an implementation:</p>\n\n<pre><code>import Data.List (sort)\n\n-- Convert a number to a list of digits\ndigits :: Integral x =&gt; x -&gt; [x]\ndigits 0 = []\ndigits x = digits (x `div` 10) ++ [x `mod` 10]\n\n-- Convert a list of digits to a number\nundigits :: Integral x =&gt; [x] -&gt; x\nundigits = foldl (\\ a b -&gt; a * 10 + b) 0\n\n-- Compute the next Kaprekar number\nnextKapNumber :: Integral x =&gt; x -&gt; x\nnextKapNumber x = b - a\n  where n = sort . digits $ x\n        a = undigits n\n        b = undigits . reverse $ n\n\n-- Compute the Kaprekar list for a number\nkapList :: Integral x =&gt; x -&gt; [x]\nkapList x = genList [x]\n  where genList as@(6174:_) = reverse as\n        genList as@(a:_)    = genList $ nextKapNumber a : as\n\nmain :: IO ()\nmain = putStrLn . show $ kapList 5432\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 1748977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2b5ffcfd4e2f5294728bfef99fd1a2?s=128&d=identicon&r=PG", "display_name": "camrymps", "link": "https://stackoverflow.com/users/1748977/camrymps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 29340135, "answer_count": 2, "score": 0, "last_activity_date": 1427700337, "creation_date": 1427692626, "question_id": 29338855, "link": "https://stackoverflow.com/questions/29338855/kaprekars-routine-haskell-implementation", "title": "Kaprekar&#39;s Routine - Haskell Implementation", "body": "<p>I am having a little trouble with Haskell. I am doing an implemenation of Kaprekar's routine (<a href=\"http://en.wikipedia.org/wiki/6174_%28number%29\" rel=\"nofollow\">http://en.wikipedia.org/wiki/6174_%28number%29</a>) and I have done everything but being able to successfully print the list of numbers that the routine produces. So, if I put in the number 5432, I would like the output to be [5432, 3087, 8352, 6174]. </p>\n\n<p>Here is the code I have:</p>\n\n<pre><code>kaprekarList :: Integer -&gt; [Integer]\n\nkaprekarList x = n\n  where p = kaprekar x\n        n =\n          if p == 6174\n              then [p]\n              else\n                -- add to list of kaprekar numbers\n                kaprekarList p\n</code></pre>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["list", "haskell", "dictionary", "printing", "split"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1427681979, "post_id": 29337417, "comment_id": 46862988, "body": "&quot;except I get an error at, loop splitter&quot; - What error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4706184"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427682072, "post_id": 29337417, "comment_id": 46863009, "body": "Couldn&#39;t match type <code>[Char]&#39; with </code>Char&#39;         Expected type: [String]       Actual type: [[[Char]]]"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427682414, "post_id": 29337417, "comment_id": 46863084, "body": "Maybe you mean something like <code>mapM_ loop splitter</code>?  It looks like <code>splitter</code> is a list of lists of strings, and <code>loop</code> looks like it&#39;s expecting just a list of strings.  It would really help if you added type signatures to your functions, and even your variable declarations, they act as a sort of documentation so others can understand more about what your code is doing without having to try to compile it themselves."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4706184"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427685821, "post_id": 29337417, "comment_id": 46863947, "body": "is there a way to make splitter one list?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427724073, "post_id": 29337417, "comment_id": 46882139, "body": "Have you tried searching <a href=\"https://www.fpcomplete.com/hoogle?q=%5B%5Ba%5D%5D+-%3E+%5Ba%5D&amp;env=ghc-7.8-stable-14.09\" rel=\"nofollow noreferrer\">hoogle</a>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4706184"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427745814, "post_id": 29337417, "comment_id": 46895424, "body": "not much, since im new to haskell, but ill start to. it was a really simple fix. just needed to use concat."}], "owner": {"user_type": "does_not_exist", "display_name": "user4706184"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427681811, "creation_date": 1427681811, "question_id": 29337417, "link": "https://stackoverflow.com/questions/29337417/haskell-iterating-split-function-over-list", "title": "Haskell --- iterating split function over list", "body": "<pre><code>getLines = liftM lines . readFile\n\nmain = do\n    argv &lt;- getArgs\n    name &lt;- getProgName\n    if not (null argv)\n    then do\n           let file = head argv \n           list &lt;- getLines file\n           let olist = mergesort (&lt;=) list\n           let splitter = map (split \",\")  olist\n           loop splitter \n    else hPutStr stderr $ \"usage: \" ++ name ++ \" filename\"\n\nloop a = do \n    line &lt;- getLine\n    case line of\n     \"help\"  -&gt; putStrLn \"print - prints list in alphabetical order\\n\\\n                \\quit  - exits program\"\n     \"print\" -&gt; do putStrLn \"[print]\"\n                   mapM_ putStrLn a\n                   putStr \"\\n\"\n     \"quit\"  -&gt; do putStrLn \"[quit]\" \n                   exitSuccess\n     _       -&gt; putStrLn \"invalid command\" \n    loop a\n</code></pre>\n\n<p>I'm trying to split a list of lines that each have a comma, except I get an error at, loop splitter. I think its because mapM_ putStrLn within my loop function can't understand the new list. Before i used the splitter function my program would print out the entire list taken from a text file with no problems. How can i print out a new list of words that were split at the comma?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1427681821, "post_id": 29337359, "comment_id": 46862950, "body": "<code>[everyf 3 xs, everyf 3 (tail xs), everyf 3 (drop 2 xs)]</code>? Which generalization looks like <code>[everyf 3 (drop 0 xs), everyf 3 (drop 1 xs), everyf 3 (drop 2 xs)]</code>"}, {"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1427682168, "post_id": 29337359, "comment_id": 46863033, "body": "@zerkms sorry for being unclear, but i want this to work for any nth element, not just 3. I updated my question."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1427682523, "post_id": 29337465, "comment_id": 46863109, "body": "well... nice try but this gives:  [[3,6],[3,6],[3,6],[3,6]]"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 2, "last_activity_date": 1427683446, "last_edit_date": 1427683446, "creation_date": 1427682286, "answer_id": 29337465, "question_id": 29337359, "link": "https://stackoverflow.com/questions/29337359/getting-every-3rd-element-looping-back-haskell/29337465#29337465", "title": "getting every 3rd element &amp; looping back (Haskell)", "body": "<p>Disclaimer: I don't know haskell (at all) :-)</p>\n\n<pre><code>listOfNths :: Int -&gt; [a] -&gt; [[a]]\nlistOfNths n xs = map (\\x -&gt; everyf n (drop x xs)) [0..n-1]\n</code></pre>\n\n<p>and a slightly \"improved\" version:</p>\n\n<pre><code>listOfNths :: Int -&gt; [a] -&gt; [[a]]\nlistOfNths n xs = map pickEveryf [0..n-1]\n    where pickEveryf = (everyf n) . (`drop` xs)\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 29337465, "answer_count": 1, "score": 1, "last_activity_date": 1427683446, "creation_date": 1427681339, "last_edit_date": 1427682123, "question_id": 29337359, "link": "https://stackoverflow.com/questions/29337359/getting-every-3rd-element-looping-back-haskell", "title": "getting every 3rd element &amp; looping back (Haskell)", "body": "<p>I want to write a function that returns every nth element of a given list but then updates the head to the second element and does this again until it has gone through all elements in the list. \nI know the code for going through every nth element in a list is:</p>\n\n<pre><code>everyf n [] = []\neveryf n as  = head as : everyf n (drop n as)\n</code></pre>\n\n<p>but this does not loop back. How can I get this to update head so that i get the following result:</p>\n\n<pre><code>everyf 3 [1,2,3,4,5,6,7]\nreturns [[1,4,7],[2,5],[3,6]]\n</code></pre>\n"}, {"tags": ["list", "haskell", "recursion", "pattern-matching"], "comments": [{"owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "edited": false, "score": 0, "creation_date": 1427676294, "post_id": 29336748, "comment_id": 46861608, "body": "What do you intend your program to do if the input list has multi-digit numbers, such as <code>[3, 21, 0]</code>?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1427676644, "post_id": 29336748, "comment_id": 46861691, "body": "You&#39;ll need to account for the position each number, and, (IIRC), raise the number to the base (I&#39;m guessing 10 here), and add it to the previous numbers."}, {"owner": {"reputation": 327, "user_id": 1748977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2b5ffcfd4e2f5294728bfef99fd1a2?s=128&d=identicon&r=PG", "display_name": "camrymps", "link": "https://stackoverflow.com/users/1748977/camrymps"}, "edited": false, "score": 0, "creation_date": 1427676723, "post_id": 29336748, "comment_id": 46861707, "body": "They will not be allowed, I am just doing numbers from 0-9, nothing 10+"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 1748977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2b5ffcfd4e2f5294728bfef99fd1a2?s=128&d=identicon&r=PG", "display_name": "camrymps", "link": "https://stackoverflow.com/users/1748977/camrymps"}, "edited": false, "score": 0, "creation_date": 1427677104, "post_id": 29336839, "comment_id": 46861780, "body": "Thanks @Sibi, this was exactly what I was looking for!"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 5, "last_activity_date": 1427676753, "creation_date": 1427676753, "answer_id": 29336839, "question_id": 29336748, "link": "https://stackoverflow.com/questions/29336748/list-of-integers-to-single-integer-haskell/29336839#29336839", "title": "List of integers to single integer - Haskell", "body": "<p>You can use the <a href=\"https://wiki.haskell.org/Worker_wrapper\" rel=\"noreferrer\">worker wrapper</a> approach to do this:</p>\n\n<pre><code>fromDigits :: [Integer] -&gt; Integer\nfromDigits xs = aux xs 0\n    where aux [] acc = acc\n          aux (x:xs) acc  = aux xs ((acc * 10) + x)\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>\u03bb&gt; fromDigits [3,2,1]\n321\n</code></pre>\n\n<p>Or even you can use the higher order function <code>foldl</code>:</p>\n\n<pre><code>\u03bb&gt; foldl' (\\acc x -&gt; (acc * 10) + x) 0 [1,2,3]\n123\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1427678669, "last_edit_date": 1427678669, "creation_date": 1427677326, "answer_id": 29336892, "question_id": 29336748, "link": "https://stackoverflow.com/questions/29336748/list-of-integers-to-single-integer-haskell/29336892#29336892", "title": "List of integers to single integer - Haskell", "body": "<p>This is <strong>not</strong> a conversion. The list <code>[3,2,1]</code> may \u201clook\u201d like the number <code>321</code>, but it's not a one-to-one relation (as Greg alluded \u2013 <code>[32,1]</code> looks like the same number), and most certainly not a canonical one (why would you use base 10? Is this actually hexadecimal?) Hence there is really no reason why this <em>should</em> be particularly simple in Haskell<sup>1</sup>. <a href=\"https://www.destroyallsoftware.com/talks/wat\" rel=\"nofollow\">This is not JavaScript, fortunately</a>.</p>\n\n<p>Repeat of message... it <em>looks</em> like the number <code>321</code>, and that's all, it's not related to the number in really any meaningful way. So, if you really need to implement this function of questionable worth (I think you shouldn't), then you might as well do the hack to actually exploit the &ldquo;looks like&rdquo; thing. I.e.,</p>\n\n<pre><code>fromDigits = read . filter (not . (`elem`\"[,]\")) . show\n</code></pre>\n\n<p>This uses the <code>Show</code> instance of lists, to <em>convert</em> the list <code>[3,2,1]</code> into an actual string <code>\"[3,2,1]\"</code>, then throws away the list-related characters, and reads the concatenated string <code>\"321\"</code> back, yielding the number <code>321</code>.</p>\n\n<p><hr>\n<sup>1</sup><sub>Apart from the fact that it's generally quite simple to implement pure functions in Haskell...</sub></p>\n"}], "owner": {"reputation": 327, "user_id": 1748977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2b5ffcfd4e2f5294728bfef99fd1a2?s=128&d=identicon&r=PG", "display_name": "camrymps", "link": "https://stackoverflow.com/users/1748977/camrymps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2309, "favorite_count": 1, "accepted_answer_id": 29336839, "answer_count": 2, "score": 1, "last_activity_date": 1427678669, "creation_date": 1427676185, "question_id": 29336748, "link": "https://stackoverflow.com/questions/29336748/list-of-integers-to-single-integer-haskell", "title": "List of integers to single integer - Haskell", "body": "<p>I seem to be struggling with something that should be extremely simple in Haskell, but I just cannot figure it out and I need some help. I am trying to convert a list of integers ([3,2,1]) and convert it to a single integer (321). </p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>fromDigits :: [Integer] -&gt; Integer\nfromDigits [] = 0;\nfromDigits (x:xs) = x : fromDigits (xs)\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427676938, "post_id": 29336746, "comment_id": 46861742, "body": "Yikes, it&#39;s been ages since I&#39;ve written that page! I wouldn&#39;t be surprised if the output of <code>amixer</code> has changed in an incompatible way since then. (I&#39;ve moved from ALSA to pulse.) But, to check: if you bind some key to <code>getVolume &gt;&gt;= alert</code>, does it show the correct answer? Does changing volumes on the command line with <code>amixer</code> change your volume? What channel in <code>alsamixer</code> (if any) actually controls your volume correctly?"}, {"owner": {"reputation": 3339, "user_id": 2759719, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/5KMeF.png?s=128&g=1", "display_name": "mrQWERTY", "link": "https://stackoverflow.com/users/2759719/mrqwerty"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427677715, "post_id": 29336746, "comment_id": 46861911, "body": "Oh wow! You actually wrote that page! I binded a key as you said, and unfortunately nothing shows up. I apologize if for me being a newbie at this, but I don&#39;t understand what alsa or pulse is. I know that if I use the following command in the terminal, amixer -D pulse sset Master 15%, I can set the volume. As for channel in alsamixer, I&#39;m not sure what that means. I ran alsamixer which led me to three s/pdif. I think that stands for Sony/Philips digital interface."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427678082, "post_id": 29336746, "comment_id": 46861994, "body": "Ah, unfortunately, that module doesn&#39;t support controlling a specific device (and doesn&#39;t have a good way to munge the <code>amixer</code> command line by hand). You have a couple choices: copy the code from the module and fix it (the work of 10 seconds, but not usable by others); patch <code>xmonad-extras</code> to add this functionality (a bit more work, but I will happily include your patch, and others will be able to benefit); use <code>pacmd</code> instead of touching <code>amixer</code> at all (much more work if you want an on-screen volume display after you change it). Which do you want to hear more about?"}, {"owner": {"reputation": 3339, "user_id": 2759719, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/5KMeF.png?s=128&g=1", "display_name": "mrQWERTY", "link": "https://stackoverflow.com/users/2759719/mrqwerty"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427682111, "post_id": 29336746, "comment_id": 46863019, "body": "Hmm, sorry for the delay. Its possible to directly call amixer from the script right? Unfortunately, I&#39;ve just started learning Haskell in my class coincidentally. So fixing and then patching something is probably out of my league at the moment."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427682866, "post_id": 29336746, "comment_id": 46863200, "body": "Changing the module to include <code>-D pulse</code> in the <code>amixer</code> command line should be very, very easy -- just copy the module and look for all instances of <code>amixer</code> and change them. You can call <code>amixer</code> directly if you like; but then you might as well call <code>pacmd</code>, since presumably <code>amixer -D pulse</code> means you are using pulseaudio. I&#39;m happy to talk about either approach."}, {"owner": {"reputation": 3339, "user_id": 2759719, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/5KMeF.png?s=128&g=1", "display_name": "mrQWERTY", "link": "https://stackoverflow.com/users/2759719/mrqwerty"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427684280, "post_id": 29336746, "comment_id": 46863568, "body": "Can you talk more about the pacmd approach? It would be wonderful if there was a way to feed the get the display for volume working too. Although that wouldn&#39;t be a priority since I could just include the volume in xmobarr"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427847947, "post_id": 29336746, "comment_id": 46941327, "body": "Reading your updated question: I&#39;m baffled why having your audio key spawn amixer directly didn&#39;t work. That seems like the (or at least, &quot;a&quot;) core problem. Can you open <code>xev</code> and see what key it thinks you&#39;re pressing when you press your audio volume down key?"}, {"owner": {"reputation": 3339, "user_id": 2759719, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/5KMeF.png?s=128&g=1", "display_name": "mrQWERTY", "link": "https://stackoverflow.com/users/2759719/mrqwerty"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427865972, "post_id": 29336746, "comment_id": 46945585, "body": "xev outputs are extremely bizarre. Since my multimedia keys are executed via holding fn down, xev only outputs Fn and f2 or f3 depending on what is pressed. Only AudioMute gets recognized by xev. I booted into Unity, and my multimedia keys works like a charm."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427907467, "post_id": 29336746, "comment_id": 46969359, "body": "Okay, so... bind to something like <code>(mod3Mask, xK_F2)</code> instead of <code>(0, xF86XK_AudioLowerVolume)</code>, where you should replace <code>mod3Mask</code> with the appropriate mask for your Fn key (which I can&#39;t guess without seeing your xev output)."}], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 2782510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78d18128391ff0c51a3824714247a83?s=128&d=identicon&r=PG", "display_name": "fimad", "link": "https://stackoverflow.com/users/2782510/fimad"}, "is_accepted": true, "score": 4, "last_activity_date": 1604553048, "last_edit_date": 1604553048, "creation_date": 1430692019, "answer_id": 30020130, "question_id": 29336746, "link": "https://stackoverflow.com/questions/29336746/xmonad-volume-configuration-not-working/30020130#30020130", "title": "XMonad Volume configuration not working", "body": "<p>Here is a script that I wrote to control pulse audio volume. Dump it in a file named pulse_control.pl and make sure it is executable and in your <code>PATH</code>. It uses <code>pacmd</code> and <code>pactl</code> which you may have to install with your distro's package manager.</p>\n<pre><code>#!/usr/bin/perl\n\nuse List::Util qw[min max];\nuse Getopt::Long;\n\nmy $_IS_MUTED;\nmy $_TOGGLE_MUTE;\nmy $_VOL;\nmy $_INC_VOL;\nmy $_DEC_VOL;\n\nGetOptions(\n    &quot;is-muted&quot;    =&gt; \\$_IS_MUTED\n,   &quot;toggle-mute&quot; =&gt; \\$_TOGGLE_MUTE\n,   &quot;volume&quot;      =&gt; \\$_VOL\n,   &quot;inc-vol&quot;     =&gt; \\$_INC_VOL\n,   &quot;dec-vol&quot;     =&gt; \\$_DEC_VOL\n);\n\nmy $sink = `pactl info | sed -rn 's/^Default Sink: (.+)\\$/\\\\1/gp'`;\nchomp $sink;\n\nsub ismuted {\n    my $ismuted = `pacmd dump | grep &quot;$sink&quot; | grep sink-mute | grep yes`;\n    chomp $ismuted;\n    if ($ismuted ne &quot;&quot;) {\n        return 1;\n    } else {\n        0;\n    }\n}\n\nsub curvol {\n    my $volline = `pacmd dump | grep &quot;$sink&quot; | grep sink-vol`;\n    if ($volline =~ m/(0x[0-9a-f]+)/ ) {\n        return hex $1;\n    } else {\n        return 0;\n    }\n}\n\nif ($_IS_MUTED) {\n    print ismuted(), &quot;\\n&quot;;\n}\nelsif($_TOGGLE_MUTE) {\n    if (ismuted()) {\n        `pactl set-sink-mute $sink 0`;\n    } else {\n        `pactl set-sink-mute $sink 1`;\n    }\n}\nelsif($_VOL) {\n    print int(curvol() * 100.0 / hex(&quot;0x10000&quot;)), &quot;%\\n&quot;;\n}\nelsif($_INC_VOL) {\n    my $newvol = min(hex(&quot;0x10000&quot;), curvol() + int((hex(&quot;0x10000&quot;) * .04)));\n    `pactl set-sink-volume $sink $newvol`;\n}\nelsif($_DEC_VOL) {\n    my $newvol = max(0, curvol() - int((hex(&quot;0x10000&quot;) * .04)));\n    `pactl set-sink-volume $sink $newvol`;\n}\n</code></pre>\n<p>Then in my xmonad config, I have volume control bound to ctrl+alt+(page up/page down/end).</p>\n<pre><code>`additionalKeys`\n[\n    ((controlMask .|. mod1Mask, xK_Page_Up), spawn &quot;pulse_control.pl -inc&quot;)\n,   ((controlMask .|. mod1Mask, xK_Page_Down), spawn &quot;pulse_control.pl -dec&quot;)\n,   ((controlMask .|. mod1Mask, xK_End), spawn &quot;pulse_control.pl -toggle&quot;)\n]\n</code></pre>\n"}], "owner": {"reputation": 3339, "user_id": 2759719, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/5KMeF.png?s=128&g=1", "display_name": "mrQWERTY", "link": "https://stackoverflow.com/users/2759719/mrqwerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1381, "favorite_count": 2, "accepted_answer_id": 30020130, "answer_count": 1, "score": 5, "last_activity_date": 1604553048, "creation_date": 1427676159, "last_edit_date": 1427697384, "question_id": 29336746, "link": "https://stackoverflow.com/questions/29336746/xmonad-volume-configuration-not-working", "title": "XMonad Volume configuration not working", "body": "<p>I recently got into XMonad and unforunately I don't know much Haskell at all. I'm trying to configure my xmonad.hs file such that I can control the volume. However, right now, even though my xmonad.hs file compiles without errors, I cannot control the volume. </p>\n\n<p>I got the volume control code from this link:<code>http://dmwit.com/volume/</code></p>\n\n<p>Here is my configuration file:</p>\n\n<pre><code>import XMonad\nimport XMonad.Util.Run(spawnPipe)\nimport XMonad.Hooks.DynamicLog\nimport XMonad.Hooks.ManageDocks\nimport XMonad.Actions.Volume\nimport XMonad.Util.Dzen\nimport Data.Map (fromList)\nimport Data.Monoid (mappend)\nimport System.IO\n\nalert = dzenConfig centered . show . round\ncentered =\n        onCurr (center 150 66)\n    &gt;=&gt; font \"-*-helvetica-*-r-*-*-64-*-*-*-*-*-*-*\"\n    &gt;=&gt; addArgs [\"-fg\", \"#80c0ff\"]\n    &gt;=&gt; addArgs [\"-bg\", \"#000040\"]\n\nmain = do \n        xmproc &lt;- spawnPipe \"xmobar /home/david/.xmobarrc\"\n        xmonad $ defaultConfig\n                {\n                        manageHook = manageDocks &lt;+&gt; manageHook defaultConfig\n                        , layoutHook = avoidStruts  $  layoutHook defaultConfig\n                        , logHook = dynamicLogWithPP xmobarPP\n                                { ppOutput = hPutStrLn xmproc\n                                , ppTitle = xmobarColor \"green\" \"\" . shorten 50\n                                }\n                        , modMask = mod4Mask \n                        , keys =\n                            keys defaultConfig `mappend`\n                            \\c -&gt; fromList [\n                                ((0, xK_F6), lowerVolume 4 &gt;&gt;= alert),\n                                ((0, xK_F7), raiseVolume 4 &gt;&gt;= alert)\n                            ]\n                }\n</code></pre>\n\n<p>I have changed my code the following, however the volume has not changed:</p>\n\n<pre><code>main = do \n    xmproc &lt;- spawnPipe \"xmobar /home/luren/.xmobarrc\"\n    xmonad $ defaultConfig\n            {\n                    manageHook = manageDocks &lt;+&gt; manageHook defaultConfig\n                    , layoutHook = avoidStruts  $  layoutHook defaultConfig\n                    , logHook = dynamicLogWithPP xmobarPP\n                            { ppOutput = hPutStrLn xmproc\n                            , ppTitle = xmobarColor \"green\" \"\" . shorten 50\n                            }\n                    , modMask = mod4Mask \n                    , keys =\n                        keys defaultConfig `mappend`\n                        \\c -&gt; fromList [\n                            ((0, 0x1008FF11), spawn \"amixer -D pulse sset Master 4-\"),\n                            ((0, 0x1008FF13), spawn \"amixer -D pulse sset Master 4+\")\n                        ]\n            }\n</code></pre>\n\n<p>(END)</p>\n\n<p>Those keys are the codes for the volume media keys on my laptop. </p>\n\n<p>I snooped around and saw some other configurations. I decided to do a little test and make the audio lower volume key print Hi ppl! when pressed. Unfortunately, this does not work.</p>\n\n<pre><code>main = do \n    xmproc &lt;- spawnPipe \"xmobar /home/luren/.xmobarrc\"\n    xmonad $ defaultConfig\n            {\n                    manageHook = manageDocks &lt;+&gt; manageHook defaultConfig\n                    , layoutHook = avoidStruts  $  layoutHook defaultConfig\n                    , logHook = dynamicLogWithPP xmobarPP\n                            { ppOutput = hPutStrLn xmproc\n                            , ppTitle = xmobarColor \"green\" \"\" . shorten 50\n                            }\n                    , modMask = mod4Mask\n            }\n            `additionalKeys`\n            [\n                    ((0, xF86XK_AudioLowerVolume), spawn \"echo 'Hi ppl!'\"),\n                    ((0, xF86XK_AudioRaiseVolume), spawn \"amixer -D pulse sset Master 15%+\")\n            ]\n</code></pre>\n"}, {"tags": ["multithreading", "haskell", "exception", "asynchronous", "conduit"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427675935, "post_id": 29336670, "comment_id": 46861523, "body": "To ensure that the child thread will finish, create an <code>MVar</code>; have the child thread put something into it and the main thread take from it. Don&#39;t know enough to answer the other half, though."}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "edited": false, "score": 0, "creation_date": 1427770272, "post_id": 29340626, "comment_id": 46903651, "body": "Thanks for the detailed answer with links! I wouldn&#39;t have thought of taking this approach. Fascinating stuff!"}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 3, "last_activity_date": 1427734320, "last_edit_date": 1495541756, "creation_date": 1427700753, "answer_id": 29340626, "question_id": 29336670, "link": "https://stackoverflow.com/questions/29336670/haskell-conduit-and-masking-async-exceptions/29340626#29340626", "title": "Haskell Conduit and masking async exceptions", "body": "<p>I'd suggest another technique, unrelated to <em>conduit</em>:</p>\n\n<ul>\n<li>Create a new, temporary file,</li>\n<li>write your data there,</li>\n<li><a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/fsync.html\" rel=\"nofollow noreferrer\">fsync</a> the file, so that everything is really written to disk,</li>\n<li><a href=\"http://en.wikipedia.org/wiki/Rename_%28computing%29#Atomic_rename\" rel=\"nofollow noreferrer\">atomically rename</a> the temporary file to the target one; on POSIX systems this is easy, as <code>rename</code> is designed for it, on Windows <a href=\"https://stackoverflow.com/q/167414/1333025\">this question</a> should help.</li>\n</ul>\n\n<p>With this sequence, whatever happens, the target file will either remain intact or will contain the new data, fully written to disk. If the sequence is abruptly interrupted for some reason, it'll just leave a stale temporary file.</p>\n\n<p>The <a href=\"https://hackage.haskell.org/package/unix\" rel=\"nofollow noreferrer\"><em>unix</em></a> Haskell library introduces <code>fsync</code> <a href=\"http://hackage.haskell.org/package/unix-2.7.1.0/docs/System-Posix-Unistd.html#v:fileSynchronise\" rel=\"nofollow noreferrer\">only in version 2.7.1.0</a>, but it's easy to add the call yourself. See <a href=\"http://git.ganeti.org/?p=ganeti.git;a=blob;f=src/Ganeti/Utils/UniStd.hs;h=c3453d99c52d3804541fa9c004a94d73f4abbd52;hb=refs/heads/stable-2.12\" rel=\"nofollow noreferrer\">this module</a> in the <a href=\"http://code.google.com/p/ganeti/\" rel=\"nofollow noreferrer\">Ganeti project</a> (licensed under BSD2). In particular</p>\n\n<pre><code>foreign import ccall \"fsync\" fsync :: CInt -&gt; IO CInt\n\nfsyncFile :: FilePath -&gt; IO ()\nfsyncFile path =\n    bracket (openFd path ReadOnly Nothing defaultFileFlags) closeFd callfsync\n  where\n    callfsync (Fd fd) = throwErrnoPathIfMinus1_ \"fsyncFile\" path $ fsync fd\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 29340626, "answer_count": 1, "score": 0, "last_activity_date": 1427734320, "creation_date": 1427675467, "question_id": 29336670, "link": "https://stackoverflow.com/questions/29336670/haskell-conduit-and-masking-async-exceptions", "title": "Haskell Conduit and masking async exceptions", "body": "<p>I have the following line of code that uses <code>aeson</code> to serialize an <code>IntMap</code> and save the JSON to disk, all on a child thread:</p>\n\n<pre><code>    import Data.Aeson (encode, toJSON)\n    import Data.Conduit (($$), (=$), yield)\n    import qualified Data.ByteString.Lazy as BL (toStrict)\n    import qualified Data.Conduit.Binary as CB (sinkFile)\n    import qualified Data.Conduit.List as CL (map)\n\n    -- ...\n\n    forkIO . runResourceT $ yield (toJSON intMap) $$ CL.map (BL.toStrict . encode) =$ CB.sinkFile file\n</code></pre>\n\n<p>I would like to ensure that this code cannot be interrupted by any asynchronous exceptions. My fear is that an interruption could result in incomplete/corrupt data on disk.</p>\n\n<p>What can I do in this case to ensure immunity from async exceptions? Is it possible to ensure that the child thread will be allowed to finish even if <code>main</code> wants to terminate?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427671852, "post_id": 29336139, "comment_id": 46860598, "body": "While the compiler does do some pretty magical stuff, expecting it to know what you mean by <code>list</code> just because that&#39;s the English name for the type of one of the arguments to your function seems a bit unreasonable. It only knows the names you tell it -- which in this case are <code>f</code>, <code>x</code>, <code>xs</code>, <code>prefix&#39;</code>, and whatever is available from the <code>Prelude</code>. You&#39;ll have to write your implementation in terms of those."}, {"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427672000, "post_id": 29336139, "comment_id": 46860635, "body": "@DanielWagner do you think everything else in my function is correct though?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1427672125, "post_id": 29336139, "comment_id": 46860655, "body": "I&#39;ve never heard of this function called by the name <code>prefix</code>? In the standard library, it&#39;s called <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:scanl1\" rel=\"nofollow noreferrer\"><code>scanl1</code></a>. A <a href=\"https://en.wikipedia.org/wiki/Prefix\" rel=\"nofollow noreferrer\">prefix</a> is something well-defined, albeit completely different."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427672160, "post_id": 29336139, "comment_id": 46860666, "body": "@Chalupa I think there are many errors in your code, potentially stemming from several misunderstandings of Haskell. I suspect you would be best served by finding a buddy who knows Haskell and sitting down with them. People here will try to give you some help, but it&#39;s going to be tough going in plain text and without tight interaction with you. You could also consider hopping on #haskell IRC channel, which at least mitigates the &quot;tight interaction&quot; problem."}, {"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1427672176, "post_id": 29336139, "comment_id": 46860670, "body": "prefix&#39; is just what i decided to name it. it does not already exist on its own"}, {"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427672354, "post_id": 29336139, "comment_id": 46860706, "body": "@DanielWagner well i don&#39;t have a buddy that knows Haskell, any help would be appreciated!"}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1427672529, "post_id": 29336291, "comment_id": 46860742, "body": "i get this error :    Couldn&#39;t match type \u2018b\u2019 with \u2018a -&gt; b\u2019       \u2018b\u2019 is a rigid type variable bound by           the type signature for prefix :: (a -&gt; b) -&gt; [a] -&gt; [b]           at Hask3.hs:1:9     Expected type: a -&gt; a -&gt; b       Actual type: a -&gt; b     Relevant bindings include       l :: [a] (bound at Hask3.hs:2:10)       f :: a -&gt; b (bound at Hask3.hs:2:8)       prefix :: (a -&gt; b) -&gt; [a] -&gt; [b] (bound at Hask3.hs:2:1)     In the first argument of \u2018prefix&#39;\u2019, namely \u2018f\u2019     In the second argument of \u2018(:)\u2019, namely       \u2018prefix&#39; f (f (head l)) (tail l)\u2019"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "reply_to_user": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1427672686, "post_id": 29336291, "comment_id": 46860779, "body": "Yup, same here, I didn&#39;t test yet, I will fix in a moment"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "reply_to_user": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "edited": false, "score": 0, "creation_date": 1427672899, "post_id": 29336291, "comment_id": 46860823, "body": "@Chalupa, try that now"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427673185, "post_id": 29336291, "comment_id": 46860895, "body": "If the purpose is to just get something working, <code>prefix = scanl1</code> seems much less baroque. If the purpose is to learn how to write this function in Haskell, the complete lack of discussion makes this answer unenlightening. So what purpose is this answer addressing?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427673366, "post_id": 29336291, "comment_id": 46860936, "body": "@DanielWagner, well for one practice for myself (I just started learning haskell a week ago) and two, to provide a code that does what OP is asking. I can&#39;t seem to think of any other reason. I don&#39;t even know what <code>scanl1</code> is or how imports work in haskell, so that&#39;s out of the question"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427675824, "post_id": 29336291, "comment_id": 46861504, "body": "The explanation improves this answer a lot. Thanks for including it!"}], "tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": true, "score": 3, "last_activity_date": 1427674712, "last_edit_date": 1427674712, "creation_date": 1427672359, "answer_id": 29336291, "question_id": 29336139, "link": "https://stackoverflow.com/questions/29336139/writing-the-prefix-function-haskell/29336291#29336291", "title": "writing the prefix function (Haskell)", "body": "<p>Try this</p>\n\n<pre><code>prefix::(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a]\nprefix f lst| null lst = []\n            | null (tail lst) = lst\n            | otherwise = h : prefix' f (f h) (tail lst) where\n               h = head lst\n            prefix' fn fc (x:xs) | null xs = [acc]\n                                 | otherwise = acc : prefix' fn (fn acc) xs where\n                                    acc = fc x\n</code></pre>\n\n<p>I will try to explain the above code as much as possible. The type signature of the function is one that takes a function <code>(a-&gt;a-&gt;a)</code> and a list <code>[a]</code> as parameter and returns another list with that function applied to each adjacent pair of the list. The <code>a</code> in the parameter list simply implies any type (which can be anything). If we had specified a specific type (i.e. in Title case), the function will only work with that specific type</p>\n\n<ul>\n<li>The function works by first checking if the list it recieved is empty (<code>null lst</code>), if so we simply return an empty list</li>\n<li>The next thing it checks for is if the list only contains one item in it (<code>null (tail lst)</code>), in that case, we simply return the list</li>\n<li>The third case is when we actually do something, and the first thing we do is to append the first element in the list to head of our new list (<code>head lst</code>) and call another function which we have defined on the fly to do compute the rest of the list (<code>: prefix' f (f (head lst)) (tail lst)</code>). Note the <code>:</code> separates the head from the rest of the list</li>\n<li>The <code>prefix'</code> function has a type signature of <code>(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]</code> so as you can see the only thing different about it is that it takes one extra parameter which is a function (<code>fc</code>) that takes an element of type <code>a</code> and returns an element of type <code>a</code>. To create this function, we have simply passed one parameter to the initial function recieved as argument which creates this new function. This will be useful in computing the rest of the list</li>\n<li>The base case for this new function is that if the list only contains one element, it applies the new parameter function <code>fc</code> to that element in the list and returns a list containing the return value of the function</li>\n<li>Otherwise it will apply <code>fc</code> to the first element of the list and we generate <code>fc</code> again by applying <code>fn</code> to the return value of <code>fc x</code>.</li>\n</ul>\n\n<p>If you are interested in learning how all these work, this is the <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow\">website</a> I've been using and my knowledge of haskell has improved greatly due to this website, so highly recommended</p>\n"}, {"tags": [], "owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "is_accepted": false, "score": 3, "last_activity_date": 1427674631, "creation_date": 1427674631, "answer_id": 29336575, "question_id": 29336139, "link": "https://stackoverflow.com/questions/29336139/writing-the-prefix-function-haskell/29336575#29336575", "title": "writing the prefix function (Haskell)", "body": "<p>Isn't what you want to implement the <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-List.html#scanl1\" rel=\"nofollow\"><code>scanl1</code></a> function? I'm a beginner too, but from what I understood, it goes like this:</p>\n\n<pre><code>scanl1                  :: (a -&gt; a -&gt; a) -&gt; [a] -&gt; [a]\nscanl1 f (x:xs)         =  scanl f x xs\nscanl1 _ []             =  []\n</code></pre>\n\n<p>The <code>scanl</code> function. which <code>scanl1</code> uses, goes like this:</p>\n\n<pre><code>scanl                   :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]\nscanl                   = scanlGo\n  where\n    scanlGo           :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]\n    scanlGo f q ls    = q : (case ls of\n                               []   -&gt; []\n                               x:xs -&gt; scanlGo f (f q x) xs)\n</code></pre>\n\n<p>Here's what <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:scanl\" rel=\"nofollow\">hackage</a> has to say about <code>scanl</code>:</p>\n\n<pre><code>scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b] Source\n</code></pre>\n\n<p><code>scanl</code> is similar to <code>foldl</code>, but returns a list of successive reduced values from the left:</p>\n\n<pre><code>scanl f z [x1, x2, ...] == [z, z `f` x1, (z `f` x1) `f` x2, ...]\n</code></pre>\n\n<p>Note that</p>\n\n<pre><code>last (scanl f z xs) == foldl f z xs.\n</code></pre>\n\n<p>So, I guess the flow of execution goes like this:</p>\n\n<pre><code>scanl1 (+) [2, 4, 1, 1]\n\nscanl (+) 2 [4, 1, 1]\n\nscanlGo (+) 2 [4, 1, 1]\n2 : scanlGo (+) (+ 2 4) [1, 1]\n2 : 6 : scanlGo (+) (+ 6 1] [1]\n2 : 6 : 7 : scanlGo (+) (+ 7 1) []\n2 : 6 : 7 : 8 : scanlGo []\n2 : 6 : 7 : 8 : []\n[2, 6, 7, 8]\n</code></pre>\n\n<p>The same thing happens with the <code>(*)</code> and the <code>max</code> functions that you mentioned. Hope this helps.</p>\n"}], "owner": {"reputation": 347, "user_id": 4522343, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/120005cd79a0d28edb0c6273127ecc39?s=128&d=identicon&r=PG&f=1", "display_name": "Chalupa", "link": "https://stackoverflow.com/users/4522343/chalupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "accepted_answer_id": 29336291, "answer_count": 2, "score": 1, "last_activity_date": 1427824404, "creation_date": 1427671192, "last_edit_date": 1427672292, "question_id": 29336139, "link": "https://stackoverflow.com/questions/29336139/writing-the-prefix-function-haskell", "title": "writing the prefix function (Haskell)", "body": "<p>I'm writing a prefix function that will take a binary function and a list of numbers as parameters, and returns a list formed by computing the successive function and accumulating as you go.\nTo make things simple, Here's an example: </p>\n\n<pre><code>prefix (+) [2, 4, 1, 1]\n  returns [2, 6, 7, 8]\n\nprefix (+) [0, 2, -3, 4, -5]\n   returns [0, 2, -1, 3, -2]\n\nprefix max [2, 3, 1, 1]\n   returns [2, 3, 3, 3]\n</code></pre>\n\n<p>Here's my code so far however I get an error when i try to load the file because 'list is not in range'. How can i rewrite it so it makes sense to the compiler? Any help will be appreciated. </p>\n\n<pre><code>prefix' :: (a -&gt; b) -&gt; [a] -&gt;[b]  \nprefix' _ [] = []  \nprefix' f (x:xs) \n      | ((list !! x) == 0) = f (list !! 0) (list !! 0)\n      | otherwise = prefix' f xs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1427664562, "post_id": 29334809, "comment_id": 46858737, "body": "This has nothing to do with the Monad instance or with Maybe. <code>x &gt;&gt;= (\\y -&gt; Just y)</code> = <code>x &gt;&gt;= Just</code> = <code>x &gt;&gt;= return</code> = <code>x</code> (according to the Monad laws). You can write <code>boom n x = boom (n-1) x</code> and you will get the same behaviour. You are explicitly doing recursion on the first arugement - the <code>Int</code> - it would be a very non-trivial optimization in general to deduce that a recursive function can be simplified to a non-recursive definition. You can do this optimization yourself: <code>boom n x = case (x &gt;&gt;= Just) of {Nothing  -&gt; Nothing; y -&gt; boom&#39; (n-1) y}</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427665897, "post_id": 29334809, "comment_id": 46859131, "body": "Some further investigation: GHC won&#39;t even recognize that if <code>boom :: Int -&gt; a -&gt; a; boom 0 x = x; boom n x = boom (n-1) x</code> then <code>boom n</code> is <code>id</code>. I&#39;m not sure I can say <i>why</i>, but I don&#39;t think the bulk of the question about how to do this is actually about <code>Maybe</code> and short-circuiting."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1427666956, "post_id": 29334809, "comment_id": 46859415, "body": "What happens if you add <code>x `seq` </code> to the beginning of the second case?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1427667040, "post_id": 29334809, "comment_id": 46859438, "body": "@dfeuer Nothing interesting changes (it was one of the things I tested during my investigation). It gets a little bit faster -- but it doesn&#39;t switch over from a linear-time algorithm to a constant-time one."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 5, "creation_date": 1427667277, "post_id": 29334809, "comment_id": 46859507, "body": "When using -fllvm the expected optimization appears to take place..."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427665433, "post_id": 29334983, "comment_id": 46859002, "body": "In my tests, <code>print (last [0..n :: Int])</code> takes about 85% of the time of <code>boom n Nothing</code>. So just counting up to an appropriately big number does seem to be a large chunk of the time -- but there is also a chunk of time left over spent thinking about the <code>Maybe</code> bit. And this doesn&#39;t really answer the actual question, which is: why doesn&#39;t GHC recognize that <code>boom n</code> is <code>id</code>?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427667774, "post_id": 29334983, "comment_id": 46859631, "body": "Ghc doesn&#39;t recognise that boom is id because it&#39;s not : boom -1 will loop (I&#39;d won&#39;t)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1427667910, "post_id": 29334983, "comment_id": 46859666, "body": "<code>boom (-1)</code> will loop, but not forever (try <code>(minBound :: Int) - 1 == maxBound</code> in ghci). And even if that weren&#39;t so, one might hope that you could determine that <code>boom n</code> was <code>id</code> whenever <code>n &gt;= 0</code>."}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 0, "last_activity_date": 1427664079, "creation_date": 1427664079, "answer_id": 29334983, "question_id": 29334809, "link": "https://stackoverflow.com/questions/29334809/why-isnt-haskell-able-to-optimize-this-nothing-gets-propagated-needlessly-in/29334983#29334983", "title": "Why isn&#39;t Haskell able to optimize this? (Nothing gets propagated needlessly in the Maybe monad.)", "body": "<p>Because <code>boom</code> expands the <code>n-1</code> first.</p>\n\n<p>So <code>boom 100 x</code> = <code>boom (100-1) ...</code> = <code>boom (100-1-1) ...</code> etc ...</p>\n\n<p>You can try swapping the argument of boom (but I'm not sure that will change anything).</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1427667071, "creation_date": 1427667071, "answer_id": 29335520, "question_id": 29334809, "link": "https://stackoverflow.com/questions/29334809/why-isnt-haskell-able-to-optimize-this-nothing-gets-propagated-needlessly-in/29335520#29335520", "title": "Why isn&#39;t Haskell able to optimize this? (Nothing gets propagated needlessly in the Maybe monad.)", "body": "<p>Yours is a nice example of a function which is slow <em>because it is tail recursive</em>. In strict languages, tail recursive functions are usually preferred since they typically lead to a better performance (in both time and space). In lazy ones tail recursion is not so beneficial. Indeed, a non tail recursive variant of your function is:</p>\n\n<pre><code>boom :: Int -&gt; Maybe a -&gt; Maybe a\nboom 0 x = x\nboom n x = x &gt;&gt;= (\\y -&gt; boom (n-1) (Just y))\n</code></pre>\n\n<p>The above will still loop <code>n</code> times when <code>x</code> is a <code>Just something</code>. However, it will do that in <em>constant space</em> unlike the original code which builds a large thunk in its second argument. Even better, when <code>x</code> is <code>Nothing</code>, the the above code will return immediately.</p>\n\n<p>I do realize that this does not really answer your question about \"why\" GHC is not able to optimize this. But hopefully, it can show that these kinds of optimizations are quite subtle, and often involve an inductive reasoning. Expecting the compiler to optimize this is probably asking a bit too much.</p>\n"}, {"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427695706, "post_id": 29339227, "comment_id": 46866296, "body": "Indeed I can reproduce this behavior (somewhat) on my system: <code>ghc = 1.961sec</code>, <code>ghc -O2 = the same</code> - using <code>-fforce-recomp = 0.218sec</code> so I think that is the reason of why the LLVM backend might suddenly produce better behavior as Thomas mentioned above"}], "tags": [], "owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "is_accepted": false, "score": 1, "last_activity_date": 1427695855, "last_edit_date": 1427695855, "creation_date": 1427694725, "answer_id": 29339227, "question_id": 29334809, "link": "https://stackoverflow.com/questions/29334809/why-isnt-haskell-able-to-optimize-this-nothing-gets-propagated-needlessly-in/29339227#29339227", "title": "Why isn&#39;t Haskell able to optimize this? (Nothing gets propagated needlessly in the Maybe monad.)", "body": "<p>you need to force the recompile with <code>-fforce-recomp</code> </p>\n\n<p>compiled with <code>ghc</code> and got 1.44s</p>\n\n<p>compiled with <code>ghc -O</code> and got 1.44s</p>\n\n<p>compiled with <code>ghc -O -fforce-recomp</code> and got 0.00s to 0.04s</p>\n\n<p>note</p>\n\n<p>It still does not work with <code>boom maxBound (Nothing :: Maybe Int)</code></p>\n\n<p>You will be waiting a very long time.</p>\n"}], "owner": {"reputation": 1147, "user_id": 3523379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60d63603cea5cf4e45808eedab6cafae?s=128&d=identicon&r=PG&f=1", "display_name": "stackoverflowuser", "link": "https://stackoverflow.com/users/3523379/stackoverflowuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 1, "accepted_answer_id": 29335520, "answer_count": 3, "score": 4, "last_activity_date": 1427695855, "creation_date": 1427663056, "question_id": 29334809, "link": "https://stackoverflow.com/questions/29334809/why-isnt-haskell-able-to-optimize-this-nothing-gets-propagated-needlessly-in", "title": "Why isn&#39;t Haskell able to optimize this? (Nothing gets propagated needlessly in the Maybe monad.)", "body": "<p>Let's start with</p>\n\n<pre><code>boom :: Int -&gt; Maybe a -&gt; Maybe a\nboom 0 x = x\nboom n x = boom (n-1) (x &gt;&gt;= (\\y -&gt; Just y))\n</code></pre>\n\n<p>It's a simple function that just repeatedly shoves (<code>&gt;&gt;=</code>) a <code>Maybe</code> value into a trivial <code>\\y -&gt; Just y</code> function.</p>\n\n<p>Now, the program</p>\n\n<pre><code>main = do\n    let z = boom 10 (Nothing :: Maybe Int)\n    putStrLn $ show z\n</code></pre>\n\n<p>runs very quickly, in a split second. However, the program</p>\n\n<pre><code>main = do\n    let z = boom 10000000 (Nothing :: Maybe Int)\n    putStrLn $ show z\n</code></pre>\n\n<p>takes a few seconds to finish, even if I compile with <code>ghc -O</code> (GHC 7.8.3).</p>\n\n<p>This means that Haskell is not able to optimize this away. <code>Nothing</code> gets shoved repeatedly into a function even if there is no need for it to do so.</p>\n\n<p>My question is, <strong>why</strong>? Why can't it deduce that a <code>Nothing</code> always ends up as <code>Nothing</code> in repeated shoving? In other words, <strong>why isn't it able to immediately <em>short-circuit</em> at the first <code>Nothing</code></strong>?</p>\n"}, {"tags": ["haskell", "monoids"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1427662560, "post_id": 29334571, "comment_id": 46858064, "body": "You may find this chunk of output from <code>:i Monoid</code> interesting: <code>instance Monoid b =&gt; Monoid (a -&gt; b)</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1427666921, "post_id": 29334571, "comment_id": 46859406, "body": "Also, a bit more helpfully, though it doesn&#39;t directly answer your question: you almost certainly meant <code>F.foldMap Sum</code> rather than <code>F.foldMap (+)</code>... or perhaps <code>F.foldr (+) 0</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1427667397, "post_id": 29334571, "comment_id": 46859529, "body": "Note that <code>F.foldMap (+)</code> may type check, but it does not sum the elements of the tree."}], "answers": [{"tags": [], "owner": {"reputation": 785, "user_id": 3087558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a43d21bfa85dc7dc360cafa7f69ba3b1?s=128&d=identicon&r=PG&f=1", "display_name": "fgv", "link": "https://stackoverflow.com/users/3087558/fgv"}, "is_accepted": false, "score": 2, "last_activity_date": 1427666727, "creation_date": 1427666727, "answer_id": 29335462, "question_id": 29334571, "link": "https://stackoverflow.com/questions/29334571/foldmap-taking-the-wrong-type-of-parameter/29335462#29335462", "title": "foldMap taking the wrong type of parameter?", "body": "<p>\"Num a =>\" is a typeclass constraint, which indicates that the parameters and results for (+) must be <em>at least</em> members of the typeclass \"Num\", but they can be perfectly members of any other typeclass too (in this case, Monoid). </p>\n\n<p>With respect to z, there are a couple of standard types that would satisfy those constraints (being part of Num and Monoid at the same time). These are Sum and Product, defined in Data.Monoid.</p>\n\n<p>To answer your question, a Tree of Sum or Product would pass the type check and work, and so would do any other type that you define as being part of the typeclasses Num and Monoid.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1427670327, "last_edit_date": 1427670327, "creation_date": 1427669939, "answer_id": 29335966, "question_id": 29334571, "link": "https://stackoverflow.com/questions/29334571/foldmap-taking-the-wrong-type-of-parameter/29335966#29335966", "title": "foldMap taking the wrong type of parameter?", "body": "<p>So let's be clear about what's happening here. We have these two types that we are supposed to unify:</p>\n\n<pre><code>Num a =&gt; a -&gt; a -&gt; a\nMonoid m =&gt; b -&gt; m\n</code></pre>\n\n<p>This can be done by setting <code>b ~ a</code> and <code>m ~ a -&gt; a</code>, resulting in</p>\n\n<pre><code>(Num a, Monoid (a -&gt; a)) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Moreover, there is a monoid instance for functions:</p>\n\n<pre><code>instance Monoid b =&gt; Monoid (a -&gt; b) where\n    mempty = \\_ -&gt; mempty\n    mappend f g = \\x -&gt; f x `mappend` g x\n</code></pre>\n\n<p>(Let's set aside why this instance is useful for a moment.) This means that, in fact, to satisfy the <code>Monoid (a -&gt; a)</code> constraint, we need only ensure that the return type -- <code>a</code> -- is a monoid, hence we now arrive at this type for <code>(+)</code>:</p>\n\n<pre><code>(Num a, Monoid a) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>and this type for <code>foldMap (+)</code>:</p>\n\n<pre><code>(Monoid a, F.Foldable t) =&gt; t a -&gt; a -&gt; a\n</code></pre>\n\n<p>The behavior of this is to walk over the tree, (partially) applying <code>(+)</code> to each element of the tree, then use <code>mappend</code> to combine all the results. Thus, the small example tree <code>Node 3 (Node 1 Empty Empty) (Node 6 Empty Empty)</code> would result in something like this:</p>\n\n<pre><code>(mempty `mappend` (+) 1 `mappend` mempty) `mappend`\n(+) 3                                     `mappend`\n(mempty `mappend` (+) 6 `mappend` mempty)\n</code></pre>\n\n<p>For compactness, let's write this as <code>mconcat [(1+), (3+), (6+)]</code>, even though that's fudging things a little bit. Running <code>foldMap (+)</code> on your larger example tree would be <code>mconcat [(1+), (3+), (6+), (5+), (8+), (9+), (10+)]</code>.</p>\n\n<p>Now, working out what the monoid instance on functions says, we find that <code>mconcat [f,g,h] = \\x -&gt; mconcat [f x, g x, h x]</code>, and so on with more functions. So <code>foldMap (+) testTree</code> comes out to</p>\n\n<pre><code>\\n -&gt; mconcat [1+n, 3+n, 6+n, 5+n, 8+n, 9+n, 10+n]\n</code></pre>\n\n<p>Probably you were expecting <code>foldMap (+) testTree</code> to come out to something like <code>1+3+6+5+8+9+10</code>; hopefully you can see the actual outcome dramatically differs from your expectation (and why).</p>\n\n<p>If what we want to do is add up all the elements of a tree, we can actually make this work by accident. We can specifically choose the <code>Sum</code> monoid and pick <code>n</code> to be <code>0</code>: so, for example</p>\n\n<pre><code>getSum $ foldMap (+) testTree 0\n= { by our computations above }\ngetSum $ (\\n -&gt; mconcat [1+n, 3+n, 6+n, 5+n, 8+n, 9+n, 10+n]) 0\n= { beta reduction }\ngetSum $ mconcat [1+0, 3+0, 6+0, 5+0, 8+0, 9+0, 10+0]\n= { n+0 = n }\ngetSum $ mconcat [1, 3, 6, 5, 8, 9, 10]\n= { definition of mconcat for Sum }\ngetSum $ sum [1, 3, 6, 5, 8, 9, 10]\n= { playing fast and loose with polymorphic literals }\nsum [1, 3, 6, 5, 8, 9, 10]\n</code></pre>\n\n<p>That's an awfully convoluted way to get the sum of the elements in a tree. But hopefully this explains why what you wrote is not simply a type error; what the meaning of <code>z</code> is; and why it's not important that <code>Num</code> is neither subclass nor superclass of <code>Monoid</code>.</p>\n"}], "owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1427670327, "creation_date": 1427661563, "question_id": 29334571, "link": "https://stackoverflow.com/questions/29334571/foldmap-taking-the-wrong-type-of-parameter", "title": "foldMap taking the wrong type of parameter?", "body": "<p>Here is some examples from Learn You a Haskell:</p>\n\n<pre><code>import qualified Data.Foldable as F\n\ndata\u00a0Tree\u00a0a\u00a0=\u00a0Empty\u00a0|\u00a0Node\u00a0a\u00a0(Tree\u00a0a)\u00a0(Tree\u00a0a)\u00a0deriving\u00a0(Show,\u00a0Read,\u00a0Eq)\u00a0\u00a0\n\ninstance\u00a0F.Foldable\u00a0Tree\u00a0where\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0foldMap\u00a0f\u00a0Empty\u00a0=\u00a0mempty\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0foldMap\u00a0f\u00a0(Node\u00a0x\u00a0l\u00a0r)\u00a0=\u00a0F.foldMap\u00a0f\u00a0l\u00a0`mappend`\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0f\u00a0x\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0`mappend`\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0F.foldMap\u00a0f\u00a0r\u00a0\u00a0\n\ntestTree\u00a0=\u00a0Node\u00a05\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(Node\u00a03\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(Node\u00a01\u00a0Empty\u00a0Empty)\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(Node\u00a06\u00a0Empty\u00a0Empty)\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0)\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(Node\u00a09\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(Node\u00a08\u00a0Empty\u00a0Empty)\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(Node\u00a010\u00a0Empty\u00a0Empty)\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0)\u00a0\u00a0\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>&gt; let z = F.foldMap (+) testTree\n&gt; :t F.foldMap\nF.foldMap :: (Monoid m, F.Foldable t) =&gt; (a -&gt; m) -&gt; t a -&gt; m\n&gt; :t (+)\n(+) :: Num a =&gt; a -&gt; a -&gt; a\n&gt; :t z\nz :: (Monoid a, Num a) =&gt; a -&gt; a\n</code></pre>\n\n<p>First param of <code>F.foldable</code> is a function that returns a Monoid, but Num is not a subclass of Monoid, so (+) is surely not qualified here? But from the tests it seems to fit just fine.</p>\n\n<p>And <code>z</code> is kind of mysterious here, it's supposed to be a Monoid, but what is it, concretely? </p>\n"}, {"tags": ["function", "haskell", "types"], "comments": [{"owner": {"reputation": 7070, "user_id": 1087848, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7c09991a02e7ffa559c69d159231b07a?s=128&d=identicon&r=PG", "display_name": "11684", "link": "https://stackoverflow.com/users/1087848/11684"}, "edited": false, "score": 0, "creation_date": 1427661130, "post_id": 29334360, "comment_id": 46857632, "body": "Aren&#39;t arrays zero-based in Haskell? Does it work if you use <code>!! 0</code> instead of 1?"}, {"owner": {"reputation": 7070, "user_id": 1087848, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7c09991a02e7ffa559c69d159231b07a?s=128&d=identicon&r=PG", "display_name": "11684", "link": "https://stackoverflow.com/users/1087848/11684"}, "edited": false, "score": 0, "creation_date": 1427661203, "post_id": 29334360, "comment_id": 46857654, "body": "By the way, clarifying your exact problem would help; do you get a compiletime error? A runtime error? Does it run but not behave as expected? What does it do instead?"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1427669093, "post_id": 29334543, "comment_id": 46859938, "body": "@Bergi: well, actually it didn&#39;t work the way I first wrote it: I was just making the point that you can use arbitrary things within the function body without it affecting the signature. But <code>myLast</code> wasn&#39;t really meant serious, hence the ellipsis... But alright, I now changed it so it does work. Basically, the idea is trying to pop elements off the list in an infinite loop (implemented by fixpoint recursion). Instead of an ordinary termination condition, I <i>use</i> the fact that <code>last []</code> gives an error, and catch that exception with <a href=\"http://hackage.haskell.org/package/spoon\" rel=\"nofollow noreferrer\"><code>spoon</code></a>."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1427669975, "post_id": 29334543, "comment_id": 46860159, "body": "Oh wow. I understood that it wasn&#39;t serious, but didn&#39;t grasp how crazy it really was :-) I had never encountered teaspoons as well, so thanks for the example and link!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1427668690, "last_edit_date": 1427668690, "creation_date": 1427661392, "answer_id": 29334543, "question_id": 29334360, "link": "https://stackoverflow.com/questions/29334360/beginner-haskell-making-a-last-function-with-reverse/29334543#29334543", "title": "Beginner Haskell: Making a last function with reverse", "body": "<p>A function's type signature has nothing to do with what you use <em>in</em> the function, it only describes how other people can use this function <em>you're defining</em>. So by writing</p>\n\n<pre><code>myLast :: [a] -&gt; [a] -&gt; Int -&gt; a\n</code></pre>\n\n<p>you're saying, users need to supply two lists and and integer. Just to get the last element of one of the lists?? That doesn't make sense.</p>\n\n<p>You surely mean</p>\n\n<pre><code>myLast :: [a] -&gt; a\n</code></pre>\n\n<p>You should generally write that down <em>before even thinking</em> about how you're going to implement that function.</p>\n\n<p>With that signature, you can write various implementations:</p>\n\n<pre><code>myLast :: [a] -&gt; a\nmyLast xs = head $ reverse xs\n\nmyLast' :: [a] -&gt; a\nmyLast' [l] = l\nmyLast' (_:xs) = myLast' xs\n\nmyLast'' :: [a] -&gt; a\nmyLast'' = fix $ \\f (x:xs) -&gt; maybe x id . teaspoon $ f xs\n</code></pre>\n\n<p>or whatever weird implementation you choose, it has nothing to do with the signature.</p>\n\n<p>On an unrelated note: though <code>last</code> is actually a standard function from the prelude, it's a <a href=\"https://en.wikipedia.org/wiki/Partial_function\" rel=\"nofollow\">kind of function</a> avoided in modern Haskell: <code>last []</code> gives an error, because the <em>is</em> no <code>a</code> value to be found in the empty list! Errors are bad. Hence the &ldquo;ideal&rdquo; way to write it is actually</p>\n\n<pre><code>myLast :: [a] -&gt; Maybe a\nmyLast [] = Nothing\nmyLast [x] = x\nmyLast (_:xs) = myLast xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7070, "user_id": 1087848, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7c09991a02e7ffa559c69d159231b07a?s=128&d=identicon&r=PG", "display_name": "11684", "link": "https://stackoverflow.com/users/1087848/11684"}, "is_accepted": false, "score": 1, "last_activity_date": 1427661750, "last_edit_date": 1427661750, "creation_date": 1427661404, "answer_id": 29334545, "question_id": 29334360, "link": "https://stackoverflow.com/questions/29334360/beginner-haskell-making-a-last-function-with-reverse/29334545#29334545", "title": "Beginner Haskell: Making a last function with reverse", "body": "<p>I would recommend not using <code>!!</code> at all, but to use <code>head</code>.</p>\n\n<pre><code>myLast xs = head (reverse xs)\n</code></pre>\n\n<p>Head returns the first element of the list it is given as argument.<br>\nIf you insist on using <code>!!</code>, in Haskell arrays are indeed zero-based, which means that <code>!! 0</code> gets the first element, <code>!! 1</code> the second, etc.</p>\n\n<p><strike>As for the type: <code>myLast</code> takes an array of some type and returns one item of that same type. That is denoted as follows:</p>\n\n<pre><code>myLast :: [a] -&gt; a\n</code></pre>\n\n<p></strike> @leftaroundabout covered this way better in his answer.</p>\n"}, {"tags": [], "owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1427680789, "creation_date": 1427680789, "answer_id": 29337286, "question_id": 29334360, "link": "https://stackoverflow.com/questions/29334360/beginner-haskell-making-a-last-function-with-reverse/29337286#29337286", "title": "Beginner Haskell: Making a last function with reverse", "body": "<p>Based on @leftaroundabout 's answer, here's an implementation that should do what you want:</p>\n\n<pre><code>safeHead :: [a] -&gt; Maybe a\nsafeHead [] = Nothing\nsafeHead (x:_) = Just x\n\nmyLast :: [a] -&gt; Maybe a\nmyLast [] = Nothing\nmyLast xs = safeHead $ reverse xs\n</code></pre>\n\n<p>The <code>Maybe</code> type is constructed as follows (from <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-Base.html#Maybe\" rel=\"nofollow\">Hackage</a>):</p>\n\n<pre><code>data  Maybe a  =  Nothing | Just a\n  deriving (Eq, Ord)\n</code></pre>\n\n<p><code>myLast [1, 2, 3, 4]</code>, for example, will return <code>Just 4</code>. If you want to use the value <code>4</code> you can use the function <code>fromJust</code> function from the <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/Data-Maybe.html#fromJust\" rel=\"nofollow\"><code>Data.Maybe</code> module</a> (<code>fromJust (Just 4)</code> returns <code>4</code>). <code>fromJust</code> is defined like this:</p>\n\n<pre><code>-- | The 'fromJust' function extracts the element out of a 'Just' and\n-- throws an error if its argument is 'Nothing'.\n--\n-- ==== __Examples__\n--\n-- Basic usage:\n--\n-- &gt;&gt;&gt; fromJust (Just 1)\n-- 1\n--\n-- &gt;&gt;&gt; 2 * (fromJust (Just 10))\n-- 20\n--\n-- &gt;&gt;&gt; 2 * (fromJust Nothing)\n-- *** Exception: Maybe.fromJust: Nothing\n--\nfromJust          :: Maybe a -&gt; a\nfromJust Nothing  = error \"Maybe.fromJust: Nothing\" -- yuck\nfromJust (Just x) = x\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4727309, "user_type": "registered", "profile_image": "https://graph.facebook.com/1563027420618377/picture?type=large", "display_name": "Zach Arias", "link": "https://stackoverflow.com/users/4727309/zach-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 29334543, "answer_count": 3, "score": 0, "last_activity_date": 1427680789, "creation_date": 1427660416, "last_edit_date": 1427661072, "question_id": 29334360, "link": "https://stackoverflow.com/questions/29334360/beginner-haskell-making-a-last-function-with-reverse", "title": "Beginner Haskell: Making a last function with reverse", "body": "<p>I'm attempting to make a function that generates the last item in a list. I want to use reverse and !!. This is what I have so far:</p>\n\n<pre><code>myLast :: [a] -&gt; [a] -&gt; Int -&gt; a\nmyLast xs = (reverse xs) !! 1\n</code></pre>\n\n<p>I know the problem lies somewhere within the type, but I'm having trouble identifying how to fix it.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1427659833, "post_id": 29334118, "comment_id": 46857200, "body": "You should definitely use a properly-endowed exception monad transformer rather than relying on IO.  That said, the behavior you are seeing is pretty weird"}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1427661610, "post_id": 29334118, "comment_id": 46857785, "body": "I am actually relying on the <code>exceptions</code> package trying to follow <a href=\"https://www.fpcomplete.com/user/DanBurton/test-upload-group/content/exceptions-best-practices\" rel=\"nofollow noreferrer\">these principles</a>."}], "answers": [{"comments": [{"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "edited": false, "score": 0, "creation_date": 1427659871, "post_id": 29334249, "comment_id": 46857211, "body": "Yes I have forgotten the testfoo ... I will edit my question."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "edited": false, "score": 1, "creation_date": 1427660008, "post_id": 29334249, "comment_id": 46857245, "body": "@PierreR I would give the same answer to your edited question (up to the renamings you gave in your edit)."}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "edited": false, "score": 0, "creation_date": 1427660268, "post_id": 29334249, "comment_id": 46857335, "body": "I actually thought <code>testCatalog fp t = testFileSources fp t &gt;&gt; testUsersGroups fp t</code> was equivalent to <code>testCatalog = testFileSources &gt;&gt; testUsersGroups</code> ... So this could be my problem all along ..."}, {"owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "edited": false, "score": 0, "creation_date": 1427661057, "post_id": 29334249, "comment_id": 46857611, "body": "Yep I have just checked it. My confusion has born from the fact that I have always assumed it was equivalent with or without the params ...Thanks so much !"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1427659981, "last_edit_date": 1427659981, "creation_date": 1427659789, "answer_id": 29334249, "question_id": 29334118, "link": "https://stackoverflow.com/questions/29334118/wicked-exceptions-behavior-using-the-exceptions-package/29334249#29334249", "title": "Wicked exceptions behavior using the `exceptions` package", "body": "<p>You probably meant <code>testme fp t = testfoo fp t &gt;&gt; testbar fp t</code> instead of <code>testme = testfoo &gt;&gt; testbar</code>. In the latter, the <code>(&gt;&gt;)</code> is from the <code>(-&gt;) r</code> instance, which is what's surprising you: <code>f &gt;&gt; g</code> is the same as just <code>g</code> for the <code>(-&gt;) r</code> monad (but makes your computer a little hotter).</p>\n"}], "owner": {"reputation": 206, "user_id": 3943027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b609c6568ccf94f887297f33ebc9f62?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre R", "link": "https://stackoverflow.com/users/3943027/pierre-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 29334249, "answer_count": 1, "score": 1, "last_activity_date": 1427659981, "creation_date": 1427659112, "last_edit_date": 1427659894, "question_id": 29334118, "link": "https://stackoverflow.com/questions/29334118/wicked-exceptions-behavior-using-the-exceptions-package", "title": "Wicked exceptions behavior using the `exceptions` package", "body": "<p>I have been taken aback by some peculiar behavior while using the <code>exceptions</code> package.</p>\n\n<p>I have a function that looks like:</p>\n\n<pre><code>testme ::(MonadThrow m , Monad O m, Applicative m) =&gt; FilePath -&gt; Text -&gt; m ()\ntestme fp t = testfoo fp t &gt;&gt; testbar fp t\n</code></pre>\n\n<p>with</p>\n\n<pre><code>testfoo :: (MonadThrow m , MonadIO m, Applicative m) =&gt; FilePath -&gt; Text -&gt; m ()\ntestbar :: (MonadThrow m , MonadIO m, Applicative m) =&gt; FilePath -&gt; Text -&gt; m ()\n</code></pre>\n\n<p>Another module will catch all the specific exceptions thrown here doing something along the line:</p>\n\n<pre><code>catching _PrettyError\n         (do {testCatalog workingdir c; return stm})\n         (return . S.Left)\n</code></pre>\n\n<p>And _PrettyError is defined as such:</p>\n\n<pre><code>_PrettyError :: Prism' SomeException PrettyError\n_PrettyError = prism' toException fromException\n</code></pre>\n\n<p>My first surprise comes from the fact that if I change <code>testme</code> for:</p>\n\n<pre><code>testme = testfoo  &gt;&gt; testbar\n</code></pre>\n\n<p>Ghc refuses to compile because it can't deduce MonadThrow.</p>\n\n<p>Trying this signature:</p>\n\n<pre><code>testme :: FilePath -&gt; Text -&gt; IO ()\ntestme = testfoo &gt;&gt; testbar\n</code></pre>\n\n<p>Ghc still don't want to deduce <code>MonadThrow</code> which I find more surprising.</p>\n\n<p>I am now making another type signature change:</p>\n\n<pre><code>testfoo :: FilePath -&gt; Text -&gt; IO ()\ntestbar :: FilePath -&gt; Text -&gt; IO ()\n</code></pre>\n\n<p>And ... it does compile but in utter bewilderment I have then realized that only the exceptions from the second call (testbar) would be caught by <code>catching</code>.\nThe ones throws by <code>testfoo</code> are just lost somehow ...</p>\n\n<p>I am amazed that changing signatures would completely change the exception handling.</p>\n\n<p><a href=\"https://github.com/bartavelle/language-puppet/commit/f9f8b8b70ed055125bee5ef6426badcf01f66cd6\" rel=\"nofollow\">The commit of the real code is here</a> (with notes).</p>\n\n<p>The current code does work as expected.</p>\n\n<p>My question is really why the signature change from explicit constraints to a specific IO monad causes such an unexpected behavior (the exceptions from the first term of <code>&gt;&gt;</code> aren't caught anymore). My understanding is that in both case the <code>IO</code> monad is at play.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["haskell", "interface", "state"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1427658967, "post_id": 29333788, "comment_id": 46856946, "body": "Your <code>ProgramState</code> doesn&#39;t really make sense. You are saying that there is a field called <code>componentState</code>, whose type is completely unknown. You cannot magically &quot;produce&quot; a value of type <code>ComponentState</code> from the <code>componentState</code> field because you have existentially quantified the type variable <code>cs</code> - the type of <code>cs</code> is no longer visible to the outside world. You are correct that &quot;myFunction can&#39;t prove that the record selector provides an appropriate type&quot;. The obvious solution is to not existentially quantify <code>cs</code> - it is not clear at all why you would want to in this case."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1427664733, "post_id": 29333788, "comment_id": 46858791, "body": "This might be relevant: <a href=\"http://stackoverflow.com/q/13915923/1333025\">Combining multiple states in StateT</a>."}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427659139, "post_id": 29334041, "comment_id": 46856999, "body": "That&#39;s what I was actually using for the user state in my library. I suppose I could parametrize over both. I think I had some problems with that, though. One of them is having to repeat the type manually everytime."}, {"owner": {"reputation": 10108, "user_id": 450811, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b1a81486c967643c2f05cddb94841d27?s=128&d=identicon&r=PG", "display_name": "Waldheinz", "link": "https://stackoverflow.com/users/450811/waldheinz"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427659418, "post_id": 29334041, "comment_id": 46857069, "body": "You can always create a new type when it gets too long, like having <code>type Program = ProgramState ComponentState</code> and from there on only use <code>Program</code> instead of the expanded type."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427795900, "post_id": 29334041, "comment_id": 46914379, "body": "I&#39;ve came up with a working example and posted it on <a href=\"http://codereview.stackexchange.com/questions/85481/did-i-understand-this-module-idea-correctly\">CodeReview</a>."}], "tags": [], "owner": {"reputation": 10108, "user_id": 450811, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b1a81486c967643c2f05cddb94841d27?s=128&d=identicon&r=PG", "display_name": "Waldheinz", "link": "https://stackoverflow.com/users/450811/waldheinz"}, "is_accepted": false, "score": 1, "last_activity_date": 1427658738, "creation_date": 1427658738, "answer_id": 29334041, "question_id": 29333788, "link": "https://stackoverflow.com/questions/29333788/how-to-create-an-interface-for-a-stateful-component-where-the-state-type-is-opaq/29334041#29334041", "title": "How to create an interface for a stateful component where the state type is opaque?", "body": "<p>You can parametrize <code>ProgramState</code> by the type of the component state(s), e.g. have</p>\n\n<pre><code>data ProgramState cs = ProgramState { componentState :: cs }\n</code></pre>\n\n<p>This would mean you'll also have to expose the <code>ComponentState</code> type from <code>InternalComponent.hs</code>, but <em>not</em> the constructors. This way you give the type checker something to play with, but don't expose any internals to the users of <code>InternalComponent</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427717118, "post_id": 29345138, "comment_id": 46877457, "body": "I&#39;m still in progress of reading the linked answer (thanks for your comment BTW!) I&#39;ll read that ASAP. Oh, and forgot to mention I made a deliberate choice of not using Lens in this library (though I might backpedal from that, given how much pain it is to work with regular haskell records)."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427797225, "post_id": 29345138, "comment_id": 46915147, "body": "I&#39;ve came up with a working example and posted it on <a href=\"http://codereview.stackexchange.com/questions/85481/did-i-understand-this-module-idea-correctly\">CodeReview</a>"}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 1, "last_activity_date": 1427715191, "last_edit_date": 1495535055, "creation_date": 1427715191, "answer_id": 29345138, "question_id": 29333788, "link": "https://stackoverflow.com/questions/29333788/how-to-create-an-interface-for-a-stateful-component-where-the-state-type-is-opaq/29345138#29345138", "title": "How to create an interface for a stateful component where the state type is opaque?", "body": "<p>First, I'd suggest to read <a href=\"https://stackoverflow.com/q/13915923/1333025\">Combining multiple states in StateT</a>, just to see other available options.</p>\n\n<p>Since in the case of nested states we need to update values inside more complex objects, using <a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lens</a> can make life a lot easier (see also <a href=\"https://www.fpcomplete.com/school/to-infinity-and-beyond/pick-of-the-week/a-little-lens-starter-tutorial\" rel=\"nofollow noreferrer\">this tutorial</a>). A value of type <code>Lens' s a</code> knows how to reach a particular value of type <code>a</code> inside <code>s</code> and how to modify it (that is, creating a new value of type <code>s</code> that is the same, except for a modified <code>a</code>). Then we can define a helper function</p>\n\n<pre><code>runInside :: (MonadState s m) =&gt; Lens' s a -&gt; State a r -&gt; m r\nrunInside lens s = lens %%= (runState s)\n</code></pre>\n\n<p>Given a lens and a stateful computation on <code>a</code>, we can lift such a computation to a stateful computation parametrized by <code>s</code>. The library allows us to generate lenses using Template Haskell, for example:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, TemplateHaskell #-}\nimport Control.Lens.TH\n\ndata ProgramState cs = ProgramState { _componentState :: cs }\n\n$(makeLenses ''ProgramState)\n</code></pre>\n\n<p>will generate <code>componentState :: Lens' ProgramState cs</code> (actually the generated function will be slightly more more generic). Combining them together we get</p>\n\n<pre><code>runInside componentState :: MonadState (ProgramState a) m =&gt; State a r -&gt; m r\n</code></pre>\n\n<hr>\n\n<p>Using <code>Typeable</code> we could go even further and create a map that automatically creates or keeps a state for whatever type it is asked for. I'd not recommend this approach in general, as it sort-of avoids Haskell's strong type system checks, but it might be useful in some cases.</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification, ScopedTypeVariables, RankNTypes #-}\nimport Control.Lens\nimport Control.Lens.TH\nimport Control.Monad.State\nimport Data.Map (Map)\nimport qualified Data.Map as Map\nimport Data.Typeable\n\ndata Something = forall a . Typeable a =&gt; Something a\n\ntype TypeMap = Map TypeRep Something\n</code></pre>\n\n<p>We defined a generic untyped container that can hold whatever is <code>Typeable</code> and a map that maps representation of types to their values.</p>\n\n<p>We'll need some class to provide default/starting values:</p>\n\n<pre><code>class Default a where\n    getDefault :: a\n\n-- just an example\ninstance Default Int where\n    getDefault = 0\n</code></pre>\n\n<p>Finally, we can create a lens that given an arbitrary <code>Typeable</code> type, it focuses on its value in the map by looking up its type representation:</p>\n\n<pre><code>typeLens :: forall t . (Typeable t, Default t) =&gt; Lens' TypeMap t\ntypeLens = lens get set\n  where\n    set map v = Map.insert (typeOf v) (Something v) map\n    get map = case Map.lookup (typeRep (Proxy :: Proxy t)) map of\n                Just (Something v) | Just r &lt;- cast v   -&gt; r\n                _                                       -&gt; getDefault\n</code></pre>\n\n<p>So you could have <code>TypeMap</code> somewhere in your state and let all stateful computations use it, regardless of what state they need.</p>\n\n<p>However, there is a <strong>big warning</strong>: If two unrelated computations happen to use the same type for their state, they'll share the value with very likely disastrous results! So using explicit records for states of different parts of your computations is going to be much safer.</p>\n"}], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1427715191, "creation_date": 1427657467, "last_edit_date": 1427657944, "question_id": 29333788, "link": "https://stackoverflow.com/questions/29333788/how-to-create-an-interface-for-a-stateful-component-where-the-state-type-is-opaq", "title": "How to create an interface for a stateful component where the state type is opaque?", "body": "<pre><code>-- InternalComponent.hs\ndata ComponentState = ComponentState ...\ninstance Default ComponentState where ...\n\ncomponentFunction :: (MonadState InternalComponentState m) =&gt; a -&gt; m a\n\n-- Program.hs\ndata ProgramState = forall cs. ProgramState {\n    componentState :: cs,\n    ...\n}\n\nnewtype MyMonad a = MyMonad { runMyMonad :: StateT ProgramState IO a }\n\nmyFunction a = do\n    s &lt;- get\n    let cs = componentState s\n    let (r, cs') = runState (componentFunction a) cs\n    put $ s { componentState = cs' }\n    return r\n</code></pre>\n\n<p>What I want is to be able to use the <code>componentFunction</code> inside of <code>MyMonad</code> (in <code>myFunction</code>, as presented in the example), without being particularly interested in the actual type of the state the component requires. Keeping the component state inside of my own state isn't a requirement, but that's as far as my ability to use state in Haskell goes.</p>\n\n<p>This can really be viewed as an equivalent of an implementation of a stateful interface in another programming language: instantiation of the interface with some implementation provides default state value, and every function called through that interface can modify that state. In any point isn't the user presented with implementation details.</p>\n\n<p>In case it's not clear, the above example fails because the implementation of <code>myFunction</code> can't prove that the record selector provides an appropriate type (because it's an existential); at least that's how I understand it.</p>\n"}, {"tags": ["haskell", "graph"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1427654410, "last_edit_date": 1427654410, "creation_date": 1427654080, "answer_id": 29333160, "question_id": 29333127, "link": "https://stackoverflow.com/questions/29333127/problems-building-unode-and-lnode-defined-in-fgl-data-graph-inductive-graph/29333160#29333160", "title": "Problems building UNode and LNode defined in FGL Data.Graph.Inductive.Graph", "body": "<p><code>UNode</code> and <code>LNode</code> already live at the type level, so asking for their type is a bit strange. Perhaps you want to know their kind, instead, in which case you can use <code>:k[ind]</code> instead of <code>:t[ype]</code>.</p>\n\n<pre><code>Prelude Data.Graph.Inductive.Graph&gt; :k UNode\nUNode :: *\nPrelude Data.Graph.Inductive.Graph&gt; :k LNode\nLNode :: * -&gt; *\n</code></pre>\n\n<p>Or perhaps you want to know how to build one of them, in which case you can use <code>:i[nfo]</code> to find out more:</p>\n\n<pre><code>Prelude Data.Graph.Inductive.Graph&gt; :i UNode\ntype UNode = LNode ()   -- Defined in \u2018Data.Graph.Inductive.Graph\u2019\nPrelude Data.Graph.Inductive.Graph&gt; :i LNode\ntype LNode a = (Node, a)\n    -- Defined in \u2018Data.Graph.Inductive.Graph\u2019\nPrelude Data.Graph.Inductive.Graph&gt; :i Node\ntype Node = Int     -- Defined in \u2018Data.Graph.Inductive.Graph\u2019\nPrelude Data.Graph.Inductive.Graph&gt; :i (,)\ndata (,) a b = (,) a b  -- Defined in \u2018GHC.Tuple\u2019\n-- [editor's note: many instances snipped here]\n</code></pre>\n\n<p>And now we finally know how to build a <code>UNode</code>, if a bit painstakingly:</p>\n\n<pre><code>Prelude Data.Graph.Inductive.Graph&gt; (32, ()) :: UNode\n(32,())\n</code></pre>\n"}], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 29333160, "answer_count": 1, "score": 0, "last_activity_date": 1427654834, "creation_date": 1427653907, "last_edit_date": 1427654834, "question_id": 29333127, "link": "https://stackoverflow.com/questions/29333127/problems-building-unode-and-lnode-defined-in-fgl-data-graph-inductive-graph", "title": "Problems building UNode and LNode defined in FGL Data.Graph.Inductive.Graph", "body": "<p>I'm trying to learn to use FGL.</p>\n\n<p>I don't understand why I can't use <code>UNode</code>, <code>LNode</code>, <code>LEdge</code> and <code>UEdge</code>. The types seems unknown to ghci, although when I type <code>:t mkGraph</code> it explicitely uses them.</p>\n\n<pre><code>\u03bb: import Data.Graph.Inductive.Graph\n\u03bb: :t UNode\n\n&lt;interactive&gt;:1:1: Not in scope: data constructor `UNode'\n\u03bb: :t LNode\n\n&lt;interactive&gt;:1:1: Not in scope: data constructor `LNode'\n\u03bb: :t mkGraph\nmkGraph :: Graph gr =&gt; [LNode a] -&gt; [LEdge b] -&gt; gr a b\n</code></pre>\n\n<p>What have I forgotten to do ?</p>\n\n<p>I'm trying to create UNode and LNode from Int, and cannot figure out how to do it.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 24443, "user_id": 100020, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7b137a205dff52b6471dfd17158c8b8f?s=128&d=identicon&r=PG", "display_name": "sdcvvc", "link": "https://stackoverflow.com/users/100020/sdcvvc"}, "edited": false, "score": 4, "creation_date": 1427654224, "post_id": 29333085, "comment_id": 46855292, "body": "Note that <code>bind</code> is not a keyword. It&#39;s a name people use to refer to <code>&gt;&gt;=</code> operator. You can define <code>bind = (&gt;&gt;=)</code> if that helps."}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "reply_to_user": {"reputation": 24443, "user_id": 100020, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7b137a205dff52b6471dfd17158c8b8f?s=128&d=identicon&r=PG", "display_name": "sdcvvc", "link": "https://stackoverflow.com/users/100020/sdcvvc"}, "edited": false, "score": 0, "creation_date": 1427656240, "post_id": 29333085, "comment_id": 46856007, "body": "Thank you for correcting me.  I should have known it was a name, not a built-in keyword.  I&#39;ll edit my post (and leave this comment if you leave yours)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1427660772, "post_id": 29333085, "comment_id": 46857498, "body": "Indeed almost nothing is a keyword in Haskell (<code>class</code>, <code>instance</code>, <code>type</code>, <code>newtype</code>, <code>data</code>, <code>case</code>&#39;<code>of</code>, <code>do</code>, <code>if</code>&#39;<code>then</code>&#39;<code>else</code>, <code>let</code>&#39;<code>in</code>, <code>where</code>: those are pretty much all that can occur in the actual code part. Plus a few more which are only used in the module header, and a few from GHC extensions \u2013 the full list <a href=\"https://wiki.haskell.org/Keywords\" rel=\"nofollow noreferrer\">is here</a>.) All other <i>words</i> are simply names of functions/actions, defined in some library (if not in your own code); you can use <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a> or <a href=\"http://hayoo.fh-wedel.de/\" rel=\"nofollow noreferrer\">Hayoo</a> to find them."}], "answers": [{"comments": [{"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 0, "creation_date": 1427654197, "post_id": 29333123, "comment_id": 46855283, "body": "Thank you for the answer and advice.  FYI, I wasn&#39;t planning to use <code>bind</code> as a word in programs, just as an intermediate step when teaching monads.  I appreciate the <code>do</code> syntax."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 2, "creation_date": 1427654286, "post_id": 29333123, "comment_id": 46855309, "body": "@espertus sorry, can&#39;t help it; I just keep seeing the more and more ways  to write the function :)"}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "edited": false, "score": 1, "creation_date": 1427654744, "post_id": 29333123, "comment_id": 46855486, "body": "Thanks for the improvements, although I&#39;m just trying to stay <i>one</i> step ahead of my students. :-)"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 6, "last_activity_date": 1427654215, "last_edit_date": 1427654215, "creation_date": 1427653893, "answer_id": 29333123, "question_id": 29333085, "link": "https://stackoverflow.com/questions/29333085/how-to-use-bind-keyword-instead-of-operator-in-haskell/29333123#29333123", "title": "How to use &quot;bind&quot; keyword instead of &quot;&gt;&gt;=&quot; operator in Haskell", "body": "<p>This isn't a part of Prelude; it resides in <a href=\"http://hackage.haskell.org/package/monad-extras-0.5.9/docs/Control-Monad-Extra.html\"><code>Control.Monad.Extra</code></a>, a part of <code>monad-extras</code> package.</p>\n\n<hr>\n\n<p>However, you can call operators in prefix manner (like named functions) easily:</p>\n\n<pre><code>processNumsMonadically n d = (&gt;&gt;=) (divide n d) (\\q -&gt; return (q+1))\n</code></pre>\n\n<p>You could also just use <code>do</code> notation:</p>\n\n<pre><code>processNumsMonadically n d = do\n    q &lt;- divide n d\n    return (q+1)\n</code></pre>\n\n<p>But while we're at it, I'd write using a Functor:</p>\n\n<pre><code>processNumsMonadically n d = fmap (+1) (divide n d)\n</code></pre>\n\n<p>or Applicative syntax:</p>\n\n<pre><code>processNumsMonadically n d = (+1) &lt;$&gt; divide n d\n</code></pre>\n\n<p>You could also <code>lift</code> the <code>+1</code> to avoid the need for <code>return</code> and the lambda.</p>\n\n<hr>\n\n<p>As a personal style remark, <code>bind</code> used as a word isn't idiomatic, and IMHO you shouldn't use it.</p>\n"}], "owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 29333123, "answer_count": 1, "score": 0, "last_activity_date": 1427656977, "creation_date": 1427653735, "last_edit_date": 1427656977, "question_id": 29333085, "link": "https://stackoverflow.com/questions/29333085/how-to-use-bind-keyword-instead-of-operator-in-haskell", "title": "How to use &quot;bind&quot; keyword instead of &quot;&gt;&gt;=&quot; operator in Haskell", "body": "<p>I'm trying to understand Haskell monads and wrote this test program, which compiles and works as expected:</p>\n\n<pre><code>divide :: Int -&gt; Int -&gt; Either String Int\ndivide _ 0 = Left \"Divide by zero error\ndivide numerator denom = Right (numerator `div` denom)\n\nprocessNumsMonadically :: Int -&gt; Int -&gt; Either String Int\nprocessNumsMonadically n d = divide n d &gt;&gt;= \\q -&gt; return (q+1)\n</code></pre>\n\n<p>When I try using the word <code>bind</code> instead of the <code>&gt;&gt;=</code> operator in the latter function definition:</p>\n\n<pre><code>processNumsMonadically n d = bind (divide n d) (\\q -&gt; return (q+1))\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>Not in scope: 'bind'\n</code></pre>\n\n<p>What is the correct way to use the word <code>bind</code>?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 1, "last_activity_date": 1427671637, "last_edit_date": 1427671637, "creation_date": 1427671305, "answer_id": 29336158, "question_id": 29333025, "link": "https://stackoverflow.com/questions/29333025/criterion-causing-memory-consumption-to-explode-no-cafs-in-sight/29336158#29336158", "title": "Criterion causing memory consumption to explode, no CAFs in sight", "body": "<p>In your version without <code>criterion</code>, the list returned by <code>lst ()</code> gets produced lazily and then incrementally garbage collected while <code>mysum</code> consumes it, since there are no other references to the list.</p>\n\n<p>For the <code>criterion</code> version, however, look at the <a href=\"http://hackage.haskell.org/package/criterion-1.1.0.0/docs/src/Criterion-Types.html#whnf\" rel=\"nofollow\">definition of <code>whnf</code></a>:</p>\n\n<pre><code>whnf :: (a -&gt; b) -&gt; a -&gt; Benchmarkable\nwhnf = pureFunc id\n{-# INLINE whnf #-}\n</code></pre>\n\n<p>and <code>pureFunc</code>:</p>\n\n<pre><code>pureFunc :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; Benchmarkable\npureFunc reduce f0 x0 = Benchmarkable $ go f0 x0\n  where go f x n\n          | n &lt;= 0    = return ()\n          | otherwise = evaluate (reduce (f x)) &gt;&gt; go f x (n-1)\n{-# INLINE pureFunc #-}\n</code></pre>\n\n<p>It seems like <code>x</code> in <code>go</code> above would eventually become bound to the list returned by your <code>lst ()</code>, while <code>n</code> is the number of iterations for the benchmarking.  When the first benchmark iteration is finished, <code>x</code> will all have been evaluated, but this time it cannot be garbage collected: It is still kept in memory because it is <em>shared</em> with the following iterations through the recursive <code>go f x (n-1)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "edited": false, "score": 0, "creation_date": 1427696668, "post_id": 29336593, "comment_id": 46866668, "body": "Thanks, I had actually tried <code>whnf (mysum .lst) ()</code> before when I was using <code>O3</code> optimization, but I found that the benchmark time was independent of <code>num</code>, so I discarded this idea. However rerunning this again with <code>O0</code> shows a clear dependence on <code>num</code>."}, {"owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "edited": false, "score": 0, "creation_date": 1427698583, "post_id": 29336593, "comment_id": 46867462, "body": "I asked the question about the behaviour with <code>O3</code> optimization at <a href=\"http://stackoverflow.com/questions/29340053/preventing-caching-of-computation-in-criterion-benchmark\" title=\"preventing caching of computation in criterion benchmark\">stackoverflow.com/questions/29340053/&hellip;</a>"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 3, "last_activity_date": 1427674783, "creation_date": 1427674783, "answer_id": 29336593, "question_id": 29333025, "link": "https://stackoverflow.com/questions/29333025/criterion-causing-memory-consumption-to-explode-no-cafs-in-sight/29336593#29336593", "title": "Criterion causing memory consumption to explode, no CAFs in sight", "body": "<p>You don't need to inspect the source of criterion to know that <code>lst ()</code> will be shared: any subexpression will be shared (and therefore computed at most once) during the evaluation of the body of the immediately surrounding lambda. Additional lambdas may be introduced by overloading, various syntactic sugar constructs, and compiler optimizations, but none of that happens here as you can see from the Core.</p>\n\n<p>If you don't want <code>lst ()</code> to be shared then you should refactor the arguments of <code>whnf</code> to something like <code>whnf (mysum . lst) ()</code>.</p>\n"}], "owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 29336158, "answer_count": 2, "score": 2, "last_activity_date": 1427674783, "creation_date": 1427653377, "last_edit_date": 1495535055, "question_id": 29333025, "link": "https://stackoverflow.com/questions/29333025/criterion-causing-memory-consumption-to-explode-no-cafs-in-sight", "title": "Criterion causing memory consumption to explode, no CAFs in sight", "body": "<p>Basically I have a simple function call, which \nwhen used in conjunction with <a href=\"http://hackage.haskell.org/package/criterion\" rel=\"nofollow noreferrer\">Criterion</a>, results in \nthe memory consumption exploding.</p>\n\n<p>Suppose I have the following program : </p>\n\n<pre><code>{-# OPTIONS_GHC -fno-cse #-}\n{-# LANGUAGE BangPatterns #-}\nmodule Main where\nimport Criterion.Main\nimport Data.List\n\nnum :: Int\nnum = 10000000\n\nlst :: a -&gt; [Int]\nlst _ = [1,2..num]\n\nmyadd :: Int -&gt; Int -&gt; Int\nmyadd !x !y = let !result = x + y in\n  result\n\nmysum = foldl' myadd 0\n\nmain :: IO ()\nmain = do\n  print $ mysum (lst ())\n</code></pre>\n\n<p>Then this program (compiled with O0) runs fine, without \nthe memory exploding.</p>\n\n<p>If we use <code>cabal build -v</code> to yield a dump of the compilation\ncommands invoked, and then tag <code>-ddump-simpl -fforce-recomp -O0 -dsuppress-all</code> (suggested in <a href=\"https://stackoverflow.com/a/24990602\">IO/Monadic assign operator causing ghci to explode for infinite list</a>) to the end of the <code>ghc --make -no-link ...</code> command, we get the following core : </p>\n\n<pre><code>num\nnum = I# 10000000\n\nlst\nlst = \\ @ a_a3Yn _ -&gt; enumFromThenTo $fEnumInt (I# 1) (I# 2) num\n\nmyadd\nmyadd =\n  \\ x_a3Cx y_a3Cy -&gt;\n    case x_a3Cx of x1_X3CC { I# ipv_s4gX -&gt;\n    case y_a3Cy of y1_X3CE { I# ipv1_s4h0 -&gt;\n    + $fNumInt x1_X3CC y1_X3CE\n    }\n    }\n\nmysum\nmysum = foldl' myadd (I# 0)\n\nmain\nmain =\n  print\n    $fShowInt (mysum (enumFromThenTo $fEnumInt (I# 1) (I# 2) num))\n\nmain\nmain = runMainIO main\n</code></pre>\n\n<p>It seems that no CAFs are being produced, which is consistent \nwith the fact that the program does not explode. Now if I \nrun the following program which uses criterion 1.1.0.0 : </p>\n\n<pre><code>{-# OPTIONS_GHC -fno-cse #-}\n{-# LANGUAGE BangPatterns #-}\nmodule Main where\nimport Criterion.Main\nimport Data.List\n\nnum :: Int\nnum = 10000000\n\nlst :: a -&gt; [Int]\nlst _ = [1,2..num]\n\nmyadd :: Int -&gt; Int -&gt; Int\nmyadd !x !y = let !result = x + y in\n  result\n\nmysum = foldl' myadd 0\n\nmain :: IO ()\nmain = defaultMain [\n  bgroup \"summation\" \n    [bench \"mysum\" $ whnf mysum (lst ())]\n  ]\n</code></pre>\n\n<p>then the memory consumption explodes. However printing \nthe core yields : </p>\n\n<pre><code>num\nnum = I# 10000000\n\nlst\nlst = \\ @ a_a3UV _ -&gt; enumFromThenTo $fEnumInt (I# 1) (I# 2) num\n\nmyadd\nmyadd =\n  \\ x_a3Cx y_a3Cy -&gt;\n    case x_a3Cx of x1_X3CC { I# ipv_s461 -&gt;\n    case y_a3Cy of y1_X3CE { I# ipv1_s464 -&gt;\n    + $fNumInt x1_X3CC y1_X3CE\n    }\n    }\n\nmysum\nmysum = foldl' myadd (I# 0)\n\nmain\nmain =\n  defaultMain\n    (: (bgroup\n      (unpackCString# \"summation\"#)\n      (: (bench\n            (unpackCString# \"mysum\"#)\n            (whnf mysum (enumFromThenTo $fEnumInt (I# 1) (I# 2) num)))\n         ([])))\n       ([]))\n\nmain\nmain = runMainIO main\n</code></pre>\n\n<p>and it seems that no CAFs are being produced. Therefore why\ndoes the latter program, which uses criterion, result in the memory consumption exploding, whereas the former program \ndoes not? I am using GHC version 7.8.3</p>\n"}, {"tags": ["haskell", "haskell-prelude"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427649641, "post_id": 29332229, "comment_id": 46853642, "body": "Hayoo will find some: <a href=\"http://hayoo.fh-wedel.de/?query=%28a+-%3E+b%29+-%3E+a+-%3E+%28a%2Cb%29\" rel=\"nofollow noreferrer\">hayoo.fh-wedel.de/?query=%28a+-%3E+b%29+-%3E+a+-%3E+%28a%2Cb&zwnj;&#8203;%29</a> but I doubt that those are more idiomatic (if you have to fetch those libs just for this) than redefining it quick and easy"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1427662409, "post_id": 29332229, "comment_id": 46858013, "body": "One of the nice things about very polymorphic functions like this in a language like Haskell is that there&#39;s basically only one way to define a function with type <code>(a -&gt; b) -&gt; a -&gt; (a, b)</code>. So in a sense you don&#39;t have to worry about reinventing wheels like this; the type system <i>forces</i> your wheel to be just as good as anyone else&#39;s! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1427650791, "post_id": 29332392, "comment_id": 46854035, "body": "I knew when I read the question that the answer would be in <code>Control.Arrow</code>, but I can never, ever remember what the different functions in there do."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1427650922, "post_id": 29332392, "comment_id": 46854085, "body": "I like this answer - although I hope I will never see something like this in <i>real</i> code ;) (to the uninitiated (noob) <i>eye</i> (like mine) <code>\\f a -&gt; (a, f a)</code> is just easier to read)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1427653721, "post_id": 29332392, "comment_id": 46855104, "body": "@dfeuer well I guess you are right - the big question is: is this a good thing? - but I guess this is not the right place for such discussions and you already got my upvote too - so have a nice day"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1427654122, "post_id": 29332392, "comment_id": 46855251, "body": "@CarstenK&#246;nig Indeed, I think I&#39;m more likely to use the plain version in real code. The step from point-free to point-less can be very short."}, {"owner": {"reputation": 821, "user_id": 4325617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sa0ex.png?s=128&g=1", "display_name": "Tom Galvin", "link": "https://stackoverflow.com/users/4325617/tom-galvin"}, "edited": false, "score": 0, "creation_date": 1427656716, "post_id": 29332392, "comment_id": 46856176, "body": "Thanks, I&#39;m relatively new to Haskell and its control structures, so I&#39;ll take a look at <code>Control.Arrow</code> now."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 821, "user_id": 4325617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sa0ex.png?s=128&g=1", "display_name": "Tom Galvin", "link": "https://stackoverflow.com/users/4325617/tom-galvin"}, "edited": false, "score": 0, "creation_date": 1427666236, "post_id": 29332392, "comment_id": 46859212, "body": "@Quackmatic If you are new, keep in mind that arrows are quite abstract. You may want to look at functors and/or monads first."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1427650233, "creation_date": 1427650233, "answer_id": 29332392, "question_id": 29332229, "link": "https://stackoverflow.com/questions/29332229/is-there-a-function-in-prelude-to-pair-a-value-with-that-value-applied-to-a-func/29332392#29332392", "title": "Is there a function in Prelude to pair a value with that value applied to a function?", "body": "<p>The section <code>(id &amp;&amp;&amp;)</code> does what you want:</p>\n\n<pre><code>&gt; import Control.Arrow\n&gt; :t (id &amp;&amp;&amp;)\n(id &amp;&amp;&amp;) :: (a -&gt; c') -&gt; a -&gt; (a, c')\n&gt; (id &amp;&amp;&amp;) succ 4\n(4,5)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 3, "creation_date": 1427651486, "post_id": 29332580, "comment_id": 46854276, "body": "Compared to the obvious definition this is ridiculously complex. :)"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1427688486, "post_id": 29332580, "comment_id": 46864518, "body": "It&#39;s simply <code>withSelf = ((,) &lt;*&gt;)</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1512975396, "post_id": 29332580, "comment_id": 82455677, "body": "<code>ap (,)</code> is shorter :)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 7, "last_activity_date": 1427689208, "last_edit_date": 1495541819, "creation_date": 1427651155, "answer_id": 29332580, "question_id": 29332229, "link": "https://stackoverflow.com/questions/29332229/is-there-a-function-in-prelude-to-pair-a-value-with-that-value-applied-to-a-func/29332580#29332580", "title": "Is there a function in Prelude to pair a value with that value applied to a function?", "body": "<p>If you don't want to use <code>Control.Arrow</code>, you can always use <code>Applicative</code>:</p>\n\n<pre><code>withSelf f = (,) &lt;$&gt; id &lt;*&gt; f\n</code></pre>\n\n<p>Many people will probably actually understand this immediately, but for something so simple it's pretty silly.</p>\n\n<h3>Edit</h3>\n\n<p>As pointed out in a <a href=\"https://stackoverflow.com/questions/29332229/is-there-a-function-in-prelude-to-pair-a-value-with-that-value-applied-to-a-func/29332580?noredirect=1#comment46864518_29332580\">comment</a>, this can be written even more briefly as</p>\n\n<pre><code>withSelf = ((,) &lt;*&gt;)\n</code></pre>\n\n<p>This astonished me at first, but it's actually very simple: for <code>(-&gt;) r</code>, <code>fmap = (.)</code>, so the <code>&lt;$&gt; id</code> is completely redundant!</p>\n"}], "owner": {"reputation": 821, "user_id": 4325617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sa0ex.png?s=128&g=1", "display_name": "Tom Galvin", "link": "https://stackoverflow.com/users/4325617/tom-galvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 29332392, "answer_count": 2, "score": 6, "last_activity_date": 1512974635, "creation_date": 1427649304, "last_edit_date": 1512974635, "question_id": 29332229, "link": "https://stackoverflow.com/questions/29332229/is-there-a-function-in-prelude-to-pair-a-value-with-that-value-applied-to-a-func", "title": "Is there a function in Prelude to pair a value with that value applied to a function?", "body": "<p>I am searching for a function which looks something similar to this:</p>\n\n<p><code>withSelf :: (a -&gt; b) -&gt; a -&gt; (a, b)\nwithSelf f x = (x, f x)\n</code></p>\n\n<p>I have searched with Hoogle for such a function; I searched for <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a+-%3E+b%29++-%3E+a+-%3E+%28a%2C+b%29\" rel=\"noreferrer\"><code>(a -&gt; b) -&gt; a -&gt; (a, b)</code></a> and <a href=\"https://www.haskell.org/hoogle/?hoogle=a+-%3E+%28a+-%3E+b%29++-%3E+%28a%2C+b%29\" rel=\"noreferrer\"><code>a -&gt; (a -&gt; b) -&gt; (a, b)</code></a>, neither of which were conclusive. The <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Tuple.html\" rel=\"noreferrer\">Hackage page on <code>Data.Tuple</code></a> doesn't have what I'm looking for either.</p>\n\n<p>I'm aware that it's trivial to write, but I want to write idiomatic Haskell where possible, and avoid re-inventing the wheel.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1427631625, "post_id": 29328891, "comment_id": 46847675, "body": "Probably you should put all of your relevant code here ? How is <code>AExp</code> and <code>evalAExp</code> defined ?"}, {"owner": {"reputation": 2725, "user_id": 2251058, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8ffc7bebb06ae9943708d99f3621c1b5?s=128&d=identicon&r=PG", "display_name": "Akshay Hazari", "link": "https://stackoverflow.com/users/2251058/akshay-hazari"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1427631880, "post_id": 29328891, "comment_id": 46847749, "body": "Sorry about that . I couldn&#39;t find a way to point to the problem I had while explaining, so I added that part. I am a bit bad at expressing myself."}], "answers": [{"comments": [{"owner": {"reputation": 2725, "user_id": 2251058, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8ffc7bebb06ae9943708d99f3621c1b5?s=128&d=identicon&r=PG", "display_name": "Akshay Hazari", "link": "https://stackoverflow.com/users/2251058/akshay-hazari"}, "edited": false, "score": 0, "creation_date": 1427632492, "post_id": 29329081, "comment_id": 46847942, "body": "Thanks for explaining out types to me so wonderfully. I will keep that in mind to embed end types everytime."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 7, "last_activity_date": 1427631989, "creation_date": 1427631989, "answer_id": 29329081, "question_id": 29328891, "link": "https://stackoverflow.com/questions/29328891/boolean-expression-evaluation-couldnt-match-expected-type/29329081#29329081", "title": "Boolean Expression evaluation . Couldn&#39;t match expected type", "body": "<p>Your suspicion, \"I think there is a problem in the data BExp declaration itself\", is correct. What you've written doesn't mean what I suspect you hope it does. The error is at the far right end (as errors often are) so I had to scroll to find it. Using more vertical space, let's see.</p>\n\n<pre><code>data BExp\n  = Eq AExp AExp\n  | Lt AExp AExp\n  | Gt AExp AExp\n  | ELt AExp AExp\n  | EGt AExp AExp\n  | And BExp BExp\n  | Or BExp BExp\n  | Bool\n</code></pre>\n\n<p>And it's the last that is the big problem. It's harder to spot because although you tell <em>us</em>, \"I want the type to be :: BExp -> Bool\", you do not tell the compiler. If you had done the decent thing and communicated your intention by writing an explicit type signature, the error report might have been more helpful. Your program begins</p>\n\n<pre><code>evalBExp True = True\n</code></pre>\n\n<p>and that is enough to convince the typechecker that the intended type is</p>\n\n<pre><code>evalBExp :: Bool -&gt; Bool\n</code></pre>\n\n<p>because <code>True :: Bool</code>. When line 3 shows up with</p>\n\n<pre><code>evalBExp (Eq a1 a2) = evalAExp (a1) == evalAExp (a2)\n</code></pre>\n\n<p>suddenly it wonders why you're giving <code>evalBExp</code> a <code>BExp</code> instead of a <code>Bool</code>.</p>\n\n<p>Now, I suspect that you have the impression that your final clause in <code>BExp</code></p>\n\n<pre><code>| Bool\n</code></pre>\n\n<p>makes <code>True :: BExp</code> and <code>False :: BExp</code>, but that's not what it does at all. Instead, you will discover that you have a nullary data constructor <code>Bool :: BExp</code> whose name is coincident with the datatype <code>Bool</code> but lives in an entirely separate namespace. I believe your intention is to embed the values of <code>Bool</code> into <code>BExp</code> silently, but Haskell does not allow such subtle subtyping. To achieve the intended effect, you will need a constructor which explicitly packs up a <code>Bool</code>, so try</p>\n\n<pre><code>data BExp\n  = ...\n  | BVal Bool\n</code></pre>\n\n<p>and</p>\n\n<pre><code>evalBExp :: BExp -&gt; Bool\nevalBExp (BVal b) = b\n...\n</code></pre>\n\n<p>to get closer to your plan.</p>\n\n<p>You are, of course, free to use the name <code>Bool</code> for the <code>BVal</code> constructor, and so write</p>\n\n<pre><code>data BExp\n  = ...\n  | Bool Bool\n</code></pre>\n\n<p>where the first <code>Bool</code> is a data constructor and the second is a type constructor, but I would find that choice confusing.</p>\n"}], "owner": {"reputation": 2725, "user_id": 2251058, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8ffc7bebb06ae9943708d99f3621c1b5?s=128&d=identicon&r=PG", "display_name": "Akshay Hazari", "link": "https://stackoverflow.com/users/2251058/akshay-hazari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 29329081, "answer_count": 1, "score": 0, "last_activity_date": 1427631989, "creation_date": 1427630808, "last_edit_date": 1427631651, "question_id": 29328891, "link": "https://stackoverflow.com/questions/29328891/boolean-expression-evaluation-couldnt-match-expected-type", "title": "Boolean Expression evaluation . Couldn&#39;t match expected type", "body": "<p>I am trying to write an evaluator for a Boolean expression . Here type of evalAExp :: AExp-> Maybe Int (i.e. Arithmetic expression evaluator). Arithmetic evaluator is working for me. </p>\n\n<p>In Boolean Evaluator I want the type to be :: BExp -> Bool. \nWhile compiling I get an error like <code>Couldn't match expected type ``Bool' with actual type ``BExp'\n    In the pattern: Eq a1 a2\n    In an equation for ``evalBExp':\n        evalBExp (Eq a1 a2) = evalAExp (a1) == evalAExp (a2)</code></p>\n\n<p>The end types of a BExp should be Bool.</p>\n\n<p>How should I be declaring my BExp in this case. Is there a better way of going about it. </p>\n\n<pre><code>data BExp = Eq AExp AExp | Lt AExp AExp | Gt AExp AExp | ELt AExp AExp| EGt AExp AExp | And BExp BExp | Or BExp BExp | Bool\n\nevalBExp True = True\nevalBExp False = False\nevalBExp (Eq a1 a2) = evalAExp (a1) == evalAExp (a2)\n</code></pre>\n\n<p>Here in <code>evalBExp (Eq a1 a2) = evalAExp (a1) == evalAExp (a2)</code> I am comparing Just Int == Just Int and the resultant is a Bool. What should I be doing? I think there is a problem in the data BExp declaration itself for me.</p>\n\n<p>Any Help</p>\n\n<p><strong>EDIT :</strong></p>\n\n<p>I changed my code to something like this. </p>\n\n<pre><code>data BExp = Eq AExp AExp | Lt AExp AExp | Gt AExp AExp | ELt AExp AExp| EGt AExp AExp | And BExp BExp | Or BExp BExp |Boolean Bool\n\nevalBExp (Boolean True) = True\nevalBExp (Boolean False) = False\nevalBExp (Eq a1 a2) = (evalAExp (a1)) == (evalAExp (a2))\n</code></pre>\n\n<p>So I changed the type to Boolean Bool. Is this a better way of declaring a type . Why not simply Bool as earlier. Is there a better way to do this.</p>\n\n<p><strong>Entire Code</strong> </p>\n\n<pre><code>import qualified Data.Map as M\nimport Data.List\ndata AExp = Var Char | Value Int | Add AExp AExp | Mul AExp AExp | Sub AExp AExp\ndata BExp = Eq AExp AExp | Lt AExp AExp | Gt AExp AExp | ELt AExp AExp| EGt AExp AExp | And BExp BExp | Or BExp BExp |Boolean Bool\ndata AssignExp = AExp Char |  BExp Char\ndata Statement = AssignExp | While BExp Statement\ntype Env   = M.Map Char Int\n\nenv = M.fromList[('A',1),('B',2),('C',3)]\n\nevalAExp :: AExp -&gt; Maybe Int\nevalAExp (Value x) = (Just x)\nevalAExp (Var x) = M.lookup x env\nevalAExp (Add a1 a2) =do\n  v2&lt;-evalAExp a2;v1&lt;-evalAExp a1\n  return (v1+v2)\nevalAExp (Sub a1 a2) =do\n  v2&lt;-evalAExp a2;v1&lt;-evalAExp a1\n  return (v1-v2)\nevalAExp (Mul a1 a2) = do\n  v1 &lt;-evalAExp a1;v2 &lt;- evalAExp a2\n  return (v1*v2)\n\nevalBExp (Boolean True) = True\nevalBExp (Boolean False) = False\nevalBExp (Eq a1 a2) = (evalAExp (a1)) == (evalAExp (a2))\n</code></pre>\n"}, {"tags": ["unit-testing", "haskell", "cabal", "hunit"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1427644999, "post_id": 29328774, "comment_id": 46851946, "body": "How are you running <code>ghci</code>? Did you pass it the <a href=\"http://stackoverflow.com/a/24840899/414413\"><code>-package-db</code> flag</a> to tell <code>ghci</code> where to find the sandbox installed packages?"}, {"owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427651914, "post_id": 29328774, "comment_id": 46854432, "body": "No this was the problem ... i wasn&#39;t aware that ghci is not aware of sandboxes by default."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457852311, "creation_date": 1457852311, "answer_id": 35967495, "question_id": 29328774, "link": "https://stackoverflow.com/questions/29328774/problems-with-test-framework-and-hunit/35967495#35967495", "title": "Problems with Test-Framework and HUnit", "body": "<p>Sandboxed packages are visible to <code>cabal</code> but not to <code>ghc</code> or <code>ghci</code> without additional flags. But you can alter your environment in general for a process by executing it with <code>cabal exec myCmd</code> -- and even better, for <code>ghci</code> in particular, <code>cabal repl</code> is a more full-featured solution that opens \"stuff you want\" in a variety of situations, both with and without sandboxes.</p>\n"}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1457852311, "creation_date": 1427630036, "question_id": 29328774, "link": "https://stackoverflow.com/questions/29328774/problems-with-test-framework-and-hunit", "title": "Problems with Test-Framework and HUnit", "body": "<p>I have problems setting up unit-tests with Test-Framework and HUnit.<br>\nI have the following imports in my testfile:</p>\n\n<pre><code>import Test.Framework\nimport Test.Framework.Providers.QuickCheck2\nimport Test.Framework.Providers.HUnit\n</code></pre>\n\n<p>When I try to load the file in <code>ghci</code> I get the error-message:</p>\n\n<pre><code>test/MainTestSuite.hs:3:8:\n    Could not find module \u2018Test.Framework.Providers.HUnit\u2019\n    Perhaps you meant\n      Test.Framework.Providers.API (from test-framework-0.8.1.1)\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Only loading <code>Test.Framework</code> and <code>Test.Framework.Providers.QuickCheck2</code> works and can run the tests. According to <code>cabal</code> <code>test-framework-hunit</code>\nis installed:</p>\n\n<pre><code>$ cabal install test-framework-hunit\nResolving dependencies...\nAll the requested packages are already installed:\ntest-framework-hunit-0.3.0.1\nUse --reinstall if you want to reinstall anyway.\nNotice: installing into a sandbox located at\n/home/XXX/projects/my_project/.cabal-sandbox\n</code></pre>\n\n<p>Also <code>test-framework-hunit</code> is listed as a dependency in the <code>my_project.cabal</code>-file:  </p>\n\n<pre><code>test-suite tests\n    main-is:           \n        MainTestSuite.hs\n    type:              \n    exitcode-stdio-1.0\n    hs-source-dirs:    \n        test, \n        src\n    build-depends:     \n        base,\n        HUnit,\n        QuickCheck,\n        test-framework,\n        test-framework-hunit,\n        test-framework-quickcheck2,\n        containers &gt;=0.5 &amp;&amp; &lt;0.6\n    default-language:\n        Haskell2010\n</code></pre>\n\n<p>What am I doing wrong? If that matters: I'm installing everything into a <code>cabal-sandbox</code>.</p>\n"}, {"tags": ["haskell", "freeglut"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 4, "creation_date": 1427626456, "post_id": 29326429, "comment_id": 46846273, "body": "Can you edit your question to add a minimal full example?"}], "owner": {"reputation": 219, "user_id": 314239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/382877ee4bad4640c6be37d92ca5e8ab?s=128&d=identicon&r=PG", "display_name": "BT.", "link": "https://stackoverflow.com/users/314239/bt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1427640625, "creation_date": 1427611624, "last_edit_date": 1427640625, "question_id": 29326429, "link": "https://stackoverflow.com/questions/29326429/haskell-glut-deallocation-freezing-my-thread", "title": "Haskell Glut: Deallocation Freezing my thread", "body": "<p>I have a forkOS thread which is the only thread talking to freeGlut.  Everything goes fine.  The thread polls for thunks to compute, and does them just happily.  But when I go to kill it with an exit statement it freezes and leaves child windows dangling on my desktop (note: that this is in the threads code; where I'm trying to deallocate glut cleanly; not a thunk it's taking in).  Has anybody ran into this issue, or knows what would cause it?</p>\n\n<pre><code>g i o = do\n        m &lt;- tryReadSig i\n        case m of\n            Just (GlutKill)     -&gt; do\n                                   putStrLn \"exiting\"\n                                   Glut.exit\n                                   putStrLn \"exited\"\n                                   writeSigF o ()\n</code></pre>\n\n<p>This is really what it all boils down to.  The console puts out exiting then hangs.  </p>\n"}, {"tags": ["haskell", "io", "return", "variable-assignment"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1427597156, "post_id": 29324923, "comment_id": 46840936, "body": "What do you mean by &quot;supressed&quot; ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1427618745, "post_id": 29324923, "comment_id": 46844459, "body": "The closest you can get to this is to discriminate on the return type so that when returning <code>IO ()</code> you do something and when returning <code>IO TypeOfd</code> you do something else. This however would require a type class and even then may require some type annotation in the caller code. So, why don&#39;t you just define two different functions?"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1427626389, "post_id": 29324923, "comment_id": 46846261, "body": "Perhaps describe in more detail what you&#39;re trying to achieve from a higher-level perspective. What you&#39;re asking for isn&#39;t possible in Haskell for good reasons, but there could be other, better ways."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1427660604, "post_id": 29324923, "comment_id": 46857430, "body": "I don&#39;t think what you are asking for is possible in any other language either, it&#39;s just really bizarre, if I&#39;m understanding it correctly..."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1427667812, "post_id": 29324923, "comment_id": 46859646, "body": "Yeah, I didn&#39;t think it was, but there&#39;ve been a few things that have surprised me about Haskell&#39;s capabilities.  Essentially, what I wanted was an if statement to determine whether I call a function, based on how the original function is called, if that makes sense?"}], "answers": [{"comments": [{"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1427668353, "post_id": 29325343, "comment_id": 46859767, "body": "Ah, I&#39;ve never tried binding a function that returns an IO using a let before. I&#39;m not sure I could use it, though. Since the result is the final state of something. If I pass <code>d</code> to it, it&#39;d be an IO of the object, and then I&#39;d need to bound it using a <code>&lt;-</code> in the function anyway, meaning it&#39;d recalculate the state every time it&#39;s called which is what I wanted to avoid in the first place. That&#39;s fine, I&#39;ll just have a bool argument or a separate function instead. Thanks!"}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 4, "last_activity_date": 1427602166, "last_edit_date": 1427602166, "creation_date": 1427600023, "answer_id": 29325343, "question_id": 29324923, "link": "https://stackoverflow.com/questions/29324923/boolean-check-in-haskell-when-assigning-io-action-to-variable/29325343#29325343", "title": "Boolean check in Haskell when assigning IO action to variable", "body": "<p>What you are asking for is impossible in Haskell.  One of the fundamental rules behind Haskell's design is <a href=\"http://en.wikipedia.org/wiki/Principle_of_compositionality\" rel=\"nofollow\"><strong>compositionality</strong></a>: the meaning of an expression depends exclusively on the meaning of its subexpressions and how they are combined.  The <strong>only</strong> exception is that the meaning of a variable depends on context.  </p>\n\n<p>What you're asking for, fundamentally, is to have <code>renderDrawable drawable</code> mean two different things depending on the context in which it appears in the program (in this case, depending on whether it's result is bound as a variable or not).  No can do.</p>\n\n<p>Compositionality is intimately related with the principles of <strong>referential transparency</strong> and <strong>purity</strong> that Haskell's design also follows.  It's not just Haskell's design that values compositionality, too, because generally most programming languages obey it in most situations.  It's hard to reason about code otherwise.</p>\n\n<p>The closest I can think of to what you're looking for is the contrast between this:</p>\n\n<pre><code>do {- ... -} \n   renderDrawable drawable\n   {- ... -}\n</code></pre>\n\n<p>And this:</p>\n\n<pre><code>do {- ... -} \n   let d = renderDrawable drawable\n   {- ... -}\n</code></pre>\n\n<p>If you're not familiar with this form of <code>let</code>, that's the way you assign a <em>pure value</em> to a variable inside of <code>do</code>-notation.  What you're doing here is you're taking <code>renderDrawable drawable</code>, and binding the <strong>action itself</strong> (not its result!) to the variable <code>d</code>.  This is just a variable assignment, so <code>renderDrawable drawable</code> is not executed.</p>\n"}, {"tags": [], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "is_accepted": false, "score": 0, "last_activity_date": 1429208839, "creation_date": 1429208839, "answer_id": 29683087, "question_id": 29324923, "link": "https://stackoverflow.com/questions/29324923/boolean-check-in-haskell-when-assigning-io-action-to-variable/29683087#29683087", "title": "Boolean check in Haskell when assigning IO action to variable", "body": "<p>Although this answer probably isn't as good as above, since like they said, it's impossible, I've found another approach.</p>\n\n<p><code>drawDrawable</code> is a recursive function. <code>Drawable</code> is my data type, and so I added another node for <code>Drawable</code>. It took another <code>Drawable</code> as an argument, and also the current state which traverses down and simply sets a flag to true if I want it to render. So I'd have something like </p>\n\n<pre><code>drawDrawable Direct drawable\n</code></pre>\n\n<p>This seems like it could be a source for bugs, though. So I opted for separate functions: <code>compile</code> and <code>render</code>, where <code>render</code> returns an <code>IO ()</code> instead of <code>IO Drawable</code> as simply works like</p>\n\n<pre><code>render :: Drawable -&gt; IO ()\nrender drawable = do\n  cd &lt;- compile drawable\n  renderCompiled cd\n</code></pre>\n\n<p>Does the job and there's less ambiguity for the whole situation. </p>\n"}], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429208839, "creation_date": 1427595488, "question_id": 29324923, "link": "https://stackoverflow.com/questions/29324923/boolean-check-in-haskell-when-assigning-io-action-to-variable", "title": "Boolean check in Haskell when assigning IO action to variable", "body": "<p>I'm not sure if this is possible, but I'd like to be able to perform an IO action that returns a value, and if it gets assigned to a variable, then it suppresses a particular IO action (Or when, any action, I guess, it doesn't have to be an IO one).  </p>\n\n<p>Here's the specific issue I'm having:</p>\n\n<p>When I do:</p>\n\n<pre><code>renderDrawable drawable\n</code></pre>\n\n<p>I want it to call a particular function (<code>drawArrays</code>).</p>\n\n<p>When assigning to a variable, like:</p>\n\n<pre><code>d &lt;- renderDrawable drawable\n</code></pre>\n\n<p>I want that particular function suppressed. </p>\n\n<p>Now, this seems like a long shot, but is it possible? Something similar to mapM_/foldM_ would be ideal, I guess. </p>\n\n<p>Thanks! </p>\n"}, {"tags": ["haskell", "mpi", "ghc", "ffi", "petsc"], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 229255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588fe10267b620e1c0d0d188a8db2621?s=128&d=identicon&r=PG", "display_name": "Ian Ross", "link": "https://stackoverflow.com/users/229255/ian-ross"}, "reply_to_user": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 1, "creation_date": 1427658453, "post_id": 29332030, "comment_id": 46856776, "body": "Sorry - should have mentioned that you need a recent C2HS: version 0.25.1 or GitHub HEAD.  The typedef and default stuff is quite new."}], "tags": [], "owner": {"reputation": 965, "user_id": 229255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588fe10267b620e1c0d0d188a8db2621?s=128&d=identicon&r=PG", "display_name": "Ian Ross", "link": "https://stackoverflow.com/users/229255/ian-ross"}, "is_accepted": true, "score": 2, "last_activity_date": 1427649248, "last_edit_date": 1427649248, "creation_date": 1427648202, "answer_id": 29332030, "question_id": 29324155, "link": "https://stackoverflow.com/questions/29324155/library-design-of-petsc-ffi-in-haskell/29332030#29332030", "title": "library design of PETSc FFI in Haskell", "body": "<p>Ambitious!  I'd be tempted to use C2HS instead of hsc2hs, since it can produce some of the boilerplate for foreign imports for you.  (I'm the maintainer of C2HS, so you can take whatever I say with a grain of salt!)</p>\n\n<p>As an example, you can bind <code>PetscInitialize</code> and <code>PetscFinalize</code> like this:</p>\n\n<pre><code>-- This is in PETSc.chs\nmodule PETSc (initialize, finalize) where\n\nimport Foreign\nimport Foreign.Ptr\nimport Foreign.C.Types\nimport Foreign.C.String\nimport System.Environment (getArgs)\n\n#include &lt;petscksp.h&gt;\n#include &lt;petscsys.h&gt;\n\n-- Marshalling helpers for PETSc error codes.\n\nnewtype ErrCode = ErrCode { unErrCode :: Int }\n                deriving (Eq, Show)\n\nconvErrCode :: CInt -&gt; ErrCode\nconvErrCode = ErrCode . fromIntegral\n\n{#typedef PetscErrorCode CInt#}\n{#default out `ErrCode' [PetscErrorCode] convErrCode#}\n\n\n-- Marshalling helpers for \"char ***\" argument to PetscInitialize.\n\nwithCStrings :: [String] -&gt; ([CString] -&gt; IO a) -&gt; IO a\nwithCStrings ss f = case ss of\n  [] -&gt; f []\n  (s:ss') -&gt; withCString s $ \\cs -&gt; do\n    withCStrings ss' $ \\css -&gt; f (cs:css)\n\nwithCStringArray :: [String] -&gt; (Ptr CString -&gt; IO a) -&gt; IO a\nwithCStringArray ss f = withCStrings ss $ \\css -&gt; withArray css f\n\nwithCStringArrayPtr :: [String] -&gt; (Ptr (Ptr CString) -&gt; IO a) -&gt; IO a\nwithCStringArrayPtr ss f = withCStringArray ss $ \\css -&gt; with css f\n\n\n-- Low-level function hooks.\n\n{#fun PetscInitialize as internal_initialize\n    {`Int', withCStringArrayPtr* `[String]', `String', `String'}\n    -&gt; `ErrCode'#}\n{#fun PetscFinalize as finalize {} -&gt; `ErrCode'#}\n\n\n-- Better API for initialization.\n\ninitialize :: String -&gt; String -&gt; IO ErrCode\ninitialize file help = do\n  args &lt;- getArgs\n  internal_initialize (length args) args file help\n</code></pre>\n\n<p>This is actually a pretty tough example to do with C2HS because managing the marshalling of the <code>char ***</code> argument to <code>PetscInitialize</code> is a bit awkward, but you get the idea.  Most other marshalling cases should be much more straightforward -- dealing with pointers and arrays is pretty easy, as is marshalling C strings.  (I'm happy to help with C2HS questions if you decide to use it.)</p>\n\n<p>Once you have this, you can call it like this:</p>\n\n<pre><code>-- This is Tst.hs or something...\nmodule Main where\n\nimport PETSc\n\nmain :: IO ()\nmain = do\n  res1 &lt;- initialize \"\" \"\"\n  print res1\n  res2 &lt;- finalize\n  print res2\n</code></pre>\n\n<p>Not very useful yet, but it's a start!  Compile it like this:</p>\n\n<pre><code>c2hs -C -I/opt/petsc/arch-linux2-cxx-opt/include PETSc.chs\nghc --make Tst.hs PETSc.hs -L/opt/petsc/arch-linux2-cxx-opt/lib/ -lpetsc\n</code></pre>\n\n<p>(adjusting paths as necessary, obvs).</p>\n\n<p>To answer your other questions:</p>\n\n<ul>\n<li><p>Don't use <code>unsafePerformIO</code> unless you're really sure that the functions you're calling are \"effectively pure\" -- <code>PetscInitialize</code> certainly doesn't fulfil that condition.  You could write a <code>PETSc</code> monad as a sort of restricted wrapper around <code>IO</code> if you don't want to have everything in the <code>IO</code> monad directly, but most of what you're doing PETSc-wise really will be in the <code>IO</code> monad, since you're going to be setting bits of internal PETSc state by calling API functions, and you need to capture that effectfulness in the types of your Haskell functions.</p></li>\n<li><p>Running GHC-produced binaries with <code>mpirun</code> shouldn't be a problem.</p></li>\n</ul>\n\n<p>I'd also not be writing makefiles.  You should be able to do this all with Cabal without too much trouble!</p>\n"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 29332030, "answer_count": 1, "score": 4, "last_activity_date": 1427965548, "creation_date": 1427587973, "last_edit_date": 1427965548, "question_id": 29324155, "link": "https://stackoverflow.com/questions/29324155/library-design-of-petsc-ffi-in-haskell", "title": "library design of PETSc FFI in Haskell", "body": "<p>I would like to make (a subset of) the <a href=\"http://www.mcs.anl.gov/petsc/\" rel=\"nofollow\">PETSc</a> library available from Haskell via a FFI interface in order to hide the memory and error management from the user;   </p>\n\n<ul>\n<li>built PETSc 3.5.3 with shared libraries with the command shown below, the test suite runs successfully</li>\n<li>prepared a .hsc file #2 with the header imports, types and two example foreign function interfaces</li>\n<li>prepared a Makefile #3 to automate the build; <code>make test1</code> passes and fires up GHCi with the loaded module.</li>\n</ul>\n\n<p>Since the library shines on parallel operations, enabled by MPI and fully distributed data structures, one should not expect much traffic of data with Haskell during most operations (all data assembly, computation and deallocation should be done by the library primitives) but only at \"data ready\". The PETSc-related Haskell functions will mostly have values in the IO monad, since we cannot guarantee purity (e.g. returned C error codes can vary due to reasons external to the program)</p>\n\n<ul>\n<li><del><code>unsafePerformIO</code> would be needed to wrap the memory <code>alloca</code>tion and the error management. Is this line of thought correct?</del> Bad idea</li>\n<li><del>Can a binary compiled with GHC be executed with <code>mpirun</code>? </del> Yes</li>\n</ul>\n\n<p>I am open to all suggestions and remarks. Thank you in advance</p>\n\n<p>-- NOTES:\nWe want GHC to produce a binary that <code>mpirun</code> can execute: Since one can pass options from the GHC command line to the linker with the <code>-optl</code> flag (reference <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/flag-reference.html\" rel=\"nofollow\">here</a>), I've been suggested a combination such as <code>ghc -optl-static -lmpich</code>. I'll add more about this as soon as I can try it out.</p>\n\n<p>1) config command:</p>\n\n<pre><code>$ ./configure --with-cc=gcc --with-cxx=g++ --with-fc=gfortran --with-shared-libraries=1 --download-mpich --download-fblaslapack\n</code></pre>\n\n<p>2) PETSC.hsc</p>\n\n<pre><code>{-# LANGUAGE CPP, ForeignFunctionInterface, EmptyDataDecls #-}\nmodule PETSc where\n\nimport Foreign\nimport Foreign.Ptr\nimport Foreign.C.Types\nimport Foreign.C.String\n\n#include &lt;petscksp.h&gt;\n#include &lt;petscsys.h&gt;\n\nnewtype PetscErrCode = PetscErrCode {unPetscErrCode :: CInt} deriving (Eq, Show)\nnewtype PetscInt = PetscInt {unPetscInt :: CInt} deriving (Eq, Show)\n\ndata Petsc\n-- PetscErrorCode PetscInitialize(int *argc,char ***args,const char file[],const char help[])\nforeign import ccall unsafe \"petscsys.h PetscInitialize\"\n  c_petscInitialize :: Ptr CInt -&gt; Ptr (Ptr CString) -&gt; CString -&gt; CString -&gt; IO PetscErrCode\n\n-- PetscErrorCode PetscFinalize(void)\nforeign import ccall unsafe \"petscsys.h PetscFinalize\"\n  c_petscFinalize :: IO PetscErrCode\n</code></pre>\n\n<p>3) Makefile</p>\n\n<pre><code>PETSC_DIR_ARCH = ${PETSC_DIR}/arch-darwin-c-debug\n\nPETSc.hs: \n    hsc2hs PETSc.hsc -I ${PETSC_DIR}/include -I ${PETSC_DIR_ARCH}/include\n\ntest1: PETSc.hs \n    ghci -dynamic PETSc.hs -L${PETSC_DIR_ARCH}/lib\n</code></pre>\n"}, {"tags": ["haskell", "graphics", "haskell-diagrams"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1427580810, "post_id": 29323132, "comment_id": 46837317, "body": "But a <code>bezier4</code> curve isn&#39;t a translated <code>bezier3</code> curve as far as I know..."}, {"owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1427580922, "post_id": 29323132, "comment_id": 46837345, "body": "oh, so that&#39;s not a good name. the bezier3 function always starts with the origin, i just meant to make a function that can start from an arbitrary point."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1427580980, "post_id": 29323132, "comment_id": 46837362, "body": "It is a good name: as you can see on the <a href=\"http://en.wikipedia.org/wiki/B%C3%A9zier_curve\" rel=\"nofollow noreferrer\">wiki page</a>, you can define a Bezier curve for an arbitrary number of points."}, {"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1427631062, "post_id": 29323132, "comment_id": 46847527, "body": "The 3 in <code>bezier3</code> is not the number of argument but the degree of the curve (its a cubic) so the 4 in your function should indicate your bezier curve is of the fourth degree (need 5 points or 4 vectors). Note that bezier3 doesn&#39;t &quot;always start at the origin&quot;, it&#39;s just that it is a Segment and as such has no location (it&#39;s a bit like a vector in that). Segments are useful in a list to create complex curves you then localize with <code>at</code> their start point. You can then use <code>fromLocSegments</code> to get a Diagram."}], "answers": [{"tags": [], "owner": {"reputation": 4230, "user_id": 4592, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5d8d81116011a01424b4dbe952846c25?s=128&d=identicon&r=PG", "display_name": "fryguybob", "link": "https://stackoverflow.com/users/4592/fryguybob"}, "is_accepted": true, "score": 4, "last_activity_date": 1427589772, "creation_date": 1427589772, "answer_id": 29324368, "question_id": 29323132, "link": "https://stackoverflow.com/questions/29323132/a-bezier-function-that-takes-4-args-in-haskell/29324368#29324368", "title": "a bezier function that takes 4 args in haskell", "body": "<p>First lets address the name.  Typically <code>bezier4</code> would be the name for a function giving a quartic bezier curve segment.  A better name would be <code>fixedBezier3</code>, and a better form would be to take <code>Points</code> rather then vectors for the arguments.  Indeed this function exists as <code>FCubic</code> from the <code>FixedSegment</code> data type.</p>\n\n<p>If we look at the type of <code>bezier4</code> we can see where things go wrong:</p>\n\n<pre><code>bezier4 x1 c1 c2 x2 = bezier3 (c1 ^-^ x1) (c2 ^-^ x1) (x2 ^-^ x1) # translate x1\n\nghci&gt; :t bezier4\nbezier4'\n  :: (Data.Basis.HasBasis v,\n      Data.MemoTrie.HasTrie (Data.Basis.Basis v)) =&gt;\n     v -&gt; v -&gt; v -&gt; v -&gt; Segment Closed v\n</code></pre>\n\n<p>The important part is that the result is a <code>Segment Closed v</code>.  Reading the <a href=\"http://hackage.haskell.org/package/diagrams-lib-1.2.0.8/docs/Diagrams-Segment.html\" rel=\"nofollow\">documentation</a> for <code>Segment</code>:</p>\n\n<blockquote>\n  <p>Segments are <em>translationally invariant</em>, that is, they have no particular \n  \"location\" and are unaffected by translations. They are, however, affected by \n  other transformations such as rotations and scales.</p>\n</blockquote>\n\n<p>The translation at the end of <code>bezier4</code> will not have any effect as the type <code>Segment</code> cannot express values that have a location, it just expresses the \"shape\" and displacement.  We can see this in GHCi:</p>\n\n<pre><code>ghci&gt; bezier4 x1 c1 c2 x2\nCubic (0.7 ^&amp; 1.5) (2.7 ^&amp; (-0.5)) (OffsetClosed (2.7 ^&amp; (-1.5)))\nghci&gt; bezier4' x1 c1 c2 x2 # translate (r2 (1000,1000))\nCubic (0.7 ^&amp; 1.5) (2.7 ^&amp; (-0.5)) (OffsetClosed (2.7 ^&amp; (-1.5)))\n</code></pre>\n\n<p>One fix would be to make the type of <code>bezier4</code> result in a <code>Located (Segment Closed v)</code>.  With this type we can at least express the curve wanted:</p>\n\n<pre><code>bezier4' x1 c1 c2 x2 = bezier3 (c1 ^-^ x1) (c2 ^-^ x1) (x2 ^-^ x1) `at` (0 .+^ x1)\n\nghci&gt; bezier4' x1 c1 c2 x2\nLoc { loc = P (0.3 ^&amp; 0.5)\n    , unLoc = Cubic (0.7 ^&amp; 1.5) (2.7 ^&amp; (-0.5)) (OffsetClosed (2.7 ^&amp; (-1.5)))\n    }\n</code></pre>\n\n<p>Notice we get the same segment as before, but now we have a location.</p>\n\n<pre><code>ghci&gt; bezier4' x1 c1 c2 x2 # translate (r2 (1000,1000))\nLoc { loc = P (1000.3 ^&amp; 1000.5)\n    , unLoc = Cubic (0.7 ^&amp; 1.5) (2.7 ^&amp; (-0.5)) (OffsetClosed (2.7 ^&amp; (-1.5)))\n    }\n</code></pre>\n\n<p>We are a bit stuck at this point though.  Located segments are not particularly interesting as typically we want to string together many segments as a <code>Trail</code>.  A located <em>list</em> of segments gets us there and we can use <code>fromLocSegments</code>:</p>\n\n<pre><code>fromLocSegments :: TrailLike t =&gt; Located [Segment Closed (V t)] -&gt; t\n</code></pre>\n\n<p>Now we have something that will work (with an additional change at the use site of <code>bezier4</code>):</p>\n\n<pre><code>bezier4 x1 c1 c2 x2 = fromSegments [bezier3 (c1 ^-^ x1) (c2 ^-^ x1) (x2 ^-^ x1)]\n                    # translate x1\n</code></pre>\n\n<p>Note that we cannot string together the output of this function with other segments to make longer trails.  Diagrams chooses to use strong types with <code>Segment</code>, <code>Trail</code>, <code>Located</code>, and <code>Path</code> only allow values that precisely match what is expressed in output (the \"meaning\").  For instance, say we want to write\n<code>fromFixedSegments</code>:</p>\n\n<pre><code>fromFixedSegments :: TrailLike t =&gt; [FizedSegment (V t)] -&gt; t\n</code></pre>\n\n<p>Each cubic segment would have four points, but the result is going to be a trail having the meaning of \"no gaps\".  To do this we will have to throw away the information of the first or last points of adjacent segments.  There is no good choice here!</p>\n"}], "owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 29324368, "answer_count": 1, "score": 2, "last_activity_date": 1427589772, "creation_date": 1427580089, "question_id": 29323132, "link": "https://stackoverflow.com/questions/29323132/a-bezier-function-that-takes-4-args-in-haskell", "title": "a bezier function that takes 4 args in haskell", "body": "<p>I am trying to make a bezier function that takes 4 args:</p>\n\n<pre><code>&gt; import Diagrams.Backend.SVG.CmdLine\n&gt; import Diagrams.Prelude\n&gt; import Control.Applicative\n\n&gt; bezier4 x1 c1 c2 x2 = bezier3 (c1 ^-^ x1) (c2 ^-^ x1) (x2 ^-^ x1) # translate x1\n&gt; lineBtwPoints p1 p2 = fromOffsets [p2 ^-^ p1] # translate p1\n&gt; illustrateB\u00e9zier x1 c1 c2 x2\n&gt;     =  endpt  # translate x1\n&gt;     &lt;&gt; endpt  # translate x2\n&gt;     &lt;&gt; ctrlpt # translate c1\n&gt;     &lt;&gt; ctrlpt # translate c2\n&gt;     &lt;&gt; l1\n&gt;     &lt;&gt; l2\n&gt;     &lt;&gt; fromSegments [bezier4 x1 c1 c2 x2]\n&gt;   where\n&gt;     dashed  = dashingN [0.03,0.03] 0\n&gt;     endpt   = circle 0.05 # fc red  # lw none\n&gt;     ctrlpt  = circle 0.05 # fc blue # lw none\n&gt;     l1      = lineBtwPoints x1 c1 # dashed\n&gt;     l2      =  lineBtwPoints x2 c2 # dashed\n&gt;\n&gt; x1      = r2 (0.3, 0.5) :: R2\n&gt; x2      = r2 (3,-1) :: R2         -- endpoint\n&gt; [c1,c2] = map r2 [(1,2), (3,0)]   -- control points\n&gt; example = illustrateB\u00e9zier x1 c1 c2 x2\n</code></pre>\n\n<p>But the result seems not to be what I wanted:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Vizae.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["list", "haskell", "split", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 2820780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d25db9ca18246b44c8327995f7f36f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Adam R.", "link": "https://stackoverflow.com/users/2820780/adam-r"}, "edited": false, "score": 0, "creation_date": 1427579490, "post_id": 29323007, "comment_id": 46836978, "body": "Well, I really should have caught that. Thanks!"}, {"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "edited": false, "score": 2, "creation_date": 1427580330, "post_id": 29323007, "comment_id": 46837187, "body": "<code>groupBy (\\x y -&gt; fst x == fst y)</code> can be replaced by <code>groupBy ((==) `on` fst)</code> after importing <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Function.html#v:on\" rel=\"nofollow noreferrer\"><code>Data.Function.on</code></a>."}, {"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 2, "creation_date": 1427580392, "post_id": 29323007, "comment_id": 46837202, "body": "Note that the predicate can be written <code>(==) `on` fst</code> with Data.Function. on."}, {"owner": {"reputation": 40039, "user_id": 699224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4feb08afcd7c57acb72bd49fc2bf834d?s=128&d=identicon&r=PG", "display_name": "DNA", "link": "https://stackoverflow.com/users/699224/dna"}, "edited": false, "score": 0, "creation_date": 1427582035, "post_id": 29323007, "comment_id": 46837580, "body": "Thanks; I had a feeling it could probably be written more concisely - will update my answer ;-)"}], "tags": [], "owner": {"reputation": 40039, "user_id": 699224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4feb08afcd7c57acb72bd49fc2bf834d?s=128&d=identicon&r=PG", "display_name": "DNA", "link": "https://stackoverflow.com/users/699224/dna"}, "is_accepted": true, "score": 5, "last_activity_date": 1427582300, "last_edit_date": 1427582300, "creation_date": 1427579259, "answer_id": 29323007, "question_id": 29322933, "link": "https://stackoverflow.com/questions/29322933/haskell-split-tuple-array-where-first-elements-are-the-same/29323007#29323007", "title": "Haskell split tuple array where first elements are the same", "body": "<p>I think you can just use <code>groupBy</code>:</p>\n\n<pre><code>&gt; import Data.List\n&gt; import Data.Function\n\n&gt; let xs = [([], \"str1\"), ([], \"str2\"), ([1], \"ser1\")]\n\n&gt; groupBy ((==) `on` fst) xs\n\n[[([],\"str1\"),([],\"str2\")], [([1],\"ser1\")]]\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2820780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d25db9ca18246b44c8327995f7f36f0e?s=128&d=identicon&r=PG&f=1", "display_name": "Adam R.", "link": "https://stackoverflow.com/users/2820780/adam-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 29323007, "answer_count": 1, "score": 0, "last_activity_date": 1427582300, "creation_date": 1427578776, "last_edit_date": 1427579022, "question_id": 29322933, "link": "https://stackoverflow.com/questions/29322933/haskell-split-tuple-array-where-first-elements-are-the-same", "title": "Haskell split tuple array where first elements are the same", "body": "<p>I have a list in Haskell of a form similar to</p>\n\n<pre><code>[([], \"str1\"), ([], \"str2\"), ([1], \"ser1\")]\n</code></pre>\n\n<p>and I want to split this into separate lists of 2-tuples, where the first elements of each tuple are the same, like so</p>\n\n<pre><code>[([], \"str1\"), ([], \"str2\")]\n[([1], \"ser1\")]\n</code></pre>\n\n<p>I''ve been eyeing <code>Data.List.Split</code>'s <code>splitWhen</code> function, but I've been having trouble getting <code>ghc</code> to accept a predicate for it, since I gather it really wasn't meant to do that.</p>\n"}, {"tags": ["haskell", "vim", "cabal", "syntastic"], "answers": [{"tags": [], "owner": {"reputation": 5271, "user_id": 1658042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879e79284efb4639584574a5fc46c9e4?s=128&d=identicon&r=PG", "display_name": "lcd047", "link": "https://stackoverflow.com/users/1658042/lcd047"}, "is_accepted": true, "score": 2, "last_activity_date": 1427644354, "creation_date": 1427644354, "answer_id": 29331297, "question_id": 29322840, "link": "https://stackoverflow.com/questions/29322840/how-to-configure-syntastic-to-use-build-depends-and-hs-source-dirs-from-my-test/29331297#29331297", "title": "How to configure syntastic to use build-depends and hs-source-dirs from my test suite in the .cabal file of the package?", "body": "<p>There is no silver bullet.  You can either set <code>g:syntastic_haskell_hdevtools_args</code> and friends to the proper flags for your project, or write a wrapper script similar to <a href=\"https://gist.github.com/lcd047/7796203\" rel=\"nofollow\">this</a> and point <code>g:syntastic_haskell_hdevtools_exec</code> to it.  Syntastic has no built-in support for looking at cabal files.</p>\n"}], "owner": {"reputation": 622, "user_id": 311524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2067d97bbaec06933c9e1eeeb811a9?s=128&d=identicon&r=PG", "display_name": "Diogo Biazus", "link": "https://stackoverflow.com/users/311524/diogo-biazus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 29331297, "answer_count": 1, "score": 1, "last_activity_date": 1427644354, "creation_date": 1427578153, "question_id": 29322840, "link": "https://stackoverflow.com/questions/29322840/how-to-configure-syntastic-to-use-build-depends-and-hs-source-dirs-from-my-test", "title": "How to configure syntastic to use build-depends and hs-source-dirs from my test suite in the .cabal file of the package?", "body": "<p>Syntastic works great in my system with hdevtools and hlint. But if I'm editing a file under a test directory, importing packages that are exclusively under the test-suite configuration of the cabal package, it marks my imports as bogus and tells me to include them in my cabal file. The same problem happens with the hs-source-dir, it only finds the ones under the library or executable directory.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 6, "creation_date": 1427572343, "post_id": 29321687, "comment_id": 46834889, "body": "<code>tupleApply</code> is <code>uncurry</code> and Control.Lens defines <code>(|&gt;)</code> as <code>(&amp;)</code>"}, {"owner": {"reputation": 1361, "user_id": 2556165, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fGy2y.jpg?s=128&g=1", "display_name": "wowofbob", "link": "https://stackoverflow.com/users/2556165/wowofbob"}, "edited": false, "score": 1, "creation_date": 1427572362, "post_id": 29321687, "comment_id": 46834899, "body": "<a href=\"http://learnyouahaskell.com/a-fistful-of-monads#walk-the-line\" rel=\"nofollow noreferrer\">Here</a> they use analagous to <code>(|&gt;)</code> function <code>(-:)</code>. But it looks like defined by hands."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1427572455, "post_id": 29321687, "comment_id": 46834924, "body": "on top of this you can find any of those functions yourself very easily by using <a href=\"http://hayoo.fh-wedel.de\" rel=\"nofollow noreferrer\">Hayoo</a> - here is an <a href=\"http://hayoo.fh-wedel.de/?query=a+-%3E+%28a-%3Eb%29+-%3E+b\" rel=\"nofollow noreferrer\">example for the <i>pipe</i> function</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1427572509, "post_id": 29321687, "comment_id": 46834954, "body": "In haskell, we use <code>$</code> or <code>.</code> for long chains. Their flipped versions are less frequently used: they are called <code>&amp;</code> (very uncommon, from lens package ), and <code>&gt;&gt;&gt;</code> (from arrows)."}, {"owner": {"reputation": 679, "user_id": 1038984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8ccdd2690efb42463e1e6587e17fad2?s=128&d=identicon&r=PG", "display_name": "jcc333", "link": "https://stackoverflow.com/users/1038984/jcc333"}, "edited": false, "score": 0, "creation_date": 1427572743, "post_id": 29321687, "comment_id": 46835026, "body": "Thanks, all. These were incredibly helpful"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1427572972, "post_id": 29321687, "comment_id": 46835072, "body": "As a general comment, I&#39;d argue that what you are trying to do is inherently wrong. Programming in language X by redefining standard functions so that they match the names they have in language Y feels wrong: it will lead to programs which are not idiomatic in X. This can then lead to the temptation of writing X code by designing the code thinking in terms of Y, and then trying to shoehorn-translate the design into X. I&#39;d advise against this."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1427574371, "post_id": 29321687, "comment_id": 46835463, "body": "The <code>base</code> that comes with ghc-7.10 defines <code>&amp;</code> in <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Function.html#v:-38-\" rel=\"nofollow noreferrer\"><code>Data.Function</code></a> ."}, {"owner": {"reputation": 679, "user_id": 1038984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8ccdd2690efb42463e1e6587e17fad2?s=128&d=identicon&r=PG", "display_name": "jcc333", "link": "https://stackoverflow.com/users/1038984/jcc333"}, "edited": false, "score": 0, "creation_date": 1427574930, "post_id": 29321687, "comment_id": 46835625, "body": "Yeah, I&#39;d tend to agree with you, I just wanted to know where to dig up all of the utils I keep on wanting to type out. I suppose I was just thinking since they were constructs from immutable-by-default functional(ish) languages, they might be idiomatic haskell. In the end, it turns out there are plenty of synonyms for what I want, and I&#39;ll just learn those."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1427588358, "post_id": 29321687, "comment_id": 46839172, "body": "@chi, <code>&gt;&gt;&gt;</code> is actually native to the much lighter/saner <code>Control.Category</code>, not <code>Control.Arrow</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1427588711, "post_id": 29321687, "comment_id": 46839258, "body": "@jcc333, when different languages/language families collide, you sometimes end up needing to learn different sets of symbols for things. In Haskell, <code>|&gt;</code> is sometimes (but not always/everywhere!) used to mean what is elsewhere called <code>snoc</code>, <code>pushR</code>, or <code>enqueue</code>. It&#39;s probably been used that way since about 2006. <code>$</code> and likely <code>&gt;&gt;&gt;</code> go back to the 90s, but <code>&amp;</code> is probably just a few years old."}], "owner": {"reputation": 679, "user_id": 1038984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8ccdd2690efb42463e1e6587e17fad2?s=128&d=identicon&r=PG", "display_name": "jcc333", "link": "https://stackoverflow.com/users/1038984/jcc333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1427571553, "creation_date": 1427571553, "question_id": 29321687, "link": "https://stackoverflow.com/questions/29321687/is-there-a-package-on-hackage-with-common-utils-idioms-from-other-functionalish", "title": "Is there a package on hackage with common utils/idioms from other functional(ish) languages?", "body": "<p>F# has this great util function <code>(|&gt;) a b = b a</code> that can really help readability for long chains of function applications. I could redefine it easily, but it's part of a class of convenience functions (another would be <code>tupleApply f (a, b) = f a b</code> that don't really belong anywhere but some file called \"utils.hs\". Is there a package with the \"sugar\" I'm looking for, or is it best practice to avoid using idioms like that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1427562216, "post_id": 29319891, "comment_id": 46831439, "body": "A list is not an array, it is represented by an array, but a linked list. The elements from <code>y</code> are not copied: only a reference is set... Some variables thus share the same substructure."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427562305, "post_id": 29319891, "comment_id": 46831472, "body": "it will depend on the implementation and there are surely people around who can explain at least the GHC side directly (not me). Having said that: I doubt that any implementation would <i>copy</i> <code>y</code> instead of just reusing it"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1427562388, "post_id": 29319891, "comment_id": 46831503, "body": "Here is a nice example (and of course you reimplemented it yourself) : <a href=\"https://en.wikipedia.org/wiki/Persistent_data_structure#Linked_lists\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Persistent_data_structure#Linked_lists</a>"}, {"owner": {"reputation": 269, "user_id": 1084637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745239e23061d746727436ec06e5dd2e?s=128&d=identicon&r=PG", "display_name": "asp5", "link": "https://stackoverflow.com/users/1084637/asp5"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1427563449, "post_id": 29319891, "comment_id": 46831869, "body": "@CommuSoft: Thanks. you mentioned only a reference is set, is there a way to see that in GHCI? any existing module, that would help me investigate this? yes list is not array found it easier to use a array representation when asking the question."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1427564869, "post_id": 29319891, "comment_id": 46832345, "body": "The internal representation is quite sophisticated. There&#39;s the ghc-vis tool which shows it, but you will need to understand the runtime, which is very different from any imperative language. You have been warned :-P"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1427587110, "post_id": 29320537, "comment_id": 46838824, "body": "There are a very few packages that use it for very special purposes. It&#39;s really not something any beginner needs to touch with a ten-foot pole, and I would bet an ice cream sundae that under 5% of <i>experienced</i> Haskell programmers have used it even once."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 4, "last_activity_date": 1427565552, "last_edit_date": 1427565552, "creation_date": 1427565082, "answer_id": 29320537, "question_id": 29319891, "link": "https://stackoverflow.com/questions/29319891/haskell-get-memory-address-of-a-list/29320537#29320537", "title": "Haskell: get memory address of a list", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/System-Mem-StableName.html#t%3AStableName\" rel=\"nofollow\"><code>StableName</code></a> or <a href=\"https://hackage.haskell.org/package/ghc-prim-0.3.1.0/docs/GHC-Prim.html#g:20\" rel=\"nofollow\"><code>reallyUnsafePointerEquality#</code></a> (note the name and don't use in real programs; you'll also need <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html\" rel=\"nofollow\">MagicHash</a> extension to call it) to check whether two expressions refer to the same object. See <a href=\"https://stackoverflow.com/questions/9649500/what-advantages-do-stablenames-have-over-reallyunsafeptrequality-and-vice-vers\">What advantages do StableNames have over reallyUnsafePtrEquality#, and vice versa?</a> for the differences.</p>\n"}], "owner": {"reputation": 269, "user_id": 1084637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745239e23061d746727436ec06e5dd2e?s=128&d=identicon&r=PG", "display_name": "asp5", "link": "https://stackoverflow.com/users/1084637/asp5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 29320537, "answer_count": 1, "score": 3, "last_activity_date": 1427565552, "creation_date": 1427561670, "question_id": 29319891, "link": "https://stackoverflow.com/questions/29319891/haskell-get-memory-address-of-a-list", "title": "Haskell: get memory address of a list", "body": "<p>is there a way to get the address of data element (say a list element) in Haskell.</p>\n\n<pre><code>combineLists :: [a] -&gt; [a] -&gt; [a]\n\ncombineLists [] y = y\ncombineLists (x:xs) y = x : combineLists xs y\n\n*Main&gt; let x=[1,23, 12, 45]\n*Main&gt; x\n[1,23,12,45]\n*Main&gt; let y =[90, 56, 78]\n*Main&gt; y\n[90,56,78]\n*Main&gt; let z = combineLists x y\n*Main&gt; z\n[1,23,12,45,90,56,78]\n</code></pre>\n\n<p>Now would <code>z</code> be constructed completely by copying elements from x and y (internal haskell representation) or</p>\n\n<p>would z be something like: z = [ [copy of all elements from x] y]</p>\n\n<p>I wanted to see if &amp;y == &amp;z[4] (z[4] = 90).</p>\n\n<p>Also is there a way to dump the internal representation using something similar to ctypes in Python.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["list", "haskell", "syntax", "list-comprehension", "infinite"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427566011, "post_id": 29319771, "comment_id": 46832745, "body": "AFAIK there isn&#39;t syntax sugar for a <code>takeWhile</code> for list comprehensions.  However, if you were to use <code>map</code> and <code>takeWhile</code>, it&#39;d come out as <code>map bla $ takeWhile (&lt; 42) $ map foo [0..]</code>, which I don&#39;t see as particularly inelegant."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1427567658, "post_id": 29319771, "comment_id": 46833281, "body": "You could do something like <code>[bla z | z &lt;- takeWhile (&lt; 42) [foo n | n &lt;- [0..]]</code>, this keeps things much more list-comprehension-y."}], "answers": [{"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 3, "last_activity_date": 1427562880, "creation_date": 1427562880, "answer_id": 29320105, "question_id": 29319771, "link": "https://stackoverflow.com/questions/29319771/takewhile-within-a-list-comprehension/29320105#29320105", "title": "&quot;takeWhile&quot; within a list comprehension", "body": "<p>I don't have a good answer for this, so I'll just suggest a kludge that lets you use as much of the list comprehension as possible:</p>\n\n<pre><code>map snd . takeWhile fst $\n    [(z &lt; 42, bla z)|n&lt;-[0..], let z = foo n]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "edited": false, "score": 1, "creation_date": 1427580524, "post_id": 29321355, "comment_id": 46837242, "body": "You might be able to use QuickCheck to test to see if <code>F</code> is a <code>Monad</code> if you implement <code>Arbitrary</code> for it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1427588197, "post_id": 29321355, "comment_id": 46839133, "body": "That&#39;s completely nuts. +1."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "edited": false, "score": 0, "creation_date": 1427653318, "post_id": 29321355, "comment_id": 46854957, "body": "@icktoofay Thanks, I just tried your suggestion. No counterexamples after 100000 tests."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1427653224, "last_edit_date": 1427653224, "creation_date": 1427569606, "answer_id": 29321355, "question_id": 29319771, "link": "https://stackoverflow.com/questions/29319771/takewhile-within-a-list-comprehension/29321355#29321355", "title": "&quot;takeWhile&quot; within a list comprehension", "body": "<p>Since list comprehensions do not allow this, I have hacked a bit using <em>monad</em> comprehensions and defining a custom monad. The outcome of that is that the following works:</p>\n\n<pre><code>example :: [Int]\nexample = toList [1000 + n \n                 | n &lt;- fromList [0..]\n                 , _ &lt;- nonStopGuard (n &gt; 1)\n                 , let z = 10*n\n                 , _ &lt;- stopGuard (z &lt; 42) ]\n\n-- Output: [1002,1003,1004]\n</code></pre>\n\n<p>The above works as a normal list comprehension, but has two different kinds of guard. A <code>nonStopGuard</code> works as a regular guard, except for requiring a bizarre syntax. A <code>stopGuard</code> instead does something more: as soon as it become false, it stops further choices in the <em>previous</em> generators (such as <code>&lt;-[0..]</code>) to be considered.</p>\n\n<p>The small library I wrote is shown below:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor, MonadComprehensions #-}\nimport Control.Monad\nimport Control.Applicative\n\ndata F a = F [a] Bool\n  deriving (Functor, Show)\n</code></pre>\n\n<p>The <code>Bool</code> above is a <em>stop</em> bit, signaling we must <em>stop</em> considering further choices.</p>\n\n<pre><code>instance Applicative F where pure = return; (&lt;*&gt;) = ap\ninstance Monad F where\n   return x = F [x] False\n   F [] s      &gt;&gt;= _ = F [] s\n   F (x:xs) sx &gt;&gt;= f = F (ys ++ zs) (sx || sy || sz)\n      where \n      F ys sy = f x\n      F zs sz = if sy then F [] False else F xs sx &gt;&gt;= f\n</code></pre>\n\n<p>The last <code>if</code> will discard the <code>xs</code> part when <code>f x</code> signals to stop.</p>\n\n<pre><code>nonStopGuard :: Bool -&gt; F ()\nnonStopGuard True  = F [()] False\nnonStopGuard False = F []   False\n</code></pre>\n\n<p>A regular guard never signals to stop. It just provides one or zero choices.</p>\n\n<pre><code>stopGuard :: Bool -&gt; F ()\nstopGuard True  = F [()] False\nstopGuard False = F [] True\n</code></pre>\n\n<p>A stopping guard instead signals to stop as soon as it becomes false.</p>\n\n<pre><code>fromList :: [a] -&gt; F a\nfromList xs = F xs False\n\ntoList :: F a -&gt; [a]\ntoList (F xs _) = xs\n</code></pre>\n\n<p>Last caveat: I'm not completely sure my monad instance defines an actual monad, i.e. whether it satisfies the monad laws.</p>\n\n<hr>\n\n<p>Following the suggestion of @icktoofay, I wrote a few quickcheck tests:</p>\n\n<pre><code>instance Arbitrary a =&gt; Arbitrary (F a) where\n   arbitrary = F &lt;$&gt; arbitrary &lt;*&gt; arbitrary\n\ninstance Show (a -&gt; b) where\n   show _ = \"function\"\n\nprop_monadRight :: F Int -&gt; Bool\nprop_monadRight m =\n   (m &gt;&gt;= return) == m\n\nprop_monadLeft :: Int -&gt; (Int -&gt; F Int) -&gt; Bool\nprop_monadLeft x f =\n   (return x &gt;&gt;= f) == f x\n\nprop_monadAssoc :: F Int -&gt; (Int -&gt; F Int) -&gt; (Int -&gt; F Int) -&gt; Bool\nprop_monadAssoc m f g =\n   ((m &gt;&gt;= f) &gt;&gt;= g)\n   ==\n   (m &gt;&gt;= (\\x -&gt; f x &gt;&gt;= g))\n</code></pre>\n\n<p>Running 100000 tests found no counterexamples. So, it's likely that the above <code>F</code> is an actual monad.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1427600913, "creation_date": 1427600913, "answer_id": 29325422, "question_id": 29319771, "link": "https://stackoverflow.com/questions/29319771/takewhile-within-a-list-comprehension/29325422#29325422", "title": "&quot;takeWhile&quot; within a list comprehension", "body": "<p>This sounds like a good point to stop using list comprehensions and instead learn to work with higher-order list functions, such as the ones provided in <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-List.html\" rel=\"nofollow\">the <code>Data.List</code> module</a>.</p>\n\n<p>Fundamentally, list comprehensions are just a pretty syntax for nested uses of <code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]</code>.  So your original comprehension:</p>\n\n<pre><code>[bla z|n&lt;-[0..], let z = foo n, z &lt; 42]\n</code></pre>\n\n<p>...is really the same as this:</p>\n\n<pre><code>let step n = let z = foo n\n             in if z &lt; 42 then [] else [bla z] \nin concatMap step [0..]\n</code></pre>\n\n<p>But the idiomatic way of writing comprehension-like computations directly is with <code>map</code>, <code>filter</code> and the <code>Applicative</code> class (the last of which is not needed in this one example):</p>\n\n<pre><code>map bla (filter (&lt;42) (map foo [0..]))\n</code></pre>\n\n<p>And once you have it written like this, it's easy to see that this is what you want:</p>\n\n<pre><code>map bla (takeWhile (&lt;42) (map foo [0..]))\n</code></pre>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1427653224, "creation_date": 1427561062, "question_id": 29319771, "link": "https://stackoverflow.com/questions/29319771/takewhile-within-a-list-comprehension", "title": "&quot;takeWhile&quot; within a list comprehension", "body": "<p>I have something like the following:</p>\n\n<pre><code>[bla z|n&lt;-[0..], let z = foo n, z &lt; 42]\n</code></pre>\n\n<p>The thing is, I want the list comprehension to end as soon as <code>z &lt; 42</code> fails, as if it were a takeWhile. I know I could refactor this into a bunch of filters and maps, but it will be much more elegant with a list comprehension.</p>\n\n<p>What is the most elegant way to combine list comprehensions and takeWhile?</p>\n"}, {"tags": ["list", "haskell", "non-exhaustive-patterns"], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 4, "last_activity_date": 1427550691, "last_edit_date": 1427550691, "creation_date": 1427548008, "answer_id": 29317528, "question_id": 29317491, "link": "https://stackoverflow.com/questions/29317491/haskell-non-exhaustive-patterns-error-with-a-function-using-list/29317528#29317528", "title": "Haskell - &quot;Non-exhaustive patterns&quot; error with a function using list", "body": "<p>The pattern <code>[x]</code> matches a list containing exactly one item, <code>x</code>. Thus, the pattern <code>[[items]]</code> matches a single list containing a single item. What you want is to match all non-empty lists in the second case. But since empty lists have already been matched against, by elimination you simply want to match anything that hasn't already been matched.</p>\n\n<pre><code>sameLength :: [[t]] -&gt; String\nsameLength [] = \"Empty list\"\nsameLength items = -- Code here\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 110, "user_id": 2682768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345f835c6dd742dba19c14ae5b054b37?s=128&d=identicon&r=PG&f=1", "display_name": "user2682768", "link": "https://stackoverflow.com/users/2682768/user2682768"}, "edited": false, "score": 0, "creation_date": 1427568706, "post_id": 29317557, "comment_id": 46833651, "body": "Won&#39;t the compiler optimize the [code]length h[/code] because of referential transparency?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 110, "user_id": 2682768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345f835c6dd742dba19c14ae5b054b37?s=128&d=identicon&r=PG&f=1", "display_name": "user2682768", "link": "https://stackoverflow.com/users/2682768/user2682768"}, "edited": false, "score": 0, "creation_date": 1427569765, "post_id": 29317557, "comment_id": 46834043, "body": "@user2682768 honestly: I don&#39;t know - maybe (and tbh: I don&#39;t think it will matter in most cases) - if you want you can run some tests or look at the core-code (see here: <a href=\"http://book.realworldhaskell.org/read/profiling-and-optimization.html\" rel=\"nofollow noreferrer\">book.realworldhaskell.org/read/profiling-and-optimization.ht&zwnj;&#8203;ml</a>) - in any case it will not hurt (aside from beeing a bit longer) and I just wanted to add a version in non-point-free (!) style and so the line did fit nicer (and performance sounds impressive ;) )"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 110, "user_id": 2682768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345f835c6dd742dba19c14ae5b054b37?s=128&d=identicon&r=PG&f=1", "display_name": "user2682768", "link": "https://stackoverflow.com/users/2682768/user2682768"}, "edited": false, "score": 1, "creation_date": 1427644499, "post_id": 29317557, "comment_id": 46851770, "body": "@user2682768 GHC doesn&#39;t automatically memoize functions because, in general, that would use a <i>lot</i> of memory. If you make a named binding to it though, like the last code block in this answer, it will only evaluate <code>length h</code> once because of sharing."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1427644805, "post_id": 29317557, "comment_id": 46851874, "body": "@DavidYoung thanks for pointing that out - I remember having read something like this somewhere but GHC seems to get more <i>magic</i> every day and so you can never be sure ;)"}, {"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1427735089, "post_id": 29317557, "comment_id": 46889379, "body": "I&#39;m pretty sure that <code>length h</code> will be evaluated only once and this is not a question of optimization but simply of the fact that this is a closure and h is not a parameter, thus <code>length h</code> won&#39;t change and is just a thunk that will be evaluated to WHNF once because of the comparison."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1427550276, "last_edit_date": 1427550276, "creation_date": 1427548285, "answer_id": 29317557, "question_id": 29317491, "link": "https://stackoverflow.com/questions/29317491/haskell-non-exhaustive-patterns-error-with-a-function-using-list/29317557#29317557", "title": "Haskell - &quot;Non-exhaustive patterns&quot; error with a function using list", "body": "<p>you have too many <code>[..]</code> in here: </p>\n\n<pre><code>sameLength [[items]] \n</code></pre>\n\n<p>(as Silvio explained really well) - try </p>\n\n<pre><code>sameLength items \n</code></pre>\n\n<p>instead. </p>\n\n<p>Further as <code>a == a</code>, you don't have to check if the length of the head is the same as the length of the head` (of course) and so I would recommend doing something like this:</p>\n\n<pre><code>sameLength :: [[a]] -&gt; Bool\nsameLength []     = True\nsameLength (h:tl) = all ((length h ==) . length) tl\n</code></pre>\n\n<p>as I think the <code>Bool</code> result is just more useful and natural</p>\n\n<h3>how does this work?</h3>\n\n<p><code>all</code> takes a predicate and a list and checks if the predicate holds for each element of the list - so <code>(length h ==) . length = \\xs -&gt; length h == length xs</code> as a predicate checks if a given list <code>xs</code> has the same length as the head-list <code>h</code> - so due to the remark above you only have to check this with the tail-list <code>tl</code></p>\n\n<h3>remark</h3>\n\n<p>You can argue if all <em>elements</em> of the empty list should have <em>the same length</em> - but I think the answer should be yes ;)</p>\n\n<h3>examples</h3>\n\n<pre><code>Prelude&gt; sameLength [[1,2],[3,4]]\nTrue\nPrelude&gt; sameLength [[1,2],[3,4,5]]\nFalse\nPrelude&gt; sameLength [[1,2]]\nTrue\nPrelude&gt; sameLength []\nTrue\n</code></pre>\n\n<h3>in case you are concerned about performance</h3>\n\n<p>(or you do not like the point-free style)</p>\n\n<pre><code>sameLength :: [[a]] -&gt; Bool\nsameLength []     = True\nsameLength (h:tl) = let l = length h\n                    in all (\\xs -&gt; length xs == l) tl\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4281300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZKnaY.jpg?s=128&g=1", "display_name": "Prygan", "link": "https://stackoverflow.com/users/4281300/prygan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "accepted_answer_id": 29317557, "answer_count": 2, "score": 0, "last_activity_date": 1427550691, "creation_date": 1427547747, "question_id": 29317491, "link": "https://stackoverflow.com/questions/29317491/haskell-non-exhaustive-patterns-error-with-a-function-using-list", "title": "Haskell - &quot;Non-exhaustive patterns&quot; error with a function using list", "body": "<p>I'm trying to make a function in haskell to know if all the elements in a list of list have the same length. (I've search answers in previous posts but none of them works).</p>\n\n<pre><code>sameLength :: [[t]] -&gt; String\nsameLength [] = \"Empty list\"\nsameLength [[items]]\n    | and $ map (\\x -&gt; length x == (length $ head [[items]])) [[items]] = \"Same length\"\n    | otherwise = \"Not the same length\"\n</code></pre>\n\n<p>The problem is that it doesn't work :</p>\n\n<pre><code>*Main&gt; :l test.hs\n[1 of 1] Compiling Main             ( test.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; sameLength []\n\"Empty list\"\n*Main&gt; sameLength [[1,2],[3,4]]\n\"*** Exception: test.hs:(2,1)-(5,39): Non-exhaustive patterns in function sameLength\n\n*Main&gt; sameLength [[1,2]]\n\"*** Exception: test.hs:(2,1)-(5,39): Non-exhaustive patterns in function sameLength\n</code></pre>\n\n<p>I don't really see where is the problem. It treat the case in which the parameter is an empty list and in which it is not. Am I wrong ? Did i miss something ?</p>\n\n<p>Thanks for your help :)</p>\n"}, {"tags": ["opengl", "haskell", "textures", "shader"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427545006, "post_id": 29316993, "comment_id": 46826044, "body": "um, <code>tUnit =(\\(TextureObject x) -&gt; x) texObj</code>? why? <code>tUnit (TextureObject x) = x</code>. Also, texture unit IDs aren&#39;t texture object IDs."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1427545363, "post_id": 29316993, "comment_id": 46826128, "body": "Ah, that&#39;d work too, lol. Sorry, I&#39;m not quite used to Haskell yet. Yeah, but I&#39;m not sure how to pass a TextureObject as a uniform variable, and I can&#39;t find anything on it. I don&#39;t get the difference between them?"}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1427545790, "post_id": 29316993, "comment_id": 46826235, "body": "Figured it out, I&#39;m dumb! Posted an answer explaining what I did wrong!"}], "answers": [{"tags": [], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "is_accepted": true, "score": 1, "last_activity_date": 1427546039, "last_edit_date": 1427546039, "creation_date": 1427545769, "answer_id": 29317155, "question_id": 29316993, "link": "https://stackoverflow.com/questions/29316993/using-multiple-textures-for-shader-programming-in-haskell/29317155#29317155", "title": "Using multiple textures for shader programming in Haskell", "body": "<p>The TextureUnit is a local shader id and the TextureObject is a global texture id. I wasn't binding my TextureObject again before setting the active texture, so it was just using the latest one bound.</p>\n"}], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 29317155, "answer_count": 1, "score": 1, "last_activity_date": 1427546039, "creation_date": 1427544689, "question_id": 29316993, "link": "https://stackoverflow.com/questions/29316993/using-multiple-textures-for-shader-programming-in-haskell", "title": "Using multiple textures for shader programming in Haskell", "body": "<p>I'm currently using TextureObjects when reading in a texture. I read in two textures, and want to dynamically switch between them, but when I try do:</p>\n\n<pre><code>tUnit =(\\(TextureObject x) -&gt; x) texObj\n</code></pre>\n\n<p>And then </p>\n\n<pre><code>activeTexture $= (TextureUnit tUnit)\nsetUniform p \"texUnit\" (TextureUnit tUnit)\n</code></pre>\n\n<p>It doesn't work, but if I replace tUnit with 0, it works but it'll draw everything with the last texture I load.</p>\n\n<p>I'm using GLUtil's <code>readTexture</code> function to load in my texture.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1427508189, "creation_date": 1427508189, "answer_id": 29312845, "question_id": 29312753, "link": "https://stackoverflow.com/questions/29312753/how-to-get-minimum-value-of-enum-type-declared-in-function-type-definition/29312845#29312845", "title": "How to get minimum value of Enum type declared in function type definition?", "body": "<p>Two plausible answers:</p>\n\n<ol>\n<li><p>Delete the internal type signature.</p>\n\n<pre><code>minValue = minBound\n</code></pre>\n\n<p>While this works, it doesn't \"scale\" well to larger functions that need to do more stuff, where it may not be so obvious which type to use for <code>minBound</code>. That leads us to</p></li>\n<li><p>Turn on lexical scoping for type variables. You can start a scope with the <code>forall</code> keyword; then definitions in that scope can refer to type variables. Thus:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nminValue :: forall a. (Enum a, Bounded a) =&gt; a\nminValue = minBound :: a\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 1, "last_activity_date": 1427508575, "last_edit_date": 1427508575, "creation_date": 1427508201, "answer_id": 29312848, "question_id": 29312753, "link": "https://stackoverflow.com/questions/29312753/how-to-get-minimum-value-of-enum-type-declared-in-function-type-definition/29312848#29312848", "title": "How to get minimum value of Enum type declared in function type definition?", "body": "<p>What you're wanting here is <code>ScopedTypeVariables</code>, where the <code>a</code> in <code>minValue</code>'s type signature is the same as the <code>a</code> used in the definition.  However, I have a suspicion that you don't need it for your use case.  The value <code>minBound</code> is polymorphic, and when something in Haskell is polymorphic it's usually <em>call site</em> polymorphic.  This means that the caller determines the type, not the definition.  For example, you could write something like</p>\n\n<pre><code>cycleBounded :: (Bounded a, Enum a, Eq a) =&gt; [a]\ncycleBounded\n    = minBound\n    : map (\\n -&gt; if n == maxBound then minBound else succ n)\n          cycleBounded\n</code></pre>\n\n<p>And then you could do something like <code>cycleBounded :: [Bool]</code> to get something equivalent to <code>cycle [False, True]</code>.  However, you would run into a problem if you wanted to get rid of the <code>Eq</code> constraint by using <code>fromEnum</code> on <code>n</code> and <code>maxBound</code> before comparing, because then the compiler doesn't know what <code>Bounded a =&gt; a</code> to use for <code>maxBound</code>, there's nothing in the context that says that it has to use the same type as <code>n</code>, just that it's a <code>(Enum a, Bounded a) =&gt; a</code>.  This would be an appropriate application of <code>ScopedTypeVariables</code>:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\ncycleBounded :: forall a. (Bounded a, Enum a, Eq a) =&gt; [a]\ncycleBounded\n    = minBound\n    : map (\\n -&gt; if fromEnum n == fromEnum (maxBound :: a) then minBound else succ n)\n          cycleBounded\n</code></pre>\n\n<p>And while there are tricks to get these types to unify without the need for <code>ScopedTypeVariables</code>, most would probably find it more understandable to see <code>ScopedTypeVariables</code> and <code>maxBound :: a</code> than anything.  For the sake of completeness, here's how you could get it to unify:</p>\n\n<pre><code>cycleBounded\n    = minBound\n    : map (\\n -&gt; let {m = maxBound;\n                      x = [m, n] -- This forces `m` and `n` to have the same type\n                     }\n                 in if fromEnum n == fromEnum (head x)\n                        then minBound\n                        else succ n)\n          cycleBounded\n</code></pre>\n\n<p>Which is pretty ugly in my opinion.</p>\n"}], "owner": {"reputation": 117, "user_id": 1266055, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dfd4c91a6bb4129adaa59491be3d5121?s=128&d=identicon&r=PG", "display_name": "gumol", "link": "https://stackoverflow.com/users/1266055/gumol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1427508575, "creation_date": 1427507409, "question_id": 29312753, "link": "https://stackoverflow.com/questions/29312753/how-to-get-minimum-value-of-enum-type-declared-in-function-type-definition", "title": "How to get minimum value of Enum type declared in function type definition?", "body": "<p>Let's say I want to define a function that uses one of the constants defined for the given type. I tried:</p>\n\n<pre><code>minValue :: (Enum a,Bounded a) =&gt; a\nminValue = minBound::a\n</code></pre>\n\n<p>but the function definition doesn't know that a is of type Enum, because that is specified in the declaration.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427508334, "post_id": 29312748, "comment_id": 46819076, "body": "Nice explanation. Per your question at the beginning of your answer, <code>map (take 13)</code> will result in some lists shorter than length 13, whereas <code>foldr (zipWith (:)) (repeat []) . take 13</code> won&#39;t. Though idiomatically this would probably be spelled <code>transpose . take 13</code> instead."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1427509467, "post_id": 29312748, "comment_id": 46819265, "body": "If finding consecutive digits that minimized the product, the difference between <code>map (take 13)</code> and <code>foldr (zipWith (:)) (repeat []) . take 13</code> would be very important."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427509823, "post_id": 29312748, "comment_id": 46819312, "body": "@DanielWagner <code>transpose . take 13</code> also results in some lists shorter than length 13."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1427528430, "post_id": 29312748, "comment_id": 46822208, "body": "@Cirdec It could matter for the maximum too, if we had something like <code>0999999999999</code> at the end of the input."}, {"owner": {"reputation": 796, "user_id": 4722212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88280d4d07ac29273d3c377ed70d9cad?s=128&d=identicon&r=PG&f=1", "display_name": "Radek", "link": "https://stackoverflow.com/users/4722212/radek"}, "edited": false, "score": 0, "creation_date": 1427536233, "post_id": 29312748, "comment_id": 46823757, "body": "I have edited my answer to make the solution correct."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427563355, "post_id": 29312748, "comment_id": 46831839, "body": "@Cirdec exactly! <code>transpose</code> could conceivably be defined either way, but <code>zip</code> is <code>zip</code>, so the meaning is clear."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1427567184, "post_id": 29312748, "comment_id": 46833138, "body": "@Cirdec You&#39;re absolutely right, <code>transpose</code> is not a correct respelling of <code>foldr (zipWith (:)) (repeat [])</code>."}], "tags": [], "owner": {"reputation": 796, "user_id": 4722212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88280d4d07ac29273d3c377ed70d9cad?s=128&d=identicon&r=PG&f=1", "display_name": "Radek", "link": "https://stackoverflow.com/users/4722212/radek"}, "is_accepted": false, "score": 0, "last_activity_date": 1427536022, "last_edit_date": 1427536022, "creation_date": 1427507375, "answer_id": 29312748, "question_id": 29312499, "link": "https://stackoverflow.com/questions/29312499/project-euler-8-i-dont-understand-it/29312748#29312748", "title": "Project Euler 8 - I don&#39;t understand it", "body": "<p>EDIT: I found out later what the <code>foldr</code> expression was for. (See comments bellow my answer). </p>\n\n<p>I think that this could be expressed in different way - You can simply add a guard at the end of the list.</p>\n\n<p>My verbose version of that solution would be:</p>\n\n<pre><code>import Data.List\nimport Data.Char\n\neuler_8 = do\n    let len  = 13\n    let str1 = \"123456789\\n123456789\"\n    -- Join lines \n    let str2 = concat (lines str1)\n    -- Transform the list of characters into a list of numbers\n    let lst1 = map (fromIntegral . digitToInt) str2\n    -- EDIT: Add a guard at the end of list\n    let lst2 = lst1 ++ [-1]\n    -- Get all tails of the list of digits\n    let lst3 = tails lst2\n    -- Get first 13 digits from each tail\n    let lst4 = map (take len) lst3\n    -- Get a list of products\n    let prod = map product lst4\n    -- Find max product\n    let m    = maximum prod\n    print m\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2965601"}, "edited": false, "score": 0, "creation_date": 1427579883, "post_id": 29312934, "comment_id": 46837085, "body": "But isn&#39;t repeat problematic, because it creates an infinite list?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1427582820, "post_id": 29312934, "comment_id": 46837785, "body": "@user2965601 <code>zipWith</code>, as also <code>zip</code>, stops when the shortest of its argument lists ends. So using the infinite list ensures that whatever the length of the shortest list, it will be processed in full. The rest of <code>[]</code>s in the infinite list will be ignored, because of Haskell&#39;s lazyness. Of course the length can be calculated (1000-13, +-1) and the lists evened out with <code>drop</code>, but using this trick is nice, for it takes care of the ends alignment automagically, without calculations. Note that <code>foldr f [a,b,c,...,n] z == f a (f b (f c ...(f n z) ... ))</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1427585127, "post_id": 29312934, "comment_id": 46838345, "body": "@user2965601 ... lists evened out ... with <code>take</code>, of course, not <code>drop</code>."}, {"owner": {"reputation": 365, "user_id": 2593302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe83beb5917d7541b088a20bce08b3?s=128&d=identicon&r=PG&f=1", "display_name": "chad", "link": "https://stackoverflow.com/users/2593302/chad"}, "edited": false, "score": 0, "creation_date": 1452454780, "post_id": 29312934, "comment_id": 57166007, "body": "Could the <code>foldr (zipWith (:)) (repeat [])</code> line be replaced with the <code>transpose</code> function from <code>Data.List</code> since it is already being imported anyway?"}, {"owner": {"reputation": 365, "user_id": 2593302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe83beb5917d7541b088a20bce08b3?s=128&d=identicon&r=PG&f=1", "display_name": "chad", "link": "https://stackoverflow.com/users/2593302/chad"}, "edited": false, "score": 0, "creation_date": 1452460786, "post_id": 29312934, "comment_id": 57167981, "body": "With regards to my above comment, it appears that <code>transpose</code> could possibly yield a different answer, though it is unlikely. Unlike <code>zipWith</code> it does not automagically drop the parts of a given row longer than the shortest row. E.g. <code>transpose [[1,2],[3],[4]]</code> yields <code>[[1,3,4],[2]]</code> where as the <code>foldr</code> method would yield <code>[[1,3,4]]</code>. This means that <code>transpose</code> leaves some additional lists with less than 13 items in the mix. Usually, these lists would not have a larger product, however it&#39;s possible e.g. if a list had mainly low products and there were an island of 9s surrounded by 0s."}, {"owner": {"reputation": 365, "user_id": 2593302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe83beb5917d7541b088a20bce08b3?s=128&d=identicon&r=PG&f=1", "display_name": "chad", "link": "https://stackoverflow.com/users/2593302/chad"}, "edited": false, "score": 0, "creation_date": 1452461233, "post_id": 29312934, "comment_id": 57168141, "body": "A simple example of the above would be the list [[1],[1],[1,9]]. Using the transpose method, the largest product is 9 but the foldr method would give you 1."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 9, "last_activity_date": 1427509000, "last_edit_date": 1495542156, "creation_date": 1427509000, "answer_id": 29312934, "question_id": 29312499, "link": "https://stackoverflow.com/questions/29312499/project-euler-8-i-dont-understand-it/29312934#29312934", "title": "Project Euler 8 - I don&#39;t understand it", "body": "<h3>Reading the data</h3>\n\n<p><code>readFile</code> reads the file <code>\"number.txt\"</code>. If we put a small 16 digit number in a file called <code>number.txt</code></p>\n\n<pre><code>7316\n9698\n8586\n1254\n</code></pre>\n\n<p>Runing</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print $ str\n</code></pre>\n\n<p>Results in</p>\n\n<pre><code>\"7316\\n9698\\n8586\\n1254\"\n</code></pre>\n\n<p>This string has extra newline characters in it. To remove them, the author splits the string into <code>lines</code>.</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . lines $ str\n</code></pre>\n\n<p>The result no longer has any <code>'\\n'</code> characters, but is a list of strings.</p>\n\n<pre><code>[\"7316\",\"9698\",\"8586\",\"1254\"]\n</code></pre>\n\n<p>To turn this into a single string, the strings are <code>concat</code>enated together.</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . concat . lines $ str\n</code></pre>\n\n<p>The concatenated string is a list of characters instead of a list of numbers</p>\n\n<pre><code>\"7316969885861254\"\n</code></pre>\n\n<p>Each character is converted into an <code>Int</code> by <code>digitToInt</code> then converted into an <code>Integer</code> by <code>fromInteger</code>. On 32 bit hardware using a full-sized <code>Integer</code> is important since the product of 13 digits could be larger than <code>2^31-1</code>. This conversion is <code>map</code>ped onto each item in the list.</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . map (fromIntegral . digitToInt)\n         . concat . lines $ str\n</code></pre>\n\n<p>The resulting list is full of <code>Integer</code>s.</p>\n\n<pre><code>[7,3,1,6,9,6,9,8,8,5,8,6,1,2,5,4]\n</code></pre>\n\n<h3>Subsequences</h3>\n\n<p>The author's next goal is to find all of the 13 digit runs in this list of integers. <code>tails</code> returns all of the sublists of a list, starting at any position and running till the end of the list.</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . tails\n         . map (fromIntegral . digitToInt)\n         . concat . lines $ str\n</code></pre>\n\n<p>This results in 17 lists for our 16 digit example. (I've added formatting)</p>\n\n<pre><code>[\n  [7,3,1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n    [3,1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n      [1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n        [6,9,6,9,8,8,5,8,6,1,2,5,4],\n          [9,6,9,8,8,5,8,6,1,2,5,4],\n            [6,9,8,8,5,8,6,1,2,5,4],\n              [9,8,8,5,8,6,1,2,5,4],\n                [8,8,5,8,6,1,2,5,4],\n                  [8,5,8,6,1,2,5,4],\n                    [5,8,6,1,2,5,4],\n                      [8,6,1,2,5,4],\n                        [6,1,2,5,4],\n                          [1,2,5,4],\n                            [2,5,4],\n                              [5,4],\n                                [4],\n                                 []\n]\n</code></pre>\n\n<p>The author is going to pull a trick where we rearrange these lists to read off 13 digit long sub lists. If we look at these lists left-aligned instead of right-aligned we can see the sub sequences running down each column.</p>\n\n<pre><code>[\n  [7,3,1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [3,1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [9,6,9,8,8,5,8,6,1,2,5,4],\n  [6,9,8,8,5,8,6,1,2,5,4],\n  [9,8,8,5,8,6,1,2,5,4],\n  [8,8,5,8,6,1,2,5,4],\n  [8,5,8,6,1,2,5,4],\n  [5,8,6,1,2,5,4],\n  [8,6,1,2,5,4],\n  [6,1,2,5,4],\n  [1,2,5,4],\n  [2,5,4],\n  [5,4],\n  [4],\n  []\n]\n</code></pre>\n\n<p>We only want these columns to be 13 digits long, so we only want to <code>take</code> the first <code>13</code> rows.</p>\n\n<pre><code>[\n  [7,3,1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [3,1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [1,6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [6,9,6,9,8,8,5,8,6,1,2,5,4],\n  [9,6,9,8,8,5,8,6,1,2,5,4],\n  [6,9,8,8,5,8,6,1,2,5,4],\n  [9,8,8,5,8,6,1,2,5,4],\n  [8,8,5,8,6,1,2,5,4],\n  [8,5,8,6,1,2,5,4],\n  [5,8,6,1,2,5,4],\n  [8,6,1,2,5,4],\n  [6,1,2,5,4],\n  [1,2,5,4]\n]\n</code></pre>\n\n<p><code>foldr (zipWith (:)) (repeat [])</code> transposes a list of lists (explaining it belongs to perhaps <a href=\"https://stackoverflow.com/a/24609264/414413\">another question</a>). It discards the parts of the rows longer than the shortest row.</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . foldr (zipWith (:)) (repeat [])\n         . take 13 . tails\n         . map (fromIntegral . digitToInt)\n         . concat . lines $ str\n</code></pre>\n\n<p>We are now reading the sub-sequences across the lists as usual</p>\n\n<pre><code>[\n  [7,3,1,6,9,6,9,8,8,5,8,6,1],\n  [3,1,6,9,6,9,8,8,5,8,6,1,2],\n  [1,6,9,6,9,8,8,5,8,6,1,2,5],\n  [6,9,6,9,8,8,5,8,6,1,2,5,4]\n]\n</code></pre>\n\n<h3>The problem</h3>\n\n<p>We find the <code>product</code> of each of the sub-sequences by <code>map</code>ping <code>product</code> on to them.</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . map product\n         . foldr (zipWith (:)) (repeat [])\n         . take 13 . tails\n         . map (fromIntegral . digitToInt)\n         . concat . lines $ str\n</code></pre>\n\n<p>This reduces the lists to a single number each</p>\n\n<pre><code>[940584960,268738560,447897600,1791590400]\n</code></pre>\n\n<p>From which we must find the <code>maximum</code>.</p>\n\n<pre><code>euler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . maximum . map product\n         . foldr (zipWith (:)) (repeat [])\n         . take 13 . tails\n         . map (fromIntegral . digitToInt)\n         . concat . lines $ str\n</code></pre>\n\n<p>The answer is</p>\n\n<blockquote class=\"spoiler\">\n  <p>    1791590400</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1427527931, "post_id": 29312971, "comment_id": 46822117, "body": "The <code>fromIntegral</code> is not superfluous, it prevents <code>Int</code> overflow on 32-bit systems. I added it in response to <a href=\"http://stackoverflow.com/questions/25344196/project-euler-8-haskell\">a previous SO question</a>. I vaguely recall someone else &quot;cleaned it up&quot; later, though. I&#39;m not sure though, because someone also broke diffs on the Haskell wiki..."}, {"owner": {"reputation": 6215, "user_id": 388182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TqkIS.jpg?s=128&g=1", "display_name": "RageD", "link": "https://stackoverflow.com/users/388182/raged"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1427548483, "post_id": 29312971, "comment_id": 46827019, "body": "Ah, thanks for pointing this out! :) I have corrected the post."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1427584977, "post_id": 29312971, "comment_id": 46838310, "body": "BTW I just realized that the &quot;cleaned up&quot; version is of course @WillNess&#39;s corrected version from his answer to the same SO question."}], "tags": [], "owner": {"reputation": 6215, "user_id": 388182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TqkIS.jpg?s=128&g=1", "display_name": "RageD", "link": "https://stackoverflow.com/users/388182/raged"}, "is_accepted": false, "score": 4, "last_activity_date": 1427548570, "last_edit_date": 1427548570, "creation_date": 1427509422, "answer_id": 29312971, "question_id": 29312499, "link": "https://stackoverflow.com/questions/29312499/project-euler-8-i-dont-understand-it/29312971#29312971", "title": "Project Euler 8 - I don&#39;t understand it", "body": "<p>If you're not familiar with the functions used, the first thing you should do is examine the types of each function. Since this is function composition, you apply from inside out (i.e. operations occur right to left, bottom to top when reading). We can walk through this line by line.</p>\n\n<p>Starting from the last line, we'll first examine the types.</p>\n\n<pre><code>:t str\nstr :: String -- This is your input\n:t lines\nlines :: String -&gt; [String] -- Turn a string into an array of strings splitting on new line\n:t concat\nconcat :: [[a]] -&gt; [a] -- Merge a list of lists into a single list (hint: type String = [Char])\n</code></pre>\n\n<p>Since <code>type String = [Char]</code> (so <code>[String]</code> is equivalent to <code>[[Char]]</code>), this line is converting the multi-line number into a single array of number characters. More precisely, it first creates an array of strings based on the full string. That is, one string per new line. It then merges all of these lines (now containing only number characters) into a single array of characters (or a single <code>String</code>).</p>\n\n<p>The next line takes this new String as input. Again, let's observe the types:</p>\n\n<pre><code>:t digitToInt\ndigitToInt :: Char -&gt; Int -- Convert a digit char to an int\n:t fromIntegral\nfromIntegral :: (Num b, Integral a) =&gt; a -&gt; b -- Convert integral to num type\n:t map\nmap :: (a -&gt; b) -&gt; [a] -&gt; [b] -- Perform a function on each element of the array\n:t tails\ntails :: [a] -&gt; [[a]] -- Returns all final segments of input (see: http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-List.html#v:tails)\n:t take\ntake :: Int -&gt; [a] -&gt; [a] -- Return the first n values of the list\n</code></pre>\n\n<p>If we apply these operations to our string current input, the first thing that happens is we map the composed function of <code>(fromIntegral . digitToInt)</code> over each character in our string. What this does is turn our string of digits into a list of number types. <strong>EDIT</strong> As pointed out below in the comments, the <code>fromIntegral</code> in this example is to prevent overflow on 32-bit integer types. Now that we have converted our string into actual numeric types, we start by running tails on this result. Since (by the problem statement) all values must be adjacent and we know that all of the integers are non-negative (by virtue of being places of a larger number), we take only the first 13 elements since we want to ensure our multiplication is groupings of 13 consecutive elements. How this works is difficult to understand without considering the next line.</p>\n\n<p>So, let's do a quick experiment. After converting our string into numeric types, we now have a big list of lists. This is actually kind of hard to think about what we actually have here. For sake of understanding, the contents of the list are not very important. What is important is its size. So let's take a look at an artificial example:</p>\n\n<pre><code>(map length . take 13 . tails) [1..1000]\n[1000,999,998,997,996,995,994,993,992,991,990,989,988]\n</code></pre>\n\n<p>You can see what we have here is a big list of 13 elements. Each element is a list of size 1000 (i.e. the full dataset) down to 988 in descending order. So this is what we currently have for input into the next line which is, arguably, the most difficult-- yet most important-- line to understand. Why understanding this is important should become clear as we walk through the next line.</p>\n\n<pre><code>:t foldr\nfoldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b -- Combine values into a single value\n:t zipWith\nzipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c] -- Generalization of zip\n:t (:)\n(:) :: a -&gt; [a] -&gt; [a] -- Cons operator. Add element to list\n:t repeat\nrepeat :: a -&gt; [a] -- Infinite list containing specified value\n</code></pre>\n\n<p>Remember how I mentioned we had a list of 13 elements before (of varying-sized lists)? This is important now. The line is going to iterate over that list and apply <code>(zipWith (:))</code> to it. The <code>(repeat [])</code> is such that each time <code>zipWith</code> is called on a subsequence, it starts with an empty list as its base. This allows us to construct a list of lists containing our adjacent subsequences of length 13.</p>\n\n<p>Finally, we get to the last line which is pretty easy. That said, we should still be mindful of our types</p>\n\n<pre><code>:t product\nproduct :: Num a =&gt; [a] -&gt; a -- Multiply all elements of a list together and return result\n:t maximum\nmaximum :: Ord a =&gt; [a] -&gt; a -- Return maximum element in the list\n</code></pre>\n\n<p>The first thing we do is map the <code>product</code> function over each subsequence. When this has completed we end up with a list of numeric types (hey, we finally don't have a list of lists anymore!). These values are the products of each subsequence. Finally, we apply the <code>maximum</code> function which returns only the largest element in the list.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2965601"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 1, "accepted_answer_id": 29312934, "answer_count": 3, "score": 2, "last_activity_date": 1427548570, "creation_date": 1427504881, "last_edit_date": 1427505564, "question_id": 29312499, "link": "https://stackoverflow.com/questions/29312499/project-euler-8-i-dont-understand-it", "title": "Project Euler 8 - I don&#39;t understand it", "body": "<p>I looked up for a solution in Haskell for the 8th Euler problem, but I don't quite understand it.</p>\n\n<pre><code>import Data.List\nimport Data.Char\n\neuler_8 = do\n   str &lt;- readFile \"number.txt\"\n   print . maximum . map product\n         . foldr (zipWith (:)) (repeat [])\n         . take 13 . tails . map (fromIntegral . digitToInt)\n         . concat . lines $ str\n</code></pre>\n\n<p><a href=\"https://wiki.haskell.org/Euler_problems/1_to_10#Problem_8\" rel=\"nofollow\">Here</a> is the link for the solution and <a href=\"https://projecteuler.net/problem=8\" rel=\"nofollow\">here</a> you can find the task.</p>\n\n<p>Could anyone explain me the solution one by one?</p>\n"}, {"tags": ["haskell", "operators"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 6, "creation_date": 1427494856, "post_id": 29310780, "comment_id": 46815925, "body": "Note that <a href=\"https://www.fpcomplete.com/hoogle?q=.%3A&amp;env=ghc-7.8-stable-14.09\" rel=\"nofollow noreferrer\">FP Complete&#39;s Hoogle</a> is extremely helpful in these scenarios."}, {"owner": {"reputation": 607, "user_id": 2436412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07531356cc096dc9551e1ac5983f651d?s=128&d=identicon&r=PG", "display_name": "Heimdell", "link": "https://stackoverflow.com/users/2436412/heimdell"}, "edited": false, "score": 0, "creation_date": 1427548756, "post_id": 29310780, "comment_id": 46827120, "body": "If you have the code which uses some name and successfully loads into the <code>ghci</code> or <code>cabal repl</code>, you can, for instance, type <code>:i .:</code> to get some info about it."}], "answers": [{"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1427493336, "post_id": 29310785, "comment_id": 46815365, "body": "Oh. Awesome library. Thanks."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1427541348, "post_id": 29310785, "comment_id": 46825043, "body": "Nice take on <code>.:</code>. Looks actually more useful for other functors than for functions."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 8, "last_activity_date": 1427494232, "last_edit_date": 1427494232, "creation_date": 1427493221, "answer_id": 29310785, "question_id": 29310780, "link": "https://stackoverflow.com/questions/29310780/where-is-the-haskell-operator-defined/29310785#29310785", "title": "Where is the Haskell (.:) operator defined?", "body": "<p>You can find it in the <a href=\"http://hackage.haskell.org/package/composition-1.0.1.0/docs/Data-Composition.html\" rel=\"noreferrer\">composition</a> library, along with other higher order function compositions.  This operator is not defined in <code>base</code>.  If you don't want to add a (very small) package as a dependency then just define it yourself, although I would use the more generalize version that uses <code>fmap</code>:</p>\n\n<pre><code>(.:) :: (Functor f, Functor g) =&gt; (a -&gt; b) -&gt; f (g a) -&gt; f (g b)\n(.:) = fmap fmap fmap\n</code></pre>\n\n<p>which just <code>fmap</code>s a function through two layers of functors.  For functions, all three of these <code>fmap</code>s specialize to <code>(.)</code>.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1427494232, "creation_date": 1427493178, "question_id": 29310780, "link": "https://stackoverflow.com/questions/29310780/where-is-the-haskell-operator-defined", "title": "Where is the Haskell (.:) operator defined?", "body": "<p>Apparently the common name for the <code>((.).(.))</code> operator is <code>(.:)</code>. Where is <code>(.:)</code> defined? Or do I have to define it myself?</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 5, "last_activity_date": 1427493057, "creation_date": 1427493057, "answer_id": 29310747, "question_id": 29310140, "link": "https://stackoverflow.com/questions/29310140/haskell-pipes-get-return-value-of-last-proxy-in-pipeline/29310747#29310747", "title": "Haskell Pipes - get return value of last Proxy in pipeline", "body": "<p>Without in-band signaling it will never be possible for the <code>Consumer</code> to have a \"return value\" if the <code>Producer</code> returns first. If the producer is <code>return</code>ing that means the <code>Consumer</code> must be blocked waiting for a requested value. The <code>Consumer</code> will never run again, and thus never have an opportunity to <code>return</code>,  until the <code>Consumer</code> gets an in-band signal with the requested value.</p>\n\n<p>Just because signaling is in-band doesn't mean it needs to be \"icky\". We can convert a <code>Producer</code> that might return into a <code>Producer</code> that we know doesn't return (it's return type is <code>forall r' . r'</code>) by capturing the <code>return</code> and forwarding it downstream. We do this <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#v:forever\" rel=\"noreferrer\"><code>forever</code></a> in case another request comes back upstream.</p>\n\n<pre><code>returnDownstream :: Monad m =&gt; Proxy a' a b' b m r -&gt; Proxy a' a b' (Either r b) m r'\nreturnDownstream = (forever . respond . Left =&lt;&lt;) . (respond . Right &lt;\\\\)\n</code></pre>\n\n<p>At the <code>Consumer</code> end you need to explicitly handle what to do when a value is <code>request</code>ed but instead of getting the response (in a <code>Right</code>) you get the return value of the upstream producer (in a <code>Left</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "is_accepted": false, "score": 2, "last_activity_date": 1427556325, "last_edit_date": 1427556325, "creation_date": 1427508090, "answer_id": 29312836, "question_id": 29310140, "link": "https://stackoverflow.com/questions/29310140/haskell-pipes-get-return-value-of-last-proxy-in-pipeline/29312836#29312836", "title": "Haskell Pipes - get return value of last Proxy in pipeline", "body": "<p>Thanks.  What I have come up with is something like</p>\n\n<pre><code>produce :: MonadIO m =&gt; Producer (Either ExitCode ByteString) m r\nconsume :: MonadIO m =&gt; Consumer (Either ExitCode ByteString) m (Maybe ExitCode, ExitCode)\n</code></pre>\n\n<p>so that when the Effect runs, I get a (Nothing, code) if the downstream process terminated, or (Just code1, code2) if the upstream process terminated first.  (If the downstream terminates first, there's nothing left to do with the upstream process but terminate it, so providing an exit code doesn't make any sense.)</p>\n"}], "owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 2, "accepted_answer_id": 29310747, "answer_count": 2, "score": 4, "last_activity_date": 1427556325, "creation_date": 1427490096, "question_id": 29310140, "link": "https://stackoverflow.com/questions/29310140/haskell-pipes-get-return-value-of-last-proxy-in-pipeline", "title": "Haskell Pipes - get return value of last Proxy in pipeline", "body": "<p>Let's say I have two <code>Proxy</code> in Haskell Pipes.  They represent external system processes.</p>\n\n<pre><code>produce :: MonadIO m =&gt; Producer ByteString m ExitCode\nconsume :: MonadIO m =&gt; Consumer ByteString m ExitCode\n</code></pre>\n\n<p>So I hook them into an <code>Effect</code>, like this:</p>\n\n<pre><code>effect :: Effect m ExitCode\neffect = produce &gt;-&gt; consume\n</code></pre>\n\n<p>This <code>Effect</code> is going to give me the <code>ExitCode</code> from the first <code>Proxy</code> that terminates.  Ordinarily this will be the <code>produce</code>, not the <code>consume</code>.  What's the idiomatic Pipes way to get the return value of the <code>consume</code> even if it does not terminate first?</p>\n\n<p>So far I am thinking this is not possible without doing some sort of icky in-band signaling so the <code>consume</code> knows the stream is done.  The only way the last Proxy knows to shut down is by getting something from an <code>await</code>, so I could send it an empty <code>ByteString</code> to signal that the stream is done.  That just doesn't feel right though.  What I've got now is a separate MVar that can provide the exit value but I'm thinking there has to be a more idiomatic way to do this.</p>\n"}, {"tags": ["haskell", "vector"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1427497085, "post_id": 29309815, "comment_id": 46816621, "body": "I would expect that to be optimized away by stream fusion, yes.  You can always check with <code>ghc-core</code> and looking at the optimized Core yourself."}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 4, "last_activity_date": 1427489643, "creation_date": 1427489643, "answer_id": 29310029, "question_id": 29309815, "link": "https://stackoverflow.com/questions/29309815/how-to-best-implement-countwhile-in-haskell-for-vectors/29310029#29310029", "title": "How to best implement countWhile in Haskell for vectors?", "body": "<p>There's already a function <a href=\"http://hackage.haskell.org/package/vector-0.10.12.2/docs/Data-Vector.html#v:findIndex\" rel=\"nofollow\"><code>findIndex</code></a> for finding the index of the first item that does satisfy a predicate.</p>\n\n<pre><code>findIndex :: (a -&gt; Bool) -&gt; Vector a -&gt; Maybe Int\n</code></pre>\n\n<p>Assuming this is as efficient as possible, we could use this to efficiently write <code>countWhile</code> by finding the first index that doesn't match the predicate. If we can't find one that doesn't match the predicate then all of them (<code>length v</code>) matched the predicate.</p>\n\n<pre><code>countWhile :: (a -&gt; Bool) -&gt; Vector a -&gt; Int\ncountWhile p v = maybe (length v) (findIndex (not . p) v)\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427491442, "creation_date": 1427488772, "last_edit_date": 1427491442, "question_id": 29309815, "link": "https://stackoverflow.com/questions/29309815/how-to-best-implement-countwhile-in-haskell-for-vectors", "title": "How to best implement countWhile in Haskell for vectors?", "body": "<p>I'd like to use a function that counts the number of items at the beginning of a <a href=\"http://hackage.haskell.org/package/vector-0.10.12.2/docs/Data-Vector.html\" rel=\"nofollow\">Vector</a> that satisfies a predicate. In other words:</p>\n\n<pre><code>countWhile p xs = V.length $ V.takeWhile p xs\n</code></pre>\n\n<p>Would stream fusion optimize this function or is it more efficient write out the recursion explicitly, like the following?</p>\n\n<pre><code>countWhile p xs\n  | V.null xs = 0\n  | otherwise = if p (V.head xs) then 1 + countWhile p (V.tail xs) else 0\n</code></pre>\n\n<p>Or is there another better way?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1427489880, "post_id": 29309813, "comment_id": 46813935, "body": "Could you instead define your data type as <code>Stock { isEtf :: Bool, _stockSymbol :: String, ... }</code>?  If all the fields are the same and the difference is the constructor then just make the constructor a field.  I&#39;m going to guess that the lens library doesn&#39;t support what you&#39;re trying to do since multi-constructor records are generally discouraged.  You could try using the same field names for both constructors, though, that might work."}, {"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427490047, "post_id": 29309813, "comment_id": 46814019, "body": "@bheklilr I have a working example, see my edit. I could use a field like you said, but having data constructors seemed nicer. Why does the lens library discourage multi-constructor records?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1427490201, "post_id": 29309813, "comment_id": 46814079, "body": "The haskell community in general discourages them, they can be dangerous.  For example, what if I called <code>_etfBuyAt (Stock &quot;&quot; 0 0 0)</code>?  You lose safety by introducing partial functions and that can lead to crashing your application."}, {"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427491021, "post_id": 29309813, "comment_id": 46814448, "body": "Ah, makes sense. Thanks! Followup question: suppose I split this into two data types, <code>Stock</code> and <code>Etf</code>, but I can use the same functions on both thanks to lenses. How do I write a function that can take either one? Like <code>getSymbol :: EitherStockOrEtf -&gt; String</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1427501398, "post_id": 29309813, "comment_id": 46817730, "body": "@VladTheImpala Why do you want to do that? You&#39;re making life difficult for yourself"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1427530414, "post_id": 29309813, "comment_id": 46822537, "body": "@bheklilr I think <code>lens</code> actually decreases the problems with multi-constructor records, because it makes sure to only derive a <code>Traversal</code> when a field is not always defined."}], "answers": [{"comments": [{"owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "edited": false, "score": 0, "creation_date": 1427494058, "post_id": 29310845, "comment_id": 46815625, "body": "Oh I had no idea multiple data constructors could share the same field name. Thanks!"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 1, "creation_date": 1427494211, "post_id": 29310845, "comment_id": 46815678, "body": "This does use the new (as of 7.10) <a href=\"http://stackoverflow.com/a/22019416/925978\">OverloadedRecords</a> extension, does it not?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 2, "creation_date": 1427494449, "post_id": 29310845, "comment_id": 46815769, "body": "@Eric: Nope, Haskell 98. (&quot;A data declaration may use the same field label in multiple constructors as long as the typing of the field is the same in all cases after type synonym expansion.&quot;) You might be mislead by the OP writing &quot;data types&quot; when they meant &quot;data constructors&quot;."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 2, "last_activity_date": 1427493543, "creation_date": 1427493543, "answer_id": 29310845, "question_id": 29309813, "link": "https://stackoverflow.com/questions/29309813/use-the-same-lens-with-multiple-data-constructors/29310845#29310845", "title": "Use the same lens with multiple data constructors", "body": "<p>Not to disagree with bheklilr's comment, but you could just do this:</p>\n\n<pre><code>data Stock =\n         Stock {\n           _symbol :: String,\n           _fairValue :: Float,\n           _buyAt :: Float,\n           _currentPrice :: Float\n         } |\n         Etf {\n           _symbol :: String,\n           _fairValue :: Float,\n           _buyAt :: Float,\n           _currentPrice :: Float\n         } deriving (Eq)\n$(makeLenses ''Stock)\n</code></pre>\n"}], "owner": {"reputation": 14101, "user_id": 139117, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f327e79d803f7372c952f0023983195d?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad the Impala", "link": "https://stackoverflow.com/users/139117/vlad-the-impala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 29310845, "answer_count": 1, "score": 3, "last_activity_date": 1427495211, "creation_date": 1427488767, "last_edit_date": 1427495211, "question_id": 29309813, "link": "https://stackoverflow.com/questions/29309813/use-the-same-lens-with-multiple-data-constructors", "title": "Use the same lens with multiple data constructors", "body": "<p>Suppose I have a type like this:</p>\n\n<pre><code>data Stock = Stock {\n               _stockSymbol :: String,\n               _stockFairValue :: Float,\n               _stockBuyAt :: Float,\n               _stockCurrentPrice :: Float\n             } |\n             Etf {\n               _etfSymbol :: String,\n               _etfFairValue :: Float,\n               _etfBuyAt :: Float,\n               _etfCurrentPrice :: Float\n             } deriving (Eq)\n</code></pre>\n\n<p><code>Stock</code> and <code>Etf</code> both have the same fields. Now I want to access the symbol for one of them:</p>\n\n<pre><code>item ^. symbol -- don't care if stock or etf\n</code></pre>\n\n<p>I can do this with a typeclass, but I'm wondering if the lens package can build this lens for my automatically? I have looked at the <code>makeFields</code> function, but it seems that works if I have the constructors defined separately:</p>\n\n<pre><code>data Stock = Stock { ... }\ndata Etf   = Etf { ... }\n</code></pre>\n\n<p>Is there any way to do this while keeping them under the same type?</p>\n\n<p>Edit: This works:</p>\n\n<pre><code>makeLensesFor [(\"_stockSymbol\", \"symbol\"),\n               (\"_etfSymbol\", \"symbol\"),\n               (\"_stockFairValue\", \"fairValue\"),\n               (\"_etfFairValue\", \"fairValue\"),\n               (\"_stockBuyAt\", \"buyAt\"),\n               (\"_etfBuyAt\", \"buyAt\"),\n               (\"_stockCurrentPrice\", \"currentPrice\"),\n               (\"_etfCurrentPrice\", \"currentPrice\")\n               ] ''Stock\n</code></pre>\n\n<p>Not sure if there's a built-in way where I don't have to write the fields out.</p>\n"}, {"tags": ["r", "haskell"], "comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 1, "creation_date": 1427488136, "post_id": 29309296, "comment_id": 46813125, "body": "<code>let m = 7 in map(\\i -&gt;  (map (\\ j -&gt; (mod (i^2) m == j)) [0..m-1]))[0..m-1]</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1427489139, "post_id": 29309296, "comment_id": 46813623, "body": "Snarky answer: <code>type Matrix i a = i -&gt; i -&gt; a; zn_func :: Num a =&gt; a -&gt; (i -&gt; a) -&gt; Matrix i Bool; zn_func n f = \\row col -&gt; ((==) `on` (`mod` n)) row (f col)</code> But to give a real answer, you should write some code of your own and tell us what&#39;s bad about it."}], "answers": [{"tags": [], "owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "is_accepted": false, "score": 3, "last_activity_date": 1427490863, "creation_date": 1427490863, "answer_id": 29310299, "question_id": 29309296, "link": "https://stackoverflow.com/questions/29309296/f-z-z-n-in-r-and-haskell/29310299#29310299", "title": "f: Z -&gt; Z_n in R and haskell", "body": "<p>Here is what I did after some discussion on #haskell irc channel:</p>\n\n<pre><code>import Numeric.LinearAlgebra\nznFunc n f = res where\n  res_raw = [[if f i `rem` n == j then 1 else 0 | j &lt;- [0 .. (n-1)]] | i &lt;- [0 .. (n-1)]]\n  res = fromRows $ map fromList res_raw\n</code></pre>\n\n<p>Testing:</p>\n\n<pre><code>&gt; znFunc 7 (^2)\n(7&gt;&lt;7)\n [ 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0\n , 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0\n , 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0\n , 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0\n , 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0\n , 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0\n , 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0 ]\n</code></pre>\n\n<p>Results are the same as in R. The printing is not as pretty as in R, but at this point i don't know how to improve on it.</p>\n"}], "owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427490863, "creation_date": 1427486622, "last_edit_date": 1427489104, "question_id": 29309296, "link": "https://stackoverflow.com/questions/29309296/f-z-z-n-in-r-and-haskell", "title": "f: Z -&gt; Z_n in R and haskell", "body": "<p>Is there a straight-forward way to translate the following R code into haskell?</p>\n\n<p>For any function f:Z -> Z_n (Z for the set of integers, Z_n for the set {0, 1, 2, ..., (n-1)}, f(i) = j if and only if f(i) is congruent with j mod n, i.e. f(i) has the same remainder as j when divided by n. </p>\n\n<p>The following R code tries to make an n by n matrix M, so that when f(i) = j, \nM(i,j) = 1, otherwise M(i,j) = 0.</p>\n\n<pre><code># visualize functions in Z_n\nzn_func = function(n, f) {\n    n1 = n - 1\n    # make a single column matrix with elements {f(0), f(1), f(2), ... f(n-1)}\n    x = matrix(f(0:n1), ncol = 1)\n    # repeat this column n times\n    x = x[, rep(1, n)]\n    # set row and col names\n    rownames(x) = colnames(x) = 0:n1\n    # get f(x) mod n\n    y = x %% n\n    # make a single row matrix with elements {0, 1, 2, 3, ..., n-1}\n    rs = matrix(0:n1, nrow = 1)\n    # repeat that row n times\n    rs = rs[rep(1, n), ]\n    rownames(rs) = colnames(rs) = 0:n1\n    # determine if y[i, j] == rs[i, j]\n    # z is a matrix of type bool\n    z = y == rs\n    # z + 0 converts z into a matrix of type integer\n    # FALSE -&gt; 0, TRUE -&gt; 1\n    z=z+0\n    list(x=x, y=y, z=z)\n}\nf = function(x) x^2\nzn_func(7, f)\n</code></pre>\n\n<p>See it in action:</p>\n\n<pre><code>&gt; zn_func(7, f)\n$x\n   0  1  2  3  4  5  6\n0  0  0  0  0  0  0  0\n1  1  1  1  1  1  1  1\n2  4  4  4  4  4  4  4\n3  9  9  9  9  9  9  9\n4 16 16 16 16 16 16 16\n5 25 25 25 25 25 25 25\n6 36 36 36 36 36 36 36\n\n$y\n  0 1 2 3 4 5 6\n0 0 0 0 0 0 0 0\n1 1 1 1 1 1 1 1\n2 4 4 4 4 4 4 4\n3 2 2 2 2 2 2 2\n4 2 2 2 2 2 2 2\n5 4 4 4 4 4 4 4\n6 1 1 1 1 1 1 1\n\n$z\n  0 1 2 3 4 5 6\n0 1 0 0 0 0 0 0\n1 0 1 0 0 0 0 0\n2 0 0 0 0 1 0 0\n3 0 0 1 0 0 0 0\n4 0 0 1 0 0 0 0\n5 0 0 0 0 1 0 0\n6 0 1 0 0 0 0 0\n</code></pre>\n\n<p>The <code>$z</code> part is what we are after. In this case, it says that in Z_7, under f(x) = x^2, f(6) = 1, f(4) = f(3) = 2, f(2) = 4, etc. </p>\n\n<p>I have tried the hmatrix library, but it won't even allow a matrix of integers. It's doable with list of lists, but I prefer to use an existing library made ready for matrix operations.</p>\n"}, {"tags": ["haskell"], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1427483503, "creation_date": 1427483503, "question_id": 29308466, "link": "https://stackoverflow.com/questions/29308466/simple-graphs-without-parallel-edges-in-fgl", "title": "Simple graphs (without parallel edges) in fgl?", "body": "<p>Are there any provisions in <a href=\"http://hackage.haskell.org/package/fgl\" rel=\"nofollow\">http://hackage.haskell.org/package/fgl</a> for handling simple graphs (i.e., no parallel edges)? At the moment, we get</p>\n\n<pre><code>import Data.Graph.Inductive\nmkGraph [(1,()),(2,())] [(1,2,()),(1,2,())] :: Gr () ()\n\n==&gt;  mkGraph [(1,()),(2,())] [(1,2,()),(1,2,())]\n</code></pre>\n\n<p>containing two edges from 1 to 2. Indeed for this graph,</p>\n\n<pre><code>suc g 1  ==&gt;  [2,2]\n</code></pre>\n\n<p>Just to show that I've done some research: the official documentation <a href=\"http://web.engr.oregonstate.edu/~erwig/fgl/haskell/old/fgl0103.pdf\" rel=\"nofollow\">http://web.engr.oregonstate.edu/~erwig/fgl/haskell/old/fgl0103.pdf</a> (paper linked from original web page) states in Section 2.1 \"we define one type for directed, node-labelled, edge-labelled multi-graphs; other graph types can be obtained as special cases\" but then am seeing just the trivial specialisation (no label = label ()), but nothing on simple graphs.</p>\n\n<p>For simple graphs, the type of <code>Adj b</code>, which occurs in <code>Context a b</code>, should perhaps be <code>Set (b,Node)</code> instead of <code>[(b,Node)]</code> as it is now.\n(Or even <code>Map b (Set Node)</code>, or <code>Map Node (Set b)</code> ...)</p>\n\n<p>Somewhat related: is there a method that allows to check for the presence of an edge, or give me the set of edges from one node <code>p</code> to another node <code>q</code>? At the moment it seems I have to find <code>q</code> by walking through <code>suc g p</code>. And that's a list, which worries me even more. What if my graph has nodes with large degree?</p>\n"}, {"tags": ["algorithm", "haskell", "functional-programming", "imperative"], "answers": [{"tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": false, "score": 0, "last_activity_date": 1427480971, "last_edit_date": 1427480971, "creation_date": 1427479827, "answer_id": 29307454, "question_id": 29306972, "link": "https://stackoverflow.com/questions/29306972/transferring-an-imperative-for-loop-into-idiomatic-haskell/29307454#29307454", "title": "transferring an imperative for-loop into idiomatic haskell", "body": "<p>Loops can usually be expressed using different <code>fold</code> functions. Here is a solution which uses <code>foldl</code>(you can switch to <code>foldl'</code> if you run into a stackoverflow error):</p>\n\n<pre><code>f :: (Num a) =&gt; (b -&gt; Bool) -&gt; a -&gt; [b] -&gt; [a]\nf pred startVal = reverse . fst . foldl step ([], startVal)\n    where            \n        step (xs, curVal) x \n            | pred x = (curVal:xs, curVal + 1)\n            | otherwise = (0:xs, curVal)\n</code></pre>\n\n<p>How to use it? This function takes a predicate (<code>someCondition</code> in your code), the initial value of an index and a list of element to iterate over. That is, you can call <code>f someCondition 1 [0..255]</code> to obtain the result for the example from your question.</p>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 3, "last_activity_date": 1427481873, "last_edit_date": 1427481873, "creation_date": 1427480250, "answer_id": 29307544, "question_id": 29306972, "link": "https://stackoverflow.com/questions/29306972/transferring-an-imperative-for-loop-into-idiomatic-haskell/29307544#29307544", "title": "transferring an imperative for-loop into idiomatic haskell", "body": "<p>There are several ways to approach this problem depending on what data structure you want to use.  The simplest one would probably be with lists and the basic functions available in <code>Prelude</code>:</p>\n\n<pre><code>a = go 1 [] [0..255]\n    where\n        go idx out [] = out\n        go idx out (i:is) =\n            if condition i\n                then go (idx + 1) (out ++ [idx]) is\n                else go idx (out ++ [0]) is\n</code></pre>\n\n<p>This uses the worker pattern with two accumulators, <code>idx</code> and <code>out</code>, and it traverses down the last parameter until no more elements are left, then returns <code>out</code>.  This could certainly be converted into a <code>fold</code> of some sort, but in any case it won't be very efficient, appending items to a list with <code>++</code> is very inefficient.  You could make it better by using <code>idx : out</code> and <code>0 : out</code>, then using <code>reverse</code> on the output of <code>go</code>, but it still isn't an ideal solution.</p>\n\n<p>Another solution might be to use the <code>State</code> monad:</p>\n\n<pre><code>a = flip runState 1 $ forM [0..255] $ \\i -&gt; do\n        idx &lt;- get\n        if condition i\n            then do\n                put $ idx + 1    -- idx++\n                return idx       -- A[i] = idx\n            else return 0\n</code></pre>\n\n<p>Which certainly looks a lot more imperative.  The <code>1</code> in <code>flip runState 1</code> is indicating that your initial state is <code>idx = 1</code>, then you use <code>forM</code> (which looks like a for loop but really isn't) over <code>[0..255]</code>, the loop variable is <code>i</code>, and then it's just a matter of implementing the rest of the logic.</p>\n\n<p>If you want to go a lot more advanced you could use the <code>StateT</code> and <code>ST</code> monads to have an actual mutable array with a state at the same time.  The explanation of how this works is far beyond the scope of this answer, though:</p>\n\n<pre><code>import Control.Monad.State\nimport Control.Monad.ST\nimport qualified Data.Vector as V\nimport qualified Data.Vector.Mutable as MV\n\n\na :: V.Vector Int\na = runST $ (V.freeze =&lt;&lt;) $ flip evalStateT (1 :: Int) $ do\n    a' &lt;- lift $ MV.new 256\n    lift $ MV.set a' 0\n    forM_ [0..255] $ \\i -&gt; do\n        when (condition i) $ do\n            idx &lt;- get\n            lift $ MV.write a' i idx\n            put $ idx + 1\n    return a'\n</code></pre>\n\n<p>I simplified it a bit so that each element is set to <code>0</code> from the start, we begin with an initial state of <code>idx = 1</code>, loop over <code>[0..255]</code>, if the current index <code>i</code> meets the condition then get the current <code>idx</code>, write it to the current index, then increment <code>idx</code>.  Run this as a stateful operation, then freeze the vector, and finally run the <code>ST</code> monad side of things.  This allows for an actual mutable vector hidden safely within the <code>ST</code> monad so that the outside world doesn't know that to calculate <code>a</code> you have to do some rather strange things.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1427480404, "creation_date": 1427480404, "answer_id": 29307584, "question_id": 29306972, "link": "https://stackoverflow.com/questions/29306972/transferring-an-imperative-for-loop-into-idiomatic-haskell/29307584#29307584", "title": "transferring an imperative for-loop into idiomatic haskell", "body": "<p>Explicit recursion:</p>\n\n<pre><code>a = go 0 1\n  where go 256 _   = []\n        go i   idx | someCondition i = idx : go (i+1) (idx+1)\n                   | otherwise       = 0   : go (i+1) idx\n</code></pre>\n\n<p>Unfolding: (variant of the explicit recursion above)</p>\n\n<pre><code>a = unfoldr f (0,1)\n    where f (256,_) = Nothing\n          f (i,idx) | someCondition i = Just (idx,(i+1,idx+1))\n                    | otherwise       = Just (0  ,(i+1,idx  ))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1143, "user_id": 1233615, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b941941886b3fdc1e8a3596ff5cd3f0a?s=128&d=identicon&r=PG", "display_name": "fuji", "link": "https://stackoverflow.com/users/1233615/fuji"}, "edited": false, "score": 0, "creation_date": 1427503535, "post_id": 29307678, "comment_id": 46818184, "body": "Really good answer. I was not aware of the state monad up to this point. Thank you very much!"}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 8, "last_activity_date": 1427482221, "last_edit_date": 1427482221, "creation_date": 1427480721, "answer_id": 29307678, "question_id": 29306972, "link": "https://stackoverflow.com/questions/29306972/transferring-an-imperative-for-loop-into-idiomatic-haskell/29307678#29307678", "title": "transferring an imperative for-loop into idiomatic haskell", "body": "<p>One of the core ideas in functional programming is to express algorithms as <strong>data transformations</strong>. In a lazy language like Haskell, we can even go a step further and think of lazy data structures as reified computations. In a very real sense, Haskell's lists are more like loops than normal linked lists: they can be calculated incrementally and don't have to exist in memory all at once. At the same time, we still get many of the advantages of having a data type like that ability to pass it around and inspect it with pattern matching.</p>\n\n<p>With this in mind, the \"trick\" for expressing a for-loop with an index is to create a list of all the values it can take. Your example is probably the simplest case: <code>i</code> takes all the values from <code>0</code> to <code>255</code>, so we can use Haskell's built-in notation for ranges:</p>\n\n<pre><code>[0..255]\n</code></pre>\n\n<p>At a high level, this is Haskell's equivalent of <code>for (i = 0 to 255)</code>; we can then execute the actual logic in the loop by traversing this list either by a recursive function or a higher-order function from the standard library. (The second option is highly preferred.)</p>\n\n<p>This particular logic is a good fit for a <code>fold</code>. A fold lets us take in a list item by item and build up a result of some sort. At each step, we get a list item and the value of our built-up result so far. In this particular case, we want to process the list from left to right while incrementing an index, so we can use <code>foldl</code>; the one tricky part is that it will produce the list backwards.</p>\n\n<p>Here's the type of <code>foldl</code>:</p>\n\n<pre><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>So our function takes in our intermediate value and a list element and produces an updated intermediate value. Since we're constructing a list and keeping track of an index, our intermediate value will be a pair that contains both. Then, once we have the final result, we can ignore the <code>idx</code> value and reverse the final list we get:</p>\n\n<pre><code>a = let (result, _) = foldl step ([], 1) [0..255] in reverse result\n  where step (a, idx) i\n          | someCondition i = (idx:a, idx + 1)\n          | otherwise       = (0:a, idx)\n</code></pre>\n\n<p>In fact, the pattern of transforming a list while keeping track of some intermediate state (<code>idx</code> in this case) is common enough so that it has a function of its own in terms of the <code>State</code> type. The core abstraction is a bit more involved (read through [\"You Could Have Invented Monads\"][you] for a great introduction), but the resulting code is actually quite pleasant to read (except for the imports, I guess :P):</p>\n\n<pre><code>import Control.Applicative\nimport Control.Monad \nimport Control.Monad.State\n\na = evalState (mapM step [0..255]) 1\n  where step i\n          | someCondition i = get &lt;* modify (+ 1)\n          | otherwise       = return 0\n</code></pre>\n\n<p>The idea is that we map over <code>[0..255]</code> while keeping track of some state (the value of <code>idx</code>) in the background. <code>evalState</code> is how we put all the plumbing together and just get our final result. The <code>step</code> function is applied to each input list element and can also access or modify the state.</p>\n\n<p>The first case of the <code>step</code> function is interesting. The <code>&lt;*</code> operator tells it to do the thing on the left first, the thing on the right second <em>but return the value on the left</em>. This lets us get the current state, increment it but still return the value we got <em>before</em> it was incremented. The fact that our notion of state is a first-class entity and we can have library functions like <code>&lt;*</code> is very powerful\u2014I've found this particular idiom really useful for traversing trees, and other similar idioms have been quite useful for other code.</p>\n"}], "owner": {"reputation": 1143, "user_id": 1233615, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b941941886b3fdc1e8a3596ff5cd3f0a?s=128&d=identicon&r=PG", "display_name": "fuji", "link": "https://stackoverflow.com/users/1233615/fuji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 2, "accepted_answer_id": 29307678, "answer_count": 4, "score": 8, "last_activity_date": 1504451439, "creation_date": 1427478357, "last_edit_date": 1504451439, "question_id": 29306972, "link": "https://stackoverflow.com/questions/29306972/transferring-an-imperative-for-loop-into-idiomatic-haskell", "title": "transferring an imperative for-loop into idiomatic haskell", "body": "<p>I have some difficulties to transfer imperative algorithms into a functional style. The main concept that I cannot wrap my head around is how to fill sequences with values according to their position in the sequence. How would an idiomatic solution for the following algorithm look in Haskell?</p>\n\n<pre><code>A = unsigned char[256]\nidx &lt;- 1\nfor(i = 0 to 255)\n    if (some_condition(i))\n        A[i] &lt;- idx\n        idx++\n    else\n        A[i] = 0;\n</code></pre>\n\n<p>The algorithm basically creates a lookup table for the mapping function of a histogram. </p>\n\n<p>Do you know any resources which would help me to understand this kind of problem better?</p>\n"}]