[{"tags": ["haskell", "depth-first-search"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 3, "last_activity_date": 1525316208, "creation_date": 1525316208, "answer_id": 50146262, "question_id": 50145045, "link": "https://stackoverflow.com/questions/50145045/generic-depth-first-search-algorithm-with-set/50146262#50146262", "title": "Generic Depth First Search algorithm with Set", "body": "<p>You can write <code>dfs2</code> in terms of a set of visited nodes coming from the left and the remainder of the results coming from the right.</p>\n\n<p>My head is stuck in folds this week, so first I'm going to define the idea of a fold that operates on both strict left-associated values coming from the left and lazy right-associated values coming from the right; it'd probably be more illustrative to you to write out an explicit version of <code>dfs2</code>.</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nfoldboth :: ((l, r) -&gt; a -&gt; (l, r)) -&gt; (l, r) -&gt; [a] -&gt; (l, r)\nfoldboth f = go\n  where\n    go (l, r) [] = (l, r)\n    go (l, r) (x:xs) = (l'', r'')\n      where\n        (l', r'') = f (l, r') x\n        (l'', r') = go (l', r) xs\n\nfoldboth' :: ((l, r) -&gt; a -&gt; (l, r)) -&gt; (l, r) -&gt; [a] -&gt; (l, r)\nfoldboth' f = foldboth f'\n  where\n    f' (!l, r) = f (l, r)\n</code></pre>\n\n<p>Depth first search can be defined by folding up the successors, skipping the ones that have already been visited and adding the unvisited ones both the the set traveling left-to-right and to the results traveling right to left.</p>\n\n<pre><code>dfs2 :: (Ord a) =&gt; (a -&gt; [a]) -&gt; a -&gt; [a]\ndfs2 succ start = snd $ go (Set.empty, []) [start] where\n  go = foldboth' step\n  step (visited, remaining) x = \n    if Set.member x visited\n    then (visited, remaining)\n    else (visited', x:remaining')\n      where\n        (visited', remaining') = go (Set.insert x visited, remaining) (succ x) \n</code></pre>\n\n<p>This gives the desired result</p>\n\n<pre><code>&gt; dfs2 f2 1\n[1,3,2,6,5,4]\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525321239, "creation_date": 1525304909, "question_id": 50145045, "link": "https://stackoverflow.com/questions/50145045/generic-depth-first-search-algorithm-with-set", "title": "Generic Depth First Search algorithm with Set", "body": "<p>I'm trying to implement a generic Depth First Search algorithm with the following type signature:</p>\n\n<pre><code>dfs :: (Ord a) =&gt; (a -&gt; [a]) -&gt; a -&gt; [a]\n</code></pre>\n\n<p><a href=\"https://qmaurmann.wordpress.com/2014/06/28/haskell-one-liners-for-search/\" rel=\"nofollow noreferrer\">I had a reference from this blog post</a>:</p>\n\n<pre><code>dfs2 :: (Ord a) =&gt; (a -&gt; Set a) -&gt; a -&gt; [a]\ndfs2 succ start = loop [start] (Set.singleton start) where\n    loop [] _ = []\n    loop (x:xs) visited = x : loop (Set.toList new ++ xs) (Set.union visited new)\n        where new = Set.difference (succ x) visited\n</code></pre>\n\n<p>It works that it does DFS, and only visit the same element once.</p>\n\n<pre><code>f 1 = Set.fromList [2, 3]\nf 2 = Set.fromList [3, 4, 5, 6]\nf _ = Set.empty\n\nghci&gt; dfs2 f 1\n[1,2,4,5,6,3]\n</code></pre>\n\n<p>But since <code>dfs2</code> takes <code>f :: (a -&gt; Set a)</code> which returns a <code>Set a</code> rather than a <code>[a]</code>, I can't specify the order of the elements to visit.</p>\n\n<p>For example, if <code>f2</code> is defined like this:</p>\n\n<pre><code>f2 1 = Set.fromList [3, 2]\nf2 2 = Set.fromList [6, 5, 4, 3]\nf2 _ = Set.empty\n</code></pre>\n\n<p>It would return the same result</p>\n\n<pre><code>ghci&gt; dfs2 f2 1\n[1,2,4,5,6,3]\n</code></pre>\n\n<p>But what I want is <code>[1,3,2,6,5,4]</code></p>\n\n<p>I can't figure out how to make changes to dfs2 to implement with the type signature</p>\n\n<pre><code>dfs :: (Ord a) =&gt; (a -&gt; [a]) -&gt; a -&gt; [a]\n</code></pre>\n\n<p>such that, dfs would visit each element only once in the order that is specified by <code>[a]</code>. And </p>\n\n<pre><code>dfs f2 1 == [1,3,2,6,5,4]\n</code></pre>\n\n<p>Does anyone have some idea?</p>\n"}, {"tags": ["list", "haskell", "wolfram-mathematica", "infinite"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1525308066, "post_id": 50144990, "comment_id": 87308864, "body": "This is slightly off the (literal) main topic here, but you might also be interested in <a href=\"https://www.youtube.com/watch?v=LJQgYBQFtSE\" rel=\"nofollow noreferrer\">this talk</a> about implementing exact real (computable) number arithmetic in Haskell using a continued fraction representation (as well as another technique)."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 5, "last_activity_date": 1525304999, "creation_date": 1525304999, "answer_id": 50145057, "question_id": 50144990, "link": "https://stackoverflow.com/questions/50144990/how-to-implement-an-eventually-repeating-list-in-haskell/50145057#50145057", "title": "How to implement an eventually repeating list in Haskell?", "body": "<p>Why not just prepend something to the result of <code>cycle</code>?</p>\n\n<pre><code>3 : cycle [1, 4, 2, 8, 5, 7]\n</code></pre>\n\n<p>Whereas a \u201ccircular\u201d\u00a0linked list is one where the tail points back to the head, this is a linked list with a cycle that points into the middle of the list, like so:</p>\n\n<pre><code>let x = [1, 4, 2, 8, 5, 7] ++ x in 3 : x\n3 : (let x = 1 : 4 : 2 : 8 : 5 : 7 : x in x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1525366532, "creation_date": 1525366532, "answer_id": 50160270, "question_id": 50144990, "link": "https://stackoverflow.com/questions/50144990/how-to-implement-an-eventually-repeating-list-in-haskell/50160270#50160270", "title": "How to implement an eventually repeating list in Haskell?", "body": "<p>This is a more general function. It will take any real number from any function.\nThis, of course, only does two parts.\nI'm sure you can do better. This is just a starter. I use show to process the number as a string because Haskell is so picky about mixing floating/non-floating types. </p>\n\n<pre><code>c2l d = splitAt 1 [read [u] :: Int| u&lt;-(tail.tail.show $ d/10)]\n</code></pre>\n\n<p>Execute as</p>\n\n<pre><code>c2l (22/7)\n</code></pre>\n\n<p>([3],[1,4,2,8,5,7,1,4,2,8,5,7,1,4,3])</p>\n\n<p>Or</p>\n\n<pre><code>c2l (sqrt 13)\n</code></pre>\n\n<p>([3],[6,0,5,5,5,1,2,7,5,4,6,3,9,8,9])</p>\n\n<p>Also the Haskell Math library is most wonderful. There is Computer Algebra, fix points, set theory, analysis, linear algebra (!) and abstract algebra. </p>\n\n<p>Take the <code>splitAt 1</code> out to have just a linear list. </p>\n"}], "owner": {"reputation": 131, "user_id": 2702192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f06f62f1da64c3f7595541f6d7d3211?s=128&d=identicon&r=PG", "display_name": "pdmclean", "link": "https://stackoverflow.com/users/2702192/pdmclean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1525366532, "creation_date": 1525304457, "last_edit_date": 1525304890, "question_id": 50144990, "link": "https://stackoverflow.com/questions/50144990/how-to-implement-an-eventually-repeating-list-in-haskell", "title": "How to implement an eventually repeating list in Haskell?", "body": "<p>I can see how <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:cycle\" rel=\"nofollow noreferrer\">cycle</a> can be used to implement a repeating list (eg [0,9,0,9,...], the decimal expansion of 10/11), but how could one implement one that has some initial elements before it settles down to a repeating pattern (eg [3,1,4,2,8,5,7,1,4,2,8,5,7,...], the decimal expansion of 22/7)? I'd like such a structure to work well with fold etc.</p>\n\n<p>My specific interest is representing decimals and continued fractions where the list just contains digits or numbers, respectively, but also lists with more general types are of interest eg pairs of numbers. </p>\n\n<p>Mathematica implements recurring fractions (<a href=\"http://reference.wolfram.com/language/ref/RealDigits.html?q=RealDigits\" rel=\"nofollow noreferrer\">RealDigits</a> and <a href=\"http://reference.wolfram.com/language/ref/FromDigits.html\" rel=\"nofollow noreferrer\">FromDigits</a>) and recurring continued fractions (<a href=\"http://reference.wolfram.com/language/ref/ContinuedFraction.html\" rel=\"nofollow noreferrer\">ContinuedFraction</a> and <a href=\"http://reference.wolfram.com/language/ref/FromContinuedFraction.html\" rel=\"nofollow noreferrer\">FromContinuedFraction</a>):</p>\n\n<pre><code>ContinuedFraction[Sqrt[13]] = {3,{1,1,1,1,6}}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>RealDigits[22/7] = {{3,{1,2,8,5,7}},1}\n</code></pre>\n\n<p>A similar question is here: <a href=\"https://mathematica.stackexchange.com/questions/21998/building-a-continued-fraction\">https://mathematica.stackexchange.com/questions/21998/building-a-continued-fraction</a> but the results seem very adhoc and I'm hoping for something more clean in Haskell.</p>\n"}, {"tags": ["haskell", "tuples", "record", "esqueleto"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525298157, "post_id": 50143910, "comment_id": 87306467, "body": "Can&#39;t we here perform an <code>fmap</code>?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1525298562, "post_id": 50143910, "comment_id": 87306601, "body": "I think you might have to instantiate <a href=\"https://hackage.haskell.org/package/esqueleto-2.5.3/docs/Database-Esqueleto-Internal-Sql.html#t:SqlSelect\" rel=\"nofollow noreferrer\">SqlSelect</a>. I&#39;d maybe look at the way the tuple instances are defined and go from there."}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525298592, "post_id": 50143910, "comment_id": 87306612, "body": "@WillemVanOnsem I am asking of a way to specifically return custom records directly. Without the inefficiency of going tuple and then to the custom type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525298689, "post_id": 50143910, "comment_id": 87306642, "body": "Yeah, but I was thinking something like <code>Custom &lt;$&gt; (li ^. LogItemTitle) &lt;*&gt; (li ^. LogItemId)</code>. But right now I can not test it :("}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525299332, "post_id": 50143910, "comment_id": 87306867, "body": "@WillemVanOnsem I don&#39;t think lifting it will be enough. <code>select :: (SqlSelect a r, MonadIO m) =&gt; SqlQuery a -&gt; SqlReadT m [r]</code>, from what I can tell there&#39;s an actual translation from the return type <code>a</code> to an SQL expression to the final type <code>r</code>."}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525299672, "post_id": 50143910, "comment_id": 87306976, "body": "@WillemVanOnsem I tried your example and it is also not working. See last update."}], "answers": [{"tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": false, "score": 2, "last_activity_date": 1525305591, "creation_date": 1525305591, "answer_id": 50145127, "question_id": 50143910, "link": "https://stackoverflow.com/questions/50143910/haskell-esqueleto-project-subset-of-columns-to-list-of-custom-records/50145127#50145127", "title": "Haskell Esqueleto project subset of columns to list of custom records", "body": "<p>What esqueleto is actually doing here is a little complicated. Here is the type for <code>select</code>:</p>\n\n<pre><code>select :: (SqlSelect a r, MonadIO m) =&gt; SqlQuery a -&gt; SqlReadT m [r]\n</code></pre>\n\n<p>This takes an <code>SqlQuery a</code> (a monad wrapping the value you <code>return</code>), and returns an <code>SqlReadT m [r]</code> (a monad wrapping a list of results). When you <code>return</code> your <code>Custom</code> type, the following happens:</p>\n\n<ol>\n<li>esqueleto converts your <code>a</code> type to persistent's internal SQL representation</li>\n<li>persistent executes the query and gets back a results list</li>\n<li>esqueleto converts the results list from persistent's internal SQL representation to <code>[r]</code></li>\n</ol>\n\n<hr>\n\n<p>To make this work for custom types, you'll need to instantiate <a href=\"https://hackage.haskell.org/package/esqueleto-2.5.3/docs/Database-Esqueleto-Internal-Sql.html#t:SqlSelect\" rel=\"nofollow noreferrer\">SqlSelect</a>, and define conversion functions to and from the persistent types:</p>\n\n<pre><code>data Custom' = Custom' (Value Text) (Value Int)\n\ndata Custom = Custom\n  { title :: Text\n  , id    :: Int\n  }\n\ninstance SqlSelect Custom' Custom where\n  sqlSelectCols esc (Custom' a b) = (mconcat [ta, \", \", tb], va ++ vb)\n    where\n      (ta, va) = sqlSelectCols esc a\n      (tb, vb) = sqlSelectCols esc b\n  sqlSelectColCount _ = 2\n  sqlSelectProcessRow [PersistText a, PersistInt64 b] = Right $ Custom a b\n  sqlSelectProcessRow _ = Left \"Error: Incorrect rows to translate to Custom\"\n</code></pre>\n\n<p>(note that I wasn't actually able to test any of the above, so it might have bugs)</p>\n\n<p>One thing to note is that in the above example, the <code>a</code> and <code>r</code> types are not the same (<code>Custom'</code> vs <code>Custom</code>). This is because inside of a <code>select</code>, all of the values you're working with are of type <code>Value</code>, not their actual types.</p>\n"}], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1525305591, "creation_date": 1525297048, "last_edit_date": 1525299650, "question_id": 50143910, "link": "https://stackoverflow.com/questions/50143910/haskell-esqueleto-project-subset-of-columns-to-list-of-custom-records", "title": "Haskell Esqueleto project subset of columns to list of custom records", "body": "<p>In all the examples I have seen the results from <a href=\"https://github.com/bitemyapp/esqueleto/blob/master/test/Common/Test.hs\" rel=\"nofollow noreferrer\">esqueleto</a> are projected into a list of tuples or to <a href=\"https://stackoverflow.com/a/50143591/750216\">entities records</a>.</p>\n\n<p>For example:</p>\n\n<pre><code>previousLogItems &lt;- select $ from $ \\li -&gt; do\n        orderBy [desc (li ^. LogItemId)]\n        limit 10\n        return (li ^. LogItemId, li ^. LogItemTitle)\n</code></pre>\n\n<p>Is there any way in esqueleto to project a subset of the columns to custom  records (different than the entity) instead of tuples? This being done without an extra projection from tuples to custom records.</p>\n\n<p>As an example, let's say that it would be inefficient to get all the data from the database so we only want to project columns WindowTitle and BeginTime from the database into a custom record with adequate names for those columns.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Example of not working code:</p>\n\n<pre><code>data Custom = Custom\n  { title :: Text\n  , id    :: Int\n  } deriving (Eq, Show, Generic)\n\ndaily :: Servant.Handler [Custom]\ndaily = do\n  lis &lt;- liftIO $ runDB $\n            select $ from $ \\li -&gt; do\n                    orderBy [desc (li ^. LogItemId)]\n                    limit 25\n                    return (Custom (li ^. LogItemTitle) (li ^. LogItemId))\n  return lis\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Text\u2019\n              with actual type \u2018SqlExpr (Database.Esqueleto.Value Text)\u2019\n\u2022 In the first argument of \u2018Custom\u2019, namely \u2018(li ^. LogItemTitle)\u2019\n  In the first argument of \u2018return\u2019, namely\n    \u2018(Custom (li ^. LogItemTitle) (li ^. LogItemId))\u2019\n  In a stmt of a 'do' block:\n    return (Custom (li ^. LogItemTitle) (li ^. LogItemId))\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Example of not working code:</p>\n\n<pre><code>daily :: Servant.Handler [Custom]\ndaily = do\n  lis &lt;- liftIO $ runDB $\n            select $ from $ \\li -&gt; do\n                    orderBy [desc (li ^. LogItemId)]\n                    limit 25\n                    return (Custom &lt;$&gt; (li ^. LogItemTitle) &lt;*&gt; (li ^. LogItemId))\n  return lis\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018Database.Esqueleto.Value Text\u2019 with \u2018Text\u2019\n  Expected type: SqlExpr Text\n    Actual type: SqlExpr (Database.Esqueleto.Value Text)\n\u2022 In the second argument of \u2018(&lt;$&gt;)\u2019, namely \u2018(li ^. LogItemTitle)\u2019\n  In the first argument of \u2018(&lt;*&gt;)\u2019, namely\n    \u2018Custom &lt;$&gt; (li ^. LogItemTitle)\u2019\n  In the first argument of \u2018return\u2019, namely\n    \u2018(Custom &lt;$&gt; (li ^. LogItemTitle) &lt;*&gt; (li ^. LogItemId))\u2019\n\n\n\u2022 Couldn't match type \u2018Database.Esqueleto.Value (Key LogItem)\u2019\n                 with \u2018Int\u2019\n  Expected type: SqlExpr Int\n    Actual type: SqlExpr (Database.Esqueleto.Value (Key LogItem))\n\u2022 In the second argument of \u2018(&lt;*&gt;)\u2019, namely \u2018(li ^. LogItemId)\u2019\n  In the first argument of \u2018return\u2019, namely\n    \u2018(Custom &lt;$&gt; (li ^. LogItemTitle) &lt;*&gt; (li ^. LogItemId))\u2019\n  In a stmt of a 'do' block:\n    return (Custom &lt;$&gt; (li ^. LogItemTitle) &lt;*&gt; (li ^. LogItemId))\n</code></pre>\n"}, {"tags": ["haskell", "tuples", "record", "esqueleto"], "answers": [{"comments": [{"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1525296551, "post_id": 50143591, "comment_id": 87305840, "body": "I asked the wrong question. I&#39;ll create another one regarding projections. Thank you very much, this is great answer"}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1525297128, "post_id": 50143591, "comment_id": 87306102, "body": "This is what I wanted to ask, if you happen to know a solution: <a href=\"https://stackoverflow.com/q/50143910/750216\">stackoverflow.com/q/50143910/750216</a>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1525296406, "last_edit_date": 1525296406, "creation_date": 1525295362, "answer_id": 50143591, "question_id": 50143475, "link": "https://stackoverflow.com/questions/50143475/haskell-esqueleto-project-to-list-of-records-instead-of-tuples/50143591#50143591", "title": "Haskell Esqueleto project to list of records instead of tuples", "body": "<p>In fact you construct the tuple yourself. Indeed:</p>\n\n<pre><code>previousLogItems &lt;- select $ from $ \\li -&gt; do\n        orderBy [desc (li ^. LogItemId)]\n        limit 10\n        return <b>(li ^. LogItemId, li ^. LogItemTitle)</b></code></pre>\n\n<p>You thus make use of the <a href=\"https://hackage.haskell.org/package/esqueleto-2.5.3/docs/Database-Esqueleto.html#v:-94-.\" rel=\"nofollow noreferrer\"><strong><code>(^.) :: (PersistEntity val, PersistField typ) =&gt; expr (Entity val) -&gt; EntityField val typ -&gt; expr (Value typ)</code></strong></a> \"selector\" to obtain the fields and wrap them into a tuple.</p>\n\n<p>If you write it like:</p>\n\n<pre><code>previousLogItems &gt;- select $ from $ \\li -&gt; do\n        orderBy [desc (li ^. LogItemId)]\n        limit 10\n        return <b>li</b></code></pre>\n\n<p>You will obtain a list of <code>[Entity Foo]</code> where <code>Foo</code> is the type of object you query.</p>\n\n<p>You can use the <a href=\"https://hackage.haskell.org/package/persistent-0.8.0.2/docs/Database-Persist.html#t:Entity\" rel=\"nofollow noreferrer\"><strong><code>entityVal :: Entity a -&gt; a</code></strong></a> to obtain the entity that is wrapped into the <code>Entity</code>, for example:</p>\n\n<pre><code>previousLogItems &lt;- select $ from $ \\li -&gt; do\n        orderBy [desc (li ^. LogItemId)]\n        limit 10\n        return li\n<b>mapM_ (print . entityVal) previousLogItems</b></code></pre>\n\n<p>given the entity is of course an instance of <code>Show</code>.</p>\n"}], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 50143591, "answer_count": 1, "score": 1, "last_activity_date": 1525296406, "creation_date": 1525294705, "question_id": 50143475, "link": "https://stackoverflow.com/questions/50143475/haskell-esqueleto-project-to-list-of-records-instead-of-tuples", "title": "Haskell Esqueleto project to list of records instead of tuples", "body": "<p>In all the examples I have seen the results from <a href=\"https://github.com/bitemyapp/esqueleto/blob/master/test/Common/Test.hs\" rel=\"nofollow noreferrer\">esqueleto</a> are projected into a list of tuples. This makes coding and maintenance harder because of lack of labels.</p>\n\n<p>For example:</p>\n\n<pre><code>previousLogItems &lt;- select $ from $ \\li -&gt; do\n        orderBy [desc (li ^. LogItemId)]\n        limit 10\n        return (li ^. LogItemId, li ^. LogItemTitle)\n</code></pre>\n\n<p>Is there any way to get esqueleto to project the results to a list of records instead?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 4, "creation_date": 1525289079, "post_id": 50141722, "comment_id": 87302359, "body": "@9000 This is not the standard <code>State</code>, this is <code>type State = Var -&gt; Val</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1525289227, "post_id": 50141722, "comment_id": 87302438, "body": "&quot;<i>Does that mean that a function that is of type State = Var-&gt;Val has to be defined somewhere</i>&quot; - All functions you use have to be defined somewhere regardless of their type."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1525290991, "post_id": 50142492, "comment_id": 87303329, "body": "Your answer is much better (and more concise) than mine! It might be worth showing what <code>state2</code> might look like"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1525293053, "post_id": 50142492, "comment_id": 87304338, "body": "@AdamSmith well, we shouldn&#39;t underestimate the imagination of the OP :) What is more interesting is that we could also have a &quot;undefined variables don&#39;t exist, they&#39;re just 0&quot; semantics."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 2, "last_activity_date": 1525293267, "last_edit_date": 1525293267, "creation_date": 1525290674, "answer_id": 50142492, "question_id": 50141722, "link": "https://stackoverflow.com/questions/50141722/haskell-functions-as-an-input-to-a-function/50142492#50142492", "title": "Haskell - functions as an input to a function", "body": "<p>You can think of the <code>State</code> type as an environment where you can look up variables. You can start with an \"empty\" environment like so:</p>\n\n<pre><code>emptyState v = error (\"variable \" ++ show v ++ \" is unknown\")\n</code></pre>\n\n<p>As far as I can see, the environment is updated every time the interpreter sees a</p>\n\n<pre><code>var := value\n</code></pre>\n\n<p>construct. That is, after</p>\n\n<pre><code>V 23 := 42\n</code></pre>\n\n<p>the state function that is used in subsequent statements will look like:</p>\n\n<pre><code>state1 v = if v == 23 then 42 else emptyState v\n</code></pre>\n\n<p>Interestingly, the set up of the <code>emptyState</code> function determines important semantic properties of the interpreted language. The <code>emptyState</code> above, for example, forbids undefined variables. But it would be as well possible to come up with a variant that treats all undefined variables as 0, or 1, or 42.</p>\n"}], "owner": {"reputation": 45, "user_id": 9731629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9e61704de0488355ef982c366c406f?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Braun", "link": "https://stackoverflow.com/users/9731629/peter-braun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 50142492, "answer_count": 1, "score": 2, "last_activity_date": 1525293267, "creation_date": 1525287583, "question_id": 50141722, "link": "https://stackoverflow.com/questions/50141722/haskell-functions-as-an-input-to-a-function", "title": "Haskell - functions as an input to a function", "body": "<p>I am looking at this code for a small step WHILE interpreter, and I am trying to understand how to run it. Specifically, I am confused about the State type. It seems to be a type of function - Does that mean that a function that is of type State = Var->Val has to be defined somewhere, and that function needs to be passed to the functions that require it?</p>\n\n<p>At the same time, I see that the state should be modifiable by variable assignments. How does the upd function work, if it is only passed in a function that is of type Var->Val?</p>\n\n<p>Thanks for your help! I can't seem to find anything about this on the tutorials or on stackoverflow.</p>\n\n<pre><code>type Var = Integer\ntype Val = Integer\ntype State = Var -&gt; Val\n\n\n--takes a var, returns a val. Here, we use an integer to describe a\n-- variable as opposed to a string.\nlkp :: Var -&gt; State -&gt; Val\nlkp x s = s x\n\nupd :: Var -&gt; Val -&gt; State -&gt; State\nupd x v s = \\y -&gt; if x == y then v else s y\n\ndata AExp = N Integer | V Var\n            | AExp :+ AExp | AExp :- AExp | AExp :* AExp\n   deriving (Show)\n\naexp :: AExp -&gt; State -&gt; Integer\naexp (N z) _ = z\naexp (V x) s = lkp x s\naexp (a0 :+ a1) s = aexp a0 s + aexp a1 s\naexp (a0 :- a1) s = aexp a0 s - aexp a1 s\naexp (a0 :* a1) s = aexp a0 s * aexp a1 s\n\ndata BExp = TT | FF | AExp :== AExp | AExp :&lt;= AExp\n            | Not BExp | BExp :&amp;&amp; BExp | BExp :|| BExp\n   deriving (Show)\n\nbexp :: BExp -&gt; State -&gt; Bool\nbexp TT _ = True\nbexp FF _ = False\nbexp (a0 :== a1) s = aexp a0 s == aexp a1 s\nbexp (a0 :&lt;= a1) s = aexp a0 s &lt;= aexp a1 s\nbexp (Not b) s = not (bexp b s)\nbexp (a0 :&amp;&amp; a1) s = bexp a0 s &amp;&amp; bexp a1 s\nbexp (a0 :|| a1) s = bexp a0 s || bexp a1 s\n\ndata Stmt = Skip | Stmt :\\ Stmt | Var := AExp\n            | If BExp Stmt Stmt | While BExp Stmt\n\ndata Trace = Nil State | Delay State Trace\n\n--reduces the statement by one step.\nred :: Stmt -&gt; State -&gt; Maybe (Stmt, State)\nred Skip s = Nothing\nred (x := a) s = Just (Skip, upd x v s) where v = aexp a s\nred (stmt0 :\\ stmt1) s =\n    case red stmt0 s of\n        Just (stmt0', s') -&gt; Just (stmt0' :\\ stmt1, s')\n        Nothing -&gt; red stmt1 s\nred (If b stmt0 stmt1) s =\n    if bexp b s then\n        Just (stmt0, s)\n    else Just (stmt1, s)\nred (While b stmt0) s =\n    if bexp b s then\n        Just (stmt0 :\\ While b stmt0, s)\n    else Just (Skip, s)\n\nnorm :: Stmt -&gt; State -&gt; Trace\nnorm stmt s =\n    case red stmt s of\n        Nothing -&gt; Nil s\n        Just (stmt', s') -&gt; Delay s (norm stmt' s')\n</code></pre>\n"}, {"tags": ["haskell", "partition"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1525286592, "post_id": 50141383, "comment_id": 87301159, "body": "If you partition the list, and then go through partitions, you&#39;re still going through the list twice."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1525286820, "post_id": 50141383, "comment_id": 87301269, "body": "If I run partition and get list a and b, can&#39;t I just fold a and concat with b? I wouldn&#39;t have to pattern match the B data again with the list"}], "answers": [{"comments": [{"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 1, "creation_date": 1525290591, "post_id": 50141546, "comment_id": 87303149, "body": "I&#39;ve accepted yours because it more closely aligned with what I was going for. What I also noted from reading other examples was the use case of pattern matching functions with partitioning. This helps for more complex &quot;simplifications&quot;, where I may need to call actions for multiple data types"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1525331490, "post_id": 50141546, "comment_id": 87315848, "body": "Perhaps you&#39;d want to lazy-pattern your second argument to <code>f</code>."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 3, "last_activity_date": 1525286977, "creation_date": 1525286977, "answer_id": 50141546, "question_id": 50141383, "link": "https://stackoverflow.com/questions/50141383/partition-list-based-on-data-constructor/50141546#50141546", "title": "Partition list based on data constructor", "body": "<p>This seems doable if you're okay with always having the <code>A</code> value ahead of the <code>B</code>s.</p>\n\n<pre><code>simplify :: [D] -&gt; [D]\nsimplify = uncurry (:) . foldr f (A 0, [])\n  where\n  f (A x) ((A n), acc) = (A (n+x),   acc)\n  f b     (a    , acc) = (a      , b:acc)\n</code></pre>\n\n<p>Though honestly I think the <code>uncurry (:)</code> is a mistake here, and your final type should be:</p>\n\n<pre><code>simplify :: [D] -&gt; (D, [D])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1525289407, "post_id": 50141616, "comment_id": 87302548, "body": "TIL about <code>mapAccumL</code>! Do you prefer this accumulator to one that carries <code>Just (B x)</code> or <code>Nothing</code>, then have <code>f</code> do <code>A acc : catMaybes ys</code>? (<code>f</code> then becomes <code>uncurry (:) . A *** catMaybes</code>)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525291856, "post_id": 50141616, "comment_id": 87303739, "body": "<code>acc `seq` acc+i</code> seems pointless -- are you sure you don&#39;t want instead <code>acc `seq` (acc+i, [])</code> ?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1525330877, "post_id": 50141616, "comment_id": 87315561, "body": "@AdamSmith yes, it&#39;s logical to expect <code>catMaybes</code> to be more efficient than <code>concat</code>. Lists <i>are</i> more versatile, though it&#39;s not needed in this case."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1525330676, "last_edit_date": 1525330676, "creation_date": 1525287234, "answer_id": 50141616, "question_id": 50141383, "link": "https://stackoverflow.com/questions/50141383/partition-list-based-on-data-constructor/50141616#50141616", "title": "Partition list based on data constructor", "body": "<p>You don't need partition for that, just a left fold:</p>\n\n<pre><code>import Data.List (mapAccumL)\n\nsimplify :: [D] -&gt; [D]\nsimplify = f . mapAccumL g 0 \n  where\n  g acc (A i) = acc `seq` (acc+i, [])\n  g acc b     = (acc,  [b])\n  f (acc, ys) = A acc : concat ys\n</code></pre>\n"}], "owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 50141546, "answer_count": 2, "score": 2, "last_activity_date": 1525330676, "creation_date": 1525286208, "question_id": 50141383, "link": "https://stackoverflow.com/questions/50141383/partition-list-based-on-data-constructor", "title": "Partition list based on data constructor", "body": "<p>Let's say I have the following:</p>\n\n<pre><code>data D = A Int | B Int deriving Show\n</code></pre>\n\n<p>and I have a function</p>\n\n<pre><code>simplify :: [D] -&gt; [D]\n</code></pre>\n\n<p>My goal is for simplify to create a new list where it will add up all values with data <code>A</code> (into a single value of data <code>A</code>) and keep the <code>B</code> data as is.</p>\n\n<p>As an example, <code>[A 1, A 2, A 3, B 1, A 4, B 2]</code> would become <code>[A 10, B 1, B 2]</code>.</p>\n\n<p>I know I can do it with foldl:</p>\n\n<pre><code>A (foldl (+) 0 [x | A x &lt;- ll]) : [B x | B x &lt;- ll]\n</code></pre>\n\n<p>But this involves going through the list twice looking for constructors.\nI was wondering if there was a way of using partition, where I could separate the list into those that have data <code>A</code> and those that do not.</p>\n"}, {"tags": ["haskell", "types", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1525284104, "post_id": 50139963, "comment_id": 87299977, "body": "You have <code>ScopedTypeVariables</code> enabled?"}], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 4, "last_activity_date": 1525289306, "creation_date": 1525289306, "answer_id": 50142139, "question_id": 50139963, "link": "https://stackoverflow.com/questions/50139963/monadreader-foo-m-m-results-in-infinite-type-from-functional-dependency/50142139#50142139", "title": "&quot;MonadReader (Foo m) m&quot; results in infinite type from functional dependency", "body": "<pre><code>runFoo :: MonadReader (Foo m) m =&gt; m ()\n</code></pre>\n\n<p>Let's forget about the class, and just assume that <code>MonadReader env mon</code> means that <code>mon ~ ((-&gt;) env)</code>. This corresponds to simply using <code>(-&gt;)</code> as our monad instead of the fancier <code>ReaderT</code>. Then you get <code>m ~ ((-&gt;) m) =&gt; m ()</code>. You see that <code>m</code> needs to contain itself (specifically, the argument to <code>m</code> is <code>m</code>). This is OK for values, but it would be quite bad if the typechecker had to deal with infinitely large types. The same is true for <code>ReaderT</code> (and you need to use <code>ReaderT</code> because you call <code>runReaderT runFoo</code>). You need to define another newtype to encode this recursion:</p>\n\n<pre><code>data RecReader c a = RecReader { runRecReader :: c (RecReader c) -&gt; a }\ninstance Functor (RecReader c) where\n  fmap f (RecReader r) = RecReader $ f . r\ninstance Applicative (RecReader c) where\n pure = RecReader . const\n RecReader f &lt;*&gt; RecReader g = RecReader $ \\e -&gt; f e (g e)\ninstance Monad (RecReader c) where\n  return = pure\n  RecReader x &gt;&gt;= f = RecReader $ \\e -&gt; runRecReader (f (x e)) e\ninstance MonadReader (c (RecReader c)) (RecReader c) where\n  ask = RecReader id\n  local f (RecReader x) = RecReader $ x . f\n</code></pre>\n\n<p>And it works:</p>\n\n<pre><code>runRecReader runFoo (Foo $ return ())\n-- ==&gt;\n()\n</code></pre>\n"}], "owner": {"reputation": 668, "user_id": 862710, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4b363b4cab914cf00b48e869a6f3675d?s=128&d=identicon&r=PG", "display_name": "Albeit", "link": "https://stackoverflow.com/users/862710/albeit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 50142139, "answer_count": 1, "score": 2, "last_activity_date": 1525289306, "creation_date": 1525280535, "question_id": 50139963, "link": "https://stackoverflow.com/questions/50139963/monadreader-foo-m-m-results-in-infinite-type-from-functional-dependency", "title": "&quot;MonadReader (Foo m) m&quot; results in infinite type from functional dependency", "body": "<p>I am trying to pass a function in a Reader that is to be called from the same monad as the calling function, but I get an infinite type error.</p>\n\n<p>The simplified code is:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n\nmodule G2 where\n\nimport Control.Monad\nimport Control.Monad.Reader\n\ndata Foo m = Foo { bar :: m () }\n\nrunFoo :: MonadReader (Foo m) m =&gt; m ()\nrunFoo = do\n    b &lt;- asks bar\n    b\n\nmain :: Monad m =&gt; m ()\nmain = do\n    let bar = return () :: m ()\n        foo = Foo bar\n    runReaderT runFoo foo\n</code></pre>\n\n<p>And the error is:</p>\n\n<pre><code>    \u2022 Occurs check: cannot construct the infinite type:\n        m0 ~ ReaderT (Foo m0) m\n        arising from a functional dependency between:\n          constraint \u2018MonadReader\n                        (Foo (ReaderT (Foo m0) m)) (ReaderT (Foo m0) m)\u2019\n            arising from a use of \u2018runFoo\u2019\n          instance \u2018MonadReader r (ReaderT r m1)\u2019 at &lt;no location info&gt;\n    \u2022 In the first argument of \u2018runReaderT\u2019, namely \u2018runFoo\u2019\n      In a stmt of a 'do' block: runReaderT runFoo foo\n      In the expression:\n        do let bar = ...\n               foo = Foo bar\n           runReaderT runFoo foo\n    \u2022 Relevant bindings include main :: m () (bound at G2.hs:16:1)\n   |\n19 |     runReaderT runFoo foo\n   |                ^^\n</code></pre>\n\n<p>Any help would be much appreciated, thanks!</p>\n"}, {"tags": ["haskell", "monads", "category-theory"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525273469, "post_id": 50137641, "comment_id": 87293960, "body": "Without <code>fmap</code>, I don&#39;t know of any standard typeclasses."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1525273599, "post_id": 50137641, "comment_id": 87294039, "body": "It looks a lot like <a href=\"http://hackage.haskell.org/package/comonad/docs/Control-Comonad.html\" rel=\"nofollow noreferrer\">ComonadApply</a>, but that requires that the container is a <code>Functor</code>."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 4, "creation_date": 1525273659, "post_id": 50137641, "comment_id": 87294076, "body": "Anything is a <code>Functor</code> with <a href=\"https://hackage.haskell.org/package/kan-extensions-5.1/docs/Data-Functor-Coyoneda.html\" rel=\"nofollow noreferrer\"><code>Coyoneda</code></a> (<code>instance Functor (Coyoneda f)</code>)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1525273691, "post_id": 50137641, "comment_id": 87294096, "body": "This reminds me of things like <a href=\"https://wiki.haskell.org/DeepArrow\" rel=\"nofollow noreferrer\"><code>DeepArrow</code></a>, which tries to get as much of the structure of an arrow as possible without requiring <code>arr</code> (which is the analogue of <code>fmap</code>)."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 0, "creation_date": 1525403878, "post_id": 50137641, "comment_id": 87351003, "body": "@Iceland_jack unfortunately this probably doesn&#39;t help in my case as there&#39;s no way to go back from a <code>Coyoneda</code> to the original type unless the original type is itself a <code>Functor</code>, which in this case it isn&#39;t."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1525272892, "creation_date": 1525272892, "question_id": 50137641, "link": "https://stackoverflow.com/questions/50137641/what-monad-style-typeclass-does-this-typeclass-fit-into", "title": "What monad style typeclass does this typeclass fit into?", "body": "<p>I've got a type <code>t</code> that supports the following three operations:</p>\n\n<pre><code>extract :: t a -&gt; a\nduplicate :: t a -&gt; t (t a)\n(&lt;*&gt;) :: t (a -&gt; b) -&gt; t a -&gt; t b\n</code></pre>\n\n<p>Naturally I can also write bind:</p>\n\n<pre><code>(&gt;&gt;=) :: f a -&gt; (a -&gt; f b) -&gt; f b\n(&gt;&gt;=) x f = f (extract x)\n</code></pre>\n\n<p>And <code>join</code>:</p>\n\n<pre><code>join :: t (t a) -&gt; t a\njoin = extract\n</code></pre>\n\n<p>But I can't write <code>fmap</code> nor <code>pure</code></p>\n\n<p>So this is kind of a \"monad\", and kind of a \"comonad\", but without <code>fmap</code>.</p>\n\n<p>Technically, I have got an <code>fmap</code> and <code>pure</code>, but they're constrained.</p>\n\n<p>I looked at various constrained functor style packages, but they all seem to constrain <code>(&lt;*&gt;)</code> as well, but in my case <code>(&lt;*&gt;)</code> is not constrained.</p>\n\n<p>Is there an existing typeclass I could squeeze this type into?</p>\n\n<p><em>If anyone is interested, the actual type I'm dealing with is the <a href=\"https://hackage.haskell.org/package/static-closure-0.1.0.0/docs/Control-Static-Closure.html#t:Closure\" rel=\"noreferrer\"><code>Closure</code></a> type</em></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 375, "user_id": 3335163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7c16ceedcdd8d1a01eee6b5b3de944?s=128&d=identicon&r=PG&f=1", "display_name": "Grisha", "link": "https://stackoverflow.com/users/3335163/grisha"}, "edited": false, "score": 0, "creation_date": 1525271453, "post_id": 50137115, "comment_id": 87292543, "body": "<code>Textedit</code> expects four type arguments in order to become a grown-up type you can reason about, i.e. <code>moveCursorLeft :: TextEdit String String String String -&gt; TextEdit String String String String</code>"}, {"owner": {"reputation": 29, "user_id": 9727898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb90a34bb1ca68823dc66de6373259b3?s=128&d=identicon&r=PG&f=1", "display_name": "BasicBooties", "link": "https://stackoverflow.com/users/9727898/basicbooties"}, "reply_to_user": {"reputation": 375, "user_id": 3335163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7c16ceedcdd8d1a01eee6b5b3de944?s=128&d=identicon&r=PG&f=1", "display_name": "Grisha", "link": "https://stackoverflow.com/users/3335163/grisha"}, "edited": false, "score": 0, "creation_date": 1525271725, "post_id": 50137115, "comment_id": 87292725, "body": "Grisha, I&#39;ve added that to my code and it&#39;s giving me a different error now.      TextEditor.hs:21:17: error:     * The constructor <code>TextEdit&#39; should have 4 arguments, but has been given 1     * In the pattern: TextEdit (l, r, c, s)       In an equation for </code>moveCursorLeft&#39;:           moveCursorLeft (TextEdit (l, r, c, s)) = (TextEdit (l, r, c, s))    | 21 | moveCursorLeft (TextEdit(l, r, c, s)) = (TextEdit(l, r, c, s))    |                 ^^^^^^^^^^^^^^^^^^^^"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525271782, "post_id": 50137115, "comment_id": 87292762, "body": "The <code>l r c s</code> after your TextEdit are <i>type</i> arguments. If you want all of those to be <code>[Char]</code>, just leave them off. Also, you&#39;re constructing your TextEdit incorrectly - constructors are just functions, <code>TextEdit (l,r,c,s)</code> should be <code>TextEdit l r c s</code>"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1525282296, "last_edit_date": 1525282296, "creation_date": 1525281155, "answer_id": 50140125, "question_id": 50137115, "link": "https://stackoverflow.com/questions/50137115/haskell-wont-compile-with-custom-datatype/50140125#50140125", "title": "Haskell: Wont compile with custom datatype", "body": "<pre><code>data TextEdit l r c s = TextEdit { left   :: l, right  :: r\n                                 , cursor :: c, select :: s }\n</code></pre>\n\n<p>So <code>TextEdit</code> is a type constructor that takes 4 type arguments, for example <code>TextEdit String String String String</code> would be a valid type.  You also have a data constructor of the same name, <code>TextEdit \"a\" \"b\" \"c\" \"d\"</code> would be a valid value of type <code>TextEdit String String String String</code>.</p>\n\n<pre><code>data TextEdit l r c s = TextEdit { left   :: [Char], right  :: [Char]\n                                 , cursor :: [Char], select :: [Char]}\n</code></pre>\n\n<p>This is somewhat different and probably not what you want.  Here <code>TextEdit</code> is still a type constructor but the arguments do not appear on the right hand side - they are phantom.  Instead how about you use:</p>\n\n<pre><code>data TextEdit = TextEdit { left   :: [Char], right  :: [Char]\n                         , cursor :: [Char], select :: [Char]}\n</code></pre>\n\n<p>Moving forward we will use this definition.  Now <code>TextEdit</code> is NOT a <em>type constructor</em> but it is merely a <em>type</em>.</p>\n\n<pre><code>moveCursorLeft :: TextEdit -&gt; TextEdit\nmoveCursorLeft (TextEdit(l, r, c, s)) = (TextEdit(l, r, c, s))\n</code></pre>\n\n<p>Ah no.  You have used <code>TextEdit</code> correctly in the <code>main</code> routine but seem to have forgotten what you have learned.  <code>TextEdit (l,r,c,s)</code> says the text edit function takes one argument that is a 4-tuple of values.  However, looking at the data declaration we know <code>TextEdit</code> takes 4 arguments and they are all <code>[Char]</code> not tuples.  So use <code>TextEdit l r c s</code>.  Same goes for the function definition, yielding:</p>\n\n<pre><code>moveCursorLeft :: TextEdit -&gt; TextEdit\nmoveCursorLeft (TextEdit l r c s) = TextEdit l r c s\n</code></pre>\n\n<p>To restate:  <code>(a,b,c,d)</code> is one value - a tuple.  <code>F (a,b,c,d)</code> is some constructor <code>F</code> applied to that one value.  <code>F a b c d</code> is the constructor <code>F</code> applied to four values.  Function application uses spaces and not parenthesis with commas - drop the C syntax.</p>\n"}], "owner": {"reputation": 29, "user_id": 9727898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb90a34bb1ca68823dc66de6373259b3?s=128&d=identicon&r=PG&f=1", "display_name": "BasicBooties", "link": "https://stackoverflow.com/users/9727898/basicbooties"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525282296, "creation_date": 1525271230, "last_edit_date": 1525271487, "question_id": 50137115, "link": "https://stackoverflow.com/questions/50137115/haskell-wont-compile-with-custom-datatype", "title": "Haskell: Wont compile with custom datatype", "body": "<p>I am a beginner at haskell. Trying to create a program which allows you to enter a string and then manipulate it with different commands.</p>\n\n<p>I've declared a new type called TextEdit which I want to store:\n -Text left of cursor (l)\n -Text right of cursor (r)\n -Text 'selected' by cursor (c)\n -and a clipboard for copy/cut/pasting (s)</p>\n\n<pre><code>data TextEdit l r c s = TextEdit { left :: l, right :: r, cursor :: c, select :: s }\n</code></pre>\n\n<p>or</p>\n\n<pre><code>data TextEdit l r c s = TextEdit { left :: [Char], right :: [Char], cursor :: [Char], select :: [Char]}\n</code></pre>\n\n<p>The rest of my code looks like this so far:</p>\n\n<pre><code>main = do\n    putStrLn \"-----Text Editor-----\" \n    putStrLn \"Please enter your text\"\n    tInput &lt;- getLine\n    let tI = TextEdit tInput \"|\" \"\" \"\"\n    putStrLn \"\\n\\n\" \n    putStrLn tInput\n\n\nmoveCursorLeft :: TextEdit -&gt; TextEdit\nmoveCursorLeft (TextEdit(l, r, c, s)) = (TextEdit(l, r, c, s))\n</code></pre>\n\n<p>The user will be calling 'moveCursorLeft tI' to move the cursor.</p>\n\n<p>This is the error I am getting when I try to run it</p>\n\n<pre><code>TextEditor.hs:20:31: error:\n* Expecting four more arguments to `TextEdit'\n  Expected a type, but `TextEdit' has kind `* -&gt; * -&gt; * -&gt; * -&gt; *'\n* In the type signature: moveCursorLeft :: TextEdit -&gt; TextEdit\n   |\n20 | moveCursorLeft :: TextEdit -&gt; TextEdit\n   |                               ^^^^^^^^\n</code></pre>\n\n<p>Thanks for any help guys :) Really appreciate it</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525272615, "post_id": 50136713, "comment_id": 87293317, "body": "Do you know how to use an <code>Either</code> value <i>without</i> an <code>IO</code> action?"}, {"owner": {"reputation": 589, "user_id": 1494159, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2af3dee10db5e7d656a93ee582c4c66b?s=128&d=identicon&r=PG", "display_name": "Ajit", "link": "https://stackoverflow.com/users/1494159/ajit"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525273101, "post_id": 50136713, "comment_id": 87293699, "body": "I tried this using <code>case of</code> syntax as highlighted here : <a href=\"https://pastebin.com/nquCFvck\" rel=\"nofollow noreferrer\">pastebin.com/nquCFvck</a> and it seems to work . Now trying use <code>bind</code> for learning purposes"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1525273469, "post_id": 50136713, "comment_id": 87293959, "body": "No, that&#39;s the (or rather: a) right solution. You could use the <code>either</code> or <code>fromRight</code> functions instead, but I don&#39;t think that would be a significant improvement. Note that you don&#39;t need to keep nesting like that if you have the <code>Left</code> branch terminate the program (with an error or an exception) and the right branch return the value."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525273613, "post_id": 50136713, "comment_id": 87294048, "body": "You can&#39;t use bind for this: roughly, bind takes something of out its monadic context if that is then re-inserted in the same monadic context. You can&#39;t take something out of <code>Either a</code> and put it in <code>IO</code> with bind."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525276658, "post_id": 50138618, "comment_id": 87295973, "body": "Since this just ignores the error message that <code>lookupValue</code> might return, you could also probably use <code>fromRight &quot;0&quot; (config &gt;&gt;= ...)</code>. (I <i>think</i> that requires importing <code>Data.Either</code> where <code>either</code> does not, but I cannot confirm at the moment.)"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1525277215, "post_id": 50138618, "comment_id": 87296323, "body": "I wonder if a nested <code>do</code> and continued use of <code>&lt;-</code> would let the code avoid the <code>&gt;&gt;=</code> and prevent it from ignoring the config reading errors, if any."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1525277521, "post_id": 50138618, "comment_id": 87296500, "body": "@9000 Probably not without introducing monad transformers in a way that would be less clear than the current code."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1525279278, "post_id": 50138618, "comment_id": 87297509, "body": "Yeah, the problem in this case is that&#39;s doing two things at once, which is great for an example but not so great in &quot;real&quot; code - a config value not being present is usually not an error (unless it&#39;s something where sensible default values genuinely do not exist), but you definitely want to treat syntax errors in a config files as errors."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1525281762, "post_id": 50138618, "comment_id": 87298756, "body": "Is <code>Either</code> really a monad?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 1, "creation_date": 1525282137, "post_id": 50138618, "comment_id": 87298948, "body": "@bipll <code>Either</code> is not, but <code>Either String</code> is."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525282170, "post_id": 50138618, "comment_id": 87298971, "body": "@Cubic Good point; I&#39;ll update with a helper function that distinguishes between a missing <code>port</code> key and other errors."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1525282457, "last_edit_date": 1525282457, "creation_date": 1525275943, "answer_id": 50138618, "question_id": 50136713, "link": "https://stackoverflow.com/questions/50136713/reading-an-ini-file-using-monads/50138618#50138618", "title": "Reading an INI file using monads", "body": "<p>There are two different monads involved. <code>readIniFile</code> returns an <code>IO (Either String Ini)</code> value, which means <code>config</code> has type <code>Either String Ini</code>. With in <em>this</em> <code>do</code> expression, you cannot extract the <code>Text</code> value from the <code>Either String Text</code> value returned by <code>config &gt;&gt;= lookupValue \"NETWORK\" \"port\"</code>. Instead, use <code>either</code> to return a default value should the lookup fail, or extract the port if the lookup succeeds.</p>\n\n<pre><code>getPort :: Ini -&gt; Either String Text\ngetPort cfg = let result = lookupValue \"NETWORK\" \"port\" cfg\n              in case result of\n                    Left \"Couldn't find key: port\" -&gt; Right \"0\"\n                    otherwise -&gt; result\n\n main = do\n  config &lt;- readIniFile \"configs/config.ini\"\n  -- You could probably do better than just raise an error\n  let port = either error id (config &gt;&gt;= getPort)\n  putStrLn (unpack port)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1525367053, "post_id": 50140180, "comment_id": 87338572, "body": "Speaking of \u201cvarious reasons\u201d, I\u2019ll add that you may see older code using <code>ErrorT</code>, which has a spurious <code>Error</code> constraint, or <code>EitherT</code> from (older versions of?) <code>either</code>, but <code>ExceptT</code> is the right choice nowadays for an <code>Either</code> transformer."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 3, "last_activity_date": 1525281318, "creation_date": 1525281318, "answer_id": 50140180, "question_id": 50136713, "link": "https://stackoverflow.com/questions/50136713/reading-an-ini-file-using-monads/50140180#50140180", "title": "Reading an INI file using monads", "body": "<p>Since there's more than one monad involved, you could use a <em>monad transformer</em>. While you'd expect the <code>Either</code> monad transformer to be called <code>EitherT</code>, it is, for various reasons, called <code>ExceptT</code>.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport Control.Monad.IO.Class (liftIO)\nimport Control.Monad.Trans.Except\nimport Data.Ini\n\nmain = runExceptT $ do\n  config &lt;- ExceptT $ readIniFile \"./config.ini\"\n  port &lt;- ExceptT $ return $ lookupValue \"NETWORK\" \"port\" config\n  liftIO $ putStrLn $ show port\n</code></pre>\n\n<p>By doing various lifting, <code>config</code> in the above code example is an <code>Ini</code> value, and <code>port</code> is a <code>Text</code> value.</p>\n\n<p>When all operations succeed, the program prints the <code>port</code> value, but if one of the operations fail, nothing happens.</p>\n"}], "owner": {"reputation": 589, "user_id": 1494159, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2af3dee10db5e7d656a93ee582c4c66b?s=128&d=identicon&r=PG", "display_name": "Ajit", "link": "https://stackoverflow.com/users/1494159/ajit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 50140180, "answer_count": 2, "score": 3, "last_activity_date": 1525282457, "creation_date": 1525270143, "last_edit_date": 1525281345, "question_id": 50136713, "link": "https://stackoverflow.com/questions/50136713/reading-an-ini-file-using-monads", "title": "Reading an INI file using monads", "body": "<p>I am a trying to read an INI file with haskell using monads. </p>\n\n<p>Here is my code : </p>\n\n<pre><code>import Control.Monad\nimport Data.Ini\n\nmain = do\n    config &lt;- readIniFile \"configs/config.ini\"\n    port &lt;- (config &gt;&gt;= lookupValue \"NETWORK\" \"port\")\n    port &gt;&gt;= putStrLn\n</code></pre>\n\n<p>In my limited understanding, <code>config</code> and <code>port</code> would be of type <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Either.html\" rel=\"nofollow noreferrer\">Either</a>. How can use an <code>Either</code> value with an <code>IO</code> action</p>\n"}, {"tags": ["file", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525264077, "post_id": 50134608, "comment_id": 87287171, "body": "You will need a serializer that transforms Haskell objects into a stream of bytes (or characters). Perhaps you can use <code>Data.Aeson</code> to construct a JSON string."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1525264889, "post_id": 50134608, "comment_id": 87287752, "body": "side-note: you are not passing in three <code>[Char]</code> but a <code>TextEditor</code>."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1525283792, "post_id": 50134869, "comment_id": 87299814, "body": "Is there any reason you used <code>readMay</code> instead of <code>readMaybe</code> from base?"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1525264724, "creation_date": 1525264724, "answer_id": 50134869, "question_id": 50134608, "link": "https://stackoverflow.com/questions/50134608/creating-txt-file-with-a-custom-data-type/50134869#50134869", "title": "Creating txt file with a custom data type", "body": "<p>if you <code>derive (Show, Read)</code> you can then</p>\n\n<pre><code>save :: TextEditor -&gt; FilePath -&gt; IO ()\nsave editor f = writeFile f $ show editor\n\nrestore:: FilePath -&gt; IO (Maybe TextEditor)\nrestore f = readMay &lt;$&gt; readFile f\n</code></pre>\n\n<h2>Note</h2>\n\n<ul>\n<li><code>readMay</code> is from the package <a href=\"https://hackage.haskell.org/package/safe\" rel=\"nofollow noreferrer\">safe</a>.</li>\n<li><code>read</code>/<code>show</code>/<code>String</code> are very inefficient, so the remark about using something like <code>aeson</code> for (de-)serialization is a good idea.</li>\n<li>if you have a custom <code>show</code> instance - a derived <code>read</code> won't work.</li>\n</ul>\n"}], "owner": {"reputation": 25, "user_id": 9697142, "user_type": "registered", "profile_image": "https://graph.facebook.com/1846288642049065/picture?type=large", "display_name": "Andrew Morrison", "link": "https://stackoverflow.com/users/9697142/andrew-morrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 50134869, "answer_count": 1, "score": 0, "last_activity_date": 1525264809, "creation_date": 1525263900, "last_edit_date": 1525264809, "question_id": 50134608, "link": "https://stackoverflow.com/questions/50134608/creating-txt-file-with-a-custom-data-type", "title": "Creating txt file with a custom data type", "body": "<p>I have a custom data type:</p>\n\n<pre><code>data TextEditor = TextEditor [Char] [Char] [Char] deriving (Show)\n</code></pre>\n\n<p>This is used to hold text before a cursor then after the cursor and then hold only selections that are made.</p>\n\n<p>I wish to have a function 'save' that allows the user to save the contents of this datatype to a txt file. My current versions is: </p>\n\n<pre><code>save :: TextEditor -&gt; String -&gt; IO()\nsave (TextEditor b a x) f = writeFile f (TextEditor b a x)\n</code></pre>\n\n<p>but <code>writeFile</code> takes a <code>String</code> and I am passing three <code>[Char]</code> is there a way to convert this into a string or is there something I am missing?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1525269090, "post_id": 50134328, "comment_id": 87290703, "body": "The wavefront-obj repository hasn&#39;t been updated in 2 years, and the version is marked as 0.0.1 with an &quot;experimental&quot; tag. Looks like this was just a small parser someone got together on a weekend or so, it&#39;s not surprising it doesn&#39;t quite work for all inputs."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1525270666, "post_id": 50136297, "comment_id": 87291921, "body": "The <code>readOBJ</code> function of the <code>rgl</code> package for R ignores unknown directives. I expected the same. I think the best I can do is my own &quot;readOBJ&quot; function, without using this package."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1525276284, "post_id": 50136297, "comment_id": 87295722, "body": "Well, at least let me share the pinecone (done with R): <a href=\"https://media.giphy.com/media/zmksFMLFWIWg6ybt23/giphy.gif\" rel=\"nofollow noreferrer\">pinecone</a>. I hope you appreciate ;)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1525269001, "creation_date": 1525269001, "answer_id": 50136297, "question_id": 50134328, "link": "https://stackoverflow.com/questions/50134328/reading-an-obj-file-with-haskell/50136297#50136297", "title": "Reading an OBJ file with Haskell", "body": "<p>Looks like your OBJ file has some directives that wavefront-obj doesn't recognize. You can see <a href=\"http://hackage.haskell.org/package/wavefront-obj-0.1.0.1/docs/src/Data-WavefrontObj-Parsers.html#loadWavefrontObj\" rel=\"nofollow noreferrer\">in the source</a> that wavefront-obj only understands the <code>#</code>, <code>v</code>, <code>vt</code>, <code>vn</code>, and <code>f</code> directives. Your file kicks off with <code>mtllib</code> and <code>o</code> directives, and appears to have several others not in the supported list.</p>\n\n<p>A priori, I would therefore expect a <code>Left</code> result instead of a <code>Right</code> as you're getting. But the wavefront-obj author fell into a common parser-combinator pitfall: their top-level parser does not end with <code>eof</code>. So it sees the first two comment lines, then none of its parsers match the next line but it doesn't mind not being at the end of the file, so it reports successfully parsing an empty list of directives.</p>\n\n<p>Between this and a few other things I noticed while sourcediving (comments are almost certainly not treated correctly, failure to exploit the predictable structure of directives and therefore code duplication), I expect you're going to have to do quite a bit of work if you want this package to work reliably and correctly.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 50136297, "answer_count": 1, "score": 0, "last_activity_date": 1525269001, "creation_date": 1525262928, "question_id": 50134328, "link": "https://stackoverflow.com/questions/50134328/reading-an-obj-file-with-haskell", "title": "Reading an OBJ file with Haskell", "body": "<p>I'm trying to use the <code>wavefront-obj</code> package to read an OBJ file. Here is <a href=\"https://raw.githubusercontent.com/josdirksen/learning-threejs/master/assets/models/pinecone.obj\" rel=\"nofollow noreferrer\">an example of OBJ file</a>.</p>\n\n<p>After downloading this file, I do</p>\n\n<pre><code>import Data.WaveFrontObj\nx &lt;- loadWavefrontObj \"pinecone.obj\"\n</code></pre>\n\n<p>Then: </p>\n\n<pre><code>&gt; :t x\nx :: Either String WavefrontModel\n\nimport Data.Either.Extra\ny = fromRight' x\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>&gt; :t y\ny :: WavefrontModel\n&gt; y\nWavefrontModel []\n</code></pre>\n\n<p>Looks like the result is empty. What am I doing bad ?</p>\n"}, {"tags": ["file", "haskell", "io", "lazy-evaluation"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1525262071, "post_id": 50133659, "comment_id": 87286018, "body": "That&#39;s what the <code>withFile</code> documentation says, but <code>hGetContents</code> also has some documentation. &quot;Computation <code>hGetContents hdl</code> returns the list of characters corresponding to the unread portion of the channel or file managed by <code>hdl</code>, which is put into an intermediate state, semi-closed. Any operation that fails because a handle is closed, also fails if a handle is semi-closed.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1525262166, "post_id": 50134016, "comment_id": 87286069, "body": "Ok, but what if I would like to read file and then write to it without reopening it?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 3, "creation_date": 1525263867, "post_id": 50134016, "comment_id": 87287043, "body": "@Ikciwor In that case, you <i>definitely</i> want to avoid lazy I/O. Open the file with <code>withFile</code>, and use <code>hGetChar</code> or <code>hGetLine</code> repeatedly to read in the contents, and <code>hPutChar</code> or <code>hPutLine</code> to write data back. (If you want to overwrite rather than append, you&#39;ll need to <code>hSeek</code> back to the beginning before writing.)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 4, "last_activity_date": 1525261853, "creation_date": 1525261853, "answer_id": 50134016, "question_id": 50133659, "link": "https://stackoverflow.com/questions/50133659/withfile-closing-file-to-early/50134016#50134016", "title": "withFile closing file to early", "body": "<p><code>hGetContents</code> puts the file handle into the \"semi-closed\" state. All explicit operations on that handle are invalid after this point. This has nothing to do with <code>withFile</code>; you just can't use <code>hGetContents</code> on the same handle twice.</p>\n\n<p>In general, you want to <em>either</em> use lazy I/O throughout (with <code>readFile</code> for example), <em>or</em> use explicit I/O throughout (using <code>withFile</code> and friends). Preferably the latter. Trying to mix the two will probably just result in problems.</p>\n\n<p>In general, lazy I/O is good for quick prototyping, but does have quite a lot of drawbacks in terms of predicting when the underlying OS resources will be released.</p>\n"}], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525261853, "creation_date": 1525260672, "question_id": 50133659, "link": "https://stackoverflow.com/questions/50133659/withfile-closing-file-to-early", "title": "withFile closing file to early", "body": "<p>After running following code</p>\n\n<pre><code>withFile \"file.txt\" ReadWriteMode \n  (\\h -&gt; hGetContents h &gt;&gt;= putStrLn &gt;&gt; hGetContents h &gt;&gt;= putStrLn)\n</code></pre>\n\n<p>I get contents of <code>file.txt</code> printed only once and then I receive following exception:</p>\n\n<p><code>*** Exception: file.txt: hGetContents: illegal operation (handle is closed)</code></p>\n\n<p>Why did Haskell close the file so early that I could not execute all desired actions? The documentation says</p>\n\n<blockquote>\n  <p>The Handle will be automatically closed <strong><em>when the computation returns</em></strong>.</p>\n</blockquote>\n\n<p>which seems not to be true in this case.</p>\n\n<p>Why does it behave like this and how to chain multiple IO operations on single handler?</p>\n"}, {"tags": ["haskell", "shape"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525260054, "post_id": 50133380, "comment_id": 87284719, "body": "Can you explain, for example in pseudo-code how you would construct such a list?"}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1525364155, "post_id": 50133380, "comment_id": 87336995, "body": "Your function&#39;s return value is built from 4 segments that are <code>(++)</code> &#39;ed together - that makes sense. But each of those is only 2 points.  Make a function that takes 2 points, and returns a variable number of points that form a line between the two points. Look into list comprehensions and concepts related to those: step sizes, guards, generators, etc."}], "answers": [{"tags": [], "owner": {"reputation": 291, "user_id": 9529580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e826697f12ac7b6de2a502cd1e7e0b5?s=128&d=identicon&r=PG", "display_name": "Vora", "link": "https://stackoverflow.com/users/9529580/vora"}, "is_accepted": true, "score": 2, "last_activity_date": 1525397798, "creation_date": 1525397798, "answer_id": 50165937, "question_id": 50133380, "link": "https://stackoverflow.com/questions/50133380/creating-a-rectangle-coordinates-haskell/50165937#50165937", "title": "Creating a rectangle - Coordinates - Haskell", "body": "<p>A rasterized rectangle can be expressed simply as:<br>\n Every point <code>(x', y')</code> that exist between <code>(x1, y1)</code> and <code>(x2,y2)</code> that satisfy any number of the following conditions:<br>\n - <code>x == x1</code><br>\n - <code>x == x2</code><br>\n - <code>y == y1</code><br>\n - <code>y == y2</code><br>\nList comprehension is a decent start for what you want. As a hint, here's the list comprehension that would give you a filled square between <code>(x1, y1)</code> and <code>(x2, y2)</code>:<br></p>\n\n<pre><code>pointList = [(x', y') | x' &lt;- [x1..x2], y' &lt;- [y1..y2]]\n</code></pre>\n\n<p>From there, work your way further by finding how to specify which of those points should make it into the list. You can read up on list comprehension, for example at:<br> <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/List_comprehension</a>.\n<br><br>\nGood luck!</p>\n"}], "owner": {"reputation": 95, "user_id": 9574376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1632c0741c5612ec6146d91410469b59?s=128&d=identicon&r=PG&f=1", "display_name": "goat", "link": "https://stackoverflow.com/users/9574376/goat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 50165937, "answer_count": 1, "score": 0, "last_activity_date": 1525397798, "creation_date": 1525259852, "question_id": 50133380, "link": "https://stackoverflow.com/questions/50133380/creating-a-rectangle-coordinates-haskell", "title": "Creating a rectangle - Coordinates - Haskell", "body": "<p>I'm trying to create a raster graphic. At the moment, I've created code for a rectangle, however, the code only works for a 3x3 rectangle. I'm not sure how to improve the code so it works for 4x4, 5x5 etc. Here is what I have:</p>\n\n<pre><code>rectangleRaster :: Coord -&gt; Coord -&gt; Raster\nrectangleRaster (x1, y1) (x2, y2) = [((x1, y1), 1.0), ((x1, y1 + y2), 1.0)] ++ [((x1, y2), 1.0), ((x1 + x2, y1), 1.0)] ++ [((x2 + x1, y2), 1.0), ((x2, y1), 1.0)] ++ [((x2, y2 + y1), 1.0), ((x2, y2), 1.0)]\n</code></pre>\n\n<p>I see that the problem is everytime I want a bigger rectangle I need to add more points to <code>rectangleRaster</code>. So how could I use recursion or something else so when I input some points it creates a full rectangle without gaps. Here is what is prints for the points:</p>\n\n<p>Points: (-1, -1) (1, 1)\n<a href=\"https://i.stack.imgur.com/ob8Iz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ob8Iz.png\" alt=\"(-1, -1) (1, 1)\"></a></p>\n\n<p>Points: (-2, 1) (2, -1)\n<a href=\"https://i.stack.imgur.com/EOGSW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EOGSW.png\" alt=\"(-2, 1) (2, -1)\"></a></p>\n"}, {"tags": ["list", "haskell", "types", "tuples", "type-mismatch"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525252277, "post_id": 50130940, "comment_id": 87279611, "body": "That&#39;s not a list with three elements, but a 3-tuple."}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525252381, "post_id": 50130940, "comment_id": 87279664, "body": "jeez dude you always seem to come bash at me for really simple terminologies or ask me to provide extra when you never give any input to my questions. edited it to tuples ..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1525252474, "post_id": 50130940, "comment_id": 87279716, "body": "not at all, but there is a fundamental difference between tuples and lists: you can <i>not</i> append lists with <code>++</code>, tuples always have fixed number of items (known at compile time), the elements can have different elements, etc. So your <code>indexedWIP ++ (...)</code> will not work out, since you can not append tuples."}, {"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 1, "creation_date": 1525252522, "post_id": 50130940, "comment_id": 87279750, "body": "You may want to indent that a bit :P"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1525269700, "post_id": 50130940, "comment_id": 87291185, "body": "@WillemVanOnsem You meant &quot;you can not append <i>tuples</i> with <code>++</code>&quot;. @Omar lists and tuples really behave differently, Willem was not trying to bash at you, but to point out the issue."}], "answers": [{"tags": [], "owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "is_accepted": true, "score": 5, "last_activity_date": 1525254700, "creation_date": 1525254700, "answer_id": 50131691, "question_id": 50130940, "link": "https://stackoverflow.com/questions/50130940/haskell-indexing-a-list/50131691#50131691", "title": "Haskell - indexing a list", "body": "<p>Let me examine the types of your <code>addIndex</code> at each row:</p>\n\n<pre><code>addIndex :: [a] -&gt; b -&gt; b\naddIndex [] indexed = indexed\n\n-- Combined with the above, leads to:\naddIndex :: (Num n) =&gt; [(a,b,c)] -&gt; [(a,b,c,n)] -&gt; [(a,b,c,n)]\naddIndex ((a1,b1,c1):xs) [] = addIndex xs [(a1,b1,c1,0)]\n\n-- This call demands addIndexH satisfies:\naddIndexH :: (Num n) =&gt; [(a,b,c)] -&gt; [(a,b,c,n)] -&gt; (a,b,c,n) -&gt; [(a,b,c,n)]\n-- It's also costly, as last needs to traverse the list\naddIndex ((a1,b1,c1):xs) indexedWIP = \n    addIndexH ((a1,b1,c1):xs) indexedWIP (last indexedWIP)\n\n-- /= check matches types of a1 and ax, requiring them to be Eq\naddIndexH ((a1,b1,c1):xs) indexedWIP (ax,bx,cx,ix) = \n    if (a1 /= ax) then (addIndex xs (indexedWIP ++ (a1,b1,c1,(ix+1)))) \n    else (addIndex xs (indexedWIP ++ (a1,b1,c1,(ix))))\n</code></pre>\n\n<p>The distinction of list and tuple is actually the problem you hit here. </p>\n\n<pre><code>Prelude&gt; :t (++)\n(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Both operands to <code>++</code> must be same-type lists. So we need something like:</p>\n\n<pre><code>addIndexH ((a1,b1,c1):xs) indexedWIP (ax,bx,cx,ix) = \n    if (a1 /= ax) then (addIndex xs (indexedWIP ++ [(a1,b1,c1,(ix+1))])) \n    else (addIndex xs (indexedWIP ++ [(a1,b1,c1,(ix))]))\n</code></pre>\n\n<p>The end result should be a function that takes a list of 3-tuples and another list of enumerated 4-tuples, but in a rather circuitous manner. Consider how it expands:</p>\n\n<pre><code>addIndex [(a,b,c), (x,y,z)] []\naddIndex [(x,y,z)] [(a,b,c,0)]\naddIndexH [(x,y,z)] [(a,b,c,0)] (a,b,c,0)\naddIndex [] ([(a,b,c,0)] ++ [(x,y,z,(0+1))])\n([(a,b,c,0)] ++ [(x,y,z,(0+1))])\n</code></pre>\n\n<p>That's a fairly complex procedure, and it grows worse the longer the lists are (we haven't even looked at duplicate a fields yet). </p>\n\n<p>When you do encounter a duplicate a field, you still append it, only keeping the new index value. This means, since we only checked against the last item, that we have two items of matching <code>a</code> and index right next to each other. The function could be rewritten in several ways, in particular without rebuilding lists of every intermediate length and traversing the growing one for each element. </p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1525263193, "last_edit_date": 1525263193, "creation_date": 1525256289, "answer_id": 50132219, "question_id": 50130940, "link": "https://stackoverflow.com/questions/50130940/haskell-indexing-a-list/50132219#50132219", "title": "Haskell - indexing a list", "body": "<p>I think you make it more complex than necessary. If I understand it correctly, you take as input a list of 3-tuples <code>(a, b, c)</code>, and you want to return a list of 4-tuples <code>(a, b, c, i)</code>, where <code>i</code> specifies the thus far number of different <code>a</code>-values we observed.</p>\n\n<p>We thus perform some sort of mapping but with an accumulator. Although we can use higher-order constructs here, let us here aim to use recursion and add an accumulator. We can first define a helper function with signature:</p>\n\n<pre><code>addIndex' :: (Num n, Eq a) =&gt; a -&gt; n -&gt; [(a, b, c)] -&gt; [(a, b, c, n)]\n</code></pre>\n\n<p>where the first parameter is thus the <code>a</code>-value of the <em>previous</em> element (we here assume that we processed already an element). The second parameter is the number of elements we thus far observed, the third elements is the list of elements we still have to process, and the result is the list of 4-tuples.</p>\n\n<p>In case the list is exhausted, then we can return the empty list, regardless of the other variables:</p>\n\n<pre><code>addIndex' _ _ [] = []\n</code></pre>\n\n<p>in the other case, we should compare the previous key <code>ap</code> with the current key <code>a</code>, and in case the two are equal, we return the tuple with the index <code>i</code> as last element, we then recurse with the <em>same</em> index; otherwise we increment the index (to <code>i1 = i + 1</code>). We each time recurse on the tail of the list:</p>\n\n<pre><code>addIndex' ap i ((a, b, c): xs) | a == ap = (a, b, c, i) : addIndex' a i xs\n                               | otherwise = (a, b, c, i1) : addIndex' a i1 xs\n    where i1 = i + 1\n</code></pre>\n\n<p>So we obtain the function:</p>\n\n<pre><code>addIndex' :: (Num n, Eq a) =&gt; a -&gt; n -&gt; [(a, b, c)] -&gt; [(a, b, c, n)]\naddIndex' _ _ [] = []\naddIndex' ap i ((a, b, c): xs) | a == ap = (a, b, c, i) : addIndex' a i xs\n                               | otherwise = (a, b, c, i1) : addIndex' a i1 xs\n    where i1 = i + 1\n</code></pre>\n\n<p>But now we still have to process the first element. We know that if the list is empty, we return the empty list:</p>\n\n<pre><code>addIndex [] = []\n</code></pre>\n\n<p>otherwise we return as first tuple the first one in the given list with index <code>0</code>, and then make a call to <code>addIndex'</code> with the remaining tuples and the first key as accumulator:</p>\n\n<pre><code>addIndex ((a, b, c): xs) = (a, b, c, 0) : addIndex' a 0 xs\n</code></pre>\n\n<p>so we obtain as full solution:</p>\n\n<pre><code>addIndex :: (Num n, Eq a) =&gt; [(a, b, c)] -&gt; [(a, b, c, n)]\naddIndex [] = []\naddIndex ((a, b, c): xs) = (a, b, c, 0) : addIndex' a 0 xs\n\naddIndex' :: (Num n, Eq a) =&gt; a -&gt; n -&gt; [(a, b, c)] -&gt; [(a, b, c, n)]\naddIndex' _ _ [] = []\naddIndex' ap i ((a, b, c): xs) | a == ap = (a, b, c, i) : addIndex' a i xs\n                               | otherwise = (a, b, c, i1) : addIndex' a i1 xs\n    where i1 = i + 1\n</code></pre>\n\n<p>Then we generate for example:</p>\n\n<pre><code>Prelude&gt; addIndex [('a', 1, 4), ('a', 2, 5), ('b', 1, 3), ('b', 0, 2), ('c', 1, 2)]\n[('a',1,4,0),('a',2,5,0),('b',1,3,1),('b',0,2,1),('c',1,2,2)]\n</code></pre>\n\n<p>But note that we only look at the previous element, and hence for example if the <code>'a'</code> key occurs after <code>'c'</code>, we will increment the counter again:</p>\n\n<pre><code>Prelude&gt; addIndex [('a', 1, 4), ('a', 2, 5), ('b', 1, 3), ('b', 0, 2), ('c', 1, 2), ('a', 3, 4)]\n[('a',1,4,0),('a',2,5,0),('b',1,3,1),('b',0,2,1),('c',1,2,2),('a',3,4,3)]\n</code></pre>\n\n<p>This function will run in <em>linear</em> time <em>O(n)</em> whereas the functions you composed will run in <em>quadratic</em> time <em>O(n<sup>2</sup>)</em> since appending is done in linear time (as well as <code>last</code>, etc.).</p>\n"}], "owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1003, "favorite_count": 0, "accepted_answer_id": 50131691, "answer_count": 2, "score": -1, "last_activity_date": 1525263193, "creation_date": 1525252192, "last_edit_date": 1525256163, "question_id": 50130940, "link": "https://stackoverflow.com/questions/50130940/haskell-indexing-a-list", "title": "Haskell - indexing a list", "body": "<p>I have a list of 3 tuples items, I would like to index the list based on the first item, I have already written a code that sounds logically sane to me yet am getting a type error, here's what I wrote</p>\n\n<pre><code>addIndex [] indexed = indexed\naddIndex ((a1,b1,c1):xs) [] \n                    = addIndex xs [(a1,b1,c1,0)]\naddIndex ((a1,b1,c1):xs) indexedWIP \n                    = addIndexH ((a1,b1,c1):xs) indexedWIP (last indexedWIP)\naddIndexH ((a1,b1,c1):xs) indexedWIP (ax,bx,cx,ix)\n                    = if (a1 /= ax) \n                        then (addIndex xs (indexedWIP ++ (a1,b1,c1,(ix+1)))) \n                        else (addIndex xs (indexedWIP ++ (a1,b1,c1,(ix))))\n</code></pre>\n\n<p>I'm getting the following type error</p>\n\n<pre><code>ERROR file:.\\lmaogetrektson.hs:109 - Type error in application\n*** Expression     : indexedWIP ++ (a1,b1,c1,ix + 1)\n*** Term           : (a1,b1,c1,ix + 1)\n*** Type           : (b,c,d,e)\n*** Does not match : [a]\n</code></pre>\n"}, {"tags": ["haskell", "monoids"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525250405, "post_id": 50130388, "comment_id": 87278535, "body": "But <code>x &lt;&gt; mempty == mempty &lt;&gt; x == x</code> (that is one of the properties of a monoid), in your case <code>mempty &lt;&gt; x == mempty</code>. I think in case of a <code>ZipList</code>, the <code>mappend</code> should be equal to an infinite list of <code>mempty</code>s (of the <code>a</code> type)."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "edited": false, "score": 0, "creation_date": 1525252084, "post_id": 50130388, "comment_id": 87279498, "body": "Why do you create a new newtype instead of just adding a Monoid instance for <code>ZipList a</code>?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "edited": false, "score": 1, "creation_date": 1525252788, "post_id": 50130388, "comment_id": 87279920, "body": "@DominiqueDevriese &quot;I need to create a newtype ... <i>Thus avoiding orphan instances.</i>&quot;"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 4, "creation_date": 1525254937, "post_id": 50130388, "comment_id": 87281336, "body": "If your goal was for <code>MySum</code> to behave exactly like <code>Sum</code> then that at least looks right. Although I&#39;m not sure why you&#39;re wrapping <code>Sum</code> and <code>ZipList</code> if you&#39;re going to re-implement their behaviour anyway - you might as well just build <code>MySum</code> and <code>MyZipList</code> directly.  That being said, you said you want assistance but you didn&#39;t actually say what your problem was. You explained pretty well what you actually did, but your question is missing a description of what&#39;s actually going wrong."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525267878, "post_id": 50132919, "comment_id": 87289788, "body": "Is there a way to use <code>Compose</code> here?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525268191, "post_id": 50132919, "comment_id": 87290008, "body": "@chepner I guess <code>Ap f = Compose f Identity</code>, but sadly <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Functor-Compose.html\" rel=\"nofollow noreferrer\"><code>Compose</code> doesn&#39;t have the <code>Monoid</code> instance we&#39;d want either</a>"}, {"owner": {"reputation": 171, "user_id": 8256981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9812a29ae653519e5d8ff986a6521cc6?s=128&d=identicon&r=PG&f=1", "display_name": "maxloo", "link": "https://stackoverflow.com/users/8256981/maxloo"}, "edited": false, "score": 0, "creation_date": 1610721464, "post_id": 50132919, "comment_id": 116229071, "body": "@BenjaminHodgson How would you implement an <code>Arbitrary (Ap f a)</code> for <code>quickBatch</code> testing?  I&#39;ve tried <code>instance Arbitrary a =&gt; Arbitrary (Ap f a) where arbitrary = liftA2 (&lt;&gt;) Ap arbitrary arbitrary</code> and a few other variations, but none worked.."}, {"owner": {"reputation": 171, "user_id": 8256981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9812a29ae653519e5d8ff986a6521cc6?s=128&d=identicon&r=PG&f=1", "display_name": "maxloo", "link": "https://stackoverflow.com/users/8256981/maxloo"}, "edited": false, "score": 0, "creation_date": 1610721994, "post_id": 50132919, "comment_id": 116229321, "body": "@BenjaminHodgson You can also check out what I&#39;m trying to do at <a href=\"https://stackoverflow.com/questions/65716919/haskell-quickbatch-testing-ziplist-monoid-at-mconcat-results-in-stack-overflow\" title=\"haskell quickbatch testing ziplist monoid at mconcat results in stack overflow\">stackoverflow.com/questions/65716919/&hellip;</a>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1610726138, "post_id": 50132919, "comment_id": 116231323, "body": "You&#39;d wanna reuse <code>ZipList</code>&#39;s <code>Arbitrary</code>, right? <code>instance Arbitrary (f a) =&gt; Arbitrary (Ap f a) where arbitrary = Ap arbitrary</code>"}, {"owner": {"reputation": 171, "user_id": 8256981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9812a29ae653519e5d8ff986a6521cc6?s=128&d=identicon&r=PG&f=1", "display_name": "maxloo", "link": "https://stackoverflow.com/users/8256981/maxloo"}, "edited": false, "score": 0, "creation_date": 1610732528, "post_id": 50132919, "comment_id": 116234136, "body": "@BenjaminHodgson Thanks!  I tried that, but got this error:  <code>Couldn&#39;t match expected type \u2018Test.QuickCheck.Gen.Gen (Ap f a)\u2019 with actual type \u2018Ap Test.QuickCheck.Gen.Gen a0\u2019 In the expression: Ap arbitrary</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1610736116, "post_id": 50132919, "comment_id": 116235598, "body": "<code>arbitrary = Ap &lt;$&gt; arbitrary</code>, my mistake"}, {"owner": {"reputation": 171, "user_id": 8256981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9812a29ae653519e5d8ff986a6521cc6?s=128&d=identicon&r=PG&f=1", "display_name": "maxloo", "link": "https://stackoverflow.com/users/8256981/maxloo"}, "edited": false, "score": 0, "creation_date": 1610796686, "post_id": 50132919, "comment_id": 116248089, "body": "@BenjaminHodgson Thanks, I&#39;ve just posted my attempt at quickBatch.  Could you help with the <code>EqProp (Ap f a)</code>?  Is my <code>quickBatch $ monoid app</code> going in the right direction?"}, {"owner": {"reputation": 171, "user_id": 8256981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9812a29ae653519e5d8ff986a6521cc6?s=128&d=identicon&r=PG&f=1", "display_name": "maxloo", "link": "https://stackoverflow.com/users/8256981/maxloo"}, "edited": false, "score": 0, "creation_date": 1610817867, "post_id": 50132919, "comment_id": 116254001, "body": "@BenjaminHodgson I&#39;ve posted my attempt with quickBatch at <a href=\"https://stackoverflow.com/questions/65752398/haskell-quickbatch-testing-applicative-monoid-ziplist\" title=\"haskell quickbatch testing applicative monoid ziplist\">stackoverflow.com/questions/65752398/&hellip;</a>.  Hope you can help with that."}, {"owner": {"reputation": 171, "user_id": 8256981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9812a29ae653519e5d8ff986a6521cc6?s=128&d=identicon&r=PG&f=1", "display_name": "maxloo", "link": "https://stackoverflow.com/users/8256981/maxloo"}, "edited": false, "score": 0, "creation_date": 1610817947, "post_id": 50132919, "comment_id": 116254030, "body": "@Dharman Sorry for my mis-post here.  I&#39;ve deleted the post."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1610820008, "post_id": 50132919, "comment_id": 116254688, "body": "Since you wrote this, <code>Ap</code> has been added to <code>Data.Monoid</code> (in <code>base-4.12.0.0</code>)."}, {"owner": {"reputation": 171, "user_id": 8256981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9812a29ae653519e5d8ff986a6521cc6?s=128&d=identicon&r=PG&f=1", "display_name": "maxloo", "link": "https://stackoverflow.com/users/8256981/maxloo"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1610827809, "post_id": 50132919, "comment_id": 116257019, "body": "@BenjaminHodgson Sorry, I&#39;m now wondering why <code>arbitrary = Ap &lt;$&gt; arbitrary</code> works, but <code>arbitrary = Ap arbitrary</code> doesn&#39;t.. could you or @dfeuer help explain?"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 9, "last_activity_date": 1525261278, "last_edit_date": 1525261278, "creation_date": 1525258469, "answer_id": 50132919, "question_id": 50130388, "link": "https://stackoverflow.com/questions/50130388/ziplist-monoid-haskell/50132919#50132919", "title": "ZipList Monoid haskell", "body": "<p>First note that <code>ZipList</code>\u2019s <code>Applicative</code> instance already has the zippy behaviour you want.</p>\n\n<pre><code>ghci&gt; liftA2 (&lt;&gt;) (Sum &lt;$&gt; ZipList [1,2,3]) (Sum &lt;$&gt; ZipList [4,5,6]) :: ZipList Int\nZipList [Sum 5, Sum 7, Sum 9]\n</code></pre>\n\n<p>Then use the fact that any <code>Applicative</code> gives rise to a <code>Monoid</code> by lifting the monoidal behaviour of its contents through the monoidal functor itself. The plan is to abstract the <code>liftA2 (&lt;&gt;)</code> pattern from the expression I wrote above.</p>\n\n<pre><code>newtype Ap f a = Ap { getAp :: f a }\ninstance (Applicative f, Monoid a) =&gt; Monoid (Ap f a) where\n    mempty = Ap $ pure mempty\n    Ap xs `mappend` Ap ys = Ap $ liftA2 mappend xs ys\n</code></pre>\n\n<p>(As far as I know this <code>newtype</code> is missing from <code>base</code>, which seems like an oversight to me, though there may be a good reason for it. In fact, I\u2019d argue that <code>ZipList</code> should have a zippy <code>Monoid</code> instance out of the box, but, alas, it doesn\u2019t.)</p>\n\n<p>Your desired <code>Monoid</code> is then just <code>Ap ZipList (Sum Int)</code>. This is equivalent to the <code>MyZipList</code> <code>Monoid</code> you wrote by hand (except for the mistake in your <code>mempty</code> - it should be <code>MyZipList $ ZipList $ repeat mempty</code>), but composing it out of reusable <code>newtype</code>s like this is less ad-hoc and requires less boilerplate.</p>\n"}], "owner": {"reputation": 107, "user_id": 5288415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f03bfa6f2b9de3b0545d25044a701f?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Kamau", "link": "https://stackoverflow.com/users/5288415/kevin-kamau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1610796593, "creation_date": 1525250218, "last_edit_date": 1525355967, "question_id": 50130388, "link": "https://stackoverflow.com/questions/50130388/ziplist-monoid-haskell", "title": "ZipList Monoid haskell", "body": "<p>The default monoid for lists in the GHC Prelude is concatenation.</p>\n\n<p><code>[1,2,3] &lt;&gt; [4,5,6]</code> becomes <code>[1,2,3] ++ [4,5,6]</code> and thus <code>[1,2,3,4,5,6]</code></p>\n\n<p>I want to write a ZipList Monoid instance that behaves like this:</p>\n\n<pre><code>[\n  1 &lt;&gt; 4\n, 2 &lt;&gt; 5\n, 3 &lt;&gt; 6\n]\n</code></pre>\n\n<p>The result is <code>[5,7,9]</code> assuming I am using the sum monoid.\nNote this behaves like <code>zipWith (+)</code></p>\n\n<p>Potentially it would behave like this:</p>\n\n<pre><code>[\n  Sum 1 &lt;&gt; Sum 4\n, Sum 2 &lt;&gt; Sum 5\n, Sum 3 &lt;&gt; Sum 6\n]\n</code></pre>\n\n<p>I need to create a newtype around the <code>ZipList</code> newtype and the <code>Sum</code> newtype in order to create an instance for <code>Monoid</code>, <code>Arbitrary</code>, and <code>EqProp</code>. \nThus avoiding orphan instances.\nThis is how both the <code>ZipList</code> and the <code>Sum</code> looks like in the <code>Prelude</code>:</p>\n\n<pre><code>newtype ZipList a = ZipList { getZipList :: [a] }\nnewtype Sum a = Sum { getSum :: a }\n</code></pre>\n\n<p>This is how my newtype <code>MyZipList</code> looks: Does it look right?</p>\n\n<pre><code>newtype MyZipList a =\n  MyZipList (ZipList [a])\n  deriving (Eq, Show)\n\ninstance Monoid a =&gt; Monoid (MyZipList a) where\n  mempty = MyZipList (ZipList [])\n\n  mappend (MyZipList z) (MyZipList z') =\n    MyZipList $ liftA2 mappend z z'\n\ninstance Arbitrary a =&gt; Arbitrary (MyZipList a) where\n  arbitrary = MyZipList &lt;$&gt; arbitrary\n\ninstance Eq a =&gt; EqProp (MyZipList a) where\n  (=-=) = eq\n</code></pre>\n\n<p>This is how my newtype<code>MySum</code> looks like:\nDoes this look right?</p>\n\n<pre><code>newtype MySum a =\n  MySum (Sum a)\n  deriving (Eq, Show)\n\n instance (Num a, Monoid a) =&gt; Monoid (MySum a) where\n   mempty = MySum mempty\n\n   mappend (MySum s) (MySum s') = MySum $ s &lt;&gt; s'\n\n instance Arbitrary a =&gt; Arbitrary (MySum a) where\n   arbitrary = MySum &lt;$&gt; arbitrary\n</code></pre>\n\n<p>I would like assistance in finding out where I went wrong.</p>\n"}, {"tags": ["haskell", "types", "compiler-errors", "type-mismatch", "algebraic-data-types"], "comments": [{"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1525246200, "post_id": 50128894, "comment_id": 87276334, "body": "You don&#39;t seem to quite understand the difference between <code>type</code> and <code>data</code>. <code>Raster</code>, <code>Shade</code> and <code>Coord</code> don&#39;t exist anywhere but at the type level, where they&#39;re just aliases for existing types"}, {"owner": {"reputation": 95, "user_id": 9574376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1632c0741c5612ec6146d91410469b59?s=128&d=identicon&r=PG&f=1", "display_name": "goat", "link": "https://stackoverflow.com/users/9574376/goat"}, "reply_to_user": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1525247688, "post_id": 50128894, "comment_id": 87277058, "body": "Yeah I realised that when I made the post. I&#39;ve edited the post to what I&#39;ve attempted and still getting an error. Sorry I&#39;m new to Haskell and I make silly mistakes."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 3, "last_activity_date": 1525249707, "creation_date": 1525249707, "answer_id": 50130209, "question_id": 50128894, "link": "https://stackoverflow.com/questions/50128894/creating-a-rectangle-haskell/50130209#50130209", "title": "Creating a rectangle? - Haskell", "body": "<p>It's not clear what you want to do, but if you want to write a function with the type given for <code>rectangleRaster</code>, you don't have to involve <code>Rectangle</code>.</p>\n\n<p>The simplest solution that looks like the OP is something like this:</p>\n\n<pre><code>rectangleRaster :: Coord -&gt; Coord -&gt; Raster\nrectangleRaster a b = [(a, 1), (b, 1)]\n</code></pre>\n\n<p>Here, I've hard-coded the <code>Shade</code> value of each <code>Pixel</code> as <code>1</code>, as that looks like the attempted solution in the OP.</p>\n\n<p>You can call the function like this:</p>\n\n<pre><code>*Q50128894&gt; rectangleRaster (1,2) (3,4)\n[((1,2),1.0),((3,4),1.0)]\n</code></pre>\n\n<p>If, on the other hand, you want to create a <code>Rectangle</code>, you'll need to supply two <code>Point</code> values, which you can do like in the following GHCi example:</p>\n\n<pre><code>*Q50128894&gt; Rectangle (1,2) (3,4)\nRectangle (1.0,2.0) (3.0,4.0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1525250480, "creation_date": 1525250480, "answer_id": 50130462, "question_id": 50128894, "link": "https://stackoverflow.com/questions/50128894/creating-a-rectangle-haskell/50130462#50130462", "title": "Creating a rectangle? - Haskell", "body": "<p><code>Rectangle</code> is a data constructor. It creates a value of type <code>Shape</code>, according to the definition</p>\n\n<pre><code>data Shape = .... | Rectangle Point Point | ....\n--   ^^^^^          ^^^^^^^^^ ^^^^^ ^^^^^\n--   type           data      type  type\n--                constructor\n</code></pre>\n\n<p>It in fact has type <code>Rectangle :: Point -&gt; Point -&gt; Shape</code>.</p>\n\n<p>But in your definition</p>\n\n<pre><code>rectangleRaster :: Coord -&gt; Coord -&gt; Raster\nrectangleRaster a b = Rectangle [(a, 1)] [(b, 1)]\n</code></pre>\n\n<p>you have proclaimed <code>rectangleRaster</code> as a function returning <code>Raster</code>, not <code>Shape</code>. Hence the type mismatch error. Which even says,</p>\n\n<pre><code>src\\View.hs:70:24: error:\n* Couldn't match type `Shape' with `[Pixel]'\n  Expected type: Raster\n    Actual type: Shape\n</code></pre>\n\n<p>i.e. it <em>expects</em> to find <code>Raster</code>, as per your declaration / type specification, but it <em>actually</em> finds a value of type <code>Shape</code>, being constructed by the data constructor <code>Rectangle :: Point -&gt; Point -&gt; Shape</code>.</p>\n"}], "owner": {"reputation": 95, "user_id": 9574376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1632c0741c5612ec6146d91410469b59?s=128&d=identicon&r=PG&f=1", "display_name": "goat", "link": "https://stackoverflow.com/users/9574376/goat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "accepted_answer_id": 50130209, "answer_count": 2, "score": 2, "last_activity_date": 1525250575, "creation_date": 1525244811, "last_edit_date": 1525250575, "question_id": 50128894, "link": "https://stackoverflow.com/questions/50128894/creating-a-rectangle-haskell", "title": "Creating a rectangle? - Haskell", "body": "<pre><code>rectangleRaster :: Coord -&gt; Coord -&gt; Raster\nrectangleRaster a b = (Rectangle [(a, 1)] [(b, 1)])\n</code></pre>\n\n<p>Rectangle is defined by two points:</p>\n\n<pre><code>data Shape\n    = Point Point\n    | Rectangle Point\n                Point\n    | Circle Point\n            Point\n    | Line Point\n        Point\n    | Polygon [Point]\n    deriving (Show)\n</code></pre>\n\n<p>and Point is defined as </p>\n\n<pre><code>type Point = (Double, Double)\n</code></pre>\n\n<p>where:</p>\n\n<pre><code>type Shade = Double\ntype Coord = (Int, Int)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type Pixel = (Coord, Shade)\ntype Raster = [Pixel]\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>src\\View.hs:70:24: error:\n* Couldn't match type `Shape' with `[Pixel]'\n  Expected type: Raster\n    Actual type: Shape\n* In the expression: (Rectangle [(a, 1)] [(b, 1)])\n  In an equation for `rectangleRaster':\n      rectangleRaster a b = (Rectangle [(a, 1)] [(b, 1)])\n   |\n70 | rectangleRaster a b = (Rectangle [(a, 1)] [(b, 1)])\n   |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nsrc\\View.hs:70:34: error:\n    * Couldn't match type `[(Coord, Integer)]' with `(Double, Double)'\n      Expected type: Point\n        Actual type: [(Coord, Integer)]\n    * In the first argument of `Rectangle', namely `[(a, 1)]'\n      In the expression: (Rectangle [(a, 1)] [(b, 1)])\n      In an equation for `rectangleRaster':\n          rectangleRaster a b = (Rectangle [(a, 1)] [(b, 1)])\n   |\n70 | rectangleRaster a b = (Rectangle [(a, 1)] [(b, 1)])\n   |                                  ^^^^^^^^\n\nsrc\\View.hs:70:43: error:\n    * Couldn't match type `[(Coord, Integer)]' with `(Double, Double)'\n      Expected type: Point\n        Actual type: [(Coord, Integer)]\n    * In the second argument of `Rectangle', namely `[(b, 1)]'\n      In the expression: (Rectangle [(a, 1)] [(b, 1)])\n      In an equation for `rectangleRaster':\n          rectangleRaster a b = (Rectangle [(a, 1)] [(b, 1)])\n   |\n70 | rectangleRaster a b = (Rectangle [(a, 1)] [(b, 1)])\n   |            \n</code></pre>\n\n<p>Not sure what I'm doing wrong? It might have something to do with Raster being a list of [Pixel], if so, can anyone help me fix this problem? Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 2, "creation_date": 1525222126, "post_id": 50125632, "comment_id": 87269465, "body": "Very few languages should be able to do that.  When you get to writing more complicated programs, you&#39;ll see why it&#39;s useful."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1525277095, "post_id": 50125632, "comment_id": 87296236, "body": "The languages which <i>can</i> do that (e.g. Lisp and shell) use <i>dynamic</i> scoping, rather than the more common <i>static</i> or <i>lexical</i> scoping."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9727898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb90a34bb1ca68823dc66de6373259b3?s=128&d=identicon&r=PG&f=1", "display_name": "BasicBooties", "link": "https://stackoverflow.com/users/9727898/basicbooties"}, "edited": false, "score": 0, "creation_date": 1525222612, "post_id": 50125714, "comment_id": 87269545, "body": "moveCursorLeft is to be called by a user to move the &#39;cursor&#39; through the text that has been input into leftString  e.g. &quot;A,B,C,D&quot; | &quot;E,F,G&quot; =&gt; moveCursorLeft =&gt; &quot;A,B,C&quot; | &quot;D,E,F,G&quot;"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1525223637, "post_id": 50125714, "comment_id": 87269735, "body": "That seems like a different question. It isn&#39;t good to amend or expand questions through comments."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 29, "user_id": 9727898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb90a34bb1ca68823dc66de6373259b3?s=128&d=identicon&r=PG&f=1", "display_name": "BasicBooties", "link": "https://stackoverflow.com/users/9727898/basicbooties"}, "edited": false, "score": 0, "creation_date": 1525248329, "post_id": 50125714, "comment_id": 87277387, "body": "@BasicBooties: You would want to separate your data model from the way it&#39;s printed, and your program logic (like moving a cursor) from printing logic, e.g. <code>moveCursorLeft (&quot;ABCD&quot;, &quot;EF&quot;)</code> ~&gt; <code>(&quot;ABC&quot;, &quot;DEF&quot;)</code>. And then print the cursor afterwards, <code>printCursor (&quot;ABC&quot;, &quot;DEF&quot;)</code> ~&gt; <i>printing</i> <code>A, B, C | D, E, F</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1525222018, "creation_date": 1525222018, "answer_id": 50125714, "question_id": 50125632, "link": "https://stackoverflow.com/questions/50125632/haskell-cant-pass-variables/50125714#50125714", "title": "Haskell cant pass variables", "body": "<p>Function calls are a handshake between caller and callee: the caller must pass some arguments, and the callee must accept them. As you've written it, <code>moveCursorLeft</code> doesn't accept any arguments. But don't worry, it's easy to fix:</p>\n\n<pre><code>    moveCursorLeft leftString = do\n        putStr $ leftString\n</code></pre>\n\n<p>You could now use this in <code>main</code>, e.g.</p>\n\n<pre><code>    main = do\n        leftString &lt;- getLine\n        putStr \"\\n\\n\"\n        moveCursorLeft leftString\n        putStrLn \"|\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9727898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb90a34bb1ca68823dc66de6373259b3?s=128&d=identicon&r=PG&f=1", "display_name": "BasicBooties", "link": "https://stackoverflow.com/users/9727898/basicbooties"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525222018, "creation_date": 1525221220, "question_id": 50125632, "link": "https://stackoverflow.com/questions/50125632/haskell-cant-pass-variables", "title": "Haskell cant pass variables", "body": "<p>I'm very much a beginner at Haskell and I've hit a rather annoying bump in the road. At my current stage I am just trying to pass a lists from my main function into another and just PRINT it and I don't understand why it wont work.</p>\n\n<p>In my head, I feel like I should just be able to:</p>\n\n<pre><code>    main = do\n          putStrLn \"-----Text Editor-----\" \n          putStrLn \"Please enter your text\"\n          leftString &lt;- getLine\n          putStrLn $ \"\\n\\n\" ++ leftString ++ \"|\" \n\n    moveCursorLeft = do\n          putStr $ leftString\n</code></pre>\n\n<p>but this doesn't seem to work as 'leftString' is not in scope.</p>\n"}, {"tags": ["mongodb", "haskell", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1525255770, "post_id": 50125396, "comment_id": 87281910, "body": "Can you give a more complete reproducible code using a stack script:<a href=\"https://github.com/yesodweb/yesod-cookbook/blob/master/snippets/Basic_Template.md\" rel=\"nofollow noreferrer\">github.com/yesodweb/yesod-cookbook/blob/master/snippe&zwnj;&#8203;ts/&hellip;</a> ?"}], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1525222483, "creation_date": 1525219171, "last_edit_date": 1525222483, "question_id": 50125396, "link": "https://stackoverflow.com/questions/50125396/couldnt-match-type-persistentitybackend-a0-with-mongocontext-obtain-docu", "title": "Couldn&#39;t match type \u2018PersistEntityBackend a0\u2019 with \u2018MongoContext\u2019 -- obtain document by ObjectId", "body": "<p>I'm trying to write a handler function for a Yesod application that will take an ObjectId as a <code>String</code>, query a MongoDB collection, and return the document matching that ObjectId.  </p>\n\n<p>In the <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Class.html#v:get\" rel=\"nofollow noreferrer\">documentation</a> there's a function called <code>get</code>, which seems to do exactly this, but this function expects a <code>Key</code>.  Again consulting the <a href=\"https://hackage.haskell.org/package/persistent-mongoDB-1.2.0/docs/Database-Persist-MongoDB.html#g:5\" rel=\"nofollow noreferrer\">documentation</a> I find a function <code>oidToKey</code> that converts an <code>ObjectId</code> to a <code>Key</code>.  Putting this all together, my first attempt is along these lines:</p>\n\n<pre><code>getMyEventR :: String -&gt; Handler Value\ngetMyEventR oid = do\n  let key = oidToKey (read oid :: ObjectId)\n  Just myEvent &lt;- runDB $ get key\n  returnJson myEvent\n</code></pre>\n\n<p>but this fails with</p>\n\n<pre><code>error:\n\u2022 Couldn't match type \u2018PersistEntityBackend a0\u2019 with \u2018MongoContext\u2019\n    arising from a use of \u2018get\u2019\n  The type variable \u2018a0\u2019 is ambiguous\n\u2022 In the second argument of \u2018($)\u2019, namely \u2018get key\u2019\n  In a stmt of a 'do' block: Just myEvent &lt;- runDB $ get key\n  In the expression:\n    do let key = oidToKey (read oid :: ObjectId)\n       Just myEvent &lt;- runDB $ get key\n       returnJson myEvent\n</code></pre>\n\n<p>This led me to <a href=\"https://stackoverflow.com/questions/43160513/haskell-couldnt-match-type-persistentitybackend-record0-with-sqlbackend\">this</a> question, in which the OP notes that your <code>Entity</code> types actually have an instance of <code>Key</code>; for me</p>\n\n<pre><code>newtype instance Key MyEvent = MyEventKey {unMyEventKey :: BackendKey MongoContext}\n</code></pre>\n\n<p>Great!</p>\n\n<pre><code>let key = oidToKey (read oid :: ObjectId)\nJust myEvent &lt;- runDB $ get $ MyEventKey key\nreturnJson myEvent\n</code></pre>\n\n<p>Nope:</p>\n\n<pre><code>    \u2022 Couldn't match expected type \u2018BackendKey MongoContext\u2019\n              with actual type \u2018Key record0\u2019\n</code></pre>\n\n<p>Ahh, okay, so I need a <code>BackendKey</code> not a <code>Key</code>.  Let's try using <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Class.html#t:ToBackendKey\" rel=\"nofollow noreferrer\"><code>toBackendKey</code></a>:</p>\n\n<pre><code>let key = toBackendKey (oidToKey (read oid :: ObjectId))\nJust myEvent &lt;- runDB $ get $ MyEventKey key\nreturnJson myEvent\n</code></pre>\n\n<p>Again, no:</p>\n\n<pre><code>    \u2022 Ambiguous type variable \u2018record0\u2019 arising from a use of \u2018toBackendKey\u2019\n  prevents the constraint \u2018(ToBackendKey\n                              MongoContext record0)\u2019 from being solved.\n  Probable fix: use a type annotation to specify what \u2018record0\u2019 should be.\n</code></pre>\n\n<p>Annotating everything will all manners of types doesn't work and now I'm going blind staring at errors.  </p>\n\n<p>Long explanation for a simple question: <strong>can someone tell me what's going on here?</strong></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1525214087, "post_id": 50124736, "comment_id": 87267623, "body": "@9000 perhaps you&#39;d kindly add the corrected pattern-matching line as well?"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1525214311, "post_id": 50124736, "comment_id": 87267693, "body": "@bipill: I try to understand the intention correctly, that is, the <code>t</code> parameter to <code>TextEditor</code> type should be a 4-tuple.  It won&#39;t compile, though, to my mind, because the first argument of <code>load</code> should be a <code>TextEditor t</code> for some type <code>t</code>, not a tuple."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1525214472, "post_id": 50124736, "comment_id": 87267744, "body": "@9000 No it shouldn&#39;t. It should read as <code>TextEditor (l,s,r,b)</code>, for <code>(l,s,r,b)</code> is obviously a non-match for a single variable, and I wonder if there should be any more constraints on the variables."}, {"owner": {"reputation": 69, "user_id": 7937867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ada9cdf8f67babb5d6e52d9689756a5?s=128&d=identicon&r=PG&f=1", "display_name": "Queen567", "link": "https://stackoverflow.com/users/7937867/queen567"}, "edited": false, "score": 0, "creation_date": 1525214498, "post_id": 50124736, "comment_id": 87267756, "body": "I receive the following errors with the corrected code:  <code>* Expecting one fewer arguments to &#39;TextEditor&#39;       Expected kind &#39;k0 -&gt; *&#39;, but &#39;TextEditor&#39; has kind &#39;*&#39;     * In the type signature:         load :: TextEditor t -&gt; [Char] -&gt; IO TextEditor t</code>   and  <code>* Expecting one fewer arguments to &#39;IO TextEditor&#39;       Expected kind &#39;k0 -&gt; *&#39;, but &#39;IO TextEditor&#39; has kind &#39;*&#39;     * In the type signature:         load :: TextEditor t -&gt; [Char] -&gt; IO TextEditor t</code>"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1525214527, "post_id": 50124736, "comment_id": 87267770, "body": "Unless it&#39;s something of a <code>newtype</code> with a quadruple-accepting constructor."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 69, "user_id": 7937867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ada9cdf8f67babb5d6e52d9689756a5?s=128&d=identicon&r=PG&f=1", "display_name": "Queen567", "link": "https://stackoverflow.com/users/7937867/queen567"}, "edited": false, "score": 0, "creation_date": 1525214533, "post_id": 50124736, "comment_id": 87267773, "body": "@Queen567: What is the declaration of <code>TextEditor</code> type? Please edit your post to include it."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1525214603, "post_id": 50124736, "comment_id": 87267794, "body": "@9000 apparently its kind is <code>*</code>, so the type reads simply as <code>TextEditor</code>."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 69, "user_id": 7937867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ada9cdf8f67babb5d6e52d9689756a5?s=128&d=identicon&r=PG&f=1", "display_name": "Queen567", "link": "https://stackoverflow.com/users/7937867/queen567"}, "edited": false, "score": 0, "creation_date": 1525214699, "post_id": 50124736, "comment_id": 87267829, "body": "@Queen567 it&#39;s not the type."}, {"owner": {"reputation": 69, "user_id": 7937867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ada9cdf8f67babb5d6e52d9689756a5?s=128&d=identicon&r=PG&f=1", "display_name": "Queen567", "link": "https://stackoverflow.com/users/7937867/queen567"}, "edited": false, "score": 0, "creation_date": 1525214882, "post_id": 50124736, "comment_id": 87267883, "body": "@bipll updated."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1525215211, "post_id": 50124736, "comment_id": 87267964, "body": "Okay, so the current version in my, hm, answer should work. Try it."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 2, "last_activity_date": 1525215162, "last_edit_date": 1525215162, "creation_date": 1525213790, "answer_id": 50124736, "question_id": 50124705, "link": "https://stackoverflow.com/questions/50124705/error-parse-error-on-input-haskell/50124736#50124736", "title": "error: parse error on input `,&#39; - Haskell", "body": "<p>As the error message suggests, in Haskell, function arguments are not separated with commas (curried form).</p>\n\n<p>Specifically, the declaration should read</p>\n\n<pre><code>load :: TextEditor -&gt; String -&gt; IO TextEditor\n-- The below won't compile.\nload (TextEditor (_,s,r,b)) path = do  -- What is (l, s, r, b) here?\n    content &lt;- readFile path\n    return $TextEditor (content,s,r,b)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16397, "user_id": 303939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3f6c98562c6d9bb188eacc2002af257?s=128&d=identicon&r=PG", "display_name": "Ming-Tang", "link": "https://stackoverflow.com/users/303939/ming-tang"}, "is_accepted": false, "score": 0, "last_activity_date": 1525216107, "last_edit_date": 1525216107, "creation_date": 1525215776, "answer_id": 50124992, "question_id": 50124705, "link": "https://stackoverflow.com/questions/50124705/error-parse-error-on-input-haskell/50124992#50124992", "title": "error: parse error on input `,&#39; - Haskell", "body": "<p>You forgot the parens <code>( ... )</code> to surround a tuple in the type of <code>load :: ...</code>.</p>\n\n<pre><code>load :: (TextEditor (t), [Char]) -&gt; IO TextEditor (t)\n</code></pre>\n\n<p>Also, you have to indent the second line properly (to have same indentation as first line), or else Haskell will give you another confusing error message.</p>\n\n<pre><code>load :: (TextEditor (t), [Char]) -&gt; IO TextEditor (t)\nload(TextEditor(l,s,r,b),path) = do\n        content &lt;- readFile path\n        return(TextEditor(content,s,r,b))\n</code></pre>\n\n<p>Also, there are other type errors (like what is <code>TextEditor (t)</code>?) you need to resolve. See another answer for more details.</p>\n\n<p>Also, consider using <a href=\"https://codereview.stackexchange.com\">Code Review.SE</a> if you want more feedbacks on your entire Haskell code, after you got your code compiling.</p>\n"}], "owner": {"reputation": 69, "user_id": 7937867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ada9cdf8f67babb5d6e52d9689756a5?s=128&d=identicon&r=PG&f=1", "display_name": "Queen567", "link": "https://stackoverflow.com/users/7937867/queen567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "closed_date": 1525250845, "accepted_answer_id": 50124736, "answer_count": 2, "score": 1, "last_activity_date": 1525249954, "creation_date": 1525213581, "last_edit_date": 1525249954, "question_id": 50124705, "link": "https://stackoverflow.com/questions/50124705/error-parse-error-on-input-haskell", "closed_reason": "Needs details or clarity", "title": "error: parse error on input `,&#39; - Haskell", "body": "<p>Getting the error \"error: parse error on input `,'\" </p>\n\n<p>When reading in text from a file</p>\n\n<p>With the below code:</p>\n\n<p><code>data TextEditor = TextEditor ([Char], [Char], [Char], [Char]) deriving (Show)</code></p>\n\n<p>Any help would be appreciated,</p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["string", "haskell", "sum", "case"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1525202906, "post_id": 50122588, "comment_id": 87263192, "body": "You hardcoded the <code>&#39;x&#39;</code> character instead of using the <code>x</code> variable I guess."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1525209425, "post_id": 50122588, "comment_id": 87266026, "body": "Tuning on warnings would have spotted the error. I recommend to do that, and address each warning, especially those reporting missing type signatures."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8880650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038374c98950ba15f4c499f7ca64e830?s=128&d=identicon&r=PG&f=1", "display_name": "Kubaguette The Testobun", "link": "https://stackoverflow.com/users/8880650/kubaguette-the-testobun"}, "edited": false, "score": 1, "creation_date": 1525213838, "post_id": 50122663, "comment_id": 87267539, "body": "Thank you, now I understand it and edited my code :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1525337783, "last_edit_date": 1525337783, "creation_date": 1525203235, "answer_id": 50122663, "question_id": 50122588, "link": "https://stackoverflow.com/questions/50122588/haskell-case-statements-with-ord-x/50122663#50122663", "title": "Haskell case statements with ord &#39;x&#39;", "body": "<p>You here have <strong>hardcoded the <code>'x'</code> character</strong> instead of <strong>using the <code>x</code> variable</strong>:</p>\n\n<pre><code>import Data.Char  \nx1 xs = sum(map (hilfsfunction) xs)\nhilfsfunction x  \n   | (ord <b>'x'</b> &gt; 97 && ord <b>'x'</b> &lt; 107) = (ord <b>'x'</b> - 96)  \n   | (ord <b>'x'</b> &gt; 48 && ord <b>'x'</b> &lt; 58) = (ord <b>'x'</b> - 48)  \n   | otherwise = 0</code></pre>\n\n<p>So that means Haskell does not care what the value of <code>x</code> is: it will simply use the <code>'x'</code>.</p>\n\n<p>Note that here you write a rather cryptic function, you can write it in a cleaner way by making comparisons with other characters, and use <code>ord</code> when you do arithmetic:</p>\n\n<pre><code>hilfsfunction :: Char -&gt; Int\nhilfsfunction x  \n   | <b>'a'</b> &lt;= <b>x</b> && <b>x</b> &lt;= <b>'z'</b> = ox - ord 'a' + 1\n   | <b>'0'</b> &lt;= <b>x</b> && <b>x</b> &lt;= <b>'9'</b> = ox - ord '0'\n   | otherwise = 0\n    <b>where ox = ord x</b></code></pre>\n\n<p>Here it is clear at first sight (without any knowledge of the outline of ASCII) that you first check if <code>x</code> is in the range <code>['a'..'z']</code>, and if that is the case you basically use its sequence number. If not that you check if it is in the range <code>['0' .. '9']</code> and then use its numerical counterpart, and otherwise you return <code>0</code>. In fact you made a mistake in your implementation, since <code>ord 'z'</code> is <code>122</code>, and not <code>107</code>. Although you <em>can</em> use <code>122</code>, by comparing against <code>'z'</code>, it is probably less likely to make mistakes, since you let Haskell translate characters to its ASCII code equivalent.</p>\n\n<p>With the new definition for the <code>hilsfsfunction</code>, we obtain:</p>\n\n<pre><code>Prelude Data.Char&gt; x1 \"6aa@a1a~dwfwf123\"\n79\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 1, "last_activity_date": 1525281558, "creation_date": 1525281558, "answer_id": 50140250, "question_id": 50122588, "link": "https://stackoverflow.com/questions/50122588/haskell-case-statements-with-ord-x/50140250#50140250", "title": "Haskell case statements with ord &#39;x&#39;", "body": "<p>There is a loss of information in the sum. First <code>'0'</code> is not included. Second, the range of <code>['1'..'9']</code> and <code>['a'..'i']</code> is the very same in the sum. </p>\n\n<p>Also, if I were going to write this, I would</p>\n\n<pre><code>import Data.Char (ord)\nsol x | elem x ['0'..'9'] = mod (ord x) 16\n      | elem x ['a'..'z'] = mod (ord x) 32\n      | elem x ['A'..'Z'] = mod (ord x) 64\n      | otherwise = 0\n</code></pre>\n\n<p>With this, the preceding facts can be demonstrated</p>\n\n<pre><code>sol 'd' produces 4\nsol '4' produces 4\nsol '@' produces 0\nsol '0' produces 0\n</code></pre>\n\n<p>Now that said, <code>ord</code> is an index into the ASCII character set.\nIt is possible to create you own index with just the characters that interest you.</p>\n\n<pre><code>tlz = zip [1..] $ concat [['0'..'9'],['a'..'z']]\n</code></pre>\n\n<p>Then you can lookup characters and each will have a unique index number, even zero '0' will register as one. If a character is not in the table it, simply is not counted. The list compression just emits a null <code>[]</code>.</p>\n\n<p>Create the following function to use the list. The output is larger than the original function, the length of <code>tls</code> is 36 and originally the length is 26.</p>\n\n<pre><code>smmat = sum.concat.map (\\x-&gt;[a|(a,b)&lt;-tlz,x == b])\n</code></pre>\n\n<p>Just feed it a list.</p>\n\n<pre><code>smmat \"This is 42% sure\"\n</code></pre>\n\n<p>226</p>\n\n<p>Be assured in the preceding list there were 11 \"hits\". take <code>sum</code> out of the list to see or changer <code>a</code> in the list comprehension to b to see the characters.  </p>\n"}], "owner": {"reputation": 49, "user_id": 8880650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038374c98950ba15f4c499f7ca64e830?s=128&d=identicon&r=PG&f=1", "display_name": "Kubaguette The Testobun", "link": "https://stackoverflow.com/users/8880650/kubaguette-the-testobun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1525698886, "creation_date": 1525202844, "last_edit_date": 1525698886, "question_id": 50122588, "link": "https://stackoverflow.com/questions/50122588/haskell-case-statements-with-ord-x", "title": "Haskell case statements with ord &#39;x&#39;", "body": "<pre><code>import Data.Char  \nx1 xs = sum(map (hilfsfunction) xs)\nhilfsfunction x  \n   | (ord 'x' &gt; 97 &amp;&amp; ord 'x' &lt; 107) = (ord 'x' - 96)  \n   | (ord 'x' &gt; 48 &amp;&amp; ord 'x' &lt; 58) = (ord 'x' - 48)  \n   | otherwise = 0  \n</code></pre>\n\n<p>I need to write a programm where the function takes a string and then makes the following things with it:<br>\n- If the letter is an a, change it to 1<br>\n- If the letter is something else, I should take the equivalent number for it.<br>\n- All other symbols should be changed to 0   </p>\n\n<p>My problem now is, everytime I launch this programm the sum is 0, no matter if the first case or secound case is true.</p>\n\n<p>Example: Lets take \"6\":</p>\n\n<pre><code>*Main Data.Char&gt; ord '6' &gt; 48 &amp;&amp; ord '6' &lt; 58\nTrue\n</code></pre>\n\n<p>after this:</p>\n\n<pre><code>*Main Data.Char&gt; ord '6' - 48\n6\n</code></pre>\n\n<p>but if I take my function, everytime thats the case....:</p>\n\n<pre><code>*Main Data.Char&gt; x1 \"6\"\n[0]\n</code></pre>\n\n<p>I dont know where my error is.</p>\n"}, {"tags": ["haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1525202720, "post_id": 50122553, "comment_id": 87263079, "body": "But <code>h</code> has type <code>a -&gt; a</code>."}, {"owner": {"reputation": 261, "user_id": 6483826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719b751a6f8adbf559f769fabbfed0e8?s=128&d=identicon&r=PG&f=1", "display_name": "pricks", "link": "https://stackoverflow.com/users/6483826/pricks"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525202791, "post_id": 50122553, "comment_id": 87263124, "body": "Just fixed that, thanks"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1525203072, "post_id": 50122553, "comment_id": 87263270, "body": "But are <code>b</code> the same type in <code>f</code> and <code>g</code>? They are not a part of the class signature, so they could be anything?"}, {"owner": {"reputation": 261, "user_id": 6483826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719b751a6f8adbf559f769fabbfed0e8?s=128&d=identicon&r=PG&f=1", "display_name": "pricks", "link": "https://stackoverflow.com/users/6483826/pricks"}, "edited": false, "score": 0, "creation_date": 1525203182, "post_id": 50122553, "comment_id": 87263330, "body": "I dont really care what value b is. I need a way to specifify the value of the class used within h.  In this case h could be a -&gt; b or a -&gt; a.  I dont think that matters."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525203443, "post_id": 50122553, "comment_id": 87263455, "body": "@pricks: well the problem is that - depending on the type of <code>b</code> - there can be several &quot;correct&quot; results for <code>h x</code> (with <code>x</code> a value). Since if <code>b ~ Int</code>, then we might attach a different meaning to it, than when it is a <code>Char</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1525203946, "post_id": 50122553, "comment_id": 87263648, "body": "Related: <a href=\"https://stackoverflow.com/questions/28123453/what-is-the-difference-between-traits-in-rust-and-typeclasses-in-haskell/29388580#29388580\">What is the difference between traits in Rust and typeclasses in Haskell?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 6483826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719b751a6f8adbf559f769fabbfed0e8?s=128&d=identicon&r=PG&f=1", "display_name": "pricks", "link": "https://stackoverflow.com/users/6483826/pricks"}, "edited": false, "score": 0, "creation_date": 1525206157, "post_id": 50123276, "comment_id": 87264656, "body": "How safe/unsafe are AmbiguaousTypes and TypeApplications?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 261, "user_id": 6483826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719b751a6f8adbf559f769fabbfed0e8?s=128&d=identicon&r=PG&f=1", "display_name": "pricks", "link": "https://stackoverflow.com/users/6483826/pricks"}, "edited": false, "score": 1, "creation_date": 1525206445, "post_id": 50123276, "comment_id": 87264783, "body": "@pricks They are perfectly safe, despite their scary name. The only price to pay for ambiguous types is that inference can not guess what <code>b</code> is since <code>b</code> does not occur in <code>h</code>&#39;s type, so you will always need to use <code>h @ SomeType</code> in every call. These two extensions are usually used together."}, {"owner": {"reputation": 261, "user_id": 6483826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719b751a6f8adbf559f769fabbfed0e8?s=128&d=identicon&r=PG&f=1", "display_name": "pricks", "link": "https://stackoverflow.com/users/6483826/pricks"}, "edited": false, "score": 0, "creation_date": 1525206499, "post_id": 50123276, "comment_id": 87264807, "body": "Thank you, this was exactly the solution a was looking for."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1525374357, "post_id": 50123276, "comment_id": 87342325, "body": "If you\u2019re using type applications, you can also write <code>h = f . g @_ @b</code> (or <code>g @a @b</code>)."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1525206533, "last_edit_date": 1525206533, "creation_date": 1525206061, "answer_id": 50123276, "question_id": 50122553, "link": "https://stackoverflow.com/questions/50122553/using-haskell-classes-internally-in-a-function/50123276#50123276", "title": "Using haskell classes internally in a function", "body": "<p>If you want <code>h</code> to decide internally which instance to use, just provide an annotation to remove the ambiguity. Say, if you want to choose <code>b ~ Int</code></p>\n\n<pre><code>h :: Foo a =&gt; a -&gt; a\nh = f . (g :: Int -&gt; a)\n</code></pre>\n\n<p>(I guess <code>Foo</code> will need another parameter <code>b</code> in your actual class, but in such case this approach can be adapted as needed).</p>\n\n<p>If you instead need the <em>caller</em> of <code>h</code> to choose the instance, not <code>h</code> itself, you can use <code>AmbiguousTypes</code> and <code>TypeApplications</code> (and <code>ScopedTypeVariables</code>).</p>\n\n<pre><code>h :: forall b a . Foo a =&gt; a -&gt; a\nh = f . (g :: b -&gt; a)\n</code></pre>\n\n<p>Later on, you can call <code>h</code> as in, e.g., <code>h @ Int</code> to choose <code>b ~ Int</code>.</p>\n"}], "owner": {"reputation": 261, "user_id": 6483826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719b751a6f8adbf559f769fabbfed0e8?s=128&d=identicon&r=PG&f=1", "display_name": "pricks", "link": "https://stackoverflow.com/users/6483826/pricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 50123276, "answer_count": 1, "score": 0, "last_activity_date": 1525206533, "creation_date": 1525202652, "last_edit_date": 1525202776, "question_id": 50122553, "link": "https://stackoverflow.com/questions/50122553/using-haskell-classes-internally-in-a-function", "title": "Using haskell classes internally in a function", "body": "<p>Imagine that there is some class:</p>\n\n<pre><code>class Foo a where\n  g :: b -&gt; a\n  f :: a -&gt; b\n</code></pre>\n\n<p>I want to be able to write the following function:</p>\n\n<pre><code>h :: a -&gt; a\nh = f . g\n</code></pre>\n\n<p>But to do this I need some way to specify the exact instance of Foo I'm using.  Is there some way to do this simillar to how Rust uses traits?  I'm pretty certain I could use template haskell to build this function with a supplied class each time, but if possible I'd like to about that.</p>\n"}, {"tags": ["haskell", "opaleye"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1525206203, "post_id": 50121404, "comment_id": 87264678, "body": "What is the SQL interpretation of the <code>Maybe</code> type? If you would like to use <code>Maybe</code> in the generated SQL, you must define and implement such an interpretation. But you should not write any instances; you need functions <code>_Nothing :: Column (Maybe a)</code> and <code>_Just :: Column a -&gt; Column (Maybe a)</code> (and probably a destructor - <code>caseMaybe :: Column b -&gt; (Column a -&gt; Column b) -&gt; Column (Maybe a) -&gt; b</code>)"}, {"owner": {"reputation": 55, "user_id": 8363515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bd6dde88e770a81b12a11253dae100?s=128&d=identicon&r=PG&f=1", "display_name": "limick", "link": "https://stackoverflow.com/users/8363515/limick"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1525208944, "post_id": 50121404, "comment_id": 87265862, "body": "<code>Nothing :: Maybe ProductAttributePGR</code> was supposed to mean that all the relevant columns are null, but from your comment and from <a href=\"http://haskell.vacationlabs.com/en/latest/docs/opaleye/basic-db-mapping.html#different-types-for-read-write-again\" rel=\"nofollow noreferrer\">here</a> it seems that <code>Maybe</code> has no business being there, instead all the columns on the right side of the join have to be <code>Nullable</code>. I thought that <code>leftJoinF</code> would help me get around that, but apparently that&#39;s not the case."}], "answers": [{"tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": true, "score": 0, "last_activity_date": 1526142211, "creation_date": 1526142211, "answer_id": 50308365, "question_id": 50121404, "link": "https://stackoverflow.com/questions/50121404/leftjoinf-in-opaleye-and-ifpp/50308365#50308365", "title": "leftJoinF in Opaleye and IfPP", "body": "<p>You can't return a <code>Maybe</code> out of a functional join.  Functional join allows you to avoid <code>Nullable</code> in the sense that it hides the <code>IS NULL</code> check from you.  It doesn't allow you to \"lift the nullability\" onto the Haskell side.  </p>\n"}], "owner": {"reputation": 55, "user_id": 8363515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bd6dde88e770a81b12a11253dae100?s=128&d=identicon&r=PG&f=1", "display_name": "limick", "link": "https://stackoverflow.com/users/8363515/limick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 50308365, "answer_count": 1, "score": 1, "last_activity_date": 1526142211, "creation_date": 1525197606, "question_id": 50121404, "link": "https://stackoverflow.com/questions/50121404/leftjoinf-in-opaleye-and-ifpp", "title": "leftJoinF in Opaleye and IfPP", "body": "<p>I want to use a <code>LEFT JOIN</code> to fetch products and their (optional) attributes.\nI have types like:</p>\n\n<pre><code>type ProductPGR = ProductPoly (Column (PGID Product)) (Column PGText)\ntype ProductAttributePGR = ProductAttributePoly (Column (PGID ProductAttribute)) (Column (PGID Product)) (Column PGInt4)\n</code></pre>\n\n<p>My intention was to use:</p>\n\n<pre><code>  (p :: ProductPGR, pa :: Maybe ProductAttributePGR) &lt;- leftJoinF\n    (\\p' pa' -&gt; (p', Just pa'))\n    (\\p'     -&gt; (p', Nothing))\n    (\\p' pa' -&gt; productId p' .== paProductId pa')\n    productQuery\n    productAttributeQuery -&lt; ()\n</code></pre>\n\n<p>This doesn't compile because:</p>\n\n<pre><code>No instance for (Default\n                     IfPP\n                     (Maybe\n                        (ProductAttributePoly\n                           (Column (PGID ProductAttribute))\n                           (Column (PGID Product))\n                           (Column PGInt4))))\n                     (Maybe\n                        (ProductAttributePoly\n                           (Column (PGID ProductAttribute))\n                           (Column (PGID Product))\n                           (Column PGInt4))))\narising from a use of \u2018leftJoinF\u2019\n</code></pre>\n\n<p>Am I really supposed to define this instance? What is it for and how would I do that?</p>\n\n<p>Or if I'm not supposed to use <code>Maybe</code>, what else would I do?</p>\n"}, {"tags": ["string", "haskell", "ghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525197443, "post_id": 50121310, "comment_id": 87260401, "body": "That&#39;s because you write <code>t = addText t &quot;test&quot;</code>. As a result you thus define <code>t</code> in terms of itself. Note that in Haskell you do not <i>assign</i> to variables, you declare them. If you write <code>r = addText t &quot;test&quot;</code> it will work. But the same holds for <code>m</code> in the function."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 4, "last_activity_date": 1525199975, "last_edit_date": 1525199975, "creation_date": 1525197621, "answer_id": 50121412, "question_id": 50121310, "link": "https://stackoverflow.com/questions/50121310/insert-a-string-starting-at-a-given-index/50121412#50121412", "title": "Insert a string starting at a given index", "body": "<pre><code>let m = drop p m\n</code></pre>\n\n<p>is a circular definition. It doesn't mean \"set <code>m</code> to be smaller than what <code>m</code> was before\", because remember, it is impossible to modify variables in Haskell. Instead, you ignore the existing <code>m</code>, and define a new variable named <code>m</code>, defined in terms of itself: an evaluation which can never be completed. This may seem like a silly feature, but in other situations it is in fact quite useful to define values in terms of themselves, which is why the language allows it.</p>\n\n<p>You then make the same mistake again, with</p>\n\n<pre><code>t = addText t \"test\"\n</code></pre>\n\n<p>defining <code>t</code> in terms of itself.</p>\n\n<p>You can fix both of these errors by using uniquely named variables, e.g.</p>\n\n<pre><code>r = addText t \"test\"\n</code></pre>\n\n<p>at which point you will run into exciting new errors: <code>create</code>'s inferred type signature does not match the inferred type signature for <code>addText</code>, because of type defaulting rules. If you specify explicit type signatures, or inline the definition of <code>create</code>, you will finally get what you wanted:</p>\n\n<pre><code>*Main&gt; addText (\"\",0,0,\"\",\"\") \"test\"\n(\"test\",4,4,\"\",\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1525199721, "post_id": 50121461, "comment_id": 87261608, "body": "You can use <code>splitAt</code> to obtain <code>a</code> and <code>z</code> in one go"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1525197850, "creation_date": 1525197850, "answer_id": 50121461, "question_id": 50121310, "link": "https://stackoverflow.com/questions/50121310/insert-a-string-starting-at-a-given-index/50121461#50121461", "title": "Insert a string starting at a given index", "body": "<p>Like many people new to Haskell, you write functions in an <em>imperative</em> style where you <em>update</em> variables.</p>\n\n<p>A variable in Haskell however can not be updated: you do not <em>(re)assign</em> a value to a variable, you declare a variable. In case you write <code>i = i + 1</code>, you do <em>not</em> take the old value of <code>i</code>, and add <code>1</code> to it, you here declare <code>i</code> in terms of itself, so <code>i = i + 1</code>, means that we have written an infinite deep recursive expression <code>i = ( ( (...) + 1) + 1) + 1</code>.</p>\n\n<p>In your function you seem to update <code>m</code>:</p>\n\n<pre><code>addText (<b>m</b>, l, p, _, k) i = \n    let a = take p <b>m</b>\n        <b>m</b> = drop p <b>m</b>\n        full = a++i++<b>m</b>\n    in (full, length full, p + length i, \"\", k)</code></pre>\n\n<p>So you have written <code>m</code> in terms of itself, and although due to lazyness this will not <em>per se</em> loop, in case the value of <code>m</code> is necessary, we will get stuck into infinite recursion.</p>\n\n<p>By using a new variable, we can solve the problem:</p>\n\n<pre><code>addText (<b>m</b>, l, p, _, k) i = \n    let a = take p <b>m</b>\n        <b>z</b> = drop p <b>m</b>\n        full = a++i++<b>z</b>\n    in (full, length full, p + length i, \"\", k)</code></pre>\n\n<p>The same phenomena occurs if you write:</p>\n\n<pre><code>Prelude&gt; t = addText t \"test\"\n</code></pre>\n\n<p>you again define <code>t</code> in terms of itself. You thus better use another variable or constants:</p>\n\n<pre><code>Prelude&gt; t = addText (\"\",0,0,\"\",\"\") \"test\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9726802, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jack", "link": "https://stackoverflow.com/users/9726802/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 50121412, "answer_count": 2, "score": 1, "last_activity_date": 1525199975, "creation_date": 1525197161, "question_id": 50121310, "link": "https://stackoverflow.com/questions/50121310/insert-a-string-starting-at-a-given-index", "title": "Insert a string starting at a given index", "body": "<p>I am completely new to Haskell. I need to insert a given string at a given index of a string that may already be non-empty.</p>\n\n<p>This is what I have so far. However, after seemingly running with no errors, when I ask what the value of <code>t</code> is ghci just hangs indefinitely.</p>\n\n<p>Haskell:</p>\n\n<p><code>create = (\"\",0,0,\"\",\"\")</code></p>\n\n<pre><code>addText (m,l,p,_,k) i = \n    let a = take p m\n        m = drop p m\n        full = a++i++m\n    in (full, length full, p + length i, \"\", k)\n</code></pre>\n\n<p>Where <code>m</code> is the text to add to, <code>l</code> is the length of <code>m</code> and <code>p</code> is the index to start adding the new string at</p>\n\n<p>Output:</p>\n\n<pre><code>*Main&gt; t = create\n</code></pre>\n\n<p><code>*Main&gt; t</code></p>\n\n<p><code>(\"\",0,0,\"\",\"\")</code></p>\n\n<p><code>*Main&gt; t = addText t \"test\"</code></p>\n\n<p><code>*Main&gt; t</code></p>\n\n<p><code>(hangs)</code></p>\n"}, {"tags": ["list", "haskell", "tuples", "modulo"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1525196214, "post_id": 50121098, "comment_id": 87259828, "body": "But if it is always a pair, then it is usually better to use 2-tuples, since then we enforce that by the type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525196255, "post_id": 50121098, "comment_id": 87259845, "body": "Secondly I have the idea that that you probably want to select it the opposite way: in case <code>selector mod 2</code> is <code>1</code>, then you probably want to select <code>pair[1]</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525197327, "post_id": 50121098, "comment_id": 87260358, "body": "You can also zip with <code>cycle [True, False]</code> so that you don&#39;t have to use <code>mod x 2</code>. Anyway, you should use <code>map</code> on this list (or yours)."}, {"owner": {"reputation": 410, "user_id": 2567875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d40b212881da1bd7d6e6acdce1f6bbb6?s=128&d=identicon&r=PG", "display_name": "user2567875", "link": "https://stackoverflow.com/users/2567875/user2567875"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525197656, "post_id": 50121098, "comment_id": 87260505, "body": "@chi: can you add an example? I dont understand how to use this"}, {"owner": {"reputation": 410, "user_id": 2567875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d40b212881da1bd7d6e6acdce1f6bbb6?s=128&d=identicon&r=PG", "display_name": "user2567875", "link": "https://stackoverflow.com/users/2567875/user2567875"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525197764, "post_id": 50121098, "comment_id": 87260564, "body": "@Willem Van Onsem: maybe, i haven&#39;t figured out what I realy need to do, I only know that I have to select alternating values; but I guess I can&#39;t use tuples because the input is in list form already"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525198837, "post_id": 50121098, "comment_id": 87261146, "body": "@user2567875 You can <code>map ... (zip .. ..)</code> or more directly <code>zipWith .. .. ..</code> as Daniel Wagner did below. In each case you need a suitable function for the <code>map</code> or <code>zipWith</code>."}], "answers": [{"comments": [{"owner": {"reputation": 410, "user_id": 2567875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d40b212881da1bd7d6e6acdce1f6bbb6?s=128&d=identicon&r=PG", "display_name": "user2567875", "link": "https://stackoverflow.com/users/2567875/user2567875"}, "edited": false, "score": 0, "creation_date": 1525416110, "post_id": 50121441, "comment_id": 87354833, "body": "Thanks, can you please explain what the !! and $ do here? I am still struggling with the haskell concepts in general"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 410, "user_id": 2567875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d40b212881da1bd7d6e6acdce1f6bbb6?s=128&d=identicon&r=PG", "display_name": "user2567875", "link": "https://stackoverflow.com/users/2567875/user2567875"}, "edited": false, "score": 1, "creation_date": 1525439161, "post_id": 50121441, "comment_id": 87368339, "body": "@user2567875 You can use <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a> to find documentation for Haskell functions."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1525197757, "creation_date": 1525197757, "answer_id": 50121441, "question_id": 50121098, "link": "https://stackoverflow.com/questions/50121098/how-to-select-element-from-tuple-by-index-in-list/50121441#50121441", "title": "How to select element from tuple by index in list?", "body": "<p>Perhaps:</p>\n\n<pre><code>&gt; zipWith (!!) [[1,2],[3,4],[5,6],[7,8],[9,10]] (cycle [0,1])\n[1,4,5,8,9]\n</code></pre>\n\n<p>If you know you're working with lists of length two inside, you should probably be using pairs instead.</p>\n\n<pre><code>&gt; zipWith ($) (cycle [fst, snd]) [(1,2),(3,4),(5,6),(7,8),(9,10)]\n[1,4,5,8,9]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 1, "last_activity_date": 1525420031, "last_edit_date": 1525420031, "creation_date": 1525381170, "answer_id": 50163764, "question_id": 50121098, "link": "https://stackoverflow.com/questions/50121098/how-to-select-element-from-tuple-by-index-in-list/50163764#50163764", "title": "How to select element from tuple by index in list?", "body": "<p>I like @DanielWagner answer a lot. The first is so simple and effective. His second is a just a little harder to understand but simple, too. When theories are simple, it increases their veracity. Here is my sorry solution but it does use your structure. (Association lists are tuples. It was suggested you use tuples but for this, what you have and probably need is okay.)</p>\n\n<pre><code>a = [(0,[1,2]),(1,[3,4]),(2,[5,6]),(3,[7,8]),(4,[9,10])]\n\n[if even i then x else y | (i,(x:y:z)) &lt;- a]\n\n[1,4,5,8,9]\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 2567875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d40b212881da1bd7d6e6acdce1f6bbb6?s=128&d=identicon&r=PG", "display_name": "user2567875", "link": "https://stackoverflow.com/users/2567875/user2567875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 50121441, "answer_count": 2, "score": 0, "last_activity_date": 1525420031, "creation_date": 1525196133, "question_id": 50121098, "link": "https://stackoverflow.com/questions/50121098/how-to-select-element-from-tuple-by-index-in-list", "title": "How to select element from tuple by index in list?", "body": "<p>I want to select elements from a list, [[1,2],[3,4],[5,6]] once the first, than the second, than again the first and so on. \nI figured that i could use zip to add a counter in front of the pairs and use modulo to select the part, and now my list looks like this:  </p>\n\n<pre><code>let a = [(0,[1,2]),(1,[3,4]),(2,[5,6]),(3,[7,8]),(4,[9,10])]\n</code></pre>\n\n<p>but how can I now select the elements? </p>\n\n<p>the pseudocode would be </p>\n\n<pre><code>for each tuple in list:\n      first part of tuple is the selector, second part is the pair\n      if selector mod 2 : choose pair[0] else choose pair[1]\n</code></pre>\n\n<p>the output for the list a should be: 1,4,5,7,9</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525193878, "post_id": 50120508, "comment_id": 87258674, "body": "I don&#39;t understand the question. What do you mean by &quot;allocated&quot;?"}, {"owner": {"reputation": 279, "user_id": 1211728, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a9162a3dbeebd8ce02c1ec58bfcad215?s=128&d=identicon&r=PG", "display_name": "jayesh hathila", "link": "https://stackoverflow.com/users/1211728/jayesh-hathila"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1525193963, "post_id": 50120508, "comment_id": 87258723, "body": "@melpomene I mean what value will &quot;pre&quot; hold in lets say first iteration of input &quot;ab\\ncd&quot;"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1525194014, "post_id": 50120508, "comment_id": 87258749, "body": "Well, <code>pre</code> is the first component of the return value of <code>break</code> here, so are you asking what <code>break</code> returns?"}], "answers": [{"comments": [{"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1525194138, "post_id": 50120594, "comment_id": 87258798, "body": "Excuse me, I swapped <code>break</code> with <code>splitLines</code> before. It should be fine now."}, {"owner": {"reputation": 279, "user_id": 1211728, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a9162a3dbeebd8ce02c1ec58bfcad215?s=128&d=identicon&r=PG", "display_name": "jayesh hathila", "link": "https://stackoverflow.com/users/1211728/jayesh-hathila"}, "edited": false, "score": 0, "creation_date": 1525195067, "post_id": 50120594, "comment_id": 87259235, "body": "Also any reason why (&#39;\\r&#39;:&#39;\\n&#39;:rest) and not (&quot;\\r\\n&quot;:rest) ?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 279, "user_id": 1211728, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a9162a3dbeebd8ce02c1ec58bfcad215?s=128&d=identicon&r=PG", "display_name": "jayesh hathila", "link": "https://stackoverflow.com/users/1211728/jayesh-hathila"}, "edited": false, "score": 1, "creation_date": 1525195265, "post_id": 50120594, "comment_id": 87259338, "body": "@jayeshhathila <code>&quot;\\r\\n&quot; : rest</code> would be a type error (it would require <code>rest</code> to be a list of strings, not a list of characters). <code>a : b : c</code> parses as <code>a : (b : c)</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525199389, "post_id": 50120594, "comment_id": 87261430, "body": "Just to put @melpomene&#39;s comment another way: <code>(:) :: a -&gt; [a] -&gt; [a]</code>&#39;s left operand is a <i>single thing</i> and its right operand is a <i>list of things</i>. When you specialise <code>a</code> to <code>Char</code> you get <code>(:) :: Char -&gt; String -&gt; String</code>. So the expression <code>&quot;\\r\\n&quot; : rest</code> would fail to type check because in this case <code>(:)</code>&#39;s left argument and its right argument are both <code>String</code>s, which is not valid."}], "tags": [], "owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "is_accepted": false, "score": 2, "last_activity_date": 1525207996, "last_edit_date": 1525207996, "creation_date": 1525193914, "answer_id": 50120594, "question_id": 50120508, "link": "https://stackoverflow.com/questions/50120508/understanding-splitlines-function-in-haskell/50120594#50120594", "title": "Understanding Splitlines function in haskell", "body": "<p>If you would execute <code>break isLineTerminator \"foo\\r\\nbar\"</code>, then <code>pre</code> would be <code>\"foo\"</code> and <code>suf</code> would be <code>\"\\r\\nbar\"</code>. <code>break</code> will ensure that the second argument is split on the first occurrence where <code>isLineTerminator c</code> returns <code>True</code>, including the match that returned <code>True</code> from the passed function (<code>isLineTerminator</code> in this case) on the right-hand side.</p>\n\n<p>Feeding <code>suf</code> into</p>\n\n<pre><code>case suf of \n    ('\\r':'\\n':rest) -&gt; splitLines rest\n    ('\\r':rest)      -&gt; splitLines rest\n    ('\\n':rest)      -&gt; splitLines rest\n    _                -&gt; []\n</code></pre>\n\n<p>will try to remove the linebreaks from <code>suf</code>, while passing the rest (<code>\"bar\"</code>) to <code>splitLines</code> again. <code>pre</code> will be <code>\"bar\"</code> in the recursive call, while <code>suf</code> will be <code>\"\"</code>, thus matching the last case. On the way back it will flatten <code>\"foo\" : \"bar\" : []</code> to <code>[\"foo\", \"bar\"]</code> (cons operator <code>:</code>).</p>\n"}], "owner": {"reputation": 279, "user_id": 1211728, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a9162a3dbeebd8ce02c1ec58bfcad215?s=128&d=identicon&r=PG", "display_name": "jayesh hathila", "link": "https://stackoverflow.com/users/1211728/jayesh-hathila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525207996, "creation_date": 1525193550, "question_id": 50120508, "link": "https://stackoverflow.com/questions/50120508/understanding-splitlines-function-in-haskell", "title": "Understanding Splitlines function in haskell", "body": "<p>Below is the code segment I am trying to understand:</p>\n\n<pre><code>splitLines [] = []\nsplitLines cs =\n    let (pre, suf) = break isLineTerminator cs\n    in  pre : case suf of \n                ('\\r':'\\n':rest) -&gt; splitLines rest\n                ('\\r':rest)      -&gt; splitLines rest\n                ('\\n':rest)      -&gt; splitLines rest\n                _                -&gt; []\n\nisLineTerminator c = c == '\\r' || c == '\\n'\n</code></pre>\n\n<p>What I am not able to wrap my head around is what value will be allocated to \"pre\" in \"pre :\". If I am right \":\" is used to append so \"pre\" should be prefix, but of what value ?</p>\n"}, {"tags": ["haskell", "archlinux", "window-managers", "xmonad"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1525189880, "post_id": 50119141, "comment_id": 87256535, "body": "What are you error messages, how did you install xmonad?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1525200505, "post_id": 50119141, "comment_id": 87262023, "body": "Weird. This just happened to me a few times when I tried to recompile via my keybinding. After that I tried it from the terminal and it ran fine, and now the keybinding works again."}, {"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "edited": false, "score": 0, "creation_date": 1525217716, "post_id": 50119141, "comment_id": 87268516, "body": "I installed xmonad  and xmonad -contrib via pacman. I also tried building xmonad with stack, and providing the absolute path of built xmonad in xsession, which didn&#39;t seem to fix the issue."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1525280393, "post_id": 50119141, "comment_id": 87298055, "body": "Related maybe? <a href=\"https://stackoverflow.com/questions/22390858/xmonad-cant-find-module-xmonad-or-any-other\" title=\"xmonad cant find module xmonad or any other\">stackoverflow.com/questions/22390858/&hellip;</a>"}, {"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1525378414, "post_id": 50119141, "comment_id": 87344239, "body": "@DarthFennec related .. yes. but none of the solutions work."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525616806, "post_id": 50119141, "comment_id": 87418069, "body": "How many ghcs do you have and which one is in your PATH? What does <code>type -a ghc</code> say?"}, {"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525627564, "post_id": 50119141, "comment_id": 87421843, "body": "@melpomene i have added the output."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525628664, "post_id": 50119141, "comment_id": 87422151, "body": "@sidhartharya Then if you installed xmonad with pacman, it&#39;s only visible to <code>&#47;usr&#47;bin&#47;ghc</code> (the system ghc), not <code>&#47;usr&#47;local&#47;bin&#47;ghc</code> (the one you get when you just run <code>ghc</code> on the command line)."}, {"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525721798, "post_id": 50119141, "comment_id": 87459875, "body": "@melpomene so should i delete /usr/local/bin/ghc???"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525721967, "post_id": 50119141, "comment_id": 87459942, "body": "@sidhartharya Why do you have a <code>&#47;usr&#47;local&#47;bin&#47;ghc</code> in the first place? You could probably also install XMonad in your local ghc."}, {"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525729502, "post_id": 50119141, "comment_id": 87463340, "body": "@melpomene i have no idea. beacause stack and cabal install it at home directory. it must be pacman thing, or maybe i tried building from source. Thanks though i ll try your solution."}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1526028189, "post_id": 50119141, "comment_id": 87592796, "body": "Does not look like Xmonad is installed. What is the output of <code>pacman -Ql xmonad</code>?"}, {"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1526248510, "post_id": 50119141, "comment_id": 87657832, "body": "@ChrisStryczynski added"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "edited": false, "score": 0, "creation_date": 1525627618, "post_id": 50200631, "comment_id": 87421857, "body": "I tried cabal install and stack install. I cannot fix the issue still."}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "edited": false, "score": 0, "creation_date": 1525632566, "post_id": 50200631, "comment_id": 87423561, "body": "what is the output of <code>ghc-pkg list</code>?"}, {"owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "edited": false, "score": 0, "creation_date": 1525721652, "post_id": 50200631, "comment_id": 87459804, "body": "I have added the output of the ghc-pkg list"}], "tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 0, "last_activity_date": 1525615952, "creation_date": 1525615952, "answer_id": 50200631, "question_id": 50119141, "link": "https://stackoverflow.com/questions/50119141/cannot-compile-xmonad-hs-file/50200631#50200631", "title": "Cannot compile xmonad.hs file", "body": "<p>Probably some issue with the XMonad package on Arch linux. </p>\n\n<p>As an alternative you could try <code>pacman -s haskell-cabal</code> and <code>cabal install xmonad</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 8809295, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v32PX9GylSo/AAAAAAAAAAI/AAAAAAAAAX8/HHOv-w-dPA4/photo.jpg?sz=128", "display_name": "Pedro Queiroga", "link": "https://stackoverflow.com/users/8809295/pedro-queiroga"}, "is_accepted": false, "score": 1, "last_activity_date": 1614117996, "last_edit_date": 1614117996, "creation_date": 1614117606, "answer_id": 66341729, "question_id": 50119141, "link": "https://stackoverflow.com/questions/50119141/cannot-compile-xmonad-hs-file/66341729#66341729", "title": "Cannot compile xmonad.hs file", "body": "<p>SLIGHTLY RELATED,</p>\n<p>In a fresh install of <strong>UBUNTU 20.10</strong> I had this issue when I installed xmonad through apt with <code>sudo apt install xmonad</code>. I think this also installed xmonad-contrib, which is located here <a href=\"https://launchpad.net/ubuntu/+source/xmonad-contrib\" rel=\"nofollow noreferrer\"><code>libghc-xmonad-contrib-dev</code></a>, because I already had that when I tried installing it to see if it fixed. What finally fixed it in the end was cabal-installing xmonad and xmonad-contrib with <code>cabal install xmonad</code> then <code>cabal install --lib xmonad-contrib</code>, alongside with creating a build command in <code>~/.xmonad/build</code>.</p>\n<p>Content of <code>~/.xmonad/build</code>:</p>\n<pre><code>ghc -package xmonad -package xmonad-contrib --make xmonad.hs -i -ilib -main-is main -fforce-recomp -o xmonad\n</code></pre>\n<p>Here is my command history if it is of any help:</p>\n<pre class=\"lang-sh prettyprint-override\"><code> 1912  ghc-pkg list # to check the output, just as in the question\n 1913  cabal install xmonad\n 1914  xmonad --recompile\n 1915  cabal install xmonad-contrib\n 1916  cabal install --lib xmonad-contrib # the previous line gave a warning, so I issued a corrected command.\n 1917  xmonad --recompile\n 1918  ghc -package xmonad ~/.xmonad/monad.hs\n 1919  ghc -package xmonad ~/.xmonad/xmonad.hs # the previous line had a typo, so I had to issue the command again.\n 1920  xmonad --recompile\n 1921  nano .xmonad/build # when I tried the previous command, it said something about creating the following file, so I created it.\n 1922  xmonad --recompile\n 1923  chmod u+x .xmonad/build # when I tried the previous command, it complained about the file not being executable and recommended those permissions.\n 1924  xmonad --recompile # worked!!!\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 9204788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LHM0Qxcydzc/AAAAAAAAAAI/AAAAAAAAAW4/tLAkY0fvWZ4/photo.jpg?sz=128", "display_name": "sidharth arya", "link": "https://stackoverflow.com/users/9204788/sidharth-arya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1769, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1614117996, "creation_date": 1525188125, "last_edit_date": 1526248479, "question_id": 50119141, "link": "https://stackoverflow.com/questions/50119141/cannot-compile-xmonad-hs-file", "title": "Cannot compile xmonad.hs file", "body": "<p>I am using xmonad on top of an arch based system. But after upgrading i am not able to compile my xmonad.hs file via </p>\n\n<p><code>$ xmonad --recompile</code></p>\n\n<p>I seem to be getting error on every module of xmonad, even import XMonad doesn't seem to work. \nIf anyone has fixed this issue somehow please let me know. </p>\n\n<h3>Error Messages:</h3>\n\n<pre><code>Error detected while loading xmonad configuration file: \n/home/arya/.xmonad/xmonad.hs\n\nxmonad.hs:2:1: error:\n    Could not find module \u2018XMonad\u2019\n    Use -v to see a list of the files searched for.\n  |\n2 | import XMonad\n  | ^^^^^^^^^^^^^\n\nxmonad.hs:3:1: error:\n    Could not find module \u2018XMonad.Config.Mate\u2019\n    Use -v to see a list of the files searched for.\n  |\n3 | import XMonad.Config.Mate\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^\n\nxmonad.hs:5:1: error:\n    Could not find module \u2018XMonad.StackSet\u2019\n    Use -v to see a list of the files searched for.\n  |\n5 | import qualified XMonad.StackSet as W\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nxmonad.hs:8:1: error:\n    Could not find module \u2018XMonad.Hooks.ManageDocks\u2019\n    Use -v to see a list of the files searched for.\n  |\n8 | import XMonad.Hooks.ManageDocks\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nxmonad.hs:9:1: error:\n    Could not find module \u2018XMonad.Hooks.EwmhDesktops\u2019\n    Use -v to see a list of the files searched for.\n  |\n9 | import XMonad.Hooks.EwmhDesktops\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nxmonad.hs:10:1: error:\n    Could not find module \u2018XMonad.Layout.Minimize\u2019\n    Use -v to see a list of the files searched for.\n   |\n10 | import XMonad.Layout.Minimize\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nPlease check the file for errors.\n\n[arya@localhost ~]$ Warning: Missing charsets in String to FontSet \nconversion\n[arya@localhost ~]$ \nmonad.hs:9:1: error:\n    Could not find module \u2018XMonad.Hooks.EwmhDesktops\u2019\n    Use -v to see a list of the files searched for.\n  |\n9 | import XMonad.Hooks.EwmhDesktops\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nxmonad.hs:10:1: error:\n    Could not find module \u2018XMonad.Layout.Minimize\u2019\n    Use -v to see a list of the files searched for.\n   |\n10 | import XMonad.Layout.Minimize\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<h3>Output:</h3>\n\n<p><code>$ type -a ghc</code></p>\n\n<pre><code>ghc is /usr/local/bin/ghc\nghc is /usr/bin/ghc\n</code></pre>\n\n<p>Output of\n<code>$  ghc-pkg list</code>\n:</p>\n\n<pre><code> /usr/local/haskell/ghc-8.2.2-x86_64/lib/ghc-8.2.2/package.conf.d\n    Cabal-2.0.1.0\n    array-0.5.2.0\n    base-4.10.1.0\n    binary-0.8.5.1\n    bytestring-0.10.8.2\n    containers-0.5.10.2\n    deepseq-1.4.3.0\n    directory-1.3.0.2\n    filepath-1.4.1.2\n    (ghc-8.2.2)\n    ghc-boot-8.2.2\n    ghc-boot-th-8.2.2\n    ghc-compact-0.1.0.0\n    ghc-prim-0.5.1.1\n    ghci-8.2.2\n    haskeline-0.7.4.0\n    hoopl-3.10.2.2\n    hpc-0.6.0.3\n    integer-gmp-1.0.1.0\n    pretty-1.1.3.3\n    process-1.6.1.0\n    rts-1.0\n    template-haskell-2.12.0.0\n    terminfo-0.4.1.0\n    time-1.8.0.2\n    transformers-0.5.2.0\n    unix-2.7.2.2\n    xhtml-3000.2.2\n</code></pre>\n\n<p>Output for pacman -Ql xmonad :</p>\n\n<pre><code>xmonad /usr/\nxmonad /usr/bin/\nxmonad /usr/bin/xmonad\nxmonad /usr/lib/\nxmonad /usr/lib/ghc-8.2.2/\nxmonad /usr/lib/ghc-8.2.2/site-local/\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/Paths_xmonad.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/Config.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/Core.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/Layout.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/Main.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/ManageHook.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/Operations.dyn_hi\nxmonad /usr/lib/ghc-8.2.2/site-local/xmonad-0.13/XMonad/StackSet.dyn_hi\nxmonad /usr/lib/libHSxmonad-0.13-K842KXy8eLK2djQHd55ZyZ-ghc8.2.2.so\nxmonad /usr/share/\nxmonad /usr/share/doc/\nxmonad /usr/share/doc/xmonad/\nxmonad /usr/share/doc/xmonad/LICENSE\nxmonad /usr/share/haskell/\nxmonad /usr/share/haskell/register/\nxmonad /usr/share/haskell/register/xmonad.sh\nxmonad /usr/share/haskell/unregister/\nxmonad /usr/share/haskell/unregister/xmonad.sh\nxmonad /usr/share/licenses/\nxmonad /usr/share/licenses/xmonad/\nxmonad /usr/share/licenses/xmonad/LICENSE\nxmonad /usr/share/man/\nxmonad /usr/share/man/man1/\nxmonad /usr/share/man/man1/xmonad.1.gz\nxmonad /usr/share/pixmaps/\nxmonad /usr/share/pixmaps/xmonad.svg\nxmonad /usr/share/xmonad/\nxmonad /usr/share/xmonad/man/\nxmonad /usr/share/xmonad/man/xmonad.1\nxmonad /usr/share/xmonad/man/xmonad.1.html\nxmonad /usr/share/xmonad/man/xmonad.hs\nxmonad /usr/share/xsessions/\nxmonad /usr/share/xsessions/xmonad.desktop\n</code></pre>\n"}, {"tags": ["haskell", "types", "functional-programming", "ghc"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525185738, "post_id": 50118536, "comment_id": 87254306, "body": "Because there are multiple errors..."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1525186043, "post_id": 50118536, "comment_id": 87254476, "body": "I only get two errors (both on line 3) when I <a href=\"https://ideone.com/zhWQvD\" rel=\"nofollow noreferrer\">try your code online</a>"}, {"owner": {"reputation": 205, "user_id": 9725978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e07d302414b4f9bcd4aa5face22e07e1?s=128&d=identicon&r=PG", "display_name": "Mark Wildon", "link": "https://stackoverflow.com/users/9725978/mark-wildon"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1525186147, "post_id": 50118536, "comment_id": 87254521, "body": "@sepp2k That&#39;s interesting. I notice that ideone uses GHC 8.0.1. I compiled with GHC 7.8.4. Maybe the bug (if it is one) has been fixed."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1525186169, "post_id": 50118536, "comment_id": 87254531, "body": "GHC 7.8.4 is pretty old. Maybe it had a bug regarding reporting warnings as errors if there were other errors.  Or maybe it&#39;s reporting it as a warning and you&#39;re just misreading? That line should certainly be resulting in a warning about defaulting an ambiguous type, in normal GHC operation."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1525186891, "post_id": 50118536, "comment_id": 87254903, "body": "Great question -- precise, minimal, all the details needed to try it ourselves. I upvote questions pretty rarely, but this one deserved it."}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1525187905, "post_id": 50118781, "comment_id": 87255491, "body": "The moral of the story is: keep your compiler updated."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525188598, "post_id": 50118781, "comment_id": 87255850, "body": "I clearly remember an old GHC version (could indeed be 7.8) where the first error in a file often caused several false errors to be reported later on. In that period, I learned to ignore all the errors but the first one. This was fixed in newer compilers."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1525186744, "creation_date": 1525186744, "answer_id": 50118781, "question_id": 50118536, "link": "https://stackoverflow.com/questions/50118536/why-does-the-glasgow-haskell-compiler-report-multiple-type-errors-here/50118781#50118781", "title": "Why does the Glasgow Haskell Compiler report multiple type errors here?", "body": "<p>Looks like a bug to me. I can confirm the behavior you describe appears in 7.8.4, but does not in 7.10.3, 8.0.2, 8.2.2, or 8.4.2, all of which have either zero or two errors, not zero or three.</p>\n"}], "owner": {"reputation": 205, "user_id": 9725978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e07d302414b4f9bcd4aa5face22e07e1?s=128&d=identicon&r=PG", "display_name": "Mark Wildon", "link": "https://stackoverflow.com/users/9725978/mark-wildon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 50118781, "answer_count": 1, "score": 5, "last_activity_date": 1525186744, "creation_date": 1525185706, "last_edit_date": 1525186108, "question_id": 50118536, "link": "https://stackoverflow.com/questions/50118536/why-does-the-glasgow-haskell-compiler-report-multiple-type-errors-here", "title": "Why does the Glasgow Haskell Compiler report multiple type errors here?", "body": "<p>Consider the following Haskell code</p>\n\n<pre><code>module TypeErrors where\nf xs = [True | _ &lt;- repeat 0]\nx = (x, x)\n</code></pre>\n\n<p>The Glasgow Haskell Compiler (version 7.8.4) gives three type errors. The second and third arise from the infinite type implied by line 3. The first is</p>\n\n<pre><code>TypeErrors.hs:2:32:\n    No instance for (Num t0) arising from the literal \u20180\u2019\n    The type variable \u2018t0\u2019 is ambiguous\n</code></pre>\n\n<p>After commenting out line 3, the module compiles as expected. I'd like to understand better how GHC performs its miracles. So my question is:</p>\n\n<blockquote>\n  <p>Why does GHC object to line 2 if and only if line 3 is present?</p>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1525183660, "post_id": 50117726, "comment_id": 87253193, "body": "<code>parseCSV</code> isn&#39;t your issue. Think more closely about the type of <code>either</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1525184577, "post_id": 50117726, "comment_id": 87253656, "body": "That... is not what the error says. 1. Read it carefully; GHC&#39;s error messages are generally both very precise and very informative. 2. Proper etiquette here on SO is to copy-and-paste errors; attempts to summarize them when you don&#39;t understand them in the first place are doomed to failure."}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1525184646, "post_id": 50117726, "comment_id": 87253696, "body": "There&#39;s quite a lot going wrong here. You need to take this function apart and study the types of the things you&#39;re using. Copying and modifying solutions from the book may not be a good idea if you&#39;re still new to the language."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1525185179, "post_id": 50117726, "comment_id": 87253974, "body": "I second the comment by @DanielWagner. We can&#39;t reproduce your error using GHC since you did not provide the full code, nor a MCVE. And, even if we could, you should try to minimize the effort required for an answer: it costs you only a little time to cut&amp;paste the error, and point out the relevant line."}], "answers": [{"comments": [{"owner": {"reputation": 479, "user_id": 4496701, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-SST61v329Q0/AAAAAAAAAAI/AAAAAAAAAFM/ihwdZ1nZE7Q/photo.jpg?sz=128", "display_name": "Cliff Stamp", "link": "https://stackoverflow.com/users/4496701/cliff-stamp"}, "edited": false, "score": 0, "creation_date": 1525221235, "post_id": 50118366, "comment_id": 87269260, "body": "Thanks, I figured it was something that simple, I just can&#39;t parse out the error messages that readily yet. Now it is clear, either required a function (desiring to generate a Left in this case) and I was passing it a Left directly, hence the mismatch. In the book code, it actually had handleCSVError == Left &quot;This does not appear to be a CSV file.&quot; which just threw an error directly as it could not parse it. I guess that was a typo,  _ = vs == ."}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 1, "last_activity_date": 1525185140, "creation_date": 1525185140, "answer_id": 50118366, "question_id": 50117726, "link": "https://stackoverflow.com/questions/50117726/type-mismatch-in-example-from-learning-haskell-through-data-analysis/50118366#50118366", "title": "Type mismatch in example from Learning Haskell through Data Analysis", "body": "<p>Let's focus on this part of your code: </p>\n\n<pre><code>return $ either handleCSVError (\\csv -&gt; applyToColumnInCSV func csv column) records\n  where\n    handleCSVError = Left \"This does not appear to be a CSV file.\"\n</code></pre>\n\n<p>As @DanielWagner noted in the comments, you misquoted your error message which actually reads: </p>\n\n<blockquote>\n  <p>\u2022 Couldn't match expected type <code>parsec3.1.13.0:Text.Parsec.Error.ParseError -&gt; Either String b</code>\n                    with actual type <code>Either [Char] b0</code></p>\n</blockquote>\n\n<p>The error message continues to point you to your definition of <code>handleCSVError</code>. You didn't apply a type to it, but let's add one to make more sense of the error message: </p>\n\n<pre><code>return $ either handleCSVError (\\csv -&gt; applyToColumnInCSV func csv column) records\n  where \n    handleCSVError :: Either String _\n    handleCSVError = Left \"This does not appear to be a CSV file.\"\n</code></pre>\n\n<p>I'm using a type hole for the right component of the either since we don't actually care what it is here, and remember that in Haskell <code>[Char]</code> and <code>String</code> are the same type.</p>\n\n<p>Now, let's look at the type of <a href=\"https://www.haskell.org/hoogle/?hoogle=either\" rel=\"nofollow noreferrer\"><code>either :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c</code></a>. </p>\n\n<p>The first argument of <code>either</code> is a <em>function</em> which takes in something of the left type of your <code>Either</code>, and returns the output type. But you've defined <code>handleCSVError</code> as a static function with no arguments. It has the correct output type <code>c</code> of <code>Either String _</code> from your larger function, but doesn't specify the argument. There are two ways to fix this: </p>\n\n<ol>\n<li>Use <a href=\"https://www.haskell.org/hoogle/?hoogle=const\" rel=\"nofollow noreferrer\"><code>const</code></a>: <code>... either (const handleCSVError) ...</code> </li>\n<li><p>Throw away the first argument in your definition of <code>handleCSVError</code>: </p>\n\n<pre><code>handleCSVError :: ParseError -&gt; Either String _\nhandleCSVError _ = Left \"This does not appear to be a CSV file.\"\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 479, "user_id": 4496701, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-SST61v329Q0/AAAAAAAAAAI/AAAAAAAAAFM/ihwdZ1nZE7Q/photo.jpg?sz=128", "display_name": "Cliff Stamp", "link": "https://stackoverflow.com/users/4496701/cliff-stamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50118366, "answer_count": 1, "score": 0, "last_activity_date": 1540748745, "creation_date": 1525182730, "question_id": 50117726, "link": "https://stackoverflow.com/questions/50117726/type-mismatch-in-example-from-learning-haskell-through-data-analysis", "title": "Type mismatch in example from Learning Haskell through Data Analysis", "body": "<p>I have a <em>basic</em> knowledge of Haskell (LYAH) and wanted to look at this book to expand my Haskell, plus the general topic is something I enjoy. However it didn't take long before I ran into a type issue :</p>\n\n<pre><code>applyToColumnInCSVFile :: ([String] -&gt; b) -&gt; FilePath -&gt; String -&gt; IO (Either String b)\napplyToColumnInCSVFile func inFileName column = do\n  input &lt;- readFile inFileName\n  let records = parseCSV inFileName input\n  return $ either handleCSVError (\\csv -&gt; applyToColumnInCSV func csv column) records\n    where\n      handleCSVError = Left \"This does not appear to be a CSV file.\"\n</code></pre>\n\n<p>It complains that handleCSVError is expected to be <code>Text.Parsec.Error.ParseError</code> but actually is Either [Char] b0' .</p>\n\n<p>This is where I hit a wall on trying to figure out the solution to these error messages. I can actually follow the code at a high level in this book, but if I make a small error in writing the code, or there is some other small problem I can not so easily recover.</p>\n\n<p>In the above I have possibly narrowed it down to an issue with parseCSV because when I check that :</p>\n\n<p><a href=\"http://hackage.haskell.org/package/csv-0.1.2/docs/Text-CSV.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/csv-0.1.2/docs/Text-CSV.html</a></p>\n\n<p>It shows it can return a ParseError, but I don't know how to resolve the issue.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525182163, "post_id": 50117561, "comment_id": 87252357, "body": "The code you post works. Perhaps you mixed up spaces and tabs. What happens if you post your code in the question back into the file?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1525182283, "post_id": 50117561, "comment_id": 87252438, "body": "@WillemVanOnsem It works <i>now</i> because your edit modified the indentation..."}, {"owner": {"reputation": 19, "user_id": 9300718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f484f99491707d31e487ab93bf5ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahat Batool", "link": "https://stackoverflow.com/users/9300718/rahat-batool"}, "edited": false, "score": 0, "creation_date": 1525182298, "post_id": 50117561, "comment_id": 87252452, "body": "The spaces are same in my code as I posted but it creates the same error and can&#39;t work"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525182412, "post_id": 50117561, "comment_id": 87252500, "body": "@RahatBatool: ah, I had the idea that this was more SO that formatted it the wrong way. Anyway, you need to add at least one spaces to inline a <code>do</code> block."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1525182500, "post_id": 50117561, "comment_id": 87252551, "body": "@DanielWagner <a href=\"https://ideone.com/e65yYm\" rel=\"nofollow noreferrer\">The original unindented version works too</a>, though I&#39;m not exactly sure why."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1525182639, "post_id": 50117561, "comment_id": 87252623, "body": "@sepp2k The original version isn&#39;t unindented (click &quot;source&quot; next to the original to see the actual indentation -- bad on SO for screwing this up so badly on a code-specific site!). But the unindented version works because the <a href=\"https://prime.haskell.org/wiki/NondecreasingIndentation\" rel=\"nofollow noreferrer\">NondecreasingIndentation</a> Haskell Prime proposal was accepted into Haskell 2010. This also motivates the &quot;for beginners&quot; condition in my answer; without that modification to the standard, I would just say categorically to indent <code>do</code> blocks deeper."}, {"owner": {"reputation": 19, "user_id": 9300718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f484f99491707d31e487ab93bf5ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahat Batool", "link": "https://stackoverflow.com/users/9300718/rahat-batool"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525182784, "post_id": 50117561, "comment_id": 87252709, "body": "@WillemVanOnsem Thanks alot"}, {"owner": {"reputation": 19, "user_id": 9300718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f484f99491707d31e487ab93bf5ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahat Batool", "link": "https://stackoverflow.com/users/9300718/rahat-batool"}, "edited": false, "score": 0, "creation_date": 1525182851, "post_id": 50117561, "comment_id": 87252748, "body": "It is working now. Next time I take care of indentation"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525185074, "post_id": 50117561, "comment_id": 87253916, "body": "always use explicit <code>{</code>, <code>;</code>, and <code>}</code>, and you will never have these  problems."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1525261743, "post_id": 50117652, "comment_id": 87285819, "body": "Oh dear, I&#39;ve just had a horrible thought. There is a smaller edit still that fixes it -- just a single character insertion. But it&#39;s too awful to include."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1525182982, "last_edit_date": 1525182982, "creation_date": 1525182424, "answer_id": 50117652, "question_id": 50117561, "link": "https://stackoverflow.com/questions/50117561/why-the-error-last-generator-in-do-must-be-an-expression-occurs/50117652#50117652", "title": "Why the error &quot;Last generator in do {...} must be an expression&quot; occurs?", "body": "<p>In your original question, your four lines had these indentations:</p>\n\n<ol>\n<li>four spaces</li>\n<li>four spaces</li>\n<li>one tab</li>\n<li>one tab</li>\n</ol>\n\n<p>At a guess, the indentation of (1) was inserted by StackOverflow's \"insert code\" button, so your original source probably had this indentation:</p>\n\n<ol>\n<li>zero spaces</li>\n<li>four spaces</li>\n<li>one tab</li>\n<li>one tab</li>\n</ol>\n\n<p>GHC treats tabs as expanding to an eight-space tabstop, but each of the lines in a <code>do</code> block must align with each other (and for beginners, should be indented deeper than the enclosing block). Therefore I recommend one of these two solutions:</p>\n\n<ol>\n<li>zero spaces</li>\n<li>one tab</li>\n<li>one tab</li>\n<li>one tab</li>\n</ol>\n\n<p>OR</p>\n\n<ol>\n<li>zero spaces</li>\n<li>four spaces</li>\n<li>four spaces</li>\n<li>four spaces</li>\n</ol>\n\n<p>The following would also work (and is the smallest edit to the original by most sensible metrics), but I strongly recommend against it.</p>\n\n<ol>\n<li>zero spaces</li>\n<li>eight spaces</li>\n<li>one tab</li>\n<li>one tab</li>\n</ol>\n\n<p>See <a href=\"https://stackoverflow.com/questions/35855170/why-shouldnt-i-mix-tabs-and-spaces\">Why shouldn't I mix tabs and spaces?</a> for further discussion of whitespace style.</p>\n"}], "owner": {"reputation": 19, "user_id": 9300718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f484f99491707d31e487ab93bf5ce1c?s=128&d=identicon&r=PG&f=1", "display_name": "Rahat Batool", "link": "https://stackoverflow.com/users/9300718/rahat-batool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "closed_date": 1525245112, "answer_count": 1, "score": 2, "last_activity_date": 1525182982, "creation_date": 1525182051, "last_edit_date": 1525182122, "question_id": 50117561, "link": "https://stackoverflow.com/questions/50117561/why-the-error-last-generator-in-do-must-be-an-expression-occurs", "closed_reason": "Not suitable for this site", "title": "Why the error &quot;Last generator in do {...} must be an expression&quot; occurs?", "body": "<p>I am new in Haskell and during writing a small code in haskell, I faced an error named </p>\n\n<pre><code>Last generator in do {...} must be an expression\n</code></pre>\n\n<p>I tried hard to remove this error but failed. </p>\n\n<p>I visit the stack overflow for this error and I found but the answer was given too much large and complex so I can't understand.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9157174/haskell-last-generator-in-do-must-be-an-expression-error-typed-binding-err\">It is the link where I found about this error</a></p>\n\n<p>My code is </p>\n\n<pre><code>main = do\n    putStrLn \"What is your name?\"\n    name &lt;- getLine\n    putStrLn (\"Name of customer is \"++ name)\n</code></pre>\n\n<p>Anybody can help me so this error can be resolved and your help must be appreciated </p>\n"}, {"tags": ["list", "haskell", "split", "fold"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1525178458, "post_id": 50116582, "comment_id": 87250466, "body": "Voting as unclear what you&#39;re asking because it&#39;s unclear what you&#39;re asking. You should at minimum include a description of the problem you&#39;re having as well as what your attempts to solve it so far were."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525218037, "post_id": 50116582, "comment_id": 87268599, "body": "this question is a duplicate of <a href=\"https://stackoverflow.com/questions/3707753/haskell-split-even-and-odd-elements-into-tuple\" title=\"haskell split even and odd elements into tuple\">stackoverflow.com/questions/3707753/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525186225, "post_id": 50116706, "comment_id": 87254560, "body": "I guess we can generalise it to something like <code>insertAndSwap x (xss,[]) = insertAndSwap x ([],reverse xss)</code> <code>insertAndSwap x (yss,(zs:zss)) = ((x:zs):yss, zss)</code> <code>split n | n &gt; 0 = (\\(x,y) -&gt; x ++ reverse y) . foldr swap ([], replicate n [])</code>"}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525186617, "post_id": 50116706, "comment_id": 87254750, "body": "Do you want just want the same thing with triples? <code>foldr (\\x (l1,l2,l3) -&gt; (x:l2,l3,l1)) ([],[],[])</code>? I think I&#39;m missing something."}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525186964, "post_id": 50116706, "comment_id": 87254945, "body": "<code>foldr (\\x (l1,l2,l3) -&gt; (x:l3,l1,l2)) ([],[],[]) [1..10]</code> then. By &quot;missing something&quot; I mean that I have no clue why you&#39;re asking the question."}], "tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 2, "last_activity_date": 1525178651, "creation_date": 1525178651, "answer_id": 50116706, "question_id": 50116582, "link": "https://stackoverflow.com/questions/50116582/spliting-a-list-in-haskell-with-fold/50116706#50116706", "title": "Spliting a list in Haskell with fold?", "body": "<p>This is relatively straight-forward. We know the type of our \"seed\" for the fold, it must be a pair of lists. We alternate which list of the two lists we're appending to by simply swapping the two lists, and we append to list on the left (which will change between each iteration).</p>\n\n<pre><code>foldr (\\x (ys,zs) -&gt; (x:zs, ys)) ([],[]) [2,4,6,8,7]  -- ([2,6,7],[4,8])\n</code></pre>\n\n<p>If we were to use <code>foldl</code> the lists would come out backwards, so <code>foldr</code> seems like the logical choice.</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 5771177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f66c6628f434a7998195c89f2af5427b?s=128&d=identicon&r=PG&f=1", "display_name": "suffi", "link": "https://stackoverflow.com/users/5771177/suffi"}, "is_accepted": false, "score": 1, "last_activity_date": 1525181817, "creation_date": 1525181817, "answer_id": 50117496, "question_id": 50116582, "link": "https://stackoverflow.com/questions/50116582/spliting-a-list-in-haskell-with-fold/50117496#50117496", "title": "Spliting a list in Haskell with fold?", "body": "<p>Given a predicate <code>p :: a -&gt; Bool</code> you can split on that using <code>foldr</code> as follows: </p>\n\n<pre><code>split :: (a -&gt; Bool) -&gt; [a] -&gt; ([a],[a])\nsplit p = foldr (\\x (as, bs) -&gt; if p x then (x:as, bs) else (as, x:bs)) ([],[])\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; split (\\x -&gt; x `mod` 4 /= 0) [2,4,6,8,7]\n([2,6,7],[4,8])\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8168791, "user_type": "registered", "profile_image": "https://graph.facebook.com/1685691695074031/picture?type=large", "display_name": "Marcos Ayala", "link": "https://stackoverflow.com/users/8168791/marcos-ayala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "closed_date": 1525184784, "answer_count": 2, "score": -5, "last_activity_date": 1525185308, "creation_date": 1525178198, "last_edit_date": 1525185308, "question_id": 50116582, "link": "https://stackoverflow.com/questions/50116582/spliting-a-list-in-haskell-with-fold", "closed_reason": "Needs more focus", "title": "Spliting a list in Haskell with fold?", "body": "<p>Need to implement a split with <code>foldl</code> or <code>foldr</code>. </p>\n\n<p>For example: split <code>[2, 4, 6, 8, 7]</code> into <code>([2, 6, 7], [4, 8])</code>.</p>\n"}, {"tags": ["algorithm", "haskell", "non-deterministic"], "comments": [{"owner": {"reputation": 137, "user_id": 5771177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f66c6628f434a7998195c89f2af5427b?s=128&d=identicon&r=PG&f=1", "display_name": "suffi", "link": "https://stackoverflow.com/users/5771177/suffi"}, "edited": false, "score": 0, "creation_date": 1525187800, "post_id": 50115770, "comment_id": 87255429, "body": "If you need to store an arbitrary number of only one type of data in a structure, you probably want to use some kind of list, instead of a tuple. Consider e.g. <code>Maybe [Int]</code> or <code>Maybe (Vector Int)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2192, "user_id": 2480092, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/97f4cd231024913afd99cbe69655a963?s=128&d=identicon&r=PG", "display_name": "TheEnvironmentalist", "link": "https://stackoverflow.com/users/2480092/theenvironmentalist"}, "edited": false, "score": 0, "creation_date": 1525176894, "post_id": 50115915, "comment_id": 87249701, "body": "For future reader&#39;s sake, mind adding some info on how this works?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1525177250, "post_id": 50115915, "comment_id": 87249860, "body": "In the &quot;no-<code>Ord</code>-available&quot; case, one can write <code>twoEqual xs = xs == Data.List.nub xs</code>. I like this for its brevity and modularity; especially because once you understand it, you can immediately write down the &quot;<code>Ord</code>-available&quot; case in an almost identical matter: <code>twoEquals xs_ = xs == Data.List.Ordered.nub xs where xs = sort xs_</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1525177234, "last_edit_date": 1525177234, "creation_date": 1525175103, "answer_id": 50115915, "question_id": 50115770, "link": "https://stackoverflow.com/questions/50115770/identifying-duplicates-in-haskell-tuples/50115915#50115915", "title": "Identifying duplicates in Haskell tuples", "body": "<p>We can first produce a list of <code>Int</code>s and then perform all equality checks:</p>\n\n<pre><code>import Data.List(tails)\n\ntwoEqual :: Eq a =&gt; [a] -&gt; Bool\ntwoEqual xs = any (uncurry elem) [(h, t) | (h:t) &lt;- tails xs]\n</code></pre>\n\n<p>Here we first generate for every element in the list a tuple containing the element and the <em>rest</em> of the list. Then we perform <code>elem</code> functions: we call <code>elem</code> on the item and the rest of the list and in case <code>any</code> of these checks holds, then we return <code>True</code>, <code>False</code> otherwise.</p>\n\n<p>So now we can construct a list from this tuple and then use a guard to perform the checks:</p>\n\n<pre><code>nothingIfMatch :: Eq a =&gt; Maybe (a, a, a, a, a) -&gt; Maybe (a, a, a, a, a)\nnothingIfMatch = (&gt;&gt;= f)\n    where f r@(a, b, c, d, e) | twoEqual [a, b, c, d, e] = Nothing\n                              | otherwise = Just r\n</code></pre>\n\n<p>We can easily add one extra element to the tuple and add it to the list in the <code>twoEqual</code> call. Here we still perform <em>O(n<sup>2</sup>)</em>. We can do it in <em>O(n log n)</em> if we can order the elements first, or we can even do it in <em>O(n)</em> in case the elements are <em>hashable</em> and no hash collisions occur.</p>\n\n<p>For example:</p>\n\n<pre><code>-- O(n log n) if the elements can be ordered\n\nimport Data.List(sort, tails)\n\ntwoEqual :: Ord a =&gt; [a] -&gt; Bool\ntwoEqual xs = or [h1 == h2 | (h1:h2:_) &lt;- tails (sort xs)]\n</code></pre>\n\n<p>Or in case the elements can be hashed:</p>\n\n<pre><code>-- O(n) in case the elements are hashable and no hash collisions\n\nimport Data.Hashable(Hashable)\nimport Data.HashSet(fromList, member)\n\ntwoEqual :: (Hashable a, Ord a) =&gt; [a] -&gt; Bool\ntwoEqual xs = any (flip member hs) xs\n    where hs = fromList xs\n</code></pre>\n"}], "owner": {"reputation": 2192, "user_id": 2480092, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/97f4cd231024913afd99cbe69655a963?s=128&d=identicon&r=PG", "display_name": "TheEnvironmentalist", "link": "https://stackoverflow.com/users/2480092/theenvironmentalist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1525177234, "creation_date": 1525174498, "question_id": 50115770, "link": "https://stackoverflow.com/questions/50115770/identifying-duplicates-in-haskell-tuples", "title": "Identifying duplicates in Haskell tuples", "body": "<p>I'm trying to write a function that will <code>Nothing</code> a <code>Just</code> <code>Int</code> tuple if any two values in the tuple are the same. For a tuple of five values, here's what I've got. Clearly, there's room for improvement:</p>\n\n<pre><code>nothingIfMatch :: Maybe (Int, Int, Int, Int, Int) -&gt; Maybe (Int, Int, Int, Int, Int)\nnothingIfMatch Nothing = Nothing\nnothingIfMatch (Just (a, b, c, d, e))\n    | a == b = Nothing\n    | a == c = Nothing\n    | a == d = Nothing\n    | a == e = Nothing\n    | b == c = Nothing\n    | b == d = Nothing\n    | b == e = Nothing\n    | c == d = Nothing\n    | c == e = Nothing\n    | d == e = Nothing\n    | otherwise = Just (a, b, c, d, e)\n</code></pre>\n\n<p>Considering there are \"n choose 2\" possible intersections for an n-tuple, in this case, there are only 10 options. But imagine this were an 8-tuple, with 28 possibilities, or a 10-tuple, with 45.</p>\n\n<p>There has to be a more idiomatic way to do this, probably relying on non-determinism features.</p>\n\n<p>How should this be done?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525173647, "post_id": 50115397, "comment_id": 87248257, "body": "What is <code>matrixPairs</code>?"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525174567, "post_id": 50115397, "comment_id": 87248677, "body": "@WillemVanOnsem added them in, hope it makes the question clearer"}], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1525177101, "post_id": 50116290, "comment_id": 87249793, "body": "oh lol that&#39;s so stupid of me, I just used differeneRatings that I posted up there instead of subtracting and it&#39;s all good now, thanks for your help &lt;3"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1525176854, "creation_date": 1525176854, "answer_id": 50116290, "question_id": 50115397, "link": "https://stackoverflow.com/questions/50115397/haskell-cannot-infer-instance/50116290#50116290", "title": "Haskell - Cannot infer instance", "body": "<p>You use <code>Rating a</code>s as if they were just numbers here:</p>\n\n<pre><code>(x!!a) - (x!!b)\n</code></pre>\n\n<p>You presumably need to use <code>case</code> or similar to pattern match on <code>x!!a</code> and <code>x!!b</code> to extract the number they contain. You can move the check for <code>NoRating</code> into that <code>case</code> match to simplify your code. For example:</p>\n\n<pre><code>case (x!!a, x!!b) of\n    (YesRating ra, YesRating rb) -&gt; diffFreqMatrixH2 xs a b (summ + ra - rb) (num + 1)\n    _ -&gt; diffFreqMatrixH2 xs a b summ num\n</code></pre>\n\n<p>Once you get this working the way you want, I encourage you to post to the  <a href=\"https://codereview.stackexchange.com/\">code review StackExchange</a>; your code can be cleaned up significantly to be both simpler and faster.</p>\n"}], "owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 50116290, "answer_count": 1, "score": 0, "last_activity_date": 1525176854, "creation_date": 1525172811, "last_edit_date": 1525174544, "question_id": 50115397, "link": "https://stackoverflow.com/questions/50115397/haskell-cannot-infer-instance", "title": "Haskell - Cannot infer instance", "body": "<p>I have written the following predicate (Lines 94-99)</p>\n\n<pre><code>diffFreqMatrix :: Fractional a =&gt; [[Rating a]] -&gt; [a]\ndiffFreqMatrix (x:xs) =  diffFreqMatrixH (x:xs) (matrixPairs (length x))\ndiffFreqMatrixH _ [] = []\ndiffFreqMatrixH x ((a,b):ys) = [(diffFreqMatrixH2 x a b 0 0)] ++ diffFreqMatrixH x ys\ndiffFreqMatrixH2 [] _ _ x y = x / y\ndiffFreqMatrixH2 (x:xs) a b summ num = if (((x!!a) /= NoRating) &amp;&amp; ((x!!b) /= NoRating)) then  diffFreqMatrixH2 xs a b (summ + ((x!!a) - (x!!b))) (num + 1) else diffFreqMatrixH2 xs a b summ num\n</code></pre>\n\n<p>supposedly it calculates an average I want but i'm getting this error</p>\n\n<pre><code>ERROR file:.\\project.hs:98 - Cannot infer instance\n*** Instance   : Fractional (Rating a)\n*** Expression : diffFreqMatrixH2\n</code></pre>\n\n<p>Helpers im using in case u want to take a look</p>\n\n<pre><code>matrixPairs :: Num a =&gt; a -&gt; [(a,a)]\nmatrixPairs 0 = []\nmatrixPairs c = matrixPairsH 0 0 (c-1)\nmatrixPairsH a b c = [(a,b)] ++ if ((b == c) &amp;&amp; (a == c)) then [] else if (b == c) then (if (a==c) then [] else matrixPairsH (a+1) 0 c ) else matrixPairsH a (b+1) c\n\n\ndiffereneRatings :: Fractional a =&gt; Rating a -&gt; Rating a -&gt; a\ndiffereneRatings NoRating (R a) = 0\ndiffereneRatings (R a) NoRating = 0\ndiffereneRatings NoRating NoRating = 0\ndiffereneRatings  (R a) (R b) = a - b\n</code></pre>\n"}, {"tags": ["haskell", "line", "points"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1525175626, "post_id": 50115315, "comment_id": 87249131, "body": "Let&#39;s say you&#39;re given (0,0) and (4,6) as inputs. Which of these is on that line: (2,3), (6,9), (1,1), (1,2)? (Each of these four points may or may not qualify, depending on what you mean by &quot;on a line&quot;.) The current answer (&quot;use Bresenham&quot;) applies if all but (6,9) are on the line; but there are other answers for other choices."}], "answers": [{"tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 1, "last_activity_date": 1525174095, "creation_date": 1525174095, "answer_id": 50115686, "question_id": 50115315, "link": "https://stackoverflow.com/questions/50115315/function-in-haskell-that-gets-every-point-on-a-line-given-by-two-points/50115686#50115686", "title": "Function in haskell that gets every point on a Line given by two points", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm\" rel=\"nofollow noreferrer\">Bresenham's Algorithm</a> is probably the algorithm you want to use. There's <a href=\"https://wiki.haskell.org/Bresenham%27s_line_drawing_algorithm\" rel=\"nofollow noreferrer\">an implementation of it on the Haskell wiki</a>, although if you're learning Haskell it might be a good idea to try writing it yourself.</p>\n"}], "owner": {"reputation": 1, "user_id": 9725149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John merc", "link": "https://stackoverflow.com/users/9725149/john-merc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525174095, "creation_date": 1525172365, "last_edit_date": 1525172807, "question_id": 50115315, "link": "https://stackoverflow.com/questions/50115315/function-in-haskell-that-gets-every-point-on-a-line-given-by-two-points", "title": "Function in haskell that gets every point on a Line given by two points", "body": "<p>So i have been stuck on this for a while now, I would like to make a function that gets every point on a line and excludes all the other points, given two points, given that a point is defined as (Int , Int) \nThank you </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525169680, "post_id": 50114588, "comment_id": 87246458, "body": "Note that your reader will generate a reversed list."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1525169422, "creation_date": 1525169422, "answer_id": 50114700, "question_id": 50114588, "link": "https://stackoverflow.com/questions/50114588/haskell-create-list-with-user-input/50114700#50114700", "title": "Haskell, Create list with user input", "body": "<p>As you say, <code>print</code> has type</p>\n\n<pre><code>print :: Show a =&gt; a -&gt; IO ()\n</code></pre>\n\n<p>and <code>getList []</code> has type <code>IO [String]</code>, so for <code>print (getList [])</code> to typecheck there must be a <code>Show</code> instance for <code>IO [String]</code>. There is no such instance, which causes the error.</p>\n\n<p>There is a <code>Show</code> instance for <code>[String]</code> however, so you can call <code>print</code> on the list returned by executing <code>getList []</code>. You can use <code>do</code> notation to bind the result to call print on it:</p>\n\n<pre><code>checkDebruijn sequence alphabet  = do\n    result &lt;- (getList [])\n    print result\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "is_accepted": true, "score": 2, "last_activity_date": 1525170816, "creation_date": 1525170816, "answer_id": 50114997, "question_id": 50114588, "link": "https://stackoverflow.com/questions/50114588/haskell-create-list-with-user-input/50114997#50114997", "title": "Haskell, Create list with user input", "body": "<p>Your main should look like:</p>\n\n<pre><code>main = getList [] &gt;&gt;= print\n</code></pre>\n\n<p>where:</p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>Or alternatively:</p>\n\n<pre><code>main = do\n  xs &lt;- getList []\n  print xs\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 8562168, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212454666228770/picture?type=large", "display_name": "Benjamin Sx", "link": "https://stackoverflow.com/users/8562168/benjamin-sx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "accepted_answer_id": 50114997, "answer_count": 2, "score": 0, "last_activity_date": 1525170816, "creation_date": 1525168906, "question_id": 50114588, "link": "https://stackoverflow.com/questions/50114588/haskell-create-list-with-user-input", "title": "Haskell, Create list with user input", "body": "<p>Hello I need to create a list from the user input and stop when \"END\" is detected.\nI'm learning Haskell so it's a bit confuse with the IO.</p>\n\n<p>I have this code to recursivly add the input in a list and when \"END\" is write by the user it give the list</p>\n\n<pre><code>getList :: [String] -&gt; IO [String]\ngetList list =  do line &lt;- getLine\n                   if line ==  \"END\"\n                      then return list\n                      else getList (line : list)\n</code></pre>\n\n<p>and I try to catch the result and print it in this function, it already take two parameter that I didn't code already.</p>\n\n<pre><code>checkDebruijn :: Int -&gt; String -&gt; IO ()\ncheckDebruijn sequence alphabet  = do\n    print (getList [])\n</code></pre>\n\n<p>And I call it in the main to test it </p>\n\n<pre><code>main :: IO ()\nmain = do\n  print (checkDebruijn 0 \"\")\n</code></pre>\n\n<p>And I have this error :</p>\n\n<pre><code>No instance for (Show (IO [String]))\n        arising from a use of \u2018print\u2019\n    \u2022 In a stmt of a 'do' block: print (getList [])\n      In the expression: do print (getList [])\n      In an equation for \u2018checkDebruijn\u2019:\n          checkDebruijn sequence alphabet = do print (getList [])\n  |\n7 |     print (getList [])\n  |     ^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I see that print is :\nprint :: Show a => a -> IO ()\nSo I don't understand why it wouldn't compile. For me <strong>IO</strong> is an action that the compiler do. So getList :: [String] -> <strong>IO [String]</strong>\nIO [String] is when the compiler do an action and return a [String] ?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525166793, "post_id": 50114128, "comment_id": 87245179, "body": "Your syntax in the second example is wrong, it looks like you write <code>f1</code> in an imperative style. Probably it is lacking a <code>let</code> statement."}, {"owner": {"reputation": 410, "user_id": 2567875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d40b212881da1bd7d6e6acdce1f6bbb6?s=128&d=identicon&r=PG", "display_name": "user2567875", "link": "https://stackoverflow.com/users/2567875/user2567875"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525167717, "post_id": 50114128, "comment_id": 87245584, "body": "I changed the text a little bit, to make it clearer that its &quot;only the idea&quot; of what I want, I dont know the right syntax for it"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1525166986, "creation_date": 1525166986, "answer_id": 50114177, "question_id": 50114128, "link": "https://stackoverflow.com/questions/50114128/how-to-access-to-listelements-of-returnvalue-in-haskell/50114177#50114177", "title": "How to access to listelements of returnvalue in haskell?", "body": "<p>I think this is more a matter of wrong syntax here: you use two <code>=</code> tokens for <code>f1</code>, and seem to write it in an imperative way.</p>\n\n<p>We can here use a <strong><code>let</code> clause</strong>:</p>\n\n<pre><code>f1 = <b>let</b> [x,y] = f2 1 2 <b>in</b> if x == 42 then y * 23 else x</code></pre>\n\n<p>or we can use a <strong><code>where</code> clause:</strong></p>\n\n<pre><code>f1 = if x == 42 then y * 23 else x\n    <b>where</b> [x,y] = f2 1 2</code></pre>\n\n<p>Note that the above pattern matching is rather unsafe: a list can not give guarantees about its size. Usually in case the size is fixed, a tuple is a better option. We can thus reimplement it with tuples like:</p>\n\n<pre><code>-- with tuples\nf1  = let <b>(</b>x, y<b>)</b> = f2 1 2 in if x == 42 then y * 23 else x\n\nf2 a b = <b>(</b>a, b<b>)</b></code></pre>\n"}], "owner": {"reputation": 410, "user_id": 2567875, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d40b212881da1bd7d6e6acdce1f6bbb6?s=128&d=identicon&r=PG", "display_name": "user2567875", "link": "https://stackoverflow.com/users/2567875/user2567875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 50114177, "answer_count": 1, "score": 1, "last_activity_date": 1525167655, "creation_date": 1525166722, "last_edit_date": 1525167655, "question_id": 50114128, "link": "https://stackoverflow.com/questions/50114128/how-to-access-to-listelements-of-returnvalue-in-haskell", "title": "How to access to listelements of returnvalue in haskell?", "body": "<p>I have some trouble accessing the return value of my function. The returnvalue is a list, and I want to have access to both of the list elements:</p>\n\n<p>That's the working code:</p>\n\n<pre><code>f1  =  f2 1 2\nf2 a b = [a,b]\nmain :: IO ()\nmain =  do\n    print(f1)\n</code></pre>\n\n<p>To show the idea, this is what I want to do (that code does not work):</p>\n\n<pre><code>f1  =  [x,y] = f2 1 2\n       if x == 42 then y * 23 else x\n\nf2 a b = [a,b]\nmain :: IO ()\nmain =  do\n    print(f1)\n</code></pre>\n\n<p>How can i get access to x and y in f1?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 2, "creation_date": 1525153981, "post_id": 50111760, "comment_id": 87240999, "body": "Can&#39;t reproduce. Writing a module with the above definitions and loading it in GHCi. at least, produces no compiler errors."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1525154762, "post_id": 50111760, "comment_id": 87241201, "body": "&quot;I had to use...&quot; - what do you mean by it? Was there any error otherwise?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525160967, "post_id": 50111760, "comment_id": 87243190, "body": "You forgot the case where the first is a <code>Hello</code> and the second a <code>Goodbye</code> and vice versa."}, {"owner": {"reputation": 133, "user_id": 2159471, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ba03bcf5c19e5dd23f98da34fc17348?s=128&d=identicon&r=PG", "display_name": "user2159471", "link": "https://stackoverflow.com/users/2159471/user2159471"}, "edited": false, "score": 0, "creation_date": 1525165962, "post_id": 50111760, "comment_id": 87244883, "body": "Thanks everyone. I provided the link below with screenshot of my code and error. I wrote the types and typeclasses in Notepadd++, didn&#39;t create modules. Also, i would welcome any learning suggestions for Haskell. As of now spending two hours a day on mentioned book. Also planning to join University Of Glasgow online course on futurelearn."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1525166621, "post_id": 50111760, "comment_id": 87245126, "body": "@user2159471 Please don&#39;t post descriptions, screenshots or reimaginings of your code. Copy&amp;Paste actual code that actually exhibits the actual problem you&#39;re having. Actually. If the &quot;real&quot; code is too large, try to create a small code sample that still has the same problem (that way you&#39;ll often find things like typos before having to ask anyone else)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1525177417, "post_id": 50111760, "comment_id": 87249941, "body": "The issue here is that you are mixing TABs and spaces. Don&#39;t. Remove tabs for an easy fix. GHC should warn loudly about this, but does not (GHC 8.2.2) in your example: I get the warning only if I align the tab with 8 spaces, which fixes the error. But at that point it&#39;s too late! GHC should warn earlier -- indeed GHC 8.4.2 does!"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 2159471, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ba03bcf5c19e5dd23f98da34fc17348?s=128&d=identicon&r=PG", "display_name": "user2159471", "link": "https://stackoverflow.com/users/2159471/user2159471"}, "edited": false, "score": 0, "creation_date": 1525165546, "post_id": 50112158, "comment_id": 87244710, "body": "Thanks Adam. I accept my second question was nonsense, i am not sure what did i miss, i tried multiple times that time. I tried again and it worked but still facing the same issue for first question. I took the screenshot and providing the link below. I wrote the the types and typeclasses in Notepad++. I loaded without EitherOr type, it works fine. I unloaded the file, added EitherOr and again tried to load. Facing the same error."}, {"owner": {"reputation": 133, "user_id": 2159471, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ba03bcf5c19e5dd23f98da34fc17348?s=128&d=identicon&r=PG", "display_name": "user2159471", "link": "https://stackoverflow.com/users/2159471/user2159471"}, "edited": false, "score": 0, "creation_date": 1525165555, "post_id": 50112158, "comment_id": 87244716, "body": "<a href=\"https://www.dropbox.com/s/iighrxe4mb6nax4/EqInstance.png?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/iighrxe4mb6nax4/EqInstance.png?dl=0</a>"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 4, "last_activity_date": 1525155669, "creation_date": 1525155669, "answer_id": 50112158, "question_id": 50111760, "link": "https://stackoverflow.com/questions/50111760/creating-instance-for-eq-typeclass-for-a-custom-type/50112158#50112158", "title": "Creating instance for Eq typeclass for a custom type", "body": "<p>You've typo'd. Your code reads either:</p>\n\n<pre><code>(==) (Hello v) (Hello v') = v = v'  -- note the @v = v'@\n</code></pre>\n\n<p>or</p>\n\n<pre><code>(==) (Goodbye b) (Goodbye b') = b = b'  -- same problem\n</code></pre>\n\n<p>or potentially both.</p>\n\n<hr>\n\n<p>Your second question is nonsense. You can define any variable name there, not just <code>v</code> and <code>v'</code>.</p>\n\n<pre><code>data MyEither a b = Lefty a | Righty b\n\ninstance (Eq a, Eq b) =&gt; Eq (MyEither a b) where\n  (Lefty kumquat)   == (Lefty jebediah) = kumquat  == jebediah\n  (Righty superman) == (Righty batman)  = superman == batman\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 2159471, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ba03bcf5c19e5dd23f98da34fc17348?s=128&d=identicon&r=PG", "display_name": "user2159471", "link": "https://stackoverflow.com/users/2159471/user2159471"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1525376622, "answer_count": 1, "score": 0, "last_activity_date": 1525155669, "creation_date": 1525152744, "question_id": 50111760, "link": "https://stackoverflow.com/questions/50111760/creating-instance-for-eq-typeclass-for-a-custom-type", "closed_reason": "Not suitable for this site", "title": "Creating instance for Eq typeclass for a custom type", "body": "<p>I am learning Haskell through Chris Allen's Haskell Programming Book. Need help on the below (exercise question from Typeclasses chapter).\nI need to create an instance of Eq typeclass for the data type:</p>\n\n<pre><code>data EitherOr a b = Hello a | Goodbye b\n</code></pre>\n\n<p>But when i am creating it as below, i am getting an error, which says, strangely, \"parse error on input '='. Perhaps you need let in do block.\" </p>\n\n<pre><code>instance (Eq a,Eq b) =&gt; Eq (EitherOr a b) where\n    (==) (Hello v) (Hello v') = v == v'\n    (==) (Goodbye b) (Goodbye b') = b == b'\n</code></pre>\n\n<p>While attempting the exercises i also faced problem on below:</p>\n\n<pre><code>data Which a = ThisOne a | ThatOne a\n</code></pre>\n\n<p>I had to use the same name for argument (v, v') while defining (==) for both data constructors. I don't understand the reason.</p>\n\n<pre><code>instance Eq a =&gt; Eq (Which a) where\n   (==) (ThisOne v) (ThisOne v') = v == v'\n   (==) (ThatOne v) (ThatOne v') = v == v'\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1525141352, "post_id": 50110614, "comment_id": 87238541, "body": "Have you tried enabling <code>FlexibleInstances</code>?"}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1525141370, "post_id": 50110614, "comment_id": 87238545, "body": "@FyodorSoikin Yes, see the linked gist."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1525181448, "post_id": 50111137, "comment_id": 87251975, "body": "Perhaps worth noting that if/when <code>QuantifiedConstraints</code> arrives in GHC then <code>ForallF</code> will become obsolete (and programming with such constraints will be much easier)"}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1525182904, "post_id": 50111137, "comment_id": 87252780, "body": "I guess the second part of this is really the answer to the question, still trying to understand the first bit. When you say &quot;Whenever m is a <code>Monoid</code> and <code>f :: a -&gt; m</code>, <code>foldMap f</code> ...&quot;, isn&#39;t that first clause a given for any <code>f</code> you can pass to <code>foldMap</code>? Or is this asserting some special property I&#39;m not understanding?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1525197387, "post_id": 50111137, "comment_id": 87260379, "body": "@AsadSaeeduddin, look at the explanation of <a href=\"https://en.wikipedia.org/wiki/Free_group#Universal_property\" rel=\"nofollow noreferrer\">the universal property of the free group</a> on Wikipedia. The universal property of a monoid is the same (just substitute monoid everywhere). In that explanation, <code>pure</code> serves as the inclusion mapping and <code>foldMap f</code> plays the role of their \u03c6. The point is that lists and the like have an interesting relationship among their <code>Monoid</code>, <code>Applicative</code>, and <code>Foldable</code> instances that does not need to exist in general, and in the general case they don&#39;t come together to form a valid <code>Traversable</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1525275942, "post_id": 50111137, "comment_id": 87295498, "body": "In the above comment, I meant &quot;The universal property of a <i>free</i> monoid is the same, with monoid substituted for group everywhere.&quot; @AsadSaeeduddin, do you understand what I was getting at now?"}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1525276045, "post_id": 50111137, "comment_id": 87295567, "body": "@dfeuer I&#39;m sorry, I haven&#39;t had time to look at the Wikipedia article or your comment in depth yet, I&#39;m planning to do that this weekend. In a time crunch at work right now."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1525276684, "post_id": 50111137, "comment_id": 87295985, "body": "My surface level understanding so far is that you could possibly write a monoid subclass with some extra laws, and for any lawful instance of <i>that subclass</i> (instead of vanilla <code>Monoid</code>s) you can legally do the traversable thing above."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1525277522, "post_id": 50111137, "comment_id": 87296501, "body": "@AsadSaeeduddin, I think you&#39;d be better off dropping <code>Applicative</code> and adding <code>class (Foldable t, ForallF Monoid t) =&gt; FreeMonoid t where inject :: a -&gt; t a</code> with the appropriate laws."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1525277752, "post_id": 50111137, "comment_id": 87296655, "body": "@dfeuer That makes sense. I had the sense that <code>Applicative</code> was overkill since we don&#39;t have any use for the <code>lift2</code>/<code>ap</code> here, but couldn&#39;t find a &quot;pointed&quot; superclass of it."}, {"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "edited": false, "score": 0, "creation_date": 1526171483, "post_id": 50111137, "comment_id": 87639799, "body": "I went over things and it makes much more sense now, thanks. I was wondering if this has anything to do with the fact that depending on <code>Foldable</code> here sort of &quot;overconstrains&quot; things, in that I&#39;m deriving traversable from foldable as one of the ingredients, but a foldable may be derived from that traversable as well. The only valid solution is one where the free foldable you get from the traversable is identical to the one you put in, and it just so happens the only monoid with a satisfactory interaction with <code>foldMap</code> is the free monoid?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 4, "last_activity_date": 1525197719, "last_edit_date": 1525197719, "creation_date": 1525146832, "answer_id": 50111137, "question_id": 50110614, "link": "https://stackoverflow.com/questions/50110614/expressing-an-instance-for-any-type-that-satisfies-multiple-constraints/50111137#50111137", "title": "Expressing an instance for any type that satisfies multiple constraints", "body": "<p>Your conjecture is wrong. Consider the type</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nimport Data.Semigroup\nimport Data.Monoid hiding ((&lt;&gt;))\n\nnewtype FL a = FL [a] deriving (Functor, Foldable, Applicative)\ninstance Semigroup (FL a) where\n  FL as &lt;&gt; FL bs = FL $ as ++ drop (length as) bs\ninstance Monoid (FL a) where\n  mempty = FL []\n  mappend = (&lt;&gt;)\n</code></pre>\n\n<p>This is based on the <code>Alternative</code> instance for <code>ZipList</code>. <code>mempty</code> is obviously the identity for <code>mappend</code>, and <code>mappend</code> is somewhat less obviously associative, so it's a valid <code>Monoid</code> instance. However, it does <em>not</em> lead to a valid <code>Traversable</code> instance using your definition. Your definition works for lists (and a few other types, like <code>Data.Sequence.Seq</code> and <code>Data.Vector.Vector</code>) because they have a very special structure.</p>\n\n<p>In particular, <code>[a]</code> is (modulo some laziness considerations) the <em>free monoid</em> over <code>a</code> with <code>pure</code> and <code>foldMap</code> satisfying a particular universal property:</p>\n\n<blockquote>\n  <p>Whenever <code>m</code> is a <code>Monoid</code> and <code>f :: a -&gt; m</code>, <code>foldMap f</code> is the unique monoid homomorphism such that <code>foldMap f . pure = f</code>.</p>\n</blockquote>\n\n<p>In other situations, such as <code>FL</code> above, you're generally not going to end up satisfying the identity law for <code>Traversable</code>, although I suppose you might find somewhat weaker conditions under which it works out.</p>\n\n<hr>\n\n<p>What if you want to muck about with your idea anyway? The easiest thing is to replace the <code>Monoid (t a)</code> constraint with an <code>Alternative t</code> constraint. Then you can use <code>empty</code> instead of <code>mempty</code> and <code>(&lt;|&gt;)</code> instead of <code>mappend</code>, and the types (although not the laws) should work out.</p>\n\n<p>If you're really stuck on <code>Monoid</code>, you have to bring in some much heavier machinery from <a href=\"https://hackage.haskell.org/package/constraints-0.10/docs/Data-Constraint-Forall.html\" rel=\"nofollow noreferrer\"><code>Data.Constraint.Forall</code></a>. What you want to say is that for each <code>a</code>, <code>Monoid (t a)</code>. You can express that as <code>ForallF Monoid t</code>. But you can't just use <code>Monoid</code> methods under that constraint, because it's not natively supported by <code>GHC</code>. Rather, you'll have to use <code>instF</code>:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators, ScopedTypeVariables, InstanceSigs, ... #-}\n\nimport Data.Constraint\nimport Data.Constraint.Forall\n\ninstance (Applicative t, Foldable t, ForallF Monoid t)\n  =&gt; Traversable t where\n  sequenceA :: forall f a. Applicative f =&gt; t (f a) -&gt; f (t a)\n  sequenceA =\n   case instF :: ForallF Monoid t :- Monoid (t a) of\n     Sub Dict -&gt; foldl (liftA2 $ \\b a -&gt; mappend b (pure a)) (pure mempty)\n</code></pre>\n\n<p>Of course, once you've gone to all that trouble, you'll discover that your <code>Traversable</code> instance overlaps with <em>every other</em> <code>Traversable</code> instance, which is pretty much a total disaster.</p>\n\n<p>Addendum: as <a href=\"https://stackoverflow.com/questions/50110614/expressing-an-instance-for-any-type-that-satisfies-multiple-constraints/50111137?noredirect=1#comment87251975_50111137\">Benjamin Hodgson notes</a>, there is an accepted <a href=\"https://github.com/ghc-proposals/ghc-proposals/blob/master/proposals/0018-quantified-constraints.rst\" rel=\"nofollow noreferrer\">GHC proposal</a> to support quantified (and implication) constraints. When that is implemented (likely to be soon), you'll be able to simply write <code>forall a. Monoid (t a)</code> as a constraint, and things should work out much more easily.</p>\n"}], "owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 50111137, "answer_count": 1, "score": 1, "last_activity_date": 1525197719, "creation_date": 1525141221, "last_edit_date": 1525141649, "question_id": 50110614, "link": "https://stackoverflow.com/questions/50110614/expressing-an-instance-for-any-type-that-satisfies-multiple-constraints", "title": "Expressing an instance for any type that satisfies multiple constraints", "body": "<p>I suspect that all applicative, foldable monoids are traversable in the same manner. In other words, for any type <code>t :: * -&gt; *</code> that satisfies <code>Applicative</code> and <code>Foldable</code>, and for which all instantiations <code>t a</code> satisfy <code>Monoid</code>, there is a free instance of <code>Traversable</code>.</p>\n\n<p>Here is how I would implement <code>sequenceA</code>:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>sequenceA :: (Applicative t, Foldable t, Monoid (t a), Applicative f) =&gt;\n  t (f a) -&gt; f (t a)\nsequenceA = foldl (liftA2 $ \\b a -&gt; mappend b (pure a)) (pure mempty)\n</code></pre>\n\n<p>We can e.g. use this to traverse a list containing functions into a function that will produce a list (since <code>[]</code> is applicative, foldable, and a monoid for all types <code>[a]</code>):</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>sequenceA [\\a -&gt; 2 * a, \\a -&gt; 2 + a] $ 5\n-- [10, 7]\n</code></pre>\n\n<hr>\n\n<p>Unfortunately, I can't figure out how to actually specify a <code>Traversable</code> instance with this implementation of <code>sequenceA</code>. Here's what I tried:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>instance (Applicative t, Foldable t, Monoid (t a)) =&gt; Traversable t where\n  sequenceA = foldl (liftA2 $ \\b a -&gt; mappend b (pure a)) (pure mempty)\n</code></pre>\n\n<p>If I try to compile this without any extensions I get:</p>\n\n<pre><code>&lt;interactive&gt;:3:55: error:\n    \u2022 Illegal instance declaration for \u2018Traversable t\u2019\n        (All instance types must be of the form (T a1 ... an)\n         where a1 ... an are *distinct type variables*,\n         and each type variable appears at most once in the instance head.\n         Use FlexibleInstances if you want to disable this.)\n    \u2022 In the instance declaration for \u2018(Traversable t)\u2019\n</code></pre>\n\n<p>What is the correct way for me to express this instance in Haskell?</p>\n\n<hr>\n\n<p>On the off chance that recursively adding whatever extensions the compiler errors mention might fix the problem, I tried that out and have pasted the results <a href=\"https://gist.github.com/masaeedu/d392178a7691e9955bf4b14c8eac321a\" rel=\"nofollow noreferrer\">here</a>. If any of the error messages there are relevant, please let me know and I'll move them directly into the question body.</p>\n"}, {"tags": ["haskell", "types", "declaration"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525104425, "post_id": 50104085, "comment_id": 87225663, "body": "Types, functions, etc. are all elements that ship with a module. So you here use the <code>Map</code> type from the <code>Data.Map</code> module."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525104831, "post_id": 50104085, "comment_id": 87225874, "body": "You could certainly implement <code>Map</code> as a function from a key type to a value type (<code>newtype Map a b = Map (a -&gt; b)</code>), but that&#39;s an implementation detail that wouldn&#39;t be exposed by the type itself."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1525106457, "post_id": 50104272, "comment_id": 87226646, "body": "Perhaps it would help to show an unqualified use too?  If you <code>import Data.Map</code> then you could instead write <code>Map String String</code>, i.e., you can drop the qualified name prefixing the type."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1525150542, "post_id": 50104272, "comment_id": 87240208, "body": "Or if you do <code>import qualified Data.Map as M</code>, it&#39;s <code>M.Map</code>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 7, "last_activity_date": 1525104434, "creation_date": 1525104434, "answer_id": 50104272, "question_id": 50104085, "link": "https://stackoverflow.com/questions/50104085/haskell-typesig-map-map-lyah/50104272#50104272", "title": "Haskell, typesig Map.Map, LYAH", "body": "<p><code>Data.Map</code> exports a type called <code>Map</code>:</p>\n\n<pre><code>data Map k a\n</code></pre>\n\n<p>whose definition is hidden. The qualified import means that to refer to that type, you need to prefix it with the name you stuck after <code>as</code>. So <code>Map.Map</code> is just the name of the finite map type constructor.</p>\n\n<pre><code>Map.Map String String\n</code></pre>\n\n<p>is simply the type of finite maps from strings to strings.</p>\n"}, {"comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1525105922, "post_id": 50104340, "comment_id": 87226392, "body": "<code>Map</code> has the kind <code>* -&gt; * -&gt; *</code> not <code>* -&gt; *</code>"}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1525109031, "post_id": 50104340, "comment_id": 87227788, "body": "Oops my bad, fixed."}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": false, "score": 3, "last_activity_date": 1525108982, "last_edit_date": 1525108982, "creation_date": 1525104699, "answer_id": 50104340, "question_id": 50104085, "link": "https://stackoverflow.com/questions/50104085/haskell-typesig-map-map-lyah/50104340#50104340", "title": "Haskell, typesig Map.Map, LYAH", "body": "<p><code>phonebook</code> is of type <code>Map String String</code> (if you were to import with <code>import Data.Map (Map)</code>). That is, it a mapping of <code>Strings</code> to <code>Strings</code>. </p>\n\n<p>More generally, the <code>Map</code> type constructor can be written as <code>Map key value</code> where <code>key</code> and <code>value</code> can be thought of as type arguments <em>yet to be applied</em>. Hence we say <code>Map</code> has the <em>kind</em> <code>* -&gt; * -&gt; *</code> where the stars themselves are concrete types. </p>\n\n<p>So in...</p>\n\n<pre><code>import qualified Data.Map as Map \n\nphonebook :: Map.Map String String   -- passing \"arguments\" to Map here\nphonebook = undefined\n</code></pre>\n\n<p>You're <code>phonebook</code> has the kind <code>*</code>.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525108982, "creation_date": 1525103745, "question_id": 50104085, "link": "https://stackoverflow.com/questions/50104085/haskell-typesig-map-map-lyah", "title": "Haskell, typesig Map.Map, LYAH", "body": "<p>I don't quite get the Map.Map part. I understand that when I import qualified as Map, I need to prefix addressing that as 'Map.' but whereas that is normally followed by a function (eg. 'lookup'), here two types are used. </p>\n\n<pre><code>import qualified Data.Map as Map \nphonebook :: Map.Map String String\n</code></pre>\n\n<p>I get that phonebook takes a String and a String, but is Map.Map strictly there to indicate it is an association list, or is there more to it? And why are the arrows omitted? </p>\n"}, {"tags": ["haskell", "functional-programming", "reverse-proxy"], "answers": [{"tags": [], "owner": {"reputation": 677, "user_id": 2659595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62be5bdb8707d16bd9247792d857d296?s=128&d=identicon&r=PG", "display_name": "tom", "link": "https://stackoverflow.com/users/2659595/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1597543109, "creation_date": 1597543109, "answer_id": 63432425, "question_id": 50103208, "link": "https://stackoverflow.com/questions/50103208/haskell-reverse-proxy-issue/63432425#63432425", "title": "Haskell reverse proxy issue", "body": "<p>I experienced this same problem and opened a PR against <code>http-reverse-proxy</code> to fix it: <a href=\"https://github.com/fpco/http-reverse-proxy/pull/35\" rel=\"nofollow noreferrer\">https://github.com/fpco/http-reverse-proxy/pull/35</a>.</p>\n<p>The solution has a slightly performance penalty as written, but it works. Hopefully that will be corrected in review.</p>\n"}], "owner": {"reputation": 333, "user_id": 1285245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e317ba4a8b9c7283005e70d8b598a5df?s=128&d=identicon&r=PG", "display_name": "user1285245", "link": "https://stackoverflow.com/users/1285245/user1285245"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1597543109, "creation_date": 1525100547, "question_id": 50103208, "link": "https://stackoverflow.com/questions/50103208/haskell-reverse-proxy-issue", "title": "Haskell reverse proxy issue", "body": "<p>I am a newbie to Haskell and functional programming. In order to gain some hands-on experience, I wrote this simple reverse proxy application. The idea is simple, based on the <code>x-tenant-id</code> header in the request, the proxy forwards the request to the corresponding upstream host <code>tenant-${tenantid}</code>.\nThe application works well for GET and DELETE requests. But for POST  and PUT, from time to time(almost every other request) it complains incorrect <code>Content-Length</code>, even though there is nothing wrong with it. I did some search on the internet, it seems no one has encountered similar issue before, so probably my code is messed up somewhere.</p>\n\n<p>Error message:</p>\n\n<pre><code>WrongRequestBodyStreamSize 200 0\n</code></pre>\n\n<p>200 is the actual content length, but the upstream server thinks it's 0. My first thought was the request got truncated somehow, but Wireshark revealed the request was fully sent to upstream... Now my speculation is the whole request is split into two by the proxy, the headers are in the first request while the payload falls into the second.</p>\n\n<p>Code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\nmodule Main where\n\nimport qualified Network.HTTP.Client as Client\nimport qualified Network.HTTP.ReverseProxy as ReverseProxy\nimport qualified Network.Wai as Wai\nimport qualified Network.Wai.Request as Request\nimport qualified Network.Wai.Handler.Warp as Warp\nimport qualified Data.Maybe as Maybe\nimport qualified Data.ByteString as ByteString\n\nmain = do\n  manager &lt;- Client.newManager $ Client.defaultManagerSettings { Client.managerConnCount = 5000, Client.managerIdleConnectionCount = 5000 }\n  let settings = Warp.setPort 80 $ Warp.setHTTP2Disabled Warp.defaultSettings\n  Warp.runSettings settings $ mainApp manager\n\nmainApp :: Client.Manager -&gt; Wai.Application\nmainApp manager req res = do\n  let maybeUpstream = lookup \"x-tenant-id\" $ Wai.requestHeaders $ req\n  let upstream = if Maybe.isNothing(maybeUpstream) then \"12345\" else Maybe.fromJust(maybeUpstream)\n  proxyApp upstream manager req res\n\nproxyApp :: ByteString.ByteString -&gt; Client.Manager -&gt; Wai.Application\nproxyApp upstream manager req res = do\n  let host = ByteString.concat([\"tenant-\", upstream])\n  let dest = ReverseProxy.WPRProxyDest ReverseProxy.ProxyDest { ReverseProxy.pdHost = host, ReverseProxy.pdPort = 80 }\n  ReverseProxy.waiProxyTo (const $ return dest) ReverseProxy.defaultOnExc manager req res\n</code></pre>\n"}, {"tags": ["haskell", "coq", "coq-extraction"], "comments": [{"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1525100171, "post_id": 50102671, "comment_id": 87223078, "body": "I don&#39;t think there is. I looked for ages and couldn&#39;t find any and wrote a script for it myself. I really hope someone answers your question in the positive though."}], "answers": [{"comments": [{"owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "edited": false, "score": 0, "creation_date": 1525211550, "post_id": 50120001, "comment_id": 87266815, "body": "Is there a relevant issue on Coq&#39;s bugtracker?"}, {"owner": {"reputation": 5355, "user_id": 377022, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c11c7cc23517cf5f043b51fc7914049a?s=128&d=identicon&r=PG", "display_name": "Jason Gross", "link": "https://stackoverflow.com/users/377022/jason-gross"}, "edited": false, "score": 0, "creation_date": 1525321741, "post_id": 50120001, "comment_id": 87312060, "body": "I don&#39;t see such an issue.  Feel free to open one, though!  Note also <a href=\"https://github.com/coq/coq/blob/master/plugins/extraction/ExtrHaskellString.v#L11\" rel=\"nofollow noreferrer\">github.com/coq/coq/blob/master/plugins/extraction/&hellip;</a>: <code>At the moment, Coq&#39;s extraction has no way to add extra import statements to the extracted Haskell code.  You will have to manually add: [...]</code>"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4084567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73224038c27f5e8e9f92f1a79e94ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Tej Chajed", "link": "https://stackoverflow.com/users/4084567/tej-chajed"}, "is_accepted": false, "score": 1, "last_activity_date": 1525191328, "creation_date": 1525191328, "answer_id": 50120001, "question_id": 50102671, "link": "https://stackoverflow.com/questions/50102671/can-you-automatically-add-haskell-import-statements-when-extracting-from-coq/50120001#50120001", "title": "Can you automatically add Haskell import statements when extracting from Coq?", "body": "<p>There isn't, and it's very sad.</p>\n\n<p>We've solved this problem with a Python script that adds several imports (<a href=\"https://github.com/mit-pdos/fscq/blob/master/src/fiximports.py\" rel=\"nofollow noreferrer\">fiximports.py</a>), but this requires using the Haskell preprocessor (you use it by passing <code>-F -pgmF fiximports.py</code> to <code>ghc</code>) and results in unused imports warnings, and isn't terribly elegant.</p>\n\n<p>I think the issue is that these imports are unnecessary for OCaml extraction, and the feature hasn't been designed and implemented for Haskell extraction.</p>\n"}], "owner": {"reputation": 323, "user_id": 9631527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb9e5f1bf9b89241e5dddb0eb757ad78?s=128&d=identicon&r=PG&f=1", "display_name": "tlon", "link": "https://stackoverflow.com/users/9631527/tlon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1525191328, "creation_date": 1525098756, "last_edit_date": 1525099797, "question_id": 50102671, "link": "https://stackoverflow.com/questions/50102671/can-you-automatically-add-haskell-import-statements-when-extracting-from-coq", "title": "Can you automatically add Haskell import statements when extracting from Coq?", "body": "<p>I'm doing an extraction from Coq to Haskell that requires importing a couple of modules on the Haskell end.  Is there any Coq extraction feature that allows you to do this automatically?  I know I could just write a script to do this but I'd prefer to not reinvent the wheel if necessary.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1525096042, "post_id": 50101870, "comment_id": 87220522, "body": "You need to load the three files: <code>:l &#47;path&#47;to&#47;experiment.hs &#47;path&#47;to&#47;Geometry.hs &#47;path&#47;to&#47;Shapes.hs</code>"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525096094, "post_id": 50101870, "comment_id": 87220562, "body": "Do I do this just by <code>:l &#47;Users&#47;macbookpro&#47;Downloads&#47;experiment.hs</code>, followed by <code>:l &#47;Users&#47;macbookpro&#47;Downloads&#47;Geometry.hs</code>, followed by <code>:l &#47;Users&#47;macbookpro&#47;Downloads&#47;Shapes.hs</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525096165, "post_id": 50101870, "comment_id": 87220610, "body": "well the dependencies need to be resolved, so you need to load a module first if another module depends on that module. But if you load the three files in the same <code>:l</code>, then Haskell will determine the dependecies itself, and load it in the right order."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525096205, "post_id": 50101870, "comment_id": 87220632, "body": "I don&#39;t understand the syntax <code>:l &#47;path&#47;to&#47;experiment.hs &#47;path&#47;to&#47;Geometry.hs &#47;path&#47;to&#47;Shapes.hs</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525096245, "post_id": 50101870, "comment_id": 87220655, "body": "<code>:l</code> followed by all the paths to the files you want to compile including files that are dependencies."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525096267, "post_id": 50101870, "comment_id": 87220670, "body": "Does that literally amount to <code>:l &#47;Users&#47;macbookpro&#47;Downloads&#47;experiment.hs &#47;Users&#47;macbookpro&#47;Downloads&#47;Geometry.hs &#47;Users&#47;macbookpro&#47;Downloads&#47;Shapes.hs</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525096330, "post_id": 50101870, "comment_id": 87220707, "body": "Yes, probably it does."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525096390, "post_id": 50101870, "comment_id": 87220739, "body": "Fantastic, thanks :)"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525095968, "creation_date": 1525095968, "question_id": 50101870, "link": "https://stackoverflow.com/questions/50101870/users-macbookpro-downloads-experiment-hs121-error-could-not-find-module-ge", "title": "/Users/macbookpro/Downloads/experiment.hs:12:1: error: Could not find module \u2018Geometry\u2019 Use -v to see a list of the files searched for", "body": "<p>I have used the terminal on my mac to start ghci. When I write <code>ls</code> to find the files in the current directory, the file I wish to load, <code>experiment.hs</code> appears in the current directory, its path being <code>/Users/macbookpro/Downloads/experiment.hs</code>. However, when I load ghci and write</p>\n\n<p><code>:l /Users/macbookpro/Downloads/experiment.hs</code></p>\n\n<p>I receive this error:</p>\n\n<pre><code>`Prelude&gt; :l /Users/macbookpro/Downloads/experiment.hs\n[1 of 1] Compiling Main             \n(/Users/macbookpro/Downloads/experiment.hs, interpreted )\n\n/Users/macbookpro/Downloads/experiment.hs:12:1: error:\nCould not find module \u2018Geometry\u2019\nUse -v to see a list of the files searched for.\n|\n12 | import Geometry\n| ^^^^^^^^^^^^^^^\n\n/Users/macbookpro/Downloads/experiment.hs:14:1: error:\nCould not find module \u2018Shapes\u2019\nUse -v to see a list of the files searched for.\n |\n14 | import Shapes\n | ^^^^^^^^^^^^^\nFailed, no modules loaded.`\n</code></pre>\n\n<p>I have also used <code>experiment.hs</code> on a windows computer on WinGHCi, with no problems; that is, the following appears:</p>\n\n<pre><code>\"ghci&gt;\" :l experiment\n[1 of 3] Compiling Geometry         ( Geometry.hs, interpreted )\n[2 of 3] Compiling Shapes           ( Shapes.hs, interpreted )\n[3 of 3] Compiling Main             ( experiment.hs, interpreted )\nOk, three modules loaded.\n</code></pre>\n\n<p>What is going wrong exactly?</p>\n\n<p>In my file <code>experiment.hs</code> I have the following modules at the top of the emacs file:</p>\n\n<pre><code>  import Data.List\n\n  import Data.Char\n\n  import qualified Data.Map as Map\n\n  import qualified Data.Set as Set\n\n  import Control.Monad\n\n  import Geometry\n\n  import Shapes`\n</code></pre>\n\n<p>I have two files accessible from the terminal via emacs <code>/Users/macbookpro/Downloads/Shapes.hs</code>, and <code>emacs /Users/macbookpro/Downloads/Geometry.hs</code>, which contain various functions relevant to my <code>experiment.hs</code> file. I note that these files do not appear in the current directory on the terminal.</p>\n"}, {"tags": ["list", "haskell", "list-comprehension", "fibonacci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525094358, "post_id": 50101409, "comment_id": 87219459, "body": "The above is not an efficient implementation, it will run in exponential time."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525115021, "post_id": 50101409, "comment_id": 87230534, "body": "like <a href=\"https://stackoverflow.com/questions/11466284/how-is-this-fibonacci-function-memoized\">this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525094532, "post_id": 50101472, "comment_id": 87219552, "body": "You can drop the <code>Int -&gt;</code> part of the signature :)"}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525094599, "post_id": 50101472, "comment_id": 87219595, "body": "No, I just forgot to include it on the LHS (he wants up to the nth element)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1525095412, "post_id": 50101472, "comment_id": 87220088, "body": "<code>take</code> + an infinite list is very modular, but when it&#39;s this local, I&#39;d just do the rewrite to <code>map fib [0..n-1]</code>, personally."}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1525095853, "post_id": 50101472, "comment_id": 87220405, "body": "You&#39;re right, but I think this has more utility as a pedagogical example. Perhaps moving <code>map fib [0..]</code> to a <code>where</code> clause would have made that clearer?"}], "tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 3, "last_activity_date": 1525094564, "last_edit_date": 1525094564, "creation_date": 1525094494, "answer_id": 50101472, "question_id": 50101409, "link": "https://stackoverflow.com/questions/50101409/fibonacci-infinite-list-in-haskell/50101472#50101472", "title": "Fibonacci infinite list in Haskell", "body": "<p>Not a fast way (because your function runs in exponential time), but using your function <code>fib</code></p>\n\n<pre><code>nfibs :: Int -&gt; [Integer]\nnfibs n = take n (map fib [0..])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 9278225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c78a691a3f82dee01c5c5e918dbf4c?s=128&d=identicon&r=PG&f=1", "display_name": "CoreNoob", "link": "https://stackoverflow.com/users/9278225/corenoob"}, "edited": false, "score": 1, "creation_date": 1525095508, "post_id": 50101475, "comment_id": 87220144, "body": "Thank you for your example. The graphic is also a very good help. I ask myself how did you do that graphic? :D Do you have a program to help you create such kind of graphics or did you do it yourself?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 107, "user_id": 9278225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c78a691a3f82dee01c5c5e918dbf4c?s=128&d=identicon&r=PG&f=1", "display_name": "CoreNoob", "link": "https://stackoverflow.com/users/9278225/corenoob"}, "edited": false, "score": 2, "creation_date": 1525095581, "post_id": 50101475, "comment_id": 87220192, "body": "@CoreNoob: I write the ascii art myself :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1525098036, "last_edit_date": 1525098036, "creation_date": 1525094507, "answer_id": 50101475, "question_id": 50101409, "link": "https://stackoverflow.com/questions/50101409/fibonacci-infinite-list-in-haskell/50101475#50101475", "title": "Fibonacci infinite list in Haskell", "body": "<p>A compact definition (that scales linear) is the following:</p>\n\n<pre><code>fib :: Num n =&gt; [n]\nfib = 0 : nxt\n    where nxt = 1 : zipWith (+) fib nxt\n\nfibN :: Num n =&gt; Int -&gt; [n]\nfibN = flip take fib\n</code></pre>\n\n<p>What we here do is constructing a list <code>fib</code> that is \"cons\" of <code>0</code> and <code>nxt</code> (the rest of the lists). <code>nxt</code> is defined in the <code>where</code> clause as a \"cons\" of 1 and and the result of <code>zipWith (+) fib nxt</code>. The <code>zipWith</code> elementwise adds the elements of <code>fib</code> and <code>nxt</code> together, since <code>nxt</code> is always one element \"ahead\" of <code>fib</code>, we thus add the two last elements together. We then <code>take</code> the first <code>n</code> elements in the <code>fibN</code> function.</p>\n\n<p>So we obtain a list like:</p>\n\n<pre><code>   fib          nxt\n    |            |\n    v            v\n+-------+    +-------+    +-------------+\n|  (:)  | ,-&gt;|  (:)  | ,-&gt;|   zipWith   |\n+---+---+ |  +---+---+ |  +-----+---+---+\n| 0 | o---'  | 1 | o---'  | (+) | o | o |\n+---+---+    +---+---+    +-----+-|-+-|-+\n  ^            ^                  |   |\n  |            `------------------|---'\n  `-------------------------------'\n</code></pre>\n\n<p>In case we thus evaluate up to the third element, this means that we call <code>zipWith</code>, and this will produce the sum of the head of <code>fib</code> and <code>nxt</code> and advance both points, like:</p>\n\n<pre><code>   fib          nxt\n    |            |\n    v            v\n+-------+    +-------+    +-------+    +-------------+\n|  (:)  | ,-&gt;|  (:)  | ,-&gt;|  (:)  | ,-&gt;|   zipWith   |\n+---+---+ |  +---+---+ |  +---+---+ |  +-----+---+---+\n| 0 | o---'  | 1 | o---'  | 1 | o---'  | (+) | o | o |\n+---+---+    +---+---+    +---+---+    +-----+-|-+-|-+\n               ^            ^                  |   |\n               |            `------------------|---'\n               `-------------------------------'\n</code></pre>\n\n<p>and so on.</p>\n"}], "owner": {"reputation": 107, "user_id": 9278225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c78a691a3f82dee01c5c5e918dbf4c?s=128&d=identicon&r=PG&f=1", "display_name": "CoreNoob", "link": "https://stackoverflow.com/users/9278225/corenoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 0, "accepted_answer_id": 50101475, "answer_count": 2, "score": 1, "last_activity_date": 1525098036, "creation_date": 1525094275, "question_id": 50101409, "link": "https://stackoverflow.com/questions/50101409/fibonacci-infinite-list-in-haskell", "title": "Fibonacci infinite list in Haskell", "body": "<p>I want to create a list of Fibonacci numbers.\nI want to call fib x and it should give me a list till the xth element.\nHow do I achieve that.</p>\n\n<p>I would calculate fib numbers like this:</p>\n\n<pre><code>fib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>How do I put the result in a list to call the list till the element I need?</p>\n"}, {"tags": ["haskell", "streaming", "bytestring", "bitstream"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1525153611, "post_id": 50101329, "comment_id": 87240908, "body": "<code>(w `shiftR` i) .&amp;. 1 == 1</code> can be replaced with <code>testBit w i</code>, which is the approximately equivalent <code>w .&amp;. (1 `shiftL` i) &#47;= 0</code>."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1525153820, "post_id": 50101329, "comment_id": 87240956, "body": "Streaming bits read from input happens in IO because the source of the stream of bits is IO. Your program can be written purely in terms of an arbitrary <code>Monad m =&gt; </code> and then used in IO in main."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1525153839, "post_id": 50101329, "comment_id": 87240960, "body": "One thing to look at is <a href=\"https://github.com/haskell-streaming/streaming/issues/47\" rel=\"nofollow noreferrer\">github.com/haskell-streaming/streaming/issues/47</a> which has been fixed in master."}], "answers": [{"comments": [{"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "edited": false, "score": 0, "creation_date": 1525175776, "post_id": 50115664, "comment_id": 87249201, "body": "Hmmm... Interesting. But it is a lot of effort for still being about 7x slower than C. (The 8.65s looks wrong to me. The naive ByteString implementation isn&#39;t that bad.)"}, {"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "edited": false, "score": 0, "creation_date": 1525176486, "post_id": 50115664, "comment_id": 87249536, "body": "I get much less favourable performance for the C code: longest-seq-c: 0m0.711s, longest-seq: 0m6.876s, longest-seq-fuse: 0m0.851s !! (gcc=Apple LLVM version 9.0.0)"}, {"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "edited": false, "score": 1, "creation_date": 1525259321, "post_id": 50115664, "comment_id": 87284228, "body": "I did some more tests. With llvm-3.9 (i.e using -fllvm instead of -fasm in the cabal file) your solution is basically on par with C."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 1, "last_activity_date": 1525173976, "creation_date": 1525173976, "answer_id": 50115664, "question_id": 50101329, "link": "https://stackoverflow.com/questions/50101329/efficient-bitstreams-in-haskell/50115664#50115664", "title": "Efficient bitstreams in Haskell", "body": "<p>Intermediate allocations and their corresponding overhead can be removed when operations on streams fuse together. The GHC prelude provides foldr/build fusion for lazy streams in the form of <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#list-fusion\" rel=\"nofollow noreferrer\">rewrite rules</a>. The general idea is if one function produces a result that looks like a foldr (it has the type <code>(a -&gt; b -&gt; b) -&gt; b -&gt; b</code> applied to <code>(:)</code> and <code>[]</code>) and another function consumes a list that looks like a foldr, constructing the intermediate list can be removed.</p>\n\n<p>For your problem I'm going to build something similar, but using strict left folds (<code>foldl'</code>) instead of foldr. Instead of using rewrite rules that try to detect when something looks like a <code>foldl</code>, I'll use a data type that forces lists to look like left folds.</p>\n\n<pre><code>-- A list encoded as a strict left fold.\nnewtype ListS a = ListS {build :: forall b. (b -&gt; a -&gt; b) -&gt; b -&gt; b}\n</code></pre>\n\n<p>Since I've started by abandoning lists we'll be re-implementing part of the prelude for lists. </p>\n\n<p>Strict left folds can be created from the <code>foldl'</code> functions of both lists and bytestrings.</p>\n\n<pre><code>{-# INLINE fromList #-}\nfromList :: [a] -&gt; ListS a\nfromList l = ListS (\\c z -&gt; foldl' c z l)\n\n{-# INLINE fromBS #-}\nfromBS :: BSL.ByteString -&gt; ListS Word8\nfromBS l = ListS (\\c z -&gt; BSL.foldl' c z l)\n</code></pre>\n\n<p>The simplest example of using one is to find the length of a list.</p>\n\n<pre><code>{-# INLINE length' #-}\nlength' :: ListS a -&gt; Int\nlength' l = build l (\\z a -&gt; z+1) 0\n</code></pre>\n\n<p>We can also map and concatenate left folds.</p>\n\n<pre><code>{-# INLINE map' #-}\n-- fmap renamed so it can be inlined\nmap' f l = ListS (\\c z -&gt; build l (\\z a -&gt; c z (f a)) z)\n\n{-# INLINE concat' #-}\nconcat' :: ListS (ListS a) -&gt; ListS a\nconcat' ll = ListS (\\c z -&gt; build ll (\\z l -&gt; build l c z) z)\n</code></pre>\n\n<p>For your problem we need to be able to split a word into bits.</p>\n\n<pre><code>{-# INLINE splitByte #-}\nsplitByte :: Word8 -&gt; [Bool]\nsplitByte w = Prelude.map (\\i-&gt; (w `shiftR` i) .&amp;. 1 == 1) [0..7]\n\n{-# INLINE splitByte' #-}\nsplitByte' :: Word8 -&gt; ListS Bool\nsplitByte' = fromList . splitByte\n</code></pre>\n\n<p>And a <code>ByteString</code> into bits</p>\n\n<pre><code>{-# INLINE bitStream' #-}\nbitStream' :: BSL.ByteString -&gt; ListS Bool\nbitStream' = concat' . map' splitByte' . fromBS\n</code></pre>\n\n<p>To find the longest run we'll keep track of the previous value, the length of the current run, and the length of the longest run. We make the fields strict so that the strictness of the fold prevents chains of thunks from being accumulated in memory. Making a strict data type for a state is an easy way to get control over both its memory representation and when its fields are evaluated.</p>\n\n<pre><code>data LongestRun = LongestRun !Bool !Int !Int\n\n{-# INLINE extendRun #-}\nextendRun (LongestRun previous run longest) x = LongestRun x current (max current longest)\n  where\n    current = if x == previous then run + 1 else 1\n\n{-# INLINE longestRun #-}\nlongestRun :: ListS Bool -&gt; Int\nlongestRun l = longest\n where\n   (LongestRun _ _ longest) = build l extendRun (LongestRun False 0 0)\n</code></pre>\n\n<p>And we're done</p>\n\n<pre><code>main :: IO ()\nmain = do\n    bs &lt;- BSL.getContents\n    print $ longestRun $ bitStream' bs\n</code></pre>\n\n<p>This is much faster, but not quite the performance of c.</p>\n\n<pre><code>longest-seq-c       0m00.12s    (C)\nlongest-seq         0m08.65s    (Haskell ByteString)\nlongest-seq-fuse    0m00.81s    (Haskell ByteString fused)\n</code></pre>\n\n<p>The program allocates about 1 Mb to read 1000000 bytes from input.</p>\n\n<pre><code>total alloc =   1,173,104 bytes  (excludes profiling overheads)\n</code></pre>\n\n<p>Updated <a href=\"https://github.com/Cedev/haskell-efficient-bitstreams\" rel=\"nofollow noreferrer\">github code</a></p>\n"}, {"tags": [], "owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "is_accepted": false, "score": 0, "last_activity_date": 1530012480, "last_edit_date": 1530012480, "creation_date": 1530011631, "answer_id": 51041535, "question_id": 50101329, "link": "https://stackoverflow.com/questions/50101329/efficient-bitstreams-in-haskell/51041535#51041535", "title": "Efficient bitstreams in Haskell", "body": "<p>I found another solution that is on par with C. The <a href=\"http://hackage.haskell.org/package/vector-0.12.0.1/docs/Data-Vector-Fusion-Stream-Monadic.html\" rel=\"nofollow noreferrer\"><code>Data.Vector.Fusion.Stream.Monadic</code></a> has a stream implementation based on this <a href=\"http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.104.7401\" rel=\"nofollow noreferrer\">Coutts, Leshchinskiy, Stewart 2007 paper</a>. The idea behind it is to use a destroy/unfoldr stream fusion.</p>\n\n<p>Recall that list's <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-List.html#v:unfoldr\" rel=\"nofollow noreferrer\">unfoldr</a> <code>:: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]</code> creates a list by repeatedly applying (unfolding) a step-forward function, starting with an initial value.  A <code>Stream</code> is just an <code>unfoldr</code> function with starting state.  (The <code>Data.Vector.Fusion.Stream.Monadic</code> library uses GADTs to create constructors for <a href=\"http://hackage.haskell.org/package/vector-0.12.0.1/docs/Data-Vector-Fusion-Stream-Monadic.html#t:Step\" rel=\"nofollow noreferrer\"><code>Step</code></a> that can be pattern-matched conveniently. It could just as well be done without GADTs, I think.)</p>\n\n<p>The central piece of the solution is the <code>mkBitstream :: BSL.ByteString -&gt; Stream Bool</code> function that turns a <code>BytesString</code> into a stream of <code>Bool</code>. Basically, we keep track of the current <code>ByteString</code>, the current byte, and how much of the current byte is still unconsumed. Whenever a byte is used up another byte is chopped off <code>ByteString</code>. When <code>Nothing</code> is left, the stream is <code>Done</code>.</p>\n\n<p>The <code>longestRun</code> function is taken straight from @Cirdec's solution. </p>\n\n<p>Here's the etude:</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\n#define PHASE_FUSED [1]\n#define PHASE_INNER [0]\n#define INLINE_FUSED INLINE PHASE_FUSED\n#define INLINE_INNER INLINE PHASE_INNER\nmodule Main where\n\nimport           Control.Monad.Identity            (Identity)\nimport           Data.Bits                         (shiftR, (.&amp;.))\nimport qualified Data.ByteString.Lazy              as BSL\nimport           Data.Functor.Identity             (runIdentity)\nimport qualified Data.Vector.Fusion.Stream.Monadic as S\nimport           Data.Word8                        (Word8)\n\ntype Stream a = S.Stream Identity a   -- no need for any monad, really\n\ndata Step = Step BSL.ByteString !Word8 !Word8   -- could use tuples, but this is faster\n\nmkBitstream :: BSL.ByteString -&gt; Stream Bool\nmkBitstream bs' = S.Stream step (Step bs' 0 0) where\n    {-# INLINE_INNER step #-}\n    step (Step bs w n) | n==0 = case (BSL.uncons bs) of\n                            Nothing        -&gt; return S.Done\n                            Just (w', bs') -&gt; return $ \n                                S.Yield (w' .&amp;. 1 == 1) (Step bs' (w' `shiftR` 1) 7)\n                       | otherwise = return $ \n                                S.Yield (w .&amp;. 1 == 1) (Step bs (w `shiftR` 1) (n-1))\n\n\ndata LongestRun = LongestRun !Bool !Int !Int\n\n{-# INLINE extendRun #-}\nextendRun :: LongestRun -&gt; Bool -&gt; LongestRun\nextendRun (LongestRun previous run longest) x  = LongestRun x current (max current longest)\n    where current = if x == previous then run + 1 else 1\n\n{-# INLINE longestRun #-}\nlongestRun :: Stream Bool -&gt; Int\nlongestRun s = runIdentity $ do\n    (LongestRun _ _ longest) &lt;- S.foldl' extendRun (LongestRun False 0 0) s\n    return longest\n\nmain :: IO ()\nmain = do\n    bs &lt;- BSL.getContents\n    print $ longestRun (mkBitstream bs)\n</code></pre>\n"}], "owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 3, "accepted_answer_id": 50115664, "answer_count": 2, "score": 14, "last_activity_date": 1530012480, "creation_date": 1525094000, "last_edit_date": 1525323920, "question_id": 50101329, "link": "https://stackoverflow.com/questions/50101329/efficient-bitstreams-in-haskell", "title": "Efficient bitstreams in Haskell", "body": "<p>In an ongoing endeavour to efficiently fiddle with bits (e.g. see this <a href=\"https://stackoverflow.com/questions/43601927/efficient-bit-fiddling-in-a-lfsr-implementation\">SO question</a>) the newest challenge is the efficient streaming and consumption of bits.</p>\n\n<p>As a first simple task I choose to find the longest sequence of identical bits in a bitstream generated by <code>/dev/urandom</code>. A typical incantation would be <code>head -c 1000000 &lt;/dev/urandom | my-exe</code>. The actual goal is to stream bits and decode an <a href=\"https://en.wikipedia.org/wiki/Elias_gamma_coding\" rel=\"nofollow noreferrer\">Elias gamma code</a>, for example, i.e. codes that are not chunks of bytes or multiples thereof.</p>\n\n<p>For such codes of variable length it is nice to have the <code>take</code>, <code>takeWhile</code>, <code>group</code>, etc. language for list manipulation. Since a <code>BitStream.take</code> would actually consume part of the bistream some monad would probably come into play.</p>\n\n<p>The obvious starting point is the lazy bytestring from <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString-Lazy.html\" rel=\"nofollow noreferrer\"><code>Data.ByteString.Lazy</code></a>.</p>\n\n<p><strong>A. Counting bytes</strong></p>\n\n<p>This very simple Haskell program performs on par with a C program, as is to be expected.</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as BSL\n\nmain :: IO ()\nmain = do\n    bs &lt;- BSL.getContents\n    print $ BSL.length bs\n</code></pre>\n\n<p><strong>B. Adding bytes</strong></p>\n\n<p>Once I start using <code>unpack</code> things should get worse.</p>\n\n<pre><code>main = do\n    bs &lt;- BSL.getContents\n    print $ sum $ BSL.unpack bs\n</code></pre>\n\n<p>Suprisingly, Haskell and C show the almost same performance.</p>\n\n<p><strong>C. Longest sequence of identical bits</strong></p>\n\n<p>As a first nontrivial task the longest sequence of identical bits can be found like this:</p>\n\n<pre><code>module Main where\n\nimport           Data.Bits            (shiftR, (.&amp;.))\nimport qualified Data.ByteString.Lazy as BSL\nimport           Data.List            (group)\nimport           Data.Word8           (Word8)\n\nsplitByte :: Word8 -&gt; [Bool]\nsplitByte w = Prelude.map (\\i-&gt; (w `shiftR` i) .&amp;. 1 == 1) [0..7]\n\nbitStream :: BSL.ByteString -&gt; [Bool]\nbitStream bs = concat $ map splitByte (BSL.unpack bs)\n\nmain :: IO ()\nmain = do\n    bs &lt;- BSL.getContents\n    print $ maximum $ length &lt;$&gt; (group $ bitStream bs)\n</code></pre>\n\n<p>The lazy bytestring is converted to a list <code>[Word8]</code> and then, using shifts, each <code>Word</code> is split into the bits, resulting in a list <code>[Bool]</code>. This list of lists is then flattened with <code>concat</code>. Having obtained a (lazy) list of <code>Bool</code>, use <code>group</code> to split the list into sequences of identical bits and then map <code>length</code> over it. Finally <code>maximum</code> gives the desired result. Quite simple, but not very fast:</p>\n\n<pre><code># C\nreal    0m0.606s\n\n# Haskell\nreal    0m6.062s\n</code></pre>\n\n<p>This naive implementation is exactly one order of magnitude slower.</p>\n\n<p>Profiling shows that quite a lot of memory gets allocated (about 3GB for parsing 1MB of input). There is no massive space leak to be observed, though.</p>\n\n<p>From here I start poking around:</p>\n\n<ul>\n<li>There is a <a href=\"https://hackage.haskell.org/package/bitstream-0.2.0.4/docs/Data-Bitstream.html\" rel=\"nofollow noreferrer\"><code>bitstream</code> package</a> that promises \"<em>Fast, packed, strict bit streams (i.e. list of Bools) with semi-automatic stream fusion.</em>\". Unfortunately it is not up-to-date with the current <code>vector</code> package, see <a href=\"https://github.com/depressed-pho/bitstream/issues/6\" rel=\"nofollow noreferrer\">here</a> for details. </li>\n<li>Next, I investigate <a href=\"https://hackage.haskell.org/package/streaming\" rel=\"nofollow noreferrer\"><code>streaming</code></a>. I don't quite see why I should need 'effectful' streaming that brings some monad into play - at least until I start with the reverse of the posed task, i.e. encoding and writing bitstreams to file.</li>\n<li>How about just <code>fold</code>-ing over the <code>ByteString</code>? I'd have to introduce state to keep track of consumed bits. That's not quite the nice <code>take</code>, <code>takeWhile</code>, <code>group</code>, etc. language that is desirable.</li>\n</ul>\n\n<p>And now I'm not quite sure where to go.</p>\n\n<p><strong>Update</strong>:</p>\n\n<p>I figured out how to do this with <a href=\"https://hackage.haskell.org/package/streaming-0.2.1.0\" rel=\"nofollow noreferrer\"><code>streaming</code></a> and <a href=\"https://hackage.haskell.org/package/streaming-bytestring-0.1.6/docs/Data-ByteString-Streaming.html\" rel=\"nofollow noreferrer\"><code>streaming-bytestring</code></a>. I'm probably not doing this right because the result is catastrophically bad.</p>\n\n<pre><code>import           Data.Bits                 (shiftR, (.&amp;.))\nimport qualified Data.ByteString.Streaming as BSS\nimport           Data.Word8                (Word8)\nimport qualified Streaming                 as S\nimport           Streaming.Prelude         (Of, Stream)\nimport qualified Streaming.Prelude         as S\n\nsplitByte :: Word8 -&gt; [Bool]\nsplitByte w = (\\i-&gt; (w `shiftR` i) .&amp;. 1 == 1) &lt;$&gt; [0..7]\n\nbitStream :: Monad m =&gt; Stream (Of Word8) m () -&gt; Stream (Of Bool) m ()\nbitStream s = S.concat $ S.map splitByte s\n\nmain :: IO ()\nmain = do\n    let bs = BSS.unpack BSS.getContents :: Stream (Of Word8) IO ()\n        gs = S.group $ bitStream bs ::  Stream (Stream (Of Bool) IO) IO ()\n    maxLen &lt;- S.maximum $ S.mapped S.length gs\n    print $ S.fst' maxLen\n</code></pre>\n\n<p>This will test your patience with anything beyond a few thousand bytes of input from stdin. The profiler says it spends an insane amount of time (quadratic in the input size) in <code>Streaming.Internal.&gt;&gt;=.loop</code> and <code>Data.Functor.Of.fmap</code>. I'm not quite sure what the first one is, but the <code>fmap</code> indicates (?) that the juggling of these <code>Of a b</code> isn't doing us any good and because we're in the IO monad it can't be optimised away.</p>\n\n<p>I also have the streaming equivalent of the byte adder <a href=\"https://github.com/mcmayer/haskell-efficient-bitstreams/blob/master/SumBytesStream.hs\" rel=\"nofollow noreferrer\">here: <code>SumBytesStream.hs</code></a>, which is slightly slower than the simple lazy <code>ByteString</code> implementation, but still decent. Since <code>streaming-bytestring</code> is <a href=\"https://hackage.haskell.org/package/streaming-bytestring\" rel=\"nofollow noreferrer\">proclaimed</a> to be \"<em>bytestring io done right</em>\" I expected better. I'm probably not doing it right, then.</p>\n\n<p>In any case, all these bit-computations shouldn't be happening in the IO monad. But <code>BSS.getContents</code> forces me into the IO monad because <code>getContents :: MonadIO m =&gt; ByteString m ()</code> and there's no way out.</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>Following the advice of @dfeuer I used the <a href=\"https://github.com/haskell-streaming/streaming\" rel=\"nofollow noreferrer\"><code>streaming</code></a> package at master@HEAD. Here's the result.</p>\n\n<pre><code>longest-seq-c       0m0.747s    (C)\nlongest-seq         0m8.190s    (Haskell ByteString)\nlongest-seq-stream  0m13.946s   (Haskell streaming-bytestring)\n</code></pre>\n\n<p>The O(n^2) problem of <code>Streaming.concat</code> is solved, but we're still not getting closer to the C benchmark.</p>\n\n<p><strong>Update 3</strong></p>\n\n<p>Cirdec's solution produces a performance on par with C. The construct that is used is called \"Church encoded lists\", see this <a href=\"https://stackoverflow.com/questions/15589556/why-are-difference-lists-not-an-instance-of-foldable/15593349#15593349\">SO answer</a> or the Haskell Wiki on <a href=\"https://wiki.haskell.org/Rank-N_types\" rel=\"nofollow noreferrer\">rank-N types</a>.</p>\n\n<p><strong>Source files:</strong></p>\n\n<p>All the source files can be found on <a href=\"https://github.com/mcmayer/haskell-efficient-bitstreams\" rel=\"nofollow noreferrer\">github</a>. The <code>Makefile</code> has all the various targets to run the experiments and the profiling. The default <code>make</code> will just build everything (create a <code>bin/</code> directory first!) and then <code>make time</code> will do the timing on the <code>longest-seq</code> executables. The C executables get a <code>-c</code> appended to distinguish them. </p>\n"}, {"tags": ["python", "haskell", "functional-programming", "kotlin", "map-function"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1525097552, "post_id": 50099765, "comment_id": 87221425, "body": "What renders python&#39;s <code>map</code> less functional is the iterable protocol, because it abstracts from the structure you&#39;re iterating over. In FP <code>map</code> must preserve this very structure. Iterate is just too imprecise. In FP we <code>fold</code>, <code>map</code> or <code>traverse</code>."}, {"owner": {"reputation": 64040, "user_id": 3620003, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QnqtZ.jpg?s=128&g=1", "display_name": "timgeb", "link": "https://stackoverflow.com/users/3620003/timgeb"}, "edited": false, "score": 1, "creation_date": 1525109946, "post_id": 50099765, "comment_id": 87228239, "body": "This question may attract opinionated answers, but informed ones. It is also pretty specific in my view. Voted to reopen."}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525172236, "post_id": 50100065, "comment_id": 87247582, "body": "Yes, except that <code>map</code> in FP is structure preserving whereas map in python isn&#39;t. If all you really care about in the thing you&#39;re mapping over is what &quot;elements&quot; are inside of it - which is of course often enough - then this approach works fine. It&#39;s not actually at all better than something like <code>collection.asSequence.map</code>  which you can do just fine in all the other languages though. If you want a structure preserving map you&#39;re out of luck with the python approach."}, {"owner": {"reputation": 64040, "user_id": 3620003, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QnqtZ.jpg?s=128&g=1", "display_name": "timgeb", "link": "https://stackoverflow.com/users/3620003/timgeb"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525172439, "post_id": 50100065, "comment_id": 87247674, "body": "@Cubic true, you would manually have to cast the return value of <code>map</code> to whatever type you want in Python (e.g. <code>tuple(map(func, iterable))</code>). Not preserving the structure of the underlying iterable works fine in Python because the language has been carefully designed such that in almost all use cases, you either <i>should</i> simply not care or the &quot;correct&quot; data type for further processing is an obvious choice. Thanks for your input about the FP languages, I&#39;m underinformed with regards to these."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525172995, "post_id": 50100065, "comment_id": 87247931, "body": "For dictionaries, tuples and lists this works fine, but consider non-flat structures you could map over, like a tree: <code>Node 1 (Node 2 Empty Empty) (Node 3 Empty Empty)</code>. Now imagine you want to add one to all the nodes - with a structure preserving map you could do that, in an iterable based map there&#39;s no way to get the tree structure back out of the iterable."}], "tags": [], "owner": {"reputation": 64040, "user_id": 3620003, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QnqtZ.jpg?s=128&g=1", "display_name": "timgeb", "link": "https://stackoverflow.com/users/3620003/timgeb"}, "is_accepted": false, "score": 2, "last_activity_date": 1525089780, "last_edit_date": 1525089780, "creation_date": 1525089479, "answer_id": 50100065, "question_id": 50099765, "link": "https://stackoverflow.com/questions/50099765/map-as-class-member-versus-map-as-independent-function/50100065#50100065", "title": "map() as class member versus map() as independent function?", "body": "<p>This is somewhat opinion based, and my language of choice is Python, but I'll give it a shot.</p>\n\n<p>Python puts a very high emphasis on duck typing, especially with the iterable and sequence protocols.</p>\n\n<p>When you call <code>map(function, some_iterable)</code> it is - at least conceptually - not important what type <code>some_iterable</code> has, as long as you can pull values from it one by one in oder to apply a function to each of them. It could be a list, or a tuple, or a string, or a generator ... having a global <code>map</code> function ensures that all of these will work, even your self-written classes that are iterable by implementing <code>__iter__</code>. </p>\n\n<p>In my opinion it is far more elegant to implement the iterable protocol in <code>YourClass</code>, which unlocks a whole bunch of features, rather than writing your own <code>YourClass.map</code> function or having to call <code>list(YourClass_instance).map(function)</code>.</p>\n\n<p>Another example is the <code>str.join</code> method. Why do we write <code>\"sep\".join(my_list)</code> instead of <code>my_list.join(sep)</code>? It's again the fact that when building the resulting string, you don't really care if the values are pulled from a list, or set, or tuple, or any other iterable type. <code>str.join</code> accepts any iterable.</p>\n\n<p><code>len</code> is a builtin function for similar reasons. Sequences (and in general most containers) can expose their number of items with <code>len(my_container)</code> as long as they implement a <code>__len__</code> method, you don't have to guess whether it is <code>my_container.len()</code>, <code>my_container.num_items()</code>,  or <code>my_container.size()</code>.</p>\n\n<p><a href=\"http://lucumr.pocoo.org/2011/7/9/python-and-pola/\" rel=\"nofollow noreferrer\">Here</a> is a relevant article to this discussion.</p>\n"}, {"comments": [{"owner": {"reputation": 30387, "user_id": 6260170, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0caf9a0d28be362618ffc0223b301d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris_Rands", "link": "https://stackoverflow.com/users/6260170/chris-rands"}, "edited": false, "score": 1, "creation_date": 1525090130, "post_id": 50100082, "comment_id": 87216925, "body": "upvoted, but why are Kotlin and Dart different?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 30387, "user_id": 6260170, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0caf9a0d28be362618ffc0223b301d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris_Rands", "link": "https://stackoverflow.com/users/6260170/chris-rands"}, "edited": false, "score": 0, "creation_date": 1525095201, "post_id": 50100082, "comment_id": 87219976, "body": "Because the designers made different decisions. There&#39;s no right decision here."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1525138387, "last_edit_date": 1525138387, "creation_date": 1525089547, "answer_id": 50100082, "question_id": 50099765, "link": "https://stackoverflow.com/questions/50099765/map-as-class-member-versus-map-as-independent-function/50100082#50100082", "title": "map() as class member versus map() as independent function?", "body": "<p>Python's <code>map</code> doesn't just work for lists; it works for any iterable. Rather than add separate <code>map</code> methods to disparate classes (or adding a do-nothing <code>map</code> method to <code>object</code> and overriding it multiple times), Python uses the iterable protocol; any class that implements <code>__iter__</code> (providing an object the implements <code>__next__</code>) can be used with <code>map</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 3, "last_activity_date": 1525089594, "creation_date": 1525089594, "answer_id": 50100098, "question_id": 50099765, "link": "https://stackoverflow.com/questions/50099765/map-as-class-member-versus-map-as-independent-function/50100098#50100098", "title": "map() as class member versus map() as independent function?", "body": "<p>It doesn't really have anything to do with \"more functional\", just one of usage. </p>\n\n<p>Haskell doesn't have methods, so</p>\n\n<pre><code>newlist = map function somelist\n</code></pre>\n\n<p>is the only way to write it.</p>\n\n<p>In Python, <code>map</code> doesn't preserve the structure of the iterable, rather it makes either a new list (Python2) or a new map object (Python3). It's just a regular function which can take any iterable object as an argument, so it's not attached to a specific object. (On a side note, <code>map</code> isn't a particularly popular function, it's considered more \"pythonic\" to use a list or generator comprehension).</p>\n\n<p>In Kotlin, all iterables implement the method <code>map</code>. Unlike in Python where it's just a regular function, it's a regular (overridable) method, and is used as such.</p>\n\n<p>The real difference here, is that in Kotlin, we can override it with a more optimised version, whilst in Python we can't. This is probably more OOP, but it's not really any less functional.</p>\n"}, {"comments": [{"owner": {"reputation": 1644, "user_id": 6172447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tn7Gu.jpg?s=128&g=1", "display_name": "Tobias Marschall", "link": "https://stackoverflow.com/users/6172447/tobias-marschall"}, "edited": false, "score": 0, "creation_date": 1525091063, "post_id": 50100359, "comment_id": 87217460, "body": "Well here it\u2019s explained like you said (<a href=\"https://kotlinlang.org/docs/reference/extensions.html#extensions-are-resolved-statically\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/reference/&hellip;</a>) So .map() in kotlin is probably just an extension function? And do you know something about dart?"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 1644, "user_id": 6172447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tn7Gu.jpg?s=128&g=1", "display_name": "Tobias Marschall", "link": "https://stackoverflow.com/users/6172447/tobias-marschall"}, "edited": false, "score": 1, "creation_date": 1525091784, "post_id": 50100359, "comment_id": 87217842, "body": "@TobiasMarschall: Yes, <code>map</code> is an extension method <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/map.html\" rel=\"nofollow noreferrer\">made on <code>Iterable&lt;T&gt;</code></a>. Similarly, <a href=\"https://api.dartlang.org/stable/1.24.3/dart-core/Iterable/map.html\" rel=\"nofollow noreferrer\">Dart&#39;s <code>map</code></a> is made in the <a href=\"https://github.com/dart-lang/sdk/blob/master/sdk/lib/core/iterable.dart\" rel=\"nofollow noreferrer\"><code>Iterable</code> abstract class</a>. For comparison, Haskell has <a href=\"https://wiki.haskell.org/Foldable_and_Traversable\" rel=\"nofollow noreferrer\">various type classes (<code>Functor</code>, <code>Traversable</code>, ...</a>. The difference is mainly in how they do <a href=\"https://en.wikipedia.org/wiki/Loose_coupling\" rel=\"nofollow noreferrer\">loose coupling</a>."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 2, "last_activity_date": 1525090593, "creation_date": 1525090593, "answer_id": 50100359, "question_id": 50099765, "link": "https://stackoverflow.com/questions/50099765/map-as-class-member-versus-map-as-independent-function/50100359#50100359", "title": "map() as class member versus map() as independent function?", "body": "<blockquote>\n  <p>The Python/Haskell implementation is more \"functional\" isn\u00b4t it?</p>\n</blockquote>\n\n<p>Not much. The Kotlin syntax lends itself less to composition, but...</p>\n\n<p>Instead of composing (e.g. <code>(map f . map g) somelist</code>), you'd chain the method calls together (e.g. <code>somelist.map(f).map(g)</code>). This requires that the chained object supports <code>map</code>, so if you were to write your own list combinators, they'd have to be injected into that object. Since Kotlin supports <a href=\"https://kotlinlang.org/docs/reference/extensions.html\" rel=\"nofollow noreferrer\">extension methods</a>, you can still avoid coupling your data type and your higher-order list combinators (which is generally a drawback in object-oriented programming).</p>\n"}], "owner": {"reputation": 1644, "user_id": 6172447, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tn7Gu.jpg?s=128&g=1", "display_name": "Tobias Marschall", "link": "https://stackoverflow.com/users/6172447/tobias-marschall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "closed_date": 1525100053, "answer_count": 4, "score": 0, "last_activity_date": 1525138387, "creation_date": 1525088338, "last_edit_date": 1525092536, "question_id": 50099765, "link": "https://stackoverflow.com/questions/50099765/map-as-class-member-versus-map-as-independent-function", "closed_reason": "Needs more focus", "title": "map() as class member versus map() as independent function?", "body": "<p>I just found out that mapping a list is in e.g. Python and Haskell is done like this:</p>\n\n<pre><code>newlist = map(function, somelist)\n</code></pre>\n\n<p>In e.g. Kotlin and Dart it is done like this:</p>\n\n<pre><code>newlist = somelist.map(function)\n</code></pre>\n\n<p>I am wondering what advantages each solution has over the other?\nThe Python/Haskell implementation is more \"functional\" isn\u00b4t it?</p>\n"}, {"tags": ["haskell", "brackets", "reduction"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1525084673, "post_id": 50098745, "comment_id": 87213898, "body": "You can only use <code>$</code> in <i>expressions</i>, since <code>$</code> is not really Haskell syntax. It is an operator that basically is a way to &quot;trick&quot; Haskell in adding brackets itself."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525084767, "post_id": 50098745, "comment_id": 87213953, "body": "I furthermore do not see where you want to get rid of it anyway. You can pattern match with the content of <code>XY</code> instead of unpacking the tuple (and this can be more efficient), you can also remove the brackets of the <code>deriving</code>, since you only derive from one typeclass, and you can define a <code>pattern</code>."}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 2, "creation_date": 1525085114, "post_id": 50098745, "comment_id": 87214144, "body": "Unless you plan on adding some instances to your <code>XY</code> type (in which case <code>newtype</code> is a more appropriate than <code>data</code> here), you could make <code>XY</code> a <code>type</code> synonym and save yourself some parentheses - <code>vector (Vector (x1,y1) (x2,y2)) = [(x1,y1),(x2,y2)]</code>."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1525088257, "post_id": 50098745, "comment_id": 87215918, "body": "Clear! thanks for the explanations. One step further!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1525090423, "post_id": 50098745, "comment_id": 87217093, "body": "You don&#39;t have any type classes in your code; <code>Vector</code> and <code>XY</code> are just <i>types</i>."}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1525087250, "post_id": 50098908, "comment_id": 87215289, "body": "Can you also mention that <code>$</code> is just function application (+ hacks that we probably shouldn&#39;t mention here)? Might not be obvious to a beginner (which is the most likely audience here)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1525087637, "last_edit_date": 1525087637, "creation_date": 1525085168, "answer_id": 50098908, "question_id": 50098745, "link": "https://stackoverflow.com/questions/50098745/haskell-syntactic-reducing-brackets/50098908#50098908", "title": "Haskell, syntactic reducing brackets", "body": "<h1>The <code>$</code> operator</h1>\n\n<p>The <code>$</code> is <em>not</em> part of the Haskell syntax. It is a builtin <em>operator</em> <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:-36-\" rel=\"nofollow noreferrer\"><strong><code>($) :: (a -&gt; b) -&gt; a -&gt; b</code></strong></a> and the operator is defined as an <code>inxfixr 0</code> with implementation:</p>\n\n<pre><code>($) :: (a -&gt; b) -&gt; a -&gt; b\n($) f x = f x\n</code></pre>\n\n<p>So it takes as input a function <code>f</code> and a value <code>x</code>, and basically returns <code>f</code> applied to <code>x</code>. Since it has precedence <code>0</code>, that means that it binds very low, and hence if you write</p>\n\n<pre><code>f . g $ x + 2\n</code></pre>\n\n<p>you actually write:</p>\n\n<pre><code>($) ((.) f g) ((+) x 2)\n</code></pre>\n\n<p>which is a verbose form of:</p>\n\n<pre><code>((.) f g) ((+) x 2)\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>(f . g) (x + 2)\n</code></pre>\n\n<p>So it can be used as a \"<em>trick</em>\" to force Haskell to add brackets itself. Since it is an operator, and not part of the syntax, it does not work at other locations like type signatures, patterns, deriving clauses.</p>\n\n<p>The operator serves other purposes as well of course. For example we can use it in other higher-order functions (like <code>zipWith ($)</code> that takes a list of functions <code>[f1, f2, ...]</code> and a list of values <code>[x1, x2, ...]</code> and returns a list <code>[f1 x1, f2 x2, ...]</code>).</p>\n\n<h1>Minizing the number of brackets</h1>\n\n<p>We can however minimize the amount of brackets. The <code>deriving</code> clause for example does <em>not</em> need brackets if you only derive a <em>single</em> type class, so we can write it like:</p>\n\n<pre><code>data Vector = Vector XY XY deriving Show\ndata XY = XY (Float , Float) deriving Show\n</code></pre>\n\n<p>Furthermore in the function declaration, you <em>unpack</em> the tuples, but then you <em>replack</em> the tuple elements back in a tuple that is basically the same. We can reduce the expression (and reduce the amount of unpacking and repacking) by binding with the content of the <code>XY</code> constructor instead:</p>\n\n<pre><code>vector (Vector (XY xy1) (XY xy2)) = [xy1, xy2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1525103274, "post_id": 50101521, "comment_id": 87225003, "body": "Useful comment. The mapping over xy I don&#39;t quite grasp, but that is me being new to Haskell"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1525104079, "post_id": 50101521, "comment_id": 87225476, "body": "It&#39;s equivalent to <code>[xy (v1 v), xy (v2 v)]</code>; it just applies <code>xy</code> to each value in the second argument."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1525094683, "creation_date": 1525094683, "answer_id": 50101521, "question_id": 50098745, "link": "https://stackoverflow.com/questions/50098745/haskell-syntactic-reducing-brackets/50101521#50101521", "title": "Haskell, syntactic reducing brackets", "body": "<p>Using record syntax for your types,</p>\n\n<pre><code>data XY = XY {xy :: (Float, Float)} deriving (Show)\ndata Vector = Vector {v1 :: XY, v2 :: XY} deriving (Show)\n</code></pre>\n\n<p>you could write <code>vector</code> without explicit pattern matching:</p>\n\n<pre><code>vector :: Vector -&gt; [(Float, Float)]\nvector v = map xy [v1 v, v2 v]\n</code></pre>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1525094683, "creation_date": 1525084577, "last_edit_date": 1525084620, "question_id": 50098745, "link": "https://stackoverflow.com/questions/50098745/haskell-syntactic-reducing-brackets", "title": "Haskell, syntactic reducing brackets", "body": "<p>Nonsensical code I know, but trying to imprint typeclasses and so on in my brain.</p>\n\n<p>Question: how do I get rid of the brackets in the following function? '$' throws an error if I use that anywhere. </p>\n\n<pre><code>data Vector = Vector XY XY deriving (Show)\ndata XY = XY (Float , Float) deriving (Show)\nvector (Vector (XY (x1,y1)) (XY(x2,y2))) = [(x1,y1),(x2,y2)]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1525078163, "post_id": 50096970, "comment_id": 87210228, "body": "I think you reason one meta-level too high. Functions have <i>types</i> to reason about types, patterns to reason about <i>values</i>. So at the moment you write <code>g2</code>, you already know what the type is. I think you here want a <i>polymorphic</i> function."}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 2, "creation_date": 1525078703, "post_id": 50096970, "comment_id": 87210522, "body": "So what type does <code>g2</code> have? Try giving it a signature and you should see that you&#39;re describing two different functions (<code>head</code> and <code>head . head</code>)."}, {"owner": {"reputation": 121, "user_id": 4994693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf135adf371897e4c60586e96dabdd11?s=128&d=identicon&r=PG&f=1", "display_name": "Luca9984", "link": "https://stackoverflow.com/users/4994693/luca9984"}, "edited": false, "score": 0, "creation_date": 1525079169, "post_id": 50096970, "comment_id": 87210773, "body": "Thank you guys for clarifying . Seems like I need to find an other way to solve my problem."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1525080236, "post_id": 50096970, "comment_id": 87211388, "body": "@Luca9984 You may need a tree. Take a look in Data.Tree. A Node holds a data item and a list of sub-nodes. This is how you deal with data structures that in other languages might be handled by heterogenous lists of (items and lists)."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4994693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf135adf371897e4c60586e96dabdd11?s=128&d=identicon&r=PG&f=1", "display_name": "Luca9984", "link": "https://stackoverflow.com/users/4994693/luca9984"}, "edited": false, "score": 0, "creation_date": 1525094315, "post_id": 50098978, "comment_id": 87219427, "body": "Thank you for your in-depth answer. I managed to solve my problem by splitting my my function into multiple functions as you suggested."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 2, "last_activity_date": 1525087475, "last_edit_date": 1525087475, "creation_date": 1525085486, "answer_id": 50098978, "question_id": 50096970, "link": "https://stackoverflow.com/questions/50096970/distinguish-between-lists-of-lists-and-lists-using-pattern-matching/50098978#50098978", "title": "Distinguish between lists of lists and lists using pattern matching", "body": "<p>To elaborate on what Willem Van Onsem said, if you annotate your functions, you get:</p>\n\n<pre><code>-- aka `head`\ng2 :: [a] -&gt; a\ng2 (x:xs) = x\n\n-- aka `head . head`\ng2' :: [[a]] -&gt; a\ng2' ((x:xs):ys) = x\n</code></pre>\n\n<p>These cannot be the same function, because if <code>g2</code> sometimes takes as input <code>[a]</code> and sometimes takes as input <code>[[a]]</code>, then GHC will try to unify <code>a = [a]</code>, which GHC calls an infinite type (<code>a = [a]</code> \u21d2 <code>a = [[a]]</code> \u21d2 <code>a = [[[...a...]]]</code> infinitely).</p>\n\n<hr>\n\n<p>When you want to feed a function something that is sometimes a list and sometimes a list of lists, Haskell handles this using sum types, e.g.</p>\n\n<pre><code>g2 :: Either [a] [[a]] -&gt; a\ng2 (Left (x:xs)) = x\ng2 (Right ((x:xs):ys)) = x\n</code></pre>\n\n<p>and before using this function on any input, you have to know which one it is (e.g. <code>Left \"Hello\"</code>, <code>Right [\"Hello\", \"World\"]</code>). But beware that all of the <code>g2</code>s so far have been <a href=\"https://wiki.haskell.org/Partial_functions\" rel=\"nofollow noreferrer\"><em>partial</em></a>, which is bad. E.g. calling <code>g2 (Left [])</code>, <code>g2 (Right [])</code> or <code>g2 [Right [[]]</code> will crash.</p>\n\n<hr>\n\n<p>If instead of a list you had an n-ary tree (<a href=\"https://hackage.haskell.org/package/containers-0.5.11.0/docs/Data-Tree.html\" rel=\"nofollow noreferrer\"><code>Data.Tree</code></a>),</p>\n\n<pre><code>import Data.Tree\n</code></pre>\n\n<p>then this lets you nest lists arbitrarily:</p>\n\n<pre><code>g2 :: Tree a -&gt; a\ng2 (Tree x []) = x\ng2 (Tree _ (Tree x : _)) = x\n</code></pre>\n\n<p>or you can even get the first element of the first tree with no sub-forests, or at most <code>n</code> deep:</p>\n\n<pre><code>g :: Int -&gt; Tree a -&gt; a\ng 0 (Tree x _) = x\ng _ (Tree x []) = x\ng n (Tree _x t) = g (n-1) t\n\ng2 :: Tree a -&gt; a\ng2 = g 1\n</code></pre>\n\n<p>Because of the way <code>Tree a</code> is defined, this kind of tree cannot be empty, and so this <code>g2</code> isn't partial. Unlike <code>[[a]]</code>, <code>Tree a</code> has both an <code>x</code> at the top-level of the tree (e.g. <code>_x</code> above) and possibly an <code>x</code> another level in.</p>\n\n<hr>\n\n<p>If you <em>(a)</em> intend for your input only to be nested two deep, <em>(b)</em> the notion of a \"parent value\" doesn't make sense in your case, and <em>(c)</em> you want to guarantee at the type level that the <code>x</code> you're looking for will exist, perhaps it is better to compose <a href=\"https://hackage.haskell.org/package/semigroups-0.18/docs/Data-List-NonEmpty.html\" rel=\"nofollow noreferrer\"><code>Data.List.NonEmpty</code></a>:</p>\n\n<pre><code>import Data.List.NonEmpty\n\ntype NestedNonEmpty a = Either (NonEmpty a) (NonEmpty (NonEmpty a))\n\ng2 :: NestedNonEmpty a -&gt; a\ng2 (Left (x :| _)) = x\ng2 (Right ((x :| _) :| _)) = x\n</code></pre>\n\n<p>You could then use it like:</p>\n\n<pre><code>onetwothree :: NonEmpty Int\nonetwothree = 1 :| 2 : 3 : []\n\nt1, t2 :: NestedNonEmpty Int\nt1 = Left onetwothree\nt2 = Right $ onetwothree :| fmap (+3) onetwothree : []\n\ndemo1, demo2 :: Int\ndemo1 = g2 t1 -- 1\ndemo2 = g2 t2 -- 1\n</code></pre>\n\n<p>But since this data type is overly specific, perhaps it is good to revise what your input will actually look like and consequently what its type then must be. Since you commented that you'd have to find another way to solve your problem, perhaps ask a question with that problem in focus to not make this an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">X-Y problem</a>. :-)</p>\n"}], "owner": {"reputation": 121, "user_id": 4994693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf135adf371897e4c60586e96dabdd11?s=128&d=identicon&r=PG&f=1", "display_name": "Luca9984", "link": "https://stackoverflow.com/users/4994693/luca9984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 50098978, "answer_count": 1, "score": 0, "last_activity_date": 1525087626, "creation_date": 1525078060, "last_edit_date": 1525087626, "question_id": 50096970, "link": "https://stackoverflow.com/questions/50096970/distinguish-between-lists-of-lists-and-lists-using-pattern-matching", "title": "Distinguish between lists of lists and lists using pattern matching", "body": "<p>Basicallly I want to do something like this: (Which does't work)</p>\n\n<pre><code>g2 (x:xs) = x\ng2 ((x:xs):ys) = x\n</code></pre>\n\n<p>So if g2 gets a list it should extract the first element of the list and if it is a list of lists it is supposed to extract the first element in the first list.</p>\n"}, {"tags": ["haskell", "combinatory-logic"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525073986, "post_id": 50095962, "comment_id": 87208158, "body": "In Haskell <code>True</code> and <code>False</code> are constructors, hence you should use an uppercase, or in case you want the lambda variant, then you can not use an <code>if</code>, but then you should call the functions."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525074038, "post_id": 50095962, "comment_id": 87208186, "body": "Can you share your exact implementation?"}, {"owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525074167, "post_id": 50095962, "comment_id": 87208239, "body": "@WillemVanOnsem, here <code>true</code> and <code>false</code> is not the same in Haskell. It defines as <code>false = Ap K I</code>, <code>true = K</code>. My intention of using <code>if then else</code> has nothing to do with Haskell, just pseudo code. You can  see the problem on codewars for more info."}, {"owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525074405, "post_id": 50095962, "comment_id": 87208338, "body": "@WillemVanOnsem <a href=\"https://repl.it/@delta4d/SKI\" rel=\"nofollow noreferrer\">repl.it/@delta4d/SKI</a>"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1525093587, "post_id": 50100746, "comment_id": 87218942, "body": "I guess that if <code>x</code> has a polymorphic type <code>forall a. a-&gt;a-&gt;a</code> then that code could be compiled. This requires higher rank types, and turning on the suitable Haskell extensions."}], "tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": true, "score": 2, "last_activity_date": 1525092297, "last_edit_date": 1525092297, "creation_date": 1525091982, "answer_id": 50100746, "question_id": 50095962, "link": "https://stackoverflow.com/questions/50095962/express-xor-in-ski-combinators/50100746#50100746", "title": "Express XOR in SKI combinators", "body": "<p>The problem comes from the double use of <code>x</code> in <code>\u03bbxy.y (x false true) x</code>. It's forced to have two types simultaneously. Since <code>y</code> uses <code>x</code>, <code>y</code> must return something of let's say type <code>a</code>. Now this means that <code>x false true</code> is also of type <code>a</code>. So something of type <code>a</code> must be <code>(b -&gt; b -&gt; a)</code> (for some <code>b</code>). But that's impossible, since that means <code>a</code> must contain itself.</p>\n\n<p>It's worth noting that your solution is correct wrt. SK, just not Haskell's type system. So to fix we need to not use <code>x</code> twice with different types. So why not make them the same type with <code>\u03bbxy.y(x false true)(x true false)</code>?</p>\n"}], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 2, "accepted_answer_id": 50100746, "answer_count": 1, "score": 4, "last_activity_date": 1525138530, "creation_date": 1525073841, "last_edit_date": 1525138530, "question_id": 50095962, "link": "https://stackoverflow.com/questions/50095962/express-xor-in-ski-combinators", "title": "Express XOR in SKI combinators", "body": "<p>I am trying to solve <a href=\"https://www.codewars.com/kata/sure-but-can-you-ski-i\" rel=\"nofollow noreferrer\">sure but can you SKI</a> on codewars. It is about to express lambda in SKI combinators. Source is at <a href=\"https://repl.it/@delta4d/SKI\" rel=\"nofollow noreferrer\">https://repl.it/@delta4d/SKI</a>.</p>\n\n<p>After some researching, especially the <a href=\"https://en.wikipedia.org/wiki/Combinatory_logic#Completeness_of_the_S-K_basis\" rel=\"nofollow noreferrer\">Combinatory Logic</a>, I am able to solve all the cases except <code>xor</code>.</p>\n\n<p>I first translates xor into</p>\n\n<pre><code>xor x y = if y \n          then if x\n               then false\n               else true\n          else x\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>xor = \\x y -&gt; y (x false true) x\n-- false = K I\n-- true = K\n</code></pre>\n\n<p>applying lambda to SKI rules, I got</p>\n\n<pre><code>\\x.\\y.y (x false true) x\n\\x.S (\\y.y (x false true)) (K x)\n\\x.S (S I (K (x false true))) (K x)\nS (\\x.S (S I (K (x false true)))) K\nS (S (K S) (\\x.S I (K (x false true)))) K\nS (S (K S) (S (K (S I)) (\\x.K (x false true)))) K\nS (S (K S) (S (K (S I)) (S (K K) (\\x.x false true)))) K\nS (S (K S) (S (K (S I)) (S (K K) (S (\\x.x false) (K true))))) K\nS (S (K S) (S (K (S I)) (S (K K) (S (S I (K false)) (K true))))) K\n</code></pre>\n\n<p>I have checked the SKI presentation on <a href=\"http://ski.aditsu.net\" rel=\"nofollow noreferrer\">http://ski.aditsu.net</a>, it works fine.</p>\n\n<p>Haskell sources compiles, but got runtime error.</p>\n\n<p>Codewars reports:</p>\n\n<blockquote>\n<pre><code>Couldn't match type `a' with `Bool' a'\n  `a' is a rigid type variable bound by\n      a type expected by the context: a -&gt; a -&gt; a at Kata.hs:66:9\nExpected type: SKI\n                 (Bool' a -&gt; (Bool' a -&gt; Bool' a -&gt; Bool' a) -&gt; a -&gt; a -&gt; a)\n  Actual type: SKI (Bool' (Bool' a))\nIn the second argument of `xorF', namely `true'\nIn the second argument of `($)', namely `xorF true true'\n</code></pre>\n</blockquote>\n\n<p>I have test on local with <code>prettyPrintSKI $ Ap (Ap xor' false) true</code>, and it reports:</p>\n\n<blockquote>\n<pre><code>\u2022 Occurs check: cannot construct the infinite type: a20 ~ Bool' a20\n  Expected type: SKI\n                   (Bool' a20 -&gt; (Bool' a20 -&gt; Bool' a20 -&gt; Bool' a20) -&gt; Bool' a20)\n    Actual type: SKI (Bool' (Bool' a20))\n\u2022 In the second argument of \u2018Ap\u2019, namely \u2018true\u2019\n  In the second argument of \u2018($)\u2019, namely \u2018Ap (Ap xor' false) true\u2019\n  In the expression: prettyPrintSKI $ Ap (Ap xor' false) true\n</code></pre>\n</blockquote>\n\n<p>What is the infinite type about? what is the rigid type?</p>\n\n<p>I am doing the same thing on <code>or</code> as <code>or = \\x y -&gt; x true y</code>, and it works just fine.</p>\n\n<hr>\n\n<ol>\n<li><a href=\"https://www.codewars.com/kata/sure-but-can-you-ski-i\" rel=\"nofollow noreferrer\">https://www.codewars.com/kata/sure-but-can-you-ski-i</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Combinatory_logic\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Combinatory_logic</a></li>\n<li><a href=\"http://ski.aditsu.net\" rel=\"nofollow noreferrer\">http://ski.aditsu.net</a></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1525065476, "post_id": 50094251, "comment_id": 87204676, "body": "&quot;Not in scope&quot; means that it can&#39;t find <i>any</i> definition.  It&#39;s not a type error, it&#39;s an import error."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1525065765, "post_id": 50094251, "comment_id": 87204759, "body": "Well why would i need anything imported since i&#39;m using only primitive functions."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 5, "creation_date": 1525068269, "post_id": 50094251, "comment_id": 87205613, "body": "@BercoviciAdrian Where is your implementation of <code>afold</code> and where are you trying to run it? The &quot;Not in scope&quot; error is because it cannot find <code>afold</code> at all. As Carl said, the type section of that error is not very significant (in this particular context)."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1525076484, "post_id": 50094251, "comment_id": 87209269, "body": "<code>:: (Integer -&gt; Integer -&gt; Integer) -&gt; (...)</code> isn&#39;t an error, that&#39;s a type signature. Could you actually write the <b>full, unedited</b> error?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1525077133, "post_id": 50094251, "comment_id": 87209582, "body": "I solved it.I didn&#39;t place it in a module to load it."}], "answers": [{"tags": [], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1525077221, "creation_date": 1525077221, "answer_id": 50096759, "question_id": 50094251, "link": "https://stackoverflow.com/questions/50094251/fold-not-in-scope/50096759#50096759", "title": "Fold not in scope", "body": "<p>The problem was that i didn't place the method inside a <code>module</code> ,and load it.Once i enclosed the method in a module and loaded it in ghci it worked.</p>\n\n<pre><code>module Test where\nafold::(a-&gt;b-&gt;a)-&gt;a-&gt;[b]-&gt;a\nafold tsf accu (x:xs)=afold tsf (tsf accu x) xs\nafold _ accu []=accu\n</code></pre>\n\n<p>In GHCI:</p>\n\n<pre><code>:load Test\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 50096759, "answer_count": 1, "score": 1, "last_activity_date": 1525089535, "creation_date": 1525064713, "last_edit_date": 1525089535, "question_id": 50094251, "link": "https://stackoverflow.com/questions/50094251/fold-not-in-scope", "title": "Fold not in scope", "body": "<p>Hello can someone explain to me why this custom implementaiton of foldl is not in scope?</p>\n\n<pre><code>afold::(a-&gt;b-&gt;a)-&gt;a-&gt;[b]-&gt;a\nafold tsf accu (x:xs)=afold tsf (tsf accu x) xs\nafold _ accu []=accu\n</code></pre>\n\n<p>I've tried running it like this :</p>\n\n<pre><code>afold (\\x y-&gt; show y:x) [] [1,2,3,4]\n</code></pre>\n\n<p>and i get the error:</p>\n\n<pre><code>Variable not in scope:\n      afold :: ([String] -&gt; () -&gt; [String]) -&gt; [a0] -&gt; [Integer] -&gt; t\n</code></pre>\n\n<p>When i try to use it even simpler like this :</p>\n\n<pre><code> afold (\\x y-&gt; x+y) 0 [1,2,3,4]\n</code></pre>\n\n<p>i get the error:</p>\n\n<pre><code> :: (Integer -&gt; Integer -&gt; Integer) -&gt; Integer -&gt; [Integer] -&gt; t\n</code></pre>\n\n<p>Why isn't the output inferred?Why is it still <code>t</code> in the second example?</p>\n"}, {"tags": ["performance", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 3120835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48c2c7ebc4561f431e104d799f6d4256?s=128&d=identicon&r=PG&f=1", "display_name": "andregps", "link": "https://stackoverflow.com/users/3120835/andregps"}, "edited": false, "score": 0, "creation_date": 1525099978, "post_id": 50094230, "comment_id": 87222950, "body": "Your answer helped me, but i think that i can not use <code>criterion</code> because the function i want to measure is a function that is a sub-sub-routine. The previous functions must be called before the one i want to measure. I can not call the function directelly as <code>fib</code> is called on <code>criterion</code> tutorial."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 331, "user_id": 3120835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48c2c7ebc4561f431e104d799f6d4256?s=128&d=identicon&r=PG&f=1", "display_name": "andregps", "link": "https://stackoverflow.com/users/3120835/andregps"}, "edited": false, "score": 1, "creation_date": 1525108846, "post_id": 50094230, "comment_id": 87227722, "body": "@andregps The criterion library includes facilities for <a href=\"http://hackage.haskell.org/package/criterion-1.4.1.0/docs/Criterion.html#v:env\" rel=\"nofollow noreferrer\">setting up an environment before your function call</a>."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1525064487, "creation_date": 1525064487, "answer_id": 50094230, "question_id": 50092681, "link": "https://stackoverflow.com/questions/50092681/in-haskell-is-it-correct-measuring-performance-using-a-timestamp-obtained-at-th/50094230#50094230", "title": "In Haskell, is it correct measuring performance using a timestamp obtained at the beginning and in the end of a function execution?", "body": "<p>It depends on the function.  Some values have all their information immediately, whereas others can have expensive stuff going on \"beyond the top layer\". Here's a contrived example:</p>\n\n<pre><code>example :: (Int, Int)\nexample = (1+1, head [ x | x &lt;- [1..], x == 10^6 ])\n</code></pre>\n\n<p>If you load this up in ghci, you will see <code>(2,</code> printed, and then after some delay, the remainder of the value <code>1000000)</code> is printed.  If you get a value like this, then the function will \"return\" \"before\" the expensive sub-value has been computed.  But you can use <a href=\"https://hackage.haskell.org/package/deepseq\" rel=\"noreferrer\"><code>deepseq</code></a> to ensure that a value is computed all the way and doesn't have any sub-computations left.</p>\n\n<p>Benchmarking is subtle, and there are a lot of ways to do it wrong (especially in Haskell).  Fortunately we have a very good benchmarking library called <a href=\"https://hackage.haskell.org/package/criterion\" rel=\"noreferrer\"><code>criterion</code></a> \n <em>(<a href=\"http://www.serpentine.com/criterion/tutorial.html\" rel=\"noreferrer\">tutorial</a>)</em> which I definitely recommend you use if you are trying to get reliable results.</p>\n"}], "owner": {"reputation": 331, "user_id": 3120835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/48c2c7ebc4561f431e104d799f6d4256?s=128&d=identicon&r=PG&f=1", "display_name": "andregps", "link": "https://stackoverflow.com/users/3120835/andregps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1527556901, "creation_date": 1525048958, "last_edit_date": 1527556901, "question_id": 50092681, "link": "https://stackoverflow.com/questions/50092681/in-haskell-is-it-correct-measuring-performance-using-a-timestamp-obtained-at-th", "title": "In Haskell, is it correct measuring performance using a timestamp obtained at the beginning and in the end of a function execution?", "body": "<p>I want to measure the performance of a Haskell function. This function is executed concurrently. </p>\n\n<p>Is it correct to measure its performance using timestamps that <code>getCurrentTime</code> function returns? Does lazyness affects the measuring?</p>\n\n<p>I want to save these times on a log. I have looked some logging libraries, but the time they return is not as precise as the timestamp that <code>getCurrentTime</code> returns. I use <a href=\"http://www.xes-standard.org/\" rel=\"nofollow noreferrer\">XES</a> format on my log.</p>\n\n<p>The code i use is something like this: (i did not compile it)</p>\n\n<pre><code>import Data.Time.Clock    \nmeasuredFunction:: Int -&gt; IO (Int,UTCTime,UTCTime)\nmeasuredFunction x = do\n    time' &lt;- getCurrentTime\n    --performs some IO action that returns x'\n    time'' &lt;- getCurrentTime\n    return (x',time',time'')\n\nrunTest :: Int -&gt; Int -&gt; IO ()\nrunTest init end = do\n  when (init &lt;= end) (do \n                        forkIO (do \n                                   (x',time',time'') &lt;- measuredFunction 1\n                                   -- saves time' and time '' in a log \n                                )\n                        runTest (init+1) end  )\n</code></pre>\n"}, {"tags": ["haskell", "authentication", "yesod", "hardcoded"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1525027579, "post_id": 50089894, "comment_id": 87196281, "body": "You&#39;re not using <code>uid</code> anywhere there...? But clearly <code>getAuthEntity</code> requires an argument. Check its type."}, {"owner": {"reputation": 441, "user_id": 7919572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7180a29a1e3cbca63bc706c4c7414a6?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/7919572/marc"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1525028681, "post_id": 50089894, "comment_id": 87196624, "body": "Yes I know, I just haven&#39;t implemented that part yet as I got stuck on this error. So it seems you are right that it needs some argument but I have no idea what. In the documentation its:  <code>getAuthEntity :: (MonadHandler m, HandlerSite m ~ master) =&gt; AuthId master -&gt; m (Maybe (AuthEntity master))</code>  Not sure where I get that AuthId master and there are no examples.."}, {"owner": {"reputation": 441, "user_id": 7919572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7180a29a1e3cbca63bc706c4c7414a6?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/7919572/marc"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1525033353, "post_id": 50089894, "comment_id": 87198008, "body": "@AJFarmar So I figured out that I need to first get the authId with <code>uid &lt;- maybeAuthId</code>. Now intuitively I thought I should be able then to use <code>getAuthEntity</code> by doing <code>user &lt;- fmap getAuthEntity uid</code>.  but then I get the error  <code>Couldn&#39;t match type \u2018Maybe (AuthId App)\u2019 with \u2018HandlerFor App (AuthId (HandlerSite m0))\u2019  Expected type: HandlerFor App (HandlerFor App (AuthId (HandlerSite m0)))</code> on the line <code>uid &lt;- maybeAuthId</code>"}], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 7919572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7180a29a1e3cbca63bc706c4c7414a6?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/7919572/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1525033773, "creation_date": 1525033773, "answer_id": 50090999, "question_id": 50089894, "link": "https://stackoverflow.com/questions/50089894/getauthentity-fails-couldnt-match-expected-type/50090999#50090999", "title": "getAuthEntity fails &#39;Couldn&#39;t match expected type&#39;", "body": "<p>Ok so I managed to resolve it, as noted by the comment you can't just call <code>getAuthEntity</code> but you need the user as well. So I changed the code to the following</p>\n\n<pre><code>getProfileR :: Handler Html\ngetProfileR = do\n    uid &lt;- requireAuthId  \n    user &lt;- getAuthEntity uid \n\n    defaultLayout $ do\n        -- setTitle . toHtml $ userIdent user &lt;&gt; \"'s User page\"\n        setTitle . toHtml $ (\"hola\" :: Text )\n        $(widgetFile \"profile\")\n</code></pre>\n\n<p>and then it worked, however using <code>maybeAuthId</code> instead of <code>requireAuthId</code> will give an error. As to why I am not sure yet.</p>\n"}], "owner": {"reputation": 441, "user_id": 7919572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7180a29a1e3cbca63bc706c4c7414a6?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/7919572/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 50090999, "answer_count": 1, "score": 0, "last_activity_date": 1525033773, "creation_date": 1525026335, "question_id": 50089894, "link": "https://stackoverflow.com/questions/50089894/getauthentity-fails-couldnt-match-expected-type", "title": "getAuthEntity fails &#39;Couldn&#39;t match expected type&#39;", "body": "<p>I'm trying to add hardcoded authentication to Yesod. What I've just briefly modified the Yesod scaffold and added a hardcoded user by following the documentation (<a href=\"http://hackage.haskell.org/package/yesod-auth-1.6.3/docs/Yesod-Auth-Hardcoded.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/yesod-auth-1.6.3/docs/Yesod-Auth-Hardcoded.html</a>). So I have the following code:</p>\n\n<pre><code>instance YesodAuth App where\n    type AuthId App = Either UserId Text\n\n    -- Where to send a user after successful login\n    loginDest :: App -&gt; Route App\n    loginDest _ = HomeR\n    -- Where to send a user after logout\n    logoutDest :: App -&gt; Route App\n    logoutDest _ = HomeR\n    -- Override the above two destinations when a Referer: header is present\n    redirectToReferer :: App -&gt; Bool\n    redirectToReferer _ = True\n\n    authPlugins _ = [authHardcoded]\n\n    authenticate Creds{..} =\n        return\n        (case credsPlugin of\n            \"hardcoded\" -&gt;\n                case lookupUser credsIdent of\n                    Nothing -&gt; UserError InvalidLogin\n                    Just m  -&gt; Authenticated (Right (manUserName m)))\n\n\n-- | Access function to determine if a user is logged in.\nisAuthenticated :: Handler AuthResult\nisAuthenticated = do\n    muid &lt;- maybeAuthId\n    return $ case muid of\n        Nothing -&gt; Unauthorized \"You must login to access this page\"\n        Just _ -&gt; Authorized\n\n\n...        \n\ninstance YesodAuthPersist App where\n    type AuthEntity App = Either User SiteManager\n\n    getAuthEntity (Left uid) =\n      do x &lt;- liftHandler $ runDB (get uid)\n         return (fmap Left x)\n    getAuthEntity (Right username) = return (fmap Right (lookupUser username))\n...\ninstance PathPiece (Either UserId Text) where\n    fromPathPiece = readMaybe . unpack\n    toPathPiece = pack . show\n\nlookupUser :: Text -&gt; Maybe SiteManager\nlookupUser username = find (\\m -&gt; manUserName m == username) siteManagers\n\ninstance YesodAuthHardcoded App where\n    validatePassword u = return . validPassword u\n    doesUserNameExist  = return . isJust . lookupUser\n\nvalidPassword :: Text -&gt; Text -&gt; Bool\nvalidPassword u p =\n    case find (\\m -&gt; manUserName m == u &amp;&amp; manPassWord m == p) siteManagers of\n        Just _ -&gt; True\n        _      -&gt; False\n</code></pre>\n\n<p>So it seems that getAuthEntity has been properly implemented. Now however when I try to fetch the user with getAuthEntity like so:</p>\n\n<pre><code>getProfileR :: Handler Html\ngetProfileR = do\n    uid &lt;- getAuthEntity   \n    defaultLayout $ do\n        setTitle . toHtml $ (\"hola\" :: Text )\n        $(widgetFile \"profile\")\n</code></pre>\n\n<p>It simply fails with the error:</p>\n\n<pre><code>    \u2022 Couldn't match expected type \u2018HandlerFor App a0\u2019\n                  with actual type \u2018AuthId (HandlerSite m0)\n                                    -&gt; m0 (Maybe (AuthEntity (HandlerSite m0)))\u2019\n   |\n12 |     uid &lt;- getAuthEntity\n   |            ^^^^^^^^^^^^^\n</code></pre>\n\n<p>I'm completely lost as to what could be wrong. Thanks in advance for any help.</p>\n"}, {"tags": ["haskell", "erlang", "pattern-matching", "elixir"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 6, "creation_date": 1525018364, "post_id": 50088547, "comment_id": 87193279, "body": "In brief: it is a corner case of pattern matching, which presumably wasn&#39;t considered problematic enough to be ruled out. Feel free to ask for further clarification if the answers to the suggested question still leave you with lingering questions about it."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 2, "creation_date": 1525080694, "post_id": 50088547, "comment_id": 87211663, "body": "It\u2019s because of lazy evaluation. A pattern match like that is not checked until you use one of the variables in the pattern."}], "owner": {"reputation": 71, "user_id": 9259258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12f70669c83a253e559582db53bb786c?s=128&d=identicon&r=PG&f=1", "display_name": "CIrvine", "link": "https://stackoverflow.com/users/9259258/cirvine"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 2, "closed_date": 1525018232, "answer_count": 0, "score": 6, "last_activity_date": 1525018839, "creation_date": 1525017365, "last_edit_date": 1525017622, "question_id": 50088547, "link": "https://stackoverflow.com/questions/50088547/why-doesnt-haskell-report-a-mismatch-with-1-2", "closed_reason": "Duplicate", "title": "Why doesn&#39;t Haskell report a mismatch with 1 = 2?", "body": "<p>I'm confused by Haskell's pattern matching behavior. If I match 1 against 2 in either Erlang or Elixir, I expect and get a match error message. In Haskell, ghci just silently accepts the match attempt. </p>\n\n<p>With Erlang in erl:</p>\n\n<pre><code>2&gt; 1 = 2.\n** exception error: no match of right hand side value 2\n</code></pre>\n\n<p>With Elixir in iex:</p>\n\n<pre><code>iex(1)&gt; 1 = 2\n** (MatchError) no match of right hand side value: 2\n</code></pre>\n\n<p>However, with Haskell in ghci:</p>\n\n<pre><code>Prelude&gt; 1 = 2\nPrelude&gt; \n</code></pre>\n\n<p>Can someone explain why Haskell doesn't report a match error?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 1, "creation_date": 1525006755, "post_id": 50086798, "comment_id": 87189322, "body": "could it be &#39;s&#39; for strictness ?"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 7, "last_activity_date": 1525016318, "last_edit_date": 1525016318, "creation_date": 1525013299, "answer_id": 50087838, "question_id": 50086798, "link": "https://stackoverflow.com/questions/50086798/what-does-s-mean-in-the-sprint-ghci-command/50087838#50087838", "title": "What does &quot;s&quot; mean in the &quot;sprint&quot; GHCi command?", "body": "<p>As you have seen, the description of <code>:sprint</code> in the GHC User's Guide says nothing on the matter. According to the <a href=\"https://typeclasses.com/ghci/sprint\" rel=\"noreferrer\"><code>:sprint</code> entry</a> in Julie Moronuki and Chris Martin's typeclasses.com...</p>\n\n<blockquote>\n  <p>The <code>s</code> stands for \u201csimple,\u201d the idea being that <code>:sprint</code> is in some sense a simplified version of the <code>:print</code> command, since <code>:sprint</code> does less work.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>could it be 's' for strictness ?</p>\n</blockquote>\n\n<p>Presumably not, as much of the point of <code>:sprint</code> and <code>:print</code> is that they are, in a sense, <a href=\"https://stackoverflow.com/questions/35198306/why-sprint-always-prints-a\">lazier than the <code>print</code> function</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7404, "user_id": 491497, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e4aab95d9512cd6cd431b60fe00d974c?s=128&d=identicon&r=PG", "display_name": "Sagi", "link": "https://stackoverflow.com/users/491497/sagi"}, "is_accepted": false, "score": 0, "last_activity_date": 1527888001, "last_edit_date": 1592644375, "creation_date": 1527888001, "answer_id": 50651114, "question_id": 50086798, "link": "https://stackoverflow.com/questions/50086798/what-does-s-mean-in-the-sprint-ghci-command/50651114#50651114", "title": "What does &quot;s&quot; mean in the &quot;sprint&quot; GHCi command?", "body": "<ol>\n<li><p>type <code>ghci</code><br/></p>\n</li>\n<li><p>type <code>:?</code><br/></p>\n</li>\n<li><p>You will get: <code>Commands available from the prompt:</code><br/></p>\n</li>\n<li><p>Look for the <code>sprintf:</code> documentation<br/></p>\n<p><code>:sprint [&lt;name&gt; ...]        simplified version of :print</code></p>\n</li>\n</ol>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 1, "accepted_answer_id": 50087838, "answer_count": 2, "score": 4, "last_activity_date": 1527888001, "creation_date": 1525006592, "last_edit_date": 1525014747, "question_id": 50086798, "link": "https://stackoverflow.com/questions/50086798/what-does-s-mean-in-the-sprint-ghci-command", "title": "What does &quot;s&quot; mean in the &quot;sprint&quot; GHCi command?", "body": "<p>What does \"s\" mean in the name of the <code>:sprint</code> GHCi command?\nThis is <a href=\"http://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-cmd-:sprint\" rel=\"nofollow noreferrer\">the description from the official documentation</a>, to give you some context: </p>\n\n<blockquote>\n  <p>sprint :  Prints a value without forcing its evaluation. :sprint is similar to :print, with the difference that unevaluated subterms are not bound to new variables, they are simply denoted by \u2018_\u2019.</p>\n</blockquote>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1525001161, "post_id": 50086032, "comment_id": 87187681, "body": "Well right now you only showed some examples and a signature. What have you tried?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1525001935, "post_id": 50086032, "comment_id": 87187874, "body": "This is not a question, but a &quot;write code for me&quot; request."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525003492, "post_id": 50086032, "comment_id": 87188351, "body": "Hint: does a list with one element has a second smallest element?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525003557, "post_id": 50086032, "comment_id": 87188371, "body": "What you here basically have written is something that looks like a <code>minimum</code>..."}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525004124, "post_id": 50086032, "comment_id": 87188524, "body": "@WillemVanOnsem I thought I could modify that into a second smallest function, but haven&#39;t succeeded. That&#39;s why I didn&#39;t put the code in the question at first, because it&#39;s basically <code>minimum</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1525057074, "post_id": 50086795, "comment_id": 87202877, "body": "I think it&#39;s actually O(n log k), which is fine for k=2."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1525073165, "post_id": 50086795, "comment_id": 87207721, "body": "@dfeuer: that&#39;s what I meant with <i>fixed</i> <code>k</code>. If you take that as a precondition, then it is linear. If it is a variable, then it is indeed as far as I know <i>O(n log k)</i>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 10, "last_activity_date": 1525087713, "last_edit_date": 1525087713, "creation_date": 1525006568, "answer_id": 50086795, "question_id": 50086032, "link": "https://stackoverflow.com/questions/50086032/haskell-second-smallest-value-in-list/50086795#50086795", "title": "Haskell second smallest value in list", "body": "<h1>Using <code>sort</code></h1>\n\n<p>A lazy approach is by using <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-List.html#v:sort\" rel=\"noreferrer\"><strong><code>sort :: Ord a =&gt; [a] -&gt; [a]</code></strong></a>. <code>sort</code> returns a sorted list, but in a lazy manner, and obtaining the <em>k</em>-th element, with <em>O(n)</em> for a fixed element, and in case we enumerate up to the <em>k</em>-th element, it will take <em>O(n log k)</em>, we can thus perform pattern matching on the <code>sort</code> result, and then return the second element, like:</p>\n\n<pre><code>import Data.List(sort)\n\nsecondSmallest :: Ord a =&gt; [a] -&gt; Maybe a\nsecondSmallest l | (_:x:_) &lt;- sort l = Just x\n                 | otherwise = Nothing\n</code></pre>\n\n<h1>By using an accumulator</h1>\n\n<p>Another approach is by using an <em>accumulator</em>. An accumulator is a parameter in the recursion that we (optionally) update and then pass an updated version. In this case we can use a 2-tuple that contains the smallest, and one-but-smallest element. So now we implement another function</p>\n\n<pre><code>secondSmallest' :: Ord a =&gt; (a, a) -&gt; [a] -&gt; a\nsecondSmallest' (s1, s2) ...\n</code></pre>\n\n<p>where <code>s1 &lt;= s2</code> always holds. Now there are some cases we need to consider:</p>\n\n<ol>\n<li><p>the list is empty, in that case we reached the end of the list, and thus can return <code>s2</code>, the thus far obtained second minimum</p>\n\n<pre><code>secondSmallest' (_, s2) [] = s2\n</code></pre></li>\n<li><p>the list is not empty, and the head <code>x</code> is greater than or equal to <code>s2</code>, in that case the thus far two smallest elements remain the same, so we can pass the 2-tuple unchanged and we recurse on the tail of the list.</p>\n\n<pre><code>secondSmallest' s@(s1, s2) (x:xs) | x &gt;= s2 = secondSmallest' s xs\n</code></pre></li>\n<li><p>in case the head <code>x</code> is greater than or equal to <code>s1</code>, but less than <code>s2</code>, then we know that this is the <em>newest</em> second smallest, so in that case we construct a new 2-tuple with <code>(s1, x)</code> and recurse on the tail of the list</p>\n\n<pre><code>                                  | x &gt;= s1 = secondSmallest' (s1, x) xs\n</code></pre></li>\n<li><p>in case the head <code>x</code> is less than <code>s1</code>, then we obtained a new <em>smallest</em> element. In that case <code>s1</code> is the newest smallest element:</p>\n\n<pre><code>                                  | otherwise = secondSmallest' (x, s1) xs\n</code></pre></li>\n</ol>\n\n<p>So now we implemented a function that - given we already have two <em>thus</em> far smallest elements - can return the second smallest element:</p>\n\n<pre><code>secondSmallest' :: Ord a =&gt; (a, a) -&gt; [a] -&gt; a\nsecondSmallest' (_, s2) [] = s2\nsecondSmallest' s@(s1, s2) (x:xs) | x &gt;= s2 = secondSmallest' s xs\n                                  | x &gt;= s1 = secondSmallest' (s1, x) xs\n                                  | otherwise = secondSmallest' (x, s1) xs\n</code></pre>\n\n<p>But now we still have not solved the main problem, how do we obtain the first 2-smallest elements. Basically there are three cases here:</p>\n\n<ol>\n<li><p>in case the list contains at least two elements, and the first element is less than or equal to the second element, we take the first element as the smallest and the second as the second smallest element, and perform a call on the rest of the list and we wrap the result in a <code>Just</code> constructor:</p>\n\n<pre><code>secondSmallest (x1:x2:xs) | x1 &lt;= x2 = Just (secondSmallest' (x1, x2) xs)\n</code></pre></li>\n<li><p>in case the list contains at least two elements but the first element is greater than the second, then we take the first element as the second smallest, and the second element as the smallest, we again perform a call to the <code>secondSmallest'</code> function, and wrap the result in a <code>Just</code> constructor:</p>\n\n<pre><code>                          | otherwise = Just (secondSmallest' (x2, x1) xs)\n</code></pre></li>\n<li><p>in case the list contains less items, we can not calculate the second smallest, since there is no second smallest, so we return <code>Nothing</code>:</p>\n\n<pre><code>secondSmallest _ = Nothing\n</code></pre></li>\n</ol>\n\n<p>so in full we get:</p>\n\n<pre><code>secondSmallest :: Ord a =&gt; [a] -&gt; Maybe a\nsecondSmallest (x1:x2:xs) | x1 &lt;= x2 = Just (secondSmallest' (x1, x2) xs)\n                          | otherwise = Just (secondSmallest' (x2, x1) xs)\nsecondSmallest _ = Nothing\n\nsecondSmallest' :: Ord a =&gt; (a, a) -&gt; [a] -&gt; a\nsecondSmallest' (_, s2) [] = s2\nsecondSmallest' s@(s1, s2) (x:xs) | x &gt;= s2 = secondSmallest' s xs\n                                  | x &gt;= s1 = secondSmallest' (s1, x) xs\n                                  | otherwise = secondSmallest' (x, s1) xs\n</code></pre>\n\n<p>Note that <code>secondSmallest'</code> is in fact a <code>fold</code> pattern, so we can write it like:</p>\n\n<pre><code>secondSmallest :: Ord a =&gt; [a] -&gt; Maybe a\nsecondSmallest (x1:x2:xs) | x1 &lt;= x2 = Just (secondSmallest' (x1, x2) xs)\n                          | otherwise = Just (secondSmallest' (x2, x1) xs)\nsecondSmallest _ = Nothing\n\nsecondSmallest' :: Ord a =&gt; (a, a) -&gt; [a] -&gt; [a]\nsecondSmallest' t = snd . foldr f t\n    where f s@(s1, s2) x | x &gt;= s2 = s\n                         | x &gt;= s1 = (s1, x)\n                         | otherwise = (x, s1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1525073667, "post_id": 50092117, "comment_id": 87207986, "body": "Alternative: the accumulator is <code>(Maybe a, Maybe a)</code>, initialized to <code>(Nothing, Nothing)</code>.  Your <code>None</code> case is <code>(Nothing, Nothing)</code> and your <code>One</code> case is <code>(Just x, Nothing)</code>.  At the finish, return <code>snd acc</code>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1525104758, "post_id": 50092117, "comment_id": 87225842, "body": "It would let us eliminate the <code>Acc a</code> type and <code>finish</code>, and write the whole thing in fewer lines of code. Better is a matter of personal taste."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1525111727, "post_id": 50092117, "comment_id": 87229042, "body": "Wrote it up into another solution. People can decide for themselves which one they like, but I think the examples of different approaches are instructive."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1525048085, "last_edit_date": 1525048085, "creation_date": 1525043054, "answer_id": 50092117, "question_id": 50086032, "link": "https://stackoverflow.com/questions/50086032/haskell-second-smallest-value-in-list/50092117#50092117", "title": "Haskell second smallest value in list", "body": "<p>One option is to use a fold. Let's start by writing a type for the accumulator:</p>\n\n<pre><code>import Data.List (foldl')\n\ndata Acc a = None\n           | One a\n           | Two {sml :: a, sndsml :: a}\n\nfinish :: Acc a -&gt; Maybe a\nfinish Two{sndsml = r} = Just r\nfinish _ = Nothing\n</code></pre>\n\n<p>Now,</p>\n\n<pre><code>secondSmallest\n  :: Ord a =&gt; [a] -&gt; Maybe a\nsecondSmallest = finish . foldl' go None\n  where\n    go None a = One a\n    go (One b) a\n      | b &lt; a = Two{sml=b, sndsml=a}\n      | otherwise = Two{sml=b, sndsml=a}\n    go r@Two{sml=b, sndsml=c} a\n      | a &lt; b = Two{sml=a,sndsml=b}\n      | a &lt; c = Two{sml=b,sndsml=a}\n      | otherwise = r\n\n-- For extra efficiency in some cases\n{-# INLINABLE secondSmallest #-}\n</code></pre>\n\n<p>GHC is clever enough to compile this definition into something just like Willem Van Onsem's solution. However, when passed a \"good producer\" for list fusion (e.g., <code>secondSmallest (map (\\x -&gt; x * (x - 50)) xs)</code>), the fold-based version will generally be more efficient.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1525430962, "last_edit_date": 1525430962, "creation_date": 1525050140, "answer_id": 50092778, "question_id": 50086032, "link": "https://stackoverflow.com/questions/50086032/haskell-second-smallest-value-in-list/50092778#50092778", "title": "Haskell second smallest value in list", "body": "<p><a href=\"https://stackoverflow.com/users/1477667/dfeuer\">dfeuer</a>'s <a href=\"https://stackoverflow.com/a/50092117/849891\">answer</a> gave me an idea,</p>\n\n<pre><code>import Data.List (foldl', sort)\nimport Data.Maybe (listToMaybe)\n\nsecondSmallest :: Ord a =&gt; [a] -&gt; Maybe a\nsecondSmallest = listToMaybe . take 1 . drop 1 . foldl' g [] \n    where \n    g acc x = f acc `seq` take 2 (sort (x:acc))\n    f [a,b] = a &lt; b\n    f _     = True\n</code></pre>\n\n<p>The code is short, but <em>probably</em> a tad less efficient, because of all the list functions.</p>\n\n<p><em>edit:</em> forced the accumulator.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525113067, "post_id": 50104568, "comment_id": 87229672, "body": "it&#39;s not that you don&#39;t have a helper type and an extractor; they are just inlined. same for my code. the looser the type, the shorter the code. :)"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525114675, "post_id": 50104568, "comment_id": 87230377, "body": "@WillNess Indeed. Again, not making any claim that this solution is \u201cbetter,\u201d but I am spelling out its advantages and disadvantages."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525115038, "post_id": 50104568, "comment_id": 87230545, "body": "@WillNess I guess I\u2019m a perfectionist. The top answer (currently Willem Van Onsem\u2019s) is great, by the way. I upvoted it."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1525114703, "last_edit_date": 1525114703, "creation_date": 1525105701, "answer_id": 50104568, "question_id": 50086032, "link": "https://stackoverflow.com/questions/50086032/haskell-second-smallest-value-in-list/50104568#50104568", "title": "Haskell second smallest value in list", "body": "<p>Here\u2019s a different solution using a fold, with a tuple <code>{Maybe a, Maybe a)</code> as the accumulator.  The algorithm is similar to dfeuer\u2019s excellent answer.  It does not require a helper type, and the function to extract the solution is already in the <code>Prelude</code>. One disadvantage is that it does have an extra pattern match: there is an impossible state <code>(Nothing, Just _)</code> where the second-smallest element has been set but not the smallest, and we check for it in order for our patterns to be exhaustive, whereas dfeuer\u2019s <code>Acc a</code> type only encoded valid program states.  This fall-through case won\u2019t slow the program down at runtime, because it will never be reached. It\u2019s possible that the compiler will be able to unbox the accumulator argument and get something slightly more efficient.</p>\n\n<p><strong>ETA:</strong> Willem Van Onsem gave a similar solution at the end of his answer.  It differs in calling the fold if and only if the list has at least two elements, which means there is only one pattern the fold function needs to match. That\u2019s more efficient in most cases because the overhead of setting up the initial value of the accumulator only has to be done once, but the overhead of pattern-matching in the fold function has to be done once per element.  It also does not need <code>Maybe</code> inside the fold.  I\u2019ll leave this one up in the hope that seeing several different approaches is helpful.</p>\n\n<pre><code>import Data.List (foldl')\n\nsecondSmallest :: Ord a =&gt; [a] -&gt; Maybe a\nsecondSmallest = snd . foldl' go (Nothing, Nothing) where\n{- The accumulator of go is a pair whose first element is the smallest\n - element encountered so far and whose second element is the second-\n - smallest encountered so far.\n -}\n  go (Nothing, Nothing) x = (Just x, Nothing)\n  go (Just x, Nothing) y | y &lt; x     = (Just y, Just x)\n                         | otherwise = (Just x, Just y)\n  go (Just x, Just y) z | z &lt; x     = (Just z, Just x)\n                        | z &lt; y     = (Just x, Just z)\n                        | otherwise = (Just x, Just y)\n  go _ _ = error \"Logic error: found second-smallest but not smallest element.\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525178342, "post_id": 50105513, "comment_id": 87250389, "body": "A potential problem with this approach is that if the two smallest elements are equal, then you will ignore the second one, and thus retur a larger element. Perhaps it is better to add this as a precondition in your answer."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525191984, "post_id": 50105513, "comment_id": 87257707, "body": "But with <code>ls = [6,5,4,3,2,1,1,2,3,4,5,6]</code> it still produces <code>2</code>. <code>minf</code> does not count. I am confused. <code>minf</code> produces one number. The first smallest number is identical to itself but <code>minf</code> only produces one. ???  `"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1525193911, "post_id": 50105513, "comment_id": 87258690, "body": "that is because there are two <code>1</code>s in the list. As you can see in the question, if the list contains two such minimum values, the result is that minimum value."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1525202143, "post_id": 50105513, "comment_id": 87262829, "body": "I does not jibe with &quot;second smallest&quot; You asked &quot;does a list of one element have a second smallest?&quot; It does not have a second anything. Ones in [1,1,1] are all equally small, there is no smaller or larger. Equality cannot be at the same time less than or greater than. But, may well be a requirement. TY!"}], "tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1525178265, "last_edit_date": 1525178265, "creation_date": 1525109811, "answer_id": 50105513, "question_id": 50086032, "link": "https://stackoverflow.com/questions/50086032/haskell-second-smallest-value-in-list/50105513#50105513", "title": "Haskell second smallest value in list", "body": "<p>I only have a working non-solution. It depends on an minimum function I wrote a while ago. My minimum takes one parameter, a list. Your function seems to be looking for a minimum so here is mine. It would have to placed in a wrapper to meet all your requirements. It fails on <code>[]</code> and returns <code>x</code> given <code>[x]</code> so would again fail.</p>\n\n<pre><code>minf :: (Num b, Ord b) =&gt; [b] -&gt; b\nminf [x]    = x\nminf (x:xs) = if x &lt; head xs then minf $ x : tail xs else minf xs\n</code></pre>\n\n<p>How it is used is like such to produce the second smallest element. It finds the first smallest then excludes it from the list searched after it is found.</p>\n\n<pre><code>ls = [5,3,7,2,3,1]\nminf [sd | ft &lt;- [minf ls], sd &lt;- ls,sd /= ft]\n</code></pre>\n\n<p>2</p>\n"}], "owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 0, "accepted_answer_id": 50086795, "answer_count": 5, "score": 3, "last_activity_date": 1525430962, "creation_date": 1525001097, "last_edit_date": 1525003703, "question_id": 50086032, "link": "https://stackoverflow.com/questions/50086032/haskell-second-smallest-value-in-list", "title": "Haskell second smallest value in list", "body": "<p>I'm trying to write a function <code>secondSmallest</code> that returns the second smallest value in the list, or Nothing if there is no such value. Also, if the smallest value of the list occurs multiple times, it's also the second smallest. For example:</p>\n\n<ul>\n<li><code>secondSmallest [1.0]</code> -->  <code>Nothing</code></li>\n<li><code>secondSmallest [1,1,2]</code> -->  <code>Just 1</code></li>\n<li><code>secondSmallest [5,3,7,2,3,1]</code>  -->  <code>Just 2</code></li>\n</ul>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>secondSmallest :: Ord a =&gt; [a] -&gt; Maybe a\nsecondSmallest []       = Nothing\nsecondSmallest [x]      = Nothing\nsecondSmallest (x:y:xs) = Just secondSmallest ((if x &lt; y then x else y):xs)\n</code></pre>\n"}, {"tags": ["haskell", "filepath"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524992565, "post_id": 50084761, "comment_id": 87185555, "body": "Have you looked at <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/System-IO.html#t:FilePath\" rel=\"nofollow noreferrer\"><code>System.IO</code></a>?"}, {"owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1525001368, "post_id": 50084761, "comment_id": 87187732, "body": "Nothing I can see there looks like it solves the problem"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 1, "creation_date": 1525003005, "post_id": 50084761, "comment_id": 87188212, "body": "Then <a href=\"http://hackage.haskell.org/package/filepath-1.4.1.2/docs/System-FilePath-Posix.html#v:normalise\" rel=\"nofollow noreferrer\"><code>System.FilePath.Posix</code></a> and <a href=\"http://hackage.haskell.org/package/directory-1.3.2.2/docs/System-Directory.html\" rel=\"nofollow noreferrer\"><code>System.Directory</code></a> have all you need"}], "answers": [{"tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 3, "last_activity_date": 1525003603, "creation_date": 1525003603, "answer_id": 50086389, "question_id": 50084761, "link": "https://stackoverflow.com/questions/50084761/haskell-how-calculate-absolute-path-from-an-absolute-path-and-a-relative-path-p/50086389#50086389", "title": "Haskell: how calculate absolute path from an absolute path and a relative path pair", "body": "<p>First, you can combine paths with <a href=\"http://hackage.haskell.org/package/filepath-1.4.1.2/docs/System-FilePath-Posix.html#v:-60--47--62-\" rel=\"nofollow noreferrer\">(&lt;/>)</a>:</p>\n\n<pre><code>abs &lt;/&gt; rel\n</code></pre>\n\n<p>then use <code>canonicalizePath</code> to remove any indirection.</p>\n\n<pre><code>canonicalizePath (abs &lt;/&gt; rel) &gt;&gt;= \\abs -&gt; ...\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 50086389, "answer_count": 1, "score": 0, "last_activity_date": 1525003603, "creation_date": 1524990967, "question_id": 50084761, "link": "https://stackoverflow.com/questions/50084761/haskell-how-calculate-absolute-path-from-an-absolute-path-and-a-relative-path-p", "title": "Haskell: how calculate absolute path from an absolute path and a relative path pair", "body": "<p>I need to achieve the same as the following C# code in Haskell:</p>\n\n<pre><code>string abs = \"X:/A/B/Q\";\nstring rel = \"../../B/W\";\nvar path = Path.GetFullPath(Path.Combine(abs,rel));\n\n=&gt; \"X:/A/B/W\"\n</code></pre>\n\n<p>ref: <a href=\"https://stackoverflow.com/questions/18443877/combine-an-absolute-path-with-a-relative-path\">Combine an absolute path with a relative path</a></p>\n\n<p>Is there any standard package out there that can do this?</p>\n\n<p>Hoogling found me makeAbsolute and canonicalizePath but they both use the current directory as the base not a provided file path.</p>\n\n<p>I am guessing any Haskell version would need to return something like IO (Either String FilePath)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1524990618, "post_id": 50084680, "comment_id": 87185146, "body": "&quot;<i>What I would like to return is a matrix</i>&quot; - then why is your return type a plain list of numbers?"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524990912, "post_id": 50084680, "comment_id": 87185200, "body": "I&#39;m not sure why the problem i&#39;m trying to solve refers to it as a matrix honestly, I also think it&#39;s just a list but possibly he&#39;s expecting me to flatten a matrix into a list? whatever achieves the example is good for me, i&#39;ll update with the textbook problem."}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524992792, "post_id": 50084680, "comment_id": 87185609, "body": "added an example"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524994811, "post_id": 50084680, "comment_id": 87186140, "body": "How exactly do you want to traverse your matrix? It is a bit weird that you input a 3x2 matrix, but the result is a list of 4 elements."}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524995010, "post_id": 50084680, "comment_id": 87186184, "body": "As I explained, for the 2 columns, first you are on element (0,0) so you compare column 0 with column 0, then (0,1) column 0 with column 1, so on with (1,0) and (1,1). picture i added in the end + example  should kinda explain"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524997186, "post_id": 50084680, "comment_id": 87186703, "body": "Added an attempt code i made, if fixed i believe would work"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524997300, "post_id": 50084680, "comment_id": 87186726, "body": "<code>differeneRatings x!!i x!!j</code> parses as <code>((differeneRatings x) !! (i x)) !! j</code>. Spacing doesn&#39;t affect precedence. Also, <code>differeneRatings</code> is undeclared."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524997365, "post_id": 50084680, "comment_id": 87186745, "body": "@OmarHussein: but then what is the third row doing here?"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524997744, "post_id": 50084680, "comment_id": 87186824, "body": "the differenceRatings in the question was declared as differeneRatings in my file but it&#39;s the same, added brackets and now this is the error im getting, post updated with new code"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524997748, "post_id": 50084680, "comment_id": 87186825, "body": "ERROR file:.\\lmaogetrektson.hs:75 - Type error in application *** Expression     : xs i j *** Term           : xs *** Type           : [[Rating [d]]] *** Does not match : a -&gt; b -&gt; c"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524997834, "post_id": 50084680, "comment_id": 87186838, "body": "<code>dMatrixH x:xs i j</code> parses as <code>(dMatrixH x) : (xs i j)</code>. Same problem."}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524998108, "post_id": 50084680, "comment_id": 87186899, "body": "@melpomene I have (x:xs) in paranthesis, what do you mean I should do?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524998369, "post_id": 50084680, "comment_id": 87186966, "body": "Can you please first explain how you obtain the list of values. What elements are you comparing in what way in the result?"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524998624, "post_id": 50084680, "comment_id": 87187022, "body": "The elements I am comparing are of type Rating which I show in the beginning of the question, the list is input into winhuggs as shown in the example and the function I use to compare is shown in the question..."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1525000452, "post_id": 50084680, "comment_id": 87187490, "body": "Winhugs? Do you know that there hasn&#39;t been a new release of hugs in 12 years?"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1525001885, "post_id": 50084680, "comment_id": 87187859, "body": "it&#39;s what we use at uni i&#39;m sorry it&#39;s outdated lol, don&#39;t see why that should be a reason to have any problem, right?"}], "answers": [{"tags": [], "owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "is_accepted": true, "score": 0, "last_activity_date": 1525079818, "creation_date": 1525079818, "answer_id": 50097451, "question_id": 50084680, "link": "https://stackoverflow.com/questions/50084680/haskell-form-a-matrix-based-on-a-list-matrix/50097451#50097451", "title": "Haskell - Form a matrix based on a list Matrix", "body": "<p>Managed to do it using 2 of my helper functions, posting them first</p>\n\n<pre><code>matrixPairs :: Num a =&gt; a -&gt; [(a,a)]\nmatrixPairs 0 = []\nmatrixPairs c = matrixPairsH 0 0 (c-1)\nmatrixPairsH a b c = [(a,b)] ++ if ((b == c) &amp;&amp; (a == c)) then [] else if (b == c) then (if (a==c) then [] else matrixPairsH (a+1) 0 c ) else matrixPairsH a (b+1) c\n</code></pre>\n\n<p>and</p>\n\n<pre><code>differeneRatings :: Fractional a =&gt; Rating a -&gt; Rating a -&gt; a\ndiffereneRatings NoRating (R a) = 0\ndiffereneRatings (R a) NoRating = 0\ndiffereneRatings NoRating NoRating = 0\ndiffereneRatings  (R a) (R b) = a - b\n</code></pre>\n\n<p>and here's the code for the required function</p>\n\n<pre><code>dMatrix :: Fractional a =&gt; [[Rating a]] -&gt; [a]\ndMatrix [] = []\ndMatrix (x:xs) = dMatrixH (x:xs) (matrixPairs (length x))\ndMatrixH _ [] = []\ndMatrixH x ((a,b):ys) = [(dMatrixH2 x a b)] ++ dMatrixH x ys\ndMatrixH2 [] _ _ = 0\ndMatrixH2 (x:xs) a b = (differeneRatings (x!!a) (x!!b)) + dMatrixH2 xs a b\n</code></pre>\n"}], "owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 50097451, "answer_count": 1, "score": -1, "last_activity_date": 1525079818, "creation_date": 1524990252, "last_edit_date": 1525000112, "question_id": 50084680, "link": "https://stackoverflow.com/questions/50084680/haskell-form-a-matrix-based-on-a-list-matrix", "title": "Haskell - Form a matrix based on a list Matrix", "body": "<p>I would to make a haskell function that takes a list of Item Ratings(a data type I declared), looking like this:</p>\n\n<pre><code>[[NoRating,R 5.0],[R 5.0,R 4.0],[R 3.0,R 1.0]]\n</code></pre>\n\n<p>the declaration of Rating looks like this:</p>\n\n<pre><code>data Rating c = NoRating | R c deriving (Show, Eq)\n</code></pre>\n\n<p>in the list each sublist represents ratings belonging to a user, each sublist contains multiple items, in the previous example 2 items were in the sublist,</p>\n\n<p>What I would like to return is a list of item rating differences from a matrix like input, The value at row i and column j represents the sum of the differences between the ratings given to item i and item j by the same user</p>\n\n<p>for example, for the input </p>\n\n<pre><code>dMatrix [[NoRating,R 5.0],[R 5.0,R 4.0],[R 3.0,R 1.0]]\n</code></pre>\n\n<p>I would like to return</p>\n\n<pre><code>[0.0,3.0,-3.0,0.0]\n</code></pre>\n\n<p>I have already implemented a difference function that takes 2 ratings and returns the difference, it looks like this, would be nice to use it through</p>\n\n<pre><code>differenceRatings :: Fractional a =&gt; Rating a -&gt; Rating a -&gt; a\ndifferenceRatings NoRating (R a) = 0\ndifferenceRatings (R a) NoRating = 0\ndifferenceRatings  (R a) (R b) = a - b\n</code></pre>\n\n<p>I'm having a hard time implementing this because the only way I know to loop in haskell is recursion but in this instance I need to do in a specific matrix order and access multiple sublist items of same index at same time, thanks for your help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jPmpp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jPmpp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Picture as like example, first we do column 0 with column 0, difference is 0,\nthen we do column 0 with column 1, rating of item 0 for user 1 - item 2 for user 1, and so on for user 2 and 3 then sum them, put that in the second index of result list\nthen we do column 1 with column 0, negative of what is before generally\nlastly column 1 with column 1, difference is 0</p>\n\n<p>I have drafted this code and tried it but am getting a type error</p>\n\n<pre><code>dMatrix :: Fractional a =&gt; [[Rating a]] -&gt; [a]\ndMatrix [] = []\ndMatrix x = dMatrixH1 x 0 0\ndMatrixH1 (x:xs) i j = (dMatrixH x:xs i j) ++ (if (j &lt; ((length (x:xs))-1)) \nthen dMatrixH (x:xs) i (j+1) else if (i &lt; ((length xs)-1)) then dMatrixH \n(x:xs) (i+1) 0 else 0)\ndMatrixH [] _ _ = 0\ndMatrixH (x:xs) i j = (differeneRatings (x!!i) (x!!j)) + dMatrixH xs i j\n</code></pre>\n"}, {"tags": ["list", "haskell", "recursion"], "comments": [{"owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "edited": false, "score": 0, "creation_date": 1524978205, "post_id": 50083476, "comment_id": 87182828, "body": "Isn&#39;t this recursive?"}, {"owner": {"reputation": 35, "user_id": 9716319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c80203985edccb731b47e72130ead9?s=128&d=identicon&r=PG&f=1", "display_name": "radiosonic", "link": "https://stackoverflow.com/users/9716319/radiosonic"}, "reply_to_user": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "edited": false, "score": 0, "creation_date": 1524978727, "post_id": 50083476, "comment_id": 87182911, "body": "yes indeed fixed it"}], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 2, "last_activity_date": 1524978644, "last_edit_date": 1524978644, "creation_date": 1524978340, "answer_id": 50083568, "question_id": 50083476, "link": "https://stackoverflow.com/questions/50083476/haskell-beginner-recursive-function-list-error-non-exhaustive-patterns/50083568#50083568", "title": "Haskell Beginner, recursive function, list, Error: Non-exhaustive patterns", "body": "<p>The problem is that your pattern matches only a list with one element.</p>\n\n<p>For example, if you try to define a function in <code>ghci</code>:</p>\n\n<pre><code>a [x] = x\n</code></pre>\n\n<p>And then try to call it with the lists with a different number of elements:</p>\n\n<p><code>a [1]</code> results with <code>1</code></p>\n\n<p><code>a []</code> results with <code>Exception: &lt;interactive&gt;:5:1-13: Non-exhaustive patterns in function a</code></p>\n\n<p><code>a [1,2]</code> results with <code>Exception: &lt;interactive&gt;:1:1-9: Non-exhaustive patterns in function a</code></p>\n\n<p>The following modification makes your function work:</p>\n\n<pre><code>sumList :: [Int] -&gt; Int\nsumList list | length list &gt; 0  = list!!0 + sumList (drop 1 list)\n             | otherwise = 0\n</code></pre>\n\n<p>But, certainly, the following definition would be more idiomatic and performant:</p>\n\n<pre><code>sumList :: [Int] -&gt; Int\nsumList [] = 0\nsumList (x:xs) = x + sumList xs\n</code></pre>\n\n<p>By <code>(x:xs)</code> pattern you immediately receive <code>x</code> as a head of your list (<code>list!!0</code>) and <code>xs</code> as a tail of it (<code>drop 1 list</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "is_accepted": false, "score": 1, "last_activity_date": 1524979272, "last_edit_date": 1524979272, "creation_date": 1524978443, "answer_id": 50083573, "question_id": 50083476, "link": "https://stackoverflow.com/questions/50083476/haskell-beginner-recursive-function-list-error-non-exhaustive-patterns/50083573#50083573", "title": "Haskell Beginner, recursive function, list, Error: Non-exhaustive patterns", "body": "<p>The function will not work for an empty list, or any list with more than one item.</p>\n\n<p>Your problem is that you are matching against <code>[list]</code>, a list with one member which is <code>list</code>. Instead, try matching against just <code>list</code>. This means it will match anything of type <code>[Int]</code> from your type signature.</p>\n\n<p>I get your confusion, as the type <code>[a]</code> is for lists of any length, but <code>[a]</code> will only match a list of one element.</p>\n\n<p>I have also attached another way of writing your function using pattern matching, which hopefully you will find useful.</p>\n\n<pre><code>sumList :: [Int] -&gt; Int\nsumList [] = 0\nsumList (x:xs) = x + sumList xs\n</code></pre>\n\n<p>It is unusual to use guards, but you did, your code would look like this:</p>\n\n<pre><code>sumList :: [Int] -&gt; Int\nsumList list\n    | length list &gt; 0 = head list + sumList (tail list)\n    | otherwise = 0\n</code></pre>\n\n<p>Notice how <code>[list]</code> has been replaced by <code>list</code>, and <code>!! 0</code> has been replaced by <code>head</code>, and <code>drop 1</code> has been replaced by <code>tail</code>.</p>\n\n<p>Hoogle is your friend!</p>\n\n<p>You could also move the check for an empty list to the first guard, like so:</p>\n\n<pre><code>sumList :: [Int] -&gt; Int\nsumList list\n    | list == [] = 0\n    | otherwise = head list + sumList (tail list)\n</code></pre>\n\n<p>Note how similar this code is to the pattern matching code.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1524988418, "creation_date": 1524988418, "answer_id": 50084495, "question_id": 50083476, "link": "https://stackoverflow.com/questions/50083476/haskell-beginner-recursive-function-list-error-non-exhaustive-patterns/50084495#50084495", "title": "Haskell Beginner, recursive function, list, Error: Non-exhaustive patterns", "body": "<p>Others have already answered, but I want to stress that the warning emitted by the compiler spotted the issue:</p>\n\n<pre><code>Pattern match(es) are non-exhaustive\nIn an equation for \u2018sumList\u2019:\n    Patterns not matched:\n        []\n        (_:_:_)\n</code></pre>\n\n<p>This is saying that the code is not handling some cases in its pattern matching. The empty list <code>[]</code> above is reported as non-matched, meaning that the program will crash on the empty list. Also, the lists of the form <code>(_:_:_)</code> are not matched: these are lists having at least two elements, such as <code>1:2:rest</code> which is a list starting with elements <code>1</code> and <code>2</code> and then proceeding with list <code>rest</code> for the next elements.</p>\n\n<p>So, the warning is telling us that we only handle lists of length one. Indeed, we only handle the pattern <code>[_]</code>, which is the same of <code>_:[]</code> -- a list starting with one element and then ending there.</p>\n\n<p>If you are a beginner, I think you did not learn pattern matching yet. This should be your priority for learning Haskell: it is one of the most important features. Generally speaking, if your recursive code uses <code>length, !!, tail, head</code> it is very likely that your are doing it wrong. There are some places where these functions are needed, but in many simple exercises they are not, pattern matching being usually sufficient and elegant.</p>\n"}], "owner": {"reputation": 35, "user_id": 9716319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c80203985edccb731b47e72130ead9?s=128&d=identicon&r=PG&f=1", "display_name": "radiosonic", "link": "https://stackoverflow.com/users/9716319/radiosonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 50083568, "answer_count": 3, "score": 1, "last_activity_date": 1524988418, "creation_date": 1524977334, "last_edit_date": 1524979119, "question_id": 50083476, "link": "https://stackoverflow.com/questions/50083476/haskell-beginner-recursive-function-list-error-non-exhaustive-patterns", "title": "Haskell Beginner, recursive function, list, Error: Non-exhaustive patterns", "body": "<p>i try to write a function  [int] -> int to count the sum of a list of integers with an iterative function (result should equal the build in function sum)</p>\n\n<pre><code>19&gt;sumList :: [Int] -&gt; Int\n20&gt;sumList [list] | length[list] &gt; 0  = [list]!!0 + sumList (drop 1 [list])\n21&gt;               | otherwise = 0\n</code></pre>\n\n<p>This is the result if i try to run it</p>\n\n<pre><code>uebung1.lhs:20:2: warning: [-Wincomplete-patterns]\nPattern match(es) are non-exhaustive\nIn an equation for \u2018sumList\u2019:\n    Patterns not matched:\n        []\n        (_:_:_)\nOk, modules loaded: Main.\n*Main&gt; sumList []\n*** Exception: uebung1.lhs:(20,2)-(21,31): Non-exhaustive patterns in     function sumList\n\n*Main&gt; sumList [3]\n*** Exception: uebung1.lhs:(20,2)-(21,31): Non-exhaustive patterns in   function sumListi i i i i \n</code></pre>\n\n<p>What have i done wrong? I've slept a night over it but i just dont see where the problem is. The guarded equations should catch all cases of list lengths. Thanks for any advise.</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "gtk2hs"], "comments": [{"owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "edited": false, "score": 0, "creation_date": 1524960329, "post_id": 50082080, "comment_id": 87180235, "body": "Haskell platform is generally recommended against. Have you tried using stack or nix? Stack is the most recommended tool. Both will ensure these errors never happen."}, {"owner": {"reputation": 25, "user_id": 4661858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wc6eU5LW3-Q/AAAAAAAAAAI/AAAAAAAAACo/AtIbMqY2uXU/photo.jpg?sz=128", "display_name": "Vishad Goyal", "link": "https://stackoverflow.com/users/4661858/vishad-goyal"}, "reply_to_user": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "edited": false, "score": 0, "creation_date": 1524960786, "post_id": 50082080, "comment_id": 87180312, "body": "I ran <code>stack install gtk2hs-buildtools</code> and got the following error:  &gt; Run from outside a project, using implicit global project config Using resolver: lts-11.6 from implicit global project&#39;s config file: /home/vishad/.stack/global-project/stack.yaml Downloaded lts-11.6 build plan.     AesonException &quot;Invalid flag name: \\&quot;bytestring--lt-0_10_4\\&quot;&quot;"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1524977602, "post_id": 50082080, "comment_id": 87182726, "body": "What stack version are you using ? I would recommend  you to upgrade to the latest one if you aren&#39;t using so."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 1, "creation_date": 1525556124, "post_id": 50082080, "comment_id": 87405545, "body": "For that matter, what version of ghc are you using to run into those sorts of issues? The particular problem only occurs with ghc &lt; 8.0. You should be using a newer ghc: <a href=\"https://github.com/haskell/cabal/issues/4785\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/4785</a>"}], "owner": {"reputation": 25, "user_id": 4661858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wc6eU5LW3-Q/AAAAAAAAAAI/AAAAAAAAACo/AtIbMqY2uXU/photo.jpg?sz=128", "display_name": "Vishad Goyal", "link": "https://stackoverflow.com/users/4661858/vishad-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524959463, "creation_date": 1524959463, "last_edit_date": 1592644375, "question_id": 50082080, "link": "https://stackoverflow.com/questions/50082080/installing-gtk2hs-on-ubuntu", "title": "Installing gtk2hs on ubuntu", "body": "<p>I am trying to install gtk for Haskell on Ubuntu. I have already installed the Haskell platform.\nWhen I run <code>cabal install gtk2hs-buildtools</code>, I get the following error:</p>\n<blockquote>\n<p>Resolving dependencies...</p>\n<p>Configuring Cabal-2.2.0.1...</p>\n<p>Failed to install Cabal-2.2.0.1</p>\n<p>Build log ( /home/vishad/.cabal/logs/Cabal-2.2.0.1.log ):</p>\n<p>cabal: Error: some packages failed to install:</p>\n<p>Cabal-2.2.0.1 failed during the configure step. The exception was:</p>\n<p>user error ('/usr/bin/ghc' exited with an error:</p>\n<p>/tmp/cabal-tmp-11425/Cabal-2.2.0.1/Distribution/Utils/IOData.hs:36:0:</p>\n<p>error: missing binary operator before token &quot;(&quot;</p>\n<p>#if MIN_VERSION_bytestring(0,10,0)</p>\n<p>^</p>\n<p>)</p>\n<p>gtk2hs-buildtools-0.13.4.0 depends on Cabal-2.2.0.1 which failed to install.</p>\n</blockquote>\n<p>I have already installed the dependencies using the following command :</p>\n<pre><code>   sudo apt-get install libgtk2.0-dev libpango1.0-dev libglib2.0-dev libcairo2-dev\n</code></pre>\n"}, {"tags": ["list", "haskell", "replicate"], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 6, "last_activity_date": 1524956580, "creation_date": 1524956580, "answer_id": 50081840, "question_id": 50081760, "link": "https://stackoverflow.com/questions/50081760/haskell-repeat-elements-of-a-list-according-to-their-list-index/50081840#50081840", "title": "Haskell - repeat elements of a list according to their list-index", "body": "<p>A big part of Haskell is breaking things down into smaller problems. So let's break your problem down.</p>\n\n<p>One of the things you'll need to be able to do is repeat an element. As you've already found, this functionality exists in Haskell in the form of the <code>replicate</code> function. But you can implement it yourself just as easily.</p>\n\n<pre><code>repeatNTimes :: Int -&gt; a -&gt; [a]\nrepeatNTimes 0 _ = []\nrepeatNTimes n x = x : repeatNTimes (n - 1) x\n</code></pre>\n\n<p>If we're repeating something zero times, return the empty list. Otherwise, put the element at the front and recurse.</p>\n\n<p>Now we can repeat things. Let's write a function that keeps track of our list position. It'll look like this.</p>\n\n<pre><code>testImpl :: Int -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>It'll take an integer (the current position) and the tail of the list and return the result given that particular piece of the list. As before, we'll have two cases: one where the list is empty and one where it's not. The first case is simple; if the list is empty, return the empty list. If the list is nonempty, repeat the first element, and then recurse.</p>\n\n<pre><code>testImpl :: Int -&gt; [a] -&gt; [a]\ntestImpl _ [] = []\ntestImpl n (x:xs) = repeatNTimes n x ++ testImpl (n + 1) xs\n</code></pre>\n\n<p><code>++</code> is a built-in function which concatenates two lists. You could also implement that yourself if you really want to. Now, to start with, we consider the first element to be element 1, since we want to repeat it one time, so we'll begin the recursion by passing <code>1</code> to <code>testImpl</code>.</p>\n\n<pre><code>test :: [a] -&gt; [a]\ntest = testImpl 1\n</code></pre>\n\n<p><strong>Complete example:</strong></p>\n\n<pre><code>repeatNTimes :: Int -&gt; a -&gt; [a]\nrepeatNTimes 0 _ = []\nrepeatNTimes n x = x : repeatNTimes (n - 1) x\n\ntestImpl :: Int -&gt; [a] -&gt; [a]\ntestImpl _ [] = []\ntestImpl n (x:xs) = repeatNTimes n x ++ testImpl (n + 1) xs\n\ntest :: [a] -&gt; [a]\ntest = testImpl 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1524956649, "creation_date": 1524956649, "answer_id": 50081845, "question_id": 50081760, "link": "https://stackoverflow.com/questions/50081760/haskell-repeat-elements-of-a-list-according-to-their-list-index/50081845#50081845", "title": "Haskell - repeat elements of a list according to their list-index", "body": "<p>In that case, we usually use an accumulator. An accumulator is an extra parameter that we pass (and update) to reach our goal. We thus can implement a function <code>test'</code> with two parameters: a list <code>l</code>, and an index <code>i</code>, and we define it as follows:</p>\n\n<ol>\n<li>in case the list is empty, we return an empty list; and</li>\n<li>in case the list is not empty, we yield the head of the list <code>i</code> times, and recurse on the tail of the list and an incremented <code>i</code>.</li>\n</ol>\n\n<p>We can implement this like:</p>\n\n<pre><code>test' :: Int -&gt; [a] -&gt; [a]\ntest' _ [] = []\ntest' i (x:xs) = rep i\n    where rep j | j &gt; 0 = x : rep (j-1)\n                | otherwise = test' (i+1) xs\n</code></pre>\n\n<p>So now we only need to define <code>test</code> in terms of <code>test'</code>, here we can say that <code>test</code> with a list <code>l</code> is the same as <code>test'</code> with that list, and <code>1</code> as start index:</p>\n\n<pre><code>test :: [a] -&gt; [a]\ntest = test' 1\n    where test' _ [] = []\n          test' i (x:xs) = rep i\n              where rep j | j &gt; 0 = x : rep (j-1)\n                          | otherwise = test' (i+1) xs\n</code></pre>\n\n<p>We then obtain test results like:</p>\n\n<pre><code>Prelude&gt; test ['1'..'3']\n\"122333\"\nPrelude&gt; test [1..3]\n[1,2,2,3,3,3]\nPrelude&gt; test [1, 4, 2, 5]\n[1,4,4,2,2,2,5,5,5,5]\nPrelude&gt; test \"ia2b\"\n\"iaa222bbbb\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1524961334, "post_id": 50082129, "comment_id": 87180421, "body": "You could implement <code>zip</code> too."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1524959978, "creation_date": 1524959978, "answer_id": 50082129, "question_id": 50081760, "link": "https://stackoverflow.com/questions/50081760/haskell-repeat-elements-of-a-list-according-to-their-list-index/50082129#50082129", "title": "Haskell - repeat elements of a list according to their list-index", "body": "<p>List comprehensions to the rescue:</p>\n\n<pre><code>test xs = [x | (i,x) &lt;- zip [1..] xs, _ &lt;- [1..i]]\n</code></pre>\n\n<p>Unless of course you count <code>zip</code> among \"prebuilt-list-functions\", which you well might.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1524989835, "post_id": 50083586, "comment_id": 87184985, "body": "very nice idea; if we <i>start</i> with the last definition, it practically dictates the <code>oneMore cons a as = a : cons a as</code> definition."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525011695, "post_id": 50083586, "comment_id": 87190923, "body": "@WillNess, I struggled a bit with presentation here. Please feel free to edit if you think you can do better. Also, for myself I&#39;d use <code>RankNTypes</code> to explain what&#39;s not going on a little better, but the OP would then be quite lost."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525018336, "post_id": 50083586, "comment_id": 87193269, "body": "@WillNess, I&#39;m not sure that really helps; I personally find it confusing and opaque. After pondering some more, I&#39;m thinking the way to start is with a version of <code>test</code> that uses <code>oneMore0</code> and <code>++</code>, then show how to eliminate the latter. I&#39;ll try to work that up later unless you get to it first"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525018652, "post_id": 50083586, "comment_id": 87193377, "body": "btw the trivial tracing of a data structure as a starting point is a technique from Sterling and Shapiro  old Prolog book. they call it &quot;program skeleton&quot;."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525047147, "post_id": 50083586, "comment_id": 87201198, "body": "@WillNess, I reverted your change because I couldn&#39;t work out how to integrate it into the structure I decided I wanted. But if you can motivate your technique a bit better, I think you should write your own answer. Thanks for prodding me to improve my explanation."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525049066, "post_id": 50083586, "comment_id": 87201568, "body": "of course, it was too different an approach. about the derivation, good starting point! it is also possible to say that <code>rep a ++ go (oneMore rep) as = ((++).rep) a (go ...)</code> which practically forces us to give the fused <code>rep1&#39; = (++).rep1</code> definition, and the correspondingly changed <code>oneMore&#39; rep1&#39; a as = ...</code> which must be of the same type as <code>rep1&#39;</code>, which again practically writes itself. Just saying &quot;few adjustments needed&quot; is not explaining much. just a thought."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525056482, "post_id": 50083586, "comment_id": 87202802, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/170054/discussion-between-dfeuer-and-will-ness\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1525047074, "last_edit_date": 1525047074, "creation_date": 1524978605, "answer_id": 50083586, "question_id": 50081760, "link": "https://stackoverflow.com/questions/50081760/haskell-repeat-elements-of-a-list-according-to-their-list-index/50083586#50083586", "title": "Haskell - repeat elements of a list according to their list-index", "body": "<p>You can do this without any numbers. Let's work our way up to it. We'll use the accumulator approach, but instead of keeping a <em>number</em> in the accumulator, we'll keep a <em>function</em> that repeats its argument a certain number of times.</p>\n\n<pre><code>test0 :: [a] -&gt; [a]\ntest0 xs = go rep1 xs\n  where\n    rep1 :: a -&gt; [a]\n    rep1 a = [a]\n\n    go :: (a -&gt; [a]) -&gt; [a] -&gt; [a]\n    go _rep [] = []\n    go rep (a : as) = rep a ++ go (oneMore rep) as\n\n    oneMore :: (a -&gt; [a]) -&gt; (a -&gt; [a])\n    oneMore rep a = a : rep a\n</code></pre>\n\n<p>We start off calling <code>go</code> with <code>rep1</code>, a really simple function that turns its argument into a singleton list. Then on each recursive call, we modify the repeater function by making it repeat its argument one more time.</p>\n\n<p><code>test0</code> works just fine, but it uses the <code>++</code> function, and you're not supposed to be using any predefined functions. Using <code>++</code> here also means that you have to build up the small lists and put them together, an inefficiency we can remove pretty easily.</p>\n\n<p>Note that every time <code>go</code> calls <code>rep</code>, it immediately appends something else to the result. This suggests the solution: instead of having <code>rep</code> take an element and produce a list, let's have it take an element and a list, and produce a list consisting of the element repeated a certain number of times followed by the given list! So we'll have</p>\n\n<pre><code>rep1 \"a\" [\"b\", \"c\"] = [\"a\", \"b\", \"c\"]\nrep2 \"a\" [\"b\", \"c\"] = [\"a\", \"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>where <code>rep1</code> and <code>rep2</code> are the first two <code>rep</code> functions. Just a few adjustments are needed.</p>\n\n<pre><code>test :: [a] -&gt; [a]\ntest = go rep1\n  where\n    rep1 :: a -&gt; [a] -&gt; [a]\n    rep1 a as = a : as  -- Note: rep1 can be written as just (:)\n\n    go :: (a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a]\n    go _ [] = []\n    go rep (a : as) = rep a (go (oneMore rep) as)\n\n    oneMore :: (a -&gt; [a] -&gt; [a])\n            -&gt; a -&gt; [a] -&gt; [a]\n    oneMore f a as = a : f a as\n</code></pre>\n\n<p>This really isn't an <em>efficient</em> way to solve the problem, but it's a rather minimalist approach.</p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1525042383, "creation_date": 1525042383, "answer_id": 50092052, "question_id": 50081760, "link": "https://stackoverflow.com/questions/50081760/haskell-repeat-elements-of-a-list-according-to-their-list-index/50092052#50092052", "title": "Haskell - repeat elements of a list according to their list-index", "body": "<p>Enumerations can produce ordinal numbers given a cardinal number. Indices are ordinal numbers. What this means is the digit in list a is the end number in the enumeration. Each index set (cardinal number set from ordinals) is [0..index]the first, actually zero is [0..1]. If we wanted to us ordinals it would be [1..1], then [1..2] and [1..3] But the function uses zero index out of habit and the cardinal number must be decrimented.</p>\n\n<p><code>[b|b&lt;-[1,2,3], a&lt;-[0..b-1]]</code></p>\n\n<p>Enumeration parameters are very much fun. Enumerations can be used as index parameters to other lists of any type. Enumerations can supply parameters to other functions and other enumerations.</p>\n"}], "owner": {"reputation": 53, "user_id": 9712740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6525a8076acef615603ac256e72dc44c?s=128&d=identicon&r=PG&f=1", "display_name": "Pal", "link": "https://stackoverflow.com/users/9712740/pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2012, "favorite_count": 0, "accepted_answer_id": 50081840, "answer_count": 5, "score": 5, "last_activity_date": 1525047074, "creation_date": 1524955863, "last_edit_date": 1524956824, "question_id": 50081760, "link": "https://stackoverflow.com/questions/50081760/haskell-repeat-elements-of-a-list-according-to-their-list-index", "title": "Haskell - repeat elements of a list according to their list-index", "body": "<p>I\u00b4m still a beginner in Haskell. I try to do some pattern matching. I want to repeat each element of a list n-times. N is determined by the index-place of every element in a list. \nFor example <code>['1', '2', '3']</code> should give me: <code>['1', '2', '2', '3', '3', '3']</code>. \nIt\u00b4s an exercise and I shouldn\u00b4t use prebuild-list-functions. </p>\n\n<p>I tried something like that:</p>\n\n<pre><code>test [] = []\ntest (first:[]) = [first] \ntest (first:second:rest) = first : second : test (second:rest)\n</code></pre>\n\n<p>But it just doubled each element after the first element. I thought about elemIndex and replicate but I shouldn\u00b4t use these functions. My idea was to use elemIndex and with that using it as the my \"n\" and to use replicate or something similar after that with the \"n\" and recursion. I need something like that in Pattern matching. But I think, that I\u00b4m thinking too complicated. Has there anyone an idea? </p>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1524946193, "creation_date": 1524946193, "answer_id": 50080620, "question_id": 50079324, "link": "https://stackoverflow.com/questions/50079324/trouble-building-yesod-amazonka-dependencies-in-a-haskell-stack-project/50080620#50080620", "title": "Trouble building yesod/amazonka dependencies in a Haskell Stack project", "body": "<p>Unfortunately you can't use <a href=\"https://github.com/commercialhaskell/stack-templates\" rel=\"nofollow noreferrer\">Commercial Haskell's</a> stack templates with yesod and amazonka as of now. The reasons being:</p>\n\n<ul>\n<li><a href=\"https://www.snoyman.com/blog/2018/01/drop-conduits-finalizers\" rel=\"nofollow noreferrer\">There was a recent conduit rewrite in version 1.3</a></li>\n<li><a href=\"https://www.yesodweb.com/blog/2018/01/upcoming-yesod-breaking-changes\" rel=\"nofollow noreferrer\">Some breaking changes were introduced in recent Yesod 1.6 which depends on conduit >= 1.3</a></li>\n<li><a href=\"https://github.com/brendanhay/amazonka/issues/446\" rel=\"nofollow noreferrer\">Amazonka doesn't work with recent version of conduit</a></li>\n</ul>\n\n<p>The only way for you to get it working is switching back to old version of stack templates (those templates which actually worked with stackage resolver 10.9) and then using that to create a new project. Fortunately, Stack supports custom stack templates:</p>\n\n<pre><code>$ stack new my-project https://raw.githubusercontent.com/github-user-id/stack-templates/master/my-template.hsfiles\n</code></pre>\n"}], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 50080620, "answer_count": 1, "score": 3, "last_activity_date": 1524970332, "creation_date": 1524936955, "last_edit_date": 1524970332, "question_id": 50079324, "link": "https://stackoverflow.com/questions/50079324/trouble-building-yesod-amazonka-dependencies-in-a-haskell-stack-project", "title": "Trouble building yesod/amazonka dependencies in a Haskell Stack project", "body": "<p>I'm trying to use the excellent AWS SDK <a href=\"http://hackage.haskell.org/package/amazonka-1.5.0\" rel=\"nofollow noreferrer\">amazonka</a> in the backend portion of an API built using the equally excellent web framework <a href=\"https://hackage.haskell.org/package/yesod\" rel=\"nofollow noreferrer\">yesod</a>, but I am having great difficulty getting the dependencies for these two libraries to work together.  </p>\n\n<p>I started the scaffolded yesod project with</p>\n\n<pre><code>stack new my-project yesod-mongo\n</code></pre>\n\n<p>which populated my cabal file with the most recent version of yesod (1.6.0).  Naively adding the dependencies <code>amazonka-core</code> and <code>amazonka-ssm</code> (for example) to my cabal file comes back with</p>\n\n<pre><code>Error: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for my-project-0.0.0:\n    amazonka-core must match -any, but the stack configuration has no specified version\n              (latest matching version is 1.5.0)\n    amazonka-ssm must match -any, but the stack configuration has no specified version\n             (latest matching version is 1.5.0)\nneeded since my-project is a build target.\n</code></pre>\n\n<p>As suggested, I tried adding <code>amazonka-core-1.5.0</code> and <code>amazonka-ssm-1.5.0</code> to my stack.yaml file under <code>extra-deps</code>, but this doesn't work:</p>\n\n<pre><code>Warning: WARNING: /home/ubuntu/my-project/my-project.cabal was modified manually.\n     Ignoring package.yaml in favor of cabal file. If you want to use package.yaml\n     instead of the cabal file, then please delete the cabal file.\n\nError: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for amazonka-core-1.5.0:\n    conduit-1.3.0.2 from stack configuration does not match &gt;=1.1 &amp;&amp; &lt;1.3 (latest\n                matching version is 1.2.13.1)\nneeded due to my-project-0.0.0 -&gt; amazonka-core-1.5.0\n</code></pre>\n\n<p>After a bit of digging, it seems that the snapshot that the yesod template was built off of is lts-11.6, but the most recent snapshot that the amazonka library is included in is lts-10.9.  So, I tried building the project again from the yesod-mongo template, but this time specifying an older snapshot:</p>\n\n<pre><code>ubuntu:~$ stack new my-project yesod-mongo --resolver lts-10.9\nDownloading template \"yesod-mongo\" to create project \"my-project\" in my-project/ ...\nLooking for .cabal or package.yaml files to use to init the project.\nUsing cabal packages:\n- my-project/\n\nSelected resolver: lts-10.9\nResolver 'lts-10.9' does not have all the packages to match your requirements.\n    classy-prelude version 1.3.1 found\n        - my-project requires ==1.4.*\n    classy-prelude-conduit version 1.3.1 found\n        - my-project requires ==1.4.*\n    classy-prelude-yesod version 1.3.1 found\n        - my-project requires ==1.4.*\n    http-conduit version 2.2.4 found\n        - my-project requires ==2.3.*\n    persistent version 2.7.1 found\n        - my-project requires ==2.8.*\n    persistent-mongoDB version 2.6.0 found\n        - my-project requires ==2.8.*\n    yesod version 1.4.5 found\n        - my-project requires ==1.6.*\n    yesod-auth version 1.4.21 found\n        - my-project requires ==1.6.*\n    yesod-core version 1.4.37.3 found\n        - my-project requires ==1.6.*\n    yesod-form version 1.4.16 found\n        - my-project requires ==1.6.*\n    yesod-static version 1.5.3.1 found\n        - my-project requires ==1.6.*\n    Using package flags:\n        - my-project: dev = False, library-only = False\n</code></pre>\n\n<p>Now I am at a loss and more than a little frustrated.  It seems like perhaps the template is ignoring the snapshot specification.  So, my question:</p>\n\n<p><strong>Is there a way to build the scaffolded site from a template that uses a specific snapshot to fill in the cabal and stack.yaml files?  Is there anything else I can do to get this to work?</strong></p>\n\n<p>Happy to provide more information if it's helpful. </p>\n\n<p><strong>Edit:</strong> I also tried bumping down the versions of the packages in the above snippet, and while this solves the issue of building dependencies, now the scaffolded site doesn't compile (presumably because things have changed in a meaningful way from yesod-1.4.5 to yesod-1.6.0).  </p>\n"}, {"tags": ["haskell", "recursion", "lambda", "exponential"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 6, "creation_date": 1524935046, "post_id": 50078886, "comment_id": 87174005, "body": "Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524935357, "post_id": 50078886, "comment_id": 87174103, "body": "Without an MCVE, benchmarking this and trying alternatives requires too much effort."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524936258, "post_id": 50078886, "comment_id": 87174408, "body": "Yes, shrink your code to the minimal example that still produces this problem. Otherwise, &quot;why isn&#39;t this code working?&quot; is an option when voting to close subjects; the general applicability of the Q&amp;A is severely limited when the question gets so specific, and the effort of debugging becomes high."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1524937412, "post_id": 50078886, "comment_id": 87174777, "body": "<code>delta = maximum [abs (f s - g s) | s &lt;- ss]</code> is so much easier to follow. and you didn&#39;t include your <code>gen</code>, <code>pol</code>, and <code>actVal</code> definitions."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524948111, "post_id": 50078886, "comment_id": 87177667, "body": "I suspect this can be greatly simplified if you don&#39;t make it tail-recursive."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525021760, "post_id": 50078886, "comment_id": 87194381, "body": "@WillNess, thanks! Yes, I agree, your version is MUCH more readable; I&#39;ll make the chang."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525021825, "post_id": 50078886, "comment_id": 87194400, "body": "@chepner, thanks for your reply! Could you give me just a little more of a hint, please?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525021971, "post_id": 50078886, "comment_id": 87194440, "body": "I&#39;ll vote to reopen right now, on the belief that you <i>will</i> indeed edit this question as you say you will, :) to <i>include the relevant and missing</i> definitions, for <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Please do this soon."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "edited": false, "score": 0, "creation_date": 1525022563, "post_id": 50078886, "comment_id": 87194588, "body": "Okay, I solved this by using a vector representation of the <code>vofs&#39;</code> function. Thanks to all, whom replied. And my apologies to those, whom felt this question was off topic."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1525023002, "post_id": 50078886, "comment_id": 87194743, "body": "still, you should edit to include all relevant details, then post your own answer and accept it. that&#39;s the SO way. these Q&amp;A entries are to serve the community at large, not just the asker. :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525023139, "post_id": 50078886, "comment_id": 87194785, "body": "@dbanas. Instead of building up the result in an accumulator, just prepend the result of the recursive call with the new value: <code>evalPol ... = (something, delta) : evalPol</code>. It lets you get rid of some of the parameters to the function."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525023185, "post_id": 50078886, "comment_id": 87194800, "body": "You can also get rid of <code>maxIter</code> and <code>nIter</code> if you just let <code>evalPol</code> build an infinite stream of values, then just take the ones you want: <code>take maxIter (evalPol ...)</code>."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1525180901, "post_id": 50078886, "comment_id": 87251660, "body": "@chepner, thank you!"}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1525181077, "post_id": 50078886, "comment_id": 87251764, "body": "@WillNess, change to definition of <code>delta</code> made, as per your request. I hesitate to start adding more code (i.e. - definitions of <code>gen</code>, <code>pol</code>, and <code>actVal</code>, because they call other functions, which would need to be included, and this question has already been flagged as having code that isn&#39;t succinct enough."}], "answers": [{"tags": [], "owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "is_accepted": true, "score": 1, "last_activity_date": 1525181487, "creation_date": 1525181487, "answer_id": 50117413, "question_id": 50078886, "link": "https://stackoverflow.com/questions/50078886/why-am-i-getting-an-exponential-number-of-calls-into-my-sub-function/50117413#50117413", "title": "Why am I getting an exponential number of calls into my sub-function?", "body": "<p>I solved this by using a vector representation of the <code>vofs'</code> function.\nDoing so has eliminated the redundant calculations that were being performed previously. I now see 882 calls into the new equivalent of <code>vofs'</code>, for the <em>2 recursions</em> case, which is what I expect. That is, I expect the execution time of <code>evalPol</code> to be <em>linear</em> in <code>maxIter</code> and, using a vector representation of <code>vofs'</code>, that's what I'm seeing.</p>\n"}], "owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 50117413, "answer_count": 1, "score": -1, "last_activity_date": 1525181487, "creation_date": 1524934198, "last_edit_date": 1525180712, "question_id": 50078886, "link": "https://stackoverflow.com/questions/50078886/why-am-i-getting-an-exponential-number-of-calls-into-my-sub-function", "title": "Why am I getting an exponential number of calls into my sub-function?", "body": "<p>I have a problem with the following Haskell function:</p>\n\n<pre><code>evalPol :: Float\n        -&gt; Float\n        -&gt; Integer\n        -&gt; Integer\n        -&gt; (s -&gt; a -&gt; [(s, [(Float, Float)])])\n        -&gt; (s -&gt; a)\n        -&gt; [s]\n        -&gt; [((s -&gt; Float), Float)]\n        -&gt; [((s -&gt; Float), Float)]\nevalPol eps gamma maxIter nIter gen pol ss vofss =\n  if nIter &gt;= maxIter || delta &lt; eps\n    then reverse ((vofs', delta) : vofss)\n    else evalPol eps gamma maxIter (nIter + 1) gen pol ss ((vofs', delta) : vofss)\n where delta   = maximum [abs (vofs s - vofs' s) | s &lt;- ss]\n       vofs' s = actVal gamma gen vofs s (pol s)\n       vofs    = (fst . P.head) vofss\n</code></pre>\n\n<p>If I call this function with <code>maxIter = 1</code> and run with profiling then I see function entry counts, which make sense to me:</p>\n\n<pre><code>evalPol..............2\n  evalPol.delta......1\n    evalPol.vofs'..441\n</code></pre>\n\n<p>The function entry count numbers, above, make sense to me, as follows:</p>\n\n<ol>\n<li><p><code>evalPol</code> is entered twice:</p>\n\n<ol>\n<li>once, when called from outside, and</li>\n<li>once, recursively. (Only one recursive call is allowed, due to: <code>maxIter = 1</code>.)</li>\n</ol></li>\n<li><p><code>evalPol.delta</code> is called only once, because when <code>evalPol</code> is called the second time (recursively) the test: <code>nIter &gt;= maxIter</code> succeeds, and there is no need to evaluate <code>delta</code>.</p></li>\n<li><p>It makes sense that I get 441 entries into <code>evalPol.vofs'</code>, because I'm mapping that function over the list, <code>ss</code>, and there are 441 items in that list.</p></li>\n</ol>\n\n<p>Now, if I make only one change: calling <code>evalPol</code> with <code>maxIter = 2</code>, I find that my program doesn't terminate in a reasonable amount of time.\nAllowing it to run for several hours before interupting it, I get the following instead:</p>\n\n<pre><code>evalPol................2\n  evalPol.delta........2\n    evalPol.vofs'..60366\n</code></pre>\n\n<p>The change in the number of entries to <code>evalPol.delta</code> from 1 to 2 (See #2, above.) makes sense to me, since I've set <code>maxIter = 2</code>.\nHowever, I was <em>not</em> expecting such a blow up in the number of entries into <code>evalPol.vofs'</code>.\n(I was expecting to see 882 entries, 441 for each allowed recursion.)\nIt looks like the number of entries into <code>evalPol.vofs'</code> is <em>exponential</em> in <code>maxIter</code>.\n(I don't know this, since I didn't let the program finish.)</p>\n\n<p>If I \"unroll\" this 2 recursion case, looking for an exponential dependency upon <code>maxIter</code>, I get:</p>\n\n<pre><code>-- This is how I call it from outside:\nevalPol eps gamma 2 0 gen pol ss [((const 0), 0)] =                  -- Assume delta &gt;= eps and recurse.\nevalPol eps gamma 2 1 gen pol ss [(vofs', delta), ((const 0), 0)]\n\n-- Now, expand delta\ndelta = maximum $ map (abs . uncurry (-) . (vofs &amp;&amp;&amp; vofs')) ss      -- Substitute for vofs, vofs', and pol, using previous iteration's definitions.\n      = maximum $ map ( abs\n                      . uncurry (-)\n                      . ( vofs' &amp;&amp;&amp;\n                          \\s -&gt; actVal gamma gen vofs' s 0\n                        )\n                      ) ss\n      = maximum $ map ( abs\n                      . uncurry (-)\n                      . ( \\s -&gt; actVal gamma gen (const 0) s 0 &amp;&amp;&amp;\n                          \\s -&gt; actVal gamma gen (\\s' -&gt; actVal gamma gen (const 0) s' 0) s 0\n                        )\n                      ) ss\n</code></pre>\n\n<p>I see the recursion developing, as expected, but I don't see any nested calling into <code>evalPol.vofs'</code>, which might explain the (supposedly) exponential dependency upon <code>maxIter</code> that I'm observing.\nFurthermore, I've looked at both the <code>actVal</code> function, as well as the <code>gen</code> function, and there are no calls into <code>evalPol.vofs'</code> hiding in either of them.\nSo, I'm at a loss to explain this very large number of entries into <code>evalPol.vofs'</code> that I'm observing in the <code>maxIter = 2</code> case.</p>\n"}, {"tags": ["haskell", "scientific-notation"], "comments": [{"owner": {"reputation": 165, "user_id": 2630395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b5f0f742c249caa0f3d03554e9a1675?s=128&d=identicon&r=PG", "display_name": "Somebody", "link": "https://stackoverflow.com/users/2630395/somebody"}, "edited": false, "score": 1, "creation_date": 1524940641, "post_id": 50078551, "comment_id": 87175648, "body": "Maybe write another function which parses the string to an equivalent format which can be used with read?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1524946276, "post_id": 50078551, "comment_id": 87177175, "body": "I always thought Haskell should support such literals. <a href=\"https://stackoverflow.com/questions/7641363/why-do-haskell-numerical-literals-need-to-start-and-end-with-digits\">There are reasons not to do it in the language</a>, but I really don&#39;t see a reason not to support it in <code>read</code>. Fortunately, defining a numbers parser yourself is easy (and better than preprocessing for <code>Read</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 26221, "user_id": 7294647, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QFLgL.jpg?s=128&g=1", "display_name": "Jacob G.", "link": "https://stackoverflow.com/users/7294647/jacob-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1524948911, "last_edit_date": 1524948911, "creation_date": 1524942826, "answer_id": 50080181, "question_id": 50078551, "link": "https://stackoverflow.com/questions/50078551/more-accommodating-read-for-scientific-notation-in-haskell/50080181#50080181", "title": "More accommodating read for scientific notation in Haskell", "body": "<p>As <a href=\"https://stackoverflow.com/questions/50078551/more-accommodating-read-for-scientific-notation-in-haskell#comment87175648_50078551\">Somebody said</a>, you can create a helper function (or three) to help transform the number into a format that works with <code>read</code>.  I'm not the best with Haskell, so I'm not sure what other solutions exist, but I wrote some functions to help.  I've tested it with <code>read</code>, and everything seems to work fine so far.</p>\n\n<pre><code>prefixZero :: String -&gt; String\nprefixZero \"\"         = \"\"\nprefixZero ('-' : xs) = '-' : '0' : xs\nprefixZero s          = '0' : s\n\nsuffixZero :: String -&gt; String\nsuffixZero \"\"                    = \"\"\nsuffixZero ('.' : exp@('E' : _)) = '.' : '0' : exp\nsuffixZero (x : xs)              = x : suffixZero xs\n\nformat :: String -&gt; String\nformat = suffixZero . prefixZero\n</code></pre>\n\n<p>You can call the following:</p>\n\n<pre><code>read (format \"-1.E34\") :: Double\n</code></pre>\n\n<p>Which outputs the following:</p>\n\n<pre><code>-1.0e34\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1524948066, "creation_date": 1524948066, "answer_id": 50080872, "question_id": 50078551, "link": "https://stackoverflow.com/questions/50078551/more-accommodating-read-for-scientific-notation-in-haskell/50080872#50080872", "title": "More accommodating read for scientific notation in Haskell", "body": "<p>Here's a custom parser that does this, using <a href=\"http://hackage.haskell.org/package/megaparsec-6.5.0\" rel=\"nofollow noreferrer\">megaparsec</a>.</p>\n\n<pre><code>import Text.Megaparsec\nimport Text.Megaparsec.Char\n\nrealLiteral :: (MonadParsec e s m, Token s ~ Char) =&gt; m Double\nrealLiteral = mkFloat &lt;$&gt; sign &lt;*&gt; intgPart &lt;*&gt; fracPart &lt;*&gt; exponent\n where mkFloat sgn itg frc expn\n           = fromIntegral sgn * (fromIntegral itg + frc) * 10^^expn\n       sign = (-1) &lt;$ char '-'\n           &lt;|&gt; 1   &lt;$ char '+'\n           &lt;|&gt; pure 1\n       intgPart = read . ('0':) &lt;$&gt; many digitChar\n       fracPart = char '.' *&gt; (toFrc&lt;$&gt;many digitChar)\n               &lt;|&gt; pure 0\n        where toFrc \"\" = 0\n              toFrc digits = read digits / 10^length digits\n       exponent = oneOf \"eEdD\" *&gt; ((*) &lt;$&gt; sign &lt;*&gt; (read&lt;$&gt;some digitChar))\n               &lt;|&gt; pure 0\n</code></pre>\n\n<pre>[1 of 1] Compiling Main             ( wtmpf-file5764.hs, interpreted )\nOk, 1 module loaded.\n*Main> parseMaybe realLiteral \"1\"\nJust 1.0\n*Main> parseMaybe realLiteral \"-3\"\nJust (-3.0)\n*Main> parseMaybe realLiteral \"-9e+2\"\nJust (-900.0)\n*Main> parseMaybe realLiteral \".3e+9\"\nJust 3.0e8\n*Main> parseMaybe realLiteral \"-1.E34\"\nJust (-1.0000000000000001e34)\n*Main> parseMaybe realLiteral \"-1.673986e-40\"\nJust (-1.6739859999999999e-40)\n*Main> parseMaybe realLiteral \"-3.E+16\"\nJust (-3.0e16)</pre>\n"}], "owner": {"reputation": 245, "user_id": 3200553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f414fbb453ddab423b29e06e0cba12?s=128&d=identicon&r=PG", "display_name": "Ryo", "link": "https://stackoverflow.com/users/3200553/ryo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1524948911, "creation_date": 1524932036, "question_id": 50078551, "link": "https://stackoverflow.com/questions/50078551/more-accommodating-read-for-scientific-notation-in-haskell", "title": "More accommodating read for scientific notation in Haskell", "body": "<p>Haskell's <code>read</code> is a bit too strict about floating point numbers:</p>\n\n<pre><code>$ ghci\nGHCi, version 8.2.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; read \"-1E34\" :: Double\n-1.0e34\nPrelude&gt; read \"-1.E34\" :: Double\n*** Exception: Prelude.read: no parse\nPrelude&gt;\n</code></pre>\n\n<p>Is there a version of read that accepts the second form? It is quite common in physical sciences. For example, Fortran reads and writes such forms.</p>\n\n<p>Another example that Haskell doesn't support is \".1\" for \"0.1\".  This one is even more common.  I just don't want to convert the input ascii file. . . .</p>\n"}, {"tags": ["haskell", "typeclass", "type-families", "data-kinds"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1524922466, "post_id": 50077000, "comment_id": 87170358, "body": "<code>Bool</code> isn&#39;t a data constructor like <code>True</code> or <code>False</code>, it&#39;s a type. You can remove the quote <code>&#39;</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524923409, "post_id": 50077000, "comment_id": 87170592, "body": "Is this meant to be <code>data MyBool (b :: Bool)</code> instead, by any chance?"}], "answers": [{"tags": [], "owner": {"reputation": 253, "user_id": 804666, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7557e04b3a7b1d7438abb5c65a731ce2?s=128&d=identicon&r=PG", "display_name": "Anders Miltner", "link": "https://stackoverflow.com/users/804666/anders-miltner"}, "is_accepted": false, "score": 2, "last_activity_date": 1525090185, "last_edit_date": 1525090185, "creation_date": 1524928736, "answer_id": 50078028, "question_id": 50077000, "link": "https://stackoverflow.com/questions/50077000/can-you-not-use-datakinds-inside-associated-data-types/50078028#50078028", "title": "Can you not use DataKinds inside Associated Data Types?", "body": "<p>Ok, there are 2 issues with what I did.</p>\n\n<p>1: <code>DataKinds</code> only requires lifting the constructors, not the data types.  So, the <code>'Bool</code> needs only be <code>Bool</code>.</p>\n\n<p>2: Kind signatures for <code>data</code> must have a return kind of <code>*</code>. I can insert data into the kind, but after all the applications have been done, I must eventually have a type.  I did not have this.</p>\n\n<p>For 2, all I had to do was change <code>data</code> to <code>type</code> and this restriction is no longer present.</p>\n"}], "owner": {"reputation": 253, "user_id": 804666, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7557e04b3a7b1d7438abb5c65a731ce2?s=128&d=identicon&r=PG", "display_name": "Anders Miltner", "link": "https://stackoverflow.com/users/804666/anders-miltner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525090185, "creation_date": 1524921784, "question_id": 50077000, "link": "https://stackoverflow.com/questions/50077000/can-you-not-use-datakinds-inside-associated-data-types", "title": "Can you not use DataKinds inside Associated Data Types?", "body": "<p>I have the following type class</p>\n\n<pre><code>class BoolHolding h where\n  data MyBool b :: 'Bool\n</code></pre>\n\n<p>However, I keep getting the error: Not in scope: data constructor \u2018Bool\u2019.  Does Haskell not permit this for some reason, or is there away to include the data constructor?  If not, why not?</p>\n"}, {"tags": ["windows", "powershell", "haskell", "ghc", "haskell-stack"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6811411"}, "edited": false, "score": 1, "creation_date": 1524914828, "post_id": 50075951, "comment_id": 87168145, "body": "Looks like ANSI ESCape sequences that aren&#39;t interpreted correctly"}, {"owner": {"reputation": 192, "user_id": 3048859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9f0af53f2adcf91a0321c037733d13?s=128&d=identicon&r=PG", "display_name": "user3048859", "link": "https://stackoverflow.com/users/3048859/user3048859"}, "edited": false, "score": 0, "creation_date": 1524915274, "post_id": 50075951, "comment_id": 87168263, "body": "thanks! yes... and stack build --color never turns them off... but can it be fixed?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1525075556, "post_id": 50075951, "comment_id": 87208845, "body": "See also <a href=\"https://stackoverflow.com/q/45608617/126014\">stackoverflow.com/q/45608617/126014</a>"}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 3048859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9f0af53f2adcf91a0321c037733d13?s=128&d=identicon&r=PG", "display_name": "user3048859", "link": "https://stackoverflow.com/users/3048859/user3048859"}, "is_accepted": false, "score": 3, "last_activity_date": 1524916163, "last_edit_date": 1524916163, "creation_date": 1524915010, "answer_id": 50076058, "question_id": 50075951, "link": "https://stackoverflow.com/questions/50075951/is-there-a-way-to-get-ghc-error-messages-properly-formatted-on-powershell-termin/50076058#50076058", "title": "Is there a way to get GHC error messages properly formatted on powershell terminal when built with stack?", "body": "<p>Turning off \"use legacy console\" in the cmd options does the trick!</p>\n\n<p>Seems to be due to ansi color escape sequences - thanks @LotPings</p>\n\n<p>Also:\n    stack build --color never </p>\n\n<p>gives monochrome but otherwise correctly formatted error messages.</p>\n"}], "owner": {"reputation": 192, "user_id": 3048859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9f0af53f2adcf91a0321c037733d13?s=128&d=identicon&r=PG", "display_name": "user3048859", "link": "https://stackoverflow.com/users/3048859/user3048859"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1524928498, "creation_date": 1524914210, "last_edit_date": 1524928498, "question_id": 50075951, "link": "https://stackoverflow.com/questions/50075951/is-there-a-way-to-get-ghc-error-messages-properly-formatted-on-powershell-termin", "title": "Is there a way to get GHC error messages properly formatted on powershell terminal when built with stack?", "body": "<p>Building with ghc prints beautifully formatted error messages on powershell (as in other terminals):</p>\n\n<pre><code>PS &gt; ghc .\\src\\XXX.hs -package ghc -package ghc-paths -package filepath\n\n[1 of 1] Compiling XXX           ( src\\XXX.hs, src\\XXX.o )\n\nsrc\\XXX.hs:340:9: error:\n    parse error on input `&lt;-'\n    Perhaps this statement should be within a 'do' block?\n    |\n340 |   blah  &lt;- blah blah blah\n    |         ^^\n</code></pre>\n\n<p>But when building through stack, something goes wrong:</p>\n\n<pre><code>PS &gt; stack build\nXXX-0.1.0.0: build (lib + exe)\nPreprocessing library for XXX-0.1.0.0..\nBuilding library for XXX-0.1.0.0..\n[2 of 3] Compiling XXX ( src\\XXX.hs, .stack-work\\dist\\5c8418a7\\build\\XXX.o )\n\n\u2190[;1msrc\\XXX.hs:340:9: \u2190[;1m\u2190[31merror:\u2190[0m\u2190[0m\u2190[;1m\u2190[0m\u2190[0m\u2190[;1m\n    parse error on input `&lt;-'\n    Perhaps this statement should be within a 'do' block?\u2190[0m\u2190[0m\n\u2190[;1m\u2190[34m    |\u2190[0m\u2190[0m\n\u2190[;1m\u2190[34m340 |\u2190[0m\u2190[0m   blah \u2190[;1m\u2190[31m&lt;-\u2190[0m\u2190[0m blah blah blah\n\u2190[;1m\u2190[34m    |\u2190[0m\u2190[0m\u2190[;1m\u2190[31m         ^^\u2190[0m\u2190[0m\n\u2190[0m\u2190[0m\u2190[0m\n</code></pre>\n\n<p>Is this a bug in stack, or is there a setting to fix it?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524913392, "post_id": 50075772, "comment_id": 87167762, "body": "Why do you have separate <code>AClass</code> and <code>MyClass</code> classes?"}, {"owner": {"reputation": 152, "user_id": 1935301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a80cd7bdb07f8b6d39385943c0f6fb4?s=128&d=identicon&r=PG", "display_name": "ryan91", "link": "https://stackoverflow.com/users/1935301/ryan91"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524913687, "post_id": 50075772, "comment_id": 87167834, "body": "Because AClass comes from a library. I maybe should have mentioned that in the first place."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524915894, "post_id": 50075772, "comment_id": 87168436, "body": "Do you want instances of <code>MyClass</code> to also be instances of <code>AClass</code>? Then you make <code>AClass</code> a superclass of <code>MyClass</code>: class AClass x =&gt; MyClass x where ...`."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524916015, "post_id": 50075772, "comment_id": 87168467, "body": "Or, do you want to bulk-define instances for <code>AClass</code> for anything that is also an instance of <code>MyClass</code>? That, I think, you can&#39;t do, short of redefining <code>AClass</code> to use <code>MyClass</code> as its superclass."}, {"owner": {"reputation": 29209, "user_id": 495796, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/86637c99f25d60157aa0f2e7eab90148?s=128&d=identicon&r=PG", "display_name": "Robin Green", "link": "https://stackoverflow.com/users/495796/robin-green"}, "edited": false, "score": 2, "creation_date": 1524917068, "post_id": 50075772, "comment_id": 87168722, "body": "What you&#39;re saying in the question doesn&#39;t make sense. Unlike in object-oriented languages like Java, data types don&#39;t &quot;implement&quot; functions in Haskell. You&#39;re going to need to be more specific, and not just assume that we&#39;ll get what you mean. Which function do you want to require? And why can&#39;t you just put it in the type class?"}, {"owner": {"reputation": 152, "user_id": 1935301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a80cd7bdb07f8b6d39385943c0f6fb4?s=128&d=identicon&r=PG", "display_name": "ryan91", "link": "https://stackoverflow.com/users/1935301/ryan91"}, "edited": false, "score": 0, "creation_date": 1524917191, "post_id": 50075772, "comment_id": 87168759, "body": "I&#39;m sorry I didn&#39;t assume you&#39;ll get what I mean. I thought I was clear. Let me try to rewrite it."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1525051617, "post_id": 50075772, "comment_id": 87201983, "body": "I don&#39;t see the problem with your solution?"}], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 1935301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a80cd7bdb07f8b6d39385943c0f6fb4?s=128&d=identicon&r=PG", "display_name": "ryan91", "link": "https://stackoverflow.com/users/1935301/ryan91"}, "edited": false, "score": 0, "creation_date": 1524921572, "post_id": 50076839, "comment_id": 87170097, "body": "So first of all: Yes of course, this makes a ton of sense. Just one more question: How is D1 a valid argument for (String -&gt; x)? I&#39;ve not seen this before, but this is some basic stuff I&#39;m assuming?"}, {"owner": {"reputation": 912, "user_id": 612169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df2c9fb8dc016dcdce04b633ba9a6b4?s=128&d=identicon&r=PG", "display_name": "Gabriel Garcia", "link": "https://stackoverflow.com/users/612169/gabriel-garcia"}, "edited": false, "score": 1, "creation_date": 1524923059, "post_id": 50076839, "comment_id": 87170502, "body": "A constructor &#39;C&#39; with parameters &#39;P_0&#39;, &#39;P_1&#39;, etc. for a data type &#39;T&#39; has type: <code>C :: P_0 -&gt; P_1 -&gt; ... -&gt; T</code>. Here, you have a constructor &#39;D1&#39; with parameter &#39;String&#39; for the data type &#39;D1&#39;, so its type is <code>D1 :: String -&gt; D1</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1524920613, "creation_date": 1524920613, "answer_id": 50076839, "question_id": 50075772, "link": "https://stackoverflow.com/questions/50075772/guararantee-an-instance-to-have-a-certain-function/50076839#50076839", "title": "Guararantee an instance to have a certain function", "body": "<p>I don't think it's sensible to introduce an extra class here. Why not just use a simple higher-order helper function:</p>\n\n<pre><code>createUsingDefault :: x -&gt; (String -&gt; x) -&gt; String -&gt; x\ncreateUsingDefault def _ \"\" = def\ncreateUsingDefault _ constr s = constr s\n\ninstance AClass D1 where\n create = createUsingDefault (D1 \"D1Default\") D1\ninstance AClass D2 where\n create = createUsingDefault (D2 \"D2Default\") D2\n</code></pre>\n\n<p>Or even</p>\n\n<pre><code>createUsingDefault :: String -&gt; (String -&gt; x) -&gt; String -&gt; x\ncreateUsingDefault def constr \"\" = constr $ def++\"Default\"\ncreateUsingDefault _ constr s = constr s\n\ninstance AClass D1 where\n create = createUsingDefault \"D1\" D1\ninstance AClass D2 where\n create = createUsingDefault \"D2\" D2\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 1935301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a80cd7bdb07f8b6d39385943c0f6fb4?s=128&d=identicon&r=PG", "display_name": "ryan91", "link": "https://stackoverflow.com/users/1935301/ryan91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 50076839, "answer_count": 1, "score": -1, "last_activity_date": 1524920613, "creation_date": 1524913062, "last_edit_date": 1524918590, "question_id": 50075772, "link": "https://stackoverflow.com/questions/50075772/guararantee-an-instance-to-have-a-certain-function", "title": "Guararantee an instance to have a certain function", "body": "<p>My question is: How is it possible when declaring an instance to ensure that the data I'm declaring the instance for is guaranteed to implement a specific function?</p>\n\n<p>Here's an example</p>\n\n<pre><code>   class AClass x where\n     create :: String -&gt; x\n\n   data D1 = D1 { d1 :: String }\n\n   data D2 = D2 { d2 :: String }\n\n   instance AClass D1 where\n     create s = if s == [] then D1 \"D1Default\" else D1 s\n\n   instance AClass D2 where\n     create s = if s == [] then D2 \"D2Default\" else D2 s\n</code></pre>\n\n<p>Now let's say in a real example this function is more complex than here but the same for all instances except for the default and the custom constructor.</p>\n\n<p>So what I would like to be able to write is something like this:</p>\n\n<pre><code>    class AClass x where\n      create :: String -&gt; x\n\n    data D1 = D1 { d1 :: String }\n\n    data D2 = D2 { d2 :: String }\n\n    class MyClass x where\n      myDefault :: x\n      myCustom :: String -&gt; x\n\n    instance (MyClass x) =&gt; AClass MyClass where\n      create s = if s == [] then myDefault else myCustom s\n</code></pre>\n\n<p>Now I'm aware that this code has a bunch of problems. It should only demonstrate what I'm trying to do.</p>\n\n<p>I also found this question (<a href=\"https://stackoverflow.com/questions/3213490/how-do-i-write-if-typeclass-a-then-a-is-also-an-instance-of-b-by-this-definit\">How do I write, &quot;if typeclass a, then a is also an instance of b by this definition.&quot;</a>) and I feel like it might provide a solution to my problem but I couldn't quite match its solution to what I'm looking for.</p>\n\n<p>---- EDIT ----</p>\n\n<p>So since the question seems to be confusing I'll try to put it differently:</p>\n\n<p>Assume you have a library that uses a class <em>C</em>. You want to create multiple instances <em>I1</em>, ..., <em>In</em> for this class. These instances all have a function <em>f</em> whose implementation is almost identical for each <em>Ii</em> except for one string. Implmenting about 20 lines of code for each <em>f</em> results in a lot of code duplication which is what you're trying to avoid. So the question becomes: How do you create a single instance in a generic way so you then later only have to say \"<em>I1</em> uses string 'Foo', \"<em>I2</em> uses string 'Bar'\" etc.?</p>\n\n<p>I understand that this might be a bit vague, but I really don't know how else to describe my problem. I thought I was being clear in the upper paragraph.</p>\n"}, {"tags": ["haskell", "gadt"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1524910093, "post_id": 50075227, "comment_id": 87166858, "body": "What about <code>data Thing a where Foo :: String -&gt; Thing a ...</code>? Or you could use <code>DataKinds</code> to restrict it a bit: <code>data ThingType = A | B; data Thing (a :: ThingType) where Foo :: String -&gt; Thing a ...</code>. Do those fit with your use case?"}, {"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1524910717, "post_id": 50075227, "comment_id": 87167039, "body": "@DavidYoung Ohh, that&#39;s an interesting solution. I haven&#39;t played around much with <code>DataKinds</code>. I do have other types (updated question to add a <code>Thing C</code>) which I don&#39;t want to part of this &quot;union,&quot; so I don&#39;t think the first would work. But if I did <code>data AOrB = A | B; data C</code> would there be a way with <code>DataKinds</code> to restrict only the type for the <code>Foo</code> constructor?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524911221, "post_id": 50075227, "comment_id": 87167167, "body": "You can use <code>Foo :: String -&gt; AorB t -&gt; Thing t</code> where <code>AorB t</code> is a suitable GADT, only populated by <code>JustA :: AorB A</code> and <code>Just B :: AorB B</code>. It&#39;s not terribly convenient, and has some memory overhead, but it could work well enough. You could even use a type class to keep that witness &quot;implicit&quot;, in principle. The overhead is still there, but one does not have to pass it explicitly."}, {"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524911597, "post_id": 50075227, "comment_id": 87167253, "body": "@chi Thanks! So then for example, I&#39;d have to do <code>Bar :: Float -&gt; Thing JustA</code>? And for <code>Bah</code>, I&#39;d keep the <code>data C</code> and have it be <code>Bah :: Char -&gt; Thing C</code>? I&#39;m not too bothered by the memory overhead, but I am a little irked that this would require pattern matching on an additional useless value. Can you expand on how this can be done with type classes? It&#39;s not immediately obvious to me."}, {"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524912892, "post_id": 50075227, "comment_id": 87167631, "body": "@chi Also, having tried this out, it looks like this just pushes the problem into the <code>AorB</code> value. How do I instantiate a <code>Foo</code>? <code>Foo &quot;abc&quot; JustA</code> can only be used in <code>Thing (AorB A)</code> contexts. It seems like I&#39;d still need a &quot;runtime cast&quot;-like thing to change <code>Foo &quot;abc&quot; JustA</code> into a <code>Foo &quot;abc&quot; JustB</code> to be able to pass it into a function expecting <code>Thing (AorB B)</code> (and this has the aforementioned problem of having too broad of a type <code>Thing a -&gt; Thing (AorB A)</code> which requires a <code>Maybe</code>). Is there a way to avoid this?"}, {"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524913109, "post_id": 50075227, "comment_id": 87167683, "body": "@chi On second though, I guess you can do <code>Foo &quot;abc&quot; undefined</code>, but that feels dirty. The possibility of accidentally forcing the undefined value is there. Would doing this with type classes prevent this?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524915173, "post_id": 50075227, "comment_id": 87168232, "body": "No, <code>Bar</code> is still <code>Float -&gt; Thing A</code>. There is no <code>Thing AorB</code> type in this approach. If you need that you need yet another wrapper type, or a typeclass. E.g. suppose we have <code>class IsAorB t where proof :: AorB t</code>. Then we can use <code>Foo :: IsAorB t =&gt; String -&gt; Thing t</code>. If you want a function consuming only <code>Foo</code>s. You can write <code>func :: forall t. IsAorB t =&gt; Thing t -&gt; ... ; func x = case proof @ t where JustA -&gt; ... ; JustB -&gt; ...</code> or something similar. I&#39;m not claiming that this is an ideal approach. I do not have a very neat and simple solution to this problem."}, {"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 0, "creation_date": 1524918795, "post_id": 50075227, "comment_id": 87169247, "body": "Ah indeed that does work! Although it feels a bit forced having to do that typeclass dance, this does have the benefit that you can work with the constructors and GADT as if it were declared in the usual manner (without this trickery). This is sufficient for my use case. If you&#39;d like to write this up, I&#39;ll gladly mark as solved. :)"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1524992713, "last_edit_date": 1524992713, "creation_date": 1524992112, "answer_id": 50084899, "question_id": 50075227, "link": "https://stackoverflow.com/questions/50075227/union-in-gadt-type-variable/50084899#50084899", "title": "Union in GADT type variable", "body": "<p>A possible solution is as follows, even I do not consider it elegant.</p>\n\n<p>We first define a GADT and a type class for being \"A or B\":</p>\n\n<pre><code>{-# LANGUAGE DataKinds, KindSignatures, GADTs, EmptyCase,\n             ScopedTypeVariables #-}\n{-# OPTIONS -Wall #-}\n\ndata Sort = A | B | C | D\n\ndata AorB (s :: Sort) where\n  IsA :: AorB 'A\n  IsB :: AorB 'B\n\nclass IsAorB (s :: Sort) where\n  aorb :: AorB s\n\ninstance IsAorB 'A where aorb = IsA\ninstance IsAorB 'B where aorb = IsB\n</code></pre>\n\n<p>Then we exploit our type class in our type. This will cause <code>Foo</code> to require some more space, since it needs to store the typeclass dictionary at runtime. It is a small amount of overhead, but it is still unfortunate. On the other hand, this will also make it possible to discern, at runtime, whether the <code>s</code> used in <code>Foo</code> is actually <code>A</code> or <code>B</code>.</p>\n\n<pre><code>data Thing (s :: Sort) where\n  Foo :: IsAorB s =&gt; String -&gt; Thing s \n  Bar :: Float -&gt; Thing 'A\n  Baz :: Int -&gt; Thing 'B\n  Bah :: Char -&gt; Thing 'C\n</code></pre>\n\n<p>Some tests:</p>\n\n<pre><code>processThingA :: Thing 'A -&gt; String\nprocessThingA (Foo x) = x\nprocessThingA (Bar x) = show x\n\nprocessThingB :: Thing 'B -&gt; Int\nprocessThingB (Foo _) = 0\nprocessThingB (Baz i) = i\n</code></pre>\n\n<p>A main downside is that we need to convince the exhaustiveness checker that our pattern matching is OK.</p>\n\n<pre><code>-- This unfortunately will give a spurious warning\nprocessThingC :: Thing 'C -&gt; Float\nprocessThingC (Bah _) = 42.2\n-- To silence the warning we need to prove that this is indeed impossible\nprocessThingC (Foo _) = case aorb :: AorB 'C of {}\n\nprocessThingAorB :: forall s. IsAorB s =&gt; Thing s -&gt; String\nprocessThingAorB (Foo x) = x\nprocessThingAorB (Bar x) = \"Bar \" ++ show x\nprocessThingAorB (Baz x) = \"Baz \" ++ show x\n-- Again, to silence the warnings\nprocessThingAorB (Bah _) = case aorb :: AorB 'C of {}\n\ntest :: ()\ntest = ()\n  where\n  _ = processThingA $ Foo \"Hello\"\n  _ = processThingB $ Foo \"World\"\n  _ = processThingA $ Bar 3.14\n  _ = processThingB $ Baz 42\n  _ = processThingC $ Bah '\\n'\n</code></pre>\n\n<p>This technique does not scale very well. We need a custom GADT and typeclass for any constructor of <code>Thing</code> which can generate any tag in some \"union\". This can still be OK. To check exhaustiveness, we would need to exploit all these classes.</p>\n\n<p>I think this should require a linear amount of boilerplate, but it still significant.</p>\n\n<p>Perhaps using singletons is simpler, in the general case, to store the value of <code>s</code> in the constructor <code>Foo</code>, and avoid all the custom GADTs and typeclasses.</p>\n"}], "owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 50084899, "answer_count": 1, "score": 2, "last_activity_date": 1524992713, "creation_date": 1524909499, "last_edit_date": 1524911057, "question_id": 50075227, "link": "https://stackoverflow.com/questions/50075227/union-in-gadt-type-variable", "title": "Union in GADT type variable", "body": "<p>I have a GADT constructor representing the same idea, but I need two of them because the type is flexible depending on context. See this contrived example:</p>\n\n<pre><code>data A\ndata B\ndata C\n\ndata Thing a where\n  AFoo :: String -&gt; Thing A\n  Bar  :: Float -&gt; Thing A\n  BFoo :: String -&gt; Thing B\n  Baz  :: Int -&gt; Thing B\n  Bah  :: Char -&gt; Thing C\n</code></pre>\n\n<p><code>AFoo</code> and <code>BFoo</code> represent the same underlying data concept: some data with a string. But in this context, it's more than that. Ideally <code>AFoo</code> and <code>BFoo</code> would be merged into <code>Foo</code>, because they represent exactly the same thing, but I need one that types like <code>Thing A</code> and one that types like <code>Thing B</code>. As mentioned before, some contexts in which a <code>Foo</code> can be used require a <code>Thing A</code> and some require a <code>Thing B</code>, so to satisfy the type system one constructor needs to exist for each.</p>\n\n<p>I could of course write a function that \"casts\" to the desired type by switching the constructor if needed:</p>\n\n<pre><code>fooAsThingA :: Thing a -&gt; Maybe (Thing A)\nfooAsThingA t@(AFoo _) = Just t\nfooAsThingA (BFoo s) = Just $ AFoo s\nfooAsThingA _ = Nothing\n</code></pre>\n\n<p>(And similarly for <code>fooAsThingB</code>)</p>\n\n<p>But this is ugly, because it requires a <code>Maybe</code> that I have to propagate because not all <code>Thing B</code>s can become <code>Thing A</code>s (in fact, only <code>BFoo</code> can).</p>\n\n<p>Ideally, I'd like to write:</p>\n\n<pre><code>data A\ndata B\ndata C\n\ndata Thing a where\n  Foo :: String -&gt; Thing ??\n  Bar :: Float -&gt; Thing A\n  Baz :: Int -&gt; Thing B\n  Bah :: Char -&gt; Thing C\n</code></pre>\n\n<p>But I'm unclear on what I'd put in place of the <code>??</code>. Presumably it's some way of representing the union of <code>A</code> and <code>B</code> (and perhaps this requires changing the types of the other constructors for this GADT, but that's fine).</p>\n\n<p>Just to be clear, if the above were valid, I'd expect given the following functions:</p>\n\n<pre><code>processThingA :: Thing A -&gt; String\nprocessThingB :: Thing B -&gt; Int\nprocessThingC :: Thing C -&gt; Float\n</code></pre>\n\n<p>Then, I'd be able to do all of the following:</p>\n\n<pre><code>processThingA $ Foo \"Hello\"\nprocessThingB $ Foo \"World\"\n\nprocessThingA $ Bar 3.14\nprocessThingB $ Baz 42\n\nprocessThingC $ Bah '\\n'\n</code></pre>\n\n<p>tl;dr In the first snippet, is it possible to merge <code>AFoo</code> and <code>BFoo</code> into a <code>Foo</code> that types as both <code>Thing A</code> and <code>Thing B</code>?</p>\n\n<p><strong>edit:</strong> Note: there are other <code>EmptyDataDecls</code> than <code>A</code> and <code>B</code> that I use for <code>Thing a</code>. I added <code>C</code> as an example.</p>\n"}, {"tags": ["haskell", "monad-transformers", "purescript", "category-theory", "profunctor"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1524939930, "post_id": 50075036, "comment_id": 87175454, "body": "Well... at the very least functors and monads are quite restricted, in that they are only endofunctors on Hask.  There are other categories, even in haskell, worth considering, but our <code>Monad</code> does not capture them."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1524989544, "post_id": 50075036, "comment_id": 87184906, "body": "I see. Although I know endofunctors map a category to itself, I have a very limited view on what it prevents us from doing (is that what Conal Eliott&#39;s paper &quot;Compiling to categories&quot; is all about?). I guess my question is, even with that limitation, do Haskell functors keep their algebraic properties?"}, {"owner": {"reputation": 9111, "user_id": 90088, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c018f213204496b4bbf481e7c8e6c15c?s=128&d=identicon&r=PG", "display_name": "Bartosz Milewski", "link": "https://stackoverflow.com/users/90088/bartosz-milewski"}, "edited": false, "score": 2, "creation_date": 1525025474, "post_id": 50075036, "comment_id": 87195564, "body": "One limitation is that profunctor laws cannot be expressed in Haskell. A profunctor maps pairs of morphisms -- in Haskell that&#39;s the purpose of dimap -- and it should map identity morphisms to identities, and composition to composition. You can check these laws by hand using equational reasoning.   Then there is the fact that profunctors form a category. Natural transformations between profunctors may be approximated by polymorphic functions but, in Haskell, they are restricted by parametricity. Optics, in particular, require polymorphism over profunctor categories with various constraints."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1525158191, "post_id": 50075036, "comment_id": 87242250, "body": "Thank you. I\u2019ve read your \u201cprofunctors as relations\u201d post, it provided good food for thought; I\u2019ll need to re-read a few times, as some statements still escape me. Especially since, if they form a category, I should be able to write an instance of Category for any Profunctor. I\u2019ll try to write one and see where that leads me."}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1551204077, "post_id": 50075036, "comment_id": 96552083, "body": "@RegisKuckaertz profunctors form a category, where composition is <a href=\"https://hackage.haskell.org/package/profunctors-5.3/docs/Data-Profunctor-Composition.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/profunctors-5.3/docs/&hellip;</a>; <b>not</b> every <code>Profunctor</code> is a <code>Category</code> (many  are though, but e.g. <code>Tagged</code> cannot be, there is no <code>id</code>). Various classes -- like <code>Strong</code> -- form sub-categories, there is e.g. <code>(Strong p, Strong q) =&gt; Strong (Procompose p q)</code> instance: profunctor optics use these sub-category classes to form various optics."}], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 3, "answer_count": 0, "score": 14, "last_activity_date": 1559519148, "creation_date": 1524908119, "last_edit_date": 1559519148, "question_id": 50075036, "link": "https://stackoverflow.com/questions/50075036/what-properties-of-profunctors-do-not-make-it-into-haskell-purescript", "title": "What properties of profunctors do not make it into Haskell/PureScript?", "body": "<p>In their paper on <a href=\"https://arxiv.org/abs/1703.10857\" rel=\"noreferrer\">profunctor optics</a>, Pickering et al. state that</p>\n\n<blockquote>\n  <p>The term \u2018profunctor\u2019 comes from category theory, although much of the categorical structure gets lost in translation.</p>\n</blockquote>\n\n<p>That seems odd and kind of unique to me, as other algebraic structures I know of (pairs, monoids, functors, categories, etc.) \"do not seem\" to suffer the same fate, in languages like Haskell and PureScript \u2013 with quotes because I'm happy to be proven wrong.</p>\n\n<p>A while ago, I played a bit with the family of profunctors and found them very tractable, especially in the context of optics. My interest got picked again after seeing them come up <a href=\"https://www.youtube.com/watch?v=Bxcz23GOJqc\" rel=\"noreferrer\">in the context of monad transformers</a>. I need to rewatch this a couple of times as I don't get the details, but on principle it is perfectly clear. So I can't help wondering:</p>\n\n<ul>\n<li>what are those properties? why don't they materialise in the language?</li>\n<li>what effort would be necessary to bring them in, if at all possible?</li>\n<li>what would be the benefits of doing so? In particular, could they help solve the issues Ed mentions at the end of his talk?</li>\n</ul>\n"}, {"tags": ["haskell", "either", "polymorphic-functions"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524907805, "post_id": 50074977, "comment_id": 87166225, "body": "What&#39;s not working?"}, {"owner": {"reputation": 3863, "user_id": 7252805, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7x3Z0.png?s=128&g=1", "display_name": "sheldonzy", "link": "https://stackoverflow.com/users/7252805/sheldonzy"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524907979, "post_id": 50074977, "comment_id": 87166268, "body": "@WillemVanOnsem oops I added the error"}, {"owner": {"reputation": 29209, "user_id": 495796, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/86637c99f25d60157aa0f2e7eab90148?s=128&d=identicon&r=PG", "display_name": "Robin Green", "link": "https://stackoverflow.com/users/495796/robin-green"}, "edited": false, "score": 2, "creation_date": 1524908332, "post_id": 50074977, "comment_id": 87166355, "body": "The problem is your type synonyms are not polymorphic. What are you trying to do with this code? It&#39;s unclear."}, {"owner": {"reputation": 6190, "user_id": 3523446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268d77718b0875284cdfff02b4ec54b5?s=128&d=identicon&r=PG&f=1", "display_name": "qxg", "link": "https://stackoverflow.com/users/3523446/qxg"}, "edited": false, "score": 0, "creation_date": 1524908833, "post_id": 50074977, "comment_id": 87166479, "body": "Check <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">learnyouahaskell.com/making-our-own-types-and-typeclasses</a> -&gt; Kinds and some type-foo"}], "answers": [{"comments": [{"owner": {"reputation": 3863, "user_id": 7252805, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7x3Z0.png?s=128&g=1", "display_name": "sheldonzy", "link": "https://stackoverflow.com/users/7252805/sheldonzy"}, "edited": false, "score": 0, "creation_date": 1524909759, "post_id": 50075077, "comment_id": 87166769, "body": "Thanks. I&#39;m having a hard time understanding the use of <code>liftM2</code> in your implementation. Any chance you can say how would you implement it without the use of <code>liftM2</code>?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 3863, "user_id": 7252805, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7x3Z0.png?s=128&g=1", "display_name": "sheldonzy", "link": "https://stackoverflow.com/users/7252805/sheldonzy"}, "edited": false, "score": 0, "creation_date": 1525052346, "post_id": 50075077, "comment_id": 87202092, "body": "@sheldonzy The same way you did in your attempt. liftM2 just happens to implement the last 3 cases for you."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1524925022, "last_edit_date": 1524925022, "creation_date": 1524908368, "answer_id": 50075077, "question_id": 50074977, "link": "https://stackoverflow.com/questions/50074977/haskell-polymorphic-function-using-either-left-right/50075077#50075077", "title": "Haskell polymorphic function Using Either Left Right", "body": "<p>The problem is that you define your <code>EvalResult</code> type as:</p>\n\n<pre><code>type EvalResult = Either EvalError Value\n</code></pre>\n\n<p>since <code>Either</code> is a <em>type</em> constructor, that takes two types, this means that you have constructed a type now (without any type parameters). If you write a function with type signature <code>(a -&gt; b -&gt; c) -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c</code>, then Haskell thus will eventually have to construct types <code>EvalResult a ~ Either EvalError Value a</code>, and since <code>Either</code> only takes two type parameters, this makes no sense.</p>\n\n<p>My guess is that you want to define</p>\n\n<pre><code>type EvalResult <b>a</b> = Either EvalError <b>a</b></code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>type EvalResult = Either EvalError</code></pre>\n\n<p>Now <code>EvakResult</code> thus acts like a type constructor that can take one type parameter, and then the function indeed works over types.</p>\n\n<p>We can make the implementation more compact by writing:</p>\n\n<pre><code>import Control.Monad(liftM2)\n\nevalResultOp :: (a -&gt; b -&gt; c) -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c\nevalResultOp f (Left a) (Left b) = Left (a ++ b)\nevalResultOp f x y = liftM2 f x y\n</code></pre>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Monad.html#v:liftM2\" rel=\"nofollow noreferrer\"><strong><code>liftM2 :: Monad m =&gt; (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c</code></strong></a> is a function that works over monadic types <code>m</code>. <code>Either a</code> is a monadic type, it is defined as:</p>\n\n<blockquote>\n<pre><code>instance Monad (Either a) where\n    return = Right\n    (&gt;&gt;=) (Right x) f = f x\n    (&gt;&gt;=) (Left l) _ = Left l\n</code></pre>\n</blockquote>\n\n<p><code>liftM2</code> is implemented as:</p>\n\n<blockquote>\n<pre><code>liftM2 :: Monad m =&gt; (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c\nliftM2 f xm ym = do\n    x &lt;- mx\n    y &lt;- my\n    return (f x y)\n</code></pre>\n</blockquote>\n\n<p>which is syntactical sugar for:</p>\n\n<pre><code>liftM2 :: Monad m =&gt; (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c\nliftM2 f xm ym = mx &gt;&gt;= (\\x -&gt; my &gt;&gt;= \\y -&gt; return (f x y))\n</code></pre>\n\n<p>So basically we evaluate <code>mx &gt;&gt;= (...)</code> by checking if <code>mx</code> is a <code>Right</code>, if it is a <code>Left</code>, we return the content of the <code>Left</code>. Since we already handled the case with two <code>Left</code>s, that case is no longer possible, so we know that the second <code>EvalResult</code> is a <code>Right</code>, in that case we thus return the first <code>Left</code>. In case <code>mx</code> is a <code>Right x</code>, we now inspect <code>my &gt;&gt;= (..)</code> and check the state of <code>my</code>. If <code>my</code> is a <code>Left</code>, we again return that <code>Left</code>, otherwise, we return the <code>return (f x y)</code>, since <code>return</code> for an <code>Either a</code> monad, is actually <code>Right</code>, we thus wrap the content of <code>f x y</code> in the <code>Right</code> data constructor.</p>\n"}], "owner": {"reputation": 3863, "user_id": 7252805, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7x3Z0.png?s=128&g=1", "display_name": "sheldonzy", "link": "https://stackoverflow.com/users/7252805/sheldonzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 50075077, "answer_count": 1, "score": 1, "last_activity_date": 1524925022, "creation_date": 1524907720, "last_edit_date": 1524907904, "question_id": 50074977, "link": "https://stackoverflow.com/questions/50074977/haskell-polymorphic-function-using-either-left-right", "title": "Haskell polymorphic function Using Either Left Right", "body": "<p>I'm new to Haskell. I have the types:</p>\n\n<pre><code>type Variable = String\ntype Value = Float\ntype EvalError = [Variable]\ntype EvalResult = Either EvalError Value\n</code></pre>\n\n<p>And I want to create a function that I'll use a function to use it on 2 <code>EvalResult</code> types, and get a <code>EvalResult</code> accordingly.\nIf I get 2 Value types, I want to use the function on them (sum/sub for example), and If I'll get EvalError I want to return the EvalError.</p>\n\n<p>What I did:</p>\n\n<pre><code>evalResultOp :: (a -&gt; b -&gt; c) -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c\nevalResultOp f (Left a) (Left b) = Left (a ++ b)\nevalResultOp f (Left a) (Right b) = Left a\nevalResultOp f (Right a) (Left b) = Left b\nevalResultOp f (Right a) (Right b) = Right (f a b)\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>hs3.hs:46:34: error:\n    \u2022 Expecting one fewer arguments to \u2018EvalResult\u2019\n      Expected kind \u2018* -&gt; *\u2019, but \u2018EvalResult\u2019 has kind \u2018*\u2019\n    \u2022 In the type signature:\n        evalResultOp :: (a -&gt; b -&gt; c)\n                        -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c\n   |\n46 | evalResultOp :: (a -&gt; b -&gt; c) -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c    |                                  ^^^^^^^^^^^^\n\n    hs3.hs:46:50: error:\n        \u2022 Expecting one fewer arguments to \u2018EvalResult\u2019\n          Expected kind \u2018* -&gt; *\u2019, but \u2018EvalResult\u2019 has kind \u2018*\u2019\n        \u2022 In the type signature:\n            evalResultOp :: (a -&gt; b -&gt; c)\n                            -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c\n       |\n    46 | evalResultOp :: (a -&gt; b -&gt; c) -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c    |                                                  ^^^^^^^^^^^^\n\n    hs3.hs:46:66: error:\n        \u2022 Expecting one fewer arguments to \u2018EvalResult\u2019\n          Expected kind \u2018* -&gt; *\u2019, but \u2018EvalResult\u2019 has kind \u2018*\u2019\n        \u2022 In the type signature:\n            evalResultOp :: (a -&gt; b -&gt; c)\n                            -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c\n       |\n    46 | evalResultOp :: (a -&gt; b -&gt; c) -&gt; EvalResult a -&gt; EvalResult b -&gt; EvalResult c    | \n</code></pre>\n"}, {"tags": ["haskell", "algebraic-data-types"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524923500, "post_id": 50074281, "comment_id": 87170617, "body": "A small word of advice: don&#39;t do those ASCII-art comments over every definition. Not only are they useless (the names are there in the code already), they use up more of your time and add no extra infomation to your code."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1524903177, "creation_date": 1524903177, "answer_id": 50074377, "question_id": 50074281, "link": "https://stackoverflow.com/questions/50074281/haskell-adt-choosing-the-right-type/50074377#50074377", "title": "haskell ADT choosing the right type", "body": "<p>This type</p>\n\n<pre><code>data MyTree\n   = MyTreeInt\n   | MyTreeString\n</code></pre>\n\n<p>is completely unrelated to types <code>MyTreeInt</code> and <code>MyTreeString</code>. Above, these names are used as data constructor names, not as type names, so they do not refer to the other tree types. You might instead want something like</p>\n\n<pre><code>data MyTree\n   = MyTreeInt MyTreeInt\n   | MyTreeString MyTreeString\n</code></pre>\n\n<p>where, after the constructor name, we also include the type of the tree.</p>\n\n<p>Then, we can write</p>\n\n<pre><code>toString2 :: MyTree -&gt; String\ntoString2 (MyTreeInt    (MyTreeIntAtom      i))     = \"A\"\ntoString2 (MyTreeInt    (MyTreeIntPlus      t1 t2)) = \"B\"\ntoString2 (MyTreeString (MyTreeStringAtom   i))     = \"C\"\ntoString2 (MyTreeString (MyTreeStringConcat t1 t2)) = \"D\"\n</code></pre>\n\n<p>We can also reuse auxiliary functions, e.g.</p>\n\n<pre><code>toString2 :: MyTree -&gt; String\ntoString2 (MyTreeInt    t) = treeIntToString t     -- this is toString1\ntoString2 (MyTreeString t) = treeStringToString t  -- this has to be defined\n</code></pre>\n"}], "owner": {"reputation": 3212, "user_id": 3357352, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/nfb7n.jpg?s=128&g=1", "display_name": "OrenIshShalom", "link": "https://stackoverflow.com/users/3357352/orenishshalom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 50074377, "answer_count": 1, "score": 1, "last_activity_date": 1524903177, "creation_date": 1524902483, "question_id": 50074281, "link": "https://stackoverflow.com/questions/50074281/haskell-adt-choosing-the-right-type", "title": "haskell ADT choosing the right type", "body": "<p>Choosing the right type of <strong>MyTreeInt</strong> is <strong>OK</strong> with <strong>toString1</strong> in the following code:</p>\n\n<pre><code>-- ***************\n-- * MODULE Main *\n-- ***************\nmodule Main( main ) where\n\n-- **********\n-- * MyTree *\n-- **********\ndata MyTree\n   = MyTreeInt\n   | MyTreeString\n\n-- *************\n-- * MyTreeInt *\n-- *************\ndata MyTreeInt\n   = MyTreeIntAtom  Int   \n   | MyTreeIntPlus  MyTreeInt MyTreeInt\n   | MyTreeIntMinus MyTreeInt MyTreeInt\n\n-- ****************\n-- * MyTreeString *\n-- ****************\ndata MyTreeString\n   = MyTreeStringAtom   String\n   | MyTreeStringConcat String String\n\n-- *************\n-- * toString1 *\n-- *************\ntoString1 :: MyTreeInt -&gt; String\ntoString1 (MyTreeIntAtom     i) = \"PPPPP\"\ntoString1 (MyTreeIntPlus t1 t2) = \"QQQQQ\"\n\n-- *************\n-- * toString2 *\n-- *************\n-- toString2 :: MyTree -&gt; String\n-- toString2 (MyTreeIntAtom     i) = \"RRRRR\"\n-- toString2 (MyTreeIntPlus t1 t2) = \"SSSSS\"\n\n-- ********\n-- * main *\n-- ********\nmain :: IO ()\nmain = do putStrLn (toString1 (MyTreeIntAtom 8))\n</code></pre>\n\n<p>However, when the type hierarchy is greater than 1,\nlike <strong>MyTree</strong>, is it possible to write <strong>toString2</strong> to\nhandle <strong>all</strong> int and string trees?\nThanks in advance </p>\n"}, {"tags": ["haskell", "fold", "foldleft"], "comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524896511, "post_id": 50073129, "comment_id": 87163487, "body": "I didn&#39;t try, but maybe <code>foldl (+) 0 (list x)</code> ? Otherwise <code>factorial(2*n+1)</code> is an integer and the division is not valid."}, {"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524896804, "post_id": 50073129, "comment_id": 87163546, "body": "Wow. It worked! Haha, I can&#39;t believe it&#39;s that simple. Thank you! :)"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1524898785, "post_id": 50073129, "comment_id": 87163958, "body": "Why not use <code>sum</code> ?"}, {"owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "edited": false, "score": 0, "creation_date": 1524898831, "post_id": 50073129, "comment_id": 87163974, "body": "This is for class! We&#39;re required to use foldl :)"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1524908791, "post_id": 50073129, "comment_id": 87166463, "body": "If you can afford using <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:foldl1\" rel=\"nofollow noreferrer\"><code>foldl1</code></a> then you don&#39;t even need the zero value."}], "owner": {"reputation": 391, "user_id": 7157651, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/864161088d214f8a54c58acd9a07f68f?s=128&d=identicon&r=PG&f=1", "display_name": "zuzu", "link": "https://stackoverflow.com/users/7157651/zuzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 560, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524896829, "creation_date": 1524892664, "last_edit_date": 1524896829, "question_id": 50073129, "link": "https://stackoverflow.com/questions/50073129/summation-of-a-list-using-foldl", "title": "Summation of a List Using Foldl", "body": "<p>I'm new to Haskell and I'm trying to implement the sine approximation using MacLaurin's series using foldl on Haskell. I've already generated the list, and now I'm trying to get the summation using fold.</p>\n\n<p>This is my code. I know I'm doing something wrong with the sin function, but I'm not sure what to do. I also have to pass x. If sin receives x as input, list will use the same value of x. </p>\n\n<pre><code>factorial n = product [1..n]\nlist x = [-1**n * ((x**(2*n+1))/factorial(2*n+1)) | n &lt;- [0..29] ]\nsin x = foldl (+) 0 list x \n</code></pre>\n\n<p>SOLVED: \nCorrect solution:</p>\n\n<pre><code>factorial n = product [1..n]\nlist x = [(-1)**n * ((x**(2*n+1))/factorial(2*n+1)) | n &lt;- [0..29] ]\nsine x = foldl (+) 0 (list x)\n</code></pre>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1524918518, "post_id": 50073525, "comment_id": 87169175, "body": "Yes; I recognized this  for the first error - and tried this, but couldn&#39;t get it to work: instance FromJSON Field where   parseJSON = genericParseJSON defaultOptions {                 fieldLabelModifier = Prelude.drop 1"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1524896287, "creation_date": 1524896287, "answer_id": 50073525, "question_id": 50072771, "link": "https://stackoverflow.com/questions/50072771/haskell-json-parsing-with-aeson/50073525#50073525", "title": "Haskell JSON parsing with Aeson", "body": "<p>Field has an <code>ftype</code> field, so AESON is trying to find ftype in the JSON but can't (as it contains ftype). I understand you can't name a field <code>type</code> in Haskell so you need to find a way make AESON use a different name. You need to use template Haskell and set fieldLabelModifier accordingly. Alternatively, writing the insistence manually might be simpler.</p>\n"}, {"comments": [{"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1525179433, "post_id": 50080367, "comment_id": 87250956, "body": "Why can&#39;t Entry be a <i>data</i> structure, instead of a <i>type</i>?"}, {"owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "reply_to_user": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 1, "creation_date": 1525282400, "post_id": 50080367, "comment_id": 87299087, "body": "It can be as along as the data structure does not have field names.  I edited the answer to show that option."}, {"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1525353700, "post_id": 50080367, "comment_id": 87329932, "body": "Neat - thanks - but why can&#39;t it have field names, as long as it does not derive Generic?"}, {"owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "reply_to_user": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 1, "creation_date": 1525656197, "post_id": 50080367, "comment_id": 87429088, "body": "I should have said something along the lines of &quot;It can be a data structure.  I edited the answer to show one way to use a data structure.&quot;"}, {"owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "edited": false, "score": 0, "creation_date": 1525668703, "post_id": 50080367, "comment_id": 87431467, "body": "Thanks - but again, I found that adding field names won&#39;t work - why?"}], "tags": [], "owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "is_accepted": true, "score": 1, "last_activity_date": 1525282341, "last_edit_date": 1525282341, "creation_date": 1524944159, "answer_id": 50080367, "question_id": 50072771, "link": "https://stackoverflow.com/questions/50072771/haskell-json-parsing-with-aeson/50080367#50080367", "title": "Haskell JSON parsing with Aeson", "body": "<p>Three things prevent this from working as intended:</p>\n\n<ul>\n<li>The JSON data contains a field named \"type\" . A custom <code>FromJson</code> instance for the <code>Field</code> record type can handle this.</li>\n<li>The data in the <code>Entry</code> type is unnamed so it is better represented as either a <code>data</code> record without field names or a <code>tuple</code>. </li>\n<li>The <code>Float</code> representing wind gust is sometimes <code>null</code> so it should be a <code>Maybe Float</code></li>\n</ul>\n\n<p>The code below contains all of these modifications and parses your example JSON data :</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.ByteString.Lazy as BSL\nimport Data.Text (Text)\nimport Data.Aeson \nimport GHC.Generics\n\n-- Either this tuple definition of Entry or the data definition without\n-- names (commented out) will work.  \n\ntype Entry =             -- Data entries\n  ( Text     -- Observation Valid Time\n  , Text     -- Observation Valid Time UTC\n  , Float    -- Air Temperature[F] at 2m AGL\n  , Float    -- Wind Speed [kt]\n  , Maybe Float    -- Wind Gust [kt]\n  , Int      -- Wind Direction[deg]\n  ) \n\n-- data Entry =             -- Data entries\n--   Entry Text     -- Observation Valid Time\n--         Text     -- Observation Valid Time UTC\n--         Float    -- Air Temperature[F] at 2m AGL\n--         Float    -- Wind Speed [kt]\n--         (Maybe Float)    -- Wind Gust [kt]\n--         Int      -- Wind Direction[deg]\n--         deriving (Show,Generic)\n\n-- instance FromJSON Entry\n\ndata Field =             -- Schema Definition\n  Field {  ftype       :: String    -- \n        ,  name        :: String    -- \n        ,  description :: String    -- \n        } deriving (Show,Generic)\n\ninstance FromJSON Field where\n  parseJSON = withObject \"Field\" $ \\v -&gt; Field\n    &lt;$&gt; v .: \"type\"\n    &lt;*&gt; v .: \"name\"\n    &lt;*&gt; v .: \"description\"\n\ndata Record =\n  Record {  fields  :: [Field]     -- \n         ,  rows    :: [Entry]     -- data\n         } deriving (Show,Generic)\n\ninstance FromJSON Record\n\ngetJSON :: IO ByteString\ngetJSON = BSL.readFile \"json.txt\" \n\nmain :: IO()\nmain = do\n  -- Get JSON data and decode it\n  dat &lt;- (eitherDecode &lt;$&gt; getJSON) :: IO (Either String Record)\n  case dat of\n    Right parsed -&gt; print parsed\n    Left err -&gt; print err\n</code></pre>\n"}], "owner": {"reputation": 4173, "user_id": 593975, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f9550b19b4c3f1dc5b72ae7c4123d817?s=128&d=identicon&r=PG", "display_name": "guthrie", "link": "https://stackoverflow.com/users/593975/guthrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "accepted_answer_id": 50080367, "answer_count": 2, "score": 2, "last_activity_date": 1594621474, "creation_date": 1524888810, "last_edit_date": 1594621474, "question_id": 50072771, "link": "https://stackoverflow.com/questions/50072771/haskell-json-parsing-with-aeson", "title": "Haskell JSON parsing with Aeson", "body": "<p>I have a JSON data source which looks like this:</p>\n\n<pre><code>{ \"fields\": [\n{ \"type\": \"datetime\",\n  \"name\": \"Observation Valid\",\n  \"description\": \"Observation Valid Time\"},\n{ \"type\": \"datetime\",\n  \"name\": \"Observation Valid UTC\",\n  \"description\": \"Observation Valid Time UTC\"},\n{ \"type\": \"number\",\n  \"name\": \"Air Temperature[F]\",\n  \"description\": \"Air Temperature at 2m AGL\"},\n{ \"type\": \"number\",\n  \"name\": \"Wind Speed[kt]\",\n  \"description\": \"Wind Speed\"},\n{ \"type\": \"number\",\n  \"name\": \"Wind Gust[kt]\",\n  \"description\": \"Wind Gust\"},\n{ \"type\": \"number\", \"name\":\n  \"Wind Direction[deg]\",\n  \"description\": \"Wind Direction\"}\n  ],\n\"rows\": [\n[\"2018-04-22T00:10:00\", \"2018-04-22T05:10:00Z\", 50.0, 9.0, null, 50.0],\n[\"2018-04-22T00:15:00\", \"2018-04-22T05:15:00Z\", 50.0, 9.0, null, 60.0],\n[\"2018-04-22T00:20:00\", \"2018-04-22T05:20:00Z\", 50.0, 8.0, null, 60.0],\n[\"2018-04-22T00:30:00\", \"2018-04-22T05:30:00Z\", 50.0, 9.0, null, 60.0]\n]\n}\n\n            ( https://mesonet.agron.iastate.edu/json/obhistory.py?station=TVK&amp;network=AWOS&amp;date=2018-04-22 )\n</code></pre>\n\n<p>And tried several data descriptions, lastly this:</p>\n\n<pre><code>data Entry =             -- Data entries\n  Entry {  time      ::  Text     -- Observation Valid Time\n         , timeUTC   ::  Text     -- Observation Valid Time UTC\n         , airTemp   ::  Float    -- Air Temperature[F] at 2m AGL\n         , wind      ::  Float    -- Wind Speed [kt]\n         , gust      ::  Float    -- Wind Gust [kt]\n         , direction ::  Int      -- Wind Direction[deg]\n           } deriving (Show,Generic)\n\ndata Field =             -- Schema Definition\n  Field {  ftype       :: String     -- \n         , name        :: String     -- \n         , description :: String    -- \n           } deriving (Show,Generic)\n\ndata Record =\n  Record {  fields  :: [Field]     -- \n          , rows    :: [Entry]     -- data\n           } deriving (Show,Generic)\n\n-- Instances to convert our type to/from JSON.\ninstance FromJSON Entry\ninstance FromJSON Field\ninstance FromJSON Record\n\n-- Get JSON data and decode it\ndat &lt;- (eitherDecode &lt;$&gt; getJSON) :: IO (Either String Record)\n</code></pre>\n\n<p>which gives this error:\n    Error in $.fields[0]: key \"ftype\" not present</p>\n\n<p>The (first) error comes from the field definitions (which I don\u2019t use). In the JSON the Entry\u2019s are arrays of mixed types, but in the Haskell it is just a data structure, not an array \u2013 not sure how to reconcile these.</p>\n\n<p>No doubt a beginner error \u2013 but I haven\u2019t found any examples which seem to have this structure. Do I need to write a custom parser for this?</p>\n"}, {"tags": ["haskell", "graph-theory", "dsl", "typechecking"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1524887276, "post_id": 50072210, "comment_id": 87161959, "body": "By &quot;type&quot;, do you mean compile-time type? If so, they&#39;re going to need some sort of run-time residue. Maybe a GADT if the set of types is easy to enumerate, maybe using <code>Typeable</code> if the set of types is not easy to enumerate."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1524928308, "post_id": 50072210, "comment_id": 87171955, "body": "Would you be interested in a safe interface that uses unsafe features internally? What operations should your graph support? And are there any restrictions on the type of the nodes?"}, {"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1525314116, "post_id": 50072210, "comment_id": 87310162, "body": "@JoachimBreitner Yes, using unsafe features internally would be fine. Typeable or erasing phantom node/edge types would be preferred to something like unsafeCoerce, but if its neccessary and externally safe anything goes. Now that you ask, it might be sufficient operations to, once the graph is known to be correctly typed, convert it to a homogenous representation. Maybe a TH splice that checks a homogenous representation for correctness in this sense might fulfill all my needs, I will explore that path a bit."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1525360455, "post_id": 50072210, "comment_id": 87334705, "body": "I think one could have an implementation that stores nodes of type <code>Any</code>, exposes an interface using tagged types, uses <code>unsafeCoerce</code> internally, and maybe a higher rank type (like <code>runST</code>) to make sure nodes of different graphs are not confused.  But it would be helpful to see the your \u201cdream interface\u201d first."}], "answers": [{"comments": [{"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "edited": false, "score": 0, "creation_date": 1524910483, "post_id": 50075007, "comment_id": 87166976, "body": "This is a good dynamic solution. Accepting the condition that the graphs are static (say, in an EDSL for describing mechatronic systems or bond graphs), do you see any route to a statically checked solution?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "edited": false, "score": 0, "creation_date": 1524916056, "post_id": 50075007, "comment_id": 87168477, "body": "@DougMcClean: Could you explain a bit more about your use case &amp; what operations you need? I\u2019m playing with a solution like <code>data Graph (ns :: [(Nat, *)]) (es :: [(Nat, Nat)]) = Graph (Nodes ns) (Edges es)</code> where the whole graph structure is encoded in the type and <code>Nodes</code> &amp; <code>Edges</code> are type families that give you fields for runtime values. API could be <code>emptyGraph &amp; addNode @0 (1 :: Int) &amp; addNode @1 (&#39;x&#39; :: Char) &amp; addEdge @0 @1 (Edge 0.5 :: Edge Int Char) :: Graph &#39;[(1, Char), (0, Int)] &#39;[(0, 1)]</code> using <code>TypeApplications</code> to specify the labels\u2014which could also use <code>Symbol</code> instead of <code>Nat</code>."}, {"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "edited": false, "score": 0, "creation_date": 1524918186, "post_id": 50075007, "comment_id": 87169059, "body": "My use case is modeling automation systems. A <code>Node Device</code> would represent the internal logic/behavior of a physical device like a motor or sensor, and would be connected by an <code>Edge Device ElectricalPort</code> to an electrical port. Static checking would ensure that <code>wire :: Edge ElectricalPort ElectricalPort</code> couldn&#39;t be used where <code>tubing :: Edge PneumaticPort PneumaticPort</code> was intended. The type labels are phantoms and can be erased once checked, or converted to some simple term level representation, so the query interface can check the labels and return inside a <code>Maybe</code>."}, {"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "edited": false, "score": 0, "creation_date": 1524918253, "post_id": 50075007, "comment_id": 87169086, "body": "Ideally there would be some way to add a whole subgraph as if it were an edge, like <code>pressureSensor :: ActsLikeAnEdge PneumaticPort ElectricalPort</code> where in fact that pressure sensor is modelled with some internal details."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "edited": false, "score": 1, "creation_date": 1524920952, "post_id": 50075007, "comment_id": 87169895, "body": "@DougMcClean: Hm, I wonder if you might want <code>Arrow</code>s? E.g., with <code>type Edge i o = Kleisli IO i o; type Source o = Edge () o; type Sink i = Edge i ()</code> you could write things like <code>proc (power, pneumatic) -&gt; do { power &lt;- powerCable &lt;&lt;&lt; battery -&lt; (); sensor &lt;- dataCable &lt;&lt;&lt; pressureSensor -&lt; pneumatic; result &lt;- dataCable &lt;&lt;&lt; device -&lt; (power, sensor); display -&lt; result }</code> with suitable definitions of things like <code>battery :: Source PowerOut</code>, <code>powerCable :: Edge PowerOut PowerIn</code>, <code>device :: Edge (PowerIn, DataIn Double) (DataOut Double)</code>, <code>display :: Sink (DataOut Double)</code>\u2026"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "edited": false, "score": 0, "creation_date": 1524921657, "post_id": 50075007, "comment_id": 87170125, "body": "Well, that should be just <code>proc (pneumatic)</code> actually, since the <code>battery</code> presumably generates power, hah. Just an illustration of how you can get a static graph structure by composing things that act more or less like regular functions equipped with whatever extra structure you want. Arrows let you do analysis of the graph as well, described here: <a href=\"https://elvishjerricco.github.io/2017/03/10/profunctors-arrows-and-static-analysis.html\" rel=\"nofollow noreferrer\">elvishjerricco.github.io/2017/03/10/&hellip;</a>"}, {"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "edited": false, "score": 0, "creation_date": 1525314232, "post_id": 50075007, "comment_id": 87310182, "body": "Thanks @jon-purdy, that elvishjerricco link is very interesting. I don&#39;t follow all of it, but I will reread it a few times until I do."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1524916196, "last_edit_date": 1524916196, "creation_date": 1524907921, "answer_id": 50075007, "question_id": 50072210, "link": "https://stackoverflow.com/questions/50072210/modeling-heterogenous-graphs-in-haskell/50075007#50075007", "title": "Modeling heterogenous graphs in Haskell", "body": "<p>I\u2019m not sure how I would go about enforcing this at compile time\u2014I think it requires that your graphs be completely static?\u2014but it\u2019s relatively straightforward to enforce at runtime using <code>Typeable</code>. Here\u2019s a sketch of what that would look like. First, I\u2019ll start with typed <code>Node</code> and <code>Edge</code> types:</p>\n\n<pre><code>data Node a = Node a\ndata Edge a b = Edge !Int !Int\n</code></pre>\n\n<p>Wrap them in existentials:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\nimport Data.Typeable\n\ndata SomeNode\n  = forall a. (Typeable a)\n  =&gt; SomeNode (Node a)\n\ndata SomeEdge\n  = forall a b. (Typeable a, Typeable b)\n  =&gt; SomeEdge (Edge a b)\n</code></pre>\n\n<p>Have a heterogeneous graph data type that uses the existentially quantified types:</p>\n\n<pre><code>import Data.IntMap (IntMap)\n\n-- Not a great representation, but simple for illustration.\ndata Graph = Graph !(IntMap SomeNode) [SomeEdge]\n</code></pre>\n\n<p>And then operations that perform dynamic type checks:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeApplications #-}\n\nimport qualified Data.IntMap as IntMap\n\naddNode\n  :: forall a. (Typeable a)\n  =&gt; Int -&gt; a -&gt; Graph -&gt; Maybe Graph\naddNode i x (Graph ns es) = case IntMap.lookup i ns of\n\n  -- If a node already exists at a given index:\n  Just (SomeNode (existing :: Node e)) -&gt; case eqT @e @a of\n\n    -- Type-preserving replacement is allowed, but\u2026\n    Just Refl -&gt; Just $ Graph ns' es\n\n    -- \u2026*type-changing* replacement is *not* allowed,\n    -- since it could invalidate existing edges.\n    Nothing -&gt; Nothing\n\n  -- Insertion is of course allowed.\n  Nothing -&gt; Just $ Graph ns' es\n\n  where\n    ns' = IntMap.insert i (SomeNode (Node x)) ns\n\n-- To add an edge:\naddEdge\n  :: forall a b. (Typeable a, Typeable b)\n  =&gt; Edge a b -&gt; Graph -&gt; Maybe Graph\naddEdge e@(Edge f t) (Graph ns es) = do\n\n  -- The \u2018from\u2019 node must exist\u2026\n  SomeNode (fn :: Node tfn) &lt;- IntMap.lookup f ns\n  -- \u2026and have the correct type; and\n  Refl &lt;- eqT @a @tfn\n\n  -- The \u2018to\u2019 node must exist\u2026\n  SomeNode (tn :: Node ttn) &lt;- IntMap.lookup t ns\n  -- \u2026and have the correct type.\n  Refl &lt;- eqT @b @ttn\n\n  pure $ Graph ns $ SomeEdge e : es\n</code></pre>\n\n<p>Now this succeeds:</p>\n\n<pre><code>pure (Graph mempty mempty)\n  &gt;&gt;= addNode 0 (1 :: Int)\n  &gt;&gt;= addNode 1 ('x' :: Char)\n  &gt;&gt;= addEdge (Edge 0 1 :: Edge Int Char)\n</code></pre>\n\n<p>But changing <code>Int</code>/<code>Char</code> in <code>Edge Int Char</code> to invalid types, or <code>0</code>/<code>1</code> to invalid indices, will fail and return <code>Nothing</code>.</p>\n"}], "owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1524916196, "creation_date": 1524881725, "question_id": 50072210, "link": "https://stackoverflow.com/questions/50072210/modeling-heterogenous-graphs-in-haskell", "title": "Modeling heterogenous graphs in Haskell", "body": "<p>How can I model what I will call \"heterogenous graphs\" in haskell, such that the type-correctness of the graph can be verified at compile time?</p>\n\n<p>For this purpose, a heterogenous graph is a set of nodes, each with a certain type label, and a set of edges, each with a source type label and a destination type label.</p>\n\n<p>We wish to <em>statically</em> ensure that, when an edge is added to a graph, the source type label of that edge matches the type label of the source node, and the destination type label of that edge matches the type label of the destination node. But we don't wish to do that in the trivial way (by forcing the entire graph to contain only nodes with one particular type label).</p>\n"}, {"tags": ["haskell", "idioms"], "comments": [{"owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 3, "creation_date": 1524863465, "post_id": 50070096, "comment_id": 87157217, "body": "You are looking for some kind of algebraic data type called <code>Result</code> defined by something like <code>data Result = Ok | Error String</code>. You can get fancier and use type variables for different kinds of errors and even add stuff to the <code>Ok</code> part. Elm has this type built in. Does Haskell? It might, look around. :)"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1524863475, "post_id": 50070096, "comment_id": 87157222, "body": "Hmm, what about using <code>Either e ()</code> and creating a pattern synonym <code>pattern Success = Right ()</code>?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524865789, "post_id": 50070096, "comment_id": 87158036, "body": "Your first bullet point reminds me of the idiomatic <code>err</code> variable in Go. It is typically re-shadowed every time you call a function that might fail, and after each result you must check: <code>if err != nil { &#47;&#47;handle it }</code>"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1524866505, "post_id": 50070096, "comment_id": 87158253, "body": "If you&#39;re working with monadic computation, then <code>ExceptT err m ()</code> would be my first instinct - an action that either succeeds with no result (success) or produces an error."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 2, "creation_date": 1524873416, "post_id": 50070096, "comment_id": 87159816, "body": "A computation that doesn&#39;t return any information other than &quot;yes it succeeded&quot; doesn&#39;t sound very useful outside of an IO action, and as far as I know the most idiomatic way to represent errors in that context is with exceptions, no? It really depends on what the function does, honestly."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1524874077, "post_id": 50070096, "comment_id": 87159917, "body": "@DarthFennec There are plenty of contexts other than <code>IO</code> where \u201cyes it succeeded\u201d might be desirable: <code>State</code>, <code>STM</code>, <code>Writer</code>..."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524877767, "post_id": 50070096, "comment_id": 87160565, "body": "<code>System.Exit</code> defines <code>data ExitCode = ExitSuccess | ExitFailure Int</code>, which is basically an exit-status-specific version of Ray Toal&#39;s <code>Result</code> suggestion. <code>ExitCode</code> also has an <code>Exception</code> instance, which implies the &quot;standard&quot; thing to do is define your own domain-specific type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524879761, "post_id": 50070096, "comment_id": 87160879, "body": "Very related, possibly dupe: <a href=\"https://stackoverflow.com/q/43236259/791604\">Should Maybe&#39;s be used to hold error messages?</a>"}, {"owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1524884260, "post_id": 50070096, "comment_id": 87161543, "body": "@DavidYoung That sounds like a decent solution to me (and it seems clear that there\u2019s no single idiomatic solution that everyone already knows). Could you promote that into an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1525052632, "post_id": 50073706, "comment_id": 87202135, "body": "The Monad implementation for Maybe treats Nothing as a failure."}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 2, "last_activity_date": 1524897778, "creation_date": 1524897778, "answer_id": 50073706, "question_id": 50070096, "link": "https://stackoverflow.com/questions/50070096/what-s-the-idiomatic-type-to-represent-multiple-failure-cases-but-only-one-succe/50073706#50073706", "title": "What\u2019s the idiomatic type to represent multiple failure cases but only one success case?", "body": "<p>Without seeing the actual code it is actually difficult to understand what you mean by failure. If it's a pure function then I don't see what using <code>Maybe</code> would be a problem. I never really see <code>Nothing</code> as failure but just as it is : Nothing. Depending on the context , I  either return Nothing as well or, use a default value and carry on. I understand that it can be seen as a failure, but it more depends on the point  of view \nif the caller than the function itself.\nNow, you want to represent a computation which can fails but returns nothing. If it is a pure function, that doesn't make sense. You function being pure, nothing has happened (no side effect) and you don't get a result. So in case of success, you actually computed nothing : that's not a success, that's nothing. ATHI If you fail, you've got a reason why it failed. That's no different from a simple check returning a <code>Maybe</code>.</p>\n\n<p>For example you might need to check that a domain is not in a blacklist. For that you do a lookup in a list : Nothing means it's fine even though it means it's from your point of view and failure and need to stop your computation. The same code can be used to check your domain belongs to a white list. in that case Nothing is a failure : just depends on the context.</p>\n\n<p>Now, if you are running a monadic action (like saving a file or something) it makes sense to return nothing but different failures can happened (disk full, path incorrect, etc). The standard signature for an IO which we don't care about the result is <code>IO ()</code>, so you can either go for <code>IO (Either e ())</code> (everybody will understand it) or go for <code>IO ()</code> and raises exception (if they are genuinely exceptional). </p>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1524901940, "creation_date": 1524901940, "answer_id": 50074215, "question_id": 50070096, "link": "https://stackoverflow.com/questions/50070096/what-s-the-idiomatic-type-to-represent-multiple-failure-cases-but-only-one-succe/50074215#50074215", "title": "What\u2019s the idiomatic type to represent multiple failure cases but only one success case?", "body": "<p>Its not clear from the question how the computation might fail.</p>\n\n<p>If it is something like a compiler, which might produce a lot of error messages (rather than halting on the first one) then you want something like:</p>\n\n<pre><code>type MyResult a = Either [Error] a\n</code></pre>\n\n<p>which either succeeds with a result or fails with a list of reasons.</p>\n\n<p>On the other hand if you have a non-deterministic computation where each variation might succeed or fail then you want something more like:</p>\n\n<pre><code>type MyResult a = [Either Error a]\n</code></pre>\n\n<p>Then search the list of results. If you find a Right then return it, otherwise assemble the list of Lefts.</p>\n"}, {"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1524904835, "post_id": 50074429, "comment_id": 87165459, "body": "The pattern synonyms is a bit point less as one will use only if he already knows the semantics behind the <code>Either e ()</code>. Itll be better using <code>Either e Success</code> with <code>data Success = Success</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1524904999, "post_id": 50074429, "comment_id": 87165496, "body": "@mb14 Hmm, what makes that better? That just replaces <code>Right ()</code> with <code>Right Success</code> instead of just <code>Success</code>. Also, I&#39;m not sure I understand what you&#39;re saying. The reason for the pattern synonym and the type synonym would be to make things more clear to people who are <i>not</i> completely aware of the intent of the <code>Either e ()</code>."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1524906440, "post_id": 50074429, "comment_id": 87165868, "body": "Type synonyms doesn&#39;t provide guarantee (or safety or semantic as they can disappear) and add unnecessary level of indirection. I think <code>Eithe e ()</code> is clear enough, but <code>Eithe e Success</code> enforces a semantic if really needed."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 1, "last_activity_date": 1524905562, "last_edit_date": 1524905562, "creation_date": 1524903624, "answer_id": 50074429, "question_id": 50070096, "link": "https://stackoverflow.com/questions/50070096/what-s-the-idiomatic-type-to-represent-multiple-failure-cases-but-only-one-succe/50074429#50074429", "title": "What\u2019s the idiomatic type to represent multiple failure cases but only one success case?", "body": "<p>A short way to go about this would be to use <code>Either e ()</code> along with the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html?highlight=inline#pattern-synonyms\" rel=\"nofollow noreferrer\">pattern synonym</a></p>\n\n<pre><code>pattern Success :: Either e ()  -- Explicit type signature not necessary\npattern Success = Right ()\n</code></pre>\n\n<p>You could also include some other things as well, if it improves readability, such as</p>\n\n<pre><code>type FailableWith e = Either e ()\n\npattern FailedWith :: e -&gt; FailableWith e\npattern FailedWith x = Left x\n</code></pre>\n\n<p>Unlike <code>Maybe</code>, <code>Either</code> has the advantage of having all the existing machinery already in place: the <code>Functor</code>, <code>Applicative</code>, <code>Monad</code>, <code>Foldable</code>, <code>Traversable</code>, <code>Semigroup</code> and even <code>Ord</code> (<code>Left x &lt; Right y</code> should always hold) instances will likely already behave exactly how you would want for error handling. Generally, for this particular situation, <code>Maybe</code> will tend to do the opposite of what you want (usually you want to continue on a success and stop after the first failure, which is the opposite of what most of the <code>Maybe</code> machinery will provide for this scenario).</p>\n"}], "owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 50074429, "answer_count": 3, "score": 4, "last_activity_date": 1524905562, "creation_date": 1524862120, "question_id": 50070096, "link": "https://stackoverflow.com/questions/50070096/what-s-the-idiomatic-type-to-represent-multiple-failure-cases-but-only-one-succe", "title": "What\u2019s the idiomatic type to represent multiple failure cases but only one success case?", "body": "<p>The type <code>Maybe a</code> represents a computation that could fail, with the semantics that we don\u2019t care about exactly <em>how</em> it failed. If the computation succeeds then any value of type <code>a</code> might be returned.</p>\n\n<p>What about the inverse case, where the computation could fail for any number of reasons (and we want to preserve that information) but success doesn\u2019t involve any information other than \u201cyes, it succeeded\u201d? I can think of two obvious ways to encode this kind of computation:</p>\n\n<ul>\n<li><code>Maybe e</code>, where <code>Just e</code> represents a failure and <code>Nothing</code> represents a success. This is so contrary to the usual use of <code>Maybe</code> that I would be reluctant to use it.</li>\n<li><code>Either e ()</code>, where <code>Left e</code> represents a failure and <code>Right ()</code> represents a success. This has the advantage of being explicit, but has the disadvantage of\u2026 being explicit. Writing <code>()</code> feels awkward, especially outside the context of a type signature.</li>\n</ul>\n\n<p>Does Haskell have a more idiomatic way to represent \u201cmultiple failure cases but only one success case\u201d?</p>\n"}, {"tags": ["haskell", "documentation", "hackage"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524856562, "post_id": 50068901, "comment_id": 87154238, "body": "<a href=\"https://blog.hackage.haskell.org/posts/2018-04-26-downtime.html\" rel=\"nofollow noreferrer\">Related?</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1524867588, "post_id": 50068901, "comment_id": 87158553, "body": "Yes, you can do something to force documents - you can upload your own haddocks to hackage."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1524867946, "post_id": 50068901, "comment_id": 87158637, "body": "@ThomasM.DuBuisson Does that address the question?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524870454, "post_id": 50068901, "comment_id": 87159258, "body": "Indeed, uploading your own also means you can generate it with proper source hyperlinks."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524872637, "post_id": 50068901, "comment_id": 87159696, "body": "You asked lots of questions. I believe my statement addresses one of them but you are the authority on that, not me."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524907859, "post_id": 50068901, "comment_id": 87166235, "body": "For a simple way of uploading docs yourself, see <a href=\"https://neilmitchell.blogspot.de/2014/10/fixing-haddock-docs-on-hackage.html\" rel=\"nofollow noreferrer\">neilmitchell.blogspot.de/2014/10/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "is_accepted": true, "score": 3, "last_activity_date": 1524955188, "creation_date": 1524955188, "answer_id": 50081697, "question_id": 50068901, "link": "https://stackoverflow.com/questions/50068901/why-isnt-my-documentation-showing-up-in-hackage/50081697#50081697", "title": "Why isn&#39;t my documentation showing up in Hackage?", "body": "<p>The doc builder got stuck and has been restarted (along with better auto-restart logic), and will catch up with the accumulated backlog over the course of a few days.</p>\n\n<p>No action is necessary.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 50081697, "answer_count": 1, "score": 2, "last_activity_date": 1524955188, "creation_date": 1524856290, "last_edit_date": 1524911810, "question_id": 50068901, "link": "https://stackoverflow.com/questions/50068901/why-isnt-my-documentation-showing-up-in-hackage", "title": "Why isn&#39;t my documentation showing up in Hackage?", "body": "<p>Documentation for <a href=\"https://hackage.haskell.org/package/crypto-enigma\" rel=\"nofollow noreferrer\">my recently updated package</a> on Hackage <a href=\"https://hackage.haskell.org/package/crypto-enigma-0.0.2.12/docs/Crypto-Enigma.html#v:enigmaEncoding\" rel=\"nofollow noreferrer\">isn't showing up</a>, even though it has now been a few days since the update. The previous version had <a href=\"https://hackage.haskell.org/package/crypto-enigma-0.0.2.11/docs/Crypto-Enigma.html#v:enigmaEncoding\" rel=\"nofollow noreferrer\">complete documentation</a>, and I've made no changes in this update that would have affected package documentation.</p>\n\n<p>Why isn't my documentation showing up in Hackage? Is there an outage or known delay in document building, or can I monitor the status of document building somewhere?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1524845902, "post_id": 50066429, "comment_id": 87149480, "body": "What is not working? What error do you get? What did you try? Why do you use <code>case</code> on a <code>Bool</code> here?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1524850326, "post_id": 50066429, "comment_id": 87151418, "body": "There are multiple issues including formatting of code in the question. It&#39;s not clear what you&#39;re asking about"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1524853542, "post_id": 50066429, "comment_id": 87152859, "body": "I updated the error."}], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "is_accepted": false, "score": 2, "last_activity_date": 1524856383, "creation_date": 1524856383, "answer_id": 50068917, "question_id": 50066429, "link": "https://stackoverflow.com/questions/50066429/how-to-implement-a-list-splitter-based-on-predicate/50068917#50068917", "title": "How to implement a list splitter based on predicate", "body": "<p>This is a way of implementing what you need.</p>\n\n<p>What I did is to use the function <code>span</code>, that breaks the list in two, returning a tuple. The first element is the list of initial elements satisfying <code>p</code>. The second element of the tuple is the remainder of the list.</p>\n\n<p>I used this recursively, while discarding the elements that do not satisfy <code>p</code>.</p>\n\n<pre><code>splt :: (a -&gt; Bool) -&gt; [a] -&gt; [[a]]\nsplt p [] = []\nsplt p ls = let (a,rs)  = span p ls\n                (b,rs') = span (not . p) rs\n            in if null a then splt p rs' else a : splt p rs'\n</code></pre>\n\n<p>You can also try to define <code>span</code> yourself</p>\n"}, {"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1524860848, "post_id": 50068932, "comment_id": 87156139, "body": "By the way is my approach efficient?The second approach?"}, {"owner": {"reputation": 165, "user_id": 2630395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b5f0f742c249caa0f3d03554e9a1675?s=128&d=identicon&r=PG", "display_name": "Somebody", "link": "https://stackoverflow.com/users/2630395/somebody"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1524865537, "post_id": 50068932, "comment_id": 87157950, "body": "You will have to reverse all the lists inside the final list and then reverse the final list as well so I think it is less efficient."}], "tags": [], "owner": {"reputation": 165, "user_id": 2630395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b5f0f742c249caa0f3d03554e9a1675?s=128&d=identicon&r=PG", "display_name": "Somebody", "link": "https://stackoverflow.com/users/2630395/somebody"}, "is_accepted": true, "score": 2, "last_activity_date": 1524856444, "creation_date": 1524856444, "answer_id": 50068932, "question_id": 50066429, "link": "https://stackoverflow.com/questions/50066429/how-to-implement-a-list-splitter-based-on-predicate/50068932#50068932", "title": "How to implement a list splitter based on predicate", "body": "<p>The second one is just a bracketing issue and can be remedied by correctly parenthesising the arguments as follows:</p>\n\n<pre><code>case p x of \n    True -&gt;go p (x:small) big xs\n    False -&gt;go p [] (small:big) xs \n</code></pre>\n\n<p>By not doing so, the lists are being treated as functions. You will have to map reverse on the resulting list as well in this case.</p>\n\n<p>You can also try using the span function for this:</p>\n\n<pre><code>splt :: (a -&gt; Bool) -&gt; [a] -&gt; [[a]]\nsplt _ [] = []\nsplt p xs = let (xs', xs'') = span p xs\n                remaining   = dropWhile (not . p) xs''\n            in case xs' of\n              []  -&gt; splt p remaining\n              xs' -&gt; xs' : splt p xs''\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 50068932, "answer_count": 2, "score": 1, "last_activity_date": 1524856444, "creation_date": 1524845523, "last_edit_date": 1524853526, "question_id": 50066429, "link": "https://stackoverflow.com/questions/50066429/how-to-implement-a-list-splitter-based-on-predicate", "title": "How to implement a list splitter based on predicate", "body": "<p>I am trying to implement a list-splitter based on a given predicate.The functionality is a similar to a recursive break.I input in a list ,and i append elements to a small list as long as the predicate for the given element is true.When the predicate is false i append the formed list to a bigger list and i continue from where i remained ignoring the element corresponding to the false predicate.</p>\n\n<p>P.S: I am trying to not use any Data.List functions only self-implemented.(I'm in learning phase).\nExample:</p>\n\n<p><strong>input</strong> <br>\n predicate: <code>(\\x-&gt;x&lt;3)</code><br>\n           list : <code>[1,2,3,2,3,1,1,1,3]</code> <br>\n<strong>output:</strong><br>  <code>[[1,2],[2],[1,1,1]]</code></p>\n\n<p>I have tried so far with the following approach:\nI use a list that given a list it breaks it in a tuple of 2.The first element is the list until the false predicate.The second is the rest.I feed this tuple to a function that performs this again and again.</p>\n\n<pre><code>splt::(a-&gt;Bool)-&gt;[a]-&gt;[[a]]\n    splt p []=[]\n    splt p (x:xs)=go p [] (x:xs) where\n                  go p rez []=rez\n                  go p rez ls=rez:process . brk $  ls [] where\n                  process  (x,[])=rez:x\n                  process ([],x)=go p rez x\n\n\n    brk::(a-&gt;Bool)-&gt;[a]-&gt; ([a],[a])\n    brk p []= ([],[])\n    brk p (x:xs)=go p ([],x:xs) where \n                 go p (accu,[])= (accu,[])\n                 go p (accu,x:xs)|not (p x) =(accu,xs)\n                                 |otherwise = go p (x:accu,xs)\n</code></pre>\n\n<p>I get the following error : <code>cannot produce infinite type.</code></p>\n\n<p>I have also tried a simpler solution:</p>\n\n<pre><code>format::(a-&gt;Bool)-&gt;[a]-&gt;[[a]]\n   format p []=[]\n   format p ls=go p [] [] ls where\n               go p small big []=small:big\n               go p small big (x:xs)=case p x of \n                                     True -&gt;go p x:small big xs\n                                     False -&gt;go p [] small:big xs     \n</code></pre>\n\n<p>But it does not work and i also have to reverse the results in both cases.The error i get is:</p>\n\n<pre><code>* Couldn't match type `a' with `[a0]'\n      `a' is a rigid type variable bound by\n        the type signature for:\n          wrds :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; [[a]]\n        at Ex84.hs:12:5-31\n      Expected type: [a0] -&gt; Bool\n        Actual type: a -&gt; Bool\n    * In the first argument of `go', namely `p'\n      In the expression: go p [] []\nls\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1524834962, "post_id": 50063254, "comment_id": 87143022, "body": "Have you looked up how pattern matching works? That will answer this pretty readily."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1524835113, "post_id": 50063254, "comment_id": 87143130, "body": "@Carcigenicate Why not provide a link to somewhere the questioneer can look it up? (Here is one such link: <a href=\"http://learnyouahaskell.com/syntax-in-functions#case-expressions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions#case-expressions</a>)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524842578, "post_id": 50063254, "comment_id": 87147756, "body": "Turn on warnings. You&#39;ll discover the the <code>xs</code> in the <code>case</code> is shadowing the outer definition of <code>xs</code>. Indeed, variables that appear in patterns, e.g. <code>x</code> above, are being <i>defined</i> by the <code>case</code>."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 0, "last_activity_date": 1524836056, "creation_date": 1524836056, "answer_id": 50063589, "question_id": 50063254, "link": "https://stackoverflow.com/questions/50063254/how-does-xs-pattern-in-haskell-work/50063589#50063589", "title": "How does xs Pattern in Haskell work?", "body": "<p>With <em>explicit parenthesization</em>, your code is</p>\n\n<pre><code>describeList :: [a] -&gt; String\ndescribeList xs = \"The list is \" ++ (case xs of \n                                        { [ ] -&gt; \"empty.\"\n                                        ; [x] -&gt; \"a singleton list.\"\n                                        ; xs -&gt; \"a longer list.\"  } )\n</code></pre>\n\n<p>So the answer to your question is, this is how the pattern matching, done by <code>case</code>, works:</p>\n\n<ul>\n<li>In <em>case</em> <code>xs</code> matches an empty list, <code>[ ]</code>, successfully, the first alternative is used.</li>\n<li>In case <code>xs</code> matches a singleton list, <code>[x]</code>, the second alternative is performed, with any <em>pattern variables</em> bound to the respective parts of the <em>value</em> being matched, <code>xs</code>.</li>\n<li>etc.</li>\n</ul>\n"}], "owner": {"reputation": 205, "user_id": 9710552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8578fe2900e52ee3bd08329635673614?s=128&d=identicon&r=PG&f=1", "display_name": "RM777", "link": "https://stackoverflow.com/users/9710552/rm777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 50063589, "answer_count": 1, "score": -2, "last_activity_date": 1524836056, "creation_date": 1524834911, "question_id": 50063254, "link": "https://stackoverflow.com/questions/50063254/how-does-xs-pattern-in-haskell-work", "title": "How does xs Pattern in Haskell work?", "body": "<p>How does this code work? I have not defined a x.</p>\n\n<pre><code>describeList :: [a] -&gt; String\ndescribeList xs = \"The list is \" ++ case xs of\n                                              [ ] -&gt; \"empty.\"\n                                              [x] -&gt; \"a singleton list.\"\n                                              xs -&gt; \"a longer list.\" \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "edited": false, "score": 1, "creation_date": 1524832116, "post_id": 50062365, "comment_id": 87141236, "body": "example input &quot;45abc&quot; output 9"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1524833242, "creation_date": 1524833242, "answer_id": 50062745, "question_id": 50062365, "link": "https://stackoverflow.com/questions/50062365/do-notation-in-haskell/50062745#50062745", "title": "Do notation in haskell", "body": "<p>You don't want <code>do</code> notation at all, just normal variable binding. So:</p>\n\n<pre><code>func str = str2 where\n    str1 = filter (&lt;'a') str\n    str2 = map digitToInt str1\n</code></pre>\n\n<p>Tracking the most recently used name is annoying, isn't it? Plus it's easy to make a mistake and type <code>str</code> instead of <code>str1</code> somewhere, or similar. Enter function composition:</p>\n\n<pre><code>func str = str2 where\n    str2 = (map digitToInt . filter (&lt;'a')) str\n</code></pre>\n\n<p>In fact, I would inline the definition of <code>str2</code>, then elide <code>str</code> entirely:</p>\n\n<pre><code>func = map digitToInt . filter (&lt;'a')\n</code></pre>\n\n<p>I would prefer to use <code>isDigit</code> over <code>(&lt;'a')</code>; we can toss in a sum at the same time.</p>\n\n<pre><code>func = sum . map digitToInt . filter isDigit\n</code></pre>\n\n<p>Reads nice and clean, in my opinion.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524842306, "post_id": 50064763, "comment_id": 87147600, "body": "Yeah. I think this should go with a big warning up front though that such use of <code>do</code> notation behaves completely different from what one might expect in an imperative language."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1524845270, "post_id": 50064763, "comment_id": 87149158, "body": "@leftaroundabout that wouldn&#39;t be an issue at all if &quot;<code>do</code>&quot; were named &quot;<code>for</code>&quot; in the first place (<code>for s in getString: print s</code>, <code>for s2 in (for s in getString: yield (s++&quot;!&quot;)): print s2</code>, <code>for c in &quot;string&quot;: [c,c]</code>). spilled milk, yes."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1524845805, "post_id": 50064763, "comment_id": 87149422, "body": "@WillNess seriously? That syntax looks nowhere near as good as the current <code>do</code> syntax. <code>yield</code> instead of <code>return</code> would of course be preferrable (that one would actually be quite easy to change), but <code>for</code> seems a worse choice of keyword than for most monads, more misleading than <code>do</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524850618, "post_id": 50064763, "comment_id": 87151551, "body": "@leftaroundabout I don&#39;t see a problem there. but it could also be <code>with s from getString:</code>, <code>with c from &quot;string&quot;:</code> etc."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1524845998, "last_edit_date": 1524845998, "creation_date": 1524839948, "answer_id": 50064763, "question_id": 50062365, "link": "https://stackoverflow.com/questions/50062365/do-notation-in-haskell/50064763#50064763", "title": "Do notation in haskell", "body": "<p>You <em>could</em> use <code>do</code> notation, since strings are lists and lists are monads. It would look like this, though:</p>\n\n<pre><code>func :: String -&gt; [Int]\nfunc str = do\n  c &lt;- filter (&lt; 'a') str  -- Get one character\n  return (digitToInt c)    -- Change that character to a integer\n</code></pre>\n\n<p>What is the value of <code>c</code>? It's not just one character, but <em>all</em> of them. The list monad models nondeterminism. Imagine that <code>func</code> makes multiple copies of itself, with each copy selecting a different character <code>c</code> from the input string. <code>return</code> makes a new list from the result, and the monad takes care of glue the individual lists into a one final list. It's a little clearer if you compare it its deconstructed form.</p>\n\n<pre><code>func str = filter (&lt; 'a') str &gt;&gt;= \\c -&gt; return (digitToInt c)\n</code></pre>\n\n<p>Since <code>xs &gt;&gt;= f = concatMap f xs</code> and <code>return x = [x]</code> in the <code>Monad []</code> instance, it becomes:</p>\n\n<pre><code>func str = concatMap (\\c -&gt; [digitToInt c]) (filter (&lt; 'a') str)\n</code></pre>\n\n<p>However, the monadic form isn't necessary, as your function only needs to make use of the <code>Functor</code> instance of <code>[]</code>, since every element from the first list corresponds to exactly one element in the final list:</p>\n\n<pre><code>-- Or in a form closer to Daniel Wagner's answer\nfunc str = fmap digitToInt (filter (&lt; 'a') str)\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 50062745, "answer_count": 2, "score": 0, "last_activity_date": 1524888547, "creation_date": 1524831993, "last_edit_date": 1524888547, "question_id": 50062365, "link": "https://stackoverflow.com/questions/50062365/do-notation-in-haskell", "title": "Do notation in haskell", "body": "<p>So I am trying to program a function in haskell which does the following things:\n1. Input is a string \n2. function first removes all letters of the string and only numbers remain\n3. function converts the string numbers to int numbers\n4. function sums the numbers in the string together and prints it out</p>\n\n<p>My Code til' Step #3</p>\n\n<pre><code>func str = \n    do \n    str &lt;- filter (&lt; 'a') str\n    str2 &lt;- map digitToInt str\n    return str2\n</code></pre>\n\n<p>somehow this doesn't work if I remove the 4th line with map digitToInt it works til step #2 fine but I dont know what the problem here is </p>\n\n<p>The Error is an couldnt match expected type [Char] with actual type Char</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["haskell", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524830154, "post_id": 50061832, "comment_id": 87140069, "body": "Please elaborate what you mean by this question."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1524832297, "last_edit_date": 1524832297, "creation_date": 1524831653, "answer_id": 50062271, "question_id": 50061832, "link": "https://stackoverflow.com/questions/50061832/lazy-evaluation-of-fibonacci-function/50062271#50062271", "title": "Lazy evaluation of Fibonacci function", "body": "<p>tl;dr because <code>infFib'</code> never returns, it only continues making calls.</p>\n\n<p>I expect what you thought while building <code>infFib'</code> was roughly this:</p>\n\n<ul>\n<li>I want an infinite list.</li>\n<li>I know how the list starts, and how the list should grow.</li>\n<li>I'll write a function which grows the list a little bit, then iterate it.</li>\n<li>Oops, Haskell doesn't do iteration -- it does recursion. Okay, I'll write a function which grows the list a little bit, and recurse with it.</li>\n</ul>\n\n<p>Unfortunately, the way you wrote it, you recurse by calling yourself with a longer and longer list -- but you never return (even parts of) that list to the caller! You just keep building a longer and longer list and calling <code>infFib'</code> on it.</p>\n\n<p>What you should do instead is to start returning the parts of the list that you're confident of, and grow the parts you aren't yet confident of. For example:</p>\n\n<pre><code>        infFib' [] = [0,1] ++ infFib' [0,1]\n        infFib' xs = newPart ++ infFib' (xs ++ newPart) where\n            newPart = [(foldr (\\a b -&gt; a+b) 0 (take 2 (reverse xs)))]\n</code></pre>\n\n<p>At this point, you can test in ghci that <code>infFib</code> actually does work and produces the right answers. If this suits your needs, you could stop here and call it a day.</p>\n\n<p>But this implementation is terribly inefficient compared to what's possible: here, <code>infFib'</code> is getting a longer and longer list as its argument, when it only really cares about the last two elements. It then has to walk that whole list just to get access to the elements it cares about, which wastes time and memory. Let's fix that by only passing the last two elements along. We'll have to fix up whatever function calls <code>infFib'</code> -- luckily, in this case, because it's scoped locally to a <code>where</code> block, we know there's just two, <code>infFib'</code> itself and the owner of the block, <code>infFib</code>. We'll also have to inline the base case of <code>[]</code>, since we don't have two elements to pass along yet in that case!</p>\n\n<pre><code>infFib = [0,1] ++ infFib' 0 1 where\n        infFib' secondToLast last = [newPart] ++ infFib' last newPart\n            where newPart = secondToLast + last\n</code></pre>\n\n<p>I would spend a little time thinking about how to clean this up some. I'm not sure if it's super obvious, but one thing that would make the code much cleaner would be to shift which element <code>infFib'</code> produces on each iteration to the left by two -- instead of producing the third element of the fibonacci sequence on the first call, produce the first element on the first call. This would eliminate the need for the extra <code>[0,1] ++</code> and the need for a special where block. So:</p>\n\n<pre><code>infFib = infFib' 0 1 where\n    infFib' old new = [old] ++ infFib' new (old+new)\n</code></pre>\n\n<p>And a last one: it is very idiomatic to unroll the definition of <code>[x] ++ y</code> to <code>x:y</code>. This gives us the final definition</p>\n\n<pre><code>infFib = infFib' 0 1 where\n    infFib' old new = old : infFib' new (old+new)\n</code></pre>\n\n<p>at which point I would be satisfied and move on to the next function I needed to write.</p>\n"}], "owner": {"reputation": 68, "user_id": 7705573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ad6428caf07ffbffc6ca14174bae5d?s=128&d=identicon&r=PG&f=1", "display_name": "james king", "link": "https://stackoverflow.com/users/7705573/james-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 50062271, "answer_count": 1, "score": 0, "last_activity_date": 1524832297, "creation_date": 1524829919, "question_id": 50061832, "link": "https://stackoverflow.com/questions/50061832/lazy-evaluation-of-fibonacci-function", "title": "Lazy evaluation of Fibonacci function", "body": "<p>I have written the function below in Haskell and I am not too sure why it doesn't work with lazy evaluation.</p>\n\n<pre><code>infFib :: [Integer]\ninfFib = infFib' []\n    where \n        infFib' [] = infFib' [0,1]\n        infFib' (xs) = infFib' (xs ++ [(foldr (\\a b -&gt; a+b) 0 (take 2 (reverse xs)))])\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1524829151, "post_id": 50061440, "comment_id": 87139481, "body": "This is exactly the sort of thing lenses are used for."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1524829797, "post_id": 50061440, "comment_id": 87139861, "body": "I suggest you look into Record Syntax, as it allows you to do just that. I currently don&#39;t have time to write up a full answer, but you should also include the definition of <code>State</code> if you want a complete answer."}, {"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1524831460, "post_id": 50061440, "comment_id": 87140804, "body": "So that pushes me to records in both cases? I&#39;ll add a definition for <code>State</code>, although I would&#39;ve thought that it wouldnt matter if it was either an <code>Integer</code> or something more complex."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1524832300, "post_id": 50061440, "comment_id": 87141344, "body": "If you use lenses you don&#39;t have to use records, although it makes defining the lenses easier."}, {"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1524833000, "post_id": 50061440, "comment_id": 87141755, "body": "Alright, thanks for the pointers, both of you. Feel free to add an answer so I can accept it, or mark it as a duplicate if it is."}], "answers": [{"comments": [{"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 0, "creation_date": 1524835777, "post_id": 50062717, "comment_id": 87143547, "body": "These lenses shrunk my codebase by half :)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1524833144, "creation_date": 1524833144, "answer_id": 50062717, "question_id": 50061440, "link": "https://stackoverflow.com/questions/50061440/haskell-update-parameters/50062717#50062717", "title": "Haskell update parameters", "body": "<p>As melpomene commented, <a href=\"http://lens.github.io/\" rel=\"nofollow noreferrer\">lenses</a> are the modern standard answer to your question. You can define lenses manually</p>\n\n<pre><code>{-# LANGUAGE Rank2Types, TypeFamilies #-}\nimport Control.Lens\n\ngameHistory :: Lens' State History\ngameHistory = lens (\\(State _ _ _ h) -&gt; h)\n                   (\\(State gs p1 p2 _) h -&gt; State gs p1 p2 h)\n</code></pre>\n\n<p>...or let Template Haskell do it for you</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\ndata State = State {\n        _gameState :: GameState\n      , _player\u2080State, _player\u2081State :: PlayerState\n      , _gameHistory :: History }\nmakeLenses ''State\n</code></pre>\n\n<p>which automatically creates</p>\n\n<pre><code>gameState :: Lens' State GameState\nplayer\u2080State :: Lens' State GameState\nplayer\u2081State :: Lens' State GameState\ngameHistory :: Lens' State History\n</code></pre>\n\n<p>Once you have such a lens, you can use the <a href=\"https://github.com/ekmett/lens/wiki/Operators\" rel=\"nofollow noreferrer\">operators</a> for tweaking <code>State</code> objects:</p>\n\n<pre><code>appendHistory :: Action -&gt; State -&gt; State -- more conventional argument order in Haskell\nappendHistory a = gameHistory %~ (a:)\n</code></pre>\n"}], "owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "closed_date": 1524833471, "accepted_answer_id": 50062717, "answer_count": 1, "score": 1, "last_activity_date": 1524833144, "creation_date": 1524828473, "last_edit_date": 1524831556, "question_id": 50061440, "link": "https://stackoverflow.com/questions/50061440/haskell-update-parameters", "closed_reason": "Duplicate", "title": "Haskell update parameters", "body": "<p>I wanted to try something new, so I've decided to wrap my head around Haskell. Coming from a mainly C#/Java background, I have a question about updating various values. I've managed to narrow it down to a single problem. Consider the following function:</p>\n\n<pre><code>appendHistory :: State -&gt; Action -&gt; State\nappendHistory (State gs p1 p2 h) a = State gs p1 p2 (a : h)\n</code></pre>\n\n<p>This basically appends the action to the state's history. <code>gs</code>, <code>p1</code> and <code>p2</code> are rather irrelevant in this case, since we're trying to update <code>h</code>. For the sake of copying the variables they need to be named (so I can use them on the right hand side of <code>=</code>). Is there any way I can write <code>appendHistory</code>, so that <code>h</code> gets updated without having to specify <code>gs</code>, <code>p1</code> and <code>p2</code> explicitly?</p>\n\n<p>One option would be to let other functions handle retrieving and updating state. <code>appendHistory</code> now doesn't have to specify the other parameters. Not my faviorite, as we've just moved our problem to <code>updateHistory</code>. In Haskell:</p>\n\n<pre><code>appendHistory :: State -&gt; Action -&gt; State\nappendHistory s a = updateHistory s (a : (history s))\n\nhistory :: State -&gt; History\nhistory (State _ _ _ h) = h\n\nupdateHistory :: State -&gt; History -&gt; State\nupdateHistory (State s p1 p2 _) h = State s p1 p2 h\n</code></pre>\n\n<p>Another way would be to use records. But I've been told (/read) that name clashes might occur when using the same names. I think I'm going to have a lot of records with fieldname <code>state</code>, so I've been avoiding those for the moment.</p>\n\n<p>I guess, all I want to do is (non-functionally):</p>\n\n<pre><code>void Update(State state, Action action) {\n    state.history.append(action);\n}\n</code></pre>\n\n<p>Is there a way to do this 'nicely' in Haskell, without having to write a 'getter' and a 'setter' for every <code>data</code> parameter?</p>\n\n<hr>\n\n<p>For full reference:</p>\n\n<pre><code>type History = [Action]\ntype Deck = [Card]\ntype Hand = [Card]\ntype Graveyard = [Card]\n\ndata Card = Card -- Still to expand\n\ndata PlayerState = PlayerState Hand Deck Graveyard\ndata GameState = NotStarted | Playing | Finished\n\ndata State = State GameState PlayerState PlayerState History\n</code></pre>\n\n<p><code>Action</code>s are just definitions on how to mutate <code>State</code>.</p>\n"}, {"tags": ["haskell", "httprequest", "happstack"], "answers": [{"tags": [], "owner": {"reputation": 184, "user_id": 4989909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5fc8f5b7ec14b5edeb606a4131c85a9e?s=128&d=identicon&r=PG&f=1", "display_name": "alex.b", "link": "https://stackoverflow.com/users/4989909/alex-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1525428185, "creation_date": 1525428185, "answer_id": 50172347, "question_id": 50060881, "link": "https://stackoverflow.com/questions/50060881/reading-request-body-twice-in-happstack-server/50172347#50172347", "title": "Reading request body twice in happstack-server", "body": "<p>I have implement a workaround, which use the function <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Control-Concurrent-MVar.html#v:tryReadMVar\" rel=\"nofollow noreferrer\">tryReadMVar</a> instead <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Control-Concurrent-MVar.html#v:tryTakeMVar\" rel=\"nofollow noreferrer\">tryTakeMVAR</a>. With this fuction i can read the body without destroy it for the continuing process</p>\n\n<pre><code>peekRequestBody :: (MonadIO m) =&gt; Request -&gt; m (Maybe RqBody)\npeekRequestBody rq = liftIO $ tryReadMVar (rqBody rq)\n\ngetBody :: RouteT AuthenticateURL (ServerPartT IO) L.ByteString\ngetBody = do\n    req  &lt;- askRq\n    body &lt;- liftIO $ peekRequestBody req\n    case body of\n        Just rqbody -&gt; return . unBody $ rqbody\n        Nothing     -&gt; return (L.pack \"\")\n</code></pre>\n"}], "owner": {"reputation": 184, "user_id": 4989909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5fc8f5b7ec14b5edeb606a4131c85a9e?s=128&d=identicon&r=PG&f=1", "display_name": "alex.b", "link": "https://stackoverflow.com/users/4989909/alex-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 50172347, "answer_count": 1, "score": 1, "last_activity_date": 1525428185, "creation_date": 1524826454, "last_edit_date": 1525425100, "question_id": 50060881, "link": "https://stackoverflow.com/questions/50060881/reading-request-body-twice-in-happstack-server", "title": "Reading request body twice in happstack-server", "body": "<p>I have a problem reading the body twice in a happstack-server application.</p>\n\n<p>I have embeded a library for user authentication (happstack-authenticate). happstack-authenticate has an JSON-Api to manage users and I trying access the same request body after the JSON-Api is called. Unfortunately this libray use the method <a href=\"https://hackage.haskell.org/package/happstack-server-7.5.1/docs/Happstack-Server-Types.html#v:takeRequestBody\" rel=\"nofollow noreferrer\">takeRequestBody</a> which destory the body, so I can't access the request body after this. Trying to access the body before the library is called shift only the problem because I also use takeRequestBody.</p>\n\n<p>The reason why takeRequestBody deletes the content is because it is based on <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Control-Concurrent-MVar.html#v:tryTakeMVar\" rel=\"nofollow noreferrer\">tryTakeMVAR</a>. </p>\n\n<p>Is there a workaround for my problem? Do i need to access the body twice or is there another solution? Or maybe there is another method to read the body which don't destroy the body?</p>\n\n<p>Simple code to demonstrate the problem:</p>\n\n<pre><code>module Test where\n\nimport Data.Data                     ( Data, Typeable )\nimport Happstack.Server \nimport Happstack.Authenticate.Core\nimport Data.Acid                     ( AcidState )\nimport Web.Routes                    ( RouteT(..) )\nimport Control.Monad.IO.Class        ( liftIO )\nimport qualified Data.ByteString.Lazy.Char8 as L\n\n\ngetBody :: RouteT AuthenticateURL (ServerPartT IO) L.ByteString\ngetBody = do\n    req  &lt;- askRq\n    body &lt;- liftIO $ takeRequestBody req\n    case body of\n        Just rqbody -&gt; return . unBody $ rqbody\n        Nothing     -&gt; return (L.pack \"\")\n\n\nroute :: AcidState AuthenticateState -&gt; (AuthenticateURL -&gt; RouteT AuthenticateURL (ServerPartT IO) Response)\n        -&gt; AuthenticateURL -&gt; RouteT AuthenticateURL (ServerPartT IO) Response\nroute authenticateState routeAuthenticate authenticateURL =\n    do\n        --routeAuthenticate is a routing function from Happstack.Authenticate\n        routeAuthenticate authenticateURL\n        body &lt;- getBody\n        ok $ toResponse body\n</code></pre>\n"}, {"tags": ["haskell", "elixir", "interop", "otp"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1524826352, "post_id": 50060612, "comment_id": 87137926, "body": "Perhaps I&#39;m missing something, but as written the question seems rather unclear to me. I can&#39;t tell what architecture you&#39;re envisioning here. Though tbh even if I could I&#39;m not sure this question is on-topic for SO. This seems to be mostly about software engineering rather than programming per se; The question about concurrency might be answerable if you go into more detail on that, the rest I&#39;m not so sure about."}, {"owner": {"reputation": 1811, "user_id": 1693831, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Pe08p.png?s=128&g=1", "display_name": "category", "link": "https://stackoverflow.com/users/1693831/category"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1524831207, "post_id": 50060612, "comment_id": 87140660, "body": "<code>NIF</code>s are Elixir/Erlang mechanisms for interoperability with external programs. So the architecture here would be two Elixir <code>Application</code>s - a Phoenix <code>Application</code> for the <code>Phoenix.Channel</code> web interface, and a second that would handle the Haskell interop (this would be loaded into the first as a dependency). The Haskell application would then communicate w. Elixir via <code>NIF</code>s. OTP refers to a set of Elixir <code>Behaviour</code>s (including <code>GenServer</code>) that leverage the <code>BEAM</code> to handle concurrency."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 4, "creation_date": 1524834950, "post_id": 50060612, "comment_id": 87143013, "body": "<i>Biased and opinionated:</i> choosing Haskell because of hype around to drastically increase the complexity does not sound reasonable enough. <code>NIF</code> will ruin all your type safety (even if it was a goodness) and the number of pitfalls and rakes you are going to step on would make the whole development process a disaster (besides that overcomplicated interoperation would bring more issues than could ever happen in plain old good elixir application.)"}, {"owner": {"reputation": 14292, "user_id": 2820, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/631713865b68894b6bf525e16d817f58?s=128&d=identicon&r=PG", "display_name": "Onorio Catenacci", "link": "https://stackoverflow.com/users/2820/onorio-catenacci"}, "edited": false, "score": 0, "creation_date": 1524840569, "post_id": 50060612, "comment_id": 87146537, "body": "&quot;Would true concurrency be maintained?&quot; is not something which can be answered easily.  It&#39;s not dependent on Haskell and Elixir solely but much more dependent on how the code is written."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1524919987, "post_id": 50060612, "comment_id": 87169566, "body": "Consider <a href=\"https://github.com/jeremyjh/dialyxir\" rel=\"nofollow noreferrer\">github.com/jeremyjh/dialyxir</a> for type-related error detection."}], "answers": [{"tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": true, "score": 3, "last_activity_date": 1525012898, "last_edit_date": 1525012898, "creation_date": 1524838524, "answer_id": 50064327, "question_id": 50060612, "link": "https://stackoverflow.com/questions/50060612/elixir-and-haskell-interoperability/50064327#50064327", "title": "Elixir and Haskell interoperability", "body": "<p>This setup is certainly possible using NIFs and GHC's FFI with a small amount of boilerplate <a href=\"https://wiki.haskell.org/Calling_Haskell_from_C\" rel=\"nofollow noreferrer\">written in C</a>. But <a href=\"http://erlang.org/doc/tutorial/nif.html\" rel=\"nofollow noreferrer\">NIFs are best used for short synchronous computations with no side effects</a> and I get the feeling that that isn't what these operations are. </p>\n\n<p>You'd probably be better off with <a href=\"http://erlang.org/doc/tutorial/cnode.html\" rel=\"nofollow noreferrer\">C Nodes</a> for the Haskell parts of the application. Most of the documentation you'll find for that will be for Erlang and not Elixir, but given Elixir's easy interop with Erlang, it should be pretty straight forward (someone's <a href=\"https://github.com/remiq/elixir-cnode-example/blob/master/src/complex.ex\" rel=\"nofollow noreferrer\">even written an example</a>). Most of the hard work will be to do with writing a Haskell \"C Node\", for which a cursory glance at hackage and github turns up nothing.</p>\n"}], "owner": {"reputation": 1811, "user_id": 1693831, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Pe08p.png?s=128&g=1", "display_name": "category", "link": "https://stackoverflow.com/users/1693831/category"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 50064327, "answer_count": 1, "score": 3, "last_activity_date": 1525012898, "creation_date": 1524825482, "question_id": 50060612, "link": "https://stackoverflow.com/questions/50060612/elixir-and-haskell-interoperability", "title": "Elixir and Haskell interoperability", "body": "<p>As a platform for handling concurrent problems, Elixir/OTP seems to be the best suited solution.</p>\n\n<p>When writing an application with a web interface, consider the case in which I want to reason about, and decouple, the application logic using another functional language - namely haskell (due to benefits like its advanced detection of errors at compile time, static typing, etc). I would then handle concurrency using <code>GenServer</code>s, and attach a web interface using <code>Phoenix.Channel</code>s.</p>\n\n<p>Is this setup even possible using <code>NIF</code>s? Also, would true concurrency be maintained? I'm not sure that I'm following the correct line of reasoning here, but would a new haskell process be able to be spawned in line with <code>GenServer</code> demands, and would the two be able communicate efficiently?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1524824070, "post_id": 50060172, "comment_id": 87136644, "body": "Don&#39;t post pictures of your code. Include the actual code in your question. You can highlight it as a codeblock by selecting it and pressing Ctrl+k."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524833545, "post_id": 50060172, "comment_id": 87142112, "body": "<a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/Data-List.html#v:delete\" rel=\"nofollow noreferrer\"><code>delete</code></a> or <code>drop 1</code>"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1524973711, "post_id": 50060172, "comment_id": 87182188, "body": "i &lt;- [2,3..10] will start  the tuples with (1,2), exactly what you want."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9520433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ryOBH55PtIw/AAAAAAAAAAI/AAAAAAAAACU/N6uPP9RrCgY/photo.jpg?sz=128", "display_name": "StarsLord", "link": "https://stackoverflow.com/users/9520433/starslord"}, "edited": false, "score": 0, "creation_date": 1524826001, "post_id": 50060253, "comment_id": 87137704, "body": "Thanks for your reply."}, {"owner": {"reputation": 11, "user_id": 9520433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ryOBH55PtIw/AAAAAAAAAAI/AAAAAAAAACU/N6uPP9RrCgY/photo.jpg?sz=128", "display_name": "StarsLord", "link": "https://stackoverflow.com/users/9520433/starslord"}, "edited": false, "score": 0, "creation_date": 1524826086, "post_id": 50060253, "comment_id": 87137760, "body": "I understand better now, but where should the filter go.?.  Inside the list comprehension or is one of the arguments a list?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11, "user_id": 9520433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ryOBH55PtIw/AAAAAAAAAAI/AAAAAAAAACU/N6uPP9RrCgY/photo.jpg?sz=128", "display_name": "StarsLord", "link": "https://stackoverflow.com/users/9520433/starslord"}, "edited": false, "score": 0, "creation_date": 1524827342, "post_id": 50060253, "comment_id": 87138508, "body": "If you want to use <code>filter</code>, then it&#39;s <code>filter (predicate function) [ list comprehension ]</code>. Alternatively, you can probably modify your list comprehension to include the filtering condition, and avoid the explicit <code>filter</code>."}, {"owner": {"reputation": 11, "user_id": 9520433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ryOBH55PtIw/AAAAAAAAAAI/AAAAAAAAACU/N6uPP9RrCgY/photo.jpg?sz=128", "display_name": "StarsLord", "link": "https://stackoverflow.com/users/9520433/starslord"}, "edited": false, "score": 0, "creation_date": 1524830936, "post_id": 50060253, "comment_id": 87140514, "body": "Alright thanks, and is the predicate function the rule where  (i,j) /= (1,1)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1524824244, "creation_date": 1524824244, "answer_id": 50060253, "question_id": 50060172, "link": "https://stackoverflow.com/questions/50060172/how-to-exclude-a-particular-tuple-from-a-list-in-haskell/50060253#50060253", "title": "How to exclude a particular tuple from a list in haskell", "body": "<p>Your attempt</p>\n\n<pre><code>Filter ((i,j) /=0) \"the list\"\n</code></pre>\n\n<p>has a few problems, which can be fixed. </p>\n\n<p>First, the function is called <code>filter</code>. Second, its first argument must be a function: so you can use <code>\\(i,j) -&gt; ...</code> to take a list as input. Third, you want <code>(i,j) /= (1,1)</code> -- you can't compare a pair <code>(i,j)</code> to a single number <code>0</code>.</p>\n\n<p>You should now be able to correct your code.</p>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 0, "last_activity_date": 1524858138, "last_edit_date": 1524858138, "creation_date": 1524851110, "answer_id": 50067689, "question_id": 50060172, "link": "https://stackoverflow.com/questions/50060172/how-to-exclude-a-particular-tuple-from-a-list-in-haskell/50067689#50067689", "title": "How to exclude a particular tuple from a list in haskell", "body": "<p>As an alternative to using <code>filter</code>, you can also specify that you don't want <code>(1,1)</code> as an element within your list comprehension by adding a guard expression <code>(i,j) /= (1,1)</code>:</p>\n\n<pre><code>take 10 [ (i,j) | i &lt- [1,2], j &lt- [1..], <b>(i,j) /= (1,1)</b> ]</code></pre>\n\n<p>This is similar to how you might write a set comprehension (which list comprehensions mimic):</p>\n\n<p><a href=\"https://i.stack.imgur.com/FWlXA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FWlXA.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><a href=\"https://stackoverflow.com/a/6067878\">This answer</a> gives a nice example (<code>[x | i &lt;- [0..10], let x = i*i, x &gt; 20]</code>) of the three types of expression you can have in the tail end of a list comprehension:</p>\n\n<ul>\n<li>Generators, eg. <code>i &lt;- [0..10]</code> provide the sources of values.</li>\n<li>Guards, eg. <code>x &gt; 20</code> are arbitrary predicates - for any given values from the generators, the value will only be included in the result if all the predicates hold.</li>\n<li>Local declarations, eg. <code>let x = i*i</code> perform the same task as normal <code>let</code>/<code>where</code> statements.</li>\n</ul>\n\n<p><sup>Names for the different expressions taken from the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch10.html\" rel=\"nofollow noreferrer\">syntax reference</a>, expression <code>qual</code>.</sup></p>\n"}], "owner": {"reputation": 11, "user_id": 9520433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ryOBH55PtIw/AAAAAAAAAAI/AAAAAAAAACU/N6uPP9RrCgY/photo.jpg?sz=128", "display_name": "StarsLord", "link": "https://stackoverflow.com/users/9520433/starslord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524858138, "creation_date": 1524823933, "last_edit_date": 1524825929, "question_id": 50060172, "link": "https://stackoverflow.com/questions/50060172/how-to-exclude-a-particular-tuple-from-a-list-in-haskell", "title": "How to exclude a particular tuple from a list in haskell", "body": "<p>Im very confused on how to filter out the element (1,1) from this list in the code below.</p>\n\n<pre><code>take 10 [ (i,j) | i &lt;- [1,2], \n                  j &lt;- [1..] ]\nyields\n\n[(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,9),(1,10)]\n</code></pre>\n\n<p>My thoughts were to use something like filter but Im not too sure where to implement it.</p>\n\n<p>My go was <code>Filter ((i,j) /=0) \"the list\"</code></p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "math", "recursion"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524824045, "post_id": 50059974, "comment_id": 87136629, "body": "Usually, in defining recursive functions, you change the argument when you perform the recursive call. E.g. <code>f x = 1 + f (x-1)</code>. Instead, above you use something like <code>f x = 1 + f x</code> which will recurse forever."}, {"owner": {"reputation": 29209, "user_id": 495796, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/86637c99f25d60157aa0f2e7eab90148?s=128&d=identicon&r=PG", "display_name": "Robin Green", "link": "https://stackoverflow.com/users/495796/robin-green"}, "edited": false, "score": 0, "creation_date": 1524826100, "post_id": 50059974, "comment_id": 87137774, "body": "This does not look like valid Haskell code. Please <i>copy and paste</i> the latest version of your code - do not type it in, as you may make typos when you do so. Also, if you have more than one function, please include all the functions."}], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 0, "last_activity_date": 1524826886, "creation_date": 1524826886, "answer_id": 50061009, "question_id": 50059974, "link": "https://stackoverflow.com/questions/50059974/cross-sum-operation-in-haskell/50061009#50061009", "title": "cross sum operation in Haskell", "body": "<p>One of the problems with your code is that <code>x</code> is not reduced (or changed somehow) when it's passed as an argument to the recursive call of <code>crosssum</code>. That's why your program never stops.</p>\n\n<p>The modified code:</p>\n\n<pre><code>crosssum :: Int -&gt; Int\ncrosssum x = if x &gt; 0\n             then x `mod` 10 + crosssum (x `div` 10)\n             else 0\n</code></pre>\n\n<p>is going to have the following logic</p>\n\n<pre><code>crosssum 12 = 2 + (crosssum 1) = 2 + (1 + (crosssum 0)) = 2 + 1 + 0\n</code></pre>\n\n<p>By the way, Haskell will help you to avoid <code>if</code> condition by using pattern-matching to receive more readable code:</p>\n\n<pre><code>crosssum :: Int -&gt; Int\ncrosssum 0 = 0\ncrosssum x =\n  (mod x 10) + (crosssum (div x 10))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1527194280, "last_edit_date": 1527194280, "creation_date": 1527022971, "answer_id": 50476413, "question_id": 50059974, "link": "https://stackoverflow.com/questions/50059974/cross-sum-operation-in-haskell/50476413#50476413", "title": "cross sum operation in Haskell", "body": "<p>divMod in Prelude is very handy, too. It's one operation for both <code>div</code> and <code>mod</code>, In fact for all 2 digit numbers <code>dm n = sum.sequence [fst,snd] $ divMod n 10</code></p>\n\n<pre><code>cs 0 = 0;   cs n =  m+ cs d   where (d,m) = divMod n 10 \n</code></pre>\n\n<p>cs will do any size number.</p>\n"}], "owner": {"reputation": 11, "user_id": 9669041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "gewissen", "link": "https://stackoverflow.com/users/9669041/gewissen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1527194280, "creation_date": 1524823332, "last_edit_date": 1524826042, "question_id": 50059974, "link": "https://stackoverflow.com/questions/50059974/cross-sum-operation-in-haskell", "title": "cross sum operation in Haskell", "body": "<p>I need to determine a recursive function crosssum :: Int -> Int in Haskell to calculate the cross sum of positive numbers. I am not allowed to use any functions from the hierarchical library besides (:), (>), (++), (&lt;), (>=), (&lt;=), div, mod, not (&amp;&amp;), max, min, etc.   </p>\n\n<pre><code>crosssum :: Int -&gt; Int \ncross sum x = if x &gt; 0 \n          then x `mod` 10 \n          + x `div` 10 + crosssum x \n          else 0 \n</code></pre>\n\n<p>so whenever I fill in e.g. crosssum 12 it says 'thread killed'. I do not understand how to get this right. I would appreciate any ideas. Thx </p>\n"}, {"tags": ["haskell", "compiler-errors", "find", "predicate"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1524812462, "post_id": 50056998, "comment_id": 87130363, "body": "Looks like you want <a href=\"https://wiki.haskell.org/Function_composition\" rel=\"nofollow noreferrer\">function composition</a>: <code>((x ==) . fst)</code>, where <code>(x ==)</code> is a <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">section</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524814369, "post_id": 50056998, "comment_id": 87131355, "body": "Indeed <code>fst</code> is a variable (even if we often call it an identifier), whose value is a function of type <code>(a,b)-&gt;a</code>. There is absolutely no difference between <code>fst</code> and <code>(fst)</code> in Haskell: both evaluate to the same function value."}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 9214910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22383025a510d1498c6cb790c140763?s=128&d=identicon&r=PG&f=1", "display_name": "Leif Metcalf", "link": "https://stackoverflow.com/users/9214910/leif-metcalf"}, "is_accepted": false, "score": 5, "last_activity_date": 1524813849, "last_edit_date": 1524813849, "creation_date": 1524813018, "answer_id": 50057169, "question_id": 50056998, "link": "https://stackoverflow.com/questions/50056998/why-is-my-predicate-being-interpreted-as-a-boolean-haskell/50057169#50057169", "title": "Why is my predicate being interpreted as a boolean? (Haskell)", "body": "<p><code>(==)</code> has type <code>x -&gt; x -&gt; Bool</code>. In your case, type <code>x</code> is <code>(a, b) -&gt; a</code>. This is because one of it's operands is <code>fst</code>, which has that type. Therefore, the type of <code>(==)</code> in your case is <code>((a, b) -&gt; a) -&gt; ((a, b) -&gt; a) -&gt; Bool</code>. That is, (==) is a function that compares two functions, x and fst.</p>\n\n<p>What you want is to <em>compose</em> <code>fst</code> and <code>(==)</code>. For example, <code>(\\y -&gt; (x == fst y)</code>. This is a function that takes a tuple, <code>y</code>, and checks if <code>x</code> is equal to its first value.</p>\n\n<p>There is a function that composes functions for you, <code>(.)</code>. It takes two functions, f(x) and g(x), and returns another function, f(g(x)). You can use this function for your program like this: <code>find ((x ==) . fst) list</code>.</p>\n\n<p>Compare the following programs, the first written as a lambda function, the second with the function composition operator:</p>\n\n<pre><code>(\\y -&gt; (x == fst y)\n\n-- Compared to:\n       (x ==) . fst\n</code></pre>\n\n<p>Summary:</p>\n\n<p>(==) is comparing two functions, x and fst, and returning a Bool.</p>\n\n<p>What you want instead is a function that takes in a tuple, gets the first item from it, and compares it to x. This can be done with function composition.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 3, "last_activity_date": 1524818284, "creation_date": 1524818284, "answer_id": 50058501, "question_id": 50056998, "link": "https://stackoverflow.com/questions/50056998/why-is-my-predicate-being-interpreted-as-a-boolean-haskell/50058501#50058501", "title": "Why is my predicate being interpreted as a boolean? (Haskell)", "body": "<p>If you want to pass a variable into a particular position, use a lambda function:</p>\n\n<pre><code>(\\ y -&gt; x == fst y)\n</code></pre>\n\n<p>Otherwise the compiler has no idea exactly where you're hoping to insert a variable.</p>\n\n<p>If your function calls <em>one function</em>, you can use currying to take a short cut. But for complex expressions, that doesn't work. You can't just leave off the last term in an expression and expect it to work. It only works for a <em>single function</em>.</p>\n\n<p>The other alternative is to take the function <code>(x ==)</code> and the function <code>fst</code> and chain them with the <code>(.)</code> operator:</p>\n\n<pre><code>((x ==) . fst)\n</code></pre>\n\n<p>It's a matter of personal taste which is \"better\". (There is no performance difference; the only difference is what your source code looks like.)</p>\n"}], "owner": {"reputation": 11, "user_id": 9708620, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215862314301352/picture?type=large", "display_name": "fabikaktus", "link": "https://stackoverflow.com/users/9708620/fabikaktus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524818284, "creation_date": 1524812382, "last_edit_date": 1524812782, "question_id": 50056998, "link": "https://stackoverflow.com/questions/50056998/why-is-my-predicate-being-interpreted-as-a-boolean-haskell", "title": "Why is my predicate being interpreted as a boolean? (Haskell)", "body": "<p>I\u2019m trying to use the find function on a list of pairs, and I want to find the first pair in which the first element equals x, so I wrote:</p>\n\n<pre><code>find (x == fst) list\n</code></pre>\n\n<p>Since the <code>fst</code> function lacks an argument, I thought <code>(x == fst)</code> would be a function that takes in a tuple and returns a boolean, but the compiler interprets it as a boolean, as if <code>fst</code> were a variable. Maybe <code>fst</code> is being interpreted as a function? But doesn\u2019t that require it to be surrounded by ()?</p>\n\n<p>I did solve the problem using a list comprehension instead but I\u2019m still curious as how to one would solve it using find.</p>\n"}, {"tags": ["haskell", "cmd", "ghci"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524797171, "post_id": 50054085, "comment_id": 87125398, "body": "Where&#39;s the <code>exit</code> come from? It&#39;s not exactly clear what you typed and what the system replied. Your OS version is relevant. Your computer model number is irrelevant, and your hardware is probably altogether irrelevant, but it&#39;s never a bad idea to mention the general sort of processor (x86_64, ARM, etc.) when you&#39;re getting strange behavior."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 2, "creation_date": 1524799432, "post_id": 50054085, "comment_id": 87125958, "body": "<a href=\"https://ghc.haskell.org/trac/ghc/ticket/14150\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/14150</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 1, "creation_date": 1524831652, "post_id": 50054085, "comment_id": 87140926, "body": "(1) I also intermittently get this issue with cmd and GHC 8.2.2 -- it&#39;s not just with <code>fix</code>, though I haven&#39;t figured out how to consistently reproduce yet. (2) @ja. Note that the ticked you have linked to is about PowerShell, and not cmd."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524857134, "post_id": 50054085, "comment_id": 87154509, "body": "@duplode, have you opened a ticket for that? Even inconsistent problems are worth looking into, and Tamar Christina is pretty darn good at tracking down pesky Windows trouble."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1524888071, "post_id": 50054085, "comment_id": 87162065, "body": "@dfeuer I&#39;ll do it -- I&#39;ll just wait until I see it again, just to make sure I won&#39;t misremember anything. It shouldn&#39;t take long for it to happen again..."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524831936, "post_id": 50055491, "comment_id": 87141096, "body": "If you are referring to the ticket ja. has linked to in the comments, note that it is about PowerShell, and not cmd. (That might be relevant, given that I have seen that happen with GHC 8.2.2 too.)"}], "tags": [], "owner": {"reputation": 104, "user_id": 826753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32bda212d90f3d131b7f7781f8ac0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Petersen", "link": "https://stackoverflow.com/users/826753/jens-petersen"}, "is_accepted": false, "score": 0, "last_activity_date": 1524835234, "last_edit_date": 1524835234, "creation_date": 1524804989, "answer_id": 50055491, "question_id": 50054085, "link": "https://stackoverflow.com/questions/50054085/haskell-statements-in-ghci-being-interrupted-seems-to-break-cmd/50055491#50055491", "title": "Haskell statements in GHCi being interrupted seems to break cmd", "body": "<p>I think this might be fixed in ghc-8.2.2.</p>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1525071530, "creation_date": 1525071530, "answer_id": 50095413, "question_id": 50054085, "link": "https://stackoverflow.com/questions/50054085/haskell-statements-in-ghci-being-interrupted-seems-to-break-cmd/50095413#50095413", "title": "Haskell statements in GHCi being interrupted seems to break cmd", "body": "<p>It looks like you're running <a href=\"https://www.haskell.org/platform\" rel=\"nofollow noreferrer\">Haskell platform</a> installed on Windows. I used to to that, but these days I run everything through <a href=\"https://docs.haskellstack.org\" rel=\"nofollow noreferrer\">Stack</a>, so I may remember the following incorrectly.</p>\n\n<p>IIRC, though, when you attempt to run <code>ghci</code> in Windows, it explicitly prints a warning that <code>ghci</code> is known to have problems with break commands on Windows, and that you should instead run GHCi via the batch command <code>ghcii.bat</code>.</p>\n\n<p>Back when I used the Haskell platform, I always ran with <code>ghcii.bat</code>, and typically didn't have those problems. I've always used Haskell from within Git Bash, which is my default CLI on Windows, so that could be a determining factor as well.</p>\n\n<p>These days I use Stack on Windows 10, and from within Git Bash, I can't reproduce the problem:</p>\n\n<pre><code>$ stack ghci\nPrelude&gt; :m +Data.Function\nPrelude Data.Function&gt; fix (\\x -&gt; x + 1)\nInterrupted.\nPrelude Data.Function&gt;\n</code></pre>\n\n<p>The <code>Interrupted.</code> line is where I hit <kbd>Ctrl+C</kbd>. When I did that, the blocking application of <code>fix</code> immediately exited, and the REPL was ready for action.</p>\n"}], "owner": {"reputation": 700, "user_id": 5499914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fz53h.png?s=128&g=1", "display_name": "Khuldraeseth na&#39;Barya", "link": "https://stackoverflow.com/users/5499914/khuldraeseth-nabarya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1525071530, "creation_date": 1524793778, "last_edit_date": 1524859190, "question_id": 50054085, "link": "https://stackoverflow.com/questions/50054085/haskell-statements-in-ghci-being-interrupted-seems-to-break-cmd", "title": "Haskell statements in GHCi being interrupted seems to break cmd", "body": "<p>I'm just beginning with Haskell and playing around with GHCi in cmd. After trying out <a href=\"https://codegolf.stackexchange.com/a/19562/73884\">something I saw on PPCG</a>, I ran into an issue. Whenever I interrupt <code>fix</code> with control-C, everything dies:</p>\n\n<pre><code>C:\\Users\\Scrooble&gt;ghci\nGHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; import Data.Function\nPrelude Data.Function&gt; fix (\\x -&gt; x + 1)\nIn^tCerrupte\nd.\nC:\\Users\\Scrooble&gt;Prelude Data.Function&gt; exit\n</code></pre>\n\n<p>(hangs)</p>\n\n<p>The <code>^</code> and <code>C</code> were my keyboard interrupt. The <code>exit</code> is mine as well.</p>\n\n<p><code>Cerrupted</code> is right! What is going on?! I seem to have halfway exited GHCi. When I interrupt the <code>exit</code> (prompt is <code>Prelude Data.Function&gt;</code> again) and <code>:q</code> it, cmd sometimes just closes and sometimes prompts me with <code>C:\\Users\\Scrooble</code> once more; however, when this happens, the first character of all my commands is ignored!</p>\n\n<pre><code>C:\\Users\\Scrooble&gt;exit\n'xit' is not recognized as an internal or external command,\noperable program, or batch file.\n</code></pre>\n\n<p>0.o</p>\n\n<p>Am I alone in this? Is there a <code>fix</code> (ha) (other than not doing stupid things)?</p>\n\n<p>HP ProBook 4535s, with Windows 7 Professional, 64-bit. AMD A4-3300M APU processor.</p>\n\n<p>The same happens in PowerShell as well. In Git Bash, the window freezes after I interrupt the <code>fix</code>.</p>\n\n<h3>Edit:</h3>\n\n<p>I've now experienced this when interrupting other infinite recursion, like my mergesort that (whoops!) didn't treat singletons as necessarily sorted.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524785816, "post_id": 50053141, "comment_id": 87122934, "body": "it is actually a String, when i add a piece to the board, i add it as a string."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786152, "post_id": 50053141, "comment_id": 87123020, "body": "that helps thanks! I&#39;d still like to see example output, though, otherwise it&#39;s impossible to know exactly what you&#39;re looking for."}, {"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786177, "post_id": 50053141, "comment_id": 87123025, "body": "&quot; x  |  piece1piece2|  x  \\n\\ \\ x  |  x  |  x   \\n\\ \\  x |  x  |  piece3piece4  &quot;"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786314, "post_id": 50053141, "comment_id": 87123068, "body": "Edit that into the question please, especially as a code block so it&#39;s easy to see the spacing you want."}, {"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786393, "post_id": 50053141, "comment_id": 87123088, "body": "it should look like a matrix, that&#39;s why i have \\n\\ in my output, but i don&#39;t know how to put a newline here :("}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786484, "post_id": 50053141, "comment_id": 87123120, "body": "type it as you want to see it, select the whole text, and press Ctrl+K (or click the &quot;code block&quot; button in the WYSIWYG editor)"}, {"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786530, "post_id": 50053141, "comment_id": 87123130, "body": "i figured it out. thanks"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786630, "post_id": 50053141, "comment_id": 87123160, "body": "I edited -- does that look right?"}, {"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786755, "post_id": 50053141, "comment_id": 87123194, "body": "yes it looks ok"}, {"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524786797, "post_id": 50053141, "comment_id": 87123207, "body": "the output is a String, I think i should have mentioned that"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "edited": false, "score": 0, "creation_date": 1524818758, "post_id": 50055253, "comment_id": 87133612, "body": "Thanks for your help. I am going to try it out"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1524803232, "creation_date": 1524803232, "answer_id": 50055253, "question_id": 50053141, "link": "https://stackoverflow.com/questions/50053141/printing-a-game-board-using-a-data-map/50055253#50055253", "title": "Printing a game board using a Data.Map", "body": "<p>I'm going to start off with the import of <code>Data.Map.Strict</code>. Generally the way to do it is</p>\n\n<pre><code>import qualified Data.Map.Strict as M\nimport Data.Map.Strict (Map)\n</code></pre>\n\n<p>You have a <code>Map (Int, Int) String</code>, and you need to print out a square array of strings. It seems that the first thing you need to do is calculate the dimensions of the array. We can do that with an indexed fold. It looks like a good one for the job is</p>\n\n<pre><code>foldlWithKey' :: (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a\n</code></pre>\n\n<p>Hrmm... Those type variables aren't very informative. Let me relabel them:</p>\n\n<pre><code>foldlWithKey'\n  :: (acc -&gt; key -&gt; elem -&gt; acc)\n  -&gt; acc\n  -&gt; Map key elem\n  -&gt; acc\n</code></pre>\n\n<p>This function takes an initial value of an accumulator, and a function indicating how to modify that accumulator for each key and element in the map. Let's make a type representing the dimensions of the board:</p>\n\n<pre><code>data Dim = Dim { rows :: !Int, cols :: !Int }\n</code></pre>\n\n<p>Now we can write</p>\n\n<pre><code>getDim :: Map (Int, Int) a -&gt; Dim\ngetDim = M.foldlWithKey' update (Dim 0 0)\n  where\n    update (Dim rs cs) (r, c) _\n      = Dim (max rs (r + 1)) (max cs (c + 1))\n</code></pre>\n\n<p>For each entry in the <code>Map</code>, we adjust the row and column counts as necessary.</p>\n\n<p>Now that we know the dimensions of the board, let's build a representation of it that will be more suitable for printing. The simplest way to do this is probably to iterate over the row and column numbers, looking up the pairs in the map. Let's start by writing a function to get a single row:</p>\n\n<pre><code>getRow :: Int -&gt; Dim -&gt; Map (Int, Int) a -&gt; [Maybe a]\ngetRow r (Dim {cols = cs}) m =\n  [ M.lookup (r, c) | c &lt;- [0 .. cs - 1] ]\n</code></pre>\n\n<p>Here <code>Nothing</code> means that the key was not in the map, and <code>Just whatever</code> means it was.</p>\n\n<p>Now we can use that to get all the rows:</p>\n\n<pre><code>getRows :: Dim -&gt; Map (Int, Int) a -&gt; [[Maybe a]]\ngetRows dim@(Dim {rows = rs}) m =\n  [ getRow r dim m | r &lt;- [0 .. rs - 1] ]\n</code></pre>\n\n<p>Now we can think about displaying! I'm going to leave this to you, but I suggest you consider using <code>Data.List.intercalate</code> and <code>map</code> to turn each row into a string.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "edited": false, "score": 0, "creation_date": 1524818825, "post_id": 50055557, "comment_id": 87133646, "body": "Thank you. I am going to try and understand and modify if i need to. It is a very good starting point"}], "tags": [], "owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "is_accepted": false, "score": 1, "last_activity_date": 1524809677, "last_edit_date": 1524809677, "creation_date": 1524805431, "answer_id": 50055557, "question_id": 50053141, "link": "https://stackoverflow.com/questions/50053141/printing-a-game-board-using-a-data-map/50055557#50055557", "title": "Printing a game board using a Data.Map", "body": "<p>Here's some code that will get you started.  It works by iterating over the (row,column) coords of the board.  In the iteration it looks up the string to print for that location, defaulting to \"x\" on failure.   Finally the board is printed one row at a time. </p>\n\n<p>The final format is not exactly what you had in mind but it should get you most of the way there.</p>\n\n<pre><code>import Data.Map as DM\nimport Data.Maybe\nimport Data.List.Split\n\n\nmain = do\n  let pieces = fromList [ ( (0,1) , [\"piece1\", \"piece2\"] )\n                        , ( (2,2) , [\"piece3\", \"piece4\"] ) ]\n\n      -- prepare piece name lists for printing\n      p2 = fmap concat pieces  \n\n      height = 3\n      width = 3\n\n      -- iterate over board in row/column order\n      -- lookup name - use \"x\" if not found\n      namesInOrder = [fromMaybe \"x\" $ DM.lookup (row,col) p2\n                         | row &lt;- [0..height-1]\n                         , col &lt;- [0..width-1]\n                     ]\n\n\n      -- split into chunks of one row each\n      rows = chunksOf width namesInOrder\n\n  -- print each row on its own line\n  mapM print rows\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9611550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70161ceac2ba17a62a4b911ae5e1381e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/9611550/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524809677, "creation_date": 1524784629, "last_edit_date": 1524786621, "question_id": 50053141, "link": "https://stackoverflow.com/questions/50053141/printing-a-game-board-using-a-data-map", "title": "Printing a game board using a Data.Map", "body": "<p>I have a <code>Data.Map (Int, Int) [String]</code> representing the board of a game (I assume that at a position on the map there can be more than one piece). Let's say that i have the following Map:</p>\n\n<pre><code>fromList [ ( (0,1) , [\"piece1\", \"piece2\"] )\n         , ( (2,2) , [\"piece3\", \"piece4\"] ) ]\n</code></pre>\n\n<p>What I am trying to do is printing the table, in this case a 3 X 3 table, with the elements of the map at the position specified while the rest of the spaces are empty or have an 'x'. I have tried to use foldl and map and combinations of the 2 but I just don't get it how i should do it. I have to mention that i am very new to Haskell. Any help would be great!</p>\n\n<p>Output should be:</p>\n\n<pre><code>x | piece1piece2 | x\nx | x | x\nx | x | piece3piece4\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1524776749, "post_id": 50051766, "comment_id": 87120054, "body": "What would the type signature of your monadic <code>maximumBy</code> be?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1524776804, "post_id": 50051766, "comment_id": 87120080, "body": "Translating from non-monadic to monadic functions is often useful, especially when the function in question is lazy in some interesting way. For example, <code>ifM</code> is useful and has to be written by hand (as opposed to, say, <code>liftA3 if&#39;</code>), because it will avoid doing one or the other of the effects in the two branches. But <code>maximumBy</code> has to look at the entire list; so there&#39;s no interesting laziness to preserve. Just use standard monadic combinators like <code>mapM</code> to do all the effects up front, then do your pure calculation afterwards."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 1, "creation_date": 1524777942, "post_id": 50051766, "comment_id": 87120580, "body": "I may be misunderstanding but will this approach allow strict folds to run without space leaks?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524780745, "post_id": 50051766, "comment_id": 87121590, "body": "@sevo Good point, that&#39;s another consideration that may make it worthwhile to hand-roll a monadic version."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1525789919, "post_id": 50062965, "comment_id": 87489521, "body": "Why not upgrade from <code>Fold</code> to <code>FoldM</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1525797849, "post_id": 50062965, "comment_id": 87494327, "body": "@dfeuer I don&#39;t really understand the question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1525801753, "post_id": 50062965, "comment_id": 87496260, "body": "The <code>Fold.maximum</code> in the question comes from <code>foldl-Control.Foldl</code>, which offers a <code>Fold</code> type (whose <code>fold</code> operation is re-exported by <code>Turtle</code>) but also a <code>FoldM</code> type. Both of these have <code>Applicative</code> instances to combine folds &quot;in parallel&quot;. It should be possible to express the effectful maximum as a <code>FoldM</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1525804415, "post_id": 50062965, "comment_id": 87497705, "body": "@dfeuer Sounds like a fun answer. You should add it!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1525807270, "post_id": 50062965, "comment_id": 87499168, "body": "I just did. It&#39;s fairly similar to yours, although I return a <code>Maybe</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1524834026, "creation_date": 1524834026, "answer_id": 50062965, "question_id": 50051766, "link": "https://stackoverflow.com/questions/50051766/what-would-an-idiomatic-monadic-version-of-maximumby-look-like/50062965#50062965", "title": "What would an idiomatic, monadic version of maximumBy look like?", "body": "<p>So I know nothing about Turtle; no idea whether this fits well with the rest of the Turtle ecosystem. But since you convinced me in the comments that <code>maximumByM</code> is worth writing by hand, here's how I would do it:</p>\n\n<pre><code>maximumOnM :: (Monad m, Ord b) =&gt; (a -&gt; m b) -&gt; [a] -&gt; m a\nmaximumOnM cmp [x] = return x -- skip the effects if there's no need for comparison\nmaximumOnM cmp (x:xs) = cmp x &gt;&gt;= \\b -&gt; go x b xs where\n    go x b [] = return x\n    go x b (x':xs) = do\n        b' &lt;- cmp x'\n        if b &lt; b' then go x' b' xs else go x b xs\n</code></pre>\n\n<p>I generally prefer the *On versions of things -- which take a function that maps to an <code>Ord</code>erable element -- to the *By versions -- which take a function that does the comparison directly. A <code>maximumByM</code> would be similar but have a type like <code>Monad m =&gt; (a -&gt; a -&gt; m Ordering) -&gt; [a] -&gt; m a</code>, but this would likely force you to redo effects for each <code>a</code>, and I'm guessing it's not what you want. I find *On more often matches with the thing I want to do and the performance characteristics I want.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1525748876, "post_id": 50223091, "comment_id": 87467774, "body": "Orphan instances are evil, and that instance doesn&#39;t even make sense. You probably meant <code>minBound = Nothing; maxBound = Just maxBound</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1525798585, "post_id": 50223091, "comment_id": 87494723, "body": "Per my answer on your other question, I would recommend <code>maxLengthIO = foldMap (Ap . fmap Finite . f)</code>, using Data.Monoid.Inf.Finite. Way fewer gymnastics required, plus it uses the modern <code>Foldable</code> idiom that has supplanted the reducers package."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1525881766, "post_id": 50223091, "comment_id": 87533120, "body": "Please allow some time whyle my brain tries to comprehend but this looks like perfect answer! I had no idea that Foldable has supplanted the reducers package!"}], "tags": [], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "is_accepted": false, "score": 0, "last_activity_date": 1525793998, "last_edit_date": 1525793998, "creation_date": 1525730569, "answer_id": 50223091, "question_id": 50051766, "link": "https://stackoverflow.com/questions/50051766/what-would-an-idiomatic-monadic-version-of-maximumby-look-like/50223091#50223091", "title": "What would an idiomatic, monadic version of maximumBy look like?", "body": "<p>It's possible to run effects on foldables using reducers package.</p>\n\n<p>I'm not sure if it's correct, but it leverages existing combinators and instances (except for <code>Bounded (Maybe a)</code>).</p>\n\n<pre><code>import Data.Semigroup.Applicative (Ap(..))\nimport Data.Semigroup.Reducer (foldReduce)\nimport Data.Semigroup (Max(..))\nimport System.IO (withFile, hFileSize, IOMode(..))\n\n-- | maxLength\n--\n-- &gt;&gt;&gt; getMax $ maxLength [\"abc\",\"a\",\"hello\",\"\"]\n-- 5\nmaxLength :: [String] -&gt; (Max Int)\nmaxLength = foldReduce . map (length)\n\n-- | maxLengthIO\n--\n-- Note, this runs IO...\n--\n-- &gt;&gt;&gt; (getAp $ maxLengthIO [\"package.yaml\", \"src/Lib.hs\"]) &gt;&gt;= return . getMax\n-- Just 1212\n--\n-- &gt;&gt;&gt; (getAp $ maxLengthIO []) &gt;&gt;= return . getMax\n-- Nothing\nmaxLengthIO :: [String] -&gt; Ap IO (Max (Maybe Integer))\nmaxLengthIO xs = foldReduce (map (fmap Just . f) xs) where\n    f :: String -&gt; IO Integer\n    f s = withFile s ReadMode hFileSize\n\ninstance Ord a =&gt; Bounded (Maybe a) where\n    maxBound = Nothing\n    minBound = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1525883322, "post_id": 50240888, "comment_id": 87533983, "body": "Nice! <code>f a</code> effect in the first pattern is lazily evaluated! Is that guaranteed, though?"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1525883534, "post_id": 50240888, "comment_id": 87534102, "body": "Applicative version is awesome, but can it break &quot;stability&quot; of results when they are equal in the eyes of combining function?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1525883755, "post_id": 50240888, "comment_id": 87534232, "body": "@sevo, I think I fixed the type error. Haven&#39;t tried compiling it yet. What do you mean about stability?"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1525885332, "post_id": 50240888, "comment_id": 87535045, "body": "Since Applicative can run effects in parallel, the IO effects may be completed in different order than they appear in the input. In such case, of two &quot;equal&quot; elements, the one that appears first in the input should be always picked. I was wondering whether foldM has this property."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 1, "creation_date": 1525897723, "post_id": 50240888, "comment_id": 87541108, "body": "@sevo, the <code>Applicative</code> instance for <code>FoldM</code> is entirely deterministic. It runs the effects for an element in order, from left to right, then moves on to the next element."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1525883707, "last_edit_date": 1525883707, "creation_date": 1525807188, "answer_id": 50240888, "question_id": 50051766, "link": "https://stackoverflow.com/questions/50051766/what-would-an-idiomatic-monadic-version-of-maximumby-look-like/50240888#50240888", "title": "What would an idiomatic, monadic version of maximumBy look like?", "body": "<p>Since you're already familiar with <code>Fold</code>, you might want to get to know <code>FoldM</code>, which is similar.</p>\n\n<pre><code>data FoldM m a b =\n  -- FoldM step initial extract\n  forall x . FoldM (x -&gt; a -&gt; m x) (m x) (x -&gt; m b)\n</code></pre>\n\n<p>You can write:</p>\n\n<pre><code>maximumOnM ::\n  (Ord b, Monad m)\n  =&gt; (a -&gt; m b) -&gt; FoldM m a (Maybe a)\nmaximumOnM f = FoldM combine (pure Nothing) (fmap snd)\n  where\n    combine Nothing a = do\n      f_a &lt;- f a\n      pure (Just (f_a, a))\n    combine o@(Just (f_old, old)) new = do\n      f_new &lt;- f new\n      if f_new &gt; f_old\n        then pure $ Just (f_new, new)\n        else pure o\n</code></pre>\n\n<p>Now you can use <code>Foldl.foldM</code> to run the fold on a list (or other <code>Foldable</code> container). Like <code>Fold</code>, <code>FoldM</code> has an <code>Applicative</code> instance, so you can combine multiple effectful folds into one that interleaves the effects of each of them and combines their results.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 50062965, "answer_count": 3, "score": 1, "last_activity_date": 1525883707, "creation_date": 1524776418, "last_edit_date": 1524776512, "question_id": 50051766, "link": "https://stackoverflow.com/questions/50051766/what-would-an-idiomatic-monadic-version-of-maximumby-look-like", "title": "What would an idiomatic, monadic version of maximumBy look like?", "body": "<p>How can I get a maximum element of an effectful container where computing attribute to compare against also triggers an effect?</p>\n\n<p>There has to be more readable way of doing things like:</p>\n\n<pre><code>latest dir = Turtle.fold (z (ls dir)) Fold.maximum\n\nz :: MonadIO m =&gt; m Turtle.FilePath -&gt; m (UTCTime, Turtle.FilePath)\nz mx = do\n    x &lt;- mx\n    d &lt;- datefile x\n    return (d, x)\n</code></pre>\n\n<p>I used overloaded version rather than non-overloaded <code>maximumBy</code> but the latter seems better suite for ad-hoc attribute selection. </p>\n\n<p>How can I be more methodic in solving similar problems?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10550, "user_id": 633094, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8FbW8.jpg?s=128&g=1", "display_name": "munk", "link": "https://stackoverflow.com/users/633094/munk"}, "edited": false, "score": 1, "creation_date": 1524776139, "post_id": 50051674, "comment_id": 87119728, "body": "I, for one, support this grumpy face syntax <code>(&gt;,&lt;)</code>"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1524904427, "post_id": 50051674, "comment_id": 87165358, "body": "There are <i>shorter</i> ways to write <code>maxmin</code>\u2014@melpomene\u2019s answer, which puts the function (<code>(&lt;)</code> or <code>(&gt;)</code>) first so the <code>x</code> and <code>y</code> parameters can be elided, is a good one\u2014but probably not any <i>clearer</i> way. For example, you can do some point-free code golf and write their function as <code>select = liftA2 (&lt;*&gt;) (flip bool)</code> using <code>bool</code> from <code>Data.Bool</code>, which expands to <code>select f x y = if f x y then x else y</code>. <i>Sometimes</i> that kind of trickery is profitable, but usually in Haskell it\u2019s much clearer to just write the explicit guards or <code>if</code>."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 10, "last_activity_date": 1524776158, "creation_date": 1524776158, "answer_id": 50051714, "question_id": 50051674, "link": "https://stackoverflow.com/questions/50051674/possibility-of-having-parameterized-definitions-in-haskell/50051714#50051714", "title": "Possibility of having parameterized definitions in haskell?", "body": "<p>Well, you can always do this:</p>\n\n<pre><code>select op x y\n    | x `op` y  = x\n    | otherwise = y\n\nmax' = select (&gt;)\nmin' = select (&lt;)\n</code></pre>\n\n<p>I.e. extract the common parts into a function and turn the differences into parameters.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524776368, "creation_date": 1524776012, "last_edit_date": 1524776368, "question_id": 50051674, "link": "https://stackoverflow.com/questions/50051674/possibility-of-having-parameterized-definitions-in-haskell", "title": "Possibility of having parameterized definitions in haskell?", "body": "<p>Is there a way to compactly write multiple definitions in haskell via case, without having to repeat, other than the input parameters, the exact same syntax?  The only possible solution I can imagine so far is a macro.</p>\n\n<p>Below is an example of defining binary max and min functions.  Can we compress</p>\n\n<pre><code>max' x y\n  | x &gt; y = x\n  | otherwise = y\n\nmin' x y\n  | x &lt; y = x\n  | otherwise = y\n</code></pre>\n\n<p>into something like</p>\n\n<pre><code>(max',min') x y\n  | x (&gt;,&lt;) y = x\n  | otherwise = y\n</code></pre>\n\n<p>?</p>\n\n<p>Edit: </p>\n\n<p>I know this allows us to parametrize over the \"grumpy face\", but it seems like there still could be a more succinct form.</p>\n\n<pre><code>maxmin x y f\n  | f x y = x\n  | otherwise = y\n\nmax' x y = maxmin x y (&gt;)\nmin' x y = maxmin x y (&lt;)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1524772913, "post_id": 50050986, "comment_id": 87118348, "body": "That is the exhaustive search approach, but this will run exponential in the size of the graph. I propose that you take a look at Dijkstra&#39;s algorithm, but drop the minimality constraint."}, {"owner": {"reputation": 81, "user_id": 9647005, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Martin Piala", "link": "https://stackoverflow.com/users/9647005/martin-piala"}, "edited": false, "score": 0, "creation_date": 1524794604, "post_id": 50050986, "comment_id": 87124886, "body": "To find all paths from start node to end node you have to look through all paths from start node anyway. So my approach would be to find all possible paths from start node (beware of cycles!) and filter out only ones containing the end node. You should look up the Depth-first search algorithm (DFS) because it is a recursive algorithm, so it would not be that hard to implement in Haskell"}], "owner": {"reputation": 79, "user_id": 9100632, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7d9e4330b31df99d14f50e92ad0ff51c?s=128&d=identicon&r=PG&f=1", "display_name": "nwelch", "link": "https://stackoverflow.com/users/9100632/nwelch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524777206, "creation_date": 1524772819, "last_edit_date": 1524777206, "question_id": 50050986, "link": "https://stackoverflow.com/questions/50050986/haskell-find-a-path-through-declared-graph-type", "title": "Haskell - Find a path through declared graph Type", "body": "<pre><code>type Node = Integer\ntype Edge = (Integer, Integer)\ntype Graph = [Edge]\ntype Path = [Node]\n\ng :: Graph\ng = [(1,2), (1,3), (2,3), (2,4), (3,4)]\nh :: Graph\nh = [(1,2), (1,3), (2,1), (3,2), (4,4)]\n</code></pre>\n\n<p>For an assignment, we are working with the defined types above and have to implement a few functions. Currently I'm trying to write a function called paths which will return a list of all possible cycle-free paths. So for example if I called <code>paths 1 4 g</code> the output would be <code>=&gt; [[1,2,3,4], [1,2,4], [1,3,4]]</code></p>\n\n<p>I have an already written function for returning the adjacent nodes of a given node. </p>\n\n<pre><code>adjacent :: Node -&gt; Graph -&gt; [Node]\nadjacent n gr = [ y | (x, y) &lt;- gr, x == n]\n</code></pre>\n\n<p>I'm having trouble getting started. I believe I will need to use adjacent to get each of the adjacent nodes and then the adjacent nodes to those nodes until I finish my destination node. Just wondering if I'm on the right track or some helpful guidance, thanks!</p>\n\n<p><em>EDIT</em> So just wanted to post an update. Been searching around and found a way to build a list of all paths from a starting node...</p>\n\n<pre><code>allPaths :: Node -&gt; Graph -&gt; [Path]\nallPaths startNode graph = map (startNode:) (go startNode)\n  where\n    go curNode =\n      case [ snd node | node &lt;- graph, fst node == curNode ] of\n        [] -&gt; [[]]\n        nextNodes -&gt; [ nextNode : path | nextNode &lt;- nextNodes, path &lt;- go nextNode ]\n</code></pre>\n\n<p>When adding in a end Node, is there a way to only return the paths that reach this end node?</p>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "edited": false, "score": 1, "creation_date": 1524862293, "post_id": 50050568, "comment_id": 87156728, "body": "It turns out that my <i>actual</i> problem was that I was defining <code>toEncoding</code> but not <code>toJSON</code>, which meant that the auto-generated <code>toJSON</code> was being used instead of the code I wrote."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1524771916, "last_edit_date": 1524771916, "creation_date": 1524771216, "answer_id": 50050664, "question_id": 50050568, "link": "https://stackoverflow.com/questions/50050568/can-i-reuse-tojson-and-fromjson-instances-between-data-aeson-and-data-yaml/50050664#50050664", "title": "Can I reuse ToJSON and FromJSON instances between Data.Aeson and Data.Yaml?", "body": "<p><strong>Short answer</strong>: the <code>ToJSON</code> (and <code>FromJSON</code>) typeclasses of <code>Data.Aeson</code> and <code>Data.Yaml</code> <strong>are the same</strong>. <code>Data.Yaml</code> actually only performs a <strong><em>reimport</em></strong> of the <code>ToJSON</code> typeclass of <code>Data.Aeson</code>.</p>\n\n<p>If we look at the <a href=\"https://hackage.haskell.org/package/yaml-0.8.29/docs/src/Data-Yaml.html\" rel=\"nofollow noreferrer\"><strong><code>Data.Yaml</code></strong> source code</a>:</p>\n\n<blockquote><pre><code>#if (defined (ghcjs_HOST_OS))\nmodule Data.Yaml {-# WARNING \"GHCJS is not supported yet (will break at runtime once called).\" #-}\n#else\n<b>module Data.Yaml</b>\n#endif\n    ( -- * Types\n      Value (..)\n    , Parser\n    , Object\n    , Array\n    , ParseException(..)\n    , prettyPrintParseException\n    , YamlException (..)\n    , YamlMark (..)\n      -- * Constructors and accessors\n    , object\n    , array\n    , (.=)\n    , (.:)\n    , (.:?)\n    , (.!=)\n      -- ** With helpers (since 0.8.23)\n    , withObject\n    , withText\n    , withArray\n    , withScientific\n    , withBool\n      -- * Parsing\n    , parseMonad\n    , parseEither\n    , parseMaybe\n      -- * Classes\n    <b>, ToJSON (..)\n    , FromJSON (..)</b>\n      -- * Encoding/decoding\n    , encode\n    , encodeFile\n    , decode\n    , decodeFile\n      -- ** Better error information\n    , decodeEither\n    , decodeEither'\n    , decodeFileEither\n      -- ** More control over decoding\n    , decodeHelper\n    ) where\n#if !MIN_VERSION_base(4,8,0)\nimport Control.Applicative(())\n#endif\nimport Control.Exception\n<b>import Data.Aeson</b>\n    ( Value (..), <b>ToJSON (..), FromJSON (..)</b>, object\n    , (.=) , (.:) , (.:?) , (.!=)\n    , Object, Array\n    , withObject, withText, withArray, withScientific, withBool\n    )</code></pre>(...)</blockquote>\n\n<p>So the module exports a <code>ToJSON</code> typeclass, but this is only the result of a <code>ToJSON</code> import of <code>Data.Aeson</code>, hence the typeclass is actually the very same.</p>\n\n<p>So it is reimported for programmer convenience (you for instance do not have to import <code>Data.Aeson</code> only to implement <code>FromJOSN</code> for example), but in fact you still work with the same types, the same type classes, etc. After all your <code>ToJSON</code> and <code>Y.ToJSON</code> refer to the <em>same</em> typeclass.</p>\n\n<p>Since the two are actually the same, you can not instantiate the same typeclass twice for the same type, but we do not need to do that: if we implement it for <code>Data.Aeson</code> (or <code>Data.Yaml</code>), that is sufficient, since the typeclass constraints that are for instance written in <code>Data.Yaml</code> (or <code>Data.Aeson</code>) will succeed. A consequence is that we can not (at least not without some tricks), implement <code>ToJSON</code> differently for <code>Data.Yaml</code> than for <code>Data.Aeson</code>.</p>\n"}], "owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 50050664, "answer_count": 1, "score": 2, "last_activity_date": 1524771916, "creation_date": 1524770776, "question_id": 50050568, "link": "https://stackoverflow.com/questions/50050568/can-i-reuse-tojson-and-fromjson-instances-between-data-aeson-and-data-yaml", "title": "Can I reuse ToJSON and FromJSON instances between Data.Aeson and Data.Yaml?", "body": "<p>Data.Aeson and Data.Yaml are libraries for working with JSON and YAML, respectively, which have nearly identical interfaces. I have written \u201cAeson-based\u201d <code>FromJSON</code> and <code>ToJSON</code> instances for some of my types:</p>\n\n<pre><code>import Data.Aeson\n\ndata PropertyValue = Nested Microformat | Flat Text\n    deriving (Generic, Show)\n\ninstance ToJSON PropertyValue where\n    toEncoding = genericToEncoding defaultOptions { sumEncoding = UntaggedValue }\n\ninstance FromJSON PropertyValue where\n    parseJSON = genericParseJSON defaultOptions { sumEncoding = UntaggedValue }\n</code></pre>\n\n<p>and while Aeson uses these instances, Yaml seems to ignore them. (Specifically, I believe that Yaml is automatically generating encoders and decoders thanks to the fact that my type derives <code>Generic</code>.) I tried to make the instances work with Yaml as well by changing my code to</p>\n\n<pre><code>import Data.Aeson\nimport qualified Data.Yaml as Y\n\ndata PropertyValue = Nested Microformat | Flat Text\n    deriving (Generic, Show)\n\ninstance ToJSON PropertyValue where\n    toEncoding = genericToEncoding defaultOptions { sumEncoding = UntaggedValue }\n\ninstance FromJSON PropertyValue where\n    parseJSON = genericParseJSON defaultOptions { sumEncoding = UntaggedValue }\n\ninstance Y.ToJSON PropertyValue where\n    toEncoding = genericToEncoding defaultOptions { sumEncoding = UntaggedValue }\n\ninstance Y.FromJSON PropertyValue where\n    parseJSON = genericParseJSON defaultOptions { sumEncoding = UntaggedValue }\n</code></pre>\n\n<p>but GHC complained:</p>\n\n<pre><code>Duplicate instance declarations:\n  instance ToJSON PropertyValue\n    -- Defined at src/Microformats.hs:54:10\n  instance ToJSON PropertyValue\n    -- Defined at src/Microformats.hs:60:10\n</code></pre>\n\n<p>Is it not possible to define instances for two different classes that happen to have the same name? Or is Yaml\u2019s <code>ToJSON</code> actually the <em>same</em> class as Aeson\u2019s somehow?</p>\n\n<p>More to the point, is it possible to reuse my <code>ToJSON</code> and <code>FromJSON</code> instances to avoid having to write the same code twice? Failing that, is it at least possible to write instances of both libraries\u2019 <code>ToJSON</code> and <code>FromJSON</code> without confusing the compiler?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524770330, "post_id": 50050431, "comment_id": 87117103, "body": "This is actually not an <code>upsert</code>, but a <code>repsert</code> I think."}, {"owner": {"reputation": 3418, "user_id": 738762, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0ef9a1ef193431ba6a0e2fc5c71ab22d?s=128&d=identicon&r=PG", "display_name": "nomen", "link": "https://stackoverflow.com/users/738762/nomen"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524770628, "post_id": 50050431, "comment_id": 87117231, "body": "@WillemVanOnsem I am not sure what you mean.  The <code>upsert</code> documentation says that an <code>upsert</code> with an empty list passed in the second argument (as in <code>upsert val []</code>) is equivalent to a <code>repsert</code> that uses the Uniqueness constraint as a key."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524770658, "post_id": 50050431, "comment_id": 87117247, "body": "anyway, it is perhaps a good idea to look for the log of the <i>response body</i>. We only see the request here. It is possible that for example the query goes wrong, but we do not see that."}, {"owner": {"reputation": 3418, "user_id": 738762, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0ef9a1ef193431ba6a0e2fc5c71ab22d?s=128&d=identicon&r=PG", "display_name": "nomen", "link": "https://stackoverflow.com/users/738762/nomen"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524770775, "post_id": 50050431, "comment_id": 87117308, "body": "@WillemVanOnsem Good suggestion.  The response body does not reflect the changes I&#39;m trying to save."}], "answers": [{"tags": [], "owner": {"reputation": 223, "user_id": 8198583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X2yJ0.png?s=128&g=1", "display_name": "ncaq", "link": "https://stackoverflow.com/users/8198583/ncaq"}, "is_accepted": false, "score": 0, "last_activity_date": 1530328277, "last_edit_date": 1530328277, "creation_date": 1530324626, "answer_id": 51111183, "question_id": 50050431, "link": "https://stackoverflow.com/questions/50050431/persistent-upsert-isnt-working/51111183#51111183", "title": "Persistent `upsert` isn&#39;t working", "body": "<p>I think upsert comment is bug.\nI opened pull request <a href=\"https://github.com/yesodweb/persistent/pull/821\" rel=\"nofollow noreferrer\">added: PersistentTest: upsert fail, it expected equivalent repsert by ncaq \u00b7 Pull Request #821 \u00b7 yesodweb/persistent</a></p>\n\n<p>upsert do not update when two argument list is empty.</p>\n\n<p>If you want unique of repsert.\nThis code created by me, you can use with stack overflow cc license.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | if a record exist by unique, then 'replace', else 'insert'\nrepsertBy :: ( PersistEntityBackend record ~ BaseBackend backend\n             , PersistStoreWrite backend\n             , PersistEntity record\n             , PersistUniqueRead backend\n             , MonadIO m) =&gt;\n             record -&gt; ReaderT backend m (Key record)\nrepsertBy record = do\n    me &lt;- getByValue record\n    case me of\n        Nothing             -&gt; insert record\n        Just (Entity key _) -&gt; replace key record &gt;&gt; return key\n</code></pre>\n\n<p>But, this code rejected at Yesod mainstream.\nBecause, when multiple unique constants exist then undefined.</p>\n"}], "owner": {"reputation": 3418, "user_id": 738762, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0ef9a1ef193431ba6a0e2fc5c71ab22d?s=128&d=identicon&r=PG", "display_name": "nomen", "link": "https://stackoverflow.com/users/738762/nomen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530328277, "creation_date": 1524770169, "question_id": 50050431, "link": "https://stackoverflow.com/questions/50050431/persistent-upsert-isnt-working", "title": "Persistent `upsert` isn&#39;t working", "body": "<p>I am apparently confused about Persistent's <code>upsert</code> function and how it works with Postgres 9.5.</p>\n\n<p>I am writing a Yesod app that takes in a JSON value, parses it, and then does an <code>upsert</code> on the appropriate database table.  I have verified that the JSON gets parsed into a valid value.  See the code:</p>\n\n<pre><code>postITSClientsR :: Handler TypedContent\npostITSClientsR = do\n  i &lt;- requireJsonBody :: Handler IntensiveTreatmentClient\n  row &lt;- runDB $ upsert i []\n  selectRep . provideJson $ row\n</code></pre>\n\n<p>I have also verified that this model type has a Uniqueness constraint:</p>\n\n<pre><code>IntensiveTreatmentClient json\n  clientId ClientId\n  UniqueIntensiveTreatmentClientClientId clientId\n  etc...\n</code></pre>\n\n<p>However, my new value isn't getting saved.  I have verified this a few times, but the Yesod log is probably the most telling, since it reports:</p>\n\n<pre><code>POST /api/itsClients\n  Params: [(\"{\\\"clientId\\\":1,...\",\"\")]\n  Request Body: {\"clientId\":1,...}\n  Accept: */*\n  Status: 200 OK 0.005041s\n</code></pre>\n\n<p>(Fields have been purposefully removed to anonymize)  Typically, the log would report the SQL query that got run, and this isn't reporting any.</p>\n\n<p>What is going on?  Yesod or Persistent are just silently dropping my query with no error.</p>\n"}, {"tags": ["haskell", "haskell-turtle"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524769780, "post_id": 50050325, "comment_id": 87116858, "body": "Well they added a monadic variant, since in Turtle, you usually perform monadic actions."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1524772804, "last_edit_date": 1524772804, "creation_date": 1524771807, "answer_id": 50050772, "question_id": 50050325, "link": "https://stackoverflow.com/questions/50050325/should-i-use-folds-in-turtle-or-foldl-packages/50050772#50050772", "title": "Should I use folds in Turtle or Foldl packages?", "body": "<p>(First of all, the folds we are talking about here are not the <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Foldable.html#v:foldr\" rel=\"nofollow noreferrer\">foldr</a> <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Foldable.html#v:foldl\" rel=\"nofollow noreferrer\">foldl</a> <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Foldable.html#v:foldl-39-\" rel=\"nofollow noreferrer\">foldl'</a> functions from <code>Data.Foldable</code>, they are from the <a href=\"http://hackage.haskell.org/package/foldl\" rel=\"nofollow noreferrer\">foldl</a> package, which is <em>conceptually</em> related to the <code>foldl'</code> function from the <code>Data.Foldable</code>, as a sort of versatile generalization, but has separate definitions.)</p>\n\n<p>The <a href=\"http://hackage.haskell.org/package/foldl-1.4.0/docs/Control-Foldl.html#t:Fold\" rel=\"nofollow noreferrer\"><code>Fold</code></a> datatype repesents a strict, stateful operation to perform on an incoming sequence of values. Its <code>Applicative</code> instance lets you run two operations combined on the same sequence of values. <code>Fold</code>s have the nice property that they are agnostic about where the values come from.</p>\n\n<p>Each type of source will have its own function to feed in the values. These functions <em>might</em> share the name <code>fold</code>, but it isn't a problem because the typical recommendation is to import the packages qualified.</p>\n\n<p>The <a href=\"http://hackage.haskell.org/package/foldl-1.4.0/docs/Control-Foldl.html#v:fold\" rel=\"nofollow noreferrer\">fold</a> function from the <a href=\"http://hackage.haskell.org/package/foldl-1.4.0\" rel=\"nofollow noreferrer\">foldl</a> package feeds the contents of any <code>Foldable</code> container. The <a href=\"http://hackage.haskell.org/package/turtle-1.5.8/docs/Turtle-Shell.html#v:fold\" rel=\"nofollow noreferrer\">fold</a> from <a href=\"http://hackage.haskell.org/package/turtle-1.5.8\" rel=\"nofollow noreferrer\">turtle</a> feeds the results of a <code>Shell</code>. Streaming libraries like \"pipes\" have their <a href=\"http://hackage.haskell.org/package/pipes-4.3.9/docs/Pipes-Prelude.html#v:fold\" rel=\"nofollow noreferrer\">own adapters</a>.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1524772804, "creation_date": 1524769725, "question_id": 50050325, "link": "https://stackoverflow.com/questions/50050325/should-i-use-folds-in-turtle-or-foldl-packages", "title": "Should I use folds in Turtle or Foldl packages?", "body": "<p>I'm having some difficulty using Turtle and only after several minutes staring at incomprehensible error messages realized that I was using wrong <code>fold</code> function.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/turtle-1.5.8/docs/Turtle-Shell.html#v:fold\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/turtle-1.5.8/docs/Turtle-Shell.html#v:fold</a>\n<a href=\"https://hackage.haskell.org/package/foldl-1.4.0/docs/src/Control.Foldl.html#fold\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/foldl-1.4.0/docs/src/Control.Foldl.html#fold</a></p>\n\n<p>Why is there a name collision? I don't believe that's coincidence but I cannot figure it out. Are these inherently different kinds of folds?</p>\n\n<p>To be concrete, I wanted to fold a stream filenames into single name using maximum of modification time.</p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1524769482, "post_id": 50050244, "comment_id": 87116729, "body": "How did you try to combine them? please show us your attempt."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524769631, "post_id": 50050244, "comment_id": 87116799, "body": "You actually make it quite hard, Haskell has a <code>ToUpper</code> and <code>toLower</code> function (<code>Data.Char</code> module)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1524769633, "post_id": 50050244, "comment_id": 87116800, "body": "<code>if .. then .. else if .. then .. else ..</code> can be used."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1524769769, "creation_date": 1524769769, "answer_id": 50050339, "question_id": 50050244, "link": "https://stackoverflow.com/questions/50050244/toggle-cases-in-haskell-language/50050339#50050339", "title": "Toggle Cases in Haskell Language", "body": "<p>First, note that it's sufficient to define the functions only for single characters. You can then wrap them in <code>map</code> later to work with strings.</p>\n\n<p>So, you have</p>\n\n<pre><code>toUpper :: Char -&gt; Char\ntoUpper x = if x&gt;='a' &amp;&amp; x&lt;='z' then \n                toEnum(fromEnum x-32) else \n                      x\n\ntoLower :: Char -&gt; Char\ntoLower x = if x&gt;='A' &amp;&amp; x&lt;='Z' then \n            toEnum (fromEnum x+32) else\n            x\n</code></pre>\n\n<p>...or, as they're better written</p>\n\n<pre><code>toUpper x\n | x&gt;='a' &amp;&amp; x&lt;='z'  = toEnum $ fromEnum x - 32\n | otherwise         = x\n\ntoLower x\n | x&gt;='A' &amp;&amp; x&lt;='Z'  = toEnum $ fromEnum x + 32\n | otherwise         = x\n</code></pre>\n\n<p>Now, the nice thing with this <em>guard syntax</em> is that you can just add more clauses. So all you need to do is put the conditional clauses of both functions in one. The first one that succeds will then specify how to compute the result.</p>\n\n<p>The equivalent thing can also be done with <code>if</code>, but it requires an awkward nesting in the <code>else</code> branch.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1524773542, "creation_date": 1524773542, "answer_id": 50051137, "question_id": 50050244, "link": "https://stackoverflow.com/questions/50050244/toggle-cases-in-haskell-language/50051137#50051137", "title": "Toggle Cases in Haskell Language", "body": "<p>You basically here perform <code>map</code>pings. You can toggle the case by defining a mapping that for a given character:</p>\n\n<ol>\n<li>checks if it is an uppercase character, in case it is, return its lowercase equivlant;</li>\n<li>check if it is a lowercase character, in case it is, return its uppercase equivalent; and</li>\n<li>otherwise return the original character.</li>\n</ol>\n\n<p>We can implement such function like:</p>\n\n<pre><code>import Data.Char(isLower, isUpper, toLower, toUpper)\n\ntoggleChar :: Char -&gt; Char\ntoggleChar x | isUpper x = toLower x\n             | isLower x = toUpper x\n             | otherwise = x\n</code></pre>\n\n<p>or without using <code>Data.Char</code> imports:</p>\n\n<pre><code>toggleChar :: Char -&gt; Char\ntoggleChar x | 'A' &lt;= x &amp;&amp; x &lt;= 'Z' = toEnum (fromEnum x - 32)\n             | 'a' &lt;= x &amp;&amp; x &lt;= 'z' = toEnum (fromEnum x + 32)\n             | otherwise = x\n</code></pre>\n\n<p>then we can implement toggle over an entire string by <code>map</code>ping over <code>toggleChar</code>:</p>\n\n<pre><code>toggleString :: String -&gt; String\ntoggleString = map toggleChar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4617, "user_id": 260229, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HEr55.png?s=128&g=1", "display_name": "Mahmoud K.", "link": "https://stackoverflow.com/users/260229/mahmoud-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1541530244, "creation_date": 1541530244, "answer_id": 53178164, "question_id": 50050244, "link": "https://stackoverflow.com/questions/50050244/toggle-cases-in-haskell-language/53178164#53178164", "title": "Toggle Cases in Haskell Language", "body": "<p>This approach handles special characters and numbers without any imports:</p>\n\n<pre><code>special = ['0'..'9'] ++ [' ', '!','@','#','$','%','^','&amp;','*','(',')','_','-','+']\nalphabet = ['a'..'z'] ++ special ++ ['A'..'Z'] ++ special\nidx c (x:xs) | c /= x = 1 + idx c xs\n             | otherwise = 0\n\ntoggleChar s = alphabet !! mod (idx s alphabet + 26 + length special) (length alphabet)\ntoggleString = map toggleChar\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9320274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y2XXwLLa_4A/AAAAAAAAAAI/AAAAAAAAACM/ZDabh3cNQOo/photo.jpg?sz=128", "display_name": "AMINA ARSHAD", "link": "https://stackoverflow.com/users/9320274/amina-arshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 50050339, "answer_count": 3, "score": -1, "last_activity_date": 1541530244, "creation_date": 1524769343, "last_edit_date": 1524773501, "question_id": 50050244, "link": "https://stackoverflow.com/questions/50050244/toggle-cases-in-haskell-language", "title": "Toggle Cases in Haskell Language", "body": "<p>I am new in Haskell and have some problem in defining the function which takes parameter of type string, returns the result of type string and convert uppercase letters into lower case letters and lower case letter into upper case letters. I have defined function for lower and upper conversion separately.</p>\n\n<p>Code:</p>\n\n<pre><code> --upper case\nfunc_upper :: String -&gt; String\nfunc_upper = map (\\x-&gt; if x&gt;='a' &amp;&amp; x&lt;='z' then \n                    toEnum(fromEnum x-32) else \n                          x)\n\n--Lower case\nfunc_lower :: String -&gt; String\nfunc_lower = map (\\x -&gt;if x&gt;='A' &amp;&amp; x&lt;='Z' then \n                toEnum (fromEnum x+32) else\n                x)\n</code></pre>\n\n<p>but i am unable to combine these two functions and make one function that will perform both operations. I have practiced but failed.My practice code is:</p>\n\n<pre><code>    func_ ::String -&gt; String\nfunc_  x = if(x&gt;='a' &amp;&amp; x&lt;='z') then toEnum (fromEnum x-32) else \n          if (x&gt;='A' &amp;&amp; x&lt;='Z')  then toEnum (fromEnum x+32) else\n          x\n</code></pre>\n\n<p>Kindly help me to solve this issue and your help would be much appreciated.</p>\n"}, {"tags": ["haskell", "gadt", "reflex"], "answers": [{"comments": [{"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "edited": false, "score": 0, "creation_date": 1524820102, "post_id": 50049757, "comment_id": 87134361, "body": "Thanks for the pointer! In the meantime together with echatav and isovector (GH names) we were able to figure this question out further, and we also found that defining <code>GEq</code> and <code>GCompare</code> instances by hand helps. Although it&#39;s much less than ideal for large record types. I wonder if the TH generator would need to be/could be updated to handle polymorphism."}, {"owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "edited": false, "score": 0, "creation_date": 1524820273, "post_id": 50049757, "comment_id": 87134451, "body": "Also, I&#39;ve found that for my current use-case the pol&#39;ism I&#39;m looking for is actually closer to <code>data Foo n a where AnInt :: Foo n Int; ANum :: (Num n, Typeable n) =&gt; Foo n n</code>. Hand-defining instances works here too, and again, less than ideal. Trying to use TH, (e.g. <code>deriveGEq &#39;&#39;Foo</code> or <code>deriveGEq &#39;&#39;(Foo n)</code>) I run into kind-issues. Maybe relevant: <a href=\"https://github.com/mokus0/dependent-sum-template/pull/6\" rel=\"nofollow noreferrer\">github.com/mokus0/dependent-sum-template/pull/6</a>"}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 5, "last_activity_date": 1524768741, "last_edit_date": 1524768741, "creation_date": 1524767271, "answer_id": 50049757, "question_id": 50048842, "link": "https://stackoverflow.com/questions/50048842/how-is-it-possible-to-have-polymorphic-values-in-a-dependent-map-gadt/50049757#50049757", "title": "(How) is it possible to have polymorphic values in a `dependent-map` GADT?", "body": "<p>The template  haskell makes it hard to see what's going on, so I suggest you roll your own instances of <code>GEq</code> to understand the error better.</p>\n\n<p>Look at <a href=\"https://hackage.haskell.org/package/dependent-sum-0.4/docs/Data-GADT-Compare.html#t:GEq\" rel=\"nofollow noreferrer\">the definition of <code>GEq</code></a>:</p>\n\n<pre><code>class GEq f where\n  geq :: f a -&gt; f b -&gt; Maybe (a := b) \n</code></pre>\n\n<p>We don't get any further constraints on <code>a</code> or <code>b</code>, so we'd need to prove (or disprove) type equality on the GADT's constructors alone.</p>\n\n<p>Which the above <code>ANum</code> doesn't give us.</p>\n\n<p>This is fixable, though, if we add another constraint to <code>ANum</code> - <code>Typeable</code></p>\n\n<pre><code>ANum :: (Num n, Typeable n) =&gt; n -&gt; Foo n\n</code></pre>\n\n<p>Now we can use <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Typeable.html#v:eqT\" rel=\"nofollow noreferrer\"><code>eqT</code></a> to witness type equality</p>\n\n<pre><code>geq (ANum _) (ANum _) = eqT\n</code></pre>\n"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1524822930, "creation_date": 1524763684, "last_edit_date": 1524822930, "question_id": 50048842, "link": "https://stackoverflow.com/questions/50048842/how-is-it-possible-to-have-polymorphic-values-in-a-dependent-map-gadt", "title": "(How) is it possible to have polymorphic values in a `dependent-map` GADT?", "body": "<p>Anyone knows how/if it's possible to extend the <code>Foo</code> GADT in <a href=\"https://github.com/mokus0/dependent-map/pull/16#issuecomment-384380287\" rel=\"nofollow noreferrer\">this code</a>:</p>\n\n<pre><code>{-# language GADTs #-}\n{-# language DeriveGeneric #-}\n{-# language DeriveAnyClass #-}\n{-# language TemplateHaskell #-}\n{-# language StandaloneDeriving #-}\n\nimport Prelude                  (Int, String, print, ($))\nimport Data.GADT.Show           ()\nimport Data.GADT.Compare        ()\nimport Data.Dependent.Map       (DMap, fromList, (!))\nimport Data.Dependent.Sum       ((==&gt;))\nimport Data.GADT.Compare.TH     (deriveGEq, deriveGCompare)\nimport Data.Functor.Identity    (Identity)\n\ndata Foo a where\n  AnInt   :: Foo Int\n  AString :: Foo String\n\nderiveGEq      ''Foo\nderiveGCompare ''Foo\n\ndmap1 :: DMap Foo Identity\ndmap1 = fromList [AnInt ==&gt; 1, AString ==&gt; \"bar\"]\n\nmain = do\n  print $ dmap1 ! AnInt\n  print $ dmap1 ! AString\n\n  -- Prints:\n  -- Identity 1\n  -- Identity \"bar\"\n</code></pre>\n\n<p>with</p>\n\n<pre><code>  ANum :: Num n =&gt; Foo n\n</code></pre>\n\n<p>(or something similar) to allow for polymorphic values in a <a href=\"https://hackage.haskell.org/package/dependent-map\" rel=\"nofollow noreferrer\"><code>dependent-map</code></a>?</p>\n\n<p>When I try, I get a type error like this:</p>\n\n<pre><code>exp-dep-map.hs:20:1: error:\n    \u2022 Couldn't match type \u2018a\u2019 with \u2018b\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          geq :: forall a b. Foo a -&gt; Foo b -&gt; Maybe (a := b)\n        at exp-dep-map.hs:20:1-20\n      \u2018b\u2019 is a rigid type variable bound by\n        the type signature for:\n          geq :: forall a b. Foo a -&gt; Foo b -&gt; Maybe (a := b)\n        at exp-dep-map.hs:20:1-20\n      Expected type: Maybe (a := b)\n        Actual type: Maybe (a :~: a)\n    \u2022 In a stmt of a 'do' block: return Refl\n      In the expression: do return Refl\n      In an equation for \u2018geq\u2019: geq ANum ANum = do return Refl\n    \u2022 Relevant bindings include\n        geq :: Foo a -&gt; Foo b -&gt; Maybe (a := b)\n          (bound at exp-dep-map.hs:20:1)\n   |\n20 | deriveGEq      ''Foo\n   | ^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<hr>\n\n<p>Edit: I've continued working on this together with echatav and isovector (GitHub usernames) and we were able to figure this question out further, and we also found that defining <code>GEq</code> and <code>GCompare</code> instances by hand helps. So thank you, @rampion, your answer also corroborates what we've found. </p>\n\n<p>Although it's much less than ideal to define these manually for large record types. I wonder if the TemplateHaskell generators (<code>deriveGCompare</code>, <code>deriveGEq</code>) {would need to be,could be} updated to handle polymorphism. </p>\n\n<p>Also, I've found that for my current use-case the pol'ism I'm looking for is actually closer to</p>\n\n<pre><code>data Foo n a where\n  AnInt :: Foo n Int\n  AString :: Foo n String\n  ANum :: (Num n, Typeable n, Show n) =&gt; Foo n n\n</code></pre>\n\n<p>Hand-defining instances works here too, and again, less than ideal.</p>\n\n<pre><code>instance GEq (Foo n) where\n  geq AnInt AnInt = return Refl\n  geq AString AString = return Refl\n  geq ANum ANum = return Refl\n  geq _ _ = Nothing\n\ninstance GCompare (Foo n) where\n  gcompare AnInt AnInt = GEQ\n  gcompare AnInt _ = GLT\n  gcompare _ AnInt = GGT\n  gcompare AString AString = GEQ\n  gcompare AString _ = GLT\n  gcompare _ AString = GGT\n  gcompare (ANum :: Foo n a) (ANum :: Foo n b) = (eqT @a @b) &amp; \\case\n    Just (Refl :: a :~: b) -&gt; GEQ\n    Nothing   -&gt; error \"This shouldn't happen\"\n  gcompare ANum _ = GLT\n  gcompare _ ANum = GGT\n</code></pre>\n\n<p>Trying to use TH, (e.g. <code>deriveGEq ''Foo</code> or <code>deriveGEq ''(Foo n)</code>) I run into kind-issues.</p>\n\n<pre><code>exp-dep-map.hs:39:1: error:\n    \u2022 Expecting one more argument to \u2018Foo\u2019\n      Expected kind \u2018* -&gt; *\u2019, but \u2018Foo\u2019 has kind \u2018* -&gt; * -&gt; *\u2019\n    \u2022 In the first argument of \u2018GEq\u2019, namely \u2018Foo\u2019\n      In the instance declaration for \u2018GEq Foo\u2019\n   |\n39 | deriveGEq      ''Foo\n   | ^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p><p></p>\n\n<pre><code>exp-dep-map.hs:40:19: error: parse error on input \u2018Foo\u2019\n   |\n40 | deriveGEq      ''(Foo n)\n   |                   ^^^\n</code></pre>\n\n<p>Maybe relevant: <a href=\"https://github.com/mokus0/dependent-sum-template/pull/6\" rel=\"nofollow noreferrer\">https://github.com/mokus0/dependent-sum-template/pull/6</a></p>\n"}, {"tags": ["haskell", "stopwatch"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 4, "creation_date": 1524757431, "post_id": 50046922, "comment_id": 87110417, "body": "Looks like a fractional to me. 29 seconds + 656841598 nanoseconds."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1524757990, "post_id": 50046922, "comment_id": 87110763, "body": "Are you claiming the nsec part is greater than 1e9?  Well... <code>656841598 &#47; 1e9 = 0.656841598</code>"}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 4, "last_activity_date": 1524757597, "creation_date": 1524757597, "answer_id": 50047171, "question_id": 50046922, "link": "https://stackoverflow.com/questions/50046922/odd-stopwatch-result-in-haskell/50047171#50047171", "title": "Odd stopWatch result in Haskell", "body": "<p>The <code>sec</code> and <code>nsec</code> fields do not show the same thing expressed in different units, but <em>parts</em> of the whole time. That is, <code>{ sec = 1, nsec = 2 }</code> means \"<em>1 second and 2 nanoseconds</em>\".</p>\n\n<p>Try this out:</p>\n\n<pre><code>print $ fromNanoSecs 1234567890000\n\n&gt; TimeSpec {sec = 1234, nsec = 567890000}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 3, "last_activity_date": 1524757614, "creation_date": 1524757614, "answer_id": 50047175, "question_id": 50046922, "link": "https://stackoverflow.com/questions/50046922/odd-stopwatch-result-in-haskell/50047175#50047175", "title": "Odd stopWatch result in Haskell", "body": "<p>The <code>TimeSpec</code> divided into two parts, a second counter and a nanosecond counter for second fractions. If you want the total time in nanoseconds, use <a href=\"https://hackage.haskell.org/package/clock-0.7.2/docs/System-Clock.html#v:toNanoSecs\" rel=\"nofollow noreferrer\">toNanoSecs</a>.</p>\n"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 50047171, "answer_count": 2, "score": 1, "last_activity_date": 1524757614, "creation_date": 1524756771, "question_id": 50046922, "link": "https://stackoverflow.com/questions/50046922/odd-stopwatch-result-in-haskell", "title": "Odd stopWatch result in Haskell", "body": "<p>The <a href=\"https://hackage.haskell.org/package/clock-0.7.2/docs/System-Clock.html#t:TimeSpec\" rel=\"nofollow noreferrer\">clock</a> package contains a <strong>stopWatch</strong> function that returns a TimeSpec record. It has a single constructor with two fields: sec (seconds) and nsec (nanoseconds). However, running this command gives an odd result:</p>\n\n<pre><code>TimeSpec {sec = 29, nsec = 656841598}\n</code></pre>\n\n<p>It does't look like nsec actually refers to nanoseconds since 1 sec should be 10^9 nanosec. Is this a bug in the library or is something else happening? </p>\n"}, {"tags": ["haskell", "types", "polymorphism", "continuation-passing", "higher-rank-types"], "comments": [{"owner": {"reputation": 2342, "user_id": 1683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2535857ac59d18baeda7b081c645f901?s=128&d=identicon&r=PG", "display_name": "Twan van Laarhoven", "link": "https://stackoverflow.com/users/1683460/twan-van-laarhoven"}, "edited": false, "score": 1, "creation_date": 1524758183, "post_id": 50045098, "comment_id": 87110867, "body": "Since <code>Susp a</code> is isomorphic to <code>a</code>, it follows that <code>Susp (Susp a)</code> is also isomorphic to <code>a</code>. So your question then boils down to whether <code>forall r. Cont r (Cont r a)</code> is isomorphic to <code>a</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524761255, "post_id": 50045098, "comment_id": 87112565, "body": "I don&#39;t understand your statement of the free theorem. Can you clarify which variables are supposed to be quantified?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2342, "user_id": 1683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2535857ac59d18baeda7b081c645f901?s=128&d=identicon&r=PG", "display_name": "Twan van Laarhoven", "link": "https://stackoverflow.com/users/1683460/twan-van-laarhoven"}, "edited": false, "score": 0, "creation_date": 1524772630, "post_id": 50045098, "comment_id": 87118212, "body": "@TwanvanLaarhoven Yup, that&#39;s another way of looking at it. (Originally, I was wondering about <code>Cont r (Cont r a)</code> versus <code>Susp a</code>; I then switched to the formulation in this post hoping that it might bring some extra clarity.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524772793, "post_id": 50045098, "comment_id": 87118285, "body": "@dfeuer <code>r</code> is quantified; with <code>g :: a -&gt; r</code> and <code>f :: r -&gt; s</code>. (I probably should have written <code>(A -&gt; r) -&gt; r</code>, for the sake of clarity.)"}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524829772, "post_id": 50052068, "comment_id": 87139847, "body": "Yup -- the harder direction feels so close, yet so far... I wonder if showing either that <code>ydiso</code> is injective or that <code>ydosi</code> is surjective (which, I believe, should be enough to get the other direction given the one we already have), though it probably requires parametricity in a similar way."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1529130303, "post_id": 50052068, "comment_id": 88772760, "body": "After quite a while, I have grown confident enough in my attempt to wiggle out of this bind to post it as <a href=\"https://stackoverflow.com/a/50885488/2751851\">a complementary answer</a>. I&#39;d love to hear your take on it."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1524777959, "creation_date": 1524777959, "answer_id": 50052068, "question_id": 50045098, "link": "https://stackoverflow.com/questions/50045098/on-nested-cps-suspension-types/50052068#50052068", "title": "On nested CPS suspension types", "body": "<p>(partial answer)</p>\n\n<p>I wouldn't be surprised if <code>a</code> turned up to be isomorphic to your proposed type</p>\n\n<pre><code>forall r. (((a -&gt; r) -&gt; r) -&gt; r) -&gt; r\n</code></pre>\n\n<p>So far, I was only able to prove that the former embeds into the latter. The embedding could as well be an isomorphism, but if that holds, to prove that we will likely need to exploit parametricity on the scary type above.</p>\n\n<p>Here's the embedding:</p>\n\n<pre><code>type YD a = forall r. (((a -&gt; r) -&gt; r) -&gt; r) -&gt; r\n\nydosi :: a -&gt; YD a\nydosi x = \\f -&gt; f (\\g -&gt; g x)\n\nydiso :: YD a -&gt; a\nydiso x = x (\\a -&gt; a id)\n</code></pre>\n\n<p>Proving that this is an embedding is easy, and only requires beta steps:</p>\n\n<pre><code>ydiso (ydosi x)\n= ydiso (\\f -&gt; f (\\g -&gt; g x))\n= (\\f -&gt; f (\\g -&gt; g x)) (\\a -&gt; a id)\n= (\\a -&gt; a id) (\\g -&gt; g x)\n= (\\g -&gt; g x) id\n= id x\n= x\n</code></pre>\n\n<p>The opposite direction is much harder, and (if possible) should rely on the parametricity of <code>x :: YD a</code>. Completing this would prove the wanted isomorphism.</p>\n\n<pre><code>ydosi (ydiso x)\n= ydosi (x (\\a -&gt; a id))\n= \\f -&gt; f (\\g -&gt; g (x (\\a -&gt; a id)))\n= ????\n= x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1529130396, "last_edit_date": 1529130396, "creation_date": 1529129933, "answer_id": 50885488, "question_id": 50045098, "link": "https://stackoverflow.com/questions/50045098/on-nested-cps-suspension-types/50885488#50885488", "title": "On nested CPS suspension types", "body": "<p>I'm not entirely confident about the following take on the matter (it kinda feels too good to be true), but it is the best I have to offer up to now, so let's put it on the table.</p>\n\n<p><a href=\"https://stackoverflow.com/a/50052068/2751851\">chi's answer</a> tackles the problem by proposing an isomorphism candidate between <code>a</code> and <code>forall r. (((a -&gt; r) -&gt; r) -&gt; r) -&gt; r</code>:</p>\n\n<pre><code>-- If you want to play with these in actual code, make YD a newtype.\ntype YD a = forall r. (((a -&gt; r) -&gt; r) -&gt; r) -&gt; r\n\nydosi :: a -&gt; YD a\nydosi x = \\kk -&gt; kk (\\k -&gt; k x)\n\nydiso :: YD a -&gt; a\nydiso mm = mm (\\m -&gt; m id)\n</code></pre>\n\n<p>chi then proves <code>ydiso . ydosi = id</code>, which leaves the <code>ydosi . ydiso</code> direction to be dealt with.</p>\n\n<p>Now, if we have some <code>f</code> and its left inverse <code>g</code> (<code>g . f = id</code>), it readily follows that <code>f . g . f = f</code>. If <code>f</code> is surjective, we can \"cancel\" it on the right, leading us to <code>f . g = id</code> (i.e. the other direction of the isomorphism). That being so, given that we have <code>ydiso . ydosi = id</code>, establishing that <code>ydosi</code> is surjective will be enough to prove the isomorphism. One way of looking into that is reasoning about the inhabitants of <code>YD a</code>.</p>\n\n<p>(Though I won't attempt to do that here, I presume the following passages can be made precise by expressing them in terms of the System F typing rules -- <a href=\"https://math.stackexchange.com/q/40155/380202\">cf. this Math.SE question</a>.)</p>\n\n<p>An <code>YD A</code> value is a function that takes a continuation:</p>\n\n<pre><code>mm :: forall r. (((A -&gt; r) -&gt; r) -&gt; r) -&gt; r\nmm = \\kk -&gt; _y\n-- kk :: forall r. ((A -&gt; r) -&gt; r) -&gt; r\n-- _y :: r\n</code></pre>\n\n<p>The only way to get a result of type <code>r</code> here is by applying <code>kk</code> to something:</p>\n\n<pre><code>mm :: forall r. (((A -&gt; r) -&gt; r) -&gt; r) -&gt; r\nmm = \\kk -&gt; kk _m\n-- kk :: forall r. ((A -&gt; r) -&gt; r) -&gt; r\n-- _m :: forall r. (A -&gt; r) -&gt; r\n</code></pre>\n\n<p>As the type of <code>kk</code> is polymorphic in <code>r</code>, so must be the type of <code>_m</code>. That means we also know what <code>_m</code> must be like, thanks to the familiar <code>A</code>/<code>forall r. (A -&gt; r) -&gt; r</code> isomorphism:</p>\n\n<pre><code>mm :: forall r. (((A -&gt; r) -&gt; r) -&gt; r) -&gt; r\nmm = \\kk -&gt; kk (\\k -&gt; k _x)\n-- kk :: forall r. ((A -&gt; r) -&gt; r) -&gt; r\n-- k :: forall r. (A -&gt; r) -&gt; r\n-- _x :: A\n</code></pre>\n\n<p>The right-hand side above, however, is precisely <code>ydosi</code>:</p>\n\n<pre><code>mm :: forall r. (((A -&gt; r) -&gt; r) -&gt; r) -&gt; r\nmm = ydosi _x\n-- _x :: A\n</code></pre>\n\n<p>We have just found out that any <code>forall r. (((A -&gt; r) -&gt; r) -&gt; r) -&gt; r</code> value is <code>ydosi x</code> for some <code>x :: A</code>. It immediately follows that <code>ydosi</code> is surjective, which is enough to prove the isomorphism.</p>\n\n<p>Since <code>a</code> is isomorphic to <code>forall r. ((forall s. (a -&gt; s) -&gt; s) -&gt; r) -&gt; r</code> (cf. <a href=\"https://stackoverflow.com/questions/50045098/on-nested-cps-suspension-types#comment87110867_50045098\">Twan van Laarhoven's comment</a>) and to <code>forall r. (((a -&gt; r) -&gt; r) -&gt; r) -&gt; r</code>, transitivity means both nested suspension types are isomorphic.</p>\n\n<hr>\n\n<p>What do the witnesses of the nested suspension isomorphism look like? If we define...</p>\n\n<pre><code>-- The familiar isomorphism.\ntype Susp a = forall r. (a -&gt; r) -&gt; r\n\nsuosi :: a -&gt; Susp a\nsuosi x = \\k -&gt; k x\n\nsuiso :: Susp a -&gt; a\nsuiso m = m id\n</code></pre>\n\n<p>... we can write...</p>\n\n<pre><code>ydosi . suiso . suiso :: Susp (Susp a) -&gt; YD a\nsuosi . suosi . ydiso :: YD a -&gt; Susp (Susp a)\n</code></pre>\n\n<p>... which boils down to:</p>\n\n<pre><code>-- A few type annotations would be necessary to persuade GHC about the types here.\n\\mm -&gt; \\kk -&gt; kk (\\k -&gt; k (mm id id)) -- Susp (Susp a) -&gt; YD a\n\\mm -&gt; \\kk -&gt; kk (\\k -&gt; k (mm (\\m -&gt; m id))) -- YD a -&gt; Susp (Susp a)\n</code></pre>\n\n<p>We can apply the <code>Susp a</code> free theorem on <code>mm</code> in the first witness...</p>\n\n<pre><code>f (mm g) = mm (f . g) -- Free theorem\nf (mm id) = mm f\n\nmm id id\n($ id) (mm id)\nmm ($ id)\nmm (\\m -&gt; m id)\n</code></pre>\n\n<p>... and so:</p>\n\n<pre><code>\\mm -&gt; \\kk -&gt; kk (\\k -&gt; k (mm (\\m -&gt; m id))) -- Susp (Susp a) -&gt; YD a\n\\mm -&gt; \\kk -&gt; kk (\\k -&gt; k (mm (\\m -&gt; m id))) -- YD a -&gt; Susp (Susp a)\n</code></pre>\n\n<p>Fascinatingly, the witnesses are \"the same\" except for their types. I wonder if there some argument starting from this observation would allow us to proceed backwards and prove the isomorphism in a more direct way.</p>\n"}], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 2, "accepted_answer_id": 50885488, "answer_count": 2, "score": 2, "last_activity_date": 1529130396, "creation_date": 1524751524, "last_edit_date": 1524754692, "question_id": 50045098, "link": "https://stackoverflow.com/questions/50045098/on-nested-cps-suspension-types", "title": "On nested CPS suspension types", "body": "<p>Let's begin with the familiar type of CPS suspended computations, <code>(a -&gt; r) -&gt; r</code>, spelled as <code>Cont r a</code> in <em>mtl</em>-speak. We know that <a href=\"https://stackoverflow.com/q/45287954/2751851\">it is isomorphic to <code>a</code> as long as it is kept polymorphic in <code>r</code></a>. If we nest this type, we get this rank-3 type:</p>\n\n<pre><code>forall r. ((forall s. (a -&gt; s) -&gt; s) -&gt; r) -&gt; r\n</code></pre>\n\n<p>(For the sake of convenience, I might have defined <code>type Susp a = forall r. (a -&gt; r) -&gt; r</code> and then began talking about <code>Susp (Susp a)</code>, but I fear that would lead to distracting technicalities.)</p>\n\n<p>We can get a similar type by universally quantifying the result type only after nesting, as it would be if we had <code>forall r. Cont r (Cont r a)</code>:</p>\n\n<pre><code>forall r. (((a -&gt; r) -&gt; r) -&gt; r) -&gt; r\n</code></pre>\n\n<p>Is there any meaningful difference between these two types? I say meaningful because some things that can apparently be only done with the first, \"SuspSusp\" type...</p>\n\n<pre><code>GHCi&gt; foo = (\\kk -&gt; kk (\\k -&gt; k True)) :: forall s. ((forall r. (Bool -&gt; r) -&gt; r) -&gt; s) -&gt; s\nGHCi&gt; bar = (\\kk -&gt; kk (\\k -&gt; k True)) :: forall r. (((Bool -&gt; r) -&gt; r) -&gt; r) -&gt; r\nGHCi&gt; foo (\\m -&gt; show (m not))\n\"False\"\nGHCi&gt; bar (\\m -&gt; show (m not))\n\n&lt;interactive&gt;:76:12: error:\n    * Couldn't match type `[Char]' with `Bool'\n      Expected type: Bool\n        Actual type: String\n    * In the expression: show (m not)\n      In the first argument of `bar', namely `(\\ m -&gt; show (m not))'\n      In the expression: bar (\\ m -&gt; show (m not))\n</code></pre>\n\n<p>... can also be achieved with the second, \"ContCont\" one by taking advantage of the free theorem for <code>(a -&gt; r) -&gt; r</code>, <code>f (m g) = m (f . g)</code> for any <code>m :: (a -&gt; r) -&gt; r</code>.</p>\n\n<pre><code>GHCi&gt; foo (\\m -&gt; m (show . not))\n\"False\"\nGHCi&gt; bar (\\m -&gt; m (show . not))\n\"False\"\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1524736217, "post_id": 50039905, "comment_id": 87095773, "body": "You can use <code>:t f</code> to obtain the type of a function."}, {"owner": {"reputation": 121, "user_id": 7023122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4fc771105a47761221bba39fd522effe?s=128&d=identicon&r=PG&f=1", "display_name": "James Johnson", "link": "https://stackoverflow.com/users/7023122/james-johnson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524736693, "post_id": 50039905, "comment_id": 87096131, "body": "@WillemVanOnsem I mean I would like to understand how to find the type myself so I can better understand types"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1524736700, "post_id": 50039905, "comment_id": 87096137, "body": "<code>Eq a</code> doesn&#39;t mean the types are equal. <code>Eq a</code> means &quot;<code>a</code> is a type whose values can be checked for equality using <code>==</code>&quot;. Also, when two variables have the same name they are the same, so for example a function <code>a -&gt; a -&gt; a</code> takes two values of type <code>a</code> (whatever that ends up being) and returns another value of <code>a</code>. If you want to indicate that two parameters can have different types you need to use different variables."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1524736913, "post_id": 50039905, "comment_id": 87096289, "body": "@JamesJohnson Learning by hand is fine, but you can at least use the tools to check if the answer is correct. If they aren&#39;t, you can still think about where you went wrong. I&#39;d recommend first trying to derive them by hand, then asking ghci if you got them right, and then trying to find out where you made mistakes."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1524747322, "post_id": 50039905, "comment_id": 87103132, "body": "The question you quoted is incorrect (or at least imprecise). Implementation iv would typecheck just fine if you gave it the type signature <code>f :: a -&gt; [a] -&gt; a</code>. That&#39;s not its <i>most general</i> type, but it is (one of) its type(s)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524758359, "post_id": 50039905, "comment_id": 87110971, "body": "@DanielWagner, arguably it&#39;s correct because that&#39;s not a function but only a partial function."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 8, "last_activity_date": 1524736909, "creation_date": 1524736909, "answer_id": 50040151, "question_id": 50039905, "link": "https://stackoverflow.com/questions/50039905/how-would-you-declare-the-types-of-these-functions-in-haskell/50040151#50040151", "title": "How would you declare the types of these functions in Haskell?", "body": "<blockquote>\n  <p><code>i) f :: a -&gt; a -&gt; a</code></p>\n  \n  <p><code>f x xs = xs</code></p>\n  \n  <p>This is because x or xs can be of any value and is not a list as it does not contain the ':' operator.</p>\n</blockquote>\n\n<p>True, but it also does not have to be of the same type!\nSo, it's actually <code>f :: a -&gt; b -&gt; b</code>.</p>\n\n<blockquote>\n  <p><code>ii) f :: Int -&gt; a -&gt; Int</code></p>\n  \n  <p><code>f x xs = x+1</code></p>\n  \n  <p>This is because the + operator is used on x, meaning x is of type Int.</p>\n</blockquote>\n\n<p>Correct. (Actually, in Haskell we get <code>Num b =&gt; b -&gt; a -&gt; b</code> which generalized the <code>Int</code> to any numeric type, but it's not that important.)</p>\n\n<blockquote>\n  <p><code>iii) f :: Eq a =&gt; a -&gt; a -&gt; a</code></p>\n  \n  <p><code>f x xs = x ++ xs</code></p>\n  \n  <p>The ++ operators are used, therefore in order to concatenate they must be of the same type..?</p>\n</blockquote>\n\n<p>True, but they must be lists. Also, <code>Eq</code> is only needed if you use <code>==</code> or something which compares values.</p>\n\n<p>Here, <code>f :: [a] -&gt; [a] -&gt; [a]</code>.</p>\n\n<blockquote>\n  <p><code>iv) f :: a -&gt; [a] -&gt; a</code></p>\n  \n  <p><code>f x (y:ys) = y</code></p>\n  \n  <p>f returns an element from the list.</p>\n</blockquote>\n\n<p>The type of <code>x</code> does not have to be the same. We get <code>f :: b -&gt; [a] -&gt; a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1524756797, "post_id": 50040166, "comment_id": 87109993, "body": "For definition <code>iv</code>, <code>ys :: [c]</code> instead of <code>ys :: c</code>, I can&#39;t edit this since it&#39;s less than 6 characters."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1524757738, "post_id": 50040166, "comment_id": 87110614, "body": "@M.Aroosi: correct! Thanks for spotting that. Updated :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1524757722, "last_edit_date": 1524757722, "creation_date": 1524736942, "answer_id": 50040166, "question_id": 50039905, "link": "https://stackoverflow.com/questions/50039905/how-would-you-declare-the-types-of-these-functions-in-haskell/50040166#50040166", "title": "How would you declare the types of these functions in Haskell?", "body": "<blockquote>\n<pre><code>i. f x xs = xs\n</code></pre>\n  \n  <p>(...)</p>\n\n<pre><code>i) f :: a -&gt; a -&gt; a\n</code></pre>\n</blockquote>\n\n<p>Although this <em>can</em> be a type signature, you make it <strong>too restrictive</strong>. The function takes two parameters <code>x</code> and <code>xs</code>. Initially we can reason that <code>x</code> and <code>xs</code> can have different types, so we say that <code>x :: a</code>, and <code>xs :: b</code>. Since the function returns <code>xs</code>, the return type is <code>b</code> as well, so the type is:</p>\n\n<pre><code>f :: a -&gt; b -&gt; b\nf x xs = xs\n</code></pre>\n\n<blockquote>\n<pre><code>ii. f x xs = x+1\n</code></pre>\n  \n  <p>(...)</p>\n\n<pre><code>ii) f :: Int -&gt; a -&gt; Int\n</code></pre>\n</blockquote>\n\n<p>Again you make the function <strong>too restrictive</strong>. Let us again assume that <code>x :: a</code> and <code>xs :: b</code> have different types. We see that we return <code>x + 1</code> (or in more canonical form <code>(+) x 1</code>. Since <code>(+)</code> has signature <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:-43-\" rel=\"nofollow noreferrer\"><strong><code>(+) :: Num c =&gt; c -&gt; c -&gt; c</code></strong></a> (we here use <code>c</code> since <code>a</code> is already used), and <code>1</code> has signature <strong><code>1 :: Num d =&gt; d</code></strong>, we thus see that we call <code>(+)</code> with <code>x</code> and <code>1</code>, as a result we know that <code>a ~ c</code> (<code>a</code> and <code>c</code> are the same type), and <code>c ~ d</code>, so as a result we obtain the signature:</p>\n\n<pre><code>f :: Num c =&gt; c -&gt; b -&gt; c\nf x xs = x+1\n</code></pre>\n\n<blockquote>\n<pre><code>iii. f x xs = x ++ xs\n</code></pre>\n  \n  <p>(...)</p>\n\n<pre><code>iii) f :: Eq a =&gt; a -&gt; a -&gt; a\n</code></pre>\n</blockquote>\n\n<p>This is <strong>wrong</strong>: we here see that <code>f</code> has two parameters, <code>x :: a</code> and <code>xs :: b</code>. We see that we return <code>(++) x xs</code>. Since <code>(++)</code> has signature <a href=\"https://www.haskell.org/hoogle/?hoogle=(%2B%2B)\" rel=\"nofollow noreferrer\"><strong><code>(++) :: [c] -&gt; [c] -&gt; [c]</code></strong></a>, we thus know that <code>a ~ [c]</code> and <code>b ~ [c]</code>, so the type is:</p>\n\n<pre><code>f :: [c] -&gt; [c] -&gt; [c]\nf x xs = x ++ xs\n</code></pre>\n\n<blockquote>\n<pre><code>iv. f x (y:ys) = y\n</code></pre>\n  \n  <p>(...)</p>\n\n<pre><code>iv) f :: a -&gt; [a] -&gt; a\n</code></pre>\n</blockquote>\n\n<p>This is again <strong>too restrictive</strong>. Here we see again two parameters: <code>x</code> and <code>(y:ys)</code>. We first generate a type <code>a</code> for <code>x :: a</code>, and <code>(y:ys) :: b</code>, since the pattern of the second parameter is <code>(y:ys)</code>, this is a <em>list constructor</em> with as parameters <strong><code>(:) :: c -&gt; [c] -&gt; [c]</code></strong>. As a result we can derive that <code>y :: c</code>, and <code>ys :: [c]</code>, furthermore the pattern <code>(y:ys)</code> has type <code>[c]</code>. Since the function returns <code>y</code>, we know that the return type is <code>c</code>, so:</p>\n\n<pre><code>f :: a -&gt; [c] -&gt; c\nf x (y:ys) = y\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong>: you can let Haskell derive the type of the function itself. In GHCi you can use the <strong><code>:t</code></strong> command to query the type of an expression. For example:</p>\n\n<pre><code>Prelude&gt; f x (y:ys) = y\nPrelude&gt; :t f\nf :: t1 -&gt; [t] -&gt; t\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 121, "user_id": 7023122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4fc771105a47761221bba39fd522effe?s=128&d=identicon&r=PG&f=1", "display_name": "James Johnson", "link": "https://stackoverflow.com/users/7023122/james-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1524757722, "creation_date": 1524736168, "last_edit_date": 1524737326, "question_id": 50039905, "link": "https://stackoverflow.com/questions/50039905/how-would-you-declare-the-types-of-these-functions-in-haskell", "title": "How would you declare the types of these functions in Haskell?", "body": "<p>So I'm learning about Haskell at the moment, and I came across this question:</p>\n\n<blockquote>\n  <p>The type of a function <code>f</code> is supposed to be <code>a-&gt;[a]-&gt;a</code>. The\n  following definitions of <code>f</code> are incorrect because their types are all\n  different from <code>a-&gt;[a]-&gt;a</code>:</p>\n\n<pre><code>i. f x xs = xs\nii. f x xs = x+1\niii. f x xs = x ++ xs\niv. f x (y:ys) = y\n</code></pre>\n</blockquote>\n\n<p>My answers as I see it are:</p>\n\n<pre><code>i) f :: a -&gt; a -&gt; a\n</code></pre>\n\n<p>This is because x or xs can be of any value and is not a list as it does not contain the ':' operator.</p>\n\n<pre><code>ii) f :: Int -&gt; a -&gt; Int\n</code></pre>\n\n<p>This is because the + operator is used on x, meaning x is of type Int.</p>\n\n<pre><code>iii) f :: Eq a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>The ++ operators are used, therefore in order to concatenate they must be of the same type..?</p>\n\n<pre><code>iv) f :: a -&gt; [a] -&gt; a\n</code></pre>\n\n<p>f returns an element from the list.</p>\n\n<p>The last one is definitely wrong, because it can't be of type a -> [a] -> a. Are there any others I did wrong, and why? I'm hoping I can fully understand types and how to find out the types of functions.</p>\n"}, {"tags": ["haskell", "c-preprocessor", "versioning", "ghc", "cabal"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1524738184, "post_id": 50039809, "comment_id": 87097040, "body": "For dashes in particular they are replaced with <code>_</code> apparently, but I&#39;m not sure if or where this is documented."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1524740111, "post_id": 50039809, "comment_id": 87098230, "body": "You can use <a href=\"http://downloads.haskell.org/~ghc/8.4.2/docs/html/users_guide/phases.html#standard-cpp-macros\" rel=\"nofollow noreferrer\">this trick</a> to list all macros."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1524740472, "last_edit_date": 1524740472, "creation_date": 1524739564, "answer_id": 50041026, "question_id": 50039809, "link": "https://stackoverflow.com/questions/50039809/how-are-the-min-version-macros-defined-for-libraries-with-non-letter-char/50041026#50041026", "title": "How are the MIN_VERSION_&#119897;&#119894;&#119887; macros defined for libraries with non-letter characters in their name?", "body": "<p><strong>Short answer</strong>: the hyphen (<code>-</code>) is replaced with an underscore (<code>_</code>).</p>\n\n<p>The macros are - as far as I know - generated in the <a href=\"https://github.com/ghc/ghc/blob/ceb914771aece0aa6d87339227ce406c7179d1d1/compiler/main/DriverPipeline.hs#L2108\" rel=\"nofollow noreferrer\"><code>generatePackageVersionMacros</code> function of the <code>DriverPipeline.hs</code> file</a>:</p>\n\n<blockquote>\n<pre><code>generatePackageVersionMacros :: [PackageConfig] -&gt; String\ngeneratePackageVersionMacros pkgs = concat\n  -- Do not add any C-style comments. See Trac #3389.\n  [ generateMacros \"\" pkgname version\n  | pkg &lt;- pkgs\n  , let version = packageVersion pkg\n        pkgname = map fixchar (packageNameString pkg)\n  ]\n\nfixchar :: Char -&gt; Char\nfixchar '-' = '_'\nfixchar c = c\n\ngenerateMacros :: String -&gt; String -&gt; Version -&gt; String\ngenerateMacros prefix name version =\n  concat\n  [\"#define \", prefix, \"VERSION_\",name,\" \",show (showVersion version),\"\\n\"\n  ,\"#define MIN_\", prefix, \"VERSION_\",name,\"(major1,major2,minor) (\\\\\\n\"\n  ,\"  (major1) &lt;  \",major1,\" || \\\\\\n\"\n  ,\"  (major1) == \",major1,\" &amp;&amp; (major2) &lt;  \",major2,\" || \\\\\\n\"\n  ,\"  (major1) == \",major1,\" &amp;&amp; (major2) == \",major2,\" &amp;&amp; (minor) &lt;= \",minor,\")\"\n  ,\"\\n\\n\"\n  ]\n  where\n(major1:major2:minor:_) = map show (versionBranch version ++ repeat 0)\n</code></pre>\n</blockquote>\n\n<p>As you can see the <code>packageNameString</code> of the package is fixed by performing a <code>map fixchar</code> on it. The hyphen (<code>-</code>) is replaced with an underscore (<code>_</code>). The macro can thus be written like:</p>\n\n<pre><code>#if !MIN_VERSION_quickcheck<b>_</b>instances(0,3,17)\ninstance Arbitrary SBS.ShortByteString where arbitrary = fmap SBS.pack arbitrary\n#endif</code></pre>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 826753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32bda212d90f3d131b7f7781f8ac0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Petersen", "link": "https://stackoverflow.com/users/826753/jens-petersen"}, "is_accepted": false, "score": 2, "last_activity_date": 1566593644, "last_edit_date": 1566593644, "creation_date": 1524751495, "answer_id": 50045079, "question_id": 50039809, "link": "https://stackoverflow.com/questions/50039809/how-are-the-min-version-macros-defined-for-libraries-with-non-letter-char/50045079#50045079", "title": "How are the MIN_VERSION_&#119897;&#119894;&#119887; macros defined for libraries with non-letter characters in their name?", "body": "<p>You can check the generated macros in <code>dist/build/autogen/cabal_macros.h</code>.</p>\n\n<p>The macro for <code>quickcheck-instances</code> would be named <code>MIN_VERSION_quickcheck_instances</code>.</p>\n"}], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1566593644, "creation_date": 1524735897, "question_id": 50039809, "link": "https://stackoverflow.com/questions/50039809/how-are-the-min-version-macros-defined-for-libraries-with-non-letter-char", "title": "How are the MIN_VERSION_&#119897;&#119894;&#119887; macros defined for libraries with non-letter characters in their name?", "body": "<p>Cabal, or <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10970\" rel=\"noreferrer\">more recently GHC itself</a>, pre-defines CPP macros that allow checking what version of which library is used. It works easily in simple examples like</p>\n\n<pre><code>#if MIN_VERSION_base(4,0,0)\n... code that works with base-4 ...\n#else\n... code that works with base-3 ...\n#endif\n</code></pre>\n\n<p>However, CPP macro names are more restricted than Cabal package names, so the following does not work:</p>\n\n<pre><code>#if !MIN_VERSION_quickcheck-instances(0,3,17)\ninstance Arbitrary SBS.ShortByteString where arbitrary = fmap SBS.pack arbitrary\n#endif\n</code></pre>\n\n<pre>     error: missing binary operator before token \"(\"\n     #if !MIN_VERSION_quickcheck-instances(0,3,17)\n     ^\n   |\n18 | #if !MIN_VERSION_quickcheck-instances(0,3,17)\n   | ^\n`gcc' failed in phase `C pre-processor'. (Exit code: 1)</pre>\n\n<p>It doesn't seem to be properly documented how library names like this are handled.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 3, "creation_date": 1524725936, "post_id": 50036527, "comment_id": 87089408, "body": "<i>This is a <code>map</code>, and this is a <code>Map</code>. This is a function, and this is a type.</i>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1524733531, "post_id": 50036527, "comment_id": 87094041, "body": "Things that start with a capital letter are not functions."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1524735300, "post_id": 50036612, "comment_id": 87095169, "body": "Addendum: <code>Map</code> is Haskell&#39;s name for what some other languages call a <i>dictionary</i>."}], "tags": [], "owner": {"reputation": 8064, "user_id": 5910563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/snpEp.jpg?s=128&g=1", "display_name": "Horia Coman", "link": "https://stackoverflow.com/users/5910563/horia-coman"}, "is_accepted": false, "score": 8, "last_activity_date": 1524725714, "creation_date": 1524725714, "answer_id": 50036612, "question_id": 50036527, "link": "https://stackoverflow.com/questions/50036527/haskell-stuck-on-understanding-type-synonyms/50036612#50036612", "title": "Haskell, stuck on understanding type synonyms", "body": "<p><a href=\"https://downloads.haskell.org/~ghc/6.12.2/docs/html/libraries/containers-0.3.0.0/Data-Map.html#t%3AMap\" rel=\"noreferrer\"><code>Map</code></a> is the name of a type. It's an <a href=\"https://en.wikipedia.org/wiki/Associative_array\" rel=\"noreferrer\">associative array</a> and maps values of type <code>T</code> to values of type <code>K</code>. So <code>IntMap</code> is the type of a <code>Map</code> which has <code>Int</code> keys and <code>v</code> values. Maps are also known as dictionaries in some languages. They're implemented by hash tables, balanced trees or other more exotic data structures.</p>\n\n<p>It's an unfortunate name collision that there's also the <code>map</code> function. They <em>kind of</em> do the same thing, only in different contexts. <code>map</code> transforms values in the input by applying a function to them, whereas <code>Map</code> transforms input keys to output values.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1524730268, "creation_date": 1524730268, "answer_id": 50037977, "question_id": 50036527, "link": "https://stackoverflow.com/questions/50036527/haskell-stuck-on-understanding-type-synonyms/50037977#50037977", "title": "Haskell, stuck on understanding type synonyms", "body": "<p>There is a type named <code>Map</code> (with a capital \"M\"). There is also a function named <code>map</code> (with a lowercase \"M\"). These are unrelated other than having kind-of similar names. Try not to confuse them. ;-)</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524730268, "creation_date": 1524725395, "question_id": 50036527, "link": "https://stackoverflow.com/questions/50036527/haskell-stuck-on-understanding-type-synonyms", "title": "Haskell, stuck on understanding type synonyms", "body": "<p>From LYAH book, parameterizing type synonyms:\nI would understand:</p>\n\n<pre><code>type MyName = String\n</code></pre>\n\n<p>But this example I don't get:</p>\n\n<pre><code>type IntMap v = Map Int v -- let alone it can be shortened\n</code></pre>\n\n<p>'Map' is a function, not a type, right? This got me in loops in the book constantly now. Next to that: Map would require a function and a list to work, correct? If so, and 'v' is the list, what is the 'Int'?</p>\n"}]