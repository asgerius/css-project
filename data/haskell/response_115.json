[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "edited": false, "score": 0, "creation_date": 1490264626, "post_id": 42963828, "comment_id": 73038677, "body": "You might use this one-liner: <code>length $ filter (True==) $ zipWith (==) a b</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1218, "user_id": 6042307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6ebc7609bac3a4ddf6c7920c2c083a?s=128&d=identicon&r=PG", "display_name": "gabesoft", "link": "https://stackoverflow.com/users/6042307/gabesoft"}, "is_accepted": false, "score": 2, "last_activity_date": 1490224725, "last_edit_date": 1490224725, "creation_date": 1490221963, "answer_id": 42963891, "question_id": 42963828, "link": "https://stackoverflow.com/questions/42963828/compare-elements-from-two-lists/42963891#42963891", "title": "Compare elements from two lists", "body": "<p>You could <code>zip</code> the two lists and then compare on the resulting tuples lists\n<code>map (uncurry compare) $ zip l1 l2</code> assuming you have two lists <code>l1</code> and <code>l2</code></p>\n\n<p>and to count all places where they have the same elements\n<code>\nlength $ filter (== EQ) $ map (uncurry compare) $ zip l1 l2\n</code></p>\n"}, {"comments": [{"owner": {"reputation": 173, "user_id": 7296110, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208108898459740/picture?type=large", "display_name": "Kostas Thanasis", "link": "https://stackoverflow.com/users/7296110/kostas-thanasis"}, "edited": false, "score": 0, "creation_date": 1490252399, "post_id": 42964573, "comment_id": 73031287, "body": "Ambiguous variable occurrence &quot;compare&quot; *** Could refer to: Main.compare Hugs.Prelude.compare  I got this error now."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 173, "user_id": 7296110, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208108898459740/picture?type=large", "display_name": "Kostas Thanasis", "link": "https://stackoverflow.com/users/7296110/kostas-thanasis"}, "edited": false, "score": 0, "creation_date": 1490262013, "post_id": 42964573, "comment_id": 73036747, "body": "@KostasThanasis: That means you\u2019ve defined <code>compare</code> in the <code>Main</code> (default) module of your program, but <code>Hugs.Prelude</code> (which is the portion of the standard library that is imported by default) already defines a function named <code>compare</code>, so when you use <code>compare</code>, the compiler can\u2019t tell which one you mean. You can: 1. say <code>import Prelude hiding (compare)</code> (at least in GHC Haskell\u2014I don\u2019t know about Hugs), 2. rename <code>compare</code> to something else, or 3. use the fully qualified name <code>Main.compare</code> when you call the function."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 3, "last_activity_date": 1490225386, "creation_date": 1490225386, "answer_id": 42964573, "question_id": 42963828, "link": "https://stackoverflow.com/questions/42963828/compare-elements-from-two-lists/42964573#42964573", "title": "Compare elements from two lists", "body": "<p>The problems with your code are:</p>\n\n<ul>\n<li><p>The patterns: you\u2019re defining <code>compare [a] [b]</code>, but you want <code>a</code> and <code>b</code> to be lists because you\u2019re using them with <code>head</code> and <code>tail</code>. Just define <code>compare a b</code> instead.</p></li>\n<li><p>The order of the patterns: the first match wins, so your <code>compare [] b = 0</code> should come first.</p></li>\n<li><p><code>compare (tail a tail b)</code> should be giving two arguments to <code>compare</code>, not three arguments to <code>tail</code>. <code>compare (tail a) (tail b)</code>.</p></li>\n</ul>\n\n<p>All told:</p>\n\n<pre><code>compare :: [Int] -&gt; [Int] -&gt; Int\ncompare [] _ = 0\ncompare a b =\n    if head a == head b then\n        1 + compare (tail a) (tail b)\n    else\n        compare (tail a) (tail b)\n</code></pre>\n\n<p>And although it probably isn\u2019t suitable for homework, it might be fun to know that you can write this by getting a list of booleans indicating whether certain positions are equal, filtering them to only true values, and getting the resulting length:</p>\n\n<pre><code>compare a = length . filter id . zipWith (==) a\n\n-- this works too\ncompare a = sum . fromEnum . zipWith (==) a\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 7296110, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208108898459740/picture?type=large", "display_name": "Kostas Thanasis", "link": "https://stackoverflow.com/users/7296110/kostas-thanasis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3209, "favorite_count": 1, "accepted_answer_id": 42964573, "answer_count": 2, "score": 1, "last_activity_date": 1490225485, "creation_date": 1490221708, "last_edit_date": 1490225485, "question_id": 42963828, "link": "https://stackoverflow.com/questions/42963828/compare-elements-from-two-lists", "title": "Compare elements from two lists", "body": "<p>I\u2019m doing my homework in Haskell and I got to a point where I need to compare two lists element by element and count how many elements are the same <em>and</em> in the same place: the first element of the first list with the first element of the second list, etc..</p>\n\n<p>Here\u2019s what I have:</p>\n\n<pre><code>compare :: [Int]-&gt;[Int]-&gt;Int\ncompare [a] [b]= if head a == head b then 1 + compare (tail a tail b) else 0 + compare (tail a tail b)\n\ncompare [] [b] = 0\n</code></pre>\n\n<p>I know in advance that they will both be lists with 8 <code>Int</code>s as elements.</p>\n"}, {"tags": ["haskell", "generic-programming", "abstract-data-type"], "comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1490425076, "post_id": 42961164, "comment_id": 73116017, "body": "Why are you required to provide <code>instance Data Table</code>? I don&#39;t remember this requirement for <code>ixset</code>. I think it&#39;s only needed for <code>ixGen</code>."}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "reply_to_user": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1490462580, "post_id": 42961164, "comment_id": 73127054, "body": "Yes it&#39;s only needed for <code>ixGen</code>"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1490603821, "post_id": 42961164, "comment_id": 73167563, "body": "But you wouldn&#39;t use <code>ixGen</code> on an abstract type, so I still don&#39;t understand the question."}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "reply_to_user": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1490835301, "post_id": 42961164, "comment_id": 73294478, "body": "Can you provide an example of <code>instance Indexable Table</code>? <code>Table</code> is not abstract but it has an abstract field"}], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1490215173, "creation_date": 1490211514, "last_edit_date": 1490215173, "question_id": 42961164, "link": "https://stackoverflow.com/questions/42961164/abstract-data-type-unindexed-columns-in-ixset", "title": "Abstract data type/unindexed columns in IxSet", "body": "<p><code>Data.IxSet</code> from <code>ixset</code> library provides multicolumn tables with indices for each column and computed indices for non-existent columns.</p>\n\n<p>How can I put an abstract value there in an unindexed column?</p>\n\n<p>Here is an example. I have <code>Lib</code> module that exports <code>Abstract</code> type without any constructors but with some functions to manipulate the opaque values.</p>\n\n<pre><code>module Lib (Abstract, makeAbstract) where\ndata Abstract = Abstract (Int -&gt; Int)\nmakeAbstract x = Abstract (\\x -&gt; 42 * x + y)\n</code></pre>\n\n<p>I can have normal map such as <code>Map String Abstract</code> as value type is unconstrained there. But I cannot have <code>IxSet Table</code> which is sort of <code>(Map String Abstract, Map Int Abstract)</code>:</p>\n\n<pre><code>module User where\nimport Lib\n\ndata Table = Table { tKey1 :: String, tKey2 :: Int, tValue :: Abstract }\n</code></pre>\n\n<p>Because I'm required to provide an <code>instance Data Table</code>. Ideally I'd like to have <code>newtype Opaque a = Opaque a</code> which has all necessary instances for any <code>a</code> without imposing constraints on it, and use something like:</p>\n\n<pre><code>data Table = Table { tKey1 :: String, tKey2 :: Int, tValue :: Opaque Abstract }\n  deriving (Data, Typable, ...)\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1490209314, "post_id": 42960485, "comment_id": 73015273, "body": "Make sure you actually have the <code>QuasiQuotes</code> extension turned on."}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1490209402, "post_id": 42960485, "comment_id": 73015318, "body": "head -&gt; desk - thanks"}], "answers": [{"tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 3, "last_activity_date": 1490209609, "creation_date": 1490209609, "answer_id": 42960599, "question_id": 42960485, "link": "https://stackoverflow.com/questions/42960485/write-an-inside-quasiquotes/42960599#42960599", "title": "Write an = inside QuasiQuotes", "body": "<p>You need to enable the correct language extension for QuasiQuotes to work. In source code: </p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\n</code></pre>\n\n<p>In GHCI: </p>\n\n<pre><code>:set -XQuasiQuotes \n</code></pre>\n"}], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 42960599, "answer_count": 1, "score": 1, "last_activity_date": 1490209609, "creation_date": 1490209240, "question_id": 42960485, "link": "https://stackoverflow.com/questions/42960485/write-an-inside-quasiquotes", "title": "Write an = inside QuasiQuotes", "body": "<p>How do I write a <code>=</code> inside a QuasiQuote expression?</p>\n\n<pre><code>[uri|https://graph.facebook.com/me?fields=id,name,email|]\n</code></pre>\n\n<p>Currently I get</p>\n\n<pre><code>example/Facebook/test.hs:56:83: error:\n    parse error on input \u2018=\u2019\n    Perhaps you need a 'let' in a 'do' block?\n    e.g. 'let x = 5' instead of 'x = 5'\n</code></pre>\n"}, {"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1490206907, "post_id": 42959514, "comment_id": 73013914, "body": "Why does your program need to halt to perform any actions? This isn&#39;t unique to haskell in that regard. I can write infinite for loops in any language and have them print on each iteration."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1490207824, "post_id": 42959514, "comment_id": 73014418, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28203214/why-how-does-recursive-io-work\">Why/how does recursive IO work?</a>"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1490207880, "post_id": 42959514, "comment_id": 73014458, "body": "@jkeuhlen But in those other languages you&#39;re printing via side-effects - that&#39;s trivial. The OP&#39;s question is how any of the constructed <code>IO</code> value can be executed if the function constructing that IO value never returns (and the answer to that is laziness). That question isn&#39;t really applicable to other languages."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1490208125, "post_id": 42959514, "comment_id": 73014598, "body": "@sepp2k Fair enough, I missed that distinction from the question. I&#39;ll update my answer to deal with laziness more as well."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1490218791, "post_id": 42959514, "comment_id": 73020411, "body": "<code>infi</code> is not a function. Also, Haskell functions don&#39;t &quot;return&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1490207069, "post_id": 42959805, "comment_id": 73014026, "body": "This is not correct. Infi will be evaluated endlessly."}, {"owner": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1490207113, "post_id": 42959805, "comment_id": 73014052, "body": "That&#39;s exactly what I just said"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1490207282, "post_id": 42959805, "comment_id": 73014152, "body": "@user3206627 No, you said it would never <i>return</i>. Since Haskell is lazy, <code>infi</code> does return, the problem is that its <i>evaluation</i> takes forever."}, {"owner": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "edited": false, "score": 0, "creation_date": 1490208309, "post_id": 42959805, "comment_id": 73014702, "body": "Ah, didn&#39;t pay attention to the language. I did some reading about Haskell, and I&#39;m curious about one thing -- while the semantics of &#39;return&#39; and &#39;evaluate&#39; are different, what is it conceptually that makes this scenario any different than in a non-evaled language? We are still ending up with a recursive action."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1490208596, "post_id": 42959805, "comment_id": 73014871, "body": "@user3206627. Lazy evaluation is the difference."}, {"owner": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "edited": false, "score": 0, "creation_date": 1490208999, "post_id": 42959805, "comment_id": 73015079, "body": "Lazy evaluation has no bearing over the concept of recursion in this situation. Even in your answer below you don&#39;t make the connection, as you say &#39;but it evaluates infinitely because it has no base case&#39;. Verbiage aside, the concept of that is no different than the concept I outlined above."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1490209434, "post_id": 42959805, "comment_id": 73015329, "body": "@user3206627 Maybe read through the question I flagged as a duplicate? <a href=\"http://stackoverflow.com/questions/28203214/why-how-does-recursive-io-work\" title=\"why how does recursive io work\">stackoverflow.com/questions/28203214/&hellip;</a> It has better answers than the one I wrote. I&#39;m only a year into learning Haskell so I try to teach what I can, but my explanations may not be the most clear yet."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1490218936, "post_id": 42959805, "comment_id": 73020474, "body": "@Alec I would say that since Haskell is lazy, &quot;<code>infi</code> does return&quot; is a statement that makes no sense."}], "tags": [], "owner": {"reputation": 39, "user_id": 3206627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a21c9c561c6fced2984ccd18740053?s=128&d=identicon&r=PG&f=1", "display_name": "user3206627", "link": "https://stackoverflow.com/users/3206627/user3206627"}, "is_accepted": false, "score": -1, "last_activity_date": 1490206883, "creation_date": 1490206883, "answer_id": 42959805, "question_id": 42959514, "link": "https://stackoverflow.com/questions/42959514/how-infinite-loop-with-io-work-in-haskell/42959805#42959805", "title": "How infinite loop with IO work in haskell", "body": "<p>Because infi is set to recursively call its self. The 'return' that is expected from main will never be met, as the first call to infi will never return. </p>\n\n<pre><code># The first call to infi will never return as the calls to infi\n# will just continue to add more calls to the stack, until you exceed\n# the size :)\n\nmain -&gt;\n  infi -&gt;\n    infi -&gt;\n      infi -&gt; ..\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2330, "user_id": 2708169, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/100002659380732/picture?type=large", "display_name": "Faiz Halde", "link": "https://stackoverflow.com/users/2708169/faiz-halde"}, "edited": false, "score": 1, "creation_date": 1490207838, "post_id": 42959999, "comment_id": 73014428, "body": "Hmm. Actually many blogs mention that when we write print &quot;hello&quot;, it returns an action of printing the hello string. The print as such doesn&#39;t happen. It&#39;s the main that then evaluates the action to print it"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 2330, "user_id": 2708169, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/100002659380732/picture?type=large", "display_name": "Faiz Halde", "link": "https://stackoverflow.com/users/2708169/faiz-halde"}, "edited": false, "score": 0, "creation_date": 1490208581, "post_id": 42959999, "comment_id": 73014863, "body": "@FaizHalde I added a little extra to explain the laziness. Does that help more?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 2330, "user_id": 2708169, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/100002659380732/picture?type=large", "display_name": "Faiz Halde", "link": "https://stackoverflow.com/users/2708169/faiz-halde"}, "edited": false, "score": 0, "creation_date": 1490218896, "post_id": 42959999, "comment_id": 73020458, "body": "@FaizHalde That is correct (mostly). And <code>do putStrLn &#39;hello&#39;</code> <code>infi</code> doesn&#39;t &quot;call&quot; <code>infi</code>. It returns an action of printing the hello string followed by &quot;calling&quot; <code>infi</code>."}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 3, "last_activity_date": 1490208554, "last_edit_date": 1490208554, "creation_date": 1490207579, "answer_id": 42959999, "question_id": 42959514, "link": "https://stackoverflow.com/questions/42959514/how-infinite-loop-with-io-work-in-haskell/42959999#42959999", "title": "How infinite loop with IO work in haskell", "body": "<p>You seem to have a misunderstanding as to how Haskell actually implements IO. There is plenty of other literature on the subject and several other answers on this site that deal with it, so I'll focus on your specific example rather than the general. </p>\n\n<pre><code>infi = \n  do\n   print \"hello\"\n   infi\n\nmain = \n  do\n    infi\n</code></pre>\n\n<p>First off, you can simplify your main action (It doesn't need to have a <code>do</code>): </p>\n\n<pre><code>main = infi \n</code></pre>\n\n<p>In haskell, \"return\" is not the same as an imperative \"return\". It simply means injection into a monadic action, i.e. <code>return :: Monad m =&gt; a -&gt; m a</code>. So let's talk about what things are evaluated here, not when things return. </p>\n\n<p>All your <code>main</code> function does is call the value <code>infi</code> which is of type <code>infi :: IO ()</code>. Since <code>infi</code> is an <code>IO</code> action, it can perform prints. Like any other value, it can also reference other values (in this case, it is recursive so it calls itself). Without a base case, infi will continue to perform the following sequence (just like it's laid out in your <code>do</code> block!):</p>\n\n<ol>\n<li>print \"hello\" to STDOUT</li>\n<li>evaluate the value infi\n\n<ol>\n<li>print \"hello\" to STDOUT</li>\n<li>evalute the value infi<br>\n...\nThe stack continues forever, since there is no base case in the recursion.</li>\n</ol></li>\n</ol>\n\n<p>The main reason this can work is because of Haskell's lazy evaluation. Haskell never actually computes values until you need it. That's why you can do pure actions with infinite lists as well:</p>\n\n<pre><code>let x = [1..] -- x is an infinite list. If you told haskell to print every element, it would run forever since it would evaluate the whole thing. \nlet y = x !! 3 -- y = 2. This is not infinite because you are only evaluating the first three elements, instead of the whole value.\n</code></pre>\n\n<p>The same is true of your infinite value <code>infi</code>. Haskell can create a \"run-time-script\" that contains the infinite actions because the <em>value</em> of infi has a finite representation (its name), but it evaluates infinitely because it has no base case. </p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1490210585, "creation_date": 1490210585, "answer_id": 42960877, "question_id": 42959514, "link": "https://stackoverflow.com/questions/42959514/how-infinite-loop-with-io-work-in-haskell/42960877#42960877", "title": "How infinite loop with IO work in haskell", "body": "<p>It is very similar to the program</p>\n\n<pre><code>ones = 1 : ones\n</code></pre>\n\n<p>The above is recursive, yes. It calls itself infinitely many times, yes. But it <em>does</em> return. It returns an infinite list. By comparison,</p>\n\n<pre><code>noList = noList\n</code></pre>\n\n<p>will loop forever without ever returning a list. (Actually, the GHC runtime detect this and throws an exception, but this is irrelevant for the discussion.)</p>\n\n<p>Similarly,</p>\n\n<pre><code>printOnes = print 1 &gt;&gt; printOnes\n-- or, equivalently\nprintOnes = do\n   print 1\n   printOnes\n</code></pre>\n\n<p>builds an IO action which will print <code>1</code> forever, even if it does recurse infinitely many times. Instead,</p>\n\n<pre><code>noPrint = noPrint\n</code></pre>\n\n<p>would loop forever and never return an IO action.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 3, "last_activity_date": 1490213169, "creation_date": 1490213169, "answer_id": 42961649, "question_id": 42959514, "link": "https://stackoverflow.com/questions/42959514/how-infinite-loop-with-io-work-in-haskell/42961649#42961649", "title": "How infinite loop with IO work in haskell", "body": "<p><code>infi</code> is essentially an infinite stream of the same <code>IO</code> action, connected with monadic sequencing (<code>&gt;&gt;</code>) instead of cons (<code>:</code>):</p>\n\n<pre><code>fives = 5                :  fives\ninfi  = putStrLn \"hello\" &gt;&gt; infi\n</code></pre>\n\n<p>In fact, we could abstract out the monadic bind using a list of actions <code>infi'</code>:</p>\n\n<pre><code>infi' :: [IO ()]\ninfi' = putStrLn \"hello\" : infi'\n</code></pre>\n\n<p>Then recover <code>infi</code> with <code>sequence_</code>, which can be implemented as <code>foldr (&gt;&gt;) (return ())</code>.</p>\n\n<pre><code>infi = sequence_ infi'\ninfi = (foldr (&gt;&gt;) (return ()) infi')\ninfi = putStrLn \"hello\" &gt;&gt; (foldr (&gt;&gt;) (return ()) infi')\ninfi = putStrLn \"hello\" &gt;&gt; (putStrLn \"hello\" &gt;&gt; (foldr (&gt;&gt;) (return ()) infi'))\ninfi = putStrLn \"hello\" &gt;&gt; (putStrLn \"hello\" &gt;&gt; (putStrLn \"hello\" &gt;&gt; ...))\n</code></pre>\n\n<p>Storing the actions in a stream like this also lets you manipulate them as first-class values:</p>\n\n<pre><code>&gt; sequence_ (take 3 infi')\nhello\nhello\nhello\n</code></pre>\n\n<p>When the Haskell runtime executes your <code>main</code> action, it evaluates <code>infi</code>, finds a <code>&gt;&gt;</code> expression, evaluates its left-hand argument to produce the action <code>putStrLn \"hello\"</code>, <em>executes</em> that action, then proceeds to the right-hand argument\u2014which happens to be <code>infi</code> again. Evaluation is lazily driven by the internal pattern matching in the <code>Monad</code> instance for <code>IO</code>.</p>\n"}], "owner": {"reputation": 2330, "user_id": 2708169, "user_type": "registered", "accept_rate": 49, "profile_image": "https://graph.facebook.com/100002659380732/picture?type=large", "display_name": "Faiz Halde", "link": "https://stackoverflow.com/users/2708169/faiz-halde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2718, "favorite_count": 0, "accepted_answer_id": 42959999, "answer_count": 4, "score": 2, "last_activity_date": 1490213169, "creation_date": 1490206009, "question_id": 42959514, "link": "https://stackoverflow.com/questions/42959514/how-infinite-loop-with-io-work-in-haskell", "title": "How infinite loop with IO work in haskell", "body": "<p>In haskell, all the IO code that we write is just an action (many suggest to think it as a script being generated). It is the main method that finally executes them (execute the constructed script). So how does the following program work ? <code>infi</code> function will never return. So why does the string get printed infinitely ?</p>\n\n<pre><code>infi = \n    do\n     print \"hello\"\n     infi\n\nmain = \n    do\n     infi\n</code></pre>\n"}, {"tags": ["performance", "haskell"], "comments": [{"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1490197599, "post_id": 42956238, "comment_id": 73007605, "body": "ST monad is eventually immutable computation as far as I know. In this context it&#39;ll be natural."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1490211817, "post_id": 42956238, "comment_id": 73016683, "body": "The <code>ST</code> version should definitely be faster for, because <code>runSTUArray</code> uses <a href=\"https://hackage.haskell.org/package/ghc-prim-0.5.0.0/docs/GHC-Prim.html#v:unsafeFreezeArray-35-\" rel=\"nofollow noreferrer\"><code>unsafeFreezeArray#</code></a> internally, whereas your <code>IO</code> version (unnecessarily) uses the copying version, <a href=\"https://hackage.haskell.org/package/ghc-prim-0.5.0.0/docs/GHC-Prim.html#v:freezeArray-35-\" rel=\"nofollow noreferrer\"><code>freezeArray#</code></a>. By the way, some work in progress in GHC could lead to <code>ST</code> operations being optimized a bit better in general, and to some <code>IO</code> operations slowing down a bit (to get better behavior). So stick with <code>ST</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1490201576, "post_id": 42957147, "comment_id": 73010507, "body": "Uhm... are <code>nf</code> and <code>nfIO</code> evaluating the whole <code>[Int]</code> list? Isn&#39;t this comparing only how much time it takes for the first element? (And if so, does that really matter?)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1490201693, "post_id": 42957147, "comment_id": 73010589, "body": "@chi <code>nf</code> stands for normal form (as opposed to <code>wnhf</code>), so I expect this is for the whole list."}, {"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "edited": false, "score": 0, "creation_date": 1490229937, "post_id": 42957147, "comment_id": 73024529, "body": "@Alec, I&#39;m compiling and executing with stack. I just did some profiling, the results are added to my original post. I will try the <code>criterion</code> benchmarking later."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 1, "last_activity_date": 1490199037, "creation_date": 1490199037, "answer_id": 42957147, "question_id": 42956238, "link": "https://stackoverflow.com/questions/42956238/performance-difference-between-iouarray-and-stuarray-in-prime-sieve/42957147#42957147", "title": "Performance difference between IOUArray and STUArray (in Prime Sieve)", "body": "<p>I'm not sure what is skewing your measurements, but with <a href=\"https://hackage.haskell.org/package/criterion-1.1.4.0\" rel=\"nofollow noreferrer\"><code>criterion</code></a> replacing your <code>main</code> with the following</p>\n\n<pre><code>import Criterion\nimport Criterion.Main\n\nmain = do\n  n &lt;- readLn\n  defaultMain\n    [ bench \"io\"  $ nfIO (primeSieveIO n)\n    , bench \"st\"  $ nf primeSieveST n\n    ]\n</code></pre>\n\n<p>No matter what input <code>n</code> I enter (<code>criterion</code> does some funky stuff with arguments which is why <code>n</code> is read from STDIN), the <code>ST</code> version is about 25% faster. Here is one interaction:</p>\n\n<pre><code>$ ./test\n100000\nbenchmarking io\ntime                 201.2 ms   (140.3 ms .. 280.0 ms)\n                     0.943 R\u00b2   (0.797 R\u00b2 .. 1.000 R\u00b2)\nmean                 214.3 ms   (196.2 ms .. 237.6 ms)\nstd dev              26.22 ms   (14.72 ms .. 32.72 ms)\nvariance introduced by outliers: 31% (moderately inflated)\n\nbenchmarking st\ntime                 141.9 ms   (139.8 ms .. 143.5 ms)\n                     1.000 R\u00b2   (0.999 R\u00b2 .. 1.000 R\u00b2)\nmean                 141.0 ms   (140.4 ms .. 141.6 ms)\nstd dev              815.1 \u03bcs   (476.3 \u03bcs .. 1.139 ms)\nvariance introduced by outliers: 12% (moderately inflated)\n</code></pre>\n\n<p>When I factor in file writes, the <code>IO</code> version is much <em>slower</em>. Are you compiling this or running in GHCi? If the latter, try compiling.</p>\n"}, {"comments": [{"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "edited": false, "score": 0, "creation_date": 1490582666, "post_id": 43036206, "comment_id": 73159515, "body": "Yes, this seems to work. Is this a bug in <code>ghc</code>? It cannot optimize properly when the type signature is too general."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "edited": false, "score": 0, "creation_date": 1490893570, "post_id": 43036206, "comment_id": 73327464, "body": "I added a little more detail to my answer.  I&#39;m not sure that it&#39;s a bug, per se.  An optimized version of <code>markOff</code> can only be generated for a more specialized type signature than the general one given; it&#39;s just that for the IO case, GHC goes ahead and generates an extra, specialized definition that it doesn&#39;t generate for the ST version."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1490893241, "last_edit_date": 1490893241, "creation_date": 1490574886, "answer_id": 43036206, "question_id": 42956238, "link": "https://stackoverflow.com/questions/42956238/performance-difference-between-iouarray-and-stuarray-in-prime-sieve/43036206#43036206", "title": "Performance difference between IOUArray and STUArray (in Prime Sieve)", "body": "<p><strong>Edited</strong> to add more detail and a better workaround.</p>\n\n<p>I'm able to duplicate the issue with Stack lts-8.5, compiling with <code>-O3</code>.</p>\n\n<p>After looking at the resulting GHC core, it looks like in the IO case, the compiler is able to generate a specialized version of <code>markOff</code> that inlines the array writes (literally inlining the setting of the bits in the bit array) into the loop.  For the ST case, it uses a general version of <code>markOff</code> instead, and every write goes through an <code>unsafeWrite</code> polymorphic call dispatched on the exact <code>MArray</code> type which is much, much slower.</p>\n\n<p>If you add a copy of <code>markOff</code> named <code>markOffST</code> with a signature specialized to <code>STUArray</code>s:</p>\n\n<pre><code>markOffST :: (Integral i,Ix i) =&gt; STUArray s i Bool -&gt; i -&gt; i -&gt; ST s ()\nmarkOffST arr a n = do\n  forM_ [2*a,2*a+a..n] $ \\b -&gt; writeArray arr b False\n</code></pre>\n\n<p>and then use it in <code>primeSieveST</code>, the compiler generates the above specialization for <code>markOffST</code> with inlined writes, and you'll find that the ST version is as fast as the IO version (at least when compiling with <code>-O3</code>).</p>\n\n<p>It's hard to say if this is a compiler \"bug\" or not.  GHC just isn't quite making the leap of generating a specialized version of <code>markOff</code> in the ST case without a little help.</p>\n\n<p>A workaround without changing signatures is to ask GHC to inline the <code>markOff</code> function:</p>\n\n<pre><code>{-# INLINE markOff #-}\nmarkOff :: ...\n</code></pre>\n\n<p>which permits the specialized loop code to be generated in both <code>primeSieveIO</code> and <code>primeSieveST</code>.</p>\n"}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1490893241, "creation_date": 1490196876, "last_edit_date": 1490230584, "question_id": 42956238, "link": "https://stackoverflow.com/questions/42956238/performance-difference-between-iouarray-and-stuarray-in-prime-sieve", "title": "Performance difference between IOUArray and STUArray (in Prime Sieve)", "body": "<p>I made a prime sieve in Haskell using mutable arrays. The two main mutable arrays are <code>IOUArray</code> and <code>STUArray</code> so I checked the performance with both.</p>\n\n<p>On my computer the <code>IOUArray</code> runs five times faster than <code>STUArray</code> even though the code structure is pretty much the same. Is this expected? Is there something I'm missing to get <code>STUArray</code> to run faster?</p>\n\n<p>Edit: I did some profiling, the results can be found below the code.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nmodule Main where\n\nimport Data.Array.MArray\nimport Data.Array.IO\nimport Data.Array.ST\nimport Control.Monad.ST\nimport Data.Array.Unboxed\nimport Control.Monad\nimport System.IO\nimport System.Environment (getArgs)\n\nmain :: IO ()\nmain = mainIO \n--main = mainST\n\nmainST :: IO ()\nmainST = do\n  [n',outdir] &lt;- getArgs\n  let n      = read n' :: Int\n      primes = primeSieveST n\n  writeFile outdir (unlines . map show $ primes)\n  putStrLn \"Primes found using STUArray\"\n\nmainIO :: IO ()\nmainIO = do\n  [n',outdir] &lt;- getArgs\n  let n      = read n' :: Int\n  primes &lt;- primeSieveIO n\n  writeFile outdir (unlines . map show $ primes)\n  putStrLn \"Primes found using IOUArray\"\n\n-- Prime sieve using IOUArray\nprimeSieveIO :: Int -&gt; IO [Int]\nprimeSieveIO n = do\n  arr &lt;- newArray (1,n) True :: IO (IOUArray Int Bool)\n  writeArray arr 1 False\n  let p=2\n  forM_ [p..n] $ \\a -&gt; do\n      v &lt;- readArray arr a\n      if v then markOff arr a n\n           else return ()\n  iarr &lt;- freeze arr :: IO (UArray Int Bool)\n  return . map fst . filter (\\(_,a)-&gt; a) $ assocs iarr\n\n-- Prime sieve using STUArray\nprimeSieveST :: Int -&gt; [Int]\nprimeSieveST n = map fst . filter (\\(_,a) -&gt; a) . assocs $ runSTUArray $ do\n  arr &lt;- newArray (1,n) True\n  writeArray arr 1 False\n  let p = 2\n  forM_ [p..n] $ \\a -&gt; do\n      v &lt;- readArray arr a\n      if v then markOff arr a n \n           else return ()\n  return arr\n\n\nmarkOff :: (Integral i,Ix i, MArray a Bool m)  =&gt; a i Bool -&gt; i -&gt; i -&gt; m ()\nmarkOff arr a n = do\n  forM_ [2*a,2*a+a..n] $ \\b -&gt; writeArray arr b False \n</code></pre>\n\n<p>I profiled the code (the program is managed by stack, in case it matters), here are the key differences from the <code>.prof</code> files:</p>\n\n<p>Using the <code>IOUArray</code>:</p>\n\n<pre><code>COST CENTRE    MODULE SRC                          %time %alloc\n\nmarkOff        Main   app/Main.hs:(60,1)-(61,53)    64.1   55.5\nprimeSieveIO   Main   app/Main.hs:(35,1)-(44,54)    25.2   34.7\nmainIO         Main   app/Main.hs:(26,1)-(31,40)     5.9    9.8\nmarkOff.\\      Main   app/Main.hs:61:32-53           3.6    0.0\nprimeSieveIO.\\ Main   app/Main.hs:(39,24)-(42,33)    1.3    0.0\n</code></pre>\n\n<p>Using the <code>STUArray</code>:</p>\n\n<pre><code>COST CENTRE  MODULE    SRC                         %time %alloc\n\nmarkOff.\\    Main      app/Main.hs:61:32-53         63.1   51.9\nmarkOff      Main      app/Main.hs:(60,1)-(61,53)   26.7   33.7\nprimeSieveST Main      app/Main.hs:(48,1)-(56,12)    7.5   10.9\nmainST       Main      app/Main.hs:(18,1)-(23,40)    1.8    2.9\n</code></pre>\n\n<p>So for some reason, the writing function is taking much longer for the STUArray. This program was built and run using stack on OSX. The function on line 61:32-53 is the <code>writeArray</code> function.</p>\n"}, {"tags": ["haskell", "math", "recursion"], "comments": [{"owner": {"reputation": 13863, "user_id": 6162307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6y4Ix.jpg?s=128&g=1", "display_name": "Ma0", "link": "https://stackoverflow.com/users/6162307/ma0"}, "edited": false, "score": 1, "creation_date": 1490186671, "post_id": 42951913, "comment_id": 72998904, "body": "Why would you need a recursive function to do that?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1490186679, "post_id": 42951913, "comment_id": 72998909, "body": "Well you first keep incrementing until you reach <code>x &gt; 100</code> and next you will alternate with -10 and +11 until you reach the fixed point: <code>91</code>..."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1490186812, "post_id": 42951913, "comment_id": 72999003, "body": "I imagine there&#39;s a far easier, more straightforward solution to this. This seems convoluted."}, {"owner": {"reputation": 11950, "user_id": 576746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fd655b00d23f25a744dbd630b7fdd09d?s=128&d=identicon&r=PG", "display_name": "Blackbam", "link": "https://stackoverflow.com/users/576746/blackbam"}, "edited": false, "score": 0, "creation_date": 1490186981, "post_id": 42951913, "comment_id": 72999130, "body": "Do you want us to solve your homework? ;-) Thats university 1st semester stuff."}, {"owner": {"reputation": 40, "user_id": 5950897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQiIF.jpg?s=128&g=1", "display_name": "Leo Mingo", "link": "https://stackoverflow.com/users/5950897/leo-mingo"}, "reply_to_user": {"reputation": 13863, "user_id": 6162307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6y4Ix.jpg?s=128&g=1", "display_name": "Ma0", "link": "https://stackoverflow.com/users/6162307/ma0"}, "edited": false, "score": 0, "creation_date": 1490187066, "post_id": 42951913, "comment_id": 72999201, "body": "@Ev.Kounis It&#39;s not I need such a function, I just read the code and was willing to understand it."}, {"owner": {"reputation": 13863, "user_id": 6162307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6y4Ix.jpg?s=128&g=1", "display_name": "Ma0", "link": "https://stackoverflow.com/users/6162307/ma0"}, "edited": false, "score": 0, "creation_date": 1490187183, "post_id": 42951913, "comment_id": 72999286, "body": "Assume you run with an input of <code>5</code>. On every recursion it will add <code>11</code> to it until it becomes <code>&gt;100</code>. in this case it will be <code>5 + 9 * 11 = 104</code>. From that point on it will subtract <code>10</code> becoming <code>94</code>, then add <code>11</code> becoming <code>105</code> then <code>95</code>, <code>106</code>, <code>96</code>, <code>107</code>, <code>97</code>, <code>108</code>, <code>98</code>, <code>109</code>, <code>99</code>, <code>110</code>, <code>100</code>, <code>90</code>, <code>101</code>, <code>91</code>, bingo!"}, {"owner": {"reputation": 40, "user_id": 5950897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQiIF.jpg?s=128&g=1", "display_name": "Leo Mingo", "link": "https://stackoverflow.com/users/5950897/leo-mingo"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1490187340, "post_id": 42951913, "comment_id": 72999405, "body": "@WillemVanOnsem Thanks for the explanation, maybe it&#39;s my problem not to be able to understand the explanation, it seems rather obscure, why does 100 have to be the boundary number? and what if I change the value being subtracted or added by x? And finally how do I apply such a sort to other numbers?"}, {"owner": {"reputation": 40, "user_id": 5950897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQiIF.jpg?s=128&g=1", "display_name": "Leo Mingo", "link": "https://stackoverflow.com/users/5950897/leo-mingo"}, "reply_to_user": {"reputation": 13863, "user_id": 6162307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6y4Ix.jpg?s=128&g=1", "display_name": "Ma0", "link": "https://stackoverflow.com/users/6162307/ma0"}, "edited": false, "score": 0, "creation_date": 1490187519, "post_id": 42951913, "comment_id": 72999548, "body": "@Ev.Kounis Now I think I get it, thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1490200829, "post_id": 42952418, "comment_id": 73009949, "body": "This is a great answer, but it is also a link-only answer, which are against the SO policy, IIRC. You should expand it to integrate the main points of the linked-to page. <a href=\"http://stackoverflow.com/help/deleted-answers\">stackoverflow.com/help/deleted-answers</a>"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1490212624, "post_id": 42952418, "comment_id": 73017179, "body": "Forgot about that rule, thanks. It seems very odd to duplicate wiki, so I tried to add a bit of own insight without duplicating the linked info."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1490280215, "post_id": 42952418, "comment_id": 73050502, "body": "You are very welcome, hope I didn&#39;t mess anything up too much, the formal proof should probably explain the matter better"}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1490221055, "last_edit_date": 1490221055, "creation_date": 1490187748, "answer_id": 42952418, "question_id": 42951913, "link": "https://stackoverflow.com/questions/42951913/a-recursive-function-that-always-returns-91-given-a-natural-number-argument-unde/42952418#42952418", "title": "A recursive function that always returns 91 given a natural number argument under 100", "body": "<p>Have you seen <a href=\"https://en.wikipedia.org/wiki/McCarthy_91_function\" rel=\"nofollow noreferrer\">McCarthy 91 function</a>?</p>\n\n<p>Suppose you start with a value <code>x &gt; 100</code>, then the result is simply <code>x - 10</code>, so a value from <code>91</code> onwards. </p>\n\n<p>Now suppose the value is from <code>90</code> to <code>100</code>. Then <code>f91</code> takes the <code>else</code> branch and <code>x + 11</code> is between <code>101</code> and <code>111</code>. The first <code>f91</code> application brings all the value to the range <code>91 - 101</code>; only <code>101</code> satisfies the <code>then</code> branch of the second application of <code>f91</code>, and for that the result (<code>x - 10</code>) is <code>91</code>.</p>\n\n<p>For all the other values we get the range <code>102 - 111</code> in the <code>else</code> branch. However the <code>else</code> branch applies <code>f91 . f91</code> to that value; since all the values are <code>&gt; 100</code>, the first <code>f91</code> brings the values down to <code>92 - 101</code>, of which only <code>101</code> passes the condition <code>&gt; 100</code> of the second <code>f91</code> and becomes <code>91</code>. </p>\n\n<p>The rest of the values go through the same cycle until all become <code>91</code>. Suppose you have a different interval of <code>11</code> values below <code>100</code>. The <code>f91</code> first brings that interval above <code>100</code> and then keeps reducing the values to <code>91</code> starting from the higher end of the interval in the same manner. Please see the <strong>proof</strong> by induction linked in the wikipedia page.</p>\n"}], "owner": {"reputation": 40, "user_id": 5950897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQiIF.jpg?s=128&g=1", "display_name": "Leo Mingo", "link": "https://stackoverflow.com/users/5950897/leo-mingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 42952418, "answer_count": 1, "score": -1, "last_activity_date": 1490531264, "creation_date": 1490186433, "last_edit_date": 1490531264, "question_id": 42951913, "link": "https://stackoverflow.com/questions/42951913/a-recursive-function-that-always-returns-91-given-a-natural-number-argument-unde", "title": "A recursive function that always returns 91 given a natural number argument under 100", "body": "<p>I was reading a book introducing formal verification algorithms with Haskell Discrete Mathematics with Haskell, and there I found a counter-example of inductively defined functions:</p>\n\n<pre><code>f91 :: Int -&gt; Int\nf91 x = if x &gt; 100\n        then x - 10\n        else f91 . f91 $ x + 11\n</code></pre>\n\n<p>This recursive function is promised to return 91 if the argument ranges between 0 and 100: I hope somebody could explain to me how the algorithm of this recursive function works.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 7, "creation_date": 1490149590, "post_id": 42941456, "comment_id": 72979936, "body": "That missing instance is actually for the exception.  You have break on exception enabled, if you disable that then you will get <code>Prelude.read: no parse</code> which is probably more like what you expect"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1490171909, "creation_date": 1490171909, "answer_id": 42946447, "question_id": 42941456, "link": "https://stackoverflow.com/questions/42941456/reading-invalid-integer-in-ghci/42946447#42946447", "title": "Reading invalid integer in ghci", "body": "<p>Don't run GHCi with <a href=\"https://downloads.haskell.org/~ghc/8.0-latest/docs/html/users_guide/flags.html#interactive-mode-options\" rel=\"nofollow noreferrer\"><code>-fbreak-on-exception</code> or <code>-fbreak-on-error</code></a>, unless you want to <a href=\"https://downloads.haskell.org/~ghc/8.0-latest/docs/html/users_guide/ghci.html#ghci-debugger-exceptions\" rel=\"nofollow noreferrer\">debug</a> your program. In this case, you can continue with <code>:continue</code>:</p>\n\n<pre><code>$ /opt/ghc/8.0.2/bin/ghci -fbreak-on-error                                                                                                                                       \nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n\nPrelude&gt; read \"12 32\" :: Int\nStopped in &lt;exception thrown&gt;, &lt;unknown&gt;\n_exception :: e = _\n\n[&lt;unknown&gt;] Prelude&gt; :continue\n*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>Note that a single <code>continue</code> might not be enough if you use <code>-fbreak-on-exception</code>, since exceptions tend to get rethrown, and you have to handle each exception:</p>\n\n<pre><code>$ /opt/ghc/8.0.2/bin/ghci -fbreak-on-exception                                                                                                                                   \nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n\nPrelude&gt; read \"12 32\" :: Int\nStopped in &lt;exception thrown&gt;, &lt;unknown&gt;\n_exception :: e = _\n\n[&lt;unknown&gt;] Prelude&gt; :continue\nStopped in &lt;exception thrown&gt;, &lt;unknown&gt;\n_exception :: e = _\n\n[&lt;unknown&gt;] Prelude&gt; :continue\nStopped in &lt;exception thrown&gt;, &lt;unknown&gt;\n_exception :: e = _\n\n[&lt;unknown&gt;] Prelude&gt; :continue\n*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>By the way, without <code>break-on-X</code> we get the exception shown immediately:</p>\n\n<pre><code>$ /opt/ghc/8.0.2/bin/ghci -fno-break-on-exception -fno-break-on-error                                                                                                                                   \nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n\nPrelude&gt; read \"12 32\" :: Int\n*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>Also note that the actual output and behaviour depends on your GHC and other flags.</p>\n"}], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 42946447, "answer_count": 1, "score": 2, "last_activity_date": 1490171909, "creation_date": 1490148373, "question_id": 42941456, "link": "https://stackoverflow.com/questions/42941456/reading-invalid-integer-in-ghci", "title": "Reading invalid integer in ghci", "body": "<p>I tried the following and worked well.</p>\n\n<pre><code>ghci&gt; read \"1232\" :: Int\n1232\n</code></pre>\n\n<p>And the following is of course invalid, but error message isn't intuitive.</p>\n\n<pre><code>ghci&gt; read \"12 32\" :: Int\nStopped in &lt;exception thrown&gt;, &lt;unknown&gt;\n_exception :: e = _\nUnable to list source for &lt;unknown&gt;\nTry rerunning with :trace, :back then :list\nghci&gt; _exception\n\n&lt;interactive&gt;:21:1: error:\n    ? No instance for (Show e) arising from a use of \u2018print\u2019\n      Cannot resolve unknown runtime type \u2018e\u2019\n      Use :print or :force to determine these types\n      Relevant bindings include it :: e (bound at &lt;interactive&gt;:21:1)\n      These potential instances exist:\n        instance (Show b, Show a) =&gt; Show (Either a b)\n          -- Defined in \u2018Data.Either\u2019\n        instance Show Ordering -- Defined in \u2018GHC.Show\u2019\n        instance Show Integer -- Defined in \u2018GHC.Show\u2019\n        ...plus 23 others\n        ...plus 28 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    ? In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>I expected it results something like runtime error, but I don't know how it drives to this. Is there any logic to this exception?</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 0, "last_activity_date": 1490146133, "creation_date": 1490146133, "answer_id": 42941155, "question_id": 42941099, "link": "https://stackoverflow.com/questions/42941099/having-trouble-when-try-to-trigger-text-editor-from-ghci/42941155#42941155", "title": "Having trouble when try to trigger text editor from ghci", "body": "<p>You want <code>:edit</code>. All GHCi commands such as <code>:load</code> and <code>:set</code> are prefixed with a colon <code>:</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": true, "score": 0, "last_activity_date": 1490146142, "creation_date": 1490146142, "answer_id": 42941156, "question_id": 42941099, "link": "https://stackoverflow.com/questions/42941099/having-trouble-when-try-to-trigger-text-editor-from-ghci/42941156#42941156", "title": "Having trouble when try to trigger text editor from ghci", "body": "<p>ghci command all begin with <code>:</code>. Try <code>:edit</code> instead.</p>\n\n<ul>\n<li><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-cmd-:edit\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-cmd-:edit</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1490149100, "creation_date": 1490149100, "answer_id": 42941550, "question_id": 42941099, "link": "https://stackoverflow.com/questions/42941099/having-trouble-when-try-to-trigger-text-editor-from-ghci/42941550#42941550", "title": "Having trouble when try to trigger text editor from ghci", "body": "<p>In addition to <code>:edit</code>, you can run arbitrary shell commands with <code>:!</code>, so if your editor were, for example, <code>vim</code>, you might open a file with it using <code>:!vim foo.hs</code>.  </p>\n"}], "owner": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 42941156, "answer_count": 3, "score": 0, "last_activity_date": 1490149100, "creation_date": 1490145687, "last_edit_date": 1490148917, "question_id": 42941099, "link": "https://stackoverflow.com/questions/42941099/having-trouble-when-try-to-trigger-text-editor-from-ghci", "title": "Having trouble when try to trigger text editor from ghci", "body": "<p>I'm new to Haskell. From some video, I see people can trigger text editor from ghci. It says if you don't set up the default text editor, it will hint you to use <code>set editor</code> command. But in my case, when I input</p>\n\n<pre><code>edit\n</code></pre>\n\n<p>It gives me an error saying</p>\n\n<pre><code>error: Variable not in scope: edit\n</code></pre>\n\n<p>How can I solve it? I'm using Haskell stack 8.0.2</p>\n"}, {"tags": ["haskell", "memory", "optimization", "memory-management", "profiling"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1490144896, "post_id": 42940256, "comment_id": 72978624, "body": "Have you tried using <code>evaluate</code> on the result of each <code>hardIO</code>? <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Exception-Base.html#v:evaluate\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/&hellip;</a> Or just using a bang pattern like  <code>!a &lt;- hardIO 100000 1</code>. My initial impression is that computing something in <code>IO</code> doesn&#39;t automatically mean that the result value is actually in WHNF."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1490147859, "post_id": 42940256, "comment_id": 72979425, "body": "Include a minimal but complete example in your question, please. You&#39;ve made some progress in your &quot;simplistic program&quot;, but I think it can probably be cut down even more, and should be included here, not hosted elsewhere. <a href=\"https://stackoverflow.com/help/mcve\">Further details and advice in the official help.</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1490149799, "post_id": 42940256, "comment_id": 72980012, "body": "In your simplistic program, try <code>return $! arrTotal + random</code> instead.  My guess is that <code>arrTotal</code> is a big thunk that isn&#39;t being evaluated.  @dandiaz&#39;s suggestions are also good."}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1490139932, "creation_date": 1490139932, "question_id": 42940256, "link": "https://stackoverflow.com/questions/42940256/memory-allocated-by-an-io-function-is-not-getting-freed-even-after-the-value-has", "title": "Memory allocated by an IO function is not getting freed even after the value has been computed", "body": "<p>Suppose we have to execute a number of complicated IO actions that each occupy a lot of space but return a rather simple value, such as Int or String. In real world that may be, for example, https get requests. I will refer to an action of such kind as <code>hardIO</code> here.</p>\n\n<pre><code>page &lt;- hardIO\n</code></pre>\n\n<p>Naturally, as the program has progressed past this line, we would like to have all the memory <code>hardIO</code> had allocated freed, except for the small bit we keep the actual value in. There is no reason to keep large amounts of data that was only required to execute the action and compute the result.</p>\n\n<p>I noticed that it's not in fact the case. Actually, <code>page</code> keeps occupying a lot of space until after the last reference to it. For example, if I want to print the result of execution of <code>hardIO</code> in the end of the program, no memory will be freed until then. No memory freed at all! In fact, it may even occupy twice as much memory after it was executed than the maximum of what it was occupying in the process of execution.</p>\n\n<pre><code>page &lt;- hardIO\n-- A lot of memory not getting freed!\nprint page\n</code></pre>\n\n<p>As we start to fetch linearly many pages, the space will get wasted linearly excessively. I believe the algorithm should run in constant time, except the linearly growing, but still relatively small list of results.</p>\n\n<hr>\n\n<p>I'm trying to write a program that repeatedly gets certain https API endpoints and around about the hundredth request it finishes eating the RAM, starts swapping and I have to kill the process. (Aside: I guess the copying garbage collector doesn't go well with swapping.) This is very frustrating. You may review the actual code <a href=\"https://github.com/kindaro/stat1\" rel=\"nofollow noreferrer\">here</a> (the commit fe0ebcb should more or less work).</p>\n\n<p>In attempts to solve the issue I have put together a simplistic program that showcases the essence of the problem. If we find a solution for the simplistic case, the general solution will surely follow at once. You may review the simplistic program <a href=\"https://github.com/kindaro/io-mem\" rel=\"nofollow noreferrer\">here</a>. (I included the script that I use to build it and obtain the profiling results.) The memory profiling graph for <code>hardIO</code> cost centre shows us that at the time between the of binding and the release of its return value, a lot of space is being occupied by unlabeled gray stuff. I guess that's what we need to get rid of.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1490127473, "post_id": 42937225, "comment_id": 72971611, "body": "<code>[ z | (x,y) &lt;- zip xs ys, z &lt;- [x,y] ]</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1490127485, "post_id": 42937225, "comment_id": 72971623, "body": "What about <code>concat [[x,y] | (x,y) &lt;- zip xs ys]</code>?"}, {"owner": {"reputation": 3836, "user_id": 4152153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/s6Znl.png?s=128&g=1", "display_name": "dcg", "link": "https://stackoverflow.com/users/4152153/dcg"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1490127619, "post_id": 42937225, "comment_id": 72971708, "body": "@WillemVanOnsem The result should be a flat list."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1490127643, "post_id": 42937225, "comment_id": 72971721, "body": "@dcg: with <code>concat</code> the result <b>is</b> a flat list."}, {"owner": {"reputation": 3836, "user_id": 4152153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/s6Znl.png?s=128&g=1", "display_name": "dcg", "link": "https://stackoverflow.com/users/4152153/dcg"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1490127781, "post_id": 42937225, "comment_id": 72971795, "body": "@Ale That worked. Thanks."}, {"owner": {"reputation": 3836, "user_id": 4152153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/s6Znl.png?s=128&g=1", "display_name": "dcg", "link": "https://stackoverflow.com/users/4152153/dcg"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1490128000, "post_id": 42937225, "comment_id": 72971942, "body": "Sorry @WillemVanOnsem I didn&#39;t see the <code>concat</code>, it works as well."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1490130451, "post_id": 42937446, "comment_id": 72973301, "body": "Are there any uses of <code>-XParallelListComp</code> in the wild? I&#39;ve heard about it before, but I never understood the motivation behind why it was introduced in the first place..."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1490131102, "post_id": 42937446, "comment_id": 72973639, "body": "Sure, just google for <code>site:hackage.haskell.org LANGUAGE ParallelListComp</code>.  Manifolds, kansas lava, many many pages of packages.  As for where it came from? Cryptol had this feature first, I think.  It&#39;s handy therefore it is."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1490131525, "post_id": 42937446, "comment_id": 72973830, "body": "@Alec I don&#39;t think I ever used them, but I still classify them in the &quot;nice to have&quot; bucket, since they are fairly simple to understand. Instead, I find SQL-like comprehensions quite alien."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1490127792, "creation_date": 1490127792, "answer_id": 42937446, "question_id": 42937225, "link": "https://stackoverflow.com/questions/42937225/how-to-put-two-elements-in-a-comprehension-list-in-haskell/42937446#42937446", "title": "How to put two elements in a comprehension list in haskell", "body": "<p>You probably want <code>-XParallelListComp</code> which is a syntactic sugar for zip. Other than that sugar the solution matches what has already been suggested:</p>\n\n<pre><code>{-# LANGUAGE ParallelListComp #-}\n\nxs = [1..3]\nys = [4..6]\nls = concat [ [x,y] | x &lt;- xs | y &lt;- ys ]\n</code></pre>\n\n<p>With a result of:</p>\n\n<pre><code>*Main&gt; ls\n[1,4,2,5,3,6]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1490133846, "post_id": 42937750, "comment_id": 72974970, "body": "<code>foldr (++) []</code> is a strange function to write, since it is equivalent to <code>concat</code> or <code>join</code>."}, {"owner": {"reputation": 245, "user_id": 7747823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EsCOp.jpg?s=128&g=1", "display_name": "Sacha", "link": "https://stackoverflow.com/users/7747823/sacha"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1490204875, "post_id": 42937750, "comment_id": 73012584, "body": "That is right, I kinda forgot that was a built-in function. I&#39;m editing the answer."}], "tags": [], "owner": {"reputation": 245, "user_id": 7747823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EsCOp.jpg?s=128&g=1", "display_name": "Sacha", "link": "https://stackoverflow.com/users/7747823/sacha"}, "is_accepted": false, "score": 1, "last_activity_date": 1490204931, "last_edit_date": 1490204931, "creation_date": 1490128908, "answer_id": 42937750, "question_id": 42937225, "link": "https://stackoverflow.com/questions/42937225/how-to-put-two-elements-in-a-comprehension-list-in-haskell/42937750#42937750", "title": "How to put two elements in a comprehension list in haskell", "body": "<pre><code>func a b = concat (map ( \\(x,y) -&gt; [x,y] ) (zip a b))\n</code></pre>\n\n<p>Do you mean something like this ?</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1490132979, "creation_date": 1490132979, "answer_id": 42938760, "question_id": 42937225, "link": "https://stackoverflow.com/questions/42937225/how-to-put-two-elements-in-a-comprehension-list-in-haskell/42938760#42938760", "title": "How to put two elements in a comprehension list in haskell", "body": "<p>This can also be conveniently done without extensions:</p>\n\n<pre><code>myFunc xs ys = [x | pairs &lt;- transpose [xs, ys], x &lt;- pairs]\n</code></pre>\n\n<p>This doesn't throw away elements as Thomas M. DuBuisson's answer does; e.g. <code>myFunc [] [1]</code> will be <code>[1]</code>, not <code>[]</code>. Whether that's desirable or not depends on your needs, of course.</p>\n\n<p>But even simpler is not to use list comprehensions at all, so that you don't need to name the intermediary <code>pairs</code>.</p>\n\n<pre><code>myFunc xs ys = concat (transpose [xs, ys])\n</code></pre>\n"}], "owner": {"reputation": 3836, "user_id": 4152153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/s6Znl.png?s=128&g=1", "display_name": "dcg", "link": "https://stackoverflow.com/users/4152153/dcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 0, "accepted_answer_id": 42937446, "answer_count": 3, "score": 0, "last_activity_date": 1490204931, "creation_date": 1490127027, "question_id": 42937225, "link": "https://stackoverflow.com/questions/42937225/how-to-put-two-elements-in-a-comprehension-list-in-haskell", "title": "How to put two elements in a comprehension list in haskell", "body": "<p>I've been looking some time now and I couldn't find how to do this. Suppose I have two lists, I want to return a new list that is the same as the result of <code>zip</code> but without the duples, e.g., given <code>[1,2,3]</code> and <code>[4,5,6]</code> the result would be <code>[1,4,2,5,3,6]</code>. I would do it like (suppossing the compiler don't generate an error):</p>\n\n<pre><code> myFunc xs ys = [x,y|(x,y) &lt;- zip xs ys]\n</code></pre>\n\n<p>PS: Have to do it with list comprehension.</p>\n\n<p>Could you give some thoughts about it?</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1490135753, "post_id": 42936984, "comment_id": 72975804, "body": "Better to pattern-match against <code>(_:_:_:_:_)</code> for the error case, so that <code>fromList [1..]</code> returns Nothing instead of diverging."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1490138092, "post_id": 42936984, "comment_id": 72976672, "body": "@amalloy Thanks, I&#39;ve updated with a similar fix that makes the <code>3</code> more obviously configurable."}, {"owner": {"reputation": 440, "user_id": 1606510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa28476ad9d46bbb1f2ac2fd7283f69?s=128&d=identicon&r=PG", "display_name": "Mekeor Melire", "link": "https://stackoverflow.com/users/1606510/mekeor-melire"}, "edited": false, "score": 0, "creation_date": 1490177722, "post_id": 42936984, "comment_id": 72992507, "body": "It&#39;s probably worth mentioning that after all this, <code>osztaly</code> would have this type signature:  <code>osztaly :: [(String, ListUpTo3 String)]</code>"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1490138069, "last_edit_date": 1490138069, "creation_date": 1490126155, "answer_id": 42936984, "question_id": 42936797, "link": "https://stackoverflow.com/questions/42936797/how-to-represent-this-type-in-haskell/42936984#42936984", "title": "How to represent this type in Haskell", "body": "<p>If you just need size 3:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n{-# LANGUAGE DeriveFoldable #-}\n{-# LANGUAGE DeriveTraversable #-}\ndata ListUpTo3 a\n    = Zero\n    | One a\n    | Two a a\n    | Three a a a\n    deriving (Functor, Foldable, Traversable)\n</code></pre>\n\n<p>The <code>Functor</code>, <code>Foldable</code>, and <code>Traversable</code> instances recover many (but not all) of the convenient functions available for the builtin lists.</p>\n\n<p>If you may need other sizes than max-3, you can generalize this, but it takes significantly more type-level programming, which adds significant programmer effort both for the implementer of the type and for the user of the type.</p>\n\n<p>Personally, I probably would not try to capture this constraint at the type level. Then the max-length-3 bit is not compiler checked; but it is also much simpler to implement and use. You can read more about this idea elsewhere on the net under the keywords \"smart constructor\".</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n-- N.B. we do not export the value constructor, only the type constructor\nmodule UpTo3 (ListUpTo3, fromList, toList) where\n\nnewtype ListUpTo3 a = ListUpTo3 [a] deriving (Functor, Foldable, Traversable)\n\nfromList :: [a] -&gt; Maybe (ListUpTo3 a)\nfromList xs = if null (drop 3 xs) then Just (ListUpTo3 xs) else Nothing\n\ntoList :: ListUpTo3 a -&gt; [a]\ntoList (ListUpTo3 xs) = xs\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7747734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9985fa7c40d9b9e811a58731fd20bc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Justy", "link": "https://stackoverflow.com/users/7747734/justy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1490138069, "creation_date": 1490125551, "last_edit_date": 1490125808, "question_id": 42936797, "link": "https://stackoverflow.com/questions/42936797/how-to-represent-this-type-in-haskell", "title": "How to represent this type in Haskell", "body": "<p>How can i represent a list which include 1 String and another list with maximum of 3 Strings.</p>\n\n<p>Like this one:</p>\n\n<pre><code>osztaly = [(\"Andr\u00e1s\", [\"m\u00e1kos\", \"meggyes\", \"alm\u00e1s\"]), (\"Joli\", [\"t\u00far\u00f3s\"]), (\"Anna\", [\"alm\u00e1s\", \"alm\u00e1s\"]), (\"Tam\u00e1s\", []), (\"Mari\", [\"alm\u00e1s\", \"meggyes\"]), (\"Vera\", [])]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 0, "creation_date": 1490124434, "post_id": 42936372, "comment_id": 72969835, "body": "If you use the built-in function, what does <code>let x = reverse x</code> do?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1490124481, "post_id": 42936372, "comment_id": 72969863, "body": "It&#39;s <i>sort of</i> a pecularity with haskell. It has nothing do with your function, the problem is that newly declared names are visible in their own definition, so <code>let x = revert x</code> means that <code>x = revert (revert (revert (revert (revert ...)))))</code> and so on."}, {"owner": {"reputation": 387, "user_id": 4953666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R6w25.jpg?s=128&g=1", "display_name": "Artur Trapp", "link": "https://stackoverflow.com/users/4953666/artur-trapp"}, "reply_to_user": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 0, "creation_date": 1490124514, "post_id": 42936372, "comment_id": 72969882, "body": "@JoshLee, it has the same result"}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 2, "creation_date": 1490124553, "post_id": 42936372, "comment_id": 72969901, "body": "please don&#39;t paste images of text"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1490124555, "post_id": 42936372, "comment_id": 72969904, "body": "also you can try <code>let x = x</code>, canonical case."}, {"owner": {"reputation": 387, "user_id": 4953666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R6w25.jpg?s=128&g=1", "display_name": "Artur Trapp", "link": "https://stackoverflow.com/users/4953666/artur-trapp"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1490124651, "post_id": 42936372, "comment_id": 72969961, "body": "@karakfa I think I understood, thank you"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1490131025, "post_id": 42936372, "comment_id": 72973597, "body": "This is indeed a peculiarity of Haskell. In Haskell, every binding is recursive. Instead, functional languages in the ML family have both <code>let</code> (non recursive) and <code>let rec</code>. In ML, <code>let x=5 in let x=x+1 in 10+x</code> evaluates to <code>10+(5+1)</code> since <code>x=x+1</code> actually means <code>inner_x = outer_x+1</code> rather than a recursive definition. Anyway, it&#39;s not a big deal once you know how each language works."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1490143588, "post_id": 42936372, "comment_id": 72978279, "body": "If you want to shadow the name in <code>do</code> notation or GHCi, you can use <code>x &lt;- pure (revert x)</code>; this desugars to <code>pure (revert x) &gt;&gt;= \\x -&gt; \u2026</code>, so unlike in a <code>let</code> binding, they\u2019re not the same <code>x</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1490149934, "post_id": 42936372, "comment_id": 72980051, "body": "For what it&#39;s worth, your english is excellent."}, {"owner": {"reputation": 387, "user_id": 4953666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R6w25.jpg?s=128&g=1", "display_name": "Artur Trapp", "link": "https://stackoverflow.com/users/4953666/artur-trapp"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1490150093, "post_id": 42936372, "comment_id": 72980099, "body": "@luqui Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 4953666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R6w25.jpg?s=128&g=1", "display_name": "Artur Trapp", "link": "https://stackoverflow.com/users/4953666/artur-trapp"}, "edited": false, "score": 0, "creation_date": 1490124689, "post_id": 42936484, "comment_id": 72969981, "body": "Oh, thank you. I think I could not figure it out before becaus this works on languages like C#. But it all makes sense now, thanks"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 7, "last_activity_date": 1490126655, "last_edit_date": 1490126655, "creation_date": 1490124512, "answer_id": 42936484, "question_id": 42936372, "link": "https://stackoverflow.com/questions/42936372/what-is-wrong-in-this-haskell-function/42936484#42936484", "title": "What is wrong in this Haskell function?", "body": "<p>You're defining</p>\n\n<pre><code>x = revert x\n</code></pre>\n\n<p>So, substituting on the right, this gives</p>\n\n<pre><code>x = revert (revert x)\n</code></pre>\n\n<p>And so on. Another example would be</p>\n\n<pre><code>a = a + 1\n</code></pre>\n\n<p>To find out what <code>a</code> is, we need to evaluate the right hand side of the definition.</p>\n\n<pre><code>a = (a + 1) + 1\na = ((a+1)+1) + 1\n</code></pre>\n\n<p>And so on.</p>\n\n<p>Bootom line: Haskell's <code>=</code> is very different from <code>=</code> in languages like C#, where it means <em>assignment</em>. In Haskell it means <em>is defined as</em> and this means we can substitute any occurance of an identifier with its definition without changing the meaning of the program. This is called <em>referential transpareny</em>.</p>\n"}], "owner": {"reputation": 387, "user_id": 4953666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R6w25.jpg?s=128&g=1", "display_name": "Artur Trapp", "link": "https://stackoverflow.com/users/4953666/artur-trapp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 42936484, "answer_count": 1, "score": 2, "last_activity_date": 1490126655, "creation_date": 1490124190, "question_id": 42936372, "link": "https://stackoverflow.com/questions/42936372/what-is-wrong-in-this-haskell-function", "title": "What is wrong in this Haskell function?", "body": "<p>I decided to dive in functional programming world recently, and a friend told me about Haskell. I started my own researches on the language particularity and soon I got the main concepts. Then, I started working with lists and decided to rewrite some existent functions, just to practice.</p>\n\n<p>I made my version of the <code>reverse</code> function, and called it <code>revert</code>. The function is defined as below:</p>\n\n<pre><code>revert :: [a] -&gt; [a]\nrevert [] = []\nrevert a = revert (tail a) ++ [head a]\n</code></pre>\n\n<p>It works perfectly for me, as you can see in the image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2mCN1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2mCN1.png\" alt=\"works\"></a></p>\n\n<p>But then, I decided to make another test, receiving the result of the <code>revert</code> function on the same variable that I passed as a parameter, as you can see below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oBRrQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oBRrQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>It seems to execute the function normally, but when I check the value of <code>x</code>, it looks like it goes into a loop, and I need to interrupt the operation.</p>\n\n<p>If I set the value on another variable, it works perfectly:</p>\n\n<pre><code>let y = revert x\n</code></pre>\n\n<p>Why does it happen? Is it some concept of functional programming that I am missing? Or some peculiarity with Haskell? I did some googling but was not able to get to an answer</p>\n\n<p>PS: Sorry for the bad english</p>\n"}, {"tags": ["haskell", "typeclass", "deriving", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 6, "creation_date": 1490121937, "post_id": 42935549, "comment_id": 72968310, "body": "The error message tells you the problem. You need an instance of <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Functor-Classes.html#t:Show1\" rel=\"nofollow noreferrer\"><code>Show1</code></a> for <code>T1F</code>. Writing instances of <code>Show1</code> by hand can be quite tedious. Fortunately the <a href=\"https://hackage.haskell.org/package/deriving-compat\" rel=\"nofollow noreferrer\"><code>deriving-compat</code></a> package <a href=\"https://hackage.haskell.org/package/deriving-compat-0.3.5/docs/Text-Show-Deriving.html#v:deriveShow1\" rel=\"nofollow noreferrer\">has got your back</a>."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1527327885, "post_id": 42935549, "comment_id": 88094028, "body": "@BenjaminHodgson is there an example of deriving it manually?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1527371344, "post_id": 42935549, "comment_id": 88105238, "body": "@CMCDragonkai Easiest way is to derive <code>Show</code> for your datatype, look at the generated code by compiling with <code>-ddump-deriv</code>, and then paste and adapt it. Not a fun task, though - much easier to use the TH helpers in the pkg!"}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1527382919, "post_id": 42935549, "comment_id": 88107175, "body": "I see. I still don&#39;t understand why this is needed."}], "answers": [{"tags": [], "owner": {"reputation": 4398, "user_id": 1056174, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GJiNL.jpg?s=128&g=1", "display_name": "Carl Patenaude Poulin", "link": "https://stackoverflow.com/users/1056174/carl-patenaude-poulin"}, "is_accepted": true, "score": 3, "last_activity_date": 1490125802, "creation_date": 1490125802, "answer_id": 42936879, "question_id": 42935549, "link": "https://stackoverflow.com/questions/42935549/haskell-deriving-show-for-fix-types/42936879#42936879", "title": "Haskell: deriving Show for Fix types", "body": "<p>Using the package <code>deriving-compat</code>:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Data.Functor.Foldable\nimport Text.Show.Deriving\n\ndata T1F a = Foo deriving Show\n$(deriveShow1 ''T1F)\ntype T1 = Fix T1F\ndata T2 = Bar T1 deriving Show\n</code></pre>\n"}], "owner": {"reputation": 4398, "user_id": 1056174, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GJiNL.jpg?s=128&g=1", "display_name": "Carl Patenaude Poulin", "link": "https://stackoverflow.com/users/1056174/carl-patenaude-poulin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 1, "accepted_answer_id": 42936879, "answer_count": 1, "score": 5, "last_activity_date": 1562457352, "creation_date": 1490121405, "last_edit_date": 1562457352, "question_id": 42935549, "link": "https://stackoverflow.com/questions/42935549/haskell-deriving-show-for-fix-types", "title": "Haskell: deriving Show for Fix types", "body": "<p>I'm trying to implement a recursive datatype using <code>recursion-schemes</code>. I would like to be able to print it.</p>\n\n<pre><code>import Data.Functor.Foldable\n\ndata T1F a = Foo deriving Show\ntype T1 = Fix T1F\ndata T2 = Bar T1 deriving Show -- error here\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>No instance for (Data.Functor.Classes.Show1 T1F)\n  arising from the first field of \u2018Bar\u2019 (type \u2018T1\u2019)\nPossible fix:\n  use a standalone 'deriving instance' declaration,\n    so you can specify the instance context yourself\nWhen deriving the instance for (Show T2)\n</code></pre>\n\n<p>How do I make <code>T1</code> derive <code>Show</code>?</p>\n"}, {"tags": ["haskell", "nix", "nixos"], "comments": [{"owner": {"reputation": 2585, "user_id": 1190453, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8bc78ac3f1246f30c55f3339c3e7586f?s=128&d=identicon&r=PG", "display_name": "danbst", "link": "https://stackoverflow.com/users/1190453/danbst"}, "edited": false, "score": 0, "creation_date": 1494588004, "post_id": 42931607, "comment_id": 74904935, "body": "There&#39;s lots of complexity here and some implicit Nix expressions. Can you simplify an example, so it is self-contained?"}], "owner": {"reputation": 113, "user_id": 5508993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceec3f3d7c4c9d8f8f6b3385c6b20e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rizary", "link": "https://stackoverflow.com/users/5508993/rizary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1490138754, "creation_date": 1490110525, "last_edit_date": 1490138754, "question_id": 42931607, "link": "https://stackoverflow.com/questions/42931607/overridepackages-of-local-nixpkgs-config-to-add-new-packages", "title": "overridePackages of local nixpkgs&#39; config to add new packages", "body": "<p>i'm looking for enlightenment on how to do the best way on my situation as follows:</p>\n\n<ol>\n<li><p>I have a nixpkgs folder on my project, which I download from other repo. It located on my <code>theproject/front-plat/default.nix</code> then the code is look like this.</p>\n\n<p><code>{ nixpkgsFunc ? import ./nixpkgs }: let nixpkgs = nixpkgsFunc ({ config = { ... }; lib = {...}; etc.</code></p></li>\n<li><p>In my <code>theproject/release.nix</code> I want to add a new packages which will be used for my built using the nixpkgs' front-plat. So the code looks like this.</p>\n\n<p><code>{ front-plat ? import ./deps/front-plat {}}:\nlet\n  nixpkgs = front-platform.nixpkgs;\n  packageCompiler = front-plat.compiler;\n  config = rec { ... \n    packageOverrides = pkgs: rec {\n      packageCompiler = pkgs.packageCompiler.override {\n        overrides = self: super: rec {\n          fronFrint = self.callPackage (import ./frontFrint { inherit front-plat; });\n      };\n    };\n  };</code></p></li>\n</ol>\n\n<p>3    Which I assume, now i'm using the nixpkgs from the front-plat but i'm still not sure does my nixpkgs' packageCompiler already contains fronFrint package or not.</p>\n\n<p>The question is, how can I add my new packages called \"frontFrint\" to the nixpkgs's packageCompiler. so that the packageCompiler can built fronFrint. for example in the end, the code will be \n <code>in { front = pkgs.packageCompiler.frontFrint; }</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1490108308, "post_id": 42929785, "comment_id": 72958819, "body": "Try Friday, a young but fun image processing library."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1490112341, "post_id": 42929785, "comment_id": 72962088, "body": "This question really shows minimal effort. I went to the <a href=\"http://hackage.haskell.org/package/JuicyPixels\" rel=\"nofollow noreferrer\">Hackage page for JuicyPixels</a> and clicked the first thing that seemed relevant a few times (first the top-level module name, <code>Codec.Picture</code>, then the link that said &quot;pixels&quot; in the navigation menu at the top right) and had the answer."}, {"owner": {"reputation": 75, "user_id": 3030823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/08c73dd341e57aa242d9f288500b3e27?s=128&d=identicon&r=PG&f=1", "display_name": "user3030823", "link": "https://stackoverflow.com/users/3030823/user3030823"}, "edited": false, "score": 0, "creation_date": 1490178908, "post_id": 42929785, "comment_id": 72993361, "body": "Hi Daniel. I am very new to haskel and sometimes got confuse with the definition. I have browse through the library and did not understand what its say. that is why i am here."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 3030823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/08c73dd341e57aa242d9f288500b3e27?s=128&d=identicon&r=PG&f=1", "display_name": "user3030823", "link": "https://stackoverflow.com/users/3030823/user3030823"}, "edited": false, "score": 0, "creation_date": 1490178966, "post_id": 42930627, "comment_id": 72993404, "body": "Thanks Erik! It just i did not understand the definition. Haskell newbie!"}], "tags": [], "owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "is_accepted": false, "score": 1, "last_activity_date": 1490108128, "creation_date": 1490108128, "answer_id": 42930627, "question_id": 42929785, "link": "https://stackoverflow.com/questions/42929785/reading-pixel-from-images-using-haskell/42930627#42930627", "title": "Reading pixel from images using Haskell", "body": "<p>JuicyPixel provides the <a href=\"https://hackage.haskell.org/package/JuicyPixels-3.2.8.1/docs/Codec-Picture.html#v:pixelAt\" rel=\"nofollow noreferrer\"><code>pixelAt</code></a> function to get a pixel at a given coordinate.</p>\n\n<pre><code>pixelAt :: Image a -&gt; Int -&gt; Int -&gt; a\n</code></pre>\n\n<blockquote>\n  <p>Extract a pixel at a given position, (x, y), the origin is assumed to be at the corner top left, positive y to the bottom of the image</p>\n</blockquote>\n"}], "owner": {"reputation": 75, "user_id": 3030823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/08c73dd341e57aa242d9f288500b3e27?s=128&d=identicon&r=PG&f=1", "display_name": "user3030823", "link": "https://stackoverflow.com/users/3030823/user3030823"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1490108128, "creation_date": 1490106120, "question_id": 42929785, "link": "https://stackoverflow.com/questions/42929785/reading-pixel-from-images-using-haskell", "title": "Reading pixel from images using Haskell", "body": "<p>Does anyone know how to read a pixel from images using Haskell? I am now using a juicy pixel as a library.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["function", "haskell", "generics", "lambda", "types"], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": false, "score": 2, "last_activity_date": 1490103552, "creation_date": 1490103552, "answer_id": 42928829, "question_id": 42928535, "link": "https://stackoverflow.com/questions/42928535/haskell-and-general-types/42928829#42928829", "title": "Haskell and General Types", "body": "<p>Using the GHC compiler, you can ask about type by using type holes, <code>_</code></p>\n\n<p>for instance:</p>\n\n<pre><code>thing :: _\nthing = (\\x -&gt; (&lt;))\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>Found hole \u2018_\u2019 with type: t -&gt; a0 -&gt; a0 -&gt; Bool\nWhere: \u2018t\u2019 is a rigid type variable bound by\n           the inferred type of thing :: t -&gt; a0 -&gt; a0 -&gt; Bool\n           at src/Expat/Data/E.hs:555:1\n       \u2018a0\u2019 is an ambiguous type variable\nTo use the inferred type, enable PartialTypeSignatures\nIn the type signature for \u2018thing\u2019: _\n</code></pre>\n\n<p>I sometimes use this with where clauses to isolate expressions in larger functions, e.g.</p>\n\n<pre><code>myFun :: a -&gt; b\nmyFun a = otherFun thing\n  where \n    thing :: _\n    thing = (\\x -&gt; (&lt;))\n</code></pre>\n\n<p>You can also use holes in place of terms. For instance, if I'm not sure exactly what otherFun should be, I could just substitute in <code>_</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 403, "user_id": 5752719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/jus9h.jpg?s=128&g=1", "display_name": "DevX10", "link": "https://stackoverflow.com/users/5752719/devx10"}, "edited": false, "score": 0, "creation_date": 1490103863, "post_id": 42928836, "comment_id": 72955182, "body": "Very interesting approach, how would you do it with <code>(\\x -&gt; x (&lt;))</code>?"}, {"owner": {"reputation": 403, "user_id": 5752719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/jus9h.jpg?s=128&g=1", "display_name": "DevX10", "link": "https://stackoverflow.com/users/5752719/devx10"}, "edited": false, "score": 0, "creation_date": 1490104523, "post_id": 42928836, "comment_id": 72955707, "body": "Thanks, I&#39;m starting to understand. Could you show me how you would do it with <code>(.).(.)</code>, since in this case we don&#39;t have any lambda expression.."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1490123980, "last_edit_date": 1490123980, "creation_date": 1490103564, "answer_id": 42928836, "question_id": 42928535, "link": "https://stackoverflow.com/questions/42928535/haskell-and-general-types/42928836#42928836", "title": "Haskell and General Types", "body": "<p>You can easily check the type of an expression with <code>:t</code> in <code>ghci</code>:</p>\n\n<pre><code>Prelude&gt; :t (\\x y z -&gt; x (y z))\n(\\x y z -&gt; x (y z)) :: (r1 -&gt; r) -&gt; (r2 -&gt; r1) -&gt; r2 -&gt; r\nPrelude&gt; :t (\\x -&gt; x (&lt;))\n(\\x -&gt; x (&lt;)) :: Ord a =&gt; ((a -&gt; a -&gt; Bool) -&gt; r) -&gt; r\nPrelude&gt; :t (.) . (.)\n(.) . (.) :: (b -&gt; c) -&gt; (a -&gt; a1 -&gt; b) -&gt; a -&gt; a1 -&gt; c\n</code></pre>\n\n<p>But I assume you want to derive the types yourself.</p>\n\n<ol>\n<li><p>For the first we can start with looking to the variables. Those are <code>x</code>, <code>y</code> and <code>z</code>. We first assign \"generic types\" to them, so:</p>\n\n<pre><code>x :: a\ny :: b\nz :: c\n</code></pre>\n\n<p>Now we look to the right hand of the expression and see <code>(y z)</code>. This means that we \"call\" <code>y</code> with <code>z</code> as argument. As a result we \"specialize\" the type of <code>y</code> to <code>y :: c -&gt; d</code>. The type of <code>(y z)</code> then is <code>(y z) :: d</code>. Now we see that <code>x (y z)</code>. So again we \"specialize\" the type of <code>x</code> into <code>x :: d -&gt; e</code>. As a result we obtain:</p>\n\n<pre><code>x :: d -&gt; e\ny :: c -&gt; d\nz :: c\n</code></pre>\n\n<p>Finally the lambda-expression maps <code>\\x y z -&gt; x (y z)</code>. So that means we look to the resulting type is something in \"pseudo code\": <code>type(x) -&gt; type(y) -&gt; type(z) -&gt; type('x (y z)')</code>. Or:</p>\n\n<pre><code>\\x y z -&gt; x (y z) :: (d -&gt; e) -&gt; (c -&gt; d) -&gt; c -&gt; e\n</code></pre></li>\n<li><p>For the second expression we first have to derive the type of <code>(&lt;)</code>:</p>\n\n<pre><code>Prelude&gt; :t (&lt;)\n(&lt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>This is because <code>(&lt;)</code> is somewhere defined in the <code>Prelude</code> with that type.</p>\n\n<p>Now we know that, we can look at the type signature. We will first assume a type for <code>x :: b</code>. Now we look to the right side, and see that we call <code>x (&lt;)</code>. So that means we know <code>x</code> has the type <code>Ord a =&gt; (a -&gt; a -&gt; Bool) -&gt; c</code> and we know that <code>x (&lt;) :: c</code>. Then again we have a lambda-expression, and as we have seen above, we can resolve it like:</p>\n\n<pre><code>(\\x -&gt; x (&lt;)) :: Ord a =&gt; ((a -&gt; a -&gt; Bool) -&gt; c) -&gt; c\n</code></pre></li>\n<li><p>Finally for the third expression, let is first rewrite it to:</p>\n\n<pre><code>(.) (.) (.)\n</code></pre>\n\n<p>Here the <em>first</em> <code>(.)</code> function, was originally the <code>.</code> (without brackets), but we will first remove the operator syntactical sugar.</p>\n\n<p>Next we will give the operators a name (only to make it more convenient for us to name them). This is <em>not</em> allowed in Haskell, but we will ignore that for now. The reason we do this is to later refer to the type of a specific <code>(.)</code> function:</p>\n\n<pre><code>(.<i>1</i>) (.<i>2</i>) (.<i>3</i>)</code></pre>\n\n<p>Next we lookup the type for <code>(.)</code>:</p>\n\n<pre><code>Prelude&gt; :t (.)\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>So we first assign some types:</p>\n\n<pre><code>(.1) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n(.2) :: (e -&gt; f) -&gt; (d -&gt; e) -&gt; d -&gt; f\n(.3) :: (h -&gt; i) -&gt; (g -&gt; h) -&gt; g -&gt; i\n</code></pre>\n\n<p>Now we need to analyze these types further. We call <code>(.1)</code> with <code>(.2)</code> as argument so we know that <code>(b -&gt; c)</code> (the first argument of <code>(.1)</code> is equivalent to <code>(e -&gt; f) -&gt; (d -&gt; e) -&gt; d -&gt; f</code>. So that means that:</p>\n\n<pre><code>(b -&gt; c) ~ (e -&gt; f) -&gt; (d -&gt; e) -&gt; d -&gt; f\n</code></pre>\n\n<p>Since the type arrows are <em>right associative</em>, <code>(e -&gt; f) -&gt; (d -&gt; e) -&gt; d -&gt; f</code> actually means <code>(e -&gt; f) -&gt; ((d -&gt; e) -&gt; (d -&gt; f))</code>. So now we can make an analysis:</p>\n\n<pre><code>  b        -&gt; c\n~ (e -&gt; f) -&gt; ((d -&gt; e) -&gt; (d -&gt; f))\n</code></pre>\n\n<p>So that means <code>b ~ (e -&gt; f)</code> and <code>c ~ ((d -&gt; e) -&gt; (d -&gt; f))</code>. So we \"specialize\" our first <code>(.1) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> into</p>\n\n<pre><code>(.1) :: ((e -&gt; f) -&gt; ((d -&gt; e) -&gt; (d -&gt; f))) -&gt; (a -&gt; (e -&gt; f)) -&gt; a -&gt; ((d -&gt; e) -&gt; (d -&gt; f))\n</code></pre>\n\n<p>Now the type of <code>(.1) (.2)</code> is</p>\n\n<pre><code>(.1) (.2) :: (a -&gt; (e -&gt; f)) -&gt; a -&gt; ((d -&gt; e) -&gt; (d -&gt; f))\n</code></pre>\n\n<p>But now we call that function with <code>(.3)</code> so we have to derive the type for <code>((.1) (.2)) (.3)</code>. Therefore again we have to do type resolution with:</p>\n\n<pre><code>  a        -&gt; (e        -&gt; f)\n~ (h -&gt; i) -&gt; ((g -&gt; h) -&gt; (g -&gt; i))\n</code></pre>\n\n<p>So that means <code>a ~ (h -&gt; i)</code>, <code>e ~ (g -&gt; h)</code> and <code>f ~ (g -&gt; i)</code>. So now we have resolved the type to:</p>\n\n<pre><code>((.1) (.2)) (.3) :: a -&gt; c\n=                   (h -&gt; i) -&gt; ((d -&gt; (g -&gt; h)) -&gt; (d -&gt; (g -&gt; i)))\n=                   (h -&gt; i) -&gt; (d -&gt; g -&gt; h) -&gt; d -&gt; g -&gt; i\n</code></pre>\n\n<p>The last line is only a syntactical simplification. As you can see, this maps on the type we derived from <code>ghci</code>.</p></li>\n</ol>\n\n<p>As you can see for all three queries we obtain the same type (of course the name of the type variables is different).</p>\n"}], "owner": {"reputation": 403, "user_id": 5752719, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/jus9h.jpg?s=128&g=1", "display_name": "DevX10", "link": "https://stackoverflow.com/users/5752719/devx10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 2, "accepted_answer_id": 42928836, "answer_count": 2, "score": 2, "last_activity_date": 1490123980, "creation_date": 1490102802, "last_edit_date": 1490114066, "question_id": 42928535, "link": "https://stackoverflow.com/questions/42928535/haskell-and-general-types", "title": "Haskell and General Types", "body": "<p>I'm kind of new to <em>Haskell</em>, and I would like to understand how general types works.</p>\n\n<p>What should be a \"systematic\" way of thinking to get the type of an expression?</p>\n\n<p>To make an example, if we have: </p>\n\n<pre><code>(\\x y z -&gt; x (y z))\n</code></pre>\n\n<p>The way I would think about this, would just be to use intuition, but it doesn't work always.</p>\n\n<p>In this case I would say:</p>\n\n<pre><code>   (y z) :: (t -&gt; t1) --function y takes t and return t1\n x (y z) :: (t1 -&gt; t2) --function x takes argument of type (return type of y)\n\n(\\x y z -&gt; x (y z)) :: (t1 -&gt; t2) -&gt; (t -&gt; t1) -&gt; t -&gt; t2 --return type is t2 (of x) with argument of type t for function y\n</code></pre>\n\n<p>I'm pretty sure this should be right, but sometimes it's harder and this way go thinking doesn't seems to work.</p>\n\n<p>For example if we have:</p>\n\n<pre><code>1.  (\\x -&gt; x (&lt;))  or\n2.  (.) . (.)\n</code></pre>\n\n<p>In this cases I would have no idea how to find the types, for the first I would guess that (&lt;) is a function on two elements that returns a <code>Bool</code> but I have troubles writing the hole expression.</p>\n\n<p>So the question is, what is the best way work with this kind of exercises? </p>\n\n<hr>\n\n<p>ADDED: I know how to check the types with <code>ghci</code>, the question was how to actually find them without it (to understand how Haskell works).</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 5, "last_activity_date": 1490095513, "creation_date": 1490095513, "answer_id": 42925737, "question_id": 42925365, "link": "https://stackoverflow.com/questions/42925365/recursive-liftio/42925737#42925737", "title": "Recursive liftIO", "body": "<p>Simple equational reasoning and rewriting definitions for some specialization can help you. Base case for <code>MonadIO</code> is <code>IO</code>. <code>MaybeT</code> is monad transformer, so lets combine <code>MaybeT</code> and <code>IO</code> in some simple example.</p>\n\n<pre><code>foo :: MaybeT IO String\nfoo = liftIO getLine\n</code></pre>\n\n<p>Now let's rewrite this function definition applying instance implementations from your question step by step.</p>\n\n<pre><code>foo\n= liftIO {- for MaybeT -} getLine\n= lift (liftIO {- for IO here -} getLine)  -- step 2\n= lift (id getLine)\n= lift getLine\n= MaybeT (liftM Just getLine)\n</code></pre>\n\n<ol>\n<li><code>getLine</code> has type <code>IO String</code></li>\n<li><code>liftM Just getLine</code> has type <code>IO (Maybe String)</code></li>\n<li><code>MaybeT m a</code> constructor needs value of type <code>m (Maybe a)</code> where <code>m = IO</code> and <code>a = String</code> in our case.</li>\n</ol>\n\n<p>Probably hardest step to analyze is step 2. But in reality it's very easy if you remind yourself types of <code>liftIO :: IO a -&gt; m a</code> and <code>lift :: Monad m =&gt; m a -&gt; t m a</code>. So all work is done by type inference.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1490105428, "creation_date": 1490105428, "answer_id": 42929533, "question_id": 42925365, "link": "https://stackoverflow.com/questions/42925365/recursive-liftio/42929533#42929533", "title": "Recursive liftIO", "body": "<p>Perhaps surprisingly, the definition below is <em>not</em> recursive, even if it looks such.</p>\n\n<pre><code>instance (MonadIO m) =&gt; MonadIO (MaybeT m) where\n    liftIO = lift . liftIO\n</code></pre>\n\n<p>This is because the <code>liftIO</code> on the left hand side is the <code>liftIO</code> for the <code>MaybeT m</code> monad, while the <code>liftIO</code> on the right hand side is the <code>liftIO</code> for the <code>m</code> monad.</p>\n\n<p>Hence, this simply defines <code>liftIO</code> in one monad in terms of the <code>liftIO</code> for another monad. No recursion here.</p>\n\n<p>This is similar to e.g.</p>\n\n<pre><code>instance (Show a, Show b) =&gt; Show (a,b) where\n   show (x,y) = \"(\" ++ show x ++ \", \" ++ show y ++ \")\"\n</code></pre>\n\n<p>Above, we define how to print a pair depending on how to print their components. It looks recursive, but it is not really such.</p>\n\n<p>It could help visualizing this by inserting explicit type arguments, at least mentally:</p>\n\n<pre><code>-- pseudo-code\ninstance (Show a, Show b) =&gt; Show (a,b) where\n   show @(a,b) (x,y) = \n      \"(\" ++ show @a x ++ \", \" ++ show @b y ++ \")\"\n</code></pre>\n\n<p>Now <code>show @(a,b)</code>, <code>show @a</code>, and <code>show @b</code> are distinct functions.</p>\n"}], "owner": {"reputation": 249, "user_id": 4643591, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206103105435558/picture?type=large", "display_name": "Marius Catalin", "link": "https://stackoverflow.com/users/4643591/marius-catalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1490309443, "creation_date": 1490094525, "last_edit_date": 1490309443, "question_id": 42925365, "link": "https://stackoverflow.com/questions/42925365/recursive-liftio", "title": "Recursive liftIO", "body": "<p>I've looked at the some instances of MonadTrans, for MaybeT the implementation looks like this:</p>\n\n<pre><code>instance MonadTrans MaybeT where\n    lift = MaybeT . liftM Just\n</code></pre>\n\n<p>As I understand the instance for MonadIO is used to do a variable number of lifts from the inner most, a IO monad, directly to the outermost. For the MaybeT case it looks like this: </p>\n\n<pre><code>instance (MonadIO m) =&gt; MonadIO (MaybeT m) where\n    liftIO = lift . liftIO\n</code></pre>\n\n<p>What I don't understand is how this recursive function escapes the infinite loop. What is the base case?</p>\n"}, {"tags": ["list", "haskell", "dictionary"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1490093112, "post_id": 42924800, "comment_id": 72946959, "body": "Could you please format your post correctly? What should <code>adders</code> do? What do you expect <code>adder</code> to do? And why don&#39;t you use <code>adders y x = y ++ x</code>?"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1490093151, "post_id": 42924800, "comment_id": 72946996, "body": "<code>[&quot;1&quot;,&quot;2&quot;] [&quot;3&quot;,&quot;4&quot;] = [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;]</code> would have the type <code>[String] -&gt; [String] -&gt; [String]</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5006554"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1490093439, "post_id": 42924800, "comment_id": 72947229, "body": "@Zeta that final point is what I was trying to achieve, sorry I didn&#39;t realize I could do that."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1490094705, "post_id": 42924800, "comment_id": 72948200, "body": "...why, if you use the standard operator <code>++</code> anyway, do you even define <code>adders</code> at all? Whereever you use <code>adders</code>, you could simply call <code>++</code> directly. Or, you could define <code>adders = (++)</code>. \u2014 Do you perhaps mean to ask how to define this <i>without</i> a library operator, only in terms of the plain list constructor (<code>:</code>)?"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1490097651, "creation_date": 1490097651, "answer_id": 42926551, "question_id": 42924800, "link": "https://stackoverflow.com/questions/42924800/adding-two-lists-together-with-map/42926551#42926551", "title": "Adding two lists together with map", "body": "<blockquote>\n  <p>I thought it was best to use the haskell map function</p>\n</blockquote>\n\n<p>No. <code>map f</code> applies <code>f</code> to every element of your list. But you don't want to change the elements at all, you want to change the list itself. That, however, is out of scope of the things that are possible with <code>map</code>. <code>map</code> cannot add more elements, neither can it remove some.</p>\n\n<p>If you want to concatenate two lists, simply use <code>++</code>:</p>\n\n<pre><code>adders :: [a] -&gt; [a] -&gt; [a]\nadders x y = x ++ y\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5006554"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 42926551, "answer_count": 1, "score": 0, "last_activity_date": 1490177483, "creation_date": 1490092960, "last_edit_date": 1490093316, "question_id": 42924800, "link": "https://stackoverflow.com/questions/42924800/adding-two-lists-together-with-map", "title": "Adding two lists together with map", "body": "<p>So I'm trying to write some minimal code to put two lists of strings together, and to do this I thought it was best to use the haskell map function. </p>\n\n<p>Essentially I want to be able to do adders [\"1\",\"2\"] [\"3\",\"4\"] = [\"1\",\"2\",\"3\",\"4\"]</p>\n\n<p>So I have a function called adder, which takes a list, then adds a string to that list and returns the new list. Then I have a function called adders which replicates the adder function, but adds a list of strings instead of just one string, however at the moment it produces multiple lists instead of one list.  </p>\n\n<p>I thought </p>\n\n<pre><code>adder :: [String] -&gt; String -&gt; [String]\nadder y x = y ++ [x]\n\nadders y x = map (adder y) x \n</code></pre>\n\n<p>would work, but this just gives a list of two lists\n[[\"1\",\"2\",\"3\"],[[\"1\",\"2\",\"4\"]] </p>\n\n<p>How is the best way to go about this? </p>\n"}, {"tags": ["haskell", "ghci", "haskell-stack"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1490095062, "post_id": 42922217, "comment_id": 72948457, "body": "I think the <code>--flag</code> option for <code>stack ghci</code> had been accidentally removed. It&#39;s back in v1.4.0 so you probably just need to upgrade. If that doesn&#39;t work, please provide the error message you see."}, {"owner": {"reputation": 71, "user_id": 3679331, "user_type": "registered", "profile_image": "https://graph.facebook.com/521210191/picture?type=large", "display_name": "ricardos", "link": "https://stackoverflow.com/users/3679331/ricardos"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1490109408, "post_id": 42922217, "comment_id": 72959646, "body": "Yes, it works, I had 1.3.x"}], "owner": {"reputation": 71, "user_id": 3679331, "user_type": "registered", "profile_image": "https://graph.facebook.com/521210191/picture?type=large", "display_name": "ricardos", "link": "https://stackoverflow.com/users/3679331/ricardos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490099329, "creation_date": 1490086270, "last_edit_date": 1490099329, "question_id": 42922217, "link": "https://stackoverflow.com/questions/42922217/haskell-stack-ghci-flags", "title": "Haskell Stack ghci flags", "body": "<p>Basically, I am trying to achieve the following:\n<code>\nstack ghci --flag proj:dev\n</code>\nbut it seems that flag is not valid for ghci, only for <code>build</code>.</p>\n\n<p><strong>How can I achieve this?</strong>  If possible </p>\n\n<p>*Notes:<br>\n<code>proj</code> is a cloned yesod-postgres template, I do not want to use yesod devel since I find it painfully slow. And I already have ghci to watch changes and notify browser-sync.</p>\n"}, {"tags": ["haskell", "type-level-computation"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1490082247, "post_id": 42920316, "comment_id": 72939829, "body": "(1) &quot;i can type right hand expression in ghci and it works fine&quot; -- what does GHCi say if you ask it the type of the right hand expression? (2) A guess: don&#39;t you need to put the <code>(Applicative (Vector (n-1)), n &gt; 0 )</code> constraints in the signature of <code>(&lt;+&gt;)</code> as well?"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1490087387, "post_id": 42920316, "comment_id": 72942702, "body": "I should be more specific next time, because that expression worked with specified values, not as function definition. However your about Applicative constraint suggestion worked. Could you elaborate as to why i need to specify that (Vector n) is instance of Applicative, as all vector lengths should be instantiated as applicatives? The (n &gt; 0) constraint isn&#39;t needed."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1490117945, "last_edit_date": 1592644375, "creation_date": 1490098006, "answer_id": 42926685, "question_id": 42920316, "link": "https://stackoverflow.com/questions/42920316/reduction-stack-overflow-with-static-size-list/42926685#42926685", "title": "Reduction stack overflow with static size list", "body": "<blockquote>\n<blockquote>\n<p>A guess: don't you need to put the [constraints] in the signature of <code>(&lt;+&gt;)</code> as well?</p>\n</blockquote>\n<p>[Your] <code>Applicative</code> constraint suggestion worked. Could you elaborate as to why i need to specify that <code>(Vector n)</code> is instance of Applicative, as all vector lengths should be instantiated as applicatives?</p>\n</blockquote>\n<p>In a nutshell, GHC has no means of reaching that conclusion inductively. Rather, what the type checker does on being told you need <code>Applicative (Vector n)</code> is stepping back and looking at <code>Applicative (Vector (n - 1))</code>, in order to see whether <code>(Applicative (Vector (n - 1)), n &gt; 0) =&gt; Applicative n</code> is satisfied. Since you aren't working with a concrete <code>n</code>, that never terminates (that is the difference from your test with specific values). That being so, you need to provide extra information. By the way, you will get the same &quot;Reduction stack overflow&quot; error if you try something more prosaic, such as:</p>\n<pre><code>GHCi&gt; :t undefined == (undefined :: [[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[a]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]])\n</code></pre>\n<p>Since <code>Eq [a]</code> requires <code>Eq a</code>, if <code>a ~ [b]</code> then <code>Eq b</code> also has to be checked, and so forth.</p>\n<p>On another note, as far as I'm aware of it is more usual to write this sort of constraint in terms of <code>KnownNat</code> rather than e.g. <code>Applicative</code>, in order to minimise the amount of constraints you have to propagate in the signatures of your functions. Cf. for instance <a href=\"http://hackage.haskell.org/package/clash-prelude-0.11/docs/src/CLaSH-Sized-Vector.html\" rel=\"nofollow noreferrer\">the source of <code>CLaSH.Sized.Vector</code></a> (someone more well versed in this sort of type-level programming than me might be able to give more specific advice).</p>\n"}], "owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 42926685, "answer_count": 1, "score": 2, "last_activity_date": 1490117945, "creation_date": 1490079553, "question_id": 42920316, "link": "https://stackoverflow.com/questions/42920316/reduction-stack-overflow-with-static-size-list", "title": "Reduction stack overflow with static size list", "body": "<p>I have following code implementing static sized vectors implemented as lists which compiles fine:</p>\n\n<pre><code>{-# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE IncoherentInstances #-}\n\nimport GHC.TypeLits\n\ninfixr 5 :.\ndata Vector :: Nat -&gt; * -&gt; * where\n  (:-:):: Vector 0 a\n  (:.) :: a -&gt; Vector (n-1) a -&gt; Vector n a\n\nderiving instance Show a =&gt; Show (Vector n a)\n\ninstance Functor (Vector n) where\n  fmap f (:-:) = (:-:)\n  fmap f (x :. xs) = f x :. fmap f xs\n\ntype x &gt; y = CmpNat x y ~ 'GT\n\ninstance Applicative (Vector 0) where\n  pure f    = (:-:)\n  (&lt;*&gt;) _ _ = (:-:)\n\ninstance (Applicative (Vector (n-1)), n &gt; 0 ) =&gt; Applicative (Vector n) where\n  pure (f::a)          = f :. (pure f :: Vector (n-1) a)\n  (f:.fs) &lt;*&gt; (x:.xs) = f x :. (fs &lt;*&gt; xs)\n</code></pre>\n\n<p>However when i try to define elementwise sum for these vectors like this:</p>\n\n<pre><code>(&lt;+&gt;) :: Num a =&gt; Vector n a -&gt; Vector n a -&gt; Vector n a\nv1 &lt;+&gt; v2 = (+) &lt;$&gt; v1 &lt;*&gt; v2\n</code></pre>\n\n<p>I get compilation error </p>\n\n<pre><code>Reduction stack overflow; size = 201\nWhen simplifying the following type: Applicative (Vector s0)\n(...)\nIn the expression: (+) &lt;$&gt; v1 &lt;*&gt; v2\n</code></pre>\n\n<p>What is the cause of this error if i can type right hand expression in ghci and it works fine, and how to avoid it in the future?</p>\n\n<p>I am using ghc 8.0.1 with natnormalize 0.5.2</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 1, "creation_date": 1490048505, "post_id": 42914870, "comment_id": 72929195, "body": "<code>(Num a, Ord a) =&gt; [a] -&gt; Int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "is_accepted": true, "score": 4, "last_activity_date": 1490049038, "last_edit_date": 1495540443, "creation_date": 1490049038, "answer_id": 42915143, "question_id": 42914870, "link": "https://stackoverflow.com/questions/42914870/type-declaration-for-list-of-num/42915143#42915143", "title": "Type Declaration For List of Num", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:-62-\" rel=\"nofollow noreferrer\"><code>(&gt;)</code> is defined on the <code>Ord</code> typeclass</a>, not the <code>Num</code> typeclass, so you need to put both the <code>Num</code> and <code>Ord</code> constraints on <code>a</code> for this to work:</p>\n\n<pre><code>numOfPos :: (Num a, Ord a) =&gt; [a] -&gt; Int\nnumOfPos xs = length [x | x &lt;- xs, x &gt; 0]\n</code></pre>\n\n<p>For more information about why elements of <code>Num</code> (\"numbers\") aren't elements of <code>Ord</code> (\"objects that have an ordering\"), see <a href=\"https://stackoverflow.com/questions/9824671/haskell-class-num-not-contained-in-ord\">this question</a>.</p>\n"}], "owner": {"reputation": 121, "user_id": 5712298, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ced70332842c48c0825bc1d39d670148?s=128&d=identicon&r=PG&f=1", "display_name": "Feltie", "link": "https://stackoverflow.com/users/5712298/feltie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 42915143, "answer_count": 1, "score": 1, "last_activity_date": 1490049038, "creation_date": 1490047691, "question_id": 42914870, "link": "https://stackoverflow.com/questions/42914870/type-declaration-for-list-of-num", "title": "Type Declaration For List of Num", "body": "<p>I'm new to Haskell and I have no idea what I'm doing wrong here. The following code generates an error.</p>\n\n<pre><code>numOfPos :: Num a =&gt; [a] -&gt; Int\nnumOfPos xs = length [x | x &lt;- xs, x &gt; 0]\n</code></pre>\n\n<p>The code just returns the number of positive elements in the list. The list can contain any type of number.</p>\n\n<p>The error says \"Could not deduce (Ord a) arising from a use of '&lt;' from the context (Num a)...\"</p>\n\n<p>What is the type declaration supposed to be to allow for this function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1490021025, "post_id": 42906427, "comment_id": 72912555, "body": "does the same happen if you invoke winghc instead of calling ghci from the commandline?"}, {"owner": {"reputation": 387, "user_id": 4953666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R6w25.jpg?s=128&g=1", "display_name": "Artur Trapp", "link": "https://stackoverflow.com/users/4953666/artur-trapp"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1490021091, "post_id": 42906427, "comment_id": 72912612, "body": "Unfortunately, yes"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 7740635, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b9ba7827bef9300abcc0e110fc2e2ebf?s=128&d=identicon&r=PG", "display_name": "user7740635", "link": "https://stackoverflow.com/users/7740635/user7740635"}, "is_accepted": true, "score": 2, "last_activity_date": 1490021761, "creation_date": 1490021761, "answer_id": 42906896, "question_id": 42906427, "link": "https://stackoverflow.com/questions/42906427/realgcc-no-disk-on-d-error/42906896#42906896", "title": "Realgcc: no disk on D: error", "body": "<p><a href=\"https://github.com/commercialhaskell/stack/issues/1798\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/1798</a>\nsays you could also remap the D: drive to another letter while they fix the issue</p>\n"}], "owner": {"reputation": 387, "user_id": 4953666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R6w25.jpg?s=128&g=1", "display_name": "Artur Trapp", "link": "https://stackoverflow.com/users/4953666/artur-trapp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 42906896, "answer_count": 1, "score": 1, "last_activity_date": 1490021761, "creation_date": 1490020657, "question_id": 42906427, "link": "https://stackoverflow.com/questions/42906427/realgcc-no-disk-on-d-error", "title": "Realgcc: no disk on D: error", "body": "<p>Just installed the last version of the Haskell platform, but when calling \"ghci\" from CMD, I get the following error: <br> <br><a href=\"https://i.stack.imgur.com/X97Ib.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X97Ib.png\" alt=\"enter image description here\"></a></p>\n\n<p>Searched over the web for solutions, but the best I found was <a href=\"https://github.com/commercialhaskell/stack/issues/1798\" rel=\"nofollow noreferrer\">this</a> post, which solution was reinstalling Windows. I do not want to reinstall right now, so, has anyone experienced this before? How can I fix?</p>\n"}, {"tags": ["haskell", "arraylist"], "comments": [{"owner": {"reputation": 41, "user_id": 7215941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c750e494a7c173026b35c1e6108c220f?s=128&d=identicon&r=PG&f=1", "display_name": "U\u011furcan \u015eahin", "link": "https://stackoverflow.com/users/7215941/u%c4%9furcan-%c5%9eahin"}, "edited": false, "score": 0, "creation_date": 1490020475, "post_id": 42906163, "comment_id": 72912159, "body": "I presume i should use this &quot;map (\\x -&gt; if p x then f x else x) xs&quot; for changing the values that i want, but the thing is how can i create the condition. I mean how can i find 2 adjoints &quot;d&quot; in the example above."}, {"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 0, "creation_date": 1490020722, "post_id": 42906163, "comment_id": 72912341, "body": "Is it always only 2 lists of strings?"}, {"owner": {"reputation": 41, "user_id": 7215941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c750e494a7c173026b35c1e6108c220f?s=128&d=identicon&r=PG&f=1", "display_name": "U\u011furcan \u015eahin", "link": "https://stackoverflow.com/users/7215941/u%c4%9furcan-%c5%9eahin"}, "reply_to_user": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 0, "creation_date": 1490021391, "post_id": 42906163, "comment_id": 72912848, "body": "no it may be more than 2"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1490027675, "post_id": 42906163, "comment_id": 72917480, "body": "What should <code>[[&quot;a&quot;],[&quot;a&quot;],[&quot;a&quot;]]</code> return? <code>[[&quot;x&quot;],[&quot;x&quot;],[&quot;a&quot;]]</code> , <code>[[&quot;a&quot;],[&quot;x&quot;],[&quot;x&quot;]]</code>, or <code>[[&quot;x&quot;],[&quot;x&quot;],[&quot;x&quot;]]</code> ? And what about <code>[[&quot;a&quot;],[&quot;a&quot;],[&quot;b&quot;]]</code> ? Should it be <code>[[&quot;x&quot;],[&quot;x&quot;],[&quot;b&quot;]]</code> ? or left as it is?"}], "answers": [{"comments": [{"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "reply_to_user": {"reputation": 41, "user_id": 7215941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c750e494a7c173026b35c1e6108c220f?s=128&d=identicon&r=PG&f=1", "display_name": "U\u011furcan \u015eahin", "link": "https://stackoverflow.com/users/7215941/u%c4%9furcan-%c5%9eahin"}, "edited": false, "score": 0, "creation_date": 1490022660, "post_id": 42907077, "comment_id": 72913872, "body": "I think in general in Haskell you generally don&#39;t need to worry about indexes too much:)"}], "tags": [], "owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "is_accepted": true, "score": 0, "last_activity_date": 1490022547, "last_edit_date": 1490022547, "creation_date": 1490022224, "answer_id": 42907077, "question_id": 42906163, "link": "https://stackoverflow.com/questions/42906163/functions-using-double-list-in-haskell/42907077#42907077", "title": "Functions Using Double List in Haskell", "body": "<p>Assuming equally long lists within</p>\n\n<pre><code>import Data.List\n\ntest = replaceWithxForEqualIndexes [[\"a\",\"b\",\"c\",\"d\"],[\"e\",\"f\",\"a\",\"d\"]]\n--Here is the magic, transpose so you get same indexes in the same list,\n--then check for equality and replace if equals, then transpose back\nreplaceWithxForEqualIndexes x = transpose $ map ifSameChangeToX $ transpose x\n\nifSameChangeToX x = ifSameChangeTo x \"x\"\n\nifSameChangeTo :: (Eq a) =&gt; [a] -&gt; a -&gt; [a]\nifSameChangeTo x rep\n    | allTheSame x = take (length x) (repeat rep)\n    | otherwise = x\n\nallTheSame :: (Eq a) =&gt; [a] -&gt; Bool\nallTheSame xs = and $ map (== head xs) (tail xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7745218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1405ee460186a9610f58ee040e13138a?s=128&d=identicon&r=PG&f=1", "display_name": "Prasenjit Chakraborty", "link": "https://stackoverflow.com/users/7745218/prasenjit-chakraborty"}, "is_accepted": false, "score": 0, "last_activity_date": 1491137926, "last_edit_date": 1491137926, "creation_date": 1490095894, "answer_id": 42925884, "question_id": 42906163, "link": "https://stackoverflow.com/questions/42906163/functions-using-double-list-in-haskell/42925884#42925884", "title": "Functions Using Double List in Haskell", "body": "<pre><code>import Data.List\n\nourFunction :: [[String]] -&gt; [[String]]\nourFunction input = [fst result, snd result]\n  where result = unzip $ zipWith (\\x y -&gt; if x == y then (\"x\", \"x\") else (x, y)) (head input) (last input)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7215941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c750e494a7c173026b35c1e6108c220f?s=128&d=identicon&r=PG&f=1", "display_name": "U\u011furcan \u015eahin", "link": "https://stackoverflow.com/users/7215941/u%c4%9furcan-%c5%9eahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 42907077, "answer_count": 2, "score": -3, "last_activity_date": 1491137926, "creation_date": 1490019984, "last_edit_date": 1490023705, "question_id": 42906163, "link": "https://stackoverflow.com/questions/42906163/functions-using-double-list-in-haskell", "title": "Functions Using Double List in Haskell", "body": "<p>I am trying to learn Haskell, and I cannot find a solution to the following problem.</p>\n\n<p>Consider the following function with type <code>ourFunction :: [[String]] -&gt; [[String]]</code>.<br>\nWhen two adjoint strings are the same, they should change to <code>'x'</code>.\nExample:  </p>\n\n<pre><code>ourFunction[[\"a\",\"b\",\"c\",\"d\"],[[\"e\",\"f\",\"a\",\"d\"] \n</code></pre>\n\n<blockquote>\n  <p><code>a</code> <code>b</code> <code>c</code> <code>d</code><br>\n  <code>e</code> <code>f</code> <code>a</code> <code>d</code></p>\n</blockquote>\n\n<p>It should return <code>[[\"a\",\"b\",\"c\",\"x\"],[[\"e\",\"f\",\"a\",\"x\"]</code>.</p>\n\n<p>I ask this to understand list indexing and changing a value within a list in a function.</p>\n"}, {"tags": ["haskell", "iteration", "nested-lists"], "comments": [{"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 3, "creation_date": 1490019015, "post_id": 42905514, "comment_id": 72911165, "body": "The simple answer is to use recursion. I recommend two things to make this question better: 1) define the problem better (e.g. what is a neighbor?) 2) try something and show your attempt"}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1490019081, "post_id": 42905514, "comment_id": 72911203, "body": "You can start by making a &quot;one step&quot; function, that will have the same type as <code>f</code>. Think about how can <code>f</code> use this function <i>many times</i>, until some condition is reached."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1490019357, "post_id": 42905514, "comment_id": 72911383, "body": "This is the exact perfect use case for a Comonad. Not beginner friendly, sure, but the most elegant way to implement this would be as a <a href=\"https://hackage.haskell.org/package/comonad-5/docs/Control-Comonad.html#v:-61--62--61-\" rel=\"nofollow noreferrer\">Comonad</a> instance (along with a data type including each &quot;cell&quot; and its neighbors). The beginner friendly solution would use a map over each layer of the list that updates each individual cell based on its neighbors."}, {"owner": {"reputation": 21, "user_id": 7242075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf7b2e3a68a0dcfafef45bd0d0c6ef9?s=128&d=identicon&r=PG&f=1", "display_name": "doodley", "link": "https://stackoverflow.com/users/7242075/doodley"}, "reply_to_user": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1490019469, "post_id": 42905514, "comment_id": 72911466, "body": "@user2297560 Ok, for neighbour, I think this definition is clear enough: A location is called as neighbor of another location if they are vertically, horizontally or diagonally adjacent."}, {"owner": {"reputation": 21, "user_id": 7242075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf7b2e3a68a0dcfafef45bd0d0c6ef9?s=128&d=identicon&r=PG&f=1", "display_name": "doodley", "link": "https://stackoverflow.com/users/7242075/doodley"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1490019557, "post_id": 42905514, "comment_id": 72911527, "body": "@Euge , This function will be used only once. For given input, it returns the next step of the input. That&#39;s all I wanted to achieve"}], "answers": [{"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 4, "last_activity_date": 1490095135, "last_edit_date": 1490095135, "creation_date": 1490067349, "answer_id": 42917974, "question_id": 42905514, "link": "https://stackoverflow.com/questions/42905514/nested-list-haskell-iteration/42917974#42917974", "title": "Nested List Haskell Iteration", "body": "<p>As I stated in a comment, recursion is the looping primitive in Haskell. However, Haskell gives us a lot of power to build more user-friendly abstractions instead of using recursion directly. As @Lazersmoke mentioned, Comonad is a good abstraction when you're updating each individual value of a collection based on other values in the collection, such as the neighbors of the value.</p>\n\n<p>There are quite a few examples of the Comonad class on the web, but it is sadly eclipsed by Monad. So here's my attempt to even the score a bit.</p>\n\n<p>This is going to be a long post, so let me begin with the results. This is from GHCi:</p>\n\n<pre><code>\u03bb display example\n[[A,A,A],[B,B,A],[A,A,B]]\n\u03bb display (transition example)\n[[B,B,A],[A,B,B],[B,B,A]]\n</code></pre>\n\n<p>Ok, now let's get down to business. First a few administrative things:</p>\n\n<pre><code>module Main where\nimport Control.Comonad -- from the comonad package\n</code></pre>\n\n<p>I'm going to try explaining each piece carefully, but it may take a while before the bigger picture becomes apparent. First, we're going to create an interesting data structure often called a zipper and implement an instance of <code>Functor</code> for it.</p>\n\n<pre><code>data U x = U [x] x [x] deriving Functor\n\ninstance Functor U where\n  fmap f (U as x bs) = U (fmap f as) (f x) (fmap f bs)\n</code></pre>\n\n<p>This data structure doesn't seem so special. It's how we use <code>U</code> that makes it cool. Because Haskell is lazy, we can use infinite lists with the <code>U</code> constructor. For example, <code>i1 = U [-1,-2..] 0 [1,2..]</code> represents all integers. That's not all, though. There's another piece of information: a center point at 0. We could have also represented all integers as <code>i2' = U [0,-1..] 1 [2,3..]</code>. These values are almost the same; they are just shifted by one. We can, in fact, create functions that will transform one into the other.</p>\n\n<pre><code>rightU (U a b (c:cs)) = U (b:a) c cs\nleftU  (U (a:as) b c) = U as a (b:c)\n</code></pre>\n\n<p>As you can see, we can <em>slide</em> a <code>U</code> to the left or the right just by rearranging elements. Let's make a <code>Show</code> instance for <code>U</code> and then verify that <code>rightU</code> and <code>leftU</code> work. We obviously can't print infinite lists, so we'll just take 3 elements from each side.</p>\n\n<pre><code>instance Show x =&gt; Show (U x) where\n  show (U as x bs) = (show . reverse . take 3) as ++ (show x) ++ (show . take 3) bs\n\n\u03bb i1\n[-3,-2,-1]0[1,2,3]\n\u03bb leftU i2\n[-3,-2,-1]0[1,2,3]\n\u03bb i2\n[-2,-1,0]1[2,3,4]\n\u03bb rightU i1\n[-2,-1,0]1[2,3,4]\n</code></pre>\n\n<p>Let's review our ultimate goal. We want to have a data structure where we can update each value based on all of its neighbors. Let's see how to do that with our <code>U</code> data structure. Suppose we want to replace each number with the sum of its neighbors. First, let's write a function that calculates the neighbors of the current position of a <code>U</code>:</p>\n\n<pre><code>sumOfNeighbors :: U Int -&gt; Int\nsumOfNeighbors (U (a:_) _ (b:_)) = a + b\n</code></pre>\n\n<p>And just to verify that it works:</p>\n\n<pre><code>\u03bb sumOfNeighbors i1\n0\n\u03bb sumOfNeighbors i2\n2\n</code></pre>\n\n<p>Unfortunately, this only gives us a single result. We want to apply this function to every possible position. Well <code>U</code> has a <code>Functor</code> instance, so we can <code>fmap</code> a function over it. That would work great if our function had a type like <code>Int -&gt; Int</code>, but it's actually <code>U Int -&gt; Int</code>. But what if we could turn our <code>U Int</code> into a <code>U (U Int)</code>? Then <code>fmap sumOfNeighbors</code> would do exactly what we want!</p>\n\n<p>Get ready for some inception-level data structuring. We're going to take our <code>U Int</code> and create a <code>U (U Int)</code> that will look like this:</p>\n\n<pre><code>-- not real Haskell. just for illustration\nU [leftU u, (leftU . leftU) u, (leftU . leftU . leftU) u..] u [rightU u, (rightU . rightU) u, (rightU . rightU . rightU) u..]\n</code></pre>\n\n<p>This center of this new <code>U (U a)</code> is the original <code>U a</code>. When we slide left, we get original <code>U a</code> slid left, and likewise sliding right. In other words, the new <code>U (U a)</code> contains all the left and right slides of the original <code>U a</code> Here's how we do it:</p>\n\n<pre><code>duplicate :: U a -&gt; U (U a)\nduplicate u = U lefts u rights\n  where lefts  = tail $ iterate leftU u\n        rights = tail $ iterate rightU u\n</code></pre>\n\n<p>We can use <code>duplicate</code> to write the function that we want:</p>\n\n<pre><code>extend :: (U a -&gt; b) -&gt; U a -&gt; U b\nextend f = fmap f . duplicate\n</code></pre>\n\n<p>Let's try it out.</p>\n\n<pre><code>\u03bb extend sumOfNeighbors i1\n[-6,-4,-2]0[2,4,6]\n</code></pre>\n\n<p>Looks like it works. These function names, <code>duplicate</code> and <code>extend</code> weren't chosen arbitrarily (by me, at least). These functions are part of the <code>Comonad</code> type class. We've been implementing it for our <code>U</code> data type.</p>\n\n<pre><code>class Functor w =&gt; Comonad w where\n  extract :: w a -&gt; a\n  duplicate :: w a -&gt; w (w a)\n  extend :: (w a -&gt; b) -&gt; w a -&gt; w b\n</code></pre>\n\n<p>The only thing missing is <code>extract</code> which is trivial for <code>U</code>:</p>\n\n<pre><code>extract (U _ x _) = x\n</code></pre>\n\n<p>It's probably not apparent how useful this class is yet. Let's move on and look at how to handle the 2-dimensional case. We can do 2-dimensions with a zipper of zippers. That is, <code>U (U a)</code> where moving left and right shifts the   inner zippers, and moving up and down shifts the outer zipper.</p>\n\n<pre><code>newtype V a = V { getV :: U (U a) }\n\ninstance Functor V where\n  fmap f = V . (fmap . fmap) f . getV\n\n-- shift the 'outer' zipper\nup :: V a -&gt; V a\nup = V . leftU . getV\n\ndown :: V a -&gt; V a\ndown = V . rightU . getV\n\n-- shift the 'inner' zippers\nleft :: V a -&gt; V a\nleft = V . fmap leftU .getV\n\nright :: V a -&gt; V a\nright = V . fmap rightU . getV\n</code></pre>\n\n<p>Here's what Comonad looks like for <code>V</code>:</p>\n\n<pre><code>instance Comonad V where\n  extract = extract . extract . getV\n  duplicate = fmap V . V . dup . dup . getV\n    where dup u = U (lefts u) r (right u)\n          lefts u  = tail $ iterate (fmap leftU) u\n          rights u = tail $ iterate (fmap rightU) u\n</code></pre>\n\n<p>The <code>extract</code> function is fairly straightforward; it just digs through two layers of zippers to grab the current value. On the other hand, <code>duplicate</code> is sort of a monster. Ignoring the newtype <code>V</code>, its type would be <code>duplicate :: U (U a) -&gt; U (U (U (U a)))</code>. The purpose of the<code>dup</code> helper function is to add a <code>U</code> layer. It gets invoked twice. Then we wrap that in <code>V</code> to get a <code>V (U (U a))</code>. Then <code>fmap V</code> wraps the inner <code>U (U a)</code> to make the result <code>V (V a)</code>.</p>\n\n<p>Oh by the way, if you're wondering where <code>extend</code> is, we don't actually have to write it. The definition given above is its default.</p>\n\n<p>That was a lot of work, but now we'll be able to easily tackle the original problem! Check this out. I'm going to make a data structure that includes your <code>A</code> and <code>B</code> values, and also a value that we don't care about, <code>C</code>:</p>\n\n<pre><code>data Token = A | B | C deriving (Eq,Show)\n</code></pre>\n\n<p>And here's some stuff to make building and displaying a <code>V</code> easier.</p>\n\n<pre><code>-- a list of U's containing nothing but x's\nfilled x = repeat $ U (repeat x) x (repeat x)\n\ntype Triple a = (a,a,a)\n\n-- create a U with the middle values a, b, and c, and all the other values the defaulted to d\ntoU :: a -&gt; Triple a -&gt; U a\ntoU d (a,b,c) = U (a : repeat d) b (c : repeat d)\n\n-- create a V centered on the 9 given values and default all other values to d\ntoV :: a -&gt; Triple (Triple a) -&gt; V a\ntoV d (as, bs, cs) = V (U x y z)\n  where x = (toU d as) : filled d\n        y = toU d bs\n        z = (toU d cs) : filled d\n\ndisplay :: Show a =&gt; V a -&gt; [[a]]\ndisplay v = fmap g [ [up . left, up, up . right]\n                   , [left, id, right]\n                   , [down . left, down , down . right] ]\n  where g = fmap (extract . ($ v))\n</code></pre>\n\n<p>Here's what the example looks like:</p>\n\n<pre><code>example = toV C ((A,A,A)\n                ,(B,B,A)\n                ,(A,A,B))\n</code></pre>\n\n<p>And the rule is implemented by:</p>\n\n<pre><code>-- move into each neighboring position and get the value in that position\nneighbors :: V a -&gt; [a]\nneighbors v = fmap (extract . ($ v)) positions\n  where positions = [ up . left\n                    , up\n                    , up . right\n                    , left\n                    , right\n                    , down . left\n                    , down\n                    , down . right ]\n\nnumberOfBs :: V Token -&gt; Int\nnumberOfBs = length . filter (==B) . neighbors\n\nrule :: V Token -&gt; Token\nrule v = case extract v of\n  C -&gt; C  -- C's remain C's forever\n  _ -&gt; if numberOfBs v &gt;= 2 then B else A\n</code></pre>\n\n<p>Finally, we can apply <code>rule</code> to every value using <code>extend</code>:</p>\n\n<pre><code>transition = extend rule\n\n\u03bb display (transition example)\n[[B,B,A],[A,B,B],[B,B,A]]\n</code></pre>\n\n<p>This rule is kind of boring though. Everything quickly becomes B's.</p>\n\n<pre><code>\u03bb take 10 $ fmap display (iterate transition example)\n[[[A,A,A],[B,B,A],[A,A,B]],[[B,B,A],[A,B,B],[B,B,A]],[[B,B,B],[B,B,B],[B,B,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,B,B],[B,B,B],[B,B,B]]]\n</code></pre>\n\n<p>Creating a different rule is easy.</p>\n\n<pre><code>rule2 :: V Token -&gt; Token\nrule2 v = case extract v of\n  C -&gt; C\n  A -&gt; if numberOfBs v &gt;= 2 then B else A\n  B -&gt; if numberOfBs v &gt;= 4 then A else B\n\n\u03bb take 10 $ fmap display (iterate (extend rule2) example)\n[[[A,A,A],[B,B,A],[A,A,B]],[[B,B,A],[B,B,B],[B,B,B]],[[B,A,B],[A,A,A],[B,A,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,A,B],[A,A,A],[B,A,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,A,B],[A,A,A],[B,A,B]],[[B,B,B],[B,B,B],[B,B,B]],[[B,A,B],[A,A,A],[B,A,B]],[[B,B,B],[B,B,B],[B,B,B]]]\n</code></pre>\n\n<p>Cool, right? One final thing I want to mention. Did you notice that we didn't write any special cases to handle the edges? Since the data structure is infinite, we just filled the stuff out of the range which we don't care about with the value <code>C</code> and ignored it when considering the neighbors.</p>\n"}], "owner": {"reputation": 21, "user_id": 7242075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf7b2e3a68a0dcfafef45bd0d0c6ef9?s=128&d=identicon&r=PG&f=1", "display_name": "doodley", "link": "https://stackoverflow.com/users/7242075/doodley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1403, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1490095135, "creation_date": 1490018220, "last_edit_date": 1490020620, "question_id": 42905514, "link": "https://stackoverflow.com/questions/42905514/nested-list-haskell-iteration", "title": "Nested List Haskell Iteration", "body": "<p>I need to implement a nested list operation in Haskell.</p>\n\n<pre><code>f :: [[String]] -&gt; [[String]]\n</code></pre>\n\n<p>My input is a 2d array</p>\n\n<pre><code>[ [ \u201dA\u201d , \u201dA\u201d , \u201dA\u201d ]  \n, [ \u201dB\u201d , \u201dB\u201d , \u201dA\u201d ]\n, [ \u201dA\u201d , \u201dA\u201d , \u201dB\u201d ] ]\n</code></pre>\n\n<p>I arbitrarily generated that list.</p>\n\n<pre><code>A A A\nB B A \nA A B\n</code></pre>\n\n<p>So in my implementation I need to do the following.</p>\n\n<ul>\n<li>If a position has A, and it has 2 or more than 2 \"B\" neighbors, it will turn to B.</li>\n<li>If a position has B, and it has 2 or more than 2 \"B\" neighbors, it stays like as it is.</li>\n<li>If a position has B, and it has less than 2 \"B\" neighbors, it will turn to A.</li>\n</ul>\n\n<p>So after 1st step my table will look like this.</p>\n\n<pre><code>B B A\nA B B\nB B A\n</code></pre>\n\n<p>If I were going to use C or C++, my algorithm would like this:</p>\n\n<ol>\n<li><p>Make a copy of my input.</p></li>\n<li><p>Traverse both list in 2for loops, check if statements to make a change in the location and whenever I'm going to make a change, I will change the second list not the first, so that traversing the first list won't effect the other \"A\"'s and \"B\"'s.</p></li>\n<li><p>Return second list.</p></li>\n</ol>\n\n<p>The problem is, in Haskell, I cannot use iteration. How can I solve this problem?</p>\n"}, {"tags": ["haskell", "lambda-calculus"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1489990936, "post_id": 42896907, "comment_id": 72894266, "body": "What type do you think <code>sa</code> should have? Remember that all terms in Haskell must have a type. Also, what problem are you trying to solve?"}, {"owner": {"reputation": 323, "user_id": 1460740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e14de97d7290976e639dd99b25f76b?s=128&d=identicon&r=PG", "display_name": "Yoshihiro Tanaka", "link": "https://stackoverflow.com/users/1460740/yoshihiro-tanaka"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489994039, "post_id": 42896907, "comment_id": 72895496, "body": "@Alec I don&#39;t know, it takes a function that can take a function ? I&#39;m just learning lambda calculus and wondered how to express it in Haskell. I thought Haskell would be nice to check each example, but I got stuck immediately. Maybe Lisp or Scheme is easier for this purpose."}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1490008429, "post_id": 42896907, "comment_id": 72903761, "body": "It&#39;s not a matter of which language you use. Try to construct this function in typed lambda calculus and think what type should it have. The problem we&#39;ll be similar, you can&#39;t construct infinite types"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1490040636, "post_id": 42896907, "comment_id": 72925227, "body": "It does matter.  You can easily do this in Lisp and Scheme, because they are dynamically typed."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1490005157, "post_id": 42897104, "comment_id": 72901675, "body": "Moreover, this might trigger a <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/bugs.html#bugs-in-ghc\" rel=\"nofollow noreferrer\">known bug in GHC</a> which makes the inliner to diverge. GHC devs will not fix this for pragmatic reasons, and IIRC the bug has an easy workaround using <code>{-# NOINLINE as #-}</code> so to disable the inliner on the critical function."}, {"owner": {"reputation": 323, "user_id": 1460740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e14de97d7290976e639dd99b25f76b?s=128&d=identicon&r=PG", "display_name": "Yoshihiro Tanaka", "link": "https://stackoverflow.com/users/1460740/yoshihiro-tanaka"}, "edited": false, "score": 0, "creation_date": 1490036256, "post_id": 42897104, "comment_id": 72922706, "body": "@Daniel Wagner, Thank you, but how can I apply this <code>sa</code> to, say, identity function <code>id</code> ? I still get type errors when I try something like <code>:type NotYet Main.id</code>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 323, "user_id": 1460740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e14de97d7290976e639dd99b25f76b?s=128&d=identicon&r=PG", "display_name": "Yoshihiro Tanaka", "link": "https://stackoverflow.com/users/1460740/yoshihiro-tanaka"}, "edited": false, "score": 0, "creation_date": 1490040875, "post_id": 42897104, "comment_id": 72925368, "body": "@YoshihiroTanaka, this is a monotyped self-application.  In the self application <code>id id</code>, the two <code>id</code>s have different types.  More explicitly its <code>(id :: (A -&gt; A) -&gt; (A -&gt; A)) (id :: A -&gt; A)</code>  (for any type <code>A</code>).  Thus you can&#39;t use <code>sa</code> because the thing <code>sa</code> applies to itself is not polymorphic."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 13, "last_activity_date": 1490040686, "last_edit_date": 1490040686, "creation_date": 1489991303, "answer_id": 42897104, "question_id": 42896907, "link": "https://stackoverflow.com/questions/42896907/how-can-i-write-self-application-function-in-haskell/42897104#42897104", "title": "How can I write self-application function in Haskell?", "body": "<p>Use a newtype to construct the infinite type.</p>\n\n<pre><code>newtype Eventually a = NotYet (Eventually a -&gt; a)\n\nsa :: Eventually a -&gt; a\nsa eventually@(NotYet f) = f eventually\n</code></pre>\n\n<p>In GHC, <code>eventually</code> and <code>f</code> will be the same object in memory.</p>\n"}, {"comments": [{"owner": {"reputation": 323, "user_id": 1460740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e14de97d7290976e639dd99b25f76b?s=128&d=identicon&r=PG", "display_name": "Yoshihiro Tanaka", "link": "https://stackoverflow.com/users/1460740/yoshihiro-tanaka"}, "edited": false, "score": 0, "creation_date": 1490078272, "post_id": 42913315, "comment_id": 72938016, "body": "Thank you for your help! I&#39;m new to Haskell and did not even know I had to add <code>{-# LANGUAGE RankNTypes #-}</code>. It works now :-)"}, {"owner": {"reputation": 323, "user_id": 1460740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e14de97d7290976e639dd99b25f76b?s=128&d=identicon&r=PG", "display_name": "Yoshihiro Tanaka", "link": "https://stackoverflow.com/users/1460740/yoshihiro-tanaka"}, "edited": false, "score": 1, "creation_date": 1490106610, "post_id": 42913315, "comment_id": 72957286, "body": "Also wanted to add a link to relevant post on Haskell type-checker back from 2002: <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2002-June/003151.html\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 3, "last_activity_date": 1490041949, "last_edit_date": 1490041949, "creation_date": 1490041572, "answer_id": 42913315, "question_id": 42896907, "link": "https://stackoverflow.com/questions/42896907/how-can-i-write-self-application-function-in-haskell/42913315#42913315", "title": "How can I write self-application function in Haskell?", "body": "<p>I don't think there is a single self-application function that will work for all terms in Haskell.  Self-application is a peculiar thing in typed lambda calculus, which will often evade typing.  This is related to the fact that with self-application we can express the fixed-point combinator, which introduces inconsistencies into the type system when viewed as a logical system (see Curry-Howard correspondence).</p>\n\n<p>You asked about applying it to the <code>id</code> function.  In the self application <code>id id</code>, the two <code>id</code>s have different types. More explicitly it's <code>(id :: (A -&gt; A) -&gt; (A -&gt; A)) (id :: A -&gt; A)</code> (for any type <code>A</code>).  We could make a self-application specifically designed for the <code>id</code> function:</p>\n\n<pre><code>sa :: (forall a. a -&gt; a) -&gt; b -&gt; b\nsa f = f f\n\nghci&gt; :t sa id\nsa id :: b -&gt; b\n</code></pre>\n\n<p>which works just fine, but is rather limited by its type.</p>\n\n<p>Using <code>RankNTypes</code> you can make families of self-application functions like this, but you're not going to be able to make a general self-application function such that <code>sa t</code> will be well-typed iff <code>t t</code> is well-typed (at least not in System F\u03c9 (\"F-omega\"), which GHC's core calculus is based on).</p>\n\n<p>The reason, if you work it out formally (probably), is that then we could get <code>sa sa</code>, which has no normal form, and F\u03c9 is known to be normalizing (until we add <code>fix</code> of course).</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1490126345, "last_edit_date": 1490126345, "creation_date": 1490125893, "answer_id": 42936901, "question_id": 42896907, "link": "https://stackoverflow.com/questions/42896907/how-can-i-write-self-application-function-in-haskell/42936901#42936901", "title": "How can I write self-application function in Haskell?", "body": "<p>This is because the untyped lambda calculus is in some way <strong>more</strong> powerful than Haskell. Or, to put it differently, the untyped lambda calculus has no type system. Thus, it has no sound type system. Whereas Haskell does have one.</p>\n\n<p>This shows up not only with self application, but in any cases where infinite types are involved. Try this, for example:</p>\n\n<pre><code>i x = x\ns f g x = f x (g x)\ns i i\n</code></pre>\n\n<p>It is astonishing how the type system finds out that the seemingly harmless expresion <code>s i i</code> should not be allowed with a sound type system. Because, if it <em>were</em> allowed, self application would be possible.</p>\n"}], "owner": {"reputation": 323, "user_id": 1460740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e14de97d7290976e639dd99b25f76b?s=128&d=identicon&r=PG", "display_name": "Yoshihiro Tanaka", "link": "https://stackoverflow.com/users/1460740/yoshihiro-tanaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 42913315, "answer_count": 3, "score": 5, "last_activity_date": 1490126345, "creation_date": 1489990347, "question_id": 42896907, "link": "https://stackoverflow.com/questions/42896907/how-can-i-write-self-application-function-in-haskell", "title": "How can I write self-application function in Haskell?", "body": "<p>I tried following code, but it generates type errors.</p>\n\n<pre><code>sa f = f f\n</code></pre>\n\n<blockquote>\n<pre><code>\u2022 Occurs check: cannot construct the infinite type: t ~ t -&gt; t1\n\u2022 In the first argument of \u2018f\u2019, namely \u2018f\u2019\n  In the expression: f f\n  In an equation for \u2018sa\u2019: sa f = f f\n\u2022 Relevant bindings include\n    f :: t -&gt; t1\n      (bound at fp-through-lambda-calculus-michaelson.hs:9:4)\n    sa :: (t -&gt; t1) -&gt; t1\n      (bound at fp-through-lambda-calculus-michaelson.hs:9:1)\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1490013718, "post_id": 42896273, "comment_id": 72907249, "body": "See also related work. The simplest, in a way most hands-on approach is <a href=\"http://hackage.haskell.org/package/mono-traversable-1.0.2/docs/Data-MonoTraversable.html#t:MonoFunctor\" rel=\"nofollow noreferrer\"><code>MonoFunctor</code></a>, which does not derive any general instance. Functor classes in generalised/constrained category-theory libraries, like my <a href=\"http://hackage.haskell.org/package/constrained-categories-0.3.0.1/docs/Control-Functor-Constrained.html#t:Functor\" rel=\"nofollow noreferrer\"><code>Constrained.Functor</code></a>,  solve the problem by giving the prelude-functor derived instance unambiguous tags (the category to work in)."}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1490017782, "post_id": 42896273, "comment_id": 72910253, "body": "Is my understanding correct that a <code>MonoTraversible</code> type, when mapped over, always returns a <code>MonoTraversible</code> of the same type? So <code>(omap f (xs :: t)) :: t</code> for all legal combinations of <code>f</code> and <code>x</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1490022241, "post_id": 42896273, "comment_id": 72913545, "body": "Yes, that class is indeed quite limiting."}], "answers": [{"tags": [], "owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "is_accepted": false, "score": 5, "last_activity_date": 1489989754, "creation_date": 1489989754, "answer_id": 42896795, "question_id": 42896273, "link": "https://stackoverflow.com/questions/42896273/functor-supertype-has-conflicting-instances/42896795#42896795", "title": "Functor supertype has conflicting instances", "body": "<p>When the compiler (GHC) looks for instances of a type class for a specific type, it doesn't take contexts of each instance into account. That's why it found two instances of <code>FgFunctor</code> for <code>OrdTriple</code> even though <code>OrdTriple</code> is not an instance of <code>Functor</code>.</p>\n\n<p><a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap\" rel=\"noreferrer\">GHC/AdvancedOverlap</a> shows you how you can solve this situation.</p>\n"}], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1489989754, "creation_date": 1489986883, "last_edit_date": 1495542329, "question_id": 42896273, "link": "https://stackoverflow.com/questions/42896273/functor-supertype-has-conflicting-instances", "title": "Functor supertype has conflicting instances", "body": "<p>I have defined a <a href=\"https://stackoverflow.com/a/42859793/6112457\">Fine-Grained Functor</a> class (<code>FgFunctor</code>) in order to apply a constraint to the type of functions that may map over my Ordered Triple datatype (<code>OrdTriple</code>), which requires the contained type be orderable.</p>\n\n<pre><code>import Data.List (sort)\n\n-- 'fine-grained' functor\nclass FgFunctor f a b where\n    fgmap :: (a -&gt; b) -&gt; f a -&gt; f b\n\ndata OrdTriple a = OrdTriple a a a deriving Show\n\ninstance (Ord a, Ord b) =&gt; FgFunctor OrdTriple a b where\n    fgmap f (OrdTriple n d x) = OrdTriple n' d' x'\n        where [n', d', x'] = sort [f n, f d, f x]\n\nmain :: IO ()\nmain = do\n    let test = fgmap (* 10^4) $ OrdTriple 1 6 11 \n    print test\n</code></pre>\n\n<p>The code works fine until I define all other <code>Functor</code>s to also be <code>FgFunctor</code>s, like so:</p>\n\n<pre><code>-- all regular functors are also fine-grained ones\ninstance Functor f =&gt; FgFunctor f a b where\n    fgmap = fmap\n</code></pre>\n\n<p>With that instance declaration, as soon as I try to use <code>fgmap</code> on my <code>OrdTriple</code> type, the compiler complains about overlapping instance declarations</p>\n\n<pre><code>Overlapping instances for FgFunctor OrdTriple b0 b0\n  arising from a use of \u2018fgmap\u2019\nMatching instances:\n  instance Functor f =&gt; FgFunctor f a b\n    -- Defined at OrdTriple.hs:15:10\n  instance (Ord a, Ord b) =&gt; FgFunctor OrdTriple a b\n    -- Defined at OrdTriple.hs:18:10\nIn the expression: fgmap (* 10 ^ 4)\nIn the expression: fgmap (* 10 ^ 4) $ OrdTriple 1 6 11\nIn an equation for \u2018test\u2019:\n    test = fgmap (* 10 ^ 4) $ OrdTriple 1 6 11\n</code></pre>\n\n<p>However, the first 'matching instance' it refers to should never apply to <code>OrdTriple</code>, as <code>OrdTriple</code> is not a <code>Functor</code>, and so I am struggling to determine what is causing the supposed overlap.</p>\n"}, {"tags": ["algorithm", "debugging", "haskell", "recursion", "trace"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489966653, "post_id": 42893670, "comment_id": 72888423, "body": "Mind that <code>=</code> is <b>not an assignment</b>. It is an equation, so the <code>primes</code> in the <code>tail primes</code> is the <b>same</b> one as the one you are constructing at that time..."}, {"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489966858, "post_id": 42893670, "comment_id": 72888467, "body": "right, so the tail only really removes the 2 from the same list, which calls itself recursively, always just removing the 2, which is where the infinite list of 3s comes from"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1489967733, "post_id": 42893670, "comment_id": 72888703, "body": "How could <code>sieve ... [5, 7, ..]</code> ever possibly return <code>3:...</code>?  <code>sieve</code> can only produce elements from its second input in its output."}, {"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1489970710, "post_id": 42893670, "comment_id": 72889418, "body": "I guess my point is more:  sieve (tail primes) xs =&gt; sieve (3:(sieve (tail primes))) =&gt; sieve (3:3(sieve (tail primes)))......"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1489972670, "post_id": 42893670, "comment_id": 72889839, "body": "<code>sieve (tail primes) xs</code> does not reduce to <code>sieve (3 : sieve (tail primes))</code>."}, {"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1489976548, "post_id": 42893670, "comment_id": 72890654, "body": "primes =&gt; 2:3:(stuff) tail primes =&gt; 3:(stuff) sieve (tail primes) other =&gt; sieve (3:stuff) other substituting stuff: sieve (tail primes) [5,7..] so sieve (tail primes) [5, 7..] =&gt; sieve(3:(sieve (tail primes) [5, 7..])) [5,7..] etc"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1489987195, "post_id": 42893670, "comment_id": 72893086, "body": "Are you pretty familiar with lazy evaluation?  If not, I would suggest leaving this program be while you get more familiar -- this is a quite complex example -- I have many years experience with haskell and it would still take me quite some time to work out the evaluation order.  Maybe consider the classic fibonacci example very closely: <code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1489987237, "post_id": 42893670, "comment_id": 72893096, "body": "You can also have a look at <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Debug-Trace.html\" rel=\"nofollow noreferrer\"><code>Debug.Trace</code></a> which will print some text the first time a thunk is evaluated.  It can be a good guide for developing your intuition."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 3, "last_activity_date": 1490074974, "last_edit_date": 1490074974, "creation_date": 1490033126, "answer_id": 42910881, "question_id": 42893670, "link": "https://stackoverflow.com/questions/42893670/is-there-a-way-to-receive-information-on-execution-orderspecifically-for-sieve/42910881#42910881", "title": "Is there a way to receive information on execution order(Specifically for sieve of erastothenes)?", "body": "<p>I took the liberty of de-optimizing and clarifying the algorithm a little bit:</p>\n\n<pre><code>primes :: [Integer]\nprimes = 2 : sieve primes [3 ..]\n\nsieve :: [Integer] -&gt; [Integer] -&gt; [Integer]\nsieve []     xs = xs -- degenerate case for testing\nsieve (p:ps) xs = h ++ sieve ps [x | x &lt;- t, x `rem` p /= 0]\n  where (h, t) = span (&lt; p*p) xs\n</code></pre>\n\n<p>This is the same base logic, but it does a lot more redundant work (a constant factor per output value, though) than the version you provided.  I think that's a simpler starting point, and once you understand how this version works, it's easy to see what the optimizations do.  I also pulled <code>sieve</code> into its own definition.  It didn't use anything from its enclosing scope, and the ability to test it standalone might help with understanding what's going on.</p>\n\n<p>If you'd like to peek into how evaluation proceeds, you can use the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Debug-Trace.html\" rel=\"nofollow noreferrer\"><code>Debug.Trace</code></a> module.  The two functions I use most from it are <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Debug-Trace.html#v:trace\" rel=\"nofollow noreferrer\"><code>trace</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Debug-Trace.html#v:traceShow\" rel=\"nofollow noreferrer\"><code>traceShow</code></a>, depending on the value I want to see.</p>\n\n<p>So, let's get a bit of tracing info from <code>sieve</code>:</p>\n\n<pre><code>import Debug.Trace\n\nprimes :: [Integer]\nprimes = 2 : sieve primes [3 ..]\n\nsieve :: [Integer] -&gt; [Integer] -&gt; [Integer]\nsieve []     xs = trace \"degenerate case for testing\" xs\nsieve (p:ps) xs = traceShow (p, h) $ h ++ sieve ps [x | x &lt;- t, x `rem` p /= 0]\n  where (h, t) = span (&lt; p*p) xs\n</code></pre>\n\n<p>And to test it out:</p>\n\n<pre><code>ghci&gt; take 10 primes\n[2(2,[3])\n,3(3,[5,7])\n,5,7(5,[11,13,17,19,23])\n,11,13,17,19,23(7,[29,31,37,41,43,47])\n,29]\n</code></pre>\n\n<p>Well, that's a lot less clear than hoped.  When ghci prints out a result, it uses the <code>Show</code> instance for the result's type. And the <code>Show</code> instance for <code>[Integer]</code> is lazy itself, so the printing of the list is getting interleaved with the tracing.  To do better, let's have ghci produce a value that won't be output until after the tracing is complete.  The <code>sum</code> should do:</p>\n\n<pre><code>ghci&gt; sum $ take 10 primes\n129\n</code></pre>\n\n<p>That was..  less than useful.  Where'd the tracing go?  Well, remember that the tracing functions are <em>very</em> impure. Their explicit goal is to produce side effects.  But GHC doesn't respect side effects.  It assumes that all functions are pure.  One result of that assumption is that it can store the result of evaluating expressions.  (Whether it does so or not depends on whether there is a shared reference or CSE optimizations kick in. In this case, <code>primes</code> itself is a shared reference.)</p>\n\n<p>Maybe if we ask it to evaluate further than it has so far?</p>\n\n<pre><code>ghci&gt; sum $ take 20 primes\n(11,[53,59,61,67,71,73,79,83,89,97,101,103,107,109,113])\n639\n</code></pre>\n\n<p>Ok, the tracing is separate from ghci's output as desired.  But it's not really very informative at that point.  To get a better picture, it needs to start back at the beginning.  To do that, we need to get ghci to unload the definition of primes so that it will re-evaluate it from scratch.  There are a bunch of ways to do this, but I'll demonstrate a method that has some additional ways to be useful.</p>\n\n<pre><code>ghci&gt; :load *sieve.hs\n[1 of 1] Compiling Main             ( sieve.hs, interpreted )\nOk, modules loaded: Main.\n</code></pre>\n\n<p>By putting the <code>*</code> in front of the file name in the <code>:load</code> command, I instructed ghci to interpret the source from scratch, regardless of its current state.  This works in this case because it forces a re-interpretation even though the source hasn't changed.  It also is useful when you want to use <code>:load</code> on a source that has compiled output in the current directory, and have it interpret the whole module, not just load the compiled code.</p>\n\n<pre><code>ghci&gt; sum $ take 10 primes\n(2,[3])\n(3,[5,7])\n(5,[11,13,17,19,23])\n(7,[29,31,37,41,43,47])\n129\n</code></pre>\n\n<p>Now, let's get into how the algorithm actually works. The first thing to look into what the components of the tracing output are. The first element is the prime whose multiples are being sieved out of the potential outputs.  The second element is the list of values being accepted as primes because they're less than <code>p*p</code>, and all non-primes less than that have already been removed from the candidate list.  The mechanics of that should be familiar from any study of the sieve of Eratosthenes.</p>\n\n<p>The calls to <code>sieve</code> start with <code>sieve primes [3..]</code>.  The first place laziness critically comes into play is the pattern match on the first argument.  The <code>(:)</code> constructor is already known, so the pattern matches <code>p</code> to the literal <code>2</code>, and <code>ps</code> to an unevaluated expression. It's very important that it's unevaluated, because this call to <code>sieve</code> is what calculates the value. If it forced it to be evaluated to proceed, it would introduce a circular data dependency, which results in an infinite loop.</p>\n\n<p>As the tracing indicates, the prime being used to remove elements from the candidates is 2.  The call to <code>span</code> splits the input <code>[3..]</code> into <code>([3], [4..])</code>.  <code>h</code> is <code>[3]</code>, as demonstrated by the tracing output.  So the result of the call to <code>sieve</code> is <code>[3] ++ &lt;recursive call to sieve&gt;</code>.  This is the second place laziness critically comes into play in the algorithm. The implementation of <code>(++)</code> doesn't do anything at all with its second argument until it has already produced the prefix of the list.  This means that before the recursive call to <code>sieve</code> is evaluated, it's known that <code>ps</code> refers to a thunk that evaluates to <code>[3] ++ &lt;recursive call&gt;</code>.</p>\n\n<p>That's enough information to handle the recursive call to <code>sieve</code>. Now, <code>p</code> is matched to <code>3</code>, <code>ps</code> is matched to a thunk, and the logic continues.  The tracing should illustrate what's going on at this point.</p>\n\n<p>Now, the version you started with does a few things to optimize.  First, it observes that the first element of <code>t</code> is always going to equal <code>p*p</code>, and it uses pattern matching to eliminate that element without doing any remainder calculation on it. This is a small saving per prime examined, but it is a clear saving.</p>\n\n<p>Second, it skips filtering out the multiples of two, and just doesn't generate them in the first place. This reduces the amount of elements generated to be filtered later by a factor of two, <em>and</em> it reduces the number of filters being applied to each odd element by one.</p>\n\n<p>As an aside, note that the stacking filter behavior is actually algorithmically significant, and not faithful to the sieve of Eratosthenes as described in literature.  For further discussion of this, see <a href=\"https://www.cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf\" rel=\"nofollow noreferrer\">The Genuine Sieve of Eratosthenes</a> by Melissa O'Neill.</p>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490074974, "creation_date": 1489966394, "question_id": 42893670, "link": "https://stackoverflow.com/questions/42893670/is-there-a-way-to-receive-information-on-execution-orderspecifically-for-sieve", "title": "Is there a way to receive information on execution order(Specifically for sieve of erastothenes)?", "body": "<p>I am attempting to understand one of the prime number algorithms enumerated here: <a href=\"https://wiki.haskell.org/index.php?title=Prime_numbers&amp;oldid=36858#Postponed_Filters_Sieve\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/index.php?title=Prime_numbers&amp;oldid=36858#Postponed_Filters_Sieve</a>, specifically:</p>\n\n<pre><code>primes :: [Integer]\nprimes = 2: 3: sieve (tail primes) [5,7..]\n  where \n    sieve (p:ps) xs = h ++ sieve ps [x | x &lt;- t, x `rem` p /= 0]  \n                                    -- or:  filter ((/=0).(`rem`p)) t\n                      where (h,~(_:t)) = span (&lt; p*p) xs\n</code></pre>\n\n<p>So conceptually I understand how this algorithm works (sieve of Erastothenes), start with 2,3, and a list of numbers, then eliminate any that are greater than the previous square and divisible by any below it.</p>\n\n<p>But I'm having a hard time following along with the nested recursive step (prime calles sieve on primes, which calls sieve on primes which...)</p>\n\n<p>I understand that this works due to lazy evaluation, and it demonstrably produces the right result, but I am incapable of following it.</p>\n\n<p>So for example if I were to run <code>take 5 primes</code> what would actually happen:</p>\n\n<p>e.g (I will refer to the result of the take operation as t for ease of reading/reasoning):</p>\n\n<p>Step 1)\nprimes returns a list <code>[2,3, xs]</code></p>\n\n<p>so <code>t</code> is <code>[2,3, take 3 xs]</code></p>\n\n<p>where <code>xs</code> is <code>sieve (tail primes) [5,7..]</code></p>\n\n<p>Step 2)\n<code>tail primes</code> is <code>3:xs</code>\nwhere <code>xs</code> is <code>sieve (tail primes) [5,7..]</code>\netc</p>\n\n<p>so t should now be [2,3,3,3,3,3...]</p>\n\n<p>I have little trouble following sieve itself...</p>\n\n<p>So I guess I have two questions.</p>\n\n<p>1) How exactly does this algorithm actually work, and where/why is my trace wrong</p>\n\n<p>2) Is there a way, generally, in Haskell to figure out what order things are running in? Maybe print a recursion tree? Or at the very least drop in a debugger halt?</p>\n"}, {"tags": ["string", "list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489964607, "post_id": 42893388, "comment_id": 72887835, "body": "What if the film cannot be found? For instance <code>printFans testDatabase &quot;Star Wars&quot;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7737002"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489964810, "post_id": 42893388, "comment_id": 72887888, "body": "that is also an issue however could be cleared up  after initial functionality is achieved"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7737002"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489965018, "post_id": 42893388, "comment_id": 72887947, "body": "can deal with catching incorrect inputs within the development of the UI"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489965583, "post_id": 42893388, "comment_id": 72888124, "body": "how should the fans be printed? In what format?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7737002"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489967189, "post_id": 42893388, "comment_id": 72888542, "body": "As a string with comas separating each element"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489971285, "post_id": 42893388, "comment_id": 72889538, "body": "What have you tried? Where are you stuck, can you make a string from a lit of strings in the format you want?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7737002"}, "edited": false, "score": 0, "creation_date": 1489971465, "post_id": 42893388, "comment_id": 72889576, "body": "So far I have conducted other tasks such as printing all films after a given year and films a certain fan is a fan off I am just unsure about how to output the list and have it be dependant on the title"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7737002"}, "edited": false, "score": 0, "creation_date": 1489972102, "post_id": 42894312, "comment_id": 72889708, "body": "Thanks for the feedback will look into using the data method any way you could elaborate on why this method is preferable"}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 2, "last_activity_date": 1489976069, "last_edit_date": 1489976069, "creation_date": 1489971607, "answer_id": 42894312, "question_id": 42893388, "link": "https://stackoverflow.com/questions/42893388/haskell-printing-all-elements-of-a-list-within-tuple/42894312#42894312", "title": "Haskell printing all elements of a list within tuple", "body": "<p>You're really shooting yourself in the foot by using type synonyms for everything. <code>data Film = Film Title Director Year Fans</code> is much better than using a tuple in this case. Defining a separate <code>Film</code> data type brings the semantic difference between a <code>Film</code> and a tuple of <code>Title</code>, <code>Director</code>, <code>Year</code>, and <code>Fans</code> into the type system. This means that you can define instances for it (like <code>Show</code> or <code>Eq</code>) that will behave in a specific way that is different from what a tuple would give you. It also causes the compiler to reject code that (potentially accidentally) mixes a tuple that happens to have the type <code>(String,String,Int,[String])</code> with an actual <code>Film</code>. This adds safety, which is one of the main reasons to use Haskell in the first place.</p>\n\n<p>That said, listing the fans only is pretty simple either way:</p>\n\n<pre><code>listFans :: Film -&gt; String\n-- data way\nlistFans (Film _ _ _ fans) = intersperse ',' fans\n-- tuple way\nlistFans (_,_,_,fans) = intersperse ',' fans\n</code></pre>\n\n<p>Next, we need a <code>lookupFilm :: Database -&gt; Title -&gt; Maybe Film</code> to find the film we want. We need the <code>Maybe</code> because the <code>Film</code> might not be in the <code>Database</code>.</p>\n\n<pre><code>lookupFilm :: Database -&gt; Title -&gt; Maybe Film\nlookupFilm db t = find (\\(Film t' _ _ _) -&gt; t == t') db\n</code></pre>\n\n<p>Note that this doesn't \"print\" the strings, it just returns them, so you would need <code>putStrLn . listFans :: Film -&gt; IO ()</code> to actually output them.</p>\n\n<p>If you always lookup films by their title, you might as well use a <code>Map Title Film</code> from <a href=\"https://hackage.haskell.org/package/containers-0.5.10.1/docs/Data-Map.html\" rel=\"nofollow noreferrer\">Data.Map</a>.</p>\n\n<p>Lastly: be sure you understand how <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/Data.Foldable.html#find\" rel=\"nofollow noreferrer\"><code>find</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/Data.OldList.html#intersperse\" rel=\"nofollow noreferrer\"><code>intersperse</code></a> work; <code>Data.List</code> is like being given a fish, but you need to learn how to fish for yourself in order to tackle more complex problems as they arise.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7737002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489976069, "creation_date": 1489964473, "last_edit_date": 1489967973, "question_id": 42893388, "link": "https://stackoverflow.com/questions/42893388/haskell-printing-all-elements-of-a-list-within-tuple", "title": "Haskell printing all elements of a list within tuple", "body": "<p>I'm trying to print all elements of the Fans list for a given film title for example all fans of \"Avatar\" not quite sure how to filter this and display the correct elements as a string. Here is the type definition of the program with some of the test data.</p>\n\n<pre><code>import Data.Char\nimport Data.List\n\n--types\ntype Title = String\ntype Director = String\ntype Year = Int\ntype Fans = [String]\n\ntype Film = (Title, Director, Year, Fans)\n\ntype Database = [Film]\n\ntestDatabase :: [Film]\ntestDatabase = [\n (\"Blade Runner\", \"Ridley Scott\", 1982, [\"Zoe\", \"Heidi\", \"Jo\", \"Kate\", \"Emma\", \"Liz\", \"Sam\", \"Olga\", \"Tim\"]),\n (\"The Fly\", \"David Cronenberg\", 1986, [\"Garry\", \"Dave\", \"Zoe\", \"Kevin\", \"Emma\"]),\n (\"Body Of Lies\", \"Ridley Scott\", 2008, [\"Bill\", \"Olga\", \"Tim\", \"Zoe\", \"Paula\"]),\n (\"Avatar\", \"James Cameron\", 2009, [\"Dave\", \"Amy\", \"Liz\"]),\n (\"Titanic\", \"James Cameron\", 1997, [\"Zoe\", \"Emma\", \"Paula\", \"Liz\", \"Olga\", \"Dave\"])]\n</code></pre>\n"}, {"tags": ["haskell", "build", "c-preprocessor", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1489961707, "last_edit_date": 1495539981, "creation_date": 1489961707, "answer_id": 42892955, "question_id": 42892425, "link": "https://stackoverflow.com/questions/42892425/is-it-possible-to-use-cpp-preprocessors-with-haskell-stack/42892955#42892955", "title": "Is it possible to use cpp preprocessors with haskell stack", "body": "<p>From the <a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/yaml_configuration.md#flags\" rel=\"nofollow noreferrer\">wiki</a>, <a href=\"https://stackoverflow.com/a/35123917/630160\">this</a> answer here on SO and also this <a href=\"https://github.com/commercialhaskell/stack/issues/191\" rel=\"nofollow noreferrer\">github issue</a></p>\n\n<blockquote>\n  <h1>flags</h1>\n  \n  <p>Flags can be set for each package separately, e.g.</p>\n\n<pre><code>flags:   package-name:\n    flag-name: true\n</code></pre>\n  \n  <p>Flags will only affect packages in your packages and extra-deps settings. Packages that come from the snapshot global\n  database are not affected.</p>\n</blockquote>\n\n<p>Alternatively you can pass a flag on directly when invoking stack with <code>--flag</code>, I assume the syntax would be something like</p>\n\n<pre><code>stack test --flag project:TEST\n</code></pre>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 42892955, "answer_count": 1, "score": 1, "last_activity_date": 1489961707, "creation_date": 1489958453, "last_edit_date": 1489959958, "question_id": 42892425, "link": "https://stackoverflow.com/questions/42892425/is-it-possible-to-use-cpp-preprocessors-with-haskell-stack", "title": "Is it possible to use cpp preprocessors with haskell stack", "body": "<p>Is it possible to use cpp preprocessors with haskell stack,</p>\n\n<p>e.g:</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\nmodule MyModule (\n  main\n  #ifdef TEST\n    ,functionUnderTest\n    ,functionAlsoUnderTest\n  #endif\n  ) where ....\n</code></pre>\n\n<p>with cabal, the following settings in .cabal appear to work:\n<code>cpp-options:         -DTEST</code> \nis it possible to reproduce this with stack?</p>\n"}, {"tags": ["haskell", "monads", "comonad"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1489951616, "post_id": 42891098, "comment_id": 72883613, "body": "@pigworker has a whole <a href=\"https://www.youtube.com/watch?v=QojLQY5H0RI\" rel=\"nofollow noreferrer\">talk</a> and a good chunk of a <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\" rel=\"nofollow noreferrer\">paper</a> all about using monads (over indexed sets) to carve up 2D space"}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1489952541, "post_id": 42891098, "comment_id": 72883960, "body": "@benjamin-hodgson Oh awesome thanks! TBH at a first glance the paper seems a bit out of my league; I&#39;ve only just scratched the surface of Type Families; so the type-level programming in that paper is going to be a bit of a reach for me. That said, I&#39;ll definitely watch the video and give reading through the paper a try! Simpler solutions are also appreciated :)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489967793, "post_id": 42891098, "comment_id": 72888719, "body": "Tangential suggestion: consider using <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#ghc-flag--XLambdaCase\" rel=\"nofollow noreferrer\"><code>LambdaCase</code></a> in your <i>recursion-schemes</i> code. YMMV, but I find it makes the definitions of the (co)algebras a lot easier on the eyes."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1489983657, "post_id": 42891098, "comment_id": 72892239, "body": "@ChrisPenner Understood! A potted summary: your first <code>Tree</code> (whose <code>Monad</code> grafts trees together) is along the right lines, but it doesn&#39;t work because keeping the sizes of the constituent boxes lined up is tricky. (If you replace <code>a</code>s with <code>b</code>s using <code>fmap</code> you&#39;d better make sure the <code>b</code>s don&#39;t occupy more 2D space than the <code>a</code>s did!) Lindley and McBride&#39;s idea is to snap boxes together at the type level and expose an indexed monad interface, which forbids users from bending spacetime. FWIW I think the Hasochism paper is an excellent intro to fancy types in general, not just this problem"}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1489960967, "last_edit_date": 1489960967, "creation_date": 1489960025, "answer_id": 42892697, "question_id": 42891098, "link": "https://stackoverflow.com/questions/42891098/which-algebraic-pattern-fits-this-type-of-tree/42892697#42892697", "title": "Which Algebraic Pattern fits this type of tree?", "body": "<p>I would represent your type as a monad and use <code>&gt;&gt;=</code> to handle <code>split</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\nimport Control.Monad.Free\n\ndata Direction = Hor | Vert\n\ndata TreeF a = TreeF Direction a a deriving Functor\n\ntype Tree a = Free TreeF a\n</code></pre>\n\n<p>As for <code>close</code>, I would probably use <a href=\"http://hackage.haskell.org/package/recursion-schemes-5.0.1/docs/Data-Functor-Foldable.html#v:project\" rel=\"nofollow noreferrer\"><code>cata</code></a> or <code>para</code> from <strong>recursion-schemes</strong>, since <code>close</code> seems to work bottom-up and require at most knowledge of node parents and siblings. You could also turn to <a href=\"http://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Plated.html#t:Plated\" rel=\"nofollow noreferrer\"><code>Control.Lens.Plated</code></a>.</p>\n\n<p>Incidentally, <code>Free</code> already has a <a href=\"http://hackage.haskell.org/package/recursion-schemes-5.0.1/docs/Data-Functor-Foldable.html#t:Recursive\" rel=\"nofollow noreferrer\"><code>Recursive</code></a> instance. <code>FreeF TreeF a</code> would be the corresponding algebra. But you mentioned that it didn't work out very well.</p>\n\n<p>Working directly with the <code>Free</code> and <code>FreeT</code> constuctors might prove cumbersome. Perhaps some pattern synonyms could help there.</p>\n"}, {"comments": [{"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1489991508, "post_id": 42897040, "comment_id": 72894471, "body": "Thanks! I&#39;ll read this over ASAP, just wanted to let you know that tracking space allocated to each box actually isn&#39;t super important in my case; the structure of which boxes are appended to which in which direction is the most important part :)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1489991803, "post_id": 42897040, "comment_id": 72894563, "body": "@ChrisPenner Well, in that case the original <code>Tree</code> and its <code>Monad</code> instance should be enough (and hopefully the first half of my answer is a good enough explanation of how that works) - but how do you propose to avoid accidentally resizing content?"}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1489991983, "post_id": 42897040, "comment_id": 72894639, "body": "It&#39;s for a text editor, the &quot;boxes&quot; are viewports into buffers, I think it&#39;s reasonable for the viewports to resize themselves any time one of them is split or closed. In any case we can guarantee we resize at most 1 window. How can we use monad to implement close?"}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1489992156, "post_id": 42897040, "comment_id": 72894729, "body": "I really appreciate you going through the trouble to explain this in depth! I&#39;m excited to dive into it tomorrow :) I&#39;ve been hoping to get further into type programming, this should help get me started!"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1489992775, "post_id": 42897040, "comment_id": 72894959, "body": "@ChrisPenner IDK your exact use case but I&#39;m thinking about the case where an <code>fmap</code> accidentally resizes the <code>a</code> in one of your leaf nodes and pushes the other windows around - see the diagram about half way through the post. <code>close</code> should be easy - if you close the 1x3 box in my example above the two other boxes should expand to take its place. I expect there&#39;s only one way to make it type check: replace the closed window&#39;s parent with its sibling, after widening the sibling&#39;s nearest child(ren) by the same amount. It&#39;s 3AM here so I&#39;m happy to answer any further questions tomorrow :)"}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1490137205, "post_id": 42897040, "comment_id": 72976349, "body": "I&#39;ll use the intuitive Monad instance for split, but will probably stick with my recursion-schemes implementation for the other operations since it seems as though there&#39;s not a clear abstraction for that form of operation. This type theory stuff is really cool (and I&#39;ll definitely be referencing back to it) but is a little heavy-handed for my use-case. Thanks for your help :) I&#39;m going to leave it open for another few days in case others have comments, but I&#39;ll come back and accept then!"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 6, "last_activity_date": 1490062347, "last_edit_date": 1495542739, "creation_date": 1489990945, "answer_id": 42897040, "question_id": 42891098, "link": "https://stackoverflow.com/questions/42891098/which-algebraic-pattern-fits-this-type-of-tree/42897040#42897040", "title": "Which Algebraic Pattern fits this type of tree?", "body": "<p>I gave up trying to cram this into a comment. <a href=\"https://stackoverflow.com/users/828361/pigworker\">Conor McBride</a> has a whole <a href=\"https://www.youtube.com/watch?v=QojLQY5H0RI\" rel=\"nofollow noreferrer\">talk</a> and, with Sam Lindley, a big chunk of a <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\" rel=\"nofollow noreferrer\">paper</a>, all about using monads to carve up 2D space. Since you asked for an elegant solution I feel compelled to give you a potted summary of their work, although I wouldn't necessarily advise building this into your codebase - I suspect it's probably simpler just to work with a library like <a href=\"https://hackage.haskell.org/package/boxes\" rel=\"nofollow noreferrer\"><code>boxes</code></a> and hand-crank the cutting and resizing logic with manual error handling.</p>\n\n<hr>\n\n<p>Your first <code>Tree</code> is a step in the right direction. We can write a <code>Monad</code> instance to graft trees together:</p>\n\n<pre><code>instance Monad Tree where\n    return = Leaf\n    Leaf x &gt;&gt;= f = f x\n    Branch d l r &gt;&gt;= f = Branch d (l &gt;&gt;= f) (r &gt;&gt;= f)\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/11241990/1523776\"><code>Tree</code>'s <code>join</code></a> takes a tree with trees at its leaves and lets you walk all the way to the bottom without stopping for breath half way down. It may be helpful to think of <code>Tree</code> as a <a href=\"https://hackage.haskell.org/package/free-4.12.4/docs/Control-Monad-Free.html#t:Free\" rel=\"nofollow noreferrer\">free monad</a>, as @danidiaz has shown in <a href=\"https://stackoverflow.com/a/42892697/1523776\">an answer</a>. Or <a href=\"https://www.schoolofhaskell.com/user/edwardk/bound\" rel=\"nofollow noreferrer\">Kmett might say</a> that you have a very simple syntax permitting term substitution whose <code>Var</code> is called <code>Leaf</code>.</p>\n\n<p>Anyway, the point is you can use <code>&gt;&gt;=</code> to grow trees by progressively chopping up their leaves. Here I have a one-dimensional UI (let's forget about <code>Direction</code> for the moment) with a single window containing a <code>String</code>, and by repeatedly cutting it in half I end up with eight smaller windows.</p>\n\n<pre><code>halve :: [a] -&gt; Tree [a]\nhalve xs = let (l, r) = splitAt (length xs `div` 2) xs\n         in Node (Leaf l) (Leaf r)\n\nghci&gt; let myT = Leaf \"completeshambles\"\n-- |completeshambles|\nghci&gt; myT &gt;&gt;= halve\nNode (Leaf \"complete\") (Leaf \"shambles\")\n-- |complete|shambles|\nghci&gt; myT &gt;&gt;= halve &gt;&gt;= halve\nNode (Node (Leaf \"comp\") (Leaf \"lete\")) (Node (Leaf \"sham\") (Leaf \"bles\"))\n-- |comp|lete|sham|bles|\nghci&gt; myT &gt;&gt;= halve &gt;&gt;= halve &gt;&gt;= halve\nNode (Node (Node (Leaf \"co\") (Leaf \"mp\")) (Node (Leaf \"le\") (Leaf \"te\"))) (Node (Node (Leaf \"sh\") (Leaf \"am\")) (Node (Leaf \"bl\") (Leaf \"es\")))\n-- |co|mp|le|te|sh|am|bl|es|\n</code></pre>\n\n<p>(In real life you'd probably only be cutting up one window at a time, by checking its ID inside your binding function and returning it unchanged if it's not the one you're looking for.)</p>\n\n<p>The problem is, <code>Tree</code> has no understanding of the fact that physical space is a limited and precious resource. <code>fmap</code> lets you replace <code>a</code>s with <code>b</code>s, but the resulting structure won't fit on the screen if the <code>b</code>s take up more space than the <code>a</code>s did!</p>\n\n<pre><code>ghci&gt; fmap (\"in\" ++) myT\nLeaf \"incompleteshambles\"\n</code></pre>\n\n<p>This gets more serious in two dimensions, because boxes can push each other around and tear. If the middle window gets accidentally resized, I either get a misshapen box or a hole in the middle (depending on whereabouts in the tree it was).</p>\n\n<pre><code>+-+-+-+         +-+-+-+            +-+-+  +-+\n| | | |         | | | |            | | |  | |\n+-+-+-+         +-+-+-++-+   or,   +-+-+--+-+\n| | | |  ----&gt;  | |    | | perhaps | |    | |\n+-+-+-+         +-+-+-++-+         +-+-+--+-+\n| | | |         | | | |            | | |  | |\n+-+-+-+         +-+-+-+            +-+-+  +-+\n</code></pre>\n\n<p>Expanding a window is a perfectly reasonable thing to want to do, but in the real world the space it expands into has to come from somewhere. You can't grow one window without shrinking another, and vice versa. This is not the sort of operation which can be done with <code>&gt;&gt;=</code>, which performs local substitutions at individual leaf nodes; you need to look at a window's siblings to know who's taking up the space adjacent to it.</p>\n\n<hr>\n\n<p>So you shouldn't be allowed to use <code>&gt;&gt;=</code> to resize content like that. Lindley and McBride's idea is to teach the type checker how to snap boxes together. Using type-level natural numbers and addition,</p>\n\n<pre><code>data Nat = Z | S Nat\ntype family n :+ m where\n    Z :+ m = m\n    S n :+ m = S (n :+ m)\n</code></pre>\n\n<p>they work with content indexed by its width and height. (In the paper they use 2D matrices represented as vectors of vectors, but for efficiency you may want to use an array with a phantom type measuring its size.)</p>\n\n<pre><code>a, Box a :: (Nat, Nat) -&gt; *\n-- so Box :: ((Nat, Nat) -&gt; *) -&gt; (Nat, Nat) -&gt; *\n</code></pre>\n\n<p>Placing two boxes side by side using <code>Hor</code> requires that they have the same height, and placing them above each other with <code>Ver</code> requires that they have the same width.</p>\n\n<pre><code>data Box a wh where\n    Content :: a '(w, h) -&gt; Box a '(w, h)\n    Hor :: Box a '(w1, h) -&gt; Box a '(w2, h) -&gt; Box a '(w1 :+ w2, h)\n    Ver :: Box a '(w, h1) -&gt; Box a '(w, h2) -&gt; Box a '(w, h1 :+ h2)\n</code></pre>\n\n<p>Now we're ready to build a monad to graft together these trees. The semantics of <code>return</code> haven't changed - it puts a 2D object in a <code>Box</code> on its own.</p>\n\n<pre><code>return :: a wh -&gt; Box a wh\nreturn = Content\n</code></pre>\n\n<p>Now let's think about <code>&gt;&gt;=</code>. In general a box is made up of a number of pieces of <code>Content</code> of varying size, composed somehow to produce a larger box. Below I have three pieces of content sized 2x1, 2x2 and 1x3 making up a 3x3 box. This box will look something like <code>Hor (Ver (Content 2x1) (Content 2x2)) Content 1x3</code>.</p>\n\n<pre><code> 2x1\n+--+-+\n|  | |\n+--+ |1x3\n|  | |\n|  | |\n+--+-+\n 2x2\n</code></pre>\n\n<p>While you, the caller of <code>&gt;&gt;=</code>, know the outer measurements of your box, you don't know the dimensions of the individual pieces of content that make it up. How can you be expected to preserve the size of the content when you cut it up with <code>&gt;&gt;=</code>? You'll have to write a function which preserves the size without <em>a priori</em> knowledge of what the size was.</p>\n\n<p>So <code>&gt;&gt;=</code> takes a <code>Box</code> of a known size <code>wh</code>, takes it apart to find the content, processes it with a function which preserves the (unknown) size of the content you give it*, and puts it back together to produce a new box with the same size <code>wh</code>. Note the rank-2 type, reflecting the fact that the caller of <code>&gt;&gt;=</code> has no control over the dimensions of content the continuation will be called with.</p>\n\n<pre><code>(&gt;&gt;=) :: Box a wh -&gt; (forall wh2. a wh2 -&gt; Box b wh2) -&gt; Box b wh\nContent x &gt;&gt;= f = f x\nHor l r &gt;&gt;= f = Hor (l &gt;&gt;= f) (r &gt;&gt;= f)\nVer t b &gt;&gt;= f = Ver (t &gt;&gt;= f) (b &gt;&gt;= f)\n</code></pre>\n\n<p>If you use a type synonym <code>~&gt;</code> for index-preserving functions and flip the arguments, you get something which looks just like <code>=&lt;&lt;</code> for regular <code>Monad</code>s, but with a different kind of arrow. Kleisli composition also comes out looking quite pretty.</p>\n\n<pre><code>type a ~&gt; b = forall x. a x -&gt; b x\n\nreturn :: a ~&gt; Box a\n(=&lt;&lt;) :: (a ~&gt; Box b) -&gt; (Box a ~&gt; Box b)\n(&gt;=&gt;) :: (a ~&gt; Box b) -&gt; (b ~&gt; Box c) -&gt; (a ~&gt; Box c)\n</code></pre>\n\n<p>So that's monads over indexed sets. (More in <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/Kleisli.pdf\" rel=\"nofollow noreferrer\"><em>Kleisli Arrows of Outrageous Fortune</em></a>.) In <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\" rel=\"nofollow noreferrer\">the paper</a> they build a bunch more infrastructure to support cropping and rearranging boxes, which would probably be useful to you building a UI. For efficiency you might also decide to track the currently focused window using a <a href=\"https://www.st.cs.uni-saarland.de/edu/seminare/2005/advanced-fp/docs/huet-zipper.pdf\" rel=\"nofollow noreferrer\">zipper</a>, which is a fun exercise. Incidentally I think <em>Hasochism</em> is a great introduction to fancy types in general, not just as a solution to this particular problem.</p>\n\n<p><sup>*Assuming that <code>a</code>'s index is indeed an accurate measure of its physical size</sup></p>\n"}], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 2, "accepted_answer_id": 42897040, "answer_count": 2, "score": 8, "last_activity_date": 1490062347, "creation_date": 1489951340, "question_id": 42891098, "link": "https://stackoverflow.com/questions/42891098/which-algebraic-pattern-fits-this-type-of-tree", "title": "Which Algebraic Pattern fits this type of tree?", "body": "<p>I've got a puzzle for you,</p>\n\n<p>I managed to write some code that would do these things using recursion-schemes, but it's incredibly messy\nand that usually means that I missed a useful abstraction somewhere.</p>\n\n<p>I'm designing a layout system for my text editor\n<a href=\"https://github.com/chrispenner/rasa\" rel=\"noreferrer\"><code>Rasa</code></a>; It uses splits in a very similar\nmanner as Vim. I decided to describe the splits using a Tree; you can imagine\nit as a binary tree of either vertical or horizontal splits with 'Views' at the\nleaf nodes. <a href=\"https://camo.githubusercontent.com/c3d68b5b37318799846cb3c668ffac851a7fe463/687474703a2f2f662e636c2e6c792f6974656d732f334f3042305532493034316334323075313633772f746d757825323076696d25323070616e65732532306861636b2e706e67\" rel=\"noreferrer\">This\npicture</a>\nmight help.</p>\n\n<p>Here's my initial data structure:</p>\n\n<pre><code>data Direction = Hor | Vert\ndata Tree a = \n  Branch Direction (Tree a) (Tree a)\n  | Leaf a\n  deriving (Functor)\n</code></pre>\n\n<p>Some of the operations I need are:</p>\n\n<ul>\n<li><code>split :: (View -&gt; Tree View) -&gt; Tree View -&gt; Tree View</code> \nWhich splits nodes (or not) into two nodes horizontally or vertically (while maintaining their position in \nthe tree)</li>\n<li><code>close :: (View -&gt; Bool) -&gt; Tree View -&gt; Tree View</code> which 'closes' any views which match the predicate by removing\nthem from the tree and re-organizing adjacent views properly.</li>\n<li><code>fmap</code>; I'd like the tree to be a functor so I can alter the views.</li>\n</ul>\n\n<p>Some nice to have features:\n- <code>focusRight :: Tree View -&gt; Tree View</code>, Sets a View to be active if and only if the nearest horizontally joined\n    view to the left WAS active</p>\n\n<p>I'm looking for an abstraction or set of abstractions which would provide this\nfunctionality in a clean way. Here's my thought process so far:</p>\n\n<p>At first I thought I had a Monoid, The identity was the empty tree, and\n<code>mappend</code> would just attach another branch to the tree, but this doesn't work\nsince I have two operations: vertical append and horizontal append and the operations\naren't associative when they're mixed together.</p>\n\n<p>Next I thought 'Some of my operations depend on their context' so I probably have a Comonad. The version of the tree\nI have doesn't work as a co-monad because I don't have a value to <code>extract</code> on a Branch, so I restructured my tree\nlike this:</p>\n\n<pre><code>data Tree a = Node Direction [Tree a] a [Tree a]\n    deriving (Functor)\n</code></pre>\n\n<p>but this still\ndidn't handle the case of 'splitting' a node based on what was inside it, this matched the signature <code>(View -&gt; Tree View) -&gt;\nTree View -&gt; Tree View</code>, which unifies with <code>bind</code> from  Monad, so maybe I had a monad? I can implement monad for the\noriginal Tree definition, but can't figure it out for my Comonad tree version.</p>\n\n<p>Is there a way I can get the best of both worlds here? Am I digging up the wrong tree with Comonad/Monad?\nBasically I'm looking for an elegant way to model these functions over my data-structure. Thanks!</p>\n\n<p>If you want to see the full code, the functions are <a href=\"https://github.com/ChrisPenner/rasa/blob/master/rasa-ext-views/src/Rasa/Ext/Views/Internal/Views.hs\" rel=\"noreferrer\">here</a> and the current tree is <a href=\"https://github.com/ChrisPenner/rasa/blob/master/rasa-ext-views/src/Rasa/Ext/Views/Internal/BiTree.hs\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": ["qt", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489943324, "post_id": 42889255, "comment_id": 72880701, "body": "I am unaware about how that works on Windows, but you need to install the development kit for QT -- just having the libraries is enough for running programs, but not enough for developing new ones."}, {"owner": {"reputation": 1, "user_id": 7735946, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mudOse8sixs/AAAAAAAAAAI/AAAAAAAAADc/FdEJobsUOd4/photo.jpg?sz=128", "display_name": "\uc804\ud76c\ucc9c", "link": "https://stackoverflow.com/users/7735946/%ec%a0%84%ed%9d%ac%ec%b2%9c"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489944338, "post_id": 42889255, "comment_id": 72881079, "body": "I installed QT 5.7 and set environment variable. But, i can&#39;t build this library"}], "owner": {"reputation": 1, "user_id": 7735946, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mudOse8sixs/AAAAAAAAAAI/AAAAAAAAADc/FdEJobsUOd4/photo.jpg?sz=128", "display_name": "\uc804\ud76c\ucc9c", "link": "https://stackoverflow.com/users/7735946/%ec%a0%84%ed%9d%ac%ec%b2%9c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489941982, "creation_date": 1489941964, "last_edit_date": 1489941982, "question_id": 42889255, "link": "https://stackoverflow.com/questions/42889255/how-can-i-install-hsqml-with-windows-10", "title": "How can I install hsqml with Windows 10", "body": "<p>When I install hsqml, I get the following error:</p>\n\n<blockquote>\n<pre><code>cabal install hsqml\nResolving dependencies...\nConfiguring hsqml-0.3.4.1...\nFailed to install hsqml-0.3.4.1\nBuild log ( C:\\Users\\wjsgm\\AppData\\Roaming\\cabal\\logs\\hsqml-0.3.4.1.log ):\ncabal: Entering directory 'C:\\Users\\wjsgm\\AppData\\Local\\Temp\\cabal-tmp-16012\\hsqml-0.3.4.1'\n[1 of 1] Compiling Main             ( C:\\Users\\wjsgm\\AppData\\Local\\Temp\\cabal-tmp-16012\\hsqml-0.3.4.1\\dist\\setup\\setup.hs, C:\\Users\\wjsgm\\AppData\\Local\\Temp\\cabal-tmp-16012\\hsqml-0.3.4.1\\dist\\setup\\Main.o )\nLinking C:\\Users\\wjsgm\\AppData\\Local\\Temp\\cabal-tmp-16012\\hsqml-0.3.4.1\\dist\\setup\\setup.exe ...\nConfiguring hsqml-0.3.4.1...\nsetup.exe: Missing dependencies on foreign libraries:\n* Missing C libraries: Qt5Core, Qt5Gui, Qt5Widgets, Qt5Qml, Qt5Quick\nThis problem can usually be solved by installing the system packages that\nprovide these libraries (you may need the \"-dev\" versions). If the libraries\nare already installed but in a non-standard location then you can use the\nflags --extra-include-dirs= and --extra-lib-dirs= to specify where they are.\ncabal: Leaving directory 'C:\\Users\\wjsgm\\AppData\\Local\\Temp\\cabal-tmp-16012\\hsqml-0.3.4.1'\ncabal: Error: some packages failed to install:\nhsqml-0.3.4.1 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1489942146, "post_id": 42889229, "comment_id": 72880314, "body": "Try deleting the type signature altogether. Ask ghci what type <code>containsAll</code> is."}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1489942233, "post_id": 42889229, "comment_id": 72880344, "body": "Nice idea. It returned <code>containsAll :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool</code>"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1489954150, "post_id": 42889229, "comment_id": 72884533, "body": "@jublikon make sure you understand why it needs that type. The <code>Eq</code> constraint means that it only accepts lists where the elements can be compared for equality."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 2, "last_activity_date": 1489962652, "last_edit_date": 1495540462, "creation_date": 1489962652, "answer_id": 42893074, "question_id": 42889229, "link": "https://stackoverflow.com/questions/42889229/haskell-invalid-type-signature-containsall-eq-a-should-be-of-form-var/42893074#42893074", "title": "Haskell Invalid type signature: containsAll (Eq a) :: ... Should be of form &lt;variable&gt; :: &lt;type&gt;", "body": "<p>You've got the order slightly wrong. The correct signature format for type constraints is:</p>\n\n<pre><code>[variable] :: ([constraint1], [constraint2], ...) =&gt; [type]\n</code></pre>\n\n<p>so your signature should be:</p>\n\n<pre><code>containsAll :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>or, since there is only one constraint:</p>\n\n<pre><code>containsAll :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>But, as <a href=\"https://stackoverflow.com/users/775806/n-m\">n.m</a> mentioned, GHCi's <code>:t</code> command is often useful in determining types.</p>\n\n<p>If you're a beginner and you're having trouble with type signatures and typeclasses, I would reccommend <a href=\"http://learnyouahaskell.com/types-and-typeclasses#believe-the-type\" rel=\"nofollow noreferrer\">this chapter of LYAH.</a></p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1489965226, "creation_date": 1489965226, "answer_id": 42893498, "question_id": 42889229, "link": "https://stackoverflow.com/questions/42889229/haskell-invalid-type-signature-containsall-eq-a-should-be-of-form-var/42893498#42893498", "title": "Haskell Invalid type signature: containsAll (Eq a) :: ... Should be of form &lt;variable&gt; :: &lt;type&gt;", "body": "<p>You may also refactor your code as;</p>\n\n<pre><code>containsAll :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\ncontainsAll [] _ = True\ncontainsAll _ [] = False\ncontainsAll (x:xs) ys = (elem x ys) &amp;&amp; containsAll xs ys\n</code></pre>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1435, "favorite_count": 0, "accepted_answer_id": 42893074, "answer_count": 2, "score": 0, "last_activity_date": 1489965226, "creation_date": 1489941820, "last_edit_date": 1489963107, "question_id": 42889229, "link": "https://stackoverflow.com/questions/42889229/haskell-invalid-type-signature-containsall-eq-a-should-be-of-form-var", "title": "Haskell Invalid type signature: containsAll (Eq a) :: ... Should be of form &lt;variable&gt; :: &lt;type&gt;", "body": "<p>I have a function that checks if a list l2 contains each element of l1. </p>\n\n<pre><code>containsAll :: [a] -&gt; [a] -&gt; Bool    -- here I get the error\ncontainsAll []     _        = True\ncontainsAll (x:xs) []       = False\ncontainsAll (x:xs) b\n      | (elem x b)          = containsAll xs b\n      | otherwise           = False\n</code></pre>\n\n<p>This is the error I get:</p>\n\n<blockquote>\n  <p>No instance for (Eq a) arising from a use of \u2018elem\u2019</p>\n  \n  <p>Possible fix:\n   add (Eq a) to the context of\n     the type signature for containsAll :: [a] -> [a] -> Bool</p>\n</blockquote>\n\n<p>However if I change the first line to</p>\n\n<pre><code>containsAll (Eq a):: [a] -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>I get another error: </p>\n\n<blockquote>\n  <p>Invalid type signature: containsAll (Eq a) :: [a] -> [a] -> Bool</p>\n  \n  <p>Should be of form [variable] :: [type]</p>\n</blockquote>\n\n<p>What did I do wrong here?</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": true, "score": 12, "last_activity_date": 1489940480, "last_edit_date": 1489940480, "creation_date": 1489939170, "answer_id": 42888745, "question_id": 42888723, "link": "https://stackoverflow.com/questions/42888723/haskell-confuses-int-with-int-int/42888745#42888745", "title": "Haskell confuses Int with Int -&gt; Int", "body": "<p><code>($)</code> is defined as:</p>\n\n<pre><code>f $ x = f x\n</code></pre>\n\n<p>So your example actually is:</p>\n\n<pre><code>max low (min high)\n</code></pre>\n\n<p>which is wrong, because you actually want</p>\n\n<pre><code>max low (min high x)\n</code></pre>\n\n<p>Using function composition, which is defined as:</p>\n\n<pre><code>f . g = \\x -&gt; f (g x)\n</code></pre>\n\n<p>and your working example <code>\\x -&gt; max low (min high x)</code> we get:</p>\n\n<pre><code>\\x -&gt; max low (min high x)\n== max low . min high -- by definition of (.)\n</code></pre>\n"}], "owner": {"reputation": 1526, "user_id": 4969140, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6s6x0.jpg?s=128&g=1", "display_name": "Adrian Ja\u0142oszewski", "link": "https://stackoverflow.com/users/4969140/adrian-ja%c5%82oszewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 42888745, "answer_count": 1, "score": 3, "last_activity_date": 1490014374, "creation_date": 1489939028, "question_id": 42888723, "link": "https://stackoverflow.com/questions/42888723/haskell-confuses-int-with-int-int", "title": "Haskell confuses Int with Int -&gt; Int", "body": "<p>I recently came across this weird issue in Haskell. The following code is supposed to return a value trimmed down to a range (if it's above <code>high</code> it should return <code>high</code> if it's under <code>low</code> it should return <code>low</code>.</p>\n\n<pre><code>inRange :: Int -&gt; Int -&gt; Int -&gt; Int\ninRange low high = max low $ min high\n</code></pre>\n\n<p>the error message is:</p>\n\n<pre><code>scratch.hs:2:20:\n    Couldn't match expected type \u2018Int -&gt; Int\u2019 with actual type \u2018Int\u2019\n    In the expression: max low $ min high\n    In an equation for \u2018inRange\u2019: inRange low high = max low $ min high\n\nscratch.hs:2:30:\n    Couldn't match expected type \u2018Int\u2019 with actual type \u2018Int -&gt; Int\u2019\n    Probable cause: \u2018min\u2019 is applied to too few arguments\n    In the second argument of \u2018($)\u2019, namely \u2018min high\u2019\n    In the expression: max low $ min high\n</code></pre>\n\n<p>Shouldn't it take another argument and put it into high? I already tried other possibilities like:</p>\n\n<pre><code>\\x -&gt; max low $ min high x\n</code></pre>\n\n<p>and </p>\n\n<pre><code>\\x -&gt; max low $ (min high x)\n</code></pre>\n\n<p>When trying it in GHCI I'm getting the following error:</p>\n\n<pre><code>&lt;interactive&gt;:7:5:\n    Non type-variable argument in the constraint: Num (a -&gt; a)\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018inRange\u2019 has the inferred type\n      inRange :: forall a.\n                 (Num a, Num (a -&gt; a), Ord a, Ord (a -&gt; a)) =&gt;\n                 a -&gt; a\n</code></pre>\n"}, {"tags": ["list", "haskell", "shuffle"], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "edited": false, "score": 0, "creation_date": 1489944239, "post_id": 42889298, "comment_id": 72881035, "body": "But the <code>split</code> function returns an Error ([a],[a])"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "edited": false, "score": 0, "creation_date": 1489944513, "post_id": 42889298, "comment_id": 72881152, "body": "This is the part where you think about how to apply your constraints to the solution. It&#39;s the most fun in my opinion ;)"}, {"owner": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "edited": false, "score": 0, "creation_date": 1489945265, "post_id": 42889298, "comment_id": 72881423, "body": "I couldn&#39;t really understand your solution, but I managed to figure it out"}], "tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": false, "score": 1, "last_activity_date": 1489942756, "last_edit_date": 1489942756, "creation_date": 1489942228, "answer_id": 42889298, "question_id": 42888698, "link": "https://stackoverflow.com/questions/42888698/shuffling-a-list-based-on-an-int-list/42889298#42889298", "title": "Shuffling a List Based On an Int List", "body": "<p>Okay, what you want is basically the following:</p>\n\n<p>Given a list <code>xs</code> and indices <code>[a1, a2, a3, ..]</code>, split <code>xs</code> at <code>a1</code>, interleave, split it at <code>a2</code> and interleave, and so on...</p>\n\n<p>Now that leaves us with two functions:</p>\n\n<pre><code>step :: Int -&gt; [a] -&gt; [a]\nstep index xs = ??? -- something with split and interleave\n\nshuffle :: [a]\nshuffle [] xs = xs\nshuffle (i:indices) xs = let newList = step i xs\n                         in ??? -- something with recursion\n</code></pre>\n\n<p>Try to write the rest of these functions on yourself.</p>\n\n<blockquote class=\"spoiler\">\n  <p> <code>step</code> can easily be expressed as <code>let (x1, x2) = split index xs in interleave x1 x2</code>. Basically, the rest of <code>shuffle</code> can be written as <code>shuffle indices newList</code>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "is_accepted": false, "score": 0, "last_activity_date": 1489945243, "creation_date": 1489945243, "answer_id": 42889900, "question_id": 42888698, "link": "https://stackoverflow.com/questions/42888698/shuffling-a-list-based-on-an-int-list/42889900#42889900", "title": "Shuffling a List Based On an Int List", "body": "<p>I figured it out: </p>\n\n<pre><code>shuffle [] xs = Ok (xs)\nshuffle (x:xs) list = case (split x list) of\n                           Fail        -&gt; Fail\n                           Ok (l1, l2) -&gt; shuffle xs (interleave l1 l2)\n</code></pre>\n"}], "owner": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489945243, "creation_date": 1489938904, "question_id": 42888698, "link": "https://stackoverflow.com/questions/42888698/shuffling-a-list-based-on-an-int-list", "title": "Shuffling a List Based On an Int List", "body": "<p>Given the code:</p>\n\n<pre><code>data Error a = Fail|Ok a\n               deriving (Eq, Ord, Show)\n\nsplit :: Int -&gt; [a] -&gt; (Error ([a],[a]))\nsplit 0 list = Ok ([], list)\nsplit n list\n    | n &lt; 0 = Fail\n    | n &gt; length (list) = Fail\n    | otherwise = Ok (take n list, drop n list)\n\ninterleave ::  [a] -&gt;  [a] -&gt; [a]\ninterleave list [] = list\ninterleave [] list = list\ninterleave (x:xs) (y:ys) = x : y : interleave xs ys\n\n\nshuffle :: [Int] -&gt; [a] -&gt; Error [a]\n</code></pre>\n\n<p>How I write the function <code>shuffle</code> which will take a list of Ints, and split another list based on those ints. Examples of the int list would be intList = [20,23,24,13] where shuffle will split a list after the 20th element, interleave, split after the 23rd element, interleave, and so on.</p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "edited": false, "score": 0, "creation_date": 1489936612, "post_id": 42888232, "comment_id": 72878446, "body": "nice, what about <code>toEncoding</code>?"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 1, "last_activity_date": 1489938360, "last_edit_date": 1489938360, "creation_date": 1489936311, "answer_id": 42888232, "question_id": 42887813, "link": "https://stackoverflow.com/questions/42887813/json-nested-serialisation/42888232#42888232", "title": "JSON nested serialisation", "body": "<p>Here how instance may look like:</p>\n\n<pre><code>data V = V { a :: Int, x :: Int, y :: Int }\n\ninstance ToJSON V where\n    toJSON (V a x y) = object\n        [ \"a\" .= a\n        , \"nested\" .= object\n            [ \"x\" .= x\n            , \"y\" .= y ]\n        ]\n</code></pre>\n\n<p>You can test it in <code>ghci</code>:</p>\n\n<pre><code>ghci&gt; import qualified Data.ByteString.Lazy.Char8 as B\nghci&gt; B.putStrLn $ encode (V 1 2 3)\n{\"nested\":{\"x\":2,\"y\":3},\"a\":1}\n</code></pre>\n\n<p><strong>UPD</strong> (regarding <code>toEncoding</code>): </p>\n\n<p>You most likely don't want to define <code>toEncoding</code>. This method has default implementation and it's defined using <code>toJSON</code> method. But <code>toJSON</code> method has no implementation for general case. It has only <code>default</code> implementation for <code>Generic</code> data types. </p>\n\n<p>Your implementation if almost fine except it has typo: <code>\"x\" .= x &lt;&gt; \"y\" .= y</code> in method body and <code>(V a b c)</code> in pattern matching (thus it uses <code>x</code> variable as function and you got those creepy errors). And you need to derive <code>Generic</code> for your <code>V</code> data type for this to work. And you need to use <a href=\"http://hackage.haskell.org/package/aeson-1.1.1.0/docs/Data-Aeson-Encoding-Internal.html#v:pair\" rel=\"nofollow noreferrer\"><code>pair</code></a> function from internals instead of <code>.=</code> in one place. Here is full version:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\n\nimport Data.Monoid ((&lt;&gt;))\nimport GHC.Generics (Generic)\nimport Data.Aeson (ToJSON (..), pairs, (.=))\nimport Data.Aeson.Encoding.Internal (pair)\n\ndata V = V { a :: Int, x :: Int, y :: Int } deriving (Generic)\n\ninstance ToJSON V where\n    toEncoding (V a x y) = \n        pairs (\"a\" .= a &lt;&gt; (pair \"nested\" $ pairs (\"x\" .= x &lt;&gt; \"y\" .= y)))\n</code></pre>\n\n<p>But be aware of possible inconsistency:</p>\n\n<pre><code>ghci&gt; encode (V 1 2 3)\n\"{\\\"a\\\":1,\\\"nested\\\":{\\\"x\\\":2,\\\"y\\\":3}}\"\nghci&gt; toEncoding (V 1 2 3)\n\"{\\\"a\\\":1,\\\"nested\\\":{\\\"x\\\":2,\\\"y\\\":3}}\"\nghci&gt; toJSON (V 1 2 3)\nObject (fromList [(\"a\",Number 1.0),(\"x\",Number 2.0),(\"y\",Number 3.0)])\n</code></pre>\n"}], "owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 42888232, "answer_count": 1, "score": 1, "last_activity_date": 1489938360, "creation_date": 1489934218, "last_edit_date": 1489935086, "question_id": 42887813, "link": "https://stackoverflow.com/questions/42887813/json-nested-serialisation", "title": "JSON nested serialisation", "body": "<p>Assume there is a data type</p>\n\n<pre><code>data V = V { a :: Int, x :: Int, y :: Int }\n</code></pre>\n\n<p>It has a correspondent JSON view</p>\n\n<p>E.g. <code>V { a = 1, x = 2, y = 3 }</code> need to be serialised like</p>\n\n<pre><code>{\n  \"a\": 1,\n  \"nested\": {\n    \"x\": 2,\n    \"y\": 3\n  }\n}\n</code></pre>\n\n<p>What <code>ToJSON</code> instance would look like in that case?</p>\n\n<hr>\n\n<p>What I've tried:</p>\n\n<pre><code>instance ToJSON V where\n  toEncoding (V a b c) = \n    pairs (  \"a\" .= a\n          &lt;&gt; (\"nested\" .= pairs (\"x\" .= x &lt;&gt; \"y\" .= y))\n          )\n\n\n&lt;interactive&gt;:6:10: error:\n    \u2022 No instance for (GHC.Generics.Generic V)\n        arising from a use of \u2018aeson-1.1.1.0:Data.Aeson.Types.ToJSON.$dmtoJSON\u2019\n    \u2022 In the expression:\n        aeson-1.1.1.0:Data.Aeson.Types.ToJSON.$dmtoJSON @V\n      In an equation for \u2018toJSON\u2019:\n          toJSON = aeson-1.1.1.0:Data.Aeson.Types.ToJSON.$dmtoJSON @V\n      In the instance declaration for \u2018ToJSON V\u2019\n\n&lt;interactive&gt;:6:68: error:\n    \u2022 No instance for (ToJSON Encoding) arising from a use of \u2018.=\u2019\n    \u2022 In the second argument of \u2018(&lt;&gt;)\u2019, namely\n        \u2018(\"nested\" .= pairs (\"x\" .= x &lt;&gt; \"y\" .= y))\u2019\n      In the first argument of \u2018pairs\u2019, namely\n        \u2018(\"a\" .= a &lt;&gt; (\"nested\" .= pairs (\"x\" .= x &lt;&gt; \"y\" .= y)))\u2019\n      In the expression:\n        pairs (\"a\" .= a &lt;&gt; (\"nested\" .= pairs (\"x\" .= x &lt;&gt; \"y\" .= y)))\n\n&lt;interactive&gt;:6:87: error:\n    \u2022 No instance for (ToJSON (V -&gt; Int)) arising from a use of \u2018.=\u2019\n        (maybe you haven't applied a function to enough arguments?)\n    \u2022 In the first argument of \u2018(&lt;&gt;)\u2019, namely \u2018\"x\" .= x\u2019\n      In the first argument of \u2018pairs\u2019, namely \u2018(\"x\" .= x &lt;&gt; \"y\" .= y)\u2019\n      In the second argument of \u2018(.=)\u2019, namely\n        \u2018pairs (\"x\" .= x &lt;&gt; \"y\" .= y)\u2019\n(0.01 secs,)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 1, "creation_date": 1489935525, "post_id": 42887691, "comment_id": 72878071, "body": "You could wrap your <code>(Value, Suite)</code> into a newtype and write an instance of <code>Show</code> for it. Or write a separate function, say <code>showCard</code> for the tuple without wrapping."}, {"owner": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "reply_to_user": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1489935623, "post_id": 42887691, "comment_id": 72878099, "body": "What would be the code for either ways?"}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 5, "last_activity_date": 1489970747, "last_edit_date": 1489970747, "creation_date": 1489936111, "answer_id": 42888183, "question_id": 42887691, "link": "https://stackoverflow.com/questions/42887691/is-it-possible-to-declare-a-typeclass-instance-for-a-type-alias/42888183#42888183", "title": "Is it possible to declare a typeclass instance for a type alias?", "body": "<p>You should define a <code>newtype</code> (or <code>data</code> type) for <code>Card</code>, the write the <code>Show</code> instance for it.</p>\n\n<pre><code>newtype Card = Card (Value,Suite)\n\ninstance Show Card where\n  show (Card (v,s)) = show v ++ show s\n</code></pre>\n\n<p>You could also enable <code>TypeSynonymInstances</code> and write the instance for <code>Card</code> as you wrote it.</p>\n\n<p>Edit: I should probably also mention that a type synonym is not the idiomatic/Haskell-ish way to handle your situation. A <code>Card</code> is semantically different from a pair of <code>Value</code> and <code>Suite</code>, which could represent (for example) some initial condition in a card game, and not necessarily an actual card.</p>\n"}, {"comments": [{"owner": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "edited": false, "score": 0, "creation_date": 1489939410, "post_id": 42888642, "comment_id": 72879432, "body": "I need to create a show function while leaving <code>Card</code> as <code>type</code>"}], "tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 4, "last_activity_date": 1489938545, "creation_date": 1489938545, "answer_id": 42888642, "question_id": 42887691, "link": "https://stackoverflow.com/questions/42887691/is-it-possible-to-declare-a-typeclass-instance-for-a-type-alias/42888642#42888642", "title": "Is it possible to declare a typeclass instance for a type alias?", "body": "<p>You probably ought to define your own data type instead of using <code>(,)</code>.</p>\n\n<pre><code>data Card = Card Value Suite\n\ninstance Show Card where\n    show (Card v s) = show v ++ show s\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 3, "last_activity_date": 1489959163, "creation_date": 1489959163, "answer_id": 42892551, "question_id": 42887691, "link": "https://stackoverflow.com/questions/42887691/is-it-possible-to-declare-a-typeclass-instance-for-a-type-alias/42892551#42892551", "title": "Is it possible to declare a typeclass instance for a type alias?", "body": "<p>To define an instance for ta ype you need to use the <code>TypeSynonymInstances</code> extension. In your case <code>instace Show Card</code> would be equivalent to <code>instance Show (Card, Suite)</code>. This is not allowed without the <code>FlexibleInstance</code> because standard type classes only allow instance of things like <code>Show (a,b)</code>.\nNow, using <code>FlexibleInstance</code> wouldn't be enough because <code>Show (a,b)</code> is already defined and your new instance will overlaps with the default one : How does the compiler chose between your instance of <code>Show (Card, Value)</code> and the standard one for <code>Show (a,b)</code> ? (Using a type is not enough has a type is like doing text substitution). To solve the problem of overlapping instance you need to use the <code>OverlappingInstance</code> extension : this is a bit tricky and usually not recommended.</p>\n"}], "owner": {"reputation": 66, "user_id": 7104323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5bc022e9bf1b3ac824be6c1f41c11f97?s=128&d=identicon&r=PG&f=1", "display_name": "Markeazy", "link": "https://stackoverflow.com/users/7104323/markeazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1489970747, "creation_date": 1489933454, "last_edit_date": 1489938633, "question_id": 42887691, "link": "https://stackoverflow.com/questions/42887691/is-it-possible-to-declare-a-typeclass-instance-for-a-type-alias", "title": "Is it possible to declare a typeclass instance for a type alias?", "body": "<p>I have the code: </p>\n\n<pre><code>data Value = A|Two|Three...Ten|J|Q|K deriving (Eq, Ord, Enum)\ninstance Show Value where\n    show A = \"A\"\n    show Two = \"2\"\n    ....\n    show K = \"K\"\n</code></pre>\n\n<p>And another data <code>Suite</code> with a similar <code>Show</code> instance for <code>Hearts</code>, <code>Spades</code>, <code>Clubs</code>, and <code>Diamonds</code>.</p>\n\n<p>If I have </p>\n\n<pre><code>type Card = (Value, Suite)\n</code></pre>\n\n<p>Is it possible to create a show function that would transform <code>(A, Spades)</code> into the string <code>\"AS\"</code>?</p>\n"}, {"tags": ["haskell", "monads", "typeclass", "ambiguous"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 6, "creation_date": 1489928329, "post_id": 42886686, "comment_id": 72875686, "body": "Give your class a different name (such as <code>MyMonad</code>) and change the name of all of its methods (like you did for <code>(&gt;&gt;==)</code>)."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 3, "creation_date": 1489929145, "post_id": 42886686, "comment_id": 72875901, "body": "Your class kinda obviously conflicts with the standard one."}, {"owner": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489930297, "post_id": 42886686, "comment_id": 72876291, "body": "hello @duplode, thanks I change the names as you mentioned, like MyMonad, myreturn and &gt;&gt;== and the code is works, thanks you, Tamas"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489931802, "post_id": 42886686, "comment_id": 72876803, "body": "Why do you keep reimplementing things that are already defined?"}, {"owner": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1489933334, "post_id": 42886686, "comment_id": 72877358, "body": "@chepner, question is good, ergo I am a beginner, I like to reimplement things as a practice, so yes, probably easier to use the already defined things, but all of these activities are good learning points for me,"}], "owner": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489927190, "creation_date": 1489927190, "question_id": 42886686, "link": "https://stackoverflow.com/questions/42886686/ambiguous-occurrence-monad", "title": "Ambiguous occurrence `Monad&#39;", "body": "<p>I am currently working with Monad type classes, and here is my code:</p>\n\n<pre><code>class Monad m where  \n    return :: a -&gt; m a  \n\n    (&gt;&gt;==) :: m a -&gt; (a -&gt; m b) -&gt; m b  \n\n    (&gt;&gt;) :: m a -&gt; m b -&gt; m b  \n    x &gt;&gt; y = x &gt;&gt;== \\_ -&gt; y  \n\n    fail :: String -&gt; m a  \n    fail msg = error msg  \n\n\ninstance Monad Maybe where  \n    return x = Just x  \n    Nothing &gt;&gt;= f = Nothing  \n    Just x &gt;&gt;= f  = f x  \n    fail _ = Nothing \n\nmain = do\n    print $ return \"WHAT\" :: Maybe String \n    print $ Just 9 &gt;&gt;= \\x -&gt; return (x*10)  \n    print $ Nothing &gt;&gt;= \\x -&gt; return (x*10)  \n</code></pre>\n\n<p>and I got this error message:</p>\n\n<pre><code>Ambiguous occurrence `Monad'\nIt could refer to either `Main.Monad'....or `Prelude.Monad',....\n</code></pre>\n\n<p>I tried import Prelude and hiding Monad but get newer and newer error messages that are much more confused me, thank you in advance, Tamas</p>\n"}, {"tags": ["haskell", "functional-programming", "integer", "logarithm"], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 4, "last_activity_date": 1489899660, "creation_date": 1489899660, "answer_id": 42883081, "question_id": 42883049, "link": "https://stackoverflow.com/questions/42883049/finding-the-number-of-digits-in-a-given-base-in-haskell/42883081#42883081", "title": "Finding the number of digits in a given base in haskell", "body": "<p>Your notation correctly uses the floor function; you just need to add that to your code: <code>floor (logBase b n) + 1</code></p>\n"}], "owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489899660, "creation_date": 1489899307, "question_id": 42883049, "link": "https://stackoverflow.com/questions/42883049/finding-the-number-of-digits-in-a-given-base-in-haskell", "title": "Finding the number of digits in a given base in haskell", "body": "<p>say we are given numbers n and b where b is the base to be taken, to find the number of digits in n i know that the formula is</p>\n\n<p>\u230alogmN\u230b+1</p>\n\n<p>however when i try it in haskell by doing</p>\n\n<pre><code>(logBase b n)+1\n</code></pre>\n\n<p>i get the answer in float but i want it in int. I am trying to use</p>\n\n<pre><code>integerLogBase b n\n</code></pre>\n\n<p>but thats also not working</p>\n\n<p>some examples are that number of digits in 7 in base 2 is 3.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1489883994, "post_id": 42881527, "comment_id": 72866446, "body": "<code>try</code> desugars to: <code>try n = calc n &gt;&gt;= \\(x, y) -&gt; return (x+1, y+1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 5, "last_activity_date": 1489884903, "last_edit_date": 1489884903, "creation_date": 1489884326, "answer_id": 42881618, "question_id": 42881527, "link": "https://stackoverflow.com/questions/42881527/binding-maybe-value-in-do-block-works-while-it-does-not-work-in-a-function/42881618#42881618", "title": "binding Maybe value in do-block works while it does not work in a function", "body": "<p>You get <code>Nothing</code> from <code>try</code> because you get <code>Nothing</code> from <code>calc</code>. The <code>Maybe</code> Monad instance (which you invoke via <code>do</code>-notation) propagates the <code>Nothing</code> forward to the output. <code>try2</code> fails because you attempt to match <code>Nothing</code> with the pattern <code>Just (x,y)</code>. These obviously don't match because one is a <code>Just</code> and one is a <code>Nothing</code>.</p>\n"}], "owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 42881618, "answer_count": 1, "score": 0, "last_activity_date": 1489884903, "creation_date": 1489883532, "question_id": 42881527, "link": "https://stackoverflow.com/questions/42881527/binding-maybe-value-in-do-block-works-while-it-does-not-work-in-a-function", "title": "binding Maybe value in do-block works while it does not work in a function", "body": "<p>In the following example, \"try 0\" works and I get \"Nothing\" while \"try2 0\" does not work and I get \"Irrefutable pattern failed for pattern Just (x, y)\"\nI don't know how I get \"Nothing\" from \"try 0\" ... because the output of \"calc n\" is binded to (x,y)...Please help me understand why..</p>\n\n<pre><code>try n = do\n  (x,y) &lt;- calc n\n  return (x+1, y+1)\n\ntry2 n = (x+1,y+1)\n  where\n    Just (x,y) = calc n\n\ncalc x\n  | x == 0 = Nothing\n  | otherwise = Just (x+1, 1)\n\nmain :: IO ()\nmain = print $ try 0\n</code></pre>\n"}, {"tags": ["file", "parsing", "haskell", "types", "readfile"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1489880034, "post_id": 42880733, "comment_id": 72865650, "body": "Well those strings aren&#39;t valid <code>Person</code> values since they lack the constructor.  Prefix them with the <code>Person</code> constructor then try <code>Read</code> or read each field and manually construct the <code>Person</code> value for each line.  Also consider using <code>readMaybe</code> so you can give prettier error messages when parsing fails."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1489882461, "post_id": 42880733, "comment_id": 72866154, "body": "The contents of the file should look more or less like the string you get doing <code>show (listOfPersons :: [Person])</code> if you want <code>read</code> to parse it"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 2, "creation_date": 1489884542, "post_id": 42880733, "comment_id": 72866524, "body": "The discussion so far ignores the fact that Read is not a good parser in general. This applies even more to the derived instance. The real solution here is to use one of the many parser combinators library. See Parsec for example."}], "owner": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 398, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1489876827, "creation_date": 1489876827, "question_id": 42880733, "link": "https://stackoverflow.com/questions/42880733/loading-a-custom-data-type-from-a-text-file-haskell", "title": "Loading a custom data type from a text file Haskell", "body": "<p>I have a custom data type, <code>Person</code>.</p>\n\n<pre><code>data Person = Person{ fname :: String\n                    , lname :: String\n                    , age :: Int\n                    , siblings :: [String]\n                    } deriving (Eq,Ord,Show,Read)\n</code></pre>\n\n<p>I also have a text file which has data formatted like </p>\n\n<pre><code>\"bob\" \"ross\" 60 [\"sam\", \"ron\"]\n\"fname\" \"lname\" age [\"sibling1\", \"sibling2\"]\n\"fname\" \"lname\" age [\"sibling1\", \"sibling2\"]\n</code></pre>\n\n<p>I want to load each line from the text file into my custom data type, <code>Person</code>. Since there are multiple lines it'll be <code>[Person]</code>.</p>\n\n<pre><code>contents &lt;- readFile \"persons.txt\"\nlet database :: [Person]\n    database = read contents\n</code></pre>\n\n<p>So <code>database</code> should be of type <code>[Person]</code> and each element in <code>database</code> relates to a line from <code>persons.txt</code>.</p>\n\n<p>I have a function which converts <code>[Person]</code> to a string, but when I try</p>\n\n<pre><code>putStrLn (personsToString(database))\n</code></pre>\n\n<p>I get <code>*** Exception: Prelude.read: no parse</code></p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "overloading"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489868639, "post_id": 42879220, "comment_id": 72862445, "body": "<code>read :: Read a =&gt; String -&gt; a</code> is for creating values of a specific type from a string representation, not for performing database lookups."}, {"owner": {"reputation": 134, "user_id": 3960649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/P6lUv.png?s=128&g=1", "display_name": "Dani Feldman", "link": "https://stackoverflow.com/users/3960649/dani-feldman"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489870818, "post_id": 42879220, "comment_id": 72863132, "body": "Thanks for your helpful comment. My boss asked from me to use the <b>read</b> function with expected code examples and I wanted to be sure if this is possible because I don`t find find any ways to resolve it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489873975, "post_id": 42879220, "comment_id": 72864056, "body": "Is he aware of the <code>Read</code> class? <code>read</code> itself cannot be overloaded, because it is not actually defined by the <code>Read</code> class."}, {"owner": {"reputation": 134, "user_id": 3960649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/P6lUv.png?s=128&g=1", "display_name": "Dani Feldman", "link": "https://stackoverflow.com/users/3960649/dani-feldman"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1489874830, "post_id": 42879220, "comment_id": 72864305, "body": "Maybe he just write it for example givings, probably he didn&#39;t analyzed it deeply. I think it&#39;s ok if it won&#39;t be <b>read</b> char by char. I was just curious if it&#39;s possible before act."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1489868530, "creation_date": 1489868530, "answer_id": 42879430, "question_id": 42879220, "link": "https://stackoverflow.com/questions/42879220/haskell-read-function-overloading-with-two-inputs/42879430#42879430", "title": "Haskell read function overloading with two inputs", "body": "<p>The function you want is <code>lookup</code>, which is part of the Prelude.</p>\n\n<pre><code>&gt; :t lookup\nlookup :: Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b\n&gt; let dbList = [(\"key1\", \"value1\")]\n&gt; lookup \"key1\" dbList\nJust \"value1\"\n&gt; lookup \"key2\" dbList\nNothing\n</code></pre>\n\n<p>If you really need the output in the tuple form you show, you can pattern-match on the result.</p>\n\n<pre><code>case lookup dbList someKey of\n    Just x -&gt; (\"found\", x)\n    Nothing -&gt; (\"not found\", \"data for \" ++ key ++ \" does not exist\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 3, "last_activity_date": 1489874732, "creation_date": 1489874732, "answer_id": 42880433, "question_id": 42879220, "link": "https://stackoverflow.com/questions/42879220/haskell-read-function-overloading-with-two-inputs/42880433#42880433", "title": "Haskell read function overloading with two inputs", "body": "<p>For completeness, I will present a way to do it using <code>read</code>. However, this is very unusual and I would consider it a bad idea, since you can just use <code>lookup</code>.</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts, FlexibleInstances #-}\n\ntype DB = [(String, String)]\n\ninstance Read (DB -&gt; (String, String)) where\n  readsPrec _ = \\key -&gt; let\n    f db = case lookup key db of\n      Just x -&gt; (\"found\", x)\n      Nothing -&gt; (\"not found\", \"data for \" ++ key ++ \" does not exist\")\n    in [(f, \"\")]\n</code></pre>\n\n<p>Here we define an instance of <code>Read</code> for the type <code>DB -&gt; (String, String)</code>. Recall that the <code>read</code> function has type <code>Read a =&gt; String -&gt; a</code>, so this instance gives us an overload of <code>read</code> of type <code>String -&gt; DB -&gt; (String, String)</code>.</p>\n\n<p>Our instance defines the <code>readsPrec</code> function, which has type <code>Read a =&gt; Int =&gt; ReadS a</code>, where <code>ReadS a</code> is an alias for <code>String -&gt; [(a, String)]</code>. So our <code>readsPrec</code> implementation must have type <code>Int -&gt; String -&gt; [(DB -&gt; (String, String), String)]</code>. We don\u2019t care about the \u201cprecedence\u201d argument, so we ignore it with <code>_</code>. And we only care about returning a single result in this instance, so we simply return <code>[(f, \"\")]</code> where <code>f</code> is a function of type <code>DB -&gt; (String, String)</code> that performs the <code>lookup</code> of the <code>key</code> in its argument <code>db</code>.</p>\n\n<p>Now we can use this instance like so:</p>\n\n<pre><code>&gt; read \"foo\" [(\"foo\", \"bar\")] :: (String, String)\n(\"found\",\"bar\")\n\n&gt; read \"baz\" [(\"foo\", \"bar\")] :: (String, String)\n(\"not found\",\"data for baz does not exist\")\n</code></pre>\n\n<p>Again I would stress that this is an unusual instance that may cause confusion in real code\u2014you should just use <code>lookup</code> directly.</p>\n"}], "owner": {"reputation": 134, "user_id": 3960649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/P6lUv.png?s=128&g=1", "display_name": "Dani Feldman", "link": "https://stackoverflow.com/users/3960649/dani-feldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 42880433, "answer_count": 2, "score": 2, "last_activity_date": 1489874732, "creation_date": 1489867285, "question_id": 42879220, "link": "https://stackoverflow.com/questions/42879220/haskell-read-function-overloading-with-two-inputs", "title": "Haskell read function overloading with two inputs", "body": "<p>In my haskell program I have a list that represents a database in <code>[(key, value)]</code> format. For example this is a valid database: <code>[(\"key1\", \"value1\"), (\"key2\", \"value2\"), (\"key3\", \"value3\")]</code>. The <em>key</em> and <em>value</em> data will always have <em>String</em> type.</p>\n\n<p>My question is: is it possible to code the <strong>reading operation</strong> by overloading the <strong>read function</strong> and using that in this way: <code>read dbList \"key1\"</code>? If yes how can I solve this problem? The output needs to be <code>(\"not found\",\"value data for key not exists\")</code> or <code>(\"found\", \"value1\")</code>. </p>\n\n<p>I`ve looked up how can I solve this but all that I found is how to use read function to one input parameter and how to define a new type in order to create an instance of the read for that particular type if it is needed. But I am still curious if I can overload somehow the read function with two input paramaters.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1489861163, "post_id": 42878063, "comment_id": 72859877, "body": "<code>parseListMaybe = sequence . map readMaybe</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1489863828, "post_id": 42878063, "comment_id": 72860894, "body": "or even shorter - <code>traverse readMaybe</code> or <code>mapM readMaybe</code> if you prefer"}], "answers": [{"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 3, "last_activity_date": 1489861132, "creation_date": 1489861132, "answer_id": 42878136, "question_id": 42878063, "link": "https://stackoverflow.com/questions/42878063/reading-integers-from-a-list/42878136#42878136", "title": "Reading integers from a list", "body": "<p>use <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:sequence\" rel=\"nofollow noreferrer\"><code>sequence</code></a> from <code>Control.Monad</code>:</p>\n\n<pre><code>\\&gt; import Control.Monad (sequence)\n\\&gt; import Text.Read (readMaybe)\n\\&gt; sequence (readMaybe &lt;$&gt; [\"1\", \"2\", \"3\"]) :: Maybe [Int]\nJust [1,2,3]\n\\&gt; sequence (readMaybe &lt;$&gt; [\"1\", \"xyz\", \"3\"]) :: Maybe [Int]\nNothing\n</code></pre>\n"}], "owner": {"reputation": 1082, "user_id": 4256283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2dc2b4976c7421d83d6f34770bc36046?s=128&d=identicon&r=PG&f=1", "display_name": "Jytug", "link": "https://stackoverflow.com/users/4256283/jytug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 42878136, "answer_count": 1, "score": 2, "last_activity_date": 1489861132, "creation_date": 1489860767, "question_id": 42878063, "link": "https://stackoverflow.com/questions/42878063/reading-integers-from-a-list", "title": "Reading integers from a list", "body": "<p>I'm facing the following problem in Haskell:</p>\n\n<p>I want to parse such list:\n<code>[\"1\", \"2\", \"3\"]</code> into a <code>Maybe [Int]</code>. What I can do is, using <code>readMaybe</code> from <code>Text.Read</code>, is get a <code>[Maybe Int]</code> int the following way:</p>\n\n<pre><code>parseList :: [String] -&gt; [Maybe Int]\nparseList l = map readMaybe l :: [Maybe Int]\n</code></pre>\n\n<p>I could then do:</p>\n\n<pre><code>parseListMaybe :: [String] -&gt; Maybe [Int]\nparseListMaybe l = if (any isNothing parsed) then Nothing\n                   else (Just $ catMaybes parsed)\n                   where parsed = parseList l\n</code></pre>\n\n<p>But this doesn't seem to me like the most elegant and precise way to solve this. I would appreciate some hints on this</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489854506, "post_id": 42876882, "comment_id": 72857630, "body": "Unless this is an exercise, normals lists can hold functions."}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1489854589, "post_id": 42876882, "comment_id": 72857656, "body": "@Carcigenicate yes, I have to use my custom list"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489854648, "post_id": 42876882, "comment_id": 72857680, "body": "Hint: if <code>Flist a</code> contains <code>a -&gt; a</code> functions, what does <code>Flist (x-&gt;y)</code> contain? Regardless... you shouldn&#39;t have run into the error you quote, you should have earlier run into a clearer to understand error when compiling <code>apply</code>. Let me guess: you didn&#39;t compile it with the type signature? Bad idea..."}], "answers": [{"comments": [{"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489856020, "post_id": 42876984, "comment_id": 72858132, "body": "if I change <code>myFunctions :: Flist (Integer -&gt; Integer) </code> to <code>myFunctions :: Flist Integer </code> I get the error:  * Couldn&#39;t match type <code>Integer -&gt; Integer&#39; with </code>Integer&#39;       Expected type: Flist Integer         Actual type: Flist (Integer -&gt; Integer)  If I understand you correct, I have to change it that way?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489882817, "post_id": 42876984, "comment_id": 72866231, "body": "@jublikon You need to remove the unused <code>y</code> and <code>x</code> arguments from your functions."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1489854939, "creation_date": 1489854939, "answer_id": 42876984, "question_id": 42876882, "link": "https://stackoverflow.com/questions/42876882/haskell-no-instance-for-num-integer-integer-for-function-with-custom-da/42876984#42876984", "title": "Haskell - No instance for (Num (Integer -&gt; Integer)) for function with custom data type", "body": "<p>There are several issues with your code.</p>\n\n<p>You have</p>\n\n<pre><code>data Flist a = Nil | Cons (a -&gt; a) (Flist a)\n--         ^               ^^^^^^\n</code></pre>\n\n<p>So if you have a function <code>f :: Integer -&gt; Integer</code>, then <code>Cons f Nil</code> has type <code>Flist Integer</code>, not <code>Flist (Integer -&gt; Integer)</code>.</p>\n\n<p>In fact, a <code>Flist (Integer -&gt; Integer)</code> would be a list of functions of type <code>(Integer -&gt; Integer) -&gt; (Integer -&gt; Integer)</code>.</p>\n\n<p>That means <code>myFunctions :: Flist (Integer -&gt; Integer)</code> has the wrong type. If you fix that, you'll discover that the code for it isn't quite right either.</p>\n\n<hr>\n\n<p>Then there's <code>apply :: Flist (a -&gt; a) -&gt; b -&gt; b</code>. This is another instance of the above problem (one layer of \"function-ness\" too many). Changing that to <code>apply :: Flist a -&gt; b -&gt; b</code> reveals another problem: You do <code>(f b)</code> where <code>f :: a -&gt; a</code> and <code>b :: b</code>. But <code>a</code> and <code>b</code> are different type variables and (at least potentially) different. To allow this function application, it would have to be <code>apply :: Flist a -&gt; a -&gt; a</code>.</p>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 42876984, "answer_count": 1, "score": 0, "last_activity_date": 1489854939, "creation_date": 1489854321, "last_edit_date": 1489854564, "question_id": 42876882, "link": "https://stackoverflow.com/questions/42876882/haskell-no-instance-for-num-integer-integer-for-function-with-custom-da", "title": "Haskell - No instance for (Num (Integer -&gt; Integer)) for function with custom data type", "body": "<p>I have a custom data type <code>Flist</code> containing functions. In the next step I would like to use the <code>Flist myFunctions</code> in <code>apply</code>. </p>\n\n<p><strong>Note</strong>: This is an exercise, so I have to use a custom list </p>\n\n<pre><code>data Flist a = Nil | Cons (a -&gt; a) (Flist a)\n\nmyFunctions :: Flist (Integer -&gt; Integer)\nmyFunctions = (Cons (\\y x -&gt; x + 1) ( Cons (\\x w -&gt; w + 1) (Nil)))\n\napply :: Flist (a -&gt; a) -&gt; b -&gt; b\napply Nil b         = b\napply (f `Cons` xs) b = apply xs (f b)\n</code></pre>\n\n<p>The call should look like that: <code>apply myFunctions 1</code> returns <code>3</code>   </p>\n\n<p>I get the error: </p>\n\n<blockquote>\n  <ul>\n  <li>No instance for (Num (Integer -> Integer))\n      arising from the literal `2'\n      (maybe you haven't applied a function to enough arguments?)\n  \n  <ul>\n  <li>In the second argument of 'apply', namely '2'\n  In the expression: apply myFunctions 2\n  In an equation for 'it': it = apply myFunctions 2</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p><strong>Question</strong>: I do not see my mistake. Why should I have applied not enough arguments to the function? I pass a Flist with functions that get an Int and return an Int. Additionally another Int is passed and that should be it. What is still missing here?</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1489854584, "post_id": 42876283, "comment_id": 72857650, "body": "Your algorithm description is missing the recursive step. Without it it&#39;s not clear why that input leads to that output."}, {"owner": {"reputation": 1, "user_id": 6706383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb588f345f7a4cf5f20a628918ba629a?s=128&d=identicon&r=PG&f=1", "display_name": "user6706383", "link": "https://stackoverflow.com/users/6706383/user6706383"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1489855001, "post_id": 42876283, "comment_id": 72857792, "body": "The output of a gate will eventually be the input of another gate.I dont know wat to put in the recursive step for it to take all the elements in the list one by one."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1489859480, "post_id": 42876283, "comment_id": 72859298, "body": "It looks like you haven&#39;t thought about what types your functions ought to be, so start there (i.e. add type signatures). Please also post a self-contained example (you haven&#39;t included <code>leafify</code> for instance)"}, {"owner": {"reputation": 1, "user_id": 6706383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb588f345f7a4cf5f20a628918ba629a?s=128&d=identicon&r=PG&f=1", "display_name": "user6706383", "link": "https://stackoverflow.com/users/6706383/user6706383"}, "edited": false, "score": 0, "creation_date": 1489859613, "post_id": 42876283, "comment_id": 72859344, "body": "i forgot to add the leafify function ....the modified version has it...the input and output is mentioned also"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1489860559, "post_id": 42876283, "comment_id": 72859664, "body": "Are you <i>absolutely</i> sure that the result is supposed to be a list of trees? (General tip: solve the problem first, before writing any code. Start with the types.)"}, {"owner": {"reputation": 1, "user_id": 6706383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb588f345f7a4cf5f20a628918ba629a?s=128&d=identicon&r=PG&f=1", "display_name": "user6706383", "link": "https://stackoverflow.com/users/6706383/user6706383"}, "edited": false, "score": 0, "creation_date": 1489861029, "post_id": 42876283, "comment_id": 72859835, "body": "the final result is one node value in the list which is the combination of all the gates and probabilities."}], "owner": {"reputation": 1, "user_id": 6706383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb588f345f7a4cf5f20a628918ba629a?s=128&d=identicon&r=PG&f=1", "display_name": "user6706383", "link": "https://stackoverflow.com/users/6706383/user6706383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489859561, "creation_date": 1489851326, "last_edit_date": 1489859561, "question_id": 42876283, "link": "https://stackoverflow.com/questions/42876283/parse-a-tree-and-get-then-compute-a-final-value-in-haskell", "title": "parse a tree and get then compute a final value in haskell", "body": "<p>Given a list of probabilities (in the form of <code>Float</code>s) and a list of logical operations, (the <code>String</code>s \"and\" and \"or\") the program will find the probability of the event described by combining them into a tree with logical operations at the nodes and probabilities at the leaves.</p>\n\n<p>I am stuck with the code below. The algorithm to parse the lists is:</p>\n\n<ul>\n<li>take 2 values from the probabilities list</li>\n<li>and one value from the operations list</li>\n<li>combine them to create a node like <code>Node \"or\" 0.5 0.6</code> meaning \"The probability of (an event with probability 0.5 occurring OR an event with probability 0.6 occurring)\"</li>\n</ul>\n\n<p>How can I modify the code to properly parse a tree and get then compute a final probability? Example input: <code>asgCode [0.5,0.4,0.5,0.6,0.3] [\"or\",\"or\",\"and\",\"and\"]</code> should be parsed into the tree <code>Node \"and\" (Node \"or\" (Leaf 0.5) (Leaf 0.6)) (Node \"and\" (Leaf 0.3) (Node \"or\" (Leaf 0.5) (Leaf 0.4)))</code></p>\n\n<p>Meaning of the output : (0.5 OR 0.6) AND (0.3 AND (0.5 OR 0.4))</p>\n\n<p>My code so far:</p>\n\n<pre><code>data Tree = Leaf Float | Node String Tree Tree deriving (Show, Eq, Ord)\nleafify [] = []\nleafify (x:xs) = [Leaf x] ++ leafify xs\n\n-- Parse the top node of a tree\nprob (y:z:ys) (x:[])  = [Node x y z] \n\n-- Parse a non-top node of a tree\nprob (y:z:ys) (x:xs) = [Node x y z] ++ prob ys xs\n\n\nasgCode list list2 = prob (leafify list) list2  \n</code></pre>\n"}, {"tags": ["class", "haskell", "higher-kinded-types"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1489845463, "post_id": 42875139, "comment_id": 72854727, "body": "I think you might be looking for <a href=\"https://prime.haskell.org/wiki/FlexibleContexts\" rel=\"nofollow noreferrer\"><code>FlexibleContexts</code></a>, which allows this kind of expression."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1489845608, "post_id": 42875139, "comment_id": 72854769, "body": "On my phone now but you could make an alias <code>type A a = [[a]]</code> and allow instances for aliases"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1489845879, "post_id": 42875139, "comment_id": 72854852, "body": "@jd823592 You can&#39;t do that: with an alias you can only declare instances for <i>fully applied</i> aliases. E.g. <code>instance C (A a)</code> is ok, but <code>instance C A</code> is not."}, {"owner": {"reputation": 992, "user_id": 1579244, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91326e6e4a8829c456ad73e58c3405ed?s=128&d=identicon&r=PG", "display_name": "Blank Chisui", "link": "https://stackoverflow.com/users/1579244/blank-chisui"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1489846815, "post_id": 42875139, "comment_id": 72855133, "body": "@AJFarmar I took a look at those, but couldn&#39;t figure out how to apply them. Could you provide an example?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1489848567, "post_id": 42875139, "comment_id": 72855697, "body": "@BlankChisui In exactly the case described in the question. <code>FlexibleContexts</code> renders such instance declarations valid."}], "answers": [{"comments": [{"owner": {"reputation": 992, "user_id": 1579244, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91326e6e4a8829c456ad73e58c3405ed?s=128&d=identicon&r=PG", "display_name": "Blank Chisui", "link": "https://stackoverflow.com/users/1579244/blank-chisui"}, "edited": false, "score": 0, "creation_date": 1489846223, "post_id": 42875382, "comment_id": 72854947, "body": "The result of the function will actually be something else but it will be depnding on b. I just wanted the signature to be small.  Also a new datatype is not an option."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 992, "user_id": 1579244, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91326e6e4a8829c456ad73e58c3405ed?s=128&d=identicon&r=PG", "display_name": "Blank Chisui", "link": "https://stackoverflow.com/users/1579244/blank-chisui"}, "edited": false, "score": 0, "creation_date": 1489846993, "post_id": 42875382, "comment_id": 72855214, "body": "What you seek is impossible in Haskell: you can have <code>instance C[], instance C [a], instance [[a]]</code> but no <code>instance C [[_]]</code> without a newtype wrapper. However, this might be an XY problem: why do you want to use such an instance and class? Won&#39;t <code>class C b a where f :: b -&gt; a ; instance C [[a]] a</code>, with a suitable class <code>C</code>, be enough? Possibly with some fundep/type family inside to make the type <code>a</code> depend on <code>b</code> ?"}, {"owner": {"reputation": 992, "user_id": 1579244, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91326e6e4a8829c456ad73e58c3405ed?s=128&d=identicon&r=PG", "display_name": "Blank Chisui", "link": "https://stackoverflow.com/users/1579244/blank-chisui"}, "edited": false, "score": 0, "creation_date": 1489847527, "post_id": 42875382, "comment_id": 72855357, "body": "That is actually how I have it implemented currently. The problem is it becomes awkward to use since <code>b</code> and <code>a</code> of <code>C</code> do not have a general connection. So when I have a function with signature <code>C b a =&gt; b a -&gt; X a</code> I have to explicitly bind <code>a</code> and can not derive it from the first argument."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 992, "user_id": 1579244, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91326e6e4a8829c456ad73e58c3405ed?s=128&d=identicon&r=PG", "display_name": "Blank Chisui", "link": "https://stackoverflow.com/users/1579244/blank-chisui"}, "edited": false, "score": 0, "creation_date": 1489849421, "post_id": 42875382, "comment_id": 72855973, "body": "@BlankChisui That&#39;s what fundeps/type families are for. See the edit."}, {"owner": {"reputation": 992, "user_id": 1579244, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91326e6e4a8829c456ad73e58c3405ed?s=128&d=identicon&r=PG", "display_name": "Blank Chisui", "link": "https://stackoverflow.com/users/1579244/blank-chisui"}, "edited": false, "score": 0, "creation_date": 1489853889, "post_id": 42875382, "comment_id": 72857394, "body": "Wow, thanks. That&#39;s exactly what I was looking for. Amazing how deep the type rabbit hole goes."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1489849384, "last_edit_date": 1489849384, "creation_date": 1489845999, "answer_id": 42875382, "question_id": 42875139, "link": "https://stackoverflow.com/questions/42875139/higher-kinded-types-and-type-arguments-for-classes/42875382#42875382", "title": "Higher kinded Types and Type arguments for classes", "body": "<p>You need a <code>newtype</code></p>\n\n<pre><code>class C a where\n    f :: a b -&gt; b  -- the class before the OP edited\n\nnewtype LL a = LL [[a]]\ninstance C LL where\n   f (LL xss) = ...\n</code></pre>\n\n<p>However, it is impossible to write a completely meaningful instance, since if the lists-of-lists is empty, it is impossible to extract an element. the best we could do is</p>\n\n<pre><code>instance C LL where\n   f (LL xss) = case concat xss of\n      (x:_) -&gt; x\n      _     -&gt; error \"f: no elements\"\n</code></pre>\n\n<p>I'm not sure if that is a good idea.</p>\n\n<hr>\n\n<p>As an alternative, you could use type families or functional dependencies. Here's a solution with type families.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, FlexibleInstances #-}\n\nclass C a where\n   type T a\n   f :: a -&gt; Maybe (T a)\n\ninstance C [[b]] where\n   type T [[b]] = b\n   f xss = case concat xss of\n      []    -&gt; Nothing\n      (x:_) -&gt; Just x\n</code></pre>\n"}], "owner": {"reputation": 992, "user_id": 1579244, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91326e6e4a8829c456ad73e58c3405ed?s=128&d=identicon&r=PG", "display_name": "Blank Chisui", "link": "https://stackoverflow.com/users/1579244/blank-chisui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 42875382, "answer_count": 1, "score": 1, "last_activity_date": 1489851285, "creation_date": 1489844698, "last_edit_date": 1489851285, "question_id": 42875139, "link": "https://stackoverflow.com/questions/42875139/higher-kinded-types-and-type-arguments-for-classes", "title": "Higher kinded Types and Type arguments for classes", "body": "<p>Suppose you are using the <a href=\"https://prime.haskell.org/wiki/FlexibleInstances\" rel=\"nofollow noreferrer\"><code>FlexibleInstances</code></a> extension and have the <code>class</code></p>\n\n<pre><code>class C a where\n    f :: a b -&gt; Maybe b\n</code></pre>\n\n<p>how would you implement it for a list of lists of a datatype. In particular, how would the type be written. The only thing I could find is how to do it for a single list, but not a list of lists or lists of any other datatypes.</p>\n\n<p>This works:</p>\n\n<pre><code>instance C [] where\n    ...\n</code></pre>\n\n<p>But this doesn't</p>\n\n<pre><code>data D = ...\n\ninstance C [[D]] where\n    ...\n</code></pre>\n\n<p>How can I express something like this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 2, "creation_date": 1489838627, "post_id": 42874143, "comment_id": 72852684, "body": "This is just saying that you don&#39;t have a Monoid instance for [Char] (or, String, if you prefer). Do you have any? You don&#39;t show it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1489838772, "post_id": 42874143, "comment_id": 72852726, "body": "You have defined your own class <code>Monoid</code>, rather than importing <code>Data.Monoid</code>, where there <i>is</i> an instance of <code>Monoid</code> for <code>[a]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "edited": false, "score": 0, "creation_date": 1489841263, "post_id": 42874263, "comment_id": 72853414, "body": "thanks @chepner your answer is clear and works, Tamas"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "edited": false, "score": 1, "creation_date": 1489881794, "post_id": 42874263, "comment_id": 72866020, "body": "@bling5630, here&#39;s a challenge: write at least three different <code>Monoid</code> instances for lists that behave differently, and prove that each of them satisfies the monoid laws. Some of these instances will have constraints."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1489839159, "creation_date": 1489839159, "answer_id": 42874263, "question_id": 42874143, "link": "https://stackoverflow.com/questions/42874143/no-instance-for-monoid-char-arising-from-a-use-of-mappend/42874263#42874263", "title": "No instance for (Monoid [Char]) arising from a use of `mappend&#39;", "body": "<p>Your code hasn't provided a definition for <code>Monoid [a]</code> (the type of list doesn't matter). Normally, you would import <code>Data.Monoid</code>, where both the class <code>Monoid</code> and many useful instances are defined for you. It is trivial to write an instance, though, to fix your immediate problem. What does it mean to <code>mappend</code> two lists? You just concatenate the two lists.</p>\n\n<pre><code>instance Monoid [a] where\n    mempty = []\n    l1 `mappend` l2 = l1 ++ l2\n</code></pre>\n\n<p>Now you have the instance of <code>Monoid [a]</code> needed to fully implement the definition of <code>Monoid (Maybe [a])</code>.</p>\n"}], "owner": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 42874263, "answer_count": 1, "score": 0, "last_activity_date": 1489839159, "creation_date": 1489838460, "question_id": 42874143, "link": "https://stackoverflow.com/questions/42874143/no-instance-for-monoid-char-arising-from-a-use-of-mappend", "title": "No instance for (Monoid [Char]) arising from a use of `mappend&#39;", "body": "<p>working with learn you Haskell functors applicative functors and monoids chapter and faced with a new problem, my code is here even though I tried to fix the problem I couldn't do it, my code is here:</p>\n\n<pre><code>class Monoid m where  \n    mempty :: m  \n    mappend :: m -&gt; m -&gt; m  \n\ninstance Monoid a =&gt; Monoid (Maybe a) where  \n    mempty = Nothing  \n    Nothing `mappend` m = m  \n    m `mappend` Nothing = m  \n    Just m1 `mappend` Just m2 = Just (m1 `mappend` m2)  \n\nmain = print $ Nothing `mappend` Just \"andy\" \n</code></pre>\n\n<p>and here is the error message that I got:</p>\n\n<pre><code>  No instance for (Monoid [Char]) arising from a use of `mappend'\n    Possible fix: add an instance declaration for (Monoid [Char])\n    In the second argument of `($)', namely\n      `Nothing `mappend` Just \"andy\"'\n    In the expression: print $ Nothing `mappend` Just \"andy\"\n    In an equation for `main':\n        main = print $ Nothing `mappend` Just \"andy\")\n</code></pre>\n\n<p>thank you in advance, Tamas</p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1489835039, "post_id": 42873405, "comment_id": 72851638, "body": "<code>a b c</code> parses as <code>(a b) c</code>, not <code>a (b c)</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 6, "creation_date": 1489835613, "post_id": 42873405, "comment_id": 72851815, "body": "<code>(\\f x -&gt; map x)</code> is a function of two arguments that ignores its first argument. <code>(\\y -&gt; 3 + y)</code> is never applied to anything."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1489841604, "post_id": 42873405, "comment_id": 72853541, "body": "If you&#39;re having trouble with the order in which functions are applied, I&#39;d recommend reading up on functions, from <a href=\"http://learnyouahaskell.com/starting-out#babys-first-functions\" rel=\"nofollow noreferrer\">LYAH.</a> Note that the functions are applied <code>f1 a b</code> akin to <code>f1(a,b)</code>, not <code>f1 f2 a</code> akin to <code>f1(f2(a))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489839636, "post_id": 42874213, "comment_id": 72852991, "body": "I still do not understand why <code>(\\f x -&gt; map x) something g</code> yields <code>map g</code>. Can you add some more detailed explanation, please?"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489839884, "post_id": 42874213, "comment_id": 72853053, "body": "@jublikon added the intermediate step of the beta reduction"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489840168, "post_id": 42874213, "comment_id": 72853118, "body": "@jublikon You need to ask yourself why you included the <code>f</code> in that lambda expression. What&#39;s its purpose?"}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489840279, "post_id": 42874213, "comment_id": 72853152, "body": "It is a task that asks for the output. I did not create the code"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489840569, "post_id": 42874213, "comment_id": 72853219, "body": "@jublikon Is it a &quot;What will this expression be?&quot; type of question?"}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1489846848, "post_id": 42874213, "comment_id": 72855143, "body": "yes, it is a question of the type &quot;what will this expression be?&quot;"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 3, "last_activity_date": 1489841024, "last_edit_date": 1489841024, "creation_date": 1489838839, "answer_id": 42874213, "question_id": 42873405, "link": "https://stackoverflow.com/questions/42873405/haskell-redundant-part-in-function/42874213#42874213", "title": "Haskell - redundant part in function", "body": "<p>It is because it goes the other way round, that is you apply <code>(\\f x -&gt; map x)</code> to <code>(\\y -&gt; 3 + y)</code> first. But </p>\n\n<pre><code>(\\f x -&gt; map x) something g\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>let f = something; x = g in map x\n</code></pre>\n\n<p>And this finally is</p>\n\n<pre><code>map g\n</code></pre>\n\n<p>So <code>something</code> doesn't appear in the resulting expression, since <code>f</code> is not mentioned anywhere right from the arrow.</p>\n\n<p>If I understand you correctly, you want</p>\n\n<pre><code>(\\f x -&gt; map (f . x))\n</code></pre>\n\n<p>Additional note: From your argumentation, it looks like you have not grasped yet how beta reduction works.</p>\n\n<p>For example, even if the expressions would be applied like you think:</p>\n\n<pre><code>(\\y -&gt; 3 + y) (\\z -&gt; 2*z)\n</code></pre>\n\n<p>the result would be</p>\n\n<pre><code>3 + (\\z -&gt; 2*z)\n</code></pre>\n\n<p>No, it is doubtful that this makes any sense, however, it's the way beta reduction works: It gives the part right from the arrow where every occurrence of a parameter is replaced by the actual argument.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489843827, "post_id": 42874915, "comment_id": 72854225, "body": "The &quot;right-associative&quot; examples are still wrong. <code>((\\y -&gt; 3 + y) (\\z -&gt; 2*z))</code> is <i>not</i> <code>(\\w -&gt; 3 + 2*w)</code> but <code>3 + (\\z -&gt; 2*z)</code>. The OP is assuming both 1) right-associativity and 2) application = composition, both of which are false. In your answer, you are still making the second mistake."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489844517, "post_id": 42874915, "comment_id": 72854428, "body": "@chi I see the mistake, thank you, let me correct that."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1489849014, "last_edit_date": 1489849014, "creation_date": 1489843238, "answer_id": 42874915, "question_id": 42873405, "link": "https://stackoverflow.com/questions/42873405/haskell-redundant-part-in-function/42874915#42874915", "title": "Haskell - redundant part in function", "body": "<p>I think you've gone wrong somewhere in the design of your function, but I'll give you an explanation of the mechanics going on here. Stick around for the detailed explanation if you still get stuck understanding.</p>\n\n<h2>Quick answer: Evaluating the expression</h2>\n\n<pre><code>j = ((\\f x -&gt; map x) (\\y -&gt; 3 + y) (\\z -&gt; 2*z)) [1,2,3]\n  = ((\\x -&gt; map x) (\\z -&gt; 2*z)) [1,2,3]\n  = (map (\\z -&gt; 2*z)) [1,2,3] -- f := (\\y -&gt; 3 + y), x := (\\z -&gt; 2*z)\n  = [2,4,6]\n</code></pre>\n\n<p>You may see that when Haskell evaluates <code>(\\f x -&gt; map x) (\\y -&gt; 3 + y)</code>, which it will because function applications are evaluated left-to-right, the substitution <code>f := (\\y -&gt; 3 + y)</code> is made, but <code>f</code> doesn't appear anywhere in the function, so it just becomes <code>(\\x -&gt; map x)</code>.</p>\n\n<h2>Detailed answer: Left (and Right) associative operators</h2>\n\n<p>In Haskell we say that <strong>function application is left associative</strong>. This is to say, when we write a function application, it is evaluated like so:</p>\n\n<pre><code>function arg1 arg2 arg3 = ((function arg1) arg2) arg3\n</code></pre>\n\n<p>No matter what the types of the arguments are. <em>This is called left associative because the brackets are always on the left.</em></p>\n\n<p>You seem to expect your expression to behave like this:</p>\n\n<pre><code>  (\\f x -&gt; map x) (\\y -&gt; 3 + y) (\\z -&gt; 2*z)\n= (\\f x -&gt; map x) ((\\y -&gt; 3 + y) (\\z -&gt; 2*z)) -- Incorrect\n</code></pre>\n\n<p>However, as we've seen, functions associate left, not right as you assumed, and so your expression looks to Haskell like this:</p>\n\n<pre><code>  (\\f x -&gt; map x) (\\y -&gt; 3 + y) (\\z -&gt; 2*z)\n= ((\\f x -&gt; map x) (\\y -&gt; 3 + y)) (\\z -&gt; 2*z)\n= (\\x -&gt; map x) (\\z -&gt; 2*z)                   -- Correct!\n</code></pre>\n\n<p>Notice that the brackets I put in to order the evaluation are on the left, not the right.</p>\n\n<p>However, Haskell has defined a very useful right-associative function application operator, namely <code>($) :: (a -&gt; b) -&gt; a -&gt; b</code>. You could re-write your expression like so to obtain the result you seemed to expect.</p>\n\n<pre><code>  (\\f x -&gt; map x) $ (\\y -&gt; 3 + y) (\\z -&gt; 2*z)\n= (\\f x -&gt; map x) $ ((\\y -&gt; 3 + y) (\\z -&gt; 2*z)) -- Correct, though nonsensical.\n</code></pre>\n\n<p>However, as you'll notice, f still isn't referred to in <code>(\\f x -&gt; map x)</code> and so is ignored entirely. I'm not sure exactly what your goal was in making this function</p>\n\n<h2>Further issue: Lambda expressions &amp; composition</h2>\n\n<p>I realise that another issue may be your understanding of lambda expressions. Consider this function:</p>\n\n<pre><code>f x = x + 2\n</code></pre>\n\n<p>We could re-write this as a lambda expression, like so:</p>\n\n<pre><code>f = \\x -&gt; x+2\n</code></pre>\n\n<p>However, what if we have two arguments? This is what we do:</p>\n\n<pre><code>g x y = x + y\n\ng = \\x -&gt; (\\y -&gt; x+y)\n</code></pre>\n\n<p>The way Haskell models multiple arguments is called <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow noreferrer\"><strong>currying</strong></a>. You can see that the function actually returns another function, which <em>then</em> returns a function that finally returns what it should have. However, this notation is long and cumbersome, so Haskell provides an alternative:</p>\n\n<pre><code>g = \\x y -&gt; x + y\n</code></pre>\n\n<p>This may <em>seem</em> to be different, but in fact it is syntactic sugar for exactly the same expression as before. Now, looking at your first lambda expression:</p>\n\n<pre><code>\\f x -&gt; map x = \\f -&gt; (\\x -&gt; map x)\n</code></pre>\n\n<p>You can see that the argument f isn't actually referred to at all in the function, so if I apply something to it:</p>\n\n<pre><code>  (\\f x -&gt; map x) foo\n= (\\f -&gt; (\\x -&gt; map x)) foo\n= \\x -&gt; map x\n</code></pre>\n\n<p>That's why your <code>(\\y -&gt; 3 + y)</code> is ignored; you haven't actually used it in your functions.</p>\n\n<p>Furthermore, you expect the expression <code>(\\y -&gt; 3 + y) (\\z -&gt; 2*z)</code> to evaluate to <code>\\w -&gt; 3 + 2*w</code>. This is not true. The lambda on the left replaces each occurrence of <code>y</code> with <code>(\\z -&gt; 2*z)</code>, so the result is the completely nonsensical <code>3 + (\\z -&gt; 2*z)</code>. How do you add a function to a number?!</p>\n\n<p>What you're looking for is called <a href=\"https://wiki.haskell.org/Function_composition\" rel=\"nofollow noreferrer\"><strong>composition.</strong></a> We have an operator in Haskell, namely <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)</code> which can help you with this. It takes a function  on the left and the right and creates a new function that 'pipes' the functions into each other. That is to say:</p>\n\n<pre><code>(\\y -&gt; 3 + y) . (\\z -&gt; 2*z) = \\w -&gt; 3 + 2*w\n</code></pre>\n\n<p>Which is what you're looking for.</p>\n\n<h2>Conclusion: Corrected expression</h2>\n\n<p>I think the expression you're looking for is:</p>\n\n<pre><code>j = ( (\\x -&gt; map x) $ (\\y -&gt; 3 + y) . (\\z -&gt; 2*z) ) [1,2,3]\n</code></pre>\n\n<p>Which is equivalent to saying:</p>\n\n<pre><code>j = map (\\w -&gt; 3 + 2*w) [1,2,3]\n</code></pre>\n\n<p>Since you seem to be having a lot of trouble with the more basic parts of Haskell, I'd recommend the quintessential beginner's book, <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\"><strong>Learn You a Haskell for Great Good</strong>.</a></p>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 42874915, "answer_count": 2, "score": 0, "last_activity_date": 1489849014, "creation_date": 1489834462, "last_edit_date": 1489834962, "question_id": 42873405, "link": "https://stackoverflow.com/questions/42873405/haskell-redundant-part-in-function", "title": "Haskell - redundant part in function", "body": "<p>I have an intricate <code>Haskell</code> function:</p>\n\n<pre><code>j :: [Int]\nj = ((\\f x -&gt; map x) (\\y -&gt; 3 + y) (\\z -&gt; 2*z)) [1,2,3]\n</code></pre>\n\n<p>My guess was that <code>(\\y -&gt; 3 + y) (\\z -&gt; 2*z)</code> will change to <code>(\\w -&gt; 3 + 2*w)</code> and together with <code>f</code> there should be print out the list <code>[5,7,9]</code>.</p>\n\n<p>When I checked with ghci I got <code>[2,4,6]</code> as a result.</p>\n\n<p><strong>Question</strong>: So is <code>(\\y -&gt; 3 + y)</code> a redundant expression here? If so, why?</p>\n"}, {"tags": ["google-chrome", "haskell", "archlinux", "xmonad"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1491757024, "post_id": 42873367, "comment_id": 73683402, "body": "It would be helpful to include your config"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5724657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ypcijb-oHw0/AAAAAAAAAAI/AAAAAAAAEcc/Y0r_h5If6Lk/photo.jpg?sz=128", "display_name": "Kuan-Ying Chou", "link": "https://stackoverflow.com/users/5724657/kuan-ying-chou"}, "edited": false, "score": 0, "creation_date": 1492103116, "post_id": 43220670, "comment_id": 73856781, "body": "Thanks for the suggestion. This &quot;Toggle UI&quot; function in Vivaldi is a pretty good workaround. I only hope it can handle the full-screen button on sites like Youtube or Vimeo as well."}], "tags": [], "owner": {"reputation": 143, "user_id": 6030703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a83fc8e2101100fe71878cdfabf2702?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Harris", "link": "https://stackoverflow.com/users/6030703/jonathan-harris"}, "is_accepted": false, "score": 1, "last_activity_date": 1491389531, "last_edit_date": 1491389531, "creation_date": 1491358437, "answer_id": 43220670, "question_id": 42873367, "link": "https://stackoverflow.com/questions/42873367/how-to-make-chrome-scale-correctly-in-full-screen-mode-in-xmonad/43220670#43220670", "title": "How to make Chrome scale correctly in full screen mode in Xmonad", "body": "<p>This problem has bothered me for a while too. I tried all sorts of combinations in my xmonad config file but with no luck. But I've recently found 'Vivaldi', a browser based on the Chromium engine and headed by the ex-CEO of the Opera browser. It achieves exactly what you want by using the 'Toggle UI' option (by default, Ctrl-F11).</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5724657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ypcijb-oHw0/AAAAAAAAAAI/AAAAAAAAEcc/Y0r_h5If6Lk/photo.jpg?sz=128", "display_name": "Kuan-Ying Chou", "link": "https://stackoverflow.com/users/5724657/kuan-ying-chou"}, "edited": false, "score": 1, "creation_date": 1492103891, "post_id": 43309332, "comment_id": 73857182, "body": "This setting would make XMonad behave like other desktop environments or OSes and make Chrome to fit to the entire screen, which may be what most people want. However, I&#39;m trying to make Chrome stay in its window in full-screen mode, so that we can, say, put 2 full &quot;screen&quot; Youtube videos side by side in the same screen."}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 101, "user_id": 5724657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ypcijb-oHw0/AAAAAAAAAAI/AAAAAAAAEcc/Y0r_h5If6Lk/photo.jpg?sz=128", "display_name": "Kuan-Ying Chou", "link": "https://stackoverflow.com/users/5724657/kuan-ying-chou"}, "edited": false, "score": 0, "creation_date": 1492120958, "post_id": 43309332, "comment_id": 73865314, "body": "It&#39;s a bit of a hack but you could use something like xbindkeys and xdotool to bind F12 to (F11)+(Mod+space), so essentially automate what you&#39;re doing manually."}], "tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 0, "last_activity_date": 1491756990, "last_edit_date": 1491756990, "creation_date": 1491756633, "answer_id": 43309332, "question_id": 42873367, "link": "https://stackoverflow.com/questions/42873367/how-to-make-chrome-scale-correctly-in-full-screen-mode-in-xmonad/43309332#43309332", "title": "How to make Chrome scale correctly in full screen mode in Xmonad", "body": "<p>You need to add the following to your config (xmonad.hs):</p>\n\n<pre><code>import XMonad.Hooks.EwmhDesktops\nmain = xmonad $ ewmh (yourExistingConfigValueGoesHereExample { handleEventHook =\n       handleEventHook def &lt;+&gt; fullscreenEventHook })\n</code></pre>\n\n<p>More information can be found here: <a href=\"http://xmonad.org/xmonad-docs/xmonad-contrib/XMonad-Hooks-EwmhDesktops.html\" rel=\"nofollow noreferrer\">http://xmonad.org/xmonad-docs/xmonad-contrib/XMonad-Hooks-EwmhDesktops.html</a></p>\n\n<hr>\n\n<p>This functionality is also bundled into desktopConfig (a sort of sane default for xmonad). <a href=\"https://hackage.haskell.org/package/xmonad-contrib-0.13/docs/XMonad-Config-Desktop.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/xmonad-contrib-0.13/docs/XMonad-Config-Desktop.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 28145, "user_id": 501187, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2bf8dee0b3c004589b62a9b0db09b04a?s=128&d=identicon&r=PG", "display_name": "Fresheyeball", "link": "https://stackoverflow.com/users/501187/fresheyeball"}, "is_accepted": false, "score": 1, "last_activity_date": 1550868683, "creation_date": 1550868683, "answer_id": 54834962, "question_id": 42873367, "link": "https://stackoverflow.com/questions/42873367/how-to-make-chrome-scale-correctly-in-full-screen-mode-in-xmonad/54834962#54834962", "title": "How to make Chrome scale correctly in full screen mode in Xmonad", "body": "<p>My solution is to use this modified version of <code>fullscreenEventHook</code> from <code>EWMH</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fullscreenEventHook :: Event -&gt; Bool -&gt; X All\nfullscreenEventHook (ClientMessageEvent _ _ _ dpy win typ (action:dats)) isChrome = do\n  wmstate &lt;- getAtom \"_NET_WM_STATE\"\n  fullsc &lt;- getAtom \"_NET_WM_STATE_FULLSCREEN\"\n  wstate &lt;- fromMaybe [] `fmap` getProp32 wmstate win\n\n  let isFull = fromIntegral fullsc `elem` wstate\n\n      -- Constants for the _NET_WM_STATE protocol:\n      remove = 0\n      add = 1\n      toggle = 2\n      ptype = 4 -- The atom property type for changeProperty\n      chWstate f = io $ changeProperty32 dpy win wmstate ptype propModeReplace (f wstate)\n\n      uglyChromeHack x = do\n        when (not isChrome) x\n        when isChrome $ windows W.swapUp &gt;&gt; windows W.swapDown\n\n  when (typ == wmstate &amp;&amp; fi fullsc `elem` dats) $ do\n    when (action == add || (action == toggle &amp;&amp; not isFull)) $ do\n      chWstate (fi fullsc:)\n      uglyChromeHack $ windows $ W.float win $ W.RationalRect 0 0 1 1\n    when (action == remove || (action == toggle &amp;&amp; isFull)) $ do\n      chWstate $ delete (fi fullsc)\n      uglyChromeHack $ windows $ W.sink win\n\n  return $ All True\n\nfullscreenEventHook _ _ = return $ All True\n\n\nbutNotChrome :: Event -&gt; X All\nbutNotChrome e@(ClientMessageEvent _ _ _ _ win _ _) = do\n  isChrome &lt;- runQuery (appName =? \"google-chrome\") win\n  fullscreenEventHook e isChrome\nbutNotChrome _ = return $ All True\n</code></pre>\n\n<p>This bit <code>windows W.swapUp &gt;&gt; windows W.swapDown</code> seems to kick chrome just hard enough.</p>\n"}], "owner": {"reputation": 101, "user_id": 5724657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ypcijb-oHw0/AAAAAAAAAAI/AAAAAAAAEcc/Y0r_h5If6Lk/photo.jpg?sz=128", "display_name": "Kuan-Ying Chou", "link": "https://stackoverflow.com/users/5724657/kuan-ying-chou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1550868683, "creation_date": 1489834198, "last_edit_date": 1489894441, "question_id": 42873367, "link": "https://stackoverflow.com/questions/42873367/how-to-make-chrome-scale-correctly-in-full-screen-mode-in-xmonad", "title": "How to make Chrome scale correctly in full screen mode in Xmonad", "body": "<p>When I enter full screen mode with the F11 key, or click the full screen button in Youtube or Netflix, Chrome seems to scale the page to fit the size of the screen, and the page would be cropped to its containing window. However, after toggling the layout with mod + space, it then scales to fit the containing window correctly. </p>\n\n<p>How do I make Chrome's scaling to fit its window instead of the entire screen when first entering full screen mode? </p>\n\n<p>I tried the functions in <code>XMonad.Hooks.EwmhDesktops</code> and <code>XMonad.Layout.Fullscreen</code> but still couldn't figure out a way. </p>\n\n<p>I'm using Google Chrome 57.0.2987.98 and xmonad 0.13 on Arch. Thanks!</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "is_accepted": false, "score": 3, "last_activity_date": 1489834045, "creation_date": 1489834045, "answer_id": 42873340, "question_id": 42873296, "link": "https://stackoverflow.com/questions/42873296/haskell-ambiguous-occurrence-when-defining-a-vector/42873340#42873340", "title": "Haskell Ambiguous Occurrence (+) when defining a vector", "body": "<p>The answer is simple: you're trying to overload the + operator, which is already defined in the Prelude.</p>\n\n<p>Haskell doesn't <em>technically</em> allow operator overloading the way most other languages do, so you can't just define a new function called <code>+</code> because this function is already used for adding scalar numbers together.</p>\n\n<p>Instead you could try calling it something else, like <code>addV</code>, or maybe <code>&gt;+&lt;</code> or something</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1489836586, "post_id": 42873409, "comment_id": 72852105, "body": "+1 for <i>not</i> recommending a <code>Num</code> instance, but <code>Monoid</code> is also not that great IMO as it doesn&#39;t allow scalar multiplication."}], "tags": [], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "is_accepted": false, "score": 3, "last_activity_date": 1489834494, "creation_date": 1489834494, "answer_id": 42873409, "question_id": 42873296, "link": "https://stackoverflow.com/questions/42873296/haskell-ambiguous-occurrence-when-defining-a-vector/42873409#42873409", "title": "Haskell Ambiguous Occurrence (+) when defining a vector", "body": "<p>I tried going around by</p>\n\n<pre><code>import Prelude hiding ((+), length)\n</code></pre>\n\n<p>but then you don't have access to addition anymore. I'd recommend going the <code>Monoid</code> route here. I'd rename <code>length</code> to <code>vlength</code> or similar, because IIRC there's no direct concept of that in any typeclass.</p>\n\n<pre><code>import Data.Monoid\n\ndata Vec3 = Vec3 {\n    x :: Float,\n    y :: Float,\n    z :: Float\n} deriving (Eq,Show)\n\ninstance Monoid Vec3 where\n  mappend (Vec3 a b c) (Vec3 t u w) = Vec3 (a+t) (b+u) (c+w)\n  mempty = Vec3 0 0 0\n\nvlength :: Vec3 -&gt; Float\nvlength (Vec3 a b c) = sqrt( a*a + b*b + c*c )\n\nvv = Vec3 1.5 0.7 2.2\nv2 = Vec3 1.0 2.7 3.4\n\nmain :: IO ()\nmain = do\n  print $ vv &lt;&gt; v2\n  print $ vlength vv\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1489836983, "last_edit_date": 1495542322, "creation_date": 1489836983, "answer_id": 42873863, "question_id": 42873296, "link": "https://stackoverflow.com/questions/42873296/haskell-ambiguous-occurrence-when-defining-a-vector/42873863#42873863", "title": "Haskell Ambiguous Occurrence (+) when defining a vector", "body": "<p>To literally overload the <code>+</code> operator, you would need to define a <code>Num</code> instance, like</p>\n\n<pre><code>instance Num Vec3 where\n  Vec3 a b c + Vec3 t u w = Vec3 (a+t) (b+u) (c+w)\n  Vec3 a b c * Vec3 t u w = ...\n</code></pre>\n\n<p>This is in fact what the <a href=\"http://hackage.haskell.org/package/linear-1.20.5/docs/Linear-V3.html\" rel=\"nofollow noreferrer\">linear</a> and <a href=\"http://hackage.haskell.org/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Data.html#g:2\" rel=\"nofollow noreferrer\">hmatrix</a> libraries do for their vector types, as does (basically) also the highly popular <a href=\"http://www.numpy.org/\" rel=\"nofollow noreferrer\">NumPy</a> Python framework.</p>\n\n<p>I would strongly recommend <em>against</em> this, because the semantics of vector spaces are in quite some sense incompatible with those of plain scalar numbers. In particular, you need to define multiplication here; the only way that properly works with these type signatures is component-wise, like with Matlab's <code>.*</code> operator</p>\n\n<pre><code>  Vec3 a b c * Vec3 t u w = Vec3 (a*t) (b*u) (c*w)\n</code></pre>\n\n<p>but that doesn't make mathematically sense for vectors as such, only for the expansion of vectors <em>in a particular basis</em>. Also it leads easily to bugs if you can erroneously define a vector as a single number (which in <code>linear</code> pastes the number into all vector components, urgh!)</p>\n\n<p>A better fit is the <code>Monoid</code> class, as <a href=\"https://stackoverflow.com/a/42873409/745903\">suggested by Reaktormonk</a>. However you'll probably find yourself also wanting a scaling operation</p>\n\n<pre><code>(*^) :: Float -&gt; Vec3 -&gt; Vec3\n\u03bc *^ Vec3 t u w = Vec3 (\u03bc*t) (\u03bc*u) (\u03bc*w)\n</code></pre>\n\n<p>(unlike component-wise multiplication, <a href=\"https://en.wikipedia.org/wiki/Vector_space#Definition\" rel=\"nofollow noreferrer\">this <em>is</em> defined for any vector space</a>), and <code>Monoid</code> doesn't offer this.</p>\n\n<p>The correct class for this sort of type is <a href=\"http://hackage.haskell.org/package/vector-space-0.10.4/docs/Data-VectorSpace.html\" rel=\"nofollow noreferrer\"><code>VectorSpace</code></a>.</p>\n\n<pre><code>instance AdditiveGroup Vec3 where\n  Vec3 a b c ^+^ Vec3 t u w = Vec3 (a+t) (b+u) (c+w)\n  negateV v = (-1)*^v\ninstance VectorSpace Vec3 where\n  type Scalar Vec3 = Float\n  \u03bc *^ Vec3 t u w = Vec3 (\u03bc*t) (\u03bc*u) (\u03bc*w)\n</code></pre>\n"}], "owner": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 42873863, "answer_count": 3, "score": 3, "last_activity_date": 1489836983, "creation_date": 1489833767, "question_id": 42873296, "link": "https://stackoverflow.com/questions/42873296/haskell-ambiguous-occurrence-when-defining-a-vector", "title": "Haskell Ambiguous Occurrence (+) when defining a vector", "body": "<p>I would like to define a 3D vector, with <code>x, y, z</code> coordinates. Vectors can be added using the <code>(+)</code> operator and the length can be calculated using the <code>length</code> function</p>\n\n<p>I get the following error, if I would like to compile it:</p>\n\n<pre><code>It could refer to either `Prelude.+',\n                             imported from `Prelude' at hello.hs:1:1\n                             (and originally defined in `GHC.Num')\n                          or `Main.+', defined at hello.hs:9:14\n</code></pre>\n\n<p>The code is:</p>\n\n<pre><code>data Vec3 = Vec3 {\n    x :: Float,\n    y :: Float,\n    z :: Float\n} deriving (Eq,Show)\n\n(+) :: Vec3 -&gt; Vec3 -&gt; Vec3\n(Vec3 a b c) + (Vec3 t u w) = Vec3 (a+t) (b+u) (c+w)\n\nlength :: Vec3 -&gt; Float\nlength (Vec3 a b c) = sqrt( a*a + b*b + c*c )\n\nvv = Vec3 1.5 0.7 2.2\n\nmain :: IO ()\nmain = do\n  print $ length vv\n</code></pre>\n"}, {"tags": ["haskell", "monad-transformers", "continuations", "arrows", "category-theory"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1489867471, "post_id": 42873249, "comment_id": 72862059, "body": "A free arrow would surely do the trick.  Then you just have to do some junk to make it efficient."}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 3, "answer_count": 0, "score": 11, "last_activity_date": 1489833422, "creation_date": 1489833422, "last_edit_date": 1495541376, "question_id": 42873249, "link": "https://stackoverflow.com/questions/42873249/is-there-something-like-a-continuation-arrow-transformer", "title": "Is there something like a continuation Arrow transformer?", "body": "<p>The <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Cont.html#v:ContT\" rel=\"nofollow noreferrer\"><code>ContT</code></a> monad transformer has a interesting property: If there is a <code>* -&gt; *</code> type such as <code>Set</code>, that has well-defined monadic operations, but can't have a <code>Monad</code> instance due to some constraints (here <code>Ord a</code>), it's possible to wrap it in <code>ContT</code> (<code>ContT r Set</code>) to get a monad instance, and defer the constraints outside it, like when we inject <code>Set</code> into <code>ContT r Set</code>.\nSee <a href=\"https://stackoverflow.com/q/12183656/1333025\">Constructing efficient monad instances on <code>Set</code> using the continuation monad</a>.</p>\n\n<p>Is there something similar for arrows? An <a href=\"https://hackage.haskell.org/package/arrows-0.4.4.1/docs/Control-Arrow-Transformer.html#t:ArrowTransformer\" rel=\"nofollow noreferrer\">arrow transformer</a> that'd allow to wrap an \"almost arrow\" into it, getting a valid <code>Arrow</code> instance, and defer problematic constraints to the part where we inject the \"almost arrow\" into it?</p>\n\n<p>For example, if we had a type <code>AlmostArrow :: * -&gt; * -&gt; *</code> for which we'd have the usual <code>Arrow</code> operations, but with constraints, such as</p>\n\n<pre><code>arr' :: (Ord a, Ord b) =&gt; (a -&gt; b) -&gt; AlmostArrow a b\n(&gt;&gt;&gt;') :: (Ord a, Ord b, Ord c) =&gt; AlmostArrow a b -&gt; AlmostArrow b c -&gt; AlmostArrow a c\n</code></pre>\n\n<p>As a bonus, if yes, is there some nifty, generic category-theory way how to derive both <code>ContT</code> and such an arrow transformer?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1489841045, "post_id": 42873241, "comment_id": 72853345, "body": "First thanks so much for the awesome explanation. The first with infinite type I&#39;ve got it but the second I do not understand. Can you please expand like the first?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1489853264, "post_id": 42873241, "comment_id": 72857154, "body": "We do <code>f x</code>. So <code>f</code> is called with <code>x</code> as input. So <code>f</code> must be a function, who&#39;s input type matches the type of <code>x</code> (whatever that is). Now we do <code>f (f x)</code>, so whatever the output type of <code>f x</code> is, it must match the input type of <code>f</code>. Hence, input and output types as the same."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1489854493, "post_id": 42873241, "comment_id": 72857622, "body": "Thanks so much @MathematicalOrchid for your help."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 6, "last_activity_date": 1489833398, "creation_date": 1489833398, "answer_id": 42873241, "question_id": 42872735, "link": "https://stackoverflow.com/questions/42872735/passing-function-to-function-generate-infinite-type/42873241#42873241", "title": "passing function to function generate infinite type", "body": "<pre><code>doWork f x = f f x\n</code></pre>\n\n<p><code>doWork</code> takes two arguments, <code>f</code> and <code>x</code>.</p>\n\n<pre><code>f f x\n</code></pre>\n\n<p>We call <code>f</code> with two arguments, so <code>f</code> must be a function.</p>\n\n<pre><code>f :: a -&gt; b -&gt; c\n</code></pre>\n\n<p>Now, what are <code>a</code>, <code>b</code> and <code>c</code>? Well, <code>c</code> is whatever the result type of the whole thing is. <code>b</code> is the type of <code>x</code>. And <code>a</code> is... the type of <code>f</code> itself. But that means that <code>a == a -&gt; b -&gt; c</code>. If you replace <code>a</code> with <code>a -&gt; b -&gt; c</code>, you get</p>\n\n<pre><code>f :: (a -&gt; b -&gt; c) -&gt; b -&gt; c\n</code></pre>\n\n<p>But that still has <code>a</code> in it. If we replace again, we get</p>\n\n<pre><code>f :: ((a -&gt; b -&gt; c) -&gt; b -&gt; c) -&gt; b -&gt; c\nf :: (((a -&gt; b -&gt; c) -&gt; b -&gt; c) -&gt; b -&gt; c) -&gt; b -&gt; c\n</code></pre>\n\n<p>and so on, forever. The trouble is, <code>a == a -&gt; b -&gt; c</code> defines <code>a</code> as a type that mentions itself - an infinite type loop. And that's not allowed.</p>\n\n<hr>\n\n<p>If, on the other hand, we have</p>\n\n<pre><code>f (f x)\n</code></pre>\n\n<p>then <code>f</code> is a 1-argument function</p>\n\n<pre><code>f :: a -&gt; b\n</code></pre>\n\n<p>Since the output of the inner-<code>f</code> is passed as input to the outer-<code>f</code>, both types must be identical: <code>a == b</code></p>\n\n<pre><code>f :: b -&gt; b\n</code></pre>\n\n<p>And that's a perfectly sensible type. So there's no problem here.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 42873241, "answer_count": 1, "score": 0, "last_activity_date": 1489833398, "creation_date": 1489830027, "question_id": 42872735, "link": "https://stackoverflow.com/questions/42872735/passing-function-to-function-generate-infinite-type", "title": "passing function to function generate infinite type", "body": "<p>I make a mistack and wrote a function like this: </p>\n\n<pre><code>Prelude&gt; doWork f x = f f x\n</code></pre>\n\n<p>and I've got a compiler error:  </p>\n\n<pre><code>&lt;interactive&gt;:3:16: error:\n    \u2022 Occurs check: cannot construct the infinite type:\n        t ~ t -&gt; t1 -&gt; t2\n    \u2022 In the first argument of \u2018f\u2019, namely \u2018f\u2019\n      In the expression: f f x\n      In an equation for \u2018doWork\u2019: doWork f x = f f x\n    \u2022 Relevant bindings include\n        x :: t1 (bound at &lt;interactive&gt;:3:10)\n        f :: t -&gt; t1 -&gt; t2 (bound at &lt;interactive&gt;:3:8)\n        doWork :: (t -&gt; t1 -&gt; t2) -&gt; t1 -&gt; t2 (bound at &lt;interactive&gt;:3:1)\n</code></pre>\n\n<p>I want to know, why apply <code>f</code> to argument <code>f</code> generate a infinite type? Is it like a recursion?</p>\n\n<p>The correct code would be: </p>\n\n<pre><code>Prelude&gt; doWork f x = f (f x)\n</code></pre>\n\n<p>Please attention, that I am just starting learning haskell and explain me as I am a dummy.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "edited": false, "score": 0, "creation_date": 1489805852, "post_id": 42869894, "comment_id": 72845795, "body": "you are correct, but I realized that what I wrote doesnt make sense for what I&#39;m trying to accomplish.  I want to iterate over all the x or points in the list &quot;points&quot; and for each point in the list call lineSide edge x and determine if the value returned is greater than or equal to or less than or equal to 0.  Thanks for your help.  You can check my edits above for what I changed."}, {"owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "edited": false, "score": 0, "creation_date": 1489806219, "post_id": 42869894, "comment_id": 72845846, "body": "It compiles now, but the method fails."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "edited": false, "score": 0, "creation_date": 1489806675, "post_id": 42869894, "comment_id": 72845929, "body": "This is not a good use case for list comprehensions. I would use <code>all ((&gt;=0) . lineSide edge) points</code> as the condition (<a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:all\" rel=\"nofollow noreferrer\">all from Prelude</a>)"}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1489807094, "last_edit_date": 1489807094, "creation_date": 1489804963, "answer_id": 42869894, "question_id": 42869773, "link": "https://stackoverflow.com/questions/42869773/type-error-regarding-the-function-ishulledge-haskell/42869894#42869894", "title": "Type error regarding the function isHullEdge, Haskell", "body": "<p>You probably meant <code>length [ c | x &lt;- points, c &lt;- lineSide edge x]</code> instead of just <code>[ c | x &lt;- points, c &lt;- lineSide edge x]</code>. A list equaling <code>0</code> doesn't make any sense. Side note, checking if the length is zero is bad; it's an O(n) computation. Use <code>null</code> to check your list for emptiness, as it is O(1) for lists.</p>\n\n<p>Using <code>all ((&gt;=0) . lineSide edge) points</code> as your condition is a more idiomatic solution. You should only ever use list comprehensions when you actually want to use a list for something, not to do tests like these. Note that <code>all f xs = foldl (\\a x -&gt; if f x then a else False) True xs</code></p>\n"}], "owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489807094, "creation_date": 1489803679, "last_edit_date": 1489806200, "question_id": 42869773, "link": "https://stackoverflow.com/questions/42869773/type-error-regarding-the-function-ishulledge-haskell", "title": "Type error regarding the function isHullEdge, Haskell", "body": "<p>I am trying to figure out the best way to complete the function isHullEdge.  I currently am trying to do it using a list comprehension, but I am getting a type error.  I'm still a beginner with Haskell so I'm having trouble understanding the stack trace to figure out what needs to be fixed.   </p>\n\n<pre><code>type Edge a = (Point a, Point a)\n\n-- Given an edge (that determines a line), say whether, as one moves along the\n-- edge from its first to its second point, one must turn right (1) or left (-1)\n-- to get to the point, or whether the point is on the line itself (0).\nlineSide :: Real a =&gt; Edge a -&gt; Point a -&gt; a\nlineSide ((e1x,e1y),(e2x,e2y)) (px,py) = signum ((px-e1x)*(e2y-e1y) - (e2x-e1x)*(py-e1y))\n\n-- isHullEdge returns true just in case all points are on the same side of or\n-- on the line determined by an edge.\nisHullEdge :: Real a =&gt; [Point a] -&gt; Edge a -&gt; Bool\nisHullEdge points edge | length points == 0 = True\n                       | length [x | x &lt;- points, lineSide edge x &gt;= 0 || lineSide edge x &lt;= 0] == length points = True\n                       | otherwise = False\n</code></pre>\n\n<hr>\n\n<pre><code>mod11PA.hs:54:50: error:\n* Couldn't match expected type `[t0]' with actual type `a'\n  `a' is a rigid type variable bound by\n    the type signature for:\n      isHullEdge :: forall a. Real a =&gt; [Point a] -&gt; Edge a -&gt; Bool\n    at mod11PA.hs:52:15\n* In the expression: lineSide edge x\n  In a stmt of a list comprehension: c &lt;- lineSide edge x\n  In the first argument of `(==)', namely\n    `[c | x &lt;- points, c &lt;- lineSide edge x]'\n* Relevant bindings include\n    x :: Point a (bound at mod11PA.hs:54:32)\n    edge :: Edge a (bound at mod11PA.hs:53:19)\n    points :: [Point a] (bound at mod11PA.hs:53:12)\n    isHullEdge :: [Point a] -&gt; Edge a -&gt; Bool\n      (bound at mod11PA.hs:53:1)\n</code></pre>\n"}, {"tags": ["git", "haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489801251, "post_id": 42869297, "comment_id": 72845036, "body": "Have a look at the <a href=\"https://hackage.haskell.org/package/github-0.15.0\" rel=\"nofollow noreferrer\"><i>github</i></a> package, which didn&#39;t exist back when that question was asked."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1489801926, "post_id": 42869297, "comment_id": 72845161, "body": "I actually meant &quot;git&quot; not &quot;github&quot; (I&#39;ve now edited the title) but yes that package maybe useful for me too thanks!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1489803401, "post_id": 42869297, "comment_id": 72845425, "body": "Another possibility is using <a href=\"https://hackage.haskell.org/package/turtle-1.3.2\" rel=\"nofollow noreferrer\"><i>turtle</i></a> to write your shell scripts in Haskell without the fiddliness. Here is <a href=\"https://github.com/duplode/duplode.github.io/blob/5dad6f2c6d549d81f883654094a61907c3d420b3/src/Scripts.hs#L30\" rel=\"nofollow noreferrer\">a piece of code</a> in which I used it for the exact same purpose that you describe."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1489803413, "post_id": 42869297, "comment_id": 72845427, "body": "I looked a month ago and was disappointed.  Sadly, this is off-topic for StackOverflow. The Haskell subreddit might be a more fitting place to ask."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1489806706, "creation_date": 1489806706, "answer_id": 42870051, "question_id": 42869297, "link": "https://stackoverflow.com/questions/42869297/programatic-interface-to-git-commands/42870051#42870051", "title": "Programatic interface to git commands", "body": "<p>This may not be exactly what you are looking for, but you can use <code>shell-conduit</code> to do it. It uses Template Haskell to give you a function named <code>git</code> to which you can pass appropriate parameters.</p>\n\n<p>A sample working code:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n     --resolver lts-8.5\n     --install-ghc\n     runghc\n     --package shell-conduit-4.6.1\n -}\n\n{-#LANGUAGE ExtendedDefaultRules#-}\n\nimport Data.Conduit.Shell\n\nclone :: Segment ()\nclone = do\n  echo \"Going to clone...\"\n  git \"clone\" [\"--depth\", \"1\", \"https://github.com/yesodweb/yesod-cookbook.git\"]\n\nmain :: IO ()\nmain = run clone\n</code></pre>\n\n<p>Note that the above code will only work with <code>shell-conduit</code> version >= 4.6.0. If you are using a older version, you cannot pass list to the <code>git</code> function. Instead you had to do it like this:</p>\n\n<pre><code>git \"clone\" \"--depth\" \"1\" \"https://github.com/yesodweb/yesod-cookbook.git\"\n</code></pre>\n\n<p>The new version accepts both way of doing things.</p>\n\n<p>Full Disclaimer: I'm the current maintainer of shell-conduit.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489806706, "creation_date": 1489799019, "last_edit_date": 1495541373, "question_id": 42869297, "link": "https://stackoverflow.com/questions/42869297/programatic-interface-to-git-commands", "title": "Programatic interface to git commands", "body": "<p>I saw this <a href=\"https://stackoverflow.com/a/6611686\">this answer</a> to a question regarding packages to manipulate github repos, but after going though all the packages listed in the answer I can't see a way to say do a simple <code>git add</code>. I basically just want to emulate what I'm doing in git using a shell script at the moment but using Haskell so I don't need to directly call <a href=\"https://hackage.haskell.org/package/process-1.6.0.0/docs/System-Process.html#v:createProcess\" rel=\"nofollow noreferrer\"><code>createProcess</code></a> to call command line git and do other fiddly things.</p>\n\n<p>It seems the libraries are intended for a more lower level manipulation of git. Is this true or am I just missing something?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489793842, "post_id": 42868646, "comment_id": 72843420, "body": "<code>distance</code> asks for <b>two <code>Pair</code>s</b>, you only feed it <b>one</b> (since you write <code>distance (p1,p2)</code>)... So Haskell &quot;complains&quot; that you should give <code>distance</code> a second argument."}, {"owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489794283, "post_id": 42868646, "comment_id": 72843543, "body": "@WillemVanOnsem the distance formula takes two Points, a Pair is 2 points so I&#39;m confused as to why its saying that? Am I missing something/"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1489795396, "post_id": 42868646, "comment_id": 72843851, "body": "look at the signatures.  <code>distance :: Point a -&gt; Point a -&gt; ..</code>  <code>(p1, p2)</code> is not the same as <code>p1 p2</code>"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1489795448, "post_id": 42868646, "comment_id": 72843863, "body": "Yup.  You&#39;re passing distance a <i>pair</i> of points, not passing it a point and another point.  You mean <code>distance p1 p2</code>, I think."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "edited": false, "score": 0, "creation_date": 1489797871, "post_id": 42868995, "comment_id": 72844398, "body": "Ahh I see what you&#39;re saying that makes much more sense now.  I&#39;m doing way more work than I needed to. Thank you."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1489796385, "creation_date": 1489796385, "answer_id": 42868995, "question_id": 42868646, "link": "https://stackoverflow.com/questions/42868646/determining-closest-pair-of-points-using-distance-function-haskell/42868995#42868995", "title": "Determining closest pair of points using distance function, Haskell", "body": "<p>You've already posted a correctly working implementation</p>\n\n<pre><code>closerPair ((x,y),(x1,y1)) ((x2,y2),(x3,y3))\n  | distance (x,y) (x1,y1) &gt;   distance (x2,y2) (x3,y3) = ((x2,y2),(x3,y3))\n  | otherwise = ((x,y),(x1,y1))\n</code></pre>\n\n<p>But note that there's no reason to actually pattern-match the <code>Point</code>-coordinates here: you're just putting back <code>x1,y1</code> and <code>x2,y2</code>... anyway. Thus why not just write it as</p>\n\n<pre><code>closerPair (p\u2080,p\u2081) (p\u2082,p\u2083)\n  | distance p\u2080 p\u2081 &gt; distance p\u2082 p\u2083 = (p\u2082,p\u2083)\n  | otherwise                       = (p\u2080,p\u2081)\n</code></pre>\n\n<p>Incidentally, this can be written in terms of standard functions:</p>\n\n<pre><code>import Data.List (minimumBy)\nimport Data.Ord (comparing)\n\ncloserPair v w = minimumBy (comparing $ uncurry distance) [v,w]\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 42868995, "answer_count": 1, "score": 0, "last_activity_date": 1489796385, "creation_date": 1489793682, "last_edit_date": 1489795210, "question_id": 42868646, "link": "https://stackoverflow.com/questions/42868646/determining-closest-pair-of-points-using-distance-function-haskell", "title": "Determining closest pair of points using distance function, Haskell", "body": "<p>Im trying to figure out how get the closest pair of points with this function for a project. I'm getting an error I don't quite understand.  Thanks for the help.  I have given the distance formula which works, I'm unsure if I am calling the distance function properly in the closestPairs function.</p>\n\n<pre><code>type Point a = (a,a)\n\n-- Determine the true distance between two points.\ndistance :: (Real a, Floating b) =&gt; Point a -&gt; Point a -&gt; b\ndistance (x1,y1) (x2,y2) = sqrt (realToFrac ((x1 - x2)^2 + (y1 - y2)^2))\n\ntype Pair a = (Point a, Point a)\n\n-- Determine which of two pairs of points is the closer.\ncloserPair :: Real a =&gt; Pair a -&gt; Pair a -&gt; Pair a\ncloserPair (p1,p2) (q1,q2) | distance (p1, p2) &gt; distance (q1,q2) = (q1,q2)\n                           | otherwise = (p1,p2)\n</code></pre>\n\n<hr>\n\n<pre><code>mod11PA.hs:30:30: error:\n* Could not deduce (Real (Point a))\n    arising from a use of `distance'\n  from the context: Real a\n    bound by the type signature for:\n               closerPair :: Real a =&gt; Pair a -&gt; Pair a -&gt; Pair a\n    at mod11PA.hs:29:1-50\n* In the first argument of `(&gt;)', namely `distance (p1, p2)'\n  In the expression: distance (p1, p2) &gt; distance (q1, q2)\n  In a stmt of a pattern guard for\n                 an equation for `closerPair':\n    distance (p1, p2) &gt; distance (q1, q2)\n\nmod11PA.hs:30:30: error:\n* Could not deduce (Ord (Point (Point a) -&gt; b0))\n    arising from a use of `&gt;'\n    (maybe you haven't applied a function to enough arguments?)\n  from the context: Real a\n    bound by the type signature for:\n               closerPair :: Real a =&gt; Pair a -&gt; Pair a -&gt; Pair a\n    at mod11PA.hs:29:1-50\n  The type variable `b0' is ambiguous\n  Relevant bindings include\n    q2 :: Point a (bound at mod11PA.hs:30:24)\n    q1 :: Point a (bound at mod11PA.hs:30:21)\n    p2 :: Point a (bound at mod11PA.hs:30:16)\n    p1 :: Point a (bound at mod11PA.hs:30:13)\n    closerPair :: Pair a -&gt; Pair a -&gt; Pair a (bound at mod11PA.hs:30:1)\n* In the expression: distance (p1, p2) &gt; distance (q1, q2)\n  In a stmt of a pattern guard for\n                 an equation for `closerPair':\n    distance (p1, p2) &gt; distance (q1, q2)\n  In an equation for `closerPair':\n      closerPair (p1, p2) (q1, q2)\n        | distance (p1, p2) &gt; distance (q1, q2) = (q1, q2)\n        | otherwise = (p1, p2)\n</code></pre>\n\n<p>Was able to fix my issue by changing the method of closerPair to take in points within two pairs: </p>\n\n<pre><code>closerPair :: Real a =&gt; Pair a -&gt; Pair a -&gt; Pair a\ncloserPair ((x,y),(x1,y1)) ((x2,y2),(x3,y3)) | distance (x,y) (x1,y1) &gt;   distance (x2,y2) (x3,y3) = ((x2,y2),(x3,y3))\n                                             | otherwise = ((x,y),(x1,y1))\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1489792081, "post_id": 42868238, "comment_id": 72842949, "body": "Thanks for that. However I need the loop on function morra. Function main is intended to run only once. If I place <code>morra</code> at the end of the function (in line with the <code>do</code> after <code>when</code>) nothing happens."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1489794478, "post_id": 42868238, "comment_id": 72843596, "body": "@user1897830 you need to put it inline with the <code>when</code> (indented only two spaces). If you put it inside the when, it will only loop when <code>isDigit p</code> is true. What do you mean by &quot;nothing happens&quot;? Does it just exit right away, or does it get stuck in a loop?"}, {"owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1489795708, "post_id": 42868238, "comment_id": 72843934, "body": "I need it to loop only when <code>isDigit p</code> is true. That is it loops until <code>isDigit p</code> is not true and then exits. However when I place <code>morra</code> inside the when it simply exits and does not loop."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1489805157, "post_id": 42868238, "comment_id": 72845682, "body": "@user1897830 add some <code>liftIO (putStrLn &quot;Test&quot;)</code> in there to see exactly what is happening with the control flow. Add one that will activate when you type a character, and tell you what that character is. That way, you can find out where it is diverging from your expectations."}, {"owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1489807779, "post_id": 42868238, "comment_id": 72846080, "body": "Ok. I did that and found out that the 2nd time through the loop the code <code>p &lt;- liftIO getChar</code> is not being executed."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1489809115, "post_id": 42868238, "comment_id": 72846295, "body": "@user1897830 What do you mean &quot;not being executed&quot;? Put a <code>putStrLn</code> on either side of it and see what happens. Better yet, put your code in <a href=\"http://lpaste.net/\" rel=\"nofollow noreferrer\">lpaste</a>"}, {"owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1489809864, "post_id": 42868238, "comment_id": 72846424, "body": "This is what happens when I run the program after placing a <code>putStrLn</code> either side of it (&quot;before&quot; and &quot;after&quot;).  The 2nd time through the loop that piece of code is not being executed.  *Morra&gt; main -- p is Player -- c is Computer -- Player is odds, Computer is evens. before 1 after P: 1 C: 2 Player Wins before after Person Score: 1 Computer Score: 0 Winner is Person *Morra&gt;"}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 2, "last_activity_date": 1489791325, "last_edit_date": 1489791325, "creation_date": 1489790849, "answer_id": 42868238, "question_id": 42868076, "link": "https://stackoverflow.com/questions/42868076/loop-with-the-statet-monad/42868238#42868238", "title": "Loop with the StateT monad", "body": "<p>You're 99% there. Just add <code>main</code> on a new line right after the last <code>putStrLn</code>, and <code>main</code> will call itself, effectively restarting the program.</p>\n\n<p>A few tricks to simplify some things in your code:</p>\n\n<ul>\n<li>Use <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-State-Strict.html#v:execStateT\" rel=\"nofollow noreferrer\"><code>execStateT</code></a><code>:: StateT s m a -&gt; s -&gt; m s</code> to take just the final state of the round. This way, you don't need to use the <code>let</code> bindings to extract the score, and can do it inline instead: <code>(personS,compS) &lt;- execStateT morra (0,0)</code></li>\n<li><code>['P',':',' ',p]</code> can be written as <code>(\"P: \" ++ [p])</code></li>\n</ul>\n\n<p>It's a matter of style and preference, but you can reduce a lot of the indentation and formatting whitespace by rearranging your <code>if</code>s, <code>else</code>s and <code>do</code>s:</p>\n\n<pre><code>if condition\n  then do\n    doSomethingA\n    doSomethingB\n  else someFunction $ do\n    doSomethingElseA\n    doSomethingElseB\n</code></pre>\n\n<p>Overall, nice job :)</p>\n"}, {"tags": [], "owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "is_accepted": false, "score": 1, "last_activity_date": 1489827224, "creation_date": 1489827224, "answer_id": 42872309, "question_id": 42868076, "link": "https://stackoverflow.com/questions/42868076/loop-with-the-statet-monad/42872309#42872309", "title": "Loop with the StateT monad", "body": "<p>I replaced <code>p &lt;- liftIO getChar</code> with <code>p &lt;- liftIO getLine</code> and made a few other minor changes to allow for the fact that p is now a String rather than a Char. Now it works. Seems that it has something to do with Windows as it works using <code>getChar</code> on linux. This is the final code:</p>\n\n<pre><code>module Morra where\n\nimport Control.Monad.Trans.State.Lazy\nimport Control.Monad.IO.Class\nimport Data.Char (isDigit, digitToInt)\nimport System.Random (randomRIO)\nimport Control.Monad (when)\n\nmorra :: StateT (Int, Int) IO ()\nmorra = do\n  p &lt;- liftIO getLine\n  let p1 = head p\n  when (isDigit p1) $ do\n    let p' = digitToInt p1\n    c &lt;- liftIO $ randomRIO (1, 2)\n    liftIO $ putStrLn (\"P: \" ++ p)\n    liftIO $ putStrLn (\"C: \" ++ show c)\n    (pt, ct) &lt;- get\n    if even (c + p') then do\n      liftIO $ putStrLn \"Computer Wins\"\n      put (pt, ct + 1)\n    else do\n      liftIO $ putStrLn \"Player Wins\"\n      put (pt + 1, ct)\n    morra\n\nmain :: IO ()\nmain = do\n  putStrLn \"-- p is Player\"\n  putStrLn \"-- c is Computer\"\n  putStrLn \"-- Player is odds, Computer is evens.\"\n  (personS,compS) &lt;- execStateT morra (0,0)\n  putStrLn (\"Person Score: \" ++ show personS)\n  putStrLn (\"Computer Score: \" ++ show compS)\n  if personS == compS then\n    putStrLn \"No Winner\"\n  else if personS &gt; compS then\n    putStrLn \"Winner is Person\"\n  else\n    putStrLn \"Winner is Computer\"\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489827224, "creation_date": 1489789874, "last_edit_date": 1489791364, "question_id": 42868076, "link": "https://stackoverflow.com/questions/42868076/loop-with-the-statet-monad", "title": "Loop with the StateT monad", "body": "<p>This is an exercise to learn the StateT monad. The program implements the game Morra. The two players are the computer and a person. The state accumulates the score of the computer and player. The program works for one iteration of function morra. However I am at a loss how to loop it. I have tried a few things but nothing seems to work.</p>\n\n<pre><code>module Morra where\n\nimport Control.Monad.Trans.State.Lazy\nimport Control.Monad.IO.Class\nimport Data.Char (isDigit, digitToInt)\nimport System.Random (randomRIO)\nimport Control.Monad (when)\n\nmorra :: StateT (Int, Int) IO ()\nmorra = do\n  p &lt;- liftIO getChar\n  when (isDigit p) $\n    do\n      let p' = digitToInt p\n      c &lt;- liftIO $ randomRIO (1, 2)\n      liftIO $ putStrLn ['P',':',' ',p] --\"P: \" ++ p)\n      liftIO $ putStrLn (\"C: \" ++ show c)\n      (pt, ct) &lt;- get\n      if even (c + p') then\n        do\n          liftIO $ putStrLn \"Computer Wins\"\n          put (pt, ct + 1)\n      else\n        do\n          liftIO $ putStrLn \"Player Wins\"\n          put (pt + 1, ct)\n\nmain :: IO ()\nmain = do\n  putStrLn \"-- p is Player\"\n  putStrLn \"-- c is Computer\"\n  putStrLn \"-- Player is odds, Computer is evens.\"\n  fScore &lt;- runStateT morra (0,0)\n  let personS = fst . snd $ fScore\n      compS = snd . snd $ fScore\n  putStrLn (\"Person Score: \" ++ show personS)\n  putStrLn (\"Computer Score: \" ++ show compS)\n  if personS &gt; compS then\n    putStrLn \"Winner is Person\"\n  else\n    putStrLn \"Winner is Computer\"\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "edited": false, "score": 0, "creation_date": 1489788492, "post_id": 42867807, "comment_id": 72841823, "body": "For this project we aren&#39;t allowed to change the method signatures.  So I have to use realToFrac?  Would I just call realToFrac on the whole line?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "edited": false, "score": 0, "creation_date": 1489788720, "post_id": 42867807, "comment_id": 72841903, "body": "@JohnOchs The easiest way is applying it to the value you give to <code>sqrt</code>. See my edit to the answer."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1489788822, "last_edit_date": 1489788822, "creation_date": 1489788314, "answer_id": 42867807, "question_id": 42867675, "link": "https://stackoverflow.com/questions/42867675/type-error-in-haskell-regarding-real-type/42867807#42867807", "title": "Type Error in Haskell regarding Real type", "body": "<p>Like most number functions in the standard library that aren't explicitly conversion functions, <code>sqrt</code> returns a value of the same type of its argument:</p>\n\n<pre><code>GHCi&gt; :t sqrt\nsqrt :: Floating a =&gt; a -&gt; a\n</code></pre>\n\n<p>If you replace <code>a</code> with <code>b</code>, your function will pass the type checker:</p>\n\n<pre><code>distance :: (Floating b) =&gt; Point b -&gt; Point b -&gt; b\ndistance (x1,y1) (x2,y2) = sqrt((x1 - x2)^2 + (y1 - y2)^2)\n</code></pre>\n\n<p>If you really need values with types that are instances of <code>Real</code> in your arguments, you can use <code>realToFrac</code> to do the necessary conversions:</p>\n\n<pre><code>GHCi&gt; :t realToFrac\nrealToFrac :: (Real a, Fractional b) =&gt; a -&gt; b\n</code></pre>\n\n\n\n<pre><code>distance :: (Real a, Floating b) =&gt; Point a -&gt; Point a -&gt; b\ndistance (x1,y1) (x2,y2) = sqrt (realToFrac ((x1 - x2)^2 + (y1 - y2)^2))\n</code></pre>\n\n<p>P.S.: Note that <code>Real</code> and <code>Floating</code> aren't types, but classes. We say, for instance, that <code>Double</code>, a concrete type, has an instance of the <code>Floating</code> class (or, less formally, that <code>Double</code> is a <code>Floating</code>).</p>\n"}], "owner": {"reputation": 37, "user_id": 7729455, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/07cf84ae46be014b0f8f2cfee63f6cd9?s=128&d=identicon&r=PG&f=1", "display_name": "jochs02", "link": "https://stackoverflow.com/users/7729455/jochs02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 42867807, "answer_count": 1, "score": 0, "last_activity_date": 1489788822, "creation_date": 1489787745, "last_edit_date": 1489787873, "question_id": 42867675, "link": "https://stackoverflow.com/questions/42867675/type-error-in-haskell-regarding-real-type", "title": "Type Error in Haskell regarding Real type", "body": "<p>I'm new to Haskell, so I dont quite understand what is going on here, other than it is a type error with the return value or values that I am using.  Could someone explain what I am doing wrong? Thanks.</p>\n\n<pre><code>type Point a = (a,a)\n\n-- Determine the true distance between two points.\ndistance :: (Real a, Floating b) =&gt; Point a -&gt; Point a -&gt; b\ndistance (x1,y1) (x2,y2) = sqrt((x1 - x2)^2 + (y1 - y2)^2)\n\n* Couldn't match expected type `b' with actual type `a'\n      `a' is a rigid type variable bound by\n        the type signature for:\n          distance :: forall a b.\n                      (Real a, Floating b) =&gt;\n                      Point a -&gt; Point a -&gt; b\n        at mod11PA.hs:12:13\n      `b' is a rigid type variable bound by\n        the type signature for:\n          distance :: forall a b.\n                      (Real a, Floating b) =&gt;\n                      Point a -&gt; Point a -&gt; b\n        at mod11PA.hs:12:13\n    * In the expression: sqrt ((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\n      In an equation for `distance':\n          distance (x1, y1) (x2, y2) = sqrt ((x1 - x2) ^ 2 + (y1 - y2) ^ 2)\n    * Relevant bindings include\n        y2 :: a (bound at mod11PA.hs:13:22)\n        x2 :: a (bound at mod11PA.hs:13:19)\n        y1 :: a (bound at mod11PA.hs:13:14)\n        x1 :: a (bound at mod11PA.hs:13:11\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489777008, "post_id": 42865073, "comment_id": 72836666, "body": "<code>(show gm:start)</code> is really just <code>show gm : start</code>, which is the same as <code>(show gm) : start</code>, and it should probably be <code>show gm ++ start</code> instead, or better yet, <code>shows gm start</code>."}, {"owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489777499, "post_id": 42865073, "comment_id": 72836932, "body": "@DietrichEpp It doesn&#180;t work. I just need print start from TGrammer but Idk how."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1489777815, "post_id": 42865073, "comment_id": 72837108, "body": "It would help if you added type annotations to your functions.  Is <code>printGrammer</code> supposed to be <code>Grammer -&gt; String</code>?  Or perhaps <code>Grammer -&gt; IO ()</code>?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489777854, "post_id": 42865073, "comment_id": 72837125, "body": "Also note that since you have <code>deriving (Show)</code>, you can just <code>print</code> your <code>TGrammer</code> value out."}, {"owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489778080, "post_id": 42865073, "comment_id": 72837234, "body": "@DietrichEpp nope doesn&#180;t work.      printGrammer :: TGrammer -&gt; IO ()     printGrammer gm@TGrammer{..} input = \t    show gm start"}, {"owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489778304, "post_id": 42865073, "comment_id": 72837345, "body": "@DietrichEpp if i have this   <code>printGrammer gm@TGrammer{..} input = \tprint start</code> it doesn&#39;t work too. I get:   <code>Couldn&#39;t match type </code>IO&#39; with <code>Either String&#39;     Expected type: Either String ()       Actual type: IO ()</code>"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 2, "creation_date": 1489778568, "post_id": 42865073, "comment_id": 72837492, "body": "To clarify: Adding types here won&#39;t make your program correct.  Adding types helps us figure out what you are trying to do.  I have no idea what <code>printGrammer</code> is actually supposed to do, and adding types helps with that.  Once I know what it&#39;s supposed to do, I can help you with the errors in the program."}, {"owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489779335, "post_id": 42865073, "comment_id": 72837862, "body": "@DietrichEpp I just need create function which is called in <code>Simulate</code> (I mean <code>Simulate -&gt; printGrammer</code> ) and this function print from <code>TGrammer</code> data about <code>nonterminals, terminals, start, ... </code> but idk how can write it I am beginner with Haskell. Types should be: <code>printGrammer :: TGrammer -&gt; IO ()</code>"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489779837, "post_id": 42865073, "comment_id": 72838149, "body": "If you want <code>TGRammer -&gt; IO ()</code> then you need to call functions like <code>putStr</code>, <code>putStrLn</code>, or <code>print</code>.  Remember that <code>show</code> returns a <code>String</code>, but does not print it out."}, {"owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489780334, "post_id": 42865073, "comment_id": 72838394, "body": "@DietrichEpp I tried it <code>printGrammer :: TGrammer -&gt; IO () printGrammer gm@TGrammer{..} = \tputStr start</code> but i get error: <code>Couldn&#39;t match type ``IO&#39; with ``Either String&#39;     Expected type: Either String ()       Actual type: IO ()</code>"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489781418, "post_id": 42865073, "comment_id": 72838945, "body": "There must be a typo somewhere.  This works fine for me.   <a href=\"https://gist.github.com/anonymous/3bd490fdec45d30f2652407e981dc0f1\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/3bd490fdec45d30f2652407e981dc0f1</a>"}, {"owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489781731, "post_id": 42865073, "comment_id": 72839064, "body": "Idk why but it doesnt work"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1489782764, "post_id": 42865073, "comment_id": 72839566, "body": "Sorry, &quot;it doesn&#39;t work&quot; isn&#39;t really enough information.  Usually, the bare minimum we need to know in order to help is two things: what, exactly, you want the code to do, and what the code actually does."}, {"owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489785350, "post_id": 42865073, "comment_id": 72840713, "body": "it doesn&#180;t work i mean the same error <code>Couldn&#39;t match type ``IO&#39; with ``Either String&#39; Expected type: Either String () Actual type: IO ()</code> in the place where I call the function <code>printGrammer</code> (I mean <code>Simulate -&gt; printGrammer gm&#39;</code>)"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1489786336, "post_id": 42865073, "comment_id": 72841089, "body": "Okay, the fact that it gives you the error where you called the function is important.  Annotate the type for <code>handleGM</code>, I don&#39;t know what it&#39;s supposed to do so I don&#39;t know what the correct type is."}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 1, "last_activity_date": 1489790107, "creation_date": 1489790107, "answer_id": 42868120, "question_id": 42865073, "link": "https://stackoverflow.com/questions/42865073/couldnt-match-type-char-with-char-in-haskell/42868120#42868120", "title": "Couldn&#39;t match type `Char&#39; with `[Char]&#39; in Haskell?", "body": "<p>There are quite a few things that are very weird about your code, so hopefully correcting them will help you solve your problem.</p>\n\n<h1>Type Signatures</h1>\n\n<p>You should always include type signatures on your top-level bindings, as well as any non-trivial <code>where</code> or <code>let</code> bindings. These are my best guesses as to what you intended the types to be:</p>\n\n<pre><code>handleGM :: String -&gt; Config -&gt; IO ()\nprintGrammer :: TGrammer -&gt; String -&gt; IO ()\n</code></pre>\n\n<h1>Shadowed Binding</h1>\n\n<p><code>handleGM</code> appears to be defined twice, once inside of itself in a <code>where</code> binding. This is <em>really bad</em> practice because it looks like you are trying to do a recursive call. You should consider renaming the internal function, or in this case, just writing it out in the do-notation, since its not recursive (and therefore doesn't need the <code>where</code> binding). In fact, you have misused <code>&lt;$&gt;</code>, which should only be used to map a pure function over an impure value. In this case, you are trying to use it to map an impure function of an impure value, which results in the confusing and not-what-you-want selection of <code>Either String ()</code> as the type for the inside <code>handleGM</code>.</p>\n\n<h1>Operator overuse</h1>\n\n<p>It's best not to use <code>&lt;$&gt;</code> and <code>&gt;&gt;=</code> if your code isn't working, as it can hide what is actually happening, so write them out explicitly (do-notation) when you have problems like this.</p>\n\n<p>Here is how I would revise <code>handleGM</code> so based on the above:</p>\n\n<pre><code>handleGM :: String -&gt; Config -&gt; IO ()\nhandleGM input Config{..} = do\n  a &lt;- readFile tgrammer\n  b &lt;- either putStrLn (mapM_ putStrLn) a\n  gm' &lt;- parseGM b\n  case action of\n    Simulate -&gt; printGrammer gm' input\n</code></pre>\n\n<h1>[Char] doesn't match Char</h1>\n\n<p>This is because you used the cons operator <code>(:) :: Char -&gt; [Char] -&gt; [Char]</code>, but the first argument you gave it was already a <code>[Char]</code> (namely, <code>show gm</code>). What you probably want is <code>(++) :: [Char] -&gt; [Char] -&gt; [Char]</code> which will put your two <code>[Char]</code> together into one longer <code>[Char]</code>. You probably also want to <em>print to the terminal</em> rather than just <em>compute a [Char]</em>, which means you need to use a function like <code>putStrLn :: String -&gt; IO ()</code>. If these are accurate, here is what I would revise <code>printGrammer</code> to:</p>\n\n<pre><code>printGrammer :: TGrammer -&gt; String -&gt; IO ()\nprintGrammer gm@TGrammer{..} input = putStrLn (show gm ++ start)\n</code></pre>\n\n<h1>Miscellaneous</h1>\n\n<ul>\n<li>You don't seem to actually do anything with <code>input</code>, so why bother passing it in at all?</li>\n<li>You might benefit from turning on <code>-Wall</code> by passing it as an argument when you compile. It turns on all the compiler warning so it will tell you if you probably made a mistake.</li>\n<li>You only have one case in your <code>case</code>. Why have the <code>case</code> there at all if it doesn't ever do anything different.</li>\n<li><code>action</code> seems to be pulled out of thin air; where does it come from?</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 3537436, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000805861928/picture?type=large", "display_name": "user3537436", "link": "https://stackoverflow.com/users/3537436/user3537436"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "closed_date": 1489850296, "accepted_answer_id": 42868120, "answer_count": 1, "score": -1, "last_activity_date": 1489790107, "creation_date": 1489776443, "last_edit_date": 1489776778, "question_id": 42865073, "link": "https://stackoverflow.com/questions/42865073/couldnt-match-type-char-with-char-in-haskell", "closed_reason": "Not suitable for this site", "title": "Couldn&#39;t match type `Char&#39; with `[Char]&#39; in Haskell?", "body": "<p>Can I ask why I get this? </p>\n\n<p>Couldn't match type <code>Char' with</code>[Char]'</p>\n\n<p>Expected type: [String]</p>\n\n<p>Actual type: [Char]</p>\n\n<p>In the second argument of <code>(:)', namely</code>start'</p>\n\n<p>In the expression: (show gm : start)</p>\n\n<pre><code>main :: IO ()\nmain = do\n    c &lt;- parseArguments &lt;$&gt; getArgs\n    input &lt;- hGetContents stdin\n    either print (handleGM input) c\n\nhandleGM input Config{..} = do\n    handleGM &lt;$&gt; readFile tgrammer &gt;&gt;= either putStrLn (mapM_ putStrLn)\n  where\n    handleGM gm = do\n        gm' &lt;- parseGM gm\n        case action of\n             Simulate -&gt; printGrammer gm' input\n\nprintGrammer gm@TGrammer{..} input =\n    (show gm:start)\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>type TState = String\ntype TSymbol = Char\n\ndata TGrammer = TGrammer\n   { neterminaly :: [TState]\n   , terminaly :: [TState]\n   , start :: [Char]\n   , rules :: [Rules]\n   }\n  deriving (Show)\n\ndata Rules = Rules\n    { from :: TSymbol\n    , to :: String\n    }\n   deriving (Show)\n</code></pre>\n"}, {"tags": ["haskell", "concurrency", "continuations"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 3, "creation_date": 1489781426, "post_id": 42864339, "comment_id": 72838949, "body": "<code>&quot;No instance for (Monad (ContT Maybe))</code>  Is there one? I don&#39;t see an instance for this anywhere."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1489939998, "post_id": 42864339, "comment_id": 72879623, "body": "If you don&#39;t want to define your own instance, you should use <a href=\"https://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Cont.html\" rel=\"nofollow noreferrer\"><code>Control.Monad.Trans.Cont</code></a>"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1489773834, "creation_date": 1489773834, "question_id": 42864339, "link": "https://stackoverflow.com/questions/42864339/using-poor-mans-concurrency-with-continuations-free-monads", "title": "Using Poor Mans Concurrency with continuations/free monads?", "body": "<p>I'm wanting to create an interleaved thread with suspended functions, which I can pass a single function at the time of invocation.</p>\n\n<p>Basic continuation type:</p>\n\n<pre><code>data ContT m a = ContT {runContT :: (a -&gt; m a) -&gt; m a}\n\nsuspendedFunction :: Int -&gt; ContT Maybe Int\nsuspendedFunction i = ContT $ \\todo -&gt; todo i\n\ncalculation :: Int -&gt; Maybe Int --(a -&gt; m a)\ncalculation i = Just 100\n</code></pre>\n\n<p>Continuations with Poor Mans Concurrency:</p>\n\n<pre><code>data C m a = Atomic (m (C m a)) | Done a\n\ninstance Monad m =&gt; Monad (C m) where\n  (&gt;&gt;=) (Atomic m) f      = Atomic $ (liftM (&gt;&gt;= f) m)\n  (&gt;&gt;=) (Done a) f        = f a\n  return                  = Done\n\natomic :: Monad m =&gt; m a -&gt; C m a\natomic m = Atomic $ liftM Done m\n\ninterleave :: Monad m =&gt; C m a -&gt; C m a -&gt; C m a\ninterleave (Atomic m1) (Atomic m2) = do\n  n1 &lt;- atom $ m1\n  n2 &lt;- atom $ m2\ninterleave n1 n2\ninterleave m1 (Done _)             = m1\ninterleave (Done _) m2             = m2\n\nrunInterleavedThread :: Monad m =&gt; C m a -&gt; m a\nrunInterleavedThread m = m &gt;&gt;= runInterleaved\n\ncreateSuspendedThread :: Int -&gt; C (ContT Maybe) Int\ncreateSuspendedThread i = atomic $ suspendedFunction i\n\nmain = do\n let inter = interleave (createSuspendedThread 1) (createSuspendedThread 2)\n let complete = runContT $ runThreads inter $ calculation\n</code></pre>\n\n<p>Error: </p>\n\n<pre><code> \"No instance for (Monad (ContT Maybe))\n    arising from a use of \u2018atomic\u2019\"\n</code></pre>\n\n<p>Am I missing something basic here, can anyone shed some light?</p>\n"}, {"tags": ["haskell", "build", "haskell-stack"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1489772047, "post_id": 42863731, "comment_id": 72833726, "body": "I think the package name is <code>mongoDB</code> not <code>mongodb</code>."}, {"owner": {"reputation": 149, "user_id": 5744349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f63ac4956d60afba3e3066789e62f5?s=128&d=identicon&r=PG&f=1", "display_name": "Xiaoji Liu", "link": "https://stackoverflow.com/users/5744349/xiaoji-liu"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1489772202, "post_id": 42863731, "comment_id": 72833801, "body": "you are right, i fixed it with mongoDB."}], "owner": {"reputation": 149, "user_id": 5744349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f63ac4956d60afba3e3066789e62f5?s=128&d=identicon&r=PG&f=1", "display_name": "Xiaoji Liu", "link": "https://stackoverflow.com/users/5744349/xiaoji-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489806746, "creation_date": 1489771551, "last_edit_date": 1489806746, "question_id": 42863731, "link": "https://stackoverflow.com/questions/42863731/haskell-stack-build-with-mongodb-as-dependency-error", "title": "haskell stack build with mongodb as dependency error", "body": "<p>I am trying to build a test project with stack:</p>\n\n<p>I ran:</p>\n\n<pre><code>stack new test simple\n</code></pre>\n\n<p>then I modified Main.hs file to be:</p>\n\n<pre><code>module Main where\n\nimport Database.MongoDB as M\n\nmain :: IO ()\nmain = do\nputStrLn \"hello world\"\n</code></pre>\n\n<p>test.cabal file to be:</p>\n\n<pre><code>executable test\nhs-source-dirs:      src\nmain-is:             Main.hs\ndefault-language:    Haskell2010\nbuild-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                    ,mongodb\n</code></pre>\n\n<p>stack.yaml file to be:</p>\n\n<pre><code>resolver: lts-8.5\npackages:\n - '.'\nextra-deps:\n - mongodb-2.1.1.1\n</code></pre>\n\n<p>when I ran \"stack build\", it shows following error message:</p>\n\n<pre><code>Warning: Some extra-deps are neither installed nor in the index:\n* mongodb-2.1.1.1\nDidn't see mongodb-2.1.1.1 in your package indices.\nUpdating and trying again.\nFetched package index.                                                                                    \nThe following package identifiers were not found in your indices: mongodb-2.1.1.1\n</code></pre>\n\n<p>I have checked that I have mongodb-2.1.1.1 installed with lts-8.5 snapshot.</p>\n\n<p>Where did I do wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489771917, "post_id": 42863605, "comment_id": 72833645, "body": "Avoid <code>head,tail</code>, they are dangerous. Prefer (exhausive) patter matching whenever possible, and turn on warnings with <code>-Wall</code> so that GHC can warn about missing cases."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489772793, "post_id": 42863605, "comment_id": 72834183, "body": "In case you want more test cases, <code>nohundred m = [ n | n &lt;- [1..], not (&quot;100&quot; `isInfixOf` showIntAtBase 2 intToDigit n &quot;&quot;) ] !! (m - 1)</code> is a reference implementation (you&#39;ll need to import <code>Numeric</code>, <code>Data.Char</code>, and <code>Data.List</code>)."}, {"owner": {"reputation": 1, "user_id": 7728324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f97c428771579e139fce38eea59ce20?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Kumar", "link": "https://stackoverflow.com/users/7728324/shubham-kumar"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489773303, "post_id": 42863605, "comment_id": 72834481, "body": "Can you be more precise with your bracketing please @Alec"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489773562, "post_id": 42863605, "comment_id": 72834655, "body": "@ShubhamKumar I&#39;m not sure I understand. You can literally copy-paste in the one line I gave into GHCi and it will define the function you want (after importing <code>Numeric</code> <code>Data.Char</code>, and <code>Data.List</code>, of course)"}, {"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1489775328, "post_id": 42863605, "comment_id": 72835680, "body": "<code>any ((==4) . (`mod` 8)) . takeWhile (&gt;0) . iterate (`div` 2)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1489784934, "last_edit_date": 1489784934, "creation_date": 1489784553, "answer_id": 42867049, "question_id": 42863605, "link": "https://stackoverflow.com/questions/42863605/haskell-function-to-check-if-substring-100-is-present-in-the-binary-expansion/42867049#42867049", "title": "Haskell function to check if substring &quot;100&quot; is present in the binary expansion of a decimal number", "body": "<p>This function is partial:</p>\n\n<pre><code>check (z:zs)\n  |((z == 1) &amp;&amp; (head (zs) == 0) &amp;&amp; (head (tail zs) == 0)) = True\n  | otherwise                                              = check zs\n</code></pre>\n\n<p>When called with a one- or two-element list, the first check will call <code>head</code> on an empty list. Additionally, it does not cover the empty-list case. The idiomatic way to write this is:</p>\n\n<pre><code>check (1:0:0:zs) = True\ncheck (z:zs) = check zs\ncheck [] = False\n</code></pre>\n\n<p>Additionally, your <code>nohundred</code> function takes a number and finds the next higher non-hundred number; but you want the nth non-hundred number, which is a very different thing.</p>\n"}], "owner": {"reputation": 1, "user_id": 7728324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f97c428771579e139fce38eea59ce20?s=128&d=identicon&r=PG&f=1", "display_name": "Shubham Kumar", "link": "https://stackoverflow.com/users/7728324/shubham-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489784934, "creation_date": 1489771149, "question_id": 42863605, "link": "https://stackoverflow.com/questions/42863605/haskell-function-to-check-if-substring-100-is-present-in-the-binary-expansion", "title": "Haskell function to check if substring &quot;100&quot; is present in the binary expansion of a decimal number", "body": "<p>Define a function nohundred :: Int -> Int such that for a positive number n   nohundred n is the nth positive number such that \"100\" does not occur as a substring in its binary expansion.</p>\n\n<pre><code>decToBin :: Int -&gt; [Int]\ndecToBin x = reverse $ decToBin' x\n  where\n    decToBin' :: Int -&gt; [Int]\n    decToBin' 0 = []\n    decToBin' y = let (a,b) = quotRem y 2 in [b] ++ decToBin' a\ncheck :: [Int] -&gt; Bool\ncheck (z:zs)\n  |((z == 1) &amp;&amp; (head (zs) == 0) &amp;&amp; (head (tail zs) == 0)) = True\n  | otherwise                                              = check zs\n\nbinToDec :: [Int] -&gt; Int\nbinToDec l = sumlist (zipWith (*) (iterate f 1) (reverse l))\n  where\n    sumlist :: [Int] -&gt; Int\n    sumlist [] = 0\n    sumlist (x:xs) = x + (sumlist xs)\n    f :: Int -&gt; Int \n    f j = (2 * j)\nnohundred :: Int -&gt; Int\nnohundred n = if ((check fun) == True) then (binToDec (fun)) else (nohundred (n+1))\n  where\n    fun = decToBin n\n</code></pre>\n\n<p>The above code gives error :-</p>\n\n<pre><code>*Main&gt; nohundred 10\n*** Exception: Prelude.head: empty list...\n</code></pre>\n\n<p>The desired output is 14.</p>\n\n<pre><code>*Main&gt; nohundred 100\n100\n</code></pre>\n\n<p>The desired output is 367...\nCan anyone suggest the cause of error?</p>\n"}, {"tags": ["haskell", "unicode", "combining-marks"], "owner": {"reputation": 1308, "user_id": 2248754, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0f3fdf7274a422a407b9554e822c96e8?s=128&d=identicon&r=PG", "display_name": "OllieB", "link": "https://stackoverflow.com/users/2248754/ollieb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1489769505, "creation_date": 1489769505, "last_edit_date": 1495535396, "question_id": 42863075, "link": "https://stackoverflow.com/questions/42863075/does-haskell-support-unicode-combining-characters", "title": "Does haskell support unicode combining characters?", "body": "<p>I've looked at the lexical specification of haskell, and I can use a lower case unicode character is a valid variable name. </p>\n\n<p>I believe it not however legal to use modifiers with lowercase letters? Attempts so far suggest not. This stackoverflow post also suggests this is a none starter: <a href=\"https://stackoverflow.com/questions/24941921/whats-wrong-with-this-haskell-unicode-variable-name/\">Link1</a></p>\n\n<p>I assume this was thoughtfully thrashed out when unicode was supported in Haskell. Can anyone suggest why not? Is it a terrible idea, or something no-one has got round to?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1489768664, "post_id": 42862653, "comment_id": 72831741, "body": "What if it there isn&#39;t an <code>a</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 4, "last_activity_date": 1489768670, "creation_date": 1489768670, "answer_id": 42862815, "question_id": 42862653, "link": "https://stackoverflow.com/questions/42862653/get-data-from-error-data-type/42862815#42862815", "title": "Get data from error data type", "body": "<p>You need to use <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">pattern matching</a>. For example:</p>\n\n<pre><code>case errorValue of\n  Fail -&gt; ... -- Do something if it was a fail\n  Ok a -&gt; ... -- Do something involving a if it was OK\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 7637341, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9cbda903cee9e038d3f46be09863f4ec?s=128&d=identicon&r=PG&f=1", "display_name": "user7637341", "link": "https://stackoverflow.com/users/7637341/user7637341"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 42862815, "answer_count": 1, "score": 0, "last_activity_date": 1489768743, "creation_date": 1489768163, "question_id": 42862653, "link": "https://stackoverflow.com/questions/42862653/get-data-from-error-data-type", "title": "Get data from error data type", "body": "<p>If I have an error data type:</p>\n\n<pre><code>data Error a = Fail|Ok a\n           deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>if something returns <code>Error a</code>, how can I then get that a on its own so I can use it?</p>\n"}, {"tags": ["algorithm", "haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1489767571, "post_id": 42862384, "comment_id": 72831066, "body": "Yes, a simple recursive function should do. Though you can also use a list if you want."}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1489767859, "post_id": 42862384, "comment_id": 72831214, "body": "@Bergi could you give me hint or something for the function, i am unable to figure it out."}, {"owner": {"reputation": 192, "user_id": 7607686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/435f7fca50284f6317909c183bd89a22?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/7607686/john"}, "edited": false, "score": 0, "creation_date": 1489767913, "post_id": 42862384, "comment_id": 72831237, "body": "If I read it right, no recursion necessary a simple loop should suffice: (pseudocode): dividend = a; power=0; while (dividend &gt;= b) { dividend=round(dividend/b);power+=1;}"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 192, "user_id": 7607686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/435f7fca50284f6317909c183bd89a22?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/7607686/john"}, "edited": false, "score": 0, "creation_date": 1489767985, "post_id": 42862384, "comment_id": 72831280, "body": "@John There are no loops in Haskell."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1489767990, "post_id": 42862384, "comment_id": 72831283, "body": "Recursion is the idiomatic way to implement this. Try writing out your mathematical understanding more formally."}, {"owner": {"reputation": 192, "user_id": 7607686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/435f7fca50284f6317909c183bd89a22?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/7607686/john"}, "edited": false, "score": 0, "creation_date": 1489768045, "post_id": 42862384, "comment_id": 72831322, "body": "Thanks Bergi - then recurse using the same protocol, should suffice"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1489768400, "post_id": 42862384, "comment_id": 72831542, "body": "If you know <code>largestPower (a&#47;b) b</code>, how do you find <code>largestPower a b</code> given that information? What is your base case? Let me know if you want me to write out a full solution for you."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1489768460, "post_id": 42862384, "comment_id": 72831584, "body": "You do not have to <b>add</b> <code>5+2+1</code>. You simply count that there are three divisions, and then you calculate <code>2^3 = 8</code>. The fact that this sum works is just a co-incidence."}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "reply_to_user": {"reputation": 192, "user_id": 7607686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/435f7fca50284f6317909c183bd89a22?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/7607686/john"}, "edited": false, "score": 0, "creation_date": 1489768489, "post_id": 42862384, "comment_id": 72831606, "body": "@John the problem i am having is that i understand the math and basic algorithm but am having problems writing the recursive function. Do i write something like say devideSum x y =  x/y + devideSum x/y y  ?"}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1489768644, "post_id": 42862384, "comment_id": 72831726, "body": "WillemVanOnsem that also works but i do not know how to implement that also @Lazersmoke you&#39;r write i am having problems finding the base case"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1489769322, "post_id": 42862384, "comment_id": 72832158, "body": "@sgman You&#39;re defintion is correct except that <code>div a b</code> is the integer division function in Haskell. Your base case is <code>a &lt; b</code>"}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1489772435, "post_id": 42862384, "comment_id": 72833943, "body": "@Lazersmoke so the base case will be if a&lt;b = 1 ? or should it be something else ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489785474, "post_id": 42862384, "comment_id": 72840762, "body": "@WillemVanOnsem You are incorrect. 5+2+1 is the right calculation to do: <code>10&#47;2=5</code> factors in <code>[1..10]</code> are even, hence contribute <code>2^5</code> to the product; an additional <code>5&#47;2=2</code> factors are even after taking out the factor contributed earlier, hence contribute an additional <code>2^2</code> to the product; and an additional <code>2&#47;2=1</code> factors are even after taking out the factors contributed earlier, hence contribute an additional <code>2^1</code> to the product. Thus the whole product is a multiple of <code>2^5*2^2*2^1 = 2^{5+2+1}</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489785552, "post_id": 42862384, "comment_id": 72840794, "body": "@WillemVanOnsem (Though I suspect this argument breaks down for composite factors. I don&#39;t see a cleverer algorithm than doing this for each prime factor, then doing some divisions by their multiplicities and taking the max of the results, but I would be shocked if my imagination had covered all the bases here.)"}], "answers": [{"comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1489769141, "post_id": 42862834, "comment_id": 72832038, "body": "Is the algorithm here correct? I think it should be <code>(div a b) + largestPower (div a b) b</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1489769736, "post_id": 42862834, "comment_id": 72832415, "body": "@Lazersmoke: Say you calculate <code>largestPower 2 3</code>. This is supposed to be <code>1</code>, not <code>2</code>... The addition as is specified in the question is simply an incorrect algorithm."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1489769868, "post_id": 42862834, "comment_id": 72832505, "body": "@Lazersmoke: see note added to the answer."}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489771267, "post_id": 42862834, "comment_id": 72833285, "body": "@WillemVanOnsem i tried this code, and it gives the wrong answer in case of largestPower 10 5, it should be 2 but it gives 5 as the answer"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489771315, "post_id": 42862834, "comment_id": 72833318, "body": "@sgman: somehow I skipped the factorial part. Will update the answer."}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489772556, "post_id": 42862834, "comment_id": 72834018, "body": "i figured your mistake @WillemVanOnsem its actually a&lt;b =0 and then you have otherwise = (div a b) + (largestPower (div a b) b)"}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489772595, "post_id": 42862834, "comment_id": 72834039, "body": "@WillemVanOnsem im not sure if links are allowed in this site but if they are i can link you the page that explains the math of the algo"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489772618, "post_id": 42862834, "comment_id": 72834061, "body": "@sgman: but <code>0</code> is <b>not</b> a power of <code>b</code> (regardless what that <code>b</code> is)..."}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489772812, "post_id": 42862834, "comment_id": 72834201, "body": "@WillemVanOnsem i am not using the power logic, i am using that quotient some thing, i actually just did it by kinda trial and error cause i figured since im calculating sum (by my logic) then adding a 1 can mess stuff up so i just changed it to a 0."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489773156, "post_id": 42862834, "comment_id": 72834394, "body": "@sgman: but have you any proof that your &quot;algorithm&quot; is correct. I was under the impression that you knew <i>how</i> to calculate it, but not how to <i>implement</i> it in Haskell. Now it seems to turn out, that you do not know whether the algoritm is correct itself?"}, {"owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "edited": false, "score": 0, "creation_date": 1489774541, "post_id": 42862834, "comment_id": 72835198, "body": "@WillemVanOnsem i initially knew that it was correct cause i had googled it a bit but then you said it was wrong so i changed my mind, anyway i got it now, its all good thanks."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489785814, "post_id": 42862834, "comment_id": 72840893, "body": "I downvoted. This appears to be answering a substantially different question than the one asked."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489787315, "post_id": 42862834, "comment_id": 72841418, "body": "No, 4 is the correct answer for <code>largestPower 10 3</code>, because 3^4 is the largest power of 3 that divides 10! evenly. I don&#39;t know what problem you are trying to solve, but it doesn&#39;t seem to be the one asked for. I&#39;m not claiming to have a proof that the proposed algorithm is correct, but your counterexample is wrong."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489787416, "post_id": 42862834, "comment_id": 72841455, "body": "@amalloy: funny though that there was a concurrent edit. :) Carl Jung would have called that <i>synchronicity</i> :) (although it is more that some people have a job, and thus cannot make edits every moment of the day)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1489788811, "last_edit_date": 1489788811, "creation_date": 1489768717, "answer_id": 42862834, "question_id": 42862384, "link": "https://stackoverflow.com/questions/42862384/finding-the-largest-power-of-a-number-that-divides-a-factorial-in-haskell/42862834#42862834", "title": "Finding the largest power of a number that divides a factorial in haskell", "body": "<h1>Recursion without an <em>accumulator</em></h1>\n\n<p>You can simply write a recursive algorithm and sum up the result of each call. Here we have two cases:</p>\n\n<ul>\n<li><p><code>a</code> is less than <code>b</code>, in which case the largest power is <code>0</code>. So:</p>\n\n<pre><code>largestPower a b | a &lt; b = 0\n</code></pre></li>\n<li><p><code>a</code> is greater than or equal to <code>b</code>, in that case we divide <code>a</code> by <code>b</code>, calculate <code>largestPower</code> for that division, and add the division to the result. Like:</p>\n\n<pre><code>                 | otherwise = d + largestPower d b\n                 where d = (div a b)\n</code></pre></li>\n</ul>\n\n<p>Or putting it together:</p>\n\n<pre><code>largestPower a b | a &lt; b = 1\n                 | otherwise = d + largestPower d b\n                 where d = (div a b)\n</code></pre>\n\n<h1>Recursion with an <em>accumuator</em></h1>\n\n<p>You can also use <em>recursion</em> with an <em>accumulator</em>: a variable you pass through the recursion, and update accordingly. At the end, you return that accumulator (or a function called on that accumulator).</p>\n\n<p>Here the accumulator would of course be the <em>running product</em> of divisions, so:</p>\n\n<pre><code>largestPower = largestPower' <b>0</b></code></pre>\n\n<p>So we will define a function <code>largestPower'</code> (mind the accent) with an accumulator as first argument that is initialized as <code>1</code>.</p>\n\n<p>Now in the recursion, there are two cases:</p>\n\n<ul>\n<li><p><code>a</code> is less than <code>b</code>, we simply return the accumulator:</p>\n\n<pre><code>largestPower' r a b | a &lt; b = r\n</code></pre></li>\n<li><p>otherwise we multiply our accumulator with <code>b</code>, and pass the division to the <code>largestPower'</code> with a recursive call:</p>\n\n<pre><code>                    | otherwise = largestPower' (d+r) d b\n                    where d = (div a b)\n</code></pre></li>\n</ul>\n\n<p>Or the full version:</p>\n\n<pre><code>largestPower = largestPower' 1\n\nlargestPower' r a b | a &lt; b = r\n                    | otherwise = largestPower' (d+r) d b\n                    where d = (div a b)\n</code></pre>\n\n<h1>Naive correct algorithm</h1>\n\n<p>The algorithm is not correct. A \"naive\" algorithm would be to simply divide every item and keep decrementing until you reach <code>1</code>, like:</p>\n\n<pre><code>largestPower 1 _ = 0\nlargestPower a b = sumPower a + largestPower (a-1) b\n    where sumPower n | n `mod` b == 0 = 1 + sumPower (div n b)\n                     | otherwise = 0\n</code></pre>\n\n<p>So this means that for the <code>largestPower 4 2</code>, this can be written as:</p>\n\n<pre><code>largestPower 4 2 = sumPower 4 + sumPower 3 + sumPower 2\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>sumPower 4 = 1 + sumPower 2\n           = 1 + 1 + sumPower 1\n           = 1 + 1 + 0\n           = 2\n\nsumPower 3 = 0\n\nsumPower 2 = 1 + sumPower 1\n           = 1 + 0\n           = 1\n</code></pre>\n\n<p>So <code>3</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489787733, "post_id": 42867416, "comment_id": 72841572, "body": "Looks to me the correct answer is <a href=\"https://www.wolframalpha.com/input/?i=10!%2F6%5E4\" rel=\"nofollow noreferrer\">4</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1489788070, "post_id": 42867416, "comment_id": 72841688, "body": "@WillemVanOnsem You&#39;re absolutely right. Fixed, thanks. That&#39;s what I get for doing my math hastily."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1489788046, "last_edit_date": 1489788046, "creation_date": 1489786306, "answer_id": 42867416, "question_id": 42862384, "link": "https://stackoverflow.com/questions/42862384/finding-the-largest-power-of-a-number-that-divides-a-factorial-in-haskell/42867416#42867416", "title": "Finding the largest power of a number that divides a factorial in haskell", "body": "<p>The algorithm as stated can be implemented quite simply:</p>\n\n<pre><code>largestPower :: Int -&gt; Int -&gt; Int\nlargestPower 0 b = 0\nlargestPower a b = d + largestPower d b where d = a `div` b\n</code></pre>\n\n<p>However, the algorithm is not correct for composite <code>b</code>. For example, <code>largestPower 10 6</code> with this algorithm yields <code>1</code>, but in fact the correct answer is <code>4</code>. The problem is that this algorithm ignores multiples of <code>2</code> and <code>3</code> that are not multiples of <code>6</code>. How you fix the algorithm is a completely separate question, though.</p>\n"}], "owner": {"reputation": 89, "user_id": 7500874, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2a505759aeda973b2072d25e64b885e1?s=128&d=identicon&r=PG&f=1", "display_name": "sgman", "link": "https://stackoverflow.com/users/7500874/sgman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 42862834, "answer_count": 2, "score": 0, "last_activity_date": 1489788811, "creation_date": 1489767298, "last_edit_date": 1489767638, "question_id": 42862384, "link": "https://stackoverflow.com/questions/42862384/finding-the-largest-power-of-a-number-that-divides-a-factorial-in-haskell", "title": "Finding the largest power of a number that divides a factorial in haskell", "body": "<p>So I am writing a haskell program to calculate the largest power of a number that divides a factorial.</p>\n\n<pre><code>largestPower :: Int -&gt; Int -&gt; Int\n</code></pre>\n\n<p>Here <code>largestPower a b</code> has find largest power of <code>b</code> that divides <code>a!</code>.</p>\n\n<p>Now I understand the math behind it, the way to find the answer is to repeatedly divide <code>a</code> (just a) by <code>b</code>, ignore the remainder and finally add all the quotients. So if we have something like</p>\n\n<pre><code>largestPower 10 2\n</code></pre>\n\n<p>we should get 8 because 10/2=5/2=2/2=1 and we add 5+2+1=8</p>\n\n<p>However, I am unable to figure out how to implement this as a function, do I use arrays or just a simple recursive function.</p>\n\n<p>I am gravitating towards it being just a normal function, though I guess it can be done by storing quotients in an array and adding them. </p>\n"}, {"tags": ["haskell", "ghc", "aeson"], "comments": [{"owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "edited": false, "score": 0, "creation_date": 1489767029, "post_id": 42861908, "comment_id": 72830699, "body": "Not too fluent in haskell but can you get rid of the outer object wrapping the inner object?"}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "reply_to_user": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "edited": false, "score": 0, "creation_date": 1489768523, "post_id": 42861908, "comment_id": 72831632, "body": "Not really, because I can&#39;t just get rid of the outer object since there are two inner objects and not just one. The inner ones will first have to be merged first."}, {"owner": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "edited": false, "score": 1, "creation_date": 1489773093, "post_id": 42861908, "comment_id": 72834365, "body": "Is there a typo in the queston?  I see <code>&quot;lastname&quot;: &quot;name of user 2&quot;</code> in the desired output but <code>&quot;lastname&quot;</code> does not show up anywhere else in the question."}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "reply_to_user": {"reputation": 1369, "user_id": 509928, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/57d816a396798416d079c92adbabdbf3?s=128&d=identicon&r=PG", "display_name": "Dave Compton", "link": "https://stackoverflow.com/users/509928/dave-compton"}, "edited": false, "score": 0, "creation_date": 1489797507, "post_id": 42861908, "comment_id": 72844328, "body": "@DaveCompton, yes, sorry, I have now corrected the typo."}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 2, "last_activity_date": 1489768669, "creation_date": 1489768669, "answer_id": 42862813, "question_id": 42861908, "link": "https://stackoverflow.com/questions/42861908/haskell-aseon-output-json-as-one-object/42862813#42862813", "title": "Haskell/Aseon: output JSON as one object", "body": "<blockquote>\n  <p>How will I have to change toJSON in order to print the desired encoded JSON?</p>\n</blockquote>\n\n<p>There is nothing you can do to change <code>toJSON</code> for <code>User</code> to print desired encoded JSON. Problem is not in <code>User</code> encoding but in list encoding. Simple list just encoded as JSON array. And JSON array doesn't have values (so you can't have <code>[\"user 1\":{...}]</code> thus each object is wrapped into <code>{}</code>). This problem can be solved in different ways. One of the easiest solution is to write custom encoder for list of <code>User</code>. Here how it looks like:</p>\n\n<pre><code>import qualified Data.HashMap.Strict as HM\n\nusersEncode :: [User] -&gt; Object\nusersEncode = HM.unions . map (\\(Object user) -&gt; user) . map toJSON\n</code></pre>\n\n<p>Adn then in <code>main</code> you can call it like this:</p>\n\n<pre><code>main = B.putStrLn $ encode $ usersEncode users\n</code></pre>\n\n<p>And it gives you desired output. </p>\n\n<p>The trick is in the fact that <code>aeson</code> stores objects as <code>HashMap</code> from <code>Text</code> to <code>Value</code>. And <code>HashMap</code> is encoded as JSON object. So the idea of given solution is to convert each user to singleton <code>HashMap</code> and then unite all <code>HashMap</code>s. </p>\n\n<p><strong>Note</strong>: it will remove users with duplicated <code>userId</code> from list.</p>\n"}], "owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 1, "accepted_answer_id": 42862813, "answer_count": 1, "score": 3, "last_activity_date": 1489797474, "creation_date": 1489765867, "last_edit_date": 1489797474, "question_id": 42861908, "link": "https://stackoverflow.com/questions/42861908/haskell-aseon-output-json-as-one-object", "title": "Haskell/Aseon: output JSON as one object", "body": "<p>I have the following Haskell code which encodes a list of the data type <code>User</code> in JSON and prints it to the standard output:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport Data.Aeson\nimport Data.Text\nimport qualified Data.ByteString.Lazy.Char8 as B\n\ndata User = User\n    { id :: String\n    , name :: String\n    , address :: String\n    } deriving (Show)\n\ninstance ToJSON User where\n    toJSON (User id name address) = object\n        [ pack id .= object\n            [ \"name\" .= name\n            , \"address\" .= address\n            ]\n        ]\n\nusers :: [User]\nusers = [ User \"user 1\" \"name of user 1\" \"address of user 1\"\n        , User \"user 2\" \"name of user 2\" \"address of user 2\"\n        ] \n\nmain :: IO ()\nmain = B.putStrLn $ encode users\n</code></pre>\n\n<p>At the moment, the code produces the following output:</p>\n\n<pre><code>[\n  {\n    \"user 1\": {\n      \"address\": \"address of user 1\",\n      \"name\": \"name of user 1\"\n    }\n  },\n  {\n    \"user 2\": {\n      \"address\": \"address of user 2\",\n      \"name\": \"name of user 2\"\n    }\n  }\n]\n</code></pre>\n\n<p>However, I would like to output the following JSON structure (joining the inner two objects):</p>\n\n<pre><code>{\n  \"user 1\": {\n    \"name\": \"name of user 1\",\n    \"address\": \"address of user 1\"\n  },\n  \"user 2\": {\n    \"name\": \"name of user 2\",\n    \"address\": \"address of user 2\"\n  }\n}\n</code></pre>\n\n<p>How will I have to change <code>toJSON</code> in order to print the desired encoded JSON?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1489765915, "post_id": 42860743, "comment_id": 72829884, "body": "My preferred response is: In C, does <code>getchar()</code> equal <code>&#39;L&#39;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1489767853, "last_edit_date": 1489767853, "creation_date": 1489763099, "answer_id": 42860897, "question_id": 42860743, "link": "https://stackoverflow.com/questions/42860743/haskell-compare-io-char-with-char/42860897#42860897", "title": "Haskell - compare IO Char with char", "body": "<p>You have to lift the comparison into the <code>IO</code> monad. For example:</p>\n\n<pre><code>myFunction :: Char -&gt; Int -&gt; IO Int\nmyFunction 'q' _ = return 1\nmyFunction 'w' _ = return 2\nmyFunction 'e' _ = return 3\nmyFunction 'r' _ = return 4\nmyFunction _ x = return x\n\n-- Actual return type depends on what the function actually does\nsomeOtherFunction :: Int -&gt; IO ?\nsomeOtherFunction oldDir = do\n   dir &lt;- input\n   newDir &lt;- myFunction dir oldDir\n   ...\n</code></pre>\n\n<p>Another (probably better) option is to keep <code>myFunction</code> a pure function, and use <code>fmap</code> if you need to apply it to an <code>IO Char</code>.</p>\n\n<pre><code>-- Note the change in the argument order\nmyFunction :: Int -&gt; Char -&gt; Int\nmyFunction _ 'q' = 1\n...\nmyFunction x _ = x\n\nsomeOtherFunction oldDir :: Int -&gt; IO ?\n   newDir &lt;- fmap (myFunction oldDir) input\n   ...\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1682, "favorite_count": 1, "closed_date": 1489765064, "accepted_answer_id": 42860897, "answer_count": 1, "score": 0, "last_activity_date": 1489767853, "creation_date": 1489762683, "question_id": 42860743, "link": "https://stackoverflow.com/questions/42860743/haskell-compare-io-char-with-char", "closed_reason": "Duplicate", "title": "Haskell - compare IO Char with char", "body": "<p>I'm a beginner in Haskell, and I'm stuck on an IO problem that I can't get to solve.</p>\n\n<p>I'm working on a Snake game, and the only thing i've got to do left is taking user input to make the snake move. So here's my function</p>\n\n<pre><code>--Get char\ninput :: IO Char\ninput =\n    hSetEcho stdin False\n    &gt;&gt; hSetBuffering stdin NoBuffering\n    &gt;&gt; getChar\n\nmyFunction :: IO Char -&gt; Int -&gt; Int\nmyfunction myChar oldValue\n     | (myChar == 'q') = 1\n     | (myChar == 'w') = 2\n     | (myChar == 'e') = 3\n     | (myChar == 'r') = 4\n     | otherwise = oldValue\n\n-- At the beginning of the game, function is called like this\nlet dir = myFunction input 1 --To give the snake an initial direction\n\n-- The game works with a function Turn that takes an Int as parameter \n-- which is the previous direction. let's call it oldDir\nlet newDir = myFunction input oldDir\n-- Then I call Turn again with newDir as parameter\n</code></pre>\n\n<p>The problem comes from the (myChar == char) part, and is \"Couldn't match expected type \u2018IO Char\u2019 with actual type \u2018Char\u2019\"</p>\n\n<p>How to compare IO Char with Char? </p>\n\n<p>Short answer: I can't. Could you please help me with the longer answer?\nThis question was probably asked a number of times, but I'm still stuck on this problem.</p>\n\n<p>Thank you in advance for your answer!</p>\n\n<p>Cordially, </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 2, "creation_date": 1489763051, "post_id": 42860426, "comment_id": 72827862, "body": "The <a href=\"https://hackage.haskell.org/package/validation-0.5.4/docs/Data-Validation.html\" rel=\"nofollow noreferrer\">page you link</a> contains a <a href=\"https://hackage.haskell.org/package/validation-0.5.4/docs/src/Data-Validation.html#AccValidation\" rel=\"nofollow noreferrer\">source link</a> that contains the line <code>import Control.Lens.Review(( # ))</code> that can easily answer where it comes from, it takes little more effort to find the actual documentation."}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 2, "last_activity_date": 1489765318, "last_edit_date": 1489765318, "creation_date": 1489761977, "answer_id": 42860480, "question_id": 42860426, "link": "https://stackoverflow.com/questions/42860426/what-is-number-sign-in-data-validation-examples/42860480#42860480", "title": "What is &quot;#&quot; (number sign) in Data.Validation examples?", "body": "<p>It's from the lens library: <code>import Control.Lens.Review(( # ))</code></p>\n\n<p>See <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Review.html#v:-35-\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 20812, "user_id": 312785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f41fa18e9774f1a2ea7c519f476c348?s=128&d=identicon&r=PG", "display_name": "davidchambers", "link": "https://stackoverflow.com/users/312785/davidchambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 42860480, "answer_count": 1, "score": 0, "last_activity_date": 1489765318, "creation_date": 1489761833, "question_id": 42860426, "link": "https://stackoverflow.com/questions/42860426/what-is-number-sign-in-data-validation-examples", "title": "What is &quot;#&quot; (number sign) in Data.Validation examples?", "body": "<p>From <a href=\"https://hackage.haskell.org/package/validation-0.5.4/docs/Data-Validation.html\" rel=\"nofollow noreferrer\">Data.Validation</a>:</p>\n\n<blockquote>\n<pre><code>&gt;&gt;&gt; _Success # (+1) &lt;*&gt; _Success # 7 :: AccValidation String Int\nAccSuccess 8\n</code></pre>\n</blockquote>\n\n<p>What is the <code>#</code>/number sign/pound sign/hash sign/octothorp in the above example?</p>\n"}, {"tags": ["function", "haskell", "input", "composition"], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 3, "last_activity_date": 1489765054, "last_edit_date": 1489765054, "creation_date": 1489760038, "answer_id": 42859828, "question_id": 42859416, "link": "https://stackoverflow.com/questions/42859416/feeding-the-output-of-two-functions-to-another-function-haskell/42859828#42859828", "title": "Feeding the output of two functions to another function Haskell", "body": "<p>You don't need parentheses on your function calls. <code>f (g h)</code> means f applied to a single argument which is <code>g h</code>. You probably want <code>function3 (function1 ...) (function2 ...)</code> where <code>...</code> is the arguments to each function.</p>\n"}], "owner": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 42859828, "answer_count": 1, "score": 1, "last_activity_date": 1489765054, "creation_date": 1489758991, "question_id": 42859416, "link": "https://stackoverflow.com/questions/42859416/feeding-the-output-of-two-functions-to-another-function-haskell", "title": "Feeding the output of two functions to another function Haskell", "body": "<p>I have three functions.</p>\n\n<pre><code>function1 :: [Person] -&gt; [String]\n\nfunction2 :: String -&gt; [Person] -&gt; [(String, Int)]\n\nfunction3 :: [String] -&gt; [(String, Int)] -&gt; [String]\n</code></pre>\n\n<p>I want the output of <code>function1</code> and <code>function2</code> to be passed to <code>function3</code>.\nE.g <code>function3(function1 function2)</code></p>\n\n<p>But <code>function1</code> and <code>function2</code> both have their own parameters so it'd look something like:</p>\n\n<pre><code>function3(function1([Person]) function2(String [Person]))\n</code></pre>\n\n<p>I've looked at function composition but that's when you feed the output of one function to another. In this case, I want to feed the output of two separate functions to another.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "type-constraints", "gadt"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1489757646, "post_id": 42858898, "comment_id": 72823929, "body": "Functor must be applicable for all types, not just those constrained by <code>Ord</code>.  You can&#39;t constrain it further even in your instance.  This is why structures like balanced trees can&#39;t be functors either."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1489758223, "post_id": 42858898, "comment_id": 72824366, "body": "You can&#39;t make that a functor. The usual way around that is then to simply implement a separate &quot;map&quot; function, as is done for <code>Data.Set</code> and <code>Data.Map</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 0, "creation_date": 1489791557, "post_id": 42859793, "comment_id": 72842790, "body": "Is your IxFunctor related to either <a href=\"http://stackoverflow.com/a/27771772/6112457\">this</a> or (slightly different) <a href=\"https://hackage.haskell.org/package/indexed-0.1.3/docs/Data-Functor-Indexed.html\" rel=\"nofollow noreferrer\">this</a>? I can&#39;t tell if they represent similar concepts in some way I&#39;m not seeing, or if they&#39;re completely different."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 1, "creation_date": 1489792363, "post_id": 42859793, "comment_id": 72843013, "body": "@ZoeyHewll It seems I messed up the terminology: the one above is not an indexed functor <code>f i j a</code>, but something else. I can&#39;t remember its proper name, but I would be surprised if this isn&#39;t found somewhere. I&#39;ll edit away the terminology so not to cause confusion. Thanks."}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 0, "creation_date": 1489794287, "post_id": 42859793, "comment_id": 72843544, "body": "For CFunctor, I&#39;m getting <code>Not in scope: type constructor or class \u2018Constraint\u2019</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 1, "creation_date": 1489825722, "post_id": 42859793, "comment_id": 72849347, "body": "@ZoeyHewll See my edit, I added the imports and reworked a bit the class, since I also realized we needed a functional dependency or type family. I went for the latter."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1489826379, "last_edit_date": 1489826379, "creation_date": 1489759971, "answer_id": 42859793, "question_id": 42858898, "link": "https://stackoverflow.com/questions/42858898/context-in-data-instances/42859793#42859793", "title": "Context in data instances", "body": "<p>You can't do this using the standard <code>Functor</code> class, since its <code>fmap</code> must work on <em>all</em> data types, without constraints.</p>\n\n<p>You could work with a different class. One option is to use an \"fine-grained functor\" class which lets you use a separate instance for each pairs of types <code>a b</code>. (Probably this already has some standard name, but I can't remember)</p>\n\n<pre><code>class FgFunctor f a b where\n   fgmap :: (a-&gt;b) -&gt; f a -&gt; f b\n\n-- regular functors are also fine-grained ones, e.g.\ninstance FgFunctor [] a b where\n   fgmap = fmap\n\ninstance (Ord a, Ord b) =&gt; FgFunctor OrdTriple a b where\n   fgmap f (OrdTriple n d x) = OrdTriple n' d' x'\n      where [n', d', x'] = sort [f n, f d, f x]\n</code></pre>\n\n<p>Alternatively, one can parametrize the <code>Functor</code> class with a constraint:</p>\n\n<pre><code>{-# LANGUAGE GADTs, KindSignatures, MultiParamTypeClasses, \n    ConstraintKinds, TypeFamilies, FlexibleInstances #-}\n{-# OPTIONS -Wall #-}\nmodule CFunctor where\n\nimport Data.List (sort)\nimport Data.Kind (Constraint)\n\ndata OrdTriple a where\n    OrdTriple :: (Ord a) =&gt; a -&gt; a -&gt; a -&gt; OrdTriple a\n\nclass CFunctor (f :: * -&gt; *) where\n   type C f a :: Constraint\n   cmap :: (C f a, C f b) =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n\n-- regular functors are also constrained ones, e.g.\ninstance CFunctor [] where\n   type C [] a = a ~ a\n   cmap = fmap\n\ninstance CFunctor OrdTriple where\n   type C OrdTriple a = Ord a\n   cmap f (OrdTriple n d x) = OrdTriple n' d' x'\n      where [n', d', x'] = sort [f n, f d, f x]\n</code></pre>\n"}], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 42859793, "answer_count": 1, "score": 0, "last_activity_date": 1489826379, "creation_date": 1489757523, "question_id": 42858898, "link": "https://stackoverflow.com/questions/42858898/context-in-data-instances", "title": "Context in data instances", "body": "<p>I have a datatype which only makes sense if its arguments can be ordered, however I seem to be needing to get deep into some complex and potentially hacky stuff to get it to work (GADTs, mainly).\nIs what I'm doing (constrained datatypes) considered bad haskell practice, and is there any way around this?</p>\n\n<p>For those interested, here's the relevant code:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE InstanceSigs #-}\nimport Data.List (sort)\n\ndata OrdTriple a where\n    OrdTriple :: (Ord a) =&gt; a -&gt; a -&gt; a -&gt; OrdTriple a\n\ninstance Functor OrdTriple where\n    fmap :: (Ord a, Ord b) =&gt; (a -&gt; b) -&gt; OrdTriple a -&gt; OrdTriple b\n    fmap f (OrdTriple n d x) = OrdTriple n' d' x'\n        where \n            [n', d', x'] = sort [f n, f d, f x]\n</code></pre>\n\n<p>At first I thought I'd just put a context in the Functor instance (it's the only instance I'm struggling with) but it seems I can't (no mention of the contained type), and even if I could I'd still need the constraint on <code>fmap</code> that its return type be orderable.</p>\n\n<p>As it is, I'm getting the following compile error, which it seems is because I'm overly constraining the Functor instance:</p>\n\n<pre><code>No instance for (Ord a)\nPossible fix:\n  add (Ord a) to the context of\n    the type signature for\n      fmap :: (a -&gt; b) -&gt; OrdTriple a -&gt; OrdTriple b\nWhen checking that:\n    forall a b.\n    (Ord a, Ord b) =&gt;\n    (a -&gt; b) -&gt; OrdTriple a -&gt; OrdTriple b\n  is more polymorphic than:\n    forall a b. (a -&gt; b) -&gt; OrdTriple a -&gt; OrdTriple b\nWhen checking that instance signature for \u2018fmap\u2019\n  is more general than its signature in the class\n  Instance sig: forall a b.\n                (Ord a, Ord b) =&gt;\n                (a -&gt; b) -&gt; OrdTriple a -&gt; OrdTriple b\n     Class sig: forall a b. (a -&gt; b) -&gt; OrdTriple a -&gt; OrdTriple b\nIn the instance declaration for \u2018Functor OrdTriple\u2019\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1489754040, "post_id": 42857060, "comment_id": 72821360, "body": "have you tried applying <code>realToFrac</code> to the result of <code>sqrt</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7726932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7b427f865c7001d172e26d1bb4c235?s=128&d=identicon&r=PG&f=1", "display_name": "Sal", "link": "https://stackoverflow.com/users/7726932/sal"}, "edited": false, "score": 0, "creation_date": 1489754393, "post_id": 42857621, "comment_id": 72821617, "body": "It is required in my assignment, that I am not supposed to change the function header, as we are supposed to use the tester provided to us"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 11, "user_id": 7726932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7b427f865c7001d172e26d1bb4c235?s=128&d=identicon&r=PG&f=1", "display_name": "Sal", "link": "https://stackoverflow.com/users/7726932/sal"}, "edited": false, "score": 0, "creation_date": 1489754766, "post_id": 42857621, "comment_id": 72821853, "body": "@Sal you can easily wrap this function to achieve the original signature, since you can convert <code>Point a</code> to <code>Point b</code> whenever <code>Real a</code> and <code>Fractional b</code>."}], "tags": [], "owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "is_accepted": false, "score": 2, "last_activity_date": 1489754726, "last_edit_date": 1489754726, "creation_date": 1489753816, "answer_id": 42857621, "question_id": 42857060, "link": "https://stackoverflow.com/questions/42857060/two-points-distance-haskell-without-changing-function-declaration/42857621#42857621", "title": "Two Points distance, Haskell without changing function declaration?", "body": "<p><code>sqrt</code> returns the same type as its argument:</p>\n\n<pre><code>Prelude&gt; :t sqrt\nsqrt :: Floating a =&gt; a -&gt; a\n</code></pre>\n\n<p>Since you're providing <code>b</code> as argument to <code>sqrt</code>, Haskell deduces that the return type must be <code>b</code> and not <code>a</code>.</p>\n\n<p>Is there a specific reason why you cannot use</p>\n\n<pre><code>distance :: Floating b =&gt; Point b -&gt; Point b -&gt; b\ndistance (x1,y1) (x2,y2) = sqrt ((dx * dx) + (dy * dy))\n  where dx = x2 - x1\n        dy = y2 - y1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1489754843, "post_id": 42857732, "comment_id": 72821911, "body": "This is now the correct solution, but IMO \u201chere have the working code\u201d answers are not great to homework questions."}, {"owner": {"reputation": 11, "user_id": 7726932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7b427f865c7001d172e26d1bb4c235?s=128&d=identicon&r=PG&f=1", "display_name": "Sal", "link": "https://stackoverflow.com/users/7726932/sal"}, "edited": false, "score": 0, "creation_date": 1489755092, "post_id": 42857732, "comment_id": 72822108, "body": "its not the exact answer I m looking for, and this was just a small function from the a larger project"}], "tags": [], "owner": {"reputation": 1556, "user_id": 1392943, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/606e0a60eca298e29ce56b5544de4950?s=128&d=identicon&r=PG&f=1", "display_name": "Kamel", "link": "https://stackoverflow.com/users/1392943/kamel"}, "is_accepted": false, "score": 0, "last_activity_date": 1489754777, "last_edit_date": 1489754777, "creation_date": 1489754081, "answer_id": 42857732, "question_id": 42857060, "link": "https://stackoverflow.com/questions/42857060/two-points-distance-haskell-without-changing-function-declaration/42857732#42857732", "title": "Two Points distance, Haskell without changing function declaration?", "body": "<pre><code>type Point a = (a,a)\ndistance :: (Real a, Floating b) =&gt; Point a -&gt; Point a -&gt; b\ndistance (x1,y1) (x2,y2) = sqrt ((dx * dx) + (dy * dy))\n  where dx = realToFrac $ x2 - x1\n        dy = realToFrac $ y2 - y1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7726932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7b427f865c7001d172e26d1bb4c235?s=128&d=identicon&r=PG&f=1", "display_name": "Sal", "link": "https://stackoverflow.com/users/7726932/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489756984, "creation_date": 1489752114, "last_edit_date": 1489756984, "question_id": 42857060, "link": "https://stackoverflow.com/questions/42857060/two-points-distance-haskell-without-changing-function-declaration", "title": "Two Points distance, Haskell without changing function declaration?", "body": "<p>For the distance between two Points, without changing the function declaration, I keep getting this error \"Couldn't match expected type \u2018b\u2019 with actual type \u2018a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\"</p>\n\n<pre><code>type Point a = (a,a)\ndistance :: (Real a, Floating b) =&gt; Point a -&gt; Point a -&gt; b\ndistance (x1,y1) (x2,y2) = sqrt ((dx * dx) + (dy * dy))\n  where dx = x2 - x1\n    dy = y2 - y1\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "catamorphism"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1489742947, "post_id": 42852525, "comment_id": 72813958, "body": "Not a lot of people consider the <code>extra</code> package to be common, so here&#39;s a link: <a href=\"https://hackage.haskell.org/package/extra-1.5.1/docs/Data-List-Extra.html#v:list\" rel=\"nofollow noreferrer\">list</a>."}, {"owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 0, "creation_date": 1489771221, "post_id": 42852525, "comment_id": 72833266, "body": "what&#39;s the type of <code>bool</code> with the definition you have above?"}, {"owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "edited": false, "score": 0, "creation_date": 1489827077, "post_id": 42852525, "comment_id": 72849658, "body": "The type of <code>bool</code> in the definition is <code>a -&gt; a -&gt; Bool -&gt; a</code> as defined <a href=\"https://hackage.haskell.org/package/bool-extras-0.4.0/docs/src/Data-Bool-Extras.html#bool\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 3370, "user_id": 722938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MtO4E.jpg?s=128&g=1", "display_name": "is7s", "link": "https://stackoverflow.com/users/722938/is7s"}, "edited": false, "score": 0, "creation_date": 1489829853, "post_id": 42852525, "comment_id": 72850316, "body": "@rubystallion but this definition for <code>bool</code> won&#39;t typecheck with the given definition of <code>cata</code>."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 5, "last_activity_date": 1489743261, "creation_date": 1489743261, "answer_id": 42853814, "question_id": 42852525, "link": "https://stackoverflow.com/questions/42852525/is-data-list-extras-list-function-the-catamorphism-of-list/42853814#42853814", "title": "Is Data.List.Extra&#39;s list function the catamorphism of list?", "body": "<p>The catamorphism for <code>[]</code> is <code>foldr</code>.</p>\n\n<p>The <code>list</code> function from the <code>extra</code> package is a conversion to Scott encoding, in the way that a catamorphism is a conversion to Church encoding.  Since Scott encodings are non-recursive, they can't really correspond to any recursion scheme.</p>\n"}], "owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 42853814, "answer_count": 1, "score": 1, "last_activity_date": 1561101453, "creation_date": 1489739064, "last_edit_date": 1561101453, "question_id": 42852525, "link": "https://stackoverflow.com/questions/42852525/is-data-list-extras-list-function-the-catamorphism-of-list", "title": "Is Data.List.Extra&#39;s list function the catamorphism of list?", "body": "<p>Haskell's base library contains several functions which are the lowercase versions of their respective data types, like <code>bool</code>, <code>maybe</code> and <code>either</code>. In the source code of Data.Bool.Extra, the <code>bool</code> function is clearly expressed as the data type's catamorphism:</p>\n\n<pre><code>bool = curry cata\n</code></pre>\n\n<p>Now, using the catamorphism as defined in <em>Recursion Schemes by Example</em>, it seems like the above-mentioned base library functions are all the catamorphisms of their data type, e.g. for Maybe:</p>\n\n<pre><code>-- base library definition\nmaybe n _ Nothing  = n\nmaybe _ f (Just x) = f x\n\n-- definition with cata\nnewtype Fix f = Fix {unFix :: f (Fix f)}\ncata :: Functor f =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a\ncata alg = alg . fmap (cata alg) . unFix\nmaybe n f m = cata alg where\n    alg Nothing = n\n    alg (Just x) = f x\n</code></pre>\n\n<p>However, Data.List.Extra's <code>list</code> function is just mentioned in the comments as a \"Non-recursive transform over a list, like 'maybe'\", but as it is non-recursive in contrast to its data type, it apparently is not any recursion scheme of list either, or is it? Is that why it's not defined in the base library? Does the function have any other nice theoretical properties?</p>\n"}, {"tags": ["haskell", "custom-data-type"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7255172, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1uYhv1mwFCQ/AAAAAAAAAAI/AAAAAAAAAso/defmMxoAJho/photo.jpg?sz=128", "display_name": "Saad", "link": "https://stackoverflow.com/users/7255172/saad"}, "edited": false, "score": 0, "creation_date": 1489773315, "post_id": 42848855, "comment_id": 72834492, "body": "I think I meant with empty string of fans, not &quot;without it&quot;. Sorry and thanks."}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 0, "last_activity_date": 1489722272, "creation_date": 1489722272, "answer_id": 42848855, "question_id": 42848545, "link": "https://stackoverflow.com/questions/42848545/what-do-i-type-in-as-the-value-for-the-filmlist-parameter/42848855#42848855", "title": "What do I type in as the value for the filmList parameter?", "body": "<p>You need to use the data constructor, not just the arguments to it. If you want to create a value of type <code>Film</code>, you need to write for example: <code>Film \"Kong: Skull Island\" \"Jordan Vogt-Roberts\" 2017 [\"Fan One\",\"Fan Two\"]</code>.</p>\n\n<p>More specifically a data declaration like <code>data TypeName = DataConstructor String</code> creates a function <code>DataConstructor :: String -&gt; TypeName</code>. In your case, that is <code>Film :: String -&gt; String -&gt; Int -&gt; [String] -&gt; Film</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>skullIsland = Film \"Kong: Skull Island\" \"Jordan Vogt-Roberts\" 2017 [\"Fan One\",\"Fan Two\"]\notherMovie = Film \"Movie Name\" \"The Director\" 2000 [\"Lazersmoke\",\"Saad\"]\n\naddFilm skullIsland [otherMovie,otherMovie]\n</code></pre>\n\n<blockquote>\n  <p>but without the fans string array</p>\n</blockquote>\n\n<p>I'm not sure I understand what you are trying to do; the fans list is part of your data type, you can't just ignore it.</p>\n"}], "owner": {"reputation": 3, "user_id": 7255172, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1uYhv1mwFCQ/AAAAAAAAAAI/AAAAAAAAAso/defmMxoAJho/photo.jpg?sz=128", "display_name": "Saad", "link": "https://stackoverflow.com/users/7255172/saad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 42848855, "answer_count": 1, "score": 0, "last_activity_date": 1489722272, "creation_date": 1489720253, "last_edit_date": 1489720334, "question_id": 42848545, "link": "https://stackoverflow.com/questions/42848545/what-do-i-type-in-as-the-value-for-the-filmlist-parameter", "title": "What do I type in as the value for the filmList parameter?", "body": "<pre><code>data Film = Film String String Int [String] deriving (Eq, Ord, Show, Read)\n--that's my custom data type, (Film *filmname, director, year of release, fans)\n\naddFilm :: Film -&gt; [Film] -&gt; [Film]\naddFilm newFilm filmList = filmList ++ [newFilm]\n\n--this is for adding a new film to the list, but without the fans string array\n</code></pre>\n\n<p>The module is loading into WinGHCi with no errors, but I don't know what to put in place of filmList.</p>\n\n<pre><code>---\n&lt;interactive&gt;:63:30:\n    Couldn't match type `Char' with `Film'\n    Expected type: [Film]\n      Actual type: [Char]\n    In the second argument of `addFilm', namely `\"Jordan Vogt-Roberts\"'\n    In the expression:\n      addFilm \"Kong: Skull Island\" \"Jordan Vogt-Roberts\" 2017\n    In an equation for `it':\n        it = addFilm \"Kong: Skull Island\" \"Jordan Vogt-Roberts\" 2017\n*Main&gt; addFilm \"Kong: Skull Island\" \"Jordan Vogt-Roberts\" 2017 filmList\n\n&lt;interactive&gt;:64:57: Not in scope: `filmList' --- that's what I input.\n</code></pre>\n"}, {"tags": ["haskell", "type-constraints", "type-families"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1489722730, "post_id": 42848316, "comment_id": 72805793, "body": "I think this is undecidable in general; note that <code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code>, but equally validly it has type <code>(Num a,Eq a,Show a) =&gt; a -&gt; a -&gt; a</code>. What should the result type of <code>F (Num a =&gt; a -&gt; a -&gt; a)</code> be in this case?  I just realized this is somewhat relate to <a href=\"https://github.com/Lazersmoke/ghost-buster/blob/master/src/Data/SuchThat.hs#L22\" rel=\"nofollow noreferrer\">this thingy</a> I wrote recently. IDK if it will help with what you are doing, though."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1489727825, "post_id": 42848316, "comment_id": 72807163, "body": "This would require ImpredicateTypes (which doesn&#39;t really work), as the application <code>f (+)</code> would require instantiating <code>a</code> in the type of <code>f</code> to <code>forall x . Num x =&gt; x -&gt; x -&gt; x</code>. If your goal is to have a simple syntax for function symbols, consider using TH - you will be able to analyze the actual polymorphic type of the argument."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489718695, "creation_date": 1489718695, "question_id": 42848316, "link": "https://stackoverflow.com/questions/42848316/distinguishing-types-based-on-constraints", "title": "Distinguishing types based on constraints", "body": "<p>Firstly, I'll explain a simplified version of my problem, then the actual problem.</p>\n\n<p>Consider the types of <code>max</code> and <code>(+)</code></p>\n\n<pre><code>max :: Ord a =&gt; a -&gt; a -&gt; a\n(+) :: Num a =&gt; a -&gt; a -&gt; a \n</code></pre>\n\n<p>Notice they only differ by their constraint. I want to write a type family F so I've got something like:</p>\n\n<pre><code>f :: a -&gt; F a\n</code></pre>\n\n<p>So that</p>\n\n<pre><code>f max\n</code></pre>\n\n<p>has a different type to</p>\n\n<pre><code>f (+)\n</code></pre>\n\n<p>Now the actual problem.</p>\n\n<p>Given (from my <a href=\"https://hackage.haskell.org/package/polydata-0.1.0.0/docs/Data-Poly.html#t:Poly\" rel=\"nofollow noreferrer\">polydata</a> package):</p>\n\n<pre><code>data Poly (c :: * -&gt; Constraint) where\n  Poly :: { getPoly :: (forall a. c a =&gt; a) } -&gt; Poly c\n</code></pre>\n\n<p>I want to be able to write <code>mkPoly (+)</code> without explicitly specifying the constraint myself. </p>\n\n<p>I figure perhaps I could make a type family that converts types into constraints, as it's a fairly mechanical process.</p>\n\n<p>That's the background behind my question, but I thought asking a simpler problem would be a good start.</p>\n"}, {"tags": ["haskell", "recursion", "pi"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489737430, "post_id": 42847682, "comment_id": 72811032, "body": "A function result is generally recomputed at every function call -- GHC might optimize this so to avoid recomputation, but does not to. Indeed, to always avoid recomputation, GHC would need to cache all the results of all the functions that have been called in the past. That would make garbage collecting anything impossible, since that cache would keep anything alive. Worse, the cache would steadily increase during the program execution, severely impacting performance."}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1489715909, "creation_date": 1489715909, "answer_id": 42847918, "question_id": 42847682, "link": "https://stackoverflow.com/questions/42847682/why-is-this-function-being-called-every-time-i-try-to-get-its-value/42847918#42847918", "title": "Why is this function being called every time I try to get its value?", "body": "<p>GHCi doesn't optimize is well enough to figure out it shouldn't re-evaluate it each time you print it. Normal GHC will properly cache the result if you compile with the usual <code>-O2</code> flag.</p>\n\n<p><a href=\"http://rextester.com/WUEJ73364\" rel=\"nofollow noreferrer\">Try it online</a> and compare the total running time to the number of times it prints out \"Pi:3.14...\"</p>\n"}, {"tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 2, "last_activity_date": 1489778920, "creation_date": 1489778920, "answer_id": 42865677, "question_id": 42847682, "link": "https://stackoverflow.com/questions/42847682/why-is-this-function-being-called-every-time-i-try-to-get-its-value/42865677#42865677", "title": "Why is this function being called every time I try to get its value?", "body": "<p>What's biting you here is what's known as the monomorphism restriction \u2013 but unusually, it's the <em>lack</em> of the monomorphism restriction, rather than its presence.  It turns out <code>pi</code> isn't quite as constant as you expected, because its type is more general than you may have realized.</p>\n\n<hr>\n\n<p>If we turn on profiling information at the REPL:</p>\n\n<pre><code>*Main&gt; :set +s\n</code></pre>\n\n<p>Then we can see that <code>pi</code> is recomputed every time, like you said.</p>\n\n<pre><code>*Main&gt; pi = calcPi 666666\n(0.00 secs, 0 bytes)\n*Main&gt; pi\n3.141591153588293\n(0.94 secs, 551,350,552 bytes)\n*Main&gt; pi\n3.141591153588293\n(0.99 secs, 551,300,808 bytes)\n</code></pre>\n\n<p>This is because the <em>type</em> of <code>pi</code> is inferred to be type class polymorphic:</p>\n\n<pre><code>*Main&gt; :t pi\npi :: (Fractional a, Eq a) =&gt; a\n</code></pre>\n\n<p>So <code>pi</code> is in a certain sense \"not really a constant\"; there are lots of <code>pi</code>s!  There's <code>pi :: Double</code>, there's <code>pi :: Float</code>, there's <code>pi :: Complex Double</code>, and so on.  And GHC doesn't cache function applications, so <code>pi</code> is recomputed every time.</p>\n\n<p>In Haskell <em>files</em>, however, the monomorphism restriction is in effect: a variable binding, like <code>x = \u2026</code>, is never inferred to have a type class polymorphic type like <code>C a =&gt; \u2026</code>.  Such definitions are <em>defaulted</em>, if possible \u2013 a process where Haskell makes values polymorphic in standard numeric type classes monomorphic at <code>Integer</code> or <code>Double</code>.  This is why you can write <code>x^2</code> without getting an \"ambiguous type variable\" error (even though the type of the exponent doesn't influence the type of the output); the <code>2</code> is silently inferred to be of type <code>Integer</code>.</p>\n\n<p>But the monomorphism restriction only applies inside files.  In GHCi, it's disabled.  If we turn the monomorphism restriction back on:</p>\n\n<pre><code>*Main&gt; :set -XMonomorphismRestriction\n</code></pre>\n\n<p>Then we can define <code>pi'</code>, which we'll only need to calculate once.</p>\n\n<pre><code>*Main&gt; pi' = calcPi 666666\n(0.00 secs, 0 bytes)\n*Main&gt; pi'\n3.141591153588293\n(0.87 secs, 551,303,896 bytes)\n*Main&gt; pi'\n3.141591153588293\n(0.00 secs, 315,168 bytes)\n</code></pre>\n\n<p>And that's because <code>pi'</code> really is a constant.</p>\n\n<pre><code>*Main&gt; :t pi'\npi' :: Double\n</code></pre>\n\n<hr>\n\n<p>An additional few notes:</p>\n\n<ol>\n<li><p>Laziness doesn't have to do with why calculating <code>pi'</code> is fast the second time; this would be true in a strict language too.  Laziness is why the lines where we define <code>pi</code>/<code>pi'</code> report \"(0.00 secs, 0 bytes)\".</p></li>\n<li><p>It's not clear to me if you thought it might, but Haskell will <em>never</em> cache the recursive calls you're making.  Something like <code>calcPi 666666</code> will always make all 666,666 recursive calls.  It's only once you save it explicitly in a variable that you stop recomputation.</p></li>\n<li><p>The monomorphism restriction and type defaulting are explained in technical language in the Haskell 2010 report: <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-930004.5.5\" rel=\"nofollow noreferrer\">\u00a74.4.5 \"The Monomorphism Restriction</a>, and <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-790004.3.4\" rel=\"nofollow noreferrer\">\u00a74.3.4 \"Ambiguous Types, and Defaults for Overloaded Numeric Operations\"</a>.  The GHC User's Guide mentions that the monomorphism restriction is disabled in GHCi, and mentions how to re-/dis-enable it: <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#switching-off-the-dreaded-monomorphism-restriction\" rel=\"nofollow noreferrer\">\u00a79.17.1 \"Switching off the dreaded Monomorphism Restriction\"</a></p></li>\n</ol>\n"}], "owner": {"reputation": 230, "user_id": 4064871, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-m120Xswr1B0/AAAAAAAAAAI/AAAAAAAAACA/RcMDxAI5g-s/photo.jpg?sz=128", "display_name": "name", "link": "https://stackoverflow.com/users/4064871/name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 42865677, "answer_count": 2, "score": 2, "last_activity_date": 1489778920, "creation_date": 1489714224, "question_id": 42847682, "link": "https://stackoverflow.com/questions/42847682/why-is-this-function-being-called-every-time-i-try-to-get-its-value", "title": "Why is this function being called every time I try to get its value?", "body": "<p>I have this Haskell code that I wrote to calculate pi using the series <code>\u03c0/4 = 1 - 1/3 + 1/5 - 1/7 + 1/9...</code>:</p>\n\n<pre><code>quarterPi total n s = if (n /= total) then s / (2 * n - 1) + quarterPi total (n + 1) (-s) else s / (2 * n - 1)\n\ncalcPi n = 4 * quarterPi n 1 1\n</code></pre>\n\n<p>I ran the code using the GHCi prelude and tried to store an approximation of pi in a variable; something like: <code>*Main&gt; pi = calcPi 666666</code>, which would obviously take many many recursive iterations before finishing the calculation. I understand that the first time I retrieve the value of <code>pi</code>, it will take time to calculate because of lazy evaluation. For some reason though, it always takes a long time; no matter how many times I use the value or output the value on the screen, it takes several seconds to produce a result. Shouldn't it only have to calculate once because of lazy evaluation?</p>\n"}, {"tags": ["java", "haskell"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1489712013, "post_id": 42847287, "comment_id": 72802884, "body": "I think you&#39;re only going to find ocaml examples for type variables, they aren&#39;t implemented in the mathematical sense in Java. And when I hear haskell, I think <a href=\"https://wiki.haskell.org/Monad\" rel=\"nofollow noreferrer\">monad</a> (but I don&#39;t really know haskell)."}, {"owner": {"reputation": 136042, "user_id": 5221149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4qlq.png?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5221149/andreas"}, "edited": false, "score": 0, "creation_date": 1489712064, "post_id": 42847287, "comment_id": 72802899, "body": "Where did <i>we</i> mention type variables? Anyway, are you asking about a Java generics type variable, also known as a &quot;<a href=\"https://docs.oracle.com/javase/tutorial/java/generics/types.html\" rel=\"nofollow noreferrer\">type parameter</a>&quot; (\u21d0 Link to &quot;The Java\u2122 Tutorials&quot;)?"}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "reply_to_user": {"reputation": 136042, "user_id": 5221149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4qlq.png?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5221149/andreas"}, "edited": false, "score": 1, "creation_date": 1489712107, "post_id": 42847287, "comment_id": 72802911, "body": "@Andreas Well, just now for you..."}, {"owner": {"reputation": 136042, "user_id": 5221149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4qlq.png?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5221149/andreas"}, "edited": false, "score": 0, "creation_date": 1489712689, "post_id": 42847287, "comment_id": 72803064, "body": "@ScaryWombat Just because I think that using better scoped words (like <code>field</code> and <code>parameter</code>) where appropriate, given that <code>variable</code> is too wide in meaning, in order to prevent confusion/miscommunication, that doesn&#39;t make me a word-nazi. ;-) Bad code happens when miscommunication occurs, so as a good programmer, you should support me. :-P"}, {"owner": {"reputation": 41460, "user_id": 2310289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PO7Uz.jpg?s=128&g=1", "display_name": "Scary Wombat", "link": "https://stackoverflow.com/users/2310289/scary-wombat"}, "reply_to_user": {"reputation": 136042, "user_id": 5221149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4qlq.png?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5221149/andreas"}, "edited": false, "score": 0, "creation_date": 1489713783, "post_id": 42847287, "comment_id": 72803362, "body": "@Andreas and I should realize that humour does not always work on the net."}, {"owner": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "reply_to_user": {"reputation": 136042, "user_id": 5221149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4qlq.png?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5221149/andreas"}, "edited": false, "score": 0, "creation_date": 1489714624, "post_id": 42847287, "comment_id": 72803566, "body": "@Andreas True, I&#39;m asking type parameter. I thought it is the same as type variable because our professor wrote type variable/parameter on the blackboard."}], "answers": [{"comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1489717001, "post_id": 42847453, "comment_id": 72804223, "body": "Java Generic types don&#39;t work for primitive types, and they are a compile time type safety system (they are mostly <i>erased</i> at compile time). So they aren&#39;t &quot;pure&quot; in any sense..."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1489721695, "post_id": 42847453, "comment_id": 72805513, "body": "@ElliottFrisch What do you mean they don&#39;t work for primitive types? Can I not use <code>ArrayList&lt;boolean&gt;</code>? <a href=\"http://stackoverflow.com/questions/12468722/does-haskell-erase-types\"><i>All</i> type information in Haskell is erased at runtime</a>, so they are similar in that respect. How does any of this impact how &quot;pure&quot; anything here is? If you mean pure as in &quot;no side effects&quot;, I don&#39;t see how that applies here at all."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1489722224, "post_id": 42847453, "comment_id": 72805673, "body": "No. You can not use <code>ArrayList&lt;boolean&gt;</code> <i>or</i> <code>ArrayList&lt;int&gt;</code> for that matter. You&#39;d have to use the wrapper types."}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 1, "last_activity_date": 1489722337, "last_edit_date": 1489722337, "creation_date": 1489712786, "answer_id": 42847453, "question_id": 42847287, "link": "https://stackoverflow.com/questions/42847287/what-is-type-variable-in-haskell-java/42847453#42847453", "title": "What is type variable in haskell/Java", "body": "<p>A type variable is a way to have polymorphism by writing a single function/method that works on multiple different types of values. Here is an example in Haskell:</p>\n\n<pre><code>id :: forall a. a -&gt; a\nid x = x\n</code></pre>\n\n<p>The <code>a</code> in the type signature is a type variable, and as the <code>forall</code> implies, this function works \"for all\" different types. For example, you can use <code>id</code> as if it had the type <code>Int -&gt; Int</code> or as if it had the type <code>Char -&gt; Char</code>.</p>\n\n<pre><code>id (5 :: Int) = 5 :: Int\nid 'a' = 'a'\n</code></pre>\n\n<p>If <code>id</code> was given a concrete type (meaning without type variables in it) such as <code>id :: Int -&gt; Int</code>, then <code>id 'a'</code> would be a type error because <code>'a'</code>'s type (<code>Char</code>) doesn't match <code>Int</code>.</p>\n\n<p>Usually, we omit the <code>forall</code> (<code>id :: a -&gt; a</code>) because it can easily be inferred from the use of type variables, but it is helpful for understanding what is really going on.</p>\n\n<p>I don't know as much Java as Haskell, but Generics seems to be a way to use a type variable, so <code>ArrayList&lt;A&gt;</code> means an array list that works for any non-primitive type <code>A</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 2, "last_activity_date": 1489712815, "creation_date": 1489712815, "answer_id": 42847460, "question_id": 42847287, "link": "https://stackoverflow.com/questions/42847287/what-is-type-variable-in-haskell-java/42847460#42847460", "title": "What is type variable in haskell/Java", "body": "<p>Well, it's very easy. The basic observation is that we do not only have basic types like Int and Bool and Char, but types composed from other types.</p>\n\n<p>The simplest example are lists. In a type safe language, all elements of a list must have the same type. That is why we write:</p>\n\n<pre><code>Haskell   Java               Explanation\n[Int]     List&lt;Integer&gt;      list of integers\n[Char]    List&lt;Character&gt;    list of characters\n</code></pre>\n\n<p>and so on. This is nice already, but not nice enough. It turns out that certain functions on lists are absolutely identical except for the element type, and that the element type is irrelevant inside the function. Here is an example:</p>\n\n<pre><code>lengthIntList :: [Int] -&gt; Int    -- compute length of a list of int\nlengthIntList [] = 0\nlengthIntList (x:xs) = 1 + length xs\n\nlengthCharList :: [Char] -&gt; Int    -- compute length of a list of char\nlengthCharList [] = 0\nlengthCharList (x:xs) = 1 + length xs\n</code></pre>\n\n<p>Therefore, the next step is to abstract from the element type and say:</p>\n\n<pre><code>length :: [a] -&gt; Int       -- length of a list, for all elemen types\nlength [] = 0\nlength (x:xs) = 1 + length xs\n</code></pre>\n\n<p>Here, the <code>a</code> is a type variable that says: For all types, this function <code>length</code>takes a list of that type and returns an <code>Int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1489717583, "post_id": 42847469, "comment_id": 72804378, "body": "What is <code>t</code> in your example? Did you mean <code>return a;</code>?"}], "tags": [], "owner": {"reputation": 103, "user_id": 7710493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2cdd850ff7561cc09d9d3fecc919fcf?s=128&d=identicon&r=PG&f=1", "display_name": "tekbe", "link": "https://stackoverflow.com/users/7710493/tekbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1489743736, "last_edit_date": 1489743736, "creation_date": 1489712861, "answer_id": 42847469, "question_id": 42847287, "link": "https://stackoverflow.com/questions/42847287/what-is-type-variable-in-haskell-java/42847469#42847469", "title": "What is type variable in haskell/Java", "body": "<p>The example from wikipedia can be written in Java like this</p>\n\n<pre><code>public static &lt;T&gt; T identity(T a) {\n    return a;\n}\n</code></pre>\n\n<p>where the type of <code>a</code> is bound to the type parameter <code>T</code>. So when you call the identity function with an <code>Integer</code> you get back an <code>Integer</code>, when you call it with a <code>String</code> you get back a <code>String</code>.</p>\n\n<p>A very common usage example would be a collection of values of the same type like a list of Strings:</p>\n\n<pre><code>List&lt;String&gt; as = new ArrayList&lt;String&gt;();\n</code></pre>\n\n<p>The type parameter in the <code>List</code> interface is bound to <code>String</code> therefore all elements of that list must be of type <code>String</code>.</p>\n\n<p>Updated code snippet, thanks Elliott.</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 5771177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f66c6628f434a7998195c89f2af5427b?s=128&d=identicon&r=PG&f=1", "display_name": "suffi", "link": "https://stackoverflow.com/users/5771177/suffi"}, "is_accepted": true, "score": 1, "last_activity_date": 1489761317, "creation_date": 1489761317, "answer_id": 42860248, "question_id": 42847287, "link": "https://stackoverflow.com/questions/42847287/what-is-type-variable-in-haskell-java/42860248#42860248", "title": "What is type variable in haskell/Java", "body": "<p>With Type variables you can define a datatype/container for things (Numbers, Text, ...) of a non-specified type. To provide an easy example, imagine, you want a Box, where you can put in anything you want.</p>\n\n<p>Here is an example in Java (T is the type-variable):</p>\n\n<pre><code>public class Box&lt;T&gt; {\n    private T thing;\n\n    public void putThing(T thing) {\n        this.thing = thing;\n    }\n}\n</code></pre>\n\n<p>Here is an example in Haskell (a is the type-variable):</p>\n\n<pre><code>data Box a = PutThing a\n</code></pre>\n\n<p>Another good example would be a generic tuple datatype.</p>\n\n<hr>\n\n<p><strong>Example usecases</strong></p>\n\n<p>Note, in both cases the type-variables are now specified types.</p>\n\n<p>Java:</p>\n\n<pre><code>Box&lt;String&gt; box = new Box&lt;String&gt;();\nbox.putThing(\"42\");    \n</code></pre>\n\n<p>Haskell (in ghci):</p>\n\n<pre><code>:t (PutThing (42::Int))\n(PutThing (42::Int)) :: Box Int\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7326810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6623db470d0fe9ba6906d77f70314483?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Zhao", "link": "https://stackoverflow.com/users/7326810/ryan-zhao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1892, "favorite_count": 1, "accepted_answer_id": 42860248, "answer_count": 4, "score": 0, "last_activity_date": 1489761317, "creation_date": 1489711523, "question_id": 42847287, "link": "https://stackoverflow.com/questions/42847287/what-is-type-variable-in-haskell-java", "title": "What is type variable in haskell/Java", "body": "<p>Today we mentioned type variable. But I don't understand what it means. I can only find one explanation on wiki, <a href=\"https://en.wikipedia.org/wiki/Type_variable\" rel=\"nofollow noreferrer\">type variable</a></p>\n\n<p>I understand the explanation in math, but still, have no idea about programming. Can anyone give an explanation?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489708438, "post_id": 42846667, "comment_id": 72801962, "body": "Hint: first write a function <code>Int -&gt; [Int] -&gt; [Int]</code> that multiplies a single integer with a list of integers in the way you described it."}, {"owner": {"reputation": 1392, "user_id": 6533594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb40113ccda27e832d41311fc8a0977b?s=128&d=identicon&r=PG&f=1", "display_name": "flpn", "link": "https://stackoverflow.com/users/6533594/flpn"}, "edited": false, "score": 1, "creation_date": 1489709042, "post_id": 42846667, "comment_id": 72802149, "body": "<code>multiplyByValue n list = [x*n | x &lt;- list]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1489710492, "post_id": 42846979, "comment_id": 72802520, "body": "And incidentally, looking at the simplified code makes it particularly clear that we are just reimplementing <code>map</code> here. There&#39;s nothing wrong with doing that for practice, but a real solution would not use any explicit recursion at all."}], "tags": [], "owner": {"reputation": 12066, "user_id": 3924118, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/abb01e1c2a8e3d9e1534dca14b19b3d8?s=128&d=identicon&r=PG&f=1", "display_name": "nbro", "link": "https://stackoverflow.com/users/3924118/nbro"}, "is_accepted": true, "score": 1, "last_activity_date": 1507904164, "last_edit_date": 1507904164, "creation_date": 1489709314, "answer_id": 42846979, "question_id": 42846667, "link": "https://stackoverflow.com/questions/42846667/how-can-i-multiply-two-lists-by-elements-in-haskell/42846979#42846979", "title": "How can I multiply two lists by elements in Haskell?", "body": "<p>Here's a possible solution:</p>\n\n<pre><code>module ListsProduct where\n\n-- function which given a number and a list returns a list representing\n-- the elements of the list multipled by the number\ng :: Int -&gt; [Int] -&gt; [Int]\ng _ [] = []\ng a (x:xs) = a*x : g a xs\n\n\n-- Recursion proceeds by analysing each element of the first list\n-- and multiply it by all elements of the second\nf :: [Int] -&gt; [Int] -&gt; [[Int]]\nf [] _ = [[]]\nf (x:xs) b = g x b : f xs b\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6648, "user_id": 464306, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8KCe.png?s=128&g=1", "display_name": "gdejohn", "link": "https://stackoverflow.com/users/464306/gdejohn"}, "edited": false, "score": 0, "creation_date": 1489725228, "post_id": 42847358, "comment_id": 72806442, "body": "Here&#39;s a fun one: <code>multiplyElements = flip (map . flip (map . (*)))</code>"}], "tags": [], "owner": {"reputation": 1392, "user_id": 6533594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb40113ccda27e832d41311fc8a0977b?s=128&d=identicon&r=PG&f=1", "display_name": "flpn", "link": "https://stackoverflow.com/users/6533594/flpn"}, "is_accepted": false, "score": 1, "last_activity_date": 1489711976, "creation_date": 1489711976, "answer_id": 42847358, "question_id": 42846667, "link": "https://stackoverflow.com/questions/42846667/how-can-i-multiply-two-lists-by-elements-in-haskell/42847358#42847358", "title": "How can I multiply two lists by elements in Haskell?", "body": "<p>Thanks for the support guys, here's my resolution:</p>\n\n<pre><code>multiplyByValue :: Int -&gt; [Int] -&gt; [Int]\nmultiplyByValue n list = [x*n | x &lt;- list]\n\nmultiplyLists :: [Int] -&gt; [Int] -&gt; [[Int]]\nmultiplyLists list1 list2 = [multiplyByValue x list2 | x &lt;- list1]\n</code></pre>\n"}], "owner": {"reputation": 1392, "user_id": 6533594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb40113ccda27e832d41311fc8a0977b?s=128&d=identicon&r=PG&f=1", "display_name": "flpn", "link": "https://stackoverflow.com/users/6533594/flpn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1224, "favorite_count": 0, "accepted_answer_id": 42846979, "answer_count": 2, "score": -2, "last_activity_date": 1507904164, "creation_date": 1489707211, "question_id": 42846667, "link": "https://stackoverflow.com/questions/42846667/how-can-i-multiply-two-lists-by-elements-in-haskell", "title": "How can I multiply two lists by elements in Haskell?", "body": "<p>I want a function that gets two lists of Int and generate a list of lists, where each list is the result of the product of each element of the first list by the whole second list. Here's an example:</p>\n\n<ul>\n<li>Definition of the function : <code>multiplyElements :: [Int] -&gt; [Int] -&gt; [[Int]]</code></li>\n<li>What I want to do: </li>\n<li>List 1: <code>[1, 2, 3]</code> and List 2: <code>[4, 5, 6]</code></li>\n<li>Result: <code>[[4, 5, 6], [8, 10, 12], [12, 15, 18]]</code></li>\n</ul>\n\n<p>`</p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1489705396, "post_id": 42846265, "comment_id": 72800997, "body": "<code>Int</code> does not take a type argument, so you want <code>divide100By :: Int -&gt; Maybe Int</code>. Your function body also has at least 3 other problems..."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5898355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62423615880d1a180d38237137067337?s=128&d=identicon&r=PG&f=1", "display_name": "Zach J", "link": "https://stackoverflow.com/users/5898355/zach-j"}, "edited": false, "score": 0, "creation_date": 1489773625, "post_id": 42846353, "comment_id": 72834696, "body": "Thanks, it does work, I have seen this solution somewhere before. But can you also tell me why &#39;case&#39; will not work?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 81, "user_id": 5898355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62423615880d1a180d38237137067337?s=128&d=identicon&r=PG&f=1", "display_name": "Zach J", "link": "https://stackoverflow.com/users/5898355/zach-j"}, "edited": false, "score": 0, "creation_date": 1489773982, "post_id": 42846353, "comment_id": 72834889, "body": "@ZachJ <code>case</code> does work (see the edit), but you can only <code>case</code> on the input, which is an integer and not a <code>Maybe Int</code>, so you can&#39;t pattern match against <code>Nothing&#47;Just x</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1489773919, "last_edit_date": 1489773919, "creation_date": 1489705445, "answer_id": 42846353, "question_id": 42846265, "link": "https://stackoverflow.com/questions/42846265/haskell-function-definition-error-not-in-scope/42846353#42846353", "title": "Haskell function definition error: Not in scope", "body": "<p>The integer type is <code>Int</code>, writing <code>Int a</code> means nothing since <code>Int</code> does not take arguments.</p>\n\n<p>Also, <code>Int x</code> is not an expression, so you can't <code>case</code> on that.</p>\n\n<p>Further, you use <code>case</code> with <code>Nothing/Just x</code> when you have a <code>Maybe a</code> type and you want to check what is its value. Here instead you want to construct a <code>Maybe a</code> type.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>divide100By :: Int -&gt; Maybe Int\ndivide100By 0 = Nothing\ndivide100By x = Just (100 `div` x)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>divide100By :: Int -&gt; Maybe Int\ndivide100By y = case y of\n   0 -&gt; Nothing\n   x -&gt; Just (100 `div` x)\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5898355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62423615880d1a180d38237137067337?s=128&d=identicon&r=PG&f=1", "display_name": "Zach J", "link": "https://stackoverflow.com/users/5898355/zach-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489773919, "creation_date": 1489705024, "question_id": 42846265, "link": "https://stackoverflow.com/questions/42846265/haskell-function-definition-error-not-in-scope", "title": "Haskell function definition error: Not in scope", "body": "<p>I'm new to Haskell, and I'm stuck with an example. I'd like to experiment with the Maybe type, but my code does not compile:</p>\n\n<pre><code>divide100By :: Int a -&gt; Maybe a\ndivide100By x = case (Int x) of \n    Nothing -&gt; Nothing\n    Just x -&gt; 100 / x\n\nmain = putStrLn (\"Result: \" ++ show (divide100By 5))\n</code></pre>\n\n<p>But I'm always getting the error: </p>\n\n<pre><code>Not in scope: data constructor 'Int'\n</code></pre>\n\n<p>I'm afraid I don't quite get the function definition in Haskell (the divide100By :: Int a -> Maybe a part)... Can someone please tell me what's wrong here? </p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1489704807, "post_id": 42846194, "comment_id": 72800815, "body": "What exactly is the code that causes this error? We can&#39;t solve your problem if you don&#39;t describe it fully."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1489708766, "post_id": 42846318, "comment_id": 72802069, "body": "There&#39;s a much simpler solution which I think is worth mentioning: use a <code>.cabal</code> file and don&#39;t depend on both <code>matrices</code> and <code>matrix</code> in it. It seems unlikely that both packages are really needed in a single application/library."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489708826, "post_id": 42846318, "comment_id": 72802090, "body": "@DanielWagner I considered mentioning that, but I assumed the OP needed both packages, so that wasn\u2019t an option. In general, though, yes, usually only one of the packages will be visible, resolving the ambiguity."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 5, "last_activity_date": 1489705300, "creation_date": 1489705300, "answer_id": 42846318, "question_id": 42846194, "link": "https://stackoverflow.com/questions/42846194/ambiguous-interface/42846318#42846318", "title": "Ambiguous interface", "body": "<p>Using <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/users_guide/glasgow_exts.html#package-qualified-imports\" rel=\"noreferrer\">the <code>PackageImports</code> language extension</a>, you can qualify an import with a particular package:</p>\n\n<pre><code>{-# LANGUAGE PackageImports #-}\nimport \"matrix\" Data.Matrix\n</code></pre>\n\n<p>However, as the documentation suggests, it\u2019s not always a great idea. There are other ways to solve the problem, including <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/users_guide/packages.html#package-thinning-and-renaming\" rel=\"noreferrer\">renaming modules from particular packages using GHC flags</a>. For example, you could change <code>Data.Matrix</code> from <code>matrix</code> to a different name with the following GHC options:</p>\n\n<pre><code>-package \"matrix (Data.Matrix as Data.OtherMatrix)\"\n</code></pre>\n\n<p>You may choose the option that works best for you, depending on the specifics and your needs.</p>\n"}], "owner": {"reputation": 13, "user_id": 3584332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ba5aa8c8c2e6fbdc302562975149974?s=128&d=identicon&r=PG&f=1", "display_name": "user3584332", "link": "https://stackoverflow.com/users/3584332/user3584332"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 42846318, "answer_count": 1, "score": 1, "last_activity_date": 1489705300, "creation_date": 1489704663, "question_id": 42846194, "link": "https://stackoverflow.com/questions/42846194/ambiguous-interface", "title": "Ambiguous interface", "body": "<p>I am  getting the following error when trying to compile my Haskel code</p>\n\n<pre><code>Main.hs:11:1: error:\n    Ambiguous interface for \u2018Data.Matrix\u2019:\n      it was found in multiple packages: matrices-0.4.4 matrix-0.3.5.0\n</code></pre>\n\n<p>How do I solve this. I cannot use hide since it is the whole interface that is abiguous.</p>\n"}, {"tags": ["haskell", "functor", "foldable"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 1, "creation_date": 1489702893, "post_id": 42845801, "comment_id": 72800119, "body": "Why would you want to do this? It&#39;s simply a silly idea. On another note, Functor and Foldable are not types, nor are there subtypes in Haskell."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1489703227, "post_id": 42845801, "comment_id": 72800261, "body": "<code>IO</code> is a functor. Let\u2019s say there\u2019s an <code>x = readLn :: IO Int</code>. <code>foldr (+) 0 x</code> must be an <code>Int</code>. What is it?"}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489703595, "post_id": 42845801, "comment_id": 72800398, "body": "@Ingo Then how do you call the relation between <code>Applicative</code> and <code>Functor</code>. Just &quot;every <code>Applicative</code> must be an instance of <code>Functor</code>&quot;"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489704327, "post_id": 42845801, "comment_id": 72800656, "body": "It&#39;s type classes, not types, and hence super/sub-classes."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1489705217, "post_id": 42845801, "comment_id": 72800941, "body": "<code>Foldable</code> is too list-centric, it basically allows one to efficiently run <code>foldr f x . toList</code>. It will not distinguish between trees having the same in-order visit. Instead, <code>fmap f</code> will preserve all the tree structure."}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 8, "last_activity_date": 1489708580, "last_edit_date": 1489708580, "creation_date": 1489706792, "answer_id": 42846595, "question_id": 42845801, "link": "https://stackoverflow.com/questions/42845801/if-map-can-be-defined-using-foldable-why-is-functor-not-mentioned-in-definition/42846595#42846595", "title": "If map can be defined using Foldable, why is Functor not mentioned in definition of Foldable", "body": "<blockquote>\n  <p>But sadly I'm not much enough of a Haskell magician to get away with cons.</p>\n</blockquote>\n\n<p>You've found the fundamental problem that disallows making every Foldable a Functor; <code>foldr</code> discards the <em>structure</em> that is folded, keeping only (what amounts to) a list of its elements. You can't \"get away with cons\" because you <em>can't know</em> what the structure of the data is given only a <code>Foldable</code> instance.</p>\n\n<p>Given this (typical) definition of a tree:</p>\n\n<pre><code>data Tree a = Bin a (Tree a) (Tree a) | Tip\n\ninstance Functor Tree where\n  fmap f (Bin a l r) = Bin (f a) (fmap f l) (fmap f r)\n  fmap _ Tip = Tip\n\ninstance Foldable Tree where\n  foldMap f (Bin a l r) = foldMap f l &lt;&gt; f a &lt;&gt; foldMap f r\n  foldMap _ Tip = mempty\n</code></pre>\n\n<p>Compare these two trees:</p>\n\n<pre><code>let x = Bin 'b' (Bin 'a' Tip Tip) Tip\nlet y = Bin 'a' Tip (Bin 'b' Tip Tip)\n</code></pre>\n\n<p>Both trees have a <code>toList</code> of \"ab\", but are clearly different. This means that the act of folding the tree loses some information (namely, the boundary between the left subtree, right subtree, and the element) which you can not recover. Since you can't distinguish between x and y using the results from the <code>Foldable</code> instance, you can't possibly write <code>fmap</code> such that <code>fmap id == id</code> using only those methods. We had to resort to pattern matching and using constructors to write out <code>Functor</code> instance.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489708580, "creation_date": 1489702614, "last_edit_date": 1489703529, "question_id": 42845801, "link": "https://stackoverflow.com/questions/42845801/if-map-can-be-defined-using-foldable-why-is-functor-not-mentioned-in-definition", "title": "If map can be defined using Foldable, why is Functor not mentioned in definition of Foldable", "body": "<p>I read that, <code>map</code> can be defined using <code>foldr</code>, i.e. it is a primitive recursive function. At least for lists.</p>\n\n<p>Now my question: Why is Functor not a sub type class of Foldable? And if <code>fmap</code> can only be defined in terms of <code>foldr</code> for lists, what makes them special?</p>\n\n<p>Looking at a definition of <code>map</code> with foldr:</p>\n\n<pre><code>myMap f xs = foldr step [] xs\n    where step x ys = f x : ys\n</code></pre>\n\n<p>I could use Monoids to get to:</p>\n\n<pre><code>myMap f xs = foldr step mempty xs\n    where step x ys = f x : ys\n</code></pre>\n\n<p>But sadly I'm not much enough of a Haskell magician to get away with <code>cons</code>.</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1489697450, "post_id": 42844402, "comment_id": 72797827, "body": "After a match is found you do not recurse on <code>delete</code>, so only the first match gets removed. Also, I think <code>x</code> is always a prefix for <code>unwords (x:xs)</code>, so I&#39;m unsure about why you check for that. Actually, using <code>unwords</code> for this looks already quite strange. Can&#39;t you write the whole thing as <code>filter (some predicate here) listOfStrings</code> ?"}, {"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1489698602, "post_id": 42844402, "comment_id": 72798364, "body": "@chi Once again your comment directed me to the solution. So I used a filter: filter(\\x -&gt; head x=/&#39;{&#39;)myList. And it solved my problem. Thank you for your help!"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 1, "creation_date": 1489702669, "post_id": 42844402, "comment_id": 72800032, "body": "But remember that <code>head</code> will fail on empty strings, so you better check for empty strings <b>before</b> using head."}, {"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489703478, "post_id": 42844402, "comment_id": 72800359, "body": "@Ingo is this why I&#39;m getting this error message: Prelude.head: empty list?"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 1, "creation_date": 1489703567, "post_id": 42844402, "comment_id": 72800391, "body": "Exactly! That is the error for head on an empty list."}, {"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489703980, "post_id": 42844402, "comment_id": 72800535, "body": "@Ingo I thought I checked for empty strings with delete []= [] ? Am I missing something else?"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 2, "creation_date": 1489704221, "post_id": 42844402, "comment_id": 72800625, "body": "This is the outer list of strings that you are checking, but strings are themselves lists (as you know very will, since you use <code>head</code> and <code>last</code>on them)."}, {"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489705305, "post_id": 42844402, "comment_id": 72800972, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/138277/discussion-between-omar-and-ingo\">continue this discussion in chat</a>."}], "owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489696946, "creation_date": 1489696946, "question_id": 42844402, "link": "https://stackoverflow.com/questions/42844402/haskell-delete-a-specific-string-inside-a-list", "title": "haskell: delete a specific string inside a list", "body": "<p>I wrote this function to delete any word inside a list that starts with '{' and ends with '}':</p>\n\n<pre><code>delete []=[]\ndelete c@(x:xs) | head x=='{' &amp;&amp; last x=='}'= rep x \" \" (unwords c)\n                | otherwise = delete xs \n</code></pre>\n\n<p>I am using the helper function rep:</p>\n\n<pre><code>rep _ _ [] = []\nrep a b s@(x:xs)= if isPrefixOf a s\n              then b++rep a b (drop(length a)s)\n              else x: rep a b xs\n</code></pre>\n\n<p>When I call the delete function on a list of strings like the one below,, it deletes successfully the first string \"author\" but leaves the 2 others \"reference\", \"title\":</p>\n\n<p>[\"{author}\",\"has\",\"stated\",\"that\",\"{reference}\",\"     {title}\",\"has\",\"been\",\"published\",\"...\"]</p>\n\n<p>Please tell me that is missing in my function?</p>\n\n<p>Thank you,</p>\n\n<p>Omar</p>\n"}, {"tags": ["haskell", "timestamp"], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 18, "last_activity_date": 1489695177, "last_edit_date": 1489695177, "creation_date": 1489695049, "answer_id": 42843883, "question_id": 42843882, "link": "https://stackoverflow.com/questions/42843882/how-do-you-get-a-millisecond-precision-unix-timestamp-in-haskell/42843883#42843883", "title": "How do you get a millisecond-precision unix timestamp in Haskell?", "body": "<p>Using the <a href=\"https://hackage.haskell.org/package/time\" rel=\"noreferrer\">time</a> package:</p>\n\n<ol>\n<li><p>Use <code>getPOSIXTime</code>, which returns a <a href=\"https://www.stackage.org/haddock/lts-8.5/time-1.6.0.1/Data-Time-Clock.html#t:NominalDiffTime\" rel=\"noreferrer\"><code>NominalDiffTime</code></a>. This represents a <em>fractional</em> number of seconds, with a precision of 10<sup>-12</sup> seconds.</p></li>\n<li><p>Multiply 1000 to convert from seconds to milliseconds.</p></li>\n<li><p><code>NominalDiffTime</code> implements the <a href=\"https://www.stackage.org/haddock/lts-8.5/base-4.9.1.0/Prelude.html#t:RealFrac\" rel=\"noreferrer\"><code>RealFrac</code></a> class, so you can use <code>round</code> to convert to an integer.</p></li>\n</ol>\n\n<hr>\n\n<pre><code>import Data.Time.Clock.POSIX (getPOSIXTime)\n\n\u03bb&gt; (round . (* 1000)) &lt;$&gt; getPOSIXTime\n1489694668011\n</code></pre>\n"}], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2413, "favorite_count": 1, "answer_count": 1, "score": 9, "last_activity_date": 1489695177, "creation_date": 1489695049, "question_id": 42843882, "link": "https://stackoverflow.com/questions/42843882/how-do-you-get-a-millisecond-precision-unix-timestamp-in-haskell", "title": "How do you get a millisecond-precision unix timestamp in Haskell?", "body": "<p>What is the Haskell equivalent of this shell command?</p>\n\n<pre><code>$ date \"+%s%3N\"\n1489694389603\n</code></pre>\n"}, {"tags": ["algorithm", "performance", "haskell", "primes"], "comments": [{"owner": {"reputation": 853, "user_id": 3645112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QFHGj.jpg?s=128&g=1", "display_name": "Rainbacon", "link": "https://stackoverflow.com/users/3645112/rainbacon"}, "edited": false, "score": 0, "creation_date": 1489693306, "post_id": 42843297, "comment_id": 72795635, "body": "From looking at your statistics the biggest difference that jumps out to me is <code>branch-misses</code>. Your function for small primes has <code>10.673.742      branch-misses             #    0,03% of all branches</code> and your function for big primes has <code>106.102.114      branch-misses             #    0,31% of all branches</code>. Your big primes function mis-predicts branches 10x as much as your small primes function. That could cause you some slowdown. Although, the miss rate is small enough even for the big primes that it probably isn&#39;t the whole story"}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1489693320, "post_id": 42843297, "comment_id": 72795643, "body": "If you are just interested in checking whether a particular number is a prime, there are far better methods. look up Rabin-Miller, for example"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489703233, "post_id": 42843297, "comment_id": 72800262, "body": "&quot;p is greater than the square root of n&quot; is equivalent to &quot;the square of p is greater than n&quot;, however, the latter one needs only integer multiplication and comparison, whereas the former one requires much more CPU work."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 1154926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503b29da1bb8f83026697e639cc88160?s=128&d=identicon&r=PG", "display_name": "Gonenc", "link": "https://stackoverflow.com/users/1154926/gonenc"}, "edited": false, "score": 0, "creation_date": 1489704955, "post_id": 42843567, "comment_id": 72800866, "body": "Very neat! This should change my way of Haskell programming. I&#39;m still new to it. Though I wonder why <code>!!</code> is so slow."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 197, "user_id": 1154926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503b29da1bb8f83026697e639cc88160?s=128&d=identicon&r=PG", "display_name": "Gonenc", "link": "https://stackoverflow.com/users/1154926/gonenc"}, "edited": false, "score": 0, "creation_date": 1489706185, "post_id": 42843567, "comment_id": 72801231, "body": "@gonenc <code>(!!)</code> is slow because it is the naive O(n) indexing operation into a linked list."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1489693789, "creation_date": 1489693789, "answer_id": 42843567, "question_id": 42843297, "link": "https://stackoverflow.com/questions/42843297/performance-of-prime-testing-with-haskell/42843567#42843567", "title": "Performance of Prime Testing with Haskell", "body": "<p>A common antipattern brought from other languages is to iterate over indices and use <code>(!!)</code> to index into a list. In Haskell, it is instead idiomatic to simply iterate over the list itself. So:</p>\n\n<pre><code>isBigPrime' :: Integer -&gt; [Integer] -&gt;Bool\nisBigPrime' n [] = True\nisBigPrime' n (p:ps) = p &gt; intSqrt n || (rem n p /= 0 &amp;&amp; isBigPrime' n ps)\n\nisBigPrime n = isBigPrime' n (drop 1 smallPrimes)\n</code></pre>\n\n<p>On my machine, your <code>primes</code> takes 25.3s; your <code>bigPrimes</code> takes 20.9s; and my <code>bigPrimes</code> takes 3.2s. There are several other pieces of low-hanging fruit (e.g. using <code>p*p &gt; n</code> instead of <code>p &gt; intSqrt n</code>), but this is by far the most significant one.</p>\n"}], "owner": {"reputation": 197, "user_id": 1154926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503b29da1bb8f83026697e639cc88160?s=128&d=identicon&r=PG", "display_name": "Gonenc", "link": "https://stackoverflow.com/users/1154926/gonenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 42843567, "answer_count": 1, "score": 0, "last_activity_date": 1489693789, "creation_date": 1489692840, "question_id": 42843297, "link": "https://stackoverflow.com/questions/42843297/performance-of-prime-testing-with-haskell", "title": "Performance of Prime Testing with Haskell", "body": "<p>I have two ways of testing for primes. One of them called <code>isPrime</code> and the other is <code>isBigPrime</code>. What I originally wanted is to test \"big\" primes with \"small\" primes that I have already computed, so that the testing becomes faster. Here are my implementations:</p>\n\n<pre><code>intSqrt :: Integer -&gt; Integer\nintSqrt n = round $ sqrt $ fromIntegral n\n\nisPrime' :: Integer-&gt;Integer -&gt; Bool\nisPrime' 1 m = False\nisPrime' n m = do\n  if (m &gt; (intSqrt n))\n    then True\n    else if (rem n (m+1) == 0)\n         then False\n         else do isPrime' n (m+1)\n\nisPrime :: Integer -&gt; Bool\nisPrime 2 = True\nisPrime 3 = True\nisPrime n = isPrime' n 1\nisBigPrime' :: Integer -&gt;Int -&gt;Bool\nisBigPrime' n i =\n  if ( ( smallPrimes !! i ) &gt; intSqrt n )\n  then True\n  else if (rem n (smallPrimes !! i) == 0)\n       then False\n       else do isBigPrime' n (i+1)\nsmallPrimes = [2,3, List of Primes until 1700]\n--Start at 1 because we only go through uneven numbers\nisBigPrime n = isBigPrime' n 1\nprimes m = [2]++[k | k &lt;- [3,5..m], isPrime k]\nbigPrimes m = smallPrimes ++ [k | k &lt;- [1701,1703..m], isBigPrime k]\nmain = do\n  print $ (sum $ [Enter Method] 2999999 )\n</code></pre>\n\n<p>I have chosen 1700 as upper limit because I wanted to have primes up to 3e6 and sqrt(3e6) ~ 1700. I took the sum of them to compare those two algorithms. I thought that <code>bigPrimes</code> would be way faster that <code>primes</code> because first of all it does way less calculations <em>and</em> it has a head start, which is not too big but anyway. However to my surprise <code>bigPrimes</code> was slower than <code>primes</code>. Here are the results:</p>\n\n<p>For <code>primes</code></p>\n\n<pre><code>Performance counter stats for './p10':\n\n\n      16768,627686      task-clock (msec)         #    1,000 CPUs utilized          \n                58      context-switches          #    0,003 K/sec                  \n                 1      cpu-migrations            #    0,000 K/sec                  \n             6.496      page-faults               #    0,387 K/sec                  \n    53.416.641.157      cycles                    #    3,186 GHz                    \n   &lt;not supported&gt;      stalled-cycles-frontend  \n   &lt;not supported&gt;      stalled-cycles-backend   \n   160.411.056.099      instructions              #    3,00  insns per cycle        \n    34.512.352.987      branches                  # 2058,150 M/sec                  \n        10.673.742      branch-misses             #    0,03% of all branches        \n\n      16,773316435 seconds time elapsed\n</code></pre>\n\n<p>and for <code>bigPrimes</code></p>\n\n<pre><code> Performance counter stats for './p10':\n\n      19111,667046      task-clock (msec)         #    0,999 CPUs utilized          \n               259      context-switches          #    0,014 K/sec                  \n                 3      cpu-migrations            #    0,000 K/sec                  \n             6.278      page-faults               #    0,328 K/sec                  \n    61.027.453.425      cycles                    #    3,193 GHz                    \n   &lt;not supported&gt;      stalled-cycles-frontend  \n   &lt;not supported&gt;      stalled-cycles-backend   \n   198.207.905.034      instructions              #    3,25  insns per cycle        \n    34.632.138.061      branches                  # 1812,094 M/sec                  \n       106.102.114      branch-misses             #    0,31% of all branches        \n\n      19,126843560 seconds time elapsed\n</code></pre>\n\n<p>I was wondering why that would be the case. I am suspecting that using <code>primes!!n</code> makes <code>bigPrimes</code> somewhat slower but I am not entirely sure.</p>\n"}, {"tags": ["haskell", "syntax", "operators", "special-characters", "type-signature"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "edited": false, "score": 0, "creation_date": 1489693134, "post_id": 42842861, "comment_id": 72795544, "body": "I can absolutely follow that logic. But wouldn&#39;t a combination of backtick notation and symbol operator infix assumption extended to on the left-hand side of <code>=</code> suffice for formal consistency? The examples would still be legal; <code>((((+ 2)))) 3  ==  5</code>. <code>. g = \\ f x -&gt; f (g x)</code> could work just as <code>(. (+ 1)) (+ 2) 4</code> does. If symbol operators are already an exception to Haskell&#39;s regular polish notation, why not use this exception for declaration / name binding also?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489695388, "post_id": 42842861, "comment_id": 72796796, "body": "@GeorgJohannSchubert Because exceptions in the syntax are bad, and are avoided (typically) at all costs. Note that the pattern and expression syntax are very similair - patterns essentially have expression syntax (plus things like ViewPatterns, etc) and the additional constraint that each variable appears at most once. Such an exception would lead to inconsistency between the pattern and expression syntax."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1489702246, "post_id": 42842861, "comment_id": 72799879, "body": "@user2407038 Can you elaborate? I&#39;m not sure what you mean by &quot;inconsistency between the pattern and expression syntax&quot;. Isn&#39;t exception to exception (excepted infix assumption for operator symbols in patterns) more incoherent than just exception (infix assumption)?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489704655, "post_id": 42842861, "comment_id": 72800766, "body": "@GeorgJohannSchubert I don&#39;t think it makes much sense to talk about \u201cexcepted infix assumption for operator symbols in patterns\u201d. The important point is just how expressions are parsed: broadly speaking, the parser tries to grab for every infix (say <code>%</code>) expressions on the left and right as arguments. If both are found, like <code>2%7</code>, it desugars this to <code>(%) 2 7</code>. Basically, the <code>()</code> in <code>(%)</code> aren&#39;t parentheses in the grouping-sense at all, they&#39;re rather symbol-quotation marks."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1489731357, "post_id": 42842861, "comment_id": 72808387, "body": "In <code>((4 +))</code>, you don&#39;t have &quot;parenthesis around symbolic operators&quot;, you have: 1. normal grouping parentheses around expression <code>(4 +)</code>; 2. parentheses <i>in</i> <code>(4 +)</code>, which also have a special meaning, but a different one than parentheses in <code>(+)</code>: you can&#39;t write e.g. <code>f = 4 +</code>, only <code>f = (4 +)</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1489748130, "post_id": 42842861, "comment_id": 72817449, "body": "<code>+</code> is just a symbol that is treated by the parser in some way. <code>(+)</code> is the function. Your argumentation is a bit like saying: why can&#39;t we write <code>hello world :: String</code>? Surely <code>hello world</code> is a string, and you <i>can</i> write <code>&quot;hello world&quot; :: String</code>. Well, yes, but those quotation marks are important for the parser to actually interpret it as a string. Likewise, you need to surround <code>+</code> with parentheses so it&#39;s actually treated as a function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "edited": false, "score": 0, "creation_date": 1489760955, "post_id": 42842861, "comment_id": 72826310, "body": "@leftaroundabout <code>3 + 4</code> isn&#39;t just perfectly regular <i>function</i> application? Because the parser says so? Maybe this is one of those things whiches compehension requires some intuition that I have not yet aquired. I can follow your answers, but can&#39;t accept that there <i>should</i> be semantic difference between <code>map (add 4)</code>&#39;s and <code>(+)</code>&#39;s parenthesis. Probably a case of Scheme-itis."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "edited": false, "score": 0, "creation_date": 1489761385, "post_id": 42842861, "comment_id": 72826636, "body": "Nonetheless: Thank you for discussing this."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1489765248, "post_id": 42842861, "comment_id": 72829395, "body": "If <code>3 + 4</code> were regular function application, it would be parsed as <code>(((3)(+))(4))</code>: the function <code>3</code> applied to <code>+</code> and <code>4</code>. In Scheme it would in fact be parsed this way, thus the need to write it <code>(+ 3 4)</code> instead to make any sense. Haskell doesn&#39;t do this because we want actual infix notation, as most people would consider <code>3 + 4</code> more readable than <code>(+ 3 4)</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1489691690, "last_edit_date": 1489691690, "creation_date": 1489691332, "answer_id": 42842861, "question_id": 42842663, "link": "https://stackoverflow.com/questions/42842663/parenthesis-around-operator-symbol-in-type-signature/42842861#42842861", "title": "Parenthesis around operator symbol in type signature", "body": "<p>It's for consistency. Infix operators by themselves aren't <em>expressions</em> whose type or value you could define. The following is also not legal:</p>\n\n<pre><code>. = \\f g x -&gt; f (g x)\n</code></pre>\n\n<p>...though that is basically what your definition is desugared to. But for directly <em>defining the value of an infix</em> this way, we need to first disable the special syntactic status, and that's done by wrapping it in parentheses:</p>\n\n<pre><code>(.) :: (a -&gt; b) -&gt; (c -&gt; a) -&gt; c -&gt; b\n(.) = \\f g x -&gt; f (g x)\n</code></pre>\n\n<p>This is quite the same as defining</p>\n\n<pre><code>compose :: (a -&gt; b) -&gt; (c -&gt; a) -&gt; c -&gt; b\ncompose = \\f g x -&gt; f (g x)\n</code></pre>\n\n<p>...which can then also be used as an infix, like</p>\n\n<pre><code>Prelude&gt; map (toEnum `compose` round) $ [110 + sin x * 12 | x&lt;-[0..30]] :: String\n\"nxypebkvzsgbhszvkbepyxndclwyqfb\"\n</code></pre>\n\n<p>But you obviously wouldn't write the definition in infix form, like</p>\n\n<pre><code>`compose` :: (a -&gt; b) -&gt; (c -&gt; a) -&gt; c -&gt; b\n`compose` = \\f g x -&gt; f (g x)\n</code></pre>\n\n<p>...though you could do</p>\n\n<pre><code>f`compose`g = \\x -&gt; f (g x)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 42842861, "answer_count": 1, "score": 0, "last_activity_date": 1489702315, "creation_date": 1489690680, "last_edit_date": 1489702315, "question_id": 42842663, "link": "https://stackoverflow.com/questions/42842663/parenthesis-around-operator-symbol-in-type-signature", "title": "Parenthesis around operator symbol in type signature", "body": "<pre><code>. :: (a -&gt; b) -&gt; (c -&gt; a) -&gt; c -&gt; b\nf . g = \\ x -&gt; f (g x)\n</code></pre>\n\n<p>Why is this definition illegal? Aesthetic choice, or formal necessity?</p>\n"}, {"tags": ["haskell", "windows-10", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1489675511, "post_id": 42837192, "comment_id": 72783617, "body": "The end is useless. We already know everything has filed, no surprise here. The <b>first</b> error message may be helpful."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1489683466, "post_id": 42837192, "comment_id": 72789795, "body": "Are you on a windows insider build? There were issues with WSL that prevented installing Haskell before, but I think they were fixed on the most recent insiders build (and should be coming to everyone else in the next major Windows 10 update)."}, {"owner": {"reputation": 36, "user_id": 5758954, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gw6DPBOJo0/AAAAAAAAAAI/AAAAAAAAG2Y/dsca5NqNgvk/photo.jpg?sz=128", "display_name": "Ian Edwards", "link": "https://stackoverflow.com/users/5758954/ian-edwards"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1489719510, "post_id": 42837192, "comment_id": 72804921, "body": "@jkeuhlen, That is good to know. I&#39;m not on an insider build. Is it worth doing as a developer? I was worried it might result in lower stability or less support."}, {"owner": {"reputation": 36, "user_id": 5758954, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gw6DPBOJo0/AAAAAAAAAAI/AAAAAAAAG2Y/dsca5NqNgvk/photo.jpg?sz=128", "display_name": "Ian Edwards", "link": "https://stackoverflow.com/users/5758954/ian-edwards"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489719638, "post_id": 42837192, "comment_id": 72804951, "body": "@n.m. Good point! Here&#39;s a pastebin of the full output. It&#39;s shorter and different this time, though because it&#39;s already partially installed and probably corrupted somehow... <a href=\"http://pastebin.com/XgWx6u7H\" rel=\"nofollow noreferrer\">pastebin.com/XgWx6u7H</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489742464, "post_id": 42837192, "comment_id": 72813689, "body": "Googling this first error message <code>ghc: timer_create: Function not implemented</code> returns a number of hits."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1489759545, "post_id": 42837192, "comment_id": 72825312, "body": "@IanEdwards Yes. You have to be on an insider build (the most recent one, near build# 15000 I believe) for any of Haskell to work. It does come with lower stability. Personally, I&#39;m just waiting for the creators update to play with Haskell on the WSL."}], "answers": [{"tags": [], "owner": {"reputation": 4227, "user_id": 2391063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/56f9a1f4059f57bfef806a5fde53665d?s=128&d=identicon&r=PG", "display_name": "Thane Plummer", "link": "https://stackoverflow.com/users/2391063/thane-plummer"}, "is_accepted": false, "score": 0, "last_activity_date": 1501174658, "creation_date": 1501174658, "answer_id": 45356822, "question_id": 42837192, "link": "https://stackoverflow.com/questions/42837192/haskell-platform-throws-a-ton-of-errors-when-i-try-to-install-it-on-wsl/45356822#45356822", "title": "Haskell-platform throws a ton of errors when I try to install it on WSL", "body": "<p>The issue is that <code>timer_create</code> is not implemented on your current build of the Windows Linux subsystem, aka <strong>WSL</strong>. If you have a recent OS, you can uninstall your current WSL and reinstall it. This will only work if your Windows version is 64-bit and build 1607 or later. You can find the build number from <strong>Start menu Settings</strong>, then select <strong>System -> About</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/oWCRk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oWCRk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Use the following commands from a command shell (not bash shell) to uninstall and reinstall. IMPORTANT: Back up your Linux files before running these commands as this deletes all of them.</p>\n\n<pre><code>lxrun /uninstall /full /y\nlxrun /install /y\n</code></pre>\n\n<p>Once the install is complete you can open a Windows command prompt and update WSL with:</p>\n\n<pre><code>lxrun /update\n</code></pre>\n\n<p>Once you've re-installed and updated, you can <code>sudo apt-get update</code> and <code>sudo apt-get upgrade</code> from the within bash shell.</p>\n\n<p>This worked on one of my computers, but not the other. Not sure why. If it does not work, you can get the latest WSL distro by joining the <em>Insiders Build</em>; instructions <a href=\"https://insider.windows.com/GetInsiderBuilds\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><strong>Useful Links</strong></p>\n\n<ul>\n<li>Windows help on <a href=\"https://msdn.microsoft.com/en-us/commandline/wsl/reference\" rel=\"nofollow noreferrer\">lxrun</a>.  </li>\n<li>Instructions on <a href=\"https://msdn.microsoft.com/en-us/commandline/wsl/install_guide\" rel=\"nofollow noreferrer\">WSL installation</a>.</li>\n</ul>\n"}], "owner": {"reputation": 36, "user_id": 5758954, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2gw6DPBOJo0/AAAAAAAAAAI/AAAAAAAAG2Y/dsca5NqNgvk/photo.jpg?sz=128", "display_name": "Ian Edwards", "link": "https://stackoverflow.com/users/5758954/ian-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501174658, "creation_date": 1489675206, "question_id": 42837192, "link": "https://stackoverflow.com/questions/42837192/haskell-platform-throws-a-ton-of-errors-when-i-try-to-install-it-on-wsl", "title": "Haskell-platform throws a ton of errors when I try to install it on WSL", "body": "<p>I'm trying to install haskell-platform on my Windows 10 linux subsystem, but just installing it throws a ton of errors. I tried this, according to the haskell site:</p>\n\n<pre><code>$ sudo apt-get install haskell-platform\n</code></pre>\n\n<p>And it threw more than my terminal saved, and this at the end.</p>\n\n<pre><code>Errors were encountered while processing:\n ghc\n libghc-text-dev\n libghc-attoparsec-dev\n libghc-hunit-dev\n ghc-haddock\n libghc-stm-dev\n libghc-async-dev\n libghc-hashable-dev\n libghc-case-insensitive-dev\n libghc-extensible-exceptions-dev\n libghc-transformers-dev\n libghc-mtl-dev\n libghc-monadcatchio-mtl-dev\n libghc-parsec3-dev\n libghc-network-dev\n libghc-xhtml-dev\n libghc-cgi-dev\n libghc-fgl-dev\n libghc-openglraw-dev\n libghc-gluraw-dev\n libghc-opengl-dev\n libghc-glut-dev\n libghc-syb-dev\n libghc-haskell-src-dev\n libghc-html-dev\n libghc-http-dev\n libghc-parallel-dev\n libghc-primitive-dev\n libghc-random-dev\n libghc-quickcheck2-dev\nE: Sub-process /usr/bin/dpkg returned an error code (1)\n</code></pre>\n\n<p>I tried to apt-get remove, but it threw errors and didn't complete that, either. Is there a safe way to start over and try again? Has anyone else encountered this kind of problem?</p>\n"}, {"tags": ["list", "haskell", "insert", "record"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1489674909, "post_id": 42836116, "comment_id": 72783086, "body": "Discover the exciting world of <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lens</a>."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "edited": false, "score": 0, "creation_date": 1489675103, "post_id": 42836318, "comment_id": 72783263, "body": "Thank you. &quot;how do I compute a new list that is exactly like the previous one except...&quot;. really helped me understand it. Surely it&#39;s inefficient to create an entire new list just to modify one value though? (Not saying your answer isn&#39;t satisfactory, it&#39;s great, really helped me understand) but more so pointed towards Haskell."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "edited": false, "score": 0, "creation_date": 1489676802, "post_id": 42836318, "comment_id": 72784653, "body": "First of all: You are right. Certainly in this situation lists are not the structure you want to use if you desire good performance.  Second: Don&#39;t get too hung up on what you believe is efficient too early.  In this example the portion of the list after the first match will be shared - both the pre-update and post-update lists have pointers to a common tail.  In Haskell most values are boxed and what lots of update operations involve is moving pointers to the old structure, old elements, etc."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1489687065, "post_id": 42836318, "comment_id": 72792063, "body": "Note that this would be inefficient even if you could mutate the list in place. You need to do O(n) work to find the element that needs an update, so doing additional O(n) work to copy non-matching elements is not a terribly big deal."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1489673885, "last_edit_date": 1489673885, "creation_date": 1489673069, "answer_id": 42836318, "question_id": 42836116, "link": "https://stackoverflow.com/questions/42836116/updating-a-single-value-in-a-record-within-a-collection-of-records-haskell/42836318#42836318", "title": "Updating a single value in a record, within a collection of records Haskell", "body": "<p>You shouldn't think about \"updating\" something, even though we use that terminology, unless you have a mutable reference and are working in the IO monad.  In this situation the thought process should be \"how do I compute a new list that is exactly like the previous one except...\".</p>\n\n<p>You could either update a single entry or <code>map</code> a modification function across the entire list.  Lets look at the manual, single entry, solution first:</p>\n\n<pre><code>addSiblingToPerson :: String -&gt; String -&gt; [Person] -&gt; [Person]\naddSiblingToPerson siblingParam fnameParam allPeople = \n    case allPeople of\n       []     -&gt; []\n       (p:ps) | fname p == fnameParam -&gt;\n                     p { siblings = siblingParam : siblings p } : ps\n              | otherwise -&gt;\n                     p : addSiblingToPerson siblingParam fnameParam ps\n</code></pre>\n\n<p>That is, we traverse the list, keeping any non-matching people and updating the first person with a matching <code>fname</code>, being sure to include the rest of the list.</p>\n\n<p>The map solution is functionally different - it will update <em>all</em> people who share the given <code>fname</code> and it will traverse the whole list.</p>\n\n<pre><code>addSiblingToPerson :: String -&gt; String -&gt; [Person] -&gt; [Person]\naddSiblingToPerson siblingParam fnameParam allPeople =\n      let update p | fname p == fnameParam = p { siblings = siblingParam : siblings p }\n                   | otherwise = p\n      in map update allPeople\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7708789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17d404af90ed9e6460047febefeb3068?s=128&d=identicon&r=PG&f=1", "display_name": "ThatGuyOverThereIsMe", "link": "https://stackoverflow.com/users/7708789/thatguyoverthereisme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 1, "accepted_answer_id": 42836318, "answer_count": 1, "score": 0, "last_activity_date": 1489673885, "creation_date": 1489672550, "question_id": 42836116, "link": "https://stackoverflow.com/questions/42836116/updating-a-single-value-in-a-record-within-a-collection-of-records-haskell", "title": "Updating a single value in a record, within a collection of records Haskell", "body": "<p>So I have a custom data type <code>Person</code></p>\n\n<pre><code>   data Person = Person{ fname :: String\n                        , lname :: String\n                        , age :: Int\n                        , siblings :: [String]\n                        }\n</code></pre>\n\n<p>I have a list of this type, <code>foo = [Person].</code></p>\n\n<p>I'm trying to update a particular <code>Person</code>. My process is to match their <code>fname</code> (Assuming each name is unique) and then to update their <code>siblings</code> values.</p>\n\n<pre><code>addSiblingToPerson :: String -&gt; String -&gt; [Person] -&gt; [Person]\naddSiblingToPerson siblingParam fnameParam fooParam = \n</code></pre>\n\n<p>I'm really struggling to think 'functionally', if I were to do this in an imperative language I could go through each item in <code>[Person]</code> checking to see <code>if name == fname then this.siblings push newSibling</code> (Or something along those lines)</p>\n\n<p>I know how to update a record in haskell but I want to return the list of <code>Person</code> after updating a single person in the collection of <code>Person</code>.</p>\n\n<p>I just can't wrap my head around how to 'think Haskell'</p>\n\n<p>Thank you :(</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1489669013, "post_id": 42834373, "comment_id": 72778698, "body": "<code>liftA2 (,)</code> is the standard combinator. <a href=\"http://stackoverflow.com/a/36480067\">I call it <code>zipA</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 1312, "user_id": 149988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LX5tz.jpg?s=128&g=1", "display_name": "jarmond", "link": "https://stackoverflow.com/users/149988/jarmond"}, "edited": false, "score": 0, "creation_date": 1489676467, "post_id": 42834926, "comment_id": 72784376, "body": "I like the MonadComprehensions approach - reads like a clean do-block."}], "tags": [], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "is_accepted": false, "score": 4, "last_activity_date": 1489669719, "last_edit_date": 1489669719, "creation_date": 1489669489, "answer_id": 42834926, "question_id": 42834373, "link": "https://stackoverflow.com/questions/42834373/collect-result-from-two-monadic-actions/42834926#42834926", "title": "Collect result from two monadic actions", "body": "<p>Actually, <code>liftM2</code> is intuitive but it needs some time to get used to. So, the answer is yes, <code>liftM2</code> or <code>liftA2</code> are the standard combinators for your case. If you really want a readable solution, there are a number of other options:</p>\n\n<ul>\n<li><code>&lt;*&gt;</code> operator: <code>(,) &lt;$&gt; action1 &lt;*&gt; action2</code></li>\n<li><code>MonadComprehensions</code> extension: <code>[(r1, r2) | r1 &lt;- action1, r2 &lt;- action2]</code></li>\n</ul>\n"}], "owner": {"reputation": 1312, "user_id": 149988, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LX5tz.jpg?s=128&g=1", "display_name": "jarmond", "link": "https://stackoverflow.com/users/149988/jarmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1489669769, "creation_date": 1489667988, "last_edit_date": 1489669769, "question_id": 42834373, "link": "https://stackoverflow.com/questions/42834373/collect-result-from-two-monadic-actions", "title": "Collect result from two monadic actions", "body": "<p>I'm trying to tidy up the following into a nice one-liner:</p>\n\n<pre><code>(r1,r2) &lt;- do\n  r1 &lt;- action1\n  r2 &lt;- action2\n  return (r1,r2)\n</code></pre>\n\n<p>This snippet is itself inside a <code>do</code>-block. By looking at the type of <code>(,) :: a -&gt; b -&gt; (a, b)</code>, I thought to use <code>liftM2 (,) :: Monad m =&gt; m a -&gt; m b -&gt; m (a, b)</code>. Now I can write it as</p>\n\n<pre><code>(r1,r2) &lt;- liftM2 (,) action1 action2\n</code></pre>\n\n<p>which is less repetitive, but doesn't look very intuitive. What I'm wondering, and can't seem to find, is whether there is a standard combinator to join these actions and tuple-up their results?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1489665256, "post_id": 42833319, "comment_id": 72776001, "body": "<code>sum [(m + i) ^ n | i &lt;- [m..n]]</code>?"}, {"owner": {"reputation": 853, "user_id": 3645112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QFHGj.jpg?s=128&g=1", "display_name": "Rainbacon", "link": "https://stackoverflow.com/users/3645112/rainbacon"}, "edited": false, "score": 0, "creation_date": 1489690327, "post_id": 42833319, "comment_id": 72794016, "body": "Change <code>| n &lt;m = 0</code> to <code>| n &lt;= m = 0</code>"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489703463, "post_id": 42833319, "comment_id": 72800354, "body": "By the way, why are you lying to us? <code>Sum 3 4</code>  will most probably <b>not</b> output 3697, and it certainly wont run <code>sum</code>"}, {"owner": {"reputation": 190, "user_id": 4342400, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ddff88c52dfbad00e5372a78e9356417?s=128&d=identicon&r=PG&f=1", "display_name": "leo_bouts", "link": "https://stackoverflow.com/users/4342400/leo-bouts"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489779302, "post_id": 42833319, "comment_id": 72837849, "body": "@Ingo &quot;will most probably not output 3697&quot; have you actually tried this sum?, i used @Ryan\u2666 &#39;s list comprehension and it worked. im such a liar lel"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489834241, "post_id": 42833319, "comment_id": 72851389, "body": "@LeonidasB You wrote <code>Sum</code> , not <code>sum</code> , that&#39;s why."}, {"owner": {"reputation": 190, "user_id": 4342400, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ddff88c52dfbad00e5372a78e9356417?s=128&d=identicon&r=PG&f=1", "display_name": "leo_bouts", "link": "https://stackoverflow.com/users/4342400/leo-bouts"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1489929936, "post_id": 42833319, "comment_id": 72876167, "body": "@Ingo yeap youre right on this, but its an out of context detail as i explained the sum i wanted to compute"}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 0, "last_activity_date": 1489715350, "creation_date": 1489715350, "answer_id": 42847852, "question_id": 42833319, "link": "https://stackoverflow.com/questions/42833319/control-the-recursion-when-computing-a-sum-that-it-stops-at-a-certain-expression/42847852#42847852", "title": "Control the recursion when computing a sum that it stops at a certain expression", "body": "<p>You need to apply the mathematical fact that </p>\n\n<pre><code>(Sum f(x) from x=n to m) = f(n) + (Sum f(x) from x=n+1 to m) when n &lt; m\n</code></pre>\n\n<p>and that </p>\n\n<pre><code>(Sum f(x) from x=m to m) = f(m)\n</code></pre>\n\n<p>Also, negative n or m is an error. Let's translate that directly into Haskell:</p>\n\n<pre><code>sum :: (Integer -&gt; Integer) -&gt; Integer -&gt; Integer -&gt; Integer\nsum f n m\n  | (n &lt; 0 || m &lt; 0) = error \"Negative limits\"\n  -- The first rule above\n  | n &lt; m = f n + sum f (n + 1) m\n  -- The second rule above\n  | n == m = f m\n</code></pre>\n\n<p>The above function is recursion on a general summation, given as a function from <code>i</code> to the summand. To get the actual function you wanted:</p>\n\n<pre><code>yourFunction :: Integer -&gt; Integer -&gt; Integer\nyourFunction n m = sum (\\i -&gt; (n + i)^m) n m\n</code></pre>\n\n<p>Note how the recursion works in the first rule above. The recursive call <code>sum f (n + 1) m</code> means that it <em>increases</em> n until it equals m, adding up all the intermediate results.</p>\n"}], "owner": {"reputation": 190, "user_id": 4342400, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ddff88c52dfbad00e5372a78e9356417?s=128&d=identicon&r=PG&f=1", "display_name": "leo_bouts", "link": "https://stackoverflow.com/users/4342400/leo-bouts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 42847852, "answer_count": 1, "score": 0, "last_activity_date": 1489715350, "creation_date": 1489665093, "question_id": 42833319, "link": "https://stackoverflow.com/questions/42833319/control-the-recursion-when-computing-a-sum-that-it-stops-at-a-certain-expression", "title": "Control the recursion when computing a sum that it stops at a certain expression", "body": "<p>I want to compute the sum of  [ Sum(m+i)^n from i=m to n ]. How can i stop the recursion when n has reached m and not when the recursion hits zero?\nfor example some inputs</p>\n\n<pre><code>Main&gt;Sum 0 1\n0\nMain&gt;Sum 1 1\n1\nMain&gt;Sum 0 3\n36\nMain&gt;Sum 1 5\n12200\nMain&gt;Sum 3 4\n3697\n</code></pre>\n\n<p>this is what i came up with, but it wont work when m = n and also my results are not correct.</p>\n\n<pre><code>sum :: Integer-&gt;Integer-&gt;Integer             \nsum m n\n|  (m&lt;0 &amp;&amp; n &lt;0) = 0\n|  n&lt;m =0\n|  otherwise = (sum m (n-1)) + ((m+n)^n)\n</code></pre>\n"}, {"tags": ["haskell", "monads", "lifting"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1489667977, "post_id": 42830035, "comment_id": 72777947, "body": "NB <code>liftM</code> = <code>fmap</code> so you only need a <code>Functor</code> constraint. And your <code>C</code> is the same as the famous <code>Free</code> monad."}], "answers": [{"comments": [{"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1489662105, "post_id": 42831287, "comment_id": 72773862, "body": "Re: Q1. So <code>Atomic (Maybe (Done v))</code> becomes <code>Atomic (Maybe (Done (f v)))</code>?"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1489663167, "post_id": 42831287, "comment_id": 72774590, "body": "Your definition peels the <code>Done</code>. <code>Atomic (Just (Done v)) &gt;&gt;= f</code> becomes <code>Atomic (Just (f v))</code>."}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 4, "last_activity_date": 1489680516, "last_edit_date": 1489680516, "creation_date": 1489659897, "answer_id": 42831287, "question_id": 42830035, "link": "https://stackoverflow.com/questions/42830035/use-of-a-monad-superclass-in-a-monad-instance-declaration/42831287#42831287", "title": "Use of a monad superclass in a monad instance declaration?", "body": "<p>Q1. It is creating <code>Atomic</code> <strong>value</strong>. Monad is a mapping at type level. Since <code>f</code> is the second argument of <code>&gt;&gt;=</code> of <code>C m a</code> we know its type</p>\n\n<pre><code>f :: Monad m =&gt; a -&gt; C m b\n</code></pre>\n\n<p>hence</p>\n\n<pre><code>(&gt;&gt;= f) :: Monad m =&gt; C m a -&gt; C m b\n</code></pre>\n\n<p>is <code>f</code> extended to unwrap its argument, and</p>\n\n<pre><code>liftM (&gt;&gt;= f) :: (Monad m1, Monad m) =&gt; m1 (C m a) -&gt; m1 (C m b)\n</code></pre>\n\n<p>simply lifts the transformation into <code>m1</code> which in your setting is unified with <code>m</code>. When you extract the value <code>m</code> from <code>Atomic</code> and pass it to <code>liftM</code> you use the monad <code>m</code>'s bind (via <code>liftM</code>) to extract the inner <code>C m a</code> to be passed to <code>f</code>. The second part of <code>liftM</code>'s definition re-wraps the result as a <code>m (C m b)</code> which you wrap in <code>Atomic</code>. So yes.</p>\n\n<p>Q2. Yes. But it is a <code>liftM</code> of the underlying monad <code>m</code>. The <code>liftM</code> for <code>C m a</code> is defined in terms of the instance (its <code>&gt;&gt;=</code> and <code>return</code>). By using <code>C m a</code>'s <code>liftM</code> (if you managed to define <code>&gt;&gt;=</code> in terms of <code>liftM</code>) you would get a cyclic definition. You need the constraint <code>Monad m</code> to create the plumbing for <code>m (C m a)</code> to travel through the <code>&gt;&gt;=</code> and <code>f</code>. In fact as pointed by Benjamin Hodgson, <code>Monad m</code> is an unnecessarily strong constaint, <code>Functor m</code> would suffice. The fact that <code>C</code> is in fact <a href=\"https://hackage.haskell.org/package/free-4.12.4/docs/Control-Monad-Free.html#t:Free\" rel=\"nofollow noreferrer\"><code>Free</code></a> together with the relevant <a href=\"https://hackage.haskell.org/package/free-4.12.4/docs/src/Control-Monad-Free.html#line-189\" rel=\"nofollow noreferrer\">implementations</a> give the most insight in the matter.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 2, "accepted_answer_id": 42831287, "answer_count": 1, "score": 2, "last_activity_date": 1489680516, "creation_date": 1489656626, "last_edit_date": 1489658548, "question_id": 42830035, "link": "https://stackoverflow.com/questions/42830035/use-of-a-monad-superclass-in-a-monad-instance-declaration", "title": "Use of a monad superclass in a monad instance declaration?", "body": "<p>I'm implementing a very simple poor mans concurrency structure with the following data type:</p>\n\n<pre><code>data C m a = Atomic (m (C m a)) | Done a\n</code></pre>\n\n<p>I'm creating an instance of monad for this:</p>\n\n<pre><code>instance Monad m =&gt; Monad (C m) where\n  (&gt;&gt;=) (Atomic m) f      = Atomic $ (liftM (&gt;&gt;= f) m)\n  (&gt;&gt;=) (Done v) f        = f v\n  return                  = Done\n</code></pre>\n\n<p>Q1. Am I right in saying <code>Atomic $ (liftM (&gt;&gt;= f) m)</code> is creating a new <code>Atomic</code> monad which contains the result of <code>f</code> (<code>* -&gt; *</code>) applied to the value inside of <code>m</code>?</p>\n\n<p>Q2. Am I right in saying the superclass <code>Monad m</code> is used here to enable the use of <code>liftM</code>? If so, as this is an instance of the <code>Monad</code> class, why can't this access <code>liftM</code> directly? </p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1489650725, "post_id": 42827965, "comment_id": 72766404, "body": "You\u2019re saying <code>Foo a</code> is a functor, so its values have to have the type <code>Foo a b</code> (they do) and <code>fmap</code> has to apply a function <code>b -&gt; c</code> to a <code>Foo a b</code> to get a <code>Foo a c</code> (it doesn\u2019t in the first example)."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7693974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3c3e1024a603d73b77535c9bafb8b33?s=128&d=identicon&r=PG&f=1", "display_name": "inaba", "link": "https://stackoverflow.com/users/7693974/inaba"}, "edited": false, "score": 0, "creation_date": 1489654068, "post_id": 42828913, "comment_id": 72768248, "body": "Thanks for giving me that &#39;aha!&#39; moment"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1489653323, "creation_date": 1489653323, "answer_id": 42828913, "question_id": 42827965, "link": "https://stackoverflow.com/questions/42827965/implementing-functor-typeclasses/42828913#42828913", "title": "Implementing functor typeclasses", "body": "<p>If we have </p>\n\n<pre><code>data Foo a b = Foo a b\n</code></pre>\n\n<p>and</p>\n\n<pre><code>instance Functor (Foo k) where\n</code></pre>\n\n<p>then for all functions you define in your typeclass, the first parameter <code>a</code> is fixed. With that single line, you tell the world that for any <code>k</code>, <code>Foo k</code> will be a functor. However, that means that your first parameter cannot be mapped over with <code>fmap</code>:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>Remember, our functor will be <code>Foo k</code>. So we will end up with</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; (Foo k) a -&gt; (Foo k) b\n--                  ^^^^^^^      ^^^^^^^\n--                    |             |\n--                    +-------+-----+\n--                            |\n--                      f from above\n</code></pre>\n\n<p>When you've used <code>fmap</code> on the first argument, you created the following implementation of <code>fmap</code>:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; (Foo a) z -&gt; (Foo b) z\n--                  ^^^^^^^      ^^^^^^^\n--                     |             |\n--                     +-------+-----+\n--                             |\n--                  err, those 'f's differ\n</code></pre>\n\n<p>Which is why your first variant didn't work, but the latter did.</p>\n"}], "owner": {"reputation": 55, "user_id": 7693974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3c3e1024a603d73b77535c9bafb8b33?s=128&d=identicon&r=PG&f=1", "display_name": "inaba", "link": "https://stackoverflow.com/users/7693974/inaba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 42828913, "answer_count": 1, "score": 2, "last_activity_date": 1489653323, "creation_date": 1489650041, "last_edit_date": 1489650484, "question_id": 42827965, "link": "https://stackoverflow.com/questions/42827965/implementing-functor-typeclasses", "title": "Implementing functor typeclasses", "body": "<p>I just started learning haskell and I have this code which won't compile:</p>\n\n<pre><code>data Foo a b = Foo a b deriving (Show)\n\ninstance Functor (Foo a) where\n  fmap f (Foo a b) = Foo (f a) b\n</code></pre>\n\n<p>If I change the fmap implementation a bit to this, then it works:</p>\n\n<pre><code>  fmap f (Foo a b) = Foo a (f b)\n</code></pre>\n\n<p>Can someone explain why?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489636536, "post_id": 42824949, "comment_id": 72761040, "body": "Why not simply have <code>foo :: Foo (x &#39;: xs) -&gt; ()</code>?"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489636836, "post_id": 42824949, "comment_id": 72761116, "body": "Of course this example is simplified, but <code>foo</code> really has some recursive calls in it. I need to match on either the <code>Cons</code> case or the <code>Nil</code> case (elided), and naturally <code>Nil :: Foo &#39;[]</code>. I really do need GHC to figure out <code>xs ~ (y &#39;: ys)</code> based on the pattern match."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489638162, "post_id": 42824949, "comment_id": 72761464, "body": "@Alec I improved the example to demonstrate why I&#39;m asking what I&#39;m asking. I hate it when I oversimplify examples..."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1489638471, "post_id": 42824949, "comment_id": 72761556, "body": "Thanks! As a side note, <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11350\" rel=\"nofollow noreferrer\">this</a> would be really useful here. :)"}], "answers": [{"comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1489669303, "post_id": 42830095, "comment_id": 72778916, "body": "I&#39;m surprised that this works, but it&#39;s more or less what I&#39;m looking for. How silly that it requires a second function! Do you know if this behavior is documented somewhere?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 1, "creation_date": 1489684764, "post_id": 42830095, "comment_id": 72790612, "body": "If by &#39;behaviour&#39; you are referring to why the error happens in the first place, it is a consequence of how typechecking works. The different given types (<code>Foo xs</code>, <code>Foo (y:ys)</code>) are matched before the function is actually typechecked, but of course we can only unify those under the context provided by the GADT pattern match. That pattern match simply hasn&#39;t &#39;happened&#39; by the time the given types are unified. <code>ScopedTypeVariables</code> just isn&#39;t the right tool to solve this problem - we need <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11350\" rel=\"nofollow noreferrer\">visible type applications in patterns</a>."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1490985741, "post_id": 42830095, "comment_id": 73372556, "body": "SPJ confirmed that &quot;that&#39;s just how it works&quot; <a href=\"https://ghc.haskell.org/trac/ghc/ticket/13430\" rel=\"nofollow noreferrer\">here</a>, which isn&#39;t very satisfactory, but seems to be the accepted solution. The double pattern match is so clunky though..."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1489685113, "last_edit_date": 1489685113, "creation_date": 1489656789, "answer_id": 42830095, "question_id": 42824949, "link": "https://stackoverflow.com/questions/42824949/type-inference-with-gadts/42830095#42830095", "title": "Type inference with GADTs", "body": "<p>All you need is a function to extract the <code>Proxy t</code> from a <code>Foo (t ': ts)</code>: </p>\n\n<pre><code>fooFstType :: Foo (t ': ts) -&gt; Proxy t \nfooFstType _ = Proxy \n</code></pre>\n\n<p>Note that since the type argument to <code>Foo</code> is <code>t ': ts</code>, not simply <code>ts</code>, you may refer to the type variable representing the first element in the type signature (as opposed to in the body, somehow, with <code>ScopedTypeVariables</code>).  </p>\n\n<p>Your function becomes</p>\n\n<pre><code>foo :: Foo xs -&gt; IO ()\nfoo Nil = print \"done\"\nfoo f@(Cons rest) = do\n  print $ show $ typeRep (fooFstType f)\n  foo rest\n</code></pre>\n\n<p>Another possibility is to move the work to the type level: </p>\n\n<pre><code>type family First (xs :: [k]) :: k where \n  First (x ': xs) = x \n\nfoo :: forall xs . Foo xs -&gt; IO ()\nfoo Nil = print \"done\"\nfoo (Cons rest) = do\n  print $ show $ typeRep (Proxy :: Proxy (First xs))\n  foo rest\n</code></pre>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 42830095, "answer_count": 1, "score": 2, "last_activity_date": 1489685113, "creation_date": 1489636021, "last_edit_date": 1489638121, "question_id": 42824949, "link": "https://stackoverflow.com/questions/42824949/type-inference-with-gadts", "title": "Type inference with GADTs", "body": "<p>In the following code, I'm trying to match on the GADT constructor <code>Cons</code> to get the compiler to see that <code>xs</code> is non-empty:</p>\n\n<pre><code>{-# LANGUAGE DataKinds           #-} \n{-# LANGUAGE GADTs               #-}\n{-# LANGUAGE KindSignatures      #-} \n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeOperators       #-}\n\nimport Data.Typeable\n\ndata Foo (ts :: [*]) where\n  Nil :: Foo '[]\n  Cons :: (Typeable t) =&gt; Foo ts -&gt; Foo ( t ': ts)\n\nfoo :: Foo xs -&gt; IO ()\nfoo Nil = print \"done\"\nfoo (Cons rest :: Foo (y ': ys)) = do\n  print $ show $ typeRep (Proxy::Proxy y)\n  foo rest\n</code></pre>\n\n<p>Unfortunately, this simple example fails to compile with GHC 8:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018xs\u2019 with \u2018y : ys\u2019\n  \u2018xs\u2019 is a rigid type variable bound by\n    the type signature for:\n      foo :: forall (xs :: [*]). Foo xs -&gt; IO ()\n  Expected type: Foo (y : ys)\n    Actual type: Foo xs\n\u2022 When checking that the pattern signature: Foo (y : ys)\n    fits the type of its context: Foo xs\n  In the pattern: Cons rest :: Foo (y : ys)\n  In an equation for \u2018foo\u2019:\n      foo (Cons rest :: Foo (y : ys))\n        = print $ (show $ typeRep (Proxy :: Proxy y))\n</code></pre>\n\n<p>I know that type inference can be tricky with GADTs (e.g., <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9695\" rel=\"nofollow noreferrer\">#9695</a>, <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10195\" rel=\"nofollow noreferrer\">#10195</a>, <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10338\" rel=\"nofollow noreferrer\">#10338</a>), but this is <em>so</em> simple...</p>\n\n<p>What do I need to do to convince GHC that when I match on <code>Cons</code>, the GADT argument has at least one element?</p>\n"}, {"tags": ["haskell", "recursion-schemes"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1490070449, "post_id": 42824825, "comment_id": 72935451, "body": "I have added an extra section to the answer to address point #2 in your update."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1490111637, "post_id": 42824825, "comment_id": 72961482, "body": "One further edit to my answer, this time adding a summary which includes a much simpler non-empty list solution."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1489836654, "last_edit_date": 1489836654, "creation_date": 1489641643, "answer_id": 42825873, "question_id": 42824825, "link": "https://stackoverflow.com/questions/42824825/expression-expansion-using-recursion-schemes/42825873#42825873", "title": "Expression expansion using recursion schemes", "body": "<p>I am no expert in recursion schemes, but since it sounds like you are trying to practice them, hopefully you will not find it too onerous to convert a solution using manual recursion to one using recursion schemes. I'll write it with mixed prose and code first, and include the complete code again at the end for simpler copy/pasting.</p>\n\n<p>It is not too difficult to do using simply the distributive property and a bit of recursive algebra. Before we begin, though, let's define a better result type, one that guarantees we can only ever represent sums of products:</p>\n\n<pre><code>data Poly term = Sum (Poly term) (Poly term)\n               | Product (Mono term) \n               deriving Show\n\ndata Mono term = Term term\n               | MonoMul (Mono term) (Mono term)\n               deriving Show\n</code></pre>\n\n<p>This way we can't possibly mess up and accidentally yield an incorrect result like</p>\n\n<pre><code>(Mul (Var \"x\") (Add (Var \"y\") (Var \"z\")))\n</code></pre>\n\n<p>Now, let's write our function.</p>\n\n<pre><code>expand :: E -&gt; Poly String\n</code></pre>\n\n<p>First, a base case: it is trivial to expand a Var, because it is already in sum-of-products form. But we must convert it a bit to fit it into our Poly result type:</p>\n\n<pre><code>expand (Var x) = Product (Term x)\n</code></pre>\n\n<p>Next, note that it is easy to expand an addition: simply expand the two sub-expressions, and add them together.</p>\n\n<pre><code>expand (Add x y) = Sum (expand x) (expand y)\n</code></pre>\n\n<p>What about a multiplication? That is a bit more complicated, since</p>\n\n<pre><code>Product (expand x) (expand y)\n</code></pre>\n\n<p>is ill-typed: we can't multiply polynomials, only monomials. But we do know how to do algebraic manipulation to turn a multiplication of polynomials into a sum of multiplications of monomials, via the distributive rule. As in your question, we'll need a function <code>mulPoly</code>. But let's just assume that exists, and implement it later.</p>\n\n<pre><code>expand (Mul x y) = mulPoly (expand x) (expand y)\n</code></pre>\n\n<p>That handles all the cases, so all that's left is to implement <code>mulPoly</code> by distributing the multiplications across the two polynomials' terms. We simply break down one of the polynomials one term at a time, and multiply the term across each of the terms in the other polynomial, adding together the results.</p>\n\n<pre><code>mulPoly :: Poly String -&gt; Poly String -&gt; Poly String\nmulPoly (Product x) y = mulMonoBy x y\nmulPoly (Sum a b) x = Sum (mulPoly a x) (mulPoly b x)\n\nmulMonoBy :: Mono String -&gt; Poly -&gt; Poly\nmulMonoBy x (Product y) = Product $ MonoMul x y\nmulMonoBy x (Sum a b) = Sum (mulPoly a x') (mulPoly b x')\n  where x' = Product x\n</code></pre>\n\n<p>And in the end, we can test that it works as intended:</p>\n\n<pre><code>expand (Mul (Add (Var \"a\") (Var \"b\")) (Add (Var \"y\") (Var \"z\")))\n{- results in: Sum (Sum (Product (MonoMul (Term \"y\") (Term \"a\"))) \n                        (Product (MonoMul (Term \"z\") (Term \"a\")))) \n                   (Sum (Product (MonoMul (Term \"y\") (Term \"b\"))) \n                        (Product (MonoMul (Term \"z\") (Term \"b\"))))\n-}\n</code></pre>\n\n<p>Or, </p>\n\n<pre><code>(a + b)(y * z) = ay + az + by + bz\n</code></pre>\n\n<p>which we know to be correct.</p>\n\n<p><strong>The complete solution, as promised above</strong>:</p>\n\n<pre><code>data E = Add E E | Mul E E | Var String\n\ndata Poly term = Sum (Poly term) (Poly term)\n               | Product (Mono term) \n               deriving Show\n\ndata Mono term = Term term\n               | MonoMul (Mono term) (Mono term)\n               deriving Show\n\nexpand :: E -&gt; Poly String\nexpand (Var x) = Product (Term x)\nexpand (Add x y) = Sum (expand x) (expand y)\nexpand (Mul x y) = mulPoly (expand x) (expand y)\n\nmulPoly :: Poly String -&gt; Poly String -&gt; Poly String\nmulPoly (Product x) y = mulMonoBy x y\nmulPoly (Sum a b) x = Sum (mulPoly a x) (mulPoly b x)\n\nmulMonoBy :: Mono String -&gt; Poly String -&gt; Poly String\nmulMonoBy x (Product y) = Product $ MonoMul x y\nmulMonoBy x (Sum a b) = Sum (mulPoly a x') (mulPoly b x')\n  where x' = Product x\n\nmain = print $ expand (Mul (Add (Var \"a\") (Var \"b\")) (Add (Var \"y\") (Var \"z\")))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1490111335, "last_edit_date": 1495541839, "creation_date": 1489793339, "answer_id": 42868606, "question_id": 42824825, "link": "https://stackoverflow.com/questions/42824825/expression-expansion-using-recursion-schemes/42868606#42868606", "title": "Expression expansion using recursion schemes", "body": "<p><em>This answer has three sections. The first section, a summary in which I present my two favourite solutions, is the most important one. The second section contains types and imports, as well as extended commentary on the way towards the solutions. The third section focuses on the task of reassociating expressions, something that the original version of the answer (i.e. the second section) had not given due attention.</em></p>\n\n<p>At the end of the day, I ended up with two solutions worth discussing. The first one is <code>expandDirect</code> (cf. the third section):</p>\n\n<pre><code>expandDirect :: E a -&gt; E a\nexpandDirect = cata alg\n    where\n    alg = \\case\n        Var' s -&gt; Var s\n        Add' x y -&gt; apo coalgAdd (Add x y)\n        Mul' x y -&gt; (apo coalgAdd' . apo coalgMul) (Mul x y)\n    coalgAdd = \\case\n        Add (Add x x') y -&gt; Add' (Left x) (Right (Add x' y))\n        x -&gt; Left &lt;$&gt; project x\n    coalgAdd' = \\case\n        Add (Add x x') y -&gt; Add' (Left x) (Right (Add x' y))\n        Add x (Add y y') -&gt; Add' (Left x) (Right (Add y y'))\n        x -&gt; Left &lt;$&gt; project x\n    coalgMul = \\case\n        Mul (Add x x') y -&gt; Add' (Right (Mul x y)) (Right (Mul x' y))\n        Mul x (Add y y') -&gt; Add' (Right (Mul x y)) (Right (Mul x y'))\n        x -&gt; Left &lt;$&gt; project x\n</code></pre>\n\n<p>With it, we rebuild the tree from the bottom (<code>cata</code>). On every branch, if we find something invalid we walk back and rewrite the subtree (<code>apo</code>), redistributing and reassociating as needed until all immediate children are correctly arranged (<code>apo</code> makes it possible to do that without having to rewrite everyting down to the very bottom).</p>\n\n<p>The second solution, <code>expandMeta</code>, is a much simplified version of <code>expandFlat</code> from the third section.</p>\n\n<pre><code>expandMeta :: E a -&gt; E a\nexpandMeta = apo coalg . cata alg\n    where\n    alg = \\case\n        Var' s -&gt; pure (Var s)\n        Add' x y -&gt; x &lt;&gt; y\n        Mul' x y -&gt; Mul &lt;$&gt; x &lt;*&gt; y\n    coalg = \\case\n        x :| [] -&gt; Left &lt;$&gt; project x\n        x :| (y:ys) -&gt; Add' (Left x) (Right (y :| ys))\n</code></pre>\n\n<p><code>expandMeta</code> is a metamorphism; that is, a catamorphism followed by an anamorphism (while we are using <code>apo</code> here as well, an apomorphism is just a fancy kind of anamorphism, so I guess the nomenclature still applies). The catamorphism changes the tree into a non-empty list -- that implicitly handles the reassociation of the <code>Add</code>s -- with the list applicative being used to distribute multiplication (much like you suggest). The coalgebra then quite trivially converts the non-empty list back into a tree with the appropriate shape.</p>\n\n<hr>\n\n<p>Thank you for the question -- I had a lot of fun with it! Preliminaries:</p>\n\n<pre><code>{-# LANGUAGE LambdaCase #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE DeriveFunctor #-}\n{-# LANGUAGE DeriveFoldable #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nimport Data.Functor.Foldable\nimport qualified Data.List.NonEmpty as N\nimport Data.List.NonEmpty (NonEmpty(..))\nimport Data.Semigroup\nimport Data.Foldable (toList)\nimport Data.List (nub)\nimport qualified Data.Map as M\nimport Data.Map (Map, (!))\nimport Test.QuickCheck\n\ndata E a = Var a | Add (E a) (E a) | Mul (E a) (E a)\n    deriving (Eq, Show, Functor, Foldable)\n\ndata EF a b = Var' a | Add' b b | Mul' b b\n    deriving (Eq, Show, Functor)\n\ntype instance Base (E a) = EF a\n\ninstance Recursive (E a) where\n    project = \\case\n        Var x -&gt; Var' x\n        Add x y -&gt; Add' x y\n        Mul x y -&gt; Mul' x y\n\ninstance Corecursive (E a) where\n    embed = \\case\n        Var' x -&gt; Var x\n        Add' x y -&gt; Add x y\n        Mul' x y -&gt; Mul x y\n</code></pre>\n\n<p>To begin with, my first working (if flawed) attempt, which uses the applicative instance of (non-empty) lists to distribute:</p>\n\n<pre><code>expandTooClever :: E a -&gt; E a\nexpandTooClever = cata $ \\case\n    Var' s -&gt; Var s\n    Add' x y -&gt; Add x y\n    Mul' x y -&gt; foldr1 Add (Mul &lt;$&gt; flatten x &lt;*&gt; flatten y)\n    where\n    flatten :: E a -&gt; NonEmpty (E a)\n    flatten = cata $ \\case\n        Var' s -&gt; pure (Var s)\n        Add' x y -&gt; x &lt;&gt; y\n        Mul' x y -&gt; pure (foldr1 Mul (x &lt;&gt; y))\n</code></pre>\n\n<p><code>expandTooClever</code> has one relatively serious problem: as it calls <code>flatten</code>, a full-blown fold, for both subtrees whenever it reaches a <code>Mul</code>, it has horrible asymptotics for chains of <code>Mul</code>.</p>\n\n<p>Brute force, simplest-thing-that-could-possibly-work solution, with an algebra that calls itself recursively:</p>\n\n<pre><code>expandBrute :: E a -&gt; E a\nexpandBrute = cata alg\n    where\n    alg = \\case\n        Var' s -&gt; Var s\n        Add' x y -&gt; Add x y\n        Mul' (Add x x') y -&gt; Add (alg (Mul' x y)) (alg (Mul' x' y))\n        Mul' x (Add y y') -&gt; Add (alg (Mul' x y)) (alg (Mul' x y'))\n        Mul' x y -&gt; Mul x y\n</code></pre>\n\n<p>The recursive calls are needed because the distribution might introduce new occurrences of <code>Add</code> under <code>Mul</code>.</p>\n\n<p>A slightly more tasteful variant of <code>expandBrute</code>, with the recursive call factored out into a separate function:</p>\n\n<pre><code>expandNotSoBrute :: E a -&gt; E a\nexpandNotSoBrute = cata alg\n    where\n    alg = \\case\n        Var' s -&gt; Var s\n        Add' x y -&gt; Add x y\n        Mul' x y -&gt; dis x y\n    dis (Add x x') y = Add (dis x y) (dis x' y)\n    dis x (Add y y') = Add (dis x y) (dis x y')\n    dis x y = Mul x y\n</code></pre>\n\n<p>A tamed <code>expandNotSoBrute</code>, with <code>dis</code> being turned into an apomorphism. This way of phrasing it expresses nicely the big picture of what is going on: if you only have <code>Var</code>s and <code>Add</code>s, you can trivially reproduce the tree bottom-up without a care in the world; if you hit a <code>Mul</code>, however, you have to go back and reconstuct the whole subtree to perform the distributions (I wonder is there is a specialised recursion scheme that captures this pattern).</p>\n\n<pre><code>expandEvert :: E a -&gt; E a\nexpandEvert = cata alg\n    where\n    alg :: EF a (E a) -&gt; E a\n    alg = \\case\n        Var' s -&gt; Var s\n        Add' x y -&gt; Add x y\n        Mul' x y -&gt; apo coalg (x, y)\n    coalg :: (E a, E a) -&gt; EF a (Either (E a) (E a, E a))\n    coalg (Add x x', y) = Add' (Right (x, y)) (Right (x', y))\n    coalg (x, Add y y') = Add' (Right (x, y)) (Right (x, y'))\n    coalg (x, y) = Mul' (Left x) (Left y)\n</code></pre>\n\n<p><code>apo</code> is necessary because we want to anticipate the final result if there is nothing else to distribute. (There is a way to write it with <code>ana</code>; however, that requires wastefully rebuilding trees of <code>Mul</code>s without changes, which leads to the same asymptotics problem <code>expandTooClever</code> had.)</p>\n\n<p>Last, but not least, a solution which is both a successful realisation of what I had attempted with <code>expandTooClever</code> and my interpretation of <a href=\"https://stackoverflow.com/a/42825873/2751851\">amalloy's answer</a>. <code>BT</code> is a garden-variety binary tree with values on the leaves. A product is represented by a <code>BT a</code>, while a sum of products is a tree of trees.</p>\n\n<pre><code>expandSOP :: E a -&gt; E a\nexpandSOP = cata algS . fmap (cata algP) . cata algSOP\n    where\n    algSOP :: EF a (BT (BT a)) -&gt; BT (BT a)\n    algSOP = \\case\n        Var' s -&gt; pure (pure s)\n        Add' x y -&gt; x &lt;&gt; y\n        Mul' x y -&gt; (&lt;&gt;) &lt;$&gt; x &lt;*&gt; y\n    algP :: BTF a (E a) -&gt; E a\n    algP = \\case\n        Leaf' s -&gt; Var s\n        Branch' x y -&gt; Mul x y\n    algS :: BTF (E a) (E a) -&gt; E a\n    algS = \\case\n        Leaf' x -&gt; x\n        Branch' x y -&gt; Add x y\n</code></pre>\n\n<p><code>BT</code> and its instances:</p>\n\n<pre><code>data BT a = Leaf a | Branch (BT a) (BT a)\n    deriving (Eq, Show)\n\ndata BTF a b = Leaf' a | Branch' b b\n    deriving (Eq, Show, Functor)\n\ntype instance Base (BT a) = BTF a\n\ninstance Recursive (BT a) where\n    project (Leaf s) = Leaf' s\n    project (Branch l r) = Branch' l r\n\ninstance Corecursive (BT a) where\n    embed (Leaf' s) = Leaf s\n    embed (Branch' l r) = Branch l r\n\ninstance Semigroup (BT a) where\n    l &lt;&gt; r = Branch l r\n\n-- Writing this, as opposed to deriving it, for the sake of illustration.\ninstance Functor BT where\n    fmap f = cata $ \\case\n        Leaf' x -&gt; Leaf (f x)\n        Branch' l r -&gt; Branch l r\n\ninstance Applicative BT where\n    pure x = Leaf x\n    u &lt;*&gt; v = ana coalg (u, v)\n        where\n        coalg = \\case\n            (Leaf f, Leaf x) -&gt; Leaf' (f x)\n            (Leaf f, Branch xl xr) -&gt; Branch' (Leaf f, xl) (Leaf f, xr)\n            (Branch fl fr, v) -&gt; Branch' (fl, v) (fr, v)\n</code></pre>\n\n<p>To wrap things up, a test suite:</p>\n\n<pre><code>newtype TestE = TestE { getTestE :: E Char }\n    deriving (Eq, Show)\n\ninstance Arbitrary TestE where\n    arbitrary = TestE &lt;$&gt; sized genExpr\n        where\n        genVar = Var &lt;$&gt; choose ('a', 'z')\n        genAdd n = Add &lt;$&gt; genSub n &lt;*&gt; genSub n\n        genMul n = Mul &lt;$&gt; genSub n &lt;*&gt; genSub n\n        genSub n = genExpr (n `div` 2)\n        genExpr = \\case\n            0 -&gt; genVar\n            n -&gt; oneof [genVar, genAdd n, genMul n]\n\ndata TestRig b = TestRig (Map Char b) (E Char)\n    deriving (Show)\n\ninstance Arbitrary b =&gt; Arbitrary (TestRig b) where\n    arbitrary = do\n        e &lt;- genExpr\n        d &lt;- genDict e\n        return (TestRig d e)\n        where\n        genExpr = getTestE &lt;$&gt; arbitrary\n        genDict x = M.fromList . zip (keys x) &lt;$&gt; (infiniteListOf arbitrary)\n        keys = nub . toList\n\nunsafeSubst :: Ord a =&gt; Map a b -&gt; E a -&gt; E b\nunsafeSubst dict = fmap (dict !)\n\neval :: Num a =&gt; E a -&gt; a\neval = cata $ \\case\n    Var' x -&gt; x\n    Add' x y -&gt; x + y\n    Mul' x y -&gt; x * y\n\nevalRig :: (E Char -&gt; E Char) -&gt; TestRig Integer -&gt; Integer\nevalRig f (TestRig d e) = eval (unsafeSubst d (f e))\n\nmkPropEval :: (E Char -&gt; E Char) -&gt; TestRig Integer -&gt; Bool\nmkPropEval f = (==) &lt;$&gt; evalRig id &lt;*&gt; evalRig f\n\nisDistributed :: E a -&gt; Bool\nisDistributed = para $ \\case\n    Add' (_, x) (_, y) -&gt; x &amp;&amp; y\n    Mul' (Add _ _, _) _ -&gt; False\n    Mul' _ (Add _ _, _) -&gt; False\n    Mul' (_, x) (_, y) -&gt; x &amp;&amp; y\n    _ -&gt; True\n\nmkPropDist :: (E Char -&gt; E Char) -&gt; TestE -&gt; Bool\nmkPropDist f = isDistributed . f . getTestE\n\nmain = mapM_ test\n    [ (\"expandTooClever\" , expandTooClever)\n    , (\"expandBrute\"     , expandBrute)\n    , (\"expandNotSoBrute\", expandNotSoBrute)\n    , (\"expandEvert\"     , expandEvert)\n    , (\"expandSOP\"       , expandSOP)\n    ]\n    where\n    test (header, func) = do\n        putStrLn $ \"Testing: \" ++ header\n        putStr \"Evaluation test:   \"\n        quickCheck $ mkPropEval func\n        putStr \"Distribution test: \"\n        quickCheck $ mkPropDist func\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>By sum of products I mean sort of \"curried\" n-ary sum of products. A concise definition of sum of products is that I want an expression without any parentheses, with all parens represented by associativity and priority.</p>\n</blockquote>\n\n<p>We can adjust the solutions above so that the sums are reassociated. The easiest way is replacing the outer <code>BT</code> in <code>expandSOP</code> with <code>NonEmpty</code>. Given that the multiplication there is, much like you suggest, <code>liftA2 (&lt;&gt;)</code>, this works straight away.</p>\n\n<pre><code>expandFlat :: E a -&gt; E a\nexpandFlat = cata algS . fmap (cata algP) . cata algSOP\n    where\n    algSOP :: EF a (NonEmpty (BT a)) -&gt; NonEmpty (BT a)\n    algSOP = \\case\n        Var' s -&gt; pure (Leaf s)\n        Add' x y -&gt; x &lt;&gt; y\n        Mul' x y -&gt; (&lt;&gt;) &lt;$&gt; x &lt;*&gt; y\n    algP :: BTF a (E a) -&gt; E a\n    algP = \\case\n        Leaf' s -&gt; Var s\n        Branch' x y -&gt; Mul x y\n    algS :: NonEmptyF (E a) (E a) -&gt; E a\n    algS = \\case\n        NonEmptyF x Nothing -&gt; x\n        NonEmptyF x (Just y) -&gt; Add x y\n</code></pre>\n\n<p>Another option is using any of the other solutions and reassociating the sums in the distributed tree in a separate step.</p>\n\n<pre><code>flattenSum :: E a -&gt; E a\nflattenSum = cata alg\n    where\n    alg = \\case\n        Add' x y -&gt; apo coalg (x, y)\n        x -&gt; embed x\n    coalg = \\case\n        (Add x x', y) -&gt; Add' (Left x) (Right (x', y))\n        (x, y) -&gt; Add' (Left x) (Left y)\n</code></pre>\n\n<p>We can also roll <code>flattenSum</code> and <code>expandEvert</code> into a single function. Note that the sum coalgebra needs an extra case when it gets the result of the distribution coalgebra. That happens because, as the coalgebra proceeds from top to bottom, we can't be sure that the subtrees it generates are properly associated.</p>\n\n<pre><code>-- This is written in a slightly different style than the previous functions.\nexpandDirect :: E a -&gt; E a\nexpandDirect = cata alg\n    where\n    alg = \\case\n        Var' s -&gt; Var s\n        Add' x y -&gt; apo coalgAdd (Add x y)\n        Mul' x y -&gt; (apo coalgAdd' . apo coalgMul) (Mul x y)\n    coalgAdd = \\case\n        Add (Add x x') y -&gt; Add' (Left x) (Right (Add x' y))\n        x -&gt; Left &lt;$&gt; project x\n    coalgAdd' = \\case\n        Add (Add x x') y -&gt; Add' (Left x) (Right (Add x' y))\n        Add x (Add y y') -&gt; Add' (Left x) (Right (Add y y'))\n        x -&gt; Left &lt;$&gt; project x\n    coalgMul = \\case\n        Mul (Add x x') y -&gt; Add' (Right (Mul x y)) (Right (Mul x' y))\n        Mul x (Add y y') -&gt; Add' (Right (Mul x y)) (Right (Mul x y'))\n        x -&gt; Left &lt;$&gt; project x\n</code></pre>\n\n<p>Perhaps there is a more clever way of writing <code>expandDirect</code>, but I haven't figured it out yet. </p>\n"}], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1490111335, "creation_date": 1489635203, "last_edit_date": 1489830126, "question_id": 42824825, "link": "https://stackoverflow.com/questions/42824825/expression-expansion-using-recursion-schemes", "title": "Expression expansion using recursion schemes", "body": "<p>I have a data type representing arithmetic expressions:</p>\n\n<pre><code>data E = Add E E | Mul E E | Var String\n</code></pre>\n\n<p>I want to write an expansion function which will convert an expression into sum of products of variables (sort of braces expansion). Using recursion schemes of course.</p>\n\n<p>I only could think of an algorithm in the spirit of \"progress and preservation\". The algorithm at each step constructs terms that are fully expanded so there is no need to re-check.</p>\n\n<p>The handling of <code>Mul</code> made me crazy, so instead of doing it directly I used an isomorphic type of <code>[[String]]</code> and took advantage of <code>concat</code> and <code>concatMap</code> already implemented for me:</p>\n\n<pre><code>type Poly = [Mono]\ntype Mono = [String]\n\nmulMonoBy :: Mono -&gt; Poly -&gt; Poly\nmulMonoBy x = map (x ++)\n\nmulPoly :: Poly -&gt; Poly -&gt; Poly\nmulPoly x = concatMap (flip mulMonoBy x)\n</code></pre>\n\n<p>So then I just use <code>cata</code>:</p>\n\n<pre><code>expandList :: E -&gt; Poly\nexpandList = cata $ \\case\n   Var x -&gt; [[x]]\n   Add e1 e2 = e1 ++ e2\n   Mul e1 e2 = mulPoly e1 e2\n</code></pre>\n\n<p>And convert back:</p>\n\n<pre><code>fromPoly :: Poly -&gt; Expr\nfromPoly = foldr1 Add . map fromMono where\n   fromMono = foldr1 Mul . map Var\n</code></pre>\n\n<p>Are there significantly better approaches?</p>\n\n<p><strong>Upd:</strong> There are few confusions.</p>\n\n<ol>\n<li><p>The solution does allow multiline variable names. <code>Add (Val \"foo\" (Mul (Val \"foo) (Var \"bar\")))</code> is a representation of <code>foo + foo * bar</code>. I'm not representing <code>x*y*z</code> with <code>Val \"xyz\"</code> or something. Note that also as there are no scalars repeated vars such as \"foo * foo * quux\" are perfectly allowed.</p></li>\n<li><p>By sum of products I mean sort of \"curried\" n-ary sum of products. A concise definition of sum of products is that I want an expression without any parentheses, with all parens represented by associativity and priority.</p></li>\n</ol>\n\n<p>So <code>(foo * bar + bar) + (foo * bar + bar)</code> is not a sum of products as the because of middle <code>+</code> is sum of sums</p>\n\n<p><code>(foo * bar + (bar + (foo * bar + bar)))</code> or corresponding left-associative version are right answers, although we must guarantee that associativity is always left of always right. So the correct type for right-assoaciative solution is</p>\n\n<pre><code>data Poly = Sum Mono Poly\n          | Product Mono\n</code></pre>\n\n<p>which is isomorphic to nonempty lists: <code>NonEmpty Poly</code> (note <code>Sum Mono Poly</code> instead of <code>Sum Poly Poly</code>). If we allow empty sums or products then we get just the list of list representation I used.</p>\n\n<ol start=\"3\">\n<li>Also of you don't care about performance, the multiplication seems to be just <code>liftA2 (++)</code></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1489636144, "post_id": 42824274, "comment_id": 72760937, "body": "Numeric literals are special syntax for <code>fromInteger</code> and <code>fromRational</code> - you can create a value of type <code>Num a =&gt; a</code> because you have a function <code>f :: Num a =&gt; .. -&gt; a</code> (namely <code>fromInteger</code>). Precisely this same fact holds for any other typeclass. There are no such functions for <code>Eq</code> or <code>Ord</code>, that is, with the typeclass parameter in the return type."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 6, "last_activity_date": 1489632469, "creation_date": 1489632469, "answer_id": 42824399, "question_id": 42824274, "link": "https://stackoverflow.com/questions/42824274/is-num-special-in-this-way/42824399#42824399", "title": "Is Num special in this way?", "body": "<p><code>Num</code> isn't \"special\" in the sense that it is the only thing that it behaves this way. But it does have some characteristics that make it possible. Consider the <code>Bounded</code> typeclass instead. It is perfectly possible to define a similar function:</p>\n\n<pre><code>top :: Bounded a =&gt; a\ntop = maxBound\n</code></pre>\n\n<p>This is possible because <code>Bounded</code>, like <code>Num</code> but unlike <code>Eq</code>, provides as part of its class definition a way to create values of its type. </p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1489634422, "post_id": 42824417, "comment_id": 72760516, "body": "The aside about existentials seems likely to cause confusion, and doesn&#39;t even appear to be related, since the question is about universals."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489667389, "post_id": 42824417, "comment_id": 72777487, "body": "If you pattern match on MkEquatable, the variable inside will have type &#39;Eq a =&gt; a&#39;. Since they specifically asked if that was possible, I wanted to make sure I covered all the possibilities."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489686063, "post_id": 42824417, "comment_id": 72791456, "body": "It certainly will not. If that were so, you could cast a value of any <code>Eq</code> instance to a value of any other <code>Eq</code> instance; e.g. <code>MkEquatable True</code> is well-typed, so if <code>unEquatable :: Equatable -&gt; (Eq a =&gt; a); unEquatable (MkEquatable e) = e</code> were well-typed as you say then <code>unEquatable (MkEquatable True) :: String</code> would be well-typed, but is clearly nonsense."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1489689371, "post_id": 42824417, "comment_id": 72793443, "body": "You are correct; that code will be rejected because e is a Skolem variable, so it isn&#39;t allowed to escape its scope. It isn&#39;t universal, but he wasn&#39;t asking for that, he was asking about &#39;Eq a =&gt; a&#39;. You can, however, pass it to a polymorphic function. See <a href=\"https://prime.haskell.org/wiki/ExistentialQuantification\" rel=\"nofollow noreferrer\">here</a> and consider &#39;SuchThat &#39;[Eq] Identity&#39; <a href=\"https://gist.github.com/Lazersmoke/709c4cdd15d71389ba3f398075429a5d#file-ghostbuster-hs-L28\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 1, "last_activity_date": 1489632604, "creation_date": 1489632604, "answer_id": 42824417, "question_id": 42824274, "link": "https://stackoverflow.com/questions/42824274/is-num-special-in-this-way/42824417#42824417", "title": "Is Num special in this way?", "body": "<p><code>Num</code> is special in that it has special syntax for writing literals. This syntax uses the function <code>fromInteger :: Num a =&gt; Integer -&gt; a</code> internally, which is defined in <code>Num</code>. The compiler parses what you have written into an <code>Integer</code>, and gives that to <code>fromInteger</code> to get the type you see.</p>\n\n<p>The reason you can't do that with for example <code>Eq a =&gt; a</code> is there is no function in <code>Eq</code> that returns something of that type. </p>\n\n<p>If you really need a value like that, you can use something like <code>data Equatable = forall e. Eq e =&gt; MkEquatable e</code> using the ExistentialQuantification extension, but that is probably not what you want to do.</p>\n\n<p>Here is an example of a type class for which you can create a value with type <code>MyClass a =&gt; a</code>: <a href=\"https://gist.github.com/Lazersmoke/ce82856da2c3782e9735d4617ceb99f5\" rel=\"nofollow noreferrer\">gist</a></p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1489634657, "creation_date": 1489634657, "answer_id": 42824727, "question_id": 42824274, "link": "https://stackoverflow.com/questions/42824274/is-num-special-in-this-way/42824727#42824727", "title": "Is Num special in this way?", "body": "<p>There are many more examples:</p>\n\n<pre><code>def :: Default a =&gt; a\nmempty :: Monoid a =&gt; a\nmaxBound :: Bounded a =&gt; a\ntoEnum 0 :: Enum a =&gt; a\nread \"\" :: Read a =&gt; a\nfromString \"\" :: IsString a =&gt; a\n</code></pre>\n\n<p>This is just off the top of my head. I'm sure there's many more.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 42824399, "answer_count": 3, "score": 0, "last_activity_date": 1489634657, "creation_date": 1489631483, "question_id": 42824274, "link": "https://stackoverflow.com/questions/42824274/is-num-special-in-this-way", "title": "Is Num special in this way?", "body": "<p>I can create a <code>Num a =&gt; a</code> like this:</p>\n\n<pre><code>foo :: Num a =&gt; a\nfoo = 2\n</code></pre>\n\n<p>Similarly for any other number class:</p>\n\n<pre><code>foo :: Fractional a =&gt; a\nfoo = 2.0\n</code></pre>\n\n<p>However, I can\u2019t think of a way to create something of type <code>Eq a =&gt; a</code>, <code>Ord a =&gt; a</code>, or anything non-number (without using <code>undefined</code>).</p>\n\n<p>It seems to me that numbers are special in this way.</p>\n\n<p>Are they?</p>\n"}, {"tags": ["haskell", "types", "numbers", "polymorphism"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1489630474, "post_id": 42824079, "comment_id": 72759501, "body": "You signature suggests that we can multiply two elements of <i>any</i> type. I think we agree how to multiply <code>Int</code>s and <code>Float</code>s, but what about <code>Bool</code>, <code>String</code>, and my custom <code>Foo</code> type? It seems like you might need to constrain the types that are allowed in your <code>mult</code> function with a <i>constraint</i>."}, {"owner": {"reputation": 341, "user_id": 5701494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3fda4080fbbfd015b9d332fd287c33?s=128&d=identicon&r=PG&f=1", "display_name": "mauroc8", "link": "https://stackoverflow.com/users/5701494/mauroc8"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1489631468, "post_id": 42824079, "comment_id": 72759749, "body": "I don&#39;t know how to do it, nor can I find information about constraints that is easy to understand!"}, {"owner": {"reputation": 341, "user_id": 5701494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3fda4080fbbfd015b9d332fd287c33?s=128&d=identicon&r=PG&f=1", "display_name": "mauroc8", "link": "https://stackoverflow.com/users/5701494/mauroc8"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1489631604, "post_id": 42824079, "comment_id": 72759789, "body": "Ok, so I&#39;ve tried <code>mult :: (Num a) =&gt; a -&gt; a -&gt; a</code> but I have an &quot;ambiguous class occurrence&quot; error now."}, {"owner": {"reputation": 341, "user_id": 5701494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3fda4080fbbfd015b9d332fd287c33?s=128&d=identicon&r=PG&f=1", "display_name": "mauroc8", "link": "https://stackoverflow.com/users/5701494/mauroc8"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1489635438, "post_id": 42824079, "comment_id": 72760739, "body": "NOTE: The code in the last comment works perfectly fine. The error was because I was using an outdated parser (Hugs). It works fine using GHC"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 5701494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3fda4080fbbfd015b9d332fd287c33?s=128&d=identicon&r=PG&f=1", "display_name": "mauroc8", "link": "https://stackoverflow.com/users/5701494/mauroc8"}, "edited": false, "score": 0, "creation_date": 1489632523, "post_id": 42824331, "comment_id": 72760034, "body": "Ok so this seems to solve the answer but I can&#39;t make it work. Apparently the problem is with the interpreter &quot;Hugs&quot; I&#39;m using. I&#39;ll accept the answer because I understood now what a constraint is and how to solve the problem :)"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 341, "user_id": 5701494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3fda4080fbbfd015b9d332fd287c33?s=128&d=identicon&r=PG&f=1", "display_name": "mauroc8", "link": "https://stackoverflow.com/users/5701494/mauroc8"}, "edited": false, "score": 1, "creation_date": 1489632732, "post_id": 42824331, "comment_id": 72760093, "body": "IIRC, Hugs is a very outdated Haskell compiler/interpreter that was discontinued. I recommend that you use GHC instead (or better yet, get the <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">Haskell Stack Tool</a> to use GHC for you)"}, {"owner": {"reputation": 341, "user_id": 5701494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3fda4080fbbfd015b9d332fd287c33?s=128&d=identicon&r=PG&f=1", "display_name": "mauroc8", "link": "https://stackoverflow.com/users/5701494/mauroc8"}, "edited": false, "score": 0, "creation_date": 1489635314, "post_id": 42824331, "comment_id": 72760710, "body": "Indeed I installed GHC and now my code works!! :D Thanks for the help"}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 3, "last_activity_date": 1489631972, "creation_date": 1489631972, "answer_id": 42824331, "question_id": 42824079, "link": "https://stackoverflow.com/questions/42824079/can-i-make-a-polymorphic-mult-function-that-takes-any-numeric-type/42824331#42824331", "title": "Can I make a polymorphic `mult` function, that takes any numeric type?", "body": "<p>Short answer: <code>mult :: Num a =&gt; a -&gt; a -&gt; a</code> and it picked <code>Integer</code> because it felt like it was a good choice.</p>\n\n<p>Long answer:</p>\n\n<p><code>mult</code> can't be <code>a -&gt; a -&gt; a</code> because that would mean it works on <em>every</em> type <code>a</code>, including String, Char, Bool, etc. The <code>Num a =&gt;</code> part is called a <em>constraint</em>, and it restricts what <code>a</code> can be by requiring that it is an <em>instance</em> of the <code>Num</code> <em>type class</em>. It's like saying \"this function works on any type, as long as that type has the properties (has an instance) of this specific type class\". The properties for the <code>Num</code> type class are defined in the standard library, linked below.</p>\n\n<p>It's worth noting that the type of <code>(*)</code> itself is <code>Num a =&gt; a -&gt; a -&gt; a</code>, and that your function <code>mult</code> could also have been defined as <code>mult = (*)</code>.</p>\n\n<p>The reason it told you to use <code>Integer -&gt; Integer -&gt; Integer</code> is because the default for <code>Num</code> is Integer. You should never rely on this being the case, and should instead write out the full, type class constrained type signature.</p>\n\n<p>When you specified the type signature <code>Float -&gt; Float -&gt; Float</code>, the compiler specializes the function to only work on <code>Float</code>s, as you would expect. This resolves the \"over-promising\" problem arising from <code>a -&gt; a -&gt; a</code> by choosing a specific type for <code>a</code> that the compiler knows has a <code>Num</code> instance.</p>\n\n<p>Read more about type classes <a href=\"https://www.haskell.org/tutorial/classes.html\" rel=\"nofollow noreferrer\">here</a>, and the specific definition of <code>Num</code> is documented <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#t:Num\" rel=\"nofollow noreferrer\">here</a> and the code is linked on the side of the page. (Not enough rep to post the link directly)</p>\n"}], "owner": {"reputation": 341, "user_id": 5701494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3fda4080fbbfd015b9d332fd287c33?s=128&d=identicon&r=PG&f=1", "display_name": "mauroc8", "link": "https://stackoverflow.com/users/5701494/mauroc8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 42824331, "answer_count": 1, "score": 0, "last_activity_date": 1489631972, "creation_date": 1489630119, "question_id": 42824079, "link": "https://stackoverflow.com/questions/42824079/can-i-make-a-polymorphic-mult-function-that-takes-any-numeric-type", "title": "Can I make a polymorphic `mult` function, that takes any numeric type?", "body": "<p>I'm learning Haskell. This is the very first program that I've ever wrote and I just thought of making a simple function that returns the product of the given arguments.</p>\n\n<pre><code>mult :: a -&gt; a -&gt; a\nmult x y = x * y\n</code></pre>\n\n<p>When I write it this way, I get an \"inferred type\" error.</p>\n\n<pre><code>ERROR \"uno.hs\":5 - Inferred type is not general enough\n*** Expression    : mult\n*** Expected type : a -&gt; a -&gt; a\n*** Inferred type : Integer -&gt; Integer -&gt; Integer\n</code></pre>\n\n<p>It wants me to write it this way:</p>\n\n<pre><code>mult :: Int -&gt; Int -&gt; Int\nmult x y = x * y\n</code></pre>\n\n<p>...which works perfectly fine, but then I wonder... can't this function work on <code>Float</code>s as well?</p>\n\n<p>It can.</p>\n\n<pre><code>mult :: Float -&gt; Float -&gt; Float\nmult x y = x * y\n\n--then\nmult 4 5 == 20.0\n</code></pre>\n\n<p>Finally, I wonder:</p>\n\n<p><strong>Can I make a polymorphic <code>mult</code> function, that takes any numeric type?</strong></p>\n\n<p><strong>Why does the parser infers <code>Integrer</code> from a function that also works with other types?</strong></p>\n\n<p>I found no answers so far, yet this seems like a simple question. I'll be grateful for help me.</p>\n"}, {"tags": ["list", "haskell", "types"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1489628372, "post_id": 42823762, "comment_id": 72758907, "body": "Your question isn&#39;t really an actual question, but it looks like you should just use <code>map</code> in order to make a function that does <code>[Album] -&gt; [[Fan]]</code>"}, {"owner": {"reputation": 65, "user_id": 2890184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJNE1.png?s=128&g=1", "display_name": "FracturedPixel", "link": "https://stackoverflow.com/users/2890184/fracturedpixel"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1489629709, "post_id": 42823762, "comment_id": 72759288, "body": "thank you, updated my question"}], "answers": [{"tags": [], "owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "is_accepted": true, "score": 2, "last_activity_date": 1489631258, "creation_date": 1489631258, "answer_id": 42824253, "question_id": 42823762, "link": "https://stackoverflow.com/questions/42823762/remove-type-from-type-list-haskell/42824253#42824253", "title": "remove type from type list haskell", "body": "<p>As 4castle mentioned, you can use <code>map</code>:</p>\n\n<pre><code>getAlbumFans :: [Album] -&gt; [[Fan]]\ngetAlbumFans database = map (\\(_,_,_,fans) -&gt; fans) database\n</code></pre>\n\n<p>Also you could make the <code>manAlbum</code> function more readable by giving it a more descriptive name like <code>getAlbumsByManager</code> and replacing <code>String</code> in the type signature with <code>Manager</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "is_accepted": false, "score": 0, "last_activity_date": 1489650029, "creation_date": 1489650029, "answer_id": 42827961, "question_id": 42823762, "link": "https://stackoverflow.com/questions/42823762/remove-type-from-type-list-haskell/42827961#42827961", "title": "remove type from type list haskell", "body": "<p>Another solution might be to make <code>Album</code> an algebraic data type. I guess that the code might be easier to understand, when rewritten as follows:</p>\n\n<pre><code>type Title = String\ntype Manager = String\ntype Year = Int\ntype Fan = String\ndata Album = Album { title :: Title, manager :: Manager, year :: Year, fans :: [Fan]} deriving (Show)\n\nalbumDatabase :: [Album]\nalbumDatabase = [Album {title=\"A\", manager=\"B\", year=5, fans=[\"a\",\"b\"]}]\n\ncheck :: Album -&gt; String -&gt; Bool\ncheck a d=title a==d\n\nmanAlbum :: String -&gt; [Album] -&gt; [[Fan]]\nmanAlbum d database = map (\\a-&gt;fans a) $ filter (\\a-&gt;title a==d) database\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 2890184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJNE1.png?s=128&g=1", "display_name": "FracturedPixel", "link": "https://stackoverflow.com/users/2890184/fracturedpixel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 1, "accepted_answer_id": 42824253, "answer_count": 2, "score": 3, "last_activity_date": 1489650029, "creation_date": 1489627898, "last_edit_date": 1489629680, "question_id": 42823762, "link": "https://stackoverflow.com/questions/42823762/remove-type-from-type-list-haskell", "title": "remove type from type list haskell", "body": "<p>So i'm new to Haskell, and I was wondering if anyone could help me.</p>\n\n<p>I've got a list of a custom data type like so:</p>\n\n<pre><code>type Title = String\ntype Manager = String\ntype Year = Int\ntype Fan = String\ntype Album = (Title, Manager, Year, [Fan])\n</code></pre>\n\n<p>And I have a pre-made static database of albums</p>\n\n<pre><code>albumDatabase :: [Album]\nalbumDatabase = [(...)]\n</code></pre>\n\n<p>And I have a function that returns all albums that a manager has made:</p>\n\n<pre><code>manAlbum :: String -&gt; [Album] -&gt; [Album]\nmanAlbum d database = filter ((\\(_,album,_,_) -&gt; d == album)) database\n</code></pre>\n\n<p>My question is, from this new list of all the managers albums, I need to retrieve only the fans and drop the Title, Manager and Year. However I am unsure of how to tell haskell that I only want this field from the custom datatype to be returned.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1489645700, "post_id": 42823547, "comment_id": 72764057, "body": "Why do you want that, BTW?"}, {"owner": {"reputation": 227, "user_id": 415681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0229f7b532255330eff351932ca7b59c?s=128&d=identicon&r=PG", "display_name": "Adz", "link": "https://stackoverflow.com/users/415681/adz"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1489658002, "post_id": 42823547, "comment_id": 72770900, "body": "I am experimenting without base, but it&#39;s annoying to have to rebuild all the time, instead of working with ghci"}], "owner": {"reputation": 227, "user_id": 415681, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0229f7b532255330eff351932ca7b59c?s=128&d=identicon&r=PG", "display_name": "Adz", "link": "https://stackoverflow.com/users/415681/adz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1489724554, "creation_date": 1489626500, "last_edit_date": 1489724554, "question_id": 42823547, "link": "https://stackoverflow.com/questions/42823547/how-can-i-use-cabal-repl-without-base", "title": "How can I use &quot;cabal repl&quot; without base", "body": "<p>How can I use cabal repl (ghci) without base?</p>\n\n<p>The following contrived example shows the error</p>\n\n<pre><code>-- minimal.hs\nmodule Minimal where\n\nmyId :: a -&gt; a\nmyId x = x\n</code></pre>\n\n<p>and</p>\n\n<pre><code>-- minimal.cabal\nname: minimal\nversion: 0.0.1\nbuild-type: Simple\ncabal-version: &gt;= 1.10\n\nlibrary\n  exposed-modules: Minimal\n  --build-depends: base\n  default-language: Haskell2010\n  default-extensions:  NoImplicitPrelude\n</code></pre>\n\n<p>cabal build succeeds</p>\n\n<pre><code>$ cabal build\nBuilding minimal-0.0.1...\nPreprocessing library minimal-0.0.1...\n[1 of 1] Compiling Minimal          ( Minimal.hs, dist\\build\\Minimal.o )\n</code></pre>\n\n<p>but cabal repl fails</p>\n\n<pre><code>$ cabal repl\nPreprocessing library minimal-0.0.1...\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n\n&lt;interactive&gt;:1:6: error:\n    Not in scope: `System.IO.hSetBuffering'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:30: error:\n    Not in scope: `System.IO.stdin'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:46: error:\n    Not in scope: data constructor `System.IO.NoBuffering'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:70: error:\n    Not in scope: `System.IO.hSetBuffering'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:94: error:\n    Not in scope: `System.IO.stdout'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:111: error:\n    Not in scope: data constructor `System.IO.NoBuffering'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:135: error:\n    Not in scope: `System.IO.hSetBuffering'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:159: error:\n    Not in scope: `System.IO.stderr'\n    No module named `System.IO' is imported.\n\n&lt;interactive&gt;:1:176: error:\n    Not in scope: data constructor `System.IO.NoBuffering'\n    No module named `System.IO' is imported.\n</code></pre>\n\n<p>if i restore \"build-depends: base\" if works as expected.</p>\n\n<pre><code>$ cabal repl\nPreprocessing library minimal-0.0.1...\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Minimal          ( Minimal.hs, interpreted )\nOk, modules loaded: Minimal.\n*Minimal&gt;\n</code></pre>\n\n<p>i know just keeping \"build-depends: base\" will make it work, but thats not what i am asking.</p>\n\n<p>Note: this also applies for stack</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "edited": false, "score": 1, "creation_date": 1489627234, "post_id": 42823511, "comment_id": 72758644, "body": "Did you try switching <code>Int</code> to <code>Integer</code>? I think there is probably an underflow issue. And I think default is <code>Integer</code> so the third lambda should work..."}, {"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "reply_to_user": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "edited": false, "score": 0, "creation_date": 1489627688, "post_id": 42823511, "comment_id": 72758742, "body": "Ah, I forgot to type-constrain the test values. Yep, that should solve it."}], "answers": [{"comments": [{"owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "edited": false, "score": 0, "creation_date": 1489627894, "post_id": 42823732, "comment_id": 72758789, "body": "I&#39;m using Integral to keep it general, but that works well"}], "tags": [], "owner": {"reputation": 14609, "user_id": 667648, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/mTpbt.jpg?s=128&g=1", "display_name": "Dair", "link": "https://stackoverflow.com/users/667648/dair"}, "is_accepted": true, "score": 4, "last_activity_date": 1489627698, "creation_date": 1489627698, "answer_id": 42823732, "question_id": 42823511, "link": "https://stackoverflow.com/questions/42823511/unexpected-behaviour-with-powers-of-2/42823732#42823732", "title": "unexpected behaviour with powers of 2", "body": "<p>Switch from <code>Int</code> to <code>Integer</code>. Basically, you are creating an <code>Int</code> so large that it overflows. <code>Integer</code> is arbitrary precision.</p>\n\n<p>(Note: On different architectures, the number can vary. My computer fails at <code>63</code> instead of <code>31</code>).</p>\n"}], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 42823732, "answer_count": 1, "score": 1, "last_activity_date": 1489627698, "creation_date": 1489626290, "question_id": 42823511, "link": "https://stackoverflow.com/questions/42823511/unexpected-behaviour-with-powers-of-2", "title": "unexpected behaviour with powers of 2", "body": "<p>I found a strange error in some code I wrote for computing estimates based on binary logarithms (log base 2). Here is the code for <code>lb</code>, which computes the binary logarithm of a positive integer:</p>\n\n<pre><code>lb :: Int -&gt; Maybe Int -- Binary logarithm, rounded down\nlb 1 = Just 0\nlb x\n    | 1 &lt; x = (+1) &lt;$&gt; lb (div x 2)\n    | otherwise = Nothing\n</code></pre>\n\n<p>Here is the error, as demonstrated in the following annotated ghci output</p>\n\n<pre><code>\u03bb: lb (2^30)\nJust 30\n\u03bb: lb (2^31) -- should be Just 31\nNothing\n\u03bb: 1 &lt; 2^31 -- smoke check, lb's first guard evaluates to True\nTrue\n\u03bb: lb (div (2^31) 2) == lb (2^30) -- smoke check, these should be equal\nFalse\n\u03bb: div (2^31) 2 == 2^30 -- smoke check, these are indeed equal\nTrue\n</code></pre>\n\n<p>It seems that <code>lb (2^31)</code> somehow fails the first guard, leading to the <code>otherwise</code> expression, but I can find no consistent explanation for why.</p>\n\n<p>Additionally, it seems the expression <code>div (2^31) 2</code> is somehow not evaluating to the same thing as <code>2^30</code> in the body of <code>lb</code></p>\n"}, {"tags": ["haskell", "cabal", "cabal-sandbox"], "comments": [{"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1489623473, "post_id": 42822979, "comment_id": 72757694, "body": "This doesn&#39;t directly answer your question, but as a beginner, you&#39;ll likely have an easier time using an alternative to <code>cabal</code>: <code>stack</code>. <a href=\"https://haskell-lang.org/get-started\" rel=\"nofollow noreferrer\">This</a> is a good starting point."}, {"owner": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "reply_to_user": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1489691280, "post_id": 42822979, "comment_id": 72794547, "body": "I did try my way around stack, and I could do what I wanted. Thanks!"}], "owner": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1043, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489622460, "creation_date": 1489622460, "last_edit_date": 1495535394, "question_id": 42822979, "link": "https://stackoverflow.com/questions/42822979/haskell-fail-to-load-interface-for-system-console-ansi-after-installing-pack", "title": "Haskell - fail to load interface for &#39;System.Console.ANSI&#39; after installing package", "body": "<p>I've been learning haskell for the pask few days, and I find it to be very interesting though I'm not used to pure functional paradigm.</p>\n\n<p>I've been trying to make my first \"real\" program (after helloworld, fizzbuzz &amp; co), which is to make a Snake game in haskell. To do it, I'd like to clean the console and to print new things in it (I'm on Windows).</p>\n\n<p>I've found this to help me: \n<a href=\"https://stackoverflow.com/questions/2472391/how-do-i-clear-the-terminal-screen-in-haskell\">How do I clear the terminal screen in Haskell?</a></p>\n\n<p>So I updated cabal with \"cabal update\". Then I created my folder \"Snake\", and cd into it. Then I did \"cabal sandbox init\", followed by \"cabal install ansi-terminal\", and created the following file :</p>\n\n<pre><code>import Data.List\nimport System.IO\nimport System.Console.ANSI\n\nmain = do\n    putStrLn (\"Test\")\n    clearScreen\n    test &lt;- getInput\n    putStrLn (\"You entered \" ++ (show(test)))\n</code></pre>\n\n<p>When I do \"ghc --make Snake.hs\", it returns the error \"Failed to load interface for 'System.Console.ANSI'\"</p>\n\n<p>What exactly am I missing? </p>\n"}]