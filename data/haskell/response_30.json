[{"tags": ["haskell", "vector"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 3, "creation_date": 1438810673, "post_id": 31843006, "comment_id": 51608061, "body": "Can you give a concrete example of what you want to do?"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 9, "last_activity_date": 1438811712, "creation_date": 1438811712, "answer_id": 31843507, "question_id": 31843006, "link": "https://stackoverflow.com/questions/31843006/haskell-cycle-a-vector/31843507#31843507", "title": "Haskell cycle a vector", "body": "<p>No.  The existing Vector's in the Vector package allocate at least the spine and thus you can not have <code>Vector.cycle</code> without infinite memory.</p>\n\n<p>For example, <code>Data.Vector</code> uses <code>Data.Primitive.Array</code>.</p>\n\n<p>Since the internals of the vector package (e.g. <code>Data.Vector.Generic.*</code>) allow you to define other types of Vectors in a flexible manner, you could make a vector type that computes the index modulo the length to provide cyclic behavior (and includes an offset for use with <code>drop</code>).  So the construction is conceivable, just not done.</p>\n"}, {"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 2, "last_activity_date": 1438869809, "last_edit_date": 1438869809, "creation_date": 1438863573, "answer_id": 31855603, "question_id": 31843006, "link": "https://stackoverflow.com/questions/31843006/haskell-cycle-a-vector/31855603#31855603", "title": "Haskell cycle a vector", "body": "<p>If you want a finite representation of cyclic lists (not vectors so you'll still have an access time linear in the size of the cycle), you may want to have a look at <a href=\"https://github.com/gallais/potpourri/blob/master/haskell/cyclic/CyclicListFlat.hs\" rel=\"nofollow\">this module</a> I was playing with last year.</p>\n\n<p>By the way, the reason why <a href=\"https://github.com/gallais/potpourri/blob/master/haskell/cyclic/CyclicListFlat.hs#L150\" rel=\"nofollow\">the type of fold</a> is quite weird is <a href=\"http://gallais.github.io/blog/cyclic-list-purely\" rel=\"nofollow\">explained here</a>. Basically the idea is that we may or may not decide to unfold the cycle depending on whether we use the induction hypothesis given to us.</p>\n"}], "owner": {"reputation": 3023, "user_id": 1691145, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b6744a17b41f3b0e5c7554a43a04094?s=128&d=identicon&r=PG", "display_name": "Justin Raymond", "link": "https://stackoverflow.com/users/1691145/justin-raymond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 31843507, "answer_count": 2, "score": 4, "last_activity_date": 1438869809, "creation_date": 1438809453, "last_edit_date": 1438864967, "question_id": 31843006, "link": "https://stackoverflow.com/questions/31843006/haskell-cycle-a-vector", "title": "Haskell cycle a vector", "body": "<p>Is there a vector alternative of Data.List's <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:cycle\" rel=\"nofollow\">cycle</a>?</p>\n\n<p>The Data.Vector docs have a section titled <a href=\"http://hackage.haskell.org/package/vector-0.9.1/docs/Data-Vector-Generic.html#g:41\" rel=\"nofollow\">Recycling support</a> that sounds like it is what I would want but the functions <code>new</code> and <code>clone</code> clearly don't do what <code>cycle</code> does.</p>\n\n<p>The solution I was thinking about is just repeatedly index the vector with  (a counter mod the length of the vector).</p>\n\n<p>An example of what I needed to do, is I need an infinite list of randomly shuffled grids, but the grids are large and so keeping millions of them in memory is not ideal. I realized that it did not matter if the cycle of random was relatively small, so instead I generated a list of only a couple hundred grids and then used <code>Data.List.cycle</code> to give the illusion of infinite length. I am now converted the <code>list</code> of grids to a <code>Vector</code> of grids and can no longer use <code>cycle</code>.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1438812987, "post_id": 31843630, "comment_id": 51608960, "body": "Looks fine to me. I will apply it to my project, and present to the community. Then we can talk about better approaches."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1438813480, "post_id": 31843630, "comment_id": 51609157, "body": "There was a comment from another person here. I think I removed it by accident. How to restore?"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1438812301, "creation_date": 1438812301, "answer_id": 31843630, "question_id": 31842612, "link": "https://stackoverflow.com/questions/31842612/how-would-i-increment-or-otherwise-change-a-value-in-a-record-with-simon-ness/31843630#31843630", "title": "How would I increment or otherwise change a value in a record with &quot;Simon-ness&quot;", "body": "<p>Shooting from the hip here...</p>\n\n<p>There class <code>Has</code> is not powerful enough to set values. You would have to add another typeclass function, e.g. something like:</p>\n\n<pre><code>class Has a l b | a l -&gt; b where\n  from :: a -&gt; Label l -&gt; b\n  set  :: b -&gt; a -&gt; Label l -&gt; a\n</code></pre>\n\n<p>and the definitions for <code>Person1</code> might go like this:</p>\n\n<pre><code>instance Has Person1 \"age\" Int where\n  from (Person1 a _) _ = unField a\n  set v (Person1 a b) _ = Person1 (Field v) b\n</code></pre>\n\n<p>and an <code>incAge</code> function could be written like this:</p>\n\n<pre><code>incAge :: (Num b, Has a \"age\" b) =&gt; a -&gt; a\nincAge pnt = let a = from pnt (Get :: Label \"age\")\n             in set (a+1) pnt (Get :: Label \"age\")\n</code></pre>\n\n<p>This compiles, although I'm not sure if this is really useful or the best approach.</p>\n"}], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 31843630, "answer_count": 1, "score": 1, "last_activity_date": 1438812301, "creation_date": 1438808012, "last_edit_date": 1438809820, "question_id": 31842612, "link": "https://stackoverflow.com/questions/31842612/how-would-i-increment-or-otherwise-change-a-value-in-a-record-with-simon-ness", "title": "How would I increment or otherwise change a value in a record with &quot;Simon-ness&quot;", "body": "<p>The below code is from this <a href=\"http://dev.stephendiehl.com/hask/\" rel=\"nofollow\">tutorial</a></p>\n\n<p>it illustrates very well how to operate on values from records with \"Simon-ness\" (illustrated below). What I am struggling with is how to modify values inside records with \"Simon-ness\", say incrementing \"age\". I keep thinking it has to do with the way Label is defined with the constructor Get. Could I add another constructor Put?</p>\n\n<blockquote>\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE ConstraintKinds #-}\n\n\nimport GHC.TypeLits\n\nnewtype Field (n :: Symbol) v = Field { unField :: v } deriving Show\n\ndata Person1 = Person1\n  { _age      :: Field \"age\" Int\n  , _name     :: Field \"name\" String\n  }\n\ndata Person2 = Person2\n  { _age'  :: Field \"age\" Int\n  , _name' :: Field \"name\" String\n  , _lib'  :: Field \"lib\" String\n  }\n\nderiving instance Show Person1\nderiving instance Show Person2\n\ndata Label (l :: Symbol) = Get\n\nclass Has a l b | a l -&gt; b where\n  from :: a -&gt; Label l -&gt; b\n\ninstance Has Person1 \"age\" Int where\n  from (Person1 a _) _ = unField a\n\ninstance Has Person1 \"name\" String where\n  from (Person1 _ a) _ = unField a\n\ninstance Has Person2 \"age\" Int where\n  from (Person2 a _ _) _ = unField a\n\ninstance Has Person2 \"name\" String where\n  from (Person2 _ a _) _ = unField a\n\nage :: Has a \"age\" b =&gt; a -&gt; b\nage pnt = from pnt (Get :: Label \"age\")\n\nname :: Has a \"name\" b =&gt; a -&gt; b\nname pnt = from pnt (Get :: Label \"name\")\n\n-- Parameterized constraint kind for \"Simon-ness\" of a record.\ntype Simon a = (Has a \"name\" String, Has a \"age\" Int)\n\nspj :: Person1\nspj = Person1 (Field 56) (Field \"Simon Peyton Jones\")\n\nsmarlow :: Person2\nsmarlow = Person2 (Field 38) (Field \"Simon Marlow\") (Field \"rts\")\n\n\ncatNames :: (Simon a, Simon b) =&gt; a -&gt; b -&gt; String\ncatNames a b = name a ++ name b\n\naddAges :: (Simon a, Simon b) =&gt; a -&gt; b -&gt; Int\naddAges a b = age a + age b\n\n\nnames :: String\nnames = name smarlow ++ \",\" ++ name spj\n-- \"Simon Marlow,Simon Peyton Jones\"\n\nages :: Int\nages = age spj + age smarlow\n-- 94\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell", "types", "numbers", "typeclass"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1438805756, "post_id": 31841767, "comment_id": 51605474, "body": "You might like the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1270011\" rel=\"nofollow noreferrer\">graph from the Report</a> that details the relationships between the standard classes and types."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1438805826, "post_id": 31841767, "comment_id": 51605505, "body": "For starters, does this help? <a href=\"https://wiki.haskell.org/Converting_numbers\" rel=\"nofollow noreferrer\">wiki.haskell.org/Converting_numbers</a>"}, {"owner": {"reputation": 3185, "user_id": 241899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/56dfa400a964081e78a0be24978e7cdf?s=128&d=identicon&r=PG", "display_name": "Vitaly Olegovitch", "link": "https://stackoverflow.com/users/241899/vitaly-olegovitch"}, "edited": false, "score": 0, "creation_date": 1438805832, "post_id": 31841767, "comment_id": 51605509, "body": "You should take a look here: <a href=\"https://en.wikibooks.org/wiki/Haskell/Type_basics_II\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Type_basics_II</a>"}, {"owner": {"reputation": 2017, "user_id": 4106994, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6Y8lC.jpg?s=128&g=1", "display_name": "Afonso Matos", "link": "https://stackoverflow.com/users/4106994/afonso-matos"}, "edited": false, "score": 0, "creation_date": 1438806038, "post_id": 31841767, "comment_id": 51605623, "body": "Those resources don&#39;t cover anything besides converting from/to Integers, Doubles and Ints."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1438812326, "post_id": 31841767, "comment_id": 51608714, "body": "@catgocat No, Daniel&#39;s suggestion covered much more."}], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1438864063, "post_id": 31843034, "comment_id": 51630799, "body": "<code>Ratio</code> is the ratio of two values having <i>any</i> numeric type. <code>Rational</code> is the ratio of two <i>arbitrary precision</i> integers."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 19, "last_activity_date": 1438817848, "last_edit_date": 1438817848, "creation_date": 1438809568, "answer_id": 31843034, "question_id": 31841767, "link": "https://stackoverflow.com/questions/31841767/explanation-of-numbers-in-haskell/31843034#31843034", "title": "Explanation of numbers in Haskell", "body": "<p>This answer mostly assumes you know the difference between types and type classes.  If that difference is hazy to you then <a href=\"http://learnyouahaskell.com/types-and-typeclasses\" rel=\"noreferrer\">clear up your understanding</a> there before reading on.</p>\n\n<p><strong>Num</strong></p>\n\n<p><code>Num</code> is a typeclass that includes all numeric types.</p>\n\n<pre><code>:info Num\nclass Num a where\n  (+) :: a -&gt; a -&gt; a\n  (-) :: a -&gt; a -&gt; a\n  (*) :: a -&gt; a -&gt; a\n  negate :: a -&gt; a\n  abs :: a -&gt; a\n  signum :: a -&gt; a\n  fromInteger :: Integer -&gt; a\n        -- Defined in \u2018GHC.Num\u2019\ninstance Num Word -- Defined in \u2018GHC.Num\u2019\ninstance Num Integer -- Defined in \u2018GHC.Num\u2019\ninstance Num Int -- Defined in \u2018GHC.Num\u2019\ninstance Num Float -- Defined in \u2018GHC.Float\u2019\ninstance Num Double -- Defined in \u2018GHC.Float\u2019\n</code></pre>\n\n<p><strong>Real</strong></p>\n\n<p>Also a typeclass covering those types that can be represented as a real value (the <code>Rational</code> type).</p>\n\n<pre><code>:info Real\nclass (Num a, Ord a) =&gt; Real a where\n  toRational :: a -&gt; Rational\n        -- Defined in \u2018GHC.Real\u2019\ninstance Real Word -- Defined in \u2018GHC.Real\u2019\ninstance Real Integer -- Defined in \u2018GHC.Real\u2019\ninstance Real Int -- Defined in \u2018GHC.Real\u2019\ninstance Real Float -- Defined in \u2018GHC.Float\u2019\ninstance Real Double -- Defined in \u2018GHC.Float\u2019\n</code></pre>\n\n<p><strong>Integral</strong></p>\n\n<p>A type class for integrals, you know, <code>...,-2,-1,0,1,...</code>.  Types such as Integer (aka big int), Int, Int64, etc are instances.</p>\n\n<pre><code>:info Integral\nclass (Real a, Enum a) =&gt; Integral a where\n  quot :: a -&gt; a -&gt; a\n  rem :: a -&gt; a -&gt; a\n  div :: a -&gt; a -&gt; a\n  mod :: a -&gt; a -&gt; a\n  quotRem :: a -&gt; a -&gt; (a, a)\n  divMod :: a -&gt; a -&gt; (a, a)\n  toInteger :: a -&gt; Integer\n        -- Defined in \u2018GHC.Real\u2019\ninstance Integral Word -- Defined in \u2018GHC.Real\u2019\ninstance Integral Integer -- Defined in \u2018GHC.Real\u2019\ninstance Integral Int -- Defined in \u2018GHC.Real\u2019\n</code></pre>\n\n<p><strong>Integer</strong></p>\n\n<p>A type, not a type class such as what we've talked about till now, that can represent unbounded integers.  So <code>2^3028</code> is a legal value.</p>\n\n<p><strong>Int</strong></p>\n\n<p>A fixed-width integral.  In the GHC compiler this is 32 or 64 bits depending on your architecture.  The Haskell language only guarantees this will be at least 29 bits.</p>\n\n<p><strong>Ratio</strong></p>\n\n<p>This is a type constructor, so you would say something like <code>Ratio Integer</code> to get a type for ratio's of two integers (mathematically <code>a/b</code>).</p>\n\n<p><strong>Rational</strong></p>\n\n<p>Well a rational is literally a ratio of two integers, understand ratio and you're good:</p>\n\n<pre><code>:i Rational\ntype Rational = Ratio Integer\n</code></pre>\n\n<p><strong>Double</strong></p>\n\n<p>A type for double precision floating point values.</p>\n\n<p><strong>Float</strong></p>\n\n<p>A type for single precision floating point values.</p>\n"}, {"comments": [{"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 2, "creation_date": 1529175229, "post_id": 31862764, "comment_id": 88782547, "body": "This image is outdated, thoug sufficient for this discussion. For clarification, the hierarchy for Functors is now <code>Functor =&gt; Applicative =&gt; Monad</code> and <code>Applicative =&gt; Alternative</code> and <code>Monad =&gt; MonadPlus</code>, although that&#39;s not being discussed here"}], "tags": [], "owner": {"reputation": 4685, "user_id": 5180989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gxpck.jpg?s=128&g=1", "display_name": "Helder Pereira", "link": "https://stackoverflow.com/users/5180989/helder-pereira"}, "is_accepted": false, "score": 4, "last_activity_date": 1438884192, "creation_date": 1438884192, "answer_id": 31862764, "question_id": 31841767, "link": "https://stackoverflow.com/questions/31841767/explanation-of-numbers-in-haskell/31862764#31862764", "title": "Explanation of numbers in Haskell", "body": "<p>There is an interesting image in the <a href=\"https://www.haskell.org/onlinereport/basic.html#sect6.3\" rel=\"nofollow\">Haskell documentation</a> showing the relations between classes and their type instances, covering most of the ones you mentioned:</p>\n\n<p><img src=\"https://www.haskell.org/onlinereport/classes.gif\"/></p>\n\n<p>Concerning the <a href=\"https://www.haskell.org/onlinereport/ratio.html\" rel=\"nofollow\">Rational numbers</a>:</p>\n\n<blockquote>\n  <p>For each <code>Integral</code> type t, there is a type <code>Ratio</code> t of rational pairs\n  with components of type t. The type name <code>Rational</code> is a synonym for\n  <code>Ratio Integer</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 2017, "user_id": 4106994, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6Y8lC.jpg?s=128&g=1", "display_name": "Afonso Matos", "link": "https://stackoverflow.com/users/4106994/afonso-matos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4830, "favorite_count": 3, "accepted_answer_id": 31843034, "answer_count": 2, "score": 12, "last_activity_date": 1440345143, "creation_date": 1438804784, "last_edit_date": 1440345143, "question_id": 31841767, "link": "https://stackoverflow.com/questions/31841767/explanation-of-numbers-in-haskell", "title": "Explanation of numbers in Haskell", "body": "<p>I would like a clear explanation of <code>Num</code>, <code>Real</code>, <code>Integral</code>, <code>Integer</code>, <code>Int</code>, <code>Ratio</code>, <code>Rational</code>, <code>Double</code>, <code>Float</code>.</p>\n"}, {"tags": ["haskell", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 4, "creation_date": 1438804391, "post_id": 31841597, "comment_id": 51604770, "body": "You have a typo in the name of &#39;resolveDescendingInterval&#39;, so there is no generic case for that function."}, {"owner": {"reputation": 675, "user_id": 949432, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/169fa6aeda7ffdb391fcafef0a9359cb?s=128&d=identicon&r=PG", "display_name": "prog keys", "link": "https://stackoverflow.com/users/949432/prog-keys"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1438805824, "post_id": 31841597, "comment_id": 51605503, "body": "omg sorry for the dumb question, FP complete VI&#39;s mode cursor is getting an aditional char on visual mode."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1438812791, "post_id": 31841597, "comment_id": 51608884, "body": "GHC should emit two warnings on the code above: about the non exhaustive function, and about the misnamed function lacking a type signature. Enable warnings if you did not -- they can be really useful."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1438804728, "last_edit_date": 1438804728, "creation_date": 1438804400, "answer_id": 31841649, "question_id": 31841597, "link": "https://stackoverflow.com/questions/31841597/non-exhaustive-patterns/31841649#31841649", "title": "Non-exhaustive patterns", "body": "<p>This is just a typo.  Notice <code>resolveDescendingIInterval</code> is a different function from <code>resolveDescendingInterval</code>.  Get rid of that extra <code>I</code>.</p>\n\n<p>EDIT: Consider the following slightly unsafe code:</p>\n\n<pre><code>resolveDecendingInterval interval note = toEnum (fromEnum note - interval)\n</code></pre>\n\n<p>This is a partial function - it will fail when the interval is too large and we call <code>toEnum</code> on something out of range. You can clamp the range via code such as <code>max (fromEnum (minBound :: Note)) . min (fromEnum (maxBound :: Note))</code>. But there's probably a smarter way I'm just not thinking off immediately.</p>\n\n<p>One alternative would be to clamp the <code>interval</code> via <code>rem interval (fromEnum note)</code> but then you'll need to handle the case when note is minBound separately.</p>\n"}], "owner": {"reputation": 675, "user_id": 949432, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/169fa6aeda7ffdb391fcafef0a9359cb?s=128&d=identicon&r=PG", "display_name": "prog keys", "link": "https://stackoverflow.com/users/949432/prog-keys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "closed_date": 1439176150, "accepted_answer_id": 31841649, "answer_count": 1, "score": -1, "last_activity_date": 1438804728, "creation_date": 1438804266, "question_id": 31841597, "link": "https://stackoverflow.com/questions/31841597/non-exhaustive-patterns", "closed_reason": "Not suitable for this site", "title": "Non-exhaustive patterns", "body": "<p>Given I have the following code:</p>\n\n<pre><code>data Note = C | Db | D | Eb | E | F | Gb | G | Ab | A | Bb | B\n      deriving (Show, Eq, Ord, Enum)\n\nnext :: Note -&gt; Note\nnext B = C\nnext n = succ n\n\nprevious :: Note -&gt; Note\nprevious C = B\nprevious n = pred n\n\nresolveAscendingInterval :: Int -&gt; Note -&gt; Note\nresolveAscendingInterval 0 note = note\nresolveAscendingInterval interval note = resolveAscendingInterval (interval -1) (next note)\n\nresolveDescendingInterval :: Int -&gt; Note -&gt; Note\nresolveDescendingInterval 0 note = note\nresolveDescendingIInterval interval note = resolveDescendingIInterval (interval -1) (previous note)\n\nmain :: IO ()\n    main = do\n    print $ resolveAscendingInterval 3 C\n    print $ resolveDescendingInterval 3 C\n</code></pre>\n\n<p>resolveAscendingInterval works fine, but when I run resolveDescendingInterval I get:</p>\n\n<p><strong>Non-exhaustive patterns in function resolveDescendingInterval</strong></p>\n\n<p>Their code and logic are very similar, so I don't have a clue of whats wrong</p>\n\n<p>Another thing: Is there another way to achieve this behavior without recursion?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438806484, "post_id": 31840661, "comment_id": 51605853, "body": "Completely unrelated to your problem, but you might like <code>angleWithXCompare p1 p2 = compare (minusCosAngleWithX p1, norm2 p1) (minusCosAngleWithX p2, norm2 p2)</code> or perhaps <code>angleWithXCompare p1 p2 = compare (minusCosAngleWithX p1) (minusCosAngleWithX p2) &lt;&gt; compare (norm2 p1) (norm2 p2)</code>. (The latter simplifies quite nicely once you learn about <code>comparing</code>: <code>angleWithXCompare = comparing minusCosAngleWithX &lt;&gt; comparing norm2</code>.)"}, {"owner": {"reputation": 5786, "user_id": 3914041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b88c2ec674ac08403a26fed93c0db4?s=128&d=identicon&r=PG&f=1", "display_name": "ldirer", "link": "https://stackoverflow.com/users/3914041/ldirer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438808625, "post_id": 31840661, "comment_id": 51607091, "body": "Thanks @DanielWagner, that&#39;s much clearer than my 5-line boilerplate function. I don&#39;t really understand what <code>&lt;&gt;</code> does though (except for <i>the right thing</i> in this usecase). Any chance there&#39;s a specific name for this symbol? It&#39;s tough to Google and Hoogle results seem irrelevant ;)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1438809847, "post_id": 31840661, "comment_id": 51607683, "body": "The <a href=\"http://hoogle.haskell.org/?hoogle=%3C%3E\" rel=\"nofollow noreferrer\">alpha deployment of the next version of Hoogle</a> gets the right answer for <code>(&lt;&gt;)</code>. It&#39;s another name for <code>mappend</code> from <code>Monoid</code> -- and there happen to be <code>Monoid</code> instances for <code>Ordering</code> and <code>a -&gt; b</code> (provided <code>b</code> is a <code>Monoid</code>) that do what&#39;s wanted here."}, {"owner": {"reputation": 5786, "user_id": 3914041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b88c2ec674ac08403a26fed93c0db4?s=128&d=identicon&r=PG&f=1", "display_name": "ldirer", "link": "https://stackoverflow.com/users/3914041/ldirer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438810051, "post_id": 31840661, "comment_id": 51607786, "body": "Thanks. Did not really get it for now but at least I know where to find the doc."}], "answers": [{"comments": [{"owner": {"reputation": 5786, "user_id": 3914041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b88c2ec674ac08403a26fed93c0db4?s=128&d=identicon&r=PG&f=1", "display_name": "ldirer", "link": "https://stackoverflow.com/users/3914041/ldirer"}, "edited": false, "score": 0, "creation_date": 1438807914, "post_id": 31842224, "comment_id": 51606705, "body": "Thanks! I got carried away with the <code>.</code> and partial function application... What I wanted to have was (vectorDiff p1) applied to all the arguments before they were passed to <code>angleWithXCompare</code>. I think what was happening instead is that my function was passing the first argument to <code>(vectorDiff p1)</code> but the second one straight to <code>angleWithXCompare</code>."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 5, "last_activity_date": 1438807300, "last_edit_date": 1438807300, "creation_date": 1438806528, "answer_id": 31842224, "question_id": 31840661, "link": "https://stackoverflow.com/questions/31840661/sort-function-does-not-seem-to-break-ties/31842224#31842224", "title": "Sort function does not seem to break ties", "body": "<p>Something is not right with your \"comparison\" function, e.g.:</p>\n\n<pre><code>test =\n  let p1 = TwoD {x = 2.0, y = 1.0}\n      p2 = TwoD 5 1\n      p3 = TwoD 4 1\n      cmp = angleWithXCompare . vectorDiff p1\n  in (cmp p2 p3, cmp p3 p2)\n</code></pre>\n\n<p>This yields:</p>\n\n<pre><code>ghci&gt; test\n(LT, LT)\n</code></pre>\n\n<p>I would expect either <code>(LT,GT)</code> or <code>(GT,LT)</code></p>\n\n<p>Update: You want to use this comparison function:</p>\n\n<pre><code>  cmp a b = angleWithXCompare (vectorDiff p1 a) (vectorDiff p1 b)\n</code></pre>\n\n<p>in your <code>List.sortBy</code> call, e.g.:</p>\n\n<pre><code>grahamSort ps =\n let p1 = grahamGetFirstCandidate ps\n in\n    p1 : List.sortBy cmp (filter (/=p1) ps)\n where cmp a b = angleWithXCompare (vectorDiff p1 a) (vectorDiff p1 b)\n</code></pre>\n"}], "owner": {"reputation": 5786, "user_id": 3914041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b88c2ec674ac08403a26fed93c0db4?s=128&d=identicon&r=PG&f=1", "display_name": "ldirer", "link": "https://stackoverflow.com/users/3914041/ldirer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 31842224, "answer_count": 1, "score": 2, "last_activity_date": 1439504711, "creation_date": 1438801014, "last_edit_date": 1439504711, "question_id": 31840661, "link": "https://stackoverflow.com/questions/31840661/sort-function-does-not-seem-to-break-ties", "title": "Sort function does not seem to break ties", "body": "<p>I just started learning Haskell.\nI'm going through the exercises of \"Real World Haskell\", chapter 3 and I'm stumped on a behavior I don't understand.</p>\n\n<p>I don't understand why my <code>grahamSort</code> does not seem to break ties properly. The function first finds a reference point P (through <code>grahamGetFirstCandidate</code>) then sorts the other points according to the angle they and P form with the x axis. I'm using (minus) the cosine as a proxy for the angle.<br>\n<code>grahamGetFirstCandidate</code> seems to work as expected.</p>\n\n<p>The code (sorry it's probably not very clean):</p>\n\n<pre><code>import Data.List as List\n\ndata TwoD = TwoD {\nx :: Float,\ny :: Float\n} deriving (Show, Eq)\n\ndotProduct :: TwoD -&gt; TwoD -&gt; Float\ndotProduct (TwoD xa ya) (TwoD xb yb) = xa * xb + ya * yb\n\ngrahamGetFirstCandidate :: [TwoD] -&gt; TwoD\ngrahamGetFirstCandidate [] = error \"Trying to find point with minimum y in empty List\"\ngrahamGetFirstCandidate (p:ps) = search p ps where\n    search :: TwoD -&gt; [TwoD] -&gt; TwoD\n    search pmin [] = pmin\n    search pmin (p1:ps) | y pmin &gt; y p1 = search p1 ps\n                        | y pmin &lt; y p1 = search pmin ps\n                        | x pmin &gt; x p1 = search p1 ps\n                        | otherwise = search pmin ps\n\nnorm2 :: TwoD -&gt; Float\nnorm2 (TwoD x y) = sqrt (x ** 2 + y ** 2)\n\nminusCosAngleWithX :: TwoD -&gt; Float\nminusCosAngleWithX v = (-1) * dotProduct (TwoD 1 0) v / norm2 v\n\n-- compare according to the angle with X axis. I did not know about Data.Ord.comparing\nangleWithXCompare :: TwoD -&gt; TwoD -&gt; Ordering\nangleWithXCompare p1 p2 | minusCosAngleWithX p1 &gt; minusCosAngleWithX p2 = GT\n                       | minusCosAngleWithX p1 &lt; minusCosAngleWithX p2 = LT\n                       | norm2 p1 &gt; norm2 p2 = GT -- break ties\n                       | norm2 p1 &lt; norm2 p2 = LT\n                       | otherwise = EQ\n\nvectorDiff :: TwoD -&gt; TwoD -&gt; TwoD\nvectorDiff p1 p2 = TwoD (x p2 - x p1) (y p2 - y p1)\n\ngrahamSort :: [TwoD] -&gt; [TwoD]\n-- sortBy angle (~-cosine) of (p1, p) with x axis\ngrahamSort ps = let p1 = grahamGetFirstCandidate ps in\n                   p1 : List.sortBy (angleWithXCompare . vectorDiff p1) (filter (/=p1) ps)\nmain :: IO()\nmain = let ps = [TwoD 4 3, TwoD 5 1, TwoD 4 1, TwoD 1 2, TwoD 5 2, TwoD 2 1, TwoD 3 5, TwoD 2 3]\n    in do\n     print ps\n     print $ grahamGetFirstCandidate ps\n     print $ grahamSort ps\n</code></pre>\n\n<p>Here's the output I get</p>\n\n<pre><code>[TwoD {x = 4.0, y = 3.0},TwoD {x = 5.0, y = 1.0},TwoD {x = 4.0, y = 1.0},TwoD {x = 1.0, y = 2.0},TwoD {x = 5.0, y = 2.0},TwoD {x = 2.0, y = 1.0},TwoD {x = 3.0, y = 5.0},TwoD {x = 2.0, y = 3.0}]\nTwoD {x = 2.0, y = 1.0} -- This is the correct result\n[TwoD {x = 2.0, y = 1.0},TwoD {x = 5.0, y = 1.0},TwoD {x = 4.0, y = 1.0},TwoD {x = 5.0, y = 2.0},TwoD {x = 4.0, y = 3.0},TwoD {x = 2.0, y = 3.0},TwoD {x = 3.0, y = 5.0},TwoD {x = 1.0, y = 2.0}]\n</code></pre>\n\n<p>What I want (and was expecting) is that the point (4, 1) appears <strong>before</strong> (5, 1) in the sorted list.  </p>\n\n<p>If I change the order of the input points it swaps (4, 1) and (5, 1) in the output as well:</p>\n\n<pre><code>main = let ps = [TwoD 4 3, TwoD 4 1, TwoD 5 1, TwoD 1 2, TwoD 5 2, TwoD 2 1, TwoD 3 5, TwoD 2 3]\n    in do\n     print ps\n     print $ grahamGetFirstCandidate ps\n     print $ grahamSort ps\n\n[TwoD {x = 4.0, y = 3.0},TwoD {x = 4.0, y = 1.0},TwoD {x = 5.0, y = 1.0},TwoD {x = 1.0, y = 2.0},TwoD {x = 5.0, y = 2.0},TwoD {x = 2.0, y = 1.0},TwoD {x = 3.0, y = 5.0},TwoD {x = 2.0, y = 3.0}]\nTwoD {x = 2.0, y = 1.0}\n[TwoD {x = 2.0, y = 1.0},TwoD {x = 4.0, y = 1.0},TwoD {x = 5.0, y = 1.0},TwoD {x = 5.0, y = 2.0},TwoD {x = 4.0, y = 3.0},TwoD {x = 2.0, y = 3.0},TwoD {x = 3.0, y = 5.0},TwoD {x = 1.0, y = 2.0}]\n</code></pre>\n\n<p>I'm obviously missing something, any help will be appreciated.</p>\n\n<p>Edit: Well, I'm noticing now the order of the last points is not correct either: (3, 5) should appear before (2, 3). When I print the cosines, they look correct (=should give the right order, up to the ties), so there's probably something wrong with <code>angleWithXCompare</code>.</p>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1438794717, "post_id": 31838776, "comment_id": 51599170, "body": "See <a href=\"http://stackoverflow.com/questions/16457111/how-to-design-a-monadic-stack\">this question</a>"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1438795822, "post_id": 31838776, "comment_id": 51599748, "body": "@luqui Didn&#39;t find that. Yet I&#39;d like to keep this question: at least it&#39;s much narrower in scope, so can be answered better."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438824788, "post_id": 31838776, "comment_id": 51612104, "body": "By the way, lambdabot has a monad-stack-unroller. Try <code>?unmtl</code> in the #haskell channel."}], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 10, "last_activity_date": 1438795439, "last_edit_date": 1438795439, "creation_date": 1438794971, "answer_id": 31838868, "question_id": 31838776, "link": "https://stackoverflow.com/questions/31838776/whats-the-difference-between-statet-s-exceptt-e-m-and-exceptt-e-statet-s-m/31838868#31838868", "title": "What&#39;s the difference between StateT s (ExceptT e m) and ExceptT e (StateT s m)?", "body": "<p>I answer this myself, but other answers are welcome!</p>\n\n<p>Consider the example:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack runghc --package mtl \n\n{-# LANGUAGE FlexibleContexts #-}\nmodule Main (main) where\n\nimport Control.Applicative\nimport Control.Monad.State\nimport Control.Monad.Error\nimport Control.Monad.Trans.Except\nimport Data.Functor.Identity\n\ntest1 :: (MonadState Int m, MonadError String m) =&gt; m Bool\ntest1 = do\n  put 1\n  throwError \"foobar\"\n  put 2\n  return False\n\ntest2 :: (Alternative m, MonadState Int m, MonadError String m) =&gt; m Bool\ntest2 = do\n  put 4\n  test1 &lt;|&gt; return True\n\nrunStateExceptT :: Monad m =&gt; s -&gt; ExceptT e (StateT s m) a -&gt; m (Either e a, s)\nrunStateExceptT s = flip runStateT s . runExceptT\n\nrunExceptStateT :: Monad m =&gt; s -&gt; StateT s (ExceptT e m) a -&gt; m (Either e (a, s))\nrunExceptStateT s = runExceptT . flip runStateT s\n\nmain :: IO ()\nmain = do\n  print $ runIdentity . runStateExceptT 3 $ test1\n  print $ runIdentity . runExceptStateT 3 $ test1\n  print $ runIdentity . runStateExceptT 3 $ test2\n  print $ runIdentity . runExceptStateT 3 $ test2\n</code></pre>\n\n<p>It will print:</p>\n\n<pre><code>(Left \"foobar\",1)\nLeft \"foobar\"\n(Right True,1)\nRight (True,4)\n</code></pre>\n\n<p>With <code>ExceptT</code> outside, you'll still get the state which was at the moment of \"throwing an error\". This is probably what you want. </p>\n\n<p>Remember that this combination resembles imperative programming <em>a lot</em>. One should think about exception safety practicies, i.e. must be careful about when to <code>throwError</code>!</p>\n"}, {"comments": [{"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "edited": false, "score": 6, "creation_date": 1479246957, "post_id": 31839103, "comment_id": 68475041, "body": "This might give a more immediately clear picture, so: <code>StateT s (ExceptT e m) a</code> has the &quot;expanded&quot; form: <code>s -&gt; m (Either e (s, a))</code> whilst <code>ExceptT e (StateT s m)</code> &quot;expands&quot; to: <code>s -&gt; m (s, Either e a)</code>. The former allows you to roll-back changes to the state when an error occurs in <code>catchError</code>, while the latter commits faulty states making them harder to rollback. In some languages you actually want the latter. Recommended reading: <a href=\"http://www.cse.chalmers.se/edu/course/TDA342_Advanced_Functional_Programming/lecture8.html\" rel=\"nofollow noreferrer\">cse.chalmers.se/edu/course/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": true, "score": 17, "last_activity_date": 1438795767, "creation_date": 1438795767, "answer_id": 31839103, "question_id": 31838776, "link": "https://stackoverflow.com/questions/31838776/whats-the-difference-between-statet-s-exceptt-e-m-and-exceptt-e-statet-s-m/31839103#31839103", "title": "What&#39;s the difference between StateT s (ExceptT e m) and ExceptT e (StateT s m)?", "body": "<pre><code>StateT s (ExceptT e m)\n</code></pre>\n\n<p>This says:</p>\n\n<ul>\n<li>Start with <code>m</code></li>\n<li>Add exceptions to that</li>\n<li>Add state to that</li>\n</ul>\n\n<p>Now, 'adding exceptions' means your actions can terminate in two ways: either with a normal return value, or with an exception.</p>\n\n<p>'Adding state' means that an extra bit of state output gets included in <em>the normal return values</em>.</p>\n\n<p>So in <code>StateT s (ExceptT e m)</code>, you only get a result state if there is no exception.</p>\n\n<p>On the other hand,</p>\n\n<pre><code>ExceptT e (StateT s m)\n</code></pre>\n\n<p>says:</p>\n\n<ul>\n<li>Start with <code>m</code></li>\n<li>Add state to that</li>\n<li>Add exceptions to that</li>\n</ul>\n\n<p>'Adding state' means that an extra bit of state output gets included in the return values of <code>m</code>.</p>\n\n<p>But now, your added exceptions get added as an alternative return value <em>inside the <code>StateT</code> monad</em>.  So you always get a state output, and then you may get a normal return value or you may get an exception along with it.</p>\n"}], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 4, "accepted_answer_id": 31839103, "answer_count": 2, "score": 14, "last_activity_date": 1438795767, "creation_date": 1438794603, "question_id": 31838776, "link": "https://stackoverflow.com/questions/31838776/whats-the-difference-between-statet-s-exceptt-e-m-and-exceptt-e-statet-s-m", "title": "What&#39;s the difference between StateT s (ExceptT e m) and ExceptT e (StateT s m)?", "body": "<p>Monad transformers are tricky, and I'm not sure (= don't have good intuition) which one should go on top.</p>\n"}, {"tags": ["haskell", "installation", "package", "persistent"], "comments": [{"owner": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "edited": false, "score": 0, "creation_date": 1438825134, "post_id": 31838660, "comment_id": 51612176, "body": "Can you post the contents of <b>C:\\Users\\TR@FI_02\\AppData\\Roaming\\cabal\\logs\\persistent-sqli&zwnj;&#8203;te-2.2.log</b>?"}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "reply_to_user": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "edited": false, "score": 0, "creation_date": 1438847037, "post_id": 31838660, "comment_id": 51619796, "body": "@AlainO&#39;Dea cf. edited question"}, {"owner": {"reputation": 18252, "user_id": 154527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9367d0448b8fc3e6d7f6cd421940ac62?s=128&d=identicon&r=PG", "display_name": "Alain O&#39;Dea", "link": "https://stackoverflow.com/users/154527/alain-odea"}, "edited": false, "score": 0, "creation_date": 1438880815, "post_id": 31838660, "comment_id": 51642975, "body": "Ouch.  That&#39;s not great.  The problematic ldscript is probably deleted after failure.  I&#39;ve used DTrace to pause ghc in situations like this so I can read the offending files.  There may be a way to do something with the Visual Studio Debugger."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 5500292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f1bf98ef48b621345ea844c8b82e68?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Schlesinger", "link": "https://stackoverflow.com/users/5500292/samuel-schlesinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1472794611, "creation_date": 1472794611, "answer_id": 39284984, "question_id": 31838660, "link": "https://stackoverflow.com/questions/31838660/haskell-package-persistent-sqlite-fails-to-install-in-windows-with-ld-error/39284984#39284984", "title": "Haskell package persistent-sqlite fails to install in Windows with ld error", "body": "<p>That would indicate to me that I should make sure my sql driver is installed and is on my path such that GHC can link to it properly. </p>\n"}], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472794611, "creation_date": 1438794155, "last_edit_date": 1438871237, "question_id": 31838660, "link": "https://stackoverflow.com/questions/31838660/haskell-package-persistent-sqlite-fails-to-install-in-windows-with-ld-error", "title": "Haskell package persistent-sqlite fails to install in Windows with ld error", "body": "<p>Trying either one of the following commands in my Win7 system fails.</p>\n\n<pre><code>$ stack install persistent-sqlite\n$ cabal install persistent-sqlite\n</code></pre>\n\n<p>The error is some rather opaque <code>ld</code> related thing.</p>\n\n<pre><code>Resolving dependencies...\nConfiguring persistent-sqlite-2.2...\nBuilding persistent-sqlite-2.2...\nFailed to install persistent-sqlite-2.2\nBuild log ( C:\\Users\\TR@FI_02\\AppData\\Roaming\\cabal\\logs\\persistent-sqlite-2.2.log ):\nBuilding persistent-sqlite-2.2...\nPreprocessing library persistent-sqlite-2.2...\n[1 of 2] Compiling Database.Sqlite  ( Database\\Sqlite.hs, dist\\build\\Database\\Sqlite.o )\nC:\\Users\\TR@FI_02\\AppData\\Local\\Temp\\ghc4324_0\\ghc4324_9.ldscript: file not recognized: File format not recognized\ncollect2: ld returned 1 exit status\n</code></pre>\n\n<p>I have no clue what a possible cause might be. Can anyone reproduce this on their system? Where could I start looking to fix this?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The log mentioned in the output contains the same information:</p>\n\n<pre><code>Building persistent-sqlite-2.2...\nPreprocessing library persistent-sqlite-2.2...\n[1 of 2] Compiling Database.Sqlite  ( Database\\Sqlite.hs, dist\\build\\Database\\Sqlite.o )\nC:\\Users\\TR@FI_02\\AppData\\Local\\Temp\\ghc4324_0\\ghc4324_9.ldscript: file not recognized: File format not recognized\ncollect2: ld returned 1 exit status\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>This is potentially a rare bug limited to two win7 installations on two PCs I have here. I was not able to consistently reproduce the failure on <em>every</em> win7 system.</p>\n"}, {"tags": ["haskell", "persistent", "esqueleto"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1439078757, "post_id": 31836740, "comment_id": 51714486, "body": "Sure looks like a <a href=\"https://github.com/prowdsponsor/esqueleto/issues\" rel=\"nofollow noreferrer\">bug</a> to me"}, {"owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "edited": false, "score": 0, "creation_date": 1440802450, "post_id": 31836740, "comment_id": 52440369, "body": "What database backend were you using?"}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1440856562, "post_id": 31836740, "comment_id": 52451230, "body": "edited the question."}], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1440856553, "creation_date": 1438788588, "last_edit_date": 1440856553, "question_id": 31836740, "link": "https://stackoverflow.com/questions/31836740/a-database-esqueleto-riddle-regarding-val-true", "title": "A Database.Esqueleto riddle regarding ==. val True", "body": "<p>While debugging a query that unexpectedly returned an empty list, I realized that I wrote something silly:</p>\n\n<pre><code>fetchDim cId = runDb . select . from $ \\dim -&gt; do\n  where_ dim ^. DimensionIsRowKey ==. val True\n  return dim\n</code></pre>\n\n<p>... because you can append <code>== True</code> to any Boolean value. Replacing it with the following unexpectedly solved my problem and the result wasn't an empty list anymore.</p>\n\n<pre><code>fetchDim cId = runDb . select . from $ \\dim -&gt; do\n  where_ dim ^. DimensionIsRowKey\n  return dim\n</code></pre>\n\n<p>Anyone can enlighten me about the actual difference between the two? Why would there be any?</p>\n\n<p>EDIT: The database backend is sqlite.</p>\n"}, {"tags": ["haskell", "amazon-web-services", "web-applications", "server"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1438778124, "post_id": 31831487, "comment_id": 51587265, "body": "A bit unspecific... what do you mean by framework? What have you tried?"}, {"owner": {"reputation": 2598, "user_id": 2939175, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/100002492231539/picture?type=large", "display_name": "Mate Hegedus", "link": "https://stackoverflow.com/users/2939175/mate-hegedus"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1438780388, "post_id": 31831487, "comment_id": 51588999, "body": "Have not tried anything yet, but I did not find anything on Google about what others have done to setup a haskell webapp on aws, that&#39;s why I am asking on soverflow"}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 2, "creation_date": 1438781798, "post_id": 31831487, "comment_id": 51590126, "body": "EC2 is basically having a server there.... so anything would work.... <a href=\"https://hackage.haskell.org/package/wai\" rel=\"nofollow noreferrer\">this for example</a>. But if you feel particularly adventurous, you could try <a href=\"https://github.com/ghcjs/ghcjs\" rel=\"nofollow noreferrer\">ghcjs</a> and Amazon Lambda. Just don&#39;t forget to write a blog post about that if you go that way."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1438781997, "post_id": 31831487, "comment_id": 51590293, "body": "I did deploy a Yesod app in AWS previously and there was no specific problem I faced. This <a href=\"http://www.yesodweb.com/book/deploying-your-webapp\" rel=\"nofollow noreferrer\">chapter</a> from the Yesod book was a great reference."}], "answers": [{"tags": [], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "is_accepted": false, "score": 0, "last_activity_date": 1438878706, "creation_date": 1438878706, "answer_id": 31861154, "question_id": 31831487, "link": "https://stackoverflow.com/questions/31831487/how-would-you-host-a-haskell-web-app-on-aws/31861154#31861154", "title": "How would you host a Haskell web app on AWS?", "body": "<p>Haskell web servers are just like any other web server application - they bind themselves to a port (usually <code>8080</code>, <code>3000</code>, etc in development) and serve over it. You could either force the application to bind to port <code>80</code> (via the <code>-p</code> flag in Yesod, or in the code with Scotty) as a super user, or you could reroute port <code>80</code> to your development port with <code>iptables</code>.</p>\n\n<p>However, this doesn't protect you against the process itself failing - for that you would need a watchdog integration, usually with systemd or Upstart. Other than that it's pretty standard.</p>\n"}, {"tags": [], "owner": {"reputation": 608, "user_id": 912960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a97a78882cf6ecd30c81dc5c14f0993a?s=128&d=identicon&r=PG&f=1", "display_name": "grdvnl", "link": "https://stackoverflow.com/users/912960/grdvnl"}, "is_accepted": false, "score": 2, "last_activity_date": 1483748799, "creation_date": 1483748799, "answer_id": 41516500, "question_id": 31831487, "link": "https://stackoverflow.com/questions/31831487/how-would-you-host-a-haskell-web-app-on-aws/41516500#41516500", "title": "How would you host a Haskell web app on AWS?", "body": "<p>I recently attempted to host a Scotty(Haskell) based web application onto Amazon Beanstalk. Since, there was no direct support for Haskell, I had to take the docker approach. The steps involved using a default docker image from Stack (I used stack to build my application), hosting on Docker Hub and referencing that image from Amazon Elastic Beanstalk. </p>\n\n<p>I documented that whole process in a sample HelloScotty project on <a href=\"https://github.com/gdevanla/helloscotty\" rel=\"nofollow noreferrer\">Github</a></p>\n"}], "owner": {"reputation": 2598, "user_id": 2939175, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/100002492231539/picture?type=large", "display_name": "Mate Hegedus", "link": "https://stackoverflow.com/users/2939175/mate-hegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1483748799, "creation_date": 1438774817, "question_id": 31831487, "link": "https://stackoverflow.com/questions/31831487/how-would-you-host-a-haskell-web-app-on-aws", "title": "How would you host a Haskell web app on AWS?", "body": "<p>How would you go about hosting a Haskell web app on Amazon web services? What frameworks would you use?</p>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1438852847, "post_id": 31829805, "comment_id": 51623507, "body": "Note that this is not a good implementation. <code>head</code> is generally frowned upon; this is definitely not a safe use (the program will just crash if the key isn&#39;t found, with no easy way to see where things went awry). Better would be something like this: <code>valueOf :: State -&gt; String -&gt; Maybe Int</code>. For this safe signature, there are actually standard functions available which do the lookup just like you want: <code>lookup</code> or <code>find</code>. Also, consider <a href=\"http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Map-Lazy.html\" rel=\"nofollow noreferrer\">switching to <code>Map</code></a>, which is more efficient for such lookups."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 4, "last_activity_date": 1438770778, "creation_date": 1438770778, "answer_id": 31829999, "question_id": 31829805, "link": "https://stackoverflow.com/questions/31829805/finding-a-single-element-in-a-list-using-list-comprehension/31829999#31829999", "title": "Finding a single element in a list using list comprehension", "body": "<p><code>(a,b) &lt;- xs</code> is not a lambda, it is a generator in a <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow\">list comprehension</a></p>\n\n<p>In this case it successively binds the pairs in the source list <code>xs</code> and matches them with <code>(a, b)</code>. The boolean guard <code>a == var</code> retains all elements for which <code>a == var</code> is true.</p>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 1576064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47c868b652ffdc287498a8c604a30013?s=128&d=identicon&r=PG", "display_name": "Lubom&#237;r Sedl&#225;\u0159", "link": "https://stackoverflow.com/users/1576064/lubom%c3%adr-sedl%c3%a1%c5%99"}, "is_accepted": true, "score": 8, "last_activity_date": 1438847123, "last_edit_date": 1438847123, "creation_date": 1438770822, "answer_id": 31830027, "question_id": 31829805, "link": "https://stackoverflow.com/questions/31829805/finding-a-single-element-in-a-list-using-list-comprehension/31830027#31830027", "title": "Finding a single element in a list using list comprehension", "body": "<p>There is no lambda expression. What you are seeing is a list comprehension, which is a way of creating a list of values satisfying a certain condition.</p>\n\n<p>In this case the comprehension <code>[b | (a,b) &lt;- xs , a ==var ]</code> means something like: create a list of all <code>b</code>s such that <code>(a, b)</code> is an element of list <code>xs</code>, where <code>a</code> is equal to <code>var</code>.</p>\n\n<p>In imperative pseudo-code you could write it as</p>\n\n<pre><code>result = EMPTY_LIST\nfor (a,b) in xs:\n    if a == var:\n        result.add(b)\nreturn result\n</code></pre>\n\n<p>So, the whole <code>valueOf</code> function works by generating a list of values that have the right <code>String</code> key, and then uses <code>head</code> function to get the first one. Note that if there is no match, the whole computation will crash.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1438770873, "creation_date": 1438770873, "answer_id": 31830049, "question_id": 31829805, "link": "https://stackoverflow.com/questions/31829805/finding-a-single-element-in-a-list-using-list-comprehension/31830049#31830049", "title": "Finding a single element in a list using list comprehension", "body": "<p>The line</p>\n\n<pre><code>valueOf xs var  = head [b | (a,b) &lt;- xs , a ==var ]\n</code></pre>\n\n<p>is equivalent to the lambda expression</p>\n\n<pre><code>valueOf = \\xs var -&gt; head [b | (a,b) &lt;- xs , a ==var ]\n</code></pre>\n\n<p>However, I guess that what really confuses you is the list comprehension <code>[b | (a,b) &lt;- xs , a ==var ]</code>. This expression builds a list as follows: loop over all the pairs in <code>xs</code> (this is the part <code>(a,b)&lt;-xs</code>), keep only those pairs where <code>a==var</code>, then take all the remaining <code>b</code> and build a list with those.</p>\n\n<p>With <code>head</code> in front, this will simply look in <code>xs</code> for the first pair whose first component is <code>var</code>, and return its second component. If no such pair is found, a runtime error will be generated (unless <code>xs</code> is an infinite list, which will cause the program to run forever).</p>\n"}], "owner": {"reputation": 3189, "user_id": 3296266, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/MnEpU.png?s=128&g=1", "display_name": "Stanko", "link": "https://stackoverflow.com/users/3296266/stanko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "accepted_answer_id": 31830027, "answer_count": 3, "score": 2, "last_activity_date": 1438847123, "creation_date": 1438770340, "last_edit_date": 1438831662, "question_id": 31829805, "link": "https://stackoverflow.com/questions/31829805/finding-a-single-element-in-a-list-using-list-comprehension", "title": "Finding a single element in a list using list comprehension", "body": "<p>The function <code>valueOf</code> gets the <code>Int</code> value of the corresponding <code>String</code> out of a tuple list.\nCan someone explain how the third line works? </p>\n\n<pre><code>type State = [(String,Int)]\n\nvalueOf :: State -&gt; String -&gt; Int\nvalueOf xs var  = head [b | (a,b) &lt;- xs , a ==var ]\n</code></pre>\n\n<p>I've never seen a Haskell expression like that, I'm more used to expression like this:</p>\n\n<pre><code>(\\xs -&gt; length xs &gt; 15)\n</code></pre>\n"}, {"tags": ["haskell", "io"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1438748571, "post_id": 31823391, "comment_id": 51570948, "body": "Nice.  Btw those parentheses are redundant."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1438751346, "post_id": 31823391, "comment_id": 51571645, "body": "I would add spaces around <code>.</code>. That makes it a lot more obvious: <code>unlines . map f . lines</code>. And you probably want to add a type."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1438751503, "post_id": 31823391, "comment_id": 51571695, "body": "Some other useful standard functions for transformations like this: <code>words</code>, <code>unwords</code>, <code>intersperse</code>, <code>intercalate</code>, and <code>concatMap</code>."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 2, "creation_date": 1438765298, "post_id": 31823391, "comment_id": 51578874, "body": "Reminds me of <a href=\"https://www.joachim-breitner.de/blog/156-Haskell_on_the_Command_Line\" rel=\"nofollow noreferrer\">this old blog post</a> of mine."}], "tags": [], "owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "is_accepted": false, "score": 5, "last_activity_date": 1438752760, "last_edit_date": 1438752760, "creation_date": 1438748456, "answer_id": 31823391, "question_id": 31823390, "link": "https://stackoverflow.com/questions/31823390/how-to-use-haskells-interact-linewise/31823391#31823391", "title": "How to use Haskell&#39;s `interact` linewise?", "body": "<p>The most elegant solution I found so far is this oneliner:</p>\n\n<pre><code>interactLinewise f = interact $ unlines . map f . lines\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1438752760, "creation_date": 1438748456, "question_id": 31823390, "link": "https://stackoverflow.com/questions/31823390/how-to-use-haskells-interact-linewise", "title": "How to use Haskell&#39;s `interact` linewise?", "body": "<p>Solving some practise exercises I found 2 reoccuring IO patterns. The first pattern is already covered with the handy <code>interact</code>. The second pattern is similiar but processes the input linewise. </p>\n\n<p>How to write an <code>interactLinewise</code> method?</p>\n"}, {"tags": ["python", "haskell", "functional-programming", "elixir"], "answers": [{"comments": [{"owner": {"reputation": 2809, "user_id": 857893, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e6fd86546de70ba1498df22c03e53bd?s=128&d=identicon&r=PG", "display_name": "kevlar1818", "link": "https://stackoverflow.com/users/857893/kevlar1818"}, "edited": false, "score": 0, "creation_date": 1438959064, "post_id": 31828107, "comment_id": 51678833, "body": "Thanks to you both! Both answers are very helpful and equally useful in their own ways. I find it difficult to choose a &quot;correct&quot; answer."}], "tags": [], "owner": {"reputation": 21174, "user_id": 693166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c9230466478ce6a7236f9bec819d57?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142 Obrok", "link": "https://stackoverflow.com/users/693166/pawe%c5%82-obrok"}, "is_accepted": false, "score": 3, "last_activity_date": 1438765785, "last_edit_date": 1495541640, "creation_date": 1438765785, "answer_id": 31828107, "question_id": 31823272, "link": "https://stackoverflow.com/questions/31823272/seeking-idiomatic-elegant-solution-to-sendmore-money-in-elixir/31828107#31828107", "title": "Seeking idiomatic, elegant solution to &quot;send+more=money&quot; in Elixir", "body": "<p>You can take a look here: <a href=\"https://stackoverflow.com/questions/31755499/what-is-the-symbols-purpose-in-elixir\">What is the &quot;|&gt;&quot; symbol&#39;s purpose in Elixir?</a> for an overview of the <code>|&gt;</code> operator. But the basic idea is that <code>a |&gt; f(b, c)</code> is the same as <code>f(a, b, c)</code>. This is pretty useful when you do something like <code>a |&gt; f(b) |&gt; g(c)</code> which by the rule above is the same as <code>g(f(a, b), c)</code>, but reads much more nicely.</p>\n\n<p>With that said the <code>|&gt;</code> operator (called the pipeline) is not monadic bind (<code>&gt;&gt;=</code>) and will not allow you to \"flatten\" deeply nested loops like <code>&gt;&gt;=</code> does. For alternative approaches to the task that will look better in Elixir you can:</p>\n\n<ol>\n<li>Use a library implementing a syntax for Monads (or add your own), like <a href=\"https://github.com/rob-brown/MonadEx\" rel=\"nofollow noreferrer\">MonadEx</a></li>\n<li><p>Stop using this loopy approach and for example generate an assignment of numbers to letters using a recursive function upfront, like so:</p>\n\n<pre><code>defmodule Smm do\n  # some more things\n\n  def assignments(0, _), do: [[]]\n  def assignments(n, digits \\\\ Enum.into(0..9, HashSet.new)) do\n    digits\n    |&gt; Stream.flat_map(fn (d) -&gt;\n      for rest &lt;- assignments(n - 1, Set.delete(digits, d)) do\n        [d | rest]\n      end\n    end)\n  end\nend\n\nfor [s, e, n, d, m, o, r, y] &lt;- Smm.assignments(8) do\n  w_send = Smm.to_number([s, e, n, d])\n  w_more = Smm.to_number([m, o, r, e])\n  w_money = Smm.to_number([m, o, n, e, y])\n\n  if s &gt; 0 &amp;&amp; m &gt; 0 &amp;&amp; (w_send + w_more == w_money) do\n    IO.inspect([w_send, w_more, w_money])\n  end\nend\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 2809, "user_id": 857893, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e6fd86546de70ba1498df22c03e53bd?s=128&d=identicon&r=PG", "display_name": "kevlar1818", "link": "https://stackoverflow.com/users/857893/kevlar1818"}, "edited": false, "score": 0, "creation_date": 1438959142, "post_id": 31828336, "comment_id": 51678884, "body": "Thanks to you both! Both answers are very helpful and equally useful in their own ways. I find it difficult to choose a &quot;correct&quot; answer."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 3, "last_activity_date": 1438766407, "creation_date": 1438766407, "answer_id": 31828336, "question_id": 31823272, "link": "https://stackoverflow.com/questions/31823272/seeking-idiomatic-elegant-solution-to-sendmore-money-in-elixir/31828336#31828336", "title": "Seeking idiomatic, elegant solution to &quot;send+more=money&quot; in Elixir", "body": "<p>This syntactic distraction is eliminated in Haskell by two things: operator associativity and a nice language rule for lambdas.</p>\n\n<p>Having <a href=\"http://elixir-lang.org/getting-started/basic-operators.html#operator-table\" rel=\"nofollow\">associativity rules</a> eliminates unnecessary parenthesis in syntax. For example, in Elixir addition associates to the left, so when you write <code>a + 2 + x</code> it's interpreted as <code>(a + 2) + x</code>. The associativity rule let you get rid of parenthesis. If instead you meant <code>a + (2 + x)</code> you would have to write that explicitly.</p>\n\n<p>You can get the operator associativity to help out in Elixir, and some people already have. The <a href=\"https://github.com/rob-brown/MonadEx\" rel=\"nofollow\">MonadEx</a> library defines a bind operator <code>~&gt;&gt;</code> that would let you write the guts of the program approximately as</p>\n\n<pre><code>    Smm.remove(digits, [0])\n    ~&gt;&gt; fn s -&gt; Smm.remove(digits, [s])\n    ~&gt;&gt; fn e -&gt; Smm.remove(digits, [s,e])\n    ~&gt;&gt; fn n -&gt; Smm.remove(digits, [s,e,n])\n    ~&gt;&gt; fn d -&gt; return(Smm.to_number([s,e,n,d]))\n    ~&gt;&gt; fn w_send -&gt; Smm.remove(digits, [0,s,e,n,d])\n    ~&gt;&gt; fn m -&gt; Smm.remove(digits, [s,e,n,d,m])\n    ~&gt;&gt; fn o -&gt; Smm.remove(digits, [s,e,n,d,m,o])\n    ~&gt;&gt; fn r -&gt; return(Smm.to_number([m,o,r,e]))\n    ~&gt;&gt; fn w_more -&gt; Smm.remove(digits, [s,e,n,d,m,o,r])\n    ~&gt;&gt; fn y -&gt; return(Smm.to_number([m,o,n,e,y]))\n    ~&gt;&gt; fn w_money -&gt; Smm.guard(w_send + w_more == w_money)\n    ~&gt;&gt; fn -&gt; return([w_send, w_more, w_money])\n    end end end end end end end end end end end end\n</code></pre>\n\n<p>Operator associativity doesn't get rid of the lambda expressions all ending in the same place. The later expressions need to be inside the earlier lambdas so they can see the variables introduced earlier. Haskell gets rid of this distraction by a simple syntax rule <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html\" rel=\"nofollow\">\"lambda abstractions ... extend as far to the right as possible\"</a>. Because lambdas extend all the way to the right, Haskell code written in the same style doesn't have a whole bunch of end parenthesis.</p>\n\n<pre><code>solutions = remove [0] digits &gt;&gt;= \\s -&gt;\n            remove [s] digits &gt;&gt;= \\e -&gt;\n            remove [s,e] digits &gt;&gt;= \\n -&gt;\n            remove [s,e,n] digits &gt;&gt;= \\d -&gt;\n            let send = to_number [s,e,n,d]\n            in remove [0,s,e,n,d] digits &gt;&gt;= \\m -&gt;\n            remove [s,e,n,d,m] digits &gt;&gt;= \\o -&gt;\n            remove [s,e,n,d,m,o] digits &gt;&gt;= \\r -&gt;\n            let more = to_number [m,o,r,e]\n            in remove [s,e,n,d,m,o,r] digits &gt;&gt;= \\y -&gt;\n            let money = to_number [m,o,n,e,y] in\n            guard (send + more == money) &gt;&gt;= \\_ -&gt;\n            return (send, more, money)\n</code></pre>\n\n<p>I can't imagine a corresponding trick for Elixir. Every <code>fn</code> has to <code>end</code> at the end, so there will be as many <code>end</code>s as there were binds. I guess you'll just need to keep flipping tables <code>(\u256f\u00b0\u25a1\u00b0\uff09\u256f\ufe35 \u253b\u2501\u253b</code>.</p>\n"}], "owner": {"reputation": 2809, "user_id": 857893, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e6fd86546de70ba1498df22c03e53bd?s=128&d=identicon&r=PG", "display_name": "kevlar1818", "link": "https://stackoverflow.com/users/857893/kevlar1818"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1438781628, "creation_date": 1438747629, "last_edit_date": 1438781628, "question_id": 31823272, "link": "https://stackoverflow.com/questions/31823272/seeking-idiomatic-elegant-solution-to-sendmore-money-in-elixir", "title": "Seeking idiomatic, elegant solution to &quot;send+more=money&quot; in Elixir", "body": "<p>I came across <a href=\"http://blog.plover.com/prog/monad-search-2.html\" rel=\"nofollow\">Mark Dominus' blog post</a> that describes solving the <a href=\"http://ohiorc.org/for/math/stella/problems/problem.aspx?id=113\" rel=\"nofollow\">\"SEND+MORE=MONEY\" puzzle</a> using functional programming techniques (Monads, specifically) in Python.</p>\n\n<p>The puzzle summarized here in case of dead links:</p>\n\n<pre><code>    S E N D   | Find each character's *unique* numerical value, such that\n+   M O R E   | the addition on the left is valid. There are no leading zeros.\n-----------\n= M O N E Y\n</code></pre>\n\n<p>I've been looking for a chance to learn some pure functional programming, specifically with Elixir, and this seemed like a very fitting project.</p>\n\n<p>I can implement a cosmetically similar version of Mark Dominus' Python code in Elixir:</p>\n\n<pre><code>defmodule Smm do\n  def make_set(ls), do: Enum.into(ls, HashSet.new)\n\n  def to_number([]), do: :error\n  def to_number(ls), do: Enum.join(ls) |&gt; Integer.parse |&gt; elem(0)\n\n  def remove(hs, ls), do: Set.difference(hs, Enum.into(ls, HashSet.new))\n\n  def let(x, func), do: func.(x)\n\n  def guard(predicate, func) when predicate, do: func.()\n  def guard(predicate, func), do: []\nend\n\ndigits = Smm.make_set(0..9)\n\nEnum.map( Smm.remove(digits, [0]), fn s -&gt;\nEnum.map( Smm.remove(digits, [s]), fn e -&gt;\nEnum.map( Smm.remove(digits, [s,e]), fn n -&gt;\nEnum.map( Smm.remove(digits, [s,e,n]), fn d -&gt;\nSmm.let(Smm.to_number([s,e,n,d]), fn w_send -&gt;\nEnum.map( Smm.remove(digits, [0,s,e,n,d]), fn m -&gt;\nEnum.map( Smm.remove(digits, [s,e,n,d,m]), fn o -&gt;\nEnum.map( Smm.remove(digits, [s,e,n,d,m,o]), fn r -&gt;\nSmm.let(Smm.to_number([m,o,r,e]), fn w_more -&gt;\nEnum.map( Smm.remove(digits, [s,e,n,d,m,o,r]), fn y -&gt;\nSmm.let(Smm.to_number([m,o,n,e,y]), fn w_money -&gt;\nSmm.guard(w_send + w_more == w_money, fn -&gt;\n[w_send, w_more, w_money] |&gt; Enum.map( &amp;(IO.puts(&amp;1)) )\nend)end)end)end)end)end)end)end)end)end)end)end)        # (\u256f\u00b0\u25a1\u00b0\uff09\u256f\ufe35 \u253b\u2501\u253b\n</code></pre>\n\n<p>But something tells me there's got to be a way around the insanely nested anonymous functions and the subsequent table-flipping; this is why pure functional languages exist, right?</p>\n\n<p>Looking at Mark Dominus' <a href=\"http://blog.plover.com/prog/haskell/monad-search.html\" rel=\"nofollow\">previous blog post in which he solves the puzzle with Haskell</a>, I see he's using a sugary version of Haskell's \"bind\" operator <code>&gt;&gt;=</code> to eliminate the table-flipping urges... But I haven't <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow\">learned me a Haskell</a>, so I don't have a strong grasp on the code presented in this blog post.</p>\n\n<p>I'm fairly certain what I'm missing in my Elixir implementation is using the pipe operator, <code>|&gt;</code>, which was actually a big draw to the language for me (being very comfortable with Unix pipes, myself). I've tried working in pipes combined with many flavors of <code>Enum.{map,reduce}</code>, but I always end up back at square one.</p>\n\n<p>Can anyone offer any advice? Ideally, I'm looking for a more idiomatic functional programming solution to this puzzle in Elixir. </p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 21, "last_activity_date": 1438739282, "creation_date": 1438739282, "answer_id": 31822132, "question_id": 31821952, "link": "https://stackoverflow.com/questions/31821952/flags-in-cabal-files/31822132#31822132", "title": "Flags in cabal files", "body": "<p>Pass the flags to <code>cabal configure</code>, e.g.:</p>\n\n<pre><code>cabal configure -f debug\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "is_accepted": false, "score": 5, "last_activity_date": 1520424281, "creation_date": 1520424281, "answer_id": 49151513, "question_id": 31821952, "link": "https://stackoverflow.com/questions/31821952/flags-in-cabal-files/49151513#49151513", "title": "Flags in cabal files", "body": "<p>With <code>cabal-2.1.0</code> you can do it like this:</p>\n\n<pre><code>cabal new-build -f debug \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9504, "user_id": 470844, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8354544a22bb5a0ac8005ca008f94ad1?s=128&d=identicon&r=PG", "display_name": "ntc2", "link": "https://stackoverflow.com/users/470844/ntc2"}, "is_accepted": false, "score": 2, "last_activity_date": 1546988678, "creation_date": 1546988678, "answer_id": 54101009, "question_id": 31821952, "link": "https://stackoverflow.com/questions/31821952/flags-in-cabal-files/54101009#54101009", "title": "Flags in cabal files", "body": "<p>With Stack, use</p>\n\n<pre><code>stack build --flag &lt;pkg&gt;:debug\n</code></pre>\n\n<p>to set <code>debug</code> flag to <code>True</code> for <code>&lt;pkg&gt;</code>, or use <code>--flag '*:debug'</code> to set <code>debug</code> flag to <code>True</code> for all packages. Replace <code>debug</code> with <code>-debug</code> to set <code>debug</code> flag to <code>False</code>.</p>\n\n<p>You can also specify flag settings in a <code>stack.yaml</code> file. For example, to set <code>debug</code> flag to <code>False</code> for <code>&lt;pkg&gt;</code>, add this to your <code>stack.yaml</code>:</p>\n\n<pre><code>flags:\n  &lt;pkg&gt;:\n    debug: false\n</code></pre>\n"}], "owner": {"reputation": 2017, "user_id": 4106994, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6Y8lC.jpg?s=128&g=1", "display_name": "Afonso Matos", "link": "https://stackoverflow.com/users/4106994/afonso-matos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3987, "favorite_count": 2, "accepted_answer_id": 31822132, "answer_count": 3, "score": 13, "last_activity_date": 1546988678, "creation_date": 1438737900, "last_edit_date": 1438738218, "question_id": 31821952, "link": "https://stackoverflow.com/questions/31821952/flags-in-cabal-files", "title": "Flags in cabal files", "body": "<p>I am following the user-guide for package developing: <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#quickstart\" rel=\"noreferrer\">https://www.haskell.org/cabal/users-guide/developing-packages.html#quickstart</a> </p>\n\n<p>I got stuck in the <code>Flags</code> section. How do I pass flags to my files? Is it just at <code>build</code> time? I have tried to search for it, but found no useful information - just the command option <code>--flags</code>.</p>\n\n<p><code>cabal build -f debug</code> doesn't work</p>\n\n<pre><code>Flag Debug\n    Description: Enable debug support\n    Manual: True\n    Default: False\n\nBenchMark bench-foo\n    ghc-options:        -Wall\n    type:               exitcode-stdio-1.0\n    default-language:   Haskell2010\n    build-depends:      base, time\n    main-is:            bench-foo.hs\n    if flag(debug) &amp;&amp; os(windows)\n        main-is:        bench-bar.hs\n</code></pre>\n"}, {"tags": ["unit-testing", "haskell", "monads", "lexer"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user932887"}, "edited": false, "score": 3, "creation_date": 1438729062, "post_id": 31820534, "comment_id": 51566367, "body": "Please do not unit test me, it makes me feel uncomfortable."}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 1, "creation_date": 1438729094, "post_id": 31820534, "comment_id": 51566380, "body": "@AlexM. Why? Have you got something to hide?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user932887"}, "reply_to_user": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "edited": false, "score": 0, "creation_date": 1438729180, "post_id": 31820534, "comment_id": 51566407, "body": "@\u028e\u01dd\u0279\u025f\u025f\u025f\u01dd\u017f I-it&#39;s not like that."}], "answers": [{"comments": [{"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 0, "creation_date": 1438728820, "post_id": 31820702, "comment_id": 51566310, "body": "Does that work with the monad wrapper? I was under the impression it only worked with the basic wrapper. I&#39;m getting <code>Not in scope: alexScanTokens</code> when I try to use it."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 1, "creation_date": 1438729064, "post_id": 31820702, "comment_id": 51566368, "body": "Answer updated. To get <code>alexScanTokens</code> in scope you need to define one of <code>ALEX_BASIC</code>, <code>ALEX_BASIC_BYTESTRING</code>, or another <code>ALEX_...</code> symbol. See <a href=\"https://github.com/simonmar/alex/blob/master/templates/wrappers.hs#L376\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1438729027, "last_edit_date": 1438729027, "creation_date": 1438728724, "answer_id": 31820702, "question_id": 31820534, "link": "https://stackoverflow.com/questions/31820534/how-can-i-unit-test-alex-code/31820702#31820702", "title": "How can I unit test Alex code?", "body": "<p>There is a function <code>alexScanTokens :: String -&gt; [token]</code> which you can use.</p>\n\n<p>It's defined in the file <code>templates/wrappers.hs</code></p>\n\n<p>Here's a monadic version I found <a href=\"http://hackage.haskell.org/package/tamarin-prover-0.4.0.0/src/interactive-only-src/Lexer.x\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>alexScanTokens :: String -&gt; Either String [Keyword]\nalexScanTokens inp = runAlex inp gather\n  where\n  gather = do\n    t &lt;- alexMonadScan\n    case trace (show t) t of\n      EOF -&gt; return [EOF]\n      _   -&gt; (t:) `liftM` gather\n</code></pre>\n"}], "owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 31820702, "answer_count": 1, "score": 3, "last_activity_date": 1438729027, "creation_date": 1438727723, "question_id": 31820534, "link": "https://stackoverflow.com/questions/31820534/how-can-i-unit-test-alex-code", "title": "How can I unit test Alex code?", "body": "<p>I'm writing a lexer in Alex with the monad wrapper. It's not behaving as I expect, and I would like to write some unit tests for it. I can write unit tests for lexing a single token by doing:</p>\n\n<pre><code>runAlex \"foo\" alexMonadScan `shouldBe` Right TokenFoo\n</code></pre>\n\n<p>but I don't know how to test that the string \"foo bar\" gets lexed to <code>[TokenFoo, TokenBar]</code>. </p>\n\n<p>Given that <code>Token</code> is my token type, I'd need a function like <code>runAlex</code> that has the type <code>String -&gt; Alex [Token] -&gt; Either String [Token]</code>, but I don't know how to transform <code>alexMonadScan</code> so that it has the type <code>Alex [Token]</code> rather than <code>Alex Token</code>. </p>\n\n<p>I tried</p>\n\n<pre><code>runAlex \"foo bar\" (liftM (:[]) alexMonadScan) `shouldBe` [TokenFoo, TokenBar]\n</code></pre>\n\n<p>which seems to have the right type, but it returns <code>Right [TokenEOF]</code>, apparently dropping the tokens it saw along the way.</p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "edited": false, "score": 0, "creation_date": 1438724194, "post_id": 31819689, "comment_id": 51564533, "body": "That&#39;s it! Thank you. I&#39;m going to accept the answer in ~7 minutes."}], "tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 7, "last_activity_date": 1438723812, "creation_date": 1438723812, "answer_id": 31819689, "question_id": 31819676, "link": "https://stackoverflow.com/questions/31819676/whats-the-right-way-to-use-type-aliases-in-haskell/31819689#31819689", "title": "What&#39;s the right way to use type aliases in Haskell", "body": "<p>Use <code>type</code> not <code>newtype</code>. The former creates a type alias, the latter is a new type declaration. Specifically <code>newtype</code> is kind of special case for <code>data</code>, where the new type represents a \"wrapper\" over an existing type (which is a case that can be optimized by the compiler).</p>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 3, "last_activity_date": 1438773060, "last_edit_date": 1495542119, "creation_date": 1438761560, "answer_id": 31826647, "question_id": 31819676, "link": "https://stackoverflow.com/questions/31819676/whats-the-right-way-to-use-type-aliases-in-haskell/31826647#31826647", "title": "What&#39;s the right way to use type aliases in Haskell", "body": "<p>I think a better solution than the one offered by Jeffrey's answer, at least in the case of more substantial code bases than a toy game, is to keep using <code>newtype</code> but to change the code to this:</p>\n\n<pre><code>import Data.Matrix\n\nnewtype Puzzle = Puzzle (Matrix Char)\n\ncomplete :: Puzzle -&gt; Bool\ncomplete (Puzzle matrix) = '-' `elem` toList matrix\n</code></pre>\n\n<p>This will allow you to keep using a truly distinct data type as opposed to resorting to a type alias, which doesn't introduce any new types and will allow completely interchangeable use of <code>Puzzle</code> and <code>Matrix Char</code> with no added type safety (nor expressiveness). </p>\n\n<p>Also, Jeffrey is right in that <code>newtype</code> is more similar to <code>data</code> than <code>type</code> \u2014 <code>newtype</code> offers some performance optimisations over <code>data</code> but is more restricted and slightly affects the program evaluation semantics. You're better off reading up on all the various ways of defining types and type aliases in Haskell. </p>\n\n<p>In your case, you might as well substitute <code>data</code> for <code>newtype</code> without changing the behavior of your program; the rest of the program should continue to work identically. </p>\n\n<p>See also: <a href=\"https://stackoverflow.com/questions/991467/haskell-type-vs-newtype-with-respect-to-type-safety\">Haskell type vs. newtype with respect to type safety</a></p>\n"}], "owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 31819689, "answer_count": 2, "score": 3, "last_activity_date": 1438773060, "creation_date": 1438723732, "question_id": 31819676, "link": "https://stackoverflow.com/questions/31819676/whats-the-right-way-to-use-type-aliases-in-haskell", "title": "What&#39;s the right way to use type aliases in Haskell", "body": "<p>I'm a total beginner with Haskell. While trying to solve some practise exercises on hackerrank I stumbled over an error which makes me wonder to do it \"the right way\"(tm).</p>\n\n<p>What I was trying to do was this:</p>\n\n<pre><code>import Data.Matrix\n\nnewtype Puzzle = Matrix Char\n\ncomplete :: Puzzle -&gt; Bool\ncomplete p = '-' `elem` (toList p)\n\n[... more functions using 'Matrix Char']\n</code></pre>\n\n<p>what gave me</p>\n\n<pre><code>Couldn't match expected type \u2018Matrix Char\u2019\n                with actual type \u2018Puzzle\u2019\n    In the first argument of \u2018toList\u2019, namely \u2018p\u2019\n    In the second argument of \u2018elem\u2019, namely \u2018(toList p)\u2019\n</code></pre>\n\n<p>The obvious solution is of course just using <code>Matrix Char</code> instead of <code>Puzzle</code>. But I don't feel that this is an elegant solution. An abstraction into a more specific type feels the right way to go...</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 6, "creation_date": 1438723233, "post_id": 31819227, "comment_id": 51564080, "body": "<code>genericLength</code> is also an option, but less frequently used probably because it requires another import line."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1438732843, "post_id": 31819227, "comment_id": 51567375, "body": "@ThomasM.DuBuisson <code>genericLength</code> is also known to have much poorer performance in general (although rewriting rules at least for <code>Int</code> and <code>Integer</code> exist.)"}, {"owner": {"reputation": 1476, "user_id": 700597, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/rWtor.jpg?s=128&g=1", "display_name": "runeks", "link": "https://stackoverflow.com/users/700597/runeks"}, "edited": false, "score": 0, "creation_date": 1438837644, "post_id": 31819227, "comment_id": 51615360, "body": "@sepp2k thanks. I guess I had a hard time understanding that fromIntegral converts from both Integer to Int and the other way around too. Plus the GHC error message makes it seem like the last argument is the problem, rather than, perhaps, the first (ie. error is &quot;num not of right type&quot; rather than &quot;type mismatch between first and second argument to digits&quot;)."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 12, "last_activity_date": 1438721984, "creation_date": 1438721984, "answer_id": 31819227, "question_id": 31819041, "link": "https://stackoverflow.com/questions/31819041/ghc-says-digits-needs-an-int-when-it-needs-an-integral/31819227#31819227", "title": "GHC says &quot;digits&quot; needs an Int, when it needs an Integral", "body": "<p>Both arguments to <code>digits</code> need to have the same type and <code>length charlst</code> has the type <code>Int</code>, so <code>num</code> must also have type <code>Int</code>.</p>\n\n<blockquote>\n  <p>It compiles if I replace num with (fromIntegral num), but then I lose the ability to convert an Integer</p>\n</blockquote>\n\n<p>If you apply <code>fromIntegral</code> to <code>length charlst</code> instead, it will convert it to whichever type <code>num</code> is, so it'll work the way you want.</p>\n"}], "owner": {"reputation": 1476, "user_id": 700597, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/rWtor.jpg?s=128&g=1", "display_name": "runeks", "link": "https://stackoverflow.com/users/700597/runeks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 31819227, "answer_count": 1, "score": 5, "last_activity_date": 1438721984, "creation_date": 1438721300, "question_id": 31819041, "link": "https://stackoverflow.com/questions/31819041/ghc-says-digits-needs-an-int-when-it-needs-an-integral", "title": "GHC says &quot;digits&quot; needs an Int, when it needs an Integral", "body": "<p>As far as I can see, this code snippet should compile without a problem:</p>\n\n<pre><code>import Data.Digits (digits)\n-- |convert integer to arbitrary base with specified charset\n-- base/radix is charset string length.\n-- eg. convert the integer 255 to hex:\n--      intToBaseN 255 \"0123456789abcdef\" = \"ff\"\nnumToBaseN :: Integral n =&gt; n -&gt; [Char] -&gt; String\nnumToBaseN num charlst = map (\\i -&gt; charlst !! (fromIntegral i)) lst where\n    lst = digits (length charlst) num\n</code></pre>\n\n<p>But GHC complains that the <code>num</code> in the <code>lst</code> expression isn't an <code>Int</code>. But the type of <code>digits</code> is</p>\n\n<pre><code>digits :: Integral n =&gt; n -&gt; n -&gt; [n]\n</code></pre>\n\n<p>it doesn't require an <code>Int</code> as an argument, only something that is an Integral, which the type signature of <code>numToBaseN</code> does as well.</p>\n\n<p><code>!!</code> requires an Int, which is why it is converted using <code>fromIntegral</code>.</p>\n\n<p>What's going on here?</p>\n\n<p>It compiles if I replace <code>num</code> with <code>(fromIntegral num)</code>, but then I lose the ability to convert an Integer (ie. arbitrarily large integers).</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 10, "last_activity_date": 1438714544, "creation_date": 1438714544, "answer_id": 31817079, "question_id": 31816937, "link": "https://stackoverflow.com/questions/31816937/is-there-any-syntax-for-non-recursive-binding-in-haskell-just-like-the-differen/31817079#31817079", "title": "is there any syntax for non-recursive binding in Haskell, just like the difference between `let` and `let rec` in similar languages?", "body": "<p>Are record wildcards actually that useful here? The usual old way of doing things looks quite concise to me:</p>\n\n<pre><code>foo r = r { field1 = field1 r + 1, field2 = modify (field2 r) }\n</code></pre>\n\n<p>The direct answer to your question is that there is no non-recursive analog of <code>let</code> in Haskell; though you can use the <code>Identity</code> monad to sort of hack something into place:</p>\n\n<pre><code>foo MyRecord{..} = runIdentity $ do\n    field1 &lt;- return (field1 + 1)\n    field2 &lt;- return (modify field2)\n    return MyRecord{..}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1438715842, "creation_date": 1438715842, "answer_id": 31817492, "question_id": 31816937, "link": "https://stackoverflow.com/questions/31816937/is-there-any-syntax-for-non-recursive-binding-in-haskell-just-like-the-differen/31817492#31817492", "title": "is there any syntax for non-recursive binding in Haskell, just like the difference between `let` and `let rec` in similar languages?", "body": "<p>Not an answer to your question, but I'd like to point to the <a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow\">lens</a> alternative. Lenses are really quite a good solution to the problems of Haskell's records, which become quite a pain with larger data definitions and which <code>RecordWildcards</code> does, alas, not really fix as nicely as we'd like.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Control.Lens\nimport Control.Lens.TH (makeLenses)\n\ndata MyRecord = MyRecord{ _field1 :: ...\n                        , _field2 :: ...\n                        {- note the underscores -} }\nmakeLenses ''MyRecord\n\nfoo = (field1 %~ (+1))\n    . (field2 %~ modify)\n    . ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 4, "last_activity_date": 1438715945, "creation_date": 1438715945, "answer_id": 31817514, "question_id": 31816937, "link": "https://stackoverflow.com/questions/31816937/is-there-any-syntax-for-non-recursive-binding-in-haskell-just-like-the-differen/31817514#31817514", "title": "is there any syntax for non-recursive binding in Haskell, just like the difference between `let` and `let rec` in similar languages?", "body": "<blockquote>\n  <p>is there any syntax for non-recursive binding in Haskell</p>\n</blockquote>\n\n<p>No, there is no way to refer to a previously defined variable of a given name while defining a new variable with the same name.</p>\n\n<blockquote>\n<pre><code>foo MyRecord{..} = let norec field1 = field1 + 1\n                             field2 = modify field2\n                             {- some other modifications to the fields -}\n                    in MyRecord{..}\n</code></pre>\n</blockquote>\n\n<p>This can be achieved by spelling the modified fields out explicitly (while still covering the unchanged ones with the wildcard). Since you don't need local variables that way, it isn't even more code:</p>\n\n<pre><code>foo MyRecord{..} =\n  MyRecord {\n    field1 = field1 + 1,\n    field2 = modify field2,\n    ..\n  }\n</code></pre>\n\n<p>Note that here the identifier left of the equals sign is a record label, not a variable, while the on the right side is a variable, so even though this looks recursive, it is not.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1438716534, "creation_date": 1438716534, "answer_id": 31817659, "question_id": 31816937, "link": "https://stackoverflow.com/questions/31816937/is-there-any-syntax-for-non-recursive-binding-in-haskell-just-like-the-differen/31817659#31817659", "title": "is there any syntax for non-recursive binding in Haskell, just like the difference between `let` and `let rec` in similar languages?", "body": "<p>One option is:</p>\n\n<pre><code>-- also available from the lens package\n(&amp;) :: a -&gt; (a-&gt;b) -&gt; b\n(&amp;) = flip ($)\n\nf a = -- let norec a = a + 1 in a+a\n      (a+1) &amp; \\a -&gt; a + a\n\ng x = -- let norec x = x+1 in\n      (x+1) &amp; \\x -&gt;\n      -- let norec x = x+x in\n      (x+x) &amp; \\x -&gt; \n      -- 1000+x\n      1000+x\n</code></pre>\n\n<p>Not terribly elegant, but at least it's concise. It will also generate a few \"shadowing\" warnings.</p>\n"}], "owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 31817079, "answer_count": 4, "score": 4, "last_activity_date": 1438716534, "creation_date": 1438713993, "last_edit_date": 1438714453, "question_id": 31816937, "link": "https://stackoverflow.com/questions/31816937/is-there-any-syntax-for-non-recursive-binding-in-haskell-just-like-the-differen", "title": "is there any syntax for non-recursive binding in Haskell, just like the difference between `let` and `let rec` in similar languages?", "body": "<p>Non-recursive binding allows me to shadow bound value, for instance:</p>\n\n<pre><code>b a = let norec a = a + 10 in a\n</code></pre>\n\n<p>here <code>let norec</code> created by myself means a <code>let</code> binding but not recursive.</p>\n\n<p>This is extremely helpful when using record wildcards:</p>\n\n<pre><code>data MyRecord = MyRecord{ {- vary huuuuuge set of definitions -} }\n\nfoo MyRecord{..} = let norec field1 = field1 + 1\n                             field2 = modify field2\n                             {- some other modifications to the fields -}\n                    in MyRecord{..}\n</code></pre>\n\n<p>Is that achievable? Or how do you deal with it in your cases?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1438708516, "post_id": 31815310, "comment_id": 51556315, "body": "<code>P</code> <i>is</i> the new constructor."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1438733790, "post_id": 31815448, "comment_id": 51567601, "body": "Because it must be fully applied, it is also simply not possible to give the <code>type</code> version instances of higher-kinded classes such as <code>Monad</code>."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 7, "last_activity_date": 1438708683, "creation_date": 1438708683, "answer_id": 31815448, "question_id": 31815310, "link": "https://stackoverflow.com/questions/31815310/the-difference-between-type-and-newtype-in-haskell/31815448#31815448", "title": "The difference between type and newtype in Haskell", "body": "<blockquote>\n  <p>For new type why <code>P(...)</code> is used to enclose the content?</p>\n</blockquote>\n\n<p>Any <code>newtype</code> declared type must have a single constructor.  In this case that constructor is named <code>P</code> and its type is</p>\n\n<pre><code>P :: (String -&gt; [(a, String)]) -&gt; Parser a\n</code></pre>\n\n<p>You can also use record syntax, so it would be equivalent to</p>\n\n<pre><code>newtype Parser a = P { runParser :: String -&gt; [(a, String)] }\n</code></pre>\n\n<p>Or if you were to use a <code>data</code> type (in which case the wrapper does not get optimized away at runtime as easily), it would be very similar:</p>\n\n<pre><code>data Parser a = P { runParser :: String -&gt; [(a, String)] }\n</code></pre>\n\n<blockquote>\n  <p>It requires to provide new constructor with newtype, but I don't seem to find one from the example code. How to define constructor for newtype? Is it OK not to provide one?</p>\n</blockquote>\n\n<p>As mentioned above, the constructor to the <code>newtype Parser</code> is named <code>P</code>, and there must be exactly one constructor for a <code>newtype</code>.</p>\n\n<p>Some more clarification, the <code>type</code> keyword constructs a simple alias.  For example, <code>String</code> is defined as</p>\n\n<pre><code>type String = [Char]\n</code></pre>\n\n<p>You can use <code>String</code> in any function that takes <code>[Char]</code>, and you can use <code>[Char]</code> in any function that takes <code>String</code>.  Since <code>FilePath</code> is defined as</p>\n\n<pre><code>type FilePath = String\n</code></pre>\n\n<p>Then you can use <code>FilePath</code> where ever you would use a <code>String</code> and thus anywhere you would use <code>[Char]</code>, and vice versa.  These are simply names for reducing more complicated types.  I would say that in practice it's more common to use <code>newtype</code> rather than <code>type</code> except in very simple cases, simply because it allows the type system to enforce things more in your software.  There are also disadvantages to <code>type</code>s, since you need language extensions to use them in <code>instance</code> declarations, and they must always be fully applied in other expressions.  The disadvantages of <code>newtype</code> is that you have to wrap/unwrap them a lot, but this can be more of a boon when working with truly complex programs.</p>\n"}], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1465, "favorite_count": 0, "accepted_answer_id": 31815448, "answer_count": 1, "score": 3, "last_activity_date": 1438708683, "creation_date": 1438708121, "question_id": 31815310, "link": "https://stackoverflow.com/questions/31815310/the-difference-between-type-and-newtype-in-haskell", "title": "The difference between type and newtype in Haskell", "body": "<p>From the book Programming in Haskell (<a href=\"http://www.cs.nott.ac.uk/~gmh/book.html\" rel=\"nofollow\">http://www.cs.nott.ac.uk/~gmh/book.html</a>), a parser is defined as follows:</p>\n\n<pre><code>&gt; type Parser a = String -&gt; [(a,String)]\n</code></pre>\n\n<p>However, from the sample code (<a href=\"http://www.cs.nott.ac.uk/~gmh/Parsing.lhs\" rel=\"nofollow\">http://www.cs.nott.ac.uk/~gmh/Parsing.lhs</a>), the definition is a little bit different.</p>\n\n<pre><code>&gt; newtype Parser a              =  P (String -&gt; [(a,String)])\n</code></pre>\n\n<p>I found the difference from this page:<a href=\"https://wiki.haskell.org/Type#Type_and_newtype\" rel=\"nofollow\">https://wiki.haskell.org/Type#Type_and_newtype</a> as follows:</p>\n\n<blockquote>\n  <p>type introduces a synonym for a type and uses the same data constructors. newtype introduces a renaming of a type and requires you to provide new constructors. </p>\n</blockquote>\n\n<p>Here are my questions:</p>\n\n<ol>\n<li>For new type why <code>P(...)</code> is used to enclose the content?</li>\n<li>It requires to provide new constructor with newtype, but I don't seem to find one from the example code. How to define constructor for newtype? Is it OK not to provide one?  </li>\n</ol>\n"}, {"tags": ["haskell", "primes", "lazy-evaluation", "fold", "primality-test"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1438729201, "post_id": 31814172, "comment_id": 51566414, "body": "<code>(n `rem` x) &#47;= 0 &amp;&amp; acc</code> is equivalent to <code>if (n `rem` x) &#47;= 0 then acc else False</code> or <code>if (n `rem` x) == 0 then False else acc</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1438706772, "post_id": 31814324, "comment_id": 51555261, "body": "Where is the result produced? Even if the lambda evaluates to false doesnt the fold continue?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 2, "creation_date": 1438708107, "post_id": 31814324, "comment_id": 51556093, "body": "@dopatraman The definition of <code>&amp;&amp;</code> is <code>True &amp;&amp; x = x; False &amp;&amp; _ = False</code>. So <code>False &amp;&amp; acc</code> is <code>False</code> regardless of <code>acc</code>&#39;s value and <code>acc</code> is not evaluated in that case (and if <code>acc</code> is not evaluated, the <code>fold</code> does not continue as the recursive call to <code>foldr</code> is the value of <code>acc</code> and thus it is only evaluated when <code>acc</code> is)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1438783550, "post_id": 31814324, "comment_id": 51591532, "body": "<code>take 2 primes</code> loops, yes?"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 0, "last_activity_date": 1438704965, "creation_date": 1438704965, "answer_id": 31814324, "question_id": 31814172, "link": "https://stackoverflow.com/questions/31814172/determine-a-prime-number-with-right-fold/31814324#31814324", "title": "Determine a prime number with right fold", "body": "<p>The expression</p>\n\n<pre><code>(n `rem` x) /= 0\n</code></pre>\n\n<p>clearly produces a Bool result. The parameter <code>acc</code> is already a Bool value. So</p>\n\n<pre><code>(n `rem` x) /= 0 &amp;&amp; acc\n</code></pre>\n\n<p>is a logical-AND of two Bool values, which clearly produces a Bool result. Where is the confusion?</p>\n\n<p>The input list is infinite, consisting only of odd numbers. So long as you can produce a result after examining only a finite number of values, laziness makes everything fine.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1438728823, "post_id": 31815172, "comment_id": 51566312, "body": "for you and everybody else, calling <code>take 100 primes</code> prints &quot;[2&quot; and loops."}], "tags": [], "owner": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1438707658, "creation_date": 1438707658, "answer_id": 31815172, "question_id": 31814172, "link": "https://stackoverflow.com/questions/31814172/determine-a-prime-number-with-right-fold/31815172#31815172", "title": "Determine a prime number with right fold", "body": "<p>At least for me, your code doesn't finish. It is missing the stop condition, which can be seen in a similar solution from the <a href=\"https://wiki.haskell.org/Testing_primality#Primality_Test_and_Integer_Factorization\" rel=\"nofollow\">wiki</a>:</p>\n\n<pre><code>isPrime n = n &gt; 1 &amp;&amp;\n              foldr (\\p r -&gt; p*p &gt; n || ((n `rem` p) /= 0 &amp;&amp; r)) True primes\n\nprimes = 2 : filter isPrime [3,5..]\n</code></pre>\n\n<p>Here you can see, that the condition <code>p*p &gt; n</code> produces <code>True</code>, when there is no possible prime factor left. Because of lazy execution the right part of <code>||</code> is not evaluated and the <code>foldr</code> stops.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1440182360, "last_edit_date": 1440182360, "creation_date": 1438729835, "answer_id": 31820869, "question_id": 31814172, "link": "https://stackoverflow.com/questions/31814172/determine-a-prime-number-with-right-fold/31820869#31820869", "title": "Determine a prime number with right fold", "body": "<p>having</p>\n\n<pre><code>primes = [p1, p2, p3, ..., pn, ...]\n</code></pre>\n\n<p>calculating</p>\n\n<pre><code>isPrime' n = foldr (\\x acc -&gt; (n `rem` x) /= 0 &amp;&amp; acc) True primes\n</code></pre>\n\n<p>is as if calculating</p>\n\n<pre><code>isPrime' n = rem n p1 /= 0 &amp;&amp; (\n             rem n p2 /= 0 &amp;&amp; (\n             rem n p3 /= 0 &amp;&amp; (\n             ..........\n             rem n pk /= 0 &amp;&amp; (\n             ..........          ..... ))))\n</code></pre>\n\n<p>For composite <code>n</code>s this works &ndash; one of the <code>rem</code> expressions will be 0, the inequality is false, and the whole expression is false too, because <code>&amp;&amp;</code> is short-circuiting, lazy in its 2nd argument. </p>\n\n<p>For prime <code>n</code>s this will cause a problem: none of the <code>rem</code> expressions will be 0, by definition of a prime, until we reach a prime <code>p_i == n</code> itself among the primes. But it's not there yet, as we haven't detected it as being prime yet - we're just doing it right now. <em>To test whether it is prime, we must know that it is prime</em> - clearly a bad situation. </p>\n\n<p>A value will be demanded from <code>primes</code> which is not there yet. This is known as \"black hole\". It causes an error, and calculation aborts (or becomes stuck). </p>\n\n<p>To put it differently, it is as if the definition</p>\n\n<pre><code>primes = 2 : filter isPrime' [3,5..]\n</code></pre>\n\n<p>were defined as</p>\n\n<pre><code>primes = 2 : [ n | n &lt;- [3,5..]\n                 , and [rem n p /= 0 | p &lt;- takeWhile (&lt; n) primes]]\n</code></pre>\n\n<p>The problem is that to stop when <code>n</code> is prime, <code>takeWhile (&lt; n)</code> must reach a prime <code>p</code> above or equal to <code>n</code> in <code>primes</code>, but it's not there yet. \"Black hole\".</p>\n\n<p>The famous \"sieve\" code gets around this problem by \"transposing\" the workflow, </p>\n\n<pre><code>primes = map head . iterate (\\(x:xs)-&gt; filter ((/=0).(`rem`x)) xs) $ [2..]\n</code></pre>\n\n<p>thus making it work while retaining its computational inefficiency (the <em>lesser</em> problem of your code), testing its candidates by too many primes needlessly (where each prime is tested by all its preceding primes instead of just those not above its square root), making it unnecessarily slow. </p>\n\n<p>This is mitigated by putting a properly early stop to the testing, with</p>\n\n<pre><code>primes = 2 : [ n | n &lt;- [3,5..]\n                 , and [rem n p /= 0 | p &lt;- takeWhile ((&lt;= n).(^2)) primes]]\n</code></pre>\n\n<p>which, back in terms of your definition, is equivalent to</p>\n\n<pre><code>isPrime' n = p1*p1 &gt; n || rem n p1 /= 0 &amp;&amp; (\n             p2*p2 &gt; n || rem n p2 /= 0 &amp;&amp; (\n             p3*p3 &gt; n || rem n p3 /= 0 &amp;&amp; (\n             ..........\n             pk*pk &gt; n || rem n pk /= 0 &amp;&amp; (\n             ..........          ..... ))))\n</code></pre>\n\n<p>You can write this down as a <code>foldr</code>-based definition now (which can be seen in another answer here).</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1440182360, "creation_date": 1438704456, "last_edit_date": 1438783491, "question_id": 31814172, "link": "https://stackoverflow.com/questions/31814172/determine-a-prime-number-with-right-fold", "title": "Determine a prime number with right fold", "body": "<p>I found this solution on the internet and I need some help understanding it:</p>\n\n<pre><code>isPrime' :: Integer -&gt; Bool\nisPrime' n = foldr (\\x acc -&gt; (n `rem` x) /= 0 &amp;&amp; acc) True primes\n    where primes = 2 : filter isPrime' [3,5..]\n</code></pre>\n\n<p>A couple of things:</p>\n\n<p>My understanding is that if the accumulator for a fold function is a <code>Boolean</code> it has to be set in the lambda function itself. Something like:</p>\n\n<pre><code>(\\x acc -&gt; if (n `rem` x /= 0) then False else acc) True primes\n</code></pre>\n\n<p>But here it is not the case.</p>\n\n<p>Also, the range being used for <code>primes</code> does not have a terminating number. I know the reason this works is because of Haskell's lazy evaluation, but how exactly is that working here?</p>\n\n<p>Lastly, this function does not seem like it would return the proper Boolean. A prime number is one that has no other divisors but itself and 1. So shouldnt the lambda read:</p>\n\n<pre><code>(\\x acc -&gt; if (n `rem` x) == 0 then False else acc) True primes\n</code></pre>\n\n<p>I am thoroughly confused. Please help me out.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1438720545, "post_id": 31812379, "comment_id": 51562762, "body": "Maybe you can include what&#39;s in <code>C:\\\\Users\\\\martynov_p\\\\AppData\\\\Roaming\\\\stack\\\\global\\\\.sta&zwnj;&#8203;ck-work\\\\logs\\\\cmdar&zwnj;&#8203;gs-0.10.13.log</code> also?"}, {"owner": {"reputation": 560, "user_id": 284642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f30c76f5371a33ebd29109c24ccb0e5?s=128&d=identicon&r=PG", "display_name": "Pavel Martynov", "link": "https://stackoverflow.com/users/284642/pavel-martynov"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1438748309, "post_id": 31812379, "comment_id": 51570881, "body": "@adamse nothing new here:Configuring cmdargs-0.10.13... Setup.hs: does not exist"}, {"owner": {"reputation": 9504, "user_id": 470844, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8354544a22bb5a0ac8005ca008f94ad1?s=128&d=identicon&r=PG", "display_name": "ntc2", "link": "https://stackoverflow.com/users/470844/ntc2"}, "edited": false, "score": 0, "creation_date": 1439593414, "post_id": 31812379, "comment_id": 51941959, "body": "I&#39;ve run into a similar problem: for me, it only happens on Windows, and only with GHC 7.10.{1,2}. I can build my project on CentOS, Ubuntu, and OS X with GHC 7.10.{1,2}, and on Windows with GHC 7.8.4. On Windows, this error doesn&#39;t seem to have anything to do with a specific dependency: e.g., which package fails in this way depends on how many jobs I run concurrently (the <code>-j</code> option to Stack)."}, {"owner": {"reputation": 490, "user_id": 635669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0408d7a07f6d5460814d9016aef947c?s=128&d=identicon&r=PG", "display_name": "Guiraldelli", "link": "https://stackoverflow.com/users/635669/guiraldelli"}, "reply_to_user": {"reputation": 9504, "user_id": 470844, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8354544a22bb5a0ac8005ca008f94ad1?s=128&d=identicon&r=PG", "display_name": "ntc2", "link": "https://stackoverflow.com/users/470844/ntc2"}, "edited": false, "score": 0, "creation_date": 1441635673, "post_id": 31812379, "comment_id": 52745617, "body": "I had the same problem with MinGHC 7.8.4 x64 (for Windows). The less then ideal solution? Install MinGHC 7.8.4 i386. Things started to work, then. As an additional info, I inspected the <code>-j</code> argument @ntc2 has told about, but the problem persisted for any number of concurrent jobs."}], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 1, "last_activity_date": 1458266723, "creation_date": 1458266723, "answer_id": 36074885, "question_id": 31812379, "link": "https://stackoverflow.com/questions/31812379/stack-install-setup-hs-does-not-exist/36074885#36074885", "title": "stack install: Setup.hs: does not exist", "body": "<p>This is probably due to a bug in cabal, and is resolved by upgrading your cabal version or switching to a newer stackage resolver.  See </p>\n\n<p><a href=\"https://github.com/haskell/cabal/issues/1733\" rel=\"nofollow\">https://github.com/haskell/cabal/issues/1733</a></p>\n\n<p><a href=\"https://github.com/commercialhaskell/stack/issues/943\" rel=\"nofollow\">https://github.com/commercialhaskell/stack/issues/943</a></p>\n"}], "owner": {"reputation": 560, "user_id": 284642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f30c76f5371a33ebd29109c24ccb0e5?s=128&d=identicon&r=PG", "display_name": "Pavel Martynov", "link": "https://stackoverflow.com/users/284642/pavel-martynov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1458266723, "creation_date": 1438699406, "last_edit_date": 1438715924, "question_id": 31812379, "link": "https://stackoverflow.com/questions/31812379/stack-install-setup-hs-does-not-exist", "title": "stack install: Setup.hs: does not exist", "body": "<p>I put stack.exe v0.1.2.2 in one of my PATH dirs, then install ghc-7.8.4 via <code>stack setup</code>.</p>\n\n<p>I trying to install ghc-mod and obtain strange error <code>Setup.hs: does not exist</code>:</p>\n\n<pre>\nstack install ghc-mod\nUsing resolver: lts-2.21 from global config file: C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\global\\stack.yaml\nghc-paths-0.1.0.9: configure\ndata-default-class-0.0.1: configure\ndlist-0.7.1.1: configure\nansi-terminal-0.6.2.1: configure\nhscolour-1.22: configure\nextra-1.1: configure\nmtl-2.1.3.1: configure\ncmdargs-0.10.13: configure\nProgress: 8/54\n--  While building package cmdargs-0.10.13 using:\n      C:\\\\Users\\\\martynov_p\\\\appdata\\\\Local\\\\Programs\\\\stack\\\\x86_64-windows\\\\ghc-7.8.4\\\\bin\\\\runhaskell.exe -package=Cabal-1.18.1.5 -clear-package-db -global-package-db -package-db=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\pkgdb\\ C:\\Users\\MARTYN~1\\AppData\\Local\\Temp\\stack12088\\Setup.hs --builddir=.stack-work\\dist\\x86_64-windows\\Cabal-1.18.1.5\\ configure --user --package-db=clear --package-db=global --package-db=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\pkgdb\\ --constraint=base==4.7.0.2 --constraint=filepath==1.3.0.2 --constraint=process==1.2.0.0 --constraint=template-haskell==2.9.0.0 --constraint=transformers==0.3.0.0 --libdir=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\lib --bindir=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\bin --datadir=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\share --docdir=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\doc\\cmdargs-0.10.13 --htmldir=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\doc\\cmdargs-0.10.13 --haddockdir=C:\\Users\\martynov_p\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-2.21\\7.8.4\\doc\\cmdargs-0.10.13\n    Process exited with code: ExitFailure 1\n    Logs have been written to: \"C:\\\\Users\\\\martynov_p\\\\AppData\\\\Roaming\\\\stack\\\\global\\\\.stack-work\\\\logs\\\\cmdargs-0.10.13.log\"\n\n    Configuring cmdargs-0.10.13...\n    Setup.hs: does not exist\n</pre>\n"}, {"tags": ["haskell", "literate-programming"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438699995, "post_id": 31811149, "comment_id": 51550533, "body": "glad we could finally figure it out together - congrats"}], "answers": [{"comments": [{"owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "edited": false, "score": 0, "creation_date": 1438697660, "post_id": 31811466, "comment_id": 51548674, "body": "If you check my original post, you can find that I included the <code>Alternative Parser</code> for my addition. I updated the link to show the code that has <code>MonadPlus</code> and the error message that I have now."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "edited": false, "score": 0, "creation_date": 1438698935, "post_id": 31811466, "comment_id": 51549673, "body": "@prosseek ok sorry - a simple <code>import Control.Applicative</code> should do the trick"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "edited": false, "score": 0, "creation_date": 1438699930, "post_id": 31811466, "comment_id": 51550490, "body": "please note that those definitions alone will not help me much (I kindof want the code I could load into ghci myself) - yeah I basically know how to implement <code>Parser</code> and all the stuff - but I am to lazy to do this or just copy it from the book myself. But you should really try to deal with these minor annoyances yourself - you sooner or later have to and the compiler  error in this last case is not to hard to understand IMO"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "edited": false, "score": 0, "creation_date": 1438700083, "post_id": 31811466, "comment_id": 51550603, "body": "PS: also please don&#39;t edit my answer this much - if you are not fine with it add your own and accept it (you can do so - you just have to wait a bit I think)"}, {"owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "edited": false, "score": 0, "creation_date": 1438700217, "post_id": 31811466, "comment_id": 51550698, "body": "Well, I just make the question and answer as simple as possible; I&#39;ll update my question to show the correct way to do it.   Thanks for you help."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1438700027, "last_edit_date": 1438700027, "creation_date": 1438696994, "answer_id": 31811466, "question_id": 31811149, "link": "https://stackoverflow.com/questions/31811149/no-instance-for-ghc-base-alternative-parser-error-running-literate-haskell-cod/31811466#31811466", "title": "No instance for (GHC.Base.Alternative Parser) error running Literate Haskell code", "body": "<p>Right from the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Migration/7.10\" rel=\"nofollow\">Link</a> you posted:</p>\n\n<blockquote>\n  <p>GHC says No instance for (Alternative ...)</p>\n  \n  <p>A side-effect of the AMP is that Alternative became a super-class of\n  MonadPlus. The easy remedy:</p>\n  \n  <p>instance Alternative Foo where\n      (&lt;|>) = mplus\n      empty = mzero</p>\n</blockquote>\n\n<p>so here it should be:</p>\n\n<pre><code>import Control.Applicative\n\ninstance Alternative Parser where\n    (&lt;|&gt;) = mplus\n    empty = mzero\n</code></pre>\n\n<p>sadly I cannot tell you exactly if this will do because the links to the books code you did provide don't include the instance for <code>MonadPlus</code></p>\n\n<h2>where do find missing definitions</h2>\n\n<p>the easiest way is to use <a href=\"https://www.haskell.org/hoogle/?hoogle=Alternative\" rel=\"nofollow\">hoogle</a> or hayoo - as you can see in the link Hoogle for example will tell you that's in the <code>base</code> package and the <code>Control.Applicative</code> <em>namespace</em></p>\n\n<h2>dealing with the multiples</h2>\n\n<p>Ok my bad again - you should be fine with</p>\n\n<pre><code>import Control.Applicative (Alternative())\n</code></pre>\n\n<p>or </p>\n\n<pre><code>import qualified Control.Applicative as CA\n\ninstance CA.Alternative Parser where ...\n</code></pre>\n\n<p>or by qualifying all the stuff (like using <code>Parsing.many</code> instead of just <code>many</code>)</p>\n\n<p>again sorry that I cannot give you a 100% waterproof compiling solution - you might have to test a bit (for example I am not 100% sure about the <code>()</code> here <code>import Control.Applicative (Alternative())</code> and you can probably strip it.</p>\n"}, {"comments": [{"owner": {"reputation": 2445, "user_id": 1675347, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4df8222600f2e915b325a1054dce46ff?s=128&d=identicon&r=PG", "display_name": "Alexander Myshov", "link": "https://stackoverflow.com/users/1675347/alexander-myshov"}, "edited": false, "score": 0, "creation_date": 1454270508, "post_id": 35116969, "comment_id": 57957880, "body": "For those who voted negatively. My motivation for this answer was not making of some sort of duplication, but making ready to go solution, for those who just want to grab adapted version of the module for new version GHCI."}], "tags": [], "owner": {"reputation": 2445, "user_id": 1675347, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4df8222600f2e915b325a1054dce46ff?s=128&d=identicon&r=PG", "display_name": "Alexander Myshov", "link": "https://stackoverflow.com/users/1675347/alexander-myshov"}, "is_accepted": false, "score": 1, "last_activity_date": 1454270184, "last_edit_date": 1454270184, "creation_date": 1454261756, "answer_id": 35116969, "question_id": 31811149, "link": "https://stackoverflow.com/questions/31811149/no-instance-for-ghc-base-alternative-parser-error-running-literate-haskell-cod/35116969#35116969", "title": "No instance for (GHC.Base.Alternative Parser) error running Literate Haskell code", "body": "<p>I've also stumbled upon this issue. For those who want adapted version of the module <code>parsing.lhs</code> just place in import section:</p>\n\n<pre><code>&gt; import qualified Control.Applicative as CA\n</code></pre>\n\n<p>and after type Parser definition this code:</p>\n\n<pre><code>&gt; instance Applicative Parser where\n&gt;    pure  = return\n&gt;    (&lt;*&gt;) = ap  -- defined in Control.Monad\n&gt; \n&gt; instance Functor Parser where\n&gt;    fmap  = liftM\n&gt; \n&gt; instance CA.Alternative Parser where\n&gt;    (&lt;|&gt;) = mplus\n&gt;    empty = mzero\n</code></pre>\n\n<p>Or take adapted version of the module here <a href=\"https://gist.github.com/myshov/85badeb087c51631aee3\" rel=\"nofollow\">https://gist.github.com/myshov/85badeb087c51631aee3</a></p>\n"}], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1655, "favorite_count": 0, "accepted_answer_id": 31811466, "answer_count": 2, "score": 3, "last_activity_date": 1454270184, "creation_date": 1438696218, "last_edit_date": 1438700032, "question_id": 31811149, "link": "https://stackoverflow.com/questions/31811149/no-instance-for-ghc-base-alternative-parser-error-running-literate-haskell-cod", "title": "No instance for (GHC.Base.Alternative Parser) error running Literate Haskell code", "body": "<p>I'm trying to execute examples in Graham Hutton's Programming in Haskell book (<a href=\"http://www.cs.nott.ac.uk/~gmh/book.html\" rel=\"nofollow\">http://www.cs.nott.ac.uk/~gmh/book.html</a>).\nEven though the examples are in literate haskell, I could launch ghci to load the examples; for example <code>ghci cipher.lhs</code> (<a href=\"http://www.cs.nott.ac.uk/~gmh/cipher.lhs\" rel=\"nofollow\">http://www.cs.nott.ac.uk/~gmh/cipher.lhs</a>):</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( cipher.lhs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; let2int 'a'\n0\n</code></pre>\n\n<p>However with some examples, because of the changes in ghci, I have some issues;  for example in Parsing.ls in chapter 8, I have <code>No instance for (Applicative ...)</code> error. </p>\n\n<p>From <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Migration/7.10\" rel=\"nofollow\">https://ghc.haskell.org/trac/ghc/wiki/Migration/7.10</a> I got hints to remove some of the errors by adding some code. </p>\n\n<pre><code>&gt; instance Applicative Parser where\n&gt;    pure  = return\n&gt;    (&lt;*&gt;) = ap  -- defined in Control.Monad\n&gt;\n&gt; instance Functor Parser where\n&gt;    fmap  = liftM\n&gt;\n&gt; instance Alternative Parser where\n&gt;     (&lt;|&gt;) = mplus\n&gt;     empty = mzero \n</code></pre>\n\n<p>However, I couldn't resolve this error message:</p>\n\n<pre><code>Not in scope: type constructor or class \u2018Alternative\u2019\n</code></pre>\n\n<p>What's wrong with this, and how to solve this issue? \nThe original code that causes the problem is from: <a href=\"http://www.cs.nott.ac.uk/~gmh/Parsing.lhs\" rel=\"nofollow\">http://www.cs.nott.ac.uk/~gmh/Parsing.lhs</a></p>\n\n<h2>Solution</h2>\n\n<p>Adding this code works fine:</p>\n\n<pre><code>import qualified Control.Applicative as CA\ninstance CA.Alternative Parser where ...\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1438694944, "creation_date": 1438694944, "answer_id": 31810670, "question_id": 31810616, "link": "https://stackoverflow.com/questions/31810616/haskell-could-not-deduce-t-t-from-the-context-eq-t/31810670#31810670", "title": "Haskell. &quot;Could not deduce (t ~ [t]) from the context (Eq t)&quot;", "body": "<p>you just have one <code>[..]</code> wrap to many:</p>\n\n<pre><code>subst :: Eq t=&gt;t-&gt;t-&gt;[t]-&gt;[t]\nsubst a b xs = [if x==a then b else x | x &lt;- xs]\n</code></pre>\n\n<p>it's just <code>xs</code> not <code>[xs]</code></p>\n\n<p>The reason is simple: if you write <code>[xs]</code> you tell Haskell to expect a list with an single entry <code>xs</code> and it will try to <em>pattern-match</em> it - after this you tell it to pull out values <code>x</code> from <code>xs</code> (<code>x &lt;- xs</code>) that tells Haskell that <code>xs</code> has to be some kind of list itself. so in the end it will assume <code>t</code> to be some list <code>t ~ [s]</code>. But then you go on and check <code>x == a</code> and here <code>x :: s</code> and <code>a :: t</code> ending with the error as now <code>[s] ~ t ~ s</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 3, "last_activity_date": 1438695259, "creation_date": 1438695259, "answer_id": 31810781, "question_id": 31810616, "link": "https://stackoverflow.com/questions/31810616/haskell-could-not-deduce-t-t-from-the-context-eq-t/31810781#31810781", "title": "Haskell. &quot;Could not deduce (t ~ [t]) from the context (Eq t)&quot;", "body": "<p>In your parameter list you write <code>[xs]</code>. This is a pattern that matches a list containing exactly one element, which will then be referred to as <code>xs</code>. This has two consequences:</p>\n\n<ol>\n<li>This is a non-exhaustive pattern match, which will fail at run time if the given list has zero elements or more than one. Since you want the same code to execute, regardless of the list's length, you want a pattern that always matches, like <code>xs</code> without the brackets.</li>\n<li>Since the <code>xs</code> in <code>[xs]</code> refers to a single element of the list, its type is <code>t</code>, not <code>[t]</code>. However you use it as if its type were <code>[t]</code>, which leads Haskell to conclude that <code>t</code> must equal <code>[t]</code> (the <code>~</code> operator is used in Haskell to denote that two types are equal), which leads to the somewhat confusing type error you're getting.</li>\n</ol>\n"}], "owner": {"reputation": 65, "user_id": 5189727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/20bc38f6c1aed4cd56b800a02da95fad?s=128&d=identicon&r=PG&f=1", "display_name": "L.Leo", "link": "https://stackoverflow.com/users/5189727/l-leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 31810670, "answer_count": 2, "score": 3, "last_activity_date": 1438695259, "creation_date": 1438694795, "last_edit_date": 1438694839, "question_id": 31810616, "link": "https://stackoverflow.com/questions/31810616/haskell-could-not-deduce-t-t-from-the-context-eq-t", "title": "Haskell. &quot;Could not deduce (t ~ [t]) from the context (Eq t)&quot;", "body": "<p>Just learn the haskell by myself, and can not solve this problem. These are the codes.</p>\n\n<pre><code>subst :: Eq t=&gt;t-&gt;t-&gt;[t]-&gt;[t]\nsubst a b [xs]=[if x==a then b else x | x &lt;- xs]\n</code></pre>\n\n<p>The error is below.</p>\n\n<pre><code>subst.hs:2:46:\n    Could not deduce (t ~ [t])\n    from the context (Eq t)\n      bound by the type signature for\n                 subst :: Eq t =&gt; t -&gt; t -&gt; [t] -&gt; [t]\n      at subst.hs:1:10-29\n      \u2018t\u2019 is a rigid type variable bound by\n          the type signature for subst :: Eq t =&gt; t -&gt; t -&gt; [t] -&gt; [t]\n          at subst.hs:1:10\n    Relevant bindings include\n      xs :: t (bound at subst.hs:2:12)\n      b :: t (bound at subst.hs:2:9)\n      a :: t (bound at subst.hs:2:7)\n      subst :: t -&gt; t -&gt; [t] -&gt; [t] (bound at subst.hs:2:1)\n    In the expression: xs\n    In a stmt of a list comprehension: x &lt;- xs\n</code></pre>\n\n<p>The problem, I guess, is that haskell can not ensure the element from [t] match the t. I am not sure. And I want to know how to solve this problem.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438666905, "post_id": 31801399, "comment_id": 51529603, "body": "Why do you want to do this?"}, {"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438666983, "post_id": 31801399, "comment_id": 51529639, "body": "I probably will not do it because it would make the code complicated. I just thought about it and realized that I do not know whether this is possible. So I asked..."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 6, "creation_date": 1438667058, "post_id": 31801399, "comment_id": 51529667, "body": "I think there are a couple of options <code>data MyType a b = MyType (b a) (Set a) [a] a</code> for example but this would require you to do a <i>type-flip</i> for your map: <code>data Flip t a b = Flip (t b a)</code>: <code>type MyType1 a = MyType a (Flip Map String)</code>"}, {"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438667258, "post_id": 31801399, "comment_id": 51529737, "body": "@Carsten thanks. it makes sense. I did not know that I can apply one parameter to another."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1438667294, "post_id": 31801399, "comment_id": 51529752, "body": "@akonsu <b>kinds</b> for the win ;) - there is plenty of other stuff you could use (or so I think): functional-dependencies, type-families, ... but this all require ghc-language-extensions and might be a bit overkill (just as my commented <i>solution</i> is ;) )"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1438921527, "post_id": 31801399, "comment_id": 51657977, "body": "Carsten&#39;s solution may seem overkill, but modeling a problem accurately like this can have surprising benefits that are worth exploring!"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1438666560, "creation_date": 1438666560, "question_id": 31801399, "link": "https://stackoverflow.com/questions/31801399/data-type-with-two-dependent-type-parameters", "title": "data type with two dependent type parameters", "body": "<p>I have two types</p>\n\n<pre><code>data MyType0 a = MyType0 (Set a)        (Set a) [a] a\ndata MyType1 a = MyType0 (Map a String) (Set a) [a] a\n</code></pre>\n\n<p>This is a contrived example, just to show that these types differ by the first parameter and have a large total number of parameters.</p>\n\n<p>Can I declare a type with two parameters:</p>\n\n<pre><code>data MyType a b = MyType b (Set a) [a] a\n</code></pre>\n\n<p>and tell the type checker that I want <code>b</code> to be a type parameterized by <code>a</code>? That is, I do not want to be able to have a type like <code>MyType (Set Int) (Set String) [String] String</code>.</p>\n\n<p>I hope what I am asking makes sense. I am still learning.</p>\n"}, {"tags": ["haskell", "types", "polymorphism", "ghc"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1438663358, "post_id": 31800235, "comment_id": 51528446, "body": "I find this highly interesting and you got my upvote already but I hope you don&#39;t mind the question: why not just use a sum-type for your handlers - I&#39;m sure you have your reasons but the example here seems to scream for this basic solution."}, {"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438663547, "post_id": 31800235, "comment_id": 51528506, "body": "@Carsten: Mostly because I hoped there was a better way. I&#39;d never used closed type families before (I forgot GHC already supported them). At this point, I think I might just use the three different constructors and when pattern matching them, I can pass them directly to <code>enactEffect :: (Show h) =&gt; [h] -&gt; (h -&gt; Effect) -&gt; IO ()</code>. This will allow me to handle more complex constraints than <code>Show</code> (assuming <code>Show</code> is a prerequisite for <code>WithEach</code> constructor), including module private ones."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438663873, "post_id": 31800235, "comment_id": 51528593, "body": "as long as you don&#39;t want to extent to other handler IMO there is no <i>better</i> way <a href=\"https://gist.github.com/CarstenKoenig/9c7354b88befcc1db1d8\" rel=\"nofollow noreferrer\">this</a> seems to be a lot easier (to me ;) )"}, {"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438664141, "post_id": 31800235, "comment_id": 51528679, "body": "@Carsten: I see what you are saying. I really want to enforce static types. I&#39;m using this for my DSL Hearthstone model (effects and abilities). This will rule out illegal card constructions that a sum type would permit."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438664335, "post_id": 31800235, "comment_id": 51528731, "body": "ah ok - sorry for the buzz"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1438680524, "post_id": 31800235, "comment_id": 51536888, "body": "@Thomas Eding: can&#39;t you just hide the sum type itself, to rule out illegal card constructions?"}, {"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1438744764, "post_id": 31800235, "comment_id": 51570030, "body": "@leftaroundabout: That loses some necessary type info. For example, I dont want to allow clients to do something like DestroyMinion when constructed with a bad instance of a sum type . To see my real use case, refer to dreadInfernal definition in <a href=\"https://github.com/thomaseding/hearthshroud/blob/a4f424289878baaa6094cb94d8dc2028e8d1aa3d/src/Hearth/Cards/Basic.hs\" rel=\"nofollow noreferrer\">github.com/thomaseding/hearthshroud/blob/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 9, "last_activity_date": 1438663827, "last_edit_date": 1438663827, "creation_date": 1438660069, "answer_id": 31800336, "question_id": 31800235, "link": "https://stackoverflow.com/questions/31800235/does-haskell-support-closed-polymorphic-types/31800336#31800336", "title": "Does Haskell support closed polymorphic types?", "body": "<p>I think you can get precisely your syntax with a <a href=\"https://downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/type-families.html#closed-type-families\">closed</a> <a href=\"https://downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/constraint-kind.html\">constraint</a> type family:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, ConstraintKinds, GADTs #-}\n\nimport GHC.Exts (Constraint)\n\nnewtype PlayerHandle = PlayerHandle Int\nnewtype MinionHandle = MinionHandle Int\nnewtype WeaponHandle = WeaponHandle Int\n\ntype family IsHandle h :: Constraint where\n    IsHandle (PlayerHandle) = ()\n    IsHandle (MinionHandle) = ()\n    IsHandle (WeaponHandle) = ()\n\ndata Effect where\n    WithEach :: (IsHandle handle) =&gt; [handle] -&gt; (handle -&gt; Effect) -&gt; Effect\n</code></pre>\n\n<p>EDIT: Another attempt that includes <code>Show</code>:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, ConstraintKinds, GADTs,\n             UndecidableInstances #-}\n\nimport GHC.Exts (Constraint)\nimport Control.Monad (forM_)\n\nnewtype PlayerHandle = PlayerHandle Int\nnewtype MinionHandle = MinionHandle Int\nnewtype WeaponHandle = WeaponHandle Int\n\ntype family IsHandle' h :: Constraint where\n    IsHandle' (PlayerHandle) = ()\n    IsHandle' (MinionHandle) = ()\n    IsHandle' (WeaponHandle) = ()\n\ntype IsHandle h = (IsHandle' h, Show h)\n\ndata Effect where\n    WithEach :: (IsHandle handle) =&gt; [handle] -&gt; (handle -&gt; Effect) -&gt; Effect\n\n-- Assume my each (IsHandle a) already is an instance of a class I want to use, such as (Show).\nenactEffect :: Effect -&gt; IO ()\nenactEffect (WithEach handles cont) = forM_ handles $ \\handle -&gt; do\n    print handle  -- (*)\n    enactEffect $ cont handle\n</code></pre>\n\n<p>I don't quite see how to avoid having two different classes, types or families and get the API you seem to want without making it possible to add other types in another module. I also don't know of any way for the resulting <code>IsHandle</code> constraint to automatically inherit all the classes the three types have in common, without you listing them <em>somewhere</em>.</p>\n\n<p>But I think depending on your needs/style, there are some more options similar to my last one:</p>\n\n<ul>\n<li>You could make <code>IsHandle</code> a class with <code>IsHandle'</code> and <code>Show</code> etc. as superclasses.</li>\n<li>You could make <code>IsHandle'</code> a class, in which case the only prevention against adding more types would be not exporting <code>IsHandle'</code>.</li>\n</ul>\n\n<p>One advantage of the last one is that it can seriously cut down the number of extensions needed for this:</p>\n\n<pre><code>{-# LANGUAGE GADTs, ConstraintKinds #-}\n\nclass IsHandle' h\ninstance IsHandle' (PlayerHandle)\ninstance IsHandle' (MinionHandle)\ninstance IsHandle' (WeaponHandle)\n\ntype IsHandle h = (IsHandle' h, Show h)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438710965, "post_id": 31805226, "comment_id": 51557719, "body": "The problem with this approach is that I do not know all the class constraints I&#39;ll need to add to the <code>Handle</code> class at the time I would define the <code>Handle</code> class. Ideally consumers of <code>Handle</code> would be able to create new classes that Player/Minion/WeaponHandle will all instantiate and use with a generic <code>Handle</code>."}], "tags": [], "owner": {"reputation": 4685, "user_id": 5180989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gxpck.jpg?s=128&g=1", "display_name": "Helder Pereira", "link": "https://stackoverflow.com/users/5180989/helder-pereira"}, "is_accepted": false, "score": 2, "last_activity_date": 1438679619, "creation_date": 1438679619, "answer_id": 31805226, "question_id": 31800235, "link": "https://stackoverflow.com/questions/31800235/does-haskell-support-closed-polymorphic-types/31805226#31805226", "title": "Does Haskell support closed polymorphic types?", "body": "<p>Unless you want to do something complex with the type, I would go with a simple solution using <code>class</code>:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nimport Control.Monad\n\nnewtype PlayerHandle = PlayerHandle Int deriving (Show)\nnewtype MinionHandle = MinionHandle Int deriving (Show)\nnewtype WeaponHandle = WeaponHandle Int deriving (Show)\n\nclass (Show h) =&gt; Handle h\ninstance Handle PlayerHandle\ninstance Handle MinionHandle\ninstance Handle WeaponHandle\n\ndata Effect where\n    WithEach :: (Handle handle) =&gt; [handle] -&gt; (handle -&gt; Effect) -&gt; Effect\n\nenactEffect :: Effect -&gt; IO ()\nenactEffect (WithEach handles cont) = forM_ handles $ \\handle -&gt; do\n    print handle\n    enactEffect $ cont handle\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1438702021, "post_id": 31805739, "comment_id": 51552056, "body": "If you add a <code>class Handle a where { handlew :: p a -&gt; HandleW a }</code> and instances <code>instance Handle PlayerHandle where { handlew _ = WPlayer }</code>, etc., you can get rid of passing around the <code>HandleW</code> witness manually and match the desired syntax exactly."}, {"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438711417, "post_id": 31805739, "comment_id": 51557921, "body": "Looks promising. I&#39;ll try it out when I get the chance."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1438682133, "last_edit_date": 1438682133, "creation_date": 1438681115, "answer_id": 31805739, "question_id": 31800235, "link": "https://stackoverflow.com/questions/31800235/does-haskell-support-closed-polymorphic-types/31805739#31805739", "title": "Does Haskell support closed polymorphic types?", "body": "<p>Here's a solution based on GADTs:</p>\n\n<pre><code>{-# LANGUAGE GADTs, RankNTypes #-}\n{-# OPTIONS -Wall #-}\nmodule GADThandle where\n\nimport Control.Monad\n\nnewtype PlayerHandle = PlayerHandle Int deriving (Show)\nnewtype MinionHandle = MinionHandle Int deriving (Show)\nnewtype WeaponHandle = WeaponHandle Int deriving (Show)\n\ndata HandleW a where\n   WPlayer :: HandleW PlayerHandle\n   WMinion :: HandleW MinionHandle\n   WWeapon :: HandleW WeaponHandle\n\nhandlewShow :: HandleW a -&gt; (Show a =&gt; b) -&gt; b\nhandlewShow WPlayer x = x\nhandlewShow WMinion x = x\nhandlewShow WWeapon x = x\n\ndata Effect where\n   WithEach :: HandleW handle -&gt; [handle] -&gt; (handle -&gt; Effect) -&gt; Effect \n\nenactEffect :: Effect -&gt; IO ()\nenactEffect (WithEach handlew handles cont) = handlewShow handlew $ \n   forM_ handles $ \\handle -&gt; do\n      print handle\n      enactEffect $ cont handle\n</code></pre>\n\n<p>The idea here is to use a type witness <code>HandleW a</code>, certifying that <code>a</code> is one of your three types. Then, the \"lemma\" <code>handlewShow</code> proves that if <code>HandleW a</code> holds, then <code>a</code> must be a <code>Show</code>-able type.</p>\n\n<p>It is also possible to generalize the code above to arbitrary type classes. The lemma below proves that if you have <code>c T</code> for each of your three types <code>T</code>, and you know that <code>HandleW a</code> holds, then <code>c a</code> must hold as well. You can obtain the previous lemma by picking <code>c = Show</code>.</p>\n\n<pre><code>handlewC :: (c PlayerHandle, c MinionHandle, c WeaponHandle) =&gt; \n   HandleW a -&gt; Proxy c -&gt; (c a =&gt; b) -&gt; b\nhandlewC WPlayer Proxy x = x\nhandlewC WMinion Proxy x = x\nhandlewC WWeapon Proxy x = x\n\nenactEffect' :: Effect -&gt; IO ()\nenactEffect' (WithEach handlew handles cont) = handlewC handlew (Proxy :: Proxy Show) $ \n   forM_ handles $ \\handle -&gt; do\n      print handle\n      enactEffect' $ cont handle\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438711407, "post_id": 31808784, "comment_id": 51557917, "body": "Looks promising. I&#39;ll try it out when I get the chance."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 2, "last_activity_date": 1438689625, "creation_date": 1438689625, "answer_id": 31808784, "question_id": 31800235, "link": "https://stackoverflow.com/questions/31800235/does-haskell-support-closed-polymorphic-types/31808784#31808784", "title": "Does Haskell support closed polymorphic types?", "body": "<p>I'd use GADTs:</p>\n\n<pre><code>{-# LANGUAGE KindSignatures, GADTs, RankNTypes, DataKinds #-}\n\ndata K = Player | Minion | Weapon\n  deriving (Eq, Show)\n\nnewtype PlayerHandle = PlayerHandle Int deriving (Show)\nnewtype MinionHandle = MinionHandle Int deriving (Show)\nnewtype WeaponHandle = WeaponHandle Int deriving (Show)\n\n-- Plain ADT might be enough\n-- see below\ndata Handle (k :: K) where\n  PlayerHandle' :: PlayerHandle -&gt; Handle Player\n  MinionHandle' :: MinionHandle -&gt; Handle Minion\n  WeaponHandle' :: WeaponHandle -&gt; Handle Weapon\n\ndata SomeHandle where\n  SomeHandle :: Handle k -&gt; SomeHandle\n\ndata Effect where\n  WithEach :: (SomeHandle -&gt; IO ()) -&gt; Effect\n\nprintEffect :: Effect\nprintEffect = WithEach f\n  where f (SomeHandle h) = g h\n        g :: Handle k -&gt; IO ()\n        g (PlayerHandle' p) = putStrLn $ \"player :\" ++ show p\n        g (MinionHandle' p) = putStrLn $ \"minion :\" ++ show p\n        g (WeaponHandle' p) = putStrLn $ \"weapon :\" ++ show p\n\n-- GADTs are useful, if you want to have maps preserving handle kind:\ndata HandleMap where\n  -- HandleMap have to handle all `k`, yet cannot change it!\n  HandleMap :: (forall k. Handle k -&gt; Handle k) -&gt; HandleMap\n\nzeroWeaponHandle :: HandleMap\nzeroWeaponHandle = HandleMap f\n  where f :: forall k. Handle k -&gt; Handle k\n        f (PlayerHandle' h) = PlayerHandle' h\n        f (MinionHandle' h) = MinionHandle' h\n        f (WeaponHandle' _) = WeaponHandle' $ WeaponHandle 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438738030, "post_id": 31820599, "comment_id": 51568552, "body": "This works for exactly what I need. I don&#39;t need to use DataKinds (I can use types instead), but the end result is the same."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438792114, "post_id": 31820599, "comment_id": 51597524, "body": "@ThomasEding I&#39;m guessing that by &quot;I can use types instead&quot;, you mean &quot;I can write <code>data Player; data Minion; data Weapon; newtype Handle e = Handle Int</code>&quot;. Beware the difference between the two: with yours, <code>Handle :: * -&gt; *</code>, and therefore can be applied to any dumb old type like <code>Handle ()</code> or <code>Handle Bool</code>; with mine, <code>Handle :: Entity -&gt; *</code>, and therefore the kind-checker will enforce that <code>Handle</code> is <i>only</i> applied to one of the three types you care about."}, {"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438793208, "post_id": 31820599, "comment_id": 51598240, "body": "I also create three distinct monomorphic constructors for each of the handle varieties. I have posted my derived solution in my question."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438795135, "post_id": 31820599, "comment_id": 51599391, "body": "@ThomasEding Standard practice is to put solutions as answers, not as questions. It&#39;s considered perfectly fine to write and accept an answer to your own question."}, {"owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "edited": false, "score": 0, "creation_date": 1438796388, "post_id": 31820599, "comment_id": 51600026, "body": "Ah, okay. I&#39;ll accept my answer when SO allows me to do so (several hours from now)."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1438728036, "creation_date": 1438728036, "answer_id": 31820599, "question_id": 31800235, "link": "https://stackoverflow.com/questions/31800235/does-haskell-support-closed-polymorphic-types/31820599#31820599", "title": "Does Haskell support closed polymorphic types?", "body": "<p>Add a type parameter to your <code>Handle</code> type, and restrict its values to be one of just three using <code>DataKinds</code>, thus:</p>\n\n<pre><code>{-# LANGUAGE DataKinds      #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE GADTs          #-}\n\nimport Control.Monad\n\ndata Entity = Player | Minion | Weapon\n\nnewtype Handle (e :: Entity) = Handle Int\n    deriving (Eq, Ord, Read, Show)\n\ndata Effect where\n    WithEach :: [Handle e] -&gt; (Handle e -&gt; Effect) -&gt; Effect\n\nenactEffect :: Effect -&gt; IO ()\nenactEffect (WithEach handles cont) = forM_ handles $ \\handle -&gt; do\n    print handle\n    enactEffect $ cont handle\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "is_accepted": true, "score": 1, "last_activity_date": 1438796346, "creation_date": 1438796346, "answer_id": 31839260, "question_id": 31800235, "link": "https://stackoverflow.com/questions/31800235/does-haskell-support-closed-polymorphic-types/31839260#31839260", "title": "Does Haskell support closed polymorphic types?", "body": "<p>Thanks for all the solutions guys. They all are helpful for various use cases. For my use case, it turned out that making the handle types into a single GADT solved my problem.</p>\n\n<p>Here's my derived solution for those interested:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE LambdaCase #-}\n\ndata Player\ndata Minion\ndata Weapon\n\ndata Handle a where\n    PlayerHandle :: Int -&gt; Handle Player\n    MinionHandle :: Int -&gt; Handle Minion\n    WeaponHandle :: Int -&gt; Handle Weapon\n\ndata Effect where\n    WithEach :: [Handle h] -&gt; (Handle h -&gt; Effect) -&gt; Effect\n    PrintSecret :: Handle h -&gt; Effect\n\n-------------------------------------------------------------------------------\n-- Pretend the below code is a separate file that imports the above data types\n-------------------------------------------------------------------------------\n\nclass ObtainSecret a where\n    obtainSecret :: a -&gt; String\n\ninstance ObtainSecret (Handle a) where\n    obtainSecret = \\case\n        PlayerHandle n -&gt; \"Player\" ++ show n\n        MinionHandle n -&gt; \"Minion\" ++ show n\n        WeaponHandle n -&gt; \"Weapon\" ++ show n\n\nenactEffect :: Effect -&gt; IO ()\nenactEffect = \\case\n    WithEach handles continuation -&gt; mapM_ (enactEffect . continuation) handles\n    PrintSecret handle -&gt; putStrLn (obtainSecret handle)\n\ncreateEffect :: [Handle h] -&gt; Effect\ncreateEffect handles = WithEach handles PrintSecret\n\nmain :: IO ()\nmain = do\n    enactEffect $ createEffect $ map PlayerHandle [0..2]\n    enactEffect $ createEffect $ map MinionHandle [3..5]\n    enactEffect $ createEffect $ map WeaponHandle [6..9]\n</code></pre>\n"}], "owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 3, "accepted_answer_id": 31839260, "answer_count": 6, "score": 12, "last_activity_date": 1438796346, "creation_date": 1438659389, "last_edit_date": 1438795989, "question_id": 31800235, "link": "https://stackoverflow.com/questions/31800235/does-haskell-support-closed-polymorphic-types", "title": "Does Haskell support closed polymorphic types?", "body": "<p>Given:</p>\n\n<pre><code>newtype PlayerHandle = PlayerHandle Int deriving (Show)\nnewtype MinionHandle = MinionHandle Int deriving (Show)\nnewtype WeaponHandle = WeaponHandle Int deriving (Show)\n</code></pre>\n\n<p>In the following code, I would like <code>handle</code> to be <em>exactly</em> one of three types: <code>PlayerHandle</code>, <code>MinionHandle</code>, and <code>WeaponHandle</code>. Is this possible to do in Haskell?</p>\n\n<pre><code>data Effect where\n    WithEach :: (??? handle) =&gt; [handle] -&gt; (handle -&gt; Effect) -&gt; Effect -- Want `handle' to be under closed set of types.\n</code></pre>\n\n<p>The following is too tedious:</p>\n\n<pre><code>data Effect' where\n    WithEachPlayer :: [PlayerHandle] -&gt; (PlayerHandle -&gt; Effect) -&gt; Effect\n    WithEachMinion :: [MinionHandle] -&gt; (MinionHandle -&gt; Effect) -&gt; Effect\n    WithEachWeapon :: [WeaponHandle] -&gt; (WeaponHandle -&gt; Effect) -&gt; Effect\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>\u00d8rjan Johansen has proposed using closed type families, which indeed gets me a step closer to what I want. The issue I'm having using them is that I can't seem to write the following:</p>\n\n<pre><code>type family IsHandle h :: Constraint where\n    IsHandle (PlayerHandle) = ()\n    IsHandle (MinionHandle) = ()\n    IsHandle (WeaponHandle) = ()\n\ndata Effect where\n    WithEach :: (IsHandle handle) =&gt; [handle] -&gt; (handle -&gt; Effect) -&gt; Effect\n\nenactEffect :: Effect -&gt; IO ()\nenactEffect (WithEach handles cont) = forM_ handles $ \\handle -&gt; do\n    print handle  -- Eeek! Can't deduce Show, despite all cases being instances of Show.\n    enactEffect $ cont handle\n</code></pre>\n\n<p>Here GHC complains that it cannot deduce that the handle is an instance of <code>Show</code>. I am hesitant to solve this by moving the <code>Show</code> constraint in the <code>WithEach</code> constructor for various reasons. These include modularity and scalability. Would something like a closed data family solve this (as I know type family mappings are not injective... Is that the problem even with closed ones?)</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "edited": false, "score": 0, "creation_date": 1438657987, "post_id": 31799828, "comment_id": 51527168, "body": "Changing <code>queryP</code> appears to be what I needed. So putting the <code>forall</code> explicitly on the type of the function <code>f</code> is what makes it polymorphic? Is this basically the same situation as the Rank-N-Types section of this answer: <a href=\"http://stackoverflow.com/a/3071932/1542000\">stackoverflow.com/a/3071932/1542000</a> ?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "edited": false, "score": 0, "creation_date": 1438658679, "post_id": 31799828, "comment_id": 51527335, "body": "Yes. You could say it is a simple matter of parenthesization: <code>forall a. a -&gt; Bool</code> means <code>forall a. (a -&gt; Bool)</code> as opposed to <code>(forall a. a) -&gt; Bool</code> which requires explciit parentheses (and turning on higher-rank types, of course)."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1438656242, "creation_date": 1438656242, "answer_id": 31799828, "question_id": 31799691, "link": "https://stackoverflow.com/questions/31799691/specify-nested-type-variable-constraints-are-of-same-instance-in-haskell/31799828#31799828", "title": "Specify nested type variable constraints are of same instance in Haskell", "body": "<p>In the type definition</p>\n\n<pre><code>newtype FooParser a = FooParser { (#) :: Foo b =&gt; b -&gt; (a, b) }\n</code></pre>\n\n<p>the type variable <code>b</code> is bound universially in a higher-rank type; i.e. the type of the newly introduced selector function <code>(#)</code> is</p>\n\n<pre><code>*Foo&gt; :t (#)\n(#) :: Foo b =&gt; FooParser a -&gt; b -&gt; (a, b)\n</code></pre>\n\n<p>But that means when you construct a <code>FooParser a</code>, the function you pass to the constructor must be typed at <code>b -&gt; (a, b)</code> for <strong>any</strong> choice of <code>b</code> (as long as <code>Foo b</code> holds):</p>\n\n<pre><code>*Foo&gt; :t FooParser\nFooParser :: (forall b. Foo b =&gt; b -&gt; (a, b)) -&gt; FooParser a\n</code></pre>\n\n<p>However, in <code>queryP</code> you are given a function of type <code>b -&gt; a</code> for <strong>some</strong> choice of <code>b</code> (the <code>b</code> is chosen by the caller, with the only restriction that <code>Foo b</code> will hold). </p>\n\n<p>So if I set <code>b ~ b1</code> and call <code>queryP</code>, that means I am passing you a function of type <code>f :: b1 -&gt; a</code>. You then have to return to me a function of type <code>forall b. (Foo b) =&gt; b -&gt; (a, b)</code> (wrapped in the constructor <code>FooParser</code>). </p>\n\n<p>You can't just use <code>f</code> for this purpose, as for any choice of <code>b</code> other than <code>b1</code> (e.g. <code>b ~ b2</code>) it will not be of the right type.</p>\n\n<p>In its present form, you can basically only use functions from the <code>Foo</code> class and parametrically sufficiently polymorphic functions to construct your <code>forall b. (Foo b) =&gt; b -&gt; (a, b)</code> function. Depending on what you are trying to do, you can either </p>\n\n<ul>\n<li>Change <code>queryP</code> so that it takes a polymorphic function:</li>\n</ul>\n\n\n\n<pre><code>queryP :: (forall b. Foo b =&gt; (b -&gt; a)) -&gt; FooParser a\nqueryP f = FooParser $ \\b -&gt; (f b, b)\n</code></pre>\n\n<ul>\n<li>Change <code>FooParser</code> so that <code>b</code> is existentially bound:</li>\n</ul>\n\n\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\ndata FooParser a = forall b. Foo b =&gt; FooParser { (#) :: b -&gt; (a, b) }\n</code></pre>\n\n<p>Note that these two changes mean (and imply) very different things.</p>\n"}], "owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 31799828, "answer_count": 1, "score": 2, "last_activity_date": 1438656325, "creation_date": 1438655107, "last_edit_date": 1438656325, "question_id": 31799691, "link": "https://stackoverflow.com/questions/31799691/specify-nested-type-variable-constraints-are-of-same-instance-in-haskell", "title": "Specify nested type variable constraints are of same instance in Haskell", "body": "<p>The following which uses <code>FooA</code> explicitly as the type in <code>(#)</code> and in <code>queryP</code> compiles as expected:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, ScopedTypeVariables #-}\nmodule Foo where\n\nclass Foo a where\n\nnewtype FooParser a = FooParser { (#) :: FooA -&gt; (a, FooA) }\n\nqueryP :: (FooA -&gt; a) -&gt; FooParser a\nqueryP f = FooParser $ \\(b :: FooA) -&gt; (f b, b)\n\ndata FooA = FooA Int\ninstance Foo FooA where\n</code></pre>\n\n<p>But when I try to define <code>FooParser</code> and <code>queryP</code> using the typeclass <code>Foo</code> like so:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, ScopedTypeVariables #-}\nmodule Foo where\n\nclass Foo a where\n\nnewtype FooParser a = FooParser { (#) :: Foo b =&gt; b -&gt; (a, b) }\n\nqueryP :: Foo b =&gt; (b -&gt; a) -&gt; FooParser a\nqueryP f = FooParser $ \\(b :: Foo b =&gt; b) -&gt; (f b, b)\n</code></pre>\n\n<p>I get a could-not-deduce error:</p>\n\n<pre><code>Foo.hs:11:52:\n    Could not deduce (b ~ b1)\n    from the context (Foo b)\n      bound by the type signature for\n                 queryP :: Foo b =&gt; (b -&gt; a) -&gt; FooParser a\n      at Foo.hs:10:11-42\n    or from (Foo b1)\n      bound by a type expected by the context: Foo b1 =&gt; b1 -&gt; (a, b1)\n      at Foo.hs:11:12-53\n      \u2018b\u2019 is a rigid type variable bound by\n          the type signature for queryP :: Foo b =&gt; (b -&gt; a) -&gt; FooParser a\n          at Foo.hs:10:11\n      \u2018b1\u2019 is a rigid type variable bound by\n           a type expected by the context: Foo b1 =&gt; b1 -&gt; (a, b1)\n           at Foo.hs:11:12\n    Relevant bindings include\n      b :: Foo b =&gt; b (bound at Foo.hs:11:26)\n      f :: b -&gt; a (bound at Foo.hs:11:8)\n      queryP :: (b -&gt; a) -&gt; FooParser a (bound at Foo.hs:11:1)\n    In the expression: b\n    In the expression: (f b, b)\n</code></pre>\n\n<p>How can I specify that the <code>b</code> in the lambda function in <code>queryP</code> is of the same instance of the typeclass <code>Foo</code> as in the first parameter of <code>f</code>?</p>\n"}, {"tags": ["haskell", "parallel-processing"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 4100057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c6c4f4371c79d73eec08feecd688fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4100057/frank-wang"}, "edited": false, "score": 0, "creation_date": 1438709204, "post_id": 31799184, "comment_id": 51556702, "body": "Following your suggestion, I ran to tests, one with two cores and one with three. I created an input file and split it into 2 parts and 3 parts. Very rough timings are as follows:  1 Core, 1 File, 6000000 points: ~6.5 s  2 Cores, 2 Files, 3000000 points each: ~5.8 s  3 Cores, 3 Files, 2000000 points each: ~ 4.5 s"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 171, "user_id": 4100057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c6c4f4371c79d73eec08feecd688fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4100057/frank-wang"}, "edited": false, "score": 0, "creation_date": 1438717113, "post_id": 31799184, "comment_id": 51560923, "body": "Are you aware of the book <a href=\"http://chimera.labs.oreilly.com/books/1230000000929\" rel=\"nofollow noreferrer\">Parallel and Concurrent Programming in Haskell</a>?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 171, "user_id": 4100057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c6c4f4371c79d73eec08feecd688fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4100057/frank-wang"}, "edited": false, "score": 0, "creation_date": 1438720524, "post_id": 31799184, "comment_id": 51562750, "body": "Post your code some place - there&#39;s something wrong with it. I can get close to linear speedup."}, {"owner": {"reputation": 171, "user_id": 4100057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c6c4f4371c79d73eec08feecd688fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4100057/frank-wang"}, "edited": false, "score": 0, "creation_date": 1438720904, "post_id": 31799184, "comment_id": 51562952, "body": "The code I was running is housed in image_generatorT.hs in this repository :<a href=\"https://github.com/frankwang95/Polynomials/tree/master/testing\" rel=\"nofollow noreferrer\">github.com/frankwang95/Polynomials/tree/master/testing</a>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 171, "user_id": 4100057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c6c4f4371c79d73eec08feecd688fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4100057/frank-wang"}, "edited": false, "score": 0, "creation_date": 1438724627, "post_id": 31799184, "comment_id": 51564715, "body": "try <code>spawnP $ force $ ...</code> where <code>force</code> is from <code>Control.DeepSeq</code>. Also, all you are doing is parallelizing the parsing which is not going to help. <code>a&#39; ++ b</code>&#39; is going to create a huge list in memory which is going to kill performance. Generate a <code>Vector Int</code> from a <code>LB.ByteString</code> and <code>zipWith (+)</code> the vectors."}, {"owner": {"reputation": 171, "user_id": 4100057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c6c4f4371c79d73eec08feecd688fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4100057/frank-wang"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438724848, "post_id": 31799184, "comment_id": 51564811, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/85155/discussion-between-frank-wang-and-user5402\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1438651013, "last_edit_date": 1492087233, "creation_date": 1438651013, "answer_id": 31799184, "question_id": 31798004, "link": "https://stackoverflow.com/questions/31798004/diagnosing-parallel-monad-performance/31799184#31799184", "title": "Diagnosing parallel monad performance", "body": "<p>First of all I would suggest referencing your code-review posting <a href=\"https://codereview.stackexchange.com/questions/98730/parsing-and-plotting-complex-numbers\">(link)</a> to give people more background info on what you are trying to do.</p>\n\n<p>Your basic problem is that you are forcing Haskell to read the entire file into memory with <code>length x</code>. What you want to do is to stream in the results so that as little of the file is in memory at any time.</p>\n\n<p>What you have is a typical map-reduce computation, so to split the workload into two parts, my recommendation is:</p>\n\n<ol>\n<li>Open the input file twice, creating two file handles.</li>\n<li>Position the second handle at the \"middle\" of the file.</li>\n<li>Create two computations - one for each file handle.</li>\n<li>The first computation will read from its handle until it gets to the \"middle\"; the second will read from its handle until it reaches the end of file.</li>\n<li>Each computation will create a <code>Vector Int</code></li>\n<li>When each computation finishes we combine both vectors together (add up the vectors element-wise.)</li>\n</ol>\n\n<p>Of course, the \"middle\" of the file is the beginning of a line which is close to the middle of the file.</p>\n\n<p>The tricky part is step 4, so to simplify things let's assume the input file has already been split into two separate files <code>part1</code> and <code>part2</code>. Then your computation could look like this:</p>\n\n<pre><code>main = do\n    content1 &lt;- LB.readFile \"part1\"\n    content2 &lt;- LB.readFile \"part2\"\n    let v = runPar $ do a &lt;- spawnP $ computeVector content1\n                        b &lt;- spawnP $ computeVector content2\n                        vec1 &lt;- get a\n                        vec2 &lt;- get b\n                        -- combine vec1 and vec2\n                        let vec3 = ...vec1 + vec2...\n                        return vec3\n    ...\n</code></pre>\n\n<p>You should try this approach up and determine what the speedup is. If it looks good then we can figure out how to virtually split up a file into multiple parts without having to actually copy the data.</p>\n\n<p>Note - I haven't actually run this, so I don't know if there are quirks w.r.t. lazy-IO and the Par monad, but this idea in some form should work.</p>\n"}], "owner": {"reputation": 171, "user_id": 4100057, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c6c4f4371c79d73eec08feecd688fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Wang", "link": "https://stackoverflow.com/users/4100057/frank-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 31799184, "answer_count": 1, "score": 4, "last_activity_date": 1438709591, "creation_date": 1438642345, "last_edit_date": 1438709591, "question_id": 31798004, "link": "https://stackoverflow.com/questions/31798004/diagnosing-parallel-monad-performance", "title": "Diagnosing parallel monad performance", "body": "<p>I have written a Bytestring parser using the Attoparsec library:</p>\n\n<pre><code>import qualified Data.ByteString.Char8 as B\nimport qualified Data.Attoparsec.ByteString.Char8 as P\n\nparseComplex :: P.Parser Complex\n</code></pre>\n\n<p>My intention was to use this parse large (> 5 Gb) files so the implementation utilized this parser lazily:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy.Char8 as LB\nimport qualified Data.Attoparsec.ByteString.Lazy as LP\n\nextr :: LP.Result a -&gt; a\n\nmain = do\n    rawData &lt;- liftA LB.words (LB.readFile \"/mnt/hgfs/outputs/out.txt\")\n    let formatedData = map (extr.LP.parse parseComplex) rawData\n    ...\n</code></pre>\n\n<p>Executing this on a test file with <code>-O2</code> and <code>-s</code> flags, I see:</p>\n\n<pre><code> 3,509,019,048 bytes allocated in the heap\n     2,086,240 bytes copied during GC\n        58,256 bytes maximum residency (30 sample(s))\n       126,240 bytes maximum slop\n             2 MB total memory in use (0 MB lost due to fragmentation)\n\n                                  Tot time (elapsed)  Avg pause  Max pause\nGen  0      6737 colls,     0 par    0.03s    0.03s     0.0000s    0.0001s\nGen  1        30 colls,     0 par    0.00s    0.00s     0.0001s    0.0002s\n\nINIT    time    0.00s  (  0.00s elapsed)\nMUT     time    0.83s  (  0.83s elapsed)\nGC      time    0.04s  (  0.04s elapsed)\nEXIT    time    0.00s  (  0.00s elapsed)\nTotal   time    0.87s  (  0.86s elapsed)\n\n%GC     time       4.3%  (4.3% elapsed)\n\nAlloc rate    4,251,154,493 bytes per MUT second\n\nProductivity  95.6% of total user, 95.8% of total elapsed\n</code></pre>\n\n<p>Since I am mapping a function over a list independently, I thought this code would maybe benefit from parallelization. I had never done anything of the sort before in Haskell but messing around with the <code>Control.Monad.Par</code> library, I wrote a simple, naive, static paritioning function that I thought would map my parsing in parallel:</p>\n\n<pre><code>import Control.Monad.Par\n\nparseMap :: [LB.ByteString] -&gt; [Complex]\nparseMap x = runPar $ do\n    let (as, bs) = force $ splitAt (length x `div` 2) x\n    a &lt;- spawnP $ map (extr.LP.parse parseComplex) as \n    b &lt;- spawnP $ map (extr.LP.parse parseComplex) bs\n    c &lt;- get a\n    d &lt;- get b\n    return $ c ++ d\n</code></pre>\n\n<p>I was not expecting too much from this function, however performance with parallel was much worse that the sequential computation. Here is the main function and the results, compiled with <code>-O2 -threaded -rtsopts</code> and executed with <code>+RTS -s -N2</code>:</p>\n\n<pre><code>main = do\n    rawData &lt;- liftA LB.words (LB.readFile \"/mnt/hgfs/outputs/out.txt\")\n    let formatedData = parseMap rawData\n    ...\n</code></pre>\n\n<hr>\n\n<pre><code> 3,641,068,984 bytes allocated in the heap\n   356,490,472 bytes copied during GC\n    82,325,144 bytes maximum residency (10 sample(s))\n    14,182,712 bytes maximum slop\n           253 MB total memory in use (0 MB lost due to fragmentation)\n\n                                  Tot time (elapsed)  Avg pause  Max pause\nGen  0      4704 colls,  4704 par    0.50s    0.25s     0.0001s    0.0006s\nGen  1        10 colls,     9 par    0.57s    0.29s     0.0295s    0.1064s\n\nParallel GC work balance: 19.77% (serial 0%, perfect 100%)\n\nTASKS: 4 (1 bound, 3 peak workers (3 total), using -N2)\n\nSPARKS: 0 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)\n\nINIT    time    0.00s  (  0.00s elapsed)\nMUT     time    1.11s  (  0.72s elapsed)\nGC      time    1.07s  (  0.54s elapsed)\nEXIT    time    0.02s  (  0.02s elapsed)\nTotal   time    2.20s  (  1.28s elapsed)\n\nAlloc rate    3,278,811,516 bytes per MUT second\n\nProductivity  51.2% of total user, 88.4% of total elapsed\n\ngc_alloc_block_sync: 149514\nwhitehole_spin: 0\ngen[0].sync: 0\ngen[1].sync: 32\n</code></pre>\n\n<p>As you can see, there seems to be a lot of garbage collector activity in the parallel case and the loads are pretty poorly balanced. I profiled the execution using threadscope and got the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/j6uEP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j6uEP.png\" alt=\"enter image description here\"></a></p>\n\n<p>I can see very clearly garbage collector running on HEC 1 is interrupting the computation on HEC 2. Moreover, HEC 1 clearly has less work assigned than HEC 2. As a test, I attempted to adjust the relative size of the two split lists to re-balance the loads but I saw no perceivable difference in the behavior of the program after doing so. I've also attempted to run this on different sized inputs, with larger minimum heap allocations, and also just using the <code>parMap</code> function included in the <code>Control.Monad.Par</code> library but those efforts also had no effect on the outcome.</p>\n\n<p>I'm assuming that there is a space leak somewhere, maybe from the <code>let (as,bs) = ...</code> assignment, because memory usage is so much higher in the parallel case. Is this the problem? If so, how should I go about resolving it?</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> Splitting the input data manually as suggested, I am now seeing some small improvements in the timings. For a 6m point input file, I manually split the file into two 3m point files and into three 2m point files and reran the code using 2 and 3 cores respectively. Rough timings as follows:</p>\n\n<p>1 Core: 6.5s</p>\n\n<p>2 Core: 5.7s</p>\n\n<p>3 Core: 4.5s</p>\n\n<p>The new threadscope profile looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/boIMj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/boIMj.png\" alt=\"enter image description here\"></a></p>\n\n<p>The strange behavior towards the beginning is gone but now there is still some it looks to me like there are still some apparent load balancing issues.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 5, "creation_date": 1438642387, "post_id": 31797517, "comment_id": 51523634, "body": "Well this may or may not be helpful, but the PINNED data is most likely (the underlying storage of) ByteStrings."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1438643309, "post_id": 31797517, "comment_id": 51523846, "body": "@ReidBarton Interesting. The program is processing a file using ByteStrings. Are you aware of any way to confirm where the allocations are originating, or any ideas regarding how to allow/force deallocations of the instances?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1438643823, "post_id": 31797517, "comment_id": 51524003, "body": "I usually start by trying all the different <code>-hX</code> options. Probably you will see a large component in each one and can get different kinds of information about where those allocations are coming from."}], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 1, "answer_count": 0, "score": 8, "last_activity_date": 1438639376, "creation_date": 1438639376, "question_id": 31797517, "link": "https://stackoverflow.com/questions/31797517/how-can-i-trace-reduce-pinned-allocations", "title": "How can I trace/reduce &quot;PINNED&quot; allocations?", "body": "<p>I'm trying to figure out how to trace where/why the PINNED section is growing as displayed below. I'm assuming there is something permanently holding onto references but don't know how to go about affecting this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/oWaJO.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/oWaJO.png\" alt=\"RTS Output\"></a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438638338, "post_id": 31797195, "comment_id": 51522253, "body": "<a href=\"https://www.haskell.org/hoogle/?hoogle=sequence\" rel=\"nofollow noreferrer\"><b><code>sequence</code></b></a>?"}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438638902, "post_id": 31797195, "comment_id": 51522474, "body": "@recursion.ninja that&#39;s an excellent suggestion but unfortunately it doesn&#39;t appear to make a difference. Would you expect there to be instances of <code>sequence</code> having different results than <code>mapM</code>?"}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438638928, "post_id": 31797195, "comment_id": 51522488, "body": "I&#39;m formulating an answer now"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438641887, "post_id": 31797195, "comment_id": 51523485, "body": "Write <code>E</code> as an abbreviation for <code>Either String</code>, and <code>x</code> for <code>[STRef s Int -&gt; ST s Int]</code>. My guess is that <code>(&gt;&gt;=)</code> is being inferred to have type <code>forall s. E x -&gt; (x -&gt; E Int) -&gt; E Int</code>, when you wanted it to be inferred as having type <code>E (forall s. x) -&gt; ((forall s. x) -&gt; E Int) -&gt; E Int</code>. A similar type-variable scoping issue applies to the other combinators (<code>mapM</code>, <code>const</code>, <code>return</code>). Since this wanders into impredicative type territory, you&#39;re going to have a nasty time to get this working."}], "answers": [{"comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1438644172, "post_id": 31797966, "comment_id": 51524097, "body": "Thank you so much! I was hoping for this kind of explanation that I might develop a better intuition for the type checking process. I still need to read through this many more times but it has been extremely helpful!"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 10, "last_activity_date": 1438642124, "creation_date": 1438642124, "answer_id": 31797966, "question_id": 31797195, "link": "https://stackoverflow.com/questions/31797195/how-can-i-collect-a-list-of-st-actions-inside-either/31797966#31797966", "title": "How can I collect a list of ST actions inside Either?", "body": "<p>Type inference in the presence of higher-rank types is undecidable. GHC's type inference algorithm makes some simplifying assumptions, which render it incomplete. Those include:</p>\n\n<ul>\n<li><p>GHC will assume the variable bound by a lambda is a monotype (it does not contain (leading?) <code>forall</code>s)</p></li>\n<li><p>When you use a polymorphic function, GHC will assume that the free type variables in its type will be instantiated at monotypes</p></li>\n</ul>\n\n<p>Both of these assumptions can be overridden if you ask GHC politely to use a particular polytype instead.</p>\n\n<p>Now, how do you expect your program to type check?</p>\n\n<ul>\n<li>In order for <code>run fs</code> to type check, we had better have <code>fs :: forall s. [ST.STRef s Int -&gt; ST.ST s Int]</code></li>\n<li>So, according to the first point above we must write this type signature on the lambda that binds it: <code>\\(fs :: forall s. [ST.STRef s Int -&gt; ST.ST s Int]) -&gt; ...</code> (using <code>ScopedTypeVariables</code>)</li>\n<li><p>Now consider the use of <code>&gt;&gt;=</code>. Its type is <code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>. But, we need <code>a = forall s. [ST.STRef s Int -&gt; ST.ST s Int]</code>. So, according to the second point above we need to give this <code>&gt;&gt;=</code> a type signature, as in</p>\n\n<pre><code>... `op` (\\(fs :: forall s. [ST.STRef s Int -&gt; ST.ST s Int]) -&gt; ...)\n    where op :: Monad m\n             =&gt; m (forall s. [ST.STRef s Int -&gt; ST.ST s Int])\n             -&gt; ((forall s. [ST.STRef s Int -&gt; ST.ST s Int]) -&gt; m b)\n             -&gt; m b\n          op = (&gt;&gt;=)\n</code></pre></li>\n<li>Now we run into a new kind of problem. In this application of <code>op</code>, the first argument has type <code>Either String (forall s. [ST.STRef s Int -&gt; ST.ST s Int])</code>. Application of a type constructor (other than <code>(-&gt;)</code>) to a polytype is not allowed, unless you turn on the (broken) ImpredicativeTypes. However, we can turn it on and continue...</li>\n<li>Diving into the first argument, we can see that we will need <code>return :: Monad m =&gt; a -&gt; m a</code> instantiated at <code>a = forall s. ST.STRef s Int -&gt; ST.ST s Int</code>. So, we need to add another type signature to <code>return</code></li>\n<li>Similarly we will need <code>mapM :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]</code> instantiated at <code>b = forall s. ST.STRef s Int -&gt; ST.ST s Int</code></li>\n<li><p>If you are paying close attention you will notice yet another problem: the result of the <code>mapM</code> has type</p>\n\n<pre><code>Either String [forall s. ST.STRef s Int -&gt; ST.ST s Int]\n</code></pre>\n\n<p>but the argument of <code>(&gt;&gt;=)</code> needs to be of type</p>\n\n<pre><code>Either String (forall s. [ST.STRef s Int -&gt; ST.ST s Int])\n</code></pre>\n\n<p>and you will need to convert between these. In reality this is a no-op, but GHC is not smart enough to know it, so you will have to do a linear-time conversion, something like</p>\n\n<pre><code>liftM (\\x -&gt; map (\\(y :: forall s. ST.STRef s Int -&gt; ST.ST s Int) -&gt; y) x)\n</code></pre>\n\n<p>(except <code>liftM</code> will need yet another type signature)</p></li>\n</ul>\n\n<p>Moral of the story: You can do this, but you shouldn't.</p>\n\n<p>You will generally have an easier time if you hide your <code>forall</code>s inside newtypes like</p>\n\n<pre><code>newtype S s = S { unS :: forall s. ST.STRef s Int -&gt; ST.ST s Int }\n</code></pre>\n\n<p>which makes the points where polymorphism is introduced more explicit in your program (via occurrences of <code>S</code> and <code>unS</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1438643764, "post_id": 31797970, "comment_id": 51523986, "body": "Fascinating! I have so much to learn. I am curious since you mentioned <code>ImpredicativeTypes</code> how it would be solvable using that extension? I had actually experimented with turning that on, but was unable to determine the correct incantation."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1438683243, "post_id": 31797970, "comment_id": 51538822, "body": "You probably mean a <i>universal</i>, not an <i>existential</i> quantification here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 1, "creation_date": 1438683673, "post_id": 31797970, "comment_id": 51539092, "body": "@ZJM Impredicative types basically allow to construct types for the form <code>T (forall a. ...)</code> such as your <code>[forall s. ...]</code>, without resorting to a newtype and <code>[STFunc]</code> as above. However, they tend to require type annotations in many inconvenient places."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1438684226, "post_id": 31797970, "comment_id": 51539463, "body": "@ZJM A possible working incantation is <code>type STFunc = forall s. ST.STRef s Int -&gt; ST.ST s Int</code> and then <code>test = mapM (const ((return :: STFunc -&gt; Either String STFunc) action )) [0..5] &gt;&gt;= \\fs -&gt; return (run fs)</code>. You&#39;ll have to adapt the rest as well, but it should be straightforward to remove the newtype and use the type synonym instead. Anyway, I&#39;d not recommend impredicative types, but feel free to play around with them."}], "tags": [], "owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "is_accepted": false, "score": 6, "last_activity_date": 1438642152, "creation_date": 1438642152, "answer_id": 31797970, "question_id": 31797195, "link": "https://stackoverflow.com/questions/31797195/how-can-i-collect-a-list-of-st-actions-inside-either/31797970#31797970", "title": "How can I collect a list of ST actions inside Either?", "body": "<p>You need to wrap the functions in a <code>newtype</code> to preserve the existential quantification without having to use <code>ImpredicativeTypes</code>.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nimport qualified Data.STRef as ST\nimport qualified Control.Monad.ST as ST\n\nnewtype STFunc = STFunc (forall s. ST.STRef s Int -&gt; ST.ST s Int)\n\nrun :: [STFunc] -&gt; Int\nrun fs = ST.runST $ do\n    x &lt;- ST.newSTRef 0\n    mapM_ (\\(STFunc f) -&gt;\n        f x &gt;&gt;= ST.writeSTRef x\n      ) fs\n    ST.readSTRef x\n\naction :: STFunc\naction = STFunc $ \\x -&gt; ST.readSTRef x &gt;&gt;= \\y -&gt; return (y + 1)\n\ntest :: Either String Int\ntest = mapM (const (return action)) [0..5] &gt;&gt;= \\fs -&gt; return (run fs)\n\nmain = print test\n</code></pre>\n"}], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 2, "accepted_answer_id": 31797966, "answer_count": 2, "score": 6, "last_activity_date": 1438642152, "creation_date": 1438637962, "question_id": 31797195, "link": "https://stackoverflow.com/questions/31797195/how-can-i-collect-a-list-of-st-actions-inside-either", "title": "How can I collect a list of ST actions inside Either?", "body": "<p>How can I go about converting an <code>[Either ST]</code> to an <code>Either [ST]</code> and subsequently run the actions sequentially? The below code appears to work for running a list of ST actions, however when trying to generate the list of actions in Either (swapping the <code>test</code> definitions below) the types no longer line up. I would have expected the types of the lists to be identical so I would greatly appreciate any explanation of the differences.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nimport qualified Data.STRef as ST\nimport qualified Control.Monad.ST as ST\n\nrun :: (forall s. [ST.STRef s Int -&gt; ST.ST s Int]) -&gt; Int\nrun fs =\n  ST.runST $ do\n    x &lt;- ST.newSTRef 0\n    mapM_ (\\f -&gt;\n        f x &gt;&gt;= ST.writeSTRef x\n      ) fs\n    ST.readSTRef x\n\naction :: ST.STRef s Int -&gt; ST.ST s Int\naction = \\x -&gt; ST.readSTRef x &gt;&gt;= \\y -&gt; return (y + 1)\n\n-- test :: Either String Int\n-- test = mapM (const (return action)) [0..5] &gt;&gt;= \\fs -&gt; return (run fs)\n\ntest :: Int\ntest = run (map (const action) [0..5])\n\nmain = print test\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 1, "creation_date": 1438628784, "post_id": 31794836, "comment_id": 51517593, "body": "What error do you get?"}, {"owner": {"reputation": 750, "user_id": 2800956, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c2a7ae163094ac55b3536697b1f0814a?s=128&d=identicon&r=PG", "display_name": "ffuentes", "link": "https://stackoverflow.com/users/2800956/ffuentes"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1438629251, "post_id": 31794836, "comment_id": 51517841, "body": "Prelude&gt; :r [1 of 1] Compiling Main             ( haskell.hs, interpreted )  haskell.hs:207:48:     Couldn&#39;t match expected type <code>[Char]&#39; with actual type </code>IO ()     In the second argument of <code>(++)&#39;, namely </code>randomNum&#39;     In the second argument of <code>hPutStrLn&#39;, namely       </code>(&quot;Random number &quot; ++ randomNum)&#39; Failed, modules loaded: none."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1438631373, "post_id": 31794836, "comment_id": 51518918, "body": "if all you want is one value, you can just write <code>val &lt;- randomIO :: IO Int</code>, or <code>val &lt;- randomRIO (1::Int, 10)</code> to get it in a specific range (here, from 1 to 10, inclusive)."}], "answers": [{"comments": [{"owner": {"reputation": 750, "user_id": 2800956, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c2a7ae163094ac55b3536697b1f0814a?s=128&d=identicon&r=PG", "display_name": "ffuentes", "link": "https://stackoverflow.com/users/2800956/ffuentes"}, "edited": false, "score": 0, "creation_date": 1438629145, "post_id": 31794909, "comment_id": 51517789, "body": "I tried it and I get &quot;Couldn&#39;t match type IO () with IO () -&gt; Int"}, {"owner": {"reputation": 750, "user_id": 2800956, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c2a7ae163094ac55b3536697b1f0814a?s=128&d=identicon&r=PG", "display_name": "ffuentes", "link": "https://stackoverflow.com/users/2800956/ffuentes"}, "edited": false, "score": 0, "creation_date": 1438629793, "post_id": 31794909, "comment_id": 51518080, "body": "It gives me an error but it&#39;s too long for a comment."}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 1, "creation_date": 1438630137, "post_id": 31794909, "comment_id": 51518267, "body": "I&#39;m pretty sure you want <code>show val</code> not <code>show randomNum</code>. Functions usually don&#39;t show very well..."}, {"owner": {"reputation": 750, "user_id": 2800956, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c2a7ae163094ac55b3536697b1f0814a?s=128&d=identicon&r=PG", "display_name": "ffuentes", "link": "https://stackoverflow.com/users/2800956/ffuentes"}, "edited": false, "score": 0, "creation_date": 1438630434, "post_id": 31794909, "comment_id": 51518424, "body": "When using this solution the error is Prelude&gt; :r [1 of 1] Compiling Main             ( haskell.hs, interpreted )  haskell.hs:207:44:     No instance for (Show (IO Int)) arising from a use of <code>show&#39;     In the second argument of </code>(++)&#39;, namely <code>show randomNum&#39;     In the second argument of </code>hPutStrLn&#39;, namely       `(&quot;Random number &quot; ++ show randomNum)&#39;     In a stmt of a &#39;do&#39; block:       hPutStrLn theFile (&quot;Random number &quot; ++ show randomNum) Failed, modules loaded: none. Prelude&gt;"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "reply_to_user": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438630949, "post_id": 31794909, "comment_id": 51518715, "body": "That wwas fixed by @recursion.ninja&#39;s edit; it&#39;s <code>show val</code>, not <code>show randomNum</code>."}], "tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": false, "score": 4, "last_activity_date": 1438630195, "last_edit_date": 1438630195, "creation_date": 1438628831, "answer_id": 31794909, "question_id": 31794836, "link": "https://stackoverflow.com/questions/31794836/how-to-use-a-value-produced-in-another-do-block/31794909#31794909", "title": "How to use a value produced in another do block?", "body": "<p>It looks like what you need is</p>\n\n<pre><code>randomNum = do\n   gen &lt;- newStdGen\n   return (head (randoms gen :: [Int]))\n\nwriteToFile = do\n    theFile &lt;- openFile \"test.txt\" WriteMode\n    val &lt;- randomNum\n    hPutStrLn theFile (\"Random number \" ++ show val)\n    hClose theFile\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 827, "user_id": 1625415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b834badf82641e9381e139bb4228b92f?s=128&d=identicon&r=PG", "display_name": "Alden", "link": "https://stackoverflow.com/users/1625415/alden"}, "is_accepted": true, "score": 1, "last_activity_date": 1438630089, "last_edit_date": 1495541641, "creation_date": 1438629646, "answer_id": 31795140, "question_id": 31794836, "link": "https://stackoverflow.com/questions/31794836/how-to-use-a-value-produced-in-another-do-block/31795140#31795140", "title": "How to use a value produced in another do block?", "body": "<p>You could try this instead:</p>\n\n<pre><code>import System.Random\nimport System.IO\n\nwriteToFile = do\n    gen &lt;- newStdGen\n    let ns = randoms gen :: [Int]\n    let val = head ns;\n    theFile &lt;- openFile \"test.txt\" WriteMode\n    hPutStrLn theFile (\"Random number \" ++ show val)\n    hClose theFile\n\nreadFromFile = do \n    theFile2 &lt;- openFile  \"test.txt\" ReadMode\n    contents &lt;- hGetContents theFile2\n    putStr contents\n    hClose theFile2\n</code></pre>\n\n<p>One problem was that the <code>do</code> block in your <code>randomNum</code> did not return a value; rather, it performed the action you told it to do: print a random number. As an alternative, see <a href=\"https://stackoverflow.com/questions/31794909/edit\">Louis Wasserman's answer</a> for a way to make randomNum actually return a value. In this answer's code, the random number generation was just moved into writeToFile.</p>\n\n<p>Also notice that I shortened the code to get one random value: <code>ns</code> is already a list, so you can take its <code>head</code> right away. The <code>take 10</code> was redundant.</p>\n\n<p>Finally, <code>val</code> was an Int, which cannot be concatenated directly onto a string. Using <code>show val</code> converts it to a string which can be concatenated with <code>\"Random number \"</code></p>\n"}], "owner": {"reputation": 750, "user_id": 2800956, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c2a7ae163094ac55b3536697b1f0814a?s=128&d=identicon&r=PG", "display_name": "ffuentes", "link": "https://stackoverflow.com/users/2800956/ffuentes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 31795140, "answer_count": 2, "score": 0, "last_activity_date": 1438630730, "creation_date": 1438628543, "last_edit_date": 1438630730, "question_id": 31794836, "link": "https://stackoverflow.com/questions/31794836/how-to-use-a-value-produced-in-another-do-block", "title": "How to use a value produced in another do block?", "body": "<p>I just watched a video on Haskell so I tried to play a little bit with it but I can't get to understand this (In short I want to print one random value):</p>\n\n<pre><code>import System.Random\nimport System.IO\n\nrandomNum = do\n   gen &lt;- newStdGen\n   let ns = randoms gen :: [Int]\n   let val = take 10 ns \n   print $ head val\n\nwriteToFile = do\n    theFile &lt;- openFile \"test.txt\" WriteMode\n    let val = randomNum;\n    hPutStrLn theFile (\"Random number \" ++ randomNum)\n    hClose theFile\n\nreadFromFile = do \n    theFile2 &lt;- openFile  \"test.txt\" ReadMode\n    contents &lt;- hGetContents theFile2\n    putStr contents\n    hClose theFile2\n</code></pre>\n\n<p>The randomNum seems to work fine but when I try to put that on writeToFile it triggers an error. What can I do?</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT: The error I get in the beginning is:</p>\n\n<pre><code>Prelude&gt; :r\n[1 of 1] Compiling Main             ( haskell.hs, interpreted )\n\nhaskell.hs:207:48:\n    No instance for (Show (IO ())) arising from a use of `show'\n    In the second argument of `(++)', namely `show randomNum'\n    In the second argument of `hPutStrLn', namely\n      `(\"Random number \" ++ show randomNum)'\n    In a stmt of a 'do' block:\n      hPutStrLn theFile (\"Random number \" ++ show randomNum)\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell", "glade", "gtk2hs"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1438676257, "post_id": 31794219, "comment_id": 51534323, "body": "It looks like you&#39;re trying to compile against the wrong version of something. You say Cabal &quot;could not resolve dependencies&quot;; can you be a bit more specific? What is it complaining about?"}, {"owner": {"reputation": 401, "user_id": 4868124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86dc340359160250de50ea4860cb9931?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chav", "link": "https://stackoverflow.com/users/4868124/michael-chav"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1438804927, "post_id": 31794219, "comment_id": 51605042, "body": "When I try and install Glade it tries to use older versions of Cairo and GTK. When I try and install those versions of the packages it refuses."}], "owner": {"reputation": 401, "user_id": 4868124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86dc340359160250de50ea4860cb9931?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chav", "link": "https://stackoverflow.com/users/4868124/michael-chav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1438626332, "creation_date": 1438626332, "question_id": 31794219, "link": "https://stackoverflow.com/questions/31794219/install-glade-for-windows-through-unpack", "title": "Install glade for windows through unpack", "body": "<p>I'm trying to install glade for my GTK Haskell binding. The cabal install fails to resolve dependencies and trying to install the unpacked version gives me this error: </p>\n\n<pre><code>SetupWrapper.hs:118:28: Warning:\n    In the use of `configCompiler'\n    (imported from Distribution.Simple.Configure):\n    Deprecated: \"'configCompiler' is deprecated. Use 'configCompilerEx' instead.\"\n[1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist\\setup-wrapper\\Gtk2HsSetup.o )\n\nGtk2HsSetup.hs:161:28:\n    Couldn't match expected type `IO\n                                    (Distribution.InstalledPackageInfo.InstalledPackageInfo_\n                                       ModuleName)'\n                with actual type `FilePath\n                                  -&gt; PackageDB\n                                  -&gt; IO Distribution.InstalledPackageInfo.InstalledPackageInfo'\n    Probable cause: `generateRegistrationInfo' is applied to too few arguments\n    In a stmt of a 'do' block:\n      installedPkgInfoRaw &lt;- generateRegistrationInfo\n                               verbosity pkg lib lbi clbi inplace distPref\n    In the expression:\n      do { installedPkgInfoRaw &lt;- generateRegistrationInfo\n                                    verbosity pkg lib lbi clbi inplace distPref;\n           dllsInScope &lt;- getSearchPath &gt;&gt;= (filterM doesDirectoryExist)\n                          &gt;&gt;= getDlls;\n           let libs = fixLibs dllsInScope (extraLibraries installedPkgInfoRaw)\n               installedPkgInfo = ...;\n           case () of {\n             _ | modeGenerateRegFile -&gt; die \"Generate Reg File not supported\"\n               | modeGenerateRegScript -&gt; die \"Generate Reg Script not supported\"\n               | otherwise\n               -&gt; registerPackage\n                    verbosity installedPkgInfo pkg lbi inplace packageDbs } }\n\nGtk2HsSetup.hs:162:63:\n    Couldn't match type `[Char]' with `Bool'\n    Expected type: Bool\n      Actual type: FilePath\n    In the 7th argument of `generateRegistrationInfo', namely\n      `distPref'\n    In a stmt of a 'do' block:\n      installedPkgInfoRaw &lt;- generateRegistrationInfo\n                               verbosity pkg lib lbi clbi inplace distPref\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "strictness"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1438613533, "post_id": 31790327, "comment_id": 51508956, "body": "Good question, though in doubt it&#39;s probably best not to use BangPatterns at all but good old <code>seq</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1438657696, "post_id": 31792370, "comment_id": 51527105, "body": "Actually <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/bang-patterns.html#bang-patterns-sem\" rel=\"nofollow noreferrer\">the relevant section of the User&#39;s Guide</a> is so old that it links to the <i>Haskell 98</i> report, and the BNF grammar at that time treated precedence differently. <a href=\"https://www.haskell.org/onlinereport/exps.html#sect3.17.1\" rel=\"nofollow noreferrer\">For patterns in particular</a>, adding <code>pat  ::= !pat</code> means to add it at the <i>lowest precedence</i>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1438658096, "post_id": 31792370, "comment_id": 51527184, "body": "Although disturbingly, by this reading <code>(! ! x)</code> <i>should</i> work but doesn&#39;t."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1438701107, "post_id": 31792370, "comment_id": 51551378, "body": "@&#216;rjanJohansen, oh good point. I didn&#39;t try following the links to the Report since I already had the 2010 Report open in another tab. That does make the description closer to reality, though as you say still not quite the same."}, {"owner": {"reputation": 1375, "user_id": 420038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e486867defc84340f1837639ca54ee?s=128&d=identicon&r=PG", "display_name": "thomie", "link": "https://stackoverflow.com/users/420038/thomie"}, "edited": false, "score": 0, "creation_date": 1450047812, "post_id": 31792370, "comment_id": 56256597, "body": "See also <a href=\"https://ghc.haskell.org/trac/ghc/ticket/1087\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/1087</a> and <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10732\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/10732</a>."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 6, "last_activity_date": 1438619458, "creation_date": 1438619458, "answer_id": 31792370, "question_id": 31790327, "link": "https://stackoverflow.com/questions/31790327/where-can-bangpatterns-appear/31792370#31792370", "title": "Where can BangPatterns appear", "body": "<p>There is no accepted formal specification for BangPatterns since they are not a part of any Haskell Report. The closest thing we have to a specification is the User's Guide along with the haskell-prime proposal it links to.</p>\n\n<p>Both of those sources explicitly mention that a bang pattern is not allowed at the top level of a module.</p>\n\n<p>As for <code>x : !xs</code>, the User's Guide has this to say about the syntax of bang patterns:</p>\n\n<blockquote>\n  <p>We add a single new production to the syntax of patterns: </p>\n\n<pre><code>pat  ::= !pat\n</code></pre>\n</blockquote>\n\n<p>It should be read in conjunction with the Haskell 2010 Report:</p>\n\n<blockquote>\n<pre><code>pat  ::= lpat qconop pat\n       | lpat\n\nlpat ::= apat\n       | - (integer | float)\n       | gcon apat_1 ... apat_k\n\napat ::= var [ @ apat]\n       | ...\n       | ( pat )\n       | ...\n</code></pre>\n</blockquote>\n\n<p>According to these rules <code>x : !xs</code> actually should parse (since <code>!xs</code> is a <code>pat</code>, the whole thing is <code>lpat qconop pat</code>). So either the User's Guide (and the haskell-prime proposal) is wrong or GHC is wrong on this point.</p>\n\n<p>I believe that in practice the syntax accepted by GHC is \"anything that looks like a valid expression\" including interpreting <code>(!x)</code> as a section of the operator <code>!</code>. For example <code>(! Just x)</code> is accepted as a pattern but <code>(! ! x)</code> is not.</p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 31792370, "answer_count": 1, "score": 11, "last_activity_date": 1438619458, "creation_date": 1438613201, "last_edit_date": 1438615781, "question_id": 31790327, "link": "https://stackoverflow.com/questions/31790327/where-can-bangpatterns-appear", "title": "Where can BangPatterns appear", "body": "<p>From <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/bang-patterns.html\">GHC user guide</a> it seems like most <code>Pat</code> can be <code>PBangPat</code>, but there are a few exceptions. e.g. top-level bangs in a module (like <code>!main</code>) aren't allowed <s>and <code>x : !xs</code> fails to parse</s> <code>x : (!xs) parses</code> thanks @chi. What is the formal specification about where the bangs can be added? I've looked into some chapters of the user guide and the Report but found nothing. </p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 3291, "user_id": 1456761, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/gvNnG.png?s=128&g=1", "display_name": "Tobias Brandt", "link": "https://stackoverflow.com/users/1456761/tobias-brandt"}, "edited": false, "score": 2, "creation_date": 1438611798, "post_id": 31789654, "comment_id": 51507792, "body": "That&#39;s a list, not an array."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1438616082, "post_id": 31789654, "comment_id": 51510609, "body": "BTW, &quot;initialize&quot;/&quot;init&quot; is probably not the best word. Once a variable is defined as some value, it&#39;s not going to change its value in pure functional programming. Indeed, I&#39;d use &quot;define&quot; instead."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 1, "creation_date": 1438619862, "post_id": 31789654, "comment_id": 51512951, "body": "I agree with chi. At first I thought you referred to what the operation <code>init</code> (the function) does."}], "answers": [{"tags": [], "owner": {"reputation": 6093, "user_id": 4293020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/352ea26cb808b26c421ab55184231322?s=128&d=identicon&r=PG", "display_name": "Simon Gibbons", "link": "https://stackoverflow.com/users/4293020/simon-gibbons"}, "is_accepted": true, "score": 7, "last_activity_date": 1438612194, "last_edit_date": 1438612194, "creation_date": 1438611628, "answer_id": 31789739, "question_id": 31789654, "link": "https://stackoverflow.com/questions/31789654/easy-way-to-init-a-boolean-list-in-haskell/31789739#31789739", "title": "Easy way to init a boolean List in Haskell", "body": "<p>The answer depends on what you want to initialise it with, if it is just a list of all of the same value then you could just use <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:replicate\"><code>replicate</code></a></p>\n\n<pre><code>replicate 5 True -- [True,True,True,True,True]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "is_accepted": false, "score": 6, "last_activity_date": 1438615797, "last_edit_date": 1438615797, "creation_date": 1438611907, "answer_id": 31789852, "question_id": 31789654, "link": "https://stackoverflow.com/questions/31789654/easy-way-to-init-a-boolean-list-in-haskell/31789852#31789852", "title": "Easy way to init a boolean List in Haskell", "body": "<p>As well as this solution proposed by Simon Gibbons, for a fixed size array where all elements are identical</p>\n\n<pre><code>replicate 5 True       -- [True,True,True,True,True]\n</code></pre>\n\n<p>you can also make use of list comprehensions to define more complex lists, for example to get an alternating <code>False</code>/<code>True</code> list you could do</p>\n\n<pre><code>[even x | x &lt;- [1..6]] -- [False,True,False,True,False,True]\n</code></pre>\n"}], "owner": {"reputation": 1125, "user_id": 777085, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5112855aef89ec6bf599252fbae5eca7?s=128&d=identicon&r=PG", "display_name": "xcoder", "link": "https://stackoverflow.com/users/777085/xcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 0, "accepted_answer_id": 31789739, "answer_count": 2, "score": 0, "last_activity_date": 1438615797, "creation_date": 1438611406, "last_edit_date": 1438612968, "question_id": 31789654, "link": "https://stackoverflow.com/questions/31789654/easy-way-to-init-a-boolean-list-in-haskell", "title": "Easy way to init a boolean List in Haskell", "body": "<p>I realized that there is an easy way to init an integer array by using range(), or even just by saying e.g. [1..10].</p>\n\n<p>Is there an easy way to init a <code>[Bool]</code> as well? (given that I know the size of the array beforehand). -- By easy I mean without defining a function just to do the init...</p>\n"}, {"tags": ["haskell", "syntax", "type-level-computation"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 3320256, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NZCl4.png?s=128&g=1", "display_name": "daniel.kahlenberg", "link": "https://stackoverflow.com/users/3320256/daniel-kahlenberg"}, "edited": false, "score": 0, "creation_date": 1438606305, "post_id": 31787236, "comment_id": 51503928, "body": "perfect (for ghci I needed <code>:set -XDataKinds -XTypeOperators -XKindSignatures -XGADTs</code>)."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 9, "last_activity_date": 1438658735, "last_edit_date": 1438658735, "creation_date": 1438604774, "answer_id": 31787236, "question_id": 31786828, "link": "https://stackoverflow.com/questions/31786828/what-is-this-haskell-syntax-type-level-operators/31787236#31787236", "title": "What is this Haskell Syntax (type level operators?)", "body": "<p>From the Haskell user guide section on <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/promotion.html\" rel=\"nofollow\">Promoted list and tuple lists</a>:</p>\n\n<blockquote>\n  <p>With -XDataKinds, Haskell's list and tuple types are natively promoted\n  to kinds, and enjoy the same convenient syntax at the type level,\n  albeit prefixed with a quote: </p>\n\n<pre><code>data HList :: [*] -&gt; * where\n  HNil  :: HList '[]\n  HCons :: a -&gt; HList t -&gt; HList (a ': t)\n\ndata Tuple :: (*,*) -&gt; * where\n  Tuple :: a -&gt; b -&gt; Tuple '(a,b)\n\nfoo0 :: HList '[]\nfoo0 = HNil\n\nfoo1 :: HList '[Int]\nfoo1 = HCons (3::Int) HNil\n\nfoo2 :: HList [Int, Bool]\nfoo2 = ...\n</code></pre>\n  \n  <p>(Note: the declaration for HCons also requires -XTypeOperators because\n  of infix type operator (:').) For type-level lists of two or more\n  elements, such as the signature of foo2 above, the quote may be\n  omitted because the meaning is unambiguous. But for lists of one or\n  zero elements (as in foo0 and foo1), the quote is required, because\n  the types [] and [Int] have existing meanings in Haskell.</p>\n</blockquote>\n\n<p>So basically it is the same syntax prefixed with a single quote but which operates at kind level. Some playup using <code>ghci</code> with the above code:</p>\n\n<pre><code>\u03bb&gt; :t HNil\nHNil :: HList '[]\n\u03bb&gt; :t HCons\nHCons :: a -&gt; HList t -&gt; HList (a : t)\n\u03bb&gt; let x = 3 `HCons` HNil\n\u03bb&gt; :t x\nx :: Num a =&gt; HList '[a]\n\u03bb&gt; let x = Tuple 3 \"spj\"\n\u03bb&gt; :t x\nx :: Num a =&gt; Tuple '(a, [Char])\n</code></pre>\n"}], "owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 1, "accepted_answer_id": 31787236, "answer_count": 1, "score": 8, "last_activity_date": 1438658735, "creation_date": 1438603547, "last_edit_date": 1438604170, "question_id": 31786828, "link": "https://stackoverflow.com/questions/31786828/what-is-this-haskell-syntax-type-level-operators", "title": "What is this Haskell Syntax (type level operators?)", "body": "<p>What does <code>'[]</code> or <code>':</code> signify in Haskell code? Some examples -</p>\n\n<p><a href=\"https://groups.google.com/forum/#!msg/haskell-cafe/2KS4yxtCr2o/OXSddmQPo3MJ\"><strong>Example 1:</strong></a></p>\n\n<pre><code>data OrderPacket replies where\n  NoOrders :: OrderPacket '[]\n</code></pre>\n\n<p><a href=\"https://github.com/goldfirere/glambda/blob/master/src/Language/Glambda/Exp.hs#L33\"><strong>Example 2:</strong></a> </p>\n\n<pre><code>data Elem :: [a] -&gt; a -&gt; * where\n  EZ :: Elem (x ': xs) x\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "cabal", "yesod"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438603396, "post_id": 31786640, "comment_id": 51502014, "body": "have you tried to recompile the yesod-bins? Most likely quite a few packages are broken and I would recommend recompiling them all after an update"}, {"owner": {"reputation": 2527, "user_id": 1396134, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85ae7e9104d0484386cbb4ac7791ad8f?s=128&d=identicon&r=PG", "display_name": "raichoo", "link": "https://stackoverflow.com/users/1396134/raichoo"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438603850, "post_id": 31786640, "comment_id": 51502300, "body": "Yep, recompiled them right away. I&#39;m using <code>cabal build</code> and <code>cabal run</code> now to work around the issue."}, {"owner": {"reputation": 188, "user_id": 1690291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QU6tb.jpg?s=128&g=1", "display_name": "Clay Thomas", "link": "https://stackoverflow.com/users/1690291/clay-thomas"}, "edited": false, "score": 2, "creation_date": 1438609032, "post_id": 31786640, "comment_id": 51505813, "body": "You could try <a href=\"https://www.fpcomplete.com/blog/2015/06/announcing-first-public-beta-stack\" rel=\"nofollow noreferrer\">stack</a>. Might take care of stuff automatically."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438633165, "post_id": 31786640, "comment_id": 51519820, "body": "Which operating system?"}, {"owner": {"reputation": 2527, "user_id": 1396134, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85ae7e9104d0484386cbb4ac7791ad8f?s=128&d=identicon&r=PG", "display_name": "raichoo", "link": "https://stackoverflow.com/users/1396134/raichoo"}, "edited": false, "score": 0, "creation_date": 1438638354, "post_id": 31786640, "comment_id": 51522261, "body": "I&#39;m running Archlinux."}], "answers": [{"tags": [], "owner": {"reputation": 2527, "user_id": 1396134, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85ae7e9104d0484386cbb4ac7791ad8f?s=128&d=identicon&r=PG", "display_name": "raichoo", "link": "https://stackoverflow.com/users/1396134/raichoo"}, "is_accepted": true, "score": 0, "last_activity_date": 1440502694, "creation_date": 1440502694, "answer_id": 32202999, "question_id": 31786640, "link": "https://stackoverflow.com/questions/31786640/yesod-devel-does-not-work-anymore-after-upgrading-to-ghc-7-10-2/32202999#32202999", "title": "yesod devel does not work anymore after upgrading to GHC 7.10.2", "body": "<p>Updating to the latest version of <code>yesod-bin</code> (currently: <code>1.4.14</code>) fixed the issue for me.</p>\n"}], "owner": {"reputation": 2527, "user_id": 1396134, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85ae7e9104d0484386cbb4ac7791ad8f?s=128&d=identicon&r=PG", "display_name": "raichoo", "link": "https://stackoverflow.com/users/1396134/raichoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 32202999, "answer_count": 1, "score": 2, "last_activity_date": 1440502694, "creation_date": 1438603007, "last_edit_date": 1438621692, "question_id": 31786640, "link": "https://stackoverflow.com/questions/31786640/yesod-devel-does-not-work-anymore-after-upgrading-to-ghc-7-10-2", "title": "yesod devel does not work anymore after upgrading to GHC 7.10.2", "body": "<p>I've upgraded to <code>ghc 7.10.2</code> this morning. After doing that <code>yesod devel</code> does not seem to recompile the project properly since I cannot see any changes I'm making to the code, even though it seems to recompile some sources. I can only see the changes I've made after doing a <code>cabal install</code> (cabal-version is 1.22.6.0) which takes quite a lot of time.</p>\n\n<p>How can I restore <code>yesod devel</code> to it's former functionality with <code>ghc 7.10.2</code>?</p>\n"}, {"tags": ["eclipse", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1438587260, "post_id": 31781280, "comment_id": 51492880, "body": "Also you should know that  <a href=\"http://jpmoresmau.blogspot.in/2015/05/eclipsefp-end-of-life-from-me-at-least.html\" rel=\"nofollow noreferrer\">EcliseFP is no longer supported.</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1438587422, "post_id": 31781280, "comment_id": 51492964, "body": "I can&#39;t help you with EclipseFP. If you are beginning to learn Haskell, however, I sense it will only be an extra complication. Just start coding on your favourite text editor (vim, Emacs, or anything else with sensible features for writing code) while keeping GHCi open so that you can test things quickly."}, {"owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1438591639, "post_id": 31781280, "comment_id": 51495284, "body": "Also if you really want a help with <code>EclipseFP</code>, you should talk with maintainer / author or create an issue in <a href=\"https://github.com/JPMoresmau/eclipsefp\" rel=\"nofollow noreferrer\">github</a>."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1438597603, "post_id": 31781280, "comment_id": 51498737, "body": "Just install the <a href=\"https://www.haskell.org/downloads\" rel=\"nofollow noreferrer\">Haskell Platform</a> and read <a href=\"https://wiki.haskell.org/Haskell_in_5_steps\" rel=\"nofollow noreferrer\">Haskell in 5 Steps</a> for a quick intro on using ghci and compiling programs."}], "owner": {"reputation": 119, "user_id": 5051282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fcb6f91dc0e688514b1545d70713d19?s=128&d=identicon&r=PG&f=1", "display_name": "oliverjones", "link": "https://stackoverflow.com/users/5051282/oliverjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 719, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1438585526, "creation_date": 1438585526, "question_id": 31781280, "link": "https://stackoverflow.com/questions/31781280/eclipsefp-for-haskell-not-working", "title": "EclipseFP for Haskell not working", "body": "<p>I've installed the EclipseFP plugin so I can work with Haskell in Eclipse. I am running Eclipse on my Mac. I have the most recent JRE, found somewhere that that may be the issue. The plugin is not in Windows --> Open Perspective --> Other which is where is should be. I am using Eclipse Luna.</p>\n\n<p>I am relatively new and would like to learn haskell</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 8, "creation_date": 1438557166, "post_id": 31777477, "comment_id": 51485192, "body": "It terminates when <code>unfoldF</code> returns an empty list, i.e. when <code>g x</code> returns an empty list."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 12, "creation_date": 1438563782, "post_id": 31777477, "comment_id": 51486417, "body": "There is no reason why they should terminate. What&#39;s important is that they are <i>productive</i>. They support pattern matching on the rose tree, in that whenever the node structure is demanded, it&#39;s delivered. It may happen not to be the case that on every path through the tree, a node with an empty list of subtrees is eventually found. Infinite growth is possible. Haskell identifies inductive (all paths necessarily finite) and coinductive (some paths possibly infinite) structures: unfolding is the way to generate coinductive structures. How does it work? Ask rather when does it work? On demand."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1438612610, "post_id": 31777477, "comment_id": 51508371, "body": "Substituting one into the other gives <code>unfoldR f g x = Node (f x) (mapL (unfoldR f g) (g x))</code> which reduces <code>unfoldR</code> to a regular recursive function, rather than mutually recursive with <code>unfoldF</code>. As @user5402 says, when <code>g x</code> returns an empty list, <code>unfoldF</code> is mapped across an empty list resulting in zero recursive calls."}], "answers": [{"comments": [{"owner": {"reputation": 913, "user_id": 2549013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2ab92d7bdb4f64f83b35232e35d42cc?s=128&d=identicon&r=PG", "display_name": "egerhard", "link": "https://stackoverflow.com/users/2549013/egerhard"}, "edited": false, "score": 1, "creation_date": 1438898357, "post_id": 31790521, "comment_id": 51652224, "body": "Thanks, that makes sense.  This function will almost always be infinite and works with Haskell because it will be evaluated in a lazily and not lock or stack overflow the program.  Out of curiosity, do you know if unfoldR can generate any possible rose tree or can it only generate a subset of possible rose trees?"}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "reply_to_user": {"reputation": 913, "user_id": 2549013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2ab92d7bdb4f64f83b35232e35d42cc?s=128&d=identicon&r=PG", "display_name": "egerhard", "link": "https://stackoverflow.com/users/2549013/egerhard"}, "edited": false, "score": 2, "creation_date": 1438952581, "post_id": 31790521, "comment_id": 51674375, "body": "@egerhard For a given parameter type <code>\u03b1</code>, it is <i>possible</i>  depending on the definitions of <code>f</code>, <code>h</code>, and <code>x</code> that the Rose Tree generated by <code>unfoldR f h x</code> contains within it&#39;s branches all possible Rose Trees as subtrees. To be certain of this, a mathematical proof would be in order."}, {"owner": {"reputation": 51, "user_id": 10731068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6b2052a55879dc77fdb0f274643190?s=128&d=identicon&r=PG&f=1", "display_name": "user820789", "link": "https://stackoverflow.com/users/10731068/user820789"}, "edited": false, "score": 0, "creation_date": 1543655115, "post_id": 31790521, "comment_id": 94003485, "body": "@recursion.ninja Could you elaborate on the mathematical proof? (Either yourself &amp;/or w/ a reference)"}], "tags": [], "owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "is_accepted": true, "score": 2, "last_activity_date": 1438615135, "last_edit_date": 1438615135, "creation_date": 1438613811, "answer_id": 31790521, "question_id": 31777477, "link": "https://stackoverflow.com/questions/31777477/how-does-rose-tree-unfold-work-from-origami-programming/31790521#31790521", "title": "How does Rose Tree unfold work (from Origami Programming)", "body": "<h3>They do not necessarily terminate!</h3>\n\n<p>The definitions of <code>unfoldR</code> and <code>unfoldF</code> form a <a href=\"https://en.wikipedia.org/wiki/Coinduction\" rel=\"nofollow\"><strong>co-inductive</strong></a> function on the types <code>Rose</code> and <code>Forest</code> respectively. Co-induction is the dual of structural induction. Co-inductive functions are designed to create infinite data-structures, which will later be consumed via a recursive function. </p>\n\n<p>Due to Haskell's lazy evaluation, we can define and create an infinite mutually recursive <code>Rose</code> and <code>Forest</code> data structure by applying a function <code>f :: (\u03b2 \u2192 \u03b1)</code> and <code>g :: (\u03b2 \u2192 List \u03b2)</code> and an initial \"seed value\" <code>x :: \u03b2</code> to either <code>unfoldR</code> and <code>unfoldF</code>.</p>\n\n<p>We would then consume the infinite data structure with another recursive function <code>h :: Rose -&gt; \u03b3</code></p>\n\n<p>Putting together an undefined example:</p>\n\n<pre><code>f :: (\u03b2 \u2192 \u03b1)\nf = undefined\ng :: (\u03b2 \u2192 List \u03b2) \ng = undefined\nx :: \u03b2\nx = undefined\nh :: Rose -&gt; \u03b3\nh = undefined\n\nresult :: \u03b3\nresult = h $ unfoldR f g x\n</code></pre>\n\n<p>Here <code>result</code> would be the evaluation of the computation over the infinite structure. But if it's an infinite data structure, how does <code>h</code> terminate? <em>How can</em> <code>result</code> <em>ever be evaluated?</em> </p>\n\n<p>Though <code>unfoldR f g x</code> will result in an infinite structure, <code>h</code> will only search a <strong>finite</strong> subset of the search space and hence <code>result</code> can be evaluated.</p>\n\n<p><strong>Note:</strong> <em>We can also define <code>f</code>, <code>g</code> &amp; <code>x</code> to create an finite structure, it need not be infinite</em></p>\n"}], "owner": {"reputation": 913, "user_id": 2549013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2ab92d7bdb4f64f83b35232e35d42cc?s=128&d=identicon&r=PG", "display_name": "egerhard", "link": "https://stackoverflow.com/users/2549013/egerhard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 2, "accepted_answer_id": 31790521, "answer_count": 1, "score": 4, "last_activity_date": 1438615135, "creation_date": 1438556684, "last_edit_date": 1438611173, "question_id": 31777477, "link": "https://stackoverflow.com/questions/31777477/how-does-rose-tree-unfold-work-from-origami-programming", "title": "How does Rose Tree unfold work (from Origami Programming)", "body": "<p>I have been reading the article <a href=\"http://www.staff.science.uu.nl/~3860418/msc/11_infomtpt/papers/origami-programming_Gibbons.pdf\" rel=\"nofollow\"><em>Origami Programming</em> by Jeremy Gibbons</a>  and am having trouble figuring out how the <code>unfoldR</code> and <code>unfoldF</code> functions work for <code>Rose Trees</code>.</p>\n\n<p>In the paper the <code>Rose Tree</code> type is defined as:</p>\n\n<pre><code>data Rose \u03b1 = Node \u03b1 (Forest \u03b1)\ntype Forest \u03b1 = List (Rose \u03b1)\n</code></pre>\n\n<p>The <code>unfoldR</code> and <code>unfoldF</code> functions are mutually recursive and defined as:</p>\n\n<pre><code>unfoldR :: (\u03b2 \u2192 \u03b1) \u2192 (\u03b2 \u2192 List \u03b2) \u2192 \u03b2 \u2192 Rose \u03b1\nunfoldR f g x = Node (f x) (unfoldF f g x)\n\nunfoldF :: (\u03b2 \u2192 \u03b1) \u2192 (\u03b2 \u2192 List \u03b2) \u2192 \u03b2 \u2192 Forest \u03b1\nunfoldF f g x = mapL (unfoldR f g) (g x)\n</code></pre>\n\n<p>It looks like that, except in a few small edge cases, these functions will recurse infinitely. How do these two mutually recursive functions terminate? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 0, "creation_date": 1438575445, "post_id": 31776828, "comment_id": 51488528, "body": "Is it essential that the solution actually use a strictness annotation, or were you just assuming that a strictness annotation would be necessary to solve this?"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 0, "creation_date": 1438609026, "post_id": 31776828, "comment_id": 51505810, "body": "@GaneshSittampalam the former. I know it is not necessary from your example."}], "answers": [{"tags": [], "owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "is_accepted": true, "score": 10, "last_activity_date": 1438836554, "last_edit_date": 1438836554, "creation_date": 1438551589, "answer_id": 31776897, "question_id": 31776828, "link": "https://stackoverflow.com/questions/31776828/trick-ghc-into-an-infinite-loop-using-strictness-annotations/31776897#31776897", "title": "Trick GHC into an infinite loop using strictness annotations", "body": "<p>This should do it:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\nf :: Int -&gt; Int\nf x = if x &gt;= 0 then f (x + 1) else 0\n\nfun !n = 0\n\nmain = print $ fun $ f 0\n</code></pre>\n\n<p>GHC does indeed seem to be pretty clever at spotting the loop, before I added the <code>if</code> it even spotted the recursive function call.</p>\n\n<p>I've tested this with <code>-O3</code> on GHC 7.10.</p>\n\n<p>EDIT: added the extra function <code>fun</code> as suggested by the asker, just to satisfy the requirement that a bang pattern be involved. It's not really relevant to the loop itself. Also changed from <code>Integer</code> to <code>Int</code> as suggested by another answer, to ensure constant memory usage.</p>\n"}, {"tags": [], "owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "is_accepted": false, "score": 6, "last_activity_date": 1438558714, "creation_date": 1438558714, "answer_id": 31777667, "question_id": 31776828, "link": "https://stackoverflow.com/questions/31776828/trick-ghc-into-an-infinite-loop-using-strictness-annotations/31777667#31777667", "title": "Trick GHC into an infinite loop using strictness annotations", "body": "<p>The \"problem\" is that while ghc is evaluating a thunk, it replaces it with a blackhole.  That's why something like the following simple example would not work:</p>\n\n<pre><code>inf :: ()\ninf = inf\n\nmain :: IO ()\nmain = return $! inf\n</code></pre>\n\n<p>Ghc will force inf, that will cause it to force inf a second time.  It will realize inf has been blackholed and detect a loop.</p>\n\n<p>The solution proposed of an infinite counter will work, but will allocate more and more memory for the integer counter.  It probably doesn't matter, since the memory for an Integer is logarithmic, but it might be slightly more elegant to use an Int and just let the counter wrap.</p>\n\n<p>Another option would be to use an infinite data structure.  That will create garbage, but in steady state consume a fixed amount of allocated memory.  Something like:</p>\n\n<pre><code>main :: IO ()\nmain = return $! last $ repeat ()\n</code></pre>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 31776897, "answer_count": 2, "score": 4, "last_activity_date": 1438836554, "creation_date": 1438551117, "last_edit_date": 1438554422, "question_id": 31776828, "link": "https://stackoverflow.com/questions/31776828/trick-ghc-into-an-infinite-loop-using-strictness-annotations", "title": "Trick GHC into an infinite loop using strictness annotations", "body": "<p>For some reason I need to trick Haskell into executing an infinite loop rather than just detecting it and exiting with <code>&lt;&lt;loop&gt;&gt;</code>, but it's too smart to do it. Are there any handy examples where a loop is caused by a strictness annotation (<code>!</code>), or can I turn off the loop detection? Currently I'm doing</p>\n\n<pre><code>x = x + y\ny = x + y\ninf !n = 0\n\nmain = do\n    print $ inf x\n</code></pre>\n"}, {"tags": ["haskell", "uniplate"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438554777, "post_id": 31775705, "comment_id": 51484648, "body": "Answer updated with working example."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438571949, "post_id": 31775705, "comment_id": 51487764, "body": "Note that <code>!xs</code> is not allowed. You&#39;ve got your work cut out for you since bangs are allowed in many locations that you are not considering, e.g. <code>![]</code> and <code>![!x]</code>, but they are not allowed at top-level definitions, e.g. <code>!main = ...</code> is not allowed even though <code>main</code> is a pattern. Next time be more explicit about what you want."}], "answers": [{"comments": [{"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "edited": false, "score": 0, "creation_date": 1438559000, "post_id": 31776303, "comment_id": 51485550, "body": "Thank you very much, I wasn&#39;t expecting a full answer like this. Will accept as soon as I get it working."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1438554759, "last_edit_date": 1438554759, "creation_date": 1438547521, "answer_id": 31776303, "question_id": 31775705, "link": "https://stackoverflow.com/questions/31775705/zip-ast-with-bool-list/31776303#31776303", "title": "zip AST with bool list", "body": "<p>As a first step, here's how to use <code>transformBi</code>:</p>\n\n<pre><code>import Data.Data\nimport Control.Monad\nimport Data.Generics.Uniplate.Data\nimport Language.Haskell.Exts\nimport Text.Show.Pretty (ppShow)\n\nchangeNames x = transformBi change x\n  where change (Ident str) = Ident (\"foo_\" ++ str)\n        change x           = x\n\ntest2 = do\n  content &lt;- readFile \"Simple.hs\"\n  case parseModule content of\n    ParseFailed _ e -&gt; error e\n    ParseOk a       -&gt; do\n      let a' = changeNames a\n      putStrLn $ ppShow a'\n</code></pre>\n\n<p>The <code>changeNames</code> function finds all occurrences of a <code>Ident s</code> and replaces it with <code>Ident (\"foo_\"++s)</code> in the source tree.</p>\n\n<p>There is a monadic version called <code>transformBiM</code> which allows the replacement function to be monadic which would allow you to consume elements from your list of Bools as you found bang patterns.</p>\n\n<p>Here is a complete working example:</p>\n\n<pre><code>import Control.Monad\nimport Data.Generics.Uniplate.Data\nimport Language.Haskell.Exts\nimport Text.Show.Pretty (ppShow)\nimport Control.Monad.State.Strict\n\nparseHaskell path = do\n  content &lt;- readFile path\n  let mode = ParseMode path Haskell2010 [EnableExtension BangPatterns] False False Nothing\n  case parseModuleWithMode mode content of\n    ParseFailed _ e -&gt; error $ path ++ \": \" ++ e\n    ParseOk a       -&gt; return a\n\nchangeBangs bools x = runState (transformBiM go x) bools\n  where go pp@(PBangPat p) = do\n           (b:bs) &lt;- get\n           put bs\n           if b\n             then return p\n             else return pp\n        go x = return x\n\ntest = do\n  a &lt;- parseHaskell \"Simple.hs\"\n  putStrLn $ unlines . map (\"before: \" ++) . lines $ ppShow a\n  let a' = changeBangs [True,False] a\n  putStrLn $ unlines . map (\"after : \" ++) . lines $ ppShow a'\n</code></pre>\n\n<p>You might also look into using <code>rewriteBiM</code>.</p>\n\n<p>The file <code>Simple.hs</code>:</p>\n\n<pre><code>main = do\n  case args of\n    [] -&gt; error \"blah\"\n    [!x] -&gt; putStrLn \"one\"\n    (!x : xs) -&gt; putStrLn \"many\"\n</code></pre>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 31776303, "answer_count": 1, "score": 0, "last_activity_date": 1438562283, "creation_date": 1438543388, "last_edit_date": 1438562283, "question_id": 31775705, "link": "https://stackoverflow.com/questions/31775705/zip-ast-with-bool-list", "title": "zip AST with bool list", "body": "<p>I have an <a href=\"https://hackage.haskell.org/package/haskell-src-exts-1.16.0.1/docs/Language-Haskell-Exts-Syntax.html#t:Module\" rel=\"nofollow\"><code>AST</code></a> representing a haskell program and a bitvector/bool list representing the presence of strictness annotations on <a href=\"https://hackage.haskell.org/package/haskell-src-exts-1.16.0.1/docs/Language-Haskell-Exts-Syntax.html#t:Pat\" rel=\"nofollow\"><code>Pattern</code></a>s in order.For example, <code>1000</code> represents a program with 4 <code>Pat</code>s where the first one is a <code>BangPat</code>. Is there any way that I can turn on and off the annotations in the <code>AST</code> according to the list? </p>\n\n<p>-- EDIT: further clarify what I want <code>editBang</code> to do</p>\n\n<p>Based on user5042's answer: \n<code>Simple.hs :=</code></p>\n\n<pre><code>main = do\n  case args of\n    [] -&gt; error \"blah\"\n    [!x] -&gt; putStrLn \"one\"\n    (!x : xs) -&gt; putStrLn \"many\"\n</code></pre>\n\n<p>And I want <code>editBang \"Simple.hs\" [True, True, True, True]</code> to produce</p>\n\n<pre><code>main = do\n  case args of\n    [] -&gt; error \"blah\"\n    [!x] -&gt; putStrLn \"one\"\n    (!(!x : !xs)) -&gt; putStrLn \"many\"\n</code></pre>\n\n<p>Given that above are the only 4 places that <code>!</code> can appear</p>\n"}, {"tags": ["haskell", "uniplate"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438542746, "post_id": 31775131, "comment_id": 51481349, "body": "Suppose you get to a <code>PInfixApp pat1 qname pat2</code>... do you want to recurse into <code>pat1</code> and <code>pat2</code> or just stop?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1438542909, "post_id": 31775131, "comment_id": 51481408, "body": "They have <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Data.html#t:Data\" rel=\"nofollow noreferrer\"><code>Data</code></a> instances, so you could use generics."}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438542985, "post_id": 31775131, "comment_id": 51481422, "body": "@user5402 I want to recurse"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1438543006, "post_id": 31775131, "comment_id": 51481431, "body": "@luqui can you elaborate?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1438543233, "post_id": 31775131, "comment_id": 51481515, "body": "@rem, it will take a bit of learning.  The <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/hmap/\" rel=\"nofollow noreferrer\">paper</a> (the 2003 one, at the bottom) is pretty good and easy to read."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1438625304, "post_id": 31776122, "comment_id": 51515901, "body": "Awesome, I underestimated uniplate, I&#39;ll have to give it another look"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 6, "last_activity_date": 1438546228, "creation_date": 1438546228, "answer_id": 31776122, "question_id": 31775131, "link": "https://stackoverflow.com/questions/31775131/count-pats-in-a-module/31776122#31776122", "title": "Count `Pat`s in a Module", "body": "<p>It's very easy using <a href=\"https://hackage.haskell.org/package/uniplate\" rel=\"noreferrer\">uniplate</a>:</p>\n\n<pre><code>import Data.Data\nimport Data.Generics.Uniplate.Data\nimport Control.Monad\nimport Language.Haskell.Exts\n\nfindPats :: Data a =&gt; a -&gt; [Pat]\nfindPats = universeBi\n\ntest = do\n  content &lt;- readFile \"Simple.hs\"\n  case parseModule content of\n    ParseFailed _ e -&gt; error e\n    ParseOk a       -&gt; do\n      forM_ (findPats a) $ \\p -&gt; do\n        putStrLn $ \"got a pat: \" ++ show p\n</code></pre>\n\n<p>Essentially it's just the <code>universeBi</code> function.</p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 31776122, "answer_count": 1, "score": 2, "last_activity_date": 1438547765, "creation_date": 1438539741, "last_edit_date": 1438547765, "question_id": 31775131, "link": "https://stackoverflow.com/questions/31775131/count-pats-in-a-module", "title": "Count `Pat`s in a Module", "body": "<p>I need to count the number of <a href=\"https://hackage.haskell.org/package/haskell-src-exts-1.16.0.1/docs/Language-Haskell-Exts-Syntax.html#t:Pat\" rel=\"nofollow\"><code>Pat</code></a> in a haskell <a href=\"https://hackage.haskell.org/package/haskell-src-exts-1.16.0.1/docs/Language-Haskell-Exts-Syntax.html#t:Module\" rel=\"nofollow\"><code>Module</code></a>. I know the simplest way is to pattern match on each level of the AST, which will result in a huge function that looks like the entire AST. I believe there's some way to take advantage of typeclasses like <code>Functor</code> or the <code>State Monad</code> to lean on some existing function that walks the tree (like <code>prettyPrint</code>) and trace a counter along, but I'm not sure how it works exactly. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1438560172, "post_id": 31772516, "comment_id": 51485770, "body": "BTW the <code>(Num n) =&gt; State n</code> syntax without a preceding <code>forall n.</code> is <a href=\"https://downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/other-type-extensions.html#univ\" rel=\"nofollow noreferrer\">deprecated in GHC 7.10, and will be disabled entirely in 7.12</a>."}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 3834375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3262d94a862e25fc09204d0511481ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Karl Marklund", "link": "https://stackoverflow.com/users/3834375/karl-marklund"}, "edited": false, "score": 0, "creation_date": 1438525862, "post_id": 31772677, "comment_id": 51476364, "body": "Thank you @sepp2k! As a Haskell beginner I&#39;ve find the type system very interesting and hope to learn more about how to reason about polymorphic types."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 9, "last_activity_date": 1438524439, "creation_date": 1438524439, "answer_id": 31772677, "question_id": 31772516, "link": "https://stackoverflow.com/questions/31772516/type-synonym-causes-type-error/31772677#31772677", "title": "Type synonym causes type error", "body": "<p><code>S -&gt; S</code> is not equivalent to <code>forall n. Num n =&gt; State n -&gt; State n</code>. It's equivalent to <code>(forall n. Num n =&gt; State n) -&gt; (forall n. Num n =&gt; State n)</code>. The former would mean that, for all numeric types <code>n</code>, we can pass in a <code>State n</code> and get back a <code>State n</code> (for the same type <code>n</code>). The latter means that we pass in something that can be a <code>State n</code> for all numeric types <code>n</code> and we get back something that can be a <code>State n</code> for all type <code>n</code>. In other words both the argument and the result are polymorphic.</p>\n\n<p>What this means is that the argument you pass in must have type <code>Num n =&gt; State n</code>, not a more concrete type like, say, <code>State Int</code>. This is true for <code>5</code>, which has the type <code>Num n =&gt; n</code>, but not <code>5.5</code>, which has the type <code>Fractional n =&gt; n</code>.</p>\n"}], "owner": {"reputation": 445, "user_id": 3834375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3262d94a862e25fc09204d0511481ce3?s=128&d=identicon&r=PG&f=1", "display_name": "Karl Marklund", "link": "https://stackoverflow.com/users/3834375/karl-marklund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 31772677, "answer_count": 1, "score": 3, "last_activity_date": 1438614724, "creation_date": 1438523241, "last_edit_date": 1495540700, "question_id": 31772516, "link": "https://stackoverflow.com/questions/31772516/type-synonym-causes-type-error", "title": "Type synonym causes type error", "body": "<p>As a follow-up to my previous question <a href=\"https://stackoverflow.com/questions/30582583/using-makelenses-class-constraints-and-type-synonyms-together\">Using makeLenses, class constraints and type synonyms together</a> I've got a new type error I would like to understand. </p>\n\n<p>The type error is caused by the introduction of the type synonym <code>type S = (Num n) =&gt; State n</code> in the below example. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE TemplateHaskell #-}                                                                                                                              \n{-# LANGUAGE RankNTypes #-}                                                                                                                                   \n\nmodule Foo where                                                                                                                                              \n\nimport Control.Lens                                                                                                                                           \n\ndata State a = State { _a :: a                                                                                                                                \n                     } deriving Show                                                                                                                          \n\nmakeLenses ''State -- Requires TemplateHaskell                                                                                                                \n\n-- | Smart constructor enforcing class constraint on record field _a.                                                                                         \nmkState :: (Num a) =&gt;  a -&gt; State a                                                                                                                           \nmkState n = State {_a = n}                                                                                                                                    \n\ndoStuff1 :: Num a =&gt; State a -&gt; State a                                                                                                                       \ndoStuff1 s = s &amp; a %~ (*2)                                                                                                                                    \n\ntest1a = doStuff1 $ mkState  5   -- results in State {_a = 10.0}                                                                                              \ntest1b = doStuff1 $ mkState  5.5 -- results in State {_a = 11.0}                                                                                                                                                           \n\ntype S = (Num n) =&gt; State n -- Requires the RankNTypes extensions                                                                                             \n\ndoStuff2 :: S -&gt; S                                                                                                                                            \ndoStuff2 s = s &amp; a %~ (*2)                                                                                                                                    \n\ntest2a = doStuff2 $ mkState  5   -- Results in State {_a = 10.0}                                                                                              \n--test2b = doStuff2 $ mkState  5.5 -- Type error.\n</code></pre>\n\n<p>If I uncomment <code>test2b</code> I get the following error. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Could not deduce (Fractional n) arising from the literal `5.5'\nfrom the context (Num n)\n  bound by a type expected by the context: Num n =&gt; State n\n  at Foo.hs:32:10-32\nPossible fix:\n  add (Fractional n) to the context of\n    a type expected by the context: Num n =&gt; State n\nIn the first argument of `mkState', namely `5.5'\nIn the second argument of `($)', namely `mkState 5.5'\nIn the expression: doStuff2 $ mkState 5.5\n</code></pre>\n\n<p>I would like to be able to understand why the introduced type synonym causes this error and how to decipher the error message. </p>\n"}, {"tags": ["haskell", "monads", "monoids", "alternative-functor", "monadplus"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1438514454, "post_id": 31770710, "comment_id": 51473459, "body": "Ahm... sorry, but this is still a duplicate. Toxaris <a href=\"http://stackoverflow.com/a/23024217/745903\">listed quite clearly</a> what you can&#39;t do with <code>Monoid</code>, in particular points 3. and 4.: \u201c<b>3.</b> If we want to use infinitely many different <code>a</code>.<code>MonadPlus m =&gt; ...</code> instead of not possible. <b>4.</b> If we don&#39;t know what <code>a</code> we need. <code>MonadPlus m =&gt; ...</code> instead of not possible.\u201d If something about that isn&#39;t clear to you, please ask specifically about your doubts."}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1438515846, "post_id": 31770710, "comment_id": 51473794, "body": "It&#39;s just theoretical explanation. Even there the first comment was &quot; I would really like to see a concrete example here&quot;. I want practical code examples which can show how exactly 3 and 4 affect monoid usage."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1438524744, "post_id": 31770710, "comment_id": 51476041, "body": "Ok, I see what you mean. By I don&#39;t think it&#39;s helpful to cook up some contrived examples \u2013 sure, for small examples we could give here you can always say <i>\u201cnow why don&#39;t we just expose that private data type abstractly\u201d</i> or <i>\u201cthose are a couple of <code>Monoid (f A), Monoid (f B)</code> constraints, but so what? \u2013 it doesn&#39;t look that bad\u201d</i> or <i>\u201cwhy don&#39;t we put those infinitely many / unknown types in an existential/GADT wrapper\u201d</i>. But all these workarounds aren&#39;t really practical in a big project. Just look up some library functions with <code>Alternative</code> context, and try to write them with <code>Monoid</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1438532184, "post_id": 31770710, "comment_id": 51478191, "body": "Have you deleted the closed question and posted it again? Please avoid that, it is really confusing."}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1438533730, "post_id": 31770710, "comment_id": 51478664, "body": "@duplode It was marked as duplicate"}, {"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1438535923, "post_id": 31770710, "comment_id": 51479279, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/23023961/why-monadplus-and-not-monad-monoid\">Why MonadPlus and not Monad + Monoid?</a>"}, {"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "reply_to_user": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1438537097, "post_id": 31770710, "comment_id": 51479606, "body": "@phadej No one can write a simple code example which will show the difference, but everyone think <a href=\"http://stackoverflow.com/questions/23023961/why-monadplus-and-not-monad-monoid\" title=\"why monadplus and not monad monoid\">stackoverflow.com/questions/23023961/&hellip;</a> is answer to the question."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1438546137, "post_id": 31770710, "comment_id": 51482263, "body": "@ais Please don&#39;t delete a question just because it was closed. Instead, either rally to get it reopened, or ask a fresh question (as you did here) and reference it, explaining <i>exactly</i> what makes the fresh question different. I think you gave a good explanation of what makes this question different. But hiding the history of the question is a bit underhanded, and may rub people the wrong way."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 15, "last_activity_date": 1438545911, "last_edit_date": 1438545911, "creation_date": 1438545441, "answer_id": 31776002, "question_id": 31770710, "link": "https://stackoverflow.com/questions/31770710/what-can-we-do-with-alternative-but-cannot-do-with-monoid/31776002#31776002", "title": "What can we do with Alternative but cannot do with Monoid?", "body": "<p>Here is a very simple example of something one can do with <code>Alternative</code>:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Foldable\n\ndata Nested f a = Leaf a | Branch (Nested f (f a))\n\nflatten :: (Foldable f, Alternative f) =&gt; Nested f a -&gt; f a\nflatten (Leaf x) = pure x\nflatten (Branch b) = asum (flatten b)\n</code></pre>\n\n<p>Now let's try the same thing with <code>Monoid</code>:</p>\n\n<pre><code>flattenMonoid :: (Foldable f, Applicative f) =&gt; Nested f a -&gt; f a\nflattenMonoid (Leaf x) = pure x\nflattenMonoid (Branch b) = fold (flattenMonoid b)\n</code></pre>\n\n<p>Of course, this doesn't compile, because in <code>fold (flattenMonoid b)</code> we need to know that the flattening produces a container with elements that are an instance of <code>Monoid</code>. So let's add that to the context:</p>\n\n<pre><code>flattenMonoid :: (Foldable f, Applicative f, Monoid (f a)) =&gt; Nested f a -&gt; f a\nflattenMonoid (Leaf x) = pure x\nflattenMonoid (Branch b) = fold (flattenMonoid b)\n</code></pre>\n\n<p>Ah, but now we have a problem, because we can't satisfy the context of the recursive call, which demands <code>Monoid (f (f a))</code>. So let's add that to the context:</p>\n\n<pre><code>flattenMonoid :: (Foldable f, Applicative f, Monoid (f a), Monoid (f (f a))) =&gt; Nested f a -&gt; f a\nflattenMonoid (Leaf x) = pure x\nflattenMonoid (Branch b) = fold (flattenMonoid b)\n</code></pre>\n\n<p>Well, that just makes the problem worse, since now the recursive call demands even more stuff, namely <code>Monoid (f (f (f a)))</code>...</p>\n\n<p>It would be cool if we could write</p>\n\n<pre><code>flattenMonoid :: ((forall a. Monoid a =&gt; Monoid (f a)), Foldable f, Applicative f, Monoid (f a)) =&gt; Nested f a -&gt; f a\n</code></pre>\n\n<p>or even just</p>\n\n<pre><code>flattenMonoid :: ((forall a. Monoid (f a)), Foldable f, Applicative f) =&gt; Nested f a -&gt; f a\n</code></pre>\n\n<p>and we can: instead of writing <code>forall a. Monoid (f a)</code>, we write <code>Alternative f</code>. (We can write a typeclass that expresses the first, easier-to-satisfy constraint, as well.)</p>\n"}], "owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 1, "accepted_answer_id": 31776002, "answer_count": 1, "score": 9, "last_activity_date": 1613887843, "creation_date": 1438509551, "last_edit_date": 1613887843, "question_id": 31770710, "link": "https://stackoverflow.com/questions/31770710/what-can-we-do-with-alternative-but-cannot-do-with-monoid", "title": "What can we do with Alternative but cannot do with Monoid?", "body": "<p>I read <a href=\"https://stackoverflow.com/questions/23023961/why-monadplus-and-not-monad-monoid\">Why MonadPlus and not Monad + Monoid?</a> and I understand a theoretical difference, but I cannot figure out a practical difference, because for List it looks the same.</p>\n\n<pre><code>mappend [1] [2] == [1] &lt;|&gt; [2]\n</code></pre>\n\n<p>Yes. Maybe has different implementations</p>\n\n<pre><code>mappend (Just \"a\") (Just \"b\") /= (Just \"a\") &lt;|&gt; (Just \"b\")\n</code></pre>\n\n<p>But we can implement Maybe Monoid in the same way as Alternative</p>\n\n<pre><code>instance Monoid (Maybe a) where\n  Nothing `mappend` m = m\n  m `mappend` _ = m\n</code></pre>\n\n<p>So, can someone show the code example which explains a practical difference between Alternative and Monoid? </p>\n\n<p>The question is not a duplicate of <a href=\"https://stackoverflow.com/questions/23023961/why-monadplus-and-not-monad-monoid\">Why MonadPlus and not Monad + Monoid?</a></p>\n"}, {"tags": ["haskell", "homebrew"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438508424, "post_id": 31770401, "comment_id": 51472134, "body": "I can not help you 100% here (it seems to me that your path is just wrong - <code>&#47;usr&#47;bin&#47;ghci</code> but you installed into <code>&#47;usr&#47;local&#47;Cellar&#47;ghc&#47;...</code> - IMO a symlink would do) but I never tried to install it with homebrew - I used <a href=\"https://ghcformacosx.github.io/\" rel=\"nofollow noreferrer\">ghcformacosx.github.io</a> and it worked out of the box without any problem - but I have to admit that I striped OSX for linux again - was not worth the hype for me)"}, {"owner": {"reputation": 715, "user_id": 1271322, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d5a3f543001dfc9617d4d9ce398bc57?s=128&d=identicon&r=PG", "display_name": "Arninja", "link": "https://stackoverflow.com/users/1271322/arninja"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438510801, "post_id": 31770401, "comment_id": 51472646, "body": "Thanks for the information, I thought something like that"}], "answers": [{"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": false, "score": 1, "last_activity_date": 1438549088, "last_edit_date": 1438549088, "creation_date": 1438548423, "answer_id": 31776420, "question_id": 31770401, "link": "https://stackoverflow.com/questions/31770401/installing-haskell-with-homebrew-fails/31776420#31776420", "title": "Installing Haskell with Homebrew fails", "body": "<p>I think you have some lingering symlinks or similar in <code>/usr/bin</code>. Homebrew automatically symlinks binaries from its \"cellar\" to <code>/usr/local/bin</code> (notice that the directory includes <code>local</code>).</p>\n\n<p>A reasonable course of action for you might be</p>\n\n<ol>\n<li><p>Check if Homebrew installed <code>ghc</code>, <code>cabal</code>, etc in <code>/usr/local/bin</code> (they should be symlinks pointing to somewhere under <code>/usr/local/Cellar/</code>). If they do exist you can conclude that Homebrew did not screw up.</p></li>\n<li><p>Check what kind of thing <code>/usr/bin/ghci</code>, <code>/usr/bin/cabal</code> actually are: eg <code>ls -l /usr/bin/ghci</code>. It will probably tell you that they are symlinks which point to files that don't exist, they are probably left from your previous Haskell installation.</p></li>\n<li><p>Remove the broken symlinks and make sure that <code>/usr/local/bin</code> is somewhere on your <code>$PATH</code>.</p></li>\n</ol>\n\n<p>(Now there have been people who do not recommend installing GHC using Homebrew, you might want to try the installation instructions found on the Haskell homepage: <a href=\"https://www.haskell.org/downloads\" rel=\"nofollow\">https://www.haskell.org/downloads</a>. On the other hand I don't see anything too strange in Homebrew's GHC formula, so it might be fine currently.)</p>\n"}], "owner": {"reputation": 715, "user_id": 1271322, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4d5a3f543001dfc9617d4d9ce398bc57?s=128&d=identicon&r=PG", "display_name": "Arninja", "link": "https://stackoverflow.com/users/1271322/arninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442945317, "creation_date": 1438507038, "last_edit_date": 1442945317, "question_id": 31770401, "link": "https://stackoverflow.com/questions/31770401/installing-haskell-with-homebrew-fails", "title": "Installing Haskell with Homebrew fails", "body": "<p>I had installed Haskell before, but that was hopelessly outdated. I tried to uninstall everything based on the documents I found and reinstalled it using homebrew.</p>\n\n<pre><code>brew install ghc cabal-install\n</code></pre>\n\n<p>This succeeded</p>\n\n<pre><code>==&gt; Downloading https://homebrew.bintray.com/bottles/ghc-7.10.1_1.yosemite.bottle.tar.gz\n######################################################################## 100.0%\n==&gt; Pouring ghc-7.10.1_1.yosemite.bottle.tar.gz\n\ud83c\udf7a  /usr/local/Cellar/ghc/7.10.1_1: 5423 files, 821M\n==&gt; Downloading https://homebrew.bintray.com/bottles/cabal-install-1.22.2.0.yosemite.bottle.1.tar.gz\n######################################################################## 100.0%\n==&gt; Pouring cabal-install-1.22.2.0.yosemite.bottle.1.tar.gz\n==&gt; Caveats\n\nBash completion has been installed to:\n  /usr/local/etc/bash_completion.d\n==&gt; Summary\n\ud83c\udf7a  /usr/local/Cellar/cabal-install/1.22.2.0: 6 files, 19M\n</code></pre>\n\n<p>But then I get this:</p>\n\n<pre><code>&gt; ghci\n-bash: /usr/bin/ghci: No such file or directory\n</code></pre>\n\n<p>And </p>\n\n<pre><code>&gt; cabal\n-bash: /usr/bin/cabal: No such file or directory\n</code></pre>\n\n<p>Since I can run other packages that are in my Cellar, I would think that I should be able to run these packages as well?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1438498566, "post_id": 31769242, "comment_id": 51470031, "body": "The keyword you are looking for to learn about the <code>:</code> on the left side is &quot;pattern matching&quot;. This is a recursive definition, in which the second equation (which is only used if the first one doesn&#39;t match the arguments) is the base case. Compare with <a href=\"http://stackoverflow.com/questions/4482697/a-newbie-to-haskell-help/4482764#4482764\">this question and its answers</a> (only note that the base case comes first there, which also works)."}, {"owner": {"reputation": 139, "user_id": 1840348, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/413218f8bcf5f932faa2ed5e421a0629?s=128&d=identicon&r=PG", "display_name": "Jonas Shinaniganz", "link": "https://stackoverflow.com/users/1840348/jonas-shinaniganz"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1438501931, "post_id": 31769242, "comment_id": 51470644, "body": "thank you, that also helped"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1438506402, "post_id": 31769242, "comment_id": 51471661, "body": "To clarify your assumptions 1. - 4. are all correct, and if you are in doubt about the type of the function you can fire up ghci and type <code>Prelude&gt;:t zip</code> to find out about it&#39;s type, this works for any function as long it is in scope, so if you have a function that is not in <code>Prelude</code> say <code>splitOn</code> you have to do <code>Prelude&gt; import Data.List.Split</code> (that&#39;s where splitOn comes from) in order to get it in scope. For operators you have to wrap them in parens <code>Prelude&gt; :t (&#47;=)</code>."}, {"owner": {"reputation": 188, "user_id": 1690291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QU6tb.jpg?s=128&g=1", "display_name": "Clay Thomas", "link": "https://stackoverflow.com/users/1690291/clay-thomas"}, "edited": false, "score": 0, "creation_date": 1438609483, "post_id": 31769242, "comment_id": 51506156, "body": "@JonasShinaniganz remember to accept an answer if you find one of them complete and accurate. Good questions!"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 1840348, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/413218f8bcf5f932faa2ed5e421a0629?s=128&d=identicon&r=PG", "display_name": "Jonas Shinaniganz", "link": "https://stackoverflow.com/users/1840348/jonas-shinaniganz"}, "edited": false, "score": 0, "creation_date": 1438501896, "post_id": 31769573, "comment_id": 51470636, "body": "really nice! You said: &quot;(because empty lists are not of the form a:b)&quot; why does the empty list not match a:b? [] = []:[] should match a:b with a=[], b=[]?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1438502112, "post_id": 31769573, "comment_id": 51470677, "body": "<code>[]:[]</code> is <code>[ [] ]</code> - a list of one element (which is an empty list). its head element is <code>[]</code>, and its tail is <code>[]</code> - i.e., no more elements there."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1438500997, "last_edit_date": 1438500997, "creation_date": 1438500673, "answer_id": 31769573, "question_id": 31769242, "link": "https://stackoverflow.com/questions/31769242/haskell-colon-within-the-zip-function/31769573#31769573", "title": "Haskell colon within the zip function", "body": "<p>Let's work with a simpler example:</p>\n\n<pre><code>head (x:xs) = x\n</code></pre>\n\n<p>The thing to realize is that the list <code>[1,2,3]</code> is shorthand for <code>1:2:3:[]</code>, which is again shorthand for <code>1:(2:(3:[]))</code> because <code>(:)</code> is right-associative.  So taking</p>\n\n<pre><code>head [1,2,3]\n</code></pre>\n\n<p>that's the same as</p>\n\n<pre><code>head (1:(2:(3:[])))\n</code></pre>\n\n<p>And now we can see how the pattern resembles the input. </p>\n\n<pre><code>head (1:(2:(3:[])))\n      ^  ^^^^^^^^\nhead (x:   xs     )\n</code></pre>\n\n<p>So <code>x</code> will be <code>1</code> and <code>xs</code> will be <code>2:(3:[])</code>, in other words <code>[2,3]</code>. </p>\n\n<hr>\n\n<p>Expounding a little about pattern matching.  The first equation for <code>zip</code></p>\n\n<pre><code>zip (x:xs) (y:ys) = ...\n</code></pre>\n\n<p>matches when both lists have at least one element (because empty lists are not of the form <code>a:b</code>). The second equation </p>\n\n<pre><code>zip xs ys = ...\n</code></pre>\n\n<p>matches any arguments whatsoever, provided the first equation did not match (and that they are the right type, since Haskell is statically typed).</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 6, "last_activity_date": 1438503273, "last_edit_date": 1438503273, "creation_date": 1438502476, "answer_id": 31769786, "question_id": 31769242, "link": "https://stackoverflow.com/questions/31769242/haskell-colon-within-the-zip-function/31769786#31769786", "title": "Haskell colon within the zip function", "body": "<p>The <code>(x:xs)</code> on the left hand side of equations is a <em>pattern</em>. It <em>deconstructs</em> an argument.</p>\n\n<p>The <code>(x:xs)</code> on the right hand side of equations is an <em>expression</em>. It <em>constructs</em> a value.</p>\n\n<pre><code>zip (x:xs) (y:ys) = \n</code></pre>\n\n<p>means, <code>zip</code> is a function, expecting two arguments, both are expected to be non-empty lists.</p>\n\n<pre><code>                      (x,y) : zip xs ys \n</code></pre>\n\n<p>this constructs an output value; its head is <code>(x,y)</code> and its tail is the result of calling <code>zip xs ys</code>:</p>\n\n<pre><code>       [ x1,   x2, x3, x4, ....\n       [ y1,   y2, y3, y4, ....\n      --------------------------\n    [ (x1,y1) , ................\n</code></pre>\n\n<p>Trying to call <code>zip (5,7,9) (1,3,5,11)</code> won't work (will cause a compile-time type-mismatch error), because the first rgument here is a triple, and the second - 4-tuple; these are <em>not</em> lists. Lists are of varying sizes, but tuples have fixed sizes. The correct call is thus <code>zip [5,7,9] [1,3,5,11]</code>. You can see how it is reduced to a value (i.e. what result is describes), by substituting the numbers to the above scheme's <code>x1</code>, <code>y1</code>, <code>x2</code>, etc. </p>\n\n<p>When one of the lists is exhausted, the call will be <code>zip [] [11]</code>. The above equation won't match this situation. Fortunately, you have another equation,</p>\n\n<pre><code>zip xs ys = \n</code></pre>\n\n<p>which uses variables as patterns. This is an example of an <em>irrefutable</em> pattern; it always succeeds. So, whatever the two arguments are, first will be henceforth known as <code>xs</code>, second - <code>ys</code>, and the right hand side of the equation</p>\n\n<pre><code>               [ ]\n</code></pre>\n\n<p>will be entered, that shows that the value <code>[]</code> will be produced, always. The effect of it is that when the list arguments to <code>zip</code> are of different lengths, the extra elements of the longer list are ignored.</p>\n"}], "owner": {"reputation": 139, "user_id": 1840348, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/413218f8bcf5f932faa2ed5e421a0629?s=128&d=identicon&r=PG", "display_name": "Jonas Shinaniganz", "link": "https://stackoverflow.com/users/1840348/jonas-shinaniganz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1438615017, "creation_date": 1438497595, "last_edit_date": 1438615017, "question_id": 31769242, "link": "https://stackoverflow.com/questions/31769242/haskell-colon-within-the-zip-function", "title": "Haskell colon within the zip function", "body": "<p>I struggle understanding this Haskell function. I know what it does superficially, but I'm unsure of how it achieves this functionality.</p>\n\n<pre><code>zip (x:xs) (y:ys) = (x,y) : zip xs ys \nzip xs ys = [ ]\n</code></pre>\n\n<p><strong>What I think:</strong></p>\n\n<ol>\n<li><code>zip</code> is the name of the function. </li>\n<li><code>zip</code> takes 2 parameters. (I believe currying is not important here).</li>\n<li>The parammeters are <code>(x:xs)</code> and <code>(y:ys)</code></li>\n<li><code>zip</code> returns a list of a tuple type <code>(x,y)</code>.</li>\n</ol>\n\n<p>Now I don't quite understand the parameters</p>\n\n<pre><code>(x:xs) (y:ys)\n</code></pre>\n\n<p>The colon appends something to the start of a list (returning the list), so why do we append something to the lists we want to zip? What are <code>x</code> and <code>y</code> in the function definition?</p>\n\n<p>The right side seems pretty obvious: We insert(0) the tuple (x,y) to a list of tuples returned by zip.</p>\n\n<pre><code>(x,y) : zip xs ys \n</code></pre>\n\n<p>Now <code>zip xs ys = [ ]</code> why would we always want an empty list if we just pass 2 lists?</p>\n\n<p>Could you explain how the following call to <code>zip</code> would be evaluation:</p>\n\n<pre><code>zip [5,7,9] [1,3,5,11]\n</code></pre>\n"}, {"tags": ["java", "sorting", "haskell"], "comments": [{"owner": {"reputation": 7363, "user_id": 905488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb324daddc3ad22736171ba863234d8?s=128&d=identicon&r=PG", "display_name": "Mick Mnemonic", "link": "https://stackoverflow.com/users/905488/mick-mnemonic"}, "edited": false, "score": 2, "creation_date": 1438497489, "post_id": 31769122, "comment_id": 51469864, "body": "Are you looking for a list implementation that keeps the lexicographical order of its elements, or do you want a function that compares two lists lexicographically?"}, {"owner": {"reputation": 324, "user_id": 3645205, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2613b6437e4f9b36ada78a4a105bec7?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Bingley", "link": "https://stackoverflow.com/users/3645205/mr-bingley"}, "reply_to_user": {"reputation": 7363, "user_id": 905488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb324daddc3ad22736171ba863234d8?s=128&d=identicon&r=PG", "display_name": "Mick Mnemonic", "link": "https://stackoverflow.com/users/905488/mick-mnemonic"}, "edited": false, "score": 0, "creation_date": 1438531422, "post_id": 31769122, "comment_id": 51477974, "body": "@Mick Mnemonic One that compares two lists lexicographically."}], "answers": [{"tags": [], "owner": {"reputation": 11685, "user_id": 4142130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f6c44a570a709b1fd0f4e04b0b8ae?s=128&d=identicon&r=PG&f=1", "display_name": "Hoopje", "link": "https://stackoverflow.com/users/4142130/hoopje"}, "is_accepted": false, "score": 4, "last_activity_date": 1438500253, "last_edit_date": 1438500253, "creation_date": 1438499597, "answer_id": 31769449, "question_id": 31769122, "link": "https://stackoverflow.com/questions/31769122/does-java-have-a-function-that-lexicographically-orders-lists-not-their-element/31769449#31769449", "title": "Does Java have a function that lexicographically orders lists (not their elements)?", "body": "<p>There is no such method that I know of. <code>List</code> (and its concrete implementations, such as <code>ArrayList</code>) do not extend/implement the <code>Comarable</code> interface, meaning that they implement no ordering themselves.</p>\n\n<p>I think this is a correct language decision, because lists, in my opinion, indeed do not have a canonical ordering. </p>\n\n<p>You can implement you own comparator which compares lists, and pass this to objects which need to compare list (for example <code>Collections.sort(list, comparator)</code>). For example:</p>\n\n<pre><code>class LexicographicalListComparator&lt;T extends Comparable&lt;T&gt;&gt; implements Comparator&lt;List&lt;T&gt;&gt; {\n    @Override\n    public int compare(List&lt;T&gt; o1, List&lt;T&gt; o2) {\n        Iterator&lt;T&gt; i1 = o1.iterator();\n        Iterator&lt;T&gt; i2 = o2.iterator();\n        int result;\n\n        do {\n            if (!i1.hasNext()) {\n                if (!i2.hasNext()) return 0; else return -1;\n            }\n            if (!i2.hasNext()) {\n                return 1;\n            }\n\n            result = i1.next().compareTo(i2.next());\n        } while (result == 0);\n\n        return result;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": true, "score": 6, "last_activity_date": 1438538901, "creation_date": 1438538901, "answer_id": 31774986, "question_id": 31769122, "link": "https://stackoverflow.com/questions/31769122/does-java-have-a-function-that-lexicographically-orders-lists-not-their-element/31774986#31774986", "title": "Does Java have a function that lexicographically orders lists (not their elements)?", "body": "<p>If third-party libraries are fair game, then in <a href=\"https://github.com/google/guava\" rel=\"noreferrer\">Guava</a> this is just <code>Ordering.natural().lexicographical()</code>.  There isn't anything for this built into basic Java, though.</p>\n"}, {"comments": [{"owner": {"reputation": 42640, "user_id": 1553851, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=128&d=identicon&r=PG", "display_name": "shmosel", "link": "https://stackoverflow.com/users/1553851/shmosel"}, "edited": false, "score": 0, "creation_date": 1493706197, "post_id": 42757299, "comment_id": 74505819, "body": "Lexicographical string ordering has nothing to do with comparing lists lexicographically."}], "tags": [], "owner": {"reputation": 507, "user_id": 4390903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWQIG.jpg?s=128&g=1", "display_name": "Laraconda", "link": "https://stackoverflow.com/users/4390903/laraconda"}, "is_accepted": false, "score": -1, "last_activity_date": 1489384050, "creation_date": 1489384050, "answer_id": 42757299, "question_id": 31769122, "link": "https://stackoverflow.com/questions/31769122/does-java-have-a-function-that-lexicographically-orders-lists-not-their-element/42757299#42757299", "title": "Does Java have a function that lexicographically orders lists (not their elements)?", "body": "<p>Just as Hoopje said, <code>List</code> does not implement the <code>Comparable</code> interface. If you want to implement your own comparator to lexicographically compare strings (and after that you could order lists of strings), Java has the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/text/Collator.html\" rel=\"nofollow noreferrer\">Collator</a> class:</p>\n\n<blockquote>\n  <p>The Collator class performs locale-sensitive String comparison. </p>\n</blockquote>\n\n<p>If that's not enough you could use <a href=\"https://docs.oracle.com/javase/8/docs/api/java/text/RuleBasedCollator.html\" rel=\"nofollow noreferrer\">RuleBasedCollator</a>, it works as <code>Collator</code> but you can personalize it a lot more.</p>\n\n<p>Both of them implement the <code>Comparable</code> interface so may use <code>compare</code>.</p>\n\n<pre><code>import java.text.Collator;\n...\nCollator c = Collator.getInstance();\nc.compare(s1, s2);\n</code></pre>\n\n<p>If you want it to follow some locale-sensitive rules, you must do:</p>\n\n<pre><code>import java.util.Locale;\n...\nCollator c = Collator.getInstance(new Locale(\"es\", \"MX\"));\nc.compare(s1, s2);\n</code></pre>\n\n<p>Here is more info on <a href=\"http://www.oracle.com/us/technologies/java/locale-140624.html\" rel=\"nofollow noreferrer\">Locale</a>.</p>\n"}], "owner": {"reputation": 324, "user_id": 3645205, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2613b6437e4f9b36ada78a4a105bec7?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Bingley", "link": "https://stackoverflow.com/users/3645205/mr-bingley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1954, "favorite_count": 1, "accepted_answer_id": 31774986, "answer_count": 3, "score": 3, "last_activity_date": 1489384050, "creation_date": 1438496184, "last_edit_date": 1438532201, "question_id": 31769122, "link": "https://stackoverflow.com/questions/31769122/does-java-have-a-function-that-lexicographically-orders-lists-not-their-element", "title": "Does Java have a function that lexicographically orders lists (not their elements)?", "body": "<p>In Haskell, lists of type <code>Ord a =&gt; [a]</code> have a lexicographical ordering. For example,</p>\n\n<pre><code>&gt; compare [1, 2, 3] [2, 3, 4]\nLT\n&gt; compare [1] [1, 2]\nLT\n</code></pre>\n\n<p>This is an immediate generalization of the lexicographical ordering most languages have on strings. In Java, for example,</p>\n\n<pre><code>\"abc\".compareTo(\"bcd\")  // -1\n\"a\".compareTo(\"ab\")     // -1\n</code></pre>\n\n<p>Is there any Java function in the standard library or other library that implements the lexicographical ordering of lists that Haskell has? I would expect it have a type signature along the lines of</p>\n\n<pre><code>&lt;T extends Comparable&lt;T&gt;&gt; int compare(List&lt;T&gt;, List&lt;T&gt;)\n</code></pre>\n\n<p>Implementing it myself wouldn't be difficult, but I'd rather not reinvent the wheel.</p>\n"}, {"tags": ["parsing", "haskell", "monads", "happy", "alex"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1438538198, "creation_date": 1438538198, "answer_id": 31774855, "question_id": 31768221, "link": "https://stackoverflow.com/questions/31768221/where-does-templates-wrappers-hs-live-in-a-happy-project/31774855#31774855", "title": "Where does &quot;templates/wrappers.hs&quot; live, in a Happy project?", "body": "<p>You can find the source for <code>template/wrappers.hs</code> in the alex repo:</p>\n\n<p><a href=\"https://github.com/simonmar/alex/tree/master/templates\" rel=\"nofollow\">https://github.com/simonmar/alex/tree/master/templates</a></p>\n\n<p>Running alex on your provided <code>Lex.x</code> gave me this error:</p>\n\n<pre><code>alex: (Array.!): undefined array element\n</code></pre>\n\n<p>If you give me a working example I can track down your problem.</p>\n"}], "owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 31774855, "answer_count": 1, "score": 0, "last_activity_date": 1438538198, "creation_date": 1438485121, "last_edit_date": 1495541642, "question_id": 31768221, "link": "https://stackoverflow.com/questions/31768221/where-does-templates-wrappers-hs-live-in-a-happy-project", "title": "Where does &quot;templates/wrappers.hs&quot; live, in a Happy project?", "body": "<p>I'm trying to make a parser using Alex with Happy. I'm following the instructions from <a href=\"https://stackoverflow.com/questions/20315739/how-to-use-an-alex-monadic-lexer-with-happy\">this post</a>, but having trouble. I'm trying to track down the source of the following type error:</p>\n\n<pre><code>templates/wrappers.hs:234:9:\n    Couldn't match type \u2018Token\u2019 with \u2018Int -&gt; Alex Token\u2019\n    Expected type: AlexInput -&gt; Int -&gt; Alex Token\n      Actual type: String -&gt; Token\n    In a stmt of a 'do' block: action (ignorePendingBytes inp) len\n    In the expression:\n      do { alexSetInput inp';\n           action (ignorePendingBytes inp) len }\n    In a case alternative:\n        AlexToken inp' len action\n          -&gt; do { alexSetInput inp';\n                  action (ignorePendingBytes inp) len }\n</code></pre>\n\n<p>My lexer is in src/AnsiParser/FrontEnd/Lex.x. So I took a look in dist/build/AnsiParser/FrontEnd/Lex.hs, and all I can find is:</p>\n\n<pre><code>{-# LINE 1 \"templates/wrappers.hs\" #-}\n{-# LINE 1 \"templates/wrappers.hs\" #-}\n</code></pre>\n\n<p>But I can't find any files named \"wrapper.hs\" on my system. How can I track down the cause of this error?</p>\n\n<p>In case it's useful, here's a reduced version of my Parse.y:</p>\n\n<pre><code>{\nmodule AnsiParser.FrontEnd.Parse where\nimport AnsiParser.FrontEnd.Lex\n}\n\n%name parseTokens\n%tokentype { Token }\n%lexer { lexWrap } { alexEOF }\n%monad { Alex }\n%error { parseError }\n\n%token\n  -- tokens\n\n%%\n-- rules\n\n{\nparseError :: Token -&gt; Alex a\nparseError tokens = error (\"Error!\" ++ show tokens)\n}\n</code></pre>\n\n<p>And Lex.x:</p>\n\n<pre><code>{\nmodule AnsiParser.FrontEnd.Lex where\n}\n\n%wrapper \"monad\"\n\ntokens :-\n  -- tokens\n\n{\ndata Token\n  = -- token types\n  | TokenEOF\n  deriving (Show)\n\nscanTokens = alexMonadScan\n\nlexWrap :: (Token -&gt; Alex a) -&gt; Alex a\nlexWrap = (alexMonadScan &gt;&gt;=)\n\nalexEOF :: Alex Token\nalexEOF = return TokenEOF\n}\n</code></pre>\n"}, {"tags": ["haskell", "parsec", "parser-combinators"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1438473187, "post_id": 31767280, "comment_id": 51466398, "body": "As I recall, both Haskell (GHC) and Python&#39;s indentation sensitive lexers don&#39;t send blocks as a unit, but instead give special tokens marking their beginning, new lines, and end (for Haskell, &quot;implicit&quot; <code>{</code> <code>;</code> and <code>}</code> tokens). Is there some reason this wouldn&#39;t work well for you? (I guess it would be a problem if the two subformats lexed completely differently.)"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1438473770, "post_id": 31767280, "comment_id": 51466498, "body": "Come to think of it, even if the lexers <i>are</i> different you might solve it by letting the lexer <i>first</i> give a token telling that a block starts, and then the parser gives a signal back telling which format to keep lexing. (BTW Haskell also has some backsignalling from parser to lexer, because implicit <code>}</code>s are sometimes inserted by parser request.)"}, {"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1440829910, "post_id": 31767280, "comment_id": 52444783, "body": "In my case an indented block is either the rest of a multi line statement, or a string literal delineated by the end of the indentation.  The lexer doesn&#39;t know which case it might be so just returns <code>Block String</code> as the token.  I want to catch the &quot;unexpected Block &#39;...&#39; expecting x &quot; and rerun x with the lexed block I just cannot figure out how to catch the parser at the point it actually is about to fail."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1440835474, "post_id": 31767280, "comment_id": 52445879, "body": "I am pretty sure my second suggestion <i>should</i> work for this - basically get Parsec to tell when it wants a data block <i>before</i> Alex has parsed anything beyond the initial indentation. However I am not proficient with Alex or the more advanced Parsec interface, so I don&#39;t really know <i>how</i> to send the information back to Alex at the right point."}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1438472660, "creation_date": 1438472660, "question_id": 31767280, "link": "https://stackoverflow.com/questions/31767280/in-parsec-fixing-a-broken-token-before-a-parser-fails", "title": "In Parsec, Fixing a broken token before a parser fails", "body": "<p><strong>Background</strong>:</p>\n\n<p>I am using a combination of Alex and Parsec to parse an indentation sensitive language.  An line more indented then the one above it my either be data for that line, or a continuation of the commands on that line.  Alex has no way to know for sure so it simply returns a <code>Block{...}</code> token.</p>\n\n<p>The parser knows when a data block is expected and passes the data into the Abstract Syntax Tree to be used by the interpreter.</p>\n\n<p>The problem arises when the parser encounters a <code>Block</code> token when it wanted something else.  I have a function that will convert a block token into a list of <code>Tokens</code> called <code>lex_block</code> but I cannot seem to apply it to the right place in the input stream.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Given a parser combinator that which fails at some token in the input stream, is there a way to modify the token that caused the failure and either continue evaluating the new input stream or at least to try again?</p>\n\n<p>I would like to write a function <code>retry</code> as follows:</p>\n\n<pre><code>&gt; retry :: (s -&gt; Maybe s) -&gt; ParsecT s u m a -&gt; ParsecT s u m a\n</code></pre>\n\n<p><code>retry f p</code> acts like parser <code>p</code>, except that if <code>p</code> fails the function <code>f</code> is used to alter the input stream at the point <code>p</code> failed and <code>p</code> is retried. When <code>f</code> returns <code>Nothing</code> the failure is passed on.</p>\n\n<p>I have tried to write this using <code>getInput</code>, <code>setInput</code> and <code>try</code>, but I cannot figure out how to get the input stream at the point the parser combinator failed rather then the point that it started.  I think that if I could discover a way to be told where the failure happened in the input stream I could make this work.</p>\n"}, {"tags": ["haskell", "fixpoint-combinators"], "answers": [{"comments": [{"owner": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 0, "creation_date": 1438520694, "post_id": 31767076, "comment_id": 51474991, "body": "And in case you are wondering like me, yes <code>fix factabs</code> evaluates to <code>((a -&gt; a) -&gt; (a -&gt; a)) ----&gt;</code> <b><code>(a -&gt; a)</code></b> indeed"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1438471633, "last_edit_date": 1438471633, "creation_date": 1438470597, "answer_id": 31767076, "question_id": 31766980, "link": "https://stackoverflow.com/questions/31766980/calculating-fibonnacci-numbers-using-fix/31767076#31767076", "title": "Calculating fibonnacci numbers using fix", "body": "<blockquote>\n  <p>fix expects a function of type <code>a -&gt; a</code>, how can we apply it to a function of type <code>(a -&gt; a) -&gt; a -&gt; a</code> (a function that takes two parameters)? I am totally confused...</p>\n</blockquote>\n\n<p>That works because <em>all Haskell functions take just one parameter</em>. Even though we often think of this type...</p>\n\n<pre><code>(a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n\n<p>... as one of a function of two arguments, we can also read it like...</p>\n\n<pre><code>(a -&gt; a) -&gt; (a -&gt; a)\n</code></pre>\n\n<p>... that is, one of a function that takes one argument (an <code>a -&gt; a</code> function) and produces a function of one argument (of type <code>a</code>). Now if we take...</p>\n\n<pre><code>fix :: (b -&gt; b) -&gt; b\n</code></pre>\n\n<p>... we can see how <code>factabs</code> fits it by replacing <code>b</code> with <code>(a -&gt; a)</code>.</p>\n\n<blockquote>\n  <p>Basically I was trying to figure out how to convert the function <code>limit</code> below to something that uses <code>fix</code>.</p>\n</blockquote>\n\n<p>All you need to do is, starting from the original definition, replacing any recursive calls of <code>limit</code> with an extra argument and passing this <code>limit</code>-with-an-extra-argument to <code>fix</code> (as you will see, the types will match with no further ado).  </p>\n"}, {"tags": [], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "is_accepted": false, "score": 0, "last_activity_date": 1438785901, "creation_date": 1438785901, "answer_id": 31835770, "question_id": 31766980, "link": "https://stackoverflow.com/questions/31766980/calculating-fibonnacci-numbers-using-fix/31835770#31835770", "title": "Calculating fibonnacci numbers using fix", "body": "<p>Just for the record, here is a version of <code>limit</code> function that I posted in my question that uses <code>fix</code>:</p>\n\n<pre><code>limit :: Eq a =&gt; (a -&gt; a) -&gt; a -&gt; a\nlimit = fix (\\g f x -&gt; let x' = f x\n                       in if x == x' then x else g f x')\n</code></pre>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 31767076, "answer_count": 2, "score": 4, "last_activity_date": 1563167294, "creation_date": 1438469507, "last_edit_date": 1563167294, "question_id": 31766980, "link": "https://stackoverflow.com/questions/31766980/calculating-fibonnacci-numbers-using-fix", "title": "Calculating fibonnacci numbers using fix", "body": "<p>I am trying to understand how this factorial example works using the function <code>fix :: (a -&gt; a) -&gt; a</code>.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Fixed-point_combinator\" rel=\"nofollow\"><strong>Example:</strong></a></p>\n\n<pre><code>factabs :: (Num a, Eq a) =&gt; (a -&gt; a) -&gt; a -&gt; a\nfactabs fact 0 = 1\nfactabs fact x = x * fact (x-1)\n\nf :: (Num a, Eq a) =&gt; a -&gt; a\nf = fix factabs\n</code></pre>\n\n<p>I do not see why <code>fix factabs</code> has this type... <code>fix</code> expects a function of type <code>a -&gt; a</code>, how can we apply it to a function of type <code>(a -&gt; a) -&gt; a -&gt; a</code> (a function that takes two parameters)? I am totally confused...</p>\n\n<p>Basically I was trying to figure out how to convert the function <code>limit</code> below to something that uses <code>fix</code>. Would appreciate any help.</p>\n\n<pre><code>limit f n\n    | n == next       = n\n    | otherwise       = limit f next\n    where\n      next = f n\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 4, "creation_date": 1438456086, "post_id": 31765154, "comment_id": 51462494, "body": "Write type signatures for your top-level functions! You will catch errors at the source (in this case, I think the problem is with <code>createBoard</code>, but I can&#39;t even tell for sure without type signatures reflecting your intent)."}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1438456094, "post_id": 31765154, "comment_id": 51462498, "body": "The error is saying that <code>createBoard</code> expects its argument, <code>board</code>, to be a function that excepts a board as an argument and returns a new board. (This would have type <code>Map.Map (t, t) Int -&gt; Map.Map (t, t) Int</code>) hence the first part of the error. <code>Map.empty</code> has type <code>Map.Map k v</code>."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1438456731, "last_edit_date": 1438456731, "creation_date": 1438456150, "answer_id": 31765250, "question_id": 31765154, "link": "https://stackoverflow.com/questions/31765154/changing-the-type-of-map-empty-in-haskell/31765250#31765250", "title": "changing the type of Map.empty in Haskell", "body": "<p>Ignoring the details, your error message reads:</p>\n\n<pre><code>Couldn't match expected type `X -&gt; Y'\n            with actual type `Map.Map k0 a1'\n</code></pre>\n\n<p>i.e. you're using a <code>Map</code> where the code is expecting a function instead.</p>\n\n<p>Likely culprit:</p>\n\n<pre><code>createBoard listOfBombs board (x: xs) = createBoard listOfBombs (insertFunction x listOfBombs)  xs\n--                                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>You're calling <code>insertFunction</code> with 2 arguments, but it takes 3.</p>\n\n<p>Because of currying, <code>insertFunction x listOfBombs</code> is itself a function (<code>\\board -&gt; Map.insert field (giveBackBombsNumber field listOfBombs) board</code>), and you're passing it as the second argument to <code>createBoard</code> (which is <code>board</code>), so ghc thinks <code>board</code> is supposed to be a function and rejects your attempt to give it a <code>Map</code>.</p>\n\n<p>You'll get much better error messages if you put explicit type annotations on your functions.</p>\n"}], "owner": {"reputation": 367, "user_id": 4716940, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/363a400a9b096b10c2ba8070f7b12f35?s=128&d=identicon&r=PG&f=1", "display_name": "demathieu", "link": "https://stackoverflow.com/users/4716940/demathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 31765250, "answer_count": 1, "score": 0, "last_activity_date": 1438456731, "creation_date": 1438455699, "question_id": 31765154, "link": "https://stackoverflow.com/questions/31765154/changing-the-type-of-map-empty-in-haskell", "title": "changing the type of Map.empty in Haskell", "body": "<p>I'm making my a minesweeper (game) instead of using a list of list as representation, I'm using different sets that will keep the cells collected by their type.</p>\n\n<p>I'm trying to generate a Map which uses as keys a tuple (x coordinate, y coordinate) as a pair for example like this (0,0). The value of the map will be the amount of neighbors containing a bomb. for example (0,0) 1 meaning cell (0,0) has 1 neighbors with a bomb. </p>\n\n<p>I was able to come up with a dirty way to make it although I'm getting an error on the Map.empty. </p>\n\n<p><strong>Error</strong></p>\n\n<pre><code>setTest.hs:57:70:\n    Couldn't match expected type `Map.Map (t0, t0) Int\n                                  -&gt; Map.Map (t0, t0) Int'\n                with actual type `Map.Map k0 a1'\n    In the second argument of `createBoard', namely `Map.empty'\n    In the expression: createBoard listOfBombs Map.empty fieldList\n    In the expression:\n      let\n        fieldList = [... | x &lt;- ..., y &lt;- ...]\n        nrBombs = round $ fromIntegral (xCoord * yCoord) * 0.20\n        listOfBombs\n          = Set.fromAscList\n              (take nrBombs\n               $ nub $ randomRs ((0, 0), (xCoord, yCoord)) (mkStdGen seed))\n      in createBoard listOfBombs Map.empty fieldList\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I do understand that the error appears because of the Map.empty having another type than the Map that I use in my functions. However I can not find a way to solve this issue? Also I there a way to link those function smoother together using Map/fold or zip?</p>\n\n<pre><code>--Generate Set with all the neighbors of a cell\nneighbours (xCoord,yCoord) = Set.fromAscList $ filter (/=(xCoord,yCoord)) [(x,y) | x &lt;- [(pred xCoord) .. (succ xCoord)], y &lt;- [(pred yCoord) .. (succ yCoord)]]\n\n--Gives back the number of neighbors with a bomb for a cell\ngiveBackBombsNumber (xCoord,yCoord) listOfBombs =  Set.size $ Set.intersection (neighbours (xCoord,yCoord)) listOfBombs\n\n-- Will insert a cell with the number of bombs around it to the board map.\ninsertFunction field listOfBombs board =  Map.insert field (giveBackBombsNumber field listOfBombs) board\n\n-- Will create a new Map containing \ncreateBoard listOfBombs board [] = board\ncreateBoard listOfBombs board (x: xs) = createBoard listOfBombs (insertFunction x listOfBombs)  xs  \n\ntestFunction (xCoord,yCoord) seed = let fieldList = [(x,y) | x &lt;- [0 .. xCoord] , y &lt;- [0 .. yCoord]]\n                                              nrBombs = round $ fromIntegral (xCoord * yCoord) * 0.20\n                                          listOfBombs = Set.fromAscList (take nrBombs  $ nub $ randomRs ((0,0), (xCoord,yCoord)) (mkStdGen seed)) \n                              in createBoard listOfBombs Map.empty fieldList\n</code></pre>\n"}, {"tags": ["haskell", "csrf", "yesod"], "comments": [{"owner": {"reputation": 528, "user_id": 3066608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0ZlK.png?s=128&g=1", "display_name": "creichert", "link": "https://stackoverflow.com/users/3066608/creichert"}, "edited": false, "score": 1, "creation_date": 1438459964, "post_id": 31765108, "comment_id": 51463549, "body": "Have you tried using <code>generateFormPost</code> in your GET request and <code>runFormPost</code> in your POST handler?"}, {"owner": {"reputation": 1774, "user_id": 2243137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZlG8p.jpg?s=128&g=1", "display_name": "Chase Ries", "link": "https://stackoverflow.com/users/2243137/chase-ries"}, "reply_to_user": {"reputation": 528, "user_id": 3066608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0ZlK.png?s=128&g=1", "display_name": "creichert", "link": "https://stackoverflow.com/users/3066608/creichert"}, "edited": false, "score": 0, "creation_date": 1438469583, "post_id": 31765108, "comment_id": 51465786, "body": "@creichert I have not. I&#39;ll give it a shot ASAP...if it&#39;s that simple I&#39;m gonna be kicking myself."}], "answers": [{"tags": [], "owner": {"reputation": 1774, "user_id": 2243137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZlG8p.jpg?s=128&g=1", "display_name": "Chase Ries", "link": "https://stackoverflow.com/users/2243137/chase-ries"}, "is_accepted": true, "score": 3, "last_activity_date": 1438593022, "creation_date": 1438593022, "answer_id": 31783483, "question_id": 31765108, "link": "https://stackoverflow.com/questions/31765108/csrf-yesod-runformpost-always-formfailure/31783483#31783483", "title": "CSRF: Yesod runFormPost always FormFailure", "body": "<p>Well, this turns out to be one of the most time-consuming bugs with one of the most mundane answers I've ever dealt with.</p>\n\n<p>Some time ago I added in <code>sslOnlySessions</code> to <code>makeSessionBackend</code> and forgot about it. After trying to wrap my brain around every possible way I could have done something wrong, I took a step back, tried to think of a different angle to approach the problem from, and it hit me like a ton of bricks.</p>\n\n<p>I'm posting this answer on the off chance someone 10 years from now will make the same dumb mistake I did, and after scouring their code for mistakes, finally fire up Google and find an easy answer.</p>\n\n<p>Godspeed, future Haskeller.</p>\n"}], "owner": {"reputation": 1774, "user_id": 2243137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZlG8p.jpg?s=128&g=1", "display_name": "Chase Ries", "link": "https://stackoverflow.com/users/2243137/chase-ries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 31783483, "answer_count": 1, "score": 1, "last_activity_date": 1438593022, "creation_date": 1438455446, "last_edit_date": 1438457362, "question_id": 31765108, "link": "https://stackoverflow.com/questions/31765108/csrf-yesod-runformpost-always-formfailure", "title": "CSRF: Yesod runFormPost always FormFailure", "body": "<p>Apologies in advance for the code dump. I'm pretty new to both Yesod and Haskell and I'm struggling with CSRF issues. The problem as I understand it is that the form's <code>_token</code> isn't matching the environment token (running runFormPostNoToken works just fine). I have a pair of routes:</p>\n\n<pre><code>/           HomeR      GET\n/upload     UploadR    POST\n</code></pre>\n\n<p>The Handler for HomeR is defined as such:</p>\n\n<pre><code>getHomeR :: Handler Html\ngetHomeR = do\n    ((res, uploadWidget), enctype) &lt;- runFormPost imgForm\n    setTitle \"Title\"\n    $(widgetFile \"homepage\")\n</code></pre>\n\n<p>And the form itself and the upload Handler are:</p>\n\n<pre><code>imgForm :: Html -&gt; MForm (HandlerT App IO) (FormResult Img, Widget) \nimgForm hiddenInput = do\n    (titleRes, titleView)   &lt;- mreq textField uploadFormTitleSettings Nothing\n    (descRes, descView)     &lt;- mopt textareaField uploadFormDescriptionSettings Nothing\n    (fileRes, fileView)     &lt;- mreq fileField uploadFormAttachmentSettings Nothing\n\n    let imgRes =  Img\n              &lt;$&gt; titleRes\n              &lt;*&gt; descRes\n              &lt;*&gt; fileRes\n              &lt;*&gt; pure (Likes 0)\n              &lt;*&gt; pure (Dislikes 0) \n              &lt;*&gt; pure (UserID 1) \n              &lt;*&gt; pure (Community 1) \n\n    let imgUploadWidget = do\n                      toWidget\n                          [whamlet|\n                              ^{ fvInput titleView }\n                              ^{ fvInput descView }\n                              ^{ fvInput fileView }\n                              #{ hiddenInput }\n                              &lt;button type=\"submit\"&gt;Submit\n                          |]\n\n    return (imgRes, imgUploadWidget)\n\npostImgUploadR :: HandlerT App IO Html\npostImgUploadR = do\n    ((imgRes, imgUploadWidget), enctype) &lt;- runFormPost imgForm\n    let submission :: HandlerT App IO Html\n        submission = case imgRes of\n            FormSuccess upload -&gt; defaultLayout [whamlet|The form was uploaded|]\n            FormMissing -&gt; defaultLayout [whamlet|The form is missing|]\n            FormFailure upload -&gt; defaultLayout [whamlet|The form failed.|]\n    submission\n</code></pre>\n\n<p>Unfortunately I'm not even sure what question to be asking here -- hopefully there's something obviously wrong with my code and someone can point me in the right direction. I spent some time reading through the source code of the functions and I <em>think</em> I understand it, but I'm not sure where the second, erroneous CSRF token is coming from (I assumed it would be set in a session variable and therefore wouldn't change). It's been quite a few hours and all my attempts to figure this out have failed.</p>\n"}, {"tags": ["regex", "haskell", "idioms"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1438455099, "post_id": 31764967, "comment_id": 51462181, "body": "in the version using gaurds, you probably need explicit type annotations, something like <code>function :: String -&gt; ReturnType</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1438472492, "post_id": 31765059, "comment_id": 51466273, "body": "<code>PatternGuards</code> are standard, no pragma needed. <code>ViewPatterns</code> might be even closer to what OP asks for, or the even more newfangled <code>PatternSynonyms</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1525, "user_id": 222189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/36cb170adfa384f33da06c74450e2365?s=128&d=identicon&r=PG", "display_name": "matejcik", "link": "https://stackoverflow.com/users/222189/matejcik"}, "edited": false, "score": 0, "creation_date": 1543927897, "post_id": 31765059, "comment_id": 94087499, "body": "@matejcik Because the <code>=~</code> has many overloads, including one returning list-of-lists, which I exploit here. I don&#39;t recall all the details, since I answered this 3 years ago, but the library docs should probably contain them."}, {"owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "edited": false, "score": 0, "creation_date": 1553560865, "post_id": 31765059, "comment_id": 97421303, "body": "Thank you for this answer, which was helpful! (Though for the <code>function3</code> form I am always seeing that the first guard matches, even if the match is empty.)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 13, "last_activity_date": 1438503448, "last_edit_date": 1438503448, "creation_date": 1438455080, "answer_id": 31765059, "question_id": 31764967, "link": "https://stackoverflow.com/questions/31764967/using-regexp-in-haskell-function-guards/31765059#31765059", "title": "Using regexp in haskell function guards", "body": "<p>Your first example <em>does</em> work for me:</p>\n\n<pre><code>import Text.Regex.Posix\n\nfunction :: String -&gt; String\nfunction arg\n  | arg =~ \"pattern1\" = \"1\"\n  | arg =~ \"pattern2\" = \"2\"\n  | otherwise = \"3\"\n</code></pre>\n\n<p>I think your <code>IsString</code> error is due to the overloaded string literals extension. Try to disable that, or alternatively try to use explicit <code>String</code> strings:</p>\n\n<pre><code>function :: String -&gt; String\nfunction arg\n  | arg =~ (\"pattern1\"::String) = \"1\"\n  | arg =~ (\"pattern2\"::String) = \"2\"\n  | otherwise = \"3\"\n</code></pre>\n\n<p>Too noisy? You can push the cruft to the last lines.</p>\n\n<pre><code>function2 :: String -&gt; String\nfunction2 arg\n  | arg =~ s\"pattern1\" = \"1\"\n  | arg =~ s\"pattern2\" = \"2\"\n  | otherwise = \"3\"\n  where s :: String -&gt; String\n        s = id\n</code></pre>\n\n<p>Need subgroup matching?</p>\n\n<pre><code>function3 :: String -&gt; String\nfunction3 arg\n  | [_,x]:_ &lt;- arg =~ s\"pat(t*)ern1\" = \"matched group: \" ++ x\n  -- ...\n</code></pre>\n\n<p>On <code>function3 \"patttern1\"</code>, variable <code>x</code> will be bound to <code>\"tt\"</code>. On <code>function3 \"xyz\"</code>, the test will fail and the next branch will be tried.</p>\n"}], "owner": {"reputation": 135, "user_id": 5129612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HN9X2Jm2tps/AAAAAAAAAAI/AAAAAAAADnE/h_dx_H_vjvQ/photo.jpg?sz=128", "display_name": "Quyk", "link": "https://stackoverflow.com/users/5129612/quyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 3, "accepted_answer_id": 31765059, "answer_count": 1, "score": 9, "last_activity_date": 1438620978, "creation_date": 1438454456, "last_edit_date": 1438620978, "question_id": 31764967, "link": "https://stackoverflow.com/questions/31764967/using-regexp-in-haskell-function-guards", "title": "Using regexp in haskell function guards", "body": "<p>I would like to write a Haskell function that's behavior is dependent upon regex pattern matching one of the arguments. In a language like C/Python/Perl, I would definitely just use a large if/else construct, but I don't really have that option.  What is the most idiomatic Haskell way to handle this?</p>\n\n<p>I've considered guards, but they don't work: <code>No instance for (Data.String.IsString source0)</code>:</p>\n\n<pre><code>function arg\n  | arg =~ \"pattern1\" = dothis arg\n  | arg =~ \"pattern2\" = dothat arg\n  | otherwise = failwith arg\n</code></pre>\n\n<p>The pattern matching used in case constructs would be perfect, if it handled Regex.</p>\n\n<pre><code>function arg = case arg of\n  (pattern1 match) -&gt; dothis match\n  (pattern2 match) -&gt; dothat match\n  _ -&gt; failwith arg\n</code></pre>\n"}, {"tags": ["haskell", "types", "exponentiation"], "answers": [{"comments": [{"owner": {"reputation": 817, "user_id": 1077657, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/77827a893cf80112cc4157d96d81f5e0?s=128&d=identicon&r=PG", "display_name": "BenJacob", "link": "https://stackoverflow.com/users/1077657/benjacob"}, "edited": false, "score": 0, "creation_date": 1438450270, "post_id": 31764140, "comment_id": 51460724, "body": "Ah yes sorry i meant **. That works perfectly, thank you - its taking me a bit of time to get used to haskells type system."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1438449408, "last_edit_date": 1438449408, "creation_date": 1438448931, "answer_id": 31764140, "question_id": 31763921, "link": "https://stackoverflow.com/questions/31763921/raising-a-realfrac-to-another-realfrac-power/31764140#31764140", "title": "Raising a RealFrac to another RealFrac power", "body": "<p>Two issues. Firstly, you do not want <code>(^)</code>, but rather <code>(^^)</code> (if your exponents are always integer numbers) or <code>(**)</code> (if you need floating exponents):</p>\n\n<pre><code>Prelude&gt; :t (^)\n(^) :: (Integral b, Num a) =&gt; a -&gt; b -&gt; a\nPrelude&gt; :t (^^)\n(^^) :: (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a\nPrelude&gt; :t (**)\n(**) :: Floating a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Secondly, <code>RealFrac</code> covers not only floating point numbers but also, for instance, <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Ratio.html\" rel=\"nofollow\">exact fractions</a>. If you really need your function to use <code>(**)</code> <em>and</em> work with any <code>RealFrac</code> you will need to convert the values with <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:realToFrac\" rel=\"nofollow\"><code>realToFrac</code></a>:</p>\n\n<pre><code>Prelude&gt; :t realToFrac \nrealToFrac :: (Fractional b, Real a) =&gt; a -&gt; b\n</code></pre>\n\n<p>Naturally, if you define <code>splitFunc r l = realToFrac r ** realToFrac l</code> and pass exact fractions (e.g. something of type <code>Ratio Integer</code>) to it, the extra precision of exact fractions will be lost, as <code>(**)</code> is a floating point operation.</p>\n"}], "owner": {"reputation": 817, "user_id": 1077657, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/77827a893cf80112cc4157d96d81f5e0?s=128&d=identicon&r=PG", "display_name": "BenJacob", "link": "https://stackoverflow.com/users/1077657/benjacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 31764140, "answer_count": 1, "score": 1, "last_activity_date": 1438622483, "creation_date": 1438447594, "last_edit_date": 1495540699, "question_id": 31763921, "link": "https://stackoverflow.com/questions/31763921/raising-a-realfrac-to-another-realfrac-power", "title": "Raising a RealFrac to another RealFrac power", "body": "<p>I am attempting to raise a number which is of type <code>RealFrac</code> to the power of another number, also of type <code>RealFrac</code>. <a href=\"https://stackoverflow.com/questions/6400568/exponentiation-in-haskell\">This question</a> on exponentiation helpfully explains the various exponentiation functions in Haskell, and I believe I need to use <code>(^)</code> in order to preserve any non integer values. But how do I deal with the types? I keep coming up against errors like this:</p>\n\n<pre><code>Could not deduce (Integral a) arising from a use of \u2018^\u2019\nfrom the context (RealFrac a)\n  bound by the type signature for\n             splitFunc :: RealFrac a =&gt; a -&gt; a -&gt; a\n  at Procedural/City.hs:41:16-42\nPossible fix:\n  add (Integral a) to the context of\n    the type signature for splitFunc :: RealFrac a =&gt; a -&gt; a -&gt; a\nIn the expression: r ^ l\nIn an equation for \u2018splitFunc\u2019: splitFunc r l = r ^ l\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1438464652, "post_id": 31763389, "comment_id": 51464708, "body": "and <code>concatMap (\\x -&gt; [f x])</code> is <code>map f</code>."}], "tags": [], "owner": {"reputation": 1308, "user_id": 1203558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kb4nh.jpg?s=128&g=1", "display_name": "aemxdp", "link": "https://stackoverflow.com/users/1203558/aemxdp"}, "is_accepted": true, "score": 12, "last_activity_date": 1438443878, "creation_date": 1438443878, "answer_id": 31763389, "question_id": 31763252, "link": "https://stackoverflow.com/questions/31763252/how-does-liftm-work/31763389#31763389", "title": "how does liftM (:[]) work", "body": "<p>Function <code>liftM</code> turns a function which takes input and produces output to a function which takes input in some monad and produces output in the same monad. Lets look at its definition:</p>\n\n<pre><code>liftM :: Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b\nliftM f mx = mx &gt;&gt;= \\x -&gt; return (f x)\n</code></pre>\n\n<p>Strings in Haskell are lists of characters (<code>type String = [Char]</code>), so</p>\n\n<pre><code>\"abc\" = ['a', 'b', 'c'] :: [Char]\n</code></pre>\n\n<p>From your application compiler infers <code>a = Char</code>, <code>b = [Char]</code>, <code>m a = [Char]</code>, <code>m = []</code>. So <code>m b = [[Char]] = [String]</code>. List is a monad where <code>return x = [x]</code> and <code>(&gt;&gt;=) = concatMap</code>. So if we specialize above definition we get:</p>\n\n<pre><code>liftM f mx = concatMap (\\x -&gt; [f x]) mx\n</code></pre>\n\n<p>And if we apply the arguments we get:</p>\n\n<pre><code>concatMap (\\x -&gt; [[x]]) ['a', 'b', 'c'] =\nconcat $ map (\\x -&gt; [[x]]) ['a', 'b', 'c'] =\nconcat $ [[['a']], [['b']], [['c']]] =\n[['a'], ['b'], ['c']] =\n[\"a\", \"b\", \"c\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1438444360, "post_id": 31763390, "comment_id": 51459032, "body": "whow, thanks! where do I learn more about all this? so that I can also easily use terms such as &quot;existence of liftM reflects the fact that any legitimate Monad can be made into a Functor&quot;? : )"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1438445273, "post_id": 31763390, "comment_id": 51459246, "body": "@akonsu By &quot;legitimate&quot;, I mean one which follows the monad laws. A brief introduction to them is <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads#Monad_Laws\" rel=\"nofollow noreferrer\">the second half of the &quot;Understanding monads&quot; Wikibook chapter</a>. One thing it doesn&#39;t mention is that, for any type constructor, all implementations of <code>fmap</code> that follow the <a href=\"https://en.wikibooks.org/wiki/Haskell/The_Functor_class#The_functor_laws\" rel=\"nofollow noreferrer\">first <i>functor</i> law</a>, <code>fmap id = id</code>, are necessarily (and automatically) equivalent."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 8, "last_activity_date": 1438444893, "last_edit_date": 1438444893, "creation_date": 1438443887, "answer_id": 31763390, "question_id": 31763252, "link": "https://stackoverflow.com/questions/31763252/how-does-liftm-work/31763390#31763390", "title": "how does liftM (:[]) work", "body": "<p><code>liftM</code> is equivalent to <code>fmap</code>, only specialised to monads. <code>(:[])</code> uses <code>(:)</code> to make a function that produces lists of one element. Just like <code>(+2)</code> is a compact way of writing <code>(\\x -&gt; x + 2)</code>, <code>(:[])</code> is equivalent to <code>(\\x -&gt; x : [])</code>, or <code>(\\x -&gt; [x])</code>.</p>\n\n<p>Your expression, then, might have been written as:</p>\n\n<pre><code>fmap (\\x -&gt; [x]) \"abc\"\n</code></pre>\n\n<p>The existence of <code>liftM</code> reflects the fact that any legitimate <code>Monad</code> can be made into a <code>Functor</code> by doing <code>fmap f m = m &gt;&gt;= \\x -&gt; return (f x)</code>. You can always replace <code>liftM</code> by <code>fmap</code>, so the only reasons to use it are:</p>\n\n<ul>\n<li><p>to define <code>fmap</code> for free if you already have a <code>Monad</code> instance (and don't want to use the <code>DeriveFunctor</code> GHC extension), and</p></li>\n<li><p>an entirely optional style choice (if you are writing obviously monadic code and feel that <code>liftM</code> looks better than <code>fmap</code>). </p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 6, "last_activity_date": 1438443906, "creation_date": 1438443906, "answer_id": 31763395, "question_id": 31763252, "link": "https://stackoverflow.com/questions/31763252/how-does-liftm-work/31763395#31763395", "title": "how does liftM (:[]) work", "body": "<p><code>liftM</code> is defined as:</p>\n\n<pre><code>liftM f m = m &gt;&gt;= \\x -&gt; return (f x)\n</code></pre>\n\n<p>We're using <code>liftM</code> with a list (of characters), so we need to look at the list instance of <code>Monad</code> to see how <code>&gt;&gt;=</code> and <code>return</code> are defined:</p>\n\n<pre><code>instance Monad [] where\n    return x = [x]\n    xs &gt;&gt;= f = concat (map f xs)\n</code></pre>\n\n<p>Thus</p>\n\n<pre><code>liftM f xs = xs &gt;&gt;= \\x -&gt; return (f x)\n           = concat (map (\\x -&gt; [f x]) xs)\n</code></pre>\n\n<p>The <code>concat</code> on the outside and the <code>[ ]</code> on the inside cancel each other out, so</p>\n\n<pre><code>liftM f xs = map (\\x -&gt; f x) xs\n           = map f xs\n</code></pre>\n\n<p>In other words, <code>liftM</code> in the list monad is simply <code>map</code>.</p>\n\n<pre><code>map (:[]) ['a', 'b', 'c'] = [(: []) 'a', (: []) 'b', (: []) 'c']\n                          = ['a' : [], 'b' : [], 'c' : []]\n                          = [['a'], ['b'], ['c']]\n                          = [\"a\",\"b\",\"c\"]\n</code></pre>\n\n<p>because a string is really just a list of characters.</p>\n"}, {"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 4, "creation_date": 1438506606, "post_id": 31763508, "comment_id": 51471720, "body": "+1 for the &quot;robotic monkey operator&quot; I&#39;ve never heard the term and from now on my haskell programming experience will be even more awesome!"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 13, "last_activity_date": 1438444864, "last_edit_date": 1495540349, "creation_date": 1438444864, "answer_id": 31763508, "question_id": 31763252, "link": "https://stackoverflow.com/questions/31763252/how-does-liftm-work/31763508#31763508", "title": "how does liftM (:[]) work", "body": "<p>The robotic monkey head operator <code>(:[])</code> is just the <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">section</a> of the list cons <code>(:)</code> and the empty list <code>[]</code>, i.e. <code>(:[])</code> is equivalent to <code>(\\x -&gt; x:[])</code>; which in turn can also be written using list syntax as <code>(\\x -&gt; [x])</code>.</p>\n\n<p>Rewritten this way, we have</p>\n\n<pre><code>liftM (\\x -&gt; [x]) \"abc\"\n</code></pre>\n\n<p>The string literal <code>\"abc\"</code> is also just syntax sugar for the <a href=\"https://en.wikibooks.org/wiki/Haskell/Lists_and_tuples#Strings_are_just_lists\" rel=\"nofollow noreferrer\">character list <code>['a', 'b', 'c']</code></a>, so we can in turn rewrite the above as</p>\n\n<pre><code>liftM (\\x -&gt; [x]) ['a', 'b', 'c']\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/7463500/why-do-we-have-map-fmap-and-liftm\"><code>liftM</code> is just <code>fmap</code> from the Dark Days when <code>Functor</code> wasn't a superclass of <code>Monad</code></a>, giving</p>\n\n<pre><code>fmap (\\x -&gt; [x]) ['a', 'b', 'c']\n</code></pre>\n\n<p>The <code>Functor</code> instance of <code>[]</code> sets <code>fmap = map</code>, giving</p>\n\n<pre><code>map (\\x -&gt; [x]) ['a', 'b', 'c']\n</code></pre>\n\n<p>which reduces to </p>\n\n<pre><code>[['a'], ['b'], ['c']]\n</code></pre>\n\n<p>Or, going back to string notation</p>\n\n<pre><code>[\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>Q.e.d.</p>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 31763389, "answer_count": 4, "score": 6, "last_activity_date": 1438444893, "creation_date": 1438441476, "question_id": 31763252, "link": "https://stackoverflow.com/questions/31763252/how-does-liftm-work", "title": "how does liftM (:[]) work", "body": "<p>I am trying to understand the expression below. It converts the list of characters <code>['a','b','c']</code> to a list of strings <code>[\"a\", \"b\", \"c\"]</code></p>\n\n<pre><code>liftM (:[]) \"abc\"\n</code></pre>\n\n<p>How does this happen?</p>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1438438409, "post_id": 31762748, "comment_id": 51457930, "body": "The <a href=\"https://hackage.haskell.org/package/aeson-0.9.0.1/docs/doc-index.html\" rel=\"nofollow noreferrer\">index</a> linked to at the top of documentation pages often helps in such cases."}, {"owner": {"reputation": 3354, "user_id": 4261613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d8f052f9d8434d59270feefcf6cc65d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/4261613/mikhail"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1438438520, "post_id": 31762748, "comment_id": 51457969, "body": "@duplode Thanks a lot, that basically answers the question."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1438438868, "creation_date": 1438438868, "answer_id": 31762857, "question_id": 31762748, "link": "https://stackoverflow.com/questions/31762748/haskell-aeson-parsejson-example-using/31762857#31762857", "title": "Haskell aeson ParseJSON example using (.:)", "body": "<p>It retrieves the value associated with the key. <code>(.:)</code> produces a parse failure (via <code>empty</code> from <code>Alternative</code>) if the key isn't there, so it is suitable for mandatory keys (as opposed to <code>(.:?)</code>, which makes sense for optional ones).</p>\n"}], "owner": {"reputation": 3354, "user_id": 4261613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d8f052f9d8434d59270feefcf6cc65d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/4261613/mikhail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 31762857, "answer_count": 1, "score": 1, "last_activity_date": 1438438868, "creation_date": 1438438052, "last_edit_date": 1438438485, "question_id": 31762748, "link": "https://stackoverflow.com/questions/31762748/haskell-aeson-parsejson-example-using", "title": "Haskell aeson ParseJSON example using (.:)", "body": "<p>There is the following snippet of code in the Aeson package usage <a href=\"https://hackage.haskell.org/package/aeson-0.9.0.1/docs/Data-Aeson-Types.html#t:FromJSON\" rel=\"nofollow\">example</a>:</p>\n\n<pre><code>data Coord = Coord { x :: Double, y :: Double }\n\ninstance FromJSON Coord where\n  parseJSON (Object v) = Coord    &lt;$&gt;\n                         v .: \"x\" &lt;*&gt;\n                         v .: \"y\"\n</code></pre>\n\n<p>The type of <code>parseJSON</code> function is <code>parseJSON :: Value -&gt; Parser a</code>.\nI have the following question about this code: what is the <code>.:</code> function? From the example I might say that its type is <code>Object -&gt; String -&gt; Parser String</code>, however I can't find anything about it on hoogle/hackage. Any help would be appreciated!</p>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1438436991, "post_id": 31762557, "comment_id": 51457522, "body": "Even if it were useless, complicating the grammar to disallow the empty case seems to have even less value. In fact, I believe typeclass instances will still be exported."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1438679046, "post_id": 31762557, "comment_id": 51535973, "body": "I just want to note that I&#39;d generally advise against doing this because while it will export instances, they will be orphan instances."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1438437785, "last_edit_date": 1438437785, "creation_date": 1438437452, "answer_id": 31762645, "question_id": 31762557, "link": "https://stackoverflow.com/questions/31762557/when-specifying-an-empty-export-list-can-be-useful/31762645#31762645", "title": "When specifying an empty export list can be useful?", "body": "<p>Such a module will still export any class instances defined therein.</p>\n\n<pre><code>module A where\n\nclass Foo f where\n  foo :: f\n\ndata Bar = Bar deriving (Show)\n</code></pre>\n\n<hr>\n\n<pre><code>module B () where\n\nimport A\n\ninstance Foo Bar where\n  foo = Bar\n</code></pre>\n\n<hr>\n\n<pre><code>module C where\n\nimport A\nimport B -- won't compile without this import!\n\nmain = print (foo :: Bar)\n</code></pre>\n"}], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 31762645, "answer_count": 1, "score": 9, "last_activity_date": 1438437785, "creation_date": 1438436902, "question_id": 31762557, "link": "https://stackoverflow.com/questions/31762557/when-specifying-an-empty-export-list-can-be-useful", "title": "When specifying an empty export list can be useful?", "body": "<p>It is possible to export no names of a module by specifying just a pair of parenthesis as the export list:</p>\n\n<pre><code>module MyModule () where\n</code></pre>\n\n<p>In which scenarios would this be useful? As far as I understand, any file importing <code>MyModule</code> won't be able to use any functions or types declared inside <code>MyModule</code>. At this point is seems like a useless feature of the langauge, but I suppose it is there for a reason.</p>\n"}, {"tags": ["scala", "haskell", "types", "algebraic-data-types"], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 7, "last_activity_date": 1438425752, "last_edit_date": 1438425752, "creation_date": 1438425426, "answer_id": 31760904, "question_id": 31760733, "link": "https://stackoverflow.com/questions/31760733/how-to-convert-the-scala-case-class-definition-to-haskell/31760904#31760904", "title": "How to convert the Scala case class definition to Haskell?", "body": "<p>In scala, union types are emulated with a sealed class/trait with a number of subclasses containing the individual cases. These can be defined in Haskell directly:</p>\n\n<pre><code>data Expr = Value Int | Add Expr Expr | Subtract Expr Expr\n</code></pre>\n\n<p>this differs from scala in that <code>Value</code>, <code>Add</code> and <code>Subtract</code> are constructors for the <code>Expr</code> type, whereas in <code>Scala</code> the individual case classes also have their own type which can be referenced directly e.g.</p>\n\n<pre><code>def printValue(v: Value): Unit = { println(v.n) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4820, "user_id": 978664, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BWz5A.jpg?s=128&g=1", "display_name": "dmitry", "link": "https://stackoverflow.com/users/978664/dmitry"}, "is_accepted": false, "score": 3, "last_activity_date": 1438425485, "creation_date": 1438425485, "answer_id": 31760916, "question_id": 31760733, "link": "https://stackoverflow.com/questions/31760733/how-to-convert-the-scala-case-class-definition-to-haskell/31760916#31760916", "title": "How to convert the Scala case class definition to Haskell?", "body": "<pre><code>data Expr = Value Int | Add Expr Expr | Subtract Expr Expr\n</code></pre>\n\n<p><a href=\"https://wiki.haskell.org/Algebraic_data_type\" rel=\"nofollow\">https://wiki.haskell.org/Algebraic_data_type</a></p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1438429326, "creation_date": 1438429326, "answer_id": 31761426, "question_id": 31760733, "link": "https://stackoverflow.com/questions/31760733/how-to-convert-the-scala-case-class-definition-to-haskell/31761426#31761426", "title": "How to convert the Scala case class definition to Haskell?", "body": "<p>As an alternative to what others posted, here's a solution which uses a syntax closer to scala, relying on the small extension <code>GADTSyntax</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTSyntax #-}\n\n--- sealed trait Expr\ndata Expr where\n   -- case class Value(n: Int) extends Expr\n   Value :: Int -&gt; Expr\n   -- case class Add(e1: Expr, e2: Expr) extends Expr\n   Add :: Expr -&gt; Expr -&gt; Expr\n   -- case class Subtract(e1: Expr, e2: Expr) extends Expr\n   Subtract :: Expr -&gt; Expr -&gt; Expr\n</code></pre>\n"}], "owner": {"reputation": 176396, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=128&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 2, "accepted_answer_id": 31760904, "answer_count": 3, "score": 6, "last_activity_date": 1438621263, "creation_date": 1438424171, "last_edit_date": 1438621263, "question_id": 31760733, "link": "https://stackoverflow.com/questions/31760733/how-to-convert-the-scala-case-class-definition-to-haskell", "title": "How to convert the Scala case class definition to Haskell?", "body": "<p>I'm learning Haskell along with Scala. I tried to do define the following Scala type in Haskell, but failed:</p>\n\n<pre><code>sealed trait Expr\ncase class Value(n: Int) extends Expr\ncase class Add(e1: Expr, e2: Expr) extends Expr\ncase class Subtract(e1: Expr, e2: Expr) extends Expr\n</code></pre>\n\n<p>Could someone give me an example?</p>\n"}, {"tags": ["scala", "haskell", "algebraic-data-types"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1438417203, "post_id": 31759736, "comment_id": 51452394, "body": "You want tuples to return more than one result and you want sum-types to make the choices you have explicit. (of course this is only the first drop in the ocean - you can write books about this stuff). The link you gave is maybe misleading - you might get the idea that you need this stuff only for ivory-tower-arkane-magic stuff but it&#39;s really just a way to manage your data in a sane way (especially if you don&#39;t have classes and inheritance and mutating references at your disposal)"}, {"owner": {"reputation": 176396, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=128&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438417882, "post_id": 31759736, "comment_id": 51452524, "body": "@Carsten I feel you understand what I&#39;m confused with. Appreciated your comment and hope you can tell something more :)"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 5, "creation_date": 1438419597, "post_id": 31759736, "comment_id": 51452895, "body": "Just to express the warning that the acronym &quot;ADT&quot; is used also to mean &quot;Abstract Data Type&quot;, which is an opposed concept to &quot;Algebraic Data Type&quot;. The acronym &quot;ADT&quot; should thus be used with caution, i.e., not at all."}, {"owner": {"reputation": 176396, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=128&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1438419996, "post_id": 31759736, "comment_id": 51452993, "body": "@pigworker thanks, fixed"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1438623193, "post_id": 31759736, "comment_id": 51514706, "body": "If you want to know why people need numbers, don&#39;t start with a course in number theory. It won&#39;t mention things like balancing your checkbook or counting sheep. I exagerrate but only a little."}, {"owner": {"reputation": 28003, "user_id": 1083663, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/784657ec6f91c7406a2c4121d8bda505?s=128&d=identicon&r=PG", "display_name": "GOTO 0", "link": "https://stackoverflow.com/users/1083663/goto-0"}, "edited": false, "score": 0, "creation_date": 1438628443, "post_id": 31759736, "comment_id": 51517433, "body": "Coincidentially, I remember a very similar question on another network site with (imho) more exhaustive answers: <a href=\"http://programmers.stackexchange.com/questions/287461/what-problem-do-algebraic-data-types-solve\" title=\"what problem do algebraic data types solve\">programmers.stackexchange.com/questions/287461/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 176396, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=128&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "edited": false, "score": 0, "creation_date": 1438417688, "post_id": 31759850, "comment_id": 51452493, "body": "Thanks, this is exactly what I&#39;m thinking ADT before reading these articles. But seems they are talking with something different"}, {"owner": {"reputation": 21223, "user_id": 1809978, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2c84636f18304749755e15b2319751f6?s=128&d=identicon&r=PG", "display_name": "dk14", "link": "https://stackoverflow.com/users/1809978/dk14"}, "reply_to_user": {"reputation": 176396, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=128&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "edited": false, "score": 0, "creation_date": 1438418049, "post_id": 31759850, "comment_id": 51452560, "body": "I believe, it&#39;s actually almost same as you thought except that you can (more-less) think about them as a Sets <code>data Boolean = True | False</code> means that Boolean is a union (coproduct) of True and False. Cat(height: Height, weight: Weight) is a product of Height and Weight"}, {"owner": {"reputation": 21223, "user_id": 1809978, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2c84636f18304749755e15b2319751f6?s=128&d=identicon&r=PG", "display_name": "dk14", "link": "https://stackoverflow.com/users/1809978/dk14"}, "reply_to_user": {"reputation": 176396, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=128&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "edited": false, "score": 0, "creation_date": 1438420787, "post_id": 31759850, "comment_id": 51453189, "body": "@Freewind I&#39;ve added some analogies with category theory"}], "tags": [], "owner": {"reputation": 21223, "user_id": 1809978, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2c84636f18304749755e15b2319751f6?s=128&d=identicon&r=PG", "display_name": "dk14", "link": "https://stackoverflow.com/users/1809978/dk14"}, "is_accepted": false, "score": 10, "last_activity_date": 1505717329, "last_edit_date": 1505717329, "creation_date": 1438417420, "answer_id": 31759850, "question_id": 31759736, "link": "https://stackoverflow.com/questions/31759736/why-do-we-need-algebraic-data-types/31759850#31759850", "title": "Why do we need &quot;Algebraic Data Types&quot;?", "body": "<p>We should start with the Haskell wiki article <a href=\"https://wiki.haskell.org/Algebraic_data_type\" rel=\"nofollow noreferrer\"><em>Algebraic Data Types</em></a> </p>\n\n<p>And here, shortly, just my vision:</p>\n\n<ul>\n<li>we need them to model business logic in old object oriented way (or actually in old categories-based way), and make it more typesafe as compiler can check that you've matched all possible choices. Or, in other words, that your function is <a href=\"https://uf-ias-2012.wikispaces.com/file/view/turner.pdf\" rel=\"nofollow noreferrer\">total</a>, not partial. Eventually, it gives the compiler an ability to proof the correctness of your code (that's why sealed traits are recommended). So, the more different types you have the better - btw, generic programming helps you here as it produces more types.</li>\n<li>standard features: we can represent type as a \"set\" of objects, we can match object with type (using pattern matching), or even deconstruct (analyze) it with matchers. We can also dynamically add behavior (in compile-time) to such type with type classess. It's possible for regular class as well, but here it gives us an ability to separate algebraic model (types) from behavior (functions)</li>\n<li>we can construct types as <a href=\"https://en.wikipedia.org/wiki/Product_(category_theory)\" rel=\"nofollow noreferrer\">products</a>/<a href=\"https://en.wikipedia.org/wiki/Coproduct\" rel=\"nofollow noreferrer\">coproducts</a> of different objects/types. You can  think of algebraic type system as a set (or more generally - as a cartesian-closed category). <code>type Boolean = True | False</code> means that Boolean is a union (coproduct) of <code>True</code> and <code>False</code>. <code>Cat(height: Height, weight: Weight)</code> is a \"tuple\" (more generally - product) of <code>Height</code> and <code>Weight</code>. Product (more-less) represents \"part of\" relationship from OOP, coproduct - \"is\" (but in the opposite way).</li>\n</ul>\n\n<p>It also gives us a way to dispatch behaviour in runtime in multimethod-style (like it was in <a href=\"https://en.wikipedia.org/wiki/Common_Lisp_Object_System\" rel=\"nofollow noreferrer\">CLOS</a>):</p>\n\n<pre><code>  sealed trait Animal\n  case class Cat extends Animal\n  case class Dog extends Animal\n\n def move(c: Animal) = c match {\n   case Cat(...) =&gt; ...\n   case Dog(...) =&gt;\n   case a: Animal =&gt; ...//if you need default implementation\n }\n</code></pre>\n\n<p>Haskell-like:</p>\n\n<pre><code> data Animal = Dog | Cat //coproduct\n\n let move Dog d = ...\n let move Cat c = ...\n</code></pre>\n\n<p>Instead of: </p>\n\n<pre><code>trait Animal {\n  ...\n  def move = ...\n}\n\nclass Cat(val ...) extends Animal {\n  override def move = ...\n}\n\nclass Dog(val ...) extends Animal {\n  override def move = ...\n}\n</code></pre>\n\n<p>P.S. Theoretically, if you're modeling the world in algebraic way and your functions are total and pure - you can proof that your application is correct. If it compiles - it works :).</p>\n\n<p>P.S.2. I should also mention that Scala's type hierarchy which has <code>Any</code> in it isn't so good for typesafety (but good for interop with Java and IO) as it breaks the nice structure defined by GADTs. More than that <code>case class</code> might be both GADT (algebraic) and ADT (abstract) as well, which also reduces the guarantees.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1438431944, "creation_date": 1438431944, "answer_id": 31761817, "question_id": 31759736, "link": "https://stackoverflow.com/questions/31759736/why-do-we-need-algebraic-data-types/31761817#31761817", "title": "Why do we need &quot;Algebraic Data Types&quot;?", "body": "<p>The blog post you mention is more about the mathematical aspects of algebraic data types that about their practical use in programming. I think most functional programmers first learnt about algebraic data types by using them in some programming language, and only later studied their algebraic properties.</p>\n\n<p>Indeed, the intent of the blog post is clear from its very beginning:</p>\n\n<blockquote>\n  <p>In this series of posts I\u2019ll explain why Haskell\u2019s data types are\n  called algebraic - without mentioning category theory or advanced\n  math.</p>\n</blockquote>\n\n<p>Anyway, the practical usefulness of algebraic types is best appreciated by playing around with them.</p>\n\n<p>Suppose, for instance, you want to write a function to intersect two segments on a plane.</p>\n\n<pre><code>def intersect(s1: Segment, s2: Segment): ???\n</code></pre>\n\n<p>What should the result be? It's tempting to write</p>\n\n<pre><code>def intersect(s1: Segment, s2: Segment): Point\n</code></pre>\n\n<p>but what if there's no intersection? One might attempt to patch that corner case by returning <code>null</code>, or by throwing a <code>NoIntersection</code> exception. However, two segments might also overlap on more than one point, when they lie on the same straight line. What should we do in such cases? Throwing another exception?</p>\n\n<p>The algebraic types approach is to design a type covering all the cases:</p>\n\n<pre class=\"lang-scala prettyprint-override\"><code>sealed trait Intersection\ncase object NoIntersection extends Intersection\ncase class SinglePoint(p: Point) extends Intersection\ncase class SegmentPortion(s: Segment) extends Intersection\n\ndef intersect(s1: Segment, s2: Segment): Intersection\n</code></pre>\n\n<p>There are many practical cases where such approach feels quite natural. In some other languages lacking algebraic types, one has to resort to exceptions, to <code>null</code>s (also see <a href=\"https://en.wikipedia.org/wiki/Null_pointer#History\" rel=\"nofollow\">the billion-dollar mistake</a>), to non-sealed classes (making it impossible for the compiler to check for exhaustiveness of pattern matching), or to other features provided by the language. Arguably, the \"best\" option in OOP is to use the <a href=\"https://en.wikipedia.org/wiki/Visitor_pattern\" rel=\"nofollow\">Visitor pattern</a> to encode algebraic types and pattern matching in languages which have no such features. Still, having that directly supported in the language, as in scala, is much more convenient.</p>\n"}], "owner": {"reputation": 176396, "user_id": 342235, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/88e5a9eb011a73ab970ddc8cfb05ff85?s=128&d=identicon&r=PG", "display_name": "Freewind", "link": "https://stackoverflow.com/users/342235/freewind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1590, "favorite_count": 7, "answer_count": 2, "score": 13, "last_activity_date": 1505717329, "creation_date": 1438416552, "last_edit_date": 1438622716, "question_id": 31759736, "link": "https://stackoverflow.com/questions/31759736/why-do-we-need-algebraic-data-types", "title": "Why do we need &quot;Algebraic Data Types&quot;?", "body": "<p>I've read some explanation of Algebraic Data Types: </p>\n\n<ul>\n<li><a href=\"http://chris-taylor.github.io/blog/2013/02/10/the-algebra-of-algebraic-data-types/\" rel=\"noreferrer\">The Algebra of Algebraic Data types I</a></li>\n<li><a href=\"http://chris-taylor.github.io/blog/2013/02/11/the-algebra-of-algebraic-data-types-part-ii/\" rel=\"noreferrer\">The Algebra of Algebraic Data types II</a> </li>\n<li><a href=\"http://chris-taylor.github.io/blog/2013/02/13/the-algebra-of-algebraic-data-types-part-iii/\" rel=\"noreferrer\">The Algebra of Algebraic Data types III</a></li>\n<li><a href=\"http://blog.lab49.com/archives/3011\" rel=\"noreferrer\">The Algebra of Data, and Calculus of Mutation</a></li>\n</ul>\n\n<p>These articles give very detail description and code samples.</p>\n\n<p>At first I was thinking Algebraic Data Type was just for defining some types easily and we can match them with pattern matching. But after reading these articles, I found \"pattern matching\" is not even mentioned there, and the content looks interesting but far more complex than I expected.</p>\n\n<p>So I have some questions (which are not answered in these articles):</p>\n\n<ul>\n<li>Why do we need it, say, in Haskell or Scala? </li>\n<li>What we can do if we have it, and what we can't do if we don't have it?</li>\n</ul>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 3, "creation_date": 1438386837, "post_id": 31756715, "comment_id": 51447135, "body": "You might also try upgrading; I think <code>aeson</code> has had <code>Seq</code> instances since 0.8.1.0."}], "answers": [{"comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1438441883, "post_id": 31763309, "comment_id": 51458822, "body": "I saw @&#216;rjan&#39;s comment above that newer versions of <code>aeson</code> already have <code>Seq</code> instances, but I think the above is a general enough technique to merit an answer on its own."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 3, "last_activity_date": 1438441822, "creation_date": 1438441822, "answer_id": 31763309, "question_id": 31756715, "link": "https://stackoverflow.com/questions/31756715/instance-data-sequence-with-haskell-aeson/31763309#31763309", "title": "Instance Data.Sequence with Haskell Aeson", "body": "<p><code>[]</code> and <code>Seq</code> are isomorphic via <code>fromList</code> / <code>toList</code> (they just have vastly different representations and performance characteristics), so the most straightforward way to implement <code>FromJSON</code> and <code>ToJSON</code> for <code>Seq</code> is by re-using the existing implementation for <code>[]</code>:</p>\n\n<pre><code>import qualified Data.Sequence as DS\nimport Data.Foldable as DF\n\ninstance (ToJSON a) =&gt; ToJSON (DS.Seq a) where\n    toJSON = toJSON . DF.toList\n\ninstance (FromJSON a) =&gt; FromJSON (DS.Seq a) where\n    parseJSON = fmap DS.fromList . parseJSON\n</code></pre>\n"}], "owner": {"reputation": 98, "user_id": 1460053, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ucuee.png?s=128&g=1", "display_name": "tonylattke", "link": "https://stackoverflow.com/users/1460053/tonylattke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 31763309, "answer_count": 1, "score": 1, "last_activity_date": 1438441822, "creation_date": 1438385877, "last_edit_date": 1495535443, "question_id": 31756715, "link": "https://stackoverflow.com/questions/31756715/instance-data-sequence-with-haskell-aeson", "title": "Instance Data.Sequence with Haskell Aeson", "body": "<p>I have the next problem with <code>Data.Sequence</code> and Aeson. I want to create my data <code>DraftVar</code> deriving <code>Generic</code>, which use <code>Data.Sequence</code> on the constructor <code>DV2</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, OverloadedStrings #-}\n\n-- Imports\n\nimport Data.Aeson\nimport GHC.Generics\n\nimport qualified Data.Sequence as DS\n\n-- Data\n\ndata DraftVar = \n    DV1 { dv1_val :: Int }\n    | DV2 { dv2_list :: DS.Seq DraftVar }\n    deriving (Show, Generic)\n\ninstance ToJSON DraftVar\ninstance FromJSON DraftVar\n</code></pre>\n\n<p>With this code, I receive and error that says: <code>No instance for (ToJSON (DS.Seq DraftVar))</code>. So I need to create a instance of <code>Data.Sequence</code> for the Aeson library.</p>\n\n<p>On the <code>ToJSON</code> instance declaration, I decide to transform the <code>Data.Sequence</code> to a list. The code is:</p>\n\n<pre><code>import Data.Foldable as DF\n\ninstance (Show a) =&gt; ToJSON (DS.Seq a) where\n    toJSON l = object [ \"values\" .=  show (DF.toList l) ]\n</code></pre>\n\n<p>But what happen, when I want to extract from this Json the list and then transform the data to <code>Data.Sequence</code>?</p>\n\n<pre><code>instance (Show a) =&gt; FromJSON (DS.Seq a) where\n    parseJSON (Object o) = ???\n</code></pre>\n\n<p>Maybe I need a library or an special function from Aeson, I don't know. The most useful example (that I found) is this: <a href=\"https://stackoverflow.com/questions/24742872/parsing-an-array-with-haskell-aeson\">Parsing an Array with Haskell Aeson</a> </p>\n\n<p>Do you have a better approach?</p>\n"}, {"tags": ["haskell", "maybe", "hunit"], "comments": [{"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 1, "creation_date": 1438377949, "post_id": 31755356, "comment_id": 51444427, "body": "<code>$ myLast ([] :: [Int])</code> might do the trick in making the type unambiguous"}, {"owner": {"reputation": 2634, "user_id": 347611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/caa61ca1317e19f4aedacc844e2694b0?s=128&d=identicon&r=PG", "display_name": "Denis Gorodetskiy", "link": "https://stackoverflow.com/users/347611/denis-gorodetskiy"}, "reply_to_user": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438378150, "post_id": 31755356, "comment_id": 51444518, "body": "Thanks! Could you post this as answer so that I mark the question as answered?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438392205, "post_id": 31755356, "comment_id": 51448099, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/30612654/hspec-nothing-expectation-failing-to-compile\">HSpec Nothing expectation failing to compile</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "is_accepted": true, "score": 4, "last_activity_date": 1438379339, "last_edit_date": 1438379339, "creation_date": 1438378250, "answer_id": 31755485, "question_id": 31755356, "link": "https://stackoverflow.com/questions/31755356/how-to-resolve-type-ambiguity-in-this-unit-test/31755485#31755485", "title": "How to resolve type ambiguity in this unit test", "body": "<p>Since the list <code>[]</code> does not have any members, it can only be deduced from type inference that <code>[]</code> is of type <code>[a]</code>.</p>\n\n<p>For a list to be \"showable\" it must be an instance of the typeclass <code>Show</code>. A list is only an instance of <code>Show</code> if the members of the list are also instances of <code>Show</code>. </p>\n\n<p>But the type checker can't deduce the type of <code>[]</code> to a more specific type than <code>[a]</code>. We <em>cannot</em> know if <code>a</code> is an instance of <code>Show</code> so we also <em>cannot</em> know if <code>[a]</code> is in turn an instance of <code>Show</code>.</p>\n\n<p>If we simply <strong>annotate a specific type</strong> <code>([] :: [Int])</code> there will be no error!</p>\n\n<p>This is because we know that <code>Int</code> is an instance of <code>Show</code> and therefore <code>[Int]</code> is also an instance of <code>Show</code>. Now the compiler can infer the necessary information to print the list!</p>\n"}], "owner": {"reputation": 2634, "user_id": 347611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/caa61ca1317e19f4aedacc844e2694b0?s=128&d=identicon&r=PG", "display_name": "Denis Gorodetskiy", "link": "https://stackoverflow.com/users/347611/denis-gorodetskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 31755485, "answer_count": 1, "score": 1, "last_activity_date": 1438379339, "creation_date": 1438377676, "last_edit_date": 1438378822, "question_id": 31755356, "link": "https://stackoverflow.com/questions/31755356/how-to-resolve-type-ambiguity-in-this-unit-test", "title": "How to resolve type ambiguity in this unit test", "body": "<p>I can't figure out how to annotate the mylast3 test properly:</p>\n\n<pre><code>import Test.HUnit\n\nmylast :: [a] -&gt; Maybe a\nmylast [] = Nothing\nmylast [x] = Just x\nmylast (_:xs) = mylast xs\n\ntestsMyLast =\n  [TestCase $ assertEqual \"mylast1\" (Just 1) $ mylast [1],\n   TestCase $ assertEqual \"mylast2\" (Just 'b') $ mylast \"ab\",\n   TestCase $ assertEqual \"mylast3\" Nothing $ mylast []  &lt;== how to test this correctly?\n   ]\n\nmain = do runTestTT $ TestList testsMyLast\n</code></pre>\n\n<p>I'm getting the following error pointing at the line \"TestCase $ assertEqual \"mylast3\":</p>\n\n<blockquote>\n  <p>No instance for (Show a0) arising from a use of assertEqual The type\n  variable a0 is ambiguous</p>\n</blockquote>\n"}, {"tags": ["haskell", "hakyll"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1438942224, "post_id": 31754732, "comment_id": 51668002, "body": "This is potentially a nice feature request. Meanwhile, it might be possible to write a hack of some sort using  <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/System-Environment.html#v:getArgs\" rel=\"nofollow noreferrer\"><code>getArgs</code></a> from <code>System.Environment</code>."}], "owner": {"reputation": 13920, "user_id": 371228, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a4028c5dd749d198d7a8f2601d4afe07?s=128&d=identicon&r=PG", "display_name": "bdesham", "link": "https://stackoverflow.com/users/371228/bdesham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1438942264, "creation_date": 1438374808, "last_edit_date": 1438942264, "question_id": 31754732, "link": "https://stackoverflow.com/questions/31754732/building-a-hakyll-site-in-development-or-release-mode", "title": "Building a Hakyll site in \u201cdevelopment\u201d or \u201crelease\u201d mode", "body": "<p>I am building a site with Hakyll and I only want my Google Analytics code to be included if I am deploying the site, not when I\u2019m just testing it using \u201csite server\u201d. Ideally I\u2019d be able to write something like</p>\n\n<pre><code>$if(deploying)$\n    &lt;script src=\".../whatever.js\"&gt;&lt;/script&gt;\n$endif$\n</code></pre>\n\n<p>in a template and have that content included when I run \u201csite build\u201d but not \u201csite server\u201d. Does Hakyll have any built-in way to determine which subcommand is being run? Or can I somehow access the process\u2019s environment variables?</p>\n"}, {"tags": ["haskell", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1438382775, "post_id": 31756088, "comment_id": 51446129, "body": "On the injective subcategory, even <code>toList</code> is a natural transformation."}, {"owner": {"reputation": 2527, "user_id": 1396134, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85ae7e9104d0484386cbb4ac7791ad8f?s=128&d=identicon&r=PG", "display_name": "raichoo", "link": "https://stackoverflow.com/users/1396134/raichoo"}, "edited": false, "score": 0, "creation_date": 1438416698, "post_id": 31756088, "comment_id": 51452280, "body": "Thanks for the answer! So <code>n&#39;</code> and <code>n</code> form a section/retraction pair here?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 2527, "user_id": 1396134, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85ae7e9104d0484386cbb4ac7791ad8f?s=128&d=identicon&r=PG", "display_name": "raichoo", "link": "https://stackoverflow.com/users/1396134/raichoo"}, "edited": false, "score": 1, "creation_date": 1438450583, "post_id": 31756088, "comment_id": 51460834, "body": "@raichoo Yes, <code>n</code> and <code>n&#39;</code> are a whole family of section/retraction pairs, since <code>n&#39; . n == id</code>. Not all section/retraction pairs will obey the stronger law <code>n&#39; . fmap f . n == fmap f</code>."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 13, "last_activity_date": 1438383039, "last_edit_date": 1495541677, "creation_date": 1438381589, "answer_id": 31756088, "question_id": 31754591, "link": "https://stackoverflow.com/questions/31754591/are-the-natural-transformations-we-apply-on-coyoneda-to-get-a-functor-actually/31756088#31756088", "title": "Are the &quot;natural transformations&quot; we apply on Coyoneda to get a Functor actually &quot;natural transformations&quot;?", "body": "<p>For <code>n</code> to be a natural transfomation in Haskell it needs to obey (for all <code>f</code>)</p>\n\n<pre><code>(fmap f) . n == n . (fmap f)\n</code></pre>\n\n<p>This isn't the case for <code>Set.toList</code>. </p>\n\n<pre><code>fmap (const 0) . Set.toList        $ Set.fromList [1, 2, 3] = [0, 0, 0]\nSet.toList     . Set.map (const 0) $ Set.fromList [1, 2, 3] = [0]\n</code></pre>\n\n<p>Instead it obeys a different set of laws. There is another transformation <code>n'</code> back the other way such that the following holds</p>\n\n<pre><code>n' . (fmap f) . n == fmap f\n</code></pre>\n\n<p>If we choose <code>f = id</code> and apply the functor law <code>fmap id == id</code> we can see that this implies that <code>n' . n == id</code> and therefore we have a similar formula:</p>\n\n<pre><code>(fmap f) . n' . n == n' . (fmap f) . n == n' . n . (fmap f)\n</code></pre>\n\n<p><code>n = Set.toList</code> and <code>n' = Set.fromList</code> obey this law.</p>\n\n<pre><code>Set.map (const 0) . Set.fromList   . Set.toList        $ Set.fromList [1, 2, 3] = fromList [0]\nSet.fromList      . fmap (const 0) . Set.toList        $ Set.fromList [1, 2, 3] = fromList [0]\nSet.fromList      . Set.toList     . Set.map (const 0) $ Set.fromList [1, 2, 3] = fromList [0]\n</code></pre>\n\n<p>I don't know what we can call this other than observing that <code>Set</code> is an equivalence class of lists. <code>Set.toList</code> finds a representative member of the equivalence class and <code>Set.fromList</code> is the quotient.</p>\n\n<p>It's probably worth noting that <code>Set.fromList</code> is a natural transformation. At least it is on the reasonable subcategory of <strong>Hask</strong> where <code>a == b</code> implies <code>f a == f b</code> (here <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:-61--61-\" rel=\"nofollow noreferrer\"><code>==</code></a> is equality from <code>Eq</code>) . This is also the subcategory of <strong>Hask</strong> where <code>Set</code> is a functor; it excludes <a href=\"https://www.fpcomplete.com/user/chad/snippets/random-code-snippets/set-is-not-a-functor\" rel=\"nofollow noreferrer\">degenerate things like this</a>.</p>\n\n<p><a href=\"https://stackoverflow.com/users/745903/leftaroundabout\">leftaroundabout</a> also pointed out that <code>Set.toList</code> is a natural transformation on the subcategory of <strong>Hask</strong> where morphisms are restricted to <a href=\"https://en.wikipedia.org/wiki/Injective_function\" rel=\"nofollow noreferrer\">injective functions where <code>f a == f b</code> implies <code>a == b</code></a>.</p>\n"}], "owner": {"reputation": 2527, "user_id": 1396134, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85ae7e9104d0484386cbb4ac7791ad8f?s=128&d=identicon&r=PG", "display_name": "raichoo", "link": "https://stackoverflow.com/users/1396134/raichoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 1, "accepted_answer_id": 31756088, "answer_count": 1, "score": 14, "last_activity_date": 1438383039, "creation_date": 1438374167, "last_edit_date": 1438375577, "question_id": 31754591, "link": "https://stackoverflow.com/questions/31754591/are-the-natural-transformations-we-apply-on-coyoneda-to-get-a-functor-actually", "title": "Are the &quot;natural transformations&quot; we apply on Coyoneda to get a Functor actually &quot;natural transformations&quot;?", "body": "<p>I have a theoretical question about the nature of a type that is used in\na lot of examples explaining the Coyoneda lemma. They are usually referred to\nas \"natural transformations\" which to my knowledge mappings between functors.\nWhat puzzles me is that in these examples they sometimes map from <code>Set</code> to some functor <code>F</code>. So it does not really semm to be a mapping between functors but something a little more relaxed.</p>\n\n<p>Here is the code in question:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE RankNTypes #-}\nmodule Coyo where\n\nimport           Data.Set (Set)\nimport qualified Data.Set as Set\n\ndata Coyoneda f a where\n  Coyoneda :: (b -&gt; a) -&gt; f b -&gt; Coyoneda f a\n\ninstance Functor (Coyoneda f) where\n  fmap f (Coyoneda c fa) =  Coyoneda (f . c) fa\n\nset :: Set Int\nset = Set.fromList [1,2,3,4]\n\nlift :: f a -&gt; Coyoneda f a\nlift fa = Coyoneda id fa\n\nlower :: Functor f =&gt; Coyoneda f a -&gt; f a\nlower (Coyoneda f fa) = fmap f fa\n\ntype NatT f g = forall a. f a -&gt; g a\n\ncoyoset :: Coyoneda Set Int\ncoyoset = fmap (+1) (lift set)\n\napplyNatT :: NatT f g -&gt; Coyoneda f a -&gt; Coyoneda g a\napplyNatT n (Coyoneda f fa) = Coyoneda f (n fa)\n\n-- Set.toList is used as a \"natural transformation\" here\n-- while it conforms to the type signature of NatT, it\n-- is not a mapping between functors `f` and `g` since\n-- `Set` is not a functor.\nrun :: [Int]\nrun = lower (applyNatT Set.toList coyoset)\n</code></pre>\n\n<p>What am I misunderstanding here?</p>\n\n<p><strong>EDIT:</strong> After a discussion on #haskell in freenode I think I need to clarify my question a little. It's basically: \"What is <code>Set.toList</code> in a\ncategory theoretic sense? Since it is obviously(?) not a natural transformation\".</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438375540, "post_id": 31754481, "comment_id": 51443409, "body": "I think he wanted to know about <code>succ</code> and <code>pred</code> and how they operate on <code>Enum</code> types. I didn&#39;t understand that from his initial question."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1438373687, "creation_date": 1438373687, "answer_id": 31754481, "question_id": 31754011, "link": "https://stackoverflow.com/questions/31754011/how-does-enumfromto-work/31754481#31754481", "title": "How does enumFromTo work?", "body": "<p>Yes, there is a special function that can add to a <code>Char</code>, from the same <code>Enum</code> class that <code>enumFromTo</code> is from, named <code>succ</code>. Beware that it is partial: <code>succ maxBound</code> is undefined, so take care to check the value of the character before you apply <code>succ</code>. <code>succ</code> is indeed the same as <code>\\c -&gt; chr (ord c + 1)</code>, as you can verify with the <code>universe</code> package:</p>\n\n<pre><code>&gt; let avoidMaxBound f x = if x == maxBound then Nothing else Just (f x)\n&gt; avoidMaxBound succ == avoidMaxBound (\\c -&gt; chr (ord c + 1))\nTrue\n</code></pre>\n\n<p>In fact the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Enum.html#Enum\">implementation of <code>succ</code> in GHC</a> is quite close to the function you suggested:</p>\n\n<pre><code>instance  Enum Char  where\n    succ (C# c#)\n       | isTrue# (ord# c# /=# 0x10FFFF#) = C# (chr# (ord# c# +# 1#))\n       | otherwise             = error (\"Prelude.Enum.Char.succ: bad argument\")\n</code></pre>\n\n<p>However, <code>succ</code> is not used in the implementation of <code>enumFromTo</code> in GHC:</p>\n\n<pre><code>instance  Enum Char  where\n    {-# INLINE enumFromTo #-}\n    enumFromTo (C# x) (C# y) = eftChar (ord# x) (ord# y)\n{-# RULES\n\"eftChar\"       [~1] forall x y.        eftChar x y       = build (\\c n -&gt; eftCharFB c n x y)\n#-}\n\n-- We can do better than for Ints because we don't\n-- have hassles about arithmetic overflow at maxBound\n{-# INLINE [0] eftCharFB #-}\neftCharFB :: (Char -&gt; a -&gt; a) -&gt; a -&gt; Int# -&gt; Int# -&gt; a\neftCharFB c n x0 y = go x0\n                 where\n                    go x | isTrue# (x &gt;# y) = n\n                         | otherwise        = C# (chr# x) `c` go (x +# 1#)\n\n{-# NOINLINE [1] eftChar #-}\neftChar :: Int# -&gt; Int# -&gt; String\neftChar x y | isTrue# (x &gt;# y ) = []\n            | otherwise         = C# (chr# x) : eftChar (x +# 1#) y\n</code></pre>\n\n<p>If you can squint past the nastiness that exists primarily for efficiency reasons, you can see that <code>eftChar</code> is essentially using <code>succ</code>, but an inlined version of it rather than an actual call to <code>succ</code> (here, to avoid boxing and re-boxing the <code>Char</code> being manipulated).</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9344614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QtF69.png?s=128&g=1", "display_name": "ben_landau", "link": "https://stackoverflow.com/users/9344614/ben-landau"}, "is_accepted": false, "score": 1, "last_activity_date": 1532176830, "creation_date": 1532176830, "answer_id": 51456173, "question_id": 31754011, "link": "https://stackoverflow.com/questions/31754011/how-does-enumfromto-work/51456173#51456173", "title": "How does enumFromTo work?", "body": "<p>I think you're after the <code>pred</code> and <code>succ</code> methods, which return the predecessor or successor of <code>Enum a</code>. The problem is that for a <code>Bounded</code> <code>Enum</code>, if you apply <code>succ</code> on the maximum member of the set you will get an error. </p>\n\n<p>Bearing this in mind, you can define <code>enumFromTo</code> recursively as so (avoiding dangerous <code>succ</code> calls):  </p>\n\n<pre><code>eftEnum :: (Enum a, Eq a, Ord a) =&gt; a -&gt; a -&gt; [a]\neftEnum a b \n    | a  &gt; b = []\n    | a == b = [a]\n    | otherwise = a : rest \n        where rest = eftEnum (succ a) b\n</code></pre>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 31754481, "answer_count": 2, "score": 7, "last_activity_date": 1532176830, "creation_date": 1438371826, "last_edit_date": 1438375725, "question_id": 31754011, "link": "https://stackoverflow.com/questions/31754011/how-does-enumfromto-work", "title": "How does enumFromTo work?", "body": "<p>I cannot add a number to a <code>Char</code>; the following will fail to compile <code>'a' + 1</code>. But yet, <code>['a'..'z']</code> successfully creates a string in which each of the character value is incremented. Is there a special function that can increment a <code>Char</code>? </p>\n\n<p>I know that I can do <code>chr (ord c + 1)</code>. </p>\n\n<p>How does the <code>['a'..'z']</code> or the underlying <code>enumFromTo</code> function increment the characters in the resulting <code>String</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 1, "creation_date": 1438370817, "post_id": 31753727, "comment_id": 51441116, "body": "You have lived up to your username. Was my implementation correct though?"}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1438371198, "post_id": 31753727, "comment_id": 51441320, "body": "@dopatraman You can compare it to the current <a href=\"https://hackage.haskell.org/package/base-4.7.0.2/docs/src/GHC-Enum.html#enumFromThenTo\" rel=\"nofollow noreferrer\">GHC implementation</a>. Your implementation allows for the parameters to be inverted and still produce an intuitively populated, non-empty list. However some people might expect that <code>[a..b]</code> where <code>a &gt; b</code> to produce the empty set <code>[]</code> given that <code>a</code> and <code>b</code> are of a well-ordered type (<code>Ord</code>) and the implicit assumption of the list syntax is that the list is to be ascending."}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 1, "creation_date": 1438372084, "post_id": 31753727, "comment_id": 51441740, "body": "@dopatraman If you want to test certain properties of the <code>(.:.)</code> function, I recommend implementing a <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck.html\" rel=\"nofollow noreferrer\"><b><code>QuickCheck</code></b></a> property. Examples: <code>propA x y = x &lt;= y &amp;&amp; (.:.) x y == [x..y]</code>. <code>PropB x y = x &gt; y &amp;&amp; (.:.) x y == [x,(x-1)..y]</code>"}], "tags": [], "owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "is_accepted": true, "score": 10, "last_activity_date": 1438379189, "last_edit_date": 1438379189, "creation_date": 1438370738, "answer_id": 31753727, "question_id": 31753677, "link": "https://stackoverflow.com/questions/31753677/reverse-range-implementation/31753727#31753727", "title": "Reverse range implementation", "body": "<p>Try <code>[10,9..1]</code> instead of <code>[10..1]</code></p>\n\n<p><code>[10..1]</code> desugars to <a href=\"https://www.haskell.org/hoogle/?hoogle=enumFromTo\"><strong><code>enumFromTo</code></strong></a></p>\n\n<p><code>[10,9..1]</code> desugars to <a href=\"https://www.haskell.org/hoogle/?hoogle=enumFromThenTo\"><strong><code>enumFromThenTo</code></strong></a></p>\n\n<p><strong>Observe how the functions behave in GHCI:</strong></p>\n\n<pre><code>Prelude&gt; [10..1]\n[]\nPrelude&gt; [10,9..1]\n[10,9,8,7,6,5,4,3,2,1]\nPrelude&gt; :t enumFromTo\nenumFromTo :: Enum a =&gt; a -&gt; a -&gt; [a]\nPrelude&gt; :t enumFromThenTo\nenumFromThenTo :: Enum a =&gt; a -&gt; a -&gt; a -&gt; [a]\nPrelude&gt; enumFromTo 10 1\n[]\nPrelude&gt; :t enumFromThenTo 10 9 1\n[10,9,8,7,6,5,4,3,2,1]\n</code></pre>\n\n<p>The new behavior that you implemented in <code>(.:.)</code> will rarely be a desirable default, as lists generated this way can no longer <strong>always</strong> be assumed to be in <em>ascending</em> order. Hence the necessity to make your <em>descending</em> intention explicit with <code>[x,(pred x)..y]</code> or <code>enumFromThenTo</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438378945, "post_id": 31755372, "comment_id": 51444867, "body": "You articulated he default behavior far better then my brief comment. Nice Examples!"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 6, "last_activity_date": 1438377783, "creation_date": 1438377783, "answer_id": 31755372, "question_id": 31753677, "link": "https://stackoverflow.com/questions/31753677/reverse-range-implementation/31755372#31755372", "title": "Reverse range implementation", "body": "<p>Almost always when you have an expression like <code>[1..n]</code>, and <code>n</code> happens to be 0, you want the value to be <code>[]</code> rather than <code>[1,0]</code>. For example consider</p>\n\n<pre><code>factorial n = product [1..n]\n</code></pre>\n\n<p>Then we want</p>\n\n<pre><code>factorial 0  ~~&gt;  product [1..0]  ~~&gt;  product []  ~~&gt;  1   -- correct\n</code></pre>\n\n<p>not</p>\n\n<pre><code>factorial 0  ~~&gt;  product [1..0]  ~~&gt;  product [1,0]  ~~&gt;  0   -- oops\n</code></pre>\n\n<p>That's why <code>[m..n]</code> does not produce a descending list when <code>m &gt; n</code>.</p>\n\n<p>(If <code>m &gt;= n+2</code> (for example if in <code>[1..n]</code>, <code>n</code> is negative) then it's quite likely an error condition and arguably <code>[m..n]</code> ought to be an error; but it's still defined by the language standard to be <code>[]</code>.)</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 3, "accepted_answer_id": 31753727, "answer_count": 2, "score": 10, "last_activity_date": 1438379189, "creation_date": 1438370526, "last_edit_date": 1438372052, "question_id": 31753677, "link": "https://stackoverflow.com/questions/31753677/reverse-range-implementation", "title": "Reverse range implementation", "body": "<p>For the record, I'm a Haskell noob. I'm trying to understand why a range can be declared as </p>\n\n<pre><code>[1..10] -- yields [1,2,3,4,5,6,7,8,9,10]\n</code></pre>\n\n<p>and not</p>\n\n<pre><code>[10..1] -- yields []\n</code></pre>\n\n<p>It seems simple enough to implement it like this:</p>\n\n<pre><code>(.:.) :: Enum a =&gt; a -&gt; a -&gt; [a]\n(.:.) a b =\n   | a == b = []\n   | a &gt; b = a : (a - 1) .:. b\n   | a &lt; b = a : (a + 1) .:. b\n</code></pre>\n\n<p>What am I not understanding here?</p>\n"}, {"tags": ["haskell", "math", "tex"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1438341832, "post_id": 31744834, "comment_id": 51423331, "body": "<a href=\"https://github.com/leftaroundabout/Symbolic-math-HaTeX\" rel=\"nofollow noreferrer\">github.com/leftaroundabout/Symbolic-math-HaTeX</a>. It&#39;s not really finished and I haven&#39;t worked on it in a while, but it demonstrates \u201cboth output to LaTeX and Haskell\u201d is not so far-fetched: write the formulas as more or less ordinary Haskell code, and let the <code>MathematicalLaTeXT_</code> eDSL monad produce LaTeX code from it."}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 1, "creation_date": 1438342225, "post_id": 31744834, "comment_id": 51423563, "body": "There&#39;s a lot of prior work in this area, see <i>Maple</i> or <i>Mathematica</i> or <i>Sage</i> or one of many other <i>computer-algebra systems</i>.  These cover part of the ground you are interested in exploring.  But I think you should let go of the idea of their being one true canonical form -- my memory grows dim but I recall there being a fundamental theorem of mathematical logic that there isn&#39;t, and can&#39;t be, a single canonical form to represent any expression of a system such as <i>mathematics</i>.  Think <code>x^2-1</code> <i>vs</i> <code>(x+1)(x-1)</code>."}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1438342613, "post_id": 31744834, "comment_id": 51423764, "body": "@HighPerformanceMark Thanks for your input. What you pointed out with <code>f1(x) = x^2-1</code> vs <code>f2(x) = (x+1)(x-1)</code> is not an issue, quite the opposite: once you have them both spelled out in their own <i>canonical</i> form, you could then check that both <code>f1</code> and <code>f2</code> actually output the same result for any <code>x</code>. My own memory grows dim in regards to <i>Mathematica</i> and the like, so it&#39;s time for a refresher."}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1438343287, "post_id": 31744834, "comment_id": 51424181, "body": "@leftaroundabout I like the idea behind HaTeX and your project (I actually recently started working on a Ruby equivalent). I think your comment could definitely be considered as an (at least partial) answer."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1438343682, "post_id": 31744834, "comment_id": 51424443, "body": "@NicolasMattia: well, let&#39;s first see whether somebody has a <i>full</i> answer!"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1438345002, "post_id": 31745795, "comment_id": 51425318, "body": "Just so nobady gets disappointed upon finding out: the ML in MathML has nothing to do with <a href=\"https://en.wikipedia.org/wiki/ML_%28programming_language%29\" rel=\"nofollow noreferrer\">ML</a>, but with XML."}, {"owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1438351646, "post_id": 31745795, "comment_id": 51429953, "body": "That Content MathML is very interesting. While reading about it I&#39;ve also come across OpenMath, which seems to have even more range. I&#39;ll keep looking and see if any such translation tool exists; otherwise I guess it&#39;s time to write one."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "edited": false, "score": 0, "creation_date": 1438362886, "post_id": 31745795, "comment_id": 51436947, "body": "@NicolasMattia I think your edit should be a separate answer; you <i>are</i> allowed to answer your own questions."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 4, "last_activity_date": 1438355696, "last_edit_date": 1492086869, "creation_date": 1438344368, "answer_id": 31745795, "question_id": 31744834, "link": "https://stackoverflow.com/questions/31744834/mathematical-formulas-parsing-and-canonical-programming-form/31745795#31745795", "title": "Mathematical formulas: parsing and canonical *programming* form", "body": "<p>The standard computer representation of mathematical notation is <a href=\"http://www.w3.org/Math/\" rel=\"nofollow noreferrer\">MathML</a>. Note that it includes both <a href=\"http://www.w3.org/TR/MathML2/chapter3.html\" rel=\"nofollow noreferrer\">Presentation MathML</a>, which represents the way mathematical expressions are written and can be <a href=\"https://tex.stackexchange.com/a/85643/5584\">converted to LaTeX</a>, and <a href=\"http://www.w3.org/TR/MathML3/chapter4.html\" rel=\"nofollow noreferrer\">Content MathML</a> which is intended to represent the <em>meaning</em> of expressions and is what you'd need for translation to Haskell or another programming language (but I don't know of any tool which does such translation).</p>\n\n<p>Of course, you wouldn't want to write (either flavor of) MathML manually; there are some editors which produce it, but I can't recommend one.</p>\n\n<p>Otherwise, <a href=\"http://www.openmath.org/overview/index.html\" rel=\"nofollow noreferrer\">OpenMath</a> could be an option. It seems to be oriented exactly towards people \"working with mathematics on computer\".</p>\n"}], "owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1438355696, "creation_date": 1438341279, "question_id": 31744834, "link": "https://stackoverflow.com/questions/31744834/mathematical-formulas-parsing-and-canonical-programming-form", "title": "Mathematical formulas: parsing and canonical *programming* form", "body": "<p><strong>Is there any conventional format to represent a mathematical formula, that could be read by a computer?</strong></p>\n\n<p>I'm working on some mathematical problems, and have some kind of TDD approach to it. Every time I get stuck in a proof (or simply that I have no proof yet, but some intuition of what the result should be), I tend to write a little program to check that everything so far behaves as I'm thinking it does. I usually write a Haskell function for some intermediary result in my proof, play with it through <code>GHCi</code> until I'm convinced I'm still going in the right direction.</p>\n\n<p>My absolute ideal would be to have some canonical form for math formulas which I could, using some tool, both output to LaTeX and Haskell. I could run QuickTest on it, and if a step is wrong, it would tell me. LaTeX's mathematical notations are actually pretty close to a <em>canonical</em> form, though a lot is inferred by the reader (you don't want to explicitly write <strong>every</strong> parentheses). </p>\n\n<p>This ideal tool seems too good to be true; rather, what would be the correct way to spell out a mathematical formula for a computer, possibly parsing it as well? While looking around, I saw a lot for simple formulas using solely <code>*</code>,<code>+</code>,<code>-</code>,<code>/</code> and the like. Nothing encompassing things like sums (e.g. over sets), derivatives, all the \"cool\" stuff. Moreover, the output of such parsers are mostly used to calculate a result, giving some values for the variables; not for translating it to other languages (language agnostic, I guess). It seems like something like this should either already exist, or there should be a good reason why not. Which one did I miss?</p>\n"}, {"tags": ["function", "haskell", "types", "definition"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 6, "creation_date": 1438339922, "post_id": 31744124, "comment_id": 51422152, "body": "have a look at <a href=\"https://www.haskell.org/hoogle/?hoogle=compare\" rel=\"nofollow noreferrer\">hoogle</a> and search for: <code>sortBy</code>, <code>compare</code>, <code>on</code> and <code>snd</code> - you can puzzle those together to get exactly what you want (by puzzle together I really am talking about <i>composing</i> )"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438344676, "post_id": 31744124, "comment_id": 51425114, "body": "@Carsten: That could have been an answer. :D"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438348591, "post_id": 31744124, "comment_id": 51427749, "body": "@Zeta yours has a bit more info though ;) (+1)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1438392152, "post_id": 31744124, "comment_id": 51448091, "body": "@Carsten: Still, this is getting into a habit: you <a href=\"http://stackoverflow.com/questions/30612654/hspec-nothing-expectation-failing-to-compile/30617137#comment49292172_30612654\">post a comment</a>, and I write a community wiki answer based on that comment :D."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1438390280, "post_id": 31745845, "comment_id": 51447772, "body": "There should be more Literate Haskell answers like this one :)"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 7, "last_activity_date": 1438378705, "last_edit_date": 1438378705, "creation_date": 1438344508, "answer_id": 31745845, "question_id": 31744124, "link": "https://stackoverflow.com/questions/31744124/writing-a-function-from-definitions/31745845#31745845", "title": "Writing a function from definitions?", "body": "<p>Note: This post is written in literate Haskell. You can save it as <code>Team.lhs</code> and try it. That being said, it's basically a longer version of Carsten's comment. If you still try to figure things out, use hoogle and look for the functions, although it's fine if you manage things with <code>sortBy</code> solely first. </p>\n\n<hr>\n\n<p>First of all, we're going to work on lists, so you want to import <code>Data.List</code>. </p>\n\n<pre><code>&gt; module Team where\n&gt; import Data.List\n</code></pre>\n\n<p>It contains a function called <code>sortBy</code>:</p>\n\n<pre><code>sortBy :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>The first argument of <code>sortBy</code> should be a function that compares two elements of your list and returns </p>\n\n<ul>\n<li><code>LT</code> if the first is less than the second,</li>\n<li><code>EQ</code> if the both are equal,</li>\n<li><code>GT</code> if the first is greater than the second.</li>\n</ul>\n\n<p>So we need something that that takes two teams and returns their ordering:</p>\n\n<pre><code>&gt; -- Repeating your types for completeness\n&gt; type TName  = String\n&gt; type Points = [Int]\n&gt; type Team   = (TName, Points)\n&gt;\n&gt; compareTeams :: Team -&gt; Team -&gt; Ordering\n</code></pre>\n\n<p>Now, you want to compare teams based on their sum of their points. You don't need their name, so you can capture just the second part of the pair:</p>\n\n<pre><code>&gt; compareTeams (_, s1) (_, s2) =\n</code></pre>\n\n<p>We need the sum of the points, so we define <code>sum1</code> and <code>sum2</code> to be the respective sums of the teams:</p>\n\n<pre><code>&gt;       let sum1 = sum s1\n&gt;           sum2 = sum s2\n</code></pre>\n\n<p>Now we can compare those sums:</p>\n\n<pre><code>        in if sum1 &lt; sum2 \n             then LT\n             else if sum1 == sum2 \n                     then EQ\n                     else GT\n</code></pre>\n\n<p>However, that's rather verbose, and there's already a function that has type <code>Ord a =&gt; a -&gt; a -&gt; Ordering</code>. It's called <code>compare</code> and part of the <code>Prelude</code>:</p>\n\n<pre><code>&gt;       in sum1 `compare` sum2\n</code></pre>\n\n<p>That's a lot more concise. Now we can define <code>sortTeams</code> easily:</p>\n\n<pre><code>&gt; sortTeams :: [Team] -&gt; [Team]\n&gt; sortTeams = sortBy compareTeams\n</code></pre>\n\n<p>And that's it, we're done! </p>\n\n<hr>\n\n<p>Fine, I lied, we're not 100% done. The module <code>Data.Ord</code> contains a function called <code>comparing</code> that's rather handy:</p>\n\n<pre><code>comparing :: Ord b =&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; Ordering\ncomparing f x y = f x `compare` f y -- or similar\n</code></pre>\n\n<p>Together with <code>snd</code> and <code>sum</code> you can define <code>sortTeams</code> in a single line:</p>\n\n<pre><code>sortTeams = sortBy (comparing $ sum . snd)\n</code></pre>\n\n<p>The alternative <code>on</code> mentioned by Carsten is <code>on</code> from <code>Data.Function</code>:</p>\n\n<pre><code>sortTeams = sortBy (compare `on` sum . snd)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5177414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7301620bdf6b13fa03f84faec19c02d1?s=128&d=identicon&r=PG", "display_name": "Steven H", "link": "https://stackoverflow.com/users/5177414/steven-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 31745845, "answer_count": 1, "score": 1, "last_activity_date": 1438378705, "creation_date": 1438339029, "last_edit_date": 1438361807, "question_id": 31744124, "link": "https://stackoverflow.com/questions/31744124/writing-a-function-from-definitions", "title": "Writing a function from definitions?", "body": "<p>First off, I would like to make you all aware that I'm very new to Haskell, so to increase knowledge etc, I've been trying out questions and I'm pretty stuck on one. I think I'm nearly there but some more experienced advice would be appreciated. Here's the question: </p>\n\n<p>A sporting team is represented by it's name and the amount of points they scored in their last games like so <code>(\"Newcastle\",[3,3,3,0])</code>. This data is modelled by the type definitions:</p>\n\n<pre><code>type TName = String\ntype Points = [Int]\ntype Team = (TName,Points)\n</code></pre>\n\n<p>From this I have to define the following function that orders one team higher than another if their points sum is greater:</p>\n\n<pre><code>sortPoints :: [Team] -&gt; [Team]\n</code></pre>\n\n<p>This is what I've tried:</p>\n\n<pre><code>sortPoints :: [Team] -&gt; [Team]\nsortPoints [_,()] -&gt; []\nsortPoints [_,(x:xs)] = sum[x|x&lt;-xs]\n</code></pre>\n\n<p>Once I get to here, I'm not too sure how to go about adding the conditions to check the points sum, any pointers would be greatly appreciated as I'm still coming to terms with a lot of Haskell features.</p>\n"}, {"tags": ["linux", "haskell", "cross-compiling"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438333015, "post_id": 31742068, "comment_id": 51417993, "body": "You&#39;re on Windows and want to cross-compile for Linux? Or do you want to know how to package your (on Linux) compiled executable for distribution?"}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438333925, "post_id": 31742068, "comment_id": 51418533, "body": "@Zeta please see update"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1438335317, "post_id": 31742068, "comment_id": 51419366, "body": "This is non-trivial: <a href=\"https://ghc.haskell.org/trac/ghc/wiki/CrossCompilation\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/CrossCompilation</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1438335609, "post_id": 31742068, "comment_id": 51419551, "body": "@melpomene: That&#39;s the old guide. Simon Marlow has posted a new one on <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Building/CrossCompiling\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/Building/CrossCompiling</a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438335670, "post_id": 31742068, "comment_id": 51419586, "body": "@Zeta First sentence in my link: &quot;This page contains the design notes for cross compilation. For instructions on how to actually do it, see <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Building/CrossCompiling\" rel=\"nofollow noreferrer\">Building/CrossCompiling</a>.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1438335470, "post_id": 31742583, "comment_id": 51419466, "body": "Yeah, a service like travis together with an automatic deploy to the GitHub releases is probably <i>a lot</i> easier than cross-compiling from Windows to Linux. I remember that <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9589#comment:8\" rel=\"nofollow noreferrer\">cross-compiling to Pi</a> wasn&#39;t easy, and as soon as additional dependencies turn up, <a href=\"https://www.reddit.com/r/haskell/comments/3bbp7v/whats_the_current_state_for_crosscompiling/\" rel=\"nofollow noreferrer\">it gets <b>really</b> messy</a>."}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438335665, "post_id": 31742583, "comment_id": 51419583, "body": "@Zeta thanks for the Pi link, as running on Pi is my eventual intention."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 2, "last_activity_date": 1438334516, "creation_date": 1438334516, "answer_id": 31742583, "question_id": 31742068, "link": "https://stackoverflow.com/questions/31742068/how-to-package-haskell-project-for-linux-use/31742583#31742583", "title": "How to package Haskell project for Linux use", "body": "<p>Building a single binary file that works across all common distributions is a challenging task at best. People like <a href=\"http://joeyh.name/blog/entry/completely_linux_distribution-independent_packaging/\" rel=\"nofollow\">Joey Hess managed to pull that through</a>, but it is generally not recommended.</p>\n\n<p>One option is to upload your code to <a href=\"http://hackage.haskell.org/\" rel=\"nofollow\">hackage</a>, instruct your users to install the <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow\">Haskell Platform</a> (which, if you stay compatible with older releases of GHC, is as easy as running <code>apt-get install haskell-platform</code> on Debian-based distributions) and then run <code>cabal install SparkSetup</code>.</p>\n\n<p>In order to make sure your package builds with a variety of compilers, you can use <a href=\"https://github.com/hvr/multi-ghc-travis\" rel=\"nofollow\">Herbert\u2019s excellent travis setup</a>, at least as long as your code is on GitHub.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438338814, "post_id": 31743641, "comment_id": 51421483, "body": "Seems like there are some issues with stack+docker on Windows: <i>&quot;While Docker does support non-Linux operating systems through the boot2docker VM, there are issues with host volume mounting that prevent stack from being usable in this configuration.&quot;</i> So OP needs to use stack in the VM. At that point he&#39;s essentially compiling from Linux (VM) to Linux (native)."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438339139, "post_id": 31743641, "comment_id": 51421674, "body": "@Zeta Hmm, your are right on that. But still you get an easy way to &quot;package&quot; and &quot;distribute&quot; stuff if you use docker, at least for Mac OS X and Linux: you give your users less than 100 bytes in the form of a command line. And total guarantees, or a lot of them at least..."}], "tags": [], "owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "is_accepted": false, "score": 0, "last_activity_date": 1438337428, "creation_date": 1438337428, "answer_id": 31743641, "question_id": 31742068, "link": "https://stackoverflow.com/questions/31742068/how-to-package-haskell-project-for-linux-use/31743641#31743641", "title": "How to package Haskell project for Linux use", "body": "<p>If you want to distribute something binary that works with minimum hassle almost everywhere and is super-easy to install, you can always use Docker. Also, check <a href=\"https://github.com/commercialhaskell/stack/wiki/Docker\" rel=\"nofollow\">stack</a>, they seem to provide quite good support for this type of things. </p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 31742583, "answer_count": 2, "score": 1, "last_activity_date": 1438337428, "creation_date": 1438332976, "last_edit_date": 1438335094, "question_id": 31742068, "link": "https://stackoverflow.com/questions/31742068/how-to-package-haskell-project-for-linux-use", "title": "How to package Haskell project for Linux use", "body": "<p>This my setup.cabal file : </p>\n\n<pre><code>-- Initial SparkSetup.cabal generated by cabal init.  For further \n-- documentation, see http://haskell.org/cabal/users-guide/\n\nname:                SparkSetup\nversion:             0.1.0.0\n-- synopsis:            \n-- description:         \n-- license:             \nlicense-file:        LICENSE\nauthor:              user\nmaintainer:          user\n-- copyright:           \n-- category:            \nbuild-type:          Simple\n-- extra-source-files:  \ncabal-version:       &gt;=1.10\n\nexecutable SparkSetup\n  -- main-is:             \n  -- other-modules:       \n  -- other-extensions:    \n  build-depends:       base &gt;=4.7 &amp;&amp; &lt;4.8\n  -- hs-source-dirs:      \n  default-language:    Haskell2010\n</code></pre>\n\n<p>When run <code>cabal build</code> this generates a SparkSetup.exe file in dist folder which can be executed directly. Is there something similar of Linux ? Can a .sh file be generated which will package the Haskell code to be executed on Linux ?</p>\n\n<p>Update : I'm on Windows and want to cross compile for Linux / Unix</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1438326055, "post_id": 31739619, "comment_id": 51414073, "body": "if I get you right you are interested in finding out for yourself right? In this case: the <b>monad you are searching</b> is named <code>State</code> - on <a href=\"https://wiki.haskell.org/State_Monad\" rel=\"nofollow noreferrer\">haskelWiki</a> is a nice overview and of course you don&#39;t have to implement it yourself - you can use <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-State-Strict.html#t:State\" rel=\"nofollow noreferrer\"><code>State</code> from the mtl package</a>"}, {"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1438326172, "post_id": 31739619, "comment_id": 51414138, "body": "yes, I want to find out for myself, thanks!"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1438324868, "creation_date": 1438324868, "question_id": 31739619, "link": "https://stackoverflow.com/questions/31739619/how-can-i-simplify-code-that-maintains-state", "title": "how can I simplify code that maintains state?", "body": "<p>I have code below that traverses a graph, and it maintains a map that represents this graph, so it has to return this map as part of the function value.</p>\n\n<p>I am a novice in haskell and I do not know if I can use a monad of some sort that would allow me to hide these details and avoid returning state explicitly. And if I can use a monad then I do not know which and how. Please help.</p>\n\n<pre><code>expand k m =\n    case Map.lookup k m of\n      Just (Complete x) -&gt; (x, m)\n      Just (Initial x)  -&gt; let m0 = Map.adjust (const $ Visited x) k m\n                               (x', m1) = traverse x m0\n                               m2 = Map.adjust (const $ Complete x') k m1\n                           in (x', m2)\n      Just (Visited _)  -&gt; error (\"circular reference: \" ++ k)\n      Nothing           -&gt; error (\"name not found: \" ++ k)\n    where\n      traverse (Name k) m = expand k m\n      traverse (Or x y) m = let (x', m0) = traverse x m\n                                (y', m1) = traverse y m0\n                            in (Or x' y', m1)\n      traverse (Not x) m  = let (x', m') = traverse x m\n                            in  (Not x', m')\n</code></pre>\n"}, {"tags": ["haskell", "clojure", "functional-programming", "combinators"], "comments": [{"owner": {"reputation": 19466, "user_id": 2258453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee75df17db85f17e2418a80ad872dc5b?s=128&d=identicon&r=PG", "display_name": "noisesmith", "link": "https://stackoverflow.com/users/2258453/noisesmith"}, "edited": false, "score": 4, "creation_date": 1438321144, "post_id": 31737087, "comment_id": 51412008, "body": "maybe ` (defn on [g f] #(apply g (map f %&amp;)))` in clojure&#39;s varargs-if-possible spirit"}], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 1793234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8YMI.jpg?s=128&g=1", "display_name": "yurrriq", "link": "https://stackoverflow.com/users/1793234/yurrriq"}, "edited": false, "score": 0, "creation_date": 1438384957, "post_id": 31755514, "comment_id": 51446757, "body": "The varargs version of <code>on</code> rubs me the wrong way... Am I reading it correctly that <code>((on = mod 2) x y)</code> is equivalent to <code>(= (mod x 2) (mod y 2))</code>? I like the Haskell version fine, since (<code>mod</code> 2) is explicit about the order of the arguments, but in Clojure I would have expected <code>(mod 2 x)</code> not <code>(mod x 2)</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 633, "user_id": 1793234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8YMI.jpg?s=128&g=1", "display_name": "yurrriq", "link": "https://stackoverflow.com/users/1793234/yurrriq"}, "edited": false, "score": 1, "creation_date": 1438385167, "post_id": 31755514, "comment_id": 51446808, "body": "@EricBailey Pasted an old version with a <code>(fn [x y])</code> missing, sorry. As for the varargs order, mine is definitely the order that fits with other partial-applying functions. Compare, eg, <code>(swap! x &#47; 10)</code>: that&#39;s converted to <code>(swap! x #(&#47; % 10))</code>, not <code>(swap! x #(&#47; 10 %))</code>. It may look unnatural if you are used to haskell, but this order is useful much more often than the alternative."}, {"owner": {"reputation": 633, "user_id": 1793234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8YMI.jpg?s=128&g=1", "display_name": "yurrriq", "link": "https://stackoverflow.com/users/1793234/yurrriq"}, "edited": false, "score": 0, "creation_date": 1438385184, "post_id": 31755514, "comment_id": 51446810, "body": "On second thought, <code>(mod x 2)</code> makes more sense in Clojure, I just don&#39;t have any desire for the varargs version."}, {"owner": {"reputation": 633, "user_id": 1793234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8YMI.jpg?s=128&g=1", "display_name": "yurrriq", "link": "https://stackoverflow.com/users/1793234/yurrriq"}, "edited": false, "score": 1, "creation_date": 1438385250, "post_id": 31755514, "comment_id": 51446827, "body": "Either way, you&#39;ve answered my question and given me some food for thought. Thanks!"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 4, "last_activity_date": 1438385012, "last_edit_date": 1438385012, "creation_date": 1438378389, "answer_id": 31755514, "question_id": 31737087, "link": "https://stackoverflow.com/questions/31737087/in-clojure-is-there-a-function-like-haskells-on/31755514#31755514", "title": "In Clojure, is there a function like Haskell&#39;s on?", "body": "<p>No, there is no built-in that does what you are looking for. If you are going to implement it, though, I think you can afford to be a little more generic, since Clojure has vararg support and lacks currying:</p>\n\n<pre><code>(defn on\n  ([f g]\n     (fn [x y]\n       (f (g x)\n          (g y))))\n  ([f g &amp; args]\n     (on f #(apply g % args))))\n</code></pre>\n\n<p>This lets you write something like</p>\n\n<pre><code>(defn same-parity? [x y]\n  ((on = mod 2) x y))\n</code></pre>\n\n<p>which of course is easy in Haskell too, as</p>\n\n<pre><code>sameParity :: (Integral a) =&gt; a -&gt; a -&gt; Bool\nsameParity = (==) `on` (`mod` 2)\n</code></pre>\n\n<p>But in Clojure the partial application of mod is a little trickier, so it's customary to provide equivalent functionality via &amp;args if you can.</p>\n"}], "owner": {"reputation": 633, "user_id": 1793234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f8YMI.jpg?s=128&g=1", "display_name": "yurrriq", "link": "https://stackoverflow.com/users/1793234/yurrriq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 31755514, "answer_count": 1, "score": 11, "last_activity_date": 1438385012, "creation_date": 1438308997, "last_edit_date": 1438321981, "question_id": 31737087, "link": "https://stackoverflow.com/questions/31737087/in-clojure-is-there-a-function-like-haskells-on", "title": "In Clojure, is there a function like Haskell&#39;s on?", "body": "<p>In Haskell, we have <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Function.html#v:on\" rel=\"noreferrer\"><code>Data.Function.on</code></a>:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>on :: (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c\n(.*.) `on` f = \\x y -&gt; f x .*. f y\n</code></pre>\n\n<p>In Clojure, I want to be able to define, for example,\nan anagram predicate as follows:</p>\n\n<pre class=\"lang-clojure prettyprint-override\"><code>(defn anagram? [word other-word]\n  (and (not= word other-word)\n       ((on = sort) word other-word)))\n</code></pre>\n\n<p>It's trivial to implement:</p>\n\n<pre class=\"lang-clojure prettyprint-override\"><code>(defn on [g f] (fn [x y] (g (f x) (f y))))\n</code></pre>\n\n<p>But is there any built-in function\nthat accomplishes the same goal?\nI can't seem to find one.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 8, "creation_date": 1438307226, "post_id": 31736467, "comment_id": 51408569, "body": "Do not use 99 Haskell problems as an indication of Haskell idiom! They&#39;re (often badly) translated versions of Lisp problems translated from Prolog. They ask for arguments in the wrong order all the time, and ask for things that just seem silly in a typed language."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 14, "last_activity_date": 1438305485, "creation_date": 1438305485, "answer_id": 31736641, "question_id": 31736467, "link": "https://stackoverflow.com/questions/31736467/is-there-significance-in-the-order-of-haskell-function-parameters/31736641#31736641", "title": "Is there significance in the order of Haskell function parameters?", "body": "<p>One of the reasons functions are written this way is because their curried forms turn out to be useful.</p>\n\n<p>For example, consider the functions <code>map</code> and <code>filter</code>:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nfilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>If I wanted to keep the even numbers in a list and then divide them by 2, I could write:</p>\n\n<pre><code>myfunc :: [Int] -&gt; [Int]\nmyfunc as = map (`div` 2) (filter even as)\n</code></pre>\n\n<p>which may also be written this way:</p>\n\n<pre><code>myfunc = map (`div` 2) . filter even\n         \\___ 2 ____/    \\___ 1 ___/\n</code></pre>\n\n<p>Envision this as a pipeline going from right to left:</p>\n\n<ul>\n<li>first we keep the even numbers (step 1)</li>\n<li>then we divide each number by 2 (step 2)</li>\n</ul>\n\n<p>The <code>.</code> operator at as a way of joining pipeline segments together - much like how the <code>|</code> operator works in the Unix shell.</p>\n\n<p>This is all possible because the list argument for <code>map</code> and <code>filter</code> are the last parameters to those functions.</p>\n\n<p>If you write your <code>dropEvery</code> with this signature:</p>\n\n<pre><code>dropEvery :: Int -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>then we can include it in one of these pipelines, e.g.:</p>\n\n<pre><code>myfunc2 = dropEvery 3 . map (`div` 2) . filter even\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1438323113, "post_id": 31738041, "comment_id": 51412630, "body": "By usage patterns <code>div</code>, <code>mod</code>, and <code>(!!)</code> seem to have their parameters in the wrong order"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1438324140, "post_id": 31738041, "comment_id": 51413104, "body": "@luqui Yes, but there are other reasons for their parameter order. <code>div</code> and <code>mod</code> are too related to existing symbology from mathematics (and other programming languages) to want to reverse the order. Plus with infix operator it&#39;s pretty much as easy to leave out the first argument as the second."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 12, "last_activity_date": 1438324295, "last_edit_date": 1438324295, "creation_date": 1438316504, "answer_id": 31738041, "question_id": 31736467, "link": "https://stackoverflow.com/questions/31736467/is-there-significance-in-the-order-of-haskell-function-parameters/31738041#31738041", "title": "Is there significance in the order of Haskell function parameters?", "body": "<p>It's common practice in Haskell to order function parameters so that parameters which \"configure\" an operation come first, and the \"main thing being operated on\" comes last. This is often counter intuitive coming from other languages, since it tends to mean you end up passing the \"least important\" information first. It's especially jarring coming from OO where the \"main\" argument is usually the object on which the method is being invoked, occurring so early in in the call that it's out of the parameter list entirely!</p>\n\n<p>There's a method to our madness though. The reason we do this is that partial application (through currying) is so easy and so widely used in Haskell. Say I have a functions like <code>foo :: Some -&gt; Config -&gt; Parameters -&gt; DataStrucutre -&gt; DataStructure</code> and <code>bar :: Differnt -&gt; Config -&gt; DataStructure -&gt; DataStructure</code>. When you're not used to higher-order thinking you just see these as things you call to transform a data structure. But you can <em>also</em> use either of them as a factory for \"DataStructure transformers\": functions of the type <code>DataStructure -&gt; DataStructure</code>.</p>\n\n<p>It's very likely that there are <em>other</em> operations that are configured <em>by</em> such <code>DataStructure -&gt; DataStructure</code> functions; at the very least there's <code>fmap</code> for turning transformers of DataStructures into transformers of functors of DataStructures (lists, Maybes, IOs, etc).</p>\n\n<p>We can take this a bit further sometimes too. Consider <code>foo :: Some -&gt; Config -&gt; Parameters -&gt; DataStructure -&gt; DataStructure</code> again.  If I expect that callers of <code>foo</code> will often call it many times with the same <code>Some</code> and <code>Config</code>, but varying <code>Parameters</code>, then even-more-partial applications become useful.</p>\n\n<p>Of course, even if the parameters are in the \"wrong\" order for my partial application I can still do it, using combinators like <code>flip</code> and/or creating wrapper functions/lambdas. But this results in a lot of \"noise\" in my code, meaning that a reader has to be able to puzzle out what is the \"important\" thing being done and what's just adapting interfaces.</p>\n\n<p>So the basic theory is for a function writer to try to anticipate the usage patterns of the function, and list its arguments in order from \"most stable\" to \"least stable\". This isn't the <em>only</em> consideration of course, and often there are conflicting patterns and no clear \"best\" order.</p>\n\n<p>But \"the order the parameters would be listed in an English sentence describing the function call\" would not be something I would give much weight to in designing a function (and not in other languages either). Haskell code just does not read like English (nor does code in most other programming languages), and trying to make it closer in a few cases doesn't really help.</p>\n\n<p>For your specific examples:</p>\n\n<ol>\n<li><p>For <code>replicate</code>, it seems to me like the <code>a</code> parameter is the \"main\" argument, so I would put it last, as the standard library does. There's not a lot in it though; it doesn't seem <em>very</em> much more useful to choose the number of replications first and have an <code>a -&gt; [a]</code> function than it would be to choose the replicated element first and have an <code>Int -&gt; [a]</code> function.</p></li>\n<li><p><code>dropEvery</code> indeed seems to take it's arguments in a wonky order, but not because we say in English \"drop every Nth element in a list\". Functions that take a data structure and return a \"modified version of the same structure\" should almost always take the data structure as their last argument, with the parameters that configure the \"modification\" coming first. </p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1765, "user_id": 2181660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda83eedd4ccbae9799c1fab98aed7ff?s=128&d=identicon&r=PG", "display_name": "viorior", "link": "https://stackoverflow.com/users/2181660/viorior"}, "is_accepted": false, "score": 0, "last_activity_date": 1438353183, "creation_date": 1438353183, "answer_id": 31748750, "question_id": 31736467, "link": "https://stackoverflow.com/questions/31736467/is-there-significance-in-the-order-of-haskell-function-parameters/31748750#31748750", "title": "Is there significance in the order of Haskell function parameters?", "body": "<p>If you wish to flip arguments, just use <code>flip</code> function from Prelude</p>\n\n<pre><code>replicate' = flip replicate\n\n&gt; :t replicate'\nreplicate' :: a -&gt; Int -&gt; [a]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1439158562, "creation_date": 1439158562, "answer_id": 31909359, "question_id": 31736467, "link": "https://stackoverflow.com/questions/31736467/is-there-significance-in-the-order-of-haskell-function-parameters/31909359#31909359", "title": "Is there significance in the order of Haskell function parameters?", "body": "<p>To add to the other answers, there's also often an incentive to make the last argument be the one whose construction is likely to be most complicated and/or to be a lambda abstraction. This way one can write</p>\n\n<pre><code>f some little bits $\n  big honking calculation\n  over several lines\n</code></pre>\n\n<p>rather than having the big calculation surrounded by parentheses and a few little arguments trailing off at the end.</p>\n"}], "owner": {"reputation": 2059, "user_id": 2014342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1d750dd6866cf8acfccdadc444d3c2a?s=128&d=identicon&r=PG", "display_name": "aanrv", "link": "https://stackoverflow.com/users/2014342/aanrv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 2, "accepted_answer_id": 31736641, "answer_count": 4, "score": 9, "last_activity_date": 1439158562, "creation_date": 1438304083, "question_id": 31736467, "link": "https://stackoverflow.com/questions/31736467/is-there-significance-in-the-order-of-haskell-function-parameters", "title": "Is there significance in the order of Haskell function parameters?", "body": "<p>I've been learning Haskell and I noticed that many of the built in functions accept parameters in an order counter intuitive to what I would expect.  For example:</p>\n\n<pre><code>replicate :: Int -&gt; a -&gt; [a]\n</code></pre>\n\n<p>If I want to replicate 7 twice, I would write <code>replicate 2 7</code>.  But when read out loud in English, the function call feels like it is saying \"Replicate 2, 7 times\". If I would have written the function myself, I would have swapped the first and second arguments so that <code>replicate 7 2</code> would read \"replicate 7, 2 times\".</p>\n\n<p>Some other examples appeared when I was going through <a href=\"https://wiki.haskell.org/H-99:_Ninety-Nine_Haskell_Problems\">99 Haskell Problems</a>. I had to write a function: </p>\n\n<pre><code>dropEvery :: [a] -&gt; Int -&gt; [a]`\n</code></pre>\n\n<p>It takes a list as its first argument and an <code>Int</code> as its second. Intuitively, I would have written the header as <code>dropEvery :: Int -&gt; [a] -&gt; [a]</code> so that <code>dropEvery 3 [1..100]</code> would read as: \"drop every third element in the list <code>[1..100]</code>.  But in the question's example, it would look like: <code>dropEvery [1..100] 3</code>.</p>\n\n<p>I've also seen this with other functions that I cannot find right now. Is it common to write functions in such a way due to a practical reason or is this all just in my head?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438316569, "post_id": 31736048, "comment_id": 51410767, "body": "Cabal sandboxes will probably help, but they in no way ensure consistent package versions. You can get all the same problems in a sandbox that you can get outside one if you try hard enough. People just generally use them for less stuff, so they get less polluted."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438318249, "post_id": 31736048, "comment_id": 51411192, "body": "@DanielWagner They don&#39;t? I don&#39;t actually know since I&#39;ve never had enough problems to start using them (my projects usually end up in a single file), but they seemed to be what everyone was suggesting, so I added a short note about them. Except right now &quot;everyone&quot; might be shifting to stack, I guess."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 4, "last_activity_date": 1438301498, "last_edit_date": 1438301498, "creation_date": 1438301042, "answer_id": 31736048, "question_id": 31735944, "link": "https://stackoverflow.com/questions/31735944/unable-to-satisfy-superclass/31736048#31736048", "title": "Unable to satisfy superclass", "body": "<p>Your code works for me, also GHC 7.8.3.  However, look more carefully at the error message:</p>\n\n<pre><code>Test.hs:22:10:\n    Could not deduce (mtl-2.1.3.1:Control.Monad.State.Class.MonadState\n                        st' (Engine st' m))\n</code></pre>\n\n<p>The explicit package identifiers like <code>mtl-2.1.3.1</code> aren't usually included in errors.  When they <em>are</em>, it means that GHC has loaded two different versions of the package, with equally named but different types and classes.  In this case, one is probably used by <code>lens</code> and the other directly by your module.</p>\n\n<p>Cabal sandboxes is one way of avoiding this (they ensure consistent package versions).</p>\n"}], "owner": {"reputation": 30828, "user_id": 239916, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/950ab2797f3012eeed28559fcdde8e1f?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Eding", "link": "https://stackoverflow.com/users/239916/thomas-eding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 31736048, "answer_count": 1, "score": 3, "last_activity_date": 1438301498, "creation_date": 1438300354, "question_id": 31735944, "link": "https://stackoverflow.com/questions/31735944/unable-to-satisfy-superclass", "title": "Unable to satisfy superclass", "body": "<p>I have the following code, and I cannot figure out why I'm getting the first error shown below. As far as I can tell, the <code>MonadState</code> instance should be satisfied. Even when I explicitly add in the \"non-deducible\" instance character for character in the instance constraint, I still get the error. Is this a bug? How can I solve this problem?</p>\n\n<p>Windows GHC version 7.8.3</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeFamilies #-}\n\nmodule Test where\n\nimport Control.Applicative\nimport Control.Lens\nimport Control.Lens.Internal.Zoom\nimport Control.Monad.State\n\n\nnewtype Engine st m a = Engine {\n    unEngine :: StateT st m a\n} deriving (Functor, Applicative, Monad, MonadState st, MonadTrans, MonadIO)\n\n\ntype instance Zoomed (Engine st m) = Focusing m\n\n\n-- Same error message even with: (Monad m, MonadState st' (Engine st' m)) =&gt;\ninstance (Monad m) =&gt; Zoom (Engine st m) (Engine st' m) st st' where\n    zoom l = Engine . zoom l . unEngine\n</code></pre>\n\n<hr>\n\n<pre><code>Test.hs:22:10:\n    Could not deduce (mtl-2.1.3.1:Control.Monad.State.Class.MonadState\n                        st' (Engine st' m))\n      arising from the superclasses of an instance declaration\n    from the context (Monad m)\n      bound by the instance declaration at Test.hs:22:10-62\n    In the instance declaration for\n      Zoom (Engine st m) (Engine st' m) st st'\n\nTest.hs:23:23:\n    Could not deduce (Zoomed (StateT st' m) ~ Focusing m)\n    from the context (Zoomed (Engine st m) ~ Zoomed (Engine st' m),\n                      mtl-2.1.3.1:Control.Monad.State.Class.MonadState st (Engine st m),\n                      mtl-2.1.3.1:Control.Monad.State.Class.MonadState\n                        st' (Engine st' m),\n                      Monad m)\n      bound by the instance declaration at Test.hs:22:10-62\n    Relevant bindings include\n      l :: LensLike' (Zoomed (Engine st m) c) st' st\n        (bound at Test.hs:23:10)\n      zoom :: LensLike' (Zoomed (Engine st m) c) st' st\n              -&gt; Engine st m c -&gt; Engine st' m c\n        (bound at Test.hs:23:5)\n    In the first argument of `(.)', namely `zoom l'\n    In the second argument of `(.)', namely `zoom l . unEngine'\n    In the expression: Engine . zoom l . unEngine\n\nTest.hs:23:23:\n    Could not deduce (Zoom (StateT st m) (StateT st' m) st st')\n      arising from a use of `zoom'\n    from the context (Zoomed (Engine st m) ~ Zoomed (Engine st' m),\n                      mtl-2.1.3.1:Control.Monad.State.Class.MonadState st (Engine st m),\n                      mtl-2.1.3.1:Control.Monad.State.Class.MonadState\n                        st' (Engine st' m),\n                      Monad m)\n      bound by the instance declaration at Test.hs:22:10-62\n    In the first argument of `(.)', namely `zoom l'\n    In the second argument of `(.)', namely `zoom l . unEngine'\n    In the expression: Engine . zoom l . unEngine\n\nTest.hs:23:28:\n    Could not deduce (Zoomed (StateT st m) ~ Focusing m)\n    from the context (Zoomed (Engine st m) ~ Zoomed (Engine st' m),\n                      mtl-2.1.3.1:Control.Monad.State.Class.MonadState st (Engine st m),\n                      mtl-2.1.3.1:Control.Monad.State.Class.MonadState\n                        st' (Engine st' m),\n                      Monad m)\n      bound by the instance declaration at Test.hs:22:10-62\n    Expected type: LensLike' (Zoomed (StateT st m) c) st' st\n      Actual type: LensLike' (Zoomed (Engine st m) c) st' st\n    Relevant bindings include\n      l :: LensLike' (Zoomed (Engine st m) c) st' st\n        (bound at Test.hs:23:10)\n      zoom :: LensLike' (Zoomed (Engine st m) c) st' st\n              -&gt; Engine st m c -&gt; Engine st' m c\n        (bound at Test.hs:23:5)\n    In the first argument of `zoom', namely `l'\n    In the first argument of `(.)', namely `zoom l'\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "haskell-persistent"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1438392067, "last_edit_date": 1592644375, "creation_date": 1438392067, "answer_id": 31757290, "question_id": 31735685, "link": "https://stackoverflow.com/questions/31735685/persistvalues-for-mongodb-keys-in-yesod-persistent-2/31757290#31757290", "title": "PersistValues for MongoDB Keys in Yesod/Persistent 2", "body": "<p>It seems there is a <a href=\"https://hackage.haskell.org/package/persistent-mongoDB-2.1.2.2/docs/Database-Persist-MongoDB.html#v:keyToOid\" rel=\"nofollow noreferrer\"><code>keyToOid</code></a> function that does approximately what you want in <code>Database.Persist.MongoDB</code>. From the <a href=\"https://hackage.haskell.org/package/persistent-2.1.4/docs/Database-Persist-Class.html#t:ToBackendKey\" rel=\"nofollow noreferrer\">Persistent docs</a>, I gather the change was part of a move towards abstracting keys from backends:</p>\n<blockquote>\n<p><code>class (PersistEntity record, PersistEntityBackend record ~ backend, PersistStore backend) =&gt; ToBackendKey backend record where</code></p>\n<p><code>ToBackendKey</code> converts a <code>PersistEntity Key</code> into a <code>BackendKey</code> This can be used by each backend to convert between a <code>Key</code> and a plain Haskell type.</p>\n</blockquote>\n"}], "owner": {"reputation": 633, "user_id": 672301, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c212a6e98ceb4a47be40f3cd787f39b2?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/672301/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 31757290, "answer_count": 1, "score": 1, "last_activity_date": 1438459991, "creation_date": 1438298499, "last_edit_date": 1438459991, "question_id": 31735685, "link": "https://stackoverflow.com/questions/31735685/persistvalues-for-mongodb-keys-in-yesod-persistent-2", "title": "PersistValues for MongoDB Keys in Yesod/Persistent 2", "body": "<p>I have some code that was doing the following in <code>persistent &lt; 2</code>:</p>\n\n<p><code>(either (\\_ -&gt; 0) id).fromPersistValue.unKey.entityKey $ myEntity</code></p>\n\n<p>How can I achieve the same functionality using <code>persistent &gt; 2</code> as <code>keys</code> are now defined by individual Backends and as such there is no <code>unKey</code> function? Is there still away to achieve these \"Int representations\" for MongoDB keys in newer versions of Persistent?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1438291824, "post_id": 31734389, "comment_id": 51404204, "body": "wouldnt converting from <code>Integral</code> to <code>Num</code> defeat the point of rigid binding?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1438291911, "post_id": 31734389, "comment_id": 51404240, "body": "The second solution, <code>n == x^2</code>, is clearly preferrable. This is actually a case where Haskell&#39;s requirement of explicit type conversion is not just good safety- and inference-wise, but also points at a way the original code was really not very sensible written. (Obviously, this is not the only thing that&#39;s less than optimal in the entire approach!)"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 2, "creation_date": 1438294688, "post_id": 31734389, "comment_id": 51405351, "body": "I would write <code>[n,n-1..1]</code> -- feels a bit cleaner."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 4, "last_activity_date": 1595925330, "last_edit_date": 1595925330, "creation_date": 1438291731, "answer_id": 31734389, "question_id": 31734297, "link": "https://stackoverflow.com/questions/31734297/apply-comparison-between-integral-and-fractional/31734389#31734389", "title": "Apply comparison between Integral and Fractional", "body": "<p>You could add <code>fromIntegral</code> to everything to get <code>Fractional</code>s:</p>\n<pre><code>filter (\\x -&gt; fromIntegral n / fromIntegral x == fromIntegral x) numList\n</code></pre>\n<p>Or just square the number instead:</p>\n<pre><code>filter (\\x -&gt; n == x ^ 2)\n</code></pre>\n<p>Also, your length check shouldn\u2019t be <code>&gt;1</code>. <code>==1</code> would make more sense, but you should use <code>null</code> to avoid having to try every number every time (besides using a faster algorithm in the first place).</p>\n<pre><code>isSquare :: Integral a =&gt; a -&gt; Bool\nisSquare n = not $ null $ filter (\\x -&gt; n == x ^ 2) numList\n    where numList = [n,n-1..1]\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 31734389, "answer_count": 1, "score": 2, "last_activity_date": 1595925330, "creation_date": 1438291336, "last_edit_date": 1438291606, "question_id": 31734297, "link": "https://stackoverflow.com/questions/31734297/apply-comparison-between-integral-and-fractional", "title": "Apply comparison between Integral and Fractional", "body": "<p>I want to check if an <code>Integral</code> is a square:</p>\n\n<pre><code>isSquare :: Integral n =&gt; n -&gt; Bool\nisSquare n = (&gt;1) $ length (filter (\\x -&gt; n / x == x) numList)\n    where numList = reverse [1..n]\n</code></pre>\n\n<p>Apart from whether or not iterating through a list is the right approach here, when I try to compile this function I get the error:</p>\n\n<pre><code>No instance for (Fractional Int) arising from a use of \u2018/\u2019\n</code></pre>\n\n<p>My understanding of this is that since I am binding <code>n</code> to the <code>Integral</code> type, by dividing it I am breaking the function's rigid type construction.  How can I fix my function so that it compiles?</p>\n"}, {"tags": ["haskell", "import", "ghci"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438285641, "post_id": 31732605, "comment_id": 51400980, "body": "Don&#39;t you mean <a href=\"http://learnyouahaskell.com/modules#making-our-own-modules\" rel=\"nofollow noreferrer\">chapter 7</a>?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1438286390, "post_id": 31732605, "comment_id": 51401360, "body": "I&#39;ve only ever been able to load installed modules and modules from the current working directory of ghci  (If you are on windows you might maybe be able to run <code>:!cd</code> to find out the current working directory of ghci)."}, {"owner": {"reputation": 349, "user_id": 1153980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c37063c7e0cc723661232121d50d7c?s=128&d=identicon&r=PG", "display_name": "user1153980", "link": "https://stackoverflow.com/users/1153980/user1153980"}, "edited": false, "score": 0, "creation_date": 1438287139, "post_id": 31732605, "comment_id": 51401770, "body": "Yes, I changed the question to chapter 7.   I have been using an older version of the book in pdf form and it is chapter 6 in that version.     I ran the :! cd command and it points to the same directory that I have been using."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1438287438, "post_id": 31732605, "comment_id": 51401898, "body": "As far as I know, GHCi won&#39;t recognize local files as modules, unless they&#39;re used by a <code>:l</code>oaded file. Create an additional file where you <code>import Geometry</code> and load that one."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1438287518, "post_id": 31732605, "comment_id": 51401940, "body": "@Zeta That sounds like an answer to me (though I guess you can just load <code>Geometry</code> itself without creating a wrapper module)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438325627, "post_id": 31732605, "comment_id": 51413842, "body": "@DanielWagner: I wasn&#39;t sure how to write that down. Also, I didn&#39;t find anything regarding module paths in the report, and I like to source my answers if possible."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438359809, "post_id": 31732605, "comment_id": 51435303, "body": "@Zeta Yes, the Report says nothing about how modules are stored (they could go in a database for all the spec cares!). If you want a canonical source, it will have to be the GHC documentation."}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 1153980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c37063c7e0cc723661232121d50d7c?s=128&d=identicon&r=PG", "display_name": "user1153980", "link": "https://stackoverflow.com/users/1153980/user1153980"}, "edited": false, "score": 0, "creation_date": 1438344904, "post_id": 31739791, "comment_id": 51425243, "body": "Thanks all.  I found the problem.  The pdf file had a line of code that continued onto the next line of text.  The :l oad command was much more helpful with its error message than the import."}, {"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "edited": false, "score": 1, "creation_date": 1491070864, "post_id": 31739791, "comment_id": 73395925, "body": "Thank you for the answer,. Is there a way to make ghc globally aware of a custom module (so you don&#39;t need to navigate to the directory where it lives)?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "edited": false, "score": 0, "creation_date": 1546201988, "post_id": 31739791, "comment_id": 94799657, "body": "@Chris I missed that comment. Did you find an answer meanwhile?"}, {"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "edited": false, "score": 0, "creation_date": 1547112915, "post_id": 31739791, "comment_id": 95082668, "body": "@Zeta not really, but I was advised not to do this anyway and use a sandbox instead."}, {"owner": {"reputation": 13214, "user_id": 6654942, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a688e198bcd36e26a39c248a0f1e82e6?s=128&d=identicon&r=PG&f=1", "display_name": "js2010", "link": "https://stackoverflow.com/users/6654942/js2010"}, "edited": false, "score": 0, "creation_date": 1596308244, "post_id": 31739791, "comment_id": 111772931, "body": "Thanks.  I lost an hour or two on this one.  Modules have to start with a capital letter too.  Same goes for the :module command."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 23, "last_activity_date": 1603471467, "last_edit_date": 1603471467, "creation_date": 1438325560, "answer_id": 31739791, "question_id": 31732605, "link": "https://stackoverflow.com/questions/31732605/how-can-i-import-a-haskell-module-in-ghci/31739791#31739791", "title": "How can I import a Haskell module in GHCi?", "body": "<p>When you use <code>import ModuleName</code> in GHCi, it works (mostly) in the same way <code>import Data.List</code> works: GHC checks your local package database for the module, loads it, and brings its (exported) contents into scope.</p>\n<p>However, <code>Geometry</code> isn't a module of a package installed with <code>ghc-pkg</code>. Therefore, GHC doesn't know that a module <code>Geometry</code> exists at all. Neither does it interactive variant GHCi.</p>\n<p>But if you <code>:l</code>oad a program, things change. GHC will take its used modules into account:</p>\n<pre><code>-- Foo.hs\nmodule Foo where\n\nfoo :: IO ()\nfoo = putStrLn &quot;Hello from foo!&quot;\n</code></pre>\n<pre class=\"lang-hs prettyprint-override\"><code>-- Main.hs\nmodule Main where\nimport Foo (foo)\n\nmain :: IO ()\nmain = foo\n</code></pre>\n<pre class=\"lang-bash prettyprint-override\">$ cd /path/to/your/files\n$ ghci\nGHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; <strong>import Foo</strong>\n\n&lt;no location info&gt;:\n    Could not find module \u2018Foo\u2019\n    It is not a module in the <strong>current program</strong>, or in any known package.\n\nPrelude&gt; :l Main.hs\n[1 of 2] Compiling Foo              ( Foo.hs, interpreted )\n[2 of 2] Compiling Main             ( Main.hs, interpreted )\nOk, modules loaded: Main, Foo.\n*Main&gt; :l Main.hs\n*Main&gt; foo\nHello from foo!\n*Main&gt; <strong>import Foo</strong>\n*Main Foo&gt; -- module now loaded</pre> \n<p>As you can see, importing <code>Foo</code> first failed. However, after we've actually loaded the program that uses <code>Foo</code>, we were able to use <code>import Foo</code> in GHCi.</p>\n<p>So if you want to use <code>import</code> in GHCi, make sure that GHC can find your module, either by including it in a wrapper or installing it. If you just want to load the module itself, use <code>:l</code>oad.</p>\n"}, {"tags": [], "owner": {"reputation": 1165, "user_id": 2990344, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4541d7050a05707748ef30b0529407bd?s=128&d=identicon&r=PG&f=1", "display_name": "xdavidliu", "link": "https://stackoverflow.com/users/2990344/xdavidliu"}, "is_accepted": false, "score": 0, "last_activity_date": 1609910868, "creation_date": 1609910868, "answer_id": 65590669, "question_id": 31732605, "link": "https://stackoverflow.com/questions/31732605/how-can-i-import-a-haskell-module-in-ghci/65590669#65590669", "title": "How can I import a Haskell module in GHCi?", "body": "<p>TLDR: the Learn you a Haskell book fails to mention that you have to <code>:load</code> the <code>Geometry.hs</code> file first. Then <code>:m</code> to go back to <code>Prelude</code> and then <code>import Geometry</code> works.</p>\n"}], "owner": {"reputation": 349, "user_id": 1153980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c37063c7e0cc723661232121d50d7c?s=128&d=identicon&r=PG", "display_name": "user1153980", "link": "https://stackoverflow.com/users/1153980/user1153980"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16677, "favorite_count": 3, "answer_count": 2, "score": 24, "last_activity_date": 1609910868, "creation_date": 1438285099, "last_edit_date": 1495913400, "question_id": 31732605, "link": "https://stackoverflow.com/questions/31732605/how-can-i-import-a-haskell-module-in-ghci", "title": "How can I import a Haskell module in GHCi?", "body": "<p>I am trying to teach myself Haskell from the book Learn You A Haskell for Great Good. I got up to the last section of chapter 7 (Modules), where it tells how to create your own module.  I did a copy and paste of the Geometry module given in the book at the beginning of the section.  The name of the file is Geometry.hs, as the book suggested, and the file is in the bin directory for ghci, which is where I previously was able to successfully do a load using :l for another .hs file.</p>\n\n<p>When I type the following command in GHCi </p>\n\n<pre><code>import Geometry\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Could not find module 'Geometry' It is not a module in the current\n  program or in any known package</p>\n</blockquote>\n\n<p>I must be doing something that is obviously wrong, but I can't figure out what it is.</p>\n"}, {"tags": ["haskell", "bit-manipulation"], "comments": [{"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 5, "creation_date": 1438283201, "post_id": 31731963, "comment_id": 51399667, "body": "You changed a <code>==</code> into a <code>&#47;=</code> -- obviously your code won&#39;t work. (Haskell&#39;s <code>&#47;=</code> is C&#39;s <code>!=</code>, for reference! You just want <code>==</code>.)"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1438283291, "post_id": 31731963, "comment_id": 51399707, "body": "What type did you intend 237 to be?  There are many possible types."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1438283357, "post_id": 31731963, "comment_id": 51399746, "body": "Try something like: <code>main = print (moreHighBits (70000 :: Int))</code> -- the type checker can&#39;t infer which type to use, as <code>.&amp;.</code> and friends apply to all <code>Bits a</code> types."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1438283489, "post_id": 31731963, "comment_id": 51399819, "body": "You could also limit the function by adding a <a href=\"https://wiki.haskell.org/Type_signature\" rel=\"nofollow noreferrer\">signature</a> such as <code>moreHighBits :: Int -&gt; Bool</code> above your definition. In Haskell, function names are in <code>camelCase</code> by convention, and return <code>False</code>/<code>True</code> (of type <code>Bool</code>), not <code>0</code>/<code>1</code>."}, {"owner": {"reputation": 1608, "user_id": 3787144, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/392be72d51169882853bbaaf5a4d7a95?s=128&d=identicon&r=PG&f=1", "display_name": "jorgbrown", "link": "https://stackoverflow.com/users/3787144/jorgbrown"}, "edited": false, "score": 0, "creation_date": 1438284287, "post_id": 31731963, "comment_id": 51400251, "body": "I corrected the /= to be ==, thanks.  Also, I know conceptually this is a boolean return, but for my purposes I actually need the result to be 0 or 1, since this algorithm eventually needs to be generalized to identify which of 4 regions of an integer has the highest # of bits set."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438287867, "post_id": 31731963, "comment_id": 51402148, "body": "@jorgbrown As an aside on design: I don&#39;t think &quot;I want to generalize this algorithm to identify one region out of four&quot; implies &quot;I need the result to be 0 or 1&quot;. This function can still return a <code>Bool</code> just fine, even if you want to use it as a component of your other function; and the other function probably shouldn&#39;t be returning a number anyway, but a value of a custom type like <code>data Region = VeryHigh | High | Low | VeryLow</code>."}, {"owner": {"reputation": 1608, "user_id": 3787144, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/392be72d51169882853bbaaf5a4d7a95?s=128&d=identicon&r=PG&f=1", "display_name": "jorgbrown", "link": "https://stackoverflow.com/users/3787144/jorgbrown"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1438291600, "post_id": 31731963, "comment_id": 51404089, "body": "@DanielWagner yes but I don&#39;t want to call this function from another function; I want to change this function into the other function.  You are right that it should probably be returning an enumerated type, except that it would be nice to be able to retrieve the section of the integer with the most bits set simply by right-shifting. It&#39;s a long story..."}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1438724715, "post_id": 31731963, "comment_id": 51564759, "body": "<a href=\"http://codereview.stackexchange.com/q/46228/27529\">Related from codereview.SE</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1438283738, "post_id": 31732183, "comment_id": 51399931, "body": "I&#39;d rename the function to <code>moreHighBits</code>, following the <a href=\"https://wiki.haskell.org/Programming_guidelines#Naming_Conventions\" rel=\"nofollow noreferrer\">Haskell naming conventions</a>."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1438283865, "post_id": 31732183, "comment_id": 51400003, "body": "I&#39;m not sure if the guards really make sense here - seems like this should just be a boolean expression."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1438283943, "post_id": 31732183, "comment_id": 51400049, "body": "@Cubic I wanted to follow the look and feel of the C function."}, {"owner": {"reputation": 1608, "user_id": 3787144, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/392be72d51169882853bbaaf5a4d7a95?s=128&d=identicon&r=PG&f=1", "display_name": "jorgbrown", "link": "https://stackoverflow.com/users/3787144/jorgbrown"}, "edited": false, "score": 0, "creation_date": 1438292039, "post_id": 31732183, "comment_id": 51404290, "body": "Thanks, @melpomene. For what it&#39;s worth, I had to shrink this down for a competition, and it became ...  <code>m a|a`shiftR`16&lt;1=0|a.&amp;.65535&lt;1=1|0&lt;1=m(a.&amp;.(a-65537))</code>"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 8, "last_activity_date": 1438283594, "creation_date": 1438283594, "answer_id": 31732183, "question_id": 31731963, "link": "https://stackoverflow.com/questions/31731963/how-to-do-bit-shifts-and-masks-in-haskell/31732183#31732183", "title": "how to do bit shifts and masks in haskell?", "body": "<p>Here's a pretty direct translation of your C code to Haskell:</p>\n\n<pre><code>import Data.Word\nimport Data.Bits\n\nmore_high_bits :: Word32 -&gt; Bool\nmore_high_bits a\n    | (a `shiftR` 16) == 0 = False\n    | (a .&amp;. 0xFFFF)  == 0 = True\n    | otherwise            = more_high_bits (a .&amp;. (a - 0x10001))\n</code></pre>\n\n<p>Your attempt has <code>/=</code> where the C version has <code>==</code>, which inverts the condition.</p>\n\n<p><code>a0</code> is the type variable that the type checker automatically created for your use of <code>g 237</code>. It doesn't know which type you mean because <code>237</code> could be any numeric type at all, and <code>g</code> works with all numbers that support bitwise operations and equality. The list of types you could have meant includes (but is not limited to) <code>Int</code>, <code>Integer</code>, <code>Word</code>, ...</p>\n"}], "owner": {"reputation": 1608, "user_id": 3787144, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/392be72d51169882853bbaaf5a4d7a95?s=128&d=identicon&r=PG&f=1", "display_name": "jorgbrown", "link": "https://stackoverflow.com/users/3787144/jorgbrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3323, "favorite_count": 0, "accepted_answer_id": 31732183, "answer_count": 1, "score": 4, "last_activity_date": 1438285522, "creation_date": 1438282821, "last_edit_date": 1438285522, "question_id": 31731963, "link": "https://stackoverflow.com/questions/31731963/how-to-do-bit-shifts-and-masks-in-haskell", "title": "how to do bit shifts and masks in haskell?", "body": "<p>I'm writing a routine to determine whether the high 16 bits of a 32-bit integer have more bits set, or the low bits.</p>\n\n<p>In C, I would write this:</p>\n\n<pre><code>bool more_high_bits(int a) {\n  if ((a &gt;&gt; 16) == 0) return false;    // no high bits\n  if ((a &amp; 0xFFFF) == 0) return true;  // no low bits\n\n  // clear one high bit and one low bit, and ask again\n  return more_high_bits(a&amp;(a - 0x10001));\n}\n</code></pre>\n\n<p>So in Haskell, I'm trying this:</p>\n\n<pre><code>more_high_bits a=if (a `shiftR` 16) /= 0 then 0 else\n                 if ((.&amp;.) a 65535) /= 0 then 1 else\n                 more_high_bits((.&amp;.) a (a-65537))\n</code></pre>\n\n<p>But it just times out.</p>\n\n<p>What am I doing wrong?  What's the more idiomatic way to do this?  Please don't code away the shift or the &amp; because I'd like to know how I \"should\" be using these.</p>\n\n<p>Addendum: I tried this code out on an haskell compiler:</p>\n\n<p><a href=\"http://www.tutorialspoint.com/compile_haskell_online.php\" rel=\"nofollow\">http://www.tutorialspoint.com/compile_haskell_online.php</a></p>\n\n<pre><code>import Data.Bits\n\ng a=if (a `shiftR` 16) == 0 then 0 else\n    if ((.&amp;.) a 65535) == 0 then 1 else\n    g((.&amp;.) a (a-65537))\n\nmain = print (g(237))\n</code></pre>\n\n<p>But it tells me \"No instance for (Bits a0) arising from a use of 'g'\nThe type variable 'a0' is ambiguous\"</p>\n\n<p>What is \"a0\"??</p>\n"}, {"tags": ["haskell", "types", "map-function"], "answers": [{"tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": false, "score": 4, "last_activity_date": 1438282232, "creation_date": 1438282232, "answer_id": 31731798, "question_id": 31731757, "link": "https://stackoverflow.com/questions/31731757/map-a-function-over-a-string/31731798#31731798", "title": "Map a function over a string", "body": "<pre><code>testChar :: Char -&gt; String\ntestChar c = c:c:[]\n\nmyFunc :: String -&gt; String\nmyFunc str = map testChar str\n</code></pre>\n\n<p>These two do not make sense.  <code>testChar</code> maps a <code>Char</code> to a different type, and you expect <code>map</code> to map that function and get the <em>same</em> type out the other side?  <code>myFunc</code> will actually return a <code>[[Char]]</code>, not a <code>[Char]</code>/<code>String</code>.</p>\n\n<p>Perhaps you meant <code>concatMap</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": true, "score": 10, "last_activity_date": 1438285991, "last_edit_date": 1438285991, "creation_date": 1438282769, "answer_id": 31731944, "question_id": 31731757, "link": "https://stackoverflow.com/questions/31731757/map-a-function-over-a-string/31731944#31731944", "title": "Map a function over a string", "body": "<p><code>ghci</code> is your friend:</p>\n\n<pre><code>Prelude&gt; let testChar c = c:c:[]\nPrelude&gt; let myFunc str = map testChar str\nPrelude&gt; :t myFunc\nmyFunc :: [a] -&gt; [[a]]\nPrelude&gt; myFunc \"abc\"\n[\"aa\",\"bb\",\"cc\"]\n</code></pre>\n\n<p>Contrast with:</p>\n\n<pre><code>Prelude&gt; let myFunc' str = concatMap testChar str\nPrelude&gt; :t myFunc'\nmyFunc' :: [b] -&gt; [b]\nPrelude&gt; myFunc' \"abc\"\n\"aabbcc\"\n</code></pre>\n\n<p>Various equivalent ways to write this function:</p>\n\n<pre><code>myFunc' str = concatMap testChar str\nmyFunc' = concatMap testChar\nmyFunc' str = str &gt;&gt;= testChar\nmyFunc' = (&gt;&gt;= testChar)\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3066, "favorite_count": 0, "accepted_answer_id": 31731944, "answer_count": 2, "score": 3, "last_activity_date": 1438285991, "creation_date": 1438282110, "last_edit_date": 1438285135, "question_id": 31731757, "link": "https://stackoverflow.com/questions/31731757/map-a-function-over-a-string", "title": "Map a function over a string", "body": "<p>My understanding is that a <code>String</code> in Haskell is a list of <code>Char</code>acters. So I should be able to map a function <code>Char -&gt; Whatever</code> over a string, right?</p>\n\n<pre><code>testChar :: Char -&gt; String\ntestChar c = c:c:[]\n\nmyFunc :: String -&gt; String\nmyFunc str = map testChar str\n\nmain = do\n    putStrLn $ myFunc \"hi\"\n</code></pre>\n\n<p>When I run this i get:</p>\n\n<pre><code> Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019\n    Expected type: Char -&gt; Char\n      Actual type: Char -&gt; String\n    In the first argument of \u2018map\u2019, namely \u2018testChar\u2019\n    In the expression: map testChar str\n</code></pre>\n\n<p>What am i doing wrong here?</p>\n"}, {"tags": ["sql", "haskell", "esqueleto"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1438275602, "post_id": 31729752, "comment_id": 51395255, "body": "Isn&#39;t that just <code>... &amp;&amp;. (b ^. BIncludeAll ||. b ^. BField2 ==. c ^. CField2)</code>?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1438275746, "post_id": 31729752, "comment_id": 51395345, "body": "It seems unlikely to me this would work, because <code>unless</code> is a Haskell side thing and you&#39;d need it to be something that&#39;s happening in the backend."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438275782, "post_id": 31729752, "comment_id": 51395373, "body": "Shouldn&#39;t you use <code>when_ \u2026 then_</code> in Esqueleto?"}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1438338327, "post_id": 31729752, "comment_id": 51421204, "body": "thanks @melpomene, that&#39;s what I need. Sometimes these queries still puzzle me. (apart from this nice solution in this case, I don&#39;t see why the usage of <code>unless</code> should be a bad idea in esqueleto queries; if someone&#39;s willing to enlighten me ...?)"}], "answers": [{"tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": true, "score": 2, "last_activity_date": 1440803903, "creation_date": 1440803903, "answer_id": 32281096, "question_id": 31729752, "link": "https://stackoverflow.com/questions/31729752/how-to-use-unless-or-when-in-an-esqueleto-query/32281096#32281096", "title": "How to use unless (or when) in an Esqueleto query?", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#v:unless\" rel=\"nofollow\"><code>unless</code></a> expects a <code>Bool</code> as its argument, that means a boolean in the \"Haskell world\". You are passing it <code>unValue $ b ^. BIncludeAll</code>, but <code>b ^. BIncludeAll</code> is not of type <code>Value Bool</code>, it's an <code>SqlExpr (Value Bool)</code>, which represents a boolean expression in the \"database world\". It's an SQL statement that, when evaluated, returns a boolean. The only way to turn <code>SqlExpr (Value Bool)</code> into an actual <code>Value Bool</code> is by calling <code>select $ from $ ...</code>.</p>\n\n<p>As others have noted, the correct way to do this is to just use <code>where_ (b ^. BIncludeAll ||. b ^. BField2 ==. c ^. CField2)</code>.</p>\n"}], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 32281096, "answer_count": 1, "score": 0, "last_activity_date": 1457074232, "creation_date": 1438275327, "last_edit_date": 1457074232, "question_id": 31729752, "link": "https://stackoverflow.com/questions/31729752/how-to-use-unless-or-when-in-an-esqueleto-query", "title": "How to use unless (or when) in an Esqueleto query?", "body": "<p>I build a query that joins a few tables and restricts the result further <em>unless</em> one field called <code>IncludeAll</code> equals <code>True</code>.</p>\n\n<p>I'm trying to write it like this</p>\n\n<pre><code>fetch i = runDb . select . from $ \\(a, b, c) -&gt; do\n  where_ $\n        a ^. AId ==. valkey i\n    &amp;&amp;. b ^. BField1 ==. a ^. AField2\n    &amp;&amp;. c ^. CField1 ==. a ^. AField3\n  unless (unValue $ b ^. BIncludeAll) $\n    where_ $ b ^. BField2 == c ^. CField2\n  return  b\n</code></pre>\n\n<p>But I get the following error</p>\n\n<blockquote>\n  <p>Couldn't match expected type <code>Bool</code> with actual type <code>Database.Esqueleto.Internal.Language.Value Bool</code> in the first argument of <code>unless</code></p>\n</blockquote>\n\n<p>So the <code>unValue</code> somehow does not do the trick. Indeed, something like <code>b ^. BIncludeAll</code> has the type <code>expr (Value a)</code>.</p>\n\n<p>Looking at the <a href=\"https://github.com/prowdsponsor/esqueleto/blob/d153dbd40a090f927da2917d6afd50c26c37e84d/src/Database/Esqueleto/Internal/Sql.hs\" rel=\"nofollow\">definition of <code>SqlExpr</code></a> in the source didn't help me, either:</p>\n\n<p>It's an ADT:</p>\n\n<pre><code> data SqlExpr a where ...\n</code></pre>\n\n<p>PS: I use an SQL backend, but ideally that should not matter, right?</p>\n"}, {"tags": ["haskell", "ocaml", "type-inference", "hindley-milner", "type-synonyms"], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1438270588, "post_id": 31728105, "comment_id": 51392114, "body": "This. <code>Duplicate Endo a</code> is valid if <code>Endo</code> is a <code>data</code> or <code>newtype</code>, but <i>not</i> if it&#39;s just a <code>type</code>."}, {"owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "edited": false, "score": 1, "creation_date": 1438270948, "post_id": 31728105, "comment_id": 51392388, "body": "see <a href=\"https://ghc.haskell.org/trac/ghc/ticket/785\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://stackoverflow.com/questions/4922560/why-doesnt-typesynonyminstances-allow-partially-applied-type-synonyms-to-be-use\">here</a> for more info. the gist is that inference on partially applied synonyms is undecidable"}], "tags": [], "owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "is_accepted": false, "score": 9, "last_activity_date": 1438270475, "creation_date": 1438270475, "answer_id": 31728105, "question_id": 31728077, "link": "https://stackoverflow.com/questions/31728077/whats-wrong-with-my-haskell-type-synonym/31728105#31728105", "title": "What&#39;s wrong with my Haskell type synonym?", "body": "<p>Type synonyms have to be fully applied al all times. You cannot partially apply them.</p>\n\n<p>If you're intent on doing this, you will likely need to newtype it.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 13, "last_activity_date": 1438284424, "last_edit_date": 1495541047, "creation_date": 1438271603, "answer_id": 31728558, "question_id": 31728077, "link": "https://stackoverflow.com/questions/31728077/whats-wrong-with-my-haskell-type-synonym/31728558#31728558", "title": "What&#39;s wrong with my Haskell type synonym?", "body": "<p>As said by Fraser, this kind of stuff can't generally work because type partially applied type synonyms <a href=\"https://stackoverflow.com/a/4923883/745903\">make everything undecidable</a>.</p>\n\n<p>However, if you chuck in the <code>-XLiberalTypeSynonyms</code> extension, GHC will inline the synonyms until it can work out the inference:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; type Endo a = a -&gt; a\nPrelude&gt; type Duplicate w a = w (w a)\nPrelude&gt; type Control a = Duplicate Endo a\n\n&lt;\u200cinteractive&gt;:4:1:\n\u00a0 \u00a0 Type synonym \u2018Endo\u2019 should have 1 argument, but has been given none\n\u00a0 \u00a0 In the type declaration for \u2018Control\u2019\nPrelude&gt; :set -XLiberalTypeSynonyms\nPrelude&gt; type Control a = Duplicate Endo a\n</code></pre>\n"}], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "accepted_answer_id": 31728558, "answer_count": 2, "score": 5, "last_activity_date": 1438284424, "creation_date": 1438270389, "question_id": 31728077, "link": "https://stackoverflow.com/questions/31728077/whats-wrong-with-my-haskell-type-synonym", "title": "What&#39;s wrong with my Haskell type synonym?", "body": "<p>I have two functions for controlling loops, <a href=\"https://en.wikipedia.org/wiki/Control_flow#Continuation_with_next_iteration\" rel=\"noreferrer\"><code>continue</code></a> and <a href=\"https://en.wikipedia.org/wiki/Control_flow#Early_exit_from_loops\" rel=\"noreferrer\"><code>break</code></a>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Control a = (a -&gt; a) -&gt; a -&gt; a\n\ncontinue :: Control a\ncontinue = id\n\nbreak :: Control a\nbreak = const id\n</code></pre>\n\n<p>Then, I wanted to simplify the <code>Control</code> type synonym. Hence, I wrote:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Endo a = a -&gt; a\n\ntype Control a = Endo (Endo a)\n\ncontinue :: Control a\ncontinue = id\n\nbreak :: Control a\nbreak = const id\n</code></pre>\n\n<p>However, when I tried to further simplify it I got an error:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; type Endo a = a -&gt; a\nPrelude&gt; type Duplicate w a = w (w a)\nPrelude&gt; type Control a = Duplicate Endo a\n\n&lt;interactive&gt;:4:1:\n    Type synonym \u2018Endo\u2019 should have 1 argument, but has been given none\n    In the type declaration for \u2018Control\u2019\n</code></pre>\n\n<p>I don't understand why I am getting this error. Perhaps you could enlighten me.</p>\n"}, {"tags": ["haskell", "tree"], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 4618385, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a7435120be391bce02d370802b409272?s=128&d=identicon&r=PG&f=1", "display_name": "maffh", "link": "https://stackoverflow.com/users/4618385/maffh"}, "edited": false, "score": 0, "creation_date": 1438269011, "post_id": 31727202, "comment_id": 51390984, "body": "Thank you for the explaination!"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 12, "last_activity_date": 1438268147, "creation_date": 1438268147, "answer_id": 31727202, "question_id": 31726783, "link": "https://stackoverflow.com/questions/31726783/get-the-root-of-a-rose-tree-in-haskell/31727202#31727202", "title": "Get the root of a Rose tree in Haskell", "body": "<p>The declaration</p>\n\n<pre><code>data Rose a = a :&gt; [Rose a]\n</code></pre>\n\n<p>is basically equivalent to</p>\n\n<pre><code>data Rose a = Node a [Rose a]\n</code></pre>\n\n<p>In other words, <code>Node</code> is a data structure containing a datum and a list of child nodes. But in the definition above, rather than calling it <code>Node</code>, it's called <code>:&gt;</code>. It's just a made-up name; Haskell allows you to create user-defined operators like this.</p>\n\n<p>If the name <code>Node</code> was used, you could write</p>\n\n<pre><code>root (Node datum children) = datum\n</code></pre>\n\n<p>Or, more briefly,</p>\n\n<pre><code>root (Node a rs) = a\n</code></pre>\n\n<p>Since the name given is actually <code>:&gt;</code>, you'd have to write it as</p>\n\n<pre><code>root (a :&gt; rs) = a\n</code></pre>\n\n<p>In particular, you seem to be trying to use <code>Rose</code>, but that's the <em>type constructor</em>, not the <em>value constructor</em>. Similarly, you seem to be trying to use the \"<code>:</code>\" operator, but that's for lists, not rose trees.</p>\n\n<p>Hopefully that clears up some things for you.</p>\n"}], "owner": {"reputation": 249, "user_id": 4618385, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a7435120be391bce02d370802b409272?s=128&d=identicon&r=PG&f=1", "display_name": "maffh", "link": "https://stackoverflow.com/users/4618385/maffh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3341, "favorite_count": 2, "accepted_answer_id": 31727202, "answer_count": 1, "score": 5, "last_activity_date": 1450133559, "creation_date": 1438267061, "last_edit_date": 1438618719, "question_id": 31726783, "link": "https://stackoverflow.com/questions/31726783/get-the-root-of-a-rose-tree-in-haskell", "title": "Get the root of a Rose tree in Haskell", "body": "<p>Recently I started to learn about Haskell, and am struggling with the following exercise: </p>\n\n<pre>\nWrite functions root :: Rose a -> a and children :: Rose a -> [Rose a]\nthat return the value stored at the root of a rose tree, respectively the children of the\nroot of a rose tree.\n</pre>\n\n<p>They gave me the following basic code to start:</p>\n\n<pre>\ndata Rose a = a :> [Rose a]\n    deriving (Eq, Show)\n</pre>\n\n<p>I don't know what (:>) means. I tried to understand it by typing in the ghci </p>\n\n<pre><code>Input: :t (:&gt;)\nOutput: a -&gt; [Rose a] -&gt; Rose a\n</code></pre>\n\n<p>So I think it means that you have an <code>a</code> value, which will be used to lookup <code>Rose a</code> out of a list and returns <code>Rose a</code>, but I'm still confused what to do next.  </p>\n\n<p>If I look at the signature of <code>root :: Rose a -&gt; a</code>, the function would look like this: </p>\n\n<pre><code>root (Rose a) = a \n</code></pre>\n\n<p>And the function of <code>children :: Rose a -&gt; [Rose a]</code>:</p>\n\n<pre><code>children (Rose a) = (Rose a):[]\n</code></pre>\n\n<p>This is not correct, and I don't how to make it correct. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1160, "user_id": 2308076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eDuhX.jpg?s=128&g=1", "display_name": "Magnus", "link": "https://stackoverflow.com/users/2308076/magnus"}, "edited": false, "score": 0, "creation_date": 1438264525, "post_id": 31725525, "comment_id": 51387605, "body": "I just tried to put your first code lines into my ghci, but the declaration of b threw an error already. Maybe you should indicate the version of ghc you are using, and/or try to get the newest version first."}, {"owner": {"reputation": 753, "user_id": 4803555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/987de0ad150cc5d480bde50a580373a4?s=128&d=identicon&r=PG&f=1", "display_name": "Buckeye14Guy", "link": "https://stackoverflow.com/users/4803555/buckeye14guy"}, "reply_to_user": {"reputation": 1160, "user_id": 2308076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eDuhX.jpg?s=128&g=1", "display_name": "Magnus", "link": "https://stackoverflow.com/users/2308076/magnus"}, "edited": false, "score": 0, "creation_date": 1438265742, "post_id": 31725525, "comment_id": 51388524, "body": "@Magnus GHCi, version 7.8.3"}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1438264916, "post_id": 31725778, "comment_id": 51387879, "body": "That, or <code>($3) &lt;$&gt; Just (5+)</code>"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1438265018, "post_id": 31725778, "comment_id": 51387955, "body": "There&#39;s a subtle difference: the OP said they wanted <code>b</code> (and <code>c</code>) to equal <code>Just ((3+) . (5+))</code>, which has the type <code>Num a =&gt; Maybe (a -&gt; a)</code>, not <code>Num a =&gt; Maybe a</code>."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1438265208, "post_id": 31725778, "comment_id": 51388101, "body": "He said he expected them to be like that, I&#39;m not sure that&#39;s what he actually wanted."}, {"owner": {"reputation": 753, "user_id": 4803555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/987de0ad150cc5d480bde50a580373a4?s=128&d=identicon&r=PG&f=1", "display_name": "Buckeye14Guy", "link": "https://stackoverflow.com/users/4803555/buckeye14guy"}, "edited": false, "score": 0, "creation_date": 1438266541, "post_id": 31725778, "comment_id": 51389129, "body": "@Mauris. Thanks for the explanation. <code>fmap (3+) (5+) 1 = 9</code> and since <code>fmap f Just a</code> is defined as <code>Just f a</code> I thought Haskell would give me something line <code>Just (3+) ((5+))</code> and when I call that on 1 I get <code>Just ((3+) ((5+) 1))</code> and get Just 9. But then again Haskell does not use parentheses for function inputs. <b>BTW Cubic</b> Sorry if the questions were not clear but I did want <code>b</code> and <code>c</code> to equal <code>Just ((3+) . (5+))</code>"}, {"owner": {"reputation": 188, "user_id": 1690291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QU6tb.jpg?s=128&g=1", "display_name": "Clay Thomas", "link": "https://stackoverflow.com/users/1690291/clay-thomas"}, "edited": false, "score": 1, "creation_date": 1438267060, "post_id": 31725778, "comment_id": 51389512, "body": "Be careful with your parentheses: <code>Just f a</code> is (probably) a type error. You want <code>Just (f a)</code>."}, {"owner": {"reputation": 753, "user_id": 4803555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/987de0ad150cc5d480bde50a580373a4?s=128&d=identicon&r=PG&f=1", "display_name": "Buckeye14Guy", "link": "https://stackoverflow.com/users/4803555/buckeye14guy"}, "reply_to_user": {"reputation": 188, "user_id": 1690291, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QU6tb.jpg?s=128&g=1", "display_name": "Clay Thomas", "link": "https://stackoverflow.com/users/1690291/clay-thomas"}, "edited": false, "score": 1, "creation_date": 1438267771, "post_id": 31725778, "comment_id": 51390076, "body": "@ClayThomas yes that&#39;s what I meant to type. the <code>Just (3+) ((5+))</code> should also be <code>Just ((3+) ((5+)))</code> even though such thing makes no sense whatsoever."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1438268102, "post_id": 31725778, "comment_id": 51390334, "body": "There&#39;s a difference between <code>(3+)(5+)</code> and <code>(3+).(5+)</code>. The latter is composition of functions; the former is <i>applying</i> <code>(3+)</code> to <code>(5+)</code> (which causes the really confusing type errors you ran into)."}], "tags": [], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "is_accepted": true, "score": 10, "last_activity_date": 1438265104, "last_edit_date": 1438265104, "creation_date": 1438264638, "answer_id": 31725778, "question_id": 31725525, "link": "https://stackoverflow.com/questions/31725525/trying-to-better-understand-the-function-of-applicative-functors-in-haskel/31725778#31725778", "title": "Trying to better understand the (&lt;*&gt;) function of Applicative functors in Haskell", "body": "<p>When you write (expanded)</p>\n\n<pre><code>let b = (3+) &lt;$&gt; Just (5+)\n</code></pre>\n\n<p>The resulting value, by definition of <code>&lt;$&gt;</code> (which is just <code>fmap</code>!) is:</p>\n\n<pre><code>Just (3 + (5+))\n</code></pre>\n\n<p>You're adding a number to a function! This is why you get weird type errors. </p>\n\n<p>Specifically, Haskell is trying desperately to pretend <code>(5+)</code> is a number:</p>\n\n<pre><code>b :: (Num (a -&gt; a), Num a) =&gt; Maybe (a -&gt; a)\n</code></pre>\n\n<p>It's saying, <strong><em>if</strong> there is some crazy type <code>a</code> for which <code>a</code> and <code>(a -&gt; a)</code> are both instances of <code>Num</code>, I could add them together inside the Functor as though they were numbers, and give you a resulting <code>Maybe (a -&gt; a)</code>!</em> Generally, however, functions aren't instances of the <code>Num</code> typeclass, so everything blows up.</p>\n\n<p>You meant to write:</p>\n\n<pre><code>let b = ((3+).) &lt;$&gt; Just (5+)\n</code></pre>\n\n<p>Which indeed works as you expected (<code>b &lt;*&gt; Just 1 == Just 9</code>).</p>\n"}], "owner": {"reputation": 753, "user_id": 4803555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/987de0ad150cc5d480bde50a580373a4?s=128&d=identicon&r=PG&f=1", "display_name": "Buckeye14Guy", "link": "https://stackoverflow.com/users/4803555/buckeye14guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 31725778, "answer_count": 1, "score": 2, "last_activity_date": 1512977371, "creation_date": 1438263976, "last_edit_date": 1512977371, "question_id": 31725525, "link": "https://stackoverflow.com/questions/31725525/trying-to-better-understand-the-function-of-applicative-functors-in-haskel", "title": "Trying to better understand the (&lt;*&gt;) function of Applicative functors in Haskell", "body": "<p>I just finished chapter 11 of the <em>Learn You A Haskell For Great Good</em> and I would like to have a better understanding of Applicative Functors before moving on. I have the following <strong>ghci</strong> code.</p>\n\n<pre><code>let a = Just (5+) -- Instead of mapping + to Just 5\nlet b = (3+) &lt;$&gt; a -- I imported Control.Applicative even though most of these modules are deprecated\nlet c = Just (3+) &lt;*&gt; a -- I expect this to be equivalent to b and :t b, :t c shows that they are the 'same'\na &lt;*&gt; Just 1 -- returns 6 as I expected\n</code></pre>\n\n<p>Now I expect b and c to be: Just ((3+) . (5+)) which means that I could do:</p>\n\n<pre><code>b &lt;*&gt; Just 1 -- and get 9 as in (3+) $ (5+) 1 or ((3+) . (5+)) 1\n</code></pre>\n\n<p>But I get: <strong>No instance for (Num (b0 -> b0)) arising from a use of 'it' In a stmt of an interactive GHCI command: print it</strong>.</p>\n\n<p><strong>Question 1:</strong> what does the restriction as seen in the following imply:</p>\n\n<pre><code>b :: (Num (a -&gt; a), Num a) =&gt; Maybe (a -&gt; a)\n</code></pre>\n\n<p>I thought that just means that &lt;*> can \"extract\" the (a -> a) from 'b'. In my noob mind I know that <strong>Num a</strong> means that 'a' must be an instance of Num but <strong>Num (a -> a)</strong> is not making much sense to me. Does it mean that the (a -> b) inside the Maybe must return an instance of Num?</p>\n\n<p><strong>Question 2:</strong> Isn't everything I've done feasible in the Applicative realm? Is there any obvious ways to print or see the result of 'b &lt;*> Just 1'?</p>\n\n<pre><code>let Just val = b &lt;*&gt; Just 1\n:t val -- returns ((Num (t -&gt; t), Num t) =&gt; t which tells me that val is an instance of Num but then again I am just a beginner so what do I know?\n</code></pre>\n\n<p>Note: I have snapshots of my ghci session and can add them if necessary. I read some related posts but nothing seems to enlighten me.</p>\n"}, {"tags": ["haskell", "uniplate"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 2, "last_activity_date": 1438317472, "creation_date": 1438317472, "answer_id": 31738169, "question_id": 31725183, "link": "https://stackoverflow.com/questions/31725183/deriving-uniplate-with-derive/31738169#31738169", "title": "Deriving Uniplate with Derive", "body": "<p>As the error message says, <code>UniplateDirect</code> doesn't support TH mode of <code>derive</code>, so you have to use the standalone executable version as a preprocessor to generate the <code>Uniplate</code> instance.</p>\n\n<p>You can do this by adding <code>{-! !-}</code> directives, and setting <code>derive</code> as a preprocessor to be run by GHC:</p>\n\n<pre><code>{-# OPTIONS_GHC -F -pgmFderive -optF-F #-}\nimport Data.Generics.Uniplate.Direct\n\ndata Expr = Val Int\n          | Neg Expr\n          | Add Expr Expr\n\n{-!\nderiving instance UniplateDirect Expr\n!-}\n</code></pre>\n\n<p>Loading this into GHCi for a quick test confirms you have your instance:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( SO31725183.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; :i Expr\ndata Expr = Val Int | Neg Expr | Add Expr Expr\n        -- Defined at D:\\cygwin\\tmp\\ghc13224_0\\ghc13224_3.hspp:6:1\ninstance Uniplate Expr\n  -- Defined at D:\\cygwin\\tmp\\ghc13224_0\\ghc13224_3.hspp:16:10\n</code></pre>\n"}], "owner": {"reputation": 3296, "user_id": 2212478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/525e23c4b21cd4187f090b4c893015bb?s=128&d=identicon&r=PG", "display_name": "Benesh", "link": "https://stackoverflow.com/users/2212478/benesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 31738169, "answer_count": 1, "score": 1, "last_activity_date": 1438317472, "creation_date": 1438262976, "question_id": 31725183, "link": "https://stackoverflow.com/questions/31725183/deriving-uniplate-with-derive", "title": "Deriving Uniplate with Derive", "body": "<p>My program is using <a href=\"http://hackage.haskell.org/package/uniplate-1.6.12/docs/Data-Generics-Uniplate-Data.html\" rel=\"nofollow\">Uniplate.Data</a> extensively, and want to improve its performance.</p>\n\n<p>Currently I'm deriving <code>Data</code> instances automatically using the <code>DeriveDataTypeable</code> GHC extension.</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\n\nimport Data.Data\nimport Data.Generics.Uniplate.Data\n\ndata Expr = Val Int\n          | Neg Expr\n          | Add Expr Expr\n  deriving (Data,Typeable)\n</code></pre>\n\n<p>The <a href=\"http://hackage.haskell.org/package/uniplate-1.6.12/docs/Data-Generics-Uniplate-Data.html\" rel=\"nofollow\">Uniplate.Data package description</a> recommend using <a href=\"https://hackage.haskell.org/package/uniplate-1.6.12/docs/Data-Generics-Uniplate-Direct.html\" rel=\"nofollow\">Uniplate.Direct</a> because of superior performance.\nThe latter requires writing explicit <code>Uniplate</code> instances for data types, and recommend the <a href=\"http://hackage.haskell.org/package/derive-2.5.22\" rel=\"nofollow\">Derive</a> tool for that.</p>\n\n<p>When trying to derive instances automatically using <code>Derive</code>:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Data.DeriveTH\nimport Data.Generics.Uniplate.Direct\n\ndata Expr = Val Int\n          | Neg Expr\n          | Add Expr Expr\n\n$( derive makeUniplateDirect ''Expr )\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Exception when trying to run compile-time code:\n  Derivation of UniplateDirect does not yet support Template Haskell, requires info for Expr\nCode: derive makeUniplateDirect ''Expr\n</code></pre>\n\n<p>Is there any other way of deriving <code>Uniplate.Direct</code> instances automatically?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1438263187, "post_id": 31725166, "comment_id": 51386510, "body": "How would you define <code>fold</code> on <code>IO</code>, which is a <code>Functor</code>, but not <code>Foldable</code>?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1438264078, "post_id": 31725166, "comment_id": 51387257, "body": "How is <code>fmap</code> a special case of <code>fold</code>?  I can&#39;t imagine how you would be able to implement either in terms of the other, which is what I think of when I think of &quot;more fundamental&quot;."}, {"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1438264899, "post_id": 31725166, "comment_id": 51387865, "body": "the <code>fmap</code> in my post was a typo. I mean <code>map</code>."}], "answers": [{"comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1438263450, "post_id": 31725257, "comment_id": 51386727, "body": "thanks. this is interesting. I am a beginner, I vaguely understand what you are saying. in general, though, it seems confusing that a <code>Functor</code> is not necessarily a <code>Foldable</code>. Given that <code>map</code> is defined in terms of <code>fold</code>..."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 2, "creation_date": 1438263657, "post_id": 31725257, "comment_id": 51386891, "body": "That&#39;s exactly the reason, though: if <i><code>fold</code> were defined in terms of <code>map</code></i>, then we could define <code>fold</code> for every <code>Functor</code>, since we could use the existing <code>map</code> to get <code>fold</code> for free."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1438264061, "post_id": 31725257, "comment_id": 51387234, "body": "@DietrichEpp&#39;s hinting the right thing; there are <a href=\"http://stackoverflow.com/questions/8359115/haskell-an-example-of-a-foldable-which-is-not-a-functor-or-not-traversable\">possible non-Functor instances of Foldable</a>."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1438264369, "post_id": 31725257, "comment_id": 51387504, "body": "Sorry, confused <code>fold</code> with <code>traverse</code>; fixed the answer accordingly."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 7, "last_activity_date": 1438264353, "last_edit_date": 1495540984, "creation_date": 1438263185, "answer_id": 31725257, "question_id": 31725166, "link": "https://stackoverflow.com/questions/31725166/why-does-the-functor-type-class-not-include-a-fold-method/31725257#31725257", "title": "Why does the Functor type class not include a fold method?", "body": "<p>The abstraction you are looking for is <a href=\"http://hackage.haskell.org/package/base/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\"><code>Foldable</code></a>: This is a type class providing variuos forms of <code>fold</code>.</p>\n\n<p>There is also  <a href=\"http://hackage.haskell.org/package/base/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\"><code>Traversable</code></a> for things where you can \u201cfold while changing\u201d, comparable to the <code>mapAccumL</code> function for lists.</p>\n\n<p>It is actually not true that <code>fmap</code> is a special case of <code>fold</code>, as pointed out by @DietrichEpp, see as here are <a href=\"https://stackoverflow.com/questions/8359115/haskell-an-example-of-a-foldable-which-is-not-a-functor-or-not-traversable\">possible non-Functor instances of Foldable</a>.</p>\n\n<p><code>map</code> is however a special case of <code>mapAccumL</code> (no surprise, given the name), and hence the definition of <code>Traversable</code> requires the thing to be also a <code>Functor</code> and a <code>Foldable</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 3, "creation_date": 1438267157, "post_id": 31726138, "comment_id": 51389586, "body": "I think I see where I was wrong: <code>map</code> is a special case of <code>fold</code> only for lists (maybe for something else) but not in general. Thanks."}, {"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1510590573, "post_id": 31726138, "comment_id": 81488840, "body": "Yeah, <code>fold</code> is way more powerful on lists than on other types (especially something like arbitrary trees).  Formally (ignoring laziness), the list functor is the free monoid functor, which is the left adjoint of the forgetful functor from monoids to sets; the general <code>fold</code> function is then one direction of the hom-set adjunction between the list functor and the forgetful functor.  As such, every monoid homomorphism on lists (which includes <code>map</code>) is given by some instance of <code>fold</code>."}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": true, "score": 13, "last_activity_date": 1438274203, "last_edit_date": 1438274203, "creation_date": 1438265558, "answer_id": 31726138, "question_id": 31725166, "link": "https://stackoverflow.com/questions/31725166/why-does-the-functor-type-class-not-include-a-fold-method/31726138#31726138", "title": "Why does the Functor type class not include a fold method?", "body": "<p>Because a <code>Functor</code> is a very general kind of object; not all <code>Functor</code>s support folds.  For example, there is an instance<sup><a href=\"https://www.fpcomplete.com/user/edwardk/recursion-schemes/catamorphisms\" rel=\"noreferrer\" title=\"School of Haskell\">1</a></sup></p>\n\n<pre><code>instance Functor (a -&gt;) where\n     -- &gt; fmap :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\n     fmap f g = g . f\n</code></pre>\n\n<p>But, while <code>(a -&gt;)</code> is a <code>Functor</code> for all <code>a</code>, for infinite <code>a</code> there isn't a reasonable <code>fold</code> definition.  (Incidentally, a 'fold' in general is a <a href=\"https://www.fpcomplete.com/user/edwardk/recursion-schemes/catamorphisms\" rel=\"noreferrer\" title=\"School of Haskell\">catamorphism</a>, which means it has a different type for each functor.  The <code>Foldable</code> type class defines it for sequence-like types.).</p>\n\n<p>Consider what the <code>foldr</code> definition for <code>Integer -&gt; Integer</code> would look like; what would the outermost application be?  What would the value of</p>\n\n<pre><code>foldr (\\ _ n -&gt; 1 + n) 0 (\\ n -&gt; n + 1)\n</code></pre>\n\n<p>be?  There isn't a reasonable definition of <code>fold</code> without a lot more structure on the argument type.</p>\n\n<p><sup><a href=\"https://www.fpcomplete.com/user/edwardk/recursion-schemes/catamorphisms\" rel=\"noreferrer\" title=\"School of Haskell\">1</a></sup> <code>(a -&gt;)</code> isn't legal Haskell for some reason.  But I'm going to use it anyway as a more readable version of <code>(-&gt;) a</code>, since I think it's easier for a novice to understand.</p>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 31726138, "answer_count": 2, "score": 5, "last_activity_date": 1438274203, "creation_date": 1438262927, "last_edit_date": 1438264871, "question_id": 31725166, "link": "https://stackoverflow.com/questions/31725166/why-does-the-functor-type-class-not-include-a-fold-method", "title": "Why does the Functor type class not include a fold method?", "body": "<p>Why does the type class <code>Functor</code> have only the member<code>fmap</code>? I often find it useful to perform a fold over datatypes. Say, hierarchical ones, like a tree. </p>\n\n<p>Note that a <code>map</code> is a special case of <code>fold</code>, that is, the latter is more fundamental. I guess I can take it the way it is, but maybe there is a reason?</p>\n"}, {"tags": ["haskell", "instance", "typeclass"], "comments": [{"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 3, "creation_date": 1438262951, "post_id": 31724714, "comment_id": 51386346, "body": "This is generally &quot;not done&quot; in Haskell; if you write <code>instance Blank [a] where blank = null</code> you expect this to hold for <i>all</i> <code>[a]</code>, so also for <code>String</code>. You can wrap <code>String</code> in a <a href=\"https://wiki.haskell.org/Newtype\" rel=\"nofollow noreferrer\"><code>newtype</code></a> for which <code>Blank</code> behaves differently, instead."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1438263055, "post_id": 31724714, "comment_id": 51386415, "body": "For an example of this, see <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Applicative.html#t:ZipList\" rel=\"nofollow noreferrer\"><code>ZipList a</code></a>: it&#39;s a type containing exactly one <code>[a]</code> and nothing more, just to give an alternative <code>Applicative</code> instance for lists to the already-defined <code>instance Applicative []</code>."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 4, "creation_date": 1438263141, "post_id": 31724714, "comment_id": 51386470, "body": "Alternatively -- I think this makes sense in your case -- you could go for <code>instance Blank a =&gt; Blank [a] where blank = all blank</code>, and then define <code>instance Blank Char where blank = isSpace</code> :)"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1438263222, "post_id": 31724714, "comment_id": 51386539, "body": "This will then define <code>&quot;   \\r&quot;</code> to be blank, but also <code>[False, False, False]</code> or even <code>[&quot; \\t&quot;, &quot;\\n\\n&quot;]</code> (why?)"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 1, "creation_date": 1438264280, "post_id": 31724714, "comment_id": 51387427, "body": "(For the record, I&#39;ve voted to close because the question is too broad -- the OP wants to do something that you <i>shouldn&#39;t</i> do in Haskell, and is asking for a workaround, on which opinions will definitely differ; as I&#39;ve written in these comments, there are multiple ways to do different, better things.)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1438294459, "post_id": 31732817, "comment_id": 51405270, "body": "This is fairly horrifying for <code>Show</code>, and not, IMO, a good design in general. I think Morris&#39;s <a href=\"http://stackoverflow.com/questions/31724714/string-and-a-instances#comment51386470_31724714\">approach</a> is saner for this purpose."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1438319596, "post_id": 31732817, "comment_id": 51411543, "body": "@dfeuer It depends. In this simple case it is viable, but you may want to use something that cannot be reduce to <code>all blank</code> and a custom definition for <code>blank</code> in which case you need a more general approach like this one. I don&#39;t find it horrifying. Sure, maybe it&#39;s not so elegant however it gets the job done, doesn&#39;t require you to write a lot of code for the &quot;default cases&quot;, it doesn&#39;t need any extension enabled. Can you point out anything wrong/really bad about it?"}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 1, "last_activity_date": 1438285875, "creation_date": 1438285875, "answer_id": 31732817, "question_id": 31724714, "link": "https://stackoverflow.com/questions/31724714/string-and-a-instances/31732817#31732817", "title": "String and [a] instances", "body": "<p>There's a standard trick to achieve what you want in an elegant way.\nIf you think about what you want to do you should remember one standard and very used class that uses this: <code>Show</code>.</p>\n\n<p>Maybe you never thought about how <code>show [1,2,3] == \"[1, 2, 3]\"</code> while <code>show \"hello\" == \"\\\"hello\\\"\"</code>, yet the problem is the same. The way in which this is resolved is by adding a <code>showList :: [a] -&gt; ShowS</code> operation to the <code>Show</code> class, adding a default definition for it, and then provide an instance for generic lists.</p>\n\n<p>In your case you want something like:</p>\n\n<pre><code>import Data.Char(isSpace)\n\nclass Blank a where\n  blank :: a -&gt; Bool\n  blankList :: [a] -&gt; Bool\n  blankList = null\n\ninstance Blank a =&gt; Blank [a] where\n  blank = blankList\n\ninstance Blank Char where\n  blank = isSpace\n\n  blankList [] = True\n  blankList (' ':xs) = blankList xs\n  blankList ('\\t':xs) = blankList xs\n  blankList ('\\n':xs) = blankList xs\n  blankList ('\\r':xs) = blankList xs\n  blankList _ = False\n</code></pre>\n\n<p>In this way whenever you call <code>blank</code> over a list the corresponding <code>blankList</code> method is called. The method used is the one provided by the instance of the <em>elements</em> of the list, and hence the <code>Char</code> instance can define <code>blankList</code> to return <code>True</code> when the list is non-empty but contains only spaces etc while other instances can simply use the default implementation of <code>null</code>.</p>\n\n<p>The downside of this implementation is that you have to put the operations for <code>String</code>s into the instance for <code>Char</code>. However there is no way around it: in Haskell 98/2010 you can have only one instance for type constructor and class so once you define a <code>Blank [a]</code> instance you cannot have other instances using <code>[]</code>, which include <code>String</code>.</p>\n\n<p>Replacing the instance for <code>Blank [a]</code> with an instance for <code>Blank a =&gt; Blank [a]</code> allows you to define only one instance for <code>[]</code> <em>but</em> its behaviour changes depending on the instance for <code>Blank a</code> and thus you can special case <code>String</code>.</p>\n\n<hr>\n\n<p>An alternative solution is to simply <em>not</em> handle <code>String</code>s at all, as already said. You can always define:</p>\n\n<pre><code>newtype MyString = MyString String\n</code></pre>\n\n<p>and then use <code>MyString</code> in place of <code>String</code>.</p>\n"}], "owner": {"reputation": 7353, "user_id": 1378292, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bea4eb8581883ffd109fca9ab95fdb3a?s=128&d=identicon&r=PG", "display_name": "mjgpy3", "link": "https://stackoverflow.com/users/1378292/mjgpy3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1438285875, "creation_date": 1438261707, "last_edit_date": 1438262501, "question_id": 31724714, "link": "https://stackoverflow.com/questions/31724714/string-and-a-instances", "title": "String and [a] instances", "body": "<p>As an exercise, I decided to implement a <code>Blank</code> type class in Haskell (where <code>blank</code> is true when empty, <code>False</code>, or a <code>String</code> of only whitespace). I started, simply, as one might with:</p>\n\n<pre><code>class Blank a where\n  blank :: a -&gt; Bool\n\ninstance Blank Bool where\n  blank = not\n\ninstance Blank [a] where\n  blank = null\n</code></pre>\n\n<p>When I went to implement the <code>String</code> instance:</p>\n\n<pre><code>instance Blank String where\n  blank [] = True\n  blank (' ':xs) = blank xs\n  blank ('\\t':xs) = blank xs\n  blank ('\\n':xs) = blank xs\n  blank ('\\r':xs) = blank xs\n  blank _ = False\n</code></pre>\n\n<p>I was greeted with the error:</p>\n\n<pre><code>Illegal instance declaration for `Blank String'\n  (All instance types must be of the form (T t1 ... tn)\n   where T is not a synonym.\n   Use -XTypeSynonymInstances if you want to disable this.)\nIn the instance declaration for `Blank String'\n</code></pre>\n\n<p>I'm pretty sure it's because <code>[a]</code> and <code>String</code> are redundant, i.e. <code>String</code> (<code>[Char]</code>) is a more specific instance of <code>[a]</code>.</p>\n\n<p>Is there a way get around this and define a more specific instance (i.e. <code>[Char]</code>)?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438262724, "post_id": 31723658, "comment_id": 51386161, "body": "Did you install GHC by hand, or did you use <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow noreferrer\">hvr&#39;s</a> packages? Either way, given that <a href=\"https://downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/release-7-10-2.html\" rel=\"nofollow noreferrer\">7.10.2 fixes a lot of bugs</a> and supplies new library versions (binary and base), you&#39;re probably better of removing <code>~&#47;.cabal</code> and <code>~&#47;.ghc</code>."}, {"owner": {"reputation": 2875, "user_id": 2299477, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/xppB7.jpg?s=128&g=1", "display_name": "Alaya", "link": "https://stackoverflow.com/users/2299477/alaya"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1438262894, "post_id": 31723658, "comment_id": 51386307, "body": "@Zeta I installed by hand..."}], "answers": [{"tags": [], "owner": {"reputation": 20980, "user_id": 241990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/265f1d52e6e484c9abe60b4da20fb8ee?s=128&d=identicon&r=PG", "display_name": "Shaun the Sheep", "link": "https://stackoverflow.com/users/241990/shaun-the-sheep"}, "is_accepted": true, "score": 2, "last_activity_date": 1438263906, "creation_date": 1438263906, "answer_id": 31725502, "question_id": 31723658, "link": "https://stackoverflow.com/questions/31723658/what-do-i-need-to-do-if-i-want-to-install-a-new-version-of-ghc/31725502#31725502", "title": "What do I need to do if I want to install a new version of GHC?", "body": "<p>Yes, you need to reinstall the packages when you update the compiler.</p>\n\n<p>However, if you delete <code>~/.ghc</code> then that removes the packages from GHC's point of view. You can also delete <code>~/.cabal</code> and reinstall everything, but binaries in <code>~/.cabal/bin</code> (including <code>cabal</code>) will usually still work, so often it's easier to keep these and save some time (have a look to see what's there). There might be problems with some - I think some binaries may have the GHC path hard coded internally, so will break, but you can always reinstall them.</p>\n\n<p><code>~/.cabal/packages</code> contains cached downloads so it's up to you whether you delete that. The data will just be pulled down again next time your run cabal. If in doubt just delete it.</p>\n\n<p>You should delete <code>~/.cabal/lib</code> which contains the compiled packages and won't be compatible with a different GHC. Likewise for <code>~/.cabal/share</code>.</p>\n\n<p>Unless you've edited your <code>~/.cabal/config</code> file by hand and want to keep the changes you can delete that too and a new one will be created.</p>\n"}, {"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 2, "last_activity_date": 1438271094, "creation_date": 1438271094, "answer_id": 31728366, "question_id": 31723658, "link": "https://stackoverflow.com/questions/31723658/what-do-i-need-to-do-if-i-want-to-install-a-new-version-of-ghc/31728366#31728366", "title": "What do I need to do if I want to install a new version of GHC?", "body": "<p>You don't <em>need</em> to remove anything. If you install GHC 7.10.2 in the same location that you installed GHC 7.10.1, then all the symlinks <code>ghc</code>, <code>ghci</code>, <code>ghc-pkg</code> etc. will be overwritten to point to 7.10.2, but you can still run the versioned programs <code>ghc-7.10.1</code>, <code>ghci-7.10.1</code>, <code>ghc-pkg-7.10.1</code>, etc., or tell <code>cabal</code> to build with a specific compiler with the <code>-w</code> flag. All libraries and library registration information (whether they came with GHC, are installed in the user package database, or are in a sandbox) are (by default) stored under GHC version-specific subdirectories, so different versions of GHC will not interfere with each other.</p>\n\n<p>If you're not running low on disk space I would suggest not removing GHC 7.10.1. After all 7.10.2 was released just yesterday, and if you encounter a strange issue with 7.10.2, it might be worth checking whether 7.10.1 was also affected.</p>\n"}], "owner": {"reputation": 2875, "user_id": 2299477, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/xppB7.jpg?s=128&g=1", "display_name": "Alaya", "link": "https://stackoverflow.com/users/2299477/alaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 31725502, "answer_count": 2, "score": 5, "last_activity_date": 1438271094, "creation_date": 1438258877, "question_id": 31723658, "link": "https://stackoverflow.com/questions/31723658/what-do-i-need-to-do-if-i-want-to-install-a-new-version-of-ghc", "title": "What do I need to do if I want to install a new version of GHC?", "body": "<p>Currently, I am using <strong>GHC 7.10.1</strong> on my ubuntu 14.04 system, just now I got noticed from mailing list that a new version containing a lot of bug fixes has been released. So I am considering updating my GHC.</p>\n\n<p>I know how to install GHC, however, I have little knowledge about how to deal with packages I have already installed through <code>cabal</code>. It seems that those packages were installed into <code>~/.cabal</code>, for example, libs were installed into <code>~/.cabal/lib/x86_64-linux-ghc-7.10.1</code> and registered in <code>~/.ghc/x86_64-linux-7.10.1</code>.</p>\n\n<p>The path name(...x86_64-linux-7.10.1...) seems to be suggesting that they could only be used by <code>GHC 7.10.1</code>, so if I want to use a new version GHC and remove the old <code>ghc 7.10.1</code> from my system, should I clean them up and reinstall those packages? </p>\n\n<p>for example, should I <code>rm -rf ~/.cabal &amp;&amp; rm -rf ~/.ghc</code> and reinstall both cabal and GHC? or should I just leave those packages there? if so, would those installed packages get reused by the new GHC?</p>\n"}, {"tags": ["haskell", "cabal", "ghci", "winghci"], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 1433688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd6cbfdf904da5b1374d11c1f8fd1b0?s=128&d=identicon&r=PG", "display_name": "user1433688", "link": "https://stackoverflow.com/users/1433688/user1433688"}, "is_accepted": false, "score": 0, "last_activity_date": 1462795422, "last_edit_date": 1462795422, "creation_date": 1462794927, "answer_id": 37115195, "question_id": 31718202, "link": "https://stackoverflow.com/questions/31718202/run-cabal-repl-from-winghci/37115195#37115195", "title": "Run cabal repl from winghci", "body": "<p>You can use <code>:!</code> to execute shell commands. I.e. run <code>:!cabal install mypackage</code> from within the WinGHCi repl. But then you can't <code>import mypackage</code> until you restart WinGHCi. That's my experience at least. I'm interested in an answer as well...</p>\n\n<p>Running <code>:!cabal repl</code> inside WinGHCi repl is just not sensible (which answers the title to your question literally).</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462795422, "creation_date": 1438243122, "last_edit_date": 1457075178, "question_id": 31718202, "link": "https://stackoverflow.com/questions/31718202/run-cabal-repl-from-winghci", "title": "Run cabal repl from winghci", "body": "<p>To include Cabal dependencies I run <code>cabal install mypackage</code></p>\n\n<p>I then run <code>cabal repl</code> and from REPL use <code>import library</code></p>\n\n<p>This allows to use newly added library from GHCi.</p>\n\n<p>Is same possible using WinGhci ? Run a WinGhci REPL which has access to installed Cabal dependencies ?</p>\n"}, {"tags": ["haskell", "operating-system", "daemon", "ghc", "stdio"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1438244016, "post_id": 31716551, "comment_id": 51373973, "body": "Have you tried looking at <code>strace</code> to see if something obvious is wrong?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438255483, "post_id": 31716551, "comment_id": 51381240, "body": "Just to make sure we&#39;re not missing something, but what OS are you using?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1438259382, "post_id": 31716551, "comment_id": 51383862, "body": "This example <a href=\"http://lpaste.net/137599\" rel=\"nofollow noreferrer\">lpaste.net/137599</a> works for me on OSX. I see &quot;HELLO&quot; on the console and I get 1, 2, etc. in the file <code>output</code>. Note that <code>output</code> and <code>error</code> have to first exist."}, {"owner": {"reputation": 2002, "user_id": 1207863, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VxRRc.png?s=128&g=1", "display_name": "Nate Symer", "link": "https://stackoverflow.com/users/1207863/nate-symer"}, "edited": false, "score": 0, "creation_date": 1438262701, "post_id": 31716551, "comment_id": 51386149, "body": "I&#39;m using OS X. It must be something else, as this is a part of a huge piece of software."}, {"owner": {"reputation": 2002, "user_id": 1207863, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VxRRc.png?s=128&g=1", "display_name": "Nate Symer", "link": "https://stackoverflow.com/users/1207863/nate-symer"}, "edited": false, "score": 0, "creation_date": 1438266839, "post_id": 31716551, "comment_id": 51389359, "body": "I ran OS X&#39;s dtrace, and I get the same log whether or not I flush stdout. Then, in my program, I commented out a call to <code>scottyT</code> and suddenly it worked. Any idea why this is?"}], "answers": [{"tags": [], "owner": {"reputation": 2002, "user_id": 1207863, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VxRRc.png?s=128&g=1", "display_name": "Nate Symer", "link": "https://stackoverflow.com/users/1207863/nate-symer"}, "is_accepted": false, "score": 2, "last_activity_date": 1438356655, "last_edit_date": 1438356655, "creation_date": 1438268403, "answer_id": 31727310, "question_id": 31716551, "link": "https://stackoverflow.com/questions/31716551/dupto-oddities-pertaining-to-stdout/31727310#31727310", "title": "dupTo oddities pertaining to STDOUT", "body": "<p>While I haven't solved my problem, these issues with <code>stdout</code> not redirecting properly only appear when my program is daemonized as above; redirecting <code>stdout</code> while the program is not daemonized works as expected, writing to a file I specify.</p>\n\n<p>UPDATE 7.31.15:</p>\n\n<p>It turns out that the stdout handle wasn't buffering properly. After I made the <code>stdout</code> and <code>stderr</code> <code>Handle</code>s stop buffering, everything worked as intended.</p>\n\n<pre><code>hSetBuffering stdout NoBuffering\nhSetBuffering stderr NoBuffering -- for consistency\nhSetBuffering stdin  NoBuffering -- for consistency\n</code></pre>\n"}], "owner": {"reputation": 2002, "user_id": 1207863, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VxRRc.png?s=128&g=1", "display_name": "Nate Symer", "link": "https://stackoverflow.com/users/1207863/nate-symer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1438356655, "creation_date": 1438237590, "last_edit_date": 1438238239, "question_id": 31716551, "link": "https://stackoverflow.com/questions/31716551/dupto-oddities-pertaining-to-stdout", "title": "dupTo oddities pertaining to STDOUT", "body": "<p>I'm writing some code to daemonize a process. Naturally, I want to be able to redirect the STDOUT.</p>\n\n<p>However, once I switch file descriptors around, Haskell's functions for printing don't write anything to my file nor to the console, but calling <code>fdWrite</code> on the newly updated <code>stdOutput</code> file descriptor works as intended.</p>\n\n<p>As a side note, If I use any of Haskell's printing functions (print, hPutStr, etc) before I <code>daemonize'</code>, everything works as intended (stdout gets written to my file)</p>\n\n<p>How do I fix this issue?</p>\n\n<p>Here is how I'm daemonizing:</p>\n\n<pre><code>daemonize' :: Maybe String -&gt; Maybe String -&gt; IO () -&gt; IO () \ndaemonize' outpath errpath program = do\n  forkProcess $ do\n    createSession\n    forkProcess $ do\n      redirectIO outpath errpath\n      blockSignal sigHUP\n      program\n    exitImmediately ExitSuccess\n  exitImmediately ExitSuccess\n\nblockSignal :: Signal -&gt; IO () \nblockSignal sig = installHandler sig Ignore Nothing &gt;&gt; (return ())\n</code></pre>\n\n<p>This is the code that redirects STDOUT:</p>\n\n<pre><code>redirectIO :: Maybe String -&gt; Maybe String -&gt; IO ()\nredirectIO outpath errpath = do\n  dnull &lt;- openFd \"/dev/null\" ReadWrite Nothing defaultFileFlags\n  closeFd stdInput &gt;&gt; dupTo dnull stdInput\n  case outpath of\n    Nothing -&gt; closeFd stdOutput &gt;&gt; dupTo dnull stdOutput &gt;&gt; return ()\n    Just out -&gt; do\n      fdWrite stdOutput \"HELLO\"\n      fd &lt;- openFd out ReadWrite Nothing defaultFileFlags\n      setFdOption fd AppendOnWrite True\n      dupTo fd stdOutput\n      closeFd fd\n  case errpath of\n    Nothing -&gt; closeFd stdError &gt;&gt; dupTo dnull stdError &gt;&gt; return ()\n    Just err -&gt; do\n      fd &lt;- openFd err ReadWrite Nothing defaultFileFlags\n      setFdOption fd AppendOnWrite True\n      dupTo fd stdError\n      closeFd fd\n</code></pre>\n"}]