[{"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 6, "creation_date": 1432761369, "post_id": 30493159, "comment_id": 49064278, "body": "You&#39;re pretty much there. Think about the type of <code>seqList inters val</code> (you don&#39;t always need <code>return :: a -&gt; IO a</code> at the end of a do block)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1432761513, "post_id": 30493159, "comment_id": 49064357, "body": "<code>val</code> is not of type <code>IO a</code>: <code>inter n</code> is."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 4, "creation_date": 1432762005, "post_id": 30493159, "comment_id": 49064599, "body": "IOW you&#39;ve misdiagnosed your problem. nothing wrong with your <code>val</code>, it is indeed of type <code>a</code>, as <code>n</code> is. re-read closely the error message that you get (and next time do please include it in full)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432764315, "post_id": 30493159, "comment_id": 49065551, "body": "The edited version looks right."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1432764911, "post_id": 30493159, "comment_id": 49065743, "body": "Main thing about <code>do</code> blocks is, the type of the whole <code>do</code> expression is the same as each of its lines&#39; type (either  by itself without the <code>&lt;-</code>, or the expressions to the <i>right</i> of <code>&lt;-</code>, excluding the <code>let</code> statements); so all  must be of the same type.   It is <code>(Monad m) =&gt; m a</code> for some monad <code>m</code> and some type <code>a</code>.   Let yourself be guided by the types."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1432776032, "post_id": 30493159, "comment_id": 49068760, "body": "The edited version is right, just commenting that you can change the type signature to <code>seqList :: Monad m =&gt; [a -&gt; m a] -&gt; a -&gt; m a</code> and it will work the same way but also for other monads."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432791697, "post_id": 30493159, "comment_id": 49072878, "body": "You could simplify this to <code>[a -&gt; b] -&gt; a -&gt; [b]</code>, and then things might become clearer."}], "answers": [{"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 1, "last_activity_date": 1432764726, "creation_date": 1432764726, "answer_id": 30493995, "question_id": 30493159, "link": "https://stackoverflow.com/questions/30493159/haskell-sequencelistio-a-io-a-a-io-a/30493995#30493995", "title": "Haskell sequencelistIO [a -&gt; IO a] -&gt; a -&gt; IO a", "body": "<p>Some hints:</p>\n\n<ul>\n<li>Consider the case of having exactly 2 functions in your list and have a look at <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#v:-62--61--62-\" rel=\"nofollow\"><code>&gt;=&gt;</code></a>.</li>\n<li>Have a look at the <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Monoid.html#t:Endo\" rel=\"nofollow\"><code>Endo</code></a> monoid, in particular at the signature of its <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Monoid.html#v:mconcat\" rel=\"nofollow\"><code>mconcat</code></a>. Try replacing <code>Endo a</code> with <code>a -&gt; a</code> in the signature.</li>\n<li><p>How would the instance of the monadic generalization of <code>Endo</code></p>\n\n<pre><code>newtype EndoM m a = EndoM { appEndoM :: a -&gt; m a }\n</code></pre>\n\n<p>look like? What would be its <code>mempty</code> and <code>mappend</code>? What would be its <code>mconcat</code>?</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "is_accepted": false, "score": 2, "last_activity_date": 1432780569, "creation_date": 1432780569, "answer_id": 30496283, "question_id": 30493159, "link": "https://stackoverflow.com/questions/30493159/haskell-sequencelistio-a-io-a-a-io-a/30496283#30496283", "title": "Haskell sequencelistIO [a -&gt; IO a] -&gt; a -&gt; IO a", "body": "<p>The edited version is correct.</p>\n\n<hr>\n\n<p>There's an interesting way of looking at this problem, though. One might analyze the type as follows</p>\n\n<pre><code>type Thing a = a -&gt; IO a\n\nseqList :: [Thing a] -&gt; Thing a\n</code></pre>\n\n<p>In other words, <code>seqList</code> is a mechanism for combining <code>Thing</code>s. If we rewrite your working code a bit we can emphasize this.</p>\n\n<pre><code>seqList :: [Thing a] -&gt; Thing a\nseqList [] n = neutralThing n\nseqList (thingHere : restOfThings) n = do\n  let remainingThing = seqList restOfThings\n  val &lt;- thingHere\n  remainingThing val\n\nneutralThing :: Thing a\nneutralThing a = return a\n</code></pre>\n\n<p>In particular, I've isolated three parts</p>\n\n<ul>\n<li>The neutral thing which is returned when the input list is empty</li>\n<li>The recursive bit which computes the \"remaining thing\" from the tail of the list</li>\n<li>The actual <code>do</code>-notation bit which \"combines\" things.</li>\n</ul>\n\n<p>We can go even further</p>\n\n<pre><code>seqList :: [Thing a] -&gt; Thing a\nseqList [] = neutralThing\nseqList (thingHere : restOfThings) = \n  combineThings thingHere (seqList restOfThings)\n\nneutralThing :: Thing a\nneutralThing a = return a\n\ncombineThings :: Thing a -&gt; Thing a -&gt; Thing a\ncombineThings thing1 thing2 n = do\n  n'  &lt;- thing1 n\n  n'' &lt;- thing2 n'\n  return n''\n</code></pre>\n\n<p>Now we can recognize a general pattern: <code>seqList</code> is just a fold over the list.</p>\n\n<pre><code>seqList :: [Thing a] -&gt; Thing a\nseqList = foldr combineThings neutralThing\n</code></pre>\n\n<p>If we recognize that folds often expose <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Monoid.html\" rel=\"nofollow\"><code>Monoid</code>s</a> we can also detect how <code>Thing a</code> is a monoid for any choice of <code>a</code></p>\n\n<pre><code>memptyThing :: Thing a\nmemptyThing = neutralThing\n\nmappendThing :: Thing a -&gt; Thing a -&gt; Thing a\nmappendThing = combineThings\n</code></pre>\n\n<p>Finally, if we're really clever, we can note that <code>Thing</code> inherits it monoidalness from the slightly more general construction of a <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Category.html\" rel=\"nofollow\"><code>Category</code></a>\u2014in particular, something called the <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Arrow.html#t:Kleisli\" rel=\"nofollow\"><code>Kleisli IO</code> category</a>. If we were to use the <code>Kleisli</code> type itself there would be a lot of wrapping and unwrapping, but instead we can examine the types of <code>return</code> and <code>(&gt;=&gt;)</code> from <code>Control.Monad</code>.</p>\n\n<pre><code>return :: Monad m =&gt; a -&gt; m a\n(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; (a -&gt; m c)\n</code></pre>\n\n<p>With a little care we can see that these types are compatible with <code>memptyThing</code> and <code>mappendThing</code>. So, an ultimate solution to your problem is as follows</p>\n\n<pre><code>seqList :: [Thing a] -&gt; Thing a\nseqList = foldr (&gt;=&gt;) return\n</code></pre>\n\n<p>and we can finally note that this has a more general type if we like</p>\n\n<pre><code>seqList :: Monad m =&gt; [a -&gt; m a] -&gt; (a -&gt; m a)\nseqList = foldr (&gt;=&gt;) return\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 2, "last_activity_date": 1432788990, "last_edit_date": 1432788990, "creation_date": 1432787693, "answer_id": 30497333, "question_id": 30493159, "link": "https://stackoverflow.com/questions/30493159/haskell-sequencelistio-a-io-a-a-io-a/30497333#30497333", "title": "Haskell sequencelistIO [a -&gt; IO a] -&gt; a -&gt; IO a", "body": "<p>Another way to think of it is this: if you had two such actions, how would you chain them together?  <a href=\"https://hackage.haskell.org/package/base-4.6.0.1/docs/Control-Monad.html#v:-62--61--62-\" rel=\"nofollow\">There's an operator in the <code>Control.Monad</code> library that does that</a>.  It shouldn't be too hard to understand:</p>\n\n<pre><code>(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c\nf &gt;=&gt; g = \\a -&gt; do\n    b &lt;- f a\n    g b\n</code></pre>\n\n<p>And if you have that operator, then you can write <code>seqList</code> by taking the the list of actions and basically putting <code>&gt;=&gt;</code> between all of them.  <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-List.html#v:foldr\" rel=\"nofollow\">The standard <code>foldr</code> function</a>, will do the trick; as the documentation says it does precisely that:</p>\n\n<pre><code>foldr f z [x1, x2, ..., xn] == x1 `f` (x2 `f` ... (xn `f` z)...)\n</code></pre>\n\n<p>So put those together, plus <code>return</code> for the empty list case, and you get:</p>\n\n<pre><code>import Control.Monad ((&gt;=&gt;))\n\nseqList :: [a -&gt; IO a] -&gt; a -&gt; IO a\nseqList actions = foldr (&gt;=&gt;) return actions\n</code></pre>\n\n<p>Whose behavior can be described by these equations:</p>\n\n<pre><code>foldr (&gt;=&gt;) return [] == return\nfoldr (&gt;=&gt;) return [x1, ..., xn] == x1 &gt;=&gt; ... &gt;=&gt; xn &gt;=&gt; return\n</code></pre>\n\n<hr>\n\n<p>And let's work it out in more detail!  The definition of <code>foldr</code> is this:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldr _ z [] = z\nfoldr f z (x:xs) = f x (foldr f z xs)\n</code></pre>\n\n<p>So using that, we can rewrite my definition of <code>seqList</code> as such:</p>\n\n<pre><code>-- Use the definition of `foldr` to split this into two cases\nseqList [] = return\nseqList (action:actions) = action &gt;=&gt; foldr (&gt;=&gt;) return actions\n\n-- Use the definition of `&gt;=&gt;` to spell out the second equation\nseqList [] = return\nseqList (action:actions) = \\a -&gt; do\n    val &lt;- action a\n    foldr (&gt;=&gt;) return actions val\n\n-- But by the definition of `seqList`, we can rewrite the last line\n-- to this:\nseqList [] = return\nseqList (action:actions) = \\a -&gt; do\n    val &lt;- action a\n    seqList actions val\n</code></pre>\n\n<p>And that's what you wrote on your second try!</p>\n"}], "owner": {"reputation": 133, "user_id": 3556115, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84298ecd37f0fe0dc7580eb481f6a263?s=128&d=identicon&r=PG&f=1", "display_name": "user3556115", "link": "https://stackoverflow.com/users/3556115/user3556115"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1432788990, "creation_date": 1432760821, "last_edit_date": 1432764122, "question_id": 30493159, "link": "https://stackoverflow.com/questions/30493159/haskell-sequencelistio-a-io-a-a-io-a", "title": "Haskell sequencelistIO [a -&gt; IO a] -&gt; a -&gt; IO a", "body": "<p>I have the following problem:\nI have a task to write a function taking a list of IO interactions and an initial value. The first action takes the initial value as an argument and the function shall pass its result (IO a) as an argument to the next interaction.</p>\n\n<p>The latter expects data of type a, not IO a.\nI don't get how to come over this obstacle.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>seqList :: [a -&gt; IO a] -&gt; a -&gt; IO a\nseqList [] n = return n\nseqList (inter:inters) n = do\n        val &lt;- inter n\n        return $ seqList inters val\n</code></pre>\n\n<p>The problem is that val is of type (IO a) but the next IO expects a.\nI tried something like</p>\n\n<pre><code>tmp &lt;- unsafePerformIO val\n</code></pre>\n\n<p>after val &lt;- ...</p>\n\n<p>but that does not help and would be really bad style.\nHow can I solve this problem?</p>\n\n<p>I want hints, no solutions, </p>\n\n<p>thanks in advance.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I edited it the following way:</p>\n\n<pre><code>seqList :: [a -&gt; IO a] -&gt; a -&gt; IO a\nseqList [] n = return n\nseqList (inter:inters) n = do\n            val &lt;- inter n\n            seqList inters val\n</code></pre>\n\n<p>as seqList inters val is already of the right type.</p>\n\n<p>This should be ok or am I mistaken? It actually works for my examples.</p>\n\n<p>I still am very new to this whole do-notation-monads-io-stuff as it seems.</p>\n\n<p>Thank you very much for the hints.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 2, "creation_date": 1432760767, "post_id": 30492887, "comment_id": 49063965, "body": "A tip: Because your <code>Set e</code> type has only one value constructor with only one field, you may want to use a <code>newtype</code> instead of a <code>data</code> declaration (simply substitute <code>newtype</code> for <code>data</code>); the resulting type will be equivalent, but will involve less overhead than it would with <code>data</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1432766051, "post_id": 30492887, "comment_id": 49066148, "body": "Minor terminology note: in functional programming we rarely say things like &quot;an instance of this data structure&quot;, but simply &quot;a value of this type&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 2399650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/zwtpS.jpg?s=128&g=1", "display_name": "Samuel Barnes", "link": "https://stackoverflow.com/users/2399650/samuel-barnes"}, "edited": false, "score": 0, "creation_date": 1432816269, "post_id": 30492917, "comment_id": 49088790, "body": "Thanks, perfect except I had to omit the &quot;let&quot;s for it to work :P"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 103, "user_id": 2399650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/zwtpS.jpg?s=128&g=1", "display_name": "Samuel Barnes", "link": "https://stackoverflow.com/users/2399650/samuel-barnes"}, "edited": false, "score": 0, "creation_date": 1432817829, "post_id": 30492917, "comment_id": 49090011, "body": "@gravysam The <code>&gt;</code> was there to indicate that this was being entered into a GHCi session, a convention I see a lot here on SO.  If you were to put this in a <code>.hs</code> file and compile it you would indeed need to remove the <code>let</code>s."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 2, "last_activity_date": 1432833910, "last_edit_date": 1432833910, "creation_date": 1432759998, "answer_id": 30492917, "question_id": 30492887, "link": "https://stackoverflow.com/questions/30492887/haskell-declare-and-use-set-data-structure/30492917#30492917", "title": "Haskell Declare and Use &quot;Set&quot; Data Structure", "body": "<p>To make a value of this type, you need to pass a list to the constructor <code>Set</code>:</p>\n\n<pre><code>&gt; data Set e = Set [e]\n&gt; let myset :: Set Int; myset = Set [1, 2, 3]\n</code></pre>\n\n<p>To use it, you can pattern match on the constructor just like any other data type</p>\n\n<pre><code>&gt; let len :: Set e -&gt; Int; len (Set es) = length es\n&gt; len myset\n3\n</code></pre>\n\n<p>If you are not in <code>ghci</code>, you don't need the <code>let</code>s.</p>\n\n<pre><code>myset :: Set Int\nmyset = Set [1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 2399650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/zwtpS.jpg?s=128&g=1", "display_name": "Samuel Barnes", "link": "https://stackoverflow.com/users/2399650/samuel-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 30492917, "answer_count": 1, "score": 0, "last_activity_date": 1432833910, "creation_date": 1432759872, "last_edit_date": 1432793170, "question_id": 30492887, "link": "https://stackoverflow.com/questions/30492887/haskell-declare-and-use-set-data-structure", "title": "Haskell Declare and Use &quot;Set&quot; Data Structure", "body": "<p>I am trying to declare a custom \"Set\" datatype in Haskell that can hold elements so I have tried the following declaration:</p>\n\n<pre><code>data Set e = Set [e]\n</code></pre>\n\n<p>How can I declare a value of this type?</p>\n"}, {"tags": ["c", "haskell", "makefile", "ghc", "webots"], "answers": [{"comments": [{"owner": {"reputation": 1726, "user_id": 2210777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ed2b06be7765e94570ace8fb755b266c?s=128&d=identicon&r=PG", "display_name": "FabienRohrer", "link": "https://stackoverflow.com/users/2210777/fabienrohrer"}, "edited": false, "score": 0, "creation_date": 1432842512, "post_id": 30493708, "comment_id": 49106744, "body": "Indeed <code>-lController</code> should link with <code>libController.dylib</code> contained into the <code>&#47;Applications&#47;Webots&#47;lib&#47;</code> path."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 1, "last_activity_date": 1432763183, "creation_date": 1432763183, "answer_id": 30493708, "question_id": 30492653, "link": "https://stackoverflow.com/questions/30492653/linking-with-ghc/30493708#30493708", "title": "Linking with GHC", "body": "<p>It means the linker can't find those functions/symbols, because you didn't tell it to link with the Webots library.</p>\n\n<p>You need to add <code>-lsomething</code>, assuming the library file name is <code>/Applications/Webots/lib/libsomething.dylib</code> (or <code>libsomething.a</code>).</p>\n"}], "owner": {"reputation": 3209, "user_id": 1276374, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7ce4a877cf573491b23fc6aa1bf18a1d?s=128&d=identicon&r=PG", "display_name": "Boris Mocialov", "link": "https://stackoverflow.com/users/1276374/boris-mocialov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 30493708, "answer_count": 1, "score": 0, "last_activity_date": 1432763183, "creation_date": 1432758957, "last_edit_date": 1432760249, "question_id": 30492653, "link": "https://stackoverflow.com/questions/30492653/linking-with-ghc", "title": "Linking with GHC", "body": "<p>I am following this <a href=\"https://wiki.haskell.org/Calling_Haskell_from_C\" rel=\"nofollow\">short tutorial</a></p>\n\n<p>and trying to compile <em>Webots</em> application (written in C) using GHC (Glasgow Haskell Compiler, Version 7.10.1) with following command:</p>\n\n<pre><code>ghc --make -no-hs-main -optc-O \n-I\"/Applications/Webots/include/controller/c/\" \n-L\"/Applications/Webots/lib/\" \n-outputdir build/release/ \nadvanced_genetic_algorithm_supervisor.c \nSafe \n-o advanced_genetic_algorithm_supervisor\n</code></pre>\n\n<p>and getting the following error during the linking phase:</p>\n\n<pre><code>Linking advanced_genetic_algorithm_supervisor ...\nUndefined symbols for architecture x86_64:\n  \"_wb_display_draw_text\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_display_get_height\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_display_get_width\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_emitter_send\", referenced from:\n      _evaluate_genotype in advanced_genetic_algorithm_supervisor.o\n  \"_wb_receiver_enable\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_receiver_get_data\", referenced from:\n      _check_for_slaves_data in advanced_genetic_algorithm_supervisor.o\n  \"_wb_receiver_get_queue_length\", referenced from:\n      _check_for_slaves_data in advanced_genetic_algorithm_supervisor.o\n  \"_wb_receiver_next_packet\", referenced from:\n      _check_for_slaves_data in advanced_genetic_algorithm_supervisor.o\n  \"_wb_robot_cleanup\", referenced from:\n      _run_optimization in advanced_genetic_algorithm_supervisor.o\n  \"_wb_robot_get_basic_time_step\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_robot_get_device\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_robot_init\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_robot_step\", referenced from:\n      _run_seconds in advanced_genetic_algorithm_supervisor.o\n      _evaluate_genotype in advanced_genetic_algorithm_supervisor.o\n  \"_wb_supervisor_field_get_sf_rotation\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_supervisor_field_get_sf_vec3f\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_supervisor_field_set_sf_rotation\", referenced from:\n      _evaluate_genotype in advanced_genetic_algorithm_supervisor.o\n  \"_wb_supervisor_field_set_sf_vec3f\", referenced from:\n      _evaluate_genotype in advanced_genetic_algorithm_supervisor.o\n  \"_wb_supervisor_node_get_field\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\n  \"_wb_supervisor_node_get_from_def\", referenced from:\n      _main in advanced_genetic_algorithm_supervisor.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>I believe that it means that the compiler cannot find functions ('symbols'), although it managed to pass through compilation process parsing all includes specified in the program using -I path</p>\n"}, {"tags": ["haskell", "combinations", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1432754124, "post_id": 30491133, "comment_id": 49060344, "body": "<code>otherwise</code> handles anything that doesn&#39;t fall into previous <i>guards</i> -- but doesn&#39;t make a pattern match support other <i>cases</i>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1432762393, "post_id": 30491133, "comment_id": 49064787, "body": "you could fix this with a very small edit, by changing <code>l@(y:ys)</code> to <code>l@ ~(y:ys)</code>, making the pattern lazy, and so irrefutable (so empty lists are accepted too). I would recommend against such a style though, it makes the code too fragile and non-apparent."}], "answers": [{"tags": [], "owner": {"reputation": 19318, "user_id": 371834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a378ed2410bdabed82883f2615f6b61?s=128&d=identicon&r=PG", "display_name": "Mihai Maruseac", "link": "https://stackoverflow.com/users/371834/mihai-maruseac"}, "is_accepted": true, "score": 8, "last_activity_date": 1432753945, "creation_date": 1432753945, "answer_id": 30491190, "question_id": 30491133, "link": "https://stackoverflow.com/questions/30491133/haskell-non-exhaustive-patterns-in-function-with-otherwise/30491190#30491190", "title": "Haskell non-exhaustive patterns in function with `otherwise`", "body": "<p>Because of <code>l@(x:xs)</code> in <code>combinations' n k' l@(y:ys)</code> you're missing the case <code>combinations _ _ []</code>.</p>\n\n<p>The guard <code>null l</code> will always be <code>False</code>.</p>\n"}], "owner": {"reputation": 368, "user_id": 4204160, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/62550e8dec6bd6a777fe3c0013b820df?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin", "link": "https://stackoverflow.com/users/4204160/marcin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1833, "favorite_count": 0, "accepted_answer_id": 30491190, "answer_count": 1, "score": 1, "last_activity_date": 1432753997, "creation_date": 1432753785, "last_edit_date": 1432753997, "question_id": 30491133, "link": "https://stackoverflow.com/questions/30491133/haskell-non-exhaustive-patterns-in-function-with-otherwise", "title": "Haskell non-exhaustive patterns in function with `otherwise`", "body": "<p>I am using the following function:</p>\n\n<pre><code>combinations :: Int -&gt; [a] -&gt; [[a]]\ncombinations k xs = combinations' (length xs) k xs\n  where combinations' n k' l@(y:ys)\n          | k' == 0   = [[]]\n          | k' &gt;= n   = [l]\n          | null l    = []\n          | otherwise = Prelude.map (y :) (combinations' (n - 1) (k' - 1) ys) ++ combinations' (n - 1) k' ys \n</code></pre>\n\n<p>It works just fine for just about any example i can come up with, but when i call it from other functions in my larger project, for some cases I get an exception:</p>\n\n<pre><code>Exception: projekt.hs:(34,9)-(38,108): Non-exhaustive patterns in function combinations'\n</code></pre>\n\n<p>Is there something wrong with the above definition? Is it missing some case? I thought <code>otherwise</code> handles anything that doesn't fall into previous cases.</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432749807, "post_id": 30489597, "comment_id": 49057964, "body": "while AJFarmar&#39;s answer work I myself hate to do this in ghci - I would just put my input in a <i>.hs</i> file and load it (<code>:load myFile.hs</code>) ;)"}], "answers": [{"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1432750980, "post_id": 30489910, "comment_id": 49058623, "body": "I always like to point out that with <code>:set +m</code>, you have multi-line input in GHCi.  I keep this in my .ghci settings file.  This avoids needing to use the <code>:{ :}</code> wrapper, although it&#39;s still available for use."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 4, "last_activity_date": 1432750910, "last_edit_date": 1432750910, "creation_date": 1432749682, "answer_id": 30489910, "question_id": 30489597, "link": "https://stackoverflow.com/questions/30489597/input-length-restriction-in-ghci/30489910#30489910", "title": "Input length restriction in GHCi", "body": "<p>Sure:</p>\n\n<pre><code>\u03bb&gt; :{\n|  let result =\n|       kakuro [\n|    (-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),\n|    (-2,0,0),(-2,0,0),(-1,0,6),(-1,0,23) ...\n|      -- AND SO ON...\n|              ]\n| :}\n</code></pre>\n\n<p>And then just evaluate <code>result</code>.</p>\n\n<p>However, I imagine that you've taken the list from the result of a previous command. In GHCi, the result of the previous expression is <code>it</code>, so you could probably write <code>kakuro it</code>. If you haven't done that, then read it from a file:</p>\n\n<pre><code>\u03bb&gt; kakurodata &lt;- read `fmap` readFile \"/file/data/here.txt\"\n\u03bb&gt; kakuro kakurodata\n</code></pre>\n\n<p>EDIT: @Carsten pointed out that you could just plonk it in a file and <code>:load</code> it. Thanks!</p>\n"}], "owner": {"reputation": 113, "user_id": 4945871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6lZHJQrC9do/AAAAAAAAAAI/AAAAAAAAAMs/oWG-qFzBiJ8/photo.jpg?sz=128", "display_name": "Pe\u0165an", "link": "https://stackoverflow.com/users/4945871/pe%c5%a5an"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 30489910, "answer_count": 1, "score": 2, "last_activity_date": 1432750946, "creation_date": 1432748715, "last_edit_date": 1432750946, "question_id": 30489597, "link": "https://stackoverflow.com/questions/30489597/input-length-restriction-in-ghci", "title": "Input length restriction in GHCi", "body": "<p>I programmed kakuro-solver, but I have problem with user's input. When user want to enter input longer then 1024 chars, haskell trims input and throws exception </p>\n\n<pre><code>&lt;interactive&gt;:9:1024:\n    parse error (possibly incorrect indentation or mismatched brackets)\n</code></pre>\n\n<p>For example I want to enter this input</p>\n\n<pre><code>kakuro [(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,0,6),(-1,0,23),(-2,0,0),(-2,0,0),(-1,0,7),(-1,0,23),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,0,18),(-1,0,12),(-2,0,0),(-1,0,12),(-1,0,26),(-1,9,0),(0,0,0),(0,0,0),(-2,0,0),(-1,13,19),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,7,23),(0,0,0),(0,0,0),(-1,3,0),(0,0,0),(0,0,0),(-1,5,16),(0,0,0),(0,0,0),(-1,18,10),(0,0,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,7,0),(0,0,0),(0,0,0),(0,0,0),(-1,10,0),(0,0,0),(0,0,0),(0,0,0),(-1,21,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,20,15),(0,0,0),(0,0,0),(0,0,0),(-1,24,0),(0,0,0),(0,0,0),(0,0,0),(-1,11,20),(0,0,0),(0,0,0),(0,0,0),(-1,0,17),(-2,0,0),(-2,0,0),(-1,14,0),(0,0,0),(0,0,0),(-1,0,23),(-1,0,12),(-1,0,15),(-1,20,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,10,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,26,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,0,13),(-2,0,0),(-1,13,19),(0,0,0),(0,0,0),(-1,13,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,33,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,15,30),(0,0,0),(0,0,0),(-1,0,16),(-2,0,0),(-2,0,0),(-1,0,21),(-1,0,29),(-2,0,0),(-2,0,0),(-1,16,0),(0,0,0),(0,0,0),(-2,0,0),(-1,31,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,0,12),(-1,17,13),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,0,11),(-1,0,23),(-2,0,0),(-1,10,37),(0,0,0),(0,0,0),(-1,26,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,0,11),(-2,0,0),(-2,0,0),(-1,4,0),(0,0,0),(0,0,0),(-1,16,0),(0,0,0),(0,0,0),(-1,0,9),(-1,0,16),(-1,34,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,17,0),(0,0,0),(0,0,0),(-1,18,14),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,0,13),(-2,0,0),(-1,0,20),(-1,4,13),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,0,7),(-1,18,21),(0,0,0),(0,0,0),(0,0,0),(-1,21,0),(0,0,0),(0,0,0),(0,0,0),(-1,22,0),(0,0,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,33,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,6,17),(0,0,0),(0,0,0),(0,0,0),(-1,9,0),(0,0,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,8,0),(0,0,0),(0,0,0),(0,0,0),(-1,13,0),(0,0,0),(0,0,0),(-1,3,0),(0,0,0),(0,0,0),(-1,16,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,11,0),(0,0,0),(0,0,0),(-2,0,0),(-1,17,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0)]\n</code></pre>\n\n<p>but WinGHCi trims it to</p>\n\n<pre><code>kakuro [(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,0,6),(-1,0,23),(-2,0,0),(-2,0,0),(-1,0,7),(-1,0,23),(-2,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,0,18),(-1,0,12),(-2,0,0),(-1,0,12),(-1,0,26),(-1,9,0),(0,0,0),(0,0,0),(-2,0,0),(-1,13,19),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,7,23),(0,0,0),(0,0,0),(-1,3,0),(0,0,0),(0,0,0),(-1,5,16),(0,0,0),(0,0,0),(-1,18,10),(0,0,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,7,0),(0,0,0),(0,0,0),(0,0,0),(-1,10,0),(0,0,0),(0,0,0),(0,0,0),(-1,21,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,20,15),(0,0,0),(0,0,0),(0,0,0),(-1,24,0),(0,0,0),(0,0,0),(0,0,0),(-1,11,20),(0,0,0),(0,0,0),(0,0,0),(-1,0,17),(-2,0,0),(-2,0,0),(-1,14,0),(0,0,0),(0,0,0),(-1,0,23),(-1,0,12),(-1,0,15),(-1,20,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,10,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-1,26,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(0,0,0),(-1,0,13),(-2,0,0),(-1,13,19),(0,0,0),(0,0,0),(-1,13,0),(0,0,0),(0,0,0),(-2,0,0),(-2,0,0),(-2,0,0),(-1,33,0),(0,0,0)\n</code></pre>\n\n<p>I tried use monad, but there is the same problem, I have to split input to more lines.</p>\n\n<p>Is there any options, how enter inputs longer then 1024 chars?</p>\n"}, {"tags": ["http", "haskell", "authentication"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1432740449, "post_id": 30486428, "comment_id": 49052091, "body": "That first error message has nothing to do with <code>wreq</code> or <code>lens</code> and everything to do with not understanding <code>IO</code>.  The second error message has nothing to do with <code>wreq</code> or <code>lens</code> and everything to do with confusing byte streams with textual data."}], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 667, "user_id": 4945310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3dda711cc9725a0f48f632bc5482a432?s=128&d=identicon&r=PG&f=1", "display_name": "Tomo", "link": "https://stackoverflow.com/users/4945310/tomo"}, "edited": false, "score": 0, "creation_date": 1432758052, "post_id": 30490754, "comment_id": 49062659, "body": "<code>decode (...)</code> is a <code>Maybe TestInfo</code>, but <code>getTestInfo</code> is an IO action. <code>return</code> converts a pure value into an IO action (in this case). A caller of <code>getTestInfo</code> will use the monadic binding operator get the returned value out of the IO action - just like it is being used with the IO action <code>getWith</code> to get its return value."}, {"owner": {"reputation": 667, "user_id": 4945310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3dda711cc9725a0f48f632bc5482a432?s=128&d=identicon&r=PG&f=1", "display_name": "Tomo", "link": "https://stackoverflow.com/users/4945310/tomo"}, "edited": false, "score": 0, "creation_date": 1432794920, "post_id": 30490754, "comment_id": 49074351, "body": "it doesnt seem to work actually. The ` res &lt;- ...` line seems to be trigger a &quot;couldn&#39;t match Expected type Maybe .... with actual type IO...&quot;. Do you know what could be triggering this? I fired it up in ghci and manually typing each thing seems to give the correct return type."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 667, "user_id": 4945310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3dda711cc9725a0f48f632bc5482a432?s=128&d=identicon&r=PG&f=1", "display_name": "Tomo", "link": "https://stackoverflow.com/users/4945310/tomo"}, "edited": false, "score": 0, "creation_date": 1432818669, "post_id": 30490754, "comment_id": 49090658, "body": "Sorry - the lpaste version was incorrect. Use the <code>getTestInfo</code> given in the answer. Here is an updated lpaste: <a href=\"http://lpaste.net/133498\" rel=\"nofollow noreferrer\">lpaste.net/133498</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1432818768, "last_edit_date": 1432818768, "creation_date": 1432752502, "answer_id": 30490754, "question_id": 30486428, "link": "https://stackoverflow.com/questions/30486428/error-attempting-to-decode-with-wreq/30490754#30490754", "title": "Error attempting to decode with wreq", "body": "<p>This type checks for me:</p>\n\n<pre><code>getTestInfo :: Key -&gt; TestNumber -&gt; IO (Maybe TestInfo)\ngetTestInfo key test = do\n  res &lt;- getWith opts (\"http://testsite.com/v1/tests/\" ++ test)\n  return $ decode (res ^. responseBody)\n  where opts = defaults &amp; auth ?~ oauth2Bearer key\n</code></pre>\n\n<p><code>getWith</code> is an IO action, so to get its return value you need to use the monadic binding operator <code>&lt;-</code>.</p>\n\n<p>Full program: <del><a href=\"http://lpaste.net/133443\" rel=\"nofollow\">http://lpaste.net/133443</a></del> <a href=\"http://lpaste.net/133498\" rel=\"nofollow\">http://lpaste.net/133498</a></p>\n"}], "owner": {"reputation": 667, "user_id": 4945310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3dda711cc9725a0f48f632bc5482a432?s=128&d=identicon&r=PG&f=1", "display_name": "Tomo", "link": "https://stackoverflow.com/users/4945310/tomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1432818768, "creation_date": 1432739416, "question_id": 30486428, "link": "https://stackoverflow.com/questions/30486428/error-attempting-to-decode-with-wreq", "title": "Error attempting to decode with wreq", "body": "<p>I'm trying really hard to understand how to use lenses and wreq and its turning out to really slow me down. </p>\n\n<p>The error seems to be claiming there's some mismatched type here. I'm not sure exactly how to handle that though. I'm still fairly new to haskell and these lenses are pretty confusing. However, wreq seems to be cleaner, which is why I chose to use it. Can anyone help me understand what the error is, and how to fix it? I seem to run into alot of these type errors. I am aware that <code>Maybe TestInfo</code> won't be returned by my code at the moment. That's ok. That error  know how to handle. This error however, I don't.</p>\n\n<p>Here is my code:</p>\n\n<p>Module TestInformation:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule TestInformation where\n\nimport Auth\nimport Network.Wreq\nimport Control.Lens\nimport Data.Aeson\nimport Data.Aeson.Lens (_String)\n\n\ntype TestNumber = String\n\ndata TestInfo = TestInfo {\n                TestId       :: Int,\n                TestName     :: String,\n               }\n\ninstance FromJSON TestInfo\n\n\ngetTestInfo :: Key -&gt; TestNumber -&gt; Maybe TestInfo\ngetTestInfo key test =\n  decode (res ^. responseBody . _String)\n  where opts = defaults &amp; auth ?~ oauth2Bearer key\n        res  = getWith opts (\"http://testsite.com/v1/tests/\" ++ test)\n</code></pre>\n\n<p>Module Auth:</p>\n\n<pre><code>module Auth where\n\nimport qualified Data.ByteString as B\n\ntype Key = B.ByteString\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>GHCi, version 7.10.1: http://www.haskell.org/ghc/  :? for help\n[1 of 2] Compiling Auth   ( Auth.hs, interpreted )\n[2 of 2] Compiling TestInformation ( TestInformation.hs, interpreted )\n\nTestInformation.hs:36:18:\n  Couldn't match type \u2018Response body10\u2019\n               with \u2018IO (Response Data.ByteString.Lazy.Internal.ByteString)\u2019\nExpected type: (body10\n                -&gt; Const Data.ByteString.Lazy.Internal.ByteString body10)\n               -&gt; IO (Response Data.ByteString.Lazy.Internal.ByteString)\n               -&gt; Const\n                    Data.ByteString.Lazy.Internal.ByteString\n                    (IO (Response Data.ByteString.Lazy.Internal.ByteString))\n  Actual type: (body10\n                -&gt; Const Data.ByteString.Lazy.Internal.ByteString body10)\n               -&gt; Response body10\n               -&gt; Const Data.ByteString.Lazy.Internal.ByteString (Response body10)\nIn the first argument of \u2018(.)\u2019, namely \u2018responseBody\u2019\nIn the second argument of \u2018(^.)\u2019, namely \u2018responseBody . _String\u2019\n\nTestInformation.hs:36:33:\nCouldn't match type \u2018Data.ByteString.Lazy.Internal.ByteString\u2019\n               with \u2018Data.Text.Internal.Text\u2019\nExpected type: (Data.ByteString.Lazy.Internal.ByteString\n                -&gt; Const\n                     Data.ByteString.Lazy.Internal.ByteString\n                     Data.ByteString.Lazy.Internal.ByteString)\n               -&gt; body10 -&gt; Const Data.ByteString.Lazy.Internal.ByteString body10\n  Actual type: (Data.Text.Internal.Text\n                -&gt; Const\n                     Data.ByteString.Lazy.Internal.ByteString Data.Text.Internal.Text)\n               -&gt; body10 -&gt; Const Data.ByteString.Lazy.Internal.ByteString body10\nIn the second argument of \u2018(.)\u2019, namely \u2018_String\u2019\nIn the second argument of \u2018(^.)\u2019, namely \u2018responseBody . _String\u2019\nFailed, modules loaded: Auth.\nLeaving GHCi.\n</code></pre>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1432739909, "post_id": 30485219, "comment_id": 49051671, "body": "I assume this is a warning from hlint? Seems to be a bug."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 5, "last_activity_date": 1432739990, "last_edit_date": 1432739990, "creation_date": 1432739675, "answer_id": 30486526, "question_id": 30485219, "link": "https://stackoverflow.com/questions/30485219/eta-reduction-for-data-modification/30486526#30486526", "title": "Eta reduction for data modification", "body": "<p>For this case you can't eta reduce it any further.  There is only a single argument to the lambda, namely <code>(DataType arg1 arg2)</code>.  These are not separate arguments, as indicated by the parentheses, but instead you are pattern matching on a constructor.  In reality, the compiler will reduce this expression to something more like</p>\n\n<pre><code>\\arg -&gt; case arg of\n    DataType arg1 arg2 -&gt; DataType (modify arg1) arg2\n</code></pre>\n\n<p>Here it is more clear that there is only one argument to the lambda, and it is not used in such a way that it can be reduced.  The main rule for reduction is when you have something like</p>\n\n<pre><code>\\a b c -&gt; f b a c\n</code></pre>\n\n<p>The <code>c</code> argument appears as the last term in the argument declaration and in the expression, so it can be dropped:</p>\n\n<pre><code>\\a b -&gt; f b a\n</code></pre>\n\n<p>Now, if we wanted to reduce this lambda we could define a higher order function</p>\n\n<pre><code>flip f a b = f b a\n</code></pre>\n\n<p>And write it as simply</p>\n\n<pre><code>flip f\n</code></pre>\n\n<p>(Note that <code>flip</code> already exists in <code>Prelude</code>).</p>\n\n<p>Another rule you can apply is when dealing with the <code>$</code> operator.  Put simply, if you have something like</p>\n\n<pre><code>\\a b c -&gt; f a $ g b $ h c\n</code></pre>\n\n<p>Then you can first turn this into a composition:</p>\n\n<pre><code>\\a b c -&gt; (f a . g b . h) c\n</code></pre>\n\n<p>And now it is simple to drop the <code>c</code> argument</p>\n\n<pre><code>\\a b -&gt; f a . g b . h\n</code></pre>\n\n<p>And in general, you can usually swap <code>$</code>s for <code>.</code>s and drop the last argument.</p>\n\n<p>Again, this doesn't apply in your case because your function only has 1 argument, and that argument is pattern matched on to pull out a constructor's arguments, then an entirely new value is reconstructed from it.</p>\n"}], "owner": {"reputation": 479, "user_id": 3158988, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c78bf99ebe9c08f45fbae84e42985657?s=128&d=identicon&r=PG&f=1", "display_name": "user4758246", "link": "https://stackoverflow.com/users/3158988/user4758246"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 1, "accepted_answer_id": 30486526, "answer_count": 1, "score": 4, "last_activity_date": 1432748584, "creation_date": 1432736316, "last_edit_date": 1432748584, "question_id": 30485219, "link": "https://stackoverflow.com/questions/30485219/eta-reduction-for-data-modification", "title": "Eta reduction for data modification", "body": "<p>I get a warning to eta reduce the following lambda expression.</p>\n\n<pre><code>\\(DataType arg1 arg2) -&gt; DataType (modify arg1) arg2\n</code></pre>\n\n<p>The internet tells me eta-reducing means to leave out unnecessary lambdas.</p>\n\n<pre><code>map (\\x -&gt; fun x) list\nmap fun list\n</code></pre>\n\n<p>How is that applicable to the code above? Am I perhaps just missing a basic syntax for modifying data types?</p>\n"}, {"tags": ["haskell", "applicative", "monoids", "alternative-functor"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1432726405, "post_id": 30481092, "comment_id": 49041050, "body": "<code>Monoid</code> would be the class for non-applicative types."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 4, "creation_date": 1432726713, "post_id": 30481092, "comment_id": 49041284, "body": "@Lee, that doesn&#39;t quite kind-check, as <code>Monoid</code> is a class of types and <code>Alternative</code> is a class of type constructors. I wish we could have locally quantified constraints on type constructors, such as <code>(forall a. Monoid f a)</code> but that&#39;s not allowed."}, {"owner": {"reputation": 9174, "user_id": 64923, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bfab0edbc971a92ada9c0d74bf93cc42?s=128&d=identicon&r=PG", "display_name": "James Davies", "link": "https://stackoverflow.com/users/64923/james-davies"}, "edited": false, "score": 0, "creation_date": 1432728083, "post_id": 30481092, "comment_id": 49042339, "body": "Technically Alternative is just &quot;Monoid for Applicatives&quot;, so &quot;Monoid&quot; would seem to be the more common case, as I understand it the expected use of the <code>&lt;|&gt;</code> operator is &quot;Pick or ore another&quot;, which is somewhat different to <code>mconcat</code>?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1432737692, "post_id": 30481092, "comment_id": 49049983, "body": "It seems to me that all the category-theory typeclasses are a bit tangled together, mostly due to historical considerations (i.e., backwards compatibility). I think this is relevant: <a href=\"http://stackoverflow.com/questions/10167879/distinction-between-typeclasses-monadplus-alternative-and-monoid\" title=\"distinction between typeclasses monadplus alternative and monoid\">stackoverflow.com/questions/10167879/&hellip;</a>&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "edited": false, "score": 0, "creation_date": 1434621351, "post_id": 30482333, "comment_id": 49861626, "body": "It&#39;d be nicer if <code>Alt</code> was a superclass of <code>Alternative</code>, and <code>Apply</code> a superclass of <code>Applicative</code>, wouldn&#39;t it?"}, {"owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "edited": false, "score": 0, "creation_date": 1434621807, "post_id": 30482333, "comment_id": 49861921, "body": "And I seem to miss a an instance to work with this <code>Alt</code> as a Semigroup. (Analoguously to <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Monoid.html#g:5\" rel=\"nofollow noreferrer\">the <code>Alt</code> newtype</a> which makes it possible to use an <code>Alternative</code> as a Monoid.)"}, {"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "edited": false, "score": 1, "creation_date": 1523685891, "post_id": 30482333, "comment_id": 86672313, "body": "Regrettably, being a semigroup, it doesn&#39;t have <code>altEmpty :: f a</code>."}], "tags": [], "owner": {"reputation": 11510, "user_id": 5852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba340386ad2afc76d4a9602410b4e449?s=128&d=identicon&r=PG", "display_name": "Sjoerd Visscher", "link": "https://stackoverflow.com/users/5852/sjoerd-visscher"}, "is_accepted": true, "score": 6, "last_activity_date": 1432729371, "creation_date": 1432729371, "answer_id": 30482333, "question_id": 30481092, "link": "https://stackoverflow.com/questions/30481092/why-does-the-alternative-typeclass-need-to-be-a-sub-class-of-control-applicative/30482333#30482333", "title": "Why does the Alternative typeclass need to be a sub-class of Control.Applicative", "body": "<p>I think <code>Alt</code> from the <code>semigroupoids</code> package comes closest to being a 'standard' typeclass. <a href=\"https://hackage.haskell.org/package/semigroupoids-5.0.0.1/docs/Data-Functor-Alt.html#t:Alt\">https://hackage.haskell.org/package/semigroupoids-5.0.0.1/docs/Data-Functor-Alt.html#t:Alt</a></p>\n"}], "owner": {"reputation": 9174, "user_id": 64923, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bfab0edbc971a92ada9c0d74bf93cc42?s=128&d=identicon&r=PG", "display_name": "James Davies", "link": "https://stackoverflow.com/users/64923/james-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 3, "accepted_answer_id": 30482333, "answer_count": 1, "score": 15, "last_activity_date": 1614131998, "creation_date": 1432725935, "last_edit_date": 1614131998, "question_id": 30481092, "link": "https://stackoverflow.com/questions/30481092/why-does-the-alternative-typeclass-need-to-be-a-sub-class-of-control-applicative", "title": "Why does the Alternative typeclass need to be a sub-class of Control.Applicative", "body": "<p>Haskell provides a standard typeclass 'Alternative' that effectively provides the <code>&lt;|&gt;</code> operator for any type that is also an Applicative.</p>\n\n<p>As I understand it Alternative is considered a Monoid on Applicative's, however the <code>&lt;|&gt;</code> operator seems to make complete sense in a lot of types that aren't Applicative Functors as well, and there doesn't need to be any specific dependency on the Applicative typeclass for it to work properly.</p>\n\n<p>Is there a reason why Alternative needs to be a subclass of Applicative, and if so is there a standard typeclass to define similar functionality on non-applicative types?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432751707, "post_id": 30479018, "comment_id": 49059039, "body": "Just because <code>a</code> and <code>b</code> are different letters doesn&#39;t mean that <code>a &#47;= b</code>."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1432721648, "post_id": 30479076, "comment_id": 49037769, "body": "<code>pair :: a -&gt; b -&gt; (a,b)</code> might be even simpler than a <code>data</code> example."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 15, "last_activity_date": 1432720942, "last_edit_date": 1432720942, "creation_date": 1432720612, "answer_id": 30479076, "question_id": 30479018, "link": "https://stackoverflow.com/questions/30479018/why-function-matches-type-a-b-b/30479076#30479076", "title": "Why function (+) matches type (a -&gt; b -&gt; b)?", "body": "<p>No, all it means is that <code>a</code> and <code>b</code> <strong><em>can</em></strong> be different, but it isn't mandatory for it to be different. In your case, it is the same.</p>\n\n<p>A much simpler example to convey the point:</p>\n\n<pre><code>data SomeType a b = Test a b deriving (Show)\n</code></pre>\n\n<p>Now in <code>ghci</code>:</p>\n\n<pre><code>\u03bb&gt; :t Test\nTest :: a -&gt; b -&gt; SomeType a b\n\u03bb&gt; let x = Test (3 :: Int) (4 :: Int)\n\u03bb&gt; :t x\nx :: SomeType Int Int\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1432739795, "post_id": 30481064, "comment_id": 49051578, "body": "I think this is getting a bit too mechanical with the type constructors. A conceptional example (i.e. what gets unified with what) would be useful to have before the example of how the unification process operates."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 3, "last_activity_date": 1432725859, "creation_date": 1432725859, "answer_id": 30481064, "question_id": 30479018, "link": "https://stackoverflow.com/questions/30479018/why-function-matches-type-a-b-b/30481064#30481064", "title": "Why function (+) matches type (a -&gt; b -&gt; b)?", "body": "<p>You are thinking in reverse direction. You do not have to check whether <code>+</code> is identical or matches <code>a -&gt; b -&gt; b</code>, you want the type of <code>+</code> to be a <em>specialization</em> of <code>a -&gt; b -&gt; b</code> and to check this you have to <em>unify</em> the types.</p>\n\n<p>Unification means that you want to see whether the type of <code>+</code> and the type <code>a -&gt; b -&gt; b</code> can be made equal by <em>renaming the type variables</em>.</p>\n\n<p>So <code>+</code> has type <code>Num x =&gt; x -&gt; x -&gt; x</code>. Let's ignore the class constraint for now, and let's see if we can match the functional types.\nThe types become <code>x -&gt; x -&gt; x</code> and <code>a -&gt; b -&gt; b</code>. In fact it's better if we look at them as they really are, without using associativity: <code>x -&gt; (x -&gt; x)</code> and <code>a -&gt; (b -&gt; b)</code>.</p>\n\n<p>The <code>-&gt;</code> is a <em>type constructor</em>. I.e. it is a function that maps a certain number of types to a different type. In this case the <code>-&gt;</code> constructor maps two types <code>t_1</code> and <code>t_2</code> to the functional type <code>(-&gt;) t_1 t_2</code> (which is usually denoted by <code>t_1 -&gt; t_2</code>).</p>\n\n<p>So the type <code>x -&gt; (x -&gt; x)</code> is actually <code>(-&gt;) x ((-&gt;) x x)</code> which is the type constructor <code>-&gt;</code> applied to <code>x</code> and to the type constructor <code>-&gt;</code> applied to <code>x</code> and <code>x</code>.\nThe other type is <code>(-&gt;) a ((-&gt;) b b)</code>.</p>\n\n<p>When unifying you consider the outermost type constructor for the two types (<code>-&gt;</code> for both in this case). If this doesn't match, you cannot unify.\nOtherwise you have to unify the arguments of the constructor.</p>\n\n<p>So we have to unify <code>x</code> with <code>a</code>. They are both type variables, so we can <em>rename</em> one of them. Let's say that we rename <code>a</code> with <code>x</code>. So now we apply the renaming to the types, obtaining: <code>(-&gt;) x ((-&gt;) x x)</code> and <code>(-&gt;) x ((-&gt;) b b)</code> and you see that <code>x</code> and <code>x</code> now match.</p>\n\n<p>Let's consider the second argument. It's not a type variable so we have to match the type constructor, and this is again <code>-&gt;</code> for both. So we procede recursively on the arguments.</p>\n\n<p>We want to match <code>x</code> and <code>b</code>. They are both type variables, so we can rename one of them. Say we rename <code>x</code> to <code>b</code>. We apply this substitution to the types, obtaining: <code>(-&gt;) b ((-&gt;) b b)</code> and <code>(-&gt;) b ((-&gt;) b b)</code>. Now the everything matches. Hence the two types unify.</p>\n\n<p>Regarding the class constraint, when we rename <code>x</code> with <code>b</code> we applied the substitution to the constraint too so <code>Num x</code> became <code>Num b</code> and the two final types are both <code>Num b =&gt; b -&gt; b -&gt; b</code>.</p>\n\n<p>I hope this gave you some better understanding on how the types work and how the types are checked.</p>\n\n<hr>\n\n<p>Side note: This is what haskell does when performing type inference. It first assign to an unknown function a fresh type variable <code>t</code>. Then it uses unification to obtain the type of the expression that defines it and check what type was associated with <code>t</code>, and this is the type of the function.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 30479076, "answer_count": 2, "score": 8, "last_activity_date": 1432725859, "creation_date": 1432720497, "question_id": 30479018, "link": "https://stackoverflow.com/questions/30479018/why-function-matches-type-a-b-b", "title": "Why function (+) matches type (a -&gt; b -&gt; b)?", "body": "<p>fold function : </p>\n\n<pre><code>fold :: b -&gt; (a -&gt; b -&gt; b) -&gt; [a] -&gt; b\nfold z f []     = z\nfold z f (x:xs) = f x (fold z f xs)\n</code></pre>\n\n<p>taken from <a href=\"http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html\">http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html</a></p>\n\n<pre><code>Prelude&gt; :t (+)\n(+) :: Num a =&gt; a -&gt; a -&gt; a\n\n*Main&gt; fold (0) (+) [1,2,3]\n6\n</code></pre>\n\n<p>What does type <code>(a -&gt; b -&gt; b)</code>  match with type <code>a -&gt; a -&gt; a</code> for <code>(+)</code> function ?</p>\n\n<p>As fold definition accepts function type <code>(a -&gt; b -&gt; b)</code> this means the first 2 parameters <code>(a -&gt; b)</code> are required to be of different types ? </p>\n"}, {"tags": ["haskell", "ghc", "template-haskell"], "answers": [{"comments": [{"owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "edited": false, "score": 0, "creation_date": 1432735108, "post_id": 30479685, "comment_id": 49047815, "body": "Thanks! I didn&#39;t realise how recent <code>inline-c</code> was."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 8, "last_activity_date": 1432722100, "creation_date": 1432722100, "answer_id": 30479685, "question_id": 30478003, "link": "https://stackoverflow.com/questions/30478003/what-are-the-differences-between-inline-c-and-language-c-inline/30479685#30479685", "title": "What are the differences between inline-c and language-c-inline?", "body": "<p>Some differences where (shortly) discussed in <a href=\"http://redd.it/36mhfh\"><code>inline-c</code>'s reddit announcement</a>:</p>\n\n<blockquote>\n  <p>How does this compare to language-c-inline?</p>\n</blockquote>\n\n\n\n<blockquote>\n  <ul>\n  <li>In <code>inline-c</code> we have a very simple core library which is easily extensible with additional anti quoters. I wanted the core functionality to be very predictable, and leave fancier marshalling up to specific use cases. In <code>language-c-inline</code> the marshalling works with a mix of hard-coded rules and user-supplied Template Haskell functions.</li>\n  <li>We wanted to make the language to include the C code as simple as possible. The inline C is spliced with a quasi quoter and no Template Haskell functions. The inline C code specifies the Haskell variables to capture using anti-quoters, and the target types are all specified using C syntax. As I say in the blog post I cared quite a bit that this is the case, to have confidence that what you're getting in C is what you expect. Relatedly, only the anti-quoters are examined: the rest of the C code is not parsed and left verbatim, so we don't have to worry about eventual incompatibilities between the C compiler the user is using and the Haskell C parser that <code>language-c-inline</code> uses.</li>\n  <li><p>We're also making sure that the infrastructure and build process is smooth. The <code>addTopDecl</code> function is used to avoid having to populate tables at runtime like <code>language-c-inline</code> does, and I also employ various tricks to make sure that everything will work smoothly across builds. For example, the names of the generated C functions is based on the hash of the contents of the function itself. This is quite important to guarantee that repeated builds of the same file by cabal -- for example when compiling with profiling support -- result in the same C symbols being generated, while making sure that the the symbols are the same only if the C snippets in the module are the same.</p>\n  \n  <p>[\u2026]</p></li>\n  </ul>\n  \n  <p>In short, the two libraries are very similar in spirit, but we coded <code>inline-c</code> to be better suited to our needs taking different design choices. Some of the advantages above could be easily ported to <code>language-c-inline</code>, especially the ones in the last point.</p>\n</blockquote>\n\n<p>The <a href=\"https://www.fpcomplete.com/blog/2015/05/inline-c\">announcement on fpcomplete</a> also contains additional information, but all in all, yep, their somewhat similar.</p>\n"}], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 2, "accepted_answer_id": 30479685, "answer_count": 1, "score": 10, "last_activity_date": 1432722100, "creation_date": 1432717959, "question_id": 30478003, "link": "https://stackoverflow.com/questions/30478003/what-are-the-differences-between-inline-c-and-language-c-inline", "title": "What are the differences between inline-c and language-c-inline?", "body": "<p>I've been briefly looking into quasi-quotation libraries for Haskell. These libraries allow Haskell to integrate with other languages. For integrating with C, there appears to be two packages with similar functionality:</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/inline-c\" rel=\"noreferrer\">inline-c</a></li>\n<li><a href=\"https://hackage.haskell.org/package/language-c-inline\" rel=\"noreferrer\">language-c-inline</a> (which uses <a href=\"https://hackage.haskell.org/package/language-c-quote\" rel=\"noreferrer\">language-c-quote</a>)</li>\n</ul>\n\n<p>As I'm looking to build a quasi-quotation library of my own, I'm interested in design choices, API differences, performance etc.</p>\n\n<p>The only difference I'm aware of is that <code>language-c-quote</code> supports C and Objective-C, whereas <code>inline-c</code> supports C.</p>\n\n<p>How would you distinguish these packages? What are the fundamental differences? Are they, in fact, similar?</p>\n"}, {"tags": ["c", "haskell", "types", "ffi", "hsc2hs"], "comments": [{"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1432713291, "post_id": 30474224, "comment_id": 49032120, "body": "I&#39;ve been working through the first and fourth link. The problem I am running in to now is how to export a function that returns <code>TestData</code> to C. I think it needs to looks like this <code>testParse :: CString -&gt; IO (Ptr TestData)</code> but I am not sure how to wrap TestData into a Ptr. I already have a Storable instance for TestData."}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1432714895, "post_id": 30474224, "comment_id": 49033135, "body": "Got it to compile with <code>testParse :: CString -&gt; IO (StablePtr TestData)</code> but I am getting a segmentation fault in C. Maybe it is the way I setup Storable. I&#39;ll post code later."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1432715893, "post_id": 30474224, "comment_id": 49033715, "body": "have you tried looking into the source code of existing Haskell FFI C bindings? I&#39;m pretty sure it&#39;s not the first time something like this is attempted."}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1432730977, "post_id": 30474224, "comment_id": 49044464, "body": "I am sure it is not the first time. I have found a bit of code on Github. I think I&#39;ll be able to piece something together, seems like the right way to do it is pass a Ptr and mutate the pointed item. Anyway, I&#39;ll post my result as answer in the next day or two."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1432734150, "post_id": 30474224, "comment_id": 49046992, "body": "I&#39;m a bit unclear of <i>where</i> you run into trouble. Could you clarify?"}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "edited": false, "score": 0, "creation_date": 1432736894, "post_id": 30474224, "comment_id": 49049281, "body": "Sorry for the lack of clarity. I added some code at the bottom that should make it a little bit clearer. Getting a segmentation fault in C."}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 1, "creation_date": 1432738710, "post_id": 30474224, "comment_id": 49050741, "body": "@MCH <code>setFoo(&amp;f)</code> &lt;-- that seems to be wrong. You are passing a pointer to a pointer to <code>foo</code>, that means that caller allocates space for <code>foo</code>. But haskell site doesn&#39;t allocate anything, it just initializes the memory. You shoud do <code>setFoo(f)</code>."}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1432740099, "post_id": 30474224, "comment_id": 49051835, "body": "@Yuras you are right. I guess it has been too long since I have written C. Seems to be working now, but I&#39;ll do some more tests to confirm."}], "answers": [{"comments": [{"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 1, "creation_date": 1432812638, "post_id": 30500707, "comment_id": 49086021, "body": "Just for the record: you need to free memory allocated by <code>malloc</code> and <code>newCString</code>"}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1432819332, "post_id": 30500707, "comment_id": 49091210, "body": "I added malloc for the struct and free for the CStrings. Does that look right?"}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 10, "last_activity_date": 1432818868, "last_edit_date": 1432818868, "creation_date": 1432800479, "answer_id": 30500707, "question_id": 30474224, "link": "https://stackoverflow.com/questions/30474224/hsc2hs-mutate-a-c-struct-with-haskell/30500707#30500707", "title": "hsc2hs: Mutate a C struct with Haskell", "body": "<p>This is a complete example of a C program that passes a struct to Haskell then Haskell mutates the values of that struct. It has no outside dependencies. You should be able to copy the code and run it if you have GHC. Hopefully this will serve as a simple, straightforward example for others.</p>\n\n<p><strong>Foo.h</strong></p>\n\n<pre><code>typedef struct {\n    char *a;\n    char *b;\n    int   c;\n} foo;\n</code></pre>\n\n<p><strong>Foo.c</strong></p>\n\n<pre><code>#include \"foo.h\"\n</code></pre>\n\n<p><strong>HsFoo.hsc</strong></p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n{-# LANGUAGE CPP                      #-}\n\nmodule HsFoo where\n\nimport Foreign\nimport Foreign.C\n\nimport Control.Applicative\nimport Control.Monad\n\n#include \"foo.h\"\n\ndata Foo = Foo { \n    a :: CString\n  , b :: CString\n  , c :: Int\n} deriving Show\n\ninstance Storable Foo where\n    sizeOf    _ = #{size foo}\n    alignment _ = alignment (undefined :: CString)\n\n    poke p foo = do\n        #{poke foo, a} p $ a foo\n        #{poke foo, b} p $ b foo\n        #{poke foo, c} p $ c foo\n\n    peek p = return Foo\n              `ap` (#{peek foo, a} p)\n              `ap` (#{peek foo, b} p)\n              `ap` (#{peek foo, c} p)\n\nforeign export ccall \"free_HaskellPtr\" free :: Ptr a -&gt; IO ()\nforeign export ccall \"setFoo\" setFoo :: Ptr Foo -&gt; IO ()\nsetFoo :: Ptr Foo -&gt; IO ()\nsetFoo f = do\n  newA &lt;- newCString \"abc\"\n  newB &lt;- newCString \"def\"\n  poke f $ Foo newA newB 3\n  return ()\n</code></pre>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"HsFoo_stub.h\"\n#include \"foo.h\"\n\nint main(int argc, char *argv[]) {  \n  hs_init(&amp;argc, &amp;argv);\n\n  foo *f;\n  f = malloc(sizeof(foo));\n  f-&gt;a = \"Hello\";\n  f-&gt;b = \"World\";\n  f-&gt;c = 55555; \n\n  printf(\"foo has been set in C:\\n  a: %s\\n  b: %s\\n  c: %d\\n\",f-&gt;a,f-&gt;b,f-&gt;c);\n\n  setFoo(f);\n\n  printf(\"foo has been set in Haskell:\\n  a: %s\\n  b: %s\\n  c: %d\\n\",f-&gt;a,f-&gt;b,f-&gt;c);\n\n  free_HaskellPtr(f-&gt;a);\n  free_HaskellPtr(f-&gt;b);\n  free(f);\n  hs_exit();\n}\n</code></pre>\n\n<p><strong>Command Line</strong> - Compile files and run</p>\n\n<pre><code>$ hsc2hs HsFoo.hsc\n$ ghc -c HsFoo.hs foo.c\n$ ghc -no-hs-main foo.c HsFoo.o main.c -o main\n$ ./main\n</code></pre>\n"}], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 3, "accepted_answer_id": 30500707, "answer_count": 1, "score": 5, "last_activity_date": 1432818868, "creation_date": 1432706207, "last_edit_date": 1432801391, "question_id": 30474224, "link": "https://stackoverflow.com/questions/30474224/hsc2hs-mutate-a-c-struct-with-haskell", "title": "hsc2hs: Mutate a C struct with Haskell", "body": "<p>I am trying to write a Haskell program that communicates with C (ultimately for iOS via GHC-iOS). I want it to pass a string from C to Haskell, have Haskell process it and then return some Data types from Haskell to C Structs via hsc2s. I have been unsuccessful at finding a clear, simple tutorial. The only thing Haskell needs from C is the String, nothing else.</p>\n\n<p>I have no trouble with the very first part, passing a string to Haskell.</p>\n\n<pre><code>testPrint :: CString -&gt; IO ()\ntestPrint c = do \n    s &lt;- peekCString c\n    putStrLn s\n</code></pre>\n\n<p>For test purposes and future reference, I just want to be able to handle something like the following.</p>\n\n<p>C Struct</p>\n\n<pre><code>struct testdata {\n   char *a;\n   char *b;\n   int c;\n};\n</code></pre>\n\n<p>Haskell Data Type</p>\n\n<pre><code>data TestData =  TestData {\n  a :: String,\n  b :: String,\n  c :: Int\n} deriving Show\n\n-- not sure what the type would look like\ntestParse :: CString -&gt; TestData\n</code></pre>\n\n<p>I understand that I need to typeclass TestData as Storable and implement peek, poke, sizeOf and alignment, but I need to see a simple example before I can really understand it. Most of the tutorials require outside libraries and make it more complicated than it needs to be.</p>\n\n<p>Here are the resources I've looked at:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/6056323/how-to-use-hsc2hs-to-bind-to-constants-functions-and-data-structures\">Stackoverflow - How to use hsc2hs to bind to constants, functions and data structures?</a></p>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/haskell-cafe/mJalEcZ-dTI\" rel=\"nofollow\">Haskell Cafe - FFI for a beginner</a></p>\n\n<p><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/hsc2hs.html\" rel=\"nofollow\">Writing Haskell interfaces to C code: hsc2hs</a></p>\n\n<p><a href=\"https://en.wikibooks.org/wiki/Haskell/FFI\" rel=\"nofollow\">Haskell Wikibook - FFI</a></p>\n\n<p>Edit: Currently where I am stuck (gets segmentation error when setFoo is called in C)</p>\n\n<p>Haskell Code Snippet</p>\n\n<pre><code>instance Storable Foo where\n  sizeOf = #{size foo}\n  alignment = alignment (undefined :: CString)\n  poke p foo = do\n     #{poke foo, a} p $ a foo\n     #{poke foo, b} p $ b foo\n     #{poke foo, c} p $ c foo\n  peek p = return Foo\n    `ap` (#{peek foo, a} p)\n    `ap` (#{peek foo, b} p)\n    `ap` (#{peek foo, c} p)\n\nforeign export ccall \"setFoo\" setFoo :: Ptr Foo -&gt; IO ()\n\nsetFoo :: Ptr Foo -&gt; IO ()\nsetFoo f = do\n  newA &lt;- newCString \"abc\"\n  newB &lt;- newCString \"def\"\n  poke f (Foo newA newB 123)\n</code></pre>\n\n<p>C Code Snippet</p>\n\n<pre><code>foo *f;\nf = malloc(sizeof(foo));\nfoo-&gt;a = \"bbb\"\nfoo-&gt;b = \"aaa\"\nfoo-&gt;c = 1\n// this is incorrect\n// setFoo(&amp;f);\n// this is correct\nsetFoo(f);\n</code></pre>\n"}, {"tags": ["c", "haskell", "recursion", "tail-recursion"], "comments": [{"owner": {"reputation": 6036, "user_id": 1717828, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b52e6a27ec5f0cee4f12713f058923f2?s=128&d=identicon&r=PG", "display_name": "user1717828", "link": "https://stackoverflow.com/users/1717828/user1717828"}, "edited": false, "score": 0, "creation_date": 1432693011, "post_id": 30472022, "comment_id": 49024323, "body": "Hey, Downvoter, please give an explanation.  I see nothing obviously wrong with this question."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1432693222, "post_id": 30472022, "comment_id": 49024362, "body": "&quot;THIS IS THE NTH ELEM&quot;. What does &quot;THIS&quot; refer to? I assume you are setting <code>i</code> in <code>getNthFromLast</code>. But how does that in itself give you the nth element?"}, {"owner": {"reputation": 269, "user_id": 1084637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745239e23061d746727436ec06e5dd2e?s=128&d=identicon&r=PG", "display_name": "asp5", "link": "https://stackoverflow.com/users/1084637/asp5"}, "edited": false, "score": 0, "creation_date": 1432693565, "post_id": 30472022, "comment_id": 49024443, "body": "@ Alan, THIS is the &quot;node&quot; in this case. I did not type out the whole solution, as that can be implemented easily like here for example:  <a href=\"http://www.programmerinterview.com/index.php/data-structures/find-nth-to-last-element-in-a-linked-list/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 9, "creation_date": 1432693826, "post_id": 30472022, "comment_id": 49024511, "body": "By not providing full and accurate information your question ends up being unclear. Why would you need <code>i</code> to be static? Why would you need any global variables even for the non-recursive case? It doesn&#39;t make sense at all. <code>getNthFromLast</code> can return a pointer to a node that it has found. No global/static is needed regardless of whether the implementation is iterative or recursive. So what is it you are really asking?"}, {"owner": {"reputation": 269, "user_id": 1084637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745239e23061d746727436ec06e5dd2e?s=128&d=identicon&r=PG", "display_name": "asp5", "link": "https://stackoverflow.com/users/1084637/asp5"}, "edited": false, "score": 0, "creation_date": 1432734579, "post_id": 30472022, "comment_id": 49047358, "body": "Thanks all for the replies and comments. I&#39;ll make sure to make the questions more clear from next time."}], "answers": [{"tags": [], "owner": {"reputation": 4446, "user_id": 696485, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4de94e14f977802057b0109d079d95a1?s=128&d=identicon&r=PG", "display_name": "Iskar Jarak", "link": "https://stackoverflow.com/users/696485/iskar-jarak"}, "is_accepted": false, "score": 0, "last_activity_date": 1432696529, "last_edit_date": 1495539882, "creation_date": 1432696043, "answer_id": 30472453, "question_id": 30472022, "link": "https://stackoverflow.com/questions/30472022/find-nth-element-from-the-last-in-a-list-using-recursion/30472453#30472453", "title": "find nth element from the last in a list using recursion", "body": "<p>The typical iterative strategy uses two pointers and runs one to <code>n - 1</code> before starting to move the other.\nWith recursion, we can instead use the stack to count back up from the end of the list by adding a third argument. And to keep the usage clean, we can make a static helper function (in this sense it means only visible within compilation unit, <em>a totally different concept to a static variable with function scope</em>).</p>\n\n<pre><code>static node *nth_last_helper(node* curr, unsigned int n, unsigned int *f) {\n  node *t;\n  if (!curr) {\n    *f = 1;\n    return NULL;\n  }\n  t = nth_last_helper(curr-&gt;next, n, f);\n  if (n == (*f)++) return curr;\n  return t;\n}\n\nnode* nth_last(node* curr, unsigned int n) {\n  unsigned int finder = 0;\n  return nth_last_helper(curr, n, &amp;finder);\n}\n</code></pre>\n\n<p>Alternatively we could actually do the counting without the extra parameter, but I think this is less clear.</p>\n\n<pre><code>static node *nth_last_helper(node* curr, unsigned int *n) {\n  node *t;\n  if (!curr) return NULL;\n  t = nth_last_helper(curr-&gt;next, n);\n  if (t) return t;\n  if (1 == (*n)--) return curr;\n  return NULL;\n}\n\nnode* nth_last(node* curr, unsigned int n) {\n  return nth_last_helper(curr, &amp;n);\n}\n</code></pre>\n\n<p>Note that I have used unsigned integers to avoid choosing semantics for the \"negative nth last\" value in a list.</p>\n\n<p>However, neither of these are tail recursive. To achieve that, you can more directly convert the iterative solution into a recursive one, as in <a href=\"https://stackoverflow.com/questions/30472022/find-nth-element-from-the-last-in-a-list-using-recursion/30472503#30472503\">rici's answer</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 3, "last_activity_date": 1432697011, "last_edit_date": 1432697011, "creation_date": 1432696443, "answer_id": 30472503, "question_id": 30472022, "link": "https://stackoverflow.com/questions/30472022/find-nth-element-from-the-last-in-a-list-using-recursion/30472503#30472503", "title": "find nth element from the last in a list using recursion", "body": "<p>The linked page explains how to solve the problem with a two-finger solution; it's a bit surprising that they don't simply write the recursive version, which would be simple and clear. (In my experience, you don't succeed at interviews by providing tricky and obscure code when there is a simple and clear version which is equally efficient. But I suppose there are interviewers who value obscure code.)</p>\n\n<p>So, the two-finger solution is based on the observation that if we have two pointers into the list (the two fingers), and they are always <code>n</code> elements apart because we always advance them in tandem, then when the leading finger reaches the end of the list, the trailing finger will point at the element we want. That's an easy tail recursion:</p>\n\n<pre><code>Node* tandem_advance(Node* leading, Node* trailing) {\n  return leading ? tandem_advance(leading-&gt;next, trailing-&gt;next)\n                 : trailing;\n}\n</code></pre>\n\n<p>For the initial case, we need the leading finger to be N elements from the beginning of the list. Another simple tail recursion:</p>\n\n<pre><code>Node* advance_n(Node* head, int n) {\n  return n ? advance_n(head-&gt;next, n - 1)\n           : head;\n}\n</code></pre>\n\n<p>Then we just need to put the two together:</p>\n\n<pre><code>Node* nth_from_end(Node* head, int n) {\n  return tandem_advance(advance_n(head, n + 1), head);\n}\n</code></pre>\n\n<p>(We initially advance by <code>n+1</code> so that the 0th node from the end will be the last node. I didn't check the desired semantics; it might be that <code>n</code> would be correct instead.) </p>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 0, "creation_date": 1432702734, "post_id": 30473176, "comment_id": 49026917, "body": "I was going to suggest that but it turns out that it is slower than <code>nthFromLast n xs = x !! (length x - n)</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 1, "creation_date": 1432704745, "post_id": 30473176, "comment_id": 49027574, "body": "@No_signal, that sounds pretty strange, unless the list is rather short. The fastest way would surely be a bit more by-hand, but your approach looks pretty cache and GC unfriendly if the list is long."}, {"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 0, "creation_date": 1432714508, "post_id": 30473176, "comment_id": 49032867, "body": "I tested with <code>nthFromLast 50000 [1..100000]</code> and <code>last $ zipWith const xs (drop n xs)</code> was 2 times slower than <code>n !! (length xs - n)</code> but your new code is the fastest but not by much"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 0, "creation_date": 1432745738, "post_id": 30473176, "comment_id": 49055600, "body": "@No_signal, may I ask what GHC version and what optimization level you used?"}, {"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 0, "creation_date": 1432749258, "post_id": 30473176, "comment_id": 49057650, "body": "optimization -O2, GHC  7.8.3 and i tested using the Criterion package"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 0, "creation_date": 1432758743, "post_id": 30473176, "comment_id": 49062985, "body": "@No_signal, interesting indeed. My best guess for now is that the extra allocation of the <code>zip</code>+<code>last</code> approach beats out its other advantages, at least for those relatively short lists. But I don&#39;t know that it&#39;s worth investigating this particular question too deeply."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1432758786, "last_edit_date": 1432758786, "creation_date": 1432700829, "answer_id": 30473176, "question_id": 30472022, "link": "https://stackoverflow.com/questions/30472022/find-nth-element-from-the-last-in-a-list-using-recursion/30473176#30473176", "title": "find nth element from the last in a list using recursion", "body": "<p>In Haskell, the two-finger solution seems to be the obvious way. This version will go wrong in various ways if the requested element isn't present. I'll leave it as an exercise for you to fix that (hint: write versions of <code>drop</code> and <code>last</code> that return <code>Maybe</code> values, and then string the computations together with <code>&gt;&gt;=</code>). Note that this takes the last element of the list to be 0th from the end.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nthFromLast :: Int -&gt; [a] -&gt; a\nnthFromLast n xs = last $ zipWith const xs (drop n xs)\n</code></pre>\n\n<p>If you want to do some of the recursion by hand, which No_signal indicates gives better performance,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- The a and b types are different to make it clear\n-- which list we get the value from.\nlzc :: [a] -&gt; [b] -&gt; a\nlzc [] _ = error \"Empty list\"\nlzc (x : _xs) [] = x\nlzc (_x : xs) (_y : ys) = lzc xs ys\n\nnthFromLast n xs = lzc xs (drop n xs)\n</code></pre>\n\n<p>We don't bother writing out <code>drop</code> by hand because the rather simple-minded version in the library is about the best possible. Unlike either the first solution in this answer or the \"reverse, then index\" approach, the implementation using <code>lzc</code> only needs to allocate a constant amount of memory.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1432716381, "last_edit_date": 1432716381, "creation_date": 1432715861, "answer_id": 30477245, "question_id": 30472022, "link": "https://stackoverflow.com/questions/30472022/find-nth-element-from-the-last-in-a-list-using-recursion/30477245#30477245", "title": "find nth element from the last in a list using recursion", "body": "<p>I assume your code is missing</p>\n\n<pre><code>getNthFromLast(list *node_ptr, int n) {\n</code></pre>\n\n<p>right at the top. (!!)</p>\n\n<p>Your recursive version keeps track of <code>node_ptr</code>s in its call stack frames, so it is <em>essentially</em> non tail-recursive. Moreover, it continues to unwind the stack (go back up the stack of call frames), while incrementing the <code>i</code> and still checking its equality to <code>n</code>, even <em>after</em> it had found its goal <em>n</em>th node from the last; so it is <em>not</em> efficient.</p>\n\n<p>That would be an iterative version, indeed encodable as tail-recursive, that does things on the way forward, and so can stop immediately after reaching its target. For that, we open up the <em>n</em>-length gap from the start, not after the end is reached. Instead of counting backwards as your recursive version does, we count forward. This is the same two-pointers approach already mentioned here.</p>\n\n<p>In pseudocode, </p>\n\n<pre><code>end = head; \nrepeat n: (end = end-&gt;next); \nreturn tailrec(head,end)-&gt;payload;\n</code></pre>\n\n<p>where </p>\n\n<pre><code>tailrec(p,q) { \n    if(NULL==q): return p; \n    else: tailrec(p-&gt;next, q-&gt;next);\n}\n</code></pre>\n\n<p>This is 1-based, assuming <code>n &lt;= length(head)</code>. Haskell code is already given in another answer. </p>\n\n<p>This technique is known as <a href=\"https://en.wikipedia.org/wiki/Tail_call#Tail_recursion_modulo_cons\" rel=\"nofollow\">tail recursion <em>modulo cons</em></a>, or here, <em>modulo</em> <code>payload</code>-access.</p>\n"}, {"tags": [], "owner": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "is_accepted": false, "score": 1, "last_activity_date": 1432739657, "creation_date": 1432739657, "answer_id": 30486518, "question_id": 30472022, "link": "https://stackoverflow.com/questions/30472022/find-nth-element-from-the-last-in-a-list-using-recursion/30486518#30486518", "title": "find nth element from the last in a list using recursion", "body": "<pre><code>nthFromLast lst n = reverse lst !! n\n</code></pre>\n\n<p>Because Haskell is lazy, this should be sufficiently efficient</p>\n\n<p>If you don't want to use <code>!!</code>, you'll have to redefine it yourself, but this is silly.</p>\n"}], "owner": {"reputation": 269, "user_id": 1084637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745239e23061d746727436ec06e5dd2e?s=128&d=identicon&r=PG", "display_name": "asp5", "link": "https://stackoverflow.com/users/1084637/asp5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 30472503, "answer_count": 5, "score": -1, "last_activity_date": 1432758786, "creation_date": 1432692784, "last_edit_date": 1432693792, "question_id": 30472022, "link": "https://stackoverflow.com/questions/30472022/find-nth-element-from-the-last-in-a-list-using-recursion", "title": "find nth element from the last in a list using recursion", "body": "<p>we can solve this problem in, say C, using a static variable, like in the snippet below (<a href=\"http://www.programmerinterview.com/index.php/data-structures/find-nth-to-last-element-in-a-linked-list/\" rel=\"nofollow\">like the function found in this page</a>).</p>\n\n<pre><code>static int i = 0;\nif(head == NULL)\n   return;\ngetNthFromLast(head-&gt;next, n);\nif(++i == n)\n  {THIS IS THE NTH ELEM FROM LAST\n   DO STUFF WITH IT.\n  }\n</code></pre>\n\n<ol>\n<li><p>I'm trying to see if I can solve this using a tail call recursion,\nand NO static variables/global variables. </p></li>\n<li><p><em>I'm trying to learn Haskell</em> was wondering how to implement this in a purely functional way, with out using Haskell's <code>length</code> and\n<code>!!</code> something like <code>x !! ((length x) - K)</code>.</p></li>\n</ol>\n\n<p>So started by asking, how we can do it in C, with recursion and NO static/global variables, just to get some idea.</p>\n\n<p>Any suggestions/pointers would be appreciated. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 20544, "user_id": 1073695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2dca512cb7914943d46461d0bbbacd5a?s=128&d=identicon&r=PG", "display_name": "Jo So", "link": "https://stackoverflow.com/users/1073695/jo-so"}, "edited": false, "score": 0, "creation_date": 1432690125, "post_id": 30471630, "comment_id": 49023629, "body": "That&#39;s a nice explanation but I think it would be more appropriate to give a monad explanation."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1432689988, "creation_date": 1432689988, "answer_id": 30471630, "question_id": 30471253, "link": "https://stackoverflow.com/questions/30471253/haskell-recursion-in-do-notation/30471630#30471630", "title": "Haskell recursion in &#39;do&#39; notation", "body": "<p>Note that <code>concatMap moveKnight</code> has type <code>[Knight] -&gt; [Knight]</code> and will return the positions reachable from the input positions.</p>\n\n<p>Knowing that, you can use:</p>\n\n<pre><code>iterate (concatMap moveKnight)\n</code></pre>\n\n<p>to generate an infinite list of sets of positions where the next set of positions is obtained by making a knight move from a position in the previous set.</p>\n\n<p>For example:</p>\n\n<pre><code>iterate (concatMap moveKnight) [(1,2)]\n  = [ [(1,2)],               -- the initial list\n      [(3,1),(3,3),(2,4)],   -- after one iteration\n      [(5,2),(1,2),(4,3),(2,3), ... -- after two iterations\n      ...\n    ]\n</code></pre>\n\n<p>Now <code>in3</code> may be written as</p>\n\n<pre><code>in3 xs = moves !! 3\n  where moves = iterate (concatMap moveKnight) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 4, "last_activity_date": 1432698122, "last_edit_date": 1432698122, "creation_date": 1432690464, "answer_id": 30471697, "question_id": 30471253, "link": "https://stackoverflow.com/questions/30471253/haskell-recursion-in-do-notation/30471697#30471697", "title": "Haskell recursion in &#39;do&#39; notation", "body": "<p>Using direct recursion:</p>\n\n<pre><code>inNMoves :: KnightPos -&gt; Int -&gt; [KnightPos]\ninNMoves start 0 = return start\ninNMoves start n = do\n  first &lt;- moveKnight start\n  inNMoves first (n - 1)\n</code></pre>\n\n<p>But as mentioned in the comments: you can use built-in functions for this. For example:</p>\n\n<pre><code>inNMoves start n = (foldl (&gt;&gt;=) . return) start (replicate n moveKnight)\n</code></pre>\n\n<p>Or even completely pointfree:</p>\n\n<pre><code>inNMoves = (. flip replicate moveKnight) . foldl (&gt;&gt;=) . return\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20544, "user_id": 1073695, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2dca512cb7914943d46461d0bbbacd5a?s=128&d=identicon&r=PG", "display_name": "Jo So", "link": "https://stackoverflow.com/users/1073695/jo-so"}, "is_accepted": true, "score": 10, "last_activity_date": 1432835992, "last_edit_date": 1432835992, "creation_date": 1432690531, "answer_id": 30471705, "question_id": 30471253, "link": "https://stackoverflow.com/questions/30471253/haskell-recursion-in-do-notation/30471705#30471705", "title": "Haskell recursion in &#39;do&#39; notation", "body": "<p>As this exercise is about the List <em>Monad</em>, try to not think of what you know about lists, but limit yourself to the structure of monads. So that would be</p>\n\n<pre><code>move :: Monad m =&gt; Pos -&gt; m Pos\n</code></pre>\n\n<p>That is, <code>move</code> takes a <code>Pos</code> and gives you back something that is about <code>Pos</code> things in some monadic context <code>m</code>. (In the case of lists, the \"context\" being \"arbitrary multiplicity + ordering\". But try not to think about it).</p>\n\n<p>Also, let's not talk about <code>do</code> here which is only syntactic sugar for using <code>(&gt;&gt;=)</code>. For the purposes of this explanation, you are required to know how do translates to expressions using <code>(&gt;&gt;=)</code>.</p>\n\n<p><code>(&gt;&gt;=)</code> has signature <code>m a -&gt; (a -&gt; m b) -&gt; m b</code>. The instance which we need being <code>m Pos -&gt; (Pos -&gt; m Pos) -&gt; m Pos</code>. You see we have instanciated both <code>a</code> and <code>b</code> here to <code>Pos</code>. You also can recognize the middle part <code>(Pos -&gt; m Pos)</code> being <code>move</code>'s signature here. So using <code>(&gt;&gt;=)</code> and giving it <code>move</code> as second argument, we can make a function of type <code>m Pos -&gt; m Pos</code>.</p>\n\n<pre><code>moveM :: Monad m =&gt; m Pos -&gt; m Pos\nmoveM mp = mp &gt;&gt;= move\n</code></pre>\n\n<p><strong>Composition of monad endomorphisms</strong></p>\n\n<p>It is clear that <code>m Pos -&gt; m Pos</code> can be executed in sequence as often as you wish since it is a function from a type to itself (I think that can be called <em>monad endomorphism</em> since the type is a monad).</p>\n\n<p>Let's write a function which does two moves.</p>\n\n<pre><code>move2M :: Monad m =&gt; m Pos -&gt; m Pos\nmove2M mp = moveM (moveM (mp))\n</code></pre>\n\n<p>Or in pointfree style (thinking only about the <em>transformation</em>, not about the transformated object):</p>\n\n<pre><code>move2M :: Monad m =&gt; m Pos -&gt; m Pos\nmove2M = moveM . moveM\n</code></pre>\n\n<p>For the general case (number of moves parameterized by an integer <code>n</code>) we just want some number of <code>moveM</code>s connected by the function chaining operator <code>.</code>. So if n is 3, we want <code>moveM . moveM . moveM</code>. Here's how to do this programmatically:</p>\n\n<pre><code>nmoveM :: Monad m =&gt; Int -&gt; m Pos -&gt; m Pos\nnmoveM n = foldr1 (.) (replicate n moveM)  -- n \"moveM\"s connected by (.)\n</code></pre>\n\n<p>A question arises here: What is the result of moving 0 times? <code>foldr1</code> is undefined for values of <code>n</code> &lt;= 0. It makes quite a lot of sense to define <code>nmoveM 0</code> to \"doing nothing\". In other words, the identity function, <code>id</code>.</p>\n\n<pre><code>nmoveM :: Monad m =&gt; Int -&gt; m Pos -&gt; m Pos\nnmoveM n = foldr (.) id (replicate n moveM)\n</code></pre>\n\n<p>Here, we used <code>foldr</code> instead of <code>foldr1</code> which needs an additional \"base case\", <code>id</code>.</p>\n\n<p>Now we basically have what we want, but the type signature doesn't fit 100%: We have a <code>m Pos -&gt; m Pos</code>, but we want <code>Pos -&gt; m Pos</code>. That means, given a <code>Pos</code>, we first have to embed it in the context <code>m</code>, and then execute <code>nMoveM</code>. This embedding operator (i think it could be called <em>initial algebra</em>) is <code>return</code> (of type <code>Monad m =&gt; a -&gt; m a</code>)</p>\n\n<pre><code>nmoves :: Monad m =&gt; Int -&gt; Pos -&gt; m Pos\nnmoves n = nmoveM n . return\n</code></pre>\n\n<p>Let's write all that at once so you can appreciate the terseness in its full glory.</p>\n\n<pre><code>nmoves :: Monad m =&gt; Int -&gt; Pos -&gt; m Pos\nnmoves n = foldr (.) id (replicate n move) . return\n</code></pre>\n\n<p><strong>Composition of arrows</strong></p>\n\n<p>Using <code>(&gt;&gt;=)</code> is actually often a little unclean because it is so un-symmetric: It takes an <code>m a</code> and an <code>a -&gt; m b</code>. In other words, it is a little too concerned about the transformed object, instead only the transformation for our case. This makes it unnecessarily hard to compose transformations. That's why we had to tack on <code>. return</code>: It's the initial transformation from <code>Pos</code> to <code>m Pos</code>, so that we can freely combine arbitrary amounts of <code>m Pos -&gt; m Pos</code>.</p>\n\n<p>Using <code>(&gt;&gt;=)</code> results in the following pattern:</p>\n\n<pre><code>ma &gt;&gt;= f_1 &gt;&gt;= f_2 &gt;&gt;= ... &gt;&gt;= f_n\n</code></pre>\n\n<p>where <code>ma</code> is a monad thing and the <code>f_i</code> are \"arrows\" of type <code>a -&gt; m b</code> (where often a = b).</p>\n\n<p>There is a much nicer variant, <code>(&gt;=&gt;)</code>, which combines two <code>a -&gt; m b</code> type arrows in a sequence, and returns another arrow.</p>\n\n<pre><code>(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; (a -&gt; m c)\n</code></pre>\n\n<p>Here we are not unnecessarily concerned with the transformed objects, but only with transformations and their composition.</p>\n\n<p>Now let's agree that <code>move</code> is actually such an arrow (<code>Pos -&gt; m Pos</code>). So</p>\n\n<pre><code>move &gt;=&gt; move &gt;=&gt; move &gt;=&gt; move &gt;=&gt; move\n</code></pre>\n\n<p>is a valid expression still of type <code>Pos -&gt; m Pos</code>. The composable nature of monads becomes much more apparent when using <code>(&gt;=&gt;)</code>.</p>\n\n<p>We could re-write <code>nmoves</code> using <code>(&gt;=&gt;)</code> like so:</p>\n\n<pre><code>nmoves :: Monad m =&gt; Int -&gt; Pos -&gt; m Pos\nnmoves n = foldr1 (&gt;=&gt;) (replicate n move)  -- n \"move\"s connected by &gt;=&gt;\n</code></pre>\n\n<p>Again, we used <code>foldr1</code>, and we are asking \"what gives 0 times move in a row\"? It must be of the same type, <code>Pos -&gt; m Pos</code>, and the answer is <code>return</code>.</p>\n\n<pre><code>nmoves :: Monad m =&gt; Int -&gt; Pos -&gt; m Pos\nnmoves n = foldr (&gt;=&gt;) return (replicate n move)\n</code></pre>\n\n<p>Compare this to our earlier definition of <code>nmoves</code> in the monad endomorphisms world: Instead of functions combined with <code>(.)</code> and the base case <code>id</code>, we now combine arrows with <code>(&gt;=&gt;)</code> and the base case <code>return</code>. The benefit being that we don't have to inject the given <code>Pos</code> to <code>m Pos</code>.</p>\n\n<p>What makes more sense depends on your case, but more often than not <code>(&gt;=&gt;)</code> is much cleaner than <code>(&gt;&gt;=)</code>.</p>\n"}], "owner": {"reputation": 368, "user_id": 4204160, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/62550e8dec6bd6a777fe3c0013b820df?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin", "link": "https://stackoverflow.com/users/4204160/marcin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 2, "accepted_answer_id": 30471705, "answer_count": 3, "score": 4, "last_activity_date": 1432835992, "creation_date": 1432686899, "last_edit_date": 1432728816, "question_id": 30471253, "link": "https://stackoverflow.com/questions/30471253/haskell-recursion-in-do-notation", "title": "Haskell recursion in &#39;do&#39; notation", "body": "<p>I'm reading this tutorial <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow\">http://learnyouahaskell.com/a-fistful-of-monads</a> and stumbled upon this definition:</p>\n\n<pre><code>type KnightPos = (Int,Int) \n\nmoveKnight :: KnightPos -&gt; [KnightPos]  \nmoveKnight (c,r) = do  \n    (c',r') &lt;- [(c+2,r-1),(c+2,r+1),(c-2,r-1),(c-2,r+1)  \n               ,(c+1,r-2),(c+1,r+2),(c-1,r-2),(c-1,r+2)  \n               ]  \n    guard (c' `elem` [1..8] &amp;&amp; r' `elem` [1..8])  \n    return (c',r') \n\nin3 :: KnightPos -&gt; [KnightPos]  \nin3 start = do   \n    first &lt;- moveKnight start  \n    second &lt;- moveKnight first  \n    moveKnight second  \n</code></pre>\n\n<p>I have a question regarding function <code>in3</code> (which takes a pair of coordinates (Int,Int) on a chessboard and produces a list of fields [(Int,Int)] reachable from that field in exactly 3 moves of a knight).<br><br>Is it possible (and if so - how to do it) to remake that function into <br><code>inNMoves :: (Num a) =&gt; KnightPos -&gt; a -&gt; [KnightPos]</code> <br>so that it also takes the number of moves as an argument, instead of being bound to exactly 3 jumps?</p>\n"}, {"tags": ["performance", "haskell", "memory-leaks", "functional-programming", "scientific-computing"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1432680264, "post_id": 30470013, "comment_id": 49020820, "body": "Looks a bit the same as whether a system with a garbage collector is appropriate: because of the <code>gc</code> people normally don&#39;t destroy objects that are no longer necessary: they count that the gc will find them eventually. But this can result in a large number of heap objects that are only active because a reference is not set to <code>null</code> making all these objects garbage."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 6, "creation_date": 1432680450, "post_id": 30470013, "comment_id": 49020897, "body": "Laziness does not mean space leaks, just as strictness doesn&#39;t.  There are different techniques for managing both kinds of memory models.  How you write your application determines if your application will be able to run for long periods of time.  I know <a href=\"https://github.com/facebook/Haxl\" rel=\"nofollow noreferrer\">Facebook is using Haskell</a> as a middle layer between multiple data stores and some of their frontend services, but I don&#39;t know whether those are short lived processes.  My guess is that they would need to be long running, so if that&#39;s the case you would have a pretty solid example right there."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1432680546, "post_id": 30470013, "comment_id": 49020931, "body": "@bheklilr: I don&#39;t think MaxB is referring to space leaks: Haskell manages memory correctly (or should from a theoretical pov), but it can take ages before dead objects are recycled."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1432680635, "post_id": 30470013, "comment_id": 49020958, "body": "@MaxB, you can&#39;t really &quot;delete all garbage&quot; in gc languages.  We&#39;re talking about forgetting to set certain references to <code>null</code>, which is quite similar to not evaluating certain expressions because of what they refer to.  However, it can indeed be quite difficult to reason about memory in Haskell programs compared to their imperative counterparts.  You can design your persistent data structures in a way to guarantee they hold no unevaluated thunks -- if I were writing a largish system I would probably do that.  It does limit your expressivity, but also provides a checkpoint for memory usage."}, {"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 1, "creation_date": 1432728876, "post_id": 30470013, "comment_id": 49042894, "body": "Read this : <a href=\"http://engineering.imvu.com/2014/03/24/what-its-like-to-use-haskell/\" rel=\"nofollow noreferrer\">engineering.imvu.com/2014/03/24/what-its-like-to-use-haskell</a> . It seems that Haskell works pretty well fort long running services but space leaks can be harder to find (though tooling is improving so I don&#39;t know how hard it now is)."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432832711, "post_id": 30470013, "comment_id": 49100911, "body": "@MaxB, If you&#39;re happy with any of the below answers, you should probably accept one of them."}], "answers": [{"comments": [{"owner": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "edited": false, "score": 0, "creation_date": 1432710654, "post_id": 30472073, "comment_id": 49030498, "body": "<code>The warp web server proves...</code>  Are there any busy web sites that use it?"}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "edited": false, "score": 3, "creation_date": 1432720821, "post_id": 30472073, "comment_id": 49037233, "body": "<a href=\"https://github.com/yesodweb/yesod/wiki/Powered-by-Yesod\" rel=\"nofollow noreferrer\">github.com/yesodweb/yesod/wiki/Powered-by-Yesod</a> has an incomplete list of websites which use the Yesod framework (which would be difficult to use with another web server). None seem to be all that busy, but it&#39;s hard to tell sometimes. On the other hand: in benchmarks warp handles more requests per second than nginx except on single core servers. On 10 core servers: warp is 5 times faster than nginx."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 8, "last_activity_date": 1432693150, "creation_date": 1432693150, "answer_id": 30472073, "question_id": 30470013, "link": "https://stackoverflow.com/questions/30470013/is-haskell-appropriate-for-long-running-applications/30472073#30472073", "title": "Is Haskell appropriate for long-running applications?", "body": "<p>The warp web server proves that Haskell is appropriate for long-running applications.</p>\n\n<p>When Haskell applications have space leaks, it can be difficult to track down the cause, but once the cause is known it's usually trivial to resolve (the hardest fix I've ever had to use was to apply <code>zip [1..]</code> to a list and get the length from the last element instead of using the <code>length</code> function). But space leaks are actually very rare in Haskell programs. It's generally harder to deliberately create a space leak than it is to fix an accidental one.</p>\n"}, {"comments": [{"owner": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "edited": false, "score": 0, "creation_date": 1432779356, "post_id": 30494554, "comment_id": 49069485, "body": "Not a web programmer, but I think most HTTP servers need to retain some information after serving a request: logging, new content (like on this site), items left in stock, etc."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432855436, "post_id": 30494554, "comment_id": 49112254, "body": "@Carsten, so maybe we&#39;re implementing a database or some such thing."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1432872545, "post_id": 30494554, "comment_id": 49116177, "body": "@luqui ??? well seems I&#39;m the strange kind of kid you don&#39;t wanna play with here - so ok I&#39;ll shut up already"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1432872789, "post_id": 30494554, "comment_id": 49116238, "body": "I think you&#39;re hearing my frustration with defining away the problem in order to self-gratify, which seems to happen when people bring up problems with the language we love..."}], "tags": [], "owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "is_accepted": false, "score": 6, "last_activity_date": 1432767659, "creation_date": 1432767659, "answer_id": 30494554, "question_id": 30470013, "link": "https://stackoverflow.com/questions/30470013/is-haskell-appropriate-for-long-running-applications/30494554#30494554", "title": "Is Haskell appropriate for long-running applications?", "body": "<p>Most long-running apps are request driven. For example HTTP servers associate all transient data with an HTTP request. After the request ends the data is thrown away. So at least for those kinds of long-running apps any language will not have space leaks. Leak all you want in the context of a single request. As long as you do not create global references to per-request data you will not leak.</p>\n\n<p>All bets are off if you mutate global state. That is to be avoided for many reasons, and it is uncommon in such apps.</p>\n"}, {"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": false, "score": 3, "last_activity_date": 1433188560, "creation_date": 1433188560, "answer_id": 30582121, "question_id": 30470013, "link": "https://stackoverflow.com/questions/30470013/is-haskell-appropriate-for-long-running-applications/30582121#30582121", "title": "Is Haskell appropriate for long-running applications?", "body": "<p>I have a service written in haskell that works for months without any haskell-specific issue. There was a period when it worked 6 months without any attention, but then I restarted it to apply updated. It contains a stateless HTTP API, but also it has statefull websockets interface, so it maintains long living state. Its sources are closed, so I can't provide a link, but it my experience haskell works fine for long-running applications.</p>\n\n<p>Laziness is not an issue for me, but that is because I know how to deal with it. It is not hard, but requires some experience.</p>\n\n<p>Also libraries on hackage have different quality, and keeping dependencies under control is an important thing. I try to avoid dependencies unless they are really necessary, and I inspect most of their code (except a number of widely used packages, most of them are either core libraries or part of Haskell Platform, though I inspect their code too -- just to learn new things.)</p>\n\n<p>Though there are corner cases when GHC (the most widely used implementation) doesn't work well enough. I had issues with GC time when an application maintains a huge (mostly readonly) state in memory (there is a <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9052\" rel=\"nofollow\">ticket</a>.) Also a lot of stable pointers can be problematic (the <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10470\" rel=\"nofollow\">ticket</a>, though I never experienced it myself.) Most of the time such the corner cases are easy to avoid by careful design.</p>\n\n<p>Actually application design is the most important thing for long-running applications. Implementation language plays less important role. Probably it is the biggest lesson I leaned the last few years -- software design is very important and it is not too different between languages. </p>\n"}, {"comments": [{"owner": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "edited": false, "score": 2, "creation_date": 1433238899, "post_id": 30592002, "comment_id": 49254152, "body": "<code>xmonad</code> has very low complexity (&lt; 1KLOC). It&#39;s unclear how chasing leaks by looking at the profiler would scale, and doesn&#39;t <code>xmonad</code> sleep 99.9% of the time? (What does your <code>top</code> say?) Is <code>xmonad</code> really the best example of the use of Haskell in this type of application?"}, {"owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "reply_to_user": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "edited": false, "score": 0, "creation_date": 1433502520, "post_id": 30592002, "comment_id": 49391876, "body": "The core of xmonad is &lt; 1K, and is very similar to the core of a webserver. If you have different requirements for &quot;long running&quot; please specify what you mean."}, {"owner": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "edited": false, "score": 1, "creation_date": 1433506697, "post_id": 30592002, "comment_id": 49394546, "body": "I just clarified the requirements in the question."}], "tags": [], "owner": {"reputation": 134362, "user_id": 83805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c3dd15d6cd5d99a63113843d7e1c1b?s=128&d=identicon&r=PG", "display_name": "Don Stewart", "link": "https://stackoverflow.com/users/83805/don-stewart"}, "is_accepted": false, "score": 16, "last_activity_date": 1433236684, "creation_date": 1433236684, "answer_id": 30592002, "question_id": 30470013, "link": "https://stackoverflow.com/questions/30470013/is-haskell-appropriate-for-long-running-applications/30592002#30592002", "title": "Is Haskell appropriate for long-running applications?", "body": "<p>\"Space leaks\" are semantically identical to any other kind of resource use problem in any language. In strict languages the GC tends to allocate and retain too much data (as structures are strict).</p>\n\n<p>No matter the language you should be doing some \"burn in\" to look for resource usage over time, and Haskell is no different.</p>\n\n<p>See e.g. <code>xmonad</code>, which runs for months or years at a time. It's a Haskell app, has a tiny heap use, and I tested it by running for weeks or months with profiling on to analyze heap patterns. This gives me confidence that resource use is stable.</p>\n\n<p>Ultimately though, laziness is a red herring here. Use the resource monitoring tools and testing to measure and validate your resource expectations.</p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 8, "last_activity_date": 1433275622, "creation_date": 1433275622, "answer_id": 30605603, "question_id": 30470013, "link": "https://stackoverflow.com/questions/30470013/is-haskell-appropriate-for-long-running-applications/30605603#30605603", "title": "Is Haskell appropriate for long-running applications?", "body": "<p>It is. There are 2 kinds of possible space leaks:</p>\n\n<p><strong>Data on the heap.</strong> Here the situation is no different from other languages that use GC. (And for the ones that don't the situation is usually worse - if there is an error, instead of increasing memory usage, the process might touch freed memory or vice versa and just crash badly.)</p>\n\n<p><strong>Unevaluated thunks.</strong> Admittedly, one can shoot oneself in the foot, \none must of course avoid well-known situations that produce large thunks like <code>foldl (+) 0</code>. But it's not difficult to prevent that, and for other leaks I'd say that it's actually easier than in other languages, when you get used to it.</p>\n\n<p>Either you have a long-running, heavy computation, or a service that responds to requests. If you have a long-running computation, you usually need results immediately as you compute them, which forces their evaluation.</p>\n\n<p>And if you have a service, its state is usually well-contained so it's easy to make sure it's always evaluated at the end of a request. In fact, Haskell makes this easier compared to other languages: In Haskell, you can't have components of your program keep their own internal state. The application's global state is either threaded as arguments in some kind of a main loop, or is stored using <code>IO</code>. And since a good design of an Haskell application limits and localizes <code>IO</code> as much as possible, it again makes the state easy to control.</p>\n\n<hr>\n\n<p>As another example the <a href=\"https://code.google.com/p/ganeti/\" rel=\"noreferrer\">Ganeti</a> project (of which I'm a developer) uses several Haskell long-running daemons.</p>\n\n<p>From our experience, memory leaks have been very rare, if we had problems, it was usually with other resources (like file descriptors). The only somewhat recent case I recall was the monitoring daemon leaking memory as thunks in the rare case where it collected data, but nobody looked at them (which would force their evaluation). The <a href=\"http://git.ganeti.org/?p=ganeti.git;a=commitdiff;h=d89cb844e08b11234475a550e2ff3000d1c03807\" rel=\"noreferrer\">fix was rather simple</a>.</p>\n"}], "owner": {"reputation": 9601, "user_id": 1937197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/cg7w6.jpg?s=128&g=1", "display_name": "bobcat", "link": "https://stackoverflow.com/users/1937197/bobcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2861, "favorite_count": 3, "answer_count": 5, "score": 27, "last_activity_date": 1433506632, "creation_date": 1432679308, "last_edit_date": 1433506632, "question_id": 30470013, "link": "https://stackoverflow.com/questions/30470013/is-haskell-appropriate-for-long-running-applications", "title": "Is Haskell appropriate for long-running applications?", "body": "<p>I think that Haskell is a beautiful language, and judging by the benchmarks, its implementations can generate fast code. </p>\n\n<p>However, I am wondering if it is appropriate for long-running applications, or would chasing all the potential laziness-induced leaks, that one might ignore in a short-lived application, prove frustrating?</p>\n\n<p><a href=\"http://www.reddit.com/r/programming/comments/hek6f/anatomy_of_a_thunk_leak_how_to_debug_haskells/c1uxmxp\" rel=\"noreferrer\">This Reddit comment</a> echos my concerns:</p>\n\n<blockquote>\n  <p>As soon as you have more than one function calling itself recursively,\n  the heap profile ceases to give you any help pinpointing where the\n  leak is occurring.</p>\n</blockquote>\n\n<p><em>(That whole discussion seems insightful and frank)</em></p>\n\n<p>I am personally interested in high-performance computing, but I guess servers and HPC have this requirement in common.</p>\n\n<p>If Haskell is appropriate for such applications, are there any examples proving this point, that is applications that</p>\n\n<ol>\n<li>need to run for days or weeks, therefore requiring the elimination of all relevant leaks (The time the program spends sleeping or waiting for some underlying C library to return obviously doesn't count)</li>\n<li>are non-trivial (If the application is simple, the developer could just guess the source of the leak and attempt various fixes. However, I don't believe this approach scales well. The helpfulness of the heap profile in identifying the source of the leak(s) with multiple [mutually] recursive functions seems to be of particular concern, as per the Reddit discussion above)</li>\n</ol>\n\n<p>If Haskell is not appropriate for such applications, then why?</p>\n\n<p><strong>Update:</strong> The Yesod web server framework for Haskell, that was put forth as an example, <a href=\"https://groups.google.com/forum/#!topic/yesodweb/5pEUM2fxBLg\" rel=\"noreferrer\">may have issues with memory</a>. I wonder if anyone tested its memory usage after serving requests continuously for days.</p>\n"}, {"tags": ["haskell", "vim"], "comments": [{"owner": {"reputation": 5271, "user_id": 1658042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879e79284efb4639584574a5fc46c9e4?s=128&d=identicon&r=PG", "display_name": "lcd047", "link": "https://stackoverflow.com/users/1658042/lcd047"}, "edited": false, "score": 0, "creation_date": 1432705648, "post_id": 30469180, "comment_id": 49027898, "body": "This is likely to be a problem with the way you run <code>ghc-mod</code>, not with syntastic.  But SO is not the place to debug it anyway, so please open an issue at the <a href=\"https://github.com/scrooloose/syntastic/issues\" rel=\"nofollow noreferrer\">issue tracker</a>."}], "owner": {"reputation": 375, "user_id": 4232796, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42912716b8f59e0f6cfd0cbbe6a74bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle McKean", "link": "https://stackoverflow.com/users/4232796/kyle-mckean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1432675433, "creation_date": 1432675433, "question_id": 30469180, "link": "https://stackoverflow.com/questions/30469180/unclear-syntastic-errors-with-ghc-mod", "title": "Unclear syntastic errors with ghc-mod", "body": "<p>This problem only appears to happen when I am using cabal sandboxes. Everytime i type check I get this error <code>syntastic: error: checker haskell/ghc_mod returned abnormal status 1</code> This error is very unhelpful is there anyway to make syntastic errors more verbose?</p>\n"}, {"tags": ["haskell", "haskell-warp"], "comments": [{"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 1, "creation_date": 1432683134, "post_id": 30468347, "comment_id": 49021698, "body": "Try setting the timeout in the &#39;Settings&#39; (see <a href=\"http://hackage.haskell.org/package/warp-3.0.13.1/docs/Network-Wai-Handler-Warp.html#v:setTimeout\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/warp-3.0.13.1/docs/&hellip;</a>). Though it says the default is 30s in the documentation so it&#39;s probably not the same thing."}, {"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "reply_to_user": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 0, "creation_date": 1432744346, "post_id": 30468347, "comment_id": 49054757, "body": "Thanks for the tip. Looks like it&#39;s what I am looking for... Not sure how to set these options in scotty though."}], "owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1432672366, "creation_date": 1432672366, "question_id": 30468347, "link": "https://stackoverflow.com/questions/30468347/is-there-a-timeout-on-warp-server-response", "title": "Is there a timeout on warp server response?", "body": "<p>I have a web application using warp and while trying to query some large-ish using curl I noticed the connection get shutdown exactly after 1 minute transfer. I increased curl's own timeout but this did not changed anything so I assume this is set on the server side. </p>\n\n<p>Is this actually the case there is a 60s timeout on sending response in warp, and if yes, how can I control it?</p>\n"}, {"tags": ["haskell", "authentication", "haskell-snap-framework"], "answers": [{"tags": [], "owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "is_accepted": true, "score": 1, "last_activity_date": 1432667249, "creation_date": 1432667249, "answer_id": 30466867, "question_id": 30466275, "link": "https://stackoverflow.com/questions/30466275/http-basic-auth-in-snap/30466867#30466867", "title": "HTTP Basic Auth in Snap?", "body": "<p>I'm guessing either it hasn't been done or people who did it felt it was simple enough that it wasn't worth posting to hackage.  The latter makes sense because typically uploading something to hackage carries with it some expectation that you'll support it.  But if you think it's needed feel free to put it on hackage yourself.</p>\n"}], "owner": {"reputation": 4510, "user_id": 390636, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e1fd7d16d50936f8c191e90122eba028?s=128&d=identicon&r=PG", "display_name": "Kris Nuttycombe", "link": "https://stackoverflow.com/users/390636/kris-nuttycombe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 30466867, "answer_count": 1, "score": 2, "last_activity_date": 1432667249, "creation_date": 1432665248, "last_edit_date": 1432666933, "question_id": 30466275, "link": "https://stackoverflow.com/questions/30466275/http-basic-auth-in-snap", "title": "HTTP Basic Auth in Snap?", "body": "<p>I'm certain that I must be missing something obvious, but I can't find any built-in way to use HTTP Basic auth within a Snap application. The Auth snaplet (<a href=\"https://hackage.haskell.org/package/snap-0.14.0.4\" rel=\"nofollow\">https://hackage.haskell.org/package/snap-0.14.0.4</a>) doesn't appear to provide any mechanism for using HTTP Basic, so at this point I've basically written my own:</p>\n\n<pre><code>type AuthHeader = (Text, ByteString)\n\nauthHeaderParser :: Parser AuthHeader\nauthHeaderParser = do\n  let isBase64Char w = (w &gt;= 47 &amp;&amp; w &lt;= 57 ) ||\n                       (w &gt;= 64 &amp;&amp; w &lt;= 90 ) ||\n                       (w &gt;= 97 &amp;&amp; w &lt;= 122) ||\n                       (w == 43 || w == 61 )\n  b64     &lt;- string \"Basic \" *&gt; takeWhile1 isBase64Char \n  decoded &lt;- either fail pure $ B64.decode b64 \n  case split 58 decoded of\n    (uname : pwd : []) -&gt; pure $ (decodeUtf8 uname, pwd)\n    _ -&gt; fail \"Could not unpack auth header into username and password components\"\n</code></pre>\n\n<p>I then use this like so; throwChallenge and throwDenied are a couple of helpers that I <em>think</em> are the correct way to approach the necessary short-circuiting in the Snap monad:</p>\n\n<pre><code>import qualified Snap.Snaplet.Auth as AU\n\nrequireLogin :: Handler App App AU.AuthUser \nrequireLogin = do\n  req &lt;- getRequest\n  rawHeader    &lt;- maybe throwChallenge pure $ getHeader \"Authorization\" req \n  (uname, pwd) &lt;- either (throwDenied . AU.AuthError) pure $ parseOnly authHeaderParser rawHeader \n  authResult   &lt;- with auth $ AU.loginByUsername uname (AU.ClearText pwd) False\n  either throwDenied pure authResult\n\nthrowChallenge :: MonadSnap m =&gt; m a \nthrowChallenge = do\n    modifyResponse $ (setResponseStatus 401 \"Unauthorized\") . \n                     (setHeader \"WWW-Authenticate\" \"Basic realm=myrealm\")\n    getResponse &gt;&gt;= finishWith\n\nthrowDenied :: MonadSnap m =&gt; AU.AuthFailure -&gt; m a \nthrowDenied failure = do\n    modifyResponse $ setResponseStatus 403 \"Access Denied\"\n    writeText $ \"Access Denied: \" &lt;&gt; tshow failure\n    getResponse &gt;&gt;= finishWith\n</code></pre>\n\n<p>It works, but it seems ridiculous to have to write this myself for a web framework in 2015. So where the heck is it?</p>\n\n<p>Oh, also, I'm aware that there's WAI middleware for providing HTTP Basic auth in <a href=\"https://hackage.haskell.org/package/wai-extra\" rel=\"nofollow\">https://hackage.haskell.org/package/wai-extra</a>, but I've not had much luck figuring out whether there's a way to integrate this in Snap; the only wai integration packages I've found are deprecated.</p>\n"}, {"tags": ["haskell", "monads", "functor", "ghci"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432661326, "post_id": 30464891, "comment_id": 49010705, "body": "Did you try checking <code>:type a</code>? That would tell you something, maybe."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1432671531, "post_id": 30464891, "comment_id": 49016715, "body": "@AJFarmar Actually, not that much, since GHCi does not default <code>m</code> to <code>IO</code>, yet."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1432675410, "post_id": 30464891, "comment_id": 49018901, "body": "One bit of meta-explanation is in order. While you may think of GHCi as a &quot;Haskell interpreter&quot;, it&#39;s actually a rather different sort of beast. It&#39;s a tool for developing Haskell programs interactively. Whereas Haskell worries a lot about keeping things nice and consistent, GHCi cares mostly about convenience and utility."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 19, "last_activity_date": 1432716307, "last_edit_date": 1432716307, "creation_date": 1432660706, "answer_id": 30464979, "question_id": 30464891, "link": "https://stackoverflow.com/questions/30464891/in-ghci-why-cant-i-show-pure-1-in-repl/30464979#30464979", "title": "In GHCi, why can&#39;t I show `pure 1` in REPL?", "body": "<p>GHCi is defaulting the <code>Applicative f =&gt; f</code> to <code>IO</code>. When you do</p>\n\n<pre><code>\u03bb&gt; a\n1\n</code></pre>\n\n<p>you actually run an <code>IO Integer</code> action such as</p>\n\n<pre><code>\u03bb&gt; let a = return 1\n\u03bb&gt; a\n1\n</code></pre>\n\n<p>GHCi by default prints the result of <code>IO</code> actions. Hence the <code>1</code> in the result line. (Quite confusingly, this <code>1</code> is not the value of <code>a</code>, nor the output of running <code>a</code> as an <code>IO</code> action -- just the returned value of the latter.)</p>\n\n<p>GHCi uses a sophisticated heuristics to handle user input. First, it tries to <code>show</code> it, possibly defaulting some type classes like numeric ones. This fails in your case. When that fails, it tries to see if the input is an <code>IO</code> action. In such case, the action is run and, if the result can be <code>show</code>ed, it is printed. </p>\n\n<p>Note that this GHCi magic only happens at the top level.\nWhen you try to <code>show a</code>, GHCi tries its magic on the whole <code>show a</code>, not on <code>a</code>, so the same effect does not happen.</p>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1432716307, "creation_date": 1432660376, "question_id": 30464891, "link": "https://stackoverflow.com/questions/30464891/in-ghci-why-cant-i-show-pure-1-in-repl", "title": "In GHCi, why can&#39;t I show `pure 1` in REPL?", "body": "<p>I tried to assign a lifted value to <code>a</code>.</p>\n\n<pre><code>\u03bb&gt; :m Control.Applicative\n\u03bb&gt; let a = pure 1\n</code></pre>\n\n<p>When I evaluated <code>a</code> in REPL, it prints <code>1</code>. </p>\n\n<pre><code>\u03bb&gt; a\n1\n</code></pre>\n\n<p>Therefore, I thought there may be an implementation of <code>show</code> for <code>a</code>, and tried this:</p>\n\n<pre><code>\u03bb&gt; show a\n</code></pre>\n\n<p>But the GHCi throws an error:</p>\n\n<pre><code>&lt;interactive&gt;:70:1-4:\n    No instance for (Show (f0 a0)) arising from a use of \u2018show\u2019\n    The type variables \u2018f0\u2019, \u2018a0\u2019 are ambiguous\n    Note: there are several potential instances:\n      instance (Integral a, Show a) =&gt; Show (GHC.Real.Ratio a)\n        -- Defined in \u2018GHC.Real\u2019\n      instance (Show a, Show b) =&gt; Show (a, b) -- Defined in \u2018GHC.Show\u2019\n      instance (Show a, Show b, Show c) =&gt; Show (a, b, c)\n        -- Defined in \u2018GHC.Show\u2019\n      ...plus 32 others\n    In the expression: show a\n    In an equation for \u2018it\u2019: it = show a\n</code></pre>\n\n<p>Does anyone have any ideas about this?</p>\n"}, {"tags": ["python", "haskell", "functional-programming", "ocaml", "sml"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 2, "creation_date": 1432658101, "post_id": 30464163, "comment_id": 49008766, "body": "In Python you can create a <code>set</code> of visited nodes, making the lookup <code>O(1)</code> rather than <code>O(n)</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1432658354, "post_id": 30464163, "comment_id": 49008908, "body": "I bet, <i>monads</i> can handle it.."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 9, "creation_date": 1432658400, "post_id": 30464163, "comment_id": 49008941, "body": "How is using an appropriate data structure <i>not</i> the aim of the game?"}, {"owner": {"reputation": 4126, "user_id": 1319312, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9424462776476a417ddfba4bc3cd77c7?s=128&d=identicon&r=PG", "display_name": "N. McA.", "link": "https://stackoverflow.com/users/1319312/n-mca"}, "edited": false, "score": 0, "creation_date": 1432659028, "post_id": 30464163, "comment_id": 49009363, "body": "I&#39;m writing in ML and will have to implement any data structures I use in the ~7 mins I have to answer questions of this style. I&#39;m practising for exams, not coding an actual project. I&#39;m well aware of the many better data structures, but coding those is a different part of my exam!"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1432660341, "post_id": 30464163, "comment_id": 49010132, "body": "list is not the king in ml, it is though, in lisp."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1432665987, "post_id": 30464163, "comment_id": 49013461, "body": "See the <code>fgl</code> paper, <a href=\"http://web.engr.oregonstate.edu/~erwig/papers/InductiveGraphs_JFP01.pdf\" rel=\"nofollow noreferrer\">Inductive Graphs and Functional Graph Algorithms</a>, section 4.2, &quot;Breadth-First Search&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 57265, "user_id": 821679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f564c4721ee3125fa835f6c3a5283c?s=128&d=identicon&r=PG", "display_name": "Jeffrey Scofield", "link": "https://stackoverflow.com/users/821679/jeffrey-scofield"}, "is_accepted": false, "score": 12, "last_activity_date": 1432659396, "creation_date": 1432659396, "answer_id": 30464615, "question_id": 30464163, "link": "https://stackoverflow.com/questions/30464163/functional-breadth-first-search/30464615#30464615", "title": "Functional Breadth First Search", "body": "<p>You have to keep track of the nodes you visit. Lists are not king in the ML family, they're just one of the oligarchs. You should just use a set (tree based) to track the visited nodes. This will add a log factor compared to mutating the node state, but is so much cleaner it's not funny. If you know more about your nodes you can possibly eliminate the log factor by using a set not based on a tree (a bit vector say).</p>\n"}, {"tags": [], "owner": {"reputation": 28350, "user_id": 2625442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a48a497d3aae41354bc1189d57db2c3?s=128&d=identicon&r=PG", "display_name": "ivg", "link": "https://stackoverflow.com/users/2625442/ivg"}, "is_accepted": false, "score": 3, "last_activity_date": 1432662978, "creation_date": 1432662978, "answer_id": 30465604, "question_id": 30464163, "link": "https://stackoverflow.com/questions/30464163/functional-breadth-first-search/30465604#30465604", "title": "Functional Breadth First Search", "body": "<p>It is pretty OK to have a mutable state hidden inside the function. If it is not visible, then it doesn't exist. I usually use hash sets for this. But in general, you should stick to this if your profiling pinpointed that. Otherwise, just use set data structure. OCaml has an excellent Set based on eagerly balanced AVL trees. </p>\n"}, {"tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": false, "score": 5, "last_activity_date": 1432670518, "last_edit_date": 1432670518, "creation_date": 1432668736, "answer_id": 30467302, "question_id": 30464163, "link": "https://stackoverflow.com/questions/30464163/functional-breadth-first-search/30467302#30467302", "title": "Functional Breadth First Search", "body": "<p>See <a href=\"http://hackage.haskell.org/package/fgl-5.5.1.0/docs/Data-Graph-Inductive-Query-BFS.html\" rel=\"noreferrer\">example implementation of BFS</a>,\nwith explanation in <a href=\"http://web.engr.oregonstate.edu/~erwig/papers/abstracts.html#JFP01\" rel=\"noreferrer\">Martin Erwig: Inductive Graphs and Functional Graph Algorithms</a>. Also, <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Graph.html#v:dfs\" rel=\"noreferrer\">DFS implementation</a>, based on <a href=\"http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.49.2591\" rel=\"noreferrer\">David King , John Launchbury: Structuring Depth-First Search Algorithms in Haskell</a></p>\n\n<p>(Hint for the S.O. police: yes, this looks like a link-only answer, but that is how science works - you have to actually read the papers, re-typing their abstracts isn't very useful.)</p>\n"}, {"comments": [{"owner": {"reputation": 4126, "user_id": 1319312, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9424462776476a417ddfba4bc3cd77c7?s=128&d=identicon&r=PG", "display_name": "N. McA.", "link": "https://stackoverflow.com/users/1319312/n-mca"}, "edited": false, "score": 1, "creation_date": 1432717914, "post_id": 30469287, "comment_id": 49035043, "body": "This is beautiful. Thank you."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1570283126, "post_id": 30469287, "comment_id": 102868402, "body": "I do not see how you can use pattern synonyms for this. To decompose a graph, you have to provide a node identifier, but I think pattern matching does not accept parameters; or, rather, all the parameters have to be present inside the single argument being matched. You would need something like a <i>&quot;pointed graph&quot;</i>... Am I missing something?"}, {"owner": {"reputation": 20539, "user_id": 378594, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/12ecbdbb0d89bc2d6a1a002f2072de10?s=128&d=identicon&r=PG", "display_name": "Uri", "link": "https://stackoverflow.com/users/378594/uri"}, "edited": false, "score": 0, "creation_date": 1579111046, "post_id": 30469287, "comment_id": 105660110, "body": "Can you explain if and how this is O(n)?"}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 51, "last_activity_date": 1569647430, "last_edit_date": 1592644375, "creation_date": 1432675785, "answer_id": 30469287, "question_id": 30464163, "link": "https://stackoverflow.com/questions/30464163/functional-breadth-first-search/30469287#30469287", "title": "Functional Breadth First Search", "body": "<p>One option is to use <strong>inductive graphs</strong>, which are a functional way of representing and working with arbitrary graph structures. They are provided by Haskell's <strong><a href=\"https://hackage.haskell.org/package/fgl\" rel=\"noreferrer\">fgl</a></strong> library and described in <a href=\"https://web.engr.oregonstate.edu/%7Eerwig/papers/InductiveGraphs_JFP01.pdf\" rel=\"noreferrer\">&quot;Inductive Graphs and Funtional Graph Algorithms&quot;</a> by Martin Erwig.</p>\n<p>For a gentler introduction (with illustrations!), see my blog post <a href=\"http://jelv.is/blog/Generating-Mazes-with-Inductive-Graphs/\" rel=\"noreferrer\">Generating Mazes with Inductive Graphs</a>.</p>\n<p>The trick with inductive graphs is that they let  you <strong>pattern match on graphs</strong>. The common functional idiom for working with lists is to decompose them into a head element and the rest of the list, then recurse on that:</p>\n<pre><code>map f []     = []\nmap f (x:xs) = f x : map f xs\n</code></pre>\n<p>Inductive graphs let you do the same thing, but for graphs. You can decompose an inductive graph into a node, its edges and the rest of the graph.</p>\n<p><a href=\"https://i.stack.imgur.com/jt5EE.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/jt5EE.png\" alt=\"pattern matching on a node\" /></a><br />\n<sub>(source: <a href=\"http://jelv.is/blog/Generating-Mazes-with-Inductive-Graphs/match1.png\" rel=\"noreferrer\">jelv.is</a>)</sub></p>\n<p><em>Here we match on the node <code>1</code> and all of its edges (highlighted in blue), separate from the rest of the graph.</em></p>\n<p>This lets us write a <code>map</code> for graphs (in Haskellish pseudocode that can be realized with pattern synonyms):</p>\n<pre><code>gmap f Empty                     = Empty\ngmap f ((in, node, out) :&amp; rest) = f (in, node, out) :&amp; gmap f rest\n</code></pre>\n<p>The main shortcoming of this approach as opposed to lists is that graphs do not have a single natural way to decompose: the same graph can be built up in multiple ways. The map code above would visit all the vertices, but in an arbitrary (implementation-dependent) order.</p>\n<p>To overcome this, we add another construct: a <code>match</code> function that takes a specific node. If that node is in our graph, we get a successful match just like above; if it isn't, the whole match fails.</p>\n<p>This construct is enough to write a DFS or a BFS\u2014with elegant code that looks almost identical for both!</p>\n<p>Instead of manually marking nodes as visited, we just recurse on the rest of the graph <em>except</em> the node we're seeing now: at each step, we're working with a smaller and smaller portion of the original graph. If we try to access a node we've already seen with <code>match</code>, it won't be in the remaining graph and that branch will fail. This lets our graph-processing code look just like our normal recursive functions over lists.</p>\n<p>Here's a DFS for this sort of graph. It keeps the stack of nodes <em>to visit</em> as a list (the frontier), and takes the initial frontier to start. The output is a list of nodes traversed in order. (The exact code here can't be written with the library directly without some custom pattern synonyms.)</p>\n<pre class=\"lang-hs prettyprint-override\"><code>dfs _frontier Empty = []\ndfs [] _graph = []\ndfs (n:ns) (match n -&gt; Just (ctx, rest)) = -- not visited n\n  dfs (neighbors' ctx ++ ns) rest\ndfs (n:ns) graph =                         -- visited n\n  dfs ns graph\n</code></pre>\n<p>A pretty simple recursive function. To turn it into a breadth-first search, all we have to do is replace our stack frontier with a queue: instead of putting the neighbors on the <em>front</em> of the list, we put them on the <em>back</em>:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>bfs _frontier Empty = []\nbfs [] _graph = []\nbfs (n:ns) (match n -&gt; Just (ctx, rest)) = -- not visited n\n  bfs (ns ++ neighbors' ctx) rest\nbfs (n:ns) graph =                         -- visited n\n  bfs ns graph\n</code></pre>\n<p>Yep, that's all we need! We don't have to do anything special to keep track of the nodes we visited as we recurse over the graph, just like we don't have to keep track of the list cells we've visited: each time we recurse, we're only getting the part of the graph we <em>haven't</em> seen.</p>\n"}], "owner": {"reputation": 4126, "user_id": 1319312, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9424462776476a417ddfba4bc3cd77c7?s=128&d=identicon&r=PG", "display_name": "N. McA.", "link": "https://stackoverflow.com/users/1319312/n-mca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5069, "favorite_count": 12, "accepted_answer_id": 30469287, "answer_count": 4, "score": 25, "last_activity_date": 1569647430, "creation_date": 1432657946, "last_edit_date": 1432658929, "question_id": 30464163, "link": "https://stackoverflow.com/questions/30464163/functional-breadth-first-search", "title": "Functional Breadth First Search", "body": "<p>Functional depth first search is lovely in directed acyclic graphs.</p>\n\n<p>In graphs with cycles however, how do we avoid infinite recursion? In a procedural language I would mark nodes as I hit them, but let's say I can't do that. </p>\n\n<p>A list of visited nodes is possible, but will be slow because using one will result in a linear search of that list before recurring. A better data structure than a list here would obviously help, but that's not the aim of the game, because I'm coding in ML - lists are king, and anything else I will have to write myself.</p>\n\n<p>Is there a clever way around this issue? Or will I have to make do with a visited list or, god forbid, mutable state?</p>\n"}, {"tags": ["haskell", "yesod", "hamlet"], "comments": [{"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1432695528, "post_id": 30463155, "comment_id": 49024919, "body": "Try it and see what happens"}, {"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "reply_to_user": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1432731699, "post_id": 30463155, "comment_id": 49045044, "body": "Huh odd. I was getting a compile time error earlier <code>&quot;Exception when trying to run compile-time code: \u2026&quot;</code> but now I realize that only happens when I have attributes on the tag. <code>&lt;svg&gt;</code> compiles but <code>&lt;svg height = &quot;50&quot; width = &quot;500&quot;&gt;</code> does not."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1432776859, "post_id": 30463155, "comment_id": 49068936, "body": "Weird. Probably worth reporting it as a bug. I can&#39;t think of any reason why svg tags should be handled any differently from any other non-selfclosing html tag."}], "answers": [{"tags": [], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "is_accepted": true, "score": 1, "last_activity_date": 1433217667, "last_edit_date": 1433217667, "creation_date": 1433217362, "answer_id": 30587038, "question_id": 30463155, "link": "https://stackoverflow.com/questions/30463155/svg-tags-in-hamlet-shakespearean-yesod-haskell-templates/30587038#30587038", "title": "SVG tags in hamlet shakespearean (yesod/haskell) templates?", "body": "<p>You can just include it like any other tags. Don't put spaces before and after equals sign.</p>\n\n<p><code>&lt;svg height=\"50\" width=\"500\"&gt;</code></p>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 30587038, "answer_count": 1, "score": 0, "last_activity_date": 1433217667, "creation_date": 1432655065, "question_id": 30463155, "link": "https://stackoverflow.com/questions/30463155/svg-tags-in-hamlet-shakespearean-yesod-haskell-templates", "title": "SVG tags in hamlet shakespearean (yesod/haskell) templates?", "body": "<p>Is there a way to include  tags in hamlet? If not, what are the workarounds/alternatives?</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 7, "creation_date": 1432649664, "post_id": 30458734, "comment_id": 49002628, "body": "Why use <code>zip</code> when you have <code>map</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 33, "last_activity_date": 1432643891, "creation_date": 1432643891, "answer_id": 30458822, "question_id": 30458734, "link": "https://stackoverflow.com/questions/30458734/zipping-same-value-over-a-list-of-tuples-haskell/30458822#30458822", "title": "Zipping same value over a list of tuples Haskell", "body": "<p>If you zip two lists of different lengths, you get the length of the shortest list.</p>\n\n<p>You can fix this by zipping against an <em>infinitely long</em> list:</p>\n\n<pre><code>zip (repeat False) a\n</code></pre>\n\n<p>should do the trick.</p>\n"}, {"comments": [{"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 4, "creation_date": 1432650453, "post_id": 30459344, "comment_id": 49003251, "body": "Or with TupleSections: <code>map (False,) a</code>"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 0, "creation_date": 1432651489, "post_id": 30459344, "comment_id": 49004032, "body": "@thoferon Certainly, but in this case I would honestly say that it would make it less clear.  The difference between <code>map (False,) a</code> and <code>map (False) a</code> is only 1 character, and that character is very important.  I would rather have <code>map (const False &amp;&amp;&amp; id)</code> using <code>Control.Arrow</code> if I were going for pointfree.  It doesn&#39;t require extensions and is very clear code (provided you know what <code>&amp;&amp;&amp;</code> does).  Considering this requires an import and several more characters, I don&#39;t mind a pointful lambda for this simple case."}, {"owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "edited": false, "score": 1, "creation_date": 1432655490, "post_id": 30459344, "comment_id": 49007016, "body": "Using an arrow here and not thoferon&#39;s version is just plain silly. Your last suggestion (in prefix notation) is also good."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "edited": false, "score": 0, "creation_date": 1432655907, "post_id": 30459344, "comment_id": 49007308, "body": "@BenjaminGruenbaum I would disagree. I happen to like arrow syntax quite a bit, and particularly when working with lots of tuples they come in handy. In both cases you have to type extra, but I often find myself already having <code>Control.Arrow</code> imported.  For those trying to keep Haskell98, the arrow approach would be more desirable.  I prefer to keep <code>(False,)</code> as a syntax error (just as <code>[False,]</code> is) and instead reach for solutions that don&#39;t require changing the language.  At the end of the day it&#39;s really just a matter of personal style."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 29, "last_activity_date": 1432651826, "last_edit_date": 1495541841, "creation_date": 1432645281, "answer_id": 30459344, "question_id": 30458734, "link": "https://stackoverflow.com/questions/30458734/zipping-same-value-over-a-list-of-tuples-haskell/30459344#30459344", "title": "Zipping same value over a list of tuples Haskell", "body": "<p>Alternatively, instead of using <code>zip</code> you can use <code>map</code>:</p>\n\n<pre><code>map (\\x -&gt; (False, x)) a\n</code></pre>\n\n<p>This would more appropriately express your intent (in my opinion) since you want to do the same thing to every element of the list.  If you want to do different things to each element, then <code>zip</code> or <code>zipWith</code> may be more appropriate.</p>\n\n<p>If you wanted to avoid the lambda, you can write it pointfree using <code>&amp;&amp;&amp;</code> from <code>Control.Arrow</code>:</p>\n\n<pre><code>map (const False &amp;&amp;&amp; id) a\n</code></pre>\n\n<p>which basically says \"apply the functions <code>const False</code> and <code>id</code> to the input, then construct a tuple of both of their outputs\".  There is the <code>TupleSections</code> extension which would allow you to write this as</p>\n\n<pre><code>map (False,) a\n</code></pre>\n\n<p>(tip provided by <a href=\"https://stackoverflow.com/questions/30458734/zipping-same-value-over-a-list-of-tuples-haskell/30459344#comment49003251_30459344\">@thoferon</a>), but I personally find this less clear, since you have to know that the extension is enabled and notice the <code>,</code> after <code>False</code>.  You could write it as</p>\n\n<pre><code>map ((,) False) a\n</code></pre>\n\n<p>without the extension since <code>(,)</code> acts as a function of type <code>a -&gt; b -&gt; (a, b)</code>, and while a bit more verbose it doesn't require enabling a language extension.</p>\n"}, {"tags": [], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "is_accepted": false, "score": 6, "last_activity_date": 1432654472, "creation_date": 1432654472, "answer_id": 30462948, "question_id": 30458734, "link": "https://stackoverflow.com/questions/30458734/zipping-same-value-over-a-list-of-tuples-haskell/30462948#30462948", "title": "Zipping same value over a list of tuples Haskell", "body": "<p>In addition to others answers it is also possible to write a generic function for any <code>Functor</code>, not just for lists:</p>\n\n<pre><code>strengthL :: Functor f =&gt; a -&gt; f b -&gt; f (a, b)\nstrengthL = fmap . (,)\n\nstrengthR :: Functor f =&gt; a -&gt; f b -&gt; f (b, a)\nstrengthR = fmap . flip (,)\n</code></pre>\n\n<p>Then <code>strengthL</code> can be applied to False and the original list:</p>\n\n<pre><code>Prelude&gt; strengthL False [(1,()),(2,())]\n[(False,(1,())),(False,(2,()))]\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 1270740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f4b6ad64c4ae8ba4c159016841634ec?s=128&d=identicon&r=PG&f=1", "display_name": "dfj328", "link": "https://stackoverflow.com/users/1270740/dfj328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 30458822, "answer_count": 3, "score": 16, "last_activity_date": 1432654472, "creation_date": 1432643650, "question_id": 30458734, "link": "https://stackoverflow.com/questions/30458734/zipping-same-value-over-a-list-of-tuples-haskell", "title": "Zipping same value over a list of tuples Haskell", "body": "<p>I would like to transform the following tuple list</p>\n\n<pre><code>a = [(1,()),(2,())]\n</code></pre>\n\n<p>into a nested tuple list by the same value </p>\n\n<pre><code>b = [(False,(1,())),(False,(2,()))]\n</code></pre>\n\n<p>Using the zip function in this format</p>\n\n<pre><code>zip [False] a\n</code></pre>\n\n<p>only gives me</p>\n\n<pre><code>[(False,(1,()))]\n</code></pre>\n\n<p>Any suggestions or advice would be much appreciated.</p>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4151816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356cb2300b8d872e6feb4aa6eb6e9713?s=128&d=identicon&r=PG&f=1", "display_name": "Asdren", "link": "https://stackoverflow.com/users/4151816/asdren"}, "edited": false, "score": 0, "creation_date": 1432641454, "post_id": 30457469, "comment_id": 48996337, "body": "I tried adding those 2 lines at the end of the program, now it displays the error Couldn&#39;t match expected type <code>IO [([String], String)]&#39; with actual type </code>[a0]&#39; In the expression: [] What&#39;s wrong with gainData [] = [] ?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 89, "user_id": 4151816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356cb2300b8d872e6feb4aa6eb6e9713?s=128&d=identicon&r=PG&f=1", "display_name": "Asdren", "link": "https://stackoverflow.com/users/4151816/asdren"}, "edited": false, "score": 0, "creation_date": 1432641692, "post_id": 30457469, "comment_id": 48996497, "body": "@SeyrenGuile That&#39;s the opposite error. <code>gainData</code> must return a <code>IO [something]</code> not just <code>[something]</code> so use <code>return []</code> instead of <code>[]</code>."}, {"owner": {"reputation": 89, "user_id": 4151816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356cb2300b8d872e6feb4aa6eb6e9713?s=128&d=identicon&r=PG&f=1", "display_name": "Asdren", "link": "https://stackoverflow.com/users/4151816/asdren"}, "edited": false, "score": 0, "creation_date": 1432642462, "post_id": 30457469, "comment_id": 48997061, "body": "Thanks a lot for the help"}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 8, "last_activity_date": 1432641772, "last_edit_date": 1432641772, "creation_date": 1432640340, "answer_id": 30457469, "question_id": 30457304, "link": "https://stackoverflow.com/questions/30457304/recursive-function-with-io/30457469#30457469", "title": "Recursive function with IO", "body": "<p>You cannot do:</p>\n\n<pre><code>return ((temp,xz) : gainData xc)\n</code></pre>\n\n<p>The <code>gainData</code> function returns an <code>IO [something]</code> not just <code>[something]</code>.\nYou have to first extract the value returned:</p>\n\n<pre><code>res &lt;- gainData xc\nreturn $ (temp,xz) : res\n</code></pre>\n\n<p>The <code>varname &lt;- action</code> does the following:</p>\n\n<ul>\n<li>It calls <code>action</code>, which in this case its <code>gainData xc</code>. This action returns an <code>IO something</code></li>\n<li>It \"extracts\" the <code>something</code> from the <code>IO</code> and assign it to <code>varname</code></li>\n</ul>\n\n<p>in fact it works with any <code>Monad</code>, not just <code>IO</code>.</p>\n\n<p>Also, in the first definition you are returning <code>[]</code>, but this is of type <code>[something]</code> while <code>gainData</code> should be of type <code>IO [something]</code> so you have to add a <code>IO</code> layer to it:</p>\n\n<pre><code>gainData [] = return []\n</code></pre>\n\n<p><code>return</code> is \"the opposite\" of the <code>&lt;-</code>. It takes a <code>something</code> and turns it into an <code>IO something</code>, which can be extracted using the <code>&lt;-</code>.</p>\n"}], "owner": {"reputation": 89, "user_id": 4151816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356cb2300b8d872e6feb4aa6eb6e9713?s=128&d=identicon&r=PG&f=1", "display_name": "Asdren", "link": "https://stackoverflow.com/users/4151816/asdren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 30457469, "answer_count": 1, "score": 2, "last_activity_date": 1432641772, "creation_date": 1432639870, "question_id": 30457304, "link": "https://stackoverflow.com/questions/30457304/recursive-function-with-io", "title": "Recursive function with IO", "body": "<p>I'm having problems with the next code, the idea is to make a function which returns a list of words from a file with the directory in a tuple.</p>\n\n<pre><code>gainData:: [FilePath] -&gt; IO [([String],String)]\ngainData[] = []\ngainData(xz:xc) = do\n    temp &lt;- readFileP xz\n    return ((temp,xz) : gainData xc)\n</code></pre>\n\n<p>The function readFileP gets a list with all the words of a file.</p>\n\n<pre><code>readFileP:: FilePath -&gt; IO [String]\n</code></pre>\n\n<p>For example i would want to get </p>\n\n<pre><code>[([\"word\",\"word1\"],\"fileAddress\"),([\"word\",\"word1\"],\"fileAddress2\")]\n</code></pre>\n\n<p>I don't know what's the problem, can somebody tell me please? Thanks.</p>\n"}, {"tags": ["haskell", "io", "handle"], "answers": [{"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 4, "last_activity_date": 1432636526, "creation_date": 1432636526, "answer_id": 30456086, "question_id": 30455081, "link": "https://stackoverflow.com/questions/30455081/cant-write-to-a-handle/30456086#30456086", "title": "Can&#39;t write to a Handle", "body": "<p>When you write to a file, the OS keeps track of the position at which you are in said file. You get an <code>EOF</code> error because you're at the end of the file (it was empty to begin with and everything you have written is <em>before</em> the current position).</p>\n\n<p>To fix that you need to use <code>hSeek</code> to reposition yourself at the beginning of the file like so:</p>\n\n<pre><code>hSeek (hClient c) AbsoluteSeek 0\n</code></pre>\n\n<p>For more details about seeking, cf. this bit of <a href=\"http://book.realworldhaskell.org/read/io.html#io.files.seeking\" rel=\"nofollow\">real world haskell</a>.</p>\n"}], "owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 30456086, "answer_count": 1, "score": 3, "last_activity_date": 1432636526, "creation_date": 1432633701, "question_id": 30455081, "link": "https://stackoverflow.com/questions/30455081/cant-write-to-a-handle", "title": "Can&#39;t write to a Handle", "body": "<p>I'm writing a chat server in Haskell. My executable has the following code:</p>\n\n<pre><code>data Client = Client {idx :: Int, hClient :: Handle} deriving (Show, Eq)\n\ntellClient :: String -&gt; Client -&gt; IO ()\ntellClient = flip $ hPutStrLn . hClient\n\naskClient :: Client -&gt; IO (String)\naskClient = hGetLine . hClient\n</code></pre>\n\n<p>which I expect to be able to use to write and read from a file. I'm writing tests against this code with HSpec. I have the following function to build temporary <code>Client</code> objects (which relies on the \"temporary\") library:</p>\n\n<pre><code>withTempClient :: Int -&gt; (Client -&gt; IO a) -&gt; IO a\nwithTempClient cIdx f = withTempFile \"tests/generated\" \"clientFile.tmp\" axn\n  where axn _ handle = f $ Client cIdx handle\n</code></pre>\n\n<p>I'm using this to test the code above as follows:</p>\n\n<pre><code>main = hspec $  do\n  describe \"client IO\" $ do\n    it \"can ask and tell\" $ withTempClient 1 $ \\c -&gt; do\n      tellClient \"hello\" c\n      hFlush $ hClient c\n      askClient c `shouldReturn` \"hello\"\n</code></pre>\n\n<p>But the test fails with the following error:</p>\n\n<pre><code>   uncaught exception: IOException of type EOF (test/generated\n   /clientFile11587.tmp: hGetLine: end of file)\n</code></pre>\n\n<p>I thought that maybe I was doing something wrong in <code>withTempClient</code>, so I added the following test case:</p>\n\n<pre><code>it \"opens a handle corectly\" $ withTempClient 1 $ \\(Client _ h) -&gt; do\n  hIsOpen h `shouldReturn` True\n  hIsWritable h `shouldReturn` True\n</code></pre>\n\n<p>but that passed, so I'm not sure what the issue could be. What am I missing?</p>\n"}, {"tags": ["haskell", "integration-testing", "cabal"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432621242, "post_id": 30450329, "comment_id": 48982978, "body": "maybe I don&#39;t understand the question fully - you create such a <i>resources</i> folder just as you would any other - just create it with your OS/Filemanager - there is nothing special about Haskell."}, {"owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1550579502, "post_id": 30450329, "comment_id": 96312865, "body": "@Carsten the question is about best practices: in the case of tests it is usually easier to handle paths relative to the test file for example, so using <b>FILE</b> seems attractive. While in the case of the actual app it should read the paths from a config file or from the command line for example."}], "answers": [{"comments": [{"owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "edited": false, "score": 2, "creation_date": 1550579116, "post_id": 30467385, "comment_id": 96312638, "body": "Updated links: <a href=\"https://github.com/haskell/haddock/tree/ghc-8.6/html-test/ref\" rel=\"nofollow noreferrer\">github.com/haskell/haddock/tree/ghc-8.6/html-test/ref</a> , <a href=\"https://github.com/haskell/haddock/blob/ghc-8.6/haddock.cabal\" rel=\"nofollow noreferrer\">github.com/haskell/haddock/blob/ghc-8.6/haddock.cabal</a> and <a href=\"https://github.com/haskell/haddock/blob/ghc-8.6/html-test/Main.hs\" rel=\"nofollow noreferrer\">github.com/haskell/haddock/blob/ghc-8.6/html-test/Main.hs</a>"}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 3, "last_activity_date": 1432668990, "creation_date": 1432668990, "answer_id": 30467385, "question_id": 30450329, "link": "https://stackoverflow.com/questions/30450329/access-test-resources-within-haskell-tests/30467385#30467385", "title": "Access test resources within Haskell tests", "body": "<p>Have a look at an existing project that uses input and output file. </p>\n\n<p>For example, take haddock, the source code is at <a href=\"https://github.com/haskell/haddock\" rel=\"nofollow\">https://github.com/haskell/haddock</a>. They have the test files under a folder (<a href=\"https://github.com/haskell/haddock/tree/master/html-test/ref\" rel=\"nofollow\">https://github.com/haskell/haddock/tree/master/html-test/ref</a>) and they are referenced as extra-source-files in the cabal file (<a href=\"https://github.com/haskell/haddock/blob/master/haddock.cabal\" rel=\"nofollow\">https://github.com/haskell/haddock/blob/master/haddock.cabal</a>). Then the test code (<a href=\"https://github.com/haskell/haddock/blob/master/html-test/run.lhs\" rel=\"nofollow\">https://github.com/haskell/haddock/blob/master/html-test/run.lhs</a>) uses some CPP macro (<code>__FILE__</code>) to get the current directory, and can then resolve the files relative to that folder.</p>\n"}], "owner": {"reputation": 677, "user_id": 2659595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62be5bdb8707d16bd9247792d857d296?s=128&d=identicon&r=PG", "display_name": "tom", "link": "https://stackoverflow.com/users/2659595/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 30467385, "answer_count": 1, "score": 3, "last_activity_date": 1432668990, "creation_date": 1432619041, "question_id": 30450329, "link": "https://stackoverflow.com/questions/30450329/access-test-resources-within-haskell-tests", "title": "Access test resources within Haskell tests", "body": "<p>This is probably a basic question but I've been Googling for a while on it... I have a Cabal-ized Haskell project and I'm in the process of writing integration tests for it. I want to be able to include test resources for my project in the same repo and access them in tests. For example, here are a couple things I want to accomplish:</p>\n\n<p>1) Check a dummy database instance into my repo, including a shell script that spins up a database process. I want to write an Hspec integration test that spins up the database process, makes some calls to it, and then shuts it down. So I need to be able to find the shell script so I can use <code>System.Process.createProcess</code> on it.</p>\n\n<p>2) Check in paired \"input\" and \"output\" files. My test should process each of the input files and compare them to a corresponding output file to make sure they match. (I've read about \"golden\" but it doesn't seem to solve the problem of finding/reading the input files in the first place?)</p>\n\n<p>In short, how can I go about creating a \"resources\" folder in the root folder of my Haskell project and find the path to it inside tests?</p>\n"}, {"tags": ["haskell", "yesod", "shakespeare-text"], "answers": [{"comments": [{"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1432643876, "post_id": 30449949, "comment_id": 48998193, "body": "I&#39;m still new to this, but isn&#39;t the syntax I used shorthand for implicitly referencing a file without setting up a resource explicitly? It seems to work for hamlet files. Regardless, once set up the resource handler, julius has the <code>addScript</code> that can be invoked on the resource to load a named external julius resource. What&#39;s the equivalent to <code>addScript</code> for a plain html resource?"}], "tags": [], "owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "is_accepted": true, "score": 6, "last_activity_date": 1433487401, "last_edit_date": 1433487401, "creation_date": 1432617122, "answer_id": 30449949, "question_id": 30449386, "link": "https://stackoverflow.com/questions/30449386/in-yesod-haskell-how-do-i-load-a-plain-html-formatted-file-not-a-hamlet-as/30449949#30449949", "title": "In yesod (haskell), how do I load a plain html-formatted file (not a hamlet) as a widget?", "body": "<p>For this you use <code>sendFile</code> in your handler function (<a href=\"https://hackage.haskell.org/package/yesod-0.4.1/docs/Yesod-Handler.html#v:sendFile\" rel=\"nofollow\">see its definition</a>)</p>\n\n<p>The first argument is the Mime Type while the second is the file path.</p>\n\n<p>For example, you could code something like:</p>\n\n<pre><code>getMyFileR :: Handler ()\ngetMyFileR = sendFile \"text/html\" \"myfile.html\"\n</code></pre>\n\n<p>Here\u2019s Another example. Say I have the following model:</p>\n\n<pre><code>Resource\n    filename    FilePath\n    mimetype    ContentType\n\n    deriving    Typeable\n</code></pre>\n\n<p>The handler might look like:</p>\n\n<pre><code>resourceDirectory :: FilePath\nresourceDirectory = \"resource\"\n\ngetResourceGetR :: ResourceId -&gt; Handler ()\ngetResourceGetR resourceId = do\n    resource &lt;- runDB $ get404 resourceId\n\n    sendFile (resourceMimetype resource)\n             (resourceDirectory &lt;/&gt; unpack (resourceFilename resource))\n</code></pre>\n\n<p><strong>Edit 2015-06-05</strong></p>\n\n<p><code>sendFile</code> operates at a low level while <code>addScript</code> or <code>$(widgetFile \u2026)</code> operates at a higher level.</p>\n\n<p><code>$(widgetFile \u2026)</code> uses TemplateHaskell to convert your Hamlet/Cassius/Lucius/Julius templates into actual Haskell source code before your project is compiled. The same applies similarly to <code>[hamlet|\u2026|]</code>.</p>\n\n<p><code>addScript</code>works with a <code>Route</code> while <code>sendFile</code> works with a <code>FilePath</code>. This means <code>addScript</code> will be able to detect missing files at compile time. <code>sendFile</code> will detect missing files at runtime.</p>\n\n<p>There are some tools to convert Html to Hamlet:</p>\n\n<ul>\n<li><a href=\"https://github.com/yesodweb/yesod/wiki/Hamlet\" rel=\"nofollow\">a one line script</a> (which works well for simple Html),</li>\n<li><a href=\"https://github.com/meteficha/html2hamlet\" rel=\"nofollow\">html2hamlet</a>.</li>\n</ul>\n\n<p>An equivalent of <code>addScript</code> for Html files does not make sense: <code>addScript</code> will generate a <code>script</code> tag to tell the browser to download an external resource. This does not apply to an Html file.</p>\n"}, {"tags": [], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1583475871, "creation_date": 1583475871, "answer_id": 60558622, "question_id": 30449386, "link": "https://stackoverflow.com/questions/30449386/in-yesod-haskell-how-do-i-load-a-plain-html-formatted-file-not-a-hamlet-as/60558622#60558622", "title": "In yesod (haskell), how do I load a plain html-formatted file (not a hamlet) as a widget?", "body": "<pre><code>import Import\nimport Text.Blaze.Html       (preEscapedToHtml)\nimport Text.Shakespeare.Text (stextFile)\n\nmyWidget :: Widget\nmyWidget = toWidget . preEscapedToHtml $ $(stextFile \"templates/some-file.html\")\n</code></pre>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 30449949, "answer_count": 2, "score": 5, "last_activity_date": 1583475871, "creation_date": 1432613964, "question_id": 30449386, "link": "https://stackoverflow.com/questions/30449386/in-yesod-haskell-how-do-i-load-a-plain-html-formatted-file-not-a-hamlet-as", "title": "In yesod (haskell), how do I load a plain html-formatted file (not a hamlet) as a widget?", "body": "<p>How do I load a plain html-formatted file (not a hamlet-formatted file) as a widget? In other words I'm looking for the html equivalent of:</p>\n\n<pre><code>toWidget $(whamletFile \"test.hamlet\")\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1432609561, "post_id": 30448290, "comment_id": 48979243, "body": "@I.K. Ok, added an example for that."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 10, "last_activity_date": 1432610366, "last_edit_date": 1432610366, "creation_date": 1432605746, "answer_id": 30448290, "question_id": 30448073, "link": "https://stackoverflow.com/questions/30448073/kind-classification-of-types/30448290#30448290", "title": "Kind Classification of Types", "body": "<p>Kinds are curried just like types.</p>\n\n<p>The type of <code>(,)</code> (the value constructor) is <code>a -&gt; b -&gt; (a, b)</code>.  The type of <code>(,) ()</code> is <code>b -&gt; ((), b)</code>.  The type of <code>(,) () ()</code> is <code>((), ())</code>.</p>\n\n<p>Kinds work exactly the same way.  The kind of <code>(,)</code> (the type constructor) is <code>* -&gt; * -&gt; *</code>. The kind of <code>(,) ()</code> is <code>* -&gt; *</code>. That's exactly what Pierce is talking about.  (And of course, the kind of <code>(,) () ()</code> is <code>*</code>).</p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>The fourth category is a type that looks like this:</p>\n\n<pre><code>newtype Fourth f = Fourth (f ())\n</code></pre>\n\n<p>The <code>Fourth</code> type constructor has kind <code>(* -&gt; *) -&gt; *</code>. It can take as an argument any type with kind <code>(* -&gt; *)</code>, like <code>Maybe</code> or <code>[]</code>.  So types like <code>Fourth Maybe</code> or <code>Fourth []</code> have kind <code>*</code>.</p>\n"}], "owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 30448290, "answer_count": 1, "score": 1, "last_activity_date": 1432610366, "creation_date": 1432603715, "last_edit_date": 1432607877, "question_id": 30448073, "link": "https://stackoverflow.com/questions/30448073/kind-classification-of-types", "title": "Kind Classification of Types", "body": "<p>In Benjamin Pierce's book on Types and Programming Languages he classifies the different kinds of types as follows:</p>\n\n<ol>\n<li><code>*</code> the kind of proper types (like <code>Bool</code> and <code>Bool -&gt; Bool</code>)</li>\n<li><code>* -&gt; *</code> the kind of type operators (i.e., functions from proper types\nto proper types)</li>\n<li><code>* -&gt; * -&gt; *</code> the kind of functions from proper types to type operators\n(i.e., two-argument operators)</li>\n<li><code>(* -&gt; *) -&gt; *</code> the kind of functions from type operators to proper types</li>\n</ol>\n\n<p>If we consider the tuple <code>(1,2)</code>, if I query the type and kind of this in the Haskell GHCI I get:</p>\n\n<pre><code>Prelude&gt; :t (1,2)\n(1,2) :: (Num t1, Num t) =&gt; (t, t1)\n\nPrelude&gt; :k (,)\n(,) :: * -&gt; * -&gt; *\n</code></pre>\n\n<p>I don't see how <code>* -&gt; * -&gt; *</code> falls into category 3 in his definition above. To my knowledge, <code>(,)</code> takes two proper types to produce another proper type, not as Pierce states which is a function from a proper type to a type operator.</p>\n\n<p>I am probably not interpreting Pierce's categorisation properly. Please can someone expand category 3 using my 2-tuple example.</p>\n"}, {"tags": ["haskell", "ghc", "compiler-optimization", "ghci"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1432606995, "post_id": 30448007, "comment_id": 48978676, "body": "It seems to be a primitive type <a href=\"https://github.com/ghc/ghc/blob/90dd11bf1918485f0f19bb2fb764f1675c0f0dd5/compiler/prelude/primops.txt.pp#L1868\" rel=\"nofollow noreferrer\">defined in GHC</a>. It is the same type used for <code>IORef</code>s, with the <code>s</code> type argument set to <code>RealWorld#</code>."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1432628819, "post_id": 30448007, "comment_id": 48987390, "body": "It <i>is</i> defined somewhere: It&#39;s in <code>GHC.Prim</code>. The definition is just a blank stub though; as others have said, the real implementation is hard-wired into the compiler. This is a low-level GHC-specific implementation detail. A different Haskell compiler would probably implement it differently."}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1432625282, "post_id": 30451215, "comment_id": 48985264, "body": "In fact, any <code>____#</code> name is a primitive type, like <code>Int#</code> and so on. you need <code>{-# LANGUAGE MagicHash #-}</code> to enable it."}, {"owner": {"reputation": 11412, "user_id": 617159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc43cf2d76ce0981a21c0e5a817f96f5?s=128&d=identicon&r=PG", "display_name": "Lambda Fairy", "link": "https://stackoverflow.com/users/617159/lambda-fairy"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432973993, "post_id": 30451215, "comment_id": 49160631, "body": "@AJFarmar Careful with that wording. &quot;All <code>___#</code> names are primitive&quot; is <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/syntax-extns.html#magic-hash\" rel=\"nofollow noreferrer\">just a convention</a>; it isn&#39;t actually enforced by the compiler. You can define your own functions and types ending in <code>#</code>, and GHC won&#39;t treat them any differently."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432978739, "post_id": 30451215, "comment_id": 49161812, "body": "That&#39;s true, but conventions in Haskell are pretty well adhered to! That&#39;s worth mentioning nonetheless."}], "tags": [], "owner": {"reputation": 11412, "user_id": 617159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc43cf2d76ce0981a21c0e5a817f96f5?s=128&d=identicon&r=PG", "display_name": "Lambda Fairy", "link": "https://stackoverflow.com/users/617159/lambda-fairy"}, "is_accepted": false, "score": 7, "last_activity_date": 1432622421, "creation_date": 1432622421, "answer_id": 30451215, "question_id": 30448007, "link": "https://stackoverflow.com/questions/30448007/what-does-mutvar-mean/30451215#30451215", "title": "What does &#39;MutVar#&#39; mean?", "body": "<p><code>MutVar#</code> is a primitive type provided by the compiler itself. It represents a mutable reference, and forms the core of <code>IORef</code> and <code>STRef</code>.</p>\n\n<p>In general, anything that ends in <code>#</code> is an implementation detail of GHC. Unless you're doing low-level hackery you don't need to worry about them. Most of these operations have wrappers (like <code>ST</code>) which are easier to use.</p>\n\n<p>You can read more about these in the <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/primitives.html\">GHC manual</a> and the <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html#g:13\"><code>ghc-prim</code></a> package.</p>\n"}], "owner": {"reputation": 16312, "user_id": 91607, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/487b6baa0284e8a657dc80b78f777c73?s=128&d=identicon&r=PG", "display_name": "Attilah", "link": "https://stackoverflow.com/users/91607/attilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1432622421, "creation_date": 1432603032, "last_edit_date": 1432605897, "question_id": 30448007, "link": "https://stackoverflow.com/questions/30448007/what-does-mutvar-mean", "title": "What does &#39;MutVar#&#39; mean?", "body": "<p>I've been trying to read and understand the code that implements Haskell's ST monad,\nand I found <a href=\"https://github.com/ghc/ghc/blob/df3b1d43cc862fe03f0724a9c0ac9e7cecdf4605/libraries/base/GHC/STRef.hs\" rel=\"nofollow\">this code</a>:</p>\n\n<pre><code>{-# LANGUAGE Unsafe #-}\n{-# LANGUAGE NoImplicitPrelude, MagicHash, UnboxedTuples #-}\n{-# OPTIONS_HADDOCK hide #-}\n\n-----------------------------------------------------------------------------\n-- |\n-- Module      :  GHC.STRef\n-- Copyright   :  (c) The University of Glasgow, 1994-2002\n-- License     :  see libraries/base/LICENSE\n--\n-- Maintainer  :  cvs-ghc@haskell.org\n-- Stability   :  internal\n-- Portability :  non-portable (GHC Extensions)\n--\n-- References in the 'ST' monad.\n--\n-----------------------------------------------------------------------------\n\nmodule GHC.STRef (\n        STRef(..),\n        newSTRef, readSTRef, writeSTRef\n    ) where\n\nimport GHC.ST\nimport GHC.Base\n\ndata STRef s a = STRef (MutVar# s a)\n-- ^ a value of type @STRef s a@ is a mutable variable in state thread @s@,\n-- containing a value of type @a@\n\n-- |Build a new 'STRef' in the current state thread\nnewSTRef :: a -&gt; ST s (STRef s a)\nnewSTRef init = ST $ \\s1# -&gt;\n    case newMutVar# init s1#            of { (# s2#, var# #) -&gt;\n    (# s2#, STRef var# #) }\n\n-- |Read the value of an 'STRef'\nreadSTRef :: STRef s a -&gt; ST s a\nreadSTRef (STRef var#) = ST $ \\s1# -&gt; readMutVar# var# s1#\n\n-- |Write a new value into an 'STRef'\nwriteSTRef :: STRef s a -&gt; a -&gt; ST s ()\nwriteSTRef (STRef var#) val = ST $ \\s1# -&gt;\n    case writeMutVar# var# val s1#      of { s2# -&gt;\n    (# s2#, () #) }\n\n-- Just pointer equality on mutable references:\ninstance Eq (STRef s a) where\n    STRef v1# == STRef v2# = isTrue# (sameMutVar# v1# v2#)\n</code></pre>\n\n<p>I see the following line of code in the above code file :</p>\n\n<pre><code>data STRef s a = STRef (MutVar# s a)\n</code></pre>\n\n<p>A quick search on <code>MutVar#</code> yielded the following results :</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/primitive-0.4.1/docs/src/Data-Primitive-MutVar.html#MutVar\" rel=\"nofollow\">https://hackage.haskell.org/package/primitive-0.4.1/docs/src/Data-Primitive-MutVar.html#MutVar</a></li>\n<li><a href=\"https://github.com/ghc/ghc/blob/228ddb95ee137e7cef02dcfe2521233892dd61e0/utils/genprimopcode/Main.hs#L816\" rel=\"nofollow\">https://github.com/ghc/ghc/blob/228ddb95ee137e7cef02dcfe2521233892dd61e0/utils/genprimopcode/Main.hs#L816</a></li>\n</ul>\n\n<p>My question is :\n   What is <code>MutVar#</code>? Why isn't it defined anywhere ? What does it mean ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432752278, "post_id": 30447787, "comment_id": 49059362, "body": "How on earth did you make a dry Haskell problem into such an entertaining read?"}], "answers": [{"comments": [{"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432614229, "post_id": 30448641, "comment_id": 48980358, "body": "I get the same error irregardless of the type signature. I&#39;m not sure how it helps (and I&#39;m not sure it&#39;s correct anyway)."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432621334, "post_id": 30448641, "comment_id": 48983032, "body": "<a href=\"http://ideone.com/mtuYnK\" rel=\"nofollow noreferrer\">ideone.com/mtuYnK</a>  That uses GHC 7.6. I get the same error with the same code in GHC 7.10.1"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432622450, "post_id": 30448641, "comment_id": 48983603, "body": "Now one of us is just getting confused. The error message in your link is exactly the one I included in my answer -- it points to the deeper problem of overlapping instances. If you don&#39;t give a type signature to the definition of <code>h</code>, you get the error I&#39;ve added as an edit to your original question. These are two completely different type errors."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432622848, "post_id": 30448641, "comment_id": 48983792, "body": "Can you link to full code that compiles with the type signature. I&#39;ve added your type signature and I can&#39;t get it to compile (and I&#39;ve tried my own variations also)"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432623475, "post_id": 30448641, "comment_id": 48984188, "body": "Please read my answer again. It does <i>not</i> compile because of the overlapping instances. Those are a genuine (and orthogonal) problem."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432623792, "post_id": 30448641, "comment_id": 48984379, "body": "I have the overlapping instance extension selected. And without &quot;h&quot; defined, it compiles fine and runs, despite the overlapping instances, so why are they causing the problem?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432623895, "post_id": 30448641, "comment_id": 48984454, "body": "Maybe you should add a new question about the overlapping/incoherent instances. Note how your program has <code>OverlappingInstances</code> turned on, but not <code>IncoherentInstances</code>. Have you read the details of the error message? Also, without <code>h</code> defined, all of its occurances are completely monomorphic so the issue does not apply at all."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432624043, "post_id": 30448641, "comment_id": 48984548, "body": "I still don&#39;t understand how <code>f x</code> can be valid, but <code>g = f</code>, <code>g x</code> is not. That seems bizarre. That&#39;s the crux of my question."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432624151, "post_id": 30448641, "comment_id": 48984608, "body": "Have you picked up my point about the other occurrences being monomorphic? If you define <code>g = E</code>, you have to give <code>g</code> a sufficiently polymorphic type; whereas if you happen to use <code>E</code> in several contexts, all of them monomorphic, then I&#39;m not even sure it&#39;s guaranteed there&#39;s a polymorphic type that encompasses all of the monomorphic types you can possibly use <code>E</code> at."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432624623, "post_id": 30448641, "comment_id": 48984880, "body": "I have, kind of, but obviously not completely. But why can&#39;t <code>h</code> just delay selecting the instance until it&#39;s called. Like if I write <code>myAdd :: (Num a) =&gt; a -&gt; a -&gt; a</code> myAdd itself doesn&#39;t need to know the instance until it&#39;s actually called with floats or ints or whatever."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 1, "creation_date": 1432625129, "post_id": 30448641, "comment_id": 48985182, "body": "I think I&#39;ve figured out the underlying problem -- we need to find a way to tell <code>f fn x</code> to pick the dictionary from <code>D</code>, not from out of thin air based on <code>a</code> and <code>b</code>. Let me see if I can do that. Maybe something involving <a href=\"https://hackage.haskell.org/package/constraints-0.4.1.3/docs/Data-Constraint.html#g:2\" rel=\"nofollow noreferrer\">instance dictionary reification</a>..."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1432625973, "post_id": 30448641, "comment_id": 48985684, "body": "I&#39;ll drop you a bounty for a nice answer, as I&#39;m really interested in what I can learn from this."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1432626250, "last_edit_date": 1432626250, "creation_date": 1432608506, "answer_id": 30448641, "question_id": 30447787, "link": "https://stackoverflow.com/questions/30447787/the-function-that-shall-have-no-name/30448641#30448641", "title": "The function that shall have no name", "body": "<p>If you give a type signature to <code>h</code>, then that takes care of your immediate problem:</p>\n\n<pre><code>h :: b -&gt; D a -&gt; String\nh = \\fn (D x) -&gt; f fn x\n</code></pre>\n\n<p>However, this just highlights a more fundamental problem: that in general, there's nothing prohibiting the reflexive and the <code>Parent</code> case from overlapping with each other:</p>\n\n<pre><code>Overlapping instances for C (Parent a1) b arising from a use of `f'\nMatching instances:\n  instance [overlap ok] C (Parent a) b =&gt; C a b\n    -- Defined at SO-30447787.hs:21:10\n  instance [overlap ok] C A3 F3\n    -- Defined at SO-30447787.hs:46:10\n  instance [overlap ok] C A1 F1\n    -- Defined at SO-30447787.hs:43:10\n(The choice depends on the instantiation of `b, a1'\n To pick the first instance above, use IncoherentInstances\n when compiling the other instance declarations)\nIn the expression: f fn x\nIn the expression: \\ fn (D x) -&gt; f fn x\nIn an equation for `h': h = \\ fn (D x) -&gt; f fn x\n</code></pre>\n\n<p>What you really want is to use the instance stored in the <code>D</code> constructor. I'm not sure yet how to express that in Haskell (or if it's expressible at all).</p>\n\n<p>One thing that I hoped would work is to use <a href=\"https://hackage.haskell.org/package/constraints/docs/Data-Constraint.html\" rel=\"nofollow\"><code>Data.Constraint.Dict</code></a> to reify the instance dictionary stored in <code>D</code>:</p>\n\n<pre><code>import Data.Constraint\n\ndata D t = forall a. D (Dict (Constraints t a)) a\n\nh :: b -&gt; D a -&gt; String\nh fn (D d@Dict x) = f fn x\n</code></pre>\n\n<p>but of course there's still nothing connecting the usage of <code>f</code> on the right-hand side to <code>d</code> on the left-hand side, so it still suffers from the same problem.</p>\n\n<p>UPDATE: </p>\n\n<p>I've realized that there's nothing forcing <code>C a t</code> to follow from <code>Constraints t a</code> in general (nothing prevents me from adding <code>type instance Constraints A5 a = ()</code>), so just because we have <code>Dict :: Dict (Constraints t a)</code> in scope, it's not going to be picked up for the <code>C a b</code> constraint imposed by calling <code>f</code>. You need to completely rethink what you're <em>actually</em> (as in, in your real use case, not the minimal reproduction case here) trying to do.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1432626250, "creation_date": 1432601144, "last_edit_date": 1432607848, "question_id": 30447787, "link": "https://stackoverflow.com/questions/30447787/the-function-that-shall-have-no-name", "title": "The function that shall have no name", "body": "<p>The following code at <a href=\"http://ideone.com/q7fWij\" rel=\"nofollow\">http://ideone.com/q7fWij</a> compiles successfully, but when I attempt to even name the function:</p>\n\n<pre><code>(\\fn (D x) -&gt; f fn x)\n</code></pre>\n\n<p>by say:</p>\n\n<pre><code>h = (\\fn (D x) -&gt; f fn x)\n</code></pre>\n\n<p>I get a compile error:</p>\n\n<pre><code>SO-30447787.hs:51:19:\n    Couldn't match expected type `t1' with actual type `String'\n      `t1' is untouchable\n        inside the constraints (Constraints t2 a)\n        bound by a pattern with constructor\n                   D :: forall t a. (Constraints t a) =&gt; a -&gt; D t,\n                 in a lambda abstraction\n        at SO-30447787.hs:51:11-13\n      `t1' is a rigid type variable bound by\n           the inferred type of h :: t -&gt; D t2 -&gt; t1\n           at SO-30447787.hs:51:1\n    Relevant bindings include\n      h :: t -&gt; D t2 -&gt; t1\n        (bound at SO-30447787.hs:51:1)\n    In the expression: f fn x\n    In the expression: (\\ fn (D x) -&gt; f fn x)\n</code></pre>\n\n<p>Is there a way to name this poor function, or is it forever destined for a life of anonymity?</p>\n\n<p>(By the way, what I'm playing around with is a class that searches up a tree for a function to call). </p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE OverlappingInstances #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE NoMonomorphismRestriction #-}\n\nimport GHC.Exts (Constraint)\n\ntype family Parent a\n\nclass C a b where\n  f :: b -&gt; a -&gt; String\n\ninstance (C (Parent a) b) =&gt; C a b where\n  f _ _ = f (undefined :: b) (undefined :: Parent a) \n\ndata A1 = A1\ndata A2 = A2\ndata A3 = A3\ndata A4 = A4\n\ntype instance Parent A2 = A1\ntype instance Parent A3 = A2\ntype instance Parent A4 = A3\n\ndata F1 = F1\ndata F3 = F3\n\ninstance C A1 F1 where\n  f _ _ = \"F1\"\n\ninstance C A3 F3 where\n  f _ _ = \"F3\"\n\ntype family Constraints t a :: Constraint\n\ndata D t = forall a. (Constraints t a) =&gt; D a\n\ntype instance Constraints A1 a = (C a F1)\ntype instance Constraints A2 a = (C a F1, C a F3)\ntype instance Constraints A3 a = (C a F1, C a F3)\ntype instance Constraints A4 a = (C a F1, C a F3)\n\nmain = \n  do\n--    let h = (\\fn (D x) -&gt; f fn x)\n    putStrLn (f F1 A1)\n    putStrLn (f F1 A2)\n    putStrLn (f F1 A3)\n    putStrLn (f F1 A4)\n    putStrLn (f F3 A3)\n    putStrLn (f F3 A4)\n    putStrLn $ (\\fn (D x) -&gt; f fn x) F1 ((D A1) :: D A1)\n    putStrLn $ (\\fn (D x) -&gt; f fn x) F1 ((D A2) :: D A1)\n    putStrLn $ (\\fn (D x) -&gt; f fn x) F3 ((D A3) :: D A2)\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell"], "answers": [{"comments": [{"owner": {"reputation": 4530, "user_id": 68268, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4a5ab824f23e84577218c5881d36072c?s=128&d=identicon&r=PG", "display_name": "Khanzor", "link": "https://stackoverflow.com/users/68268/khanzor"}, "edited": false, "score": 0, "creation_date": 1432691677, "post_id": 30449062, "comment_id": 49023980, "body": "Right, I just leave as a top level declaration. That actually makes sense - I was trying to load it from GHCi!"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 4530, "user_id": 68268, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4a5ab824f23e84577218c5881d36072c?s=128&d=identicon&r=PG", "display_name": "Khanzor", "link": "https://stackoverflow.com/users/68268/khanzor"}, "edited": false, "score": 0, "creation_date": 1432694519, "post_id": 30449062, "comment_id": 49024683, "body": "You can run it from GHCi to see (TH&#39;s internal representation of) the generated code by loading <code>SO_30447244_Def</code> and then running <code>runQ $ quoteDec sample &quot;&quot;</code>."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 3, "last_activity_date": 1432611641, "creation_date": 1432611641, "answer_id": 30449062, "question_id": 30447244, "link": "https://stackoverflow.com/questions/30447244/how-does-one-run-a-data-declaration-from-a-quasiquoter/30449062#30449062", "title": "How does one &quot;run&quot; a data declaration from a quasiquoter", "body": "<p>Import your module into another one that has the <code>QuasiQuotes</code> <code>LANGUAGE</code> pragma turned on , and then use the syntax <code>[sample||]</code> to call it. Note that it needs to be in a separate module; you can't start using <code>[sample||]</code> in the same module as it is defined in. See e.g. <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/template-haskell.html\" rel=\"nofollow\">section 7.17.1 in the GHC 7.10.1 manual</a>: </p>\n\n<blockquote>\n  <p>Inside a splice you can only call functions defined in imported modules, not functions defined elsewhere in the same module.</p>\n</blockquote>\n\n<p>So putting it all together, here's an example of using <code>sample</code>:</p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\nimport SO_30447244_Def -- this is the module containing the code \n                       -- from the original question\n\n[sample||]\n\nfoo :: GenType\nfoo = GetType \"foo\"\n</code></pre>\n"}], "owner": {"reputation": 4530, "user_id": 68268, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4a5ab824f23e84577218c5881d36072c?s=128&d=identicon&r=PG", "display_name": "Khanzor", "link": "https://stackoverflow.com/users/68268/khanzor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 30449062, "answer_count": 1, "score": 1, "last_activity_date": 1432611641, "creation_date": 1432596278, "last_edit_date": 1432611227, "question_id": 30447244, "link": "https://stackoverflow.com/questions/30447244/how-does-one-run-a-data-declaration-from-a-quasiquoter", "title": "How does one &quot;run&quot; a data declaration from a quasiquoter", "body": "<p>I'm trying to write a quasiquoter for some type declarations.</p>\n\n<p>I've written something along the lines of </p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Language.Haskell.TH as TH\nimport Language.Haskell.TH.Quote\n\nsample :: QuasiQuoter\nsample =\n   let tName    = TH.mkName \"GenType\"\n       conName  = TH.mkName \"GetType\"\n       nameName = TH.mkName \"name\"\n       creator _ = return [TH.DataD [] tName [] [TH.RecC conName [(nameName, TH.NotStrict,TH.ConT ''String)]] [''Show, ''Eq]]\n   in QuasiQuoter { quoteDec = creator\n                  , quotePat = undefined\n                  , quoteType = undefined\n                  , quoteExp = undefined }\n</code></pre>\n\n<p>Now I have the issue of trying to make that type \"GenType\" available. I've taken a look at the yesod source code (where they do routes), but it's a little opaque for me. How does one make a type available from a quasiquoter?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1432594305, "post_id": 30446690, "comment_id": 48975866, "body": "It can&#39;t do it, according to the authors <a href=\"https://hackage.haskell.org/package/mmap-0.5.9/docs/src/System-IO-MMap.html\" rel=\"nofollow noreferrer\">comments</a>: &quot;TODO: support externally given HANDLEs and FDs&quot;. You&#39;ll have to add the functionality yourself."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1432594415, "post_id": 30446690, "comment_id": 48975891, "body": "Good catch @user2407038, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1438561836, "post_id": 31777795, "comment_id": 51486086, "body": "I&#39;m sorry for not doing that that day, I was just learning about shared memory and assumed I wasn&#39;t qualified to implement it. Thank you!"}], "tags": [], "owner": {"reputation": 2063, "user_id": 3188445, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/456b429580f304e24b652ca52363b603?s=128&d=identicon&r=PG&f=1", "display_name": "user3188445", "link": "https://stackoverflow.com/users/3188445/user3188445"}, "is_accepted": true, "score": 2, "last_activity_date": 1438559964, "creation_date": 1438559964, "answer_id": 31777795, "question_id": 30446690, "link": "https://stackoverflow.com/questions/30446690/how-do-i-read-a-shared-memory-using-haskells-mmap-library/31777795#31777795", "title": "How do I read a shared memory using Haskell&#39;s mmap library?", "body": "<p>It appears that the mmap package you are using does not support this functionality.  However, the good news is that what you want is not that hard to implement.  One approach is just to create a raw FFI binding for <code>mmap</code>, call mmap yourself, and then use <code>packCStringLen</code> to convert the pointer to a <code>ByteString</code>.</p>\n\n<pre><code>foreign import ccall \"mmap\" mmap\n  :: Ptr () -&gt; CSize -&gt; CInt -&gt; CInt-&gt; CInt-&gt; Int64 -&gt; IO (Ptr ())\n</code></pre>\n\n<p>As another option, if you don't want your own FFI binding, the <code>bindings-posix</code> package will provide this for you as <code>c'mmap</code>.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 31777795, "answer_count": 1, "score": 6, "last_activity_date": 1438559964, "creation_date": 1432592046, "question_id": 30446690, "link": "https://stackoverflow.com/questions/30446690/how-do-i-read-a-shared-memory-using-haskells-mmap-library", "title": "How do I read a shared memory using Haskell&#39;s mmap library?", "body": "<p>On C, I can create a shared memory object with:</p>\n\n<pre><code>int fd = shm_open(\"/object\", O_RDWR | O_CREAT, 0777);\n</code></pre>\n\n<p>I can also read from that memory using <code>mmap</code>:</p>\n\n<pre><code>int* addr = mmap(0, sizeof(*addr), PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);\n</code></pre>\n\n<p>But how do I access that data from Haskell? </p>\n\n<pre><code>import System.Posix.SharedMem\nimport System.IO.MMap\n\nmain = do\n    fd &lt;- shmOpen \"/bolts\" (ShmOpenFlags False False False False) 0777\n\n    -- Obviously doesn't make sense, mmapFileByteString \n    -- requires a file path that I don't have!\n    addr &lt;- mmapFileByteString \"/bolts\" Nothing\n\n    print addr\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "types", "scheme", "closures"], "comments": [{"owner": {"reputation": 2073, "user_id": 3496273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e0a40ff2f35bae1a27e3603c20102f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3496273/jack"}, "edited": false, "score": 0, "creation_date": 1432590852, "post_id": 30446473, "comment_id": 48974949, "body": "What would the type of the <code>eat</code> function be?"}, {"owner": {"reputation": 5013, "user_id": 969617, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2412de50d273085f5dcf3f2101c3996e?s=128&d=identicon&r=PG", "display_name": "beoliver", "link": "https://stackoverflow.com/users/969617/beoliver"}, "reply_to_user": {"reputation": 2073, "user_id": 3496273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e0a40ff2f35bae1a27e3603c20102f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3496273/jack"}, "edited": false, "score": 0, "creation_date": 1432591079, "post_id": 30446473, "comment_id": 48975015, "body": "maybe something like <code>eat :: [a] -&gt; a -&gt; Eat a</code>"}, {"owner": {"reputation": 5013, "user_id": 969617, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2412de50d273085f5dcf3f2101c3996e?s=128&d=identicon&r=PG", "display_name": "beoliver", "link": "https://stackoverflow.com/users/969617/beoliver"}, "reply_to_user": {"reputation": 2073, "user_id": 3496273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e0a40ff2f35bae1a27e3603c20102f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3496273/jack"}, "edited": false, "score": 0, "creation_date": 1432591442, "post_id": 30446473, "comment_id": 48975121, "body": "or <code>eat :: [a] -&gt; a -&gt; Either [a] (a -&gt; Either [a] (a -&gt; Either ...</code>"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1432591485, "post_id": 30446473, "comment_id": 48975139, "body": "It&#39;s &quot;impossible&quot; because you&#39;re playing too fast and loose with the types in this function. Passing the result <code>&#39;vomit</code> yields a list, but passing anything else yields a procedure. Haskell is statically typed, so you can&#39;t get away with the same sort of thing. You could make it return an <code>Either</code> type, but that&#39;s the best you&#39;ll get."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432593050, "post_id": 30446473, "comment_id": 48975547, "body": "There are some tricks to simulate varargs functions in Haskell, like those used by Haskell&#39;s <code>printf</code>, but they involve some deep type class hackery."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1432594313, "post_id": 30446473, "comment_id": 48975869, "body": "@chi this is not a varargs function in Scheme. What it does, is building a new closure (a function) and returning it, when given a non-&quot;vomit&quot; argument."}], "answers": [{"comments": [{"owner": {"reputation": 5013, "user_id": 969617, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2412de50d273085f5dcf3f2101c3996e?s=128&d=identicon&r=PG", "display_name": "beoliver", "link": "https://stackoverflow.com/users/969617/beoliver"}, "edited": false, "score": 0, "creation_date": 1432594133, "post_id": 30446896, "comment_id": 48975820, "body": "completely forgot about the need for defining a recursive type"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 5013, "user_id": 969617, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2412de50d273085f5dcf3f2101c3996e?s=128&d=identicon&r=PG", "display_name": "beoliver", "link": "https://stackoverflow.com/users/969617/beoliver"}, "edited": false, "score": 1, "creation_date": 1432595089, "post_id": 30446896, "comment_id": 48976043, "body": "Haskell handles recursive types for us, without us having to know how it is achieving that. But we need to declare a specific type for that, for with general type variables it is forbidden: <code>[a] ~ a -&gt; [a]</code> is invalid because <code>a</code> stands for <i>any</i> type; but when we declare <code>T</code>, it, specifically, can be recursive."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 10, "last_activity_date": 1586638624, "last_edit_date": 1586638624, "creation_date": 1432593450, "answer_id": 30446896, "question_id": 30446473, "link": "https://stackoverflow.com/questions/30446473/translate-scheme-closure-defining-function-into-haskell/30446896#30446896", "title": "Translate Scheme closure-defining function into Haskell", "body": "<p>Since you have a recursive type in there, you need to declare it explicitly:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>data T a = L [a] | F (a -&gt; T a)\n\n(+&gt;) (F f) = f\nunL  (L x) = x\n\neat xs x = if x == \"vomit\" then L $ reverse xs else F $ eat (x:xs)\n\neaten = unL $ eat [] \"x\" +&gt; \"y\" +&gt; \"z\" +&gt; \"vomit\"\n</code></pre>\n\n<blockquote>\n  <p><i>> eaten <br />\n      [\"x\",\"y\",\"z\"]</i></p>\n</blockquote>\n\n<p>Defining</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>eaten1 = eat [] \"x\" +&gt; \"y\" \n\neaten2 = eaten1 +&gt; \"z\" +&gt; \"vomit\"\n</code></pre>\n\n<p>also works:</p>\n\n<blockquote>\n  <p><i>> unL $ eaten1 +> \"vomit\"<br />\n    [\"x\",\"y\"] </i><br />\n  <i>> unL $ eaten2 <br />\n     [\"x\",\"y\",\"z\"]</i></p>\n</blockquote>\n"}], "owner": {"reputation": 5013, "user_id": 969617, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2412de50d273085f5dcf3f2101c3996e?s=128&d=identicon&r=PG", "display_name": "beoliver", "link": "https://stackoverflow.com/users/969617/beoliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 1, "accepted_answer_id": 30446896, "answer_count": 1, "score": 1, "last_activity_date": 1586638624, "creation_date": 1432590623, "last_edit_date": 1432672542, "question_id": 30446473, "link": "https://stackoverflow.com/questions/30446473/translate-scheme-closure-defining-function-into-haskell", "title": "Translate Scheme closure-defining function into Haskell", "body": "<p>The following procedure, written in Scheme,</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(define (eat xs)\n  (lambda (x)\n    (if (eq? x 'vomit)\n      (reverse xs)\n      (eat (cons x xs)))))\n</code></pre>\n\n<p>can be called in the following way:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>&gt; eat \n#{procedure 9165 eat}\n&gt; (eat '())\n#{procedure 9166 (unnamed in eat)}\n&gt; ((eat '()) 1)\n#{procedure 9166 (unnamed in eat)}\n&gt; (((((eat '()) 1) 2) 3) 4)\n#{procedure 9166 (unnamed in eat)}\n&gt; ((((((eat '()) 1) 2) 3) 4) 'vomit)\n(1 2 3 4) \n</code></pre>\n\n<p>As there is no mutation eg. <code>set!</code>, and the state is passed using recursion I thought this would be trivial to write in Haskell:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>eat xs x = if x == \"vomit\" then reverse xs else eat (x:xs)\n\n-- Couldn't match expected type \u2018[[Char]]\u2019\n--        with actual type \u2018[Char] -&gt; [[Char]]\u2019\n-- Probable cause: \u2018eat\u2019 is applied to too few arguments\n-- In the expression: eat (x : xs)\n-- In the expression:\n--   if x == \"vomit\" then reverse xs else eat (x : xs)\n</code></pre>\n\n<p>Am I missing something glaringly obvious, or is it just not possible?</p>\n"}, {"tags": ["parsing", "haskell", "attoparsec"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1434288667, "post_id": 30446223, "comment_id": 49704943, "body": "Related: <a href=\"http://stackoverflow.com/q/13202371/2541573\">stackoverflow.com/q/13202371/2541573</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1432906557, "post_id": 30519717, "comment_id": 49135539, "body": "That doesn&#39;t leave the <code>{{{</code> unconsumed, though."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1433121916, "post_id": 30519717, "comment_id": 49200090, "body": "You&#39;re right. And I can&#39;t see anything in the attoparsec docs that would help with that directly. But what you can do is write the next part of the parser knowing that it will never be reached unless <code>{{{</code> is found."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1435831551, "post_id": 30519717, "comment_id": 50368936, "body": "@JeremyList Note that <code>try</code> is just <code>id</code> in attoparsec. <a href=\"https://hackage.haskell.org/package/attoparsec-0.10.2.0/docs/Data-Attoparsec-Text.html#g:7\" rel=\"nofollow noreferrer\"><i>This combinator is provided for compatibility with Parsec. Attoparsec parsers always backtrack on failure.</i></a>"}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1436144114, "post_id": 30519717, "comment_id": 50471429, "body": "Good to know. When I rolled my own parser combinators I didn&#39;t include <code>try</code> for the same reason."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 0, "last_activity_date": 1432863015, "creation_date": 1432863015, "answer_id": 30519717, "question_id": 30446223, "link": "https://stackoverflow.com/questions/30446223/attoparsec-skipping-up-to-but-not-including-a-multi-char-delimiter/30519717#30519717", "title": "Attoparsec: skipping up to (but not including) a multi-char delimiter", "body": "<p>You can do it the slightly harder way like this:</p>\n\n<pre><code>foo = many $ do\n  Just c &lt;- fmap (const Nothing) (try $ string \"{{{\") &lt;|&gt; fmap Just anyChar\n  return c\n</code></pre>\n\n<p>Or you could use this helper function <a href=\"http://hackage.haskell.org/package/attoparsec-0.13.0.0/docs/Data-Attoparsec-ByteString.html#v:manyTill\" rel=\"nofollow\"><code>manyTill</code></a> like this:</p>\n\n<pre><code>foo = manyTill anyChar (try $ string \"{{{\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2890, "user_id": 3821009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c7fb1f9e34d1b461b185b16dd447cad?s=128&d=identicon&r=PG&f=1", "display_name": "levant pied", "link": "https://stackoverflow.com/users/3821009/levant-pied"}, "edited": false, "score": 0, "creation_date": 1599258583, "post_id": 31183941, "comment_id": 112729353, "body": "What is the rationale behind using <code>(nonOpBraceSpan &lt;|&gt; opBraceSpan)</code> instead of <code>anyChar</code>?"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 2890, "user_id": 3821009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c7fb1f9e34d1b461b185b16dd447cad?s=128&d=identicon&r=PG&f=1", "display_name": "levant pied", "link": "https://stackoverflow.com/users/3821009/levant-pied"}, "edited": false, "score": 1, "creation_date": 1599806748, "post_id": 31183941, "comment_id": 112893457, "body": "@levantpied I wrote this answer a while ago... and I can&#39;t remember :) I&#39;d have to retest it to see whether using <code>anyChar</code> changes the behaviour."}], "tags": [], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "is_accepted": true, "score": 3, "last_activity_date": 1439907980, "last_edit_date": 1439907980, "creation_date": 1435837995, "answer_id": 31183941, "question_id": 30446223, "link": "https://stackoverflow.com/questions/30446223/attoparsec-skipping-up-to-but-not-including-a-multi-char-delimiter/31183941#31183941", "title": "Attoparsec: skipping up to (but not including) a multi-char delimiter", "body": "<p>Use <code>attoparsec</code>'s <code>lookAhead</code> (which applies a parser without consuming any input) and <code>manyTill</code> to write a parser that consumes everything up to (but excluding) a <code>{{{</code> delimiter. You're then free to apply that parser and throw its result away.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Applicative ( (&lt;|&gt;) )\nimport Data.Text ( Text )\nimport qualified Data.Text as T\nimport Data.Attoparsec.Text\nimport Data.Attoparsec.Combinator ( lookAhead, manyTill )\n\nmyParser :: Parser Text\nmyParser = T.concat &lt;$&gt; manyTill (nonOpBraceSpan &lt;|&gt; opBraceSpan)\n                                 (lookAhead $ string \"{{{\")\n                    &lt;?&gt; \"{{{\"\n  where\n    opBraceSpan    = takeWhile1 (== '{')\n    nonOpBraceSpan = takeWhile1 (/= '{')\n</code></pre>\n\n<p>In GHCi:</p>\n\n<pre><code>\u03bb&gt; :set -XOverloadedStrings \n\u03bb&gt; parseTest myParser \"{foo{{bar{{{baz\"\nDone \"{{{baz\" \"{foo{{bar\"\n</code></pre>\n"}], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 1, "accepted_answer_id": 31183941, "answer_count": 2, "score": 5, "last_activity_date": 1439907980, "creation_date": 1432589136, "question_id": 30446223, "link": "https://stackoverflow.com/questions/30446223/attoparsec-skipping-up-to-but-not-including-a-multi-char-delimiter", "title": "Attoparsec: skipping up to (but not including) a multi-char delimiter", "body": "<p>I have a string that can contain pretty much any character. Inside the string there is the delimiter <code>{{{</code>. </p>\n\n<p>For example: <code>afskjdfakjsdfkjas{{{fasdf</code>.</p>\n\n<p>Using attoparsec, what is the idiomatic way of writing a <code>Parser ()</code> that skips all characters before <code>{{{</code>, but without consuming the <code>{{{</code>?</p>\n"}, {"tags": ["c", "haskell", "shared"], "comments": [{"owner": {"reputation": 8263, "user_id": 32878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e44c79ea155b0bca0a4027d9a38b11d0?s=128&d=identicon&r=PG", "display_name": "Jay Kominek", "link": "https://stackoverflow.com/users/32878/jay-kominek"}, "edited": false, "score": 0, "creation_date": 1432586451, "post_id": 30445722, "comment_id": 48973459, "body": "posix shared memory? <a href=\"https://downloads.haskell.org/~ghc/7.8.3/docs/html/libraries/unix-2.7.0.1/System-Posix-SharedMem.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/7.8.3/docs/html/libraries/&hellip;</a>"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1432588070, "post_id": 30445722, "comment_id": 48974044, "body": "Perhaps <a href=\"http://hackage.haskell.org/package/memory-0.3\" rel=\"nofollow noreferrer\">memory</a> and/or <a href=\"http://hackage.haskell.org/package/primitive-0.6\" rel=\"nofollow noreferrer\">primitive</a> could help."}, {"owner": {"reputation": 34465, "user_id": 12274, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/98e72a0366a5d8e0a4a5df9ecd1933db?s=128&d=identicon&r=PG&f=1", "display_name": "JB.", "link": "https://stackoverflow.com/users/12274/jb"}, "edited": false, "score": 0, "creation_date": 1442051947, "post_id": 30445722, "comment_id": 52932702, "body": "I&#39;d be curious as to <i>why</i> you can&#39;t use FFI for this. Raw access to memory isn&#39;t common in the Haskell ecosystem, and for good reason."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1442157813, "post_id": 30445722, "comment_id": 52958374, "body": "Now I don&#39;t remember exactly the reason, but I guess it was a bug on the FFI library of Haskell or something on those lines which basically meant I&#39;d have to update the library myself (which I had no idea how to). I&#39;m not sure..."}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1432586348, "creation_date": 1432586348, "question_id": 30445722, "link": "https://stackoverflow.com/questions/30445722/what-is-a-simple-and-cross-platform-strategy-to-share-memory-between-a-c-process", "title": "What is a simple and cross platform strategy to share memory between a C process and a Haskell program without FFI?", "body": "<p>I have a C program that renders images to a flat array of ints. I want to render that information to the screen using Haskell. What is a simple and cross platform way to read the memory on the C program from a Haskell program?</p>\n\n<pre><code>// C program allocs memory\nint main(){\n    int* data = malloc(10*sizeof(int));\n    int i;\n    for (i=0; i&lt;10; ++i)\n        data[i] = i;\n    ...\n}\n\n-- Haskell program reads that memory\nmain = do\n    cData &lt;- readDataFromCProgram\n    print cData\n</code></pre>\n\n<p>Since <code>data</code> is huge (in order of gigabytes), that has to be fast - that is, no writing to files and no streaming all the data again for each request. I.e., sharing the memory is needed. I can't use FFI for this.</p>\n"}, {"tags": ["haskell", "types", "type-signature"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432584143, "post_id": 30445081, "comment_id": 48972541, "body": "it&#39;s because <code>length ns</code> is an <code>Int</code> but <code>div</code> works for <code>Integral a =&gt; a -&gt; a -&gt; a</code> - try <code>average ns = sum ns </code>div` (fromIntegral $ length ns)` - it should work"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432584282, "post_id": 30445081, "comment_id": 48972600, "body": "but on small thing: <code>div</code> needs <code>Integral</code> anyway !"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432585642, "post_id": 30445081, "comment_id": 48973129, "body": "<code>length :: [q] -&gt; Int</code> so <code>average :: [Int] -&gt; Int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 549, "user_id": 4396823, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7493ed20de304e4d88666ff6977ae33?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/4396823/steve"}, "edited": false, "score": 0, "creation_date": 1432584563, "post_id": 30445337, "comment_id": 48972713, "body": "hmm I didn&#39;t even think about using :type to figure out what div is. Thanks for your help"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 549, "user_id": 4396823, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7493ed20de304e4d88666ff6977ae33?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/4396823/steve"}, "edited": false, "score": 0, "creation_date": 1432584634, "post_id": 30445337, "comment_id": 48972742, "body": "np - the numbers and their relation/conversion always get me too - the real fun starts with floating, sin, etc. ;)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1432584381, "creation_date": 1432584381, "answer_id": 30445337, "question_id": 30445081, "link": "https://stackoverflow.com/questions/30445081/why-doesnt-this-haskell-type-signature-work/30445337#30445337", "title": "Why doesn&#39;t this haskell type signature work?", "body": "<p>ok this will work:</p>\n\n<pre><code>average :: Integral a =&gt; [a] -&gt; a\naverage ns = sum ns `div` (fromIntegral $ length ns)\n</code></pre>\n\n<p>please note that <code>div :: Integral a =&gt; a -&gt; a -&gt; a</code> so you need <code>Integral a</code>  instead of just <code>Num a</code> (which has no division)</p>\n\n<p>And because <code>length</code> will return an <code>Int</code> so you need the <code>fromIntegral</code> to work around it.</p>\n"}, {"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432585562, "post_id": 30445386, "comment_id": 48973098, "body": "good point - I indeed forgot that maybe <code>div</code> is not the best idea ;)"}], "tags": [], "owner": {"reputation": 31664, "user_id": 226975, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad744cf47bf63187d6b406f8be7cfa3a?s=128&d=identicon&r=PG", "display_name": "Wyzard", "link": "https://stackoverflow.com/users/226975/wyzard"}, "is_accepted": false, "score": 2, "last_activity_date": 1432584672, "creation_date": 1432584672, "answer_id": 30445386, "question_id": 30445081, "link": "https://stackoverflow.com/questions/30445081/why-doesnt-this-haskell-type-signature-work/30445386#30445386", "title": "Why doesn&#39;t this haskell type signature work?", "body": "<p>The type of <code>div</code> is <code>Integral a =&gt; a -&gt; a -&gt; a</code>, which means that both of its arguments have to be of the same type.  In this case, the second argument is always of type <code>Int</code> (the result of <code>length</code>), but the first argument is of type <code>a</code>.</p>\n\n<p>In addition, you're trying to write a function that works for any kind of <code>Num</code>, but <code>div</code> only works for integegral types.  If you want to support \"averaging\" lists of integral values (with the result also being rounded to an integer), you could do:</p>\n\n<pre><code>average :: Integral a =&gt; [a] -&gt; a\naverage ns = sum ns `div` fromIntegral (length ns)\n</code></pre>\n\n<p>The <code>fromIntegral</code> will convert the <code>Int</code> length into whatever integral type <code>a</code> is (which might be <code>Int</code>, or something like <code>Integer</code>).</p>\n\n<p>To avoid rounding error, you'll need to use fractional division on fractional types:</p>\n\n<pre><code>average :: Fractional a =&gt; [a] -&gt; a\naverage ns = sum ns / fromIntegral (length ns)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 0, "last_activity_date": 1432638208, "creation_date": 1432638208, "answer_id": 30456718, "question_id": 30445081, "link": "https://stackoverflow.com/questions/30445081/why-doesnt-this-haskell-type-signature-work/30456718#30456718", "title": "Why doesn&#39;t this haskell type signature work?", "body": "<p>The other answers have well highlighted the issue with <code>Num</code> vs. <code>Integral</code> an offer to use a cast after calling <code>length</code>. Alternatively, you could use <code>genericLength</code> from <code>Data.List</code>:</p>\n\n<pre><code>import Data.List\n\naverage :: Integral a =&gt; [a] -&gt; a\naverage ns = sum ns `div` genericLength ns\n</code></pre>\n"}], "owner": {"reputation": 549, "user_id": 4396823, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e7493ed20de304e4d88666ff6977ae33?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/4396823/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 30445337, "answer_count": 3, "score": 1, "last_activity_date": 1432638208, "creation_date": 1432583181, "last_edit_date": 1432586088, "question_id": 30445081, "link": "https://stackoverflow.com/questions/30445081/why-doesnt-this-haskell-type-signature-work", "title": "Why doesn&#39;t this haskell type signature work?", "body": "<p>New guy at haskell here. I'm trying to get better at writing type signatures and this simple one doesn't want to work. I'm wondering why:</p>\n\n<pre><code>average :: Num a =&gt; [a] -&gt; a\naverage ns = sum ns `div` length ns\n</code></pre>\n\n<p>Average should take any number and return some number. However I get the error</p>\n\n<pre><code>test.hs 11:27:\n    Couldn't match expected type 'a' with actual type 'Int'\n       'a' is a rigid type variable bound by\n       the type signature for average :: Num a =&gt; [a] -&gt; a\n        at test.hs:10:12\n    Relevant bindings include\n        ns:: [a] (bound at test.hs:11:9)\n        average :: [a] -&gt; a (bound at test.hs:11:1)\n    In the second argument of 'div' namely 'length ns'\n    In the expression: sum ns `div ` length ns\n</code></pre>\n\n<p>It seems to be saying length isn't getting what it's expecting. Can anyone help? </p>\n"}, {"tags": ["haskell", "cuda", "ffi"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1432572265, "post_id": 30442524, "comment_id": 48967288, "body": "Why is there no CUDA API error checking in your code? &quot;Wrong answer&quot; usually equals &quot;never ran&quot;. But without any error checking, how could you possibly know?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1432572431, "post_id": 30442524, "comment_id": 48967356, "body": "I just took the Hello World from the web. I might add some error checks and update the question."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1432573017, "post_id": 30442524, "comment_id": 48967599, "body": "You should be able to write a native C++ main which calls the hello function and check it works. It could be that your CUDA installation is broken, or it could be a haskell-CUDA problem, but at the moment it is extremely hard to say"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1432573061, "post_id": 30442524, "comment_id": 48967619, "body": "I&#39;ve done that, it does work. Anyway, updated the question."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1432575961, "post_id": 30442524, "comment_id": 48968991, "body": "So you have your answer. The runtime API fails to detect a valid device when called from whatever it is you are using in Haskell."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1432577069, "post_id": 30442524, "comment_id": 48969571, "body": "Okay. I updated the actual question."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1432609284, "post_id": 30448463, "comment_id": 48979179, "body": "Oh. That is weird. Maybe it is something specific to my machine, then. Sorry if that&#39;s the case, and thanks!"}], "tags": [], "owner": {"reputation": 183, "user_id": 600745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea9b895125e490a90346fb03ffc85af?s=128&d=identicon&r=PG", "display_name": "nilweed", "link": "https://stackoverflow.com/users/600745/nilweed"}, "is_accepted": false, "score": 4, "last_activity_date": 1432607092, "creation_date": 1432607092, "answer_id": 30448463, "question_id": 30442524, "link": "https://stackoverflow.com/questions/30442524/calling-a-cuda-hello-world-from-haskell-using-the-ffi-gives-wrong-results/30448463#30448463", "title": "Calling a CUDA &quot;Hello World&quot; from Haskell using the FFI gives wrong results", "body": "<p>Using <code>ghc 7.8.3</code> and <code>nvcc V6.5.12</code>, I found that your code works as expected.  The only different thing that I did was name <code>hello.c</code> as <code>hello.cu</code>.</p>\n\n<pre><code>/:cuda_haskell&gt; nvcc --version\nnvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2014 NVIDIA Corporation\nBuilt on Thu_Jul_17_19:13:24_CDT_2014\nCuda compilation tools, release 6.5, V6.5.12\n/:cuda_haskell&gt; nvcc -o hello.o -c hello.cu\n/:cuda_haskell&gt; ghc main.hs -o hello_hs hello.o -L/usr/local/cuda/lib -optl-lcudart\nLinking hello_hs ...\n/:cuda_haskell&gt; ./hello_hs\nHello World!\n/:cuda_haskell&gt; cat main.hs\n-- main.hs\n{-# LANGUAGE ForeignFunctionInterface #-}\n\nimport Foreign.C\nimport Foreign.Ptr (Ptr,nullPtr)\n\nforeign import ccall \"hello\" hello :: IO ()\n\nmain = hello\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "is_accepted": true, "score": 5, "last_activity_date": 1432611913, "creation_date": 1432611913, "answer_id": 30449096, "question_id": 30442524, "link": "https://stackoverflow.com/questions/30442524/calling-a-cuda-hello-world-from-haskell-using-the-ffi-gives-wrong-results/30449096#30449096", "title": "Calling a CUDA &quot;Hello World&quot; from Haskell using the FFI gives wrong results", "body": "<p>Maybe unrelated, but I was able to reproduce your error on a Mac with separate on-board and discrete graphics cards. When \"Automatic graphics switching\" is enabled in System Preferences (and no 3D graphics applications are running), I get the same \"no CUDA-capable device is detected\" error.</p>\n\n<p>When I turn off automatic graphics switching, it forces the Mac to use the discrete graphics card, and then the program runs as expected.</p>\n\n<p>The purely C/CUDA-based version of the code doesn't seem to be affected by this preference and always works whether automatic switching is enabled or not.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 30449096, "answer_count": 2, "score": 2, "last_activity_date": 1432611913, "creation_date": 1432571829, "last_edit_date": 1432577059, "question_id": 30442524, "link": "https://stackoverflow.com/questions/30442524/calling-a-cuda-hello-world-from-haskell-using-the-ffi-gives-wrong-results", "title": "Calling a CUDA &quot;Hello World&quot; from Haskell using the FFI gives wrong results", "body": "<p>This is the standard Hello World CUDA file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"hello.h\"\n\nconst int N = 7;\nconst int blocksize = 7;\n\n__global__ void hello_kernel(char *a, int *b) {\n    a[threadIdx.x] += b[threadIdx.x];\n}\n\n#define cudaCheckError() { \\\n    cudaError_t e=cudaGetLastError(); \\\n    if(e!=cudaSuccess) { \\\n        printf(\"Cuda failure %s:%d: '%s'\\n\",__FILE__,__LINE__,cudaGetErrorString(e)); \\\n        exit(0); \\\n    } \\\n}\n\nvoid hello() {\n    char a[N] = \"Hello \";\n    int b[N] = {15, 10, 6, 0, -11, 1, 0};\n\n    char *ad;\n    int *bd;\n    const int csize = N*sizeof(char);\n    const int isize = N*sizeof(int);\n\n    printf(\"%s\", a);\n\n    cudaMalloc( (void**)&amp;ad, csize );\n    cudaMemcpy( ad, a, csize, cudaMemcpyHostToDevice );\n    cudaCheckError();\n\n    cudaMalloc( (void**)&amp;bd, isize );\n    cudaMemcpy( bd, b, isize, cudaMemcpyHostToDevice );\n    cudaCheckError();\n\n    dim3 dimBlock( blocksize, 1 );\n    dim3 dimGrid( 1, 1 );\n    hello_kernel&lt;&lt;&lt;dimGrid, dimBlock&gt;&gt;&gt;(ad, bd);\n    cudaMemcpy( a, ad, csize, cudaMemcpyDeviceToHost );\n    cudaCheckError();\n\n    cudaFree( ad );\n    cudaCheckError();\n\n    printf(\"%s\\n\", a);\n}\n</code></pre>\n\n<p>And its header:</p>\n\n<pre><code>-- hello.h\nextern \"C\" \nvoid hello();\n</code></pre>\n\n<p>That's a Haskell file that calls such function:</p>\n\n<pre><code>-- test.hs\n{-# LANGUAGE ForeignFunctionInterface #-}\n\nimport Foreign.C\nimport Foreign.Ptr (Ptr,nullPtr)\n\nforeign import ccall \"hello\" hello :: IO ()\n\nmain = hello\n</code></pre>\n\n<p>I'm compiling it with:</p>\n\n<pre><code>nvcc hello.c -c -o hello.o\nghc test.hs -o test hello.o -L/usr/local/cuda/lib -optl-lcudart\n</code></pre>\n\n<p>Running that program with <code>./test</code> results in:</p>\n\n<pre><code>Hello Cuda failure hello.cu:32: 'no CUDA-capable device is detected'\n</code></pre>\n\n<p>Running the same program with a C <code>main()</code> that just calls <code>hello</code> produces <code>Hello World</code>, as expected.</p>\n\n<p>How do I make Haskell detect the device correctly?</p>\n"}, {"tags": ["haskell", "character-encoding", "cabal", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432575123, "post_id": 30443283, "comment_id": 48968606, "body": "exactly - you&#39;ll get the same if you use ghci say in emacs ;)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1432576065, "last_edit_date": 1432576065, "creation_date": 1432574945, "answer_id": 30443283, "question_id": 30442003, "link": "https://stackoverflow.com/questions/30442003/unreadable-quickcheck-log-file-after-a-test-routine/30443283#30443283", "title": "unreadable quickcheck log file after a test routine", "body": "<p>It looks like the funny characters are simply backspaces, and quickcheck is simply reporting the number of tests it has performed so far by overwriting <code>(0 tests)</code> with <code>(1 test)</code> and then <code>(2 tests)</code> and then with <code>(3 tests)</code>, etc.</p>\n\n<p>Visually it will look fine when displayed to a terminal.</p>\n\n<p>Update:</p>\n\n<p>To report the random values used for a test the only way I know of is to write your test to explicitly display (or save to a file) the values used.</p>\n\n<p>If your test is a pure function you can use the <code>trace</code> function from  <code>Debug.Trace</code>. For instance, if you have this property:</p>\n\n<pre><code>prop_commutes :: Int -&gt; Int -&gt; Bool\nprop_commutes a b = a + b == b + a\n</code></pre>\n\n<p>You can trace each invocation of <code>prop_commutes</code> by modifying like this:</p>\n\n<pre><code>import Debug.Trace\n\nprop_commutes :: Int -&gt; Int -&gt; Bool\nprop_commutes x y = a + b == b + a\n  where (a,b) = trace (\"(a,b) = \" ++ show (x,y)) (x,y)\n</code></pre>\n\n<p>and then <code>quickCheck prop_commutes</code> will emit lines like:</p>\n\n<pre><code>(x,y) = (20,-73)\n(x,y) = (71,-36)\n(x,y) = (2,-11)\n...\n</code></pre>\n\n<p>in addition to its normal output.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 30443283, "answer_count": 1, "score": 0, "last_activity_date": 1432576065, "creation_date": 1432569492, "question_id": 30442003, "link": "https://stackoverflow.com/questions/30442003/unreadable-quickcheck-log-file-after-a-test-routine", "title": "unreadable quickcheck log file after a test routine", "body": "<p>I made a test routine for a Haskell program with quickcheck. I declared it in my cabal file with : </p>\n\n<pre><code>Test-Suite routine_de_test\n  Type:               exitcode-stdio-1.0\n  Hs-Source-Dirs:     test\n  Main-is:            Tests.hs\n</code></pre>\n\n<p>and launched it with : </p>\n\n<pre><code>cabal configure --enable-tests\ncabal buil\ncabal test\n</code></pre>\n\n<p>The tests are processed correctly and I was expecting to see details about the random value used for each test in the log file <code>dist/test/</code> but when I open it, the file looks like this : </p>\n\n<p><img src=\"https://i.stack.imgur.com/qItnp.png\" alt=\"enter image description here\"></p>\n\n<p>I tried to open the file with several encoding (UTF8, ISO-8859-15, ...) but nothing is changed.</p>\n\n<p>Is it normal? Or is there something wrong?</p>\n\n<p><strong>Is it possible when performing quickcheck test from cabal to get the complete list of random values used for each tests?</strong></p>\n"}, {"tags": ["haskell", "operator-overloading"], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1432569045, "post_id": 30441823, "comment_id": 48965915, "body": "It is possible to shadow the operators, define a Boolean class, define <code>&amp;&amp;</code> and <code>||</code> as its methods, and make Bool one of the instances of Boolean."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1432569090, "post_id": 30441823, "comment_id": 48965932, "body": "wonder why there isn&#39;t a <code>Logic</code> type class similarly to <code>Num</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1432569274, "post_id": 30441823, "comment_id": 48966031, "body": "@ErikAllik Ha, funny that, I&#39;ve been making something similar as we speak!"}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": false, "score": 1, "last_activity_date": 1432568743, "creation_date": 1432568743, "answer_id": 30441823, "question_id": 30441760, "link": "https://stackoverflow.com/questions/30441760/is-it-possible-to-overload-logical-operators-e-g-in-haskell/30441823#30441823", "title": "Is it possible to overload logical operators (&amp;&amp; e.g.) in Haskell?", "body": "<p>No, it's not possible. The type of <code>&amp;&amp;</code> is <code>Bool -&gt; Bool -&gt; Bool</code>, and Haskell doesn't allow ad-hoc overloading. You can shadow the declaration, but then you can't use the operator for both booleans and your mvl values in the same module without qualification.</p>\n\n<p>I recommend you define similar-looking operators such as <code>&amp;&amp;?</code> for your mvls.</p>\n"}, {"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1432569301, "post_id": 30441899, "comment_id": 48966045, "body": "Or <code>import Prelude hiding ((&amp;&amp;), (||))</code> and then just name them <code>||</code> and <code>&amp;&amp;</code>!"}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 1, "last_activity_date": 1432569025, "creation_date": 1432569025, "answer_id": 30441899, "question_id": 30441760, "link": "https://stackoverflow.com/questions/30441760/is-it-possible-to-overload-logical-operators-e-g-in-haskell/30441899#30441899", "title": "Is it possible to overload logical operators (&amp;&amp; e.g.) in Haskell?", "body": "<p>You can't override them, but you can define your own.</p>\n\n<pre><code>infixr 3 &lt;&amp;&amp;&gt; &lt;||&gt;\n\n&lt;&amp;&amp;&gt; :: ??? -&gt; ??? -&gt; ???\n&lt;&amp;&amp;&gt; ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1432569097, "creation_date": 1432569097, "answer_id": 30441920, "question_id": 30441760, "link": "https://stackoverflow.com/questions/30441760/is-it-possible-to-overload-logical-operators-e-g-in-haskell/30441920#30441920", "title": "Is it possible to overload logical operators (&amp;&amp; e.g.) in Haskell?", "body": "<p><code>(&amp;&amp;)</code> is defined as</p>\n\n<pre><code>(&amp;&amp;) :: Bool -&gt; Bool -&gt; Bool\n</code></pre>\n\n<p>So unless you don't load the <code>Prelude</code>, or load it qualified, you cannot overload that operator.</p>\n\n<p>There is however a typeclass that does more or less what you are looking for: <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Bits.html#v:-46--38--46-\" rel=\"nofollow\"><code>Data.Bits</code></a> with signatures like:</p>\n\n<pre><code>(.&amp;.) :: Bits a =&gt; a -&gt; a -&gt; a\n(.|.) :: Bits a =&gt; a -&gt; a -&gt; a\ncomplement :: Bits a =&gt; a -&gt; a\n</code></pre>\n\n<p><code>Data.Bits</code> is normally used to represent bitwise operations. You could decide to ignore the remaining operators (return some default value) or assign a useful property to it.</p>\n\n<p>Otherwise you can define similar operators. In that case one betters defines a typeclass first:</p>\n\n<pre><code>class Logic a where\n    land :: a -&gt; a -&gt; a\n    lor :: a -&gt; a -&gt; a\n    lnot :: a -&gt; a\n    lnand :: a -&gt; a -&gt; a\n    lnand x = lnot . land x\n    lnor :: a -&gt; a -&gt; a\n    lnor x = lnot . lor x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1432569604, "last_edit_date": 1432569604, "creation_date": 1432569297, "answer_id": 30441968, "question_id": 30441760, "link": "https://stackoverflow.com/questions/30441760/is-it-possible-to-overload-logical-operators-e-g-in-haskell/30441968#30441968", "title": "Is it possible to overload logical operators (&amp;&amp; e.g.) in Haskell?", "body": "<p>There is no such thing as overriding in Haskell in the monkeypatching sense. </p>\n\n<p>There's also no way to hook an extension into something that wasn't built to be extended. </p>\n\n<p>You can simply shadow the definition of e.g. <code>&amp;&amp;</code> but this would 1) not affect the semantics of <code>&amp;&amp;</code> in other modules and 2) would be confusing. </p>\n\n<p>So I would use something as simple as:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>-- laws should be defined for the class and instances QuickChecked/proved against these laws\nclass Logic a where\n  (&amp;.&amp;) :: a -&gt; a -&gt; a\n  (|.|) :: a -&gt; a -&gt; a\n  ...\n\ninstance Logic Bool where\n  (&amp;.&amp;) = (&amp;&amp;)\n  (|.|) = (||)\n\ndata MultiBool = False' | True' | Perhaps | CouldBe | Possibly | Unlikely\n\ninstance Logic MultiBool where\n  ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1432571069, "last_edit_date": 1432571069, "creation_date": 1432569616, "answer_id": 30442029, "question_id": 30441760, "link": "https://stackoverflow.com/questions/30441760/is-it-possible-to-overload-logical-operators-e-g-in-haskell/30442029#30442029", "title": "Is it possible to overload logical operators (&amp;&amp; e.g.) in Haskell?", "body": "<p>Haskell doesn't really have overloading (=<em>ad-hoc-polymorphism</em>) at all. <code>+</code>, <code>*</code> etc. are not functions but <em>class methods</em>: &ldquo;overloading&rdquo; them is more like defining concrete descendants of an OO interface / purely-abstract class than overloading functions in, say, C++.</p>\n\n<p>The logical operators OTOH are just ordinary functions, which are defined in the Prelude once and for all.</p>\n\n<p>However, in Haskell, infix operators are mostly treated just as a special kind of function name, they're not part of the actual syntax definition. Nothing prevents you from defining new, <em>different</em> operators with the same purpose, e.g.</p>\n\n<pre><code>class Booly b where\n  true :: b\n  false :: b\n  (&amp;&amp;?) :: b -&gt; b -&gt; b\n  (||?) :: b -&gt; b -&gt; b\ninfixr 3 &amp;&amp;?\ninfixr 2 ||?\n\ninstance Booly Bool where\n  true = True\n  false = False\n  (&amp;&amp;?) = (&amp;&amp;)\n  (||?) = (||)\n\ninstance Booly MVBool where\n  true = ...\n</code></pre>\n\n<p>In fact, it's enough if the new names are disambiguated by module qualifiers:</p>\n\n<pre><code>import Prelude hiding ((&amp;&amp;), (||))\nimport qualified Prelude\n\nclass Booly b where\n  true :: b\n  false :: b\n  (&amp;&amp;) :: b -&gt; b -&gt; b\n  (||) :: b -&gt; b -&gt; b\ninfixr 3 &amp;&amp;\ninfixr 2 ||\n\ninstance Booly Bool where\n  true = True\n  false = False\n  (&amp;&amp;) = (Prelude.&amp;&amp;)\n  (||) = (Prelude.||)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2978629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc77d3dc8add8ad1d381de99e693564?s=128&d=identicon&r=PG&f=1", "display_name": "astvat", "link": "https://stackoverflow.com/users/2978629/astvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 30442029, "answer_count": 5, "score": 3, "last_activity_date": 1432571069, "creation_date": 1432568524, "question_id": 30441760, "link": "https://stackoverflow.com/questions/30441760/is-it-possible-to-overload-logical-operators-e-g-in-haskell", "title": "Is it possible to overload logical operators (&amp;&amp; e.g.) in Haskell?", "body": "<p>I'm working with many-valued logic and trying to overload basic logic functions.</p>\n\n<p>I haven't problem with overloading <code>Num</code> and <code>Eq</code> operators, but I don't know how to overload <code>&amp;&amp;, ||</code> and <code>not</code>. </p>\n\n<p>Is it possible? Thanks for answers!</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1432576605, "creation_date": 1432576605, "answer_id": 30443673, "question_id": 30441661, "link": "https://stackoverflow.com/questions/30441661/design-code-to-avoid-rewriting-during-maintenance/30443673#30443673", "title": "Design code to avoid rewriting during maintenance", "body": "<p>I'm not sure why you need to modify the <code>objects</code> function instead of creating a new one. However, for your last question : old code  reconstructing the new structure , the standard way is to have a default value and build any new values using this value and modifying it , like</p>\n\n<pre><code>data Foo = Foo { foo :: String, bar :: Int }\nfooDef = Foo \"\" 0\n\nnewFoo :: String -&gt; Int -&gt; Foo\nnewFoo f b= fooDef { foo = f, bar = b }\n</code></pre>\n\n<p>This way, when you add a new field to <code>Foo</code> you only need to upade <code>fooDef</code>. However, it's probably better to not use it and update manually the code whereever it break. That's why you are using static typing after all, aren't you ?</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1432576605, "creation_date": 1432568129, "question_id": 30441661, "link": "https://stackoverflow.com/questions/30441661/design-code-to-avoid-rewriting-during-maintenance", "title": "Design code to avoid rewriting during maintenance", "body": "<p>I have <code>lens</code> based code that expects a certain data structure:</p>\n\n<pre><code>makeLenses ''Pool\n...\npool ^. objects ^? _head :: Maybe Object\n</code></pre>\n\n<p>This code assumes that:</p>\n\n<pre><code>objects ::\n  Functor f =&gt;\n  ([Object] -&gt; f [Object]) -&gt; Pool -&gt; f Pool\n</code></pre>\n\n<p>But I want to introduce new information to the structure and new lens will become:</p>\n\n<pre><code>objects ::\n  Functor f =&gt;\n  ([DebugInfo Object] -&gt; f [DebugInfo Object]) -&gt; Pool -&gt; f Pool\n</code></pre>\n\n<p>My goal is to avoid any changes existing code as if it were complex project under maintenance.</p>\n\n<p>Since I use <code>lens</code> library, I suppose it should be possible to provide a new module providing a \"backported\" <code>objects</code> lens so that I do not need to change old code (except imports maybe).</p>\n\n<p>Is this plausible approach? Is there is a limitation lurking somewhere? Type classes or module system come to mind. I also suspect that I may have a problem with old code being unable to \"reconstruct\" a new structure. Do I need row type polymorphism to do that?</p>\n\n<p>Lastly, if this can be done, how should I structure my modules to keep proper separation?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 5, "last_activity_date": 1432563822, "creation_date": 1432563822, "answer_id": 30440529, "question_id": 30440377, "link": "https://stackoverflow.com/questions/30440377/usefulness-of-function-arrows-associate-to-the-right/30440529#30440529", "title": "Usefulness of &quot;function arrows associate to the right&quot;?", "body": "<p>When defining a two-argument curried function, we usually write something like this:</p>\n\n<pre><code>f :: a -&gt; b -&gt; c\nf x y = ...\n</code></pre>\n\n<p>If the arrow did not associate to the right, the above type would instead have to be spelled out as <code>a -&gt; (b -&gt; c)</code>. So the usefulness of <code>-&gt;</code>'s associativity is that it saves us from writing too many parentheses when declaring function types.</p>\n"}, {"comments": [{"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1432565083, "post_id": 30440552, "comment_id": 48964052, "body": "(++) function application associates to the right, which has performance implications as you mention and so is useful information. The associativity of the arrows is meaningless and has no use as function application is all that matters ?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1432565246, "post_id": 30440552, "comment_id": 48964121, "body": "&#39;However, in functions like (++), associativity matters. If (++) were left associative, it would be very slow, so it&#39;s right associative.&#39; That&#39;s a bit of a misleading statement. If I have something like <code>a ++ b ++ c</code> there&#39;s a fast way to parenthesize it and a slow way. Associativity affects which one is chosen <i>if I don&#39;t parenthesize it myself</i>, but it does not affect the speed of the function itself. If I fully parenthesize my use of an operator, associativity has no effect at all."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 4, "creation_date": 1432565320, "post_id": 30440552, "comment_id": 48964169, "body": "@blue-sky <code>a -&gt; (b -&gt; c)</code> is a very different type from <code>(a -&gt; b) -&gt; c</code>, so when you write <code>a -&gt; b -&gt; c</code>, it&#39;s not meaningless at all what the associativity of <code>-&gt;</code> is."}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1432565856, "post_id": 30440552, "comment_id": 48964430, "body": "@sepp2k type with signature (a -&gt; b) -&gt; c . (a -&gt; b) will be evaluated first then the result of this evaluation will be evaluated with c . In this case function application associates to right instead of default associativity to left if no parenthesis used ?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1432566118, "post_id": 30440552, "comment_id": 48964585, "body": "@blue-sky Types aren&#39;t expressions, they are not evaluated. And even for expressions neither associativity nor use of parentheses tell you which subexpression is evaluated first - they only tell you what the subexpressions are. The difference between <code>f :: (a -&gt; b) -&gt; c</code> and <code>g :: a -&gt; (b -&gt; c)</code> is that <code>f</code> takes a function as its argument (and that function takes an <code>a</code> and prodcues a <code>b</code>) and produces a result of type <code>c</code>, whereas <code>g</code> takes an argument of type <code>a</code> and produces a function of type <code>b -&gt; c</code> as its result (or alternatively you might say it takes two arguments of types <code>a</code> ..."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1432566149, "post_id": 30440552, "comment_id": 48964606, "body": "... and <code>b</code> and produces a result of type <code>c</code>). That&#39;s very different from what <code>f</code> does."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1432569196, "last_edit_date": 1432569196, "creation_date": 1432563904, "answer_id": 30440552, "question_id": 30440377, "link": "https://stackoverflow.com/questions/30440377/usefulness-of-function-arrows-associate-to-the-right/30440552#30440552", "title": "Usefulness of &quot;function arrows associate to the right&quot;?", "body": "<p>If an operator <code>#</code> is 'right associative', it means this:</p>\n\n<pre><code>a # b # c # d  =  a # (b # (c # d))\n</code></pre>\n\n<p>... for any number of arguments. It behaves like <code>foldr</code></p>\n\n<p>This means that:</p>\n\n<pre><code>a -&gt; b -&gt; c -&gt; d  =  a -&gt; (b -&gt; (c -&gt; d))\n</code></pre>\n\n<p><em>Note: <code>a -&gt; (b -&gt; (c -&gt; d)) =/= ((a -&gt; b) -&gt; c) -&gt; d</code> ! This is very important.</em></p>\n\n<p>What this tells us is that, say, <code>foldr</code>:</p>\n\n<pre><code>\u03bb&gt; :t foldr\nfoldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>Takes a function of type <code>(a -&gt; b -&gt; b)</code>, and then returns... a function that takes a <code>b</code>, and then returns... a function that takes a <code>[a]</code>, and then returns... a <code>b</code>. This means that we can apply functions like this</p>\n\n<pre><code>f a b c\n</code></pre>\n\n<p>because</p>\n\n<pre><code>f a b c  =  ((f a) b) c\n</code></pre>\n\n<p>and <code>f</code> will return two functions each time an argument is given.</p>\n\n<p>Essentially, this isn't very <em>useful</em> as such, but is important information for when we want to interpret and call function types.</p>\n\n<p>However, in functions like <code>(++)</code>, associativity matters. If <code>(++)</code> were left associative, it would be very slow, so it's right associative.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 2713487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea8f613365200ed766815ff5885647bc?s=128&d=identicon&r=PG&f=1", "display_name": "csey", "link": "https://stackoverflow.com/users/2713487/csey"}, "edited": false, "score": 2, "creation_date": 1463242221, "post_id": 30441962, "comment_id": 61987601, "body": "This also helps you to think about the useful technique of <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow noreferrer\">currying</a>, whereby we use the actual <i>function</i> that is returned.  For example, if we had some <code>f x y : Int -&gt; Int -&gt; Int</code> that calculated <code>x * y</code>, then we could use <code>f 2</code> as a &quot;doubling&quot; function, of <code>f 3</code> as a &quot;tripling&quot; function etc"}], "tags": [], "owner": {"reputation": 6694, "user_id": 2555037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62b3037add2dde3cb8dd935f7ca9fe7?s=128&d=identicon&r=PG", "display_name": "Toxaris", "link": "https://stackoverflow.com/users/2555037/toxaris"}, "is_accepted": true, "score": 15, "last_activity_date": 1432569270, "creation_date": 1432569270, "answer_id": 30441962, "question_id": 30440377, "link": "https://stackoverflow.com/questions/30440377/usefulness-of-function-arrows-associate-to-the-right/30441962#30441962", "title": "Usefulness of &quot;function arrows associate to the right&quot;?", "body": "<blockquote>\n  <p>Function arrows associate to the right but [...] what is usefulness of this information?</p>\n</blockquote>\n\n<p>If you see a type signature like, for example, <code>f : String -&gt; Int -&gt; Bool</code> you need to know the associativity of the function arrow to understand what the type of <code>f</code> really is:</p>\n\n<ol>\n<li>if the arrow associates to the left, then the type means <code>(String -&gt; Int) -&gt; Bool</code>, that is, <code>f</code> takes a function as argument and returns a boolean.</li>\n<li>if the arrow associates to the right, then the type means <code>String -&gt; (Int -&gt; Bool)</code>, that is, <code>f</code> takes a string as argument and returns a function.</li>\n</ol>\n\n<p>That's a big difference, and if you want to use <code>f</code>, you need to know which one it is. Since the function arrow associates to the right, you know that it has to be the second option: <code>f</code> takes a string and returns a function.</p>\n\n<blockquote>\n  <p>Function arrows associate to the right [...] function application associates to the left</p>\n</blockquote>\n\n<p>These two choices work well together. For example, we can call the <code>f</code> from above as <code>f \"answer\" 42</code> which really means <code>(f \"answer\") 42</code>. So we are passing the string <code>\"answer\"</code> to <code>f</code> which returns a function. And then we're passing the number <code>42</code> to that function, which returns a boolean. In effect, we're almost using <code>f</code> as a function with two arguments.</p>\n\n<p>This is the standard way of writing functions with two (or more) arguments in Haskell, so it is a very common use case. Because of the associativity of function application and of the function arrow, we can write this common use case without parentheses.</p>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 5874981, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/98c6958b1b71ba6caddef718af8d8a97?s=128&d=identicon&r=PG&f=1", "display_name": "Serge", "link": "https://stackoverflow.com/users/5874981/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1498665336, "last_edit_date": 1498665336, "creation_date": 1498661646, "answer_id": 44805993, "question_id": 30440377, "link": "https://stackoverflow.com/questions/30440377/usefulness-of-function-arrows-associate-to-the-right/44805993#44805993", "title": "Usefulness of &quot;function arrows associate to the right&quot;?", "body": "<p>Early functional language Lisp suffered from excessively nested parenthesis (which make code (or even text (if you do not mind to consider a broader context)) difficult to read. With time functional language designers opted to make functional code easy to read and write for pros even at cost of confusing rookies with less uniform rules.</p>\n\n<p>In functional code, \nfunction type declaration like (String -> Int) -> Bool are much more rare than functions like String -> (Int -> Bool), because functions that return functions are trade mark of functional style. Thus associating arrows to right helps reduce parentheses number (on overage, you might need to map a function to a primitive type). For function applications it is vise-versa.</p>\n"}, {"tags": [], "owner": {"reputation": 1474, "user_id": 3506447, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/341538235a0417682919a3b2fba4db5f?s=128&d=identicon&r=PG&f=1", "display_name": "Melvic Ybanez", "link": "https://stackoverflow.com/users/3506447/melvic-ybanez"}, "is_accepted": false, "score": 0, "last_activity_date": 1601826302, "creation_date": 1601826302, "answer_id": 64196695, "question_id": 30440377, "link": "https://stackoverflow.com/questions/30440377/usefulness-of-function-arrows-associate-to-the-right/64196695#64196695", "title": "Usefulness of &quot;function arrows associate to the right&quot;?", "body": "<p>The main purposes is convenience, because partial function application goes from left to right.</p>\n<p>Every time you partially apply a function to a set of values, the remaining type has to be valid.</p>\n<p>You can think of arrow types as a queue of types, where the queue itself is a type. During partial function application, you dequeue as many types from the queue as the number of arguments, yielding whatever remains of the queue. The resulting queue is still a valid type.</p>\n<p>This is why types associate to the right. If types associate to the left, it will behave like a stack, and you won't be able to partially apply it the same way without leaving &quot;holes&quot; or undefined domains. For instance, say you have the following function:</p>\n<pre><code>foo :: a -&gt; b -&gt; c -&gt; d\n</code></pre>\n<p>If Haskell types were left-associative, then passing a single parameter to foo would yield the following invalid type:</p>\n<pre><code>((? -&gt; b) -&gt; c) -&gt; d\n</code></pre>\n<p>You will then be forced to circumvent it by adding parentheses, which could hamper readability.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1243, "favorite_count": 2, "accepted_answer_id": 30441962, "answer_count": 5, "score": 6, "last_activity_date": 1601826302, "creation_date": 1432563333, "last_edit_date": 1432565143, "question_id": 30440377, "link": "https://stackoverflow.com/questions/30440377/usefulness-of-function-arrows-associate-to-the-right", "title": "Usefulness of &quot;function arrows associate to the right&quot;?", "body": "<p>Reading <a href=\"http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html\" rel=\"noreferrer\">http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html</a> it states </p>\n\n<blockquote>\n  <p>In particular, note that function arrows associate to the right, that\n  is, W -> X -> Y -> Z is equivalent to W -> (X -> (Y -> Z)). We can\n  always add or remove parentheses around the rightmost top-level arrow\n  in a type.</p>\n</blockquote>\n\n<p>Function arrows associate to the right but as function application associates to the left then what is usefulness of this information ? I feel I'm not understanding something as to me it is a meaningless point that function arrows associate to the right. As function application always associates to the left then this the only associativity I should be concerned with ? </p>\n"}, {"tags": ["haskell", "syntax", "parse-error"], "comments": [{"owner": {"reputation": 3608, "user_id": 971193, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/595080b1b9c49b099a65928e6589e703?s=128&d=identicon&r=PG", "display_name": "Karolis Juodel\u0117", "link": "https://stackoverflow.com/users/971193/karolis-juodel%c4%97"}, "edited": false, "score": 5, "creation_date": 1432561389, "post_id": 30439734, "comment_id": 48962203, "body": "That&#39;s true for all operators. It&#39;s just a parsing thing."}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 7, "last_activity_date": 1432637980, "last_edit_date": 1432637980, "creation_date": 1432562286, "answer_id": 30440077, "question_id": 30439734, "link": "https://stackoverflow.com/questions/30439734/why-are-brackets-required-to-print-type-information-of/30440077#30440077", "title": "Why are brackets required to print type information of .?", "body": "<p><code>.</code> without the parentheses only works in infix position. <code>:t</code> however takes an expression, e.g. a function, and to turn an infix operator symbol into an expression, you need to surround it with parens.</p>\n\n<p>Consider:</p>\n\n<pre><code>3 + 4 = (+) 3 4  -- pseudocode\n</code></pre>\n\n<p>and</p>\n\n<pre><code>myPlus = (+)\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>myPlus a b = a + b\nmyPlus a b = (+) a b\n</code></pre>\n\n<p>And it applies equally to all other infix operators such as <code>*</code> or <code>&gt;&gt;=</code> or <code>&amp;&amp;&amp;</code> etc. </p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 30440077, "answer_count": 1, "score": 0, "last_activity_date": 1432637980, "creation_date": 1432561131, "last_edit_date": 1432586060, "question_id": 30439734, "link": "https://stackoverflow.com/questions/30439734/why-are-brackets-required-to-print-type-information-of", "title": "Why are brackets required to print type information of .?", "body": "<p>To print the type information of <code>.</code> I use :</p>\n\n<pre><code>\u03bb&gt; :type (.)\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>If I omit the brackets , causes an error : </p>\n\n<pre><code>\u03bb&gt; :type .\n&lt;interactive&gt;:1:1: parse error on input \u2018.\u2019\n</code></pre>\n\n<p>The same is not true for other types : </p>\n\n<pre><code>\u03bb&gt; :type 1\n1 :: Num a =&gt; a\n\u03bb&gt; :type (1)\n(1) :: Num a =&gt; a\n\u03bb&gt; :type True \nTrue :: Bool\n\u03bb&gt; :type (True)\n(True) :: Bool\n</code></pre>\n\n<p>Why the special behavior for <code>.</code> ?</p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 2, "creation_date": 1432578360, "post_id": 30439636, "comment_id": 48970126, "body": "Have you looked at <a href=\"http://snapframework.com/faq#how-do-i-enable-ssl\" rel=\"nofollow noreferrer\">snapframework.com/faq#how-do-i-enable-ssl</a>? Where are you stuck?"}, {"owner": {"reputation": 215, "user_id": 2035316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b84b148152679b9172a63ebb10a64f69?s=128&d=identicon&r=PG", "display_name": "Deck Pope", "link": "https://stackoverflow.com/users/2035316/deck-pope"}, "reply_to_user": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1432638831, "post_id": 30439636, "comment_id": 48994418, "body": "I read it, yes. I thought it will be something more programmatic , right from the server, written in the app using one of these <a href=\"https://hackage.haskell.org/package/snap-server-0.9.5.1/docs/Snap-Http-Server-Config.html\" rel=\"nofollow noreferrer\">functions</a>"}, {"owner": {"reputation": 463, "user_id": 2976251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe393a6e3c9fe3857dc7b27ff5db473?s=128&d=identicon&r=PG&f=1", "display_name": "hasufell", "link": "https://stackoverflow.com/users/2976251/hasufell"}, "reply_to_user": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1448889913, "post_id": 30439636, "comment_id": 55754871, "body": "@JPMoresmau The official documentation on that is misleading, because it assumes you are using the internal cli argument  parser via <code>commandLineAppConfig</code>, which might or might not be true, depending on your project."}], "answers": [{"tags": [], "owner": {"reputation": 1030, "user_id": 521806, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PaOw7.jpg?s=128&g=1", "display_name": "Juan Pablo Santos", "link": "https://stackoverflow.com/users/521806/juan-pablo-santos"}, "is_accepted": true, "score": 2, "last_activity_date": 1440080319, "creation_date": 1440080319, "answer_id": 32120772, "question_id": 30439636, "link": "https://stackoverflow.com/questions/30439636/how-can-i-enable-https-over-a-snap-server/32120772#32120772", "title": "How can i enable HTTPS over a Snap server?", "body": "<p>JP Moresmau showed you how to enable it from the command line, but doing the same programatically is just as easy. The function that starts Snap's \"main loop\" takes a configuration parameter as the first argument as you can see <a href=\"https://hackage.haskell.org/package/snap-server-0.9.5.1/docs/Snap-Http-Server.html#httpServe\" rel=\"nofollow\">in this bit of documentation</a>. You can simply call <code>defaultConfig</code> from the <a href=\"https://hackage.haskell.org/package/snap-server-0.9.5.1/docs/src/Snap-Internal-Http-Server-Config.html#defaultConfig\" rel=\"nofollow\">Snap.Http.Server.Config</a> module and then call <code>setSSLPort</code>, <code>setCert</code> and <code>setSSLKey</code> on it. Then you can pass this new config to <code>httpServe</code> as the first argument. If you used <code>snap init</code> you can find all the relevant code in your <code>src/Main.hs</code>.</p>\n\n<p>As you can see <a href=\"https://hackage.haskell.org/package/snap-server-0.9.5.1/docs/src/Snap-Internal-Http-Server-Config.html#extendedCommandLineConfig\" rel=\"nofollow\">here</a>, the default config is created from the command line using <a href=\"https://hackage.haskell.org/package/snap-server-0.9.5.1/docs/src/Snap-Internal-Http-Server-Config.html#optDescrs\" rel=\"nofollow\">a description of options</a>. So changing the <code>defaultConfig</code> is exactly the same as passing commandline arguments.</p>\n\n<p>What I find slightly odd is that there's no <code>defaultSSLConfig</code> that generates a self-signed certificate so you can try SSL quickly. Also, it's odd the certificate and keys are of type <code>FilePath</code>. Maybe it's a good pull request for the Snap team to check?</p>\n"}], "owner": {"reputation": 215, "user_id": 2035316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b84b148152679b9172a63ebb10a64f69?s=128&d=identicon&r=PG", "display_name": "Deck Pope", "link": "https://stackoverflow.com/users/2035316/deck-pope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 32120772, "answer_count": 1, "score": 3, "last_activity_date": 1440080319, "creation_date": 1432560819, "question_id": 30439636, "link": "https://stackoverflow.com/questions/30439636/how-can-i-enable-https-over-a-snap-server", "title": "How can i enable HTTPS over a Snap server?", "body": "<p>is there a simple example on enabling HTTPS in a Snap server?\nI am not that into OpenSsl and its usage with Snap.\nThanks</p>\n"}, {"tags": ["haskell", "lambda-calculus", "dependent-type"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1432549927, "post_id": 30434343, "comment_id": 48955794, "body": "Whatever you do, you&#39;ll need to maintain the distinctness of t. That&#39;s necessary if you&#39;re doing the Pi-abstraction (how will you abstract t if you can&#39;t see it distinctly?) but it&#39;s also needed to typecheck the body (t is a type, different from lots of other types). You can keep t de Bruijn, but then you need to be a bit more careful about how to work under its binder. I&#39;d pick a fresh name, and indeed I&#39;d cache the type with it. I&#39;m interested to see alternative approaches."}], "answers": [{"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 8, "last_activity_date": 1432659752, "last_edit_date": 1432659752, "creation_date": 1432571147, "answer_id": 30442383, "question_id": 30434343, "link": "https://stackoverflow.com/questions/30434343/what-is-the-right-way-to-typecheck-dependent-lambda-abstraction-using-bound/30442383#30442383", "title": "What is the right way to typecheck dependent lambda abstraction using &#39;bound&#39;?", "body": "<p>We need some kind of context to keep track of the lambda arguments. However, we don't necessarily need to instantiate them, since <code>bound</code> gives us de Bruijn indices, and we can use those indices to index into the context.</p>\n\n<p>Actually using the indices is a bit involved, though, because of the type-level machinery that reflects the size of the current scope (or in other words, the current depth in the expression) through the nesting of <code>Var</code>-s. It necessitates the use of polymorphic recursion or GADTs. It also prevents us from storing the context in a State monad (because the size and thus the type of the context changes as we recurse). I wonder though if we could use an indexed state monad; it'd be a fun experiment. But I digress. </p>\n\n<p>The simplest solution is to represent the context as a function:</p>\n\n<pre><code>type TC  a = Either String a -- our checker monad\ntype Cxt a = a -&gt; TC (Type a) -- the context\n</code></pre>\n\n<p>The <code>a</code> input is essentially a de Bruijn index, and we look up a type by applying the function to the index. We can define the empty context the following way:</p>\n\n<pre><code>emptyCxt :: Cxt a\nemptyCxt = const $ Left \"variable not in scope\"\n</code></pre>\n\n<p>And we can extend the context:</p>\n\n<pre><code>consCxt :: Type a -&gt; Cxt a -&gt; Cxt (Var () a)\nconsCxt ty cxt (B ()) = pure (F &lt;$&gt; ty)\nconsCxt ty cxt (F a)  = (F &lt;$&gt;) &lt;$&gt; cxt a\n</code></pre>\n\n<p>The size of the context is encoded in the <code>Var</code> nesting. The increase in the size is apparent here in the return type. </p>\n\n<p>Now we can write the type checker. The main point here is that we use <code>fromScope</code> and <code>toScope</code> to get under binders, and we carry along an appropriately extended <code>Cxt</code> (whose type lines up just perfectly).</p>\n\n<pre><code>data Term a\n  = Var a\n  | Star -- or alternatively, \"Type\", or \"*\"\n  | Lam (Type a) (Scope () Term a)\n  | Pi  (Type a) (Scope () Term a)\n  | App (Type a) (Term a)  \n  deriving (Show, Eq, Functor)\n\n-- boilerplate omitted (Monad, Applicative, Eq1, Show1 instances)\n\n-- reduce to normal form\nrnf :: Term a -&gt; Term a\nrnf = ...\n\n-- Note: IIRC \"Simply easy\" and Augustsson's post reduces to whnf\n-- when type checking. I use here plain normal form, because it \n-- simplifies the presentation a bit and it also works fine.\n\n-- We rely on Bound's alpha equality here, and also on the fact\n-- that we keep types in normal form, so there's no need for\n-- additional reduction. \ncheck :: Eq a =&gt; Cxt a -&gt; Type a -&gt; Term a -&gt; TC ()\ncheck cxt want t = do\n  have &lt;- infer cxt t\n  when (want /= have) $ Left \"type mismatch\"\n\ninfer :: Eq a =&gt; Cxt a -&gt; Term a -&gt; TC (Type a)\ninfer cxt = \\case\n  Var a -&gt; cxt a\n  Star  -&gt; pure Star -- \"Type : Type\" system for simplicity\n  Lam ty t -&gt; do\n    check cxt Star ty\n    let ty' = rnf ty\n    Pi ty' . toScope &lt;$&gt; infer (consCxt ty' cxt) (fromScope t)\n  Pi ty t -&gt; do\n    check cxt Star ty\n    check (consCxt (rnf ty) cxt) Star (fromScope t)\n    pure Star\n  App f x -&gt; \n    infer cxt f &gt;&gt;= \\case\n      Pi ty t -&gt; do\n        check cxt ty x\n        pure $ rnf (instantiate1 x t)\n      _ -&gt; Left \"can't apply non-function\"\n</code></pre>\n\n<p>Here's <a href=\"https://gist.github.com/AndrasKovacs/2b0fce538ca5e91b85a3\" rel=\"nofollow\">the working code containing</a> the above definitions. I hope I didn't mess it up too badly.</p>\n"}], "owner": {"reputation": 34861, "user_id": 110081, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/cSvwm.jpg?s=128&g=1", "display_name": "Roman Cheplyaka", "link": "https://stackoverflow.com/users/110081/roman-cheplyaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 9, "accepted_answer_id": 30442383, "answer_count": 1, "score": 23, "last_activity_date": 1432659752, "creation_date": 1432543578, "question_id": 30434343, "link": "https://stackoverflow.com/questions/30434343/what-is-the-right-way-to-typecheck-dependent-lambda-abstraction-using-bound", "title": "What is the right way to typecheck dependent lambda abstraction using &#39;bound&#39;?", "body": "<p>I am implementing a simple dependently-typed language, similar to the one <a href=\"http://augustss.blogspot.dk/2007/10/simpler-easier-in-recent-paper-simply.html\">described by Lennart Augustsson</a>, while also using <a href=\"https://hackage.haskell.org/package/bound\">bound</a> to manage bindings.</p>\n\n<p>When typechecking a dependent lambda term, such as <code>\u03bbt:* . \u03bbx:t . x</code>, I need to:</p>\n\n<ol>\n<li>\"Enter\" the outer lambda binder, by instantiating <code>t</code> to <em>something</em></li>\n<li>Typecheck <code>\u03bbx:t . x</code>, yielding <code>\u2200x:t . t</code></li>\n<li>Pi-abstract the <code>t</code>, yielding <code>\u2200t:* . \u2200x:t . t</code></li>\n</ol>\n\n<p>If lambda was non-dependent, I could get away with instantiating <code>t</code> with its <em>type</em> on step 1, since the type is all I need to know about the variable while typechecking on step 2.\nBut on step 3 I lack the information to decide which variables to abstract over.</p>\n\n<p>I could introduce a fresh name supply and instantiate <code>t</code> with a <code>Bound.Name.Name</code> containing both the type and a unique name. But I thought that with <code>bound</code> I shouldn't need to generate fresh names.</p>\n\n<p>Is there an alternative solution I'm missing?</p>\n"}, {"tags": ["haskell", "compilation", "tree"], "answers": [{"comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "reply_to_user": {"reputation": 3430, "user_id": 2538771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ad4af42f7cff8698951a7befb26f0f?s=128&d=identicon&r=PG", "display_name": "Alexey Shmalko", "link": "https://stackoverflow.com/users/2538771/alexey-shmalko"}, "edited": false, "score": 0, "creation_date": 1432576105, "post_id": 30433137, "comment_id": 48969070, "body": "Of course @AlexeyShmalko you are right but I have tried be simplest. Step by step ;)"}], "tags": [], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "is_accepted": true, "score": 5, "last_activity_date": 1432539139, "last_edit_date": 1432539139, "creation_date": 1432538582, "answer_id": 30433137, "question_id": 30433041, "link": "https://stackoverflow.com/questions/30433041/passing-data-between-programs-in-haskell/30433137#30433137", "title": "Passing data between programs in Haskell", "body": "<p>The simplest way may be</p>\n\n<pre><code>data MyData = ... deriving (Read, Show)\n</code></pre>\n\n<p>producer</p>\n\n<pre><code>makeMyData :: MyData\nmakeMyData = ....\n\nmain = writeFile \"output.data\" (show makeMyData)\n</code></pre>\n\n<p>consumer</p>\n\n<pre><code>ioUseMyData :: MyData -&gt; IO ()\nioUseMyData myData = ....\n\nmain = readFile \"output.data\" &gt;&gt;= ioUseMyData . read\n</code></pre>\n\n<p>you can use standard input/output using <code>getContents</code> and <code>putStrLn</code>.</p>\n\n<p>Complete example:</p>\n\n<pre><code>-- probably as module\ndata Tree = Node { value :: Int\n                 , left  :: Tree\n                 , right :: Tree\n                 }\n          | Empty\n            deriving (Read, Show)\n\n-- your producer program\nproducerProgram = do\n\n    let makeTree = Node 3 (Node 5 Empty Empty) (Node 7 Empty Empty)\n    writeFile \"output.data\" (show makeTree)\n\n-- your consumer program\nconsumerProgram = do\n\n    let ioUseTree t = do\n\n            let countNodes Empty = 0\n                countNodes (Node _ l r) = 1 + countNodes l + countNodes r\n\n            putStrLn $ \"Tree with \" ++ show (countNodes t) ++ \" nodes\"\n\n    readFile \"output.data\" &gt;&gt;= ioUseTree . read\n\n-- simulate call both\nmain = do\n\n    -- produce\n    producerProgram\n\n    -- consume\n    consumerProgram\n</code></pre>\n\n<p>result</p>\n\n<pre><code>Tree with 3 nodes\n</code></pre>\n\n<p>replacing</p>\n\n<pre><code>writeFile \"output.data\" (show makeTree)\n</code></pre>\n\n<p>by</p>\n\n<pre><code>print makeTree\n</code></pre>\n\n<p>and</p>\n\n<pre><code>readFile \"output.data\" &gt;&gt;= ioUseTree . read\n</code></pre>\n\n<p>by</p>\n\n<pre><code>getContents &gt;&gt;= ioUseTree . read\n</code></pre>\n\n<p>you can use pipes (<code>bash</code>, <code>cmd.exe</code>, ...)</p>\n\n<pre><code>$ ./producer | ./consumer\nTree with 3 nodes\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1432556164, "post_id": 30433618, "comment_id": 48959312, "body": "#2 ... no choice. Really ? file is obviously the easiest but there other alternatives, sockets, shared memory etc ..."}, {"owner": {"reputation": 3430, "user_id": 2538771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58ad4af42f7cff8698951a7befb26f0f?s=128&d=identicon&r=PG", "display_name": "Alexey Shmalko", "link": "https://stackoverflow.com/users/2538771/alexey-shmalko"}, "edited": false, "score": 0, "creation_date": 1432557489, "post_id": 30433618, "comment_id": 48959996, "body": "If 2 programs run separately, all sockets and memory owned by first one will be unavailable when second program runs. Jeremy stated that you can use <code>Network.Socket</code> if programs run simultaneously."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 1, "last_activity_date": 1432540580, "creation_date": 1432540580, "answer_id": 30433618, "question_id": 30433041, "link": "https://stackoverflow.com/questions/30433041/passing-data-between-programs-in-haskell/30433618#30433618", "title": "Passing data between programs in Haskell", "body": "<p>The easiest way is: don't use 2 separate programs. If you really need 2 separate programs then there are 3 things you will need to choose:</p>\n\n<ol>\n<li>A way of converting the tree into a <code>String</code> or <code>ByteString</code></li>\n<li>A way of sending the string or bytestring to the other program</li>\n<li>A way of converting the <code>String</code> or <code>ByteString</code> back into a tree</li>\n</ol>\n\n<p>For #1 and #3: it's probably easiest to use <code>show</code> and <code>read</code>, but you can also define your own functions if you want as long as they both define the same format.</p>\n\n<p>For #2: if the 2 programs are meant to be run separately then you have no choice: you have to use a file. The easiest way to do so is using the <code>writeFile</code> and <code>readFile</code> functions. If the 2 programs are meant to be run simultaneously you can also use the functions in <a href=\"http://hackage.haskell.org/package/network-2.6.1.0/docs/Network-Socket.html\" rel=\"nofollow\" title=\"`Network.Socket`\"><code>Network.Socket</code></a></p>\n"}], "owner": {"reputation": 89, "user_id": 4151816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356cb2300b8d872e6feb4aa6eb6e9713?s=128&d=identicon&r=PG&f=1", "display_name": "Asdren", "link": "https://stackoverflow.com/users/4151816/asdren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 30433137, "answer_count": 2, "score": 2, "last_activity_date": 1432540580, "creation_date": 1432538135, "question_id": 30433041, "link": "https://stackoverflow.com/questions/30433041/passing-data-between-programs-in-haskell", "title": "Passing data between programs in Haskell", "body": "<p>I'm doing two programs in Haskell, which one of them provides a tree filled with values. </p>\n\n<p>The other program has to get the same tree now filled. I searched about it, but i haven't found something about how to do something like it.</p>\n\n<p>For example i execute ./Generate and it saves the tree with values. Then i execute ./Work and it works with the values of the tree. Can somebody please help me?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432504029, "post_id": 30428486, "comment_id": 48942195, "body": "is this related to <a href=\"https://stackoverflow.com/questions/30428408/haskell-quickcheck-generate-non-upper\">this question</a> ?"}, {"owner": {"reputation": 837, "user_id": 4072022, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b8d2b1ab1299eb31efacc0843964517?s=128&d=identicon&r=PG&f=1", "display_name": "Rumen Hristov", "link": "https://stackoverflow.com/users/4072022/rumen-hristov"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432504123, "post_id": 30428486, "comment_id": 48942220, "body": "no. I have nothing to do with that question."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432504146, "post_id": 30428486, "comment_id": 48942226, "body": "maybe you have the same teacher? - well anyway - Joes answer is not that bad ;)"}], "answers": [{"comments": [{"owner": {"reputation": 837, "user_id": 4072022, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b8d2b1ab1299eb31efacc0843964517?s=128&d=identicon&r=PG&f=1", "display_name": "Rumen Hristov", "link": "https://stackoverflow.com/users/4072022/rumen-hristov"}, "edited": false, "score": 0, "creation_date": 1432507778, "post_id": 30428840, "comment_id": 48943084, "body": "makes good sense. Could you provide a bit further insight on how fmap works?"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1432505887, "last_edit_date": 1432505887, "creation_date": 1432505252, "answer_id": 30428840, "question_id": 30428486, "link": "https://stackoverflow.com/questions/30428486/haskell-quickcheck-grab-and-modify-the-generated-parameters/30428840#30428840", "title": "Haskell quickCheck - grab and modify the generated parameters", "body": "<p>as JosEduSol only gave a very incomplete answer I'll try to help you out a bit more.</p>\n\n<p>First have a look at the code:</p>\n\n<pre><code>module Test where\n\nimport Test.QuickCheck\n\nnewtype OnlyUpper = OU String\n                  deriving Show\n\nencrypt :: String -&gt; String -&gt; String\nencrypt _ msg = reverse msg\n\ndecrypt :: String -&gt; String -&gt; String\ndecrypt _ msg = reverse msg\n\ntest :: OnlyUpper -&gt; OnlyUpper -&gt; Bool\ntest (OU msg) (OU key) = msg == (decrypt key . encrypt key) msg\n\nmain :: IO ()\nmain = quickCheck test\n\ninstance Arbitrary OnlyUpper where\n  arbitrary = fmap OU $ listOf $ choose ('A', 'Z')\n</code></pre>\n\n<p>as you can see I choose a very dumb implementation for <code>encrypt</code> and <code>decrpyt</code> (and I switched the arguments for convenience).</p>\n\n<p>Also I removed the error in your <code>main</code> (no need to <code>print</code>).</p>\n\n<p>The important part is: I introduced a <code>newtype OnlyUpper</code> and I made it an instance of <code>Arbitrary</code> - this way <em>QuickCheck</em> knows what to do with it (generate lists of only upper characters)</p>\n\n<p>In order for your tests to use it you now of course have to accept arguments of type <code>OnlyUpper</code> to work with (I changed your one test accordingly) - just deconstruct it on the spot (<code>(OU msg)</code>) and the rest should really be the same.</p>\n\n<p>Maybe you don't know what the <code>fmap</code> is all about here - then thing is that <code>Arbitrary</code> is a functor and <code>listOf $ choose ('A', 'Z')</code> will <em>give you</em> lists of characters between <code>'A'</code> and <code>'Z'</code> - but you have to wrap this into <code>OU</code> so you get <code>OnlyUpper</code> back (instead of <code>[Char]</code>) - that's what the <code>fmap OU</code> is doing here.</p>\n"}], "owner": {"reputation": 837, "user_id": 4072022, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b8d2b1ab1299eb31efacc0843964517?s=128&d=identicon&r=PG&f=1", "display_name": "Rumen Hristov", "link": "https://stackoverflow.com/users/4072022/rumen-hristov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 30428840, "answer_count": 1, "score": 1, "last_activity_date": 1432505887, "creation_date": 1432502679, "question_id": 30428486, "link": "https://stackoverflow.com/questions/30428486/haskell-quickcheck-grab-and-modify-the-generated-parameters", "title": "Haskell quickCheck - grab and modify the generated parameters", "body": "<p>I wrote an encryption and decryption functions with the following function types:</p>\n\n<pre><code>encrypt::[Char]-&gt;[Char]-&gt;[Char]\ndecrypt::[Char]-&gt;[Char]-&gt;[Char]\n</code></pre>\n\n<p>These functions are tested out manually and work correctly. The only thing is that they work on capital letters ONLY.</p>\n\n<p>I also wrote a test property function, which via the above 2 functions encrypts a <code>mssg</code> and decrypts its encryption. Then it compares the decryption to <code>mssg</code> to ensure that all works fine. <code>m</code> stands for mssg and <code>k</code> stands for key.</p>\n\n<pre><code>test::[Char]-&gt;[Char]-&gt;Bool\ntest [] []          = True\ntest m k            = m == (decrypt (encrypt m k) k)\n</code></pre>\n\n<p>Now I want to use quickCheck on test to randomly generate the message and key. This is for automating testing. </p>\n\n<pre><code>main = print $ quickCheck test\n</code></pre>\n\n<p>However, quickCheck will produce lower-case letters as well and I don't want that. I want to be able to modify the parameters generated by quickCheck to only include capital-letters. How can I do that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1432497998, "post_id": 30427142, "comment_id": 48940502, "body": "Note that should you succeed, your search will require O(n) bookkeeping on top of the O(log n) comparisons. Lists in Haskell are singly linked lists! If you want to play with binary search, you should probably use <code>Array</code> (<code>Data.Array</code>) or <code>Vector</code> (<code>Data.Vector</code>), or perhaps <code>Seq</code> (<code>Data.Sequence</code>)."}, {"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432499122, "post_id": 30427142, "comment_id": 48940820, "body": "Ah, thanks for the tip. Most of the beginning text only teach lists."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432516887, "post_id": 30427142, "comment_id": 48944735, "body": "Well, you can certainly write balanced search trees, tries, and other such searchable things, or of course use the ones available in various packages."}], "answers": [{"tags": [], "owner": {"reputation": 110, "user_id": 1293173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b720eb1bd00fa53f61e86900c1638d06?s=128&d=identicon&r=PG", "display_name": "DXDXY", "link": "https://stackoverflow.com/users/1293173/dxdxy"}, "is_accepted": true, "score": 3, "last_activity_date": 1432496693, "creation_date": 1432496693, "answer_id": 30427635, "question_id": 30427142, "link": "https://stackoverflow.com/questions/30427142/trying-to-implement-binary-search-in-haskell/30427635#30427635", "title": "Trying to implement binary search in haskell", "body": "<p>From what I understand about your binary search implementation, you want to get the index of a particular element in a list. Because the type signature of <code>binarySearch</code> returns <code>Maybe Int</code> where I assume Int should be the index.\nIf that's the case, I believe in the line of code:</p>\n\n<pre><code>in if (isNothing recurse) then Nothing else (Just (centerValue + (fromJust recurse)))\n</code></pre>\n\n<p>You are trying to calculate the correct index. But you are using <code>centerValue</code>, the <strong>content</strong> which is of type <code>a</code>, instead of the <strong>index</strong>, which should be of type <code>Int</code>. You probably need to define a <code>centerValueIndex</code> in addition to <code>centerValue</code>. This should solve your compilation error.</p>\n\n<p>However, I also noticed another problem in your implementation, I don't want to spoil the fun for yourself to find it, but just as a hint, the problem is in the <code>split</code> implementation.</p>\n\n<p>I myself only know very little Haskell, but hope this could help.</p>\n"}], "owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2079, "favorite_count": 1, "accepted_answer_id": 30427635, "answer_count": 1, "score": 1, "last_activity_date": 1432499481, "creation_date": 1432493685, "last_edit_date": 1432499481, "question_id": 30427142, "link": "https://stackoverflow.com/questions/30427142/trying-to-implement-binary-search-in-haskell", "title": "Trying to implement binary search in haskell", "body": "<p>I'm trying to learn haskell and implement some basic algorithms in haskell. I'm getting this type message that I don't completely understand.\nFor the code below, the function takes a value and a list and returns an index for a matching value in the list:</p>\n\n<pre><code>#!/usr/bin/env runghc\nimport Data.Maybe (isNothing, fromJust)\n\nbinarySearch :: (Ord a) =&gt; a -&gt; [a] -&gt; Maybe Int\nbinarySearch x [] = Nothing\nbinarySearch x [y] \n  | x == y = Just 0\n  | otherwise = Nothing\nbinarySearch x ys\n  | x &lt; centerValue = binarySearch x (fst splitted)\n  | x &gt;= centerValue = let recurse = binarySearch x (snd splitted) \n                         in if (isNothing recurse) then Nothing else (Just (centerValue + (fromJust recurse)))\n    where split :: (Ord a) =&gt; [a] -&gt; ([a], [a])\n          split [] = ([],[])\n          split [x] = ([x], [])\n          split x = ((take halfIndex x), (take rhalfIndex (reverse x)))\n            where myLength = length x\n                  halfIndex = myLength `div` 2\n                  rhalfIndex = myLength - halfIndex\n          splitted = split ys\n          centerValue = head (snd splitted)\n\nmain :: IO()\nmain = print(binarySearch 5 [1,2,3,4,5])\n</code></pre>\n\n<p>I get the error message:</p>\n\n<pre><code>binarySearch.hs:12:77:\n    Couldn't match expected type \u2018Int\u2019 with actual type \u2018a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for\n            binarySearch :: Ord a =&gt; a -&gt; [a] -&gt; Maybe Int\n          at binarySearch.hs:4:17\n    Relevant bindings include\n      centerValue :: a (bound at binarySearch.hs:21:11)\n      splitted :: ([a], [a]) (bound at binarySearch.hs:20:11)\n      ys :: [a] (bound at binarySearch.hs:9:16)\n      x :: a (bound at binarySearch.hs:9:14)\n      binarySearch :: a -&gt; [a] -&gt; Maybe Int\n        (bound at binarySearch.hs:5:1)\n    In the first argument of \u2018(+)\u2019, namely \u2018centerValue\u2019\n    In the first argument of \u2018Just\u2019, namely\n      \u2018(centerValue + (fromJust recurse))\u2019\n</code></pre>\n\n<p>Not sure what's going on. Does anyone know the correction I should make and why? </p>\n\n<p>Edit, the corrected code is below:</p>\n\n<pre><code>#!/usr/bin/env runghc\nimport Data.Maybe (isNothing, fromJust)\n\nsplit :: (Ord a) =&gt; [a] -&gt; ([a], [a])\nsplit [] = ([],[])\nsplit [x] = ([x], [])\nsplit x = ((take halfIndex x), (drop halfIndex x))\n  where myLength = length x\n        halfIndex = myLength `div` 2\n\nbinarySearch :: (Ord a) =&gt; a -&gt; [a] -&gt; Maybe Int\nbinarySearch x [] = Nothing\nbinarySearch x [y] \n  | x == y = Just 1\n  | otherwise = Nothing\nbinarySearch x ys\n  | x &lt; centerValue = binarySearch x (fst splitted)\n  | x &gt;= centerValue = let recurse = binarySearch x (snd splitted) \n                         in if (isNothing recurse) \n                            then Nothing \n                            else (Just (centerValueIndex + (fromJust recurse)))\n    where splitted = split ys\n          centerValue = head (snd splitted)\n          centerValueIndex = (length ys) `div` 2\n\nmain :: IO()\nmain = print(binarySearch 8 [1,2,3,4,5,8])\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "list-comprehension", "fibonacci"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432492645, "post_id": 30426720, "comment_id": 48938904, "body": "for the example online part - I think you did not look to badly - it&#39;s the first one here: <a href=\"https://www.google.de/#q=haskell+fib\" rel=\"nofollow noreferrer\">google.de/#q=haskell+fib</a> :D"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432492449, "post_id": 30426887, "comment_id": 48938837, "body": "best <i>tutorial</i> I&#39;ve seen so far! - this deserves a lot of upvotes :D - thanks man - I enjoyed it"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 8, "last_activity_date": 1432492184, "creation_date": 1432492184, "answer_id": 30426887, "question_id": 30426720, "link": "https://stackoverflow.com/questions/30426720/defining-an-infinite-sequence-of-fibonacci-numbers-using-list-comprehension-in-h/30426887#30426887", "title": "Defining an infinite sequence of Fibonacci numbers using list comprehension in Haskell", "body": "<p>Here's a hint.</p>\n\n<p>Take the sequence of powers of two.</p>\n\n<pre><code>p2 = [1, 2, 4, 8, 16 ...\n</code></pre>\n\n<p><code>zip</code> it with itself</p>\n\n<pre><code>zip p2 p2 = [(1,1), (2,2), (4,4), ...]\n</code></pre>\n\n<p>Sum every pair in the list (this can be done using a list comprehension)</p>\n\n<pre><code>[2, 4, 8, ...\n</code></pre>\n\n<p>Prepend <code>1</code>:</p>\n\n<pre><code>[1, 2, 4, 8, ...\n</code></pre>\n\n<p>So we got the <code>p2</code> list again. If you express all of this in Haskell, you end up with some code of the form</p>\n\n<pre><code>p2 = 1 : ... something involving p2 ...\n</code></pre>\n\n<p>which is a working program generating the powers of two.</p>\n\n<p>Once you get this working, you can change it <em>slightly</em> and obtain Fibonacci as well.</p>\n\n<p>For the last point: yes, printing <code>p2</code> will print the whole infinite sequence. You can print just a few elements using</p>\n\n<pre><code>take 10 p2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1432493379, "last_edit_date": 1432493379, "creation_date": 1432492967, "answer_id": 30427029, "question_id": 30426720, "link": "https://stackoverflow.com/questions/30426720/defining-an-infinite-sequence-of-fibonacci-numbers-using-list-comprehension-in-h/30427029#30427029", "title": "Defining an infinite sequence of Fibonacci numbers using list comprehension in Haskell", "body": "<p>here is another one <strong>chi</strong> style (I hope you don't mind):</p>\n\n<p>write the fibs:</p>\n\n<pre><code>fibs = 1 1 2 3 5 8 13 ...\n</code></pre>\n\n<p>write it again but shift one left:</p>\n\n<pre><code>fibs       = 1 1 2 3 5 8 13 ...\n(??? fibs) = 1 2 3 5 8 13 ...\n</code></pre>\n\n<p>add them:</p>\n\n<pre><code>fibs       = 1 1 2 3 5 8 13 ...\n(??? fibs) = 1 2 3 5 8 13 ...\n--------------------\n(+ em)     = 2 3 5 8 13 21 ...\n</code></pre>\n\n<p>looks familiar?</p>\n\n<p>Now you only have to prepend something (again) and think about what <em>shift left</em>  means here (<em>hint</em> you mentioned it):</p>\n\n<pre><code>fibs       = 1 1 2 3 5 8 13 ...\n(??? fibs) = 1 2 3 5 8 13 ...\n--------------------\n(+ em)     = 2 3 5 8 13 21 ...\n=&gt; fibs = ? : ((+ em) fibs (??? fibs))\n</code></pre>\n\n<p>Also summing up can be done nicely with <code>zipWith (+)</code></p>\n\n<p>Have fun    </p>\n"}], "owner": {"reputation": 536, "user_id": 4364070, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/70921bd2321275b2bbf42fa255aa82fe?s=128&d=identicon&r=PG&f=1", "display_name": "eyes enberg", "link": "https://stackoverflow.com/users/4364070/eyes-enberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1432493379, "creation_date": 1432491075, "question_id": 30426720, "link": "https://stackoverflow.com/questions/30426720/defining-an-infinite-sequence-of-fibonacci-numbers-using-list-comprehension-in-h", "title": "Defining an infinite sequence of Fibonacci numbers using list comprehension in Haskell", "body": "<p>How would I do this? It's part of an exercise in my lecture slides and the hints are to use the library functions <code>tail :: [a] -&gt; [a]</code> and <code>zip :: [a] -&gt; [b] -&gt; [(a,b)]</code>. Also, the type of the function is <code>fibs :: [Integer]</code></p>\n\n<p>I know how list comprehension works, how to write a recursive Fibonacci function that takes in a value and am familiar with both the tail and zip functions - however, I just can't figure this one out and haven't been able to find an example online. Can anybody show me how its done? </p>\n\n<p>Also out of curiosity, how are functions like this (that produce an infinite list) used in Haskell? If I write <code>fibs</code> (the function name) in the ghci command prompt for example will it continue to print the elements in the list until the end of time? </p>\n\n<p>Thanks in advance for any help.  </p>\n"}, {"tags": ["haskell", "lazy-evaluation", "strict"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432490015, "post_id": 30426490, "comment_id": 48938078, "body": "well to all those questions: <b>it depends</b> - yeah that is lame I know - but you should really get a bit more concrete - let&#39;s take the comment you made about `seq&#39; for a moment: this will only evaluate to WHNF so maybe you will not gain to much, ... - sorry but this question is just to broad to give a really good answer - at least in my opinion :( - that is why <i>I would</i> just ignore this stuff until you run into trouble - <i>then</i> look what is causing it and act accordingly - <i>btw</i>: that is one reason why you don&#39;t use accumulators as much as in strict languages ;)"}, {"owner": {"reputation": 21, "user_id": 4934556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d982bbdeba56e2e6ee218d88fc7a66f7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg", "link": "https://stackoverflow.com/users/4934556/reg"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432490196, "post_id": 30426490, "comment_id": 48938139, "body": "I know that it will evaluate to WHNF but I am using only strict data structures. I know that premature optimization is bad but I want to know from a theoretical point of view, whether there is any problem that I would face."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432491598, "post_id": 30426490, "comment_id": 48938547, "body": "You may end up using less memory (e.g. avoid thunk accumulation, as in your example) or more memory e.g. <code>foldl&#39; (+) 0 $ map (+1) [1..1000]</code> allocates 2000 list cells in a strict implementation (unless some optimization kicks in, of course). In an unoptimized lazy implementation we still have 2000 cells but they can be garbage collected earlier, so that at any time only a constant time of them are in memory."}, {"owner": {"reputation": 21, "user_id": 4934556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d982bbdeba56e2e6ee218d88fc7a66f7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg", "link": "https://stackoverflow.com/users/4934556/reg"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432498172, "post_id": 30426490, "comment_id": 48940545, "body": "@chi, true, laziness does give an advantage depending on the situation. But nothing breaks by adding strictness to all my functions and data types, assuming that my algorithm does not rely on laziness? I am no worse off than what I would be if Haskell were strict by default?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432499115, "post_id": 30426490, "comment_id": 48940819, "body": "If everything is strict I believe you should get a comparable performance to strict languages such as F# or Ocaml. I&#39;d guess it will be a bit slower than these since the runtime is not optimized for that case. But the runtime is quite different and fairly complex -- I do not know it in depth so I can not really tell."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4934556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d982bbdeba56e2e6ee218d88fc7a66f7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg", "link": "https://stackoverflow.com/users/4934556/reg"}, "edited": false, "score": 0, "creation_date": 1432529712, "post_id": 30430624, "comment_id": 48947129, "body": "&quot;Not everything necessarily becomes lazy when you use strict data structures in your language:&quot; Did you mean that not everything necessarily becomes <i>strict</i>?"}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 21, "user_id": 4934556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d982bbdeba56e2e6ee218d88fc7a66f7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg", "link": "https://stackoverflow.com/users/4934556/reg"}, "edited": false, "score": 0, "creation_date": 1432535464, "post_id": 30430624, "comment_id": 48948913, "body": "@Reg: indeed, that was wrong and I&#39;ve corrected it."}, {"owner": {"reputation": 21, "user_id": 4934556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d982bbdeba56e2e6ee218d88fc7a66f7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg", "link": "https://stackoverflow.com/users/4934556/reg"}, "edited": false, "score": 0, "creation_date": 1432548442, "post_id": 30430624, "comment_id": 48954913, "body": "Laziness is useful indeed, and personally I like the fact that Haskell is lazy by default because turning off laziness seems to be at worst a minor inconvenience. It seems that many of the criticisms against Haskell&#39;s lazy by default choice, is really about mixing laziness with strictness, which would be a problem even in a strict by default language where one turned on laziness, like if one is using a spine strict list. Otherwise there are various levels of guards against space leaks that one could choose from like strictifying everything, to only data structures, to only what is needed."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 3, "last_activity_date": 1432535405, "last_edit_date": 1432535405, "creation_date": 1432522594, "answer_id": 30430624, "question_id": 30426490, "link": "https://stackoverflow.com/questions/30426490/problems-with-enforcing-strictness-in-haskell/30430624#30430624", "title": "Problems with enforcing strictness in haskell", "body": "<h1>Laziness speeding things up</h1>\n\n<p>You <em>could</em> be worse off. The naive definition of <code>++</code> is:</p>\n\n<pre><code>xs ++ ys = case xs of (x:xs) -&gt; x : (xs ++ ys)\n                      []     -&gt; ys\n</code></pre>\n\n<p>Laziness makes this O(1), though it may also add O(1) processing to extract the cons. Without laziness, the <code>++</code> needs to be evaluated immediately causing an O(n) operation. (If you've never seen the O(.) notation, it is something computer science has stolen from engineers: given a function <code>f</code> the set <code>O( f(n) )</code> is the set of all algorithms which are <em>eventually at-worst-proportional</em> to <code>f(n)</code>, where <code>n</code> is the number of bits of input fed to the function. [Formally, there exists a <code>k</code> and <code>N</code> such that for all <code>n &gt; N</code> the algorithm takes time less than <code>k * f(n)</code>.] So I'm saying that laziness makes the above operation <code>O(1)</code> or <em>eventually constant-time</em>, but adds a constant overhead to each extraction, whereas strictness makes the operation <code>O(n)</code> or <em>eventually linear in the number of list elements</em>, assuming that those elements have a fixed size.</p>\n\n<p>There are some practical examples here but the O(1) added processing time can potentially also \"stack up\" into an O(n) dependency, so the most obvious examples are O(n<sup>2</sup>) both ways. Still there can be a difference in these examples. For example, one situation that doesn't work well is using a stack (last-in first-out, which is the style of Haskell lists) for a queue (first-in first-out).</p>\n\n<p>So here's a quick library consisting of strict left-folds; I've used case statements so that each line can be pasted into GHCi (with a <code>let</code>):</p>\n\n<pre><code>data SL a = Nil | Cons a !(SL a) deriving (Ord, Eq, Show)\nslfoldl' f acc xs = case xs of Nil -&gt; acc; Cons x xs' -&gt; let acc' = f acc x in acc' `seq` slfoldl' f acc' xs'\nfoldl' f acc xs = case xs of [] -&gt; acc; x : xs' -&gt; let acc' = f acc x in acc' `seq` foldl' f acc' xs'\nslappend xs ys = case xs of Nil -&gt; ys; Cons x xs' -&gt; Cons x (slappend xs' ys)\nsl_test n = foldr Cons Nil [1..n]\ntest n = [1..n]\nsl_enqueue xs x = slappend xs (Cons x Nil)\nsl_queue = slfoldl' sl_enqueue Nil\nenqueue xs x = xs ++ [x]\nqueue = foldl' enqueue []\n</code></pre>\n\n<p>The trick here is that both <code>queue</code> and <code>sl_queue</code> follow the <code>xs ++ [x]</code> pattern to append an element to the end of the list, which takes a list and builds up an exact copy of that list. GHCi can then run some simple tests. First we make two items and force their thunks to prove that this operation itself is quite fast and not <em>too</em> prohibitively expensive in memory:</p>\n\n<pre><code>*Main&gt; :set +s\n*Main&gt; let vec = test 10000; slvec = sl_test 10000\n(0.02 secs, 0 bytes)\n*Main&gt; [foldl' (+) 0 vec, slfoldl' (+) 0 slvec]\n[50005000,50005000]\n(0.02 secs, 8604632 bytes)\n</code></pre>\n\n<p>Now we do the actual tests: summing the queue-versions:</p>\n\n<pre><code>*Main&gt; slfoldl' (+) 0 $ sl_queue slvec\n50005000\n(22.67 secs, 13427484144 bytes)\n*Main&gt; foldl' (+) 0 $ queue vec\n50005000\n(1.90 secs, 4442813784 bytes)\n</code></pre>\n\n<p>Notice that both of these <em>suck</em> in terms of memory-performance (the list-append stuff is still secretly O(n<sup>2</sup>)) where they eventually occupy gigabytes of space, but the strict version nevertheless occupies three times the space and takes ten times the time.</p>\n\n<h1>Sometimes the data structures should be changed</h1>\n\n<p>If you really want a strict queue, there are a couple options. One is finger trees as in <code>Data.Sequence</code> -- the <code>viewr</code> way they do things is a little complicated but works to get the rightmost elements. However that is a bit heavy and one common solution is O(1) amortized: define the structure</p>\n\n<pre><code>data Queue x = Queue !(SL x) !(SL x)\n</code></pre>\n\n<p>where the <code>SL</code> terms are the strict stacks above. Define a strict <code>reverse</code>, let's call it <code>slreverse</code>, the obvious way, then consider:</p>\n\n<pre><code>enqueue :: Queue x -&gt; x -&gt; Queue x\nenqueue (Queue xs ys) el = Queue xs (Cons el ys)\n\ndequeue :: Queue x -&gt; Maybe (x, Queue x)\ndequeue (Queue Nil Nil) = Nothing\ndequeue (Queue Nil (Cons x xs)) = Just (x, Queue (slreverse xs) Nil)\ndequeue (Queue (Cons x xs ys)) = Just (x, Queue xs ys)\n</code></pre>\n\n<p>This is \"amortized O(1)\": each time that a <code>dequeue</code> reverses the list, costing O(k) steps for some <code>k</code>, we ensure that we are creating a structure which won't have to pay these costs for <code>k</code> more steps.</p>\n\n<h1>Laziness hides errors</h1>\n\n<p>Another interesting point comes from the data/codata distinction, where data are finite structures traversed by recursion on subunits (that is, every data expression halts) while codata are the rest of the structures -- strict lists vs. streams. It turns out that when you properly make this distinction, there is <em>no formal difference</em> between strict data and lazy data -- the only formal difference between strict and lazy is how they handle terms within themselves which loop infinitely: strict will explore the loop and hence will also loop infinitely, while lazy will simply hand the infinite-loop onwards without descending into it.</p>\n\n<p>As such you will find that <code>x = slhead (Cons x undefined)</code> will fail where <code>head (x : undefined)</code> succeeds. So you may \"uncover\" hidden infinite loops or bugs when you do this. </p>\n\n<h1>Caution when making \"everything strict\"</h1>\n\n<p>Not everything necessarily becomes strict when you use strict data structures in your language: notice that I made a point above to define strict <code>foldl</code>, not <code>foldl</code>, for both lists and strict-lists. Common data structures in Haskell will be lazy -- lists, tuples, stuff in popular libraries -- and explicit calls to <code>seq</code> still help when building up a complicated expression.</p>\n"}], "owner": {"reputation": 21, "user_id": 4934556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d982bbdeba56e2e6ee218d88fc7a66f7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg", "link": "https://stackoverflow.com/users/4934556/reg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432535405, "creation_date": 1432489797, "question_id": 30426490, "link": "https://stackoverflow.com/questions/30426490/problems-with-enforcing-strictness-in-haskell", "title": "Problems with enforcing strictness in haskell", "body": "<p>If want to pretend that Haskell is strict and I have an algorithm in mind that does <em>not</em> exploit laziness (so for instance it does not use infinite lists), what problems can occur if I used only strict data types and annotated any function that I use, to be strict in its arguments? Will there be a performance penalty, if so how bad; can worse problems occur? I know it is dirty, pointless and ugly to mindlessly make every function and data type strict, and I do not intend to do so in practice but I only want to understand if by doing so, Haskell becomes strict by default?</p>\n\n<p>Secondly, if I tone down the paranoia, and only make the data structures strict: will I have to worry about space leaks <em>brought about by a lazy implementation</em> only when I am using some form of accumulation? In other words, assume that the algorithm would not exhibit a space leak in a strict language. Also assume that I implemented it in Haskell using <em>only</em> strict data structures, but was careful to use seq to evaluate any variable that was being passed on in a recursion, or used functions which internally are careful to do that (like fold'), would I avoid any space leaks? Remember that I am assuming that in a strict language, the same algorithm does not lead to a space leak. So it is a question about the implementation difference between lazy and strict. </p>\n\n<p>The reason I ask the second question is because apart from cases where one is trying to take advantage of laziness by using a lazy data structure, or a spine strict one, all the examples of space leaks that I have seen until now, only involve thunks developing in an accumulator because it was not the function that was recursively called did not evaluate the accumulator before applying itself on it. I am aware that if one wants to take advantage of laziness then one has to be extra careful, but that caution would be needed in a strict by default language too. </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1432483658, "post_id": 30424964, "comment_id": 48936236, "body": "The final <code>&gt;&gt;= \\y -&gt; return y</code> can be omitted, according to the monad laws."}], "tags": [], "owner": {"reputation": 24942, "user_id": 688653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/978a9f5060338657ddeb3781c6a3a2c8?s=128&d=identicon&r=PG", "display_name": "zw324", "link": "https://stackoverflow.com/users/688653/zw324"}, "is_accepted": false, "score": 2, "last_activity_date": 1432479982, "creation_date": 1432479982, "answer_id": 30424964, "question_id": 30424870, "link": "https://stackoverflow.com/questions/30424870/haskell-monad-return-list/30424964#30424964", "title": "Haskell: Monad return list", "body": "<p>Let's desugar first:</p>\n\n<pre><code>f 0 = []\nf n = [0 .. 4] &gt;&gt;= \\x -&gt; x : (f (n - 1)) &gt;&gt;= \\y -&gt; return y\n</code></pre>\n\n<p>Note</p>\n\n<pre><code>xs &gt;&gt;= f = concat (map f xs)\n</code></pre>\n\n<p><code>[0..4] &gt;&gt;= \\x -&gt; x : (f (n - 1))</code> will simply return <code>[0..4]</code> when n is 1. However, it need to be <code>[[0], [1], [2], [3], [4]]</code>, </p>\n\n<p>Thus, the following will do:</p>\n\n<pre><code>f 0 = [[]]\nf n = [0 .. 4] &gt;&gt;= \\x -&gt; map (x:) (f (n - 1)) &gt;&gt;= \\y -&gt; return y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "is_accepted": false, "score": 3, "last_activity_date": 1432753513, "last_edit_date": 1432753513, "creation_date": 1432484077, "answer_id": 30425621, "question_id": 30424870, "link": "https://stackoverflow.com/questions/30424870/haskell-monad-return-list/30425621#30425621", "title": "Haskell: Monad return list", "body": "<p>So you want the elements of your final list to be lists themselves ?</p>\n\n<p>In the List monad, each <code>&lt;-</code> remove one enclosing from the type, in other words : </p>\n\n<p><code>(x :: a) &lt;- (xs :: [a])</code></p>\n\n<p>So it is clear that <code>x :: Int</code> in your code. And you wish for your function to return <code>[[Int]]</code> so what should be the type of <code>x:(f (n-1))</code> ? You see that this expression shouldn't typecheck if <code>f</code> type was correct so there is your problem : you don't want to cons <code>x</code> to the result of <code>f (n-1)</code> but to each of the results of <code>f (n-1)</code> thus :</p>\n\n<pre><code>f n = do\n  x &lt;- [0..4]\n  xs &lt;- f (n-1)\n  return (x : xs)\n</code></pre>\n\n<p>If you try this you should see it doesn't work, this is because your <code>f 0</code> should contain one possibility : </p>\n\n<pre><code>f 0 = return [] -- or [[]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1432490943, "creation_date": 1432490943, "answer_id": 30426690, "question_id": 30424870, "link": "https://stackoverflow.com/questions/30424870/haskell-monad-return-list/30426690#30426690", "title": "Haskell: Monad return list", "body": "<p>Others have already answered, but you may wish to know there's already a function like yours in the standard library:</p>\n\n<pre><code>&gt; import Control.Monad\n&gt; replicateM 3 [0..4]\n[[0,0,0],[0,0,1],[0,0,2],[0,0,3],[0,0,4],[0,1,0],[0,1,1], ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1443156142, "post_id": 32773883, "comment_id": 53388460, "body": "What does this add to chi&#39;s answer?"}], "tags": [], "owner": {"reputation": 861, "user_id": 2252692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5e66f8452f2a583e6901fbabaff5d2a6?s=128&d=identicon&r=PG", "display_name": "wshcdr", "link": "https://stackoverflow.com/users/2252692/wshcdr"}, "is_accepted": false, "score": 0, "last_activity_date": 1443148324, "creation_date": 1443148324, "answer_id": 32773883, "question_id": 30424870, "link": "https://stackoverflow.com/questions/30424870/haskell-monad-return-list/32773883#32773883", "title": "Haskell: Monad return list", "body": "<pre><code>cross = do\nx &lt;- [0..4]\ny &lt;- [0..4]\nz &lt;- [0..4]\nreturn [x,y,z]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4934238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41d1febcaa9f4c5b215781d0d231174f?s=128&d=identicon&r=PG&f=1", "display_name": "dominik", "link": "https://stackoverflow.com/users/4934238/dominik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1443148324, "creation_date": 1432479356, "last_edit_date": 1432479441, "question_id": 30424870, "link": "https://stackoverflow.com/questions/30424870/haskell-monad-return-list", "title": "Haskell: Monad return list", "body": "<p>I'm trying to write some code in Haskell and there is problem that i can't solve</p>\n\n<pre><code>f 0 = []\nf n = do\n    x &lt;- [0..4]\n    y &lt;- x:(f (n-1))\n    return y\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>[0,0,0,1,2,3,4,1,0,1,2,3,4,2,0,1,2,3,4,3,0,1,2,3,4,4,0,1,2,3,4,1,0,0,1,2,3,4,1,0,1,2,3,4,2,0,1,2,3,4,3,0,1,2,3,4,4,0,1,2,3,4,2,0,0,1,2,3,4,1,0,1,2,3,4,2,0,1,2,3,4,3,0,1,2,3,4,4,0,1,2,3,4,3,0,0,1,2,3,4,1,0,1,2,3,4,2,0,1,2,3,4,3,0,1,2,3,4,4,0,1,2,3,4,4,0,0,1,2,3,4,1,0,1,2,3,4,2,0,1,2,3,4,3,0,1,2,3,4,4,0,1,2,3,4]\n</code></pre>\n\n<p>but I need it to be:</p>\n\n<pre><code>[[0,0,0],[0,0,1],[0,0,2],[0,0,3],[0,0,4],[0,1,0],[0,1,1]...\n</code></pre>\n\n<p>Any ideas? </p>\n"}, {"tags": ["haskell", "integer", "int", "type-conversion", "tuples"], "answers": [{"tags": [], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "is_accepted": false, "score": 0, "last_activity_date": 1432478060, "creation_date": 1432478060, "answer_id": 30424665, "question_id": 30424020, "link": "https://stackoverflow.com/questions/30424020/haskell-length-tointeger-conversion/30424665#30424665", "title": "Haskell length toInteger Conversion", "body": "<p>I have found it:</p>\n\n<pre><code>maxCollatz :: (Integer, Integer)\nmaxCollatz = (head $ maximum (map collatzList [1..500]), toInteger $ length $ maximum (map collatzList [1..500]))\n</code></pre>\n\n<p>Just add <code>toInteger $</code> before length.</p>\n"}, {"tags": [], "owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "is_accepted": true, "score": 0, "last_activity_date": 1432482806, "creation_date": 1432482806, "answer_id": 30425427, "question_id": 30424020, "link": "https://stackoverflow.com/questions/30424020/haskell-length-tointeger-conversion/30425427#30425427", "title": "Haskell length toInteger Conversion", "body": "<p>There are two problems : first your code doesn't do what you think it does, second just converting the length to an integer is completely useless...</p>\n\n<p>1) Your code is erroneous since <code>maximum</code> doesn't select the longest list. <code>maximum</code> works with <code>Ord</code> instances and select the greatest according to the <code>compare</code> method for this type. For Int and Integer, the order may be obvious but for lists it is not so. The traditional way to order list is the lexicographic order (which is used in dictionaries if you consider words to be list of characters) : \"[] &lt; y:_\" and \"x:xs &lt; y:ys\" iff x &lt; y or (x == y and xs &lt; ys).</p>\n\n<p>So your code will simply give you the collatzList that start with the biggest number, that is <code>[500, 250, ...]</code>.</p>\n\n<p>2) Converting your length to <code>Integer</code> is nice but it's too late : if it was computed with an <code>Int</code>, it won't restore the correct value, a list of length <code>(maxBound :: Int) + 1</code> will get a computed length of <code>(minBound :: Int)</code> then this <code>Int</code> will be converted to an <code>Integer</code> of the same value...</p>\n\n<p>What you want is to compute the length directly with <code>Integer</code>s which you can do with <code>Data.List.genericLength</code>.</p>\n\n<hr>\n\n<p>That said, you really don't need to use <code>Integer</code>, especially if you're on a 64-bit GHC (very likely, check with <code>ghc -e \"maxBound :: Int\"</code> on the CLI). Collatz won't go over a 64-bit <code>Int</code> for reasonable starting numbers.</p>\n\n<p>As for <code>maximum</code>, I suggest you investigate <code>maximumBy</code>, <code>comparing</code> and <code>zip</code> to get code that do what you want.</p>\n"}], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 30425427, "answer_count": 2, "score": 0, "last_activity_date": 1432482806, "creation_date": 1432474011, "question_id": 30424020, "link": "https://stackoverflow.com/questions/30424020/haskell-length-tointeger-conversion", "title": "Haskell length toInteger Conversion", "body": "<p>I have the following pair of Integers:</p>\n\n<pre><code>maxCollatz :: (Integer, Integer)\nmaxCollatz = (head $ maximum (map collatzList [1..500]), length $ maximum (map collatzList [1..500]))\n</code></pre>\n\n<p>Since I am a newbie, I don't know how to use either <code>fromIntegral</code> or <code>toInteger</code> to convert <code>length</code> to Integer. I know that length must be finite, but since the range of the \"function\" can be quite big, I am inclined to use <code>(Integer, Integer)</code>. </p>\n\n<p>Again, my question is - how to convert <code>length</code> to <code>Integer</code> from <code>Int</code> using <code>fromIntegral</code> or <code>toInteger</code>?</p>\n"}, {"tags": ["haskell", "hunit"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 0, "last_activity_date": 1460021429, "creation_date": 1460021429, "answer_id": 36472041, "question_id": 30423610, "link": "https://stackoverflow.com/questions/30423610/comparison-for-text-xml-light-element-in-test/36472041#36472041", "title": "Comparison for Text.XML.Light.Element in test", "body": "<p>You can avoid orphan instances by writing your own equality predicate:</p>\n\n<pre><code>equalElement :: XML.Element -&gt; XML.Element -&gt; Bool\nequalElement = ...\n</code></pre>\n\n<p>and then using it via <code>assertBool</code> instead of <code>assertEqual</code>:</p>\n\n<pre><code>assertBool \"create an element\" $ equalElement expectedElement (createElement tg txt)\n</code></pre>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 36472041, "answer_count": 1, "score": 1, "last_activity_date": 1460021429, "creation_date": 1432471324, "last_edit_date": 1460021424, "question_id": 30423610, "link": "https://stackoverflow.com/questions/30423610/comparison-for-text-xml-light-element-in-test", "title": "Comparison for Text.XML.Light.Element in test", "body": "<p>I am trying to write a simple <code>hunit-test</code> to verify how a <code>Text.XML.Light.Element</code> is created from a function.</p>\n\n<p>The function is:</p>\n\n<pre><code>createElement :: String -&gt; String -&gt; XML.Element\ncreateElement tg txt =\n blank_element{ elName = qualName tg\n          , elContent = [ Text blank_cdata { cdData = txt } ]\n          }\n</code></pre>\n\n<p>and my test is simply:</p>\n\n<pre><code>import Test.Framework (defaultMain)\nimport Test.Framework.Providers.HUnit (testCase)\nimport Test.HUnit (Assertion, assertEqual)\nimport Text.XML.Light as XML\nimport MyModule.MyCode (createElement)\n\ntestCreateElement :: Assertion\ntestCreateElement = do\n    let tg = \"item\"\n    let txt = \"example of text\"\n    let expectedElement = XML.Element {\n                           elName = XML.QName{ qName = tg, qURI = Nothing, qPrefix = Nothing }\n                           , elAttribs = [] :: [ Attr ]\n                           , elContent = [ fromString txt ] :: [ Content ]\n                           , elLine = Nothing\n                           }\n    assertEqual \"create an element\" expectedElement (createElement tg txt)\n\n-- utils\n\nfromString :: String -&gt; Content\nfromString txt = Text blank_cdata { cdData = txt }\n</code></pre>\n\n<p>What I get is this error:</p>\n\n<pre><code>No instance for (Eq Element) arising from a use of \u2018assertEqual\u2019\n    In a stmt of a 'do' block:\n      assertEqual \"create an element\" expectedElement (xmlElement tg txt)\n    In the expression:....\n</code></pre>\n\n<p>I have checked in the source code of <code>Text.XML.Light</code> and it looks like there is no <code>Eq</code> instance defined for <code>Element</code>.\nHow can I make the test work?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432472499, "post_id": 30423756, "comment_id": 48932896, "body": "It solved the binding error but now it says it has a parse error on the arrows of the case sentences"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1432472274, "creation_date": 1432472274, "answer_id": 30423756, "question_id": 30423578, "link": "https://stackoverflow.com/questions/30423578/the-type-signature-for-effect-lacks-an-accompanying-binding/30423756#30423756", "title": "The type signature for &quot;effect&quot; lacks an accompanying binding", "body": "<p>In <code>do</code> blocks, <code>let</code> defines but does not run IO actions. You want something like</p>\n\n<pre><code>effect :: IO [Char]\neffect = do\n  cardNo &lt;- drawSpecialCard\n  return $ case cardNo of\n      ...\n</code></pre>\n\n<p>Note that <code>effect</code> must return <code>IO</code> as well.</p>\n"}], "owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432472274, "creation_date": 1432471106, "question_id": 30423578, "link": "https://stackoverflow.com/questions/30423578/the-type-signature-for-effect-lacks-an-accompanying-binding", "title": "The type signature for &quot;effect&quot; lacks an accompanying binding", "body": "<p>I am having trouble wrapping my head around my function. It calls a function \"drawSpecialCard\" that returns a random number. Now, I've read about this error and I know its a problem of something being unimplemented but i have no idea what to do. Im not very bright when it comes to Haskell.</p>\n\n<pre><code>import System.Random\n\ndrawSpecialCard :: IO Int\ndrawSpecialCard = randomRIO(1,16)\n\neffect :: [Char]\neffect = do\nlet cardNo = drawSpecialCard\n return $ case cardNo of\n               1 -&gt; \"Pay\"\n               2 -&gt; \"ToJail\"\n               3 -&gt; \"Collect\"\n               4 -&gt; \"GoBack\"    \n               5 -&gt; \"moveOn\"    \n</code></pre>\n"}, {"tags": ["function", "haskell", "declaration", "definition"], "answers": [{"tags": [], "owner": {"reputation": 10108, "user_id": 450811, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b1a81486c967643c2f05cddb94841d27?s=128&d=identicon&r=PG", "display_name": "Waldheinz", "link": "https://stackoverflow.com/users/450811/waldheinz"}, "is_accepted": false, "score": 0, "last_activity_date": 1432466201, "creation_date": 1432466201, "answer_id": 30422885, "question_id": 30422867, "link": "https://stackoverflow.com/questions/30422867/haskell-function-definition-without/30422885#30422885", "title": "Haskell Function Definition without -&gt;", "body": "<p>This function does not take any arguments, hence it's just a constant tuple (or pair) of two Integers.</p>\n"}, {"tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 0, "last_activity_date": 1432466227, "creation_date": 1432466227, "answer_id": 30422888, "question_id": 30422867, "link": "https://stackoverflow.com/questions/30422867/haskell-function-definition-without/30422888#30422888", "title": "Haskell Function Definition without -&gt;", "body": "<p>This is a function signature, not a whole function definition. </p>\n\n<p>And this is a constant, not a \"true function\" (I've seen it debated). It returns a tuple of 2 integers, but doesn't take anything. </p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432473357, "post_id": 30422920, "comment_id": 48933160, "body": "Based on its name, I think it is either a pair of integers or \u22a5, and that no one knows which."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 8, "last_activity_date": 1432505061, "last_edit_date": 1432505061, "creation_date": 1432466456, "answer_id": 30422920, "question_id": 30422867, "link": "https://stackoverflow.com/questions/30422867/haskell-function-definition-without/30422920#30422920", "title": "Haskell Function Definition without -&gt;", "body": "<p><code>maxCollatz</code> is a pair of integers <code>(Integer, Integer)</code>. It's not a function, it takes no arguments, and isn't called to produce anything; it just <em>is</em> a pair of integers.</p>\n\n<p>The syntax for declaring the types of and then implementing top level declarations in Haskell is syntax for defining values. Functions are values, so they're included in that, but so is everything else.</p>\n"}, {"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1432488064, "post_id": 30424078, "comment_id": 48937435, "body": "<code>maxCollatz</code> is a pair of <code>Integer</code>s, not a function. A function in Haskell always takes exactly one argument, so there are no 0 arity functions: <a href=\"http://conal.net/blog/posts/everything-is-a-function-in-haskell\" rel=\"nofollow noreferrer\">conal.net/blog/posts/everything-is-a-function-in-haskell</a>"}], "tags": [], "owner": {"reputation": 1422, "user_id": 3179747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf7fbd47419df571480f649e0b9c4b0?s=128&d=identicon&r=PG&f=1", "display_name": "ankh-morpork", "link": "https://stackoverflow.com/users/3179747/ankh-morpork"}, "is_accepted": false, "score": 1, "last_activity_date": 1432474337, "creation_date": 1432474337, "answer_id": 30424078, "question_id": 30422867, "link": "https://stackoverflow.com/questions/30422867/haskell-function-definition-without/30424078#30424078", "title": "Haskell Function Definition without -&gt;", "body": "<p>The line of code is a valid function signature because it is important to understand that a function does not have to take any arguments. </p>\n\n<p>The number of arguments a function takes is referred to as its <a href=\"http://en.wikipedia.org/wiki/Arity\" rel=\"nofollow\">arity.</a></p>\n\n<blockquote>\n  <p>In logic, mathematics, and computer science, the arity of a function or operation is the number of arguments or operands the function or operation accepts.</p>\n</blockquote>\n\n<p>In this case, the function takes 0 arguments and is arity 0. A function with arity 0 is often referred to as a constant or nullary function.</p>\n\n<hr>\n\n<p>In Python a similar function would look like this</p>\n\n<pre><code>def pair():\n    return (1,1)\n</code></pre>\n\n<p>If you are familiar with Python it is clear that this function takes no arguments and returns a pair of numbers. This is exactly what the function signature you provided describes. </p>\n"}], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 30422920, "answer_count": 4, "score": 4, "last_activity_date": 1432505061, "creation_date": 1432466065, "question_id": 30422867, "link": "https://stackoverflow.com/questions/30422867/haskell-function-definition-without", "title": "Haskell Function Definition without -&gt;", "body": "<p>What the following function definition / declaration means:</p>\n\n<pre><code>maxCollatz :: (Integer, Integer)\n</code></pre>\n\n<p>I am confused, because I am not sure what arguments takes and therefore what produces. Because normally there is <code>-&gt;</code> in the function definition. E. g. <code>Int -&gt; Int</code>. </p>\n\n<p>P.S. Again sorry for this type of questions.</p>\n"}, {"tags": ["linux", "haskell", "unicode", "encoding", "utf-8"], "comments": [{"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1432459291, "post_id": 30421845, "comment_id": 48929475, "body": "Give <code>hSetEncoding</code> a try... <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/System-IO.html#v:hSetEncoding\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1432464726, "post_id": 30421845, "comment_id": 48930843, "body": "@Arnon the problem is that I have no access to <code>stFile</code> quoter&#39;s handle, because read operation is internal. Maybe there is a way set default encoding for all handles?"}, {"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1432464793, "post_id": 30421845, "comment_id": 48930864, "body": "Not that I know of, without setting it in the environment for the entire OS, which you claim you&#39;ve already tried....."}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1432466050, "post_id": 30421845, "comment_id": 48931201, "body": "@Arnon I&#39;ve built GHC from sources in that environment, so maybe I need to rebuilt GHC now with new locales?"}, {"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1432467051, "post_id": 30421845, "comment_id": 48931478, "body": "I don&#39;t think that&#39;d make a big difference"}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1432487244, "post_id": 30421845, "comment_id": 48937197, "body": "@Arnon yep, you are right, this was not helpful. BTW, I&#39;ve tried <code>hSetEncoding</code> and it works."}], "answers": [{"tags": [], "owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "is_accepted": true, "score": 7, "last_activity_date": 1566066180, "last_edit_date": 1566066180, "creation_date": 1432551041, "answer_id": 30436634, "question_id": 30421845, "link": "https://stackoverflow.com/questions/30421845/haskell-quotefile-fails-on-text-file-with-invalid-byte-sequence-on-unicode-ch/30436634#30436634", "title": "Haskell: quoteFile fails on text file with &quot;invalid byte sequence&quot; on unicode characters", "body": "<p>Finally, I've found that my virtual locale was not properly set, e.g. <code>locale</code> command showed me that all <code>LANG</code> variables are set to <code>POSIX</code>.</p>\n\n<p>Exporting <code>LANG</code> variable to command is the quickest workaround (<strong>bash</strong> example):</p>\n\n<pre><code>export LANG=en_US.UTF8 cabal build\n</code></pre>\n\n<p>However, likely you need to have <code>en_US</code> locale installed, Debian manual configuration is:</p>\n\n<ol>\n<li>edit the file <code>/etc/locale.gen</code>, append new line <code>en_US.UTF-8 UTF-8</code></li>\n<li>invoke <code>locale-gen</code> to generate locales.</li>\n<li>export <code>LANG</code> variable.</li>\n</ol>\n\n<p>Debian locales wiki<sup><a href=\"https://wiki.debian.org/Locale\" rel=\"nofollow noreferrer\">1</a></sup></p>\n\n<p>P.S. My default <strong>Debian Wheezy</strong> installation had <code>C.UTF-8</code> in default locales list, so I believe in purposes of minimalism is it possible use it rather than install additional English locale, but I didn't test it by myself.</p>\n"}], "owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 0, "accepted_answer_id": 30436634, "answer_count": 1, "score": 3, "last_activity_date": 1566066501, "creation_date": 1432458824, "last_edit_date": 1566066501, "question_id": 30421845, "link": "https://stackoverflow.com/questions/30421845/haskell-quotefile-fails-on-text-file-with-invalid-byte-sequence-on-unicode-ch", "title": "Haskell: quoteFile fails on text file with &quot;invalid byte sequence&quot; on unicode characters", "body": "<p>I'm facing issue with <code>quoteFile</code> in my virtual environment (Debian Wheezy with GHC 7.8.4 installed). I have described file oriented version of <code>st</code> quasi quoter from <code>Text.Shakespeare.Text</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Language.Haskell.TH.Quote    (QuasiQuoter, quoteFile)\nimport Text.Shakespeare.Text        (st)\n\nsfFile :: QuasiQuoter\nstFile = quoteFile st\n</code></pre>\n\n<p>This works very well on my host machine, however, this fails with following error on my virtual environment (a Docker image):</p>\n\n<blockquote>\n  <p>Exception when trying to run compile-time code:\n    test-file.md: hGetContents: invalid argument (invalid byte sequence)</p>\n  \n  <p>Code: Language.Haskell.TH.Quote.quoteExp\n          stFile \"test-file.md\"</p>\n</blockquote>\n\n<p>I little REPL investigation shows, that error occurs on first unicode character in text file, in my current case this is '\u00ab' left-pointer double angle quotation mark:</p>\n\n<pre><code>import System.IO (IOMode(..), hGetContents, openFile, openBinaryFile, utf8)\n\nmain =\n  do h &lt;- openBinaryFile \"test-file.md\" ReadMode\n     hGetContentContents h\n     -- Binary read works fine out-of-box.\n\n     h' &lt;- openFile \"test-file.md\" ReadMode\n     hSetEncoding h' utf8\n     hGetContentContents h'\n     -- This works only if encoding is explicitly set, otherwise \n     -- it gives \"invalid byte sequence\" error at run-time\n</code></pre>\n\n<p>It seems to me that I need either to configure a bit my virtual environment, or probably rebuild GHC itself.</p>\n\n<p>I tried to set locale to <code>en.UTF-8 UTF-8</code>, but it did not help (initially I did no locale configuration at all).</p>\n\n<p>Update: target file has <code>UTF-8</code> encoding:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ file -bi test-file.md\ntext/x-c++; charset=utf-8\n</code></pre>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1432458141, "creation_date": 1432458141, "answer_id": 30421748, "question_id": 30421705, "link": "https://stackoverflow.com/questions/30421705/composed-data-type-haskell/30421748#30421748", "title": "Composed data type haskell", "body": "<p>as the <code>return</code> will wrap it into some monad, you can then get to the parts by deconstructing it directly inside a <code>do</code> block like this:</p>\n\n<pre><code>do\n    (b,c) &lt;- solve x y\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4916010, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c1ccc8f19d83f83174b053fe436eba2?s=128&d=identicon&r=PG&f=1", "display_name": "Lerul Ler", "link": "https://stackoverflow.com/users/4916010/lerul-ler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 30421748, "answer_count": 1, "score": 0, "last_activity_date": 1432458141, "creation_date": 1432457786, "question_id": 30421705, "link": "https://stackoverflow.com/questions/30421705/composed-data-type-haskell", "title": "Composed data type haskell", "body": "<p>So, I have this function:</p>\n\n<pre><code>solve x y = do\n            ...\n            return (newx,y++[1])\n</code></pre>\n\n<p>where x and newx are [[Int]] and y is [Int].\nAnd with this function, I will return a \"value\". Now, I would like to know how can I \"process\" this value in order to extract the 2 components and use them separately.</p>\n\n<p>Something like this:</p>\n\n<pre><code>a &lt;- solve x y\nb &lt;- a[0]\nc &lt;- a[1]\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "complexity-theory", "higher-order-functions"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432454923, "post_id": 30421308, "comment_id": 48928397, "body": "a good example might be <code>filter isPrime [1..n]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1432522053, "post_id": 30421329, "comment_id": 48945559, "body": "Are you sure about that footnote? I don&#39;t see how you could do such a thing, although <code>traverse</code> and <code>filterM</code> certainly can. Am I missing something?"}, {"owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432527834, "post_id": 30421329, "comment_id": 48946642, "body": "@dfeuer: I think so? Just append every element you see to an array, and perform an extra dummy scan through the entire array before doing so."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 1, "creation_date": 1432548999, "post_id": 30421329, "comment_id": 48955230, "body": "You can only do that from a function that&#39;s been passed to map or filter if you&#39;re using <code>unsafePerformIO</code>"}], "tags": [], "owner": {"reputation": 188404, "user_id": 541686, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2d0d2c0f7a83e2f8797a5ae79a324b6?s=128&d=identicon&r=PG", "display_name": "user541686", "link": "https://stackoverflow.com/users/541686/user541686"}, "is_accepted": false, "score": 5, "last_activity_date": 1432454843, "last_edit_date": 1432454843, "creation_date": 1432454747, "answer_id": 30421329, "question_id": 30421308, "link": "https://stackoverflow.com/questions/30421308/computational-complexity-of-higher-order-functions/30421329#30421329", "title": "Computational Complexity of Higher Order Functions?", "body": "<p>You seem to have a (common) misunderstanding that complexity is a function of <code>n</code>.</p>\n\n<p>What is <code>n</code>?</p>\n\n<p><code>n</code> is just one parameter that measures something about your input. It might not be a sufficient (or even necessary) statistic for describing your input -- you might need other variables to accurately describe the complexity of your input.</p>\n\n<p>So, <code>map</code> and <code>filter</code> are are linear <em>in <code>n</code></em>. Their dependence on other variables depends on the function you pass, but their dependence on <code>n</code> generally doesn't.</p>\n\n<p>(Footnote: yes, you <em>can</em> pass a function to <code>map</code> and <code>filter</code> that actually performs more work as it processes more elements, but that's uninteresting and beside the point I'm trying to make here.)</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432521902, "post_id": 30421578, "comment_id": 48945536, "body": "I&#39;d never have thought about using parametricity to pull a time bound from thin air. I think it&#39;s of fairly limited utility though\u2014whatever information you <i>do</i> give the function can be fed to a busy beaver or some such."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1432456641, "creation_date": 1432456641, "answer_id": 30421578, "question_id": 30421308, "link": "https://stackoverflow.com/questions/30421308/computational-complexity-of-higher-order-functions/30421578#30421578", "title": "Computational Complexity of Higher Order Functions?", "body": "<p>In virtually all cases, when the documentation of an higher order function states its complexity is <code>O(f(n))</code>, this is assuming that the higher order function has constant time complexity <code>O(1)</code>. Further, the exact meaning of <code>n</code> can vary, but when not explicitly stated it should be clear from the context: e.g. the length of a list, the number of elements/associations in a set/map, and so on.</p>\n\n<p>Assume we have a higher order function <code>g</code> called as <code>g h ...</code> where <code>h</code> is a function and the <code>...</code> are first order data. Without any other information about the higher-order function <code>g</code>, if the documentation states it's <code>O(f(n))</code>, you can get a more realistic worst-case bound of <code>O(f(n)) * CostH</code> where <code>CostH</code> represents the cost of calling <code>H</code> once. </p>\n\n<p>Of course, <code>CostH</code> will also depend on which arguments are begin passed to <code>h</code>: here, all we know is that those arguments are being built in <code>O(f(n))</code> time. It's hard to get a useful general bound on the size of the arguments for <code>h</code> since, for instance, if <code>h</code> takes trees as input, then you can build a very large tree in a short time:</p>\n\n<pre><code>foo :: Int -&gt; Tree ()\nfoo 0 = Tree []\nfoo m = Tree [t,t] where t = foo (m-1)\n</code></pre>\n\n<p>The above builds a tree having <code>2^m</code> leaves in <code>m</code> time (thanks to sharing). This can be adapted to <code>3^m</code> or to <code>b^m</code> trivially keeping <code>b*m</code> complexity.</p>\n\n<p>However, there might be some way to exploit parametricity to recover a more useful bound. For instance, if our order function has type</p>\n\n<pre><code>g :: (a -&gt; Int) -&gt; [a] -&gt; Int\n</code></pre>\n\n<p>then we <em>know</em> that <code>g h [...]</code> can only call <code>h</code> with arguments taken from the list. Similarly, the library function call <code>sortBy h [...]</code> can only use <code>h</code> to compare two elements in the supplied list. </p>\n\n<p>I have however no idea about how to formalize and prove the sketched claim above. It's quite possible that there are some research papers on the topic.</p>\n"}, {"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1432489171, "post_id": 30424707, "comment_id": 48937784, "body": "It would be a good idea to summarize some of the main points (especially with regard to the question) since that&#39;s an offsite link (link-only answers are discouraged here) and it also requires a subscription to view."}], "tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": false, "score": 3, "last_activity_date": 1432478285, "creation_date": 1432478285, "answer_id": 30424707, "question_id": 30421308, "link": "https://stackoverflow.com/questions/30421308/computational-complexity-of-higher-order-functions/30424707#30424707", "title": "Computational Complexity of Higher Order Functions?", "body": "<p>For some background on complexity and higher-order functions, see, e.g., </p>\n\n<p>Hofmann, Martin. An Application of Category-Theoretic Semantics to the Characterisation of Complexity Classes Using Higher-Order Function Algebras. </p>\n\n<p>Bull. Symbolic Logic 3 (1997), no. 4, 469--486. <a href=\"http://projecteuclid.org/euclid.bsl/1182353537\" rel=\"nofollow\">http://projecteuclid.org/euclid.bsl/1182353537</a>.</p>\n"}], "owner": {"reputation": 571, "user_id": 2850913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0102d3704dfeadc6e05b3f9374b6584a?s=128&d=identicon&r=PG&f=1", "display_name": "tail_recursion", "link": "https://stackoverflow.com/users/2850913/tail-recursion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 30421578, "answer_count": 3, "score": 4, "last_activity_date": 1432478285, "creation_date": 1432454538, "question_id": 30421308, "link": "https://stackoverflow.com/questions/30421308/computational-complexity-of-higher-order-functions", "title": "Computational Complexity of Higher Order Functions?", "body": "<p>Map and filter seem like they would be linear O(n) because they only have to traverse a list once, but is their complexity affected by the function being passed? For example are the two examples below of the same order? </p>\n\n<pre><code>map (+) list\n\nmap (complex_function) list\n</code></pre>\n"}, {"tags": ["algorithm", "haskell", "types", "type-inference", "type-systems"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432455249, "post_id": 30420606, "comment_id": 48928465, "body": "Style comment: the <code>maxsub</code> function should take <code>(a,a)</code> instead of <code>[a]</code>, since you know there will be exactly two arguments. This will also allow you to avoid dangerous partial functions like <code>head,last</code>, and simply use pattern matching to fetch those e.g. <code>maxsub (x1,x2) y = ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1432448512, "creation_date": 1432448512, "answer_id": 30420693, "question_id": 30420606, "link": "https://stackoverflow.com/questions/30420606/why-cant-i-remove-the-ord-typeclass-from-this-haskell-implementation-of-kadane/30420693#30420693", "title": "Why can&#39;t I remove the Ord Typeclass from this haskell implementation of Kadane&#39;s algorithm?", "body": "<p>You cannot remove <code>Ord</code> since you are using functions like <code>&lt;</code> and <code>&gt;</code> and operating them on polymorphic type. See their type:</p>\n\n<pre><code>\u03bb&gt; :t (&lt;)\n(&lt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>But if you instead limit your polymorphic code to operate only on <code>Int</code> or any other monomorphic instance for which <code>Ord</code> instance is already defined, then you can remove it:</p>\n\n<pre><code>maxsub :: [Int] -&gt; Int -&gt; [Int]\nmaxsub x y\n    | last(x)+y &gt; head(x) = if last(x)+y &gt; 0 then [last(x)+y, last(x)+y] else [last(x)+y, 0]\n    | otherwise = if last(x)+y &gt; 0 then [head(x), last(x)+y]  else [head(x), 0]\n\nkadane' :: [Int] -&gt; Int\nkadane' xs = head$ foldl maxsub [0,0] xs\n</code></pre>\n"}], "owner": {"reputation": 1497, "user_id": 2148851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b7558f5365a89314a0d569edba74dbcc?s=128&d=identicon&r=PG&f=1", "display_name": "k4vin", "link": "https://stackoverflow.com/users/2148851/k4vin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 30420693, "answer_count": 1, "score": 1, "last_activity_date": 1432448512, "creation_date": 1432447664, "question_id": 30420606, "link": "https://stackoverflow.com/questions/30420606/why-cant-i-remove-the-ord-typeclass-from-this-haskell-implementation-of-kadane", "title": "Why can&#39;t I remove the Ord Typeclass from this haskell implementation of Kadane&#39;s algorithm?", "body": "<p>I have been implementing kadane's algorithm in haskell, AFAIK it is working correctly</p>\n\n<pre><code>kadane' :: (Ord a, Num a) =&gt; [a] -&gt; a\nkadane' xs = head$ foldl maxsub [0,0] xs\n\nmaxsub :: (Ord a, Num a) =&gt; [a] -&gt; a -&gt; [a]\nmaxsub x y\n    | last(x)+y &gt; head(x) = if last(x)+y &gt; 0 then [last(x)+y, last(x)+y] else [last(x)+y, 0]\n    | otherwise = if last(x)+y &gt; 0 then [head(x), last(x)+y]  else [head(x), 0]\n</code></pre>\n\n<p>I want to remove Ord typeclass from function's type specification, since I can't find maximum sub array for all the types that can be ordered. But I can't get rid of the Ord typeclass from the type specification. I wrote them initially by asking haskell's type inference as shown below</p>\n\n<pre><code>*Main&gt; :t kadane' \nkadane' :: (Ord a, Num a) =&gt; [a] -&gt; a\n*Main&gt; :t maxsub \nmaxsub :: (Ord a, Num a) =&gt; [a] -&gt; a -&gt; [a]\n*Main&gt; \n</code></pre>\n\n<p>If I remove Ord Typeclass as shown below </p>\n\n<pre><code>kadane' :: (Num a) =&gt; [a] -&gt; a\nkadane' xs = head$ foldl maxsub [0,0] xs\n\nmaxsub :: (Num a) =&gt; [a] -&gt; a -&gt; [a]\nmaxsub x y\n    | last(x)+y &gt; head(x) = if last(x)+y &gt; 0 then [last(x)+y, last(x)+y] else [last(x)+y, 0]\n    | otherwise = if last(x)+y &gt; 0 then [head(x), last(x)+y]  else [head(x), 0]\n</code></pre>\n\n<p>and compiling the above code throws the following error</p>\n\n<pre><code>*Main&gt; :l kadanes.hs \n[1 of 1] Compiling Main             ( kadanes.hs, interpreted )\n\nkadanes.hs:6:21:\n    Could not deduce (Ord a) arising from a use of \u2018&gt;\u2019\n    from the context (Num a)\n      bound by the type signature for maxsub :: Num a =&gt; [a] -&gt; a -&gt; [a]\n      at kadanes.hs:4:11-36\n    Possible fix:\n      add (Ord a) to the context of\n        the type signature for maxsub :: Num a =&gt; [a] -&gt; a -&gt; [a]\n    In the expression: last (x) + y &gt; head (x)\n    In a stmt of a pattern guard for\n                   an equation for \u2018maxsub\u2019:\n      last (x) + y &gt; head (x)\n    In an equation for \u2018maxsub\u2019:\n        maxsub x y\n          | last (x) + y &gt; head (x)\n          = if last (x) + y &gt; 0 then\n                [last (x) + y, last (x) + y]\n            else\n                [last (x) + y, 0]\n          | otherwise\n          = if last (x) + y &gt; 0 then\n                [head (x), last (x) + y]\n            else\n                [head (x), 0]\nFailed, modules loaded: none.\nPrelude&gt; \n</code></pre>\n\n<p>According to the Possible Fix reported in the error I need to add Ord typeclass again, What am I doing wrong ?</p>\n\n<p>And also please evaluate the correctness of the algorithm, if possible suggest alternative ways</p>\n"}, {"tags": ["haskell", "recursion", "stack-overflow", "guard"], "comments": [{"owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "edited": false, "score": 1, "creation_date": 1432427349, "post_id": 30418878, "comment_id": 48923559, "body": "You could also use <code>even</code> instead of the <code>mod 2</code> test. And it seems like your <code>otherwise</code> case will never be reached."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1432436043, "post_id": 30418878, "comment_id": 48925071, "body": "In your edit, an expression like <code>f x . g y</code> associates like <code>(f x) . (g y)</code> instead of <code>(f x . g) y</code> because function application binds tighter than any operator. You could use <code>$</code> here (in fact, you might be mixing up <code>$</code> with <code>.</code>), but you could also just make the parentheses explicit and not use <code>.</code> or <code>$</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1432427862, "post_id": 30418894, "comment_id": 48923644, "body": "could you explain what <code>$</code> is?"}, {"owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "reply_to_user": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 2, "creation_date": 1432428026, "post_id": 30418894, "comment_id": 48923675, "body": "You could also write this as <code>f (3 * x + 1)</code>. See <a href=\"http://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign\">this post</a> for a longer description of <code>$</code>."}, {"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1432429546, "post_id": 30418894, "comment_id": 48923994, "body": "When I want to increment it using <code>.</code> to count the number of times <code>foo</code> has been applied, what else should I do? It is in the edit part."}, {"owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "reply_to_user": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1432523358, "post_id": 30418894, "comment_id": 48945763, "body": "I could imagine doing something like <code>odd x = inc . foo $ 3 * x + 1</code>, and then defining <code>inc (x, i) = (x, i + 1)</code>, which makes <code>inc</code> have type <code>(Integer, Integer) -&gt; (Integer, Integer)</code>."}], "tags": [], "owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "is_accepted": true, "score": 5, "last_activity_date": 1432427021, "creation_date": 1432427021, "answer_id": 30418894, "question_id": 30418878, "link": "https://stackoverflow.com/questions/30418878/haskell-recursion-stack-overflow/30418894#30418894", "title": "Haskell recursion stack overflow", "body": "<p>Function application has higher precedence than many other operations, so <code>foo 3 * x + 1</code> is actually calling <code>foo 3</code>, then multiplying that result by <code>x</code> and adding <code>1</code>, which looks like where your infinite loop might be.</p>\n\n<p>Changing it to the following should fix that:</p>\n\n<pre><code>| odd x          = foo $ 3 * x + 1\n| x `mod` 2 == 0 = foo $ x `div` 2\n</code></pre>\n"}], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 30418894, "answer_count": 1, "score": 0, "last_activity_date": 1432435651, "creation_date": 1432426817, "last_edit_date": 1432435651, "question_id": 30418878, "link": "https://stackoverflow.com/questions/30418878/haskell-recursion-stack-overflow", "title": "Haskell recursion stack overflow", "body": "<p>I am pretty new to Haskell, so sorry for the question. But - how to get rid of the endless recursion and not been overflown. This is the code:</p>\n\n<pre><code>foo :: Integer -&gt; Integer\nfoo x\n    | x == 1         = 1\n    | x &lt;= 0         = error \"negative number or zero\"\n    | odd x          = foo 3 * x + 1\n    | x `mod` 2 == 0 = foo x `div` 2\n    | otherwise      = x\n</code></pre>\n\n<p><strong>EDIT</strong>:</p>\n\n<pre><code>foo :: Integer -&gt; (Integer, Integer)\nfoo x\n    | x == 1         = (1, z) \n    | x &lt;= 0         = error \"negative number or zero\"\n    | odd x          = foo  (3 * x + 1) . inc z\n    | even x         = foo  (x `div` 2) . inc z\n    | otherwise      = (x, z)\n  where z = 0\n\ninc :: Integer -&gt; Integer\ninc i = i + 1\n</code></pre>\n\n<p>I believe that the code is self-explanatory, but yet : If x is even then divide it with 2 otherwise 3*x + 1. This is part of the famous Collatz problem.</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 0, "creation_date": 1432420190, "post_id": 30417742, "comment_id": 48922246, "body": "Oh, <code>instance (MonadReader r m) =&gt; MonadReader r (ReaderT s m)</code> doesn&#39;t even exist?! Why is that?"}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 0, "creation_date": 1432420914, "post_id": 30418207, "comment_id": 48922376, "body": "Thanks for the answer, for that last comment, how do you chose which one of <code>MonadReader A App</code> or <code>MonadReader B App</code> you get, because that would in fact solve my problem."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 1, "creation_date": 1432420950, "post_id": 30418207, "comment_id": 48922384, "body": "@SydKerckhove Whichever one&#39;s on top."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 2, "creation_date": 1432420970, "post_id": 30418207, "comment_id": 48922387, "body": "@SydKerckhove So if you had <code>ReaderT B (Reader A)</code> then you&#39;d have the <code>MonadReader B</code> instance."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 15, "last_activity_date": 1432420793, "last_edit_date": 1432420793, "creation_date": 1432420293, "answer_id": 30418207, "question_id": 30417742, "link": "https://stackoverflow.com/questions/30417742/why-cant-i-stack-two-readers-ontop-of-eachother/30418207#30418207", "title": "Why can&#39;t I stack two readers ontop of eachother?", "body": "<p>The <code>MonadReader</code> class is defined using the <code>FunctionalDependencies</code> extension, which allows declarations like</p>\n\n<pre><code>class Monad m =&gt; MonadReader r m | m -&gt; r where\n    ...\n</code></pre>\n\n<p>This means that for any monad <code>m</code>, the <code>r</code> is uniquely determined by it.  Therefore, you can't have a single monad <code>m</code> that determines two different <code>r</code> types.  Without this as a restriction the compiler wouldn't be able to type check uses of the class.</p>\n\n<p>The solution to this is to write your functions like</p>\n\n<pre><code>getA'sInt :: A -&gt; Int\ngetA'sInt = undefined\n\ngetB'sString :: B -&gt; String\ngetB'sString = undefined\n\nfoo :: (MonadReader A m) =&gt; m Int\nfoo = do\n    a &lt;- asks getA'sInt\n    return $ a + 1\n\nbar :: (MonadReader B m) =&gt; m String\nbar = do\n    b &lt;- asks getB'sString\n    return $ map toUpper b\n</code></pre>\n\n<p>Then just use a tuple <code>(A, B)</code> in your actual implementation:</p>\n\n<pre><code>baz :: Reader (A, B) (Int, String)\nbaz = do\n    a &lt;- withReader fst foo\n    b &lt;- withReader snd bar\n    return (a, b)\n</code></pre>\n\n<p>There's also a <code>withReaderT</code> for more complex cases.</p>\n\n<p>As an example for why it's not allowed to stack <code>ReaderT</code>s, consider the case</p>\n\n<pre><code>type App = ReaderT Int (Reader Int)\n</code></pre>\n\n<p>When you call <code>ask</code>, which <code>Int</code> are you referring to?  It may seem obvious that for cases like</p>\n\n<pre><code>type App = ReaderT A (Reader B)\n</code></pre>\n\n<p>the compiler should be able to figure out which to use, but the problem is that the <code>ask</code> function here would have the type</p>\n\n<pre><code>ask :: App ???\n</code></pre>\n\n<p>Where <code>???</code> could be <code>A</code> or <code>B</code>.  You can get around this another way, by not using <code>MonadReader</code> directly and defining specific <code>askA</code> and <code>askB</code> functions:</p>\n\n<pre><code>type App = ReaderT A (Reader B)\n\naskA :: App A\naskA = ask\n\naskB :: App B\naskB = lift ask\n\nbaz :: App (Int, String)\nbaz = do\n    a &lt;- askA\n    b &lt;- askB\n    return (getA'sInt a, getB'sString b)\n</code></pre>\n\n<p>But you will only be able to have <code>MonadReader A App</code>, you can't also have <code>MonadReader B App</code>.  This approach could be called \"explicit lifting\", and it makes those functions specific to the <code>App</code> type, and therefore less composable.</p>\n"}, {"comments": [{"owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 0, "creation_date": 1432420734, "post_id": 30418249, "comment_id": 48922339, "body": "This is what I had just figured out, and it works! I just hoped for a clearer (safer) solution."}], "tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": false, "score": 7, "last_activity_date": 1432420653, "creation_date": 1432420653, "answer_id": 30418249, "question_id": 30417742, "link": "https://stackoverflow.com/questions/30417742/why-cant-i-stack-two-readers-ontop-of-eachother/30418249#30418249", "title": "Why can&#39;t I stack two readers ontop of eachother?", "body": "<p>It can be done using some extensions, though it might not be a good idea to have overlapping instances.</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE OverlappingInstances #-}\n\nimport Control.Monad.Reader\n\nimport Data.Functor.Identity\n\ndata A = A deriving Show\ndata B = B deriving Show\n\ntype SomeMonad a = ReaderT A (ReaderT B Identity) a\n\ninstance MonadReader a m =&gt; MonadReader a (ReaderT b m) where\n  ask = lift ask\n  local f mx = do\n    b &lt;- ask\n    lift $ local f $ runReaderT mx b\n\nmain :: IO ()\nmain = do\n  let res = runIdentity $ flip runReaderT B $ flip runReaderT A $ do\n              a &lt;- ask :: SomeMonad A\n              b &lt;- ask :: SomeMonad B\n              return (a, b)\n  print res\n</code></pre>\n\n<p>Needless to say, whenever possible it's much better to use something like <code>ReaderT (A, B) IO</code>.</p>\n"}], "owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 1, "accepted_answer_id": 30418207, "answer_count": 2, "score": 10, "last_activity_date": 1432420793, "creation_date": 1432416214, "question_id": 30417742, "link": "https://stackoverflow.com/questions/30417742/why-cant-i-stack-two-readers-ontop-of-eachother", "title": "Why can&#39;t I stack two readers ontop of eachother?", "body": "<p>I get errors like this:</p>\n\n<p>Let's say I have a monadStack <code>ReaderT A (ReaderT B m)</code>, whenever I use <code>ask</code> or <code>asks</code>, I get an error like this:</p>\n\n<pre><code>Types.hs:21:10:\n    Couldn't match type \u2018A\u2019 with \u2018B\u2019\n    arising from a functional dependency between:\n      constraint \u2018MonadReader B m\u2019\n        arising from the instance declaration\n      instance \u2018MonadReader A m2\u2019 at Types.hs:21:10-63\n    In the instance declaration for \u2018MonadReader A m\u2019\n</code></pre>\n\n<p>How come Haskell can't figure out which instance to use? Also, how can I solve this?\nLet's say putting <code>A</code> and <code>B</code> in the same datatype is not an option, because I need a <code>MonadReader A m</code> instance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432403620, "post_id": 30415865, "comment_id": 48917736, "body": "This is the whole code"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432404585, "post_id": 30415981, "comment_id": 48918084, "body": "Hmm.. I seem to receive a warning that Pattern match(es) are overlapped in the second line of your snippet. Should I be worried? Other than that its fine"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 2, "creation_date": 1432404720, "post_id": 30415981, "comment_id": 48918119, "body": "@user3402719 - You don&#39;t get it in my code, but yes in your original <code>makeAmove firstMove = firstMove</code> will always match which I assume you don&#39;t want. It&#39;s not clear what you&#39;re trying to do there."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1432404267, "creation_date": 1432404267, "answer_id": 30415981, "question_id": 30415865, "link": "https://stackoverflow.com/questions/30415865/how-do-i-make-the-recursive-function-work/30415981#30415981", "title": "How do I make the recursive function work?", "body": "<p>The error is actually that <code>pos</code> is an <code>IO Int</code> even though <code>+</code> requires both its arguments are <code>Int</code>s. You can lift the addition over <code>pos</code> using <code>fmap</code>:</p>\n\n<pre><code>makeAmove :: IO Int -&gt; IO Int\nmakeAmove pos = do\n   step &lt;- sumOfTwoDices\n   fmap (+ step) pos\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1432407395, "last_edit_date": 1432407395, "creation_date": 1432406724, "answer_id": 30416359, "question_id": 30415865, "link": "https://stackoverflow.com/questions/30415865/how-do-i-make-the-recursive-function-work/30416359#30416359", "title": "How do I make the recursive function work?", "body": "<p>just so you get something <em>working</em> I cleaned it up a bit:</p>\n\n<pre><code>import System.Random\n\nfirstMove :: IO Int\nfirstMove = do\n  -- randomRIO (0,0) will allways be 0 so start=0\n  let start = 0\n  current &lt;- sumOfTwoDices\n  return (start+current)\n\nmakeAmove :: IO Int -&gt; IO Int\nmakeAmove pos = do\n   cur  &lt;- pos\n   step &lt;- sumOfTwoDices\n   return (cur+step)\n\nrollDice :: IO Int\nrollDice = randomRIO (1,6)\n\nsumOfTwoDices :: IO Int\nsumOfTwoDices = do\n    dice1 &lt;- rollDice\n    dice2 &lt;- rollDice\n    return $ dice1+dice2\n</code></pre>\n\n<p>but as I told you in your last question - you should not do everything inside the IO monad - rewritten it would look like this:</p>\n\n<pre><code>module Monoploy where\n\nimport System.Random\n\ntype Position = Int\ntype Steps = Int\n\nstart :: Position\nstart = 0\n\nend :: Position\nend = 79 -- please note: I don't know the number of tiles on monopoly so the 79 (80 positions) will obvious be wrong ;)\n\n-- moves around the board / wraps back to start\nmove :: Steps -&gt; Position -&gt; Position\nmove s p = (p+s) `mod` (end+1)\n\nrandomMove :: Position -&gt; IO Position\nrandomMove pos = do\n  steps &lt;- sumOfTwoDices\n  return $ move steps pos\n\nrollDice :: IO Steps\nrollDice = randomRIO (1,6)\n\nsumOfTwoDices :: IO Int\nsumOfTwoDices = do\n  dice1 &lt;- rollDice\n  dice2 &lt;- rollDice\n  return $ dice1+dice2\n\nsampleMoveFromStart :: IO Position\nsampleMoveFromStart = randomMove start\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 30415981, "answer_count": 2, "score": 0, "last_activity_date": 1432408395, "creation_date": 1432403589, "last_edit_date": 1432408395, "question_id": 30415865, "link": "https://stackoverflow.com/questions/30415865/how-do-i-make-the-recursive-function-work", "title": "How do I make the recursive function work?", "body": "<p>I have here some simple haskell code that <em>rolls</em> two dices and sums up their values. I want to use that value to make a move on a monopoly board. I've decided to use a recursive function for that and another function for the first move. Problem is I declared the recursive function to take an IO Int type parameter and return a result of the same type. How do I go around this.\nNote: I am new to Haskell.</p>\n\n<pre><code>import System.Random\n\nfirstMove :: IO Int\nfirstMove = do\n  start   &lt;- randomRIO (0, 0)\n  current &lt;- sumOfTwoDices\n  return (start + current)\n\nmakeAmove :: IO Int -&gt; IO Int\nmakeAmove firstMove = firstMove\nmakeAmove pos = do\n   step &lt;- sumOfTwoDices\n   return (pos + step)\n\nrollDice :: IO Int\nrollDice = randomRIO (1, 6)\n\nsumOfTwoDices :: IO Int\nsumOfTwoDices = do\n    dice1 &lt;- rollDice\n    dice2 &lt;- rollDice\n    return (dice1 + dice2)\n</code></pre>\n\n<p>It sees pos as Int even though I specified it to  receive IO Int type. Help appreciated</p>\n"}, {"tags": ["haskell", "build", "cabal", "ffi"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user554538"}, "is_accepted": false, "score": 2, "last_activity_date": 1432519882, "creation_date": 1432519882, "answer_id": 30430367, "question_id": 30415564, "link": "https://stackoverflow.com/questions/30415564/how-do-i-configure-cabal-to-understand-a-c-ffi/30430367#30430367", "title": "How do I configure Cabal to understand a C FFI?", "body": "<p>A series of blog posts on <a href=\"http://blog.ezyang.com/2010/06/setting-up-cabal-the-ffi-and-c2hs/\" rel=\"nofollow\">Cabal, the FFI, and c2hs</a> has what you're looking for in the second article, the \"Compiling the library with Cabal\" section.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432519882, "creation_date": 1432401589, "question_id": 30415564, "link": "https://stackoverflow.com/questions/30415564/how-do-i-configure-cabal-to-understand-a-c-ffi", "title": "How do I configure Cabal to understand a C FFI?", "body": "<p>I am trying to create a Haskell library which uses a C FFI. I have 4 files:</p>\n\n<pre><code>MyLibrary.hs\nc_dependency.h\nc_dependency.c\nc_dependency.o\ntest.hs\n</code></pre>\n\n<p>All on the same directory. <code>test.hs</code> loads MyLibrary and tests it:</p>\n\n<pre><code>-- test.hs\nimport qualified MyLibrary as Lib\nmain = Lib.test\n</code></pre>\n\n<p>I want to be able to compile <code>test.hs</code> as usual, without linking to <code>c_dependency.o</code>. That is, I want <code>ghc test.hs; ./test</code> to work. How can I init/configure cabal so it builds my library properly, taking care of linking <code>c_dependency.o</code> ?</p>\n"}, {"tags": ["haskell", "cuda", "ffi"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 2, "creation_date": 1432396256, "post_id": 30414293, "comment_id": 48915315, "body": "you will probably need to link in the cuda runtime library"}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1432403717, "post_id": 30414648, "comment_id": 48917775, "body": "... let me know if there is a better answer."}, {"owner": {"reputation": 20829, "user_id": 1030110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bsgx2.png?s=128&g=1", "display_name": "m0nhawk", "link": "https://stackoverflow.com/users/1030110/m0nhawk"}, "edited": false, "score": 0, "creation_date": 1432478877, "post_id": 30414648, "comment_id": 48934850, "body": "I don&#39;t think better answer exist, you just use a proper and portable ABI (with <code>extern &quot;C&quot;</code>) and just link with CUDA library."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "is_accepted": false, "score": 2, "last_activity_date": 1432403761, "last_edit_date": 1432403761, "creation_date": 1432396146, "answer_id": 30414648, "question_id": 30414293, "link": "https://stackoverflow.com/questions/30414293/how-do-i-ffi-a-cuda-application-on-haskell/30414648#30414648", "title": "How do I FFI a CUDA application on Haskell?", "body": "<p>I managed to solve it by adding <code>extern \"C\"</code> to all functions on <code>hello.cu</code>:</p>\n\n<pre><code>-- hello.cu\nextern \"C\" \nvoid hello();\n</code></pre>\n\n<p>Compiling the CUDA file with:</p>\n\n<pre><code>nvcc -c hello.cu\n</code></pre>\n\n<p>And the Haskell file with:</p>\n\n<pre><code>ghc --make test.hs -o test hello.o -L/usr/local/cuda/lib -optl-lcudart\n</code></pre>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1432403761, "creation_date": 1432394036, "last_edit_date": 1432395186, "question_id": 30414293, "link": "https://stackoverflow.com/questions/30414293/how-do-i-ffi-a-cuda-application-on-haskell", "title": "How do I FFI a CUDA application on Haskell?", "body": "<p>I've ported a Haskell application to CUDA in order to accelerate it. Now, I have a <code>.cu</code> file which I want to use from Haskell as an API. I've managed to FFI C files easily following the tutorials, but I'm not sure how this applies to CUDA/nvcc. How do I do it?</p>\n\n<p>For completion, this is what I get trying to treat the <code>.cu</code> as a normal <code>.c</code> file:</p>\n\n<pre><code>vh:CUDA apple1$ nvcc hello.cu -c -o hello.o\nvh:CUDA apple1$ ghc test.hs -o test hello.o\nLinking test ...\nUndefined symbols for architecture x86_64:\n  \"___cudaRegisterFatBinary\", referenced from:\n      __sti____cudaRegisterAll_40_tmpxft_00002168_00000000_7_hello_cpp1_ii_f33df8d2() in hello.o\n  \"___cudaRegisterFunction\", referenced from:\n      __nv_cudaEntityRegisterCallback(void**) in hello.o\n  \"___cudaUnregisterFatBinary\", referenced from:\n      __cudaUnregisterBinaryUtil() in hello.o\n  \"_cudaConfigureCall\", referenced from:\n      render(Renderer_*) in hello.o\n  \"_cudaFree\", referenced from:\n      renderer_free(Renderer_*) in hello.o\n  \"_cudaLaunch\", referenced from:\n      cudaError cudaLaunch&lt;char&gt;(char*) in hello.o\n  \"_cudaMalloc\", referenced from:\n      renderer_init(Renderer_*, float, float, float, float, float) in hello.o\n  \"_cudaMemcpy\", referenced from:\n      renderer_init(Renderer_*, float, float, float, float, float) in hello.o\n      render(Renderer_*) in hello.o\n  \"_cudaSetupArgument\", referenced from:\n      __device_stub__Z4walk6float3PiS_S_S_S_S0_(float3&amp;, int*, float3&amp;, float3&amp;, float3&amp;, float3&amp;, int*) in hello.o\n  \"_hello\", referenced from:\n      _r3yw_info in test.o\n      _c3Ib_info in test.o\n      _c3Il_info in test.o\n     (maybe you meant: _Main_hello_closure, _Main_hello_info )\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>And that is my Haskell file:</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule Main where\n\nimport Foreign.C\nimport Foreign.Ptr (Ptr,nullPtr)\n\nforeign import ccall \"hello\" hello :: IO ()\n\nmain = hello\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1432394752, "post_id": 30414286, "comment_id": 48914861, "body": "how are you running it and what is the exact error message? also, is that the full source code?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1432394897, "post_id": 30414286, "comment_id": 48914909, "body": "note that it&#39;s an extremely bad idea to hide non pure random generation behind a pure <code>Int</code> type \u2014 at the very least it&#39;s extremely confusing and can lead to unexpected semantics, or in the worse case invalid runtime behavior. I <i>strongly</i> advise you to keep such logic in the <code>IO</code> monad, or use another monad such as the State monad."}, {"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1432394914, "post_id": 30414286, "comment_id": 48914915, "body": "I am running it using a script"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1432394961, "post_id": 30414286, "comment_id": 48914930, "body": "please provide the exact log of how you run it and what the output is."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432395011, "post_id": 30414286, "comment_id": 48914945, "body": "the problem is the last line - this will basically only work in GHCi - instead you could just say <code>position = move</code> but where is the point? <code>position</code> is just another <i>name</i> for <code>move</code> anyway"}, {"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432395017, "post_id": 30414286, "comment_id": 48914947, "body": "I have tried with IO Int monad, however I cannot acces the Int in order to update the situation of the game during turns"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1432395087, "post_id": 30414286, "comment_id": 48914972, "body": "this will get rather difficult - I think you don&#39;t know to much about Haskell and of the way how to work with <i>pure</i> languages - have you red something like <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a>? I would recommend to do so"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432395210, "post_id": 30414286, "comment_id": 48915004, "body": "but to help you a bit - instead of <i>mutating</i> variables like <code>position</code> you should start to think of functions like <code>moveFigureState :: Figure -&gt; Dice -&gt; GameState -&gt; GameState</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 6, "creation_date": 1432395253, "post_id": 30414286, "comment_id": 48915020, "body": "and do yourself a favor and <i>forget</i> for now that a function like <code>unsafePerformIO</code> even exists"}, {"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432395446, "post_id": 30414286, "comment_id": 48915064, "body": "Well this was a last resort.. since I seem to be unable to calculate the sum of the two dices to update the position without it. I&#39;ve found someone&#39;s way of extracting the Int of IO monad however it does not seem to work for me"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432395804, "post_id": 30414286, "comment_id": 48915170, "body": "the usual way is to use <i>bind</i> of some form <code>(&gt;&gt;=)</code> or the <code>do</code> notation like <code>do value &lt;- dice</code> - but this will be really hard to explain everything - it would be much easier if you would first read some introduction and then come back and ask specific questions instead"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432400983, "post_id": 30414286, "comment_id": 48916786, "body": "While you&#39;re at it, the word is &quot;dice&quot;, not &quot;dices&quot;. The singular form of &quot;dice&quot; is &quot;die&quot;. &quot;One die, two dice, three dice, etc.&quot; The word &quot;dice&quot; can also be a verb, one of whose forms is &quot;dices&quot;, but that is definitely not what you meant."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1432410437, "post_id": 30414286, "comment_id": 48919775, "body": "There is no way of &quot;extracting&quot; an <code>Int</code> from <code>IO Int</code>. <code>IO Int</code> does not contain an <code>Int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 1, "last_activity_date": 1432395274, "creation_date": 1432395274, "answer_id": 30414495, "question_id": 30414286, "link": "https://stackoverflow.com/questions/30414286/unable-to-use-storing-in-a-haskell-script/30414495#30414495", "title": "unable to use storing in a haskell script", "body": "<p>Your code snippet is fundamentally flawed to begin with. You should read a tutorial on Haskell evaluation semantics. The way you unsafely unwrap IO calls and try to make them look like pure calls is not only dangerous but has already lead you to come to invalid logic. For example the contents your <code>position</code> will probably change every time you access it because it's only an alias of <code>move</code>, and <code>move</code> evaluates to a new random value each time it's accessed. </p>\n\n<p>Alternatively, GHC might instead cache the first value of <code>move</code> so even though <code>position</code> will then be \"stable\", you can't generate new moves with <code>move</code>. </p>\n\n<p>As to the problem you're having, it's impossible to diagnose without further details as well as you fixing the logic to start with. </p>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432396146, "post_id": 30414604, "comment_id": 48915280, "body": "I ran it using a script and I received this The Type signature for &#39;sumOftwoDices&#39; lacks an accompanying binding"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432396214, "post_id": 30414604, "comment_id": 48915299, "body": "I forgot the <code>$</code> sorry - inside a <code>.hs</code> script with installed <code>random</code> package it should load into ghci just fine"}, {"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432396310, "post_id": 30414604, "comment_id": 48915330, "body": "Still the same error, and I have random package installed and included .Sorry to bother you to such lengths, I know I am a dummy."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432396432, "post_id": 30414604, "comment_id": 48915370, "body": "can you try to copy&amp;paste all the code as is into a text-editor, save it as <code>test.hs</code> and then do the steps I showed below in a terminal (<code>ghci test.hs</code> in the same directory you saved your file do, ..)"}, {"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432397151, "post_id": 30414604, "comment_id": 48915591, "body": "It worked now, thanks a lot for your  time and sorry for being such a dummy"}, {"owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432397255, "post_id": 30414604, "comment_id": 48915619, "body": "Also can I contact you somehow... I have an example code from someone with the exact same purpose as mine, yet Im having some trouble understanding it, if you are willing I would like to learn more since I am really pressured by time"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "edited": false, "score": 0, "creation_date": 1432397420, "post_id": 30414604, "comment_id": 48915673, "body": "you will do fine asking specific questions here - just make sure that you don&#39;t let it get to broad - there are a lot of really quick and really smart people around (much smarter than me) and I can not help 24/7 ;)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1432396885, "last_edit_date": 1432396885, "creation_date": 1432395907, "answer_id": 30414604, "question_id": 30414286, "link": "https://stackoverflow.com/questions/30414286/unable-to-use-storing-in-a-haskell-script/30414604#30414604", "title": "unable to use storing in a haskell script", "body": "<p>here is how you can do something like this without <code>unsafePerformIO</code>:</p>\n\n<pre><code>module Test where\n\nimport System.Random\n\nrollDice :: IO Int\nrollDice = randomRIO (1,6)\n\nsumOfTwoDices :: IO Int\nsumOfTwoDices = do\n    dice1 &lt;- rollDice\n    dice2 &lt;- rollDice\n    return $ dice1+dice2\n</code></pre>\n\n<p>you should be able to load this into ghci and then play with it:</p>\n\n<pre><code>~/Temp $ ghci test.hs \nGHCi, version 7.10.1: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Test             ( test.hs, interpreted )\nOk, modules loaded: Test.\n*Test&gt; sumOfTwoDices\n3\n</code></pre>\n\n<h2>explanation</h2>\n\n<p>You see now all calculations <em>live inside</em> IO - so you have to change the return-type accordingly.</p>\n\n<p><code>sumOfTwoDices</code> uses </p>\n\n<ul>\n<li>the <code>do</code> syntax</li>\n<li>then <em>rolls</em> the dice and pulls the value out of the <code>IO Int</code> value with <code>dice1 &lt;-</code> ...</li>\n<li>does this again for <code>dice2</code></li>\n<li>adds the two simple <code>Int</code> values with <code>dice1 + dice2</code></li>\n<li>and then wraps them back into <code>IO</code> with <code>return</code> (it's not what you might know from languages as <em>C/C++</em>, <em>Java</em> , ...)</li>\n</ul>\n\n<p>the <code>$</code> is just me being to lazy to write <code>return (dice1+dice2)</code> ;)</p>\n\n<p>Now if you want you can write your complete game inside <code>IO</code> (and it would be almost as using any other language) <strong>but</strong> you don't want this - you want to do as much as you can without <code>IO</code> and only go back in when you finally need the <em>random dices</em>  - but this is just to much to put into a single answer :(</p>\n"}], "owner": {"reputation": 141, "user_id": 3402719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ca244cefd8bc8f85735f0f46125bc1dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3402719", "link": "https://stackoverflow.com/users/3402719/user3402719"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 30414604, "answer_count": 2, "score": 0, "last_activity_date": 1432396885, "creation_date": 1432393999, "question_id": 30414286, "link": "https://stackoverflow.com/questions/30414286/unable-to-use-storing-in-a-haskell-script", "title": "unable to use storing in a haskell script", "body": "<p>Im new at haskell and Im trying to code the game of Monopoly. Below is the code for moving of the pawns every turn. My problem is I am unable to store the previous sum of the two dices in order to correctly update the current position. However, when i use the storing instruction in he console it works perfectly, yet in the script it says parse error possibly incorrect indentation or mismatched brackets. Also some advice for the concepts of the game would be welcomed. Thanks in advance</p>\n\n<pre><code>rollDice1 :: Int\nrollDice1 = unsafePerformIO(getStdRandom (randomR (1,6)))\nrollDice2 :: Int\nrollDice2 = unsafePerformIO(getStdRandom (randomR (1,6)))\n\nmove :: Int\nmove = rollDice1 + rollDice2\n\nlet position = move\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1432395720, "post_id": 30413916, "comment_id": 48915147, "body": "I get the feeling you should be using Monoid or smth."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432400810, "post_id": 30413916, "comment_id": 48916728, "body": "What is the definition of <code>Roman</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1432393374, "post_id": 30414122, "comment_id": 48914455, "body": "how would I implement this without overlapping patterns then? basically, If one argument has an empty list in the second part of the tuple, I just want to return the other argument"}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": false, "score": 3, "last_activity_date": 1432396889, "last_edit_date": 1432396889, "creation_date": 1432392974, "answer_id": 30414122, "question_id": 30413916, "link": "https://stackoverflow.com/questions/30413916/haskell-pattern-matches-overlap/30414122#30414122", "title": "Haskell - Pattern matches overlap?", "body": "<p><code>x</code> could be anything, so it could be <code>Roman (_,[])</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 1, "last_activity_date": 1432404652, "creation_date": 1432404652, "answer_id": 30416037, "question_id": 30413916, "link": "https://stackoverflow.com/questions/30413916/haskell-pattern-matches-overlap/30416037#30416037", "title": "Haskell - Pattern matches overlap?", "body": "<p>The problem is that <code>x</code> matches anything.</p>\n\n<p>You can use at-patterns to make them unique:</p>\n\n<pre><code>(+) (Roman (_, [])) x@(Roman(_, _:_) = x\n(+) x@(Roman(_, _:_) (Roman (_, [])) = x\n</code></pre>\n"}], "owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1432404652, "creation_date": 1432391644, "last_edit_date": 1432403825, "question_id": 30413916, "link": "https://stackoverflow.com/questions/30413916/haskell-pattern-matches-overlap", "title": "Haskell - Pattern matches overlap?", "body": "<p>Why do the pattern matches overlap in this code: </p>\n\n<pre><code>(+) (Roman (_, [])) x = x\n(+) x (Roman (_, [])) = x\n</code></pre>\n\n<p>It would make sense considering <code>x + y</code> is the same as <code>y + x</code> but I don't think haskell takes care of that, or does it?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1432390170, "post_id": 30413039, "comment_id": 48913468, "body": "the <code>Num a</code> constraint on your <code>Int -&gt; Int</code> function is meaningless; just remove it. alternatively, change from <code>Int -&gt; Int</code> to <code>a -&gt; a</code>."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 0, "last_activity_date": 1432387011, "creation_date": 1432387011, "answer_id": 30413139, "question_id": 30413039, "link": "https://stackoverflow.com/questions/30413039/haskell-problems-with-types/30413139#30413139", "title": "Haskell - problems with types", "body": "<p>you have to move <code>fac</code> one in:</p>\n\n<pre><code>mo08 f = \\xx -&gt; fac (if f (xx) then xx else xx * xx)\n</code></pre>\n\n<p>or (if you like)  move the <code>xx</code> to the left of the <code>=</code>:</p>\n\n<pre><code>mo08 f xx = fac $ if f (xx) then xx else xx * xx\n</code></pre>\n\n<p>to see why just look at <code>\\xx -&gt; ...</code> - this will be a function - here it will take an <code>Int</code> and produce an <code>Int</code> - same with <code>fac :: Int -&gt; Int</code> - so when you try <code>fac (\\xx -&gt; ...)</code> you are actually trying to plug a function into <code>fac</code> (that is what the error is trying to tell you) - but if you move the <code>fac</code> inside the definition of the lambda it will work.</p>\n\n<h2>using composition</h2>\n\n<p>of course maybe you tried to use function-composition:</p>\n\n<pre><code>mo08 f = fac . (\\xx -&gt; if f (xx) then xx else xx * xx)\n</code></pre>\n\n<p>but as you can see you need to use the composition operator <code>(.)</code> ;)</p>\n"}, {"tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": false, "score": 0, "last_activity_date": 1432387106, "creation_date": 1432387106, "answer_id": 30413159, "question_id": 30413039, "link": "https://stackoverflow.com/questions/30413039/haskell-problems-with-types/30413159#30413159", "title": "Haskell - problems with types", "body": "<p>That lambda expression (of type <code>a -&gt; a</code>) is not an integer, yet in <code>mo08</code> you are trying to call <code>fac</code> on it - while <code>fac</code> expects an <code>int</code>. You will need to to put the <code>fac</code> call on the end result:</p>\n\n<pre><code>mo08 f = (\\xx -&gt; fac (if f xx then xx else xx * xx))\n</code></pre>\n\n<p>or alternatively use function composition:</p>\n\n<pre><code>mo08 f = fac . (\\xx -&gt; if f xx then xx else xx * xx)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4931905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21b5d6f35d8711fba8cf5fe03f99bf87?s=128&d=identicon&r=PG&f=1", "display_name": "arto", "link": "https://stackoverflow.com/users/4931905/arto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 30413139, "answer_count": 2, "score": 0, "last_activity_date": 1432404301, "creation_date": 1432386372, "last_edit_date": 1432404301, "question_id": 30413039, "link": "https://stackoverflow.com/questions/30413039/haskell-problems-with-types", "title": "Haskell - problems with types", "body": "<p>I've started learning Haskell and got problems. I try to understand lambda and created function <code>mo06</code></p>\n\n<pre><code>mo06 f x = if f x\n           then x\n           else x * x\n</code></pre>\n\n<p>I can call that in ghci:</p>\n\n<pre><code>\u03bb mo06 (== 1) 1\n1\n\u03bb mo06 (== 1) 3\n9 \n</code></pre>\n\n<p>That works ok - no problems and no questions, but...</p>\n\n<p>...I want to write my function as</p>\n\n<pre><code>mo08 f = fac (\\x -&gt;  if f x then x else x * x)\n</code></pre>\n\n<p>where </p>\n\n<p><code>fac</code> means factorial:</p>\n\n<pre><code>fac :: Num a =&gt; Int -&gt; Int\nfac n\n  | n == 0    = 1\n  | n &gt; 0     = n * fac (n-1)\n  | otherwise = error \"fac only defined on natural numbers\"\n</code></pre>\n\n<p>and call it as previously</p>\n\n<pre><code>mo08 (==1) 3\n</code></pre>\n\n<p>I try and got an error:</p>\n\n<blockquote>\n  <p>Could't match expected type 'a -> a' with actual type 'Int'.</p>\n</blockquote>\n\n<p>Changing <code>fac</code>  to <code>(fromIntegr fac)</code> did not help.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1432382351, "post_id": 30412206, "comment_id": 48911072, "body": "IIRC, <code>(??)</code> is called <code>(&amp;)</code> in the lens library, while <code>(?)</code> is <code>(&gt;&gt;&gt;)</code> from <code>Control.Category</code>."}, {"owner": {"reputation": 1188, "user_id": 3450840, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/okH8Y.jpg?s=128&g=1", "display_name": "Florian F", "link": "https://stackoverflow.com/users/3450840/florian-f"}, "edited": false, "score": 0, "creation_date": 1475921932, "post_id": 30412206, "comment_id": 67144800, "body": "F# has a &quot;pipe operator&quot; that pipes the value left into the function right of it.  It is written x |&gt; f.  Example &quot;this is a test&quot; |&gt; reverse |&gt; split (==&#39; &#39;) |&gt; map reverse."}], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 2, "creation_date": 1432393220, "post_id": 30413695, "comment_id": 48914394, "body": "You are right, &quot;&#39;?&quot; and &quot;??&quot; are unintuitive. But, are there any other ascii non alphanumeric 1-character available for the task? (I think that &quot;&amp;&quot;  will be available with the next Haskell Platform, so &quot;??&quot; isn&#39;t really a problem.)"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 3, "creation_date": 1432394580, "post_id": 30413695, "comment_id": 48914811, "body": "I think you can use a preprocessor <code>if</code> to check the GHC version and conditionally define your <code>&amp;</code>; also, <code>Control.Arrow</code> has <code>&gt;&gt;&gt;</code> for reverse composition."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 1, "creation_date": 1432423677, "post_id": 30413695, "comment_id": 48922873, "body": "@AlbertoCapitani  correct, it&#39;s in ghc 7.10 in Data.Function as &amp;, I&#39;ve already been using it :)"}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 3, "last_activity_date": 1432390341, "creation_date": 1432390341, "answer_id": 30413695, "question_id": 30412206, "link": "https://stackoverflow.com/questions/30412206/forward-function-composition-operator-and-reverse-application-operator/30413695#30413695", "title": "Forward function composition operator and reverse application operator", "body": "<p>I don't think there's anything inefficient about the approach. But note that your functions can be defined more easily using <code>flip</code> on <code>.</code> and <code>$</code>:</p>\n\n<pre><code>(?)  = flip (.)\n(??) = flip ($)\n</code></pre>\n\n<p>also make sure to not forget an <code>infixl</code> declaration on your operators (preferrably something coherent with the non-reversed versions). </p>\n\n<p>P.S. I think the names <code>?</code> and <code>??</code> are highly unintuitive for what they mean. </p>\n"}], "owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 30413695, "answer_count": 1, "score": 1, "last_activity_date": 1432390341, "creation_date": 1432381098, "question_id": 30412206, "link": "https://stackoverflow.com/questions/30412206/forward-function-composition-operator-and-reverse-application-operator", "title": "Forward function composition operator and reverse application operator", "body": "<p><em>(Thank you to Rein Henrichs and  Carsten for the suggestions about a previous post - now deleted.)</em></p>\n\n<p>Even if the following is unusual in Haskell, is there something inefficient or untoward in defining forward function composition operator and reverse application operator in this way?</p>\n\n<pre><code>&gt; let (?) f g = \\x -&gt; g (f x) --  forward function composition operator\n\n&gt; :t (+3) ? (*4)\n\n&gt; (+3) ? (*4) :: Num t =&gt; t -&gt; t\n\n&gt; let x ?? f = f x -- reverse application operator\n-- For those who have the Haskell Platform 2014.2.0.0 with GHCi version 7.8.3, so Data.Function (&amp;) :: a -&gt; (a -&gt; b) -&gt; b is unavailable\n</code></pre>\n\n<p>-- example</p>\n\n<pre><code>&gt; \"roma\" ?? (reverse ? map toUpper ? concatMap (\\c -&gt; [c,' ']) ? (++ \"- \") ? repeat ? take 3? concat ? (\\cs -&gt; take (length cs - 3) cs) ? putStrLn)\n\n&gt; A M O R - A M O R - A M O R \n\n&gt; :t (reverse ? map toUpper ? concatMap (\\c -&gt; [c,' ']) ? (++ \"- \") ? repeat ? take 3? concat ? (\\cs -&gt; take (length cs - 3) cs) ? putStrLn)\n&gt; reverse ? ... ?putStrLn :: [Char] -&gt; IO ()\n</code></pre>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432374244, "post_id": 30411167, "comment_id": 48908990, "body": "<i>better</i>  is a really difficult term here - the question I had would be: why do you redefine it at all? Having said this: I <i>like</i> the first a lot more (the <i>undecidable isntances</i>  are a red flag IMO)"}, {"owner": {"reputation": 211, "user_id": 3525132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c3c589bdbd531ca5651f29149eef1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Brrch", "link": "https://stackoverflow.com/users/3525132/brrch"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432374414, "post_id": 30411167, "comment_id": 48909046, "body": "I want to write my own library for linear algebra and want to have some comfortable classes such as vector space and ring. Monoid and Semigroup are used only as an example."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432374593, "post_id": 30411167, "comment_id": 48909082, "body": "yeah fair I guess - but it&#39;s really not the best question for SO (you probably get a few close flags because it seems a bit opinion-based on the surface) - maybe a better idea is to go do reddit or the haskell IRC channels/mailing lists to discuss this (?) - especially on the later you will have lot&#39;s of really smart people that will tell you in no time why the one or the other is <b>the</b> way to go ;)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1432374631, "post_id": 30411167, "comment_id": 48909094, "body": "I really don&#39;t see what the advantage is. Could you clarify exactly what did you earn with the second code with respect to the first at the cost of allowing undecidable instances?"}, {"owner": {"reputation": 211, "user_id": 3525132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c3c589bdbd531ca5651f29149eef1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Brrch", "link": "https://stackoverflow.com/users/3525132/brrch"}, "edited": false, "score": 0, "creation_date": 1432378477, "post_id": 30411167, "comment_id": 48910052, "body": "Let&#39;s say I define a InnerProductSpace as: class VectorSpace s =&gt; InnerProductSpace s where     product :: s -&gt; s -&gt; Float Then, I want to make InnerProductSpace a MetricSpace, then I have to use an instance declaration..."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432380536, "post_id": 30411167, "comment_id": 48910591, "body": "maybe you are overdoing the type-classes here - but in this scenario it&#39;s a bit different because not every metric space comes from a inner product - but of course every monoid is a semigroup"}, {"owner": {"reputation": 211, "user_id": 3525132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c3c589bdbd531ca5651f29149eef1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Brrch", "link": "https://stackoverflow.com/users/3525132/brrch"}, "edited": false, "score": 0, "creation_date": 1432380625, "post_id": 30411167, "comment_id": 48910614, "body": "But every inner prudct space is a metric space"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1432382249, "post_id": 30411167, "comment_id": 48911048, "body": "In my opinion flexible and undecidable instances are harmless, in practice. However, the second approach requires overlapping instances if you want some semigroups which are not monoids, and <i>that</i> is where the real pain comes from. Overlapping and incoherent instances have a quite subtle semantics, which is hard to grasp, and can easily lead to unwanted surprises."}], "answers": [{"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 4, "last_activity_date": 1432424885, "creation_date": 1432424885, "answer_id": 30418689, "question_id": 30411167, "link": "https://stackoverflow.com/questions/30411167/the-relationship-between-type-classes-dependency-vs-using-instance/30418689#30418689", "title": "The relationship between type classes - dependency vs using instance", "body": "<p>The first version says \"monoids are semigroups, with the additional property <code>mempty</code>\".</p>\n\n<p>The second certain says \"all types are semigroups, provided they are also monoids\". Unless you're happy to turn on overlapping instances you can't add any other instances, so this amounts to \"a type is a semigroup if and only if it is a monoid\"; exactly backwards from the true relationship.</p>\n\n<p>I would almost always prefer the former. Yes, it forces someone wanting to add a <code>Monoid</code> instance to also write a <code>Semigroup</code> instance, but the real \"work\" they have to do is the same either way: decide on implementations for <code>mempty</code> and <code>mappend</code>. The only thing you save them from by using the second approach is a little boilerplate.</p>\n"}], "owner": {"reputation": 211, "user_id": 3525132, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6c3c589bdbd531ca5651f29149eef1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Brrch", "link": "https://stackoverflow.com/users/3525132/brrch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 30418689, "answer_count": 1, "score": 3, "last_activity_date": 1432424885, "creation_date": 1432373995, "question_id": 30411167, "link": "https://stackoverflow.com/questions/30411167/the-relationship-between-type-classes-dependency-vs-using-instance", "title": "The relationship between type classes - dependency vs using instance", "body": "<p>Let's say I want to define my own type classes for semigroup and monoid. So I write this code:</p>\n\n<pre><code>class Semigroup g where\n    (&lt;&gt;) :: g -&gt; g -&gt; g\n\nclass Semigroup m =&gt; Monoid m where\n    mempty :: m\n</code></pre>\n\n<p>But there's another way I could define the relationship between those type classes, with some extensions:</p>\n\n<pre><code>class Semigroup g where\n    gappend :: g -&gt; g -&gt; g\n\nclass Monoid m where\n    mempty :: m\n    mappend :: m -&gt; m -&gt; m\n\ninstance Monoid m =&gt; Semigroup m where\n    gappend = mappend\n</code></pre>\n\n<p>The latter design has an advantage - Later I can add more instances for Monoid. For example, if I have a typeclass for a vector space I can later make it an additive group without having to specify it in the class declaration. On the other hand, I am forced to use flexible instances and undecidable instances.</p>\n\n<p>My question is - what is the best design for this particular case?</p>\n"}, {"tags": ["haskell", "terminal", "filehandle", "pty"], "answers": [{"comments": [{"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 0, "creation_date": 1432404669, "post_id": 30408657, "comment_id": 48918103, "body": "Whoops, that&#39;s probably the issue. I&#39;ll check later tonight when I get home."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1432352283, "creation_date": 1432352283, "answer_id": 30408657, "question_id": 30408500, "link": "https://stackoverflow.com/questions/30408500/hgetline-from-dev-pty-n/30408657#30408657", "title": "hGetLine from /dev/pty/N?", "body": "<p>Don't you want to read from the master handle?</p>\n\n<pre><code>...\nhMaster &lt;- fdToHandle master\nhGetContents hMaster &gt;&gt;= print . take 10\n...\n</code></pre>\n"}], "owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 30408657, "answer_count": 1, "score": 1, "last_activity_date": 1432352283, "creation_date": 1432350441, "question_id": 30408500, "link": "https://stackoverflow.com/questions/30408500/hgetline-from-dev-pty-n", "title": "hGetLine from /dev/pty/N?", "body": "<p>I'm trying to read from a pseudoterminal. My eventual goal is to hook up input/output from the pseudoterminal to reactive-banana events, but right now I'm just trying to from the pseudoterminal in Haskell code and write to it in the shell. I have the following code in Main.hs:</p>\n\n<pre><code>import System.Posix.Terminal\nimport System.Posix.IO\n\nmain :: IO ()\nmain = do\n    (master, slave) &lt;- openPseudoTerminal\n    getTerminalName slave &gt;&gt;= print\n    hSlave &lt;- fdToHandle slave\n\n    hGetContents hSlave &gt;&gt;= print . take 10\n</code></pre>\n\n<p>When it runs, I see something like:</p>\n\n<pre><code>\"/dev/pts/7\"\n</code></pre>\n\n<p>So I expect that I can write to it with something like this</p>\n\n<pre><code>echo \"hellllllllllllllllllllllllllloooo\" &gt; /dev/pts/7\n</code></pre>\n\n<p>in another shell. But nothing ever gets printed after the <code>\"/dev/pts/N\"</code> line when I run Main.hs --- it looks like it just blocks forever waiting for input. I also tried using <code>hGetLine</code> and <code>hGetChar</code> in place of <code>hGetContents</code>, but with no luck. What am I missing here?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 4, "creation_date": 1432351002, "post_id": 30408488, "comment_id": 48904398, "body": "@paxdiablo  it uses tail recursion which means no stack overflow and no pun intended. No pun intended."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1432351051, "post_id": 30408488, "comment_id": 48904409, "body": "It&#39;s helpful to potential answerers if you include the error message. <a href=\"http://stackoverflow.com/help/on-topic\">&quot;Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, <i>a specific problem or error</i> and the shortest code necessary to reproduce it in the question itself.&quot;</a>."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 3, "creation_date": 1432351253, "post_id": 30408488, "comment_id": 48904433, "body": "@paxdiablo Evaluating this function in Haskell uses constant space without blowing the stack. The Haskell standard library implementation of the same function calls <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/src/Data-List.html#findIndices\" rel=\"nofollow noreferrer\"><code>findIndices</code> which uses recursion</a>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1432357893, "post_id": 30408488, "comment_id": 48905493, "body": "@paxdiablo Well, since we can&#39;t use anything other than recursion, I suppose we&#39;re stuck."}, {"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1432358844, "post_id": 30408488, "comment_id": 48905676, "body": "@paxdiablo There is no call stack in Haskell."}, {"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "edited": false, "score": 0, "creation_date": 1432368850, "post_id": 30408488, "comment_id": 48907827, "body": "My comment @paxdiablo was incorrect. Haskell has no stack. Tail recursion in this case does nothing to optimize."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1432410277, "post_id": 30408488, "comment_id": 48919729, "body": "@BrianYeh Haskell does have a stack, it just isn&#39;t a call stack."}], "answers": [{"tags": [], "owner": {"reputation": 24942, "user_id": 688653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/978a9f5060338657ddeb3781c6a3a2c8?s=128&d=identicon&r=PG", "display_name": "zw324", "link": "https://stackoverflow.com/users/688653/zw324"}, "is_accepted": true, "score": 3, "last_activity_date": 1432372236, "last_edit_date": 1432372236, "creation_date": 1432351011, "answer_id": 30408553, "question_id": 30408488, "link": "https://stackoverflow.com/questions/30408488/beginner-haskell-code-is-totally-incorrect/30408553#30408553", "title": "Beginner haskell code is totally incorrect", "body": "<p>The code is searching for the index of a number, which means is should return an <code>Int</code>:</p>\n\n<pre><code>linear_search :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\n</code></pre>\n\n<p>There's also a similar problem, see if you can find out!</p>\n\n<blockquote class=\"spoiler\">\n  <p> <code>linear_search_tail :: (Eq a) =&gt; Int -&gt; a -&gt; [a] -&gt; Int</code></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1432373191, "post_id": 30410923, "comment_id": 48908770, "body": "Check the &quot;Here&#39;s another one&quot; example: you are matching against a List and a Tuple. Also the Int is really in the first position of the pair, not the second. That won&#39;t typecheck. You probably meant &quot;  ((i, _):xs) -&gt; Just i&quot;"}, {"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1432373503, "post_id": 30410923, "comment_id": 48908825, "body": "Also check the first example of the library example: &quot;find&quot; returns the matching element, not its index. This also doesn&#39;t typecheck."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1432381286, "post_id": 30410923, "comment_id": 48910798, "body": "@MartinDrautzburg Indeed! Thank you."}, {"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1432397336, "post_id": 30410923, "comment_id": 48915647, "body": "You still have the &quot;i&quot; in the second position and it should be in the first. It is just not your day it seems."}, {"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "edited": false, "score": 0, "creation_date": 1432398062, "post_id": 30410923, "comment_id": 48915873, "body": "Great comment. I actually made another minor style improvement to the code.   for &quot;linear_search b = linear_search_tail 0&quot; you can actually just write &quot;linear_search = linear_search_tail 0&quot;"}, {"owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "edited": false, "score": 0, "creation_date": 1432398674, "post_id": 30410923, "comment_id": 48916043, "body": "For the comment above... There&#39;s an additional edit...  you actually have to make additional changes to the example your example to get it to work.  The guard will have to be changed from &quot;| b == z    = Just x&quot; to &quot;| x == z    = Just x&quot;"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1432397659, "last_edit_date": 1432397659, "creation_date": 1432372121, "answer_id": 30410923, "question_id": 30408488, "link": "https://stackoverflow.com/questions/30408488/beginner-haskell-code-is-totally-incorrect/30410923#30410923", "title": "Beginner haskell code is totally incorrect", "body": "<p>Let me add some comments on the corrected code:</p>\n\n<pre><code>linear_search :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\nlinear_search b w = linear_search_tail 0 b w\n  where linear_search_tail :: (Eq a) =&gt; Int -&gt; a -&gt; [a] -&gt; Int \n        linear_search_tail x y [] = -1\n        linear_search_tail x y (z:zs)\n              | y == z = x\n              | otherwise = linear_search_tail (x+1) y zs\n</code></pre>\n\n<p>In the auxiliary function, the second parameter <code>y</code> is passed around unchanged, so it's always equal to <code>b</code>. You can remove the parameter and directly use that:</p>\n\n<pre><code>linear_search :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\nlinear_search b w = linear_search_tail 0 w\n  where -- linear_search_tail :: (Eq a) =&gt; Int -&gt; [a] -&gt; Int \n        linear_search_tail x [] = -1\n        linear_search_tail x (z:zs)\n              | b == z    = x\n              | otherwise = linear_search_tail (x+1) zs\n</code></pre>\n\n<p>(Here I had to remove/comment the inner type signature since Haskell interprets the inner <code>a</code> type variable to be independent from the outer <code>a</code> -- you can state that these are the same by enabling an extension, but let's keep it simple and just omit the signature.)</p>\n\n<p>The above function returns <code>-1</code> on error. This is not idiomatic in Haskell, where it is more common to return a <code>Maybe Int</code>, which is a type containing values representing integers <code>Just 0, Just 1, Just 2, ...</code> plus a distinct value <code>Nothing</code> that can be interpreted as \"no result\". If we use that we get:</p>\n\n<pre><code>linear_search :: (Eq a) =&gt; a -&gt; [a] -&gt; Maybe Int\nlinear_search b w = linear_search_tail 0 w\n  where linear_search_tail x [] = Nothing\n        linear_search_tail x (z:zs)\n              | b == z    = Just x\n              | otherwise = linear_search_tail (x+1) zs\n</code></pre>\n\n<p>Note that this will make life <em>less</em> convenient for the caller, which now gets its index wrapped in a <code>Just</code> box, or <code>Nothing</code>. This is actually a good thing, since now the caller can not easily forget to check for the \"not found\" case and use a plain integer pretending it's not <code>-1</code>. The caller is now forced to use something like</p>\n\n<pre><code>case linear_search 1 [2,3,4,5] of\n   Just x  -&gt; \"Found at position \" ++ x\n   Nothing -&gt; \"Not found!\"\n</code></pre>\n\n<p>Finally, note that the first line</p>\n\n<pre><code>linear_search b w = linear_search_tail 0 w\n</code></pre>\n\n<p>can also be written as</p>\n\n<pre><code>linear_search b = linear_search_tail 0\n</code></pre>\n\n<p>That is, you can omit the same variable(s) in the trailing position of a definition. This is called eta-reduction, and does not necessarily make your code look better. In this case, it's not helping much. I just mention it since you may see some code like this in the future.</p>\n\n<hr>\n\n<p>After you learn some more Haskell, you might want to know how to exploit library functions for this. For instance, the <code>elemIndex</code> library function from <code>Data.List</code> performs the linear search you are trying to write. Alternatively,</p>\n\n<pre><code>linear_search :: (Eq a) =&gt; a -&gt; [a] -&gt; Maybe Int\nlinear_search x xs = case filter ((x ==) . snd) $ zip [0..] xs of\n                     []       -&gt; Nothing\n                     (i, _):_ -&gt; Just i\n</code></pre>\n\n<p>You probably find this unreadable right now, but you can go on with your learning and get back at this later on when you are more familiar with Haskell. In the meantime, writing recursive functions as you did is the right approach.</p>\n"}], "owner": {"reputation": 2535, "user_id": 1760720, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2725d511128304107f17561e03888cdb?s=128&d=identicon&r=PG", "display_name": "Brian Yeh", "link": "https://stackoverflow.com/users/1760720/brian-yeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 30408553, "answer_count": 2, "score": 0, "last_activity_date": 1432397659, "creation_date": 1432350362, "last_edit_date": 1432352381, "question_id": 30408488, "link": "https://stackoverflow.com/questions/30408488/beginner-haskell-code-is-totally-incorrect", "title": "Beginner haskell code is totally incorrect", "body": "<p>I'm really new to haskell. Tried to implement something really simple with recursion. A function that returns the index of the first matching value in a list. The code below won't work, not sure why, does anyone know How I could correct this code? </p>\n\n<pre><code>linear_search :: (Eq a) =&gt; a -&gt; [a] -&gt; a\nlinear_search b w = linear_search_tail 0 b w\n  where linear_search_tail :: (Eq a) =&gt; a -&gt; a -&gt; [a] -&gt; a\n        linear_search_tail x y [] = -1\n        linear_search_tail x y (z:zs)\n          | y == z = x\n          | otherwise = linear_search_tail (x+1) y zs\n\nmain :: IO ()\nmain = print (linear_search 1 [2,5,4,3,7,3,1,2,3,4,5,7,8])\n</code></pre>\n\n<p>EDIT: Got it working. this is the correct code:</p>\n\n<pre><code>#!/usr/bin/env runghc\n\nlinear_search :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\nlinear_search b w = linear_search_tail 0 b w\n  where linear_search_tail :: (Eq a) =&gt; Int -&gt; a -&gt; [a] -&gt; Int \n        linear_search_tail x y [] = -1\n        linear_search_tail x y (z:zs)\n              | y == z = x\n              | otherwise = linear_search_tail (x+1) y zs\n\nmain :: IO ()\nmain = print (linear_search 1 [2,5,4,3,7,3,1,2,3,4,5,7,8])\n</code></pre>\n"}, {"tags": ["date", "haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": true, "score": 5, "last_activity_date": 1432448024, "last_edit_date": 1432448024, "creation_date": 1432351007, "answer_id": 30408552, "question_id": 30408355, "link": "https://stackoverflow.com/questions/30408355/dates-between-today-and-another-date/30408552#30408552", "title": "Dates between today and another date", "body": "<p>Your <code>formatTime</code> version returns a string, but you want a <code>Day</code> (which looks like your string when you inspect it, but is a different type entirely). Here's one way to write a <code>today</code> function, using <code>utctDay</code> to get a <code>Day</code> out of a <code>UTCTime</code>:</p>\n\n<pre><code>import Data.Time.Calendar\nimport Data.Time.Clock\n\ntoday :: IO Day\ntoday = fmap utctDay getCurrentTime\n</code></pre>\n\n<p>And here's a days-from-today function (which I gave the shorter name <code>daysAway</code>) that uses it:</p>\n\n<pre><code>daysAway :: Day -&gt; IO Integer\ndaysAway day = fmap (diffDays day) today\n</code></pre>\n\n<p>If you're always specifying the target as a calendar date, you can do that easily enough:</p>\n\n<pre><code>daysToDate :: Integer -&gt; Int -&gt; Int -&gt; IO Integer\ndaysToDate year month day = daysAway $ fromGregorian year month day\n</code></pre>\n\n<p>Given a shorthand function for a commonly-needed relative day:</p>\n\n<pre><code>tomorrow :: IO Day\ntomorrow = fmap (addDays 1) today\n</code></pre>\n\n<p>We can demonstrate the correctness of Annie's Thesis:</p>\n\n<pre><code>ghci&gt; tomorrow &gt;&gt;= daysAway\n1\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4930964"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "accepted_answer_id": 30408552, "answer_count": 1, "score": 3, "last_activity_date": 1432448024, "creation_date": 1432348897, "question_id": 30408355, "link": "https://stackoverflow.com/questions/30408355/dates-between-today-and-another-date", "title": "Dates between today and another date", "body": "<p>im burning my brains trying to make a function that gives me the ammount of days between todays date and a given date.</p>\n\n<p>possible <strong>today</strong> function:</p>\n\n<pre><code>today = fmap (formatTime defaultTimeLocale \"%Y-%m-%d\") getCurrentTime\n</code></pre>\n\n<p>and thought using <code>diffDays</code>, but wont be able to make it work with a <strong>::Day</strong> date</p>\n\n<p>any ideas?</p>\n"}, {"tags": ["haskell", "conduit", "attoparsec"], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1432376670, "last_edit_date": 1432376670, "creation_date": 1432369160, "answer_id": 30410508, "question_id": 30408059, "link": "https://stackoverflow.com/questions/30408059/conduit-and-attoparsec-extracting-delimited-text/30410508#30410508", "title": "Conduit and Attoparsec - extracting delimited text", "body": "<p>Because it uses <code>many</code>, <code>findFoos</code> will return <code>[]</code> without consuming input when it doesn't find any delimited text.</p>\n\n<p>On the other hand, <code>conduitParser</code> applies a parser <em>repeatedly</em> on a stream, returning each parsed value until it exhausts the stream.</p>\n\n<p>The problem with <code>\"{{foo}} \"</code> is that the parser will consume <code>{{foo}}</code>, but the blank space remains unconsumed in the stream, so further invocations of the parser always return <code>[]</code>.</p>\n\n<p>If you redefine <code>findFoos</code> to consume one quoted element at a time, including the trailing blanks, it should work:</p>\n\n<pre><code>findFoos' :: Parser String\nfindFoos' = do\n   manyTill anyChar (string \"{{\")\n   manyTill letter (string \"}}\") &lt;* skipSpace\n</code></pre>\n\n<p>Real-world examples will have other characters between bracketed texts, so skipping the \"extra stuff\" after each parse (without consuming any of the <code>{{</code> opening braces for the next parse) will be a bit more involved.</p>\n\n<p>Perhaps something like the following will work:</p>\n\n<pre><code>findFoos'' :: Parser String\nfindFoos'' = do\n    manyTill anyChar (string \"{{\")\n    manyTill letter (string \"}}\") &lt;* skipMany everythingExceptOpeningBraces\n  where \n    -- is there a simpler / more efficient way of doing this?\n    everythingExceptOpeningBraces =\n        -- skip one or more non-braces\n        (skip (/='{') *&gt; skipWhile (/='{'))\n        &lt;|&gt; \n        -- skip single brace followed by non-brace character\n        (skip (=='{') *&gt; skip (/='{'))\n        &lt;|&gt;\n        -- skip a brace at the very end \n        (skip (=='{') *&gt; endOfInput)\n</code></pre>\n\n<p>(This parser will fail, however, if there aren't any bracketed texts in the stream. Perhaps you could build a <code>Parser (Maybe Text)</code> that returns <code>Nothing</code> in that case.)</p>\n"}], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 30410508, "answer_count": 1, "score": 0, "last_activity_date": 1432376670, "creation_date": 1432345472, "question_id": 30408059, "link": "https://stackoverflow.com/questions/30408059/conduit-and-attoparsec-extracting-delimited-text", "title": "Conduit and Attoparsec - extracting delimited text", "body": "<p>Say I have a document with text delimited by Jade-style brackets, like <code>{{foo}}</code>. I've written an Attoparsec parser that seems to extract <code>foo</code> properly:</p>\n\n<pre><code>findFoos :: Parser [T.Text]\nfindFoos = many $ do\n  manyTill anyChar (string \"{{\")\n  manyTill letter (string \"}}\")\n</code></pre>\n\n<p>Testing it shows that it works:</p>\n\n<pre><code>&gt; parseOnly findFoos \"{{foo}}\"\nRight [\"foo\"]\n&gt; parseOnly findFoos \"{{foo}} \"\nRight [\"foo\"]\n</code></pre>\n\n<p>Now, with the <code>Data.Conduit.Attoparsec</code> module in <code>conduit-extra</code>, I seem to be running into strange behavior:</p>\n\n<pre><code>&gt; yield \"{{foo}}\" $= (mapOutput snd $ CA.conduitParser findFoos) $$ CL.mapM_ print\n[\"foo\"]\n&gt; yield \"{{foo}} \" $= (mapOutput snd $ CA.conduitParser findFoos) $$ CL.mapM_ print\n-- floods stdout with empty lists\n</code></pre>\n\n<p>Is this the desired behavior? Is there a conduit utility I should be using here? Any help with this would be tremendous!</p>\n"}, {"tags": ["haskell", "permutation"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 3, "last_activity_date": 1450795559, "last_edit_date": 1450795559, "creation_date": 1432350302, "answer_id": 30408481, "question_id": 30408038, "link": "https://stackoverflow.com/questions/30408038/get-permutations-with-a-particular-first-element/30408481#30408481", "title": "Get permutations with a particular first element", "body": "<p>The permutations of <code>[1, 2, 3]</code> that start with <code>1</code> are just the permutations of <code>[2, 3]</code> with <code>1</code> added to the front, which you can calculate using</p>\n\n<pre><code>map (1:) . perm $ [2, 3]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4429005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/446dc76b03bc719c32632a9ea8d34709?s=128&d=identicon&r=PG", "display_name": "Kim Doe", "link": "https://stackoverflow.com/users/4429005/kim-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450795559, "creation_date": 1432345237, "last_edit_date": 1445269998, "question_id": 30408038, "link": "https://stackoverflow.com/questions/30408038/get-permutations-with-a-particular-first-element", "title": "Get permutations with a particular first element", "body": "<p>how can I get conditioned permutations in Haskell?</p>\n\n<p>This is my code:</p>\n\n<pre><code>perm :: [Int] -&gt; [[Int]]\nperm [] = [[]]\nperm xs = [ x:ps | x &lt;- xs , ps &lt;- perm ( xs\\\\[x] ) ]\n</code></pre>\n\n<p>But I want to get all the permutations that begins with 1. When I execute: </p>\n\n<pre><code>perm [1,2,3]\n</code></pre>\n\n<p>I want to get just this:</p>\n\n<pre><code>[[1,2,3],[1,3,2]]\n</code></pre>\n\n<p>I want to put some condition in the function \"perm\" that allows me to do this while its doing the permutations, I don't want to do a filter because I don't want to calculate all the permutations.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1432338246, "post_id": 30407124, "comment_id": 48902251, "body": "<code>Traversable</code> doesn&#39;t have a notion of &quot;right&quot; vs. &quot;left&quot; associativity; and <code>Foldable</code> doesn&#39;t have a notion of structure-preserving operations. So you will almost certainly need either a separate instance of <code>Traversable</code> that visits elements in the correct order, or a separate typeclass that mixes the notions of visitation order and structure preservation. I would make this an answer, except &quot;you can&#39;t&quot; is a pretty strong claim that I don&#39;t really know how to prove. But I&#39;ll be happy to discuss the suggestions I&#39;ve made here further if either of them seem palatable."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1432343094, "post_id": 30407124, "comment_id": 48903169, "body": "Okay, I just went ahead and discussed both suggestions anyway. ;-)"}, {"owner": {"reputation": 604, "user_id": 717881, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aac21dfd75e7d66cc8476bdbca6d2153?s=128&d=identicon&r=PG", "display_name": "ghorn", "link": "https://stackoverflow.com/users/717881/ghorn"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1432662710, "post_id": 30407124, "comment_id": 49011547, "body": "This comment was enlightening, thank you. I accepted your simpler answer because it&#39;s the one which is easiest for me to implement because my data structure has a reverse function."}], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1432348250, "post_id": 30407821, "comment_id": 48903980, "body": "What exactly are &quot;polynomial functors&quot; ? Google only yields incomprehensible (to the mere mortal) category theory. For example, is <code>data Spine [] a r = Cons a r</code> a polynomial functor?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1432352923, "post_id": 30407821, "comment_id": 48904682, "body": "@user2407038 Polynomial functors are the ones that are constructed from products and sums of the given type (and nothing else -- so no fixed points). <code>data Spine [] a r = Cons a r</code> is a polynomial functor (and in fact a polynomial bifunctor). You might like the paper <a href=\"http://eprints.eemcs.utwente.nl/7281/01/db-utwente-40501F46.pdf\" rel=\"nofollow noreferrer\">Functional Programming with Bananas, Lenses, Envelopes and Barbed Wire</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1432353009, "post_id": 30407821, "comment_id": 48904691, "body": "@user2407038 However, I wasn&#39;t being quite precise. The truth is it doesn&#39;t matter whether the functor is a polynomial or not; the only important thing is that the fixed point of the functor is (isomorphic to) the type you want to traverse."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1432342607, "creation_date": 1432342607, "answer_id": 30407821, "question_id": 30407124, "link": "https://stackoverflow.com/questions/30407124/how-to-implement-mapaccumrm/30407821#30407821", "title": "how to implement mapAccumRM?", "body": "<p>One could consider defining a new type class for ordered traversals. Let's see one way this might be done. We'll need a little prelude:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types, TypeFamilies #-}\n\nimport Control.Applicative\nimport Data.Foldable\nimport Data.Traversable\nimport Data.Tree\n</code></pre>\n\n<p>Most Haskell data types can be viewed as fixed-points of polynomial functors; and the functors that they are fixed-points of are good descriptions of the \"spine\" of the data structure. We'll abuse this idea to give a concrete way to encode the ordering that should be used during traversal. The class itself looks like this:</p>\n\n<pre><code>type Order t = forall f a. Applicative f =&gt; Spine t (f a) (f (t a)) -&gt; f (t a)\n\nclass OrderedTraversable t where\n    data Spine t :: * -&gt; * -&gt; *\n    otraverse :: Applicative f =&gt; Order t -&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n</code></pre>\n\n<p>Notice that the type of <code>otraverse</code> looks just like the type of <code>traverse</code>, except that it now takes an extra ordering argument. The ordering argument is, in a sense, variadic; since different data types have different numbers of values/children at various places in their structure, and the ordering may care about all of them. (Of special interest is here is the technique of using rank-2 types to prevent an ordering from observing \"too much\" about a data structure: it can't use special facts about a given instance of <code>Applicative</code> or given kind of element to decide how to traverse a spine, only decisions based on the shape of the spine are allowed.) Let's see a simple example, for lists:</p>\n\n<pre><code>instance OrderedTraversable [] where\n    -- Cute hack: the normal presentation for the spine of a list uses both\n    -- a `Cons` and a `Nil`; but parametricity says the only thing an\n    -- `Order []` can do with a `Nil` is `pure []` anyway. So let's just\n    -- bake that into `otraverse`.\n    data Spine [] a r = Cons a r\n    otraverse order f = go where\n        go []     = pure []\n        go (x:xs) = order (Cons (f x) (go xs))\n</code></pre>\n\n<p>Compare with the implementation of <code>Traversable</code> for lists in the standard library (I have taken the liberty of expanding the definition of <code>foldr</code> to make it more closely match the code above):</p>\n\n<pre><code>instance Traversable [] where\n    traverse f = go where\n        go [] = pure []\n        go (x:xs) = (:) &lt;$&gt; f x &lt;*&gt; go xs\n</code></pre>\n\n<p>As you can see, the primary difference is that we have abstracted which function to use to combine <code>f x</code> and <code>go xs</code>. We can recover the standard <code>Traversable</code> instance with a \"head-first\" order. There is also a \"last-first\" order; and these are basically the only two orders that make sense for lists.</p>\n\n<pre><code>headFirst, lastFirst :: Order []\nheadFirst (Cons fx fxs) = liftA2       (:)  fx fxs\nlastFirst (Cons fx fxs) = liftA2 (flip (:)) fxs fx\n</code></pre>\n\n<p>In ghci, we can now see how they differ:</p>\n\n<blockquote>\n<pre><code>&gt; runState (traverse (\\_ -&gt; modify (+1) &gt;&gt; get) \"hello, world!\") 0\n([1,2,3,4,5,6,7,8,9,10,11,12,13],13)\n&gt; runState (otraverse headFirst (\\_ -&gt; modify (+1) &gt;&gt; get) \"hello, world!\") 0\n([1,2,3,4,5,6,7,8,9,10,11,12,13],13)\n&gt; runState (otraverse lastFirst (\\_ -&gt; modify (+1) &gt;&gt; get) \"hello, world!\") 0\n([13,12,11,10,9,8,7,6,5,4,3,2,1],13)\n</code></pre>\n</blockquote>\n\n<p>To give another example, here is how you might use this class with rose trees:</p>\n\n<pre><code>instance OrderedTraversable Tree where\n    data Spine Tree a r = SNode a [r]\n    otraverse order f = go where\n        go (Node x ts) = order (SNode (f x) (map go ts))\n\n-- two example orders for trees\nprefix, postfix :: Order [] -&gt; Order Tree\nprefix  list (SNode fx fts) = liftA2       Node  fx (otraverse list id fts)\npostfix list (SNode fx fts) = liftA2 (flip Node) (otraverse list id fts) fx\n</code></pre>\n\n<p>Note that there are actually infinitely many \"good\" ordering functions for rose trees; two that are particularly likely to be what you want are included above.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1432343071, "creation_date": 1432343071, "answer_id": 30407861, "question_id": 30407124, "link": "https://stackoverflow.com/questions/30407124/how-to-implement-mapaccumrm/30407861#30407861", "title": "how to implement mapAccumRM?", "body": "<p>One approach is to define new instances of <code>Traversable</code> that use the ordering you like. For example, for lists, one might simply define a new type:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nimport Control.Applicative\nimport Data.Traversable\n\nnewtype BackwardsList a = BackwardsList [a]\n    deriving (Eq, Ord, Read, Show, Functor, Foldable)\n\ninstance Traversable BackwardsList where\n    traverse f (BackwardsList xs) = BackwardsList &lt;$&gt; go xs where\n        go [] = pure []\n        go (x:xs) = liftA2 (flip (:)) (go xs) (f x)\n</code></pre>\n\n<p>In ghci, we can see the difference between this and the standard instance:</p>\n\n<blockquote>\n<pre><code>&gt; runState (traverse (\\_ -&gt; modify (+1) &gt;&gt; get) \"hello, world!\") 0\n([1,2,3,4,5,6,7,8,9,10,11,12,13],13)\n&gt; runState (traverse (\\_ -&gt; modify (+1) &gt;&gt; get) (BackwardsList \"hello, world!\")) 0\n(BackwardsList [13,12,11,10,9,8,7,6,5,4,3,2,1],13)\n</code></pre>\n</blockquote>\n\n<p>This approach is fairly simple; however, it requires a new type (and the associated newtype wrapping/unwrapping garbage) for every new traversal order that you are interested in.</p>\n"}], "owner": {"reputation": 604, "user_id": 717881, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aac21dfd75e7d66cc8476bdbca6d2153?s=128&d=identicon&r=PG", "display_name": "ghorn", "link": "https://stackoverflow.com/users/717881/ghorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 30407861, "answer_count": 2, "score": 1, "last_activity_date": 1432343071, "creation_date": 1432336109, "last_edit_date": 1495540265, "question_id": 30407124, "link": "https://stackoverflow.com/questions/30407124/how-to-implement-mapaccumrm", "title": "how to implement mapAccumRM?", "body": "<p>I asked a similar question before (<a href=\"https://stackoverflow.com/questions/11652809/how-to-implement-mapaccumm\">how to implement mapAccumM?</a>).</p>\n\n<p>I need the one which folds from the right as well (<code>mapAccumR</code>):</p>\n\n<pre><code>mapAccumRM :: (Monad m, Traversable t) \n           =&gt; (a -&gt; b -&gt; m (a, c)) -&gt; a -&gt; t b -&gt; m (a, t c)\n</code></pre>\n\n<p>Is there a simple implementation for this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1432330148, "creation_date": 1432330148, "answer_id": 30406139, "question_id": 30405912, "link": "https://stackoverflow.com/questions/30405912/editing-element-of-data-map-haskell/30406139#30406139", "title": "Editing element of Data.Map haskell", "body": "<pre><code>import qualified Data.Map as M\n\nmod :: (Ord k0, Ord k1) =&gt; M.Map (k0, k1) a -&gt; [(k0, k1, a)] -&gt; M.Map (k0, k1) a\nmod m l = M.fromList (map (\\(a,b,c) -&gt; ((a,b),c)) l) `M.union` m\n</code></pre>\n\n<p>Explained: take your list <code>l</code> of triples <code>(a,b,c)</code> and change those into <code>((a,b),c)</code>. </p>\n\n<pre><code>map (\\(a,b,c) -&gt; ((a,b),c)) l\n</code></pre>\n\n<p>With the new list, make a new map.</p>\n\n<pre><code>M.fromList (map (\\(a,b,c) -&gt; ((a,b),c)) l)\n</code></pre>\n\n<p>Then use <code>M.union</code> to union the new map above and the old one <code>m</code>:</p>\n\n<pre><code>M.fromList (map (\\(a,b,c) -&gt; ((a,b),c)) l) `M.union` m\n</code></pre>\n\n<p>Since <code>M.union</code> is left-biased, the associations in the left map have higher precedence over the ones in the right map, effectively replacing the old values with the new ones.</p>\n"}, {"tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": false, "score": 1, "last_activity_date": 1432330265, "creation_date": 1432330265, "answer_id": 30406164, "question_id": 30405912, "link": "https://stackoverflow.com/questions/30405912/editing-element-of-data-map-haskell/30406164#30406164", "title": "Editing element of Data.Map haskell", "body": "<pre><code>mod = foldr (\\(a, b, c) -&gt; Map.insert (a, b) c)\n</code></pre>\n\n<p>The idea is really simple: we can insert elements from the list one by one using the <code>fold</code> function.</p>\n"}], "owner": {"reputation": 31, "user_id": 4930580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f905629565179e4018451cdc2aa5ab1?s=128&d=identicon&r=PG&f=1", "display_name": "spokoziom15", "link": "https://stackoverflow.com/users/4930580/spokoziom15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1432330265, "creation_date": 1432328987, "last_edit_date": 1432329834, "question_id": 30405912, "link": "https://stackoverflow.com/questions/30405912/editing-element-of-data-map-haskell", "title": "Editing element of Data.Map haskell", "body": "<p>I have got a map <code>(Map (Int,Int) Int)</code> (call it <code>Mapp</code>). I want to create a function <code>mod :: Mapp -&gt; [(Int,Int,Int)] -&gt; Mapp</code> which for every triple (a,b,c) of given list sets <code>Mapp[(a,b)] = c</code>. How to do it?</p>\n"}, {"tags": ["list", "haskell", "indexing"], "comments": [{"owner": {"reputation": 167, "user_id": 4447461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f23cc488cbc960cbd8905b0fdb1818?s=128&d=identicon&r=PG&f=1", "display_name": "akhil gupta", "link": "https://stackoverflow.com/users/4447461/akhil-gupta"}, "edited": false, "score": 0, "creation_date": 1432326869, "post_id": 30405381, "comment_id": 48898565, "body": "I think this might be helpful    <a href=\"http://stackoverflow.com/questions/5852722/replace-individual-list-elements-in-haskell\" title=\"replace individual list elements in haskell\">stackoverflow.com/questions/5852722/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 1, "last_activity_date": 1432326927, "last_edit_date": 1432326927, "creation_date": 1432326760, "answer_id": 30405446, "question_id": 30405381, "link": "https://stackoverflow.com/questions/30405381/switching-2-elements-in-a-list-by-index-haskell/30405446#30405446", "title": "Switching 2 elements in a list by index Haskell", "body": "<p>Pattern matching is useful here</p>\n\n<pre><code>swap 1 (x:y:rest) = y:x:rest\nswap n (x:y:z:rest) = x : swap (n - 1) (y:z:rest)\nswap _ _ = error \"Not enough elements to swap\"\n</code></pre>\n\n<p>Note, this doesn't guard against non-positive <code>n</code>, you can add that feature yourself.</p>\n\n<p>The logic for approaching these kinds of problems is to consider the simplest cases.  For this problem the simplest case is where you want to swap the first two elements, that's easy with pattern matching.  The next case is where you want to swap two elements that aren't the first two, but this can be reduced (via recursion) to the case where you're swapping the first two elements of a sublist.  In order to get to that case, you just decrement the index and move to the next element.  In all other cases you have an error.</p>\n"}], "owner": {"reputation": 319, "user_id": 4916010, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c1ccc8f19d83f83174b053fe436eba2?s=128&d=identicon&r=PG&f=1", "display_name": "Lerul Ler", "link": "https://stackoverflow.com/users/4916010/lerul-ler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 30405446, "answer_count": 1, "score": -1, "last_activity_date": 1432326927, "creation_date": 1432326480, "question_id": 30405381, "link": "https://stackoverflow.com/questions/30405381/switching-2-elements-in-a-list-by-index-haskell", "title": "Switching 2 elements in a list by index Haskell", "body": "<p>I need a function (or two) that should do something like this:</p>\n\n<pre><code>swap 2 [1,2,3,4] -&gt; [1,3,2,4]\nswap' 2 [1,2,3,4] -&gt; [1,2,4,3]\n</code></pre>\n\n<p>The first integer is the index of the value I want to move to the left and to the right (it can't be 0 or the length of my list).</p>\n\n<p>I know it might have been posted before, but I couldn't find anything useful.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1432319444, "post_id": 30403468, "comment_id": 48894841, "body": "If it&#39;s &quot;only&quot; to use them as command line arguments, use one of the excellent libraries that already exist: <a href=\"https://wiki.haskell.org/Command_line_option_parsers\" rel=\"nofollow noreferrer\">wiki.haskell.org/Command_line_option_parsers</a>. I&#39;ve used optparse-applicative and cmdargs with success."}, {"owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "reply_to_user": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1432320057, "post_id": 30403468, "comment_id": 48895194, "body": "@JPMoresmau My scenario is in the other direction. I&#39;m creating a library that abstracts over the command line, so a command line parser would not help in this case."}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1432320941, "post_id": 30403468, "comment_id": 48895684, "body": "Oh sorry yes I see in your code"}], "answers": [{"comments": [{"owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "edited": false, "score": 0, "creation_date": 1432324089, "post_id": 30404098, "comment_id": 48897328, "body": "I like this solution, but unfortunately I can only pick one answer. I picked the other one because it is simpler and fits my scenario directly, though I&#39;m going to try changing my Options type and see if I like this it better."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1432321335, "creation_date": 1432321335, "answer_id": 30404098, "question_id": 30403468, "link": "https://stackoverflow.com/questions/30403468/how-should-i-turn-a-record-of-options-into-a-list-of-strings/30404098#30404098", "title": "How should I turn a record of options into a list of strings?", "body": "<p>No, there isn't really a built-in way to do this, to my knowledge.  You could try to use some sort of generic programming, but that's likely not to work very well and be pretty difficult.  Instead, I would suggest restructuring your <code>Options</code> type:</p>\n\n<pre><code>data Option\n    = Foo Int\n    | Yes\n    | Bar String\n    deriving (Eq, Show)\n\ntype Options = [Option]\n\noptToArgs :: Option -&gt; [String]\noptToArgs opt = case opt of\n    Foo n -&gt; [\"--foo\", show n]\n    Yes   -&gt; [\"-y\"]\n    Bar s -&gt; [\"--bar\", s]\n\noptsToArgs :: Options -&gt; [String]\noptsToArgs = concatMap optToArgs\n</code></pre>\n\n<p>Then you would have</p>\n\n<pre><code>&gt; optsToArgs [Foo 3, Yes]\n[\"--foo\", \"3\", \"-y\"]\n&gt; optsToArgs [Yes, Bar \"test\"]\n[\"-y\", \"--bar\", \"test\"]\n</code></pre>\n\n<p>This way you have a different constructor for each option.  The conversion from a single option to its corresponding arguments is handled in one place, then converting multiple options to the arguments list is simple.  This would also allow you to have a more hierarchical options structure if needed:</p>\n\n<pre><code>data FooOption\n    = Foo1 Int\n    | Foo2 Double\n\ndata BarOption\n    = Bar1 String\n    = Bar2 (String, String)\n\nclass Opt o where\n    toArgs :: o -&gt; [String]\n\ninstance Opt FooOption where\n    toArgs (Foo1 n) = [\"--foo\", show n]\n    toArgs (Foo2 d) = [\"--foo\", show d]\n\ninstance Opt BarOption where\n    toArgs (Bar1 s) = [\"--bar\", s]\n    toArgs (Bar2 (s1, s2)) = [\"--bar\", s1, \"--bar\", s2]\n\ndata Option\n    = Foo FooOption\n    | Bar BarOption\n    | Yes\n\ninstance Opt Option where\n    toArgs (Foo f) = toArgs f\n    toArgs (Bar b) = toArgs b\n    toArgs Yes     = [\"-y\"]\n\ntype Options = [Option]\n\ninstance Opt o =&gt; Opt [o] where\n    toArgs = concatMap toArgs\n</code></pre>\n\n<p>Then you'd just have</p>\n\n<pre><code>callThing = callProcess \"/usr/bin/thing\" . toArgs\n</code></pre>\n\n<p>As an example:</p>\n\n<pre><code>&gt; toArgs [Bar $ Bar2 (\"hello\", \"world\"), Foo $ Foo1 3, Yes]\n[\"--bar\", \"hello\", \"--bar\", \"world\", \"--foo\", \"3\", \"-y\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 1, "last_activity_date": 1432321340, "creation_date": 1432321340, "answer_id": 30404100, "question_id": 30403468, "link": "https://stackoverflow.com/questions/30403468/how-should-i-turn-a-record-of-options-into-a-list-of-strings/30404100#30404100", "title": "How should I turn a record of options into a list of strings?", "body": "<p>I would create a TypeClass that takes the name of the option as a parameter.</p>\n\n<pre><code>class ToCommand a where\n  toCmd :: a -&gt; String -&gt; [String]\n\ninstance ToCommand Int where\n  toCmd i n = [n,show i]\n\ninstance ToCommand Bool where\n  toCmd True n = [n]\n  toCmd False _ = []\n\ninstance (ToCommand a)=&gt; ToCommand (Maybe a) where\n  toCmd Nothing _ = []\n  toCmd (Just a) n = toCmd a n\n</code></pre>\n\n<p>And with RecordWildcards you could do</p>\n\n<pre><code> optToArgs opts{..} = concat (toCmd optFoo \"--foo\") (toCmd optYes \"-y\") ...\n</code></pre>\n\n<p>Maybe a more generic solution would work, but it would be more complex to put in place.</p>\n"}], "owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 30404100, "answer_count": 2, "score": 1, "last_activity_date": 1432321340, "creation_date": 1432318987, "last_edit_date": 1432319281, "question_id": 30403468, "link": "https://stackoverflow.com/questions/30403468/how-should-i-turn-a-record-of-options-into-a-list-of-strings", "title": "How should I turn a record of options into a list of strings?", "body": "<p>I have a record of Options that I need to turn into command line arguments.</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Options = Options { optFoo :: Maybe Int\n                       , optYes :: Bool\n                       , optBar :: Maybe String\n                       }\n\noptions = Options { optFoo = Just 3\n                  , optYes = True\n                  , optBar = Nothing\n                  }\n\ncallThing :: Options -&gt; IO ()\ncallThing opts = do\n    callProcess \"/usr/bin/thing\" $ optsToArgs opts\n\n-- Output should be: [\"--foo\", \"3\", \"-y\"]\noptsToArgs :: Options -&gt; [String]\noptsToArgs opts = ???\n</code></pre>\n\n<p>I was imagining being able to use a List Monad, but I can't figure out how to make it work.</p>\n\n<p>In my specific case, Options has about 20 different things in it so a solution with nested if/case statements would not be ideal.</p>\n\n<p>Is there a common pattern for solving this kind of problem?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "edited": false, "score": 0, "creation_date": 1432319633, "post_id": 30403154, "comment_id": 48894933, "body": "Use sandboxes to separate your different package databases and not mess up your main environment: <a href=\"https://www.haskell.org/cabal/users-guide/installing-packages.html#developing-with-sandboxes\" rel=\"nofollow noreferrer\">haskell.org/cabal/users-guide/&hellip;</a>"}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 1, "creation_date": 1432325513, "post_id": 30403154, "comment_id": 48897979, "body": "Try installing with the flags <code>--constraint=&#39;template-haskell installed&#39; --constraint=&#39;containers installed&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4930082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec289596b1de4923eca7d27aebb0c716?s=128&d=identicon&r=PG&f=1", "display_name": "BackwardsE", "link": "https://stackoverflow.com/users/4930082/backwardse"}, "edited": false, "score": 1, "creation_date": 1432329395, "post_id": 30405220, "comment_id": 48899661, "body": "The non-sandbox solution appears to have worked, despite the warnings about possibly breaking ghc.  Thank you!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user554538"}, "is_accepted": true, "score": 1, "last_activity_date": 1432325803, "creation_date": 1432325803, "answer_id": 30405220, "question_id": 30403154, "link": "https://stackoverflow.com/questions/30403154/cant-install-haskell-quickcheck/30405220#30405220", "title": "Can&#39;t install Haskell QuickCheck", "body": "<p>For a per-user <code>cabal</code> installation and not a <a href=\"http://chromaticleaves.com/posts/cabal-sandbox-workflow.html\" rel=\"nofollow\">sandbox</a>, running <code>cabal install --reinstall --force-reinstalls QuickCheck</code> is fine. Using sandboxes is still much better though.</p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 3212255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X1B3L.jpg?s=128&g=1", "display_name": "shwsun", "link": "https://stackoverflow.com/users/3212255/shwsun"}, "is_accepted": false, "score": 0, "last_activity_date": 1500166320, "creation_date": 1500166320, "answer_id": 45124004, "question_id": 30403154, "link": "https://stackoverflow.com/questions/30403154/cant-install-haskell-quickcheck/45124004#45124004", "title": "Can&#39;t install Haskell QuickCheck", "body": "<p>I am also new to Haskell but it seems that people should use <code>stack</code> nowadays.</p>\n\n<p>If so,</p>\n\n<p><code>$ git clone https://github.com/stackbuilders/quickcheck-manual\n $ cd quickcheck-manual/\n $ stack setup\n $ stack install</code></p>\n\n<p>Ref/See <a href=\"https://github.com/stackbuilders/quickcheck-manual\" rel=\"nofollow noreferrer\">https://github.com/stackbuilders/quickcheck-manual</a></p>\n"}], "owner": {"reputation": 13, "user_id": 4930082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec289596b1de4923eca7d27aebb0c716?s=128&d=identicon&r=PG&f=1", "display_name": "BackwardsE", "link": "https://stackoverflow.com/users/4930082/backwardse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3194, "favorite_count": 0, "accepted_answer_id": 30405220, "answer_count": 2, "score": 1, "last_activity_date": 1500166320, "creation_date": 1432317849, "last_edit_date": 1432325241, "question_id": 30403154, "link": "https://stackoverflow.com/questions/30403154/cant-install-haskell-quickcheck", "title": "Can&#39;t install Haskell QuickCheck", "body": "<p>I need to install Haskell's QuickCheck.  I try to run <code>cabal install QuickCheck</code>, and receive the following messages:</p>\n\n<pre>Resolving dependencies...\nIn order, the following would be installed:\nprimitive-0.6 (new package)\ntemplate-haskell-2.9.0.0 (latest: 2.10.0.0) (reinstall) changes:\ncontainers-0.5.5.1 -> 0.5.6.3\ntf-random-0.5 (new package)\nQuickCheck-2.8.1 -base4point8 (new package)\n\ncabal: The following packages are likely to be broken by the reinstalls:\nghc-7.8.3\nUse --force-reinstalls if you want to install anyway.\n</pre>\n\n<p>I am quite new to Haskell, but I have a sneaking suspicion that breaking ghc is not a viable solution.  Any advice?  Thanks!</p>\n\n<p>PS.  ghc and cabal-install were installed using MacPorts.  The ghc version is, as indicated above, 7.8.3.  The port version of cabal-install is hs-cabal-install @1.18.0.5_1.  Additionally, I've encountered this error on two different machines; one is running OS 10.9, the other 10.10.</p>\n"}, {"tags": ["haskell", "functional-programming", "dynamic-programming", "template-haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432302897, "post_id": 30398444, "comment_id": 48884833, "body": "let&#39;s assume for a moment that <code>Bool</code> and <code>Maybe</code> where values of some type - already for <code>Maybe</code> your resulting list would have one element of type <code>Maybe a</code> and one of type <code>a -&gt; Maybe a</code> so it would not be a valid list - having said this: you probably get something very similar by using <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Typeable.html\" rel=\"nofollow noreferrer\">Typeable</a>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432308747, "post_id": 30398444, "comment_id": 48888840, "body": "The <code>Data</code> typeclass has something along those lines, but it&#39;s terrifying."}], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": true, "score": 14, "last_activity_date": 1432303478, "last_edit_date": 1432303478, "creation_date": 1432303305, "answer_id": 30398768, "question_id": 30398444, "link": "https://stackoverflow.com/questions/30398444/is-it-possible-to-create-a-function-in-haskell-which-returns-a-list-of-the-const/30398768#30398768", "title": "Is it possible to create a function in Haskell which returns a list of the constructors for a data type?", "body": "<p>Think about this: what would be the type of the list? <code>Nothing</code> has type <code>Maybe a</code> but <code>Just</code> has type <code>a -&gt; Maybe a</code>.</p>\n\n<p>You can look at generics though. Using the package <code>syb</code>:</p>\n\n<pre><code>Prelude&gt; import Data.Data\nPrelude Data.Data&gt; dataTypeConstrs $ dataTypeOf (Just 4)\n[Nothing,Just]\n</code></pre>\n\n<p>Note that here <code>[Nothing,Just]</code> is just how it's printed on screen, it's not actually a list containing the two constructors.</p>\n\n<pre><code>Prelude Data.Data&gt; :t dataTypeConstrs (dataTypeOf (Just 4))\ndataTypeConstrs (dataTypeOf (Just 4)) :: [Constr]\n</code></pre>\n\n<p>Anyway, having a list with <code>[Nothing,Just]</code> (even if that was correct Haskell) would not be really useful. You wouldn't be able to do anything with the values inside it as you wouldn't know their types.</p>\n"}], "owner": {"reputation": 335, "user_id": 3195266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11459be624d79fcf9665b0a46653b151?s=128&d=identicon&r=PG", "display_name": "Netsu", "link": "https://stackoverflow.com/users/3195266/netsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 30398768, "answer_count": 1, "score": 2, "last_activity_date": 1493221675, "creation_date": 1432302523, "last_edit_date": 1493221675, "question_id": 30398444, "link": "https://stackoverflow.com/questions/30398444/is-it-possible-to-create-a-function-in-haskell-which-returns-a-list-of-the-const", "title": "Is it possible to create a function in Haskell which returns a list of the constructors for a data type?", "body": "<p>Is it possible to create a function in Haskell which returns a list of the constructors for a data type?</p>\n\n<p>It should work like this:</p>\n\n<pre><code>ghci&gt; getConstructors Bool\n[True, False]\nghci&gt; getConstructors Maybe\n[Nothing, Just]\n</code></pre>\n"}, {"tags": ["list", "haskell", "append", "list-comprehension"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1432300808, "post_id": 30397725, "comment_id": 48883284, "body": "with the changes your <code>b &lt;- foo xs</code> will not be able to get <i>anything</i> when <code>xs</code> get&#39;s empty (because <i>pull a <code>b</code> from nothing</i> will never get a <code>b</code>)- this is the <b>big deal</b> (in the right case it will pull <code>b &lt;- [[]]</code> so <code>b</code> will get <code>[]</code>) :D"}, {"owner": {"reputation": 209, "user_id": 4928807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f09a70fb6bea632fa8b246f76b028c?s=128&d=identicon&r=PG&f=1", "display_name": "dmngrsk", "link": "https://stackoverflow.com/users/4928807/dmngrsk"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432300956, "post_id": 30397725, "comment_id": 48883378, "body": "Oh, of course. Thanks :)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432300981, "post_id": 30397725, "comment_id": 48883396, "body": "is this ok as an answer for you?"}, {"owner": {"reputation": 209, "user_id": 4928807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f09a70fb6bea632fa8b246f76b028c?s=128&d=identicon&r=PG&f=1", "display_name": "dmngrsk", "link": "https://stackoverflow.com/users/4928807/dmngrsk"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432301009, "post_id": 30397725, "comment_id": 48883414, "body": "Yep, I totally understand this now."}, {"owner": {"reputation": 711, "user_id": 809102, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/062b1d54e88e8b951cc73e47eb12c601?s=128&d=identicon&r=PG", "display_name": "Treesrule14", "link": "https://stackoverflow.com/users/809102/treesrule14"}, "edited": false, "score": 0, "creation_date": 1432301048, "post_id": 30397725, "comment_id": 48883446, "body": "can you explain a bit more"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1432301803, "last_edit_date": 1432301803, "creation_date": 1432301097, "answer_id": 30397909, "question_id": 30397725, "link": "https://stackoverflow.com/questions/30397725/list-appending-in-haskell/30397909#30397909", "title": "List appending in Haskell", "body": "<p>with <code>foo [] = []</code> the very last <code>b &lt;- foo xs</code> will not be able to get anything when <code>xs == []</code>, because it wants to pull a <code>b</code> from nothing - so the list-comprehension will be empty.</p>\n\n<p>with the <code>foo [] = [[]]</code> it will finally be <code>b &lt;- [[]]</code> so <code>b</code> will get a single [].</p>\n\n<h2>remark</h2>\n\n<p>you can simplify this a bit (so you don't need the costly <code>(!!)</code>):</p>\n\n<pre><code>foo :: [[a]] -&gt; [[a]]\nfoo [] = [[]]\nfoo (xs:xss) = [ y : ys | y &lt;- xs, ys &lt;- foo xss]\n</code></pre>\n\n<p>I think this is easier to read/explain too: take every <code>x</code> from <code>xs</code> and recursively combine it with every combination of the <code>xss</code> into a new list</p>\n\n<h2>what would go wrong with <code>foo [] = []</code>:</h2>\n\n<p>Let's test it with a simple case:</p>\n\n<pre><code>foo [[1],[2]]\n= [ y:ys | y  &lt;- [1], ys &lt;- foo [ [2] ] ]\n= [ 1:ys | ys &lt;- [ y':ys' | y' &lt;- [2], ys' &lt;- foo [] ] ]\n= [ 1:ys | ys &lt;- [ 2:ys'  | ys' &lt;- [] ] ]\n= [ 1:ys | ys &lt;- [] ]\n= []\n</code></pre>\n\n<p>instead of (with <code>foo [] = [[]]</code>):</p>\n\n<pre><code>foo [[1],[2]]\n= [ y:ys | y  &lt;- [1], ys &lt;- foo [ [2] ] ]\n= [ 1:ys | ys &lt;- [ y':ys' | y' &lt;- [2], ys' &lt;- foo [] ] ]\n= [ 1:ys | ys &lt;- [ 2:ys'  | ys' &lt;- [[]] ] ]\n= [ 1:ys | ys &lt;- [ 2:[] ] ]\n= [ 1:[2] ]\n= [ [1,2] ]\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 4928807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f09a70fb6bea632fa8b246f76b028c?s=128&d=identicon&r=PG&f=1", "display_name": "dmngrsk", "link": "https://stackoverflow.com/users/4928807/dmngrsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2840, "favorite_count": 0, "accepted_answer_id": 30397909, "answer_count": 1, "score": 1, "last_activity_date": 1432301803, "creation_date": 1432300573, "question_id": 30397725, "link": "https://stackoverflow.com/questions/30397725/list-appending-in-haskell", "title": "List appending in Haskell", "body": "<p>So I wrote a function that takes a list of lists as an argument and takes every single element from the first list and appends it to a recursively called function on the list of lists' tail, in result returning all possible combinations of selecting elements from these lists.</p>\n\n<pre><code>foo :: [[a]] -&gt; [[a]]\nfoo [] = [[]]\nfoo (x:xs) = [[(x !! a)] ++ b | a &lt;- [0..length(x)-1], b &lt;- foo xs]\n\n*Main&gt; foo [[1, 2], [3, 4], [5, 6]]\n[[1, 3, 5], [1, 3, 6], [1, 4, 5], [1, 4, 6], [2, 3, 5], [2, 3, 6], [2, 4, 5], [2, 4, 6]]\n</code></pre>\n\n<p>It indeed works how it should, but whenever I change the second line of my function to</p>\n\n<pre><code>foo [] = []\n</code></pre>\n\n<p>it always returns an empty list whenever I call it on a type-valid argument. What's the big deal?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432294124, "post_id": 30395379, "comment_id": 48878619, "body": "<a href=\"https://wiki.haskell.org/Pipes\" rel=\"nofollow noreferrer\">pipes</a> and <a href=\"https://hackage.haskell.org/package/conduit\" rel=\"nofollow noreferrer\">conduit</a> comes to mind (but I think the question is not really a good fit for SO - as you are basically asking for a library - sorry)"}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432294717, "post_id": 30395379, "comment_id": 48879021, "body": "@Carsten Agreed, I removed that part of question, I care mainly about picking best abstractions before implementing them."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1432296040, "post_id": 30395379, "comment_id": 48879946, "body": "Sounds a lot like <code>ResourceT</code> from <a href=\"http://hackage.haskell.org/package/resourcet\" rel=\"nofollow noreferrer\"><code>resourcet</code></a>."}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1432321778, "post_id": 30395379, "comment_id": 48896062, "body": "<a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:seq\" rel=\"nofollow noreferrer\"><b><code>seq</code></b></a> might be a simple solution, depending on the usage..."}, {"owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "edited": false, "score": 0, "creation_date": 1432446707, "post_id": 30395379, "comment_id": 48926771, "body": "One solution might be regions. See e.g. <a href=\"http://okmij.org/ftp/Computation/resource-aware-prog/region-io.pdf\" rel=\"nofollow noreferrer\">Oleg&#39;s page about regions</a>."}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1432294608, "creation_date": 1432293636, "last_edit_date": 1432294608, "question_id": 30395379, "link": "https://stackoverflow.com/questions/30395379/how-to-lazy-open-resource-and-eagerly-release", "title": "How to lazy open resource and eagerly release?", "body": "<p>How can I provide a lazily acquired resource of any kind so that client code has following guarantees:</p>\n\n<ul>\n<li>Resource is allocated at most once and not before first use (possibly never depending on business logic)</li>\n<li>Resource is released as soon as it is guaranteed to be not needed (alternatively, release on \"exit\") </li>\n<li>Such construct can be nested within another in isolation except shared resource pool</li>\n</ul>\n\n<p>Intuition tells me that it should be possible to define DSL that captures this idea without IO which I will later provide as part of main interpreter.</p>\n\n<p>What fundamental abstractions can capture those needs?</p>\n"}, {"tags": ["haskell", "categories", "functor"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1432283608, "post_id": 30391778, "comment_id": 48872055, "body": "What you&#39;ve defined are not categories. <a href=\"http://en.wikipedia.org/wiki/Category_(mathematics)#Definition\" rel=\"nofollow noreferrer\">Wikipedia</a> provides a definition for category so you can just check if what you&#39;ve defined satisfies the definition.  It doesn&#39;t, for instance you need to have an identity morphism for each object; it doesn&#39;t make sense to talk about <i>the</i> identity morphism."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1432284288, "post_id": 30391778, "comment_id": 48872468, "body": "There is a single category in Haskell, called <b>Hask</b>. (Well there are others but all Haskell functors work in Hask so those other categories are of no importance here). Objects of Hask are Haskell <i>types</i>, not values. Morphisms of Hask are functions."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1432284537, "post_id": 30391778, "comment_id": 48872601, "body": "@AmitKumarGupta you can make <code>(1*)</code> an identity morphism for each object, no problem here."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432284604, "post_id": 30391778, "comment_id": 48872641, "body": "maybe you are thinking of the monoids <code>(N,+,0)</code> and <code>(N,*,1)</code> here, as those give examples of categories as well (<a href=\"http://curiousskeptic.com/from-monoids-to-categories/\" rel=\"nofollow noreferrer\">curiousskeptic.com/from-monoids-to-categories</a>)? You&#39;ll find those as <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Monoid.html#v:Sum\" rel=\"nofollow noreferrer\"><code>Sum</code> and <code>Product</code></a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1432284952, "post_id": 30391778, "comment_id": 48872833, "body": "This has nothing to do with Haskell or programming in general. You should ask this to be migrated to e.g. the Maths SE, since the question is mostly about <i>how</i> to define the morphism, and only marginally about how to implement it in Haskell."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432285235, "post_id": 30391778, "comment_id": 48872994, "body": "Still, if you really want any arbitrary functor, try mapping each object to <code>42</code> and each morphism to the identity over <code>42</code> (i.e. (*1)). This works, but it&#39;s not what you wanted, I guess, so you should refine your aims."}, {"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1432287922, "post_id": 30391778, "comment_id": 48874689, "body": "@AmitKumarGupta , n.p is right, (0+) 2 is 2, (0+) 3 is 3, another way to look at is: think of (0+) as an arrow, 2 (0+) 2   &lt;-- id morphism"}, {"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432287987, "post_id": 30391778, "comment_id": 48874740, "body": "@chi Yes it does :) I am asking for a definition of fmap for these two categories"}, {"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432288273, "post_id": 30391778, "comment_id": 48874922, "body": "@chi In my mind i get what you are saying (although i am hoping for something a bit more complex), but event so, how do you map 1 to 42, 2 to 42 and (3+) to (1*) specifically, how do you define/write that in Haskell provided that you only have to define fmap (Thank you)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432288751, "post_id": 30391778, "comment_id": 48875253, "body": "@Tristan you first have to say how you want to express those categories in Haskell ..."}, {"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432289278, "post_id": 30391778, "comment_id": 48875556, "body": "@Carsten I am not sure exactly what d you mean but probably that would be class Category Add where id = (0+) (.) = (.)  there is probably a lot of things incorrect in what i just said in this comment (i am just learing H) but you get the idea of what i mean by Add and Mul categories"}, {"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432289655, "post_id": 30391778, "comment_id": 48875799, "body": "@Carsten, probably you mean data Mul = Mul Int"}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1432360075, "post_id": 30391778, "comment_id": 48905872, "body": "@Tristan, n.m., there are a lot of true statements in the world, the ones you guys are stating are not stated in the original question.  It says (0+) <i>is</i> the identity morphism, which doesn&#39;t make sense for a category.  You could say (0+)|{n} are the identity morphisms for each n, but that would be a charitable interpretation.  Then what about (1+)?  Is there one for every possible source object?  It&#39;s not specified.  You could have (1+)|{n} for none of the n, or all of the n, or just the odd n.   These options all generate different categories."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1432360158, "post_id": 30391778, "comment_id": 48905888, "body": "I&#39;d rather the OP read the definition of Category, understand why the structures defined here are deficient, and then update the question with an unambiguous definition of the structure such that it&#39;s a category, rather than making up a charitable interpretation and then talking about something the OP doesn&#39;t intend or doesn&#39;t understand."}, {"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "reply_to_user": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 1, "creation_date": 1432534503, "post_id": 30391778, "comment_id": 48948552, "body": "@AmitKumarGupta I admit it&#39;s not a very mathematical definition of a category (and the title should contain the word haskell) but then again, a category is such a broad definition that almost anything can be defined as one and from your comments i know you understood how i view it as a category.  (1,2,3 are the dots, between them there are arrows 1 (1+) 2, 2 (1+) 3, ... and (1+).(2+) = (3+) &lt;- composition)"}], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "edited": false, "score": 1, "creation_date": 1432534633, "post_id": 30397172, "comment_id": 48948584, "body": "Than you for trying to come up with an answer to a poorly formulated question :) As i said in my edits, probably i should have asked how to view haskell functors as mathematical functors. Thank you anyway"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "reply_to_user": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "edited": false, "score": 1, "creation_date": 1432535255, "post_id": 30397172, "comment_id": 48948837, "body": "Oh okay, in that case they are endofunctors in the category Hask, the category of Haskell types but I guess you got that from the other comments on your post."}], "tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": false, "score": 1, "last_activity_date": 1432300003, "last_edit_date": 1432300003, "creation_date": 1432298998, "answer_id": 30397172, "question_id": 30391778, "link": "https://stackoverflow.com/questions/30391778/example-of-defining-a-functor-in-haskell-between-two-categories-which-are-close/30397172#30397172", "title": "Example of defining a functor in haskell between two categories (which are closely related to additive and multiplicative monoids)", "body": "<p>If you look at the definition of the <code>class Category</code> in Haskell, you would see this.</p>\n\n<pre><code>class Category cat where\n  id :: cat a a \n  (.) :: cat b c -&gt; cat a b -&gt; cat a c\n</code></pre>\n\n<p>See, if the objects in the category are <code>Int</code>s, then you would need to define those functions where <code>a</code>, <code>b</code> and <code>c</code> are <code>Int</code>s. This is fine when objects in the collection are types but not values. So you can't make them an instance of <code>Category</code>.</p>\n\n<p>Also looking at <code>fmap</code>:</p>\n\n<pre><code> fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>You can see it only makes sense with types (thus in the category Hask). If the objects are integers, you would pass morphisms like <code>4 --&gt; 5</code> and <code>-&gt;</code> only works with types.</p>\n\n<p>Then <code>(0+)</code> is a morphism from <code>Int</code> to <code>Int</code>. You would need a morphism from, say, 2 to 5.</p>\n\n<p>Maybe it would be something like this:</p>\n\n<pre><code>data IntMorphism = IdMorphism | IntMorphism Int Int\n\ncomp :: IntMorphism -&gt; IntMorphism -&gt; IntMorphism\ncomp IdMorphism m = m\ncomp m IdMorphism = m\ncomp  (IntMorphism y' z) (IntMorphism x y)\n  | y /= y' = error \"can't compose\"\n  | otherwise = IntMorphism x z\n\nf1 :: Int -&gt; Int\nf1 = (+5)\n\nf2 :: IntMorphism -&gt; IntMorphism\nf2 IdMorphism = IdMorphism\nf2 (IntMorphism x y) = IntMorphism (f1 x) (f1 y)\n</code></pre>\n\n<p>And the functor laws hold. In particular:</p>\n\n<pre><code>f2 (comp (IntMorphism y z) (IntMorphism x y))\n= f2 (IntMorphism x z)\n= IntMorphism (f1 x) (f1 z)\n= comp (IntMorphism (f1 y) (f1 z)) (IntMorphism (f1 x) (f1 y))\n= comp (f2 (IntMorphism y z)) (f2 (IntMorphism x y))\n</code></pre>\n\n<p>Of course, as it deals with values, it can't use the typeclasses defined in base and it is all done at runtime.</p>\n"}, {"comments": [{"owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "edited": false, "score": 0, "creation_date": 1432404852, "post_id": 30408181, "comment_id": 48918175, "body": "So the short answer is &quot;You can&#39;t&quot; :). Thank you. Although technically this is not the answer to the question above, it&#39;s the right answer since it explains what is a functors in Haskell (and why my particular example can&#39;t be modeled using the Functor typeclass)"}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 2, "last_activity_date": 1432347155, "last_edit_date": 1432347155, "creation_date": 1432346836, "answer_id": 30408181, "question_id": 30391778, "link": "https://stackoverflow.com/questions/30391778/example-of-defining-a-functor-in-haskell-between-two-categories-which-are-close/30408181#30408181", "title": "Example of defining a functor in haskell between two categories (which are closely related to additive and multiplicative monoids)", "body": "<p>The issue is that Haskell's <code>Functor</code> only represents a certain kind of functor: functors from the category of Haskell types and functions (<code>Hask</code>) to itself. <code>Functor</code> maps types to types (the objects of <code>Hask</code>) and functions to functions (the morphisms of <code>Hask</code>). For instance, the <code>Maybe</code> <code>Functor</code> maps any given type <code>a</code> to the type <code>Maybe a</code> and it uses <code>fmap</code> to map a given function <code>a -&gt; b</code> to a function <code>Maybe a -&gt; Maybe b</code>.</p>\n\n<p>In the category of <code>Hask</code>, the objects are types and the morphisms are functions. Your category has integers as its objects and as a result doesn't fit the pattern of <code>Functor</code>, so the question doesn't quite make sense to ask in this form, at least not with regard to the <code>Functor</code> type class.</p>\n"}], "owner": {"reputation": 533, "user_id": 1731202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Uj8ok.jpg?s=128&g=1", "display_name": "Ruslan Talpa", "link": "https://stackoverflow.com/users/1731202/ruslan-talpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 30408181, "answer_count": 2, "score": 0, "last_activity_date": 1432534684, "creation_date": 1432283095, "last_edit_date": 1432534684, "question_id": 30391778, "link": "https://stackoverflow.com/questions/30391778/example-of-defining-a-functor-in-haskell-between-two-categories-which-are-close", "title": "Example of defining a functor in haskell between two categories (which are closely related to additive and multiplicative monoids)", "body": "<p>I am trying to reconcile the math notion of functor and the haskell notion of it.\nThis article <a href=\"http://brianshourd.com/posts/2012-10-26-tilt-functors-in-haskell.html\" rel=\"nofollow\">http://brianshourd.com/posts/2012-10-26-tilt-functors-in-haskell.html</a> explains a bit, but maybe someone can provide an example for the following case:</p>\n\n<p>Suppose i define the following categories</p>\n\n<p>Add: where objects are 0,1,2,3,...., morphisms are (0+), (1+), (2+), ... (0+) is the id morph.</p>\n\n<p>Mul: where objects are 0,1,2,3,...., morphisms are (0*), (1*), (2*), ... (1*) is the id morph.</p>\n\n<p>The composition is (.)</p>\n\n<p>How would one define a functor between these two categories in Haskell (if that is possible and if what i described above are categories at all)</p>\n\n<p>Thank you</p>\n\n<p>EDIT: As per @chi suggestion, i am clarifying  the question a bit. I am more interested in how you would put/translate into Haskell any functor between these two categories (as opposed to the existence of one, for example map any number to 42 and any morphism to (1*) as @chi sugested)</p>\n\n<p>EDIT 2: Another way to ask this is, how do you reconcile these two statements \"the Functor typeclass, which is basically for things that can be mapped over\" with \"Given categories C and D, a functor F:C\u2192D is a rule that assigns to each object A in C an object F(A) in D. It also assigns to every morphism f:A\u2192B of objects of C a morphism F(f):F(A)\u2192F(B)\". If the type constructor [] (lists) is a functor, what are the two categories it connects and how exactly is it mapping objects and morphisms between those two categories</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1432307649, "post_id": 30391465, "comment_id": 48888111, "body": "Could you explain a little your use case for <code>Pipe a (v a) m ()</code>? Do you need to group the incoming values into a stream of vectors of a given size, or something like that?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1432314108, "post_id": 30391465, "comment_id": 48891984, "body": "@danidiaz: Good question! I&#39;m not doing any grouping, in fact, I&#39;m just trying to make a pipe that produces a single vector.  The intent however is to compose that with a pipe that will produce multiple list elements for that vector. Basically: 1. Read a ton of data items into a vector; 2. Run some statistical analyses that require the whole vector at once (for random access); 3. Output a stream of results from that analysis. But maybe what I need is how to make a <code>Pipe</code> from a <code>Consumer</code> and <code>Producer</code> connected the &quot;wrong way around.&quot; If there isn&#39;t a question to that end I might post one."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1432323568, "post_id": 30391465, "comment_id": 48897030, "body": "Perhaps you don&#39;t really need to do it all in a single pipeline. Compose the <code>toVector</code> consumer with a producer that reads the data, run the resulting pipeline and extract the result vector. You can later use the vector in other pipelines, if you wish."}], "answers": [{"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1433106447, "last_edit_date": 1433106447, "creation_date": 1433050713, "answer_id": 30554242, "question_id": 30391465, "link": "https://stackoverflow.com/questions/30391465/running-a-monomorphic-consumer-inside-a-pipe/30554242#30554242", "title": "Running a monomorphic Consumer inside a Pipe", "body": "<p>Well, I came up with this after playing around for several days:</p>\n\n<pre><code>import Control.Monad\n\nimport Pipes\nimport Pipes.Core ((//&gt;), (&gt;\\\\), closed)\n\n\n-- | Convert a 'Consumer' into a 'Pipe' that 'yield's the consumer's\n-- final result.\nfromConsumer :: Monad m =&gt; Consumer i m r -&gt; Pipe i r m ()\nfromConsumer c = c //&gt; closed &gt;&gt;= yield\n\nexample1 :: MonadIO m =&gt; m ()\nexample1 = runEffect $ each \"abcde\" &gt;-&gt; fromConsumer (example' 3) &gt;-&gt; P.print\n  where\n    example' :: Monad m =&gt; Int -&gt; Consumer a m [a]\n    example' n = replicateM n await\n\n-- \u03bb&gt; example1\n-- \"abc\"\n\n\n-- | Convert a 'Producer' into a 'Pipe' that ignores its upstream\n-- and sends the producer's contents downstream.\nfromProducer :: Monad m =&gt; Producer o m r -&gt; Pipe i o m r\nfromProducer p = closed &gt;\\\\ p\n\nexample2 :: MonadIO m =&gt; m ()\nexample2 = runEffect $ P.stdinLn &gt;-&gt; fromProducer (each \"abcde\") &gt;-&gt; P.print\n\n-- Ignores stdin:\n--\n-- \u03bb&gt; example2\n-- 'a'\n-- 'b'\n-- 'c'\n-- 'd'\n-- 'e'\n</code></pre>\n"}], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1433106447, "creation_date": 1432281999, "last_edit_date": 1495541161, "question_id": 30391465, "link": "https://stackoverflow.com/questions/30391465/running-a-monomorphic-consumer-inside-a-pipe", "title": "Running a monomorphic Consumer inside a Pipe", "body": "<p>The question of <a href=\"https://stackoverflow.com/questions/24742367/running-a-consumer-inside-a-pipe\">how to run a <code>Consumer</code> inside a <code>Pipe</code></a> has already been asked, but the answer that was offered then requires the <code>Consumer'</code> polymorphic type synonym:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\nimport Pipes\n\ntoPipe :: Monad m =&gt; Consumer' i m o -&gt; Pipe i o m ()\ntoPipe consumer = consumer &gt;&gt;= yield\n</code></pre>\n\n<p>Now, the problem I'm having is that in <a href=\"http://hackage.haskell.org/package/pipes-vector-0.6.1/docs/Pipes-Vector.html\" rel=\"nofollow noreferrer\"><code>Pipes.Vector</code></a>, <code>toVector</code> uses the monomorphic <code>Consumer</code> synonym:</p>\n\n<pre><code>toVector :: (PrimMonad m, MVector (Mutable v) e) =&gt; Consumer e (ToVector v e m) r\n</code></pre>\n\n<p>So the <code>toPipe</code> function from that answer won't work in this case:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\nmodule VectorPipe where\n\nimport Control.Monad.Primitive (PrimMonad)\nimport qualified Data.Vector.Generic as G\nimport Pipes\nimport Pipes.Vector\n\ntoPipe :: Monad m =&gt; Consumer' i m o -&gt; Pipe i o m ()\ntoPipe consumer = consumer &gt;&gt;= yield\n\nvectorPipe :: (PrimMonad m, G.Vector v a) =&gt; Pipe a (v a) m ()\nvectorPipe = toPipe (runToVectorP toVector)\n\n{-\n\nVectorPipe.hs:13:35-42: Could not deduce (y' ~ ()) \u2026\n    from the context (PrimMonad m, G.Vector v a)\n      bound by the type signature for\n                 vectorPipe :: (PrimMonad m, G.Vector v a) =&gt; Pipe a (v a) m ()\n      at /Users/casillas/GitHub/tau-sigma/VectorPipe.hs:12:15-62\n      \u2018y'\u2019 is a rigid type variable bound by\n           a type expected by the context: Proxy () a y' y m (v a)\n           at /Users/casillas/GitHub/tau-sigma/VectorPipe.hs:13:14\n    Expected type: Proxy () a y' y (ToVector v a m) r0\n      Actual type: Consumer a (ToVector v a m) r0\n    In the first argument of \u2018runToVectorP\u2019, namely \u2018toVector\u2019\n    In the first argument of \u2018toPipe\u2019, namely \u2018(runToVectorP toVector)\u2019\nVectorPipe.hs:13:35-42: Could not deduce (y ~ X) \u2026\n    from the context (PrimMonad m, G.Vector v a)\n      bound by the type signature for\n                 vectorPipe :: (PrimMonad m, G.Vector v a) =&gt; Pipe a (v a) m ()\n      at /Users/casillas/GitHub/tau-sigma/VectorPipe.hs:12:15-62\n      \u2018y\u2019 is a rigid type variable bound by\n          a type expected by the context: Proxy () a y' y m (v a)\n          at /Users/casillas/GitHub/tau-sigma/VectorPipe.hs:13:14\n    Expected type: Proxy () a y' y (ToVector v a m) r0\n      Actual type: Consumer a (ToVector v a m) r0\n    In the first argument of \u2018runToVectorP\u2019, namely \u2018toVector\u2019\n    In the first argument of \u2018toPipe\u2019, namely \u2018(runToVectorP toVector)\u2019\nCompilation failed.\n\n-}\n</code></pre>\n\n<p>Any suggestions?  Is the signature of <code>toVector</code> unnecessarily narrow, perhaps?  (I'm too much of a pipes noob to tell...  <strong>EDIT:</strong> I tried changing the signature in <code>pipes-vector</code> to <code>Consumer'</code>; the code compiles, but it looks like <code>vectorPipe</code> never yields.)</p>\n"}, {"tags": ["haskell", "console", "cross-platform", "ncurses"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1432282724, "post_id": 30391457, "comment_id": 48871554, "body": "Have you tried vty-ui: <a href=\"https://github.com/jtdaugherty/vty-ui\" rel=\"nofollow noreferrer\">github.com/jtdaugherty/vty-ui</a> ? It also has a nice <a href=\"http://jtdaugherty.github.io/vty-ui/manuals/vty-ui-users-manual-1.9.pdf\" rel=\"nofollow noreferrer\">documentation</a> with it."}], "answers": [{"tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": true, "score": 0, "last_activity_date": 1432390895, "creation_date": 1432390895, "answer_id": 30413776, "question_id": 30391457, "link": "https://stackoverflow.com/questions/30391457/ncurses-like-library-for-haskell-that-runs-on-both-windows-and-unix/30413776#30413776", "title": "NCurses like library for haskell that runs on both Windows and Unix?", "body": "<p>Supposedly it is possible to make <code>hscurses</code> work on Windows, using PDCurses.  This page goes into detail: <em><a href=\"https://medium.com/@NightRa/installing-hscurses-on-windows-830532d3268a\" rel=\"nofollow\">Installing hscurses on Windows</a></em>. You might be able to use a similar procedure for the ncurses MinGW port (see <a href=\"http://invisible-mirror.net/archives/ncurses/win32/\" rel=\"nofollow\">ncurses FTP</a> for DLLs).</p>\n\n<p>The lower-level package <em><a href=\"https://hackage.haskell.org/package/ansi-terminal-0.5.0/docs/System-Console-ANSI.html\" rel=\"nofollow\">System.Console.ANSI</a></em> is said to work with Windows, but that is not what was requested: <em>too</em> low-level.</p>\n\n<p>A comment points to <em><a href=\"https://github.com/jtdaugherty/vty-ui\" rel=\"nofollow\">jtdaugherty/vty-ui</a></em>, but looking at its <a href=\"https://github.com/jtdaugherty/vty-ui/blob/master/README\" rel=\"nofollow\">readme</a> and source, I see nothing that hints it is cross-platform. Rather, it talks about <em>terminal emulators</em>.</p>\n"}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 30413776, "answer_count": 1, "score": 1, "last_activity_date": 1432390895, "creation_date": 1432281963, "question_id": 30391457, "link": "https://stackoverflow.com/questions/30391457/ncurses-like-library-for-haskell-that-runs-on-both-windows-and-unix", "title": "NCurses like library for haskell that runs on both Windows and Unix?", "body": "<p>I have a little program that is multi-threaded.  I'm tired of the output ending up cropping up within my input. I would like to use some type of library that will move me beyond the console model of the glass teletype.</p>\n\n<p>The library I know (of) is ncursed which I can get to run under linux, but have never gotten working on windows.  I get stuck in dependency hell and can never get the D**m thing to compile.</p>\n\n<p>I also have played with some GUI libraries that are nice, but I <em>really</em> don't want to have to reimplemented all the logic of line breaks, scrolling and even echoing characters by hand.</p>\n\n<p>Is there a nice library with decent Haskell bindings that would let me set up a screen with an input area and an output area without requiring more programming time to create the the actual thing I'm writing?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432272716, "post_id": 30388949, "comment_id": 48866688, "body": "possible duplicate(? - well maybe not 100%) and/or this could help you out: <a href=\"https://stackoverflow.com/questions/6905163/whats-the-best-workaround-for-not-having-cabal-upgrade\" title=\"whats the best workaround for not having cabal upgrade\">stackoverflow.com/questions/6905163/&hellip;</a>"}, {"owner": {"reputation": 8143, "user_id": 1004369, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b7e385af406a6422cea353066baf068a?s=128&d=identicon&r=PG", "display_name": "r.sendecky", "link": "https://stackoverflow.com/users/1004369/r-sendecky"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432280329, "post_id": 30388949, "comment_id": 48870215, "body": "No, it is not a duplicate. It does not answer the question at all. I know I can do tricks with sed, bash, ruby and what not. My question is about cabal."}], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "is_accepted": false, "score": 1, "last_activity_date": 1432448257, "creation_date": 1432448257, "answer_id": 30420672, "question_id": 30388949, "link": "https://stackoverflow.com/questions/30388949/upgrade-dependencies/30420672#30420672", "title": "Upgrade dependencies", "body": "<p>You can use <code>cabal list --installed</code> and compare \"Default available version\" with \"Installed versions\".</p>\n\n<p>Unfortunately cabal's <code>--simple-output</code> switch does not include that information, so to automate it you will need a smallish script.</p>\n"}], "owner": {"reputation": 8143, "user_id": 1004369, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b7e385af406a6422cea353066baf068a?s=128&d=identicon&r=PG", "display_name": "r.sendecky", "link": "https://stackoverflow.com/users/1004369/r-sendecky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1432448257, "creation_date": 1432272406, "last_edit_date": 1432280218, "question_id": 30388949, "link": "https://stackoverflow.com/questions/30388949/upgrade-dependencies", "title": "Upgrade dependencies", "body": "<p>I have an application in a sandbox. Cabal dependencies have no constraints so <code>cabal install --only-dependencies</code> gives me the latest packages.\nAfter a certain period of time I want to bump my dependencies to the latest versions but before this I want to see which dependencies are actually changed to a newer version.\nI can check all of them manually of course. But I'd rather see a nice list of the things that will be upgraded.</p>\n\n<p>I assume that <code>cabal install --upgrade-dependencies --only-dependencies --dry-run</code> is the way to do it. I would expect it to give me the list of all the packages that are at newer version that the one in my sandbox. But it never works! I mean, it just says that all dependencies are up to date when they are clearly not. Am I doing something wrong or missing/misunderstanding something?</p>\n\n<p>If I destroy my sandbox completely, rerun <code>cabal install --only-dependencies</code> and diff the freeze files then I can see which packages got bumped. But this is silly. So how can I get <code>cabal install --upgrade-dependencies --only-dependencies --dry-run</code> to work correctly and print all the packages that are going to be upgraded without blowing the sandbox? Ad if those options do not work in cabal why aren't they just removed to avoid confusion?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["performance", "haskell", "memoization"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1432271737, "post_id": 30388757, "comment_id": 48866392, "body": "I think a big step would be if you did not use lists and <code>(!!)</code> (which is painfully slow) - <a href=\"https://hackage.haskell.org/package/vector\" rel=\"nofollow noreferrer\">vector</a> would come to mind"}, {"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432274760, "post_id": 30388757, "comment_id": 48867452, "body": "@Carsten Yes, using vector improve a lot. Unfortunately, the vector package is not installed on the OJ server:("}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1432276574, "post_id": 30388757, "comment_id": 48868277, "body": "@LiaoPengyu: what about <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/Data-Array.html\" rel=\"nofollow noreferrer\">array</a>? It&#39;s shipped with GHC."}, {"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1432285741, "post_id": 30388757, "comment_id": 48873308, "body": "@Andr&#225;sKov&#225;cs Improved, and then got an MLE :("}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432286008, "post_id": 30388757, "comment_id": 48873476, "body": "yeah some algorithms are harder to translate - I guess MLE is out-of-memory exception? Do you know the DP technique where you basically reuse columns to generate the last table-cell? You don&#39;t have to mutate those (although it&#39;s even faster) - you can just transform theses FP style and it should help you do (you will have a bit more GCs thats all)"}, {"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432286671, "post_id": 30388757, "comment_id": 48873849, "body": "@Carsten My question has update, the last version code use rolling-array to reduce memory, and as you said, that may depends on the GC if I insist use immutable data structure."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432286861, "post_id": 30388757, "comment_id": 48873980, "body": "I don&#39;t know - I had a quick glance at it and for me it looks like you still initialize a full array for all <code>n</code> columns here <code>listArray (0, n - 1) lis</code> (?) (it&#39;s kindof hard to read actually - sorry)"}, {"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432287362, "post_id": 30388757, "comment_id": 48874309, "body": "@Carsten the <code>lis</code> is a n-size (not exceeding 500) <code>List</code>, <code>listArray (0, n - 1) lis</code> just translate the <code>List</code> to <code>Array</code> for indexing performance. The neckbottle is the <code>dp n</code>, which product a new 500*500 Array from previous 500*500 Array (which should be freed by GC after <code>build</code>), the n indict the times of such a product-process."}, {"owner": {"reputation": 4938, "user_id": 1465011, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5c11daff0c870a2b41ae9b907a136adf?s=128&d=identicon&r=PG", "display_name": "recursion.ninja", "link": "https://stackoverflow.com/users/1465011/recursion-ninja"}, "edited": false, "score": 0, "creation_date": 1432321905, "post_id": 30388757, "comment_id": 48896126, "body": "Reinventing the wheel aren&#39;t we? Look at <a href=\"https://hackage.haskell.org/package/monad-memo-0.3.0/docs/Control-Monad-Memo.html\" rel=\"nofollow noreferrer\"><b><code>Control.Monad.Memo</code></b></a>"}], "owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "closed_date": 1458762580, "answer_count": 0, "score": 0, "last_activity_date": 1432286836, "creation_date": 1432271383, "last_edit_date": 1432286836, "question_id": 30388757, "link": "https://stackoverflow.com/questions/30388757/haskell-performance-of-memoization-implement-of-dynamic-programming-is-poor", "closed_reason": "Duplicate", "title": "Haskell performance of memoization implement of dynamic programming is poor", "body": "<p>Problem starts from a algorithm problem from codeforces, here is the link <a href=\"http://codeforces.com/contest/543/problem/A\" rel=\"nofollow\">Writing Code</a>.\nThe problem is a basic DP problem which solution could be found at <a href=\"http://codeforces.com/blog/entry/17773\" rel=\"nofollow\">Solution Report</a>.</p>\n\n<p>I try to solve it using Haksell, my solution is recurse with memoization, which time complexity is also <code>O(n^3)</code>. Here is my code:</p>\n\n<pre><code>{-# OPTIONS_GHC -O2 -funbox-strict-fields #-}\n{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances, BangPatterns #-}\n\nimport Data.Functor\nimport Data.List\n\nclass Memo m a where\n    memo :: m -&gt; a\n\ninstance Memo m m where\n    memo = id\n\ninstance Memo m a =&gt; Memo (Int -&gt; m) [a] where\n    memo f = map (memo.f) [0..]\n\nsolve :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; [Int] -&gt; Int\nsolve n m b mod arr = modsum.map (go n m) $ [0 .. b]\n    where mods = (`rem` mod)\n          modsum = foldl1' (\\a b -&gt; mods (a + b))\n          go :: Int -&gt; Int -&gt; Int -&gt; Int\n          go _ 0 0 = 1\n          go _ 0 _ = 0\n          go 0 _ _ = 0\n          go i j k = mods $ a + b\n            where !id = i - 1\n                  !ai = arr !! id\n                  !a = (if k &gt;= ai then memo_go !! i !! (j - 1) !! (k - ai) else 0)\n                  !b = memo_go !! id !! j !! k\n          memo_go = memo go\n\n\nmain = do [n, m, b, mod] &lt;- map read.words &lt;$&gt; getLine\n          arr &lt;- map read.words &lt;$&gt; getLine\n          print $ solve n m b mod arr          \n</code></pre>\n\n<p>And the performance report of this program using <code>RTS</code> is:</p>\n\n<pre><code>    Fri May 22 12:25 2015 Time and Allocation Profiling Report  (Final)\n\n       test.exe +RTS -p -RTS\n\n    total time  =        5.75 secs   (5751 ticks @ 1000 us, 1 processor)\n    total alloc = 189,957,112 bytes  (excludes profiling overheads)\n\nCOST CENTRE MODULE  %time %alloc\n\nsolve.go    Main     97.2    8.5\nmemo        Main      2.3   82.8\nsolve.mods  Main      0.5    8.5\n\n\n                                                                  individual     inherited\nCOST CENTRE          MODULE                     no.     entries  %time %alloc   %time %alloc\n\nMAIN                 MAIN                        52           0    0.0    0.0   100.0  100.0\n main                Main                       105           0    0.0    0.3   100.0  100.0\n  solve.modsum       Main                       108           1    0.0    0.0     0.0    0.0\n  solve              Main                       106           1    0.0    0.0   100.0   99.7\n   solve.memo_go     Main                       114           1    0.0    0.0    99.9   99.7\n    memo             Main                       115       10301    2.3   82.8    99.9   99.7\n     solve.go        Main                       118     1024999   97.2    8.5    97.6   16.9\n      solve.mods     Main                       119           0    0.5    8.5     0.5    8.5\n   solve.go          Main                       113         101    0.0    0.0     0.0    0.0\n    solve.mods       Main                       120           0    0.0    0.0     0.0    0.0\n   solve.mods        Main                       111           1    0.0    0.0     0.0    0.0\n   solve.modsum      Main                       109           0    0.0    0.0     0.0    0.0\n    solve.modsum.\\   Main                       110         100    0.0    0.0     0.0    0.0\n     solve.mods      Main                       112           0    0.0    0.0     0.0    0.0\n CAF                 GHC.IO.Encoding.CodePage    91           0    0.0    0.0     0.0    0.0\n CAF                 GHC.IO.Encoding             84           0    0.0    0.0     0.0    0.0\n CAF                 Text.Read.Lex               81           0    0.0    0.0     0.0    0.0\n CAF                 GHC.IO.Handle.FD            72           0    0.0    0.0     0.0    0.0\n CAF:main1           Main                        68           0    0.0    0.0     0.0    0.0\n  main               Main                       104           1    0.0    0.0     0.0    0.0\n CAF:lvl2_r3ul       Main                        64           0    0.0    0.0     0.0    0.0\n CAF:$fMemo(-&gt;)[]1   Main                        61           0    0.0    0.0     0.0    0.0\n  memo               Main                       116           0    0.0    0.0     0.0    0.0\n CAF:$fMemomm_$cmemo Main                        59           0    0.0    0.0     0.0    0.0\n  memo               Main                       117           1    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>Predictably, the bottleneck is the <code>memo_go</code>. The memo_go is a 3-D array, in which every element is a thunk <code>go i j k</code>, and it would only be evaluated once. However, this code got a TLE from the judge.</p>\n\n<p>I wander how to improve the performance of this code?</p>\n\n<p><strong>Updata</strong>\nI change the List to Array and got an MLE, so I use rolling-array to reduce the memory, here is my code:</p>\n\n<pre><code>{-# OPTIONS_GHC -O2 -funbox-strict-fields #-}\n{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances, BangPatterns #-}\n\nimport Data.Functor\nimport Data.List (foldl', foldl1')\nimport Data.Array\n--import qualified  Data.Vector as V\n\nsize = 510\n\nclass Memo m a where\n    memo :: m -&gt; a\n\ninstance Memo m m where\n    memo = id\n\ninstance Memo m a =&gt; Memo (Int -&gt; m) (Array Int a) where\n    memo f = fmap (memo.f) $ listArray (0, size) [0..size]\n\nsolve :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; [Int] -&gt; Int\nsolve n m b mod lis = modsum.map (res ! m !) $ [0 .. b]\n    where arr = listArray (0, n - 1) lis\n          mods = (`rem` mod)\n          modsum = foldl1' (\\a b -&gt; mods (a + b))\n          init :: Int -&gt; Int -&gt; Int\n          init 0 0 = 1\n          init _ _ = 0\n          arr_init = memo init\n          dp n = foldl' build arr_init [1..n]\n            where build ar idx = memo_go'\n                    where !ai = arr ! (idx - 1)\n                          memo_go' = memo go'\n                          go' i j = mods $ a + b\n                            where !a = ar ! i ! j\n                                  !b = if i &gt; 0 &amp;&amp; j &gt;= ai then memo_go' ! (i - 1) ! (j - ai) else 0\n          res = dp n\n\nmain = do [n, m, b, mod] &lt;- map read.words &lt;$&gt; getLine\n          arr &lt;- map read.words &lt;$&gt; getLine\n          print $ solve n m b mod arr          \n</code></pre>\n\n<p>Still MLE, maybe I should use the mutable data structrue :(</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1432281077, "post_id": 30388543, "comment_id": 48870687, "body": "Try <code>printTuple :: Show a =&gt; [([Char], a)] -&gt; IO ()</code>. If you print, you <i>have</i> to return an <code>IO something</code> type."}, {"owner": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432282061, "post_id": 30388543, "comment_id": 48871221, "body": "Ah I did not know that, thank you!   I don&#39;t mind how it prints as long as it is in the correct format. I&#39;m very new to Haskell and just trying what I know so far :)  Unfortunately that returns: Couldn&#39;t match type \u2018(String, Int)\u2019 with \u2018[([Char], a0)]\u2019"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432283411, "post_id": 30388543, "comment_id": 48871931, "body": "ok - I have to admit I should have called the function <code>printTuples</code> (will fix it) - anyway the problem is that you use <code>mapM_</code> but you don&#39;t really need to (as I already use <code>forM_</code>) - so just to <code>printTuples reversed</code> instead"}, {"owner": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "edited": false, "score": 0, "creation_date": 1432284293, "post_id": 30388543, "comment_id": 48872469, "body": "Thank you so much for the help! My program is working fine now :D"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432284805, "post_id": 30388543, "comment_id": 48872745, "body": "no problem - glad to help - maybe you can accept the answer then ;) (thanks)"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "edited": false, "score": 0, "creation_date": 1432279962, "post_id": 30388609, "comment_id": 48870030, "body": "Thanks for the help! However I&#39;ve added your code into my program:"}, {"owner": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "edited": false, "score": 0, "creation_date": 1432280428, "post_id": 30388609, "comment_id": 48870269, "body": "It gives me these errors:      Couldn&#39;t match type \u2018[]\u2019 with \u2018IO\u2019     Expected type: [([Char], a0)] -&gt; IO ()       Actual type: [([Char], a0)] -&gt; [()]      Couldn&#39;t match type \u2018(String, Int)\u2019 with \u2018[([Char], a0)]\u2019     Expected type: [[([Char], a0)]]       Actual type: [(String, Int)]  Any suggestions? Thanks!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "edited": false, "score": 0, "creation_date": 1432280453, "post_id": 30388609, "comment_id": 48870289, "body": "@AlastairWarren please edit your own question - not my answer ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "edited": false, "score": 0, "creation_date": 1432280547, "post_id": 30388609, "comment_id": 48870348, "body": "my fault sorry - I messed up the types and pasted the wrong one :( ... should be fixed now"}, {"owner": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "edited": false, "score": 0, "creation_date": 1432281257, "post_id": 30388609, "comment_id": 48870791, "body": "It now is partly fixed :) However I still get one error:  fileToText.hs:18:28:     Couldn&#39;t match type \u2018(String, Int)\u2019 with \u2018[(String, a0)]\u2019     Expected type: [[(String, a0)]]       Actual type: [(String, Int)]     In the second argument of \u2018mapM_\u2019, namely \u2018reversed\u2019     In a stmt of a &#39;do&#39; block: mapM_ (printTuple) reversed"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1432283983, "last_edit_date": 1432283983, "creation_date": 1432270392, "answer_id": 30388609, "question_id": 30388543, "link": "https://stackoverflow.com/questions/30388543/haskell-printing-a-list-of-tuples/30388609#30388609", "title": "Haskell - Printing a list of tuples", "body": "<p>let's start by formatting one item:</p>\n\n<pre><code>formatOne :: Show a =&gt; (String, a) -&gt; String\nformatOne (s,i) = s ++ \" : \" ++ show i\n</code></pre>\n\n<p>now you can use this function (for example) with <code>forM_</code> from <code>Control.Monad</code> to print it to the screen like this (<code>forM_</code> because we want to <em>be</em> in the IO-Monad - because we are going to use <code>putStrLn</code>):</p>\n\n<pre><code>Prelude&gt; let test = [(\"X1\",4), (\"X2\",5)]\nPrelude&gt; import Control.Monad (forM_)\nPrelude Control.Monad&gt; forM_ test (putStrLn . formatOne)\nX1 : 4\nX2 : 5\n</code></pre>\n\n<p>in a file you would use it like this:</p>\n\n<pre><code>import Control.Monad (forM_)\n\nprintTuples :: Show a =&gt; [(String, a)] -&gt; IO ()\nprintTuples xs = forM_ xs (putStrLn . formatOne)\n\nformatOne :: Show a =&gt; (String, a) -&gt; String\nformatOne (s,i) = s ++ \" : \" ++ show i\n</code></pre>\n\n<h2>compiling file</h2>\n\n<p>overall here is a version of your code that will at least compile (cannot test it without the text file ;) )</p>\n\n<pre><code>import Control.Monad (forM_)\nimport Data.Char (toLower)\nimport Data.List (sort, sortBy, group)\nimport Data.Ord (comparing)\n\nmain :: IO ()\nmain = do  \n    putStrLn \"********* Haskell word frequency counter *********\"\n    putStrLn \"\"\n    conts &lt;- readFile \"text.txt\"\n    let lowConts = map toLower conts\n    let counted = countAllWords lowConts\n    let sorted = sortTuples counted\n    let reversed = reverse sorted\n    putStrLn \"Word : Count\"\n    printTuples reversed\n\n-- Counts all the words.\ncountAllWords :: String -&gt; [(String, Int)]\ncountAllWords = wordsCount . toWords . noPunc\n\n-- Splits words and removes linking words.\ntoWords :: String -&gt; [String]\ntoWords = filter (\\w -&gt; w `notElem` [\"and\",\"the\",\"for\"]) . words\n\n-- Remove punctuation from text String.\nnoPunc :: String -&gt; String\nnoPunc xs = [ x | x &lt;- xs, x `notElem` \",.?!-:;\\\"\\'\" ]\n\n-- Counts, how often each string in the given list appears.\nwordsCount :: [String] -&gt; [(String, Int)]\nwordsCount = map (\\xs -&gt; (head xs, length xs)) . group . sort\n\n-- Sort list in order of occurrences.\nsortTuples :: [(String, Int)] -&gt; [(String, Int)]\nsortTuples = sortBy $ comparing snd\n\n-- print one tuple per line separated by \" : \"\nprintTuples :: Show a =&gt; [(String, a)] -&gt; IO ()\nprintTuples = mapM_ (putStrLn . formatTuple)\n  where formatTuple (s,i) = s ++ \" : \" ++ show i\n</code></pre>\n\n<p>I also removed the compiler warnings and HLINTed it (but skipped the <code>Control.Arrow</code> stuff - I don't think <code>head &amp;&amp;&amp; length</code> is more readable option here)</p>\n"}], "owner": {"reputation": 55, "user_id": 4927475, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--gqfkPEPL4E/AAAAAAAAAAI/AAAAAAAAAIA/WpRO9sf3Z7w/photo.jpg?sz=128", "display_name": "Alastair Warren", "link": "https://stackoverflow.com/users/4927475/alastair-warren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 30388609, "answer_count": 1, "score": 2, "last_activity_date": 1432283983, "creation_date": 1432269976, "last_edit_date": 1432281344, "question_id": 30388543, "link": "https://stackoverflow.com/questions/30388543/haskell-printing-a-list-of-tuples", "title": "Haskell - Printing a list of tuples", "body": "<p>I have a list of tuples in the form:</p>\n\n<pre><code>[(String, Int)]\n</code></pre>\n\n<p>How can I print this to display like:</p>\n\n<pre><code>String : Int\nString : Int\nString : Int\n...\n</code></pre>\n\n<p>I am very new to Haskell so please make it as clear as possible. Thank you!</p>\n\n<p>Update: Here's how the code of my program now looks:</p>\n\n<pre><code>main = do  \n    putStrLn \"********* Haskell word frequency counter *********\"\n    putStrLn \"\"\n    conts &lt;- readFile \"text.txt\"\n    let lowConts = map toLower conts\n    let counted = countAllWords (lowConts)\n    let sorted = sortTuples (counted)\n    let reversed = reverse sorted\n    putStrLn \"Word : Count\"\n    mapM_ (printTuple) reversed\n\n-- Counts all the words.\ncountAllWords :: String -&gt; [(String, Int)]\ncountAllWords fileContents = wordsCount (toWords (noPunc fileContents))\n\n-- Splits words and removes linking words.\ntoWords :: String -&gt; [String]\ntoWords s = filter (\\w -&gt; w `notElem` [\"and\",\"the\",\"for\"]) (words s)\n\n-- Remove punctuation from text String.\nnoPunc :: String -&gt; String\nnoPunc xs = [ x | x &lt;- xs, not (x `elem` \",.?!-:;\\\"\\'\") ]\n\n-- Counts, how often each string in the given list appears.\nwordsCount :: [String] -&gt; [(String, Int)]\nwordsCount xs = map (\\xs -&gt; (head xs, length xs)) . group . sort $ xs\n\n-- Sort list in order of occurrences.\nsortTuples :: [(String, Int)] -&gt; [(String, Int)]\nsortTuples sort = sortBy (comparing snd) sort\n\n\nprintTuple :: Show a =&gt; [(String, a)] -&gt; IO ()\nprintTuple xs = forM_ xs (putStrLn . formatOne)\n\nformatOne :: Show a =&gt; (String, a) -&gt; String\nformatOne (s,i) = s ++ \" : \" ++ show i\n</code></pre>\n\n<p>It returns this error to me:</p>\n\n<pre><code>fileToText.hs:18:28:\nCouldn't match type \u2018(String, Int)\u2019 with \u2018[(String, a0)]\u2019\nExpected type: [[(String, a0)]]\n  Actual type: [(String, Int)]\nIn the second argument of \u2018mapM_\u2019, namely \u2018reversed\u2019\nIn a stmt of a 'do' block: mapM_ (printTuple) reversed\n</code></pre>\n\n<p>Thanks for any help!     </p>\n"}, {"tags": ["haskell", "authentication", "yesod", "jwt", "session-less"], "comments": [{"owner": {"reputation": 681, "user_id": 1072240, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1ef5bf598c44bbfa8b87fd77ccf2a993?s=128&d=identicon&r=PG", "display_name": "Jason Whittle", "link": "https://stackoverflow.com/users/1072240/jason-whittle"}, "edited": false, "score": 1, "creation_date": 1464383823, "post_id": 30387436, "comment_id": 62481051, "body": "leeks, did you ever find a solution to this problem?"}], "owner": {"reputation": 99, "user_id": 1477320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea41b95d3ac0816d486b2b77f9619c7?s=128&d=identicon&r=PG", "display_name": "ghn", "link": "https://stackoverflow.com/users/1477320/ghn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 5, "answer_count": 0, "score": 5, "last_activity_date": 1432305526, "creation_date": 1432261634, "last_edit_date": 1432305526, "question_id": 30387436, "link": "https://stackoverflow.com/questions/30387436/yesod-auth-sessionless-auth-plugin-flow", "title": "Yesod Auth: Sessionless Auth Plugin Flow", "body": "<p>I'm trying to using Yesod as mobile application's API backend and have chosen to use bearer JWTs to handle authentication and authorization. I've overridden <code>maybeAuthId</code> so that Yesod.Auth accepts (or rejects) the JWTs just fine. However, I can't figure out how to get the auth plugins to return a token to the client instead of its default behavior of storing the AuthId in the client session and redirecting the client. Is there anyway to alter the default auth plugin flow to have it return a token to the client instead?</p>\n\n<p><em>Update</em>: I've dug around in the docs and source code for a bit and have a better idea of how the auth plugins work now: Auth plugins internally call <code>setCredsRedirect</code> to set the session and do the callback <code>onLogin</code>. The problem with using <code>onLogin</code> is that <code>Creds</code> are not accessible from inside that function. My only other idea for a solution is to edit the <code>authenticate</code> function to respond with the JWT.</p>\n"}, {"tags": ["haskell", "substitution"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432268128, "post_id": 30386294, "comment_id": 48865422, "body": "it looks good yeah - for the tool: you could basically use the debugger in GHCi to step through it ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432276863, "post_id": 30386294, "comment_id": 48868414, "body": "btw: this kind of question is really rather unfortunate for SO - as you can see you only get answers like &quot;Yes I think so&quot;  - this is why I gonna vote to close this"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432280604, "post_id": 30386294, "comment_id": 48870391, "body": "Maybe <a href=\"https://stevekrouse.github.io/hs.js/\" rel=\"nofollow noreferrer\">stevekrouse.github.io/hs.js</a> can help, but I don&#39;t know exactly how much Haskell is supported by that tool."}, {"owner": {"reputation": 724, "user_id": 816544, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/713b44c5bbcfeceee8b415dde781a19f?s=128&d=identicon&r=PG", "display_name": "froehli", "link": "https://stackoverflow.com/users/816544/froehli"}, "edited": false, "score": 0, "creation_date": 1432302325, "post_id": 30386294, "comment_id": 48884427, "body": "This site is great but seems to be not capable to interprete this code: &quot;Expected &quot; &quot;, &quot;(&quot;, &quot;=&quot;, &quot;[&quot;, [0-9] or [A-Za-z] but &quot;\\&quot;&quot; found.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "is_accepted": false, "score": 2, "last_activity_date": 1432276218, "creation_date": 1432276218, "answer_id": 30389795, "question_id": 30386294, "link": "https://stackoverflow.com/questions/30386294/step-by-step-substitution/30389795#30389795", "title": "Step by Step Substitution", "body": "<p>I tried to figure it out in my head without reading your solution. When I was half through I got a headache and started further reading your post. As far as I got all was in accord with what you wrote. The remaining part was nicely explained by you.</p>\n\n<p>From what I can tell and to answer your question, yes, you are right.</p>\n"}, {"comments": [{"owner": {"reputation": 724, "user_id": 816544, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/713b44c5bbcfeceee8b415dde781a19f?s=128&d=identicon&r=PG", "display_name": "froehli", "link": "https://stackoverflow.com/users/816544/froehli"}, "edited": false, "score": 0, "creation_date": 1432302171, "post_id": 30391478, "comment_id": 48884306, "body": "Wow. This is a bit overwhelming for my basic knowledge. But I tried it on my ghci and got the following error-message: Error: &quot;parse error (possibly incorrect indentation or mismatched brackets)&quot;."}, {"owner": {"reputation": 300, "user_id": 4767807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672d5954b219fc35f495dd3a97770b67?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4767807/damien"}, "reply_to_user": {"reputation": 724, "user_id": 816544, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/713b44c5bbcfeceee8b415dde781a19f?s=128&d=identicon&r=PG", "display_name": "froehli", "link": "https://stackoverflow.com/users/816544/froehli"}, "edited": false, "score": 0, "creation_date": 1432322134, "post_id": 30391478, "comment_id": 48896255, "body": "I corrected it but had to put the case statement on a single line."}], "tags": [], "owner": {"reputation": 300, "user_id": 4767807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672d5954b219fc35f495dd3a97770b67?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4767807/damien"}, "is_accepted": false, "score": 2, "last_activity_date": 1432321845, "last_edit_date": 1432321845, "creation_date": 1432282039, "answer_id": 30391478, "question_id": 30386294, "link": "https://stackoverflow.com/questions/30386294/step-by-step-substitution/30391478#30391478", "title": "Step by Step Substitution", "body": "<p>I would suggest you use Debug.Trace.trace in your code to trace calls and return values:</p>\n\n<pre><code>trace :: String -&gt; a -&gt; a\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>import Debug.Trace\n\ntraceL l t v = trace (replicate l ' '++t) v  \n\nlines' :: String -&gt; Int -&gt; [String]\nlines' \"\"        l = traceL l\"lines \\\"\\\" = \" $ traceL l \"[]\" []\nlines' ('\\n':cs) l = \n    let v = (traceL l (\"lines ('\\\\n':\"++show cs++\") = \") \"\"):lines' cs (l+1)\n    in  (traceL l (show v) v)\n\nlines' (c:cs) l = \n    let v = case traceL l (\"lines (\"++show c++\":\"++show cs++\") = \") $ lines' cs (l+1) of [] -&gt; [[c]];(x:xs) -&gt; (c:x):xs\n    in (traceL l (show v) v)\n</code></pre>\n\n<p>The l parameter is the level of call.\nHope it will help</p>\n"}, {"tags": [], "owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "is_accepted": false, "score": 1, "last_activity_date": 1432435693, "creation_date": 1432435693, "answer_id": 30419587, "question_id": 30386294, "link": "https://stackoverflow.com/questions/30386294/step-by-step-substitution/30419587#30419587", "title": "Step by Step Substitution", "body": "<p>nu, the recursive calls to <code>lines</code> will stack so the expression will be processed from right to left, returning the arguments to the earlier calls. Something like:</p>\n\n<pre><code>\"o\" will pass a \"\" as cs returning a []\n\n'o' will then become [\"o\"] returning a (l:ls)\n\n\"\\n\" will become a \"\", cons'd into the [\"o\"], returning [\"\",\"o\"], another (l:ls)\n\n'f' will finally become the c in (c:l):ls meaning ('f':\"\"):[\"o\"] producing [\"f\",\"o\"]\n</code></pre>\n"}], "owner": {"reputation": 724, "user_id": 816544, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/713b44c5bbcfeceee8b415dde781a19f?s=128&d=identicon&r=PG", "display_name": "froehli", "link": "https://stackoverflow.com/users/816544/froehli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1432435693, "creation_date": 1432252553, "last_edit_date": 1432302965, "question_id": 30386294, "link": "https://stackoverflow.com/questions/30386294/step-by-step-substitution", "title": "Step by Step Substitution", "body": "<p>I have problems in understanding the following function</p>\n\n<pre><code>lines :: String -&gt; [String]\nlines \"\"        = []\nlines ('\\n':cs) = \"\": lines cs\nlines (c:cs)    = case lines cs of\n                   [] -&gt; [[c]]\n                   (l:ls) -&gt; (c:l):ls\n</code></pre>\n\n<p>I want to understand what the function is doing when it is called by <code>\"f\\no\"</code>. I am looking for a tool that shows every substitution step for a better understanding of the function. I tried it manually (and got a solution while writing this post) but I am not sure if I am correct.</p>\n\n<pre><code>lines ('f':\"\\no\")  = case lines \"\\no\" of\n                      [] -&gt; [['f']]\n                      (l:ls) -&gt; ('f':l):ls\n</code></pre>\n\n<p>--> <code>lines \"\\no\"</code></p>\n\n<pre><code>lines ('\\n':\"o\")   = \"\": lines \"o\"\n</code></pre>\n\n<p>--> <code>lines \"o\"</code></p>\n\n<pre><code>lines ('o':\"\")     = case lines \"\" of\n                      [] -&gt; [['o']]\n                      (l:ls) -&gt; ('o':l):ls\n</code></pre>\n\n<p>--> <code>lines \"\"</code> </p>\n\n<pre><code>lines \"\"           = []\n</code></pre>\n\n<p>--> return <code>[]</code></p>\n\n<pre><code>lines ('o':\"\")     = case [] of\n                      [] -&gt; [['o']]\nlines ('o':\"\")     = [['o']]\n</code></pre>\n\n<p>--> return <code>[\"o\"]</code></p>\n\n<pre><code>lines ('\\n':cs)     = \"\": [\"o\"]\n</code></pre>\n\n<p>-->return <code>\"\": [\"o\"]</code></p>\n\n<pre><code>lines ('f':\"\\no\")  = case \"\":[\"o\"] of\n                      (l:ls) -&gt; ('f':l):ls\n\nlines ('f':\"\\no\")  = ('f':\"\"):[\"o\"]\n                   = [\"f\", \"o\"]\n</code></pre>\n\n<p>Is that right?</p>\n"}, {"tags": ["haskell", "design-patterns", "overlapping-matches", "as-pattern"], "comments": [{"owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1432246892, "post_id": 30385303, "comment_id": 48859913, "body": "Why not <code>x1:x2:_</code>? I don&#39;t see any reason to use &quot;as&quot; pattern here."}, {"owner": {"reputation": 724, "user_id": 816544, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/713b44c5bbcfeceee8b415dde781a19f?s=128&d=identicon&r=PG", "display_name": "froehli", "link": "https://stackoverflow.com/users/816544/froehli"}, "reply_to_user": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1432247009, "post_id": 30385303, "comment_id": 48859951, "body": "It is an example from my professor to descripe as-pattern and bindings. But it is more a mention than an explaination."}, {"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "reply_to_user": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 1, "creation_date": 1432247471, "post_id": 30385303, "comment_id": 48860118, "body": "@dredozubov: How would you know what to recurse on in your example?"}, {"owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "reply_to_user": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 0, "creation_date": 1432333518, "post_id": 30385303, "comment_id": 48901071, "body": "@Guvante my point is: there is no need to alias subexpressions"}, {"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "reply_to_user": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1432658468, "post_id": 30385303, "comment_id": 49008986, "body": "@dredozubov: Your example drops the rest of the list and thus cannot work. <code>x1:x2:xs</code> could work but <code>x1:x2:_</code> cannot recurse on the remainder of the list making getting the last item impossible."}], "answers": [{"tags": [], "owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "is_accepted": true, "score": 3, "last_activity_date": 1432247687, "creation_date": 1432247687, "answer_id": 30385465, "question_id": 30385303, "link": "https://stackoverflow.com/questions/30385303/functionality-of-as-pattern-non-overlapping-pattern-through-as-pattern/30385465#30385465", "title": "Functionality of as-pattern, non overlapping pattern through &#39;as pattern&#39;", "body": "<p>Your recursion is going to <code>last</code> in both cases, not <code>last1</code>/<code>last2</code>.</p>\n\n<blockquote>\n  <p><code>last1</code> should be non overlapping in comparison to <code>last2</code>.\n  Lets take a look at the specific String <code>f:[]</code>. It would match to <code>[x]</code> and <code>(x:xs)</code> in <code>last1</code>. </p>\n</blockquote>\n\n<p>It could match <code>(x:xs)</code> but it won't as pattern matching will only match the first success. Overlaps are not ambiguous in this regard (the first definition is always taken).</p>\n\n<blockquote>\n  <p>In <code>last2</code>it would match to <code>[y]</code>. But not to <code>(y:ys@(_:_))</code>, because <code>ys</code> has to match <code>(_:_)</code> and just fulfills the first any pattern with <code>[]</code>.</p>\n</blockquote>\n\n<p>Your phrasing is a bit odd but you are correct that <code>f:[]</code> cannot match to <code>(y:ys@(_:_))</code> as the latter is basically matching on <code>_:_:_</code> which isn't a match.</p>\n\n<blockquote>\n  <p>Now take a look at the specific String <code>f:o:o:[]</code>. Now the pattern <code>(y:ys@(_:_))</code> matches. In this case I am curious how the binding works. What is <code>ys</code> after the first call? I assume it is <code>o:o:[]</code>.</p>\n</blockquote>\n\n<p><code>ys</code> does equal <code>o:o:[]</code> (or <code>\"oo\"</code> or <code>[o,o]</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 0, "last_activity_date": 1432247740, "creation_date": 1432247740, "answer_id": 30385473, "question_id": 30385303, "link": "https://stackoverflow.com/questions/30385303/functionality-of-as-pattern-non-overlapping-pattern-through-as-pattern/30385473#30385473", "title": "Functionality of as-pattern, non overlapping pattern through &#39;as pattern&#39;", "body": "<p>Both functions are the same in Haskell, as the first matching equation is used. Your second function is a bit more explicit about it, but the first is more idiomatic.</p>\n"}], "owner": {"reputation": 724, "user_id": 816544, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/713b44c5bbcfeceee8b415dde781a19f?s=128&d=identicon&r=PG", "display_name": "froehli", "link": "https://stackoverflow.com/users/816544/froehli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 30385465, "answer_count": 2, "score": 2, "last_activity_date": 1432247740, "creation_date": 1432246734, "question_id": 30385303, "link": "https://stackoverflow.com/questions/30385303/functionality-of-as-pattern-non-overlapping-pattern-through-as-pattern", "title": "Functionality of as-pattern, non overlapping pattern through &#39;as pattern&#39;", "body": "<p>I am new to functional programming and haskell in particular and have two questions abound as-pattern and the reduction of overlappings through using it.\nGiving the following code example:</p>\n\n<pre><code>last1 :: [a]          -&gt;  a\nlast1    [x]          =   x\nlast1    (x:xs)       =   last xs\n\nlast2 :: [a]          -&gt;  a\nlast2    [y]          =   y\nlast2    (y:ys@(_:_)) =   last ys\n</code></pre>\n\n<p><code>last1</code> should be non overlapping in comparison to <code>last2</code>.\nLets take a look at the specific String <code>f:[]</code>. It would match to <code>[x]</code> and <code>(x:xs)</code> in <code>last1</code>. </p>\n\n<p>In <code>last2</code>it would match to <code>[y]</code>. But not to <code>(y:ys@(_:_))</code>, because <code>ys</code> has to match <code>(_:_)</code> and just fulfills the first any pattern with <code>[]</code>.</p>\n\n<p>Are my assumptions correct?</p>\n\n<p>Now take a look at the specific String <code>f:o:o:[]</code>. Now the pattern <code>(y:ys@(_:_))</code> matches. In this case I am curious how the binding works. What is <code>ys</code> after the first call? I assume it is <code>o:o:[]</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432243060, "post_id": 30384453, "comment_id": 48858139, "body": "well that would be the same as having a function <code>valueTwo :: Foo -&gt; Int</code> (<code>valueTwo = (*2) . valueOne</code>) anyway wouldn&#39;t it? (and no this is not possible - you would not want it anyway as you can say <code>Foo 2 3</code> to create a value of type <code>Foo</code> which would be <i>wrong</i>)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432243263, "post_id": 30384453, "comment_id": 48858244, "body": "BTW: this <code>Foo</code> <code>deriving Bar</code> stuff <i>smells</i> of OOP ;) (no offense - just joking)"}, {"owner": {"reputation": 50, "user_id": 3435597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777d1722a94aef0c7c90f01bc09bb183?s=128&d=identicon&r=PG&f=1", "display_name": "Slimemold", "link": "https://stackoverflow.com/users/3435597/slimemold"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432243311, "post_id": 30384453, "comment_id": 48858270, "body": "Well I come from OOP :D. My question I guess would then be, what about when we have some datatype where it makes sense that a third value would be derived? <code>data Square=Square {sides::Int, area::Int}</code>. It seems like we would want area to be part of that package, even though it is a derived value."}, {"owner": {"reputation": 50, "user_id": 3435597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777d1722a94aef0c7c90f01bc09bb183?s=128&d=identicon&r=PG&f=1", "display_name": "Slimemold", "link": "https://stackoverflow.com/users/3435597/slimemold"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432243476, "post_id": 30384453, "comment_id": 48858348, "body": "I could very well be talking crazy."}], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 3435597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777d1722a94aef0c7c90f01bc09bb183?s=128&d=identicon&r=PG&f=1", "display_name": "Slimemold", "link": "https://stackoverflow.com/users/3435597/slimemold"}, "edited": false, "score": 0, "creation_date": 1432243749, "post_id": 30384558, "comment_id": 48858481, "body": "Ah! This makes sense. Is this something that I shouldn&#39;t be doing though?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 50, "user_id": 3435597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777d1722a94aef0c7c90f01bc09bb183?s=128&d=identicon&r=PG&f=1", "display_name": "Slimemold", "link": "https://stackoverflow.com/users/3435597/slimemold"}, "edited": false, "score": 0, "creation_date": 1432244053, "post_id": 30384558, "comment_id": 48858629, "body": "@Slimemold I don&#39;t think there are significant problems with this approach -- it&#39;s not extremely frequent, but I guess it&#39;s quite idiomatic. E.g. <code>Data.Rational</code> uses this to disallow non-normalized fractions. Whether you should do this or not ultimately depends on your goal, of course."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 50, "user_id": 3435597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777d1722a94aef0c7c90f01bc09bb183?s=128&d=identicon&r=PG&f=1", "display_name": "Slimemold", "link": "https://stackoverflow.com/users/3435597/slimemold"}, "edited": false, "score": 2, "creation_date": 1432244352, "post_id": 30384558, "comment_id": 48858772, "body": "(The actual module name is <code>Data.Ratio</code>)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 9, "last_activity_date": 1432243465, "last_edit_date": 1432243465, "creation_date": 1432243261, "answer_id": 30384558, "question_id": 30384453, "link": "https://stackoverflow.com/questions/30384453/haskell-type-with-derived-value/30384558#30384558", "title": "Haskell type with derived value", "body": "<p>If you <em>always</em> want the second field to depend on the first, just write a plain function:</p>\n\n<pre><code>data Foo = Foo { valueOne :: Int } deriving (Bar)\n\nvalueTwo :: Foo -&gt; Int\nvalueTwo x = valueOne x * 2\n</code></pre>\n\n<p>The only difference is that the <code>Bar</code> instance, which is automatically generated, won't notice the second field.</p>\n\n<p>If, instead, you want to <em>generate</em> values with such constraint, but still be able to sometimes disregard that, use a <em>smart constructor</em>:</p>\n\n<pre><code>data Foo = Foo { valueOne :: Int, valueTwo :: Int } deriving (Bar)\n\nfoo :: Int -&gt; Foo\nfoo x = Foo x (2 * x)\n</code></pre>\n\n<p>If you use <code>foo</code> instead of <code>Foo</code> to construct new values, you will not need to pass the second argument, which will be derived from the first one.</p>\n\n<p>Usually this is used in a <code>module</code> which does not export the constructor <code>Foo</code>, but exports the smart constructor <code>foo</code>. In this way the users of the module are constrained to build values satisfying the invariant, while the functions in the module can ignore it, when needed.</p>\n"}], "owner": {"reputation": 50, "user_id": 3435597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777d1722a94aef0c7c90f01bc09bb183?s=128&d=identicon&r=PG&f=1", "display_name": "Slimemold", "link": "https://stackoverflow.com/users/3435597/slimemold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 30384558, "answer_count": 1, "score": 1, "last_activity_date": 1432243465, "creation_date": 1432242873, "question_id": 30384453, "link": "https://stackoverflow.com/questions/30384453/haskell-type-with-derived-value", "title": "Haskell type with derived value", "body": "<p>Is it possible to have a type preform a function one of its value to generate another one of it's values? For instance:</p>\n\n<pre><code>data Foo=Foo {valueOne::Int, valueTwo=valueOne*2} deriving (Bar)\n</code></pre>\n\n<p>Or am I thinking about this in the wrong way? Any help is appreciated!</p>\n"}, {"tags": ["list", "haskell", "sublist"], "comments": [{"owner": {"reputation": 122984, "user_id": 500104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ff1143d80ee378720a879e79fe6da68f?s=128&d=identicon&r=PG", "display_name": "Xeo", "link": "https://stackoverflow.com/users/500104/xeo"}, "edited": false, "score": 0, "creation_date": 1432241728, "post_id": 30384041, "comment_id": 48857486, "body": "Try replacing the first <code>map</code> with <code>concatMap</code> (which is <code>concat (map f)</code>) to get rid of the extra nesting."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1432241873, "post_id": 30384041, "comment_id": 48857557, "body": "<code>map return . concat</code> ;)"}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 2, "last_activity_date": 1432241787, "creation_date": 1432241787, "answer_id": 30384164, "question_id": 30384041, "link": "https://stackoverflow.com/questions/30384041/haskell-wrap-everything-in-list-of-lists-as-a-list-of-lists-of-one-element/30384164#30384164", "title": "Haskell: wrap everything in list of lists as a list of lists of one element", "body": "<p>Perhaps <code>reWrap = (&gt;&gt;= map return)</code>? But this is probably too abstruse for a beginner. There is a solution very close to the one you were trying: <code>rewrap xs = concat $ map (map (:[])) xs</code>. Note that your output was very close to what you wanted, except that everything was exactly one level too deep in a list; <code>concat</code> takes a list of lists and flattens it. </p>\n\n<p>My solution is really doing the same thing, just with more shorthand. Specifically, <code>(:[])</code> is just <code>return</code> specialized to lists, and <code>concat $ map f xs</code> is the same as <code>xs &gt;&gt;= f</code> for lists. Then I also removed the explicit <code>xs</code> argument, since all you do with it is pass it to the partially-applied function you're really defining.</p>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "is_accepted": false, "score": 4, "last_activity_date": 1432241878, "creation_date": 1432241878, "answer_id": 30384187, "question_id": 30384041, "link": "https://stackoverflow.com/questions/30384041/haskell-wrap-everything-in-list-of-lists-as-a-list-of-lists-of-one-element/30384187#30384187", "title": "Haskell: wrap everything in list of lists as a list of lists of one element", "body": "<p>first you need to concat the list</p>\n\n<p>this <code>[ [1, 2, 3], [25, 24, 23, 22], [13] ]</code>\nbecomes <code>[1,2,3,25,24,23,22,13]</code></p>\n\n<p>then you need to wrap each element in a list</p>\n\n<p><code>reWrap = map (:[]) . concat</code></p>\n"}, {"comments": [{"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "edited": false, "score": 1, "creation_date": 1432247446, "post_id": 30384197, "comment_id": 48860104, "body": "if you went with pointed style you could get rid of a few sets of parens: <code>solution xs = xs =&lt;&lt; map (:[])</code>, or perhaps even <code>solution xs = map (:[]) &gt;&gt;= xs</code>"}, {"owner": {"reputation": 133, "user_id": 2851843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c70a8f666ba1a91420ba0fea7455c8?s=128&d=identicon&r=PG&f=1", "display_name": "user2851843", "link": "https://stackoverflow.com/users/2851843/user2851843"}, "edited": false, "score": 0, "creation_date": 1432358731, "post_id": 30384197, "comment_id": 48905657, "body": "It worked! (of course it did). Thanks to you and Xeo since he proposed the same answer in comments. It even gets rid of empty lists so this simple solution is perfect for my task."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 5, "last_activity_date": 1432241901, "creation_date": 1432241901, "answer_id": 30384197, "question_id": 30384041, "link": "https://stackoverflow.com/questions/30384041/haskell-wrap-everything-in-list-of-lists-as-a-list-of-lists-of-one-element/30384197#30384197", "title": "Haskell: wrap everything in list of lists as a list of lists of one element", "body": "<p>This is quite easy, if you use the <code>concatMap</code> prelude function:</p>\n\n<pre><code>\u03bb&gt; :t concatMap\nconcatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>What <code>concatMap</code> does is <code>map</code> a function, then <code>concat</code> the resulting lists.</p>\n\n<p>If we use this definition, we can get the desired effect:</p>\n\n<pre><code>solution :: [[a]] -&gt; [[a]]\nsolution = concatMap (map (:[]))\n</code></pre>\n\n<p>Here it is in action:</p>\n\n<pre><code>\u03bb&gt; solution [[1,2,3],[4,5,6]]\n[[1],[2],[3],[4],[5],[6]]\n\u03bb&gt; solution [[1,2,3],[],[12,19]]\n[[1],[2],[3],[12],[19]]\n</code></pre>\n\n<hr>\n\n<p>As @amalloy said, the <code>&gt;&gt;=</code> function in the case of lists is equivalent to <code>flip concatMap</code>, so you could say this:</p>\n\n<pre><code>solution = (=&lt;&lt;) (map (:[]))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1432242104, "post_id": 30384243, "comment_id": 48857678, "body": "Oh, that&#39;s a nice one! Though I guess this is just an abstraction of <code>concatMap</code> or <code>&gt;&gt;=</code> like any other."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1432242191, "post_id": 30384243, "comment_id": 48857717, "body": "It is probably the same code like yours, once desugared, though easier to read for a beginer."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1432242217, "post_id": 30384243, "comment_id": 48857731, "body": "@Ingo not only for a beginner ;)"}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 6, "last_activity_date": 1432242017, "creation_date": 1432242017, "answer_id": 30384243, "question_id": 30384041, "link": "https://stackoverflow.com/questions/30384041/haskell-wrap-everything-in-list-of-lists-as-a-list-of-lists-of-one-element/30384243#30384243", "title": "Haskell: wrap everything in list of lists as a list of lists of one element", "body": "<p>This is clearly a case for good old list comprehension:</p>\n\n<pre><code> rewrap xss = [ [x] | xs &lt;- xss, x &lt;- xs ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": false, "score": 0, "last_activity_date": 1432289206, "creation_date": 1432289206, "answer_id": 30393899, "question_id": 30384041, "link": "https://stackoverflow.com/questions/30384041/haskell-wrap-everything-in-list-of-lists-as-a-list-of-lists-of-one-element/30393899#30393899", "title": "Haskell: wrap everything in list of lists as a list of lists of one element", "body": "<p>A recursive version, not the shortest, yet that illustrates the wrapping of each item in each nested list, and that concatenates wrapped nested lists,</p>\n\n<pre><code>reWrap :: [[a]] -&gt; [[a]]\nreWrap [] = [[]]\nreWrap (xs:xss) = (map (:[]) xs) ++ reWrap xss\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 2851843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c70a8f666ba1a91420ba0fea7455c8?s=128&d=identicon&r=PG&f=1", "display_name": "user2851843", "link": "https://stackoverflow.com/users/2851843/user2851843"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 30384197, "answer_count": 5, "score": 2, "last_activity_date": 1432289206, "creation_date": 1432241267, "last_edit_date": 1432246936, "question_id": 30384041, "link": "https://stackoverflow.com/questions/30384041/haskell-wrap-everything-in-list-of-lists-as-a-list-of-lists-of-one-element", "title": "Haskell: wrap everything in list of lists as a list of lists of one element", "body": "<p>Good day everyone. </p>\n\n<p>What I am trying to accomplish is to convert a list like \n<code>[ [1, 2, 3], [25, 24, 23, 22], [13] ]</code> into <code>[ [1], [2], [3], [25], [24], [23], [22], [13] ]</code>. </p>\n\n<p>I tried something like </p>\n\n<pre><code>reWrap :: [[a]] -&gt; [[a]]\nreWrap data = map (map (:[])) data\n</code></pre>\n\n<p>but of course it just wrapped the contents even deeper into brackets. I'm new into functional programming so any help or tip would be much appreciated. Thank you in advance!</p>\n"}, {"tags": ["c", "haskell"], "comments": [{"owner": {"reputation": 21, "user_id": 4926052, "user_type": "registered", "profile_image": "https://graph.facebook.com/864977493539755/picture?type=large", "display_name": "Anders E. Adrielsson", "link": "https://stackoverflow.com/users/4926052/anders-e-adrielsson"}, "edited": false, "score": 0, "creation_date": 1432235399, "post_id": 30382314, "comment_id": 48853878, "body": "Okay, C doesn&#39;t have lazy evaluation, but I&#39;m not trying to do this with infinite lists, it was just a simple example. I just want the basic functionality :)"}, {"owner": {"reputation": 216, "user_id": 4876164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a77a8ca88ef81403ce1d2a95c7e3d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Riese", "link": "https://stackoverflow.com/users/4876164/sebastian-riese"}, "edited": false, "score": 0, "creation_date": 1432235445, "post_id": 30382314, "comment_id": 48853894, "body": "Haskell can have infinite lists, because it has lazy semantics. That is, if you write something like <code>list = 1:list</code>, the cdr on the right-hand side is a &quot;thunk&quot;, only evaluated, when needed. So your cdr must be a funtion pointer."}, {"owner": {"reputation": 216, "user_id": 4876164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a77a8ca88ef81403ce1d2a95c7e3d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Riese", "link": "https://stackoverflow.com/users/4876164/sebastian-riese"}, "edited": false, "score": 0, "creation_date": 1432235482, "post_id": 30382314, "comment_id": 48853914, "body": "Well but lazy semantics is at the very core of Haskell."}, {"owner": {"reputation": 5811, "user_id": 2726734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JkA2E.jpg?s=128&g=1", "display_name": "ryanpattison", "link": "https://stackoverflow.com/users/2726734/ryanpattison"}, "edited": false, "score": 1, "creation_date": 1432235596, "post_id": 30382314, "comment_id": 48853990, "body": "Linked lists are closer to what you want."}, {"owner": {"reputation": 216, "user_id": 4876164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a77a8ca88ef81403ce1d2a95c7e3d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Riese", "link": "https://stackoverflow.com/users/4876164/sebastian-riese"}, "edited": false, "score": 0, "creation_date": 1432235831, "post_id": 30382314, "comment_id": 48854137, "body": "Well he is building a linked lists .. with links on the stack, so everything will be smashed ..."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1432235983, "post_id": 30382314, "comment_id": 48854239, "body": "C is a low-level language. It&#39;s used to push bits around in memory directly. You have to do memory management yourself. Doing high-level abstract things like you mention would require you to do your own garbage collection, your own tail-call optimization, and many other things that the high-level languages do for you. C isn&#39;t meant for such things."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1432236825, "post_id": 30382314, "comment_id": 48854671, "body": "A translator from Haskell to C is called a compiler. You probably don&#39;t want to write one. You especially probably don&#39;t want to write one from Haskell to C. It&#39;s possible to build GHC specially to make it one (generally crippling other features), but this is only useful for special purposes."}, {"owner": {"reputation": 216, "user_id": 4876164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a77a8ca88ef81403ce1d2a95c7e3d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Riese", "link": "https://stackoverflow.com/users/4876164/sebastian-riese"}, "edited": false, "score": 0, "creation_date": 1432236925, "post_id": 30382314, "comment_id": 48854738, "body": "O, I missed something, the links are not even on the stack, the pointer is unitialized, thus pointing somewhere possibly even more sinister!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1432247347, "post_id": 30382314, "comment_id": 48860068, "body": "<a href=\"https://en.wikipedia.org/wiki/Royal_Road#A_metaphorical_.E2.80.9CRoyal_Road.E2.80.9D_in_famous_quotations\" rel=\"nofollow noreferrer\">there&#39;s no royal road</a> to writing Haskell-to-C translators. You need to really <i>really</i> know C very <i>very</i> well for that. It also requires being extremely comfortable with pointers, coincidentally."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432409353, "post_id": 30382314, "comment_id": 48919469, "body": "What is it that you&#39;re actually trying to accomplish, anyway? Translating ideas from a high-level research language that&#39;s recently become somewhat practical to a decades-old lowish-level language slowly approaching obsolescence seems a bit strange."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4926052, "user_type": "registered", "profile_image": "https://graph.facebook.com/864977493539755/picture?type=large", "display_name": "Anders E. Adrielsson", "link": "https://stackoverflow.com/users/4926052/anders-e-adrielsson"}, "edited": false, "score": 0, "creation_date": 1432240879, "post_id": 30382834, "comment_id": 48856970, "body": "Thank you very much for answering, it&#39;s quite a lot at once so forgive me if I don&#39;t yet realize you&#39;ve solved my problem. I have a question, I don&#39;t wanna sound stupid but, why is my pointer uninitialized..? And why does it matter, I thought I assigned it to something eventually..."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 21, "user_id": 4926052, "user_type": "registered", "profile_image": "https://graph.facebook.com/864977493539755/picture?type=large", "display_name": "Anders E. Adrielsson", "link": "https://stackoverflow.com/users/4926052/anders-e-adrielsson"}, "edited": false, "score": 0, "creation_date": 1432242577, "post_id": 30382834, "comment_id": 48857920, "body": "How is it not uninitialized, @AndersE.Adrielsson? You never initialize it, but you use it on the lhs of an assignment. Please tell us where that pointer <code>ptr</code> is pointing to?"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1432242711, "post_id": 30382834, "comment_id": 48857990, "body": "@Ingo is right, you never actually assign any value in this variable. <code>*ptr = ...</code> is not initialising, it assigns a value to the location pointed to by the pointer but it doesn&#39;t actually touch the pointer itself."}, {"owner": {"reputation": 21, "user_id": 4926052, "user_type": "registered", "profile_image": "https://graph.facebook.com/864977493539755/picture?type=large", "display_name": "Anders E. Adrielsson", "link": "https://stackoverflow.com/users/4926052/anders-e-adrielsson"}, "edited": false, "score": 0, "creation_date": 1432243449, "post_id": 30382834, "comment_id": 48858334, "body": "Alright, I follow you.. So what would make sense I initialize it to, in this context..? ptr = tail; ? (or = &amp;something I guess). Pointers are confusing"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 21, "user_id": 4926052, "user_type": "registered", "profile_image": "https://graph.facebook.com/864977493539755/picture?type=large", "display_name": "Anders E. Adrielsson", "link": "https://stackoverflow.com/users/4926052/anders-e-adrielsson"}, "edited": false, "score": 0, "creation_date": 1432243729, "post_id": 30382834, "comment_id": 48858472, "body": "@AndersE.Adrielsson obviously, ptr must point to new memory (i.e., you are creating a new list node with (:))"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 0, "creation_date": 1432244778, "post_id": 30382834, "comment_id": 48858973, "body": "Pointers contain a memory address. Even if some list was located at the address pointed to by tail, you would write to the memory before, thus corrupting the memory by overwriting other stuff and eventually try to modify an unreachable address and your program would crash."}], "tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": false, "score": 1, "last_activity_date": 1432236975, "creation_date": 1432236975, "answer_id": 30382834, "question_id": 30382314, "link": "https://stackoverflow.com/questions/30382314/concatenate-in-c-like-lists-in-haskell/30382834#30382834", "title": "Concatenate in C, like lists in Haskell", "body": "<p>First, this is what your function is doing:</p>\n\n<pre><code>int* cons(int head, int *tail) {\n    int *ptr; // Declare a pointer on the stack\n    *(ptr + 1) = *tail; // Set the int located after the one pointed by the (uninitialised) pointer ptr to the value pointed to by tail\n    *ptr = head; // Set the value that the (still unitiliased) points to to head\n    return ptr; // Return an uninitialised value\n}\n</code></pre>\n\n<p>Second, what you want is a linked list. You can create a structure just like <code>data List a = [] | (:) a (List a)</code> in C. For example,</p>\n\n<pre><code>typedef struct list {\n  void *element;\n  struct list *next;\n} list_t;\n</code></pre>\n\n<p>Now <code>cons</code> would look like this:</p>\n\n<pre><code>list_t *harp_cons(void *element, list_t *rest) {\n  list_t *list  = (list_t*)malloc(sizeof(struct list_t));\n  list-&gt;element = element;\n  list-&gt;next    = rest;\n  return list;\n}\n</code></pre>\n\n<p>This is allocating data on the heap, so you need to free it afterwards. You can provide a function <code>free_list</code> which would look like the following. (Assuming the elements can simply be freed with <code>free()</code> for the sake of simplicity.)</p>\n\n<pre><code>void free_list(list_t *list) {\n  if(list != NULL) {\n    if(list-&gt;next != NULL) {\n      free_list(list-&gt;next);\n    }\n    free(list-&gt;element);\n    free(list);\n  }\n}\n</code></pre>\n\n<p>I just took that code from some of my open source code.</p>\n\n<p>If you want to look at a full implementation of (sort of) a list API: <a href=\"https://github.com/thoferon/harp/blob/master/libharp/list.c\" rel=\"nofollow\">https://github.com/thoferon/harp/blob/master/libharp/list.c</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4926052, "user_type": "registered", "profile_image": "https://graph.facebook.com/864977493539755/picture?type=large", "display_name": "Anders E. Adrielsson", "link": "https://stackoverflow.com/users/4926052/anders-e-adrielsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547190296, "creation_date": 1432235275, "last_edit_date": 1547190296, "question_id": 30382314, "link": "https://stackoverflow.com/questions/30382314/concatenate-in-c-like-lists-in-haskell", "title": "Concatenate in C, like lists in Haskell", "body": "<p>I've sort of ended up writing a translator from Haskell to C, a hobby thing..</p>\n\n<p>Haskell's <code>(:)</code>-function, with type <code>a -&gt; [a] -&gt; [a]</code> is what I want to do in C.</p>\n\n<p><code>1 : [2,3]</code> is in fact <code>1 : (2 : (3 : []))</code> if I'm not mistaken.</p>\n\n<p>Say I want to create an infinite list with increasing numbers in it:</p>\n\n<pre><code>lst i = i : lst (i + 1)\n</code></pre>\n\n<p>How do I do this in C? I imagine the final product looking something along the lines of:</p>\n\n<pre><code>int* lst(int i) {\n    return cons(i, lst(i + 1));\n}\n</code></pre>\n\n<p>My thought so far:</p>\n\n<ul>\n<li>C has arrays. </li>\n<li>Arrays need to be of a defined length, this clashes with recursive reasoning.</li>\n<li>C has pointers. \n\n<ul>\n<li>Arrays decay to pointers when passed as arguments anyway so, might as well use pure pointers. </li>\n<li><code>array[i]</code> is equivalent to <code>*(ptr + i)</code>, I'm thinking I can use this to get around the problem of having to define things you cannot know (final length of the list etc). </li>\n</ul></li>\n</ul>\n\n<p>I'm unsure of the implementation of cons though.. My best guess is:</p>\n\n<pre><code>int* cons(int head, int *tail) {\n    int *ptr;\n    *(ptr + 1) = *tail;\n    *ptr = head;\n    return ptr;\n}\n</code></pre>\n\n<p>Pointers are hard for me, dereferencing etc etc, I don't know C very well and my brain hurts. I just want to make a pointer which contains both the head and the tail. Order is not important for the moment.</p>\n\n<p>It compiles, but that's as far as it goes. Help would be appreciated, I'm open to suggestions, I'm not even sure I'm on the right track or if it's even possible.</p>\n"}, {"tags": ["sorting", "haskell", "tuples", "elements"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1432229936, "post_id": 30380697, "comment_id": 48850676, "body": "forgot <code>import Data.List (sortBy)</code>? (before you ask: <code>import Data.Function (on)</code> too ;)  - ah yes and you have to do something about <i>descending</i> - <i>hint</i>: you can use <code>flip compare</code>)"}, {"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 2, "creation_date": 1432230172, "post_id": 30380697, "comment_id": 48850827, "body": "Also, you can replace <code>\\(a,b)-&gt;b</code> with <code>snd</code>"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1432230207, "post_id": 30380697, "comment_id": 48850850, "body": "You need to use backquotes (`) around <code>on</code>, not regular apostrophes."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432231163, "post_id": 30380697, "comment_id": 48851394, "body": "ok - for the last part: you have to put the <code>import</code> parts after the <code>module</code> parts"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432231918, "post_id": 30380697, "comment_id": 48851812, "body": "just one simple advice/observation: I guess the <code>Int</code> part here is for your exponents - but you can represent a polynomial simply by listing it&#39;s coefficients so <code>a_0 * X^0 + a_1 * X^1 + ... + a_n * X^n</code> can simply be represented by <code>[a_0,a_1,...,a_n]</code> - this way you will not have to sort any thing and you could write <code>newtype Poly = P [float]</code> (or make it even more generic with <code>newtype Poly a = P [a]</code> using <code>Num a =&gt; ...</code> for your operations on the polynomial) - the newtype is there because I think you will soon make it an instance of <code>Num</code> ;)"}], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "edited": false, "score": 0, "creation_date": 1432230640, "post_id": 30380840, "comment_id": 48851123, "body": "Hey thanks but, I&#39;ve got this in the header      module TupleListPolynomial where     type Poly = [(Float,Int)]     import Data.List (sortBy)     import Data.Function (on)  And the compiler doesnt recognize the import D: Can&#39;t format sorry"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "edited": false, "score": 0, "creation_date": 1432230719, "post_id": 30380840, "comment_id": 48851163, "body": "well you probably have to repeat it in GHCi ;) (really hard to tell without seeing your actual code and what you really did)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "edited": false, "score": 0, "creation_date": 1432230798, "post_id": 30380840, "comment_id": 48851200, "body": "btw: the imports usually come before any definition (maybe you can add your actual code and your compiler-errors) - but the part I wrote under *in GHCi you would write` works for me and they should really work for you too"}, {"owner": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "edited": false, "score": 0, "creation_date": 1432231105, "post_id": 30380840, "comment_id": 48851358, "body": "Uh, i&#39;ve edited main post for more insight and actual explanation of the compiling error"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "edited": false, "score": 0, "creation_date": 1432231185, "post_id": 30380840, "comment_id": 48851409, "body": "@dari1495 I left you an comment there - I will also edit my answer for this"}, {"owner": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "edited": false, "score": 0, "creation_date": 1432231400, "post_id": 30380840, "comment_id": 48851525, "body": "Thanks, I solved it by putting the imports between module and  type, apparently if I put module after type, it won&#39;t recognize it"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "edited": false, "score": 0, "creation_date": 1432231504, "post_id": 30380840, "comment_id": 48851584, "body": "yes the order is quite fixed - you will usually do: extensions -&gt; module -&gt; imports -&gt; now you are free ;)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 12, "last_activity_date": 1432231402, "last_edit_date": 1432231402, "creation_date": 1432230247, "answer_id": 30380840, "question_id": 30380697, "link": "https://stackoverflow.com/questions/30380697/sort-tuples-by-one-of-their-elements-in-haskell/30380840#30380840", "title": "Sort tuples by one of their elements in haskell", "body": "<p>A few observations:</p>\n\n<ul>\n<li>to get <code>sortBy</code> and <code>on</code> you have to import them first</li>\n<li>you want to sort in descending order and one way to do this is to use <code>flip compare</code> instead of <code>compare</code></li>\n<li>instead of <code>\\ (a,b) -&gt; b</code> you can also use <code>snd</code> (thanks Arnon)</li>\n<li>you have to use back-ticks <code>`</code> instead of <code>'</code> for <code>`on`</code> (thanks interjay)</li>\n<li>the <code>t</code> in <code>mySort t = ... t</code> is not needed</li>\n</ul>\n\n<h2>one possible solution:</h2>\n\n<p>ok - this one should compile and also load and works into ghci if you put it into some <code>myPolynomial.hs</code> file (or however you want to call it):</p>\n\n<pre><code>module TupleListPolynomial where\n\nimport Data.List (sortBy)\nimport Data.Function (on)\n\ntype Poly = [(Float,Int)]\n\nmySort :: Ord b =&gt; [(a, b)] -&gt; [(a, b)]\nmySort = sortBy (flip compare `on` snd)\n</code></pre>\n\n<h2>in GHCi you would write</h2>\n\n<pre><code>import Data.List (sortBy)\nimport Data.Function (on)\n\nlet mySort = sortBy (flip compare `on` snd)\n</code></pre>\n\n<p>indeed this is what I did to test it like this:</p>\n\n<h3>test</h3>\n\n<pre><code>&gt; mySort [(1,2),(2,1),(3,3)]\n[(3,3),(1,2),(2,1)]\n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 4925895, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh6.googleusercontent.com/-WYqpkQR0Wj8/AAAAAAAAAAI/AAAAAAAAAIA/OR5R46Inzo8/photo.jpg?sz=128", "display_name": "dari1495", "link": "https://stackoverflow.com/users/4925895/dari1495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10136, "favorite_count": 3, "accepted_answer_id": 30380840, "answer_count": 1, "score": 5, "last_activity_date": 1432236521, "creation_date": 1432229798, "last_edit_date": 1432236521, "question_id": 30380697, "link": "https://stackoverflow.com/questions/30380697/sort-tuples-by-one-of-their-elements-in-haskell", "title": "Sort tuples by one of their elements in haskell", "body": "<p>I have a list like this </p>\n\n<pre><code>[(1,2),(2,1),(3,3)]\n</code></pre>\n\n<p>And I want to sort it by the second element, so it'd be:</p>\n\n<pre><code>[(3,3),(1,2),(2,1)]\n</code></pre>\n\n<p>I've tried</p>\n\n<pre><code>mySort t = sortBy (compare `on` (\\(a,b)-&gt;b)) t\n</code></pre>\n\n<p>But ghci does not recognice sortBy apparently </p>\n\n<p>Okay, editing:</p>\n\n<p>I'm using GHCi to compile actual .hs files, so i've got my header:</p>\n\n<pre><code>import Data.List (sortBy)\nimport Data.Function (on)\n\nmodule TupleListPolynomial where\ntype Poly = [(Float,Int)]\n</code></pre>\n\n<p>And if I write it like this, the compiler won't recognize 'module'(using :l and :r btw) :</p>\n\n<pre><code>[1 of 1] Compiling Main             ( TupleListPolynomial.hs, interpreted )\n\nTupleListPolynomial.hs:5:1: parse error on input \u2018module\u2019\n</code></pre>\n\n<p>And if I flip it and write the imports below it won't recognize 'import' with the same error.</p>\n\n<p>EDIT: Solved by putting it like this:</p>\n\n<pre><code>module TupleListPolynomial where\nimport Data.List (sortBy)\nimport Data.Function (on)\ntype Poly = [(Float,Int)]\n</code></pre>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"tags": [], "owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "is_accepted": true, "score": 7, "last_activity_date": 1432217740, "creation_date": 1432217740, "answer_id": 30376409, "question_id": 30376163, "link": "https://stackoverflow.com/questions/30376163/why-do-i-get-unexpected-end-of-input-when-my-parser-is-explicitly-looking-for/30376409#30376409", "title": "Why do I get &quot;unexpected end of input&quot; when my parser is explicitly looking for it?", "body": "<p>The problem is that there is a newline before <code>eof</code> (inserted by <code>unlines</code>).</p>\n\n<p>So <code>eof</code> must be run through <code>lexeme</code>.</p>\n\n<pre><code>fields = many (try field) &lt;* lexeme eof\n</code></pre>\n\n<p>Otherwise Parsec is trying to run the <code>fields</code> parser on the newline.</p>\n"}], "owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 30376409, "answer_count": 1, "score": 4, "last_activity_date": 1432217740, "creation_date": 1432217166, "question_id": 30376163, "link": "https://stackoverflow.com/questions/30376163/why-do-i-get-unexpected-end-of-input-when-my-parser-is-explicitly-looking-for", "title": "Why do I get &quot;unexpected end of input&quot; when my parser is explicitly looking for it?", "body": "<pre><code>import Control.Applicative hiding (many)\nimport Text.Parsec\nimport Text.Parsec.String\n\nlexeme :: Parser a -&gt; Parser a\nlexeme p = many (oneOf \" \\n\\r\") *&gt; p\n\nidentifier :: Parser String\nidentifier = lexeme $ many1 $ oneOf (['a'..'z'] ++ ['A'..'Z'])\n\noperator :: String -&gt; Parser String\noperator = lexeme . string\n\nfield :: Parser (String, String)\nfield = (,) &lt;$&gt; identifier &lt;* operator \":\" &lt;*&gt; identifier &lt;* operator \";\"\n\nfields :: Parser [(String, String)]\nfields = many (try field) &lt;* eof\n\ntestInput :: String\ntestInput = unlines\n    [ \"    FCheckErrors         : Boolean            ;\"\n    , \"    FAcl                 : TStrings           ;\"\n    ]\n\nmain :: IO ()\nmain = parseTest fields testInput\n</code></pre>\n\n<p>When runn this yields:</p>\n\n<blockquote>\n  <p>parse error at (line 3, column 1): unexpected end of input</p>\n</blockquote>\n\n<p>When I remove the explicit eof matching there is no such parse error:</p>\n\n<pre><code>fields = many (try field)\n</code></pre>\n\n<p>I also tried <code>try field `manyTill` eof</code>, but that will result in the same behavior as the original code.</p>\n\n<p>I want to make sure the parser consumes the whole input, how can I do that?</p>\n"}, {"tags": ["sockets", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 5267, "user_id": 1102851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e1866c32c13460429d2f9ba066949bc?s=128&d=identicon&r=PG", "display_name": "bgamari", "link": "https://stackoverflow.com/users/1102851/bgamari"}, "is_accepted": true, "score": 6, "last_activity_date": 1432229024, "last_edit_date": 1495535213, "creation_date": 1432217970, "answer_id": 30376493, "question_id": 30375962, "link": "https://stackoverflow.com/questions/30375962/parsing-bytestring-from-socket-fails/30376493#30376493", "title": "Parsing ByteString from Socket fails", "body": "<p>I would bet that the problem has nothing to do with the parser but is instead due to the blocking semantics of UNIX sockets.</p>\n\n<p>While a loopback\ninterface will likely pass the packet directly from the sender to the receiver,\nan Ethernet interface may need to break up the packet to fit in the Maximum\nTransmission Unit (MTU) of the link. This is known as packet fragmentation.</p>\n\n<p>The <code>len</code>\nargument to the <a href=\"http://linux.die.net/man/2/recv\" rel=\"nofollow noreferrer\"><code>recv</code></a> system call is merely\nthe upper bound on the received length (e.g. the size of the target buffer); the\ncall may produce less data than you ask for. To quote the manpage,</p>\n\n<blockquote>\n  <p>If no messages are available at the socket, the receive calls wait for a\n  message to arrive, unless the socket is nonblocking (see fcntl(2)), in which\n  case the value -1 is returned and the external variable errno is set to\n  EAGAIN or EWOULDBLOCK.  The receive calls normally return any data\n  available, up to the requested amount, rather than waiting for receipt of\n  the full amount requested.</p>\n</blockquote>\n\n<p>For this reason, you may need multiple <code>recv</code> calls to retrieve the entire packet. Your example works if you delay the <code>recv</code> as the operating system can reassemble the original packet since all fragments have arrived by the time it is requested.</p>\n\n<p>As <a href=\"https://stackoverflow.com/a/30377965/1102851\">meiersi</a> pointed out, there are a variety of streaming I/O libraries that have developed in the Haskell world for solving this problem, among others. These include <a href=\"http://hackage.haskell.org/package/pipes-4.1.5/docs/Pipes-Tutorial.html\" rel=\"nofollow noreferrer\"><code>pipes</code></a>, <a href=\"http://hackage.haskell.org/package/conduit\" rel=\"nofollow noreferrer\"><code>conduit</code></a>, <a href=\"http://hackage.haskell.org/package/io-streams\" rel=\"nofollow noreferrer\"><code>io-streams</code></a>, and others. Depending upon your goals, this may be a natural way to handle this issue.</p>\n"}, {"tags": [], "owner": {"reputation": 298, "user_id": 1355491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2593d170f0414df66cf505226f031e?s=128&d=identicon&r=PG", "display_name": "meiersi", "link": "https://stackoverflow.com/users/1355491/meiersi"}, "is_accepted": false, "score": 2, "last_activity_date": 1432221732, "last_edit_date": 1495541658, "creation_date": 1432221732, "answer_id": 30377965, "question_id": 30375962, "link": "https://stackoverflow.com/questions/30375962/parsing-bytestring-from-socket-fails/30377965#30377965", "title": "Parsing ByteString from Socket fails", "body": "<p>You might want to try <a href=\"https://hackage.haskell.org/package/conduit-extra-1.1.8/docs/Data-Conduit-Network.html\" rel=\"nofollow noreferrer\">the socket support in <code>conduit-extra</code></a> combined with <a href=\"https://hackage.haskell.org/package/binary-conduit\" rel=\"nofollow noreferrer\"><code>binary-conduit</code></a> to properly handle the parsing of the chunked streaming, which happens due to the reasons pointed out by <a href=\"https://stackoverflow.com/users/1102851/bgamari\">bgamari</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 2292589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3e7ec809677d4959a427858b16f154d?s=128&d=identicon&r=PG", "display_name": "Finn Espen Gundersen", "link": "https://stackoverflow.com/users/2292589/finn-espen-gundersen"}, "is_accepted": false, "score": 2, "last_activity_date": 1432244804, "creation_date": 1432244804, "answer_id": 30384933, "question_id": 30375962, "link": "https://stackoverflow.com/questions/30375962/parsing-bytestring-from-socket-fails/30384933#30384933", "title": "Parsing ByteString from Socket fails", "body": "<p>First of all, consider yourself lucky to observe this. On many platforms perhaps only one out of a thousand packets exhibit this behaviour, causing a lot of such (sorry) bad networking code to fail seldom and randomly.</p>\n\n<p>The problem is that you start processing before the data is ready. Instead of the threadDelay (which introduces a permanent delay and might not be long enough in all cases), the solution is to make sure you have at least one item/message/packet to process before you start processing it. Your protocol where the first 32bit word contains the length is perfect for this. Read data until you have at least 4 bytes (the length). Then read data until you have the required number of bytes. If any calls to recvFromSock returns less than the required number, call it again to get some more. Remember to also handle the case of 0 bytes, this means the other party closed the connection.</p>\n\n<p>I have implemented this for a similar protocol (SMPP, packets also starts with the length) and it works perfectly.</p>\n"}], "owner": {"reputation": 2090, "user_id": 1610555, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3ab63b360643d119edf9347bac19492b?s=128&d=identicon&r=PG", "display_name": "Marc Juchli", "link": "https://stackoverflow.com/users/1610555/marc-juchli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 30376493, "answer_count": 3, "score": 2, "last_activity_date": 1432244804, "creation_date": 1432216741, "question_id": 30375962, "link": "https://stackoverflow.com/questions/30375962/parsing-bytestring-from-socket-fails", "title": "Parsing ByteString from Socket fails", "body": "<p>We are writing a message broker in Haskell <a href=\"https://github.com/hmb-ba/broker\" rel=\"nofollow\">(HMB)</a>. Therefore messages have to be parsed (<a href=\"https://hackage.haskell.org/package/binary-0.7.4.0/docs/Data-Binary.html\" rel=\"nofollow\">Data.Binary</a>) after they are received from socket (<a href=\"http://hackage.haskell.org/package/network-2.6.1.0/docs/Network-Socket.html#v:socket\" rel=\"nofollow\">Network.Socket</a>). We've been testing on loopback (localhost) so far - for producing and parsing messages. This worked quiet well. If we benchmark by producing messages from another machine we are facing problems: Suddenly the parser does not have enough bytes to parse. </p>\n\n<p>The first 4 bytes of each message defines the length of the message and thus describes the message to be parsed. As hinted above, we do parsing with Data.Binary - so this is lazy. For testing purposes we switched parsing of the first 4 bytes to strict by using the cereal library. This the same problem. We now even tried to completely parse the requests with cereal only and the problem also remains.</p>\n\n<p>In the code you'll see that we do threading. However, we also tried without a channel (single threaded setup) but this didn't solve the problem either.</p>\n\n<p>Here is a part of the code (Thread1) where the received bytes are written to a channel to be further consumed/parsed. (As mentioned, nothing changes if we omit channeling and directly parse <em>input</em>):</p>\n\n<pre><code>runConnection :: (Socket, SockAddr) -&gt; RequestChan -&gt; Bool -&gt; IO()\nrunConnection conn chan False = return ()\nrunConnection conn chan True = do\n    r &lt;- recvFromSock conn\n    case (r) of\n        Left e -&gt; do\n            handleSocketError conn e\n            runConnection conn chan False\n        Right input -&gt; do\n            threadDelay 5000 -- THIS FIXES THE PROBLEM!?\n            writeToReqChan conn chan input\n            runConnection conn chan True\n</code></pre>\n\n<p>Here is the part (Thread2) where <em>input</em> is beeing parsed:</p>\n\n<pre><code>runApiHandler :: RequestChan -&gt; ResponseChan -&gt; IO()\nrunApiHandler rqChan rsChan = do\n  (conn, req) &lt;- readChan rqChan\n  case readRequest req of -- readRequest IS THE PARSER\n    Left (bs, bo, e) -&gt; handleHandlerError conn $ ParseRequestError e\n    Right (bs, bo, rm) -&gt; do\n      res &lt;- handleRequest rm\n      case res  of\n        Left e -&gt; handleHandlerError conn e\n        Right bs -&gt; writeToResChan conn rsChan bs\n  runApiHandler rqChan rsChan\n</code></pre>\n\n<p>Now I figured out, that if the process of parsing is delayed a bit (see threadDelay in the first code block), everything works fine. Which basically means, the parser doesn't wait for bytes received from the socket. </p>\n\n<p>Why is that? Why does the parser not wait for the socket the have enough bytes? Is there a general mistake in our setup?</p>\n"}, {"tags": ["haskell", "recursion", "foldleft"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1432201462, "post_id": 30369954, "comment_id": 48830444, "body": "<i>I can&#39;t understand what <code>flip</code> does here.</i> You might benefit from writing <code>(:)</code> as a lambda: <code>\\x xs -&gt; x : xs</code>. If you apply <code>flip</code> to this lambda, the resulting function is <code>\\xs x -&gt; x : xs</code>."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1432217445, "post_id": 30369954, "comment_id": 48842036, "body": "protip: use <code>foldl&#39;</code> from the List module instead of <code>foldl</code>. Plain <code>foldl</code> is never the best choice (unless you are solving some <a href=\"http://stackoverflow.com/questions/8235797\">crazy made up problem</a>)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1432226215, "post_id": 30369954, "comment_id": 48848362, "body": "@hugomg, I think it should probably be perfectly fine in this case. <code>flip (:)</code> doesn&#39;t do any actual computation, so I&#39;d expect GHC to treat it pretty much like a constructor. You&#39;d have to test to be sure though."}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1432201824, "post_id": 30370129, "comment_id": 48830677, "body": "Minor objection: <code>foldl</code> doesn&#39;t cause the range to fully evaluate from the beginning."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1432202078, "post_id": 30370129, "comment_id": 48830861, "body": "yeah of course - but I think if I write down the sequence and look out for all the lazy parts this will get very cluttered and almost unreadable - I was hoping the indent and the way <code>flip</code> <code>(:)</code> and <code>foldl</code> are working here would be more obvious this way"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1432202178, "post_id": 30370129, "comment_id": 48830913, "body": "Yes, yes, no problem. You wrote &quot;something like this&quot;, after all."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1432201452, "creation_date": 1432201452, "answer_id": 30370129, "question_id": 30369954, "link": "https://stackoverflow.com/questions/30369954/how-does-this-foldl-based-function-work-myreverse-foldl-flip/30370129#30370129", "title": "How does this foldl-based function work: &quot;myreverse = foldl (flip (:)) []&quot;?", "body": "<p>flip is rather easy:</p>\n\n<p>if you have a function <code>f :: a -&gt; b -&gt; c</code> then <code>flip f</code> is a function <code>:: b -&gt; a -&gt; c</code> so it gives you back a new function and <strong>flips</strong> the order of arguments you have to pass.</p>\n\n<p><code>(:) :: a -&gt; [a] -&gt; [a]</code> is a function of this pattern and so <code>flip (:)</code> will now be a function that first takes the soon-to-be tail and then the new head and returns you a new list with those:</p>\n\n<pre><code>(flip (:)) [2..4] 1\n= (:) 1 [2..4]\n= 1 : [2..4]\n= [1,2,3,4]\n</code></pre>\n\n<p>now you need this here because <code>foldl</code> is defined this way:</p>\n\n<pre><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>you see - the function you have to pass will here be one that first takes a list and then an element and returns a new list</p>\n\n<p>this will now fold all into something like this:</p>\n\n<pre><code>myreverse [1..5]\n= foldl (flip (:)) [] [1,2,3,4,5]\n= foldl (flip (:)) (((flip (:)) [] 1)) [2,3,4,5]\n= foldl (flip (:)) (1:[]) [2,3,4,5]\n= foldl (flip (:)) (((flip (:)) [1] 2)) [3,4,5]\n= foldl (flip (:)) (2:[1]) [3,4,5]\n= ...\n= [5,4,3,2,1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 3320256, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NZCl4.png?s=128&g=1", "display_name": "daniel.kahlenberg", "link": "https://stackoverflow.com/users/3320256/daniel-kahlenberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1432220004, "creation_date": 1432220004, "answer_id": 30377307, "question_id": 30369954, "link": "https://stackoverflow.com/questions/30369954/how-does-this-foldl-based-function-work-myreverse-foldl-flip/30377307#30377307", "title": "How does this foldl-based function work: &quot;myreverse = foldl (flip (:)) []&quot;?", "body": "<p>You might try in ghci what <code>flip</code> does:</p>\n\n<pre><code>:t (:)\n(:) 1 [2..4]\n</code></pre>\n\n<blockquote>\n  <p>[1,2,3,4]</p>\n</blockquote>\n\n<pre><code>:t flip (:)\n(flip (:)) [2..4] 1\n</code></pre>\n\n<blockquote>\n  <p>[1,2,3,4]</p>\n</blockquote>\n"}], "owner": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 30370129, "answer_count": 2, "score": 4, "last_activity_date": 1432220004, "creation_date": 1432200983, "last_edit_date": 1432216222, "question_id": 30369954, "link": "https://stackoverflow.com/questions/30369954/how-does-this-foldl-based-function-work-myreverse-foldl-flip", "title": "How does this foldl-based function work: &quot;myreverse = foldl (flip (:)) []&quot;?", "body": "<p>I am learning haskell and I tried to write my own reverse function without using recursion. </p>\n\n<p>The solution is this function:</p>\n\n<pre><code>myreverse = foldl (flip (:)) []\n</code></pre>\n\n<p>I'm trying to understand what happens during the evaluation of, say:</p>\n\n<pre><code>myreverse [1..5]\n</code></pre>\n\n<p>I can't understand what flip does here. Can somebody write down what happens here with a step-by-step explanation?</p>\n"}, {"tags": ["haskell", "simulation", "frp", "conceptual", "arrows"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432191007, "post_id": 30366083, "comment_id": 48823868, "body": "what exactly is the <i>backwater effect</i> - is this just traffic jam that will propagate backwards through your roads? - as a side note: while interesting this question will most likely be to broad for this kind of FAQ site - have anything to show yet and a concrete problem (for example: how did you model your roads - in code ;) )"}, {"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432191117, "post_id": 30366083, "comment_id": 48823928, "body": "Yes, the backwater effect is as you describe. No, I don&#39;t have any code to show, because I believe I must solve this conceptual problem first."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1432208968, "post_id": 30366083, "comment_id": 48835570, "body": "How much discrete systems modeling have you done?  Have you used software like <a href=\"https://en.wikipedia.org/wiki/Arena_%28software%29\" rel=\"nofollow noreferrer\">Arena</a> before (it&#39;s the one I was exposed to at uni, but there are certainly others)?  In order to encode something like this into arrows or FRP, you&#39;re going to need to spend a lot of time thinking about the model you want to use and experimenting with how to get it modeled in one of these paradigms.  You could also consider something like <code>Pipe</code>s, as it has bidirectional communication for each channel."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1432216581, "post_id": 30366083, "comment_id": 48841337, "body": "perhaps &quot;backpressure&quot; is a better term."}, {"owner": {"reputation": 3637, "user_id": 797637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1577f43a7c6eb01836e1758a2ba4df5?s=128&d=identicon&r=PG&f=1", "display_name": "firefrorefiddle", "link": "https://stackoverflow.com/users/797637/firefrorefiddle"}, "edited": false, "score": 0, "creation_date": 1432280163, "post_id": 30366083, "comment_id": 48870146, "body": "Why wouldn&#39;t it propagate backwards? It seems that you only need the simulation function to know whether the subsequent segment is full, and if so, then not let any cars exit a segment. Perhaps you should really show some code so that we can see your mental model and how it would prohibit propagation."}], "answers": [{"comments": [{"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1432294009, "post_id": 30392113, "comment_id": 48878550, "body": "Petr, you seem to completely understand my problem. I had similar thoughts: A segment needs two inputs! What I am asking myself is the following: who says that the computation needs to return cars? The computation does not necessarily have to follow the flow of cars, but could compute &quot;something&quot; from the upstream and downstream sides of a segment. But I am unable to finish this train of thoughts."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 2, "last_activity_date": 1432284073, "creation_date": 1432284073, "answer_id": 30392113, "question_id": 30366083, "link": "https://stackoverflow.com/questions/30366083/using-frp-to-model-road-network-with-jams/30392113#30392113", "title": "Using FRP to model road network with jams", "body": "<p>The problem is that in arrows and in FRP the flow of information is in general unidirectional. Think of a FRP arrow like a piece of digital circuit. The output of a circuit element doesn't depend on what's connected to it - it just \"offers\" the output to whoever is interested. This is also described visually in Primitive signal functions in the <a href=\"https://wiki.haskell.org/Yampa#Primitive_signal_functions\" rel=\"nofollow noreferrer\">Yampa overview</a>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/oiqBV.png\" alt=\"Yampa - signal functions\"></p>\n\n<p>Your situation is different. The state of a segment of a road depends on both the next and previous segments - cars are comming from the previous one, but if cars can't leave to the next one, they have to stay. It's just like a pipe with running water. If you close the pipe at its end, water stops, and the information about that propagates backwards through the pipe at the speed of sound in water.</p>\n\n<p>So each road segment will need to have 2 inputs: One saying let's say how many cars can the following segment accept, and how many cars are coming from the previous segment (which should always be less or equal to the number of cars the segment can accept at the moment). This means that the FRP signal flow will be actually circular. For this you'll need <em>loops</em>, shown in the last image in the above diagram, which are captured by <a href=\"https://hackage.haskell.org/package/base-4.7.0.0/docs/Control-Arrow.html#t:ArrowLoop\" rel=\"nofollow noreferrer\"><code>ArrowLoop</code></a> type-class. Most likely you'll have a custom binding function for road segments that'll be internally creating the required loops. Note that there must be a time delay in a loop, to prevent it from diverging, which makes sense as it takes some time for cars to go from one segment to another.</p>\n\n<p>(I'll perhaps expand the answer with an example, if I'll have more time.)</p>\n"}], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 2, "answer_count": 1, "score": 6, "last_activity_date": 1432284073, "creation_date": 1432189666, "last_edit_date": 1432276163, "question_id": 30366083, "link": "https://stackoverflow.com/questions/30366083/using-frp-to-model-road-network-with-jams", "title": "Using FRP to model road network with jams", "body": "<p>I am currently trying to understand arrows and FRP, and I came upon a question, which I cannot seem to map to FRP, namely how to model a road network.</p>\n\n<p>I thought I could model a road network as Arrows, where each Arrow represents a road segment. It accepts streams of cars at locations and times and produces the same type, albeit with different locations and times.</p>\n\n<p>So far so good. But this model does not take into account, that segments may get jammed. While each segment could well respond to heavy traffic and delay cars more and more, the more congested it gets, there would be no backwater effect, i.e. the jam would not propagate backwards to other road segments.</p>\n\n<p>I suspect I am applying too much OO thinking here, instead of focusing on what needs to be computed, but I cannot get it right in my head.</p>\n\n<ul>\n<li>How can I model a road network with Arrows such that backwater effects are taken into account?</li>\n</ul>\n"}]